{
    "From": " Cisco IOS Configuration Fundamentals Command Reference",
    "PageTitle": "traceroute mac",
    "FuncDef": [
        "To display the Layer 2 path taken by the packets from the specified source to the specified destination, use the **traceroute mac** command in privileged EXEC mode. "
    ],
    "CLIs": [
        "traceroute mac <source-mac-address> { <destination-mac-address> | interface <type interface-number> <destination-mac-address> } [ vlan <vlan-id> ] [ detail ]",
        "traceroute mac interface <type interface-number> <source-mac-address> { <destination-mac-address> | interface <type interface-number> <destination-mac-address> } [ vlan <vlan-id> ] [ detail ]",
        "traceroute mac ip { <source-ip-address> | <source-hostname> } { <destination-ip-address> | <destination-hostname> } [ detail ]"
    ],
    "ParentView": [
        null
    ],
    "ParaDef": [
        {
            "Parameters": " *source-mac-address* ",
            "Info": " Media Access Control (MAC) address of the source switch in hexadecimal format. "
        },
        {
            "Parameters": " *destination-mac-address* ",
            "Info": " MAC address of the destination switch in hexadecimal format. "
        },
        {
            "Parameters": " **interface** *type* ",
            "Info": " Specifies the interface where the MAC address resides; valid values are **FastEthernet**, **GigabitEthernet**, and **Port-channel**. "
        },
        {
            "Parameters": " *interface-number* ",
            "Info": " Module and port number or the port-channel number; valid values for the port channel are from 1 to 282. "
        },
        {
            "Parameters": " **vlan** *vlan-id* ",
            "Info": " (Optional) Specifies the virtual local area network (VLAN) on which to trace the Layer 2 path that the packets take from the source switch to the destination switch; valid values are from 1 to 4094. "
        },
        {
            "Parameters": " **detail** ",
            "Info": " (Optional) Displays detailed information about the Layer 2 trace. "
        },
        {
            "Parameters": " **ip** ",
            "Info": " Specifies the IP address where the MAC address resides. "
        },
        {
            "Parameters": " *source-ip-address* ",
            "Info": " IP address of the source switch as a 32-bit quantity in dotted-decimal format. "
        },
        {
            "Parameters": " *source-hostname* ",
            "Info": " IP hostname of the source switch. "
        },
        {
            "Parameters": " *destination-ip-address* ",
            "Info": " IP address of the destination switch as a 32-bit quantity in dotted-decimal format. "
        },
        {
            "Parameters": " *destination-hostname* ",
            "Info": " IP hostname of the destination switch. "
        }
    ],
    "Examples": [
        [
            "```",
            "Router# traceroute mac 0001.0000.0204 0001.0000.0304 detail",
            "```",
            "```",
            "```",
            "```",
            "Source 1001.0000.0204 found on VAYU [ WS-C6509 ] (10.1.1.10)",
            "```",
            "```",
            "1 VAYU / WS-C6509 / 10.1.1.10 :",
            "```",
            "```",
            "Gi6/1 [ full, 1000M ] => Po100 [ auto, auto ]",
            "```",
            "```",
            "2 PANI / WS-C6509 / 10.1.1.12 :",
            "```",
            "```",
            "Po100 [ auto, auto ] => Po110 [ auto, auto ]",
            "```",
            "```",
            "3 BUMI / WS-C6509 / 10.1.1.13 :",
            "```",
            "```",
            "Po110 [ auto, auto ] => Po120 [ auto, auto ]",
            "```",
            "```",
            "4 AGNI / WS-C6509 / 10.1.1.11 :",
            "```",
            "```",
            "Po120 [ auto, auto ] => Gi8/12 [ full, 1000M ]",
            "```",
            "```",
            "Destination 1001.0000.0304 found on AGNI [ WS-C6509 ] (10.1.1.11)",
            "```",
            "```",
            "Layer 2 trace completed.",
            "```",
            "```",
            "Router#",
            "```",
            "```",
            "```"
        ],
        [
            "```",
            "Router# traceroute mac 0000.0201.0501 0000.0201.0201 detail",
            "```",
            "```",
            "```",
            "```",
            "Source not directly connected, tracing source .....",
            "```",
            "```",
            "Source 1000.0201.0501 found on con5 [ WS-C6509 ] (10.2.5.5)",
            "```",
            "```",
            "con5 / WS-C6509 / 10.2.5.5 :",
            "```",
            "```",
            "Fa0/1 [ auto, auto ] =>Gi0/1 [ auto, auto ]",
            "```",
            "```",
            "con1 / WS-C6509 / 10.2.1.1 :",
            "```",
            "```",
            "Gi0/1 [ auto, auto ] =>Gi0/2 [ auto, auto ]",
            "```",
            "```",
            "con2 / WS-C6509 / 10.2.2.2 :",
            "```",
            "```",
            "Gi0/2 [ auto, auto ] =>Fa0/1 [ auto, auto ]",
            "```",
            "```",
            "Destination 1000.0201.0201 found on con2 [ WS-C6509 ] (10.2.2.2)",
            "```",
            "```",
            "Layer 2 trace completed.",
            "```",
            "```",
            "Router#",
            "```",
            "```",
            "```"
        ],
        [
            "```",
            "Router# traceroute mac 0000.0011.1111 0000.0201.0201",
            "```",
            "```",
            "```",
            "```",
            "Error:Source Mac address not found.",
            "```",
            "```",
            "Layer2 trace aborted.",
            "```",
            "```",
            "Router#",
            "```",
            "```",
            "```"
        ],
        [
            "```",
            "Router# traceroute mac 0000.0201.0601 0000.0301.0201",
            "```",
            "```",
            "```",
            "```",
            "Error:Source and destination macs are on different vlans.",
            "```",
            "```",
            "Layer2 trace aborted.",
            "```",
            "```",
            "Router#",
            "```",
            "```",
            "```"
        ],
        [
            "```",
            "Router# traceroute mac 0000.0201.0601 0100.0201.0201",
            "```",
            "```",
            "```",
            "```",
            "Invalid destination mac address",
            "```",
            "```",
            "Router#",
            "```",
            "```",
            "```"
        ],
        [
            "```",
            "Router# traceroute mac 0000.0201.0601 0000.0201.0201",
            "```",
            "```",
            "```",
            "```",
            "Error:Mac found on multiple vlans.",
            "```",
            "```",
            "Layer2 trace aborted.",
            "```",
            "```",
            "Router#",
            "```",
            "```",
            "```"
        ],
        [
            "```",
            "Router# traceroute mac interface fastethernet0/1 0000.0201.0601 interface fastethernet0/3",
            "0000.0201.0201",
            "```",
            "```",
            "```",
            "```",
            "Source 1000.0201.0601 found on con6 [ WS-C6509 ] (10.2.6.6)",
            "```",
            "```",
            "con6 (10.2.6.6) :Fa0/1 =>Fa0/3",
            "```",
            "```",
            "con5 (10.2.5.5 ) : Fa0/3 =>Gi0/1",
            "```",
            "```",
            "con1 (10.2.1.1 ) : Gi0/1 =>Gi0/2",
            "```",
            "```",
            "con2 (10.2.2.2 ) : Gi0/2 =>Fa0/1",
            "```",
            "```",
            "Destination 1000.0201.0201 found on con2 [ WS-C6509 ] (10.2.2.2)",
            "```",
            "```",
            "Layer 2 trace completed",
            "```",
            "```",
            "Router#",
            "```",
            "```",
            "```"
        ],
        [
            "```",
            "Router# traceroute mac ip 10.2.66.66 10.2.22.22 detail",
            "```",
            "```",
            "```",
            "```",
            "Translating IP to mac.....",
            "```",
            "```",
            "10.2.66.66 =>0000.0201.0601",
            "```",
            "```",
            "10.2.22.22 =>0000.0201.0201",
            "```",
            "```",
            "```",
            "```",
            "Source 0000.0201.0601 found on con6 [ WS-C6509 ] (10.2.6.6)",
            "```",
            "```",
            "con6 / WS-C6509 / 10.2.6.6 :",
            "```",
            "```",
            "Fa0/1 [ auto, auto ] =>Fa0/3 [ auto, auto ]",
            "```",
            "```",
            "con5 / WS-C6509 / 10.2.5.5 :",
            "```",
            "```",
            "Fa0/3 [ auto, auto ] =>Gi0/1 [ auto, auto ]",
            "```",
            "```",
            "con1 / WS-C6509 / 10.2.1.1 :",
            "```",
            "```",
            "Gi0/1 [ auto, auto ] =>Gi0/2 [ auto, auto ]",
            "```",
            "```",
            "con2 / WS-C6509 / 10.2.2.2 :",
            "```",
            "```",
            "Gi0/2 [ auto, auto ] =>Fa0/1 [ auto, auto ]",
            "```",
            "```",
            "Destination 0000.0201.0201 found on con2 [ WS-C6509 ] (10.2.2.2)",
            "```",
            "```",
            "Layer 2 trace completed.",
            "```",
            "```",
            "Router#",
            "```",
            "```",
            "```"
        ],
        [
            "```",
            "Router# traceroute mac ip con6 con2",
            "```",
            "```",
            "```",
            "```",
            "Translating IP to mac .....",
            "```",
            "```",
            "10.2.66.66 =>0000.0201.0601",
            "```",
            "```",
            "10.2.22.22 =>0000.0201.0201",
            "```",
            "```",
            "```",
            "```",
            "Source 0000.0201.0601 found on con6",
            "```",
            "```",
            "con6 (10.2.6.6) :Fa0/1 =>Fa0/3",
            "```",
            "```",
            "con5 (10.2.5.5 ) : Fa0/3 =>Gi0/1",
            "```",
            "```",
            "con1 (10.2.1.1 ) : Gi0/1 =>Gi0/2",
            "```",
            "```",
            "con2 (10.2.2.2 ) : Gi0/2 =>Fa0/1",
            "```",
            "```",
            "Destination 0000.0201.0201 found on con2",
            "```",
            "```",
            "Layer 2 trace completed",
            "```",
            "```",
            "Router#",
            "```",
            "```",
            "```"
        ],
        [
            "```",
            "Router# traceroute mac ip 10.2.66.66 10.2.77.77",
            "```",
            "```",
            "```",
            "```",
            "Arp failed for destination 10.2.77.77.",
            "```",
            "```",
            "Layer2 trace aborted.",
            "```",
            "```",
            "Router#",
            "```"
        ]
    ],
    "ExtraInfo": "This command is not supported on the Cisco 7600 series router that is configured with a Supervisor Engine 2.Do not use leading zeros when entering a VLAN ID.For Layer 2 traceroute to functional properly, you must enable CDP on all of the switches in the network. Do not disable CDP.When the switch detects a device in the Layer 2 path that does not support Layer 2 traceroute, the switch continues to send Layer 2 trace queries and lets them time out.The maximum number of hops identified in the path is ten.Layer 2 traceroute supports only unicast traffic. If you specify a multicast source or destination MAC address, the physical path is not identified, and a message appears.The **traceroute mac** command output shows the Layer 2 path when the specified source and destination addresses belong to the same VLAN. If you specify source and destination addresses that belong to different VLANs, the Layer 2 path is not identified, and a message appears.If the source or destination MAC address belongs to multiple VLANs, you must specify the VLAN to which both the source and destination MAC addresses belong. If the VLAN is not specified, the path is not identified, and a message appears.When multiple devices are attached to one port through hubs (for example, multiple CDP neighbors are detected on a port), the Layer 2 traceroute utility terminates at that hop and displays an error message.This feature is not supported in Token Ring VLANs.",
    "RelatedCmds": []
}