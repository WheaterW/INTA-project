Establishing BFD for Eth-Trunk Member Links
===========================================

BFD for link-bundle sessions are used to detect faults on Eth-Trunk member links.

#### Context

Two routing devices are connected through an Eth-Trunk that has multiple member interfaces. To detect faults on the Eth-Trunk link between the two devices, you can configure a BFD for link-bundle session or multicast BFD session.

* To quickly detect faults on a single Eth-Trunk member interface, you are advised to configure a multicast BFD session.
* To quickly detect Eth-Trunk link faults, you are advised to configure a BFD for link-bundle session.

When a multicast BFD session is bound to an Eth-Trunk interface, only one BFD session is created. After the BFD session is created, BFD selects the board on which a member interface resides as a state machine board and monitors the member interface. If the member interface, member link, or the state machine board fails, the BFD session considers the entire Eth-Trunk interface to have failed. However, the other Eth-Trunk member interfaces are actually still available, and the Eth-Trunk interface is still up.

BFD for link-bundle resolves this problem. After a BFD for link-bundle session is bound to an Eth-Trunk interface, if the status of an Eth-Trunk member interface flaps, the status of the entire Eth-Trunk interface does not flap.

A BFD for link-bundle session consists of one main session and several sub-sessions. The number of sub-sessions is determined by the number of member interfaces of an Eth-Trunk interface bound to the BFD for link-bundle session. You do not need to configure local or remote discriminators for the main session and sub-sessions. Sub-sessions are dynamic single-hop sessions and their discriminators are determined by devices on both ends through negotiation. The main session collects the detection status of sub-sessions and determines the status of the Eth-Trunk interface. The main session does not participate in link fault detection. Main session discriminators are generated by the local system and are used for session management only.


#### Procedure

* Configure a BFD for link-bundle session to detect IPv4 Eth-Trunk faults.
  1. Run [**system-view**](cmdqueryname=system-view)
     
     
     
     The system view is displayed.
  2. Run [**bfd**](cmdqueryname=bfd) *session-name* **bind** **link-bundle** [ **compatible-mode** ] **peer-ip** *ip-address* [ **vpn-instance** *vpn-name* ] **interface** { *interface-name* | *interface-type* *interface-number* } **source-ip** *ip-address* [ **unshared-mode** ]
     
     
     
     A BFD for link-bundle session is created.
     
     
     
     ![](../../../../public_sys-resources/note_3.0-en-us.png) 
     
     A BFD for link-bundle session can be created in shared or unshared mode.
     
     + If **unshared-mode** is specified, a BFD for link-bundle session works in unshared mode. In this mode, a BFD for link-bundle session for detecting faults on a link is independent of a dynamic BFD session for detecting faults on the link.
     + If **unshared-mode** is not specified, a BFD for link-bundle session works in shared mode. In this mode, a BFD for link-bundle session for detecting faults on a link is dependent of a dynamic BFD session for detecting faults on the link.
  3. Run [**commit**](cmdqueryname=commit)
     
     
     
     The configuration is committed.
* Configure a BFD for link-bundle session to detect IPv6 Eth-Trunk faults.
  1. Run [**system-view**](cmdqueryname=system-view)
     
     
     
     The system view is displayed.
  2. Run [**bfd**](cmdqueryname=bfd) *session-name* **bind** **link-bundle** [ **compatible-mode** ] **peer-ipv6** *ipv6-address* [ **vpn-instance** *vpn-name* ] **interface** { *interface-name* |*interface-type* *interface-number* } **source-ipv6** *ipv6-address* [ **unshared-mode** ]
     
     
     
     A BFD for link-bundle session is created.
     
     
     
     ![](../../../../public_sys-resources/note_3.0-en-us.png) 
     
     A BFD for link-bundle session can be created in shared or unshared mode.
     
     + If **unshared-mode** is specified, a BFD for link-bundle session works in unshared mode. In this mode, a BFD for link-bundle session for detecting faults on a link is independent of a dynamic BFD session for detecting faults on the link.
     + If **unshared-mode** is not specified, a BFD for link-bundle session works in shared mode. In this mode, a BFD for link-bundle session for detecting faults on a link is dependent of a dynamic BFD session for detecting faults on the link.
  3. Run [**commit**](cmdqueryname=commit)
     
     
     
     The configuration is committed.
* Configure a multicast BFD session to detect IPv4 Eth-Trunk member link faults.
  1. Run [**system-view**](cmdqueryname=system-view)
     
     
     
     The system view is displayed.
  2. Run [**bfd**](cmdqueryname=bfd) **sessname-value****bind** **peer-ip** **default-ip** **interface** {*interface-name* |*interface-type* *interface-number* } [ **source-ip** *source-ip* ]
     
     
     
     A BFD session for IPv4 Eth-Trunk member interfaces is created.
  3. Run [**commit**](cmdqueryname=commit)
     
     
     
     The configuration is committed.