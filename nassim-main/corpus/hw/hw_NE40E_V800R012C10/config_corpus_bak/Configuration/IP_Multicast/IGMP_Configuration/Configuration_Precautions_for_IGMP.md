Configuration Precautions for IGMP
==================================

Configuration_Precautions_for_IGMP

#### Feature Requirements

**Table 1** Feature requirements
| Feature Requirements | Series | Models |
| --- | --- | --- |
| IGMP message transmit and receive ends must have the same Router-Alert option configuration on the same network segment. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| During the configuration, ensure that the interval for sending general query messages is greater than the maximum response time of Query messages but smaller than the keepalive time of other IGMP queriers. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| IGMPv1 does not support querier election. An IGMPv1 querier is designated by the upper-layer protocol, such as PIM. In this document version, querier election can be implemented only among multicast devices that run the same MLD version on a network segment. You must configure the same IGMP version on all multicast devices on the same network segment to ensure that the devices can work properly. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| When DNS-based IGMP SSM mapping is deployed on a router, a single multicast group can obtain a maximum of 10 multicast source addresses through the router's DNS. That is, for each domain name that the router uses the multicast group address and domain name suffix to form, when the router requests the host address of the domain name from the DNS server through the DNS client, the DNS server returns a maximum of 10 host addresses.  If the number of host addresses of the same domain name configured on the DNS server exceeds 10, the router can return only 10 host addresses of the same domain name to the IGMP module. When users continuously join the multicast group, the router's DNS periodically requests the domain name's host address from the DNS server. As a result, the host addresses of the same multicast group returned by the router to the IGMP module may be different. In this case, IGMP flaps and users cannot receive multicast traffic. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| If the igmp enable command is run on the interface connected to the user, PIM also needs to be enabled. Otherwise, multicast traffic cannot be forwarded.  You are advised to deploy PIM on the interface where IGMP is deployed. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| 1, In a scenario where IGMP dual-device hot backup is configured for routers and E-Trunk uses the direct link between the master and backup routers to send protocol packets, if the direct link is faulty, the E-Trunk enters the dual-active state, and the downstream switch receives two copies of the same multicast flow, slowing down convergence. In special scenarios, multicast traffic cannot be automatically restored.  Multicast flows are changed from two copies to one copy in either of the following scenarios:  a, If the direct link between the master and backup routers recovers or E-Trunk packets can be transmitted along another path, the E-Trunk state is restored to single-active, and multicast flows are changed from two copies to one copy. This restoration process may take several minutes.  b, If the fault of the direct link between the master and backup routers persists and no other path is available for transmitting E-Trunk packets, the E-Trunk protocol state remains dual-active. As the downstream switch sends an IGMP Join message to only one of the routers, the entries on the multicast outbound interface of the router that does not receive the IGMP Join message age. In this situation, the router stops sending multicast flows to the downstream switch. Therefore, multicast flows are changed from two copies to one copy. By default, this restoration process takes 125 seconds.  2, In a scenario where IGMP dual-device hot backup is configured for routers, the direct link between the master and backup routers is used to send mVRRP packets, and a service VRRP backup group is enabled to track the mVRRP backup group that is configured to ignore the interface Down event, a fault of the direct link causes VRRP to enter the dual-active state. As the downstream switch sends IGMP Join messages to both routers, two copies of the same multicast flow are continuously transmitted until the fault of the direct link is rectified or configuration is manually performed to rectify the fault.  It is recommended that the master and backup routers not be connected through a direct link in a VRRP scenario. If the master and backup routers are connected through a direct link, it is recommended that inter-board Eth-Trunk be deployed for the link to reduce the possibility that faults of the direct link are considered as device faults. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| If you run the igmp enable command on the interface connected to a user host, you must enable PIM on the interface. Otherwise, multicast traffic cannot be forwarded.  Deploying PIM on IGMP-enabled interfaces is recommended. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |