Configuring FADs
================

After a Flex-Algo is defined by a user based on service requirements, the IGP can use this Flex-Algo to calculate paths that meet the requirements.

#### Context

You can select one or two devices in the same IGP domain to configure flexible algorithm definitions (FADs). To improve reliability, you are advised to select two devices. A FAD is generally represented by a 3-tuple: Metric-Type, Calc-Type, and Constraints.

Because each user can individually define their Flex-Algos, the same Flex-Algo running on devices in the same IGP domain may have different FADs. To ensure that the path calculated using a specific Flex-Algo is loop-free, one FAD must be preferentially selected and advertised in the domain.

The detailed selection rules are as follows:

1. In the advertisement domain of FADs, the FAD with the highest priority is preferred.
2. If the FADs advertised in an IS-IS domain have the same priority, the FAD generated by the device with the largest system ID is preferred.

#### Procedure

1. Run [**system-view**](cmdqueryname=system-view)
   
   
   
   The system view is displayed.
2. Run [**flex-algo identifier**](cmdqueryname=flex-algo+identifier)*flexAlgoId*
   
   
   
   A Flex-Algo is created, and the Flex-Algo view is displayed.
3. Run [**priority**](cmdqueryname=priority)*priority-value*
   
   
   
   The priority of the Flex-Algo is configured.
   
   
   
   A larger value indicates a higher priority.
4. Run [**metric-type**](cmdqueryname=metric-type) { **igp** | **delay** | **te** }
   
   
   
   The Metric-Type of the Flex-Algo is configured.
   
   
   
   After this command is configured, links must have the corresponding metric type. Otherwise, these links will be pruned and cannot participate in IGP path calculation.
5. Run [**affinity**](cmdqueryname=affinity) { **include-all** | **include-any** | **exclude** } { *name-string* } &<1-32>
   
   
   
   The affinity attribute of the Flex-Algo is configured.
   
   A FAD can constrain a path to include or exclude a link with a specific affinity attribute. The following three types of affinity attributes are defined for FADs:
   
   * Include-All Admin Group (**include-all**): A link is included in path calculation only if each link administrative group bit has the same name as the corresponding affinity bit.
   * Include-Any Admin Group (**include-any**): A link is included in path calculation if at least one link administrative group bit has the same name as an affinity bit.
   * Exclude Admin Group (**exclude**): A link is excluded from path calculation if any link administrative group bit has the same name as an affinity bit.
6. Run [**commit**](cmdqueryname=commit)
   
   
   
   The configuration is committed.