
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Eth-Trunk Sub-interfaces to Support Communication Between VLANs">
<meta name="abstract" content="This example is applicable to the communication between users on different network segments and in different VLANs. In addition, the configuration in this example improves the bandwidth and therefore ensures the communication quality between users.">
<meta name="description" content="This example is applicable to the communication between users on different network segments and in different VLANs. In addition, the configuration in this example improves the bandwidth and therefore ensures the communication quality between users.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ethtrunk_cfg_0060.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ethtrunk_cfg_0064.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ethtrunk_cfg_0066.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Eth-Trunk">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Eth-Trunk">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="Eth-Trunk">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="Eth-Trunk">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wwx1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172362936">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Eth-Trunk Sub-interfaces to Support Communication Between VLANs</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172362936"></a><a name="EN-US_TASK_0172362936"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Eth-Trunk Sub-interfaces to Support Communication Between VLANs</h1>
<div class="taskbody"><p>This example is applicable to the communication between users on different network segments and in different VLANs. In addition, the configuration in this example improves the bandwidth and therefore ensures the communication quality between users.</p>
<div class="context"><a name="EN-US_TASK_0172362936__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>Users in different communities and on different network segments require the same services, such as Internet, IPTV, and VoIP services. The network administrator in each community configures a VLAN for each service to simplify management. After the configuration, users in different communities belong to different VLANs, but the users need to communicate with each other for the same services. In addition, traffic load balancing must be implemented and link bandwidth improved to ensure communication quality.</p>
<p>On the network shown in <a href="#EN-US_TASK_0172362936__fig_dc_vrp_ethtrunk_cfg_002401">Figure 1</a>, users in communities 1 and 2 belong to different VLANs and network segments but all require the Internet service. These users must be able to communicate with each other.</p>
<div class="fignone" id="EN-US_TASK_0172362936__fig_dc_vrp_ethtrunk_cfg_002401"><a name="EN-US_TASK_0172362936__fig_dc_vrp_ethtrunk_cfg_002401"></a><a name="fig_dc_vrp_ethtrunk_cfg_002401"></a><span class="figcap"><b>Figure 1 </b>Networking for configuring Eth-Trunk sub-interfaces to support communication between VLANs</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 and interface2 represent GE<span>0/1/1</span> and GE<span>0/2/1</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0257440148.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362936__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><ul><li><p>The host IP addresses in VLAN 10 and the IP address of Eth-Trunk1.2 must be on the same network segment.</p>
</li><li><p>The host IP addresses in VLAN 20 and the IP address of Eth-Trunk1.1 must be on the same network segment.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362936__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Create an Eth-Trunk sub-interface on each PE and assign an IP address to the sub-interface for Layer 3 routability.</p>
</li><li><p>Configure 802.1Q as the encapsulation mode for each Eth-Trunk sub-interface and associate each sub-interface with a VLAN, so that Eth-Trunk sub-interfaces can provide access services for users in different VLANs.</p>
</li><li><p>Verify the configuration. </p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362936__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IDs of Eth-Trunk interfaces and their member interfaces on the PE</p>
</li><li><p>Associated VLAN IDs and IP addresses of Eth-Trunk sub-interfaces on the PE</p>
</li><li><p>IDs of Eth-Trunk interfaces and their member interfaces on the switch</p>
</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>For details about how to configure the switch, see the related switch configuration guide.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172362936__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Create Eth-Trunk sub-interfaces and assign IP addresses to them.</span><p><p># Configure the PE.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>]<strong> sysname PE</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong></pre>
<p># Create Eth-Trunk1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE]<strong> interface eth-trunk 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Eth-Trunk1]<strong> quit</strong></pre>
<p># Add GE<span>0/1/1</span> and GE<span>0/2/1</span> to Eth-Trunk1.</p>
<pre class="screen">[<span class="keyword">*</span>PE]<strong> interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>]<strong> eth-trunk 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE]<strong> interface gigabitethernet <span>0/2/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/2/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/2/1</span>]<strong> eth-trunk 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/2/1</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/2/1</span>]<strong> quit</strong></pre>
<p># Create Eth-Trunk1.1 and assign an IP address to it.</p>
<pre class="screen">[<span class="keyword">*</span>PE]<strong> interface eth-trunk 1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Eth-Trunk1.1]<strong> ip address 10.110.1.10 24</strong></pre>
<p># Create Eth-Trunk1.2 and assign an IP address to it.</p>
<pre class="screen">[<span class="keyword">*</span>PE]<strong> interface eth-trunk 1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Eth-Trunk1.2]<strong> ip address 10.110.2.10 24</strong></pre>
</p></li><li><span>Configure an encapsulation mode for each Eth-Trunk sub-interface and associate the sub-interfaces with VLANs.</span><p><p># Encapsulate Eth-Trunk1.1 with 802.1Q and associate it with VLAN 20.</p>
<pre class="screen">[<span class="keyword">*</span>PE-Eth-Trunk1.1]<strong> vlan-type dot1q 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Eth-Trunk1.1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE-Eth-Trunk1.1]<strong> quit</strong></pre>
<p># Encapsulate Eth-Trunk1.2 with 802.1Q and associate it with VLAN 10.</p>
<pre class="screen">[<span class="keyword">*</span>PE-Eth-Trunk1.2]<strong> vlan-type dot1q 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Eth-Trunk1.2]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE-Eth-Trunk1.2] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>Assign IP addresses on the same network segment as the IP address of Eth-Trunk1.2 to the hosts in VLAN 10, and set the default gateway address to 10.110.2.10/24, which is the IP address of Eth-Trunk1.2.</p>
<p>Assign IP addresses on the same network segment as the IP address of Eth-Trunk1.1 to the hosts in VLAN 20, and set the default gateway address to 10.110.1.10/24, which is the IP address of Eth-Trunk1.1.</p>
<p>After the configuration, the hosts in VLAN 10 and VLAN 20 can ping each other successfully.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172362936__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">PE configuration file</h4><pre class="screen">#
sysname PE
#
interface Eth-Trunk1
 #
interface Eth-Trunk1.1
 vlan-type dot1q 20
 ip address 10.110.1.10 255.255.255.0
#
interface Eth-Trunk1.2
 vlan-type dot1q 10
 ip address 10.110.2.10 255.255.255.0
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 eth-trunk 1
#
interface GigabitEthernet<span>0/2/1</span>
 undo shutdown
 eth-trunk 1
#
return</pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ethtrunk_cfg_0060.html">Configuration Examples for Eth-Trunk Interfaces
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ethtrunk_cfg_0064.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ethtrunk_cfg_0066.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>