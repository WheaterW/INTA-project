
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Inter-VLAN Communication by Using Sub-interfaces">
<meta name="abstract" content="Configuring sub-interfaces enables users in different VLANs and network segments to communicate with each other.">
<meta name="description" content="Configuring sub-interfaces enables users in different VLANs and network segments to communicate with each other.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vlan_cfg_0033.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vlan_cfg_0035.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vlan_cfg_0037.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wWX1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172363174">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Inter-VLAN Communication by Using Sub-interfaces</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172363174"></a><a name="EN-US_TASK_0172363174"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Inter-VLAN Communication by Using Sub-interfaces</h1>
<div class="taskbody"><p>Configuring sub-interfaces enables users in different VLANs and network segments to communicate with each other.</p>
<div class="context"><a name="EN-US_TASK_0172363174__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0172363174__p_2">Users in different residential compounds in different network segments require various services such as Internet, IPTV, and VoIP services. The network administrator of each residential compound configures a VLAN for each service to simplify management. After the configuration, users in different residential compounds belong to different VLANs, but they need to communicate with each other for the same type of service.</p>
<p>On the network shown in <a href="#EN-US_TASK_0172363174__fig_dc_vrp_vlan_cfg_003601">Figure 1</a>, users in residential compounds 1 to 4 belong to different VLANs and network segments but all require the Internet access service. Therefore, communication between these users is required.</p>
<div class="fignone" id="EN-US_TASK_0172363174__fig_dc_vrp_vlan_cfg_003601"><a name="EN-US_TASK_0172363174__fig_dc_vrp_vlan_cfg_003601"></a><a name="fig_dc_vrp_vlan_cfg_003601"></a><span class="figcap"><b>Figure 1 </b>Configuring inter-VLAN communication using sub-interfaces</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1, interface2, interface3, subinterface1.1, subinterface1.2, subinterface2.1, and subinterface2.2 represent GE<span>0/1/1</span>, GE<span>0/1/2</span>, GE<span>0/1/3</span>, GE<span>0/1/1</span>.1, GE<span>0/1/1</span>.2, GE<span>0/1/2</span>.1, and GE<span>0/1/2</span>.2, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001367225853.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363174__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li id="EN-US_TASK_0172363174__li_1">Create VLANs on the CEs and determine the VLANs to which users belong.</li><li id="EN-US_TASK_0172363174__li_2">Configure trunk ports on CEs to allow frames with certain VLAN IDs to pass through.</li><li>Create sub-interfaces on PE and associate the sub-interfaces with VLANs.</li><li>Assign an IP address to each sub-interface for communication at the network layer.</li></ol>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The default gateway address of each PC in a VLAN must be the IP address of the corresponding sub-interface. Otherwise, inter-VLAN communication fails.</p>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363174__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><div class="p" id="EN-US_TASK_0172363174__p_1">To complete the configuration, you need the following data:<ul id="EN-US_TASK_0172363174__ul537133836214028"><li id="EN-US_TASK_0172363174__li_3">User VLAN ID</li><li id="EN-US_TASK_0172363174__li_4">User IP address</li><li id="EN-US_TASK_0172363174__li_5">Number of each port connecting a CE to a PC</li><li id="EN-US_TASK_0172363174__li2139103013214028">Number of each port connecting a CE to the PE</li><li id="EN-US_TASK_0172363174__li743526162214028">Number and IP address of each sub-interface on PE</li></ul>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172363174__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li id="EN-US_TASK_0172363174__step_1"><span id="EN-US_TASK_0172363174__cmd2011590534214028">Create VLANs on CE1 and CE2.</span><p><p id="EN-US_TASK_0172363174__p1707382211214028"># Configure CE1.</p>
<pre class="screen" id="EN-US_TASK_0172363174__screen1180963026214028">&lt;<span class="keyword" id="EN-US_TASK_0172363174__keyword1675197152214312">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172363174__b1668942795214312">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen690777200214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword213546159214312"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363174__keyword625120176214312">HUAWEI</span>] <strong id="EN-US_TASK_0172363174__b589928349214312">sysname CE1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen566328644214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword202363037214312">*</span><span class="keyword" id="EN-US_TASK_0172363174__keyword1648949658214312">HUAWEI</span>] <strong id="EN-US_TASK_0172363174__b1659468912214312">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1520956025214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword884039251214312"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong id="EN-US_TASK_0172363174__b1521022650214312">vlan batch 30 40</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1449136229214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword174063067214312">*</span>CE1] <strong id="EN-US_TASK_0172363174__b1783690793214312">interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1580145697214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword395419138214312">*</span>CE1-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363174__b1736791571214312"> portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen439369799214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword349362817214312">*</span>CE1-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363174__b228058192214312"> undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen426544384214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1818968743214312">*</span>CE1-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363174__b2022029203214312"> port link-type access</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1022055148214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1522602454214312">*</span>CE1-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363174__b846253780214312"> port default vlan 30</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1440591778214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1798984911214312">*</span>CE1-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363174__b1628747536214312"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1062571021214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword550599704214312">*</span>CE1] <strong id="EN-US_TASK_0172363174__b464805747214312">interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1897472909214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1637434079214312">*</span>CE1-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363174__b750119650214312"> portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen286883479214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword925289728214312">*</span>CE1-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363174__b1749367039214312"> undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1601020625214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword472196981214312">*</span>CE1-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363174__b1351850569214312"> port link-type access</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen624840539214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1745131075214312">*</span>CE1-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363174__b1658847091214312"> port default vlan 40</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1280078077214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword274835139214312">*</span>CE1-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363174__b1631120178214312"> quit</strong></pre>
<p id="EN-US_TASK_0172363174__p669901479214028"># Configure CE2.</p>
<pre class="screen" id="EN-US_TASK_0172363174__screen1764148645214028">&lt;<span class="keyword" id="EN-US_TASK_0172363174__keyword2100689754214312">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172363174__b865382416214312">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen2038672215214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword564000655214312"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363174__keyword166190727214312">HUAWEI</span>] <strong id="EN-US_TASK_0172363174__b1373283103214312">sysname CE2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen2022524463214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword771362802214312">*</span><span class="keyword" id="EN-US_TASK_0172363174__keyword2083319922214312">HUAWEI</span>] <strong id="EN-US_TASK_0172363174__b1147773360214312">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen314057983214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword2109302786214312"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2] <strong id="EN-US_TASK_0172363174__b2136012480214312">vlan batch 10 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen896620016214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1593720805214312">*</span>CE2] <strong id="EN-US_TASK_0172363174__b1304481122214312">interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1165968536214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1340602919214312">*</span>CE2-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363174__b1409417567214312"> portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen148194308214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword85420295214312">*</span>CE2-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363174__b1225547347214312"> undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen2022750182214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword816007882214312">*</span>CE2-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363174__b1567393422214312"> port link-type access</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1285850133214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1666976923214312">*</span>CE2-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363174__b1390056639214312"> port default vlan 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1018197732214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1843435442214312">*</span>CE2-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363174__b1429498360214312"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen107684491214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword855459563214312">*</span>CE2] <strong id="EN-US_TASK_0172363174__b1638400261214312">interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1184009279214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1778861670214312">*</span>CE2-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363174__b1329436927214312"> portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen2056854381214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword2045381579214312">*</span>CE2-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363174__b90501425214312"> undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen2140883216214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1107049620214312">*</span>CE2-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363174__b555778222214312"> port link-type access</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen596949182214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1804917238214312">*</span>CE2-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363174__b686352341214312"> port default vlan 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen908824957214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1601203001214312">*</span>CE2-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363174__b1384854009214312"> quit</strong></pre>
</p></li><li id="EN-US_TASK_0172363174__step_2"><span id="EN-US_TASK_0172363174__cmd180672507214028">Configure trunk ports on CE 1 and CE 2 to allow frames with certain VLAN IDs to pass through.</span><p><p id="EN-US_TASK_0172363174__p366125163214028"># Configure CE1.</p>
<pre class="screen" id="EN-US_TASK_0172363174__screen267525369214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1940856998214312">*</span>CE1] <strong id="EN-US_TASK_0172363174__b1329519210214312">interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen670538420214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1284430728214312">*</span>CE1-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363174__b1811900690214312"> portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1380037282214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1075220990214312">*</span>CE1-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363174__b1954986964214312"> undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1530413750214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword2034147196214312">*</span>CE1-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363174__b1711790255214312"> port link-type trunk</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen182820141214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword603496368214312">*</span>CE1-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363174__b1714814008214312"> port trunk allow-pass vlan 30 40</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen553602277214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword2133264774214312">*</span>CE1-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363174__b48849302214312"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen71428915214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1732307230214312">*</span>CE1]<strong id="EN-US_TASK_0172363174__b898969203214312"> commit</strong></pre>
<p id="EN-US_TASK_0172363174__p233427881214028"># Configure CE2.</p>
<pre class="screen" id="EN-US_TASK_0172363174__screen338628580214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword478656661214312">*</span>CE2] <strong id="EN-US_TASK_0172363174__b1004879203214312">interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1257043323214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1965489538214312">*</span>CE2-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363174__b1928138359214312"> portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1201744321214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1550511158214312">*</span>CE2-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363174__b355365855214312"> undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen480553592214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword594507978214312">*</span>CE2-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363174__b1158015710214312"> port link-type trunk</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen371801710214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword345587654214312">*</span>CE2-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363174__b210915851214312"> port trunk allow-pass vlan 10 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1267674266214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword1902448404214312">*</span>CE2-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363174__b1013946315214312"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1437405391214028">[<span class="keyword" id="EN-US_TASK_0172363174__keyword296449953214312">*</span>CE2]<strong id="EN-US_TASK_0172363174__b242162260214312"> commit</strong></pre>
</p></li><li><span>Create sub-interfaces on PE and associate the sub-interfaces with VLANs.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE]<strong> interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE]<strong> interface gigabitethernet <span>0/1/1</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>.1]<strong> vlan-type dot1q 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE] <strong>interface gigabitethernet <span>0/1/1</span>.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>.2] <strong>vlan-type dot1q 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>.2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE]<strong> interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/2</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/2</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE]<strong> interface gigabitethernet <span>0/1/2</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/2</span>.1] <strong>vlan-type dot1q 30</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/2</span>.1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE] <strong>interface gigabitethernet <span>0/1/2</span>.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/2</span>.2] <strong>vlan-type dot1q 40</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/2</span>.2]<strong> quit</strong></pre>
</p></li><li><span>Configure IP addresses.</span><p><pre class="screen">[<span class="keyword">*</span>PE]<strong> interface gigabitethernet <span>0/1/1</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>.1]<strong> ip address 10.110.6.3 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE] <strong>interface gigabitethernet <span>0/1/1</span>.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>.2] <strong>ip address 10.110.5.3 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>.2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE]<strong> interface gigabitethernet <span>0/1/2</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/2</span>.1]<strong> ip address 10.110.4.3 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/2</span>.1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE] <strong>interface gigabitethernet <span>0/1/2</span>.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/2</span>.2] <strong>ip address 10.110.3.3 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/2</span>.2]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>On PCs in VLAN 10, configure the IP address 10.110.6.3/24 of GE <span>0/1/1</span>.1 as the default gateway address.</p>
<p>On PCs in VLAN 20, configure the IP address 10.110.5.3/24 of GE <span>0/1/1</span>.2 as the default gateway address.</p>
<p>On PCs in VLAN 30, configure the IP address 10.110.4.3/24 of GE <span>0/1/2</span>.1 as the default gateway address.</p>
<p>On PCs in VLAN 40, configure the IP address 10.110.3.3/24 of GE<span>0/1/2</span>.2 as the default gateway address.</p>
<p id="EN-US_TASK_0172363174__p_3">After the configurations, PCs in VLANs 10, 20, 30, and 40 can ping each other successfully.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172363174__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li id="EN-US_TASK_0172363174__li_6"><p id="EN-US_TASK_0172363174__p1595543417214028"><a name="EN-US_TASK_0172363174__li_6"></a><a name="li_6"></a>Configuration file of CE1</p>
<pre class="screen" id="EN-US_TASK_0172363174__screen2058512436214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1496025280214028"> sysname CE1</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen724691888214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen70470016214028"> vlan batch 30 40</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen75276894214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen290012474214028">interface GigabitEthernet<span>0/1/1</span></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1841142306214028"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1262824652214028"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1152648181214028"> port link-type access</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen506771645214028"> port default vlan 30</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen594796818214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1791674403214028">interface GigabitEthernet<span>0/1/2</span></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1413333113818"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen242752413381"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1439788034214028"> port link-type access</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen831844615214028"> port default vlan 40</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1580341135214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen879525296214028">interface GigabitEthernet<span>0/1/3</span></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1330917533819"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen61241627113820"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen2689314214028"> port link-type trunk</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen891597524214028"> port trunk allow-pass vlan 30 40</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen474343874214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen11211458214028">return</pre>
</li><li id="EN-US_TASK_0172363174__li_7"><p id="EN-US_TASK_0172363174__p1483383372214028"><a name="EN-US_TASK_0172363174__li_7"></a><a name="li_7"></a>Configuration file of CE2</p>
<pre class="screen" id="EN-US_TASK_0172363174__screen1548832979214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen560173363214028"> sysname CE2</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen312972032214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1803783712214028"> vlan batch 10 20</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1643147095214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1009680357214028">interface GigabitEthernet<span>0/1/1</span></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen48852973819"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen17268153023812"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1920645680214028"> port link-type access</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1189550172214028"> port default vlan 10</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen1095652522214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen681529255214028">interface GigabitEthernet<span>0/1/2</span></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen645261173814"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen842743313384"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen516297266214028"> port link-type access</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen846117034214028"> port default vlan 20</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen349215605214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen572900589214028">interface GigabitEthernet<span>0/1/3</span></pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen12507181419386"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen96925362381"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen727047880214028"> port link-type trunk</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen20139430214028"> port trunk allow-pass vlan 10 20</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen164634958214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363174__screen486110996214028">return</pre>
</li><li><p>Configuration file of PE</p>
<pre class="screen">#</pre>
<pre class="screen"> sysname PE</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/1</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/1</span>.1</pre>
<pre class="screen"> vlan-type dot1q 10</pre>
<pre class="screen"> ip address 10.110.6.3 255.255.255.0</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/1</span>.2</pre>
<pre class="screen"> vlan-type dot1q 20</pre>
<pre class="screen"> ip address 10.110.5.3 255.255.255.0</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/2</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/2</span>.1</pre>
<pre class="screen"> vlan-type dot1q 30</pre>
<pre class="screen"> ip address 10.110.4.3 255.255.255.0</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/2</span>.2</pre>
<pre class="screen"> vlan-type dot1q 40</pre>
<pre class="screen"> ip address 10.110.3.3 255.255.255.0</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vlan_cfg_0033.html">Configuration Examples for VLANs
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vlan_cfg_0035.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vlan_cfg_0037.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>