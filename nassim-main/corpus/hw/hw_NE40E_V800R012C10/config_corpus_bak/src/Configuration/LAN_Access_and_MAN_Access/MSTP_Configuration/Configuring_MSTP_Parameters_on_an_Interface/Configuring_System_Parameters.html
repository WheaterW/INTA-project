
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring System Parameters">
<meta name="abstract" content="Multiple Spanning Tree Protocol (MSTP) parameters that may affect network convergence include the network diameter, hello time, and timeout period for waiting for Bridge Protocol Data Units (BPDUs) from the upstream (3 x hello time x time factor). Configure proper MSTP parameters to implement rapid network convergence.">
<meta name="description" content="Multiple Spanning Tree Protocol (MSTP) parameters that may affect network convergence include the network diameter, hello time, and timeout period for waiting for Bridge Protocol Data Units (BPDUs) from the upstream (3 x hello time x time factor). Configure proper MSTP parameters to implement rapid network convergence.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0021.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0024.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MSTP">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MSTP">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="MSTP">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="MSTP">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wwx1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172363632">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring System Parameters</title>
</head>
<body><a name="EN-US_TASK_0172363632"></a><a name="EN-US_TASK_0172363632"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring System Parameters</h1>
<div class="taskbody"><p>Multiple Spanning Tree Protocol (MSTP) parameters that may affect network convergence include the network diameter, hello time, and timeout period for waiting for Bridge Protocol Data Units (BPDUs) from the upstream (3 x hello time x time factor). Configure proper MSTP parameters to implement rapid network convergence.</p>
<div class="steps"><a name="EN-US_TASK_0172363632__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li id="EN-US_TASK_0172363632__stp_1"><span id="EN-US_TASK_0172363632__cmd208583899214313">Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172363632__cmdname447946339214313">system-view</span></b></a></span></span><p><p id="EN-US_TASK_0172363632__p1024298453214313">The system view is displayed.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=stp+process"><b><span class="cmdname">stp process</span></b></a> <i><span class="varname">process-id</span></i></span></span><p><p>The MSTP process view is displayed.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This step is needed only when you perform configuration in an MSTP process with a non-zero ID. If you perform configuration in MSTP process 0, skip this step.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=stp+bridge-diameter"><b><span class="cmdname" id="EN-US_TASK_0172363632__en-us_task_0172363549_cmdname1909702846214029">stp bridge-diameter</span></b></a> <i><span class="varname" id="EN-US_TASK_0172363632__en-us_task_0172363549_varname533868560214029">diameter</span></i></span><p><p id="EN-US_TASK_0172363632__en-us_task_0172363549_p161261578569">The network diameter is configured.</p>
</p><p><ul id="EN-US_TASK_0172363632__en-us_task_0172363549_ul1104193913214029"><li id="EN-US_TASK_0172363632__en-us_task_0172363549_li2141401409214029"><p id="EN-US_TASK_0172363632__en-us_task_0172363549_p855040990214029"><a name="EN-US_TASK_0172363632__en-us_task_0172363549_li2141401409214029"></a><a name="en-us_task_0172363549_li2141401409214029"></a>RSTP uses a single spanning tree instance on the entire network, which cannot prevent the performance from deteriorating when the network scale grows. Therefore, the network diameter cannot be larger than 7.</p>
</li><li id="EN-US_TASK_0172363632__en-us_task_0172363549_li1586797536214029"><p id="EN-US_TASK_0172363632__en-us_task_0172363549_p1854259106214029"><a name="EN-US_TASK_0172363632__en-us_task_0172363549_li1586797536214029"></a><a name="en-us_task_0172363549_li1586797536214029"></a>It is recommended that you run the <a href="cmdqueryname=stp+bridge-diameter"><b><span class="cmdname" id="EN-US_TASK_0172363632__en-us_task_0172363549_cmdname475489231214313">stp bridge-diameter</span></b></a> <i><span class="varname" id="EN-US_TASK_0172363632__en-us_task_0172363549_varname1267065992214313">diameter</span></i> command to set the network diameter. Then, the <span class="keyword" id="EN-US_TASK_0172363632__en-us_task_0172363549_keyword2137159014214029">device</span> calculates the optimal Forward Delay period, Hello time, and Max Age period based on the set network diameter.</p>
</li></ul>
</p></li><li><span>Run <a href="cmdqueryname=stp+timer-factor"><b><span class="cmdname" id="EN-US_TASK_0172363632__en-us_task_0172363549_cmdname2022254636214029">stp timer-factor</span></b></a> <i><span class="varname" id="EN-US_TASK_0172363632__en-us_task_0172363549_varname1707635273214029">factor</span></i></span><p><p id="EN-US_TASK_0172363632__en-us_task_0172363549_p109254145710">The timeout period for waiting for BPDUs from the upstream of a device is set.</p>
</p></li><li><span>(Optional) If the current device is at the edge of a network, run both or either of the following commands as needed:</span>
<p><ul id="EN-US_TASK_0172363632__en-us_task_0172363549_ul545553421214029"><li id="EN-US_TASK_0172363632__en-us_task_0172363549_li670610999214029"><p id="EN-US_TASK_0172363632__en-us_task_0172363549_p964880737214029"><a name="EN-US_TASK_0172363632__en-us_task_0172363549_li670610999214029"></a><a name="en-us_task_0172363549_li670610999214029"></a>To configure all ports on the devices as edge ports, run <a href="cmdqueryname=stp+edged-port+default"><b><span class="cmdname" id="EN-US_TASK_0172363632__en-us_task_0172363549_cmdname2076462294214029">stp edged-port default</span></b></a> command.</p>
<p id="EN-US_TASK_0172363632__en-us_task_0172363549_p2072140307214029">After ports on a network edge device are configured as edge ports, the ports no longer participate in spanning tree calculation. This speeds up network topology convergence and improves network stability.</p>
</li><li id="EN-US_TASK_0172363632__en-us_task_0172363549_li652942543214029"><p id="EN-US_TASK_0172363632__en-us_task_0172363549_p363884031214029"><a name="EN-US_TASK_0172363632__en-us_task_0172363549_li652942543214029"></a><a name="en-us_task_0172363549_li652942543214029"></a>To configure all ports on the devices as BPDU filter ports, run the <a href="cmdqueryname=stp+bpdu-filter+default"><b><span class="cmdname" id="EN-US_TASK_0172363632__en-us_task_0172363549_cmdname1242017219214029">stp bpdu-filter default</span></b></a> command.</p>
<p id="EN-US_TASK_0172363632__en-us_task_0172363549_p1256224616214029">After ports on a network edge device are configured as BPDU filter ports, the ports no longer process or send BPDUs.</p>
</li></ul>
<div class="caution" id="EN-US_TASK_0172363632__en-us_task_0172363549_note1550508733214029"><span class="cautiontitle"><img src="../../../../public_sys-resources/caution_3.0-en-us.png"> </span><div class="cautionbody"><p id="EN-US_TASK_0172363632__en-us_task_0172363549_p1833702833214029">After the <a href="cmdqueryname=stp+bpdu-filter+default"><b><span class="cmdname" id="EN-US_TASK_0172363632__en-us_task_0172363549_cmdname1642132959214029">stp bpdu-filter default</span></b></a> and <a href="cmdqueryname=stp+edged-port+default"><b><span class="cmdname" id="EN-US_TASK_0172363632__en-us_task_0172363549_cmdname1228958266214029">stp edged-port default</span></b></a> commands are run in the system view, all ports on the device no longer actively send BPDUs or negotiate with directly-connected ports; instead, all the ports are in the Forwarding state. This may lead to a loop on the network, causing broadcast storms. Exercise caution when running these commands.</p>
</div></div>
</p>
</li><li><span>(Optional) To set the Forward Delay period, Hello time, and Max Age period, perform the following operations:</span>
<p><ul id="EN-US_TASK_0172363632__en-us_task_0172363549_ul1370004274214029"><li id="EN-US_TASK_0172363632__en-us_task_0172363549_li2037198069214029"><p id="EN-US_TASK_0172363632__en-us_task_0172363549_p1856161562214029"><a name="EN-US_TASK_0172363632__en-us_task_0172363549_li2037198069214029"></a><a name="en-us_task_0172363549_li2037198069214029"></a>Run the <a href="cmdqueryname=stp+timer+forward-delay"><b><span class="cmdname" id="EN-US_TASK_0172363632__en-us_task_0172363549_cmdname648206196214029">stp timer forward-delay</span></b></a> <i><span class="varname" id="EN-US_TASK_0172363632__en-us_task_0172363549_varname327137539214313">forward-delay</span></i> command to set the Forward Delay period for a device.</p>
</li><li id="EN-US_TASK_0172363632__en-us_task_0172363549_li24309190214029"><p id="EN-US_TASK_0172363632__en-us_task_0172363549_p542663400214029"><a name="EN-US_TASK_0172363632__en-us_task_0172363549_li24309190214029"></a><a name="en-us_task_0172363549_li24309190214029"></a>Run the <a href="cmdqueryname=stp+timer+hello"><b><span class="cmdname" id="EN-US_TASK_0172363632__en-us_task_0172363549_cmdname734976879214029">stp timer hello</span></b></a> <i><span class="varname" id="EN-US_TASK_0172363632__en-us_task_0172363549_varname1448733264214313">hello-time</span></i> command to set the Hello time for a device.</p>
</li><li id="EN-US_TASK_0172363632__en-us_task_0172363549_li1380448016214029"><p id="EN-US_TASK_0172363632__en-us_task_0172363549_p1923966371214029"><a name="EN-US_TASK_0172363632__en-us_task_0172363549_li1380448016214029"></a><a name="en-us_task_0172363549_li1380448016214029"></a>Run the <a href="cmdqueryname=stp+timer+max-age"><b><span class="cmdname" id="EN-US_TASK_0172363632__en-us_task_0172363549_cmdname1939552219214029">stp timer max-age</span></b></a> <i><span class="varname" id="EN-US_TASK_0172363632__en-us_task_0172363549_varname174045488214313">max-age</span></i> command to set the Max Age period for a device.</p>
</li></ul>
<div class="note" id="EN-US_TASK_0172363632__en-us_task_0172363549_note2070907788214029"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172363632__en-us_task_0172363549_p1479725987214029">The values of the Hello time, Forward Delay period, and Max Age period must comply with the following formulas. Otherwise, networking flapping occurs.</p>
<ul id="EN-US_TASK_0172363632__en-us_task_0172363549_ul318055653214029"><li id="EN-US_TASK_0172363632__en-us_task_0172363549_li219151558214029"><p id="EN-US_TASK_0172363632__en-us_task_0172363549_p345780701214029"><a name="EN-US_TASK_0172363632__en-us_task_0172363549_li219151558214029"></a><a name="en-us_task_0172363549_li219151558214029"></a>2 Ã (Forward Delay - 1.0 second) &gt;= Max Age</p>
</li><li id="EN-US_TASK_0172363632__en-us_task_0172363549_li1765689614214029"><p id="EN-US_TASK_0172363632__en-us_task_0172363549_p2016308252214029"><a name="EN-US_TASK_0172363632__en-us_task_0172363549_li1765689614214029"></a><a name="en-us_task_0172363549_li1765689614214029"></a>Max Age &gt;= 2 Ã (Hello Time + 1.0 second)</p>
</li></ul>
</div></div>
</p>
</li><li><span>Run <a href="cmdqueryname=stp+max-hops"><b><span class="cmdname">stp max-hops</span></b></a> <i><span class="varname">hop</span></i></span><p><p>The maximum hop count is set for the MST region.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=stp+mcheck"><b><span class="cmdname">stp mcheck</span></b></a></span></span><p><p>The MCheck operation is performed.</p>
</p><p><p>On a device running MSTP, if an interface is connected to a device running STP, the interface automatically transitions to the STP mode.</p>
<p>Performing MCheck on the interface is required to manually switch the interface to the MSTP mode because the interface fails to automatically transition to the MSTP mode in the following situations:</p>
<ul><li><p>The device running STP is shut down or moved.</p>
</li><li><p>The device running STP transitions to the MSTP mode.</p>
</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If you run the <a href="cmdqueryname=stp+mcheck"><b><span class="cmdname">stp mcheck</span></b></a> command in the system view, the MCheck operation is performed on all the interfaces.</p>
</div></div>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0021.html">Configuring MSTP Parameters on an Interface
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0024.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>