
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Tunneling of Special Link-Layer-Protocol Packets over a VPLS PW">
<meta name="abstract" content="CE1 and CE2 are non-Huawei devices. Both CEs support the Cisco Discovery Protocol (CDP). To ensure that these CEs can work with NE40Es, you must establish a VPLS PW between PE1 and PE2. In this manner, CE1 and CE2 can transparently transmit CDP packets between each other over the PW and use CDP to discover each other.">
<meta name="description" content="CE1 and CE2 are non-Huawei devices. Both CEs support the Cisco Discovery Protocol (CDP). To ensure that these CEs can work with NE40Es, you must establish a VPLS PW between PE1 and PE2. In this manner, CE1 and CE2 can transparently transmit CDP packets between each other over the PW and use CDP to discover each other.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2bptnl_cfg_0017.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_vpws_cfg_5003.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Layer 2 Protocol Tunneling">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Layer 2 Protocol Tunneling">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="Layer 2 Protocol Tunneling">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="Layer 2 Protocol Tunneling">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wwx1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172363042">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring Tunneling of Special Link-Layer-Protocol Packets over a VPLS PW</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172363042"></a><a name="EN-US_TASK_0172363042"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Tunneling of Special Link-Layer-Protocol Packets over a VPLS PW</h1>
<div class="taskbody"><p>CE1 and CE2 are non-Huawei devices. Both CEs support the Cisco Discovery Protocol (CDP). To ensure that these CEs can work with <span class="keyword">NE40E</span>s, you must establish a VPLS PW between PE1 and PE2. In this manner, CE1 and CE2 can transparently transmit CDP packets between each other over the PW and use CDP to discover each other.</p>
<div class="context"><a name="EN-US_TASK_0172363042__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0172363042__fig_dc_ne_vpls_cfg_500301">Figure 1</a>, VPLS is enabled on PE1 and PE2. CE1 and CE2 are non-Huawei devices and connected to PE1 and PE2, respectively. The CEs belong to the same VPLS network. PWs are established with the Label Distribution Protocol (LDP) as the VPLS signaling protocol, and VPLS is configured for the CEs to communicate.</p>
<p>Both CEs support CDP. To ensure that these CEs can work with <span class="keyword">NE40E</span>s, you must use LDP as the signaling protocol to establish a VPLS PW between PE1 and PE2. In this manner, CE1 and CE2 can transparently transmit CDP packets between each other over the PW and use CDP to discover each other.</p>
<div class="fignone" id="EN-US_TASK_0172363042__fig_dc_ne_vpls_cfg_500301"><a name="EN-US_TASK_0172363042__fig_dc_ne_vpls_cfg_500301"></a><a name="fig_dc_ne_vpls_cfg_500301"></a><span class="figcap"><b>Figure 1 </b>Networking for tunneling of special link-layer-protocol packets over a VPLS PW</span><br><span><img class="vsd" src="images/fig_dc_ne_vpls_cfg_500301.png"></span><br></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" char="." valign="top" width="33.33333333333333%" id="mcps1.4.1.5.1.4.1.1" liSelected="liSelected"><p>Device Name</p>
</th>
<th align="left" class="cellrowborder" char="." valign="top" width="33.33333333333333%" id="mcps1.4.1.5.1.4.1.2" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" char="." valign="top" width="33.33333333333333%" id="mcps1.4.1.5.1.4.1.3" liSelected="liSelected"><p>IP Address</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.1 "><p>CE1</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.2 "><p>GE <span>0/1/0</span>.1</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.3 "><p>10.10.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.1 "><p>PE1</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.2 "><p>GE <span>0/1/0</span>.1</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.3 "><p>-</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.1 "><p>PE1</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.2 "><p>GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.3 "><p>10.1.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.1 "><p>PE1</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.2 "><p>Loopback 1</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.3 "><p>1.1.1.9/32</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.1 "><p>P</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.3 "><p>10.2.2.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.1 "><p>P</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.2 "><p>GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.3 "><p>10.1.1.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.1 "><p>P</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.2 "><p>Loopback 1</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.3 "><p>2.2.2.9/24</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.1 "><p>PE2</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.3 "><p>-</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.1 "><p>PE2</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.2 "><p>GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.3 "><p>10.2.2.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.1 "><p>PE2</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.2 "><p>Loopback 1</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.3 "><p>3.3.3.9/32</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.1 "><p>CE2</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.2 "><p>GE <span>0/1/0</span>.1</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.5.1.4.1.3 "><p>10.10.1.2/24</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363042__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure a routing protocol on the backbone network to achieve connectivity between devices.</p>
</li><li><p>Establish remote LDP sessions between PEs.</p>
</li><li><p>Establish a tunnel between PEs to transmit service data.</p>
</li><li><p>Enable MPLS L2VPN on PEs.</p>
</li><li><p>Create a VSI, configure LDP as the signaling protocol, and bind the VSI to an AC interface on each PE.</p>
</li><li><p>Enable transparent transmission of CDP packets on the AC interface on each PE connecting the PE to a CE.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363042__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>VSI name and VSI ID</p>
</li><li><p>IP addresses of peers and tunnel policies used for setting up peer relationships</p>
</li><li><p>Names of interfaces bound to the VSI</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172363042__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure an IGP. In this example, OSPF is used.</span><p><p>After the configuration is complete, run the <strong>display ip routing-table</strong> command on PEs and the P. You can view the routes that the devices have learned from each other.</p>
<p>As shown in <a href="#EN-US_TASK_0172363042__fig_dc_ne_vpls_cfg_500301">Figure 1</a>, assign an IP address to each interface on PEs and the P. When configuring OSPF, advertise the 32-bit IP addresses of loopback interfaces, which are used as LSR IDs, on PEs and the P.</p>
<p>For details, see the following configuration files.</p>
</p></li><li><span>Configure basic MPLS functions and LDP.</span><p><p>For details, see the following configuration files.</p>
<p>After the configuration is complete, run the <strong>display mpls ldp session</strong> command on PEs and the P. The command output shows that <strong>Status</strong> of the peer relationship between PE1 and PE2 and between PE2 and the P is <strong>Operational</strong>, which indicates that the peer relationships have been established. Run the <strong>display mpls lsp</strong> command to check whether the LSP is established.</p>
</p></li><li><span>Set up remote LDP sessions between PEs.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>mpls ldp remote-peer 3.3.3.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-ldp-remote-3.3.3.9] <strong>remote-ip 3.3.3.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-ldp-remote-3.3.3.9] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>mpls ldp remote-peer 1.1.1.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls-ldp-remote-1.1.1.9] <strong>remote-ip 1.1.1.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls-ldp-remote-1.1.1.9] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p>After the configuration is complete, run the <strong>display mpls ldp session</strong> command on PE1 or PE2. The command output shows that <strong>Status</strong> of the peer relationship between PE1 and PE2 is <strong>Operational</strong>, which indicates that the peer relationship has been established.</p>
</p></li><li><span>Enable MPLS L2VPN on PEs.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-l2vpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-l2vpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</p></li><li><span>Configure a VSI on PEs.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>vsi a2 static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-a2] <strong>pwsignal ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-a2-ldp] <strong>vsi-id 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-a2-ldp] <strong>peer 3.3.3.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-a2-ldp] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>vsi a2 static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vsi-a2] <strong>pwsignal ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vsi-a2-ldp] <strong>vsi-id 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vsi-a2-ldp] <strong>peer 1.1.1.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vsi-a2-ldp] <strong>commit</strong></pre>
</p></li><li><span>Bind the VSI to the interfaces of the PEs.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet<span>0/1/0</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>vlan-type dot1q 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>l2 binding vsi a2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet<span>0/2/0</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>.1] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>.1] <strong>vlan-type dot1q 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>.1] <strong>l2 binding vsi a2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</p></li><li><span>Enable transparent transmission of CDP packets on the PEs.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/1/0</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>link-protocol transport cdp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet<span>0/2/0</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>.1] <strong>link-protocol transport cdp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</p></li><li><span>Configure CEs.</span><p><p>Configure IP addresses for GE <span>0/1/0</span>.1 on CE1 and CE2. As the CEs are non-Huawei devices, their configurations are not provided here.</p>
</p></li><li><span>Verify the configuration.</span><p><p>After the configurations are complete, run the <strong>display vsi name a2 verbose</strong> command on PE1. The command output shows that the VSI named a2 has established a PW to PE2, and the status of the VSI is Up.</p>
<pre class="screen">&lt;PE1&gt; <strong>display vsi name a2 verbose</strong></pre>
<pre class="screen"> ***VSI Name               : a2</pre>
<pre class="screen">    Administrator VSI      : no</pre>
<pre class="screen">    Isolate Spoken         : disable</pre>
<pre class="screen">    VSI Index              : 0</pre>
<pre class="screen">    PW Signaling           : ldp</pre>
<pre class="screen">    Member Discovery Style : static</pre>
<pre class="screen">    Bridge-domain Mode     : disable</pre>
<pre class="screen">    PW MAC Learn Style     : unqualify</pre>
<pre class="screen">    Encapsulation Type     : vlan</pre>
<pre class="screen">    MTU                    : 1500</pre>
<pre class="screen">    Diffserv Mode          : uniform</pre>
<pre class="screen">    Service Class          : --</pre>
<pre class="screen">    Color                  : --</pre>
<pre class="screen">    DomainId               : 255</pre>
<pre class="screen">    Domain Name            :</pre>
<pre class="screen">    Ignore AcState         : disable</pre>
<pre class="screen">    P2P VSI                : disable</pre>
<pre class="screen">    Create Time            : 0 days, 3 hours, 30 minutes, 31 seconds</pre>
<pre class="screen">    VSI State              : <strong>up</strong></pre>
<pre class="screen">    VSI ID                 : 2</pre>
<pre class="screen">   *Peer Router ID         : 3.3.3.9</pre>
<pre class="screen">    primary or secondary   : primary</pre>
<pre class="screen">    ignore-standby-state   : no</pre>
<pre class="screen">    VC Label               : 23552</pre>
<pre class="screen">    Peer Type              : dynamic</pre>
<pre class="screen">    Session                : up</pre>
<pre class="screen">    Tunnel ID              : 0x2002001</pre>
<pre class="screen">    Broadcast Tunnel ID    : --</pre>
<pre class="screen">    Broad BackupTunnel ID  : --</pre>
<pre class="screen">    CKey                   : 2</pre>
<pre class="screen">    NKey                   : 3439331285</pre>
<pre class="screen">    Stp Enable             : 0</pre>
<pre class="screen">    PwIndex                : 2</pre>
<pre class="screen">    Interface Name         : GigabitEthernet<span>0/1/0</span>.1</pre>
<pre class="screen">    State                  : up</pre>
<pre class="screen">    Last Up Time           : 2012-08-15 15:41:59</pre>
<pre class="screen">    Total Up Time          : 0 days, 0 hours, 1 minutes, 2 seconds</pre>
<pre class="screen">   **PW Information:</pre>
<pre class="screen">   *Peer Ip Address        : 3.3.3.9</pre>
<pre class="screen">    PW State               : up</pre>
<pre class="screen">    Local VC Label         : 23552</pre>
<pre class="screen">    Remote VC Label        : 23552</pre>
<pre class="screen">    PW Type                : label</pre>
<pre class="screen">    Tunnel ID              : 0x0000000001006ad122</pre>
<pre class="screen">    Broadcast Tunnel ID    : --  </pre>
<pre class="screen">    Broad BackupTunnel ID  : --  </pre>
<pre class="screen">    Ckey                   : 36033 </pre>
<pre class="screen">    Nkey                   : 3053453715</pre>
<pre class="screen">    Main PW Token          : 0x0</pre>
<pre class="screen">    Slave PW Token         : 0x0</pre>
<pre class="screen">    Tnl Type               : ldp</pre>
<pre class="screen">    OutInterface           : LDP LSP </pre>
<pre class="screen">    Backup OutInterface    : --</pre>
<pre class="screen">    Stp Enable             : 0  </pre>
<pre class="screen">    PW Last Up Time        : 2012-08-15 15:41:59</pre>
<pre class="screen">    PW Total Up Time       : 0 days, 0 hours, 1 minutes, 3 seconds</pre>
<p>CE1 (10.1.1.1) can ping CE2 (10.1.1.2) successfully.</p>
<pre class="screen">&lt;CE1&gt; <strong>ping 10.1.1.2</strong></pre>
<pre class="screen">  PING 10.1.1.2: 56  data bytes, press CTRL_C to break</pre>
<pre class="screen">    Reply from 10.1.1.2: bytes=56 Sequence=1 ttl=255 time=90 ms</pre>
<pre class="screen">    Reply from 10.1.1.2: bytes=56 Sequence=2 ttl=255 time=77 ms</pre>
<pre class="screen">    Reply from 10.1.1.2: bytes=56 Sequence=3 ttl=255 time=34 ms</pre>
<pre class="screen">    Reply from 10.1.1.2: bytes=56 Sequence=4 ttl=255 time=46 ms</pre>
<pre class="screen">    Reply from 10.1.1.2: bytes=56 Sequence=5 ttl=255 time=94 ms</pre>
<pre class="screen">  --- 10.1.1.2 ping statistics ---</pre>
<pre class="screen">    5 packet(s) transmitted</pre>
<pre class="screen">    5 packet(s) received</pre>
<pre class="screen">    0.00% packet loss</pre>
<pre class="screen">    round-trip min/avg/max = 34/68/94 ms </pre>
<p>CE1 and CE2 can discover each other using the CDP.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172363042__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>Configuration file of PE1</p>
<pre class="screen">#</pre>
<pre class="screen"> sysname PE1</pre>
<pre class="screen">#</pre>
<pre class="screen"> mpls lsr-id 1.1.1.9</pre>
<pre class="screen"> mpls</pre>
<pre class="screen">#</pre>
<pre class="screen"> mpls l2vpn</pre>
<pre class="screen">#</pre>
<pre class="screen">vsi a2 static </pre>
<pre class="screen"> pwsignal ldp </pre>
<pre class="screen">  vsi-id 2    </pre>
<pre class="screen">  peer 3.3.3.9</pre>
<pre class="screen"># </pre>
<pre class="screen">mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen"> mpls ldp remote-peer 3.3.3.9</pre>
<pre class="screen"> remote-ip 3.3.3.9</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span>.1</pre>
<pre class="screen"> vlan-type dot1q 10</pre>
<pre class="screen"> link-protocol transport cdp</pre>
<pre class="screen"> l2 binding vsi a2</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> ip address 10.1.1.1 255.255.255.0</pre>
<pre class="screen"> mpls</pre>
<pre class="screen"> mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack1</pre>
<pre class="screen"> ip address 1.1.1.9 255.255.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 1.1.1.9 0.0.0.0</pre>
<pre class="screen">  network 10.1.1.0 0.0.0.255</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p>Configuration file of the P</p>
<pre class="screen">#</pre>
<pre class="screen"> sysname P</pre>
<pre class="screen">#</pre>
<pre class="screen"> mpls lsr-id 2.2.2.9</pre>
<pre class="screen"> mpls</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> ip address 10.1.1.2 255.255.255.0</pre>
<pre class="screen"> mpls</pre>
<pre class="screen"> mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> ip address 10.2.2.1 255.255.255.0</pre>
<pre class="screen"> mpls</pre>
<pre class="screen"> mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack1</pre>
<pre class="screen"> ip address 2.2.2.9 255.255.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 10.1.1.0 0.0.0.255</pre>
<pre class="screen">  network 10.2.2.0 0.0.0.255</pre>
<pre class="screen">  network 2.2.2.9 0.0.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p>Configuration file of PE2</p>
<pre class="screen">#</pre>
<pre class="screen"> sysname PE2</pre>
<pre class="screen">#</pre>
<pre class="screen"> mpls lsr-id 3.3.3.9</pre>
<pre class="screen"> mpls</pre>
<pre class="screen">#</pre>
<pre class="screen"> mpls l2vpn</pre>
<pre class="screen">#</pre>
<pre class="screen">vsi a2 static  </pre>
<pre class="screen"> pwsignal ldp  </pre>
<pre class="screen">  vsi-id 2     </pre>
<pre class="screen">  peer 1.1.1.9 </pre>
<pre class="screen"># </pre>
<pre class="screen">mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen"> mpls ldp remote-peer 1.1.1.9</pre>
<pre class="screen"> remote-ip 1.1.1.9</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> ip address 10.2.2.2 255.255.255.0</pre>
<pre class="screen"> mpls</pre>
<pre class="screen"> mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span>.1</pre>
<pre class="screen"> vlan-type dot1q 10</pre>
<pre class="screen"> link-protocol transport cdp</pre>
<pre class="screen"> l2 binding vsi a2</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack1</pre>
<pre class="screen"> ip address 3.3.3.9 255.255.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 3.3.3.9 0.0.0.0</pre>
<pre class="screen">  network 10.2.2.0 0.0.0.255</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2bptnl_cfg_0017.html">Configuration Examples for Layer 2 Protocol Tunneling
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_vpws_cfg_5003.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>