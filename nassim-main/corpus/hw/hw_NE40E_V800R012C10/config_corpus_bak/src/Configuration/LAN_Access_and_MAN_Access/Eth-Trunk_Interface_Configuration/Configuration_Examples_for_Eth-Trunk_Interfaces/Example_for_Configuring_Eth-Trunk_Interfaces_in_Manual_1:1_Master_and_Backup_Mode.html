
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Eth-Trunk Interfaces in Manual 1:1 Master/Backup Mode">
<meta name="abstract" content="An Eth-Trunk interface in manual 1:1 master/backup mode contains only two member interfaces: one master interface and one backup interface. In normal situations, only the master interface forwards traffic. If the master interface fails, the backup interface takes over traffic.">
<meta name="description" content="An Eth-Trunk interface in manual 1:1 master/backup mode contains only two member interfaces: one master interface and one backup interface. In normal situations, only the master interface forwards traffic. If the master interface fails, the backup interface takes over traffic.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ethtrunk_cfg_0060.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ethtrunk_cfg_0061.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ethtrunk_cfg_0065.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Eth-Trunk">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Eth-Trunk">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="Eth-Trunk">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="Eth-Trunk">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wwx1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172362934">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Eth-Trunk Interfaces in Manual 1:1 Master/Backup Mode</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172362934"></a><a name="EN-US_TASK_0172362934"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Eth-Trunk Interfaces in Manual 1:1 Master/Backup Mode</h1>
<div class="taskbody"><p>An Eth-Trunk interface in manual 1:1 master/backup mode contains only two member interfaces: one master interface and one backup interface. In normal situations, only the master interface forwards traffic. If the master interface fails, the backup interface takes over traffic.</p>
<div class="context"><a name="EN-US_TASK_0172362934__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As the service volume expands, the bandwidth provided by a single P2P physical link working in full-duplex mode cannot meet the service requirement. Deploying Eth-Trunk interfaces to implement link aggregation provides higher bandwidth than each individual link and improves link reliability.</p>
<p>When intermediate devices exist between the devices at both ends of an Eth-Trunk link, Eth-Trunk interfaces in manual 1:1 master/backup mode can be configured to improve link reliability.</p>
<p>On the network shown in <a href="#EN-US_TASK_0172362934__fig_dc_vrp_ethtrunk_cfg_005601">Figure 1</a>, PE1 and PE2 are connected through PE3 and PE4. To improve link reliability between PE1 and PE2, configure Eth-Trunk interfaces in manual 1:1 master/backup mode on PE1 and PE2.</p>
<div class="fignone" id="EN-US_TASK_0172362934__fig_dc_vrp_ethtrunk_cfg_005601"><a name="EN-US_TASK_0172362934__fig_dc_vrp_ethtrunk_cfg_005601"></a><a name="fig_dc_vrp_ethtrunk_cfg_005601"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring Eth-Trunk interfaces in manual 1:1 master/backup mode</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 and interface2 represent GE<span>0/1/1</span> and GE<span>0/2/1</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001433660633.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362934__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><div class="p">When configuring Eth-Trunk interfaces in manual 1:1 master/backup mode, note the following:<ul><li>The master member interface must be specified for each Eth-Trunk interface to forward data.</li><li>The devices on the two ends of the Eth-Trunk link must be enabled to send Flush packets. After the master and backup interfaces are switched in an Eth-Trunk interface, the new master interface sends Flush packets to instruct the peer end to age MAC addresses. This function prevents data interruption caused by asynchronous MAC addresses.</li><li>The intermediate devices must be enabled to receive Flush packets so that they can transparently transmit Flush packets.</li></ul>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362934__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Create an Eth-Trunk interface in manual 1:1 master/backup mode on each of PE1 and PE2 and add physical Ethernet interfaces to each Eth-Trunk interface for link aggregation.</li><li>Specify the master interface for the Eth-Trunk interface on each of PE1 and PE2 to implement link backup.</li><li>Enable PE1 and PE2 to send Flush packets. After the master and backup interfaces are switched, the new master interface sends Flush packets to instruct the peer end to age MAC addresses.</li><li>Enable PE3 and PE4 to receive Flush packets so that they can transparently transmit Flush packets.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362934__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Eth-Trunk interface ID</p>
</li><li><p>Type and number of the member interface of the Eth-Trunk interface</p>
</li><li><p>Control VLAN ID of Flush packets allowed to be forwarded</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172362934__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Create an Eth-Trunk interface in manual 1:1 master/backup mode on each of PE1 and PE2 and add physical Ethernet interfaces to each Eth-Trunk interface.</span><p><p># Configure PE1.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> interface eth-trunk 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Eth-Trunk1]<strong> portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Eth-Trunk1]<strong> mode manual backup</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Eth-Trunk1]<strong> trunkport gigabitethernet <span>0/1/1</span> <span>0/2/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Eth-Trunk1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> interface eth-trunk 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk1]<strong> portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk1]<strong> mode manual backup</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk1]<strong> trunkport gigabitethernet <span>0/1/1</span> <span>0/2/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
</p></li><li><span>Specify the master interface in the Eth-Trunk interface on each of PE1 and PE2.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>]<strong> port-master</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> interface gigabitethernet <span>0/2/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>]<strong> port-master</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> interface gigabitethernet <span>0/2/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
</p></li><li><span># Enable PE1 and PE2 to send Flush packets.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> vlan batch 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> interface eth-trunk 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Eth-Trunk1]<strong> port trunk allow-pass vlan 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Eth-Trunk1]<strong> smart-link flush send vlan 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Eth-Trunk1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> vlan batch 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> interface eth-trunk 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk1]<strong> port trunk allow-pass vlan 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk1]<strong> smart-link flush send vlan 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
</p></li><li><span># Enable PE3 and PE4 to receive Flush packets.</span><p><p># Configure PE3.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3]<strong> vlan batch 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3]<strong> interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/1</span>]<strong> portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/1</span>]<strong> port trunk allow-pass vlan 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/1</span>]<strong> smart-link flush enable control-vlan 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3]<strong> interface gigabitethernet <span>0/2/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/2/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/2/1</span>]<strong> portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/2/1</span>]<strong> port trunk allow-pass vlan 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/2/1</span>]<strong> smart-link flush enable control-vlan 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/2/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3]<strong> commit</strong></pre>
<p># Configure PE4.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE4</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4]<strong> vlan batch 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE4]<strong> interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE4-GigabitEthernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE4-GigabitEthernet<span>0/1/1</span>]<strong> portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE4-GigabitEthernet<span>0/1/1</span>]<strong> port trunk allow-pass vlan 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE4-GigabitEthernet<span>0/1/1</span>]<strong> smart-link flush enable control-vlan 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE4-GigabitEthernet<span>0/1/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE4]<strong> interface gigabitethernet <span>0/2/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE4-GigabitEthernet<span>0/2/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE4-GigabitEthernet<span>0/2/1</span>]<strong> portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE4-GigabitEthernet<span>0/2/1</span>]<strong> port trunk allow-pass vlan 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE4-GigabitEthernet<span>0/2/1</span>]<strong> smart-link flush enable control-vlan 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE4-GigabitEthernet<span>0/2/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE4]<strong> commit</strong></pre>
</p></li><li><span>Verify the configuration. </span><p><p># After the configuration is complete, check information about the Eth-Trunk interfaces in manual 1:1 master/backup mode. The command output shows the Eth-Trunk ID, manual 1:1 master/backup mode, and master interface information. The following example uses the command output on PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display eth-trunk 1</strong></pre>
<pre class="screen">Eth-Trunk1's state information is:
WorkingMode: <strong>BACKUP</strong>
WorkingState: Master
--------------------------------------------------------------------------------
PortName                      Slave/Master
GigabitEthernet<span>0/1/1</span>          <strong>M</strong>
GigabitEthernet<span>0/2/1</span>          S</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172362934__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">sysname PE1
#
vlan batch 5
#
interface Eth-Trunk1
 portswitch
 port trunk allow-pass vlan 5
 mode manual backup
 smart-link flush send vlan 5
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 eth-trunk 1
 port-master
#
interface GigabitEthernet<span>0/2/1</span>
 undo shutdown
 eth-trunk 1
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2
#
vlan batch 5
#
interface Eth-Trunk1
 portswitch
 port trunk allow-pass vlan 5
 mode manual backup
 smart-link flush send vlan 5
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 eth-trunk 1
 port-master
#
interface GigabitEthernet<span>0/2/1</span>
 undo shutdown
 eth-trunk 1
#
return</pre>
</li><li><p>PE3 configuration file</p>
<pre class="screen">#
sysname PE3
#
vlan batch 5
#
interface GigabitEthernet<span>0/1/1</span>
 portswitch
 undo shutdown
 port trunk allow-pass vlan 5
 smart-link flush enable control-vlan 5
#
interface GigabitEthernet<span>0/2/1</span>
 portswitch
 undo shutdown
 port trunk allow-pass vlan 5
 smart-link flush enable control-vlan 5
#
return</pre>
</li><li><p>PE4 configuration file</p>
<pre class="screen">#
sysname PE4
#
vlan batch 5
#
interface GigabitEthernet<span>0/1/1</span>
 portswitch
 undo shutdown
 port trunk allow-pass vlan 5
 smart-link flush enable control-vlan 5
#
interface GigabitEthernet<span>0/2/1</span>
 portswitch
 undo shutdown
 port trunk allow-pass vlan 5
 smart-link flush enable control-vlan 5
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ethtrunk_cfg_0060.html">Configuration Examples for Eth-Trunk Interfaces
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ethtrunk_cfg_0061.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ethtrunk_cfg_0065.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>