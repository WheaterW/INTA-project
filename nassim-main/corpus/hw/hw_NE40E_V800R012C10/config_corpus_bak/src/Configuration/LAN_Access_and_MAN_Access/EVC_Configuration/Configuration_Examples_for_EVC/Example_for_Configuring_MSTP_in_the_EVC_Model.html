
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring MSTP in the EVC Model">
<meta name="abstract" content="This section provides an example for configuring MSTP basic functions to prevent loops in an EVC model.">
<meta name="description" content="This section provides an example for configuring MSTP basic functions to prevent loops in an EVC model.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evc_cfg_0018.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evc_cfg_0042.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="h00847023,y00852169">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="EVC">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EVC">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="EVC">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="EVC">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="p00915595">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00437000">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172363426">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring MSTP in the EVC Model</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172363426"></a><a name="EN-US_TASK_0172363426"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring MSTP in the EVC Model</h1>
<div class="taskbody" id="taskbody1557677378214029"><p id="shortdesc251504431214029">This section provides an example for configuring MSTP basic functions to prevent loops in an EVC model.</p>
<div class="context"><a name="EN-US_TASK_0172363426__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0172363426__context2024576030214029"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0172363426__p980307509214029">MSTP can be deployed to eliminate loops. MSTP blocks redundant links on a Layer 2 network and trims the network into a loop-free tree.</p>
<p id="EN-US_TASK_0172363426__p932001534214029">As shown in <a href="#EN-US_TASK_0172363426__fig_dc_vrp_mstp_cfg_005501">Figure 1</a>, in the EVC model, to load balance traffic of VLANs 1 to 10 and traffic of VLANs 11 to 20, multiple MSTIs are created. MSTP defines a VLAN mapping table in which VLANs are associated with spanning tree instances. In addition, MSTP divides a switching network into multiple regions, each of which has multiple independent spanning tree instances. As shown in <a href="#EN-US_TASK_0172363426__fig_dc_vrp_mstp_cfg_005501">Figure 1</a>, PE1, PE3, PE2, and PE4 all run MSTP.</p>
<div class="fignone" id="EN-US_TASK_0172363426__fig_dc_vrp_mstp_cfg_005501"><a name="EN-US_TASK_0172363426__fig_dc_vrp_mstp_cfg_005501"></a><a name="fig_dc_vrp_mstp_cfg_005501"></a><span class="figcap"><b>Figure 1 </b>Configuring MSTP in an EVC model</span><div class="note" id="EN-US_TASK_0172363426__note1101091932214029"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172363426__p1185514925214029">Interfaces 1 through 3 in this example represent GE<span>0/1/1</span>, GE<span>0/1/2</span>, GE<span>0/1/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0172363426__image1327490306214029" src="images/fig_dc_vrp_mstp_cfg_005501.png" width="NaN" height="NaN"></span><br></div>
<div class="note" id="EN-US_TASK_0172363426__note1358787908214029"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172363426__p807267558214029">STP and RSTP can also be configured in an EVC model. The procedure for configuring STP or RSTP is similar to that for MSTP. This example describes how to configure MSTP in an EVC model.</p>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363426__1.4.2"></a><a name="1.4.2"></a>
<div class="p" id="EN-US_TASK_0172363426__context558748773214029"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0172363426__p1393168167214029">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0172363426__ol426596010214029"><li id="EN-US_TASK_0172363426__li1258640225214029"><div class="p" id="EN-US_TASK_0172363426__p1252338625214029"><a name="EN-US_TASK_0172363426__li1258640225214029"></a><a name="li1258640225214029"></a>Configure basic MSTP functions on the PEs:<ol type="a" id="EN-US_TASK_0172363426__ol1586462381214029"><li id="EN-US_TASK_0172363426__li1222092325214029"><p id="EN-US_TASK_0172363426__p1172106367214029"><a name="EN-US_TASK_0172363426__li1222092325214029"></a><a name="li1222092325214029"></a>Configure an MST region and create multiple MSTIs to implement load balancing.</p>
</li><li id="EN-US_TASK_0172363426__li180141368214029"><p id="EN-US_TASK_0172363426__p1831513353214029"><a name="EN-US_TASK_0172363426__li180141368214029"></a><a name="li180141368214029"></a>In the MST region, configure a primary root bridge and secondary root bridge for each MSTI.</p>
</li><li id="EN-US_TASK_0172363426__li425353430214029"><p id="EN-US_TASK_0172363426__p2089520794214029"><a name="EN-US_TASK_0172363426__li425353430214029"></a><a name="li425353430214029"></a>Set path costs for ports to be blocked in each MSTI.</p>
</li><li id="EN-US_TASK_0172363426__li1682750258214029"><div class="p" id="EN-US_TASK_0172363426__p1771438863214029"><a name="EN-US_TASK_0172363426__li1682750258214029"></a><a name="li1682750258214029"></a>Enable MSTP to eliminate loops, including:<ul id="EN-US_TASK_0172363426__ul1868021484214029"><li id="EN-US_TASK_0172363426__li449414658214029"><p id="EN-US_TASK_0172363426__p612170507214029"><a name="EN-US_TASK_0172363426__li449414658214029"></a><a name="li449414658214029"></a>Enable MSTP globally.</p>
</li><li id="EN-US_TASK_0172363426__li386615440214029"><p id="EN-US_TASK_0172363426__p1707667905214029"><a name="EN-US_TASK_0172363426__li386615440214029"></a><a name="li386615440214029"></a>Enable MSTP on all the interfaces except the interfaces connected to terminals.</p>
</li></ul>
<div class="note" id="EN-US_TASK_0172363426__note1201822886214029"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172363426__p1953544967214029">MSTP is not required on the interfaces connected to PCs because these interfaces do not need to participate in MSTP calculation.</p>
</div></div>
</div>
</li></ol>
</div>
</li><li id="EN-US_TASK_0172363426__li1788725854214029"><p id="EN-US_TASK_0172363426__p492792333214313"><a name="EN-US_TASK_0172363426__li1788725854214029"></a><a name="li1788725854214029"></a>Configure MSTP protection functions, for example, configure root protection on a designated port of a root bridge in each MSTI.</p>
</li><li id="EN-US_TASK_0172363426__li1958471776214029"><div class="p" id="EN-US_TASK_0172363426__p1553281663214029"><a name="EN-US_TASK_0172363426__li1958471776214029"></a><a name="li1958471776214029"></a>Configure the EVC model on each PE:<ol type="a" id="EN-US_TASK_0172363426__ol675080689214029"><li id="EN-US_TASK_0172363426__li1324832805214313">Configure a bridge domain to forward services.</li><li id="EN-US_TASK_0172363426__li1023436219214313">Create an EVC Layer 2 sub-interface, add it to the bridge domain, and specify traffic encapsulation types on the EVC Layer 2 sub-interface.</li></ol>
</div>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363426__1.4.3"></a><a name="1.4.3"></a>
<div class="p" id="EN-US_TASK_0172363426__context716218271214029"><h4 class="sectiontitle">Data Preparation</h4><p id="EN-US_TASK_0172363426__p903928744214029">To complete the configuration, you need the following data:</p>
<ul id="EN-US_TASK_0172363426__ul1341727067214029"><li id="EN-US_TASK_0172363426__li1471021613214029"><p id="EN-US_TASK_0172363426__p1628505427214029"><a name="EN-US_TASK_0172363426__li1471021613214029"></a><a name="li1471021613214029"></a>Region name RG1</p>
</li><li id="EN-US_TASK_0172363426__li1856918722214029"><p id="EN-US_TASK_0172363426__p2000602450214029"><a name="EN-US_TASK_0172363426__li1856918722214029"></a><a name="li1856918722214029"></a>MSTIs, MSTI 1 and MSTI 2</p>
</li><li id="EN-US_TASK_0172363426__li1753254724214029"><p id="EN-US_TASK_0172363426__p1329025781214029"><a name="EN-US_TASK_0172363426__li1753254724214029"></a><a name="li1753254724214029"></a>GE interface numbers, as shown in <a href="#EN-US_TASK_0172363426__fig_dc_vrp_mstp_cfg_005501">Figure 1</a></p>
</li><li id="EN-US_TASK_0172363426__li1702784059214029"><p id="EN-US_TASK_0172363426__p1324599691214029"><a name="EN-US_TASK_0172363426__li1702784059214029"></a><a name="li1702784059214029"></a>Primary and secondary root bridges of MSTI 1 (PE1 and PE3 respectively) and primary and secondary root bridges of MSTI 2 (PE3 and PE1 respectively), as shown in <a href="#EN-US_TASK_0172363426__fig_dc_vrp_mstp_cfg_005501">Figure 1</a></p>
</li><li id="EN-US_TASK_0172363426__li49199197214029"><p id="EN-US_TASK_0172363426__p109699884214029"><a name="EN-US_TASK_0172363426__li49199197214029"></a><a name="li49199197214029"></a>Path costs of the ports to be blocked (20000) in MSTI 1 and MSTI 2, as shown in <a href="#EN-US_TASK_0172363426__fig_dc_vrp_mstp_cfg_005501">Figure 1</a></p>
</li><li id="EN-US_TASK_0172363426__li576786370214029"><p id="EN-US_TASK_0172363426__p307338032214029"><a name="EN-US_TASK_0172363426__li576786370214029"></a><a name="li576786370214029"></a>VLAN IDs (1 to 20)</p>
</li><li id="EN-US_TASK_0172363426__li1486375292214029"><p id="EN-US_TASK_0172363426__p1979750740214029"><a name="EN-US_TASK_0172363426__li1486375292214029"></a><a name="li1486375292214029"></a>VLAN to which PC1 belongs (VLAN 10) and VLAN to which PC2 belongs (VLAN 20)</p>
</li><li id="EN-US_TASK_0172363426__li1639722855214029"><p id="EN-US_TASK_0172363426__p164382034214029"><a name="EN-US_TASK_0172363426__li1639722855214029"></a><a name="li1639722855214029"></a>Bridge domain ID 10</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172363426__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0172363426__steps1245422245214029"><li id="EN-US_TASK_0172363426__step883896716214029"><span id="EN-US_TASK_0172363426__cmd1507719513214029">Configure basic MSTP functions.</span><p><ol type="a" id="EN-US_TASK_0172363426__ol1161807363214029"><li id="EN-US_TASK_0172363426__li1669592597214029"><p id="EN-US_TASK_0172363426__p1821446077214029"><a name="EN-US_TASK_0172363426__li1669592597214029"></a><a name="li1669592597214029"></a>Add PE1, PE3, PE2, and PE4 to MST region RG1, and create two MSTIs, MSTI 1 and MSTI 2.</p>
<p id="EN-US_TASK_0172363426__p409368937214029"># Add PE1 to RG1.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1089846165214029">&lt;<span class="keyword" id="EN-US_TASK_0172363426__keyword2062469494214029">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172363426__b1140951940214029">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1213874842214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1716516741214029"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363426__keyword201552189214029">HUAWEI</span>] <strong id="EN-US_TASK_0172363426__b293074398214029">sysname PE1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen159579476214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword657313567214029">*</span><span class="keyword" id="EN-US_TASK_0172363426__keyword813240401214029">HUAWEI</span>] <strong id="EN-US_TASK_0172363426__b1237383428214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen438363259214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1056755040214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363426__b1225661620214029">stp region-configuration</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1088280134214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1517215599214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-mst-region] <strong id="EN-US_TASK_0172363426__b61781103214029">region-name RG1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1369375444214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword88747357214029">*</span>PE1-mst-region] <strong id="EN-US_TASK_0172363426__b93054636214029">instance 1 vlan 1 to 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen2138694964214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword166405401214029">*</span>PE1-mst-region] <strong id="EN-US_TASK_0172363426__b821662943214029">instance 2 vlan 11 to 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen260757085214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword437140895214029">*</span>PE1-mst-region] <strong id="EN-US_TASK_0172363426__b934636593214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen345497247214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1460145382214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-mst-region] <strong id="EN-US_TASK_0172363426__b1966533547214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p175482172214029"># Add PE2 to RG1.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1639472036214029">&lt;<span class="keyword" id="EN-US_TASK_0172363426__keyword725878289214029">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172363426__b932489891214029">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1563372780214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1126210961214029"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363426__keyword306756869214029">HUAWEI</span>] <strong id="EN-US_TASK_0172363426__b98747741214029">sysname PE2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen934744336214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword938004970214029">*</span><span class="keyword" id="EN-US_TASK_0172363426__keyword372078163214029">HUAWEI</span>] <strong id="EN-US_TASK_0172363426__b1239940901214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1172063648214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1762934979214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172363426__b1670482922214029">stp region-configuration</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1483510262214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1183626512214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-mst-region] <strong id="EN-US_TASK_0172363426__b807648877214029">region-name RG1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1883111511214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword2112856905214029">*</span>PE2-mst-region] <strong id="EN-US_TASK_0172363426__b2033056964214029">instance 1 vlan 1 to 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen458747084214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1603069244214029">*</span>PE2-mst-region] <strong id="EN-US_TASK_0172363426__b1280110002214029">instance 2 vlan 11 to 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen521890312214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword630988529214029">*</span>PE2-mst-region] <strong id="EN-US_TASK_0172363426__b962867476214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen146100198214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1915981990214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-mst-region] <strong id="EN-US_TASK_0172363426__b186277159214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p1023174796214029"># Add PE3 to RG1.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1180418801214029">&lt;<span class="keyword" id="EN-US_TASK_0172363426__keyword356800783214029">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172363426__b1284528369214029">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen999457941214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1935447867214029"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363426__keyword1137499560214029">HUAWEI</span>] <strong id="EN-US_TASK_0172363426__b292540568214029">sysname PE3</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen551614499214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword227978554214029">*</span><span class="keyword" id="EN-US_TASK_0172363426__keyword524730830214029">HUAWEI</span>] <strong id="EN-US_TASK_0172363426__b1607880666214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen867156132214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1241381915214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172363426__b730204578214029">stp region-configuration</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen176381657214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword66156702214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-mst-region] <strong id="EN-US_TASK_0172363426__b541008216214029">region-name RG1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen214577256214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1374539745214029">*</span>PE3-mst-region] <strong id="EN-US_TASK_0172363426__b1658226206214029">instance 1 vlan 1 to 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen812337965214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword302410352214029">*</span>PE3-mst-region] <strong id="EN-US_TASK_0172363426__b1747356612214029">instance 2 vlan 11 to 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1803492707214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1312351716214029">*</span>PE3-mst-region] <strong id="EN-US_TASK_0172363426__b2122849157214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1446040439214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1957717191214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-mst-region] <strong id="EN-US_TASK_0172363426__b244797076214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p1977734869214029"># Add PE4 to RG1.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen433522491214029">&lt;<span class="keyword" id="EN-US_TASK_0172363426__keyword1237929176214029">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172363426__b1902911017214029">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen449775451214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword2116635150214029"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363426__keyword1220353495214029">HUAWEI</span>] <strong id="EN-US_TASK_0172363426__b1041706702214029">sysname PE4</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1020038433214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword639609264214029">*</span><span class="keyword" id="EN-US_TASK_0172363426__keyword1757246813214029">HUAWEI</span>] <strong id="EN-US_TASK_0172363426__b7834164214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1298177100214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword756150332214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4] <strong id="EN-US_TASK_0172363426__b375811394214029">stp region-configuration</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1129060953214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword937237837214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4-mst-region] <strong id="EN-US_TASK_0172363426__b92482189214029">region-name RG1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1253482467214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword398185066214029">*</span>PE4-mst-region] <strong id="EN-US_TASK_0172363426__b1832406280214029">instance 1 vlan 1 to 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen109193877214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword127468086214029">*</span>PE4-mst-region] <strong id="EN-US_TASK_0172363426__b196028524214029">instance 2 vlan 11 to 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen987691250214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword844732116214029">*</span>PE4-mst-region] <strong id="EN-US_TASK_0172363426__b240811366214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen952139416214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1684842720214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4-mst-region] <strong id="EN-US_TASK_0172363426__b1627612132214029">quit</strong></pre>
</li><li id="EN-US_TASK_0172363426__li877042953214029"><p id="EN-US_TASK_0172363426__p133158063214029"><a name="EN-US_TASK_0172363426__li877042953214029"></a><a name="li877042953214029"></a>In RG1, configure primary and secondary root bridges for MSTI 1 and MSTI 2.</p>
<ul id="EN-US_TASK_0172363426__ul172761588214029"><li id="EN-US_TASK_0172363426__li347078393214029"><p id="EN-US_TASK_0172363426__p780965899214029"><a name="EN-US_TASK_0172363426__li347078393214029"></a><a name="li347078393214029"></a>Configure primary and secondary root bridges for MSTI 1.</p>
<p id="EN-US_TASK_0172363426__p2082413529214029"># Configure PE1 as a primary root bridge of MSTI 1.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1297220078214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1707304449214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363426__b1950875451214029">stp instance 1 root primary</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1647854172214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword2077408304214029">*</span>PE1] <strong id="EN-US_TASK_0172363426__b812621325214029">commit</strong></pre>
<p id="EN-US_TASK_0172363426__p1478476008214029"># Configure PE3 as a secondary root bridge of MSTI 1.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1965072431214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword246648512214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172363426__b1540353935214029">stp instance 1 root secondary</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1218745212214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1066342085214029">*</span>PE3] <strong id="EN-US_TASK_0172363426__b568808652214029">commit</strong></pre>
</li><li id="EN-US_TASK_0172363426__li1635915528214029"><p id="EN-US_TASK_0172363426__p599146555214029"><a name="EN-US_TASK_0172363426__li1635915528214029"></a><a name="li1635915528214029"></a>Configure primary and secondary root bridges for MSTI 2.</p>
<p id="EN-US_TASK_0172363426__p1327784631214029"># Configure PE3 as a primary root bridge of MSTI 2.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1057056228214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword373830586214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172363426__b907749258214029">stp instance 2 root primary</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1258254379214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword2008140312214029">*</span>PE3] <strong id="EN-US_TASK_0172363426__b1979137590214029">commit</strong></pre>
<p id="EN-US_TASK_0172363426__p42083403214029"># Configure PE1 as a secondary root bridge of MSTI 2.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1606655968214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword725286148214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363426__b1457705707214029">stp instance 2 root secondary</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen993104595214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1763330848214029">*</span>PE1] <strong id="EN-US_TASK_0172363426__b1096362719214029">commit</strong></pre>
</li></ul>
</li><li id="EN-US_TASK_0172363426__li1514623567214029"><p id="EN-US_TASK_0172363426__p7139031214029"><a name="EN-US_TASK_0172363426__li1514623567214029"></a><a name="li1514623567214029"></a>Set the path costs of the ports to be blocked in MSTI 1 and MSTI 2 to be larger than the default value.</p>
<div class="note" id="EN-US_TASK_0172363426__note745661075214029"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul id="EN-US_TASK_0172363426__ul1758607280214029"><li id="EN-US_TASK_0172363426__li1768817503214029"><p id="EN-US_TASK_0172363426__p899647500214029"><a name="EN-US_TASK_0172363426__li1768817503214029"></a><a name="li1768817503214029"></a>Different calculation methods define different path costs. Use the Huawei proprietary calculation method as an example to set the path costs of the ports to be blocked in MSTI 1 and MSTI 2 to 20000.</p>
</li><li id="EN-US_TASK_0172363426__li213580467214029"><p id="EN-US_TASK_0172363426__p1201734732214029"><a name="EN-US_TASK_0172363426__li213580467214029"></a><a name="li213580467214029"></a>All switching devices on a network must use the same calculation for path costs.</p>
</li></ul>
</div></div>
<p id="EN-US_TASK_0172363426__p785596563214029"># On PE1, configure the path cost calculation method as the Huawei proprietary method.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen579591989214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword555249805214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363426__b465197288214029">stp pathcost-standard legacy</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen673707478214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1098718845214029">*</span>PE1] <strong id="EN-US_TASK_0172363426__b1422738643214029">commit</strong></pre>
<p id="EN-US_TASK_0172363426__p442445689214029"># On PE2, configure the path cost calculation method as the Huawei proprietary method and set the path cost of GE <span>0/1/2</span> in MSTI 2 to 20000.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1350362231214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword124148852214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172363426__b843087693214029">stp pathcost-standard legacy</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen747205727214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1326042187214029">*</span>PE2] <strong id="EN-US_TASK_0172363426__b563729131214029">interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1874005818475">[<span class="keyword" id="EN-US_TASK_0172363426__keyword6548169134810">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b179742209485">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen16974105919476">[<span class="keyword" id="EN-US_TASK_0172363426__keyword14509171014484">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b1455622818487">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1417298606214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1657068913214029">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b1189054629214029">stp instance 2 cost 20000</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1889899716214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword977186768214029">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b122511864214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1313951603214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1257969458214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b1862662885214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p2038539280214029"># On PE3, configure the path cost calculation method as the Huawei proprietary method.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen2006099011214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1509967317214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172363426__b100182566214029">stp pathcost-standard legacy</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen305257863214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword241226119214029">*</span>PE3] <strong id="EN-US_TASK_0172363426__b291242181214029">commit</strong></pre>
<p id="EN-US_TASK_0172363426__p650111325214029"># On PE4, configure the path cost calculation method as the Huawei proprietary method and set the path cost of GE <span>0/1/2</span> in MSTI 1 to 20000.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen2096327182214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1599181038214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4] <strong id="EN-US_TASK_0172363426__b1243420270214029">stp pathcost-standard legacy</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen103462686214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1872156770214029">*</span>PE4] <strong id="EN-US_TASK_0172363426__b1252099810214029">interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen951914512484">[<span class="keyword" id="EN-US_TASK_0172363426__keyword12697205615481">*</span>PE4-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b147651918184912">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen189005214816">[<span class="keyword" id="EN-US_TASK_0172363426__keyword442112619496">*</span>PE4-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b19755111524913">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen763193970214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1584847168214029">*</span>PE4-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b1463950330214029">stp instance 1 cost 20000</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen772360334214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword2112860023214029">*</span>PE4-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b611457518214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen990484439214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword636266907214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b1791162506214029">quit</strong></pre>
</li><li id="EN-US_TASK_0172363426__li965923404214029"><p id="EN-US_TASK_0172363426__p1445763355214029"><a name="EN-US_TASK_0172363426__li965923404214029"></a><a name="li965923404214029"></a>Enable MSTP to eliminate loops.</p>
<ul id="EN-US_TASK_0172363426__ul1922305484214029"><li id="EN-US_TASK_0172363426__li1075542799214029"><p id="EN-US_TASK_0172363426__p1277965994214029"><a name="EN-US_TASK_0172363426__li1075542799214029"></a><a name="li1075542799214029"></a>Disable MSTP on interfaces connected to PCs.</p>
<p id="EN-US_TASK_0172363426__p371391966214029"># Disable STP on GE <span>0/1/1</span> of PE2.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen432093450214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1469200498214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172363426__b1816252201214029">interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen12508923552">[<span class="keyword" id="EN-US_TASK_0172363426__keyword12284914564">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b4971017155517">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen172148312559">[<span class="keyword" id="EN-US_TASK_0172363426__keyword2716164412562">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b10581182645516">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1125374310214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1589015544566">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b498508499214029">stp disable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen706586116214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1785226106214029">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b64608465214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1248601047214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword2138081010214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b643217941214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p543617454214029"># Disable STP on GE <span>0/1/1</span> of PE4.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen2132428980214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword862403843214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4] <strong id="EN-US_TASK_0172363426__b2135428536214029">interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1146623705518">[<span class="keyword" id="EN-US_TASK_0172363426__keyword167781349175510">*</span>PE4-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b863813495611">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1999833715551">[<span class="keyword" id="EN-US_TASK_0172363426__keyword13193159155515">*</span>PE4-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b142431936165610">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen2080370726214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword437719135614">*</span>PE4-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b914266665214029">stp disable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1905095327214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1106946248214029">*</span>PE4-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b1454635010214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1655736753214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword508884847214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b451818332214029">quit</strong></pre>
</li><li id="EN-US_TASK_0172363426__li696820844214029"><p id="EN-US_TASK_0172363426__p1239598017214029"><a name="EN-US_TASK_0172363426__li696820844214029"></a><a name="li696820844214029"></a>Enable MSTP globally.</p>
<p id="EN-US_TASK_0172363426__p736232526214029"># Enable MSTP on PE1.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen62483468214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword378460293214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363426__b1806537594214029">stp enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen670524433214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1745411717214029">*</span>PE1] <strong id="EN-US_TASK_0172363426__b1403049921214029">commit</strong></pre>
<p id="EN-US_TASK_0172363426__p564324628214029"># Enable MSTP on PE2.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen777034961214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword171479669214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172363426__b798396349214029">stp enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1737398918214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1709504912214029">*</span>PE2] <strong id="EN-US_TASK_0172363426__b2027993470214029">commit</strong></pre>
<p id="EN-US_TASK_0172363426__p886018605214029"># Enable MSTP on PE3.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1192698876214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword150067240214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172363426__b1765982496214029">stp enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen909218647214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1642615080214029">*</span>PE3] <strong id="EN-US_TASK_0172363426__b845700682214029">commit</strong></pre>
<p id="EN-US_TASK_0172363426__p303755559214029"># Enable MSTP on PE4.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen788236093214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword446313853214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4] <strong id="EN-US_TASK_0172363426__b88635758214029">stp enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1197679445214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword214393870214029">*</span>PE4] <strong id="EN-US_TASK_0172363426__b969059565214029">commit</strong></pre>
</li><li id="EN-US_TASK_0172363426__li1799599337214029"><p id="EN-US_TASK_0172363426__p706372611214029"><a name="EN-US_TASK_0172363426__li1799599337214029"></a><a name="li1799599337214029"></a>Enable MSTP on all the interfaces except the interfaces connected to terminals.</p>
<p id="EN-US_TASK_0172363426__p1837930709214029"># Enable MSTP on GE <span>0/1/1</span> of PE1.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen319993708214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1224173484214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363426__b835099932214029">interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen394944445214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1577821459214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b691488082214029">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen6999191317574">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1486161810571">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b1441623655710">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1790229054214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword70422256214029">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b10193929214029">stp enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1875072079214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1891220720214029">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b1555552856214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen38708790214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1327785514214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b348203565214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p1639958563214029"># Enable MSTP on GE <span>0/1/2</span> of PE1.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen577544937214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1216043312214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363426__b1174180079214029">interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1949452515214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1961152098214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b1008564288214029">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1857184814573">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1711685345715">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b1372480195813">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1382350907214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1598757983214029">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b1753673141214029">stp enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen200186067214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1009874979214029">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b739895258214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1492366547214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1484414885214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b1791821276214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p843758795214029"># Enable MSTP on GE <span>0/1/2</span> of PE2.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1370783056214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword451766107214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172363426__b1015392485214029">interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen998775231214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1584670971214029">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b1942206715214029">stp enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen875969010214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword123177668214029">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b1456472453214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen2059590689214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1527547620214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b928466661214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p2045716439214029"># Enable MSTP on GE <span>0/1/3</span> of PE2.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1342862104214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword2021723726214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172363426__b332002425214029">interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen669279072214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1678024192214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363426__b67730337214029">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen72645195915">[<span class="keyword" id="EN-US_TASK_0172363426__keyword22238635912">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363426__b291491318596">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1544408507214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword579130214029">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363426__b109308694214029">stp enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1790095525214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1983158090214029">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363426__b1296126027214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1602816873214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword586190435214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363426__b740912190214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p1462241660214029"># Enable MSTP on GE <span>0/1/1</span> of PE3.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen564709770214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword190344652214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172363426__b1092984790214029">interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen863762442214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword218656611214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b1033120737214029">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen934611281502">[<span class="keyword" id="EN-US_TASK_0172363426__keyword15100533200">*</span>PE3-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b1529824214018">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1352523361214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword682687532214029">*</span>PE3-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b1319186334214029">stp enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1123245922214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword259225830214029">*</span>PE3-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b273730373214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1743807988214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1477264697214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b354129370214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p99499212214029"># Enable MSTP on GE <span>0/1/2</span> of PE3.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1524883574214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1073325562214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172363426__b822488048214029">interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1096513642214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword295252445214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b1825298726214029">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen363410461203">[<span class="keyword" id="EN-US_TASK_0172363426__keyword178969505017">*</span>PE3-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b7100358302">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen254646995214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1029941561214029">*</span>PE3-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b1774021834214029">stp enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen347985190214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword427734616214029">*</span>PE3-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b121603242214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1038776871214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword2116600962214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b967655426214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p903603736214029"># Enable MSTP on GE <span>0/1/2</span> of PE4.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1552462404214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1712795506214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4] <strong id="EN-US_TASK_0172363426__b860701190214029">interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen994272582214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword531877766214029">*</span>PE4-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b1166189899214029">stp enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1866941618214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword51848845214029">*</span>PE4-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b1287048097214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1961192180214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1032669813214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363426__b2074069139214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p131462214029"># Enable MSTP on GE <span>0/1/3</span> of PE4.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen136672131214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1744944416214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4] <strong id="EN-US_TASK_0172363426__b1961530768214029">interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen2040347775214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword786689024214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363426__b1375097264214029">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen311034113">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1467013820110">*</span>PE4-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363426__b8811652113">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1263320692214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1162162685214029">*</span>PE4-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363426__b1700291734214029">stp enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1907972155214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword230747856214029">*</span>PE4-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363426__b1278725750214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1710924618214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword2000191249214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363426__b485285782214029">quit</strong></pre>
</li></ul>
</li></ol>
</p></li><li id="EN-US_TASK_0172363426__step2068694691214029"><span id="EN-US_TASK_0172363426__cmd791426707214029">Configure MSTP protection functions, for example, configure root protection on a designated port of a root bridge in each MSTI.</span><p><p id="EN-US_TASK_0172363426__p1231133145214029"># Enable root protection on GE <span>0/1/1</span> of PE1.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen793669197214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1483359023214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363426__b1949116419214029">interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1662419454214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword2030080927214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b2112755018214029">stp root-protection</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen2053199195214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1562572395214029">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b229115265214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen403588180214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1112237708214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b1083265627214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p1174888615214029"># Enable root protection on GE <span>0/1/1</span> of PE3.</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen569316424214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword357635495214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172363426__b2091190348214029">interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1442429672214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1303421152214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b679923915214029">stp root-protection</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1899969346214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword671428199214029">*</span>PE3-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b104097038214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen280837444214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword454279364214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363426__b491130882214029">quit</strong></pre>
</p></li><li id="EN-US_TASK_0172363426__step1763041135214029"><span id="EN-US_TASK_0172363426__cmd452994639214029">Establish the EVC model.</span><p><ol type="a" id="EN-US_TASK_0172363426__ol2014265112214029"><li id="EN-US_TASK_0172363426__li1216392769214029"><p id="EN-US_TASK_0172363426__p2016432790214029"><a name="EN-US_TASK_0172363426__li1216392769214029"></a><a name="li1216392769214029"></a>Configure a bridge domain on each PE. </p>
<p id="EN-US_TASK_0172363426__p291958187214029"># Configure PE1. </p>
<pre class="screen" id="EN-US_TASK_0172363426__screen318405065214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword2112439026214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363426__b144621095214029">bridge-domain 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen2051153369214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword645670362214029">*</span>PE1-bd10] <strong id="EN-US_TASK_0172363426__b616494141214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p1525489184214029"># Configure PE2. </p>
<pre class="screen" id="EN-US_TASK_0172363426__screen214068785214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1050967767214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172363426__b1032816158214029">bridge-domain 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen2108491598214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword256345215214029">*</span>PE2-bd10] <strong id="EN-US_TASK_0172363426__b1250231481214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p1455338868214029"># Configure PE3. </p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1493573547214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1721258283214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172363426__b792258438214029">bridge-domain 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1228961528214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword227989465214029">*</span>PE3-bd10] <strong id="EN-US_TASK_0172363426__b2031613622214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p428222464214029"># Configure PE4. </p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1605838091214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1301771329214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4] <strong id="EN-US_TASK_0172363426__b611710634214029">bridge-domain 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1675067105214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword2111141358214029">*</span>PE4-bd10] <strong id="EN-US_TASK_0172363426__b1479359134214029">quit</strong></pre>
</li><li id="EN-US_TASK_0172363426__li189483937214029"><p id="EN-US_TASK_0172363426__p2085764305214029"><a name="EN-US_TASK_0172363426__li189483937214029"></a><a name="li189483937214029"></a>Create EVC Layer 2 sub-interfaces, add them to the bridge domain, and specify traffic encapsulation types on the EVC Layer 2 sub-interfaces. </p>
</li></ol>
<p id="EN-US_TASK_0172363426__p1508445242214029"># Configure PE1. </p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1434010408214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword520978213214029">*</span>PE1] <strong id="EN-US_TASK_0172363426__b1736883350214029">interface gigabitethernet <span>0/1/1</span>.1 mode l2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1316713581214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword134878645214029">*</span>PE1-GigabitEthernet<span>0/1/1</span>.1] <strong id="EN-US_TASK_0172363426__b693435534214029">encapsulation dot1q vid 1 to 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen777894494214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword321064919214029">*</span>PE1-GigabitEthernet<span>0/1/1</span>.1] <strong id="EN-US_TASK_0172363426__b977838553214029">bridge-domain 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen907814857214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword715723567214029">*</span>PE1-GigabitEthernet<span>0/1/1</span>.1] <strong id="EN-US_TASK_0172363426__b913264010214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1860061121214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1433312854214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/1</span>.1] <strong id="EN-US_TASK_0172363426__b1234106469214029">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen570012936214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1748979784214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363426__b632375212214029">interface gigabitethernet <span>0/1/2</span>.1 mode l2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen878147318214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1875985097214029">*</span>PE1-GigabitEthernet<span>0/1/2</span>.1] <strong id="EN-US_TASK_0172363426__b484203462214029">encapsulation dot1q vid 1 to 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen864885394214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1554973289214029">*</span>PE1-GigabitEthernet<span>0/1/2</span>.1] <strong id="EN-US_TASK_0172363426__b294827674214029">bridge-domain 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen260606766214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1234338595214029">*</span>PE1-GigabitEthernet<span>0/1/2</span>.1] <strong id="EN-US_TASK_0172363426__b934058837214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen890257062214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1748725170214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/2</span>.1] <strong id="EN-US_TASK_0172363426__b1972155097214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p718658560214029"># Configure PE2. </p>
<pre class="screen" id="EN-US_TASK_0172363426__screen885950661214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword755734059214029">*</span>PE2] <strong id="EN-US_TASK_0172363426__b1171059549214029">interface gigabitethernet <span>0/1/2</span>.1 mode l2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1372381690214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword2127684813214029">*</span>PE2-GigabitEthernet<span>0/1/2</span>.1] <strong id="EN-US_TASK_0172363426__b373596714214029">encapsulation dot1q vid 1 to 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen895747791214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword348466058214029">*</span>PE2-GigabitEthernet<span>0/1/2</span>.1] <strong id="EN-US_TASK_0172363426__b1014781223214029">bridge-domain 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1122354708214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1723117707214029">*</span>PE2-GigabitEthernet<span>0/1/2</span>.1] <strong id="EN-US_TASK_0172363426__b1364041745214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen155144507214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword629947088214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/2</span>.1] <strong id="EN-US_TASK_0172363426__b34344099214029">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1757135389214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1153503667214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172363426__b2087808043214029">interface gigabitethernet <span>0/1/3</span>.1 mode l2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen757607496214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword653957446214029">*</span>PE2-GigabitEthernet<span>0/1/3</span>.1] <strong id="EN-US_TASK_0172363426__b1890262272214029">encapsulation dot1q vid 1 to 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen578437782214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword907782096214029">*</span>PE2-GigabitEthernet<span>0/1/3</span>.1] <strong id="EN-US_TASK_0172363426__b189290602214029">bridge-domain 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen221981949214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1243756243214029">*</span>PE2-GigabitEthernet<span>0/1/3</span>.1] <strong id="EN-US_TASK_0172363426__b2002665186214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen2056779558214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1626502191214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/3</span>.1] <strong id="EN-US_TASK_0172363426__b1022050410214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p649004340214029"># Configure PE3. </p>
<pre class="screen" id="EN-US_TASK_0172363426__screen813714695214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword343363598214029">*</span>PE3] <strong id="EN-US_TASK_0172363426__b450540566214029">interface gigabitethernet <span>0/1/1</span>.1 mode l2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen70363398214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1587328187214029">*</span>PE3-GigabitEthernet<span>0/1/1</span>.1] <strong id="EN-US_TASK_0172363426__b801783592214029">encapsulation dot1q vid 1 to 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen560842928214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword525826486214029">*</span>PE3-GigabitEthernet<span>0/1/1</span>.1] <strong id="EN-US_TASK_0172363426__b370964399214029">bridge-domain 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1125966459214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1160184652214029">*</span>PE3-GigabitEthernet<span>0/1/1</span>.1] <strong id="EN-US_TASK_0172363426__b1493276595214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen842369055214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword633398481214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-GigabitEthernet<span>0/1/1</span>.1] <strong id="EN-US_TASK_0172363426__b1869947986214029">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen45544680214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1006929958214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172363426__b1053150209214029">interface gigabitethernet <span>0/1/2</span>.1 mode l2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen629337668214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1812257784214029">*</span>PE3-GigabitEthernet<span>0/1/2</span>.1] <strong id="EN-US_TASK_0172363426__b1526641535214029">encapsulation dot1q vid 1 to 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1720967865214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword918193403214029">*</span>PE3-GigabitEthernet<span>0/1/2</span>.1] <strong id="EN-US_TASK_0172363426__b895910499214029">bridge-domain 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen886267256214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1198195546214029">*</span>PE3-GigabitEthernet<span>0/1/2</span>.1] <strong id="EN-US_TASK_0172363426__b521815653214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1748270625214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword189345428214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-GigabitEthernet<span>0/1/2</span>.1] <strong id="EN-US_TASK_0172363426__b1140962289214029">quit</strong></pre>
<p id="EN-US_TASK_0172363426__p1824983176214029"># Configure PE4. </p>
<pre class="screen" id="EN-US_TASK_0172363426__screen793561074214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword924439030214029">*</span>PE4] <strong id="EN-US_TASK_0172363426__b600037215214029">interface gigabitethernet <span>0/1/2</span>.1 mode l2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1758207361214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword779479460214029">*</span>PE4-GigabitEthernet<span>0/1/2</span>.1] <strong id="EN-US_TASK_0172363426__b344926701214029">encapsulation dot1q vid 1 to 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen689469484214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1970466886214029">*</span>PE4-GigabitEthernet<span>0/1/2</span>.1] <strong id="EN-US_TASK_0172363426__b461039629214029">bridge-domain 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen96649570214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1423326640214029">*</span>PE4-GigabitEthernet<span>0/1/2</span>.1] <strong id="EN-US_TASK_0172363426__b442724823214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen2090564106214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1019487228214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4-GigabitEthernet<span>0/1/2</span>.1] <strong id="EN-US_TASK_0172363426__b1323862727214029">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1964432845214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword831263708214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4] <strong id="EN-US_TASK_0172363426__b1103821209214029">interface gigabitethernet <span>0/1/3</span>.1 mode l2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen274343801214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1662858777214029">*</span>PE4-GigabitEthernet<span>0/1/3</span>.1] <strong id="EN-US_TASK_0172363426__b947288407214029">encapsulation dot1q vid 1 to 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1697464356214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1804109862214029">*</span>PE4-GigabitEthernet<span>0/1/3</span>.1] <strong id="EN-US_TASK_0172363426__b452465974214029">bridge-domain 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen923425195214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1430163926214029">*</span>PE4-GigabitEthernet<span>0/1/3</span>.1] <strong id="EN-US_TASK_0172363426__b713089477214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1187015609214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1501678312214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4-GigabitEthernet<span>0/1/3</span>.1] <strong id="EN-US_TASK_0172363426__b1944294411214029">quit</strong></pre>
</p></li><li id="EN-US_TASK_0172363426__step221566902214029"><span id="EN-US_TASK_0172363426__cmd138278016214029">Verify the configuration.</span><p><p id="EN-US_TASK_0172363426__p602396718214029">After completing the previous configurations, run the following commands to verify the configuration.</p>
<p id="EN-US_TASK_0172363426__p1869218425214029"># Run the <a href="cmdqueryname=display+stp+brief"><b><span class="cmdname" id="EN-US_TASK_0172363426__cmdname388593346214029">display stp brief</span></b></a> command on PE1 to view the interface status and protection types. The displayed information is as follows:</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen874403858214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword913048239214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363426__b1773978296214029">display stp brief</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen579440597214029"> MSTID      Port                  Role  STP State     Protection
   0        GigabitEthernet<span>0/1/1</span>  DESI  FORWARDING    ROOT
   0        GigabitEthernet<span>0/1/2</span>  ROOT  FORWARDING    NONE
   1        GigabitEthernet<span>0/1/1</span>  DESI  FORWARDING    ROOT
   1        GigabitEthernet<span>0/1/2</span>  DESI  FORWARDING    NONE
   2        GigabitEthernet<span>0/1/1</span>  DESI  FORWARDING    ROOT
   2        GigabitEthernet<span>0/1/2</span>  ROOT  FORWARDING    NONE</pre>
<p id="EN-US_TASK_0172363426__p780786926214029">In MSTI 1, PE1 is a root bridge and thus GE <span>0/1/2</span> and GE <span>0/1/1</span> on PE1 are designated ports. In MSTI 2, GE <span>0/1/1</span> on PE1 is a designated port and GE <span>0/1/2</span> is a root port.</p>
<p id="EN-US_TASK_0172363426__p2095249710214029"># Run the <a href="cmdqueryname=display+stp+brief"><b><span class="cmdname" id="EN-US_TASK_0172363426__cmdname990012526214029">display stp brief</span></b></a> command on PE3. The displayed information is as follows:</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1471775147214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1031787194214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172363426__b715550071214029">display stp brief</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1385181848214029"> MSTID      Port                  Role  STP State       Protection
   0        GigabitEthernet<span>0/1/1</span>  DESI  FORWARDING      ROOT
   0        GigabitEthernet<span>0/1/2</span>  DEST  FORWARDING      NONE
   1        GigabitEthernet<span>0/1/1</span>  DESI  FORWARDING      ROOT
   1        GigabitEthernet<span>0/1/2</span>  ROOT  FORWARDING      NONE
   2        GigabitEthernet<span>0/1/1</span>  DESI  FORWARDING      ROOT
   2        GigabitEthernet<span>0/1/2</span>  DESI  FORWARDING      NONE</pre>
<p id="EN-US_TASK_0172363426__p2039442243214029">In MSTI 2, PE3 is a root bridge and thus GE <span>0/1/1</span> and GE <span>0/1/2</span> on PE3 are designated ports. In MSTI 1, GE <span>0/1/1</span> of PE3 is a designated port and GE <span>0/1/2</span> is a root port.</p>
<p id="EN-US_TASK_0172363426__p458975415214029"># Run the <a href="cmdqueryname=display+stp+interface+brief"><b><span class="cmdname" id="EN-US_TASK_0172363426__cmdname1935294665214029">display stp interface brief</span></b></a> command on PE2. The displayed information is as follows:</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1910517189214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword538072426214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172363426__b1668310242214029">display stp interface gigabitethernet <span>0/1/3</span> brief</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1250998572214029"> MSTID      Port                    Role  STP State       Protection
   0        GigabitEthernet<span>0/1/3</span>    ROOT  FORWARDING      NONE
   1        GigabitEthernet<span>0/1/3</span>    ROOT  FORWARDING      NONE
   2        GigabitEthernet<span>0/1/3</span>    ROOT  FORWARDING      NONE</pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen823455439214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword172915282214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172363426__b1568590447214029">display stp interface gigabitethernet <span>0/1/2</span> brief</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen967253021214029"> MSTID      Port                    Role  STP State       Protection
   0        GigabitEthernet<span>0/1/2</span>    ALTE  DISCARDING      NONE
   1        GigabitEthernet<span>0/1/2</span>    DESI  FORWARDING      NONE
   2        GigabitEthernet<span>0/1/2</span>    ALTE  DISCARDING      NONE</pre>
<p id="EN-US_TASK_0172363426__p1503034883214029"># Run the <a href="cmdqueryname=display+stp+interface+brief"><b><span class="cmdname" id="EN-US_TASK_0172363426__cmdname25431919214029">display stp interface brief</span></b></a> command on PE4. The displayed information is as follows:</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen751690116214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword489025099214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4] <strong id="EN-US_TASK_0172363426__b1866062138214029">display stp interface gigabitethernet <span>0/1/3</span> brief</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1655825489214029"> MSTID      Port                    Role  STP State       Protection
   0        GigabitEthernet<span>0/1/3</span>    ROOT  FORWARDING      NONE
   1        GigabitEthernet<span>0/1/3</span>    ROOT  FORWARDING      NONE
   2        GigabitEthernet<span>0/1/3</span>    ROOT  FORWARDING      NONE</pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1660715195214029">[<span class="keyword" id="EN-US_TASK_0172363426__keyword1043778014214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4] <strong id="EN-US_TASK_0172363426__b588468089214029">display stp interface gigabitethernet <span>0/1/2</span> brief</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363426__screen1401426560214029"> MSTID      Port                    Role  STP State       Protection
   0        GigabitEthernet<span>0/1/2</span>    DEST  FORWARDING      NONE
   1        GigabitEthernet<span>0/1/2</span>    ALTE  DISCARDING      NONE
   2        GigabitEthernet<span>0/1/2</span>    DESI  FORWARDING      NONE   </pre>
<p id="EN-US_TASK_0172363426__p1860026212214029">GE <span>0/1/3</span> on PE4 is a root port in both MSTI 1 and MSTI 2. GE <span>0/1/2</span> on PE4 is blocked in MSTI 1 but is calculated to be a designated port in MSTI 2.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172363426__example1231557036214029"><a name="EN-US_TASK_0172363426__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul id="EN-US_TASK_0172363426__ul2122444278214029"><li id="EN-US_TASK_0172363426__li1686288847214029"><p id="EN-US_TASK_0172363426__p1114962070214029"><a name="EN-US_TASK_0172363426__li1686288847214029"></a><a name="li1686288847214029"></a>PE1 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1183963762214029">#
sysname PE1
#
stp instance 1 root primary
stp instance 2 root secondary
stp pathcost-standard legacy
stp enable
#
stp region-configuration
 region-name RG1
 instance 1 vlan 1 to 10
 instance 2 vlan 11 to 20
#
bridge-domain 10
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 portswitch
 stp enable
 stp root-protection
#
interface GigabitEthernet<span>0/1/1</span>.1 mode l2
 encapsulation dot1q vid 1 to 20
 bridge-domain 10
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 portswitch
 stp enable
#
interface GigabitEthernet<span>0/1/2</span>.1 mode l2
 encapsulation dot1q vid 1 to 20
 bridge-domain 10
#
return</pre>
</li><li id="EN-US_TASK_0172363426__li2075268422214029"><p id="EN-US_TASK_0172363426__p1754457627214029"><a name="EN-US_TASK_0172363426__li2075268422214029"></a><a name="li2075268422214029"></a>PE2 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen1388322798214029">#
sysname PE2
#
stp pathcost-standard legacy
stp enable
#
stp region-configuration
 region-name RG1
 instance 1 vlan 1 to 10
 instance 2 vlan 11 to 20
#
bridge-domain 10
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 portswitch
 stp disable
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 portswitch
 stp enable
 stp instance 2 cost 20000
#
interface GigabitEthernet<span>0/1/2</span>.1 mode l2
 encapsulation dot1q vid 1 to 20
 bridge-domain 10
#
interface GigabitEthernet<span>0/1/3</span>
 undo shutdown
 portswitch
 stp enable
#
interface GigabitEthernet<span>0/1/3</span>.1 mode l2
 encapsulation dot1q vid 1 to 20
 bridge-domain 10
#
return</pre>
</li><li id="EN-US_TASK_0172363426__li975599764214029"><p id="EN-US_TASK_0172363426__p867588703214029"><a name="EN-US_TASK_0172363426__li975599764214029"></a><a name="li975599764214029"></a>PE3 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen22802794214029">#
sysname PE3
#
stp instance 1 root secondary
stp instance 2 root primary
stp pathcost-standard legacy
stp enable
#
stp region-configuration
 region-name RG1
 instance 1 vlan 1 to 10
 instance 2 vlan 11 to 20
#
bridge-domain 10
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 portswitch
 stp enable
 stp root-protection
#
interface GigabitEthernet<span>0/1/1</span>.1 mode l2
 encapsulation dot1q vid 1 to 20
 bridge-domain 10
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 portswitch
 stp enable
#
interface GigabitEthernet<span>0/1/2</span>.1 mode l2
 encapsulation dot1q vid 1 to 20
 bridge-domain 10
#
return</pre>
</li><li id="EN-US_TASK_0172363426__li631118697214029"><p id="EN-US_TASK_0172363426__p790207946214029"><a name="EN-US_TASK_0172363426__li631118697214029"></a><a name="li631118697214029"></a>PE4 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172363426__screen837506919214029">#
sysname PE4
#
stp pathcost-standard legacy
stp enable
#
stp region-configuration
 region-name RG1
 instance 1 vlan 1 to 10
 instance 2 vlan 11 to 20
#
bridge-domain 10
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 portswitch
 stp disable
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 portswitch
 stp enable
 stp instance 1 cost 20000
#
interface GigabitEthernet<span>0/1/2</span>.1 mode l2
 encapsulation dot1q vid 1 to 20
 bridge-domain 10
#
interface GigabitEthernet<span>0/1/3</span>
 undo shutdown
 portswitch
 stp enable
#
interface GigabitEthernet<span>0/1/3</span>.1 mode l2
 encapsulation dot1q vid 1 to 20
 bridge-domain 10
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evc_cfg_0018.html">Configuration Examples for EVC
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evc_cfg_0042.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>