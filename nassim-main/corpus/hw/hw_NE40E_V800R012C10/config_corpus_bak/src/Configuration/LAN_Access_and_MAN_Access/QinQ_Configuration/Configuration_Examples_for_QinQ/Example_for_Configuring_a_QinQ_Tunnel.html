
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a QinQ Tunnel">
<meta name="abstract" content="After Layer 2 QinQ tunneling is configured, an enterprise can plan its own VLANs. Branch offices of the same enterprise in different locations can communicate with each other through the VLANs. Offices of different enterprises cannot communicate.">
<meta name="description" content="After Layer 2 QinQ tunneling is configured, an enterprise can plan its own VLANs. Branch offices of the same enterprise in different locations can communicate with each other through the VLANs. Offices of different enterprises cannot communicate.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0023_1.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0025_1.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wWX1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172363292">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring a QinQ Tunnel</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172363292"></a><a name="EN-US_TASK_0172363292"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a QinQ Tunnel</h1>
<div class="taskbody"><p>After Layer 2 QinQ tunneling is configured, an enterprise can plan its own VLANs. Branch offices of the same enterprise in different locations can communicate with each other through the VLANs. Offices of different enterprises cannot communicate.</p>
<div class="context"><a name="EN-US_TASK_0172363292__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0172363292__en-us_task_0172363199_context2127382379214028"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0172363292__en-us_task_0172363199_p1967806458214028">On the network shown in <a href="#EN-US_TASK_0172363292__en-us_task_0172363199_fig_dc_vrp_qinq_cfg_002401">Figure 1</a>, company 1 has three offices and company 2 has two offices. Offices of company 1 and company 2 are connected to PE1 and PE2 on the carrier network. Company 1 and company 2 can plan their own VLANs as required.</p>
<p id="EN-US_TASK_0172363292__en-us_task_0172363199_p1205845287214028">You can configure Layer 2 QinQ tunneling on PE1 and PE2 so that offices of the same company can interwork but offices of different companies cannot interwork.</p>
<div class="fignone" id="EN-US_TASK_0172363292__en-us_task_0172363199_fig_dc_vrp_qinq_cfg_002401"><a name="EN-US_TASK_0172363292__en-us_task_0172363199_fig_dc_vrp_qinq_cfg_002401"></a><a name="en-us_task_0172363199_fig_dc_vrp_qinq_cfg_002401"></a><span class="figcap"><b>Figure 1 </b>Typical networking of Layer 2 QinQ tunneling</span><div class="note" id="EN-US_TASK_0172363292__en-us_task_0172363199_note1591203512214028"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172363292__en-us_task_0172363199_p743570093214028">In this example, interfaces 1 through 4 represent GE<span>0/1/1</span>, GE<span>0/2/1</span>, GE<span>0/3/1</span>, and GE<span>0/1/4</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0172363292__en-us_task_0172363199_image9435180175810" src="figure/en-us_image_0000001505509640.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363292__1.4.2"></a><a name="1.4.2"></a>
<div class="p" id="EN-US_TASK_0172363292__en-us_task_0172363199_context945130717214028"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0172363292__en-us_task_0172363199_p2008343388214028">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0172363292__en-us_task_0172363199_ol192141203214028"><li id="EN-US_TASK_0172363292__en-us_task_0172363199_li1833493831214028"><p id="EN-US_TASK_0172363292__en-us_task_0172363199_p1287966814214028"><a name="EN-US_TASK_0172363292__en-us_task_0172363199_li1833493831214028"></a><a name="en-us_task_0172363199_li1833493831214028"></a>Configure outer VLAN tags for QinQ packets.</p>
</li><li id="EN-US_TASK_0172363292__en-us_task_0172363199_li1007127809214028"><p id="EN-US_TASK_0172363292__en-us_task_0172363199_p330980209214028"><a name="EN-US_TASK_0172363292__en-us_task_0172363199_li1007127809214028"></a><a name="en-us_task_0172363199_li1007127809214028"></a>Configure Layer 2 QinQ tunneling so that packets exchanged between VLAN users become double-tagged QinQ packets after passing through the QinQ tunnel.</p>
</li><li id="EN-US_TASK_0172363292__en-us_task_0172363199_li991330928214028"><p id="EN-US_TASK_0172363292__en-us_task_0172363199_p1120773470214028"><a name="EN-US_TASK_0172363292__en-us_task_0172363199_li991330928214028"></a><a name="en-us_task_0172363199_li991330928214028"></a>Configure interfaces on which Layer 2 QinQ tunneling is not configured. These interfaces allow packets carrying the specified outer VLAN tags to pass through so that users of the same company from different VLANs can communicate.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363292__1.4.3"></a><a name="1.4.3"></a>
<div class="p" id="EN-US_TASK_0172363292__en-us_task_0172363199_context1872180607214028"><h4 class="sectiontitle">Data Preparation</h4><p id="EN-US_TASK_0172363292__en-us_task_0172363199_p1631073701214028">To complete the configuration, you need the following data:</p>
<ul id="EN-US_TASK_0172363292__en-us_task_0172363199_ul1992925127214028"><li id="EN-US_TASK_0172363292__en-us_task_0172363199_li301761562214028"><p id="EN-US_TASK_0172363292__en-us_task_0172363199_p1497681967214028"><a name="EN-US_TASK_0172363292__en-us_task_0172363199_li301761562214028"></a><a name="en-us_task_0172363199_li301761562214028"></a>Number of the access interfaces of company 1 and company 2</p>
</li><li id="EN-US_TASK_0172363292__en-us_task_0172363199_li474005736214028"><p id="EN-US_TASK_0172363292__en-us_task_0172363199_p1597558229214028"><a name="EN-US_TASK_0172363292__en-us_task_0172363199_li474005736214028"></a><a name="en-us_task_0172363199_li474005736214028"></a>Outer VLAN IDs of the QinQ interfaces for company 1 and company 2 access</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172363292__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0172363292__en-us_task_0172363199_steps1044196758214028"><li id="EN-US_TASK_0172363292__en-us_task_0172363199_step2004858585214028"><span id="EN-US_TASK_0172363292__en-us_task_0172363199_cmd1639816665214028">Create outer VLAN tags for Layer 2 QinQ tunneling.</span><p><p id="EN-US_TASK_0172363292__en-us_task_0172363199_p1573076107214028"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1493881346214028">&lt;<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword2525498214028">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1567647841214028">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1272491346214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword180733195214028"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1040931507214028">HUAWEI</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b84423527214028">sysname PE1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen18951275214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1709381699214028">*</span><span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword541985527214028">HUAWEI</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b917379904214028">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen986017515214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword2133570621214028"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b716361109214028">vlan batch 10 20</strong></pre>
<p id="EN-US_TASK_0172363292__en-us_task_0172363199_p1695751056214028"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen317137023214028">&lt;<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1167647933214028">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1341811285214028">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1147700429214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1893270996214028"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword940432173214028">HUAWEI</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b2008093628214028">sysname PE2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen454205854214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword852202895214028">*</span><span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1405614422214028">HUAWEI</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b111701514214028">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen179965396214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword283787854214028"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1325117224214028">vlan batch 10 20</strong></pre>
</p></li><li id="EN-US_TASK_0172363292__en-us_task_0172363199_step1292001109214028"><span id="EN-US_TASK_0172363292__en-us_task_0172363199_cmd1455484146214028">Configure Layer 2 QinQ tunneling.</span><p><p id="EN-US_TASK_0172363292__en-us_task_0172363199_p1235638303214028"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen690620984214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1461613884214028">*</span>PE1] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b903451437214028">interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen304836943214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword486500488214028">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b4343193214028">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1500839214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword91094112214028">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1044212774214028">port link-type dot1q-tunnel</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1380402340214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1183802370214028">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b368920349214028">port default vlan 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1521416899214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1585046840214028">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b581638246214028">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen812416278214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword557537542214028">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b409258087214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1167551422214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1274077321214028">*</span>PE1]<strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1562747065214028"> interface gigabitethernet <span>0/2/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1199729392214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1275660358214028">*</span>PE1-GigabitEthernet<span>0/2/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1044137787214028">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen40115938214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1618791195214028">*</span>PE1-GigabitEthernet<span>0/2/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b307665945214028">port link-type dot1q-tunnel</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1916150346214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword563934988214028">*</span>PE1-GigabitEthernet<span>0/2/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1379648272214028">port default vlan 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen245718074214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword2063213909214028">*</span>PE1-GigabitEthernet<span>0/2/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1179280965214028">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1579342462214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword369501580214028">*</span>PE1-GigabitEthernet<span>0/2/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b886745284214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen652284805214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1050326745214028">*</span>PE1]<strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1857383073214028"> interface gigabitethernet <span>0/3/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen673807184214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1327865234214028">*</span>PE1-GigabitEthernet<span>0/3/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1612034064214028">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen408020371214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword254893620214028">*</span>PE1-GigabitEthernet<span>0/3/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b943702136214028">port link-type dot1q-tunnel</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1364557187214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword371172965214028">*</span>PE1-GigabitEthernet<span>0/3/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b780970707214028">port default vlan 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen866262170214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1704886107214028">*</span>PE1-GigabitEthernet<span>0/3/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1911273067214028">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1655249426214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword689955418214028">*</span>PE1-GigabitEthernet<span>0/3/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1045821523214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1992730524214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1057276321214028">*</span>PE1] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1547228093214028">commit</strong></pre>
<p id="EN-US_TASK_0172363292__en-us_task_0172363199_p228039390214028"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen2083310098214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword659799108214028">*</span>PE2] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b612363687214028">interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen34732284214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1749168987214028">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1382885304214028">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen308915618214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword246100063214028">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b775927032214028">port link-type dot1q-tunnel</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1180625893214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1266522411214028">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1909445948214028">port default vlan 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1243073540214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword2042032939214028">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1856239490214028">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1672028518214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword2083093978214028">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1758021955214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1004646402214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1256428743214028">*</span>PE2] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1747447528214028">interface gigabitethernet <span>0/2/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen887671700214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword32822616214028">*</span>PE2-GigabitEthernet<span>0/2/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b340317569214028">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen628180541214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1970783443214028">*</span>PE2-GigabitEthernet<span>0/2/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b267360852214028">port link-type dot1q-tunnel</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen232255563214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword87973386214028">*</span>PE2-GigabitEthernet<span>0/2/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b203264753214028">port default vlan 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen36694085214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1672540439214028">*</span>PE2-GigabitEthernet<span>0/2/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b2136002738214028">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1340603237214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1229539365214028">*</span>PE2-GigabitEthernet<span>0/2/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b2066575193214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1973015394214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1930969346214028">*</span>PE2]<strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1600082062214028"> commit</strong></pre>
</p></li><li id="EN-US_TASK_0172363292__en-us_task_0172363199_step1770911140214028"><span id="EN-US_TASK_0172363292__en-us_task_0172363199_cmd1727666207214028">Configure other interfaces.</span><p><p id="EN-US_TASK_0172363292__en-us_task_0172363199_p1632592755214028"># Configure GE<span>0/1/4</span> on PE1 to allow packets from VLAN 10 and VLAN 20 to pass through.</p>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen983585136214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword515257253214028"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b825372044214028">interface gigabitethernet <span>0/1/4</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen509797889214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1544288519214028">*</span>PE1-GigabitEthernet<span>0/1/4</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b2077085098214028">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1237061589214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword459412446214028">*</span>PE1-GigabitEthernet<span>0/1/4</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b2072696502214028">port link-type trunk</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen784170287214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword170879288214028">*</span>PE1-GigabitEthernet<span>0/1/4</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b2113521375214028">port trunk allow-pass vlan 10 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1848561253214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1002402271214028">*</span>PE1-GigabitEthernet<span>0/1/4</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1792107667214028">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1356329017214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1912495087214028">*</span>PE1-GigabitEthernet<span>0/1/4</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b2051917665214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen227612568214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1606974941214028">*</span>PE1] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b731508246214028">commit</strong></pre>
<p id="EN-US_TASK_0172363292__en-us_task_0172363199_p1476023782214028"># Configure GE<span>0/3/1</span> on PE2 to allow packets from VLAN 10 and VLAN 20 to pass through.</p>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen722517762214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword660631702214028"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1843261094214028">interface gigabitethernet <span>0/3/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1764027738214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1889168780214028">*</span>PE2-GigabitEthernet<span>0/3/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b370788270214028">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1943969034214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword2042616724214028">*</span>PE2-GigabitEthernet<span>0/3/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b2000689829214028">port link-type trunk</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1862275263214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword18797344214028">*</span>PE2-GigabitEthernet<span>0/3/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b655863964214028">port trunk allow-pass vlan 10 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen316472971214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1315197141214028">*</span>PE2-GigabitEthernet<span>0/3/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b483169504214028">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1834790087214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1612733500214028">*</span>PE2-GigabitEthernet<span>0/3/1</span>] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1143247496214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen1984389342214028">[<span class="keyword" id="EN-US_TASK_0172363292__en-us_task_0172363199_keyword1850171110214028">*</span>PE2] <strong id="EN-US_TASK_0172363292__en-us_task_0172363199_b1064693885214028">commit</strong></pre>
</p></li><li id="EN-US_TASK_0172363292__en-us_task_0172363199_step1746633800214028"><span id="EN-US_TASK_0172363292__en-us_task_0172363199_cmd1720305757214028">Verify the configuration.</span><p><p id="EN-US_TASK_0172363292__en-us_task_0172363199_p851948192214028">Hosts of company 1 in different offices but the same VLAN can ping each other. </p>
<p id="EN-US_TASK_0172363292__en-us_task_0172363199_p1692752948214028">Hosts of company 2 in different offices but the same VLAN can ping each other. </p>
<p id="EN-US_TASK_0172363292__en-us_task_0172363199_p1401757286214028">Hosts of company 1 cannot ping hosts of company 2.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172363292__en-us_task_0172363199_example1684915648214028"><a name="EN-US_TASK_0172363292__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul id="EN-US_TASK_0172363292__en-us_task_0172363199_ul168562847214028"><li id="EN-US_TASK_0172363292__en-us_task_0172363199_li123469455214028"><p id="EN-US_TASK_0172363292__en-us_task_0172363199_p681927183214028"><a name="EN-US_TASK_0172363292__en-us_task_0172363199_li123469455214028"></a><a name="en-us_task_0172363199_li123469455214028"></a>PE1 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen701196696214028">#
 sysname PE1
#
 vlan batch 10 20
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 portswitch
 port link-type dot1q-tunnel
 port default vlan 10
#
interface GigabitEthernet<span>0/2/1</span>
 undo shutdown
 portswitch
 port link-type dot1q-tunnel
 port default vlan 20
#
interface GigabitEthernet<span>0/3/1</span>
 undo shutdown
 portswitch
 port link-type dot1q-tunnel
 port default vlan 10
#
interface GigabitEthernet<span>0/1/4</span>
 undo shutdown
 portswitch
 port link-type trunk
 port trunk allow-pass vlan 10 20
#
return</pre>
</li><li id="EN-US_TASK_0172363292__en-us_task_0172363199_li1967426993214028"><p id="EN-US_TASK_0172363292__en-us_task_0172363199_p1739758492214028"><a name="EN-US_TASK_0172363292__en-us_task_0172363199_li1967426993214028"></a><a name="en-us_task_0172363199_li1967426993214028"></a>PE2 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172363292__en-us_task_0172363199_screen2020718507214028">#
 sysname PE2
#
 vlan batch 10 20
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 portswitch
 port link-type dot1q-tunnel
 port default vlan 20
#
interface GigabitEthernet<span>0/2/1</span>
 undo shutdown
 portswitch
 port link-type dot1q-tunnel
 port default vlan 10
#
interface GigabitEthernet<span>0/3/1</span>
 undo shutdown
 portswitch
 port link-type trunk
 port trunk allow-pass vlan 10 20
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0023_1.html">Configuration Examples for QinQ
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0025_1.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>