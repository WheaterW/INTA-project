
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a VLAN Tag Termination Sub-interface">
<meta name="abstract" content="A virtual local area network (VLAN) tag termination sub-interface can be a dot1q VLAN tag termination sub-interface or a QinQ VLAN tag termination sub-interface. In dot1q/QinQ termination, a device identifies whether a packet has one tag or two tags. The device then forwards the packet after stripping one or both tags or discards the packet.">
<meta name="description" content="A virtual local area network (VLAN) tag termination sub-interface can be a dot1q VLAN tag termination sub-interface or a QinQ VLAN tag termination sub-interface. In dot1q/QinQ termination, a device identifies whether a packet has one tag or two tags. The device then forwards the packet after stripping one or both tags or discards the packet.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0012.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0057.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wwx1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172363264">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring a VLAN Tag Termination Sub-interface</title>
</head>
<body><a name="EN-US_TASK_0172363264"></a><a name="EN-US_TASK_0172363264"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a VLAN Tag Termination Sub-interface</h1>
<div class="taskbody"><p>A virtual local area network (VLAN) tag termination sub-interface can be a dot1q VLAN tag termination sub-interface or a QinQ VLAN tag termination sub-interface. In dot1q/QinQ termination, a device identifies whether a packet has one tag or two tags. The device then forwards the packet after stripping one or both tags or discards the packet.</p>
<div class="context"><a name="EN-US_TASK_0172363264__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>An increasing number of QinQ encapsulation and termination modes have been developed to distinguish users or services and reduce the use of virtual local area network (VLAN) IDs. These QinQ encapsulation and termination modes enable carriers to implement refined operation.</p>
<p>Users may communicate over various types of Layer 2 virtual private networks (L2VPNs), such as a virtual private wire service (VPWS) or virtual private LAN service (VPLS). To achieve more flexibility in managing packets for these users, you can configure QinQ VLAN tag termination sub-interfaces on edge devices on the L2VPN and configure the attributes of the sub-interfaces to provide L2VPN access.</p>
<p>QinQ VLAN tag termination sub-interfaces can access VPWS or VPLS in symmetrical or asymmetrical mode. User packets are sent to the L2VPN in different modes after being processed by the PE, as described in <a href="#EN-US_TASK_0172363264__tab_01">Table 1</a> and <a href="#EN-US_TASK_0172363264__tab_02">Table 2</a>.</p>

<div class="tableBorder"><a name="EN-US_TASK_0172363264__tab_01"></a><a name="tab_01"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172363264__tab_01" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Packet processing on an inbound interface</caption><thead align="left"><tr><th align="left" class="cellrowborder" rowspan="2" valign="top" id="mcps1.4.1.4.2.4.1.1" liSelected="liSelected"><p>Inbound Interface Type</p>
</th>
<th align="left" class="cellrowborder" colspan="2" valign="top" id="mcps1.4.1.4.2.4.1.2" liSelected="liSelected"><p>VPWS/VPLS</p>
</th>
</tr>
<tr><th align="left" class="cellrowborder" valign="top" id="mcps1.4.1.4.2.4.2.1" liSelected="liSelected"><p>Ethernet Encapsulation</p>
</th>
<th align="left" class="cellrowborder" valign="top" id="mcps1.4.1.4.2.4.2.2" liSelected="liSelected"><p>VLAN Encapsulation</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.2.4.1.1 "><p>Symmetry mode</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.2.4.1.2 mcps1.4.1.4.2.4.2.1 "><p>Removes the outer tag.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.2.4.1.2 mcps1.4.1.4.2.4.2.2 "><p>Keeps both inner and outer tags unchanged.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.2.4.1.1 "><p>Asymmetrical mode</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.2.4.1.2 mcps1.4.1.4.2.4.2.1 "><p>Removes both inner and outer tags.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.2.4.1.2 mcps1.4.1.4.2.4.2.2 "><p>Removes both inner and outer tags and adds another tag.</p>
</td>
</tr>
</tbody>
</table>
</div>

<div class="tableBorder"><a name="EN-US_TASK_0172363264__tab_02"></a><a name="tab_02"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172363264__tab_02" frame="border" border="1" rules="all"><caption><b>Table 2 </b>Packet processing on an outbound interface</caption><thead align="left"><tr><th align="left" class="cellrowborder" rowspan="2" valign="top" id="mcps1.4.1.5.2.4.1.1" liSelected="liSelected"><p>Outbound Interface Type</p>
</th>
<th align="left" class="cellrowborder" colspan="2" valign="top" id="mcps1.4.1.5.2.4.1.2" liSelected="liSelected"><p>VPWS/VPLS</p>
</th>
</tr>
<tr><th align="left" class="cellrowborder" valign="top" id="mcps1.4.1.5.2.4.2.1" liSelected="liSelected"><p>Ethernet Encapsulation</p>
</th>
<th align="left" class="cellrowborder" valign="top" id="mcps1.4.1.5.2.4.2.2" liSelected="liSelected"><p>VLAN Encapsulation</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="33.44334433443344%" headers="mcps1.4.1.5.2.4.1.1 "><p>Symmetry mode</p>
</td>
<td class="cellrowborder" valign="top" width="33.44334433443344%" headers="mcps1.4.1.5.2.4.1.2 mcps1.4.1.5.2.4.2.1 "><p>Adds an outer tag.</p>
</td>
<td class="cellrowborder" valign="top" width="33.11331133113312%" headers="mcps1.4.1.5.2.4.1.2 mcps1.4.1.5.2.4.2.2 "><p>Replaces the outer tag.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.44334433443344%" headers="mcps1.4.1.5.2.4.1.1 "><p>Asymmetrical mode</p>
</td>
<td class="cellrowborder" valign="top" width="33.44334433443344%" headers="mcps1.4.1.5.2.4.1.2 mcps1.4.1.5.2.4.2.1 "><p>Adds two tags.</p>
</td>
<td class="cellrowborder" valign="top" width="33.11331133113312%" headers="mcps1.4.1.5.2.4.1.2 mcps1.4.1.5.2.4.2.2 "><p>Removes the existing tag, and adds two tags.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p" id="EN-US_TASK_0172363264__en-us_concept_0172363210_p1839042762214028">To configure VLAN encapsulation or Ethernet encapsulation, run the <a href="cmdqueryname=encapsulation+%28VSI+view%29"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_concept_0172363210_cmdname459946539214028">encapsulation (VSI view)</span></b></a> command.<ul id="EN-US_TASK_0172363264__en-us_concept_0172363210_ul1704211703214028"><li id="EN-US_TASK_0172363264__en-us_concept_0172363210_li2019318708214028"><p id="EN-US_TASK_0172363264__en-us_concept_0172363210_p2005451815214028"><a name="EN-US_TASK_0172363264__en-us_concept_0172363210_li2019318708214028"></a><a name="en-us_concept_0172363210_li2019318708214028"></a>VLAN encapsulation</p>
<p id="EN-US_TASK_0172363264__en-us_concept_0172363210_p2089068270214028">Each Ethernet frame transmitted between CEs and PEs carries a VLAN tag called a Provider-Tag (P-tag). The tag is a service delimiter required by a carrier for user differentiation.</p>
</li><li id="EN-US_TASK_0172363264__en-us_concept_0172363210_li517051069214028"><p id="EN-US_TASK_0172363264__en-us_concept_0172363210_p1358480921214028"><a name="EN-US_TASK_0172363264__en-us_concept_0172363210_li517051069214028"></a><a name="en-us_concept_0172363210_li517051069214028"></a>Ethernet encapsulation</p>
<p id="EN-US_TASK_0172363264__en-us_concept_0172363210_p1252050304214028">Ethernet frames transmitted between CEs and PEs do not carry P-tags. If an Ethernet frame carries a VLAN tag, the tag is an internal VLAN tag called a User-Tag (U-tag). It is carried in a user packet before the packet is sent to a CE. The U-tag is used by the CE to identify the packet and is meaningless to the PE.</p>
</li></ul>
</div>
</div></div>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172363264__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure a dot1q VLAN tag termination sub-interface.</span><p><ol><li><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p1147144422011">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname2068608992214028">system-view</span></b></a></p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p573277117214028">The system view is displayed.</p>
</li><li><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p524102702116">Run <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname271602996214028">interface</span></b></a> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname647930865214028">interface-type interface-number.subinterface-number</span></i></p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p2048295801214028">The view of the PE's Ethernet sub-interface connecting to the user side is displayed.</p>
</li><li><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p2104807058214028">(Optional) Create a user VLAN group.</p>
<ol type="a" id="EN-US_TASK_0172363264__en-us_task_0172363258_ol_1"><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li1771904166214028"><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p948954094214312"><a name="EN-US_TASK_0172363264__en-us_task_0172363258_li1771904166214028"></a><a name="en-us_task_0172363258_li1771904166214028"></a>Run <a href="cmdqueryname=vlan-group"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname1712192296214028">vlan-group</span></b></a> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname1028502291214028">group-id</span></i></p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p739469088214312">A user VLAN group is created.</p>
</li><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li967913461214028"><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p182182833511"><a name="EN-US_TASK_0172363264__en-us_task_0172363258_li967913461214028"></a><a name="en-us_task_0172363258_li967913461214028"></a>Run <a href="cmdqueryname=group+mode"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname38288312351">group mode</span></b></a> { <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname2828123123514">single</span></strong> | <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname148281931183513">multiple</span></strong> }</p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p274165163513">The working mode of the VLAN group is configured.</p>
<ul id="EN-US_TASK_0172363264__en-us_task_0172363258_ul332236645214028"><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li909258174214028"><strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname408498366214028">single</span></strong>: A VLAN group is considered as a user. This means that you cannot collect statistics about QinQ packets or deploy quality of service (QoS) policies based on a VLAN or a VLAN range.</li><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li980140465214028"><p id="EN-US_TASK_0172363264__en-us_task_0172363258_li980140465214028p0"><a name="EN-US_TASK_0172363264__en-us_task_0172363258_li980140465214028"></a><a name="en-us_task_0172363258_li980140465214028"></a><strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname2021222765214028">multiple</span></strong>: VLANs and VLAN ranges in a VLAN group are considered as different users. This means that you can collect statistics about QinQ packets or deploy QoS policies based on a VLAN or VLAN range to implement refined management.</p>
</li></ul>
</li><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li1511047054214028"><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p1818445943214312"><a name="EN-US_TASK_0172363264__en-us_task_0172363258_li1511047054214028"></a><a name="en-us_task_0172363258_li1511047054214028"></a>Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname565663257214028">quit</span></b></a></p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p935179603214312">Return to the view of the PE's Ethernet sub-interface connecting to the user side.</p>
</li></ol>
<div class="note" id="EN-US_TASK_0172363264__en-us_task_0172363258_note_1"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p1583683060214028">Configuring a VLAN group allows you to achieve the following purposes:</p>
<ul id="EN-US_TASK_0172363264__en-us_task_0172363258_ul1787138538214028"><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li845962212214028">Deploy QoS policies based on services or users so that higher priority service traffic is preferentially forwarded, improving user experience.</li><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li1638708273214028">View statistics about QinQ packets to check whether a device is functioning properly.</li></ul>
</div></div>
</li><li><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p1295014357554">Run <a href="cmdqueryname=control-vid"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname29501335185516">control-vid</span></b></a> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname9950635115511">vid</span></i> <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname19501351555">dot1q-termination</span></strong> [ <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname2095023513557">rt-protocol</span></strong> ] or <a href="cmdqueryname=encapsulation"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname9950135155513">encapsulation</span></b></a> <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname10950103519556">dot1q-termination</span></strong> [ <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname159509359556">rt-protocol</span></strong> ]</p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p24912504552">The encapsulation type is configured as dot1q VLAN tag termination for the sub-interface.</p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p14151125915557">Specify <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname142084739214028">rt-protocol</span></strong> so that the dot1q VLAN tag termination sub-interface supports routing protocols.</p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p_1">To enable the dot1q VLAN tag termination sub-interface to support routing protocols, specify <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname1552419141566">rt-protocol</span></strong>.</p>
</li><li>Configure the dot1q VLAN tag termination sub-interface<span> using one or more of the following commands</span> based on site requirements:<ul id="EN-US_TASK_0172363264__en-us_task_0172363258_ul1074711032214028"><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li90923504214028">To configure a dot1q VLAN tag termination sub-interface, run the <a href="cmdqueryname=dot1q+termination+vid"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname1302204724214028">dot1q termination vid</span></b></a> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname90010312214028">low-pe-vid</span></i> [ <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname1717204086214028">to</span></strong> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname1453111016214028">high-pe-vid</span></i> ] [ <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname923057369214028">vlan-group</span></strong> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname1519870117214028">group-id</span></i> ] command.</li><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li1435718023214028"><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p986554869214028"><a name="EN-US_TASK_0172363264__en-us_task_0172363258_li1435718023214028"></a><a name="en-us_task_0172363258_li1435718023214028"></a>To configure a dot1q VLAN tag termination sub-interface and a matching policy for the sub-interface, run the <a href="cmdqueryname=dot1q+termination+vid"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname751900866214028">dot1q termination vid</span></b></a> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname241923706214028">low-pe-vid</span></i> [ <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname1758244705214028">to</span></strong> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname1759296233214028">high-pe-vid</span></i> ] { <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname2088370397214028">8021p</span></strong> { <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname1476941439214028">val8021p1</span></i> [ <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname1887189330214028">to</span></strong> <em id="EN-US_TASK_0172363264__en-us_task_0172363258_i107861440192112">val8021p2</em> ] } &amp;&lt;1-8&gt; | <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname1442456084214028">dscp</span></strong> { <em id="EN-US_TASK_0172363264__en-us_task_0172363258_i1565315813221">valdscp1</em> [ <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname1002109378214028">to</span></strong> <em id="EN-US_TASK_0172363264__en-us_task_0172363258_i4128912172217">valdscp2</em> ] } &amp;&lt;1-10&gt; | <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname719559204214028">eth-type PPPoE</span></strong> | <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname379721584214028">default</span></strong> } [ <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname1766795729214028">vlan-group</span></strong> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname137124585214028">group-id</span></i> ] command.</p>
</li></ul>
<div class="note" id="EN-US_TASK_0172363264__en-us_task_0172363258_note425707214028"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul id="EN-US_TASK_0172363264__en-us_task_0172363258_ul712406608214028"><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li1019830709214028"><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p1227739456214028"><a name="EN-US_TASK_0172363264__en-us_task_0172363258_li1019830709214028"></a><a name="en-us_task_0172363258_li1019830709214028"></a>The preceding commands are all used to configure a dot1q VLAN tag termination sub-interface. If you do not configure any matching policy, the dot1q VLAN tag termination sub-interface terminates the VLAN tags of packets carrying the specified VLAN ID. If you configure a matching policy, the dot1q VLAN tag termination sub-interface terminates the VLAN tags of packets carrying the specified VLAN ID+802.1p value/DSCP value/EthType.</p>
</li><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li477675139214028"><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p992188687214028"><a name="EN-US_TASK_0172363264__en-us_task_0172363258_li477675139214028"></a><a name="en-us_task_0172363258_li477675139214028"></a>After the <a href="cmdqueryname=dot1q+termination+vid"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname662825728214028">dot1q termination vid</span></b></a> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname1641960535214028">low-pe-vid</span></i> [ <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname172237062214028">to</span></strong> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname1560009246214028">high-pe-vid</span></i> ] [ <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname2042387622214028">vlan-group</span></strong> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname361760227214028">group-id</span></i> ] command is run in the Ethernet sub-interface view, the specified VLAN range belongs to the sub-interface, and any VLAN ID in the VLAN range cannot be configured together with the 802.1p value/DSCP value/EthType on other sub-interfaces.</p>
</li></ul>
</div></div>
</li><li><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p324350125310">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname164440968214028">commit</span></b></a></p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p2039648316214028">The configuration is committed.</p>
</li></ol>
</p></li><li><span>Configure a QinQ VLAN tag termination sub-interface.</span><p><ol><li><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p1147144422011_1">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname2068608992214028_1">system-view</span></b></a></p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p573277117214028_1">The system view is displayed.</p>
</li><li><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p524102702116_1">Run <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname271602996214028_1">interface</span></b></a> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname647930865214028_1">interface-type interface-number.subinterface-number</span></i></p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p2048295801214028_1">The view of the PE's Ethernet sub-interface connecting to the user side is displayed.</p>
</li><li><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p2104807058214028_1">(Optional) Create a user VLAN group.</p>
<ol type="a" id="EN-US_TASK_0172363264__en-us_task_0172363258_ol_1_1"><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li1771904166214028_1"><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p948954094214312_1"><a name="EN-US_TASK_0172363264__en-us_task_0172363258_li1771904166214028_1"></a><a name="en-us_task_0172363258_li1771904166214028_1"></a>Run <a href="cmdqueryname=vlan-group"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname1712192296214028_1">vlan-group</span></b></a> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname1028502291214028_1">group-id</span></i></p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p739469088214312_1">A user VLAN group is created.</p>
</li><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li967913461214028_1"><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p182182833511_1"><a name="EN-US_TASK_0172363264__en-us_task_0172363258_li967913461214028_1"></a><a name="en-us_task_0172363258_li967913461214028_1"></a>Run <a href="cmdqueryname=group+mode"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname38288312351_1">group mode</span></b></a> { <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname2828123123514_1">single</span></strong> | <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname148281931183513_1">multiple</span></strong> }</p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p274165163513_1">The working mode of the VLAN group is configured.</p>
<ul id="EN-US_TASK_0172363264__en-us_task_0172363258_ul332236645214028_1"><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li909258174214028_1"><strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname408498366214028_1">single</span></strong>: A VLAN group is considered as a user. This means that you cannot collect statistics about QinQ packets or deploy quality of service (QoS) policies based on a VLAN or a VLAN range.</li><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li980140465214028_1"><p id="EN-US_TASK_0172363264__en-us_task_0172363258_li980140465214028p0_1"><a name="EN-US_TASK_0172363264__en-us_task_0172363258_li980140465214028_1"></a><a name="en-us_task_0172363258_li980140465214028_1"></a><strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname2021222765214028_1">multiple</span></strong>: VLANs and VLAN ranges in a VLAN group are considered as different users. This means that you can collect statistics about QinQ packets or deploy QoS policies based on a VLAN or VLAN range to implement refined management.</p>
</li></ul>
</li><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li1511047054214028_1"><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p1818445943214312_1"><a name="EN-US_TASK_0172363264__en-us_task_0172363258_li1511047054214028_1"></a><a name="en-us_task_0172363258_li1511047054214028_1"></a>Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname565663257214028_1">quit</span></b></a></p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p935179603214312_1">Return to the view of the PE's Ethernet sub-interface connecting to the user side.</p>
</li></ol>
<div class="note" id="EN-US_TASK_0172363264__en-us_task_0172363258_note_1_1"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p1583683060214028_1">Configuring a VLAN group allows you to achieve the following purposes:</p>
<ul id="EN-US_TASK_0172363264__en-us_task_0172363258_ul1787138538214028_1"><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li845962212214028_1">Deploy QoS policies based on services or users so that higher priority service traffic is preferentially forwarded, improving user experience.</li><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li1638708273214028_1">View statistics about QinQ packets to check whether a device is functioning properly.</li></ul>
</div></div>
</li><li><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p19824348105816">Run <a href="cmdqueryname=control-vid"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname544014478214028">control-vid</span></b></a> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname1992763496214028">vid</span></i> <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname974057367214028">qinq-termination</span></strong> [ <span><strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname1880245753214028">local-switch</span></strong> | </span><strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname3023363214028">rt-protocol</span></strong> ] or <a href="cmdqueryname=encapsulation"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname373077056214028">encapsulation</span></b></a> <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname220019265214028">qinq-termination</span></strong> [ <span><strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname1971283362214028">local-switch</span></strong> | </span><strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname1893475673214028">rt-protocol</span></strong> ]</p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p9715193320586">The encapsulation type is configured as QinQ VLAN tag termination for the sub-interface.</p>
<ul id="EN-US_TASK_0172363264__en-us_task_0172363258_ul1953423517542"><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li1534535115416">Specify <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname4123574495">local-switch</span></strong> so that the QinQ VLAN tag termination sub-interface supports local switching.</li><li id="EN-US_TASK_0172363264__en-us_task_0172363258_li1653413357541"><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p4534203535418"><a name="EN-US_TASK_0172363264__en-us_task_0172363258_li1653413357541"></a><a name="en-us_task_0172363258_li1653413357541"></a>Specify <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname5611165911497">rt-protocol</span></strong> so that the QinQ VLAN tag termination sub-interface supports routing protocols.</p>
</li></ul>
</li><li><p>Run <a href="cmdqueryname=qinq+termination+l2"><b><span class="cmdname">qinq termination l2</span></b></a> { <strong><span>asymmetry</span></strong> | <strong><span>symmetry</span></strong> [ <strong><span>user-mode</span></strong> ] }</p>
<p>The termination mode is configured for the QinQ VLAN tag termination sub-interface that provides L2VPN access.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This step takes effect only on QinQ VLAN tag termination sub-interfaces that provide L2VPN access, not L3VPN access. This means that before you configure a QinQ VLAN tag termination sub-interface that provides L2VPN access, configure the termination mode of the sub-interface.</p>
</div></div>
<ul><li><p>If the <a href="cmdqueryname=qinq+termination+l2"><b><span class="cmdname">qinq termination l2</span></b></a> <strong><span>symmetry</span></strong> command is used on a QinQ VLAN tag termination sub-interface, the sub-interface connects to the L2VPN in symmetrical mode. MAC address learning is performed only on the outer tags carried in packets. The sub-interface sends inner tags as part of the data to the peer, implementing inner tag isolation. To configure QoS for inner tags, run the <a href="cmdqueryname=qinq+termination+l2"><b><span class="cmdname">qinq termination l2</span></b></a> <strong><span>symmetry</span></strong> <strong><span>user-mode</span></strong> command.</p>
</li><li><p>If the <a href="cmdqueryname=qinq+termination+l2"><b><span class="cmdname">qinq termination l2</span></b></a> <strong><span>asymmetry</span></strong> command is used on a QinQ VLAN tag termination sub-interface, the sub-interface connects to the L2VPN in asymmetrical mode. MAC address learning is performed on both inner and outer tags carried in packets. The sub-interface does not send inner tags as part of the data to the peer.</p>
</li><li><p>If the <a href="cmdqueryname=qinq+termination+l2"><b><span class="cmdname">qinq termination l2</span></b></a> <strong><span>asymmetry</span></strong> command is run on a QinQ VLAN tag termination sub-interface, the sub-interface can terminate single inner and outer VLAN tags carried in packets but cannot terminate VLAN tag ranges.</p>
</li></ul>
</li><li><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p1919017388911">Run <a href="cmdqueryname=qinq+termination+pe-vid"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname1681915753214028">qinq termination pe-vid</span></b></a> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname967370351214028">pe-vid</span></i> [ <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname1609060928214028">to</span></strong> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname2003342744214028">high-pe-vid</span></i> ] <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname1175107279214028">ce-vid</span></strong> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname349017209214028">ce-vid</span></i> [ <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname1413165037214028">to</span></strong> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname208608820214028">high-ce-vid</span></i> ] [ <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname1393342562214028">vlan-group</span></strong> <i><span class="varname" id="EN-US_TASK_0172363264__en-us_task_0172363258_varname1048107441214028">group-id</span></i> ]</p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p23018586817">The encapsulation type is configured as QinQ VLAN tag termination for the sub-interface.</p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p_3">If <strong><span id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdparmname1831176795214028">rt-protocol</span></strong> is specified, the QinQ VLAN tag termination sub-interface terminates double-tagged packets whose inner and outer tags contain only single VLAN IDs (not VLAN ranges).</p>
</li><li><p id="EN-US_TASK_0172363264__en-us_task_0172363258_p324350125310_1">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172363264__en-us_task_0172363258_cmdname164440968214028_1">commit</span></b></a></p>
<p id="EN-US_TASK_0172363264__en-us_task_0172363258_p2039648316214028_1">The configuration is committed.</p>
</li></ol>
</p></li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0012.html">Configuring a VLAN Tag Termination Sub-interface to Transmit the VPN Service
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0057.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>