
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a VLAN-based MAC Address Learning Limit Rule">
<meta name="abstract" content="Configuring a VLAN-based MAC address learning limit rule can control the number of users in a VLAN. If the number of learned MAC addresses reaches the maximum, no additional MAC addresses will be learned. In addition, the packet discarding and alarm functions can be configured to prevent MAC address attacks and improve network security.">
<meta name="description" content="Configuring a VLAN-based MAC address learning limit rule can control the number of users in a VLAN. If the number of learned MAC addresses reaches the maximum, no additional MAC addresses will be learned. In addition, the packet discarding and alarm functions can be configured to prevent MAC address attacks and improve network security.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mac_cfg_0008.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mac_cfg_0009.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mac_cfg_0020.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MAC">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MAC">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="MAC">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="MAC">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wWX1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172362756">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring a VLAN-based MAC Address Learning Limit Rule</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172362756"></a><a name="EN-US_TASK_0172362756"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a VLAN-based MAC Address Learning Limit Rule</h1>
<div class="taskbody"><p>Configuring a VLAN-based MAC address learning limit rule can control the number of users in a VLAN. If the number of learned MAC addresses reaches the maximum, no additional MAC addresses will be learned. In addition, the packet discarding and alarm functions can be configured to prevent MAC address attacks and improve network security.</p>
<div class="context"><a name="EN-US_TASK_0172362756__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>Networks with poor security management, such as community networks, are vulnerable to hackers' MAC address attacks. The capacity of a MAC address table is limited. When hackers forge a large number of packets with different source MAC addresses and send the packets to a device, the MAC address table of the device will be filled up. Even if the device can receive valid packets, it cannot learn the source MAC addresses of the packets.</p>
<p>On the network shown in <a href="#EN-US_TASK_0172362756__fig_dc_vrp_mac_cfg_001001">Figure 1</a>, user network 1 connects to the CE through S1. S1 connects to interface1 on the CE. User network 2 connects to the CE through S2. S2 connects to interface2 on the CE. Interface1 and interface2 belong to VLAN 2. To prevent MAC address attacks and control the number of users in VLAN 2, configure a MAC address learning limit for VLAN 2.</p>
<div class="fignone" id="EN-US_TASK_0172362756__fig_dc_vrp_mac_cfg_001001"><a name="EN-US_TASK_0172362756__fig_dc_vrp_mac_cfg_001001"></a><a name="fig_dc_vrp_mac_cfg_001001"></a><span class="figcap"><b>Figure 1 </b>Networking diagram of a VLAN-based MAC address learning limit rule</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interfaces 1 and 2 represent GE<span>0/1/1</span> and GE<span>0/2/1</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001316257210.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362756__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Create a VLAN and add the interfaces to the VLAN.</p>
</li><li><p>Configure a VLAN-based MAC address learning limit rule to control the number of users in the VLAN, preventing MAC address attacks and improving network safety.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362756__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>ID of the VLAN to which the interfaces belong</p>
</li><li><p>Number of each user interface</p>
</li><li><p>Maximum number of MAC addresses that can be learned</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172362756__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure a MAC address learning limit rule.</span><p><p># Add GE <span>0/1/1</span> and GE <span>0/2/1</span> to VLAN 2.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname CE</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE]<strong> vlan 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-vlan2]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/1/1</span>]<strong> portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/1/1</span>]<strong> port link-type trunk</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/1/1</span>]<strong> port trunk allow-pass vlan 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/1/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE]<strong> interface gigabitethernet <span>0/2/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/2/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/2/1</span>]<strong> portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/2/1</span>]<strong> port link-type trunk</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/2/1</span>]<strong> port trunk allow-pass vlan 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/2/1</span>]<strong> quit</strong></pre>
<p># Configure the MAC address learning limit rule for VLAN 2: a maximum of 100 MAC addresses can be learned; additional packets are forwarded but their MAC addresses cannot be added to the MAC address table.</p>
<pre class="screen">[<span class="keyword">*</span>CE]<strong> vlan 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-vlan2]<strong> mac-limit maximum 100 <span>rate 50 </span>action forward</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-vlan2]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE-vlan2]<strong> quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>Run the <a href="cmdqueryname=display+mac-limit"><b><span class="cmdname">display mac-limit</span></b></a> command in any view to check whether the MAC address learning limit rule is configured successfully.</p>
<pre class="screen">[<span class="keyword">*</span>CE]<strong> display mac-limit</strong></pre>
<pre class="screen">MAC limit is enabled
Total MAC limit rule count : 1

PORT     VLAN/BD/VSI      SLOT Maximum Rate(ms) Action  Alarm
----------------------------------------------------------------------------
-        2                -    100     50       forward disable</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172362756__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><pre class="screen">#
sysname CE
#
vlan batch 2
#
vlan 2
 <span>mac-limit maximum 100 <span>rate 50 </span>action forward</span>
#
interface GigabitEthernet<span>0/1/1</span>
 portswitch
 undo shutdown
 port link-type trunk
 port trunk allow-pass vlan 2
#
interface GigabitEthernet<span>0/2/1</span>
 portswitch
 undo shutdown
 port link-type trunk
 port trunk allow-pass vlan 2
#
return</pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mac_cfg_0008.html">Configuration Examples for MAC
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mac_cfg_0009.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mac_cfg_0020.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>