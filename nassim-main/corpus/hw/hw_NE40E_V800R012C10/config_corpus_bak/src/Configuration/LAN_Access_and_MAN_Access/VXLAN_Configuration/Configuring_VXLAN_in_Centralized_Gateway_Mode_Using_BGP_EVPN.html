
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring VXLAN in Centralized Gateway Mode Using BGP EVPN">
<meta name="abstract" content="VXLAN can be deployed in centralized gateway mode so that all inter-subnet traffic is forwarded through Layer 3 gateways, thereby implementing centralized traffic management.">
<meta name="description" content="VXLAN can be deployed in centralized gateway mode so that all inter-subnet traffic is forwarded through Layer 3 gateways, thereby implementing centralized traffic management.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1082.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0017.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0018b.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1214.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1215.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_0023b.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0021b.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1049.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="p00915595">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="p00915595">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001884468548">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring VXLAN in Centralized Gateway Mode Using BGP EVPN</title>
</head>
<body><a name="EN-US_TASK_0000001884468548"></a><a name="EN-US_TASK_0000001884468548"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring VXLAN in Centralized Gateway Mode Using BGP EVPN</h1>
<div class="taskbody"><p>VXLAN can be deployed in centralized gateway mode so that all inter-subnet traffic is forwarded through Layer 3 gateways, thereby implementing centralized traffic management.</p>
<div class="context"><a name="EN-US_TASK_0000001884468548__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>An enterprise may allocate VMs in different locations to a tenant over an IPv4 network. Some VMs are on the same subnet, while others are not. To allow communication between VMs, properly deploy Layer 2 and Layer 3 VXLAN gateways and establish VXLAN tunnels.</p>
<div class="p">On the network shown in <a href="#EN-US_TASK_0000001884468548__en-us_task_0274174836_fig_dc_vrp_vxlan_cfg_103901">Figure 1</a>, Server2 and Server3 belong to the same subnet and access the VXLAN through Device1 and Device2, respectively. Server1 and Server2 belong to different subnets and both access the VXLAN through Device1.<ul><li>To enable communication between VM1 on Server2 and VM1 on Server3, deploy Layer 2 VXLAN gateways on Device1 and Device2 and establish a VXLAN tunnel between Device1 and Device2 so that tenants on the same subnet can communicate.</li><li>To enable communication between VM1 on Server1 and VM1 on Server3, deploy a Layer 3 VXLAN gateway on Device3 and establish VXLAN tunnels between Device1 and Device3 and between Device2 and Device3 so that tenants on different subnets can communicate.</li></ul>
</div>
<p>The VMs and Layer 3 VXLAN gateway can be allocated either IPv4 or IPv6 addresses. This means that either an IPv4 or IPv6 overlay network can be used with IPv4 VXLAN. <a href="#EN-US_TASK_0000001884468548__en-us_task_0274174836_fig_dc_vrp_vxlan_cfg_103901">Figure 1</a> shows an IPv4 overlay network.</p>
<div class="fignone" id="EN-US_TASK_0000001884468548__en-us_task_0274174836_fig_dc_vrp_vxlan_cfg_103901"><a name="EN-US_TASK_0000001884468548__en-us_task_0274174836_fig_dc_vrp_vxlan_cfg_103901"></a><a name="en-us_task_0274174836_fig_dc_vrp_vxlan_cfg_103901"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring VXLAN in centralized gateway mode</span><br><span><img class="vsd" src="figure/en-us_image_0000002126480901.png" width="NaN" height="NaN"></span></div>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If only VMs on the same subnet need to communicate with each other, Layer 3 VXLAN gateways do not need to be deployed. If VMs on different subnets need to communicate with each other or VMs on the same subnet need to communicate with external networks, Layer 3 VXLAN gateways must be deployed.</p>
</div></div>
<div class="p">The following table lists the differences in centralized gateway configuration between IPv4 and IPv6 overlay networks.
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.1.7.1.1.4.1.1" liSelected="liSelected"><p>Configuration Task</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.1.7.1.1.4.1.2" liSelected="liSelected"><p>IPv4 Overlay Network</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.1.7.1.1.4.1.3" liSelected="liSelected"><p>IPv6 Overlay Network</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.7.1.1.4.1.1 "><p>Configure a Layer 3 VXLAN gateway.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.7.1.1.4.1.2 "><p>Configure an IPv4 address for the VBDIF interface of the Layer 3 gateway.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.7.1.1.4.1.3 "><p>Configure an IPv6 address for the VBDIF interface of the Layer 3 gateway.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001884468548__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Prerequisites</h4><div class="p">Before configuring VXLAN in centralized gateway mode using BGP EVPN, complete the following task:<ul><li>Configure a routing protocol to ensure Layer 3 connectivity.</li></ul>
</div>
</div></div>
</div>

<ul class="ullinks">
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0018b.html">Configuring a VXLAN Service Access Point</a>
</dt>
<dd>
Layer 2 sub-interfaces are used for service access on VXLANs. These Layer 2 sub-interfaces can have different encapsulation types configured to transmit various types of data packets. A Layer 2 sub-interface can transmit data packets through a BD after being associated with it.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1214.html">Configuring a VXLAN Tunnel</a>
</dt>
<dd>
To allow VXLAN tunnel establishment between VTEPs using EVPN, establish a BGP EVPN peer relationship, configure an EVPN instance, and configure ingress replication.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1215.html">Configuring a Layer 3 VXLAN Gateway</a>
</dt>
<dd>
To allow users on different network segments to communicate, a Layer 3 VXLAN gateway must be deployed, and the default gateway address of the users must be the IP address of the VBDIF interface of the Layer 3 gateway.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_0023b.html">(Optional) Configuring a Static MAC Address Entry</a>
</dt>
<dd>
Using static MAC address entries to forward user packets helps reduce BUM traffic on the network and prevent bogus attacks.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0021b.html">(Optional) Configuring a Limit on the Number of MAC Addresses Learned by an Interface</a>
</dt>
<dd>
MAC address learning limiting helps improve VXLAN network security.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1049.html">Verifying the Configuration of VXLAN in Centralized Gateway Mode Using BGP EVPN</a>
</dt>
<dd>
After configuring VXLAN in centralized gateway mode for dynamic tunnel establishment, check VXLAN tunnel, VNI, and VBDIF interface information.</dd>
</dl>
</ul>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1082.html">VXLAN Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0017.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0001.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>