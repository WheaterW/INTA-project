
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring SBFD for SR-MPLS BE Tunnel">
<meta name="abstract" content="This section describes how to configure SBFD for SR-MPLS BE to detect SR-MPLS BE tunnel faults.">
<meta name="description" content="This section describes how to configure SBFD for SR-MPLS BE to detect SR-MPLS BE tunnel faults.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0201.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr-te_cfg_0002.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909,l00587852">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00468467">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368831">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring SBFD for SR-MPLS BE Tunnel</title>
</head>
<body><a name="EN-US_TASK_0172368831"></a><a name="EN-US_TASK_0172368831"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring SBFD for SR-MPLS BE Tunnel</h1>
<div class="taskbody"><p>This section describes how to configure SBFD for SR-MPLS BE to detect SR-MPLS BE tunnel faults.</p>
<div class="context"><a name="EN-US_TASK_0172368831__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>With SBFD for SR-MPLS BE, applications such as VPN FRR can be triggered to perform a fast traffic switching when the primary tunnel fails, minimizing the impact on services.</p>
<p>This configuration task applies to both common SR-MPLS BE tunnels and Flex-Algo-based SR-MPLS BE tunnels.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368831__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring SBFD for SR-MPLS BE tunnel, complete the following tasks:</p>
<ul><li><p>Configure an SR-MPLS BE tunnel.</p>
</li><li><p>Run the <a href="cmdqueryname=mpls+lsr-id"><b><span class="cmdname">mpls lsr-id</span></b></a> <i><span class="varname">lsr-id</span></i> command to configure an LSR ID and ensure that the route from the peer to the local address specified using <i><span class="varname">lsr-id</span></i> is reachable.</p>
</li></ul>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172368831__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configuring an SBFD Initiator</span><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a></span></span><p><p>BFD is globally enabled.</p>
</p><p><p>You can set BFD parameters only after running the <a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a> command to enable global BFD.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=sbfd"><b><span class="cmdname">sbfd</span></b></a></span><p><p>SBFD is enabled globally, and the SBFD view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368831__substep150633217214048"><span id="EN-US_TASK_0172368831__cmd1956741953214048">(Optional) Run <a href="cmdqueryname=destination+ipv4"><b><span class="cmdname" id="EN-US_TASK_0172368831__cmdname997633621214048">destination ipv4</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368831__varname1349269702214048">ip-address</span></i> <a href="cmdqueryname=remote-discriminator"><b><span class="cmdname" id="EN-US_TASK_0172368831__cmdname1949284797214048">remote-discriminator</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368831__varname186970532214048">discriminator-value</span></i></span><p><p id="EN-US_TASK_0172368831__p614020275419">The mapping between the SBFD reflector IP address and discriminator is configured.</p>
</p><p><p id="EN-US_TASK_0172368831__p63691039173514">On the device functioning as an SBFD initiator, if the mapping between the SBFD reflector IP address and discriminator is configured using the <a href="cmdqueryname=destination+ipv4+remote-discriminator"><b><span class="cmdname" id="EN-US_TASK_0172368831__cmdname96080537358">destination ipv4 remote-discriminator</span></b></a> command, the initiator uses the configured discriminator to negotiate with the reflector in order to establish an SBFD session. If such a mapping is not configured, the SBFD initiator uses the reflector IP address as a discriminator by default to complete the negotiation.</p>
<p id="EN-US_TASK_0172368831__p168531811389">This step is optional. If it is performed, the value of <i><span class="varname" id="EN-US_TASK_0172368831__varname9928825123820">discriminator-value</span></i> must be the same as that of <i><span class="varname" id="EN-US_TASK_0172368831__varname15715493911">unsigned-integer-value</span></i> in the <a href="cmdqueryname=reflector+discriminator"><b><span class="cmdname" id="EN-US_TASK_0172368831__cmdname1624275019386">reflector discriminator</span></b></a> command configured on the reflector.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=segment-routing"><b><span class="cmdname">segment-routing</span></b></a></span></span><p><p>The Segment Routing view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=seamless-bfd+enable"><b><span class="cmdname">seamless-bfd enable</span></b></a> <strong><span>mode</span></strong> <strong><span>tunnel</span></strong> [ <strong><span>filter-policy</span></strong> <strong><span>ip-prefix</span></strong> <i><span class="varname">ip-prefix-name</span></i> | <strong><span>effect-sr-lsp</span></strong> ] <sup>*</sup></span></span><p><p>SBFD is enabled for the SR-MPLS tunnel.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=seamless-bfd"><b><span class="cmdname">seamless-bfd</span></b></a> <strong><span>tunnel</span></strong> { <strong><span>min-rx-interval</span></strong> <i><span class="varname">receive-interval</span></i> | <strong><span>min-tx-interval</span></strong> <i><span class="varname">transmit-interval</span></i> | <strong><span>detect-multiplier</span></strong> <i><span class="varname">multiplier-value</span></i> } <sup>*</sup></span><p><p>SBFD parameters are set for the SR-MPLS tunnel.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=seamless-bfd+flex-algo"><b><span class="cmdname">seamless-bfd flex-algo</span></b></a> <strong><span>exclude</span></strong> { <i><span class="varname">flex-algo-begin</span></i> [ <strong><span>to</span></strong> <i><span class="varname">flex-algo-end</span></i> ] } &amp;&lt;1-10&gt;</span><p><p>Flex-Algos that do not require SBFD session establishment are excluded.</p>
</p><p><p>After the <span><a href="cmdqueryname=seamless-bfd+enable"><b><span class="cmdname">seamless-bfd enable</span></b></a></span> command is run, SBFD sessions are established for all common SR-MPLS BE tunnels and Flex-Algo-based SR-MPLS BE tunnels. If some Flex-Algo-based SR-MPLS BE tunnels do not require SBFD session establishment, run the preceding command to exclude the corresponding Flex-Algos.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368831__substep6611345510"><span id="EN-US_TASK_0172368831__cmd6611541357">(Optional) Configure an IS-IS SBFD source address.</span><p><p id="EN-US_TASK_0172368831__p875153312104">In IS-IS multi-process scenarios, you can configure source addresses for SBFD sessions in different IS-IS processes.</p>
<p id="EN-US_TASK_0172368831__p47071016181010">By default, MPLS LSR IDs are used to create SBFD sessions. During SBFD deployment, only an LSR ID can be used as the source of an SBFD session, but the source belongs to only one IS-IS process. As a result, in the multi-process scenarios, LSR ID-based host routes must be imported in route import mode. Otherwise, SBFD cannot take effect. If IS-IS process isolation prevents route import, the device must support SBFD session establishment using different sources in different IS-IS processes.</p>
<ol type="a" id="EN-US_TASK_0172368831__ol5619192115106"><li id="EN-US_TASK_0172368831__li96191421131015">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0172368831__cmdname364520181633">quit</span></b></a><p id="EN-US_TASK_0172368831__p18124161913318">Return to the system view.</p>
</li><li id="EN-US_TASK_0172368831__li26196219109">Run <a href="cmdqueryname=isis"><b><span class="cmdname" id="EN-US_TASK_0172368831__cmdname846734117274">isis</span></b></a> [ <i><span class="varname" id="EN-US_TASK_0172368831__varname3467541112712">process-id</span></i> ]<p id="EN-US_TASK_0172368831__p201541742202710">The IS-IS view is displayed.</p>
</li><li id="EN-US_TASK_0172368831__li961962191011">Run <a href="cmdqueryname=cost-style"><b><span class="cmdname" id="EN-US_TASK_0172368831__cmdname19797330834">cost-style</span></b></a> { <strong><span id="EN-US_TASK_0172368831__cmdparmname17971130339">wide</span></strong> | <strong><span id="EN-US_TASK_0172368831__cmdparmname17797030437">compatible</span></strong> | <strong><span id="EN-US_TASK_0172368831__cmdparmname57971830533">wide-compatible</span></strong> }<p id="EN-US_TASK_0172368831__p15240031139">The IS-IS wide metric is configured.</p>
</li><li id="EN-US_TASK_0172368831__li176191213105"><p id="EN-US_TASK_0172368831__p67599019213"><a name="EN-US_TASK_0172368831__li176191213105"></a><a name="li176191213105"></a>Run <a href="cmdqueryname=segment-routing+mpls"><b><span class="cmdname" id="EN-US_TASK_0172368831__cmdname07593011219">segment-routing mpls</span></b></a></p>
<p id="EN-US_TASK_0172368831__p25291913214">IS-IS SR-MPLS is enabled.</p>
</li><li id="EN-US_TASK_0172368831__li11619821141017">Run <a href="cmdqueryname=segment-routing+sbfd+source-address"><b><span class="cmdname" id="EN-US_TASK_0172368831__cmdname17441739933">segment-routing sbfd source-address</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368831__varname1744113918310">ip-address</span></i><p id="EN-US_TASK_0172368831__p11400103917319">An SBFD source address is configured.</p>
</li></ol>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configuring an SBFD Reflector</span><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a></span></span><p><p>BFD is globally enabled.</p>
</p><p><p>You can set BFD parameters only after running the <a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a> command to enable global BFD.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=sbfd"><b><span class="cmdname">sbfd</span></b></a></span><p><p>SBFD is enabled globally, and the SBFD view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=reflector+discriminator"><b><span class="cmdname">reflector discriminator</span></b></a> { <i><span class="varname">unsigned-integer-value</span></i> | <i><span class="varname">ip-address-value</span></i> }</span></span><p><p>A discriminator is configured for the SBFD reflector.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
<div class="postreq"><a name="EN-US_TASK_0172368831__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After successfully configuring SBFD for SR-MPLS BE tunnel, run the <a href="cmdqueryname=display+segment-routing+seamless-bfd+tunnel+session"><b><span class="cmdname">display segment-routing seamless-bfd tunnel session</span></b></a> [ <strong><span>prefix</span></strong> <i><span class="varname">ip-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } ] [ <strong><span>flex-algo</span></strong> [ <i><span class="varname">flexAlgoId</span></i> ] ] command to check information about the SBFD session that monitors the SR tunnel.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0000.html">Segment Routing MPLS Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0201.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr-te_cfg_0002.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>