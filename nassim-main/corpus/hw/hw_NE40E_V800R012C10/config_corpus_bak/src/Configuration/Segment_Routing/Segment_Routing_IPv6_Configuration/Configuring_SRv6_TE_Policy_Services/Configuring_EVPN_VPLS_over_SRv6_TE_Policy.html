
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring EVPN VPLS over SRv6 TE Policy">
<meta name="abstract" content="This section describes how to configure EVPN VPLS over SRv6 TE Policy so that EVPN VPLSs can be carried over SRv6 TE Policies.">
<meta name="description" content="This section describes how to configure EVPN VPLS over SRv6 TE Policy so that EVPN VPLSs can be carried over SRv6 TE Policies.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0131.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_evpn-vpws_over_srv6-te_policy.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0228.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00587852">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0194319216">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring EVPN VPLS over SRv6 TE Policy</title>
</head>
<body><a name="EN-US_TASK_0194319216"></a><a name="EN-US_TASK_0194319216"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring EVPN VPLS over SRv6 TE Policy</h1>
<div class="taskbody" id="taskbody1569402501793"><p id="shortdesc10481832172748">This section describes how to configure EVPN VPLS over SRv6 TE Policy so that EVPN VPLSs can be carried over SRv6 TE Policies.</p>
<div class="context"><a name="EN-US_TASK_0194319216__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0194319216__context1677625172748"><div class="p" id="EN-US_TASK_0194319216__context1677625172748"><h4 class="sectiontitle">Usage Scenario</h4><p id="EN-US_TASK_0194319216__p2032626805214049">EVPN VPLS uses the EVPN E-LAN model to carry MP2MP VPLSs. EVPN VPLS over SRv6 TE Policy uses public SRv6 TE Policies to carry EVPN VPLSs. As shown in <a href="#EN-US_TASK_0194319216__fig_dc_vrp_srv6_cfg_all_002101">Figure 1</a>, PE1 and PE2 communicate through an IPv6 public network. An SRv6 TE Policy is deployed on the network to carry EVPN VPLSs.</p>
<div class="fignone" id="EN-US_TASK_0194319216__fig_dc_vrp_srv6_cfg_all_002101"><a name="EN-US_TASK_0194319216__fig_dc_vrp_srv6_cfg_all_002101"></a><a name="fig_dc_vrp_srv6_cfg_all_002101"></a><span class="figcap"><b>Figure 1 </b>EVPN VPLS over SRv6 TE Policy networking</span><br><span><img class="vsd" id="EN-US_TASK_0194319216__image1028806706214049" src="figure/en-us_image_0194320129.png" width="NaN" height="NaN"></span></div>
<h4 class="sectiontitle">Pre-configuration Tasks</h4><p id="EN-US_TASK_0194319216__p503891719214049">Before configuring EVPN VPLS over SRv6 TE Policy, complete the following tasks:</p>
<ul id="EN-US_TASK_0194319216__ul788735101212"><li id="EN-US_TASK_0194319216__li16894356128"><a href="dc_vrp_srv6_cfg_all_0110.html">Configure an SRv6 TE Policy manually</a> or <a href="dc_vrp_srv6_cfg_all_0116.html">use a controller to dynamically deliver an SRv6 TE Policy</a>.</li></ul>
<ul id="EN-US_TASK_0194319216__ul388518137214049"><li id="EN-US_TASK_0194319216__li0145546163519"><p id="EN-US_TASK_0194319216__p31451246123514"><a name="EN-US_TASK_0194319216__li0145546163519"></a><a name="li0145546163519"></a><a href="dc_vrp_evpn_cfg_0065.html">Configure BD EVPN</a> between PE1 and PE2.</p>
</li></ul>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0194319216__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0194319216__steps10132325172748"><li id="EN-US_TASK_0194319216__step1274795457214049"><span id="EN-US_TASK_0194319216__cmd42899680214049">Establish a BGP EVPN peer relationship between PEs.</span><ol type="a" id="EN-US_TASK_0194319216__substeps1134867418214049"><li class="substepexpand" id="EN-US_TASK_0194319216__substep2146337079214049"><span id="EN-US_TASK_0194319216__cmd56984447214049">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname251129927214049">system-view</span></b></a></span><p><p id="EN-US_TASK_0194319216__p1644715185411">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep18492171619389"><span id="EN-US_TASK_0194319216__cmd11492516193811">Run <a href="cmdqueryname=bgp"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname116698463382">bgp</span></b></a> { <i><span class="varname" id="EN-US_TASK_0194319216__varname168741723571">as-number-plain</span></i> | <i><span class="varname" id="EN-US_TASK_0194319216__varname2875102312714">as-number-dot</span></i> }</span><p><p id="EN-US_TASK_0194319216__p717920312410">The BGP view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep1310520433382"><span id="EN-US_TASK_0194319216__cmd9104114311384">(Optional) Run <a href="cmdqueryname=router-id"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname105642136433">router-id</span></b></a> <i><span class="varname" id="EN-US_TASK_0194319216__varname15834838675">ipv4-address</span></i></span><p><p id="EN-US_TASK_0194319216__p1629314441344">A BGP router ID is configured.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep318850188214049"><span id="EN-US_TASK_0194319216__cmd943410451214049">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname184901730124416">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0194319216__varname758115533714">ipv6-address</span></i> <strong><span id="EN-US_TASK_0194319216__cmdparmname85825531371">as-number</span></strong> { <i><span class="varname" id="EN-US_TASK_0194319216__varname175831153571">as-number-plain</span></i> | <i><span class="varname" id="EN-US_TASK_0194319216__varname1559112536715">as-number-dot</span></i> }</span><p><p id="EN-US_TASK_0194319216__p96473750">The remote PE is configured as a peer.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep1355958814214049"><span id="EN-US_TASK_0194319216__cmd503324934214049">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname070521184911">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0194319216__varname34411658978">ipv6-address</span></i> <strong><span id="EN-US_TASK_0194319216__cmdparmname11446458570">connect-interface</span></strong> <strong><span id="EN-US_TASK_0194319216__cmdparmname244719582075">loopback</span></strong> <i><span class="varname" id="EN-US_TASK_0194319216__varname4448135812715">interface-number</span></i></span><p><p id="EN-US_TASK_0194319216__p8916161859">The interface on which a TCP connection to the specified BGP peer is established is specified.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep950151211506"><span id="EN-US_TASK_0194319216__cmd85021213503">Run <a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname12575204917506">l2vpn-family evpn</span></b></a></span><p><p id="EN-US_TASK_0194319216__p08992287516">The BGP EVPN address family view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep1949053210506"><span id="EN-US_TASK_0194319216__cmd11490143216508">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname34477232114">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0194319216__varname123761751585">ipv6-address</span></i> <strong><span id="EN-US_TASK_0194319216__cmdparmname153778519810">enable</span></strong></span><p><p id="EN-US_TASK_0194319216__p82166391551">The device is enabled to exchange EVPN routes with the specified peer.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep18230869535"><span id="EN-US_TASK_0194319216__cmd1923016645314">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname1649235515126">peer</span></b></a> { <i><span class="varname" id="EN-US_TASK_0194319216__varname192031681589">ipv6-address</span></i> | <i><span class="varname" id="EN-US_TASK_0194319216__varname42041181783">group-name</span></i> } <strong><span id="EN-US_TASK_0194319216__cmdparmname172051481489">advertise encap-type srv6</span></strong></span><p><p id="EN-US_TASK_0194319216__p77234511953">The device is enabled to send EVPN routes carrying SRv6-encapsulated attributes to the specified peer or peer group.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep18545181010302"><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmd392762818519">(Optional) Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdname1439632714419">peer</span></b></a> { <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0176593776_varname160111443225">ipv6-address</span></i> | <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0176593776_varname1060194442213">group-name</span></i> } <strong><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdparmname1939652713414">srv6-label-compatible</span></strong></span><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p18744102015112">SRv6 label compatibility is enabled.</p>
</p><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p131484441213">According to relevant standards, the MPLS Label2 field of IRB routes and the ESI Label field of ES-AD routes sent to SRv6 peers should both be set to 3 in non-transposition scenarios. By default, however, the value of the MPLS Label2 field in IRB routes is a specific MPLS label, and that of the ESI Label field in ES-AD routes is a specific ESI. After the <strong id="EN-US_TASK_0194319216__en-us_task_0176593776_en-us_task_0172368965_b1333261581113">peer srv6-label-compatible</strong> command is run, the value of the MPLS Label2 field in IRB routes and that of the ESI Label field in ES-AD routes are both changed to 3. To ensure proper interworking between Huawei and non-Huawei devices, you can run this command.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep1486616210487"><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmd1592715281516">(Optional) Run <a href="cmdqueryname=peer+srv6-label-compatible+inclusive-route"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdname6153144141714">peer</span></b></a> { <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0176593776_varname9153114141715">ipv6-address</span></i> | <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0176593776_varname1415311419173">group-name</span></i> } <strong><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdparmname115317441719">srv6-label-compatible inclusive-route</span></strong></span><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p2420192265017">SRv6 label compatibility for inclusive routes is enabled.</p>
</p><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p176421514143618">According to relevant standards, the MPLS Label field in the PMSI attribute of an inclusive route sent to an SRv6 peer should be set to 0 in non-transposition scenarios. By default, however, this field is set to 3 for such a route. After the <strong id="EN-US_TASK_0194319216__en-us_task_0176593776_b1460395674613">peer srv6-label-compatible inclusive-route</strong> command is run, the value of this field is changed to 0. To ensure proper interworking between Huawei and non-Huawei devices, you can run this command.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep1912615011164"><span id="EN-US_TASK_0194319216__cmd1412619015161">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname116073407265">quit</span></b></a></span><p><p id="EN-US_TASK_0194319216__p175219212610">Exit the BGP EVPN address family view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep1641315556257"><span id="EN-US_TASK_0194319216__cmd154131355142519">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname390112717333">quit</span></b></a></span><p><p id="EN-US_TASK_0194319216__p9857121110611">Exit the BGP view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep43011548203312"><span id="EN-US_TASK_0194319216__cmd8301448133314">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname89961164343">commit</span></b></a></span><p><p id="EN-US_TASK_0194319216__p1831423868">The configuration is committed.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0194319216__step4934745133020"><span id="EN-US_TASK_0194319216__cmd1893364511308">On each PE, configure EVPN VPLSs to recurse to an SRv6 TE Policy.</span><ol type="a" id="EN-US_TASK_0194319216__substeps2262171010335"><li class="substepexpand" id="EN-US_TASK_0194319216__substep1092014388133"><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmd1043712309441">(Optional) Run <a href="cmdqueryname=evpn+srv6+next-header-field"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdname4480156165418">evpn srv6 next-header-field</span></b></a> { <strong><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdparmname1793514311558">59</span></strong> | <strong><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdparmname1818817508616">143</span></strong> }</span><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p1576145019336">A value is set for the Next Header field in an SRv6 extension header.</p>
</p><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p245712013573">If the value is 59 in earlier versions, you can perform this step to change the value to 59 to ensure compatibility with the earlier versions.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep8131183915136"><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmd1562546822214049">Run <a href="cmdqueryname=segment-routing+ipv6"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdname1795325734214049">segment-routing ipv6</span></b></a></span><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p237165214543">SRv6 is enabled, and the SRv6 view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep643844915593"><span id="EN-US_TASK_0194319216__en-us_task_0172368959_cmd1865633037214048">Configure a source address for SRv6 encapsulation. Note that you only need to perform one of the following operations. If both of the operations are performed, the latest configuration overrides the previous one.</span><p><ul id="EN-US_TASK_0194319216__en-us_task_0172368959_ul261475310544"><li id="EN-US_TASK_0194319216__en-us_task_0172368959_li761411538546">Run the <a href="cmdqueryname=encapsulation+source-address"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0172368959_cmdname23368553547">encapsulation source-address</span></b></a> <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0172368959_varname6336145515412">ipv6-address</span></i> [ <strong><span id="EN-US_TASK_0194319216__en-us_task_0172368959_cmdparmname1633612551542">ip-ttl</span></strong> <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0172368959_varname2033635519549">ttl-value</span></i> ] command to directly configure a source address for SRv6 encapsulation.</li><li id="EN-US_TASK_0194319216__en-us_task_0172368959_li1554119145516">Run the <a href="cmdqueryname=encapsulation+source-interface"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0172368959_cmdname10488513573">encapsulation source-interface</span></b></a> { <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0172368959_varname0729113313571">intfname</span></i> | <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0172368959_varname17377153912578">interfaceType</span></i> <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0172368959_varname1951134465716">interfaceNum</span></i> } [ <strong id="EN-US_TASK_0194319216__en-us_task_0172368959_b7945154716571">ip-ttl</strong> <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0172368959_varname2091014584572">ttl-value</span></i> ] command to specify the interface to which the source address used for SRv6 encapsulation belongs.<p id="EN-US_TASK_0194319216__en-us_task_0172368959_p2488153115910">If no IPv6 global address is configured for the interface specified using the <a href="cmdqueryname=encapsulation+source-interface"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0172368959_cmdname2054948195915">encapsulation source-interface</span></b></a> command, the source address for SRv6 encapsulation is not configured.</p>
</li></ul>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep15476113981316"><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmd1134230891214049">Run <a href="cmdqueryname=locator"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdname232104912362">locator</span></b></a> <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0176593776_varname193217498361">locator-name</span></i> [ <strong><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdparmname1321164933618">ipv6-prefix</span></strong> <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0176593776_varname1732214915361">ipv6-address</span></i> <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0176593776_varname53221149103614">prefix-length</span></i> [ <strong><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdparmname232224913611">static</span></strong> <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0176593776_varname3322449103613">static-length</span></i> | <strong><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdparmname1632213497369">args</span></strong> <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0176593776_varname1322154916365">args-length</span></i> ] <sup id="EN-US_TASK_0194319216__en-us_task_0176593776_sup0322184943618">*</sup> ]</span><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p19387311365">An SRv6 locator is configured.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep96472039101314"><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmd1736439137214049">(Optional) Run <a href="cmdqueryname=opcode"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdname9315141173714">opcode</span></b></a> <em id="EN-US_TASK_0194319216__en-us_task_0176593776_i77469933611"><i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0176593776_varname224552117372">func-opcode</span></i></em> <strong><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdparmname11451162312387">end-dt2m</span></strong> <strong><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdparmname186971429113815">bridge-domain</span></strong> <em id="EN-US_TASK_0194319216__en-us_task_0176593776_i374610943612"><i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0176593776_varname1449492963720">bd-id</span></i></em></span><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p1811746115516">A static End.DT2M SID operation code (opcode) is configured.</p>
<p id="EN-US_TASK_0194319216__en-us_task_0176593776_p169947394362">Perform this step if a static locator is configured using the <strong id="EN-US_TASK_0194319216__en-us_task_0176593776_b594663410368">static</strong><em id="EN-US_TASK_0194319216__en-us_task_0176593776_i2946734183615"> static-length</em> parameter. End.DT2M SIDs are used for BUM traffic forwarding through VPLS.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep28187391133"><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmd12167242192220">(Optional) Run <a href="cmdqueryname=opcode"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdname10442516111018">opcode</span></b></a> <em id="EN-US_TASK_0194319216__en-us_task_0176593776_i1389082133718">func-opcode</em> { <strong id="EN-US_TASK_0194319216__en-us_task_0176593776_b17890128375">end-dt2u</strong> | <strong id="EN-US_TASK_0194319216__en-us_task_0176593776_b17890162173712">end-dt2ul</strong> } <strong id="EN-US_TASK_0194319216__en-us_task_0176593776_b168909273712">bridge-domain</strong> <em id="EN-US_TASK_0194319216__en-us_task_0176593776_i88901420374">bd-id</em></span><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p197815345220">An opcode for static End.DT2U and End.DT2UL SIDs is configured.</p>
</p><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p46561552163818">Perform this step if a static locator is configured through the <strong id="EN-US_TASK_0194319216__en-us_task_0176593776_b2257916121619">static</strong><em id="EN-US_TASK_0194319216__en-us_task_0176593776_i0257316141615"> static-length</em> parameter. End.DT2U SIDs are used for the forwarding of known unicast traffic over VPLS. In a dual-homing scenario, you need to specify an End.DT2UL opcode for the bypass path to prevent traffic loops between PEs.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep19992339181312"><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmd1012488329214049">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdname681676596214049">quit</span></b></a></span><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p172451617145616">Exit the SRv6 locator view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep119544019137"><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmd1845657748214049">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdname1806500413214049">quit</span></b></a></span><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p4954192595615">Exit the SRv6 view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep1332013405137"><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmd897546692214049">Run <a href="cmdqueryname=isis"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdname19904193314101">isis</span></b></a> [ <em id="EN-US_TASK_0194319216__en-us_task_0176593776_i072645871712">process-id</em> ]</span><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p1967935185610">The IS-IS view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep54951740161312"><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmd14661416134316">Run <a href="cmdqueryname=segment-routing+ipv6"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdname3624441201010">segment-routing ipv6</span></b></a> <strong id="EN-US_TASK_0194319216__en-us_task_0176593776_b624017194438">locator</strong> <em id="EN-US_TASK_0194319216__en-us_task_0176593776_i624051918439">locator-name</em> [ <strong id="EN-US_TASK_0194319216__en-us_task_0176593776_b2240111994314">auto-sid-disable</strong> ]</span><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p1827942411447">IS-IS SRv6 is enabled.</p>
</p><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p132601555174311">In this command, the value of <em id="EN-US_TASK_0194319216__en-us_task_0176593776_i7384053104315">locator-name</em> must be the same as that specified using the <a href="cmdqueryname=locator"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdname14535923131617">locator</span></b></a> <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0176593776_varname453517239163">locator-name</span></i> [ <strong><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdparmname14535112316164">ipv6-prefix</span></strong> <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0176593776_varname12535122317164">ipv6-address</span></i> <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0176593776_varname1153582321613">prefix-length</span></i> [ <strong><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdparmname14536172318169">static</span></strong> <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0176593776_varname1053672319162">static-length</span></i> | <strong><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdparmname19536223191619">args</span></strong> <i><span class="varname" id="EN-US_TASK_0194319216__en-us_task_0176593776_varname1053642310168">args-length</span></i> ] <sup id="EN-US_TASK_0194319216__en-us_task_0176593776_sup2536122318163">*</sup> ] command. If a separate locator is configured for each of BUM traffic and known unicast traffic of EVPN VPLS services, you need to run this command once for each locator for IS-IS to advertise them both.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep18663140161319"><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmd693717172265">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdname1426545110">quit</span></b></a></span><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p13617165910389">Exit the IS-IS view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep10665205124419"><span id="EN-US_TASK_0194319216__en-us_task_0176593776_cmd066512517442">Run <a href="cmdqueryname=evpn+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0194319216__en-us_task_0176593776_cmdname859217961117">evpn vpn-instance</span></b></a> <em id="EN-US_TASK_0194319216__en-us_task_0176593776_i1419518364518">vpn-instance-name</em> <strong id="EN-US_TASK_0194319216__en-us_task_0176593776_b02214171462">bd-mode</strong></span><p><p id="EN-US_TASK_0194319216__en-us_task_0176593776_p1533367135714">The view of the EVPN instance that works in BD mode is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep14462499248"><span id="EN-US_TASK_0194319216__cmd2444165594415">Run <a href="cmdqueryname=segment-routing+ipv6+locator"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname1787241891118">segment-routing ipv6 locator</span></b></a> <em id="EN-US_TASK_0194319216__i65091417124510">locator-name</em> [ <strong><span id="EN-US_TASK_0194319216__cmdparmname131915587163">unicast-locator</span></strong><em id="EN-US_TASK_0194319216__i1558216156171"> </em><i><span class="varname" id="EN-US_TASK_0194319216__varname1525071991715">unicast-locator-name</span></i> ]</span><p><p id="EN-US_TASK_0194319216__p113072515142">The device is enabled to add SIDs to EVPN routes to be advertised.</p>
</p><p><div class="p" id="EN-US_TASK_0194319216__p25214513455">For the command:<ul id="EN-US_TASK_0194319216__ul921813428456"><li id="EN-US_TASK_0194319216__li14218142184516"><p id="EN-US_TASK_0194319216__p1821818423457"><a name="EN-US_TASK_0194319216__li14218142184516"></a><a name="li14218142184516"></a><em id="EN-US_TASK_0194319216__i13161155065513">locator-name</em> must be set to an End.DT2M SID, with the <strong id="EN-US_TASK_0194319216__b116219508550">args</strong> parameter specified. <i><span class="varname" id="EN-US_TASK_0194319216__varname206819153148">unicast-locator-name</span></i> must be set to an End.DT2U or End.DT2UL SID, without having the <strong id="EN-US_TASK_0194319216__b114751833717">args</strong> parameter specified. If the <em id="EN-US_TASK_0194319216__i821944284519">locator-name</em> and <i><span class="varname" id="EN-US_TASK_0194319216__varname1859615204150">unicast-locator-name</span></i> parameters are both required, you need to run the <a href="cmdqueryname=locator"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname16987145751711">locator</span></b></a> <i><span class="varname" id="EN-US_TASK_0194319216__varname5987857111713">locator-name</span></i> [ <strong><span id="EN-US_TASK_0194319216__cmdparmname16987357111710">ipv6-prefix</span></strong> <i><span class="varname" id="EN-US_TASK_0194319216__varname1898710573178">ipv6-address</span></i> <i><span class="varname" id="EN-US_TASK_0194319216__varname13987857131716">prefix-length</span></i> [ <strong><span id="EN-US_TASK_0194319216__cmdparmname798775714173">static</span></strong> <i><span class="varname" id="EN-US_TASK_0194319216__varname20987195711720">static-length</span></i> | <strong><span id="EN-US_TASK_0194319216__cmdparmname8987115712175">args</span></strong> <i><span class="varname" id="EN-US_TASK_0194319216__varname1198755731713">args-length</span></i> ] <sup id="EN-US_TASK_0194319216__sup79873578179">*</sup> ] command to create two corresponding locators before setting the two parameters.</p>
</li><li id="EN-US_TASK_0194319216__li19219642204518"><p id="EN-US_TASK_0194319216__p162195429458"><a name="EN-US_TASK_0194319216__li19219642204518"></a><a name="li19219642204518"></a>In EVPN VPLS dual-homing scenarios, the <strong id="EN-US_TASK_0194319216__b926283119217">args</strong> parameter is used to stitch ESI labels for End.DT2M SIDs only, which causes a waste of End.DT2U SIDs. In this case, you can separately configure a locator for End.DT2U SIDs and another locator for End.DT2M SIDs. The former locator does not require the <strong id="EN-US_TASK_0194319216__b226312311226">args</strong> parameter to be specified. The two locators can then be bound to the same EVPN instance to conserve SIDs.</p>
</li><li id="EN-US_TASK_0194319216__li42191642124517"><p id="EN-US_TASK_0194319216__p021944274516"><a name="EN-US_TASK_0194319216__li42191642124517"></a><a name="li42191642124517"></a>If static SIDs are configured for the locator specified using <em id="EN-US_TASK_0194319216__i7219842164511">locator-name</em> or <i><span class="varname" id="EN-US_TASK_0194319216__varname15576452171513">unicast-locator-name</span></i>, use the static SIDs. Otherwise, use dynamically allocated SIDs.</p>
</li></ul>
</div>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep1879130461214049"><span id="EN-US_TASK_0194319216__cmd1651145245214049">Run <a href="cmdqueryname=segment-routing+ipv6+traffic-engineer"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname113168524214146">segment-routing ipv6 traffic-engineer</span></b></a> [ <strong><span id="EN-US_TASK_0194319216__cmdparmname73161312102313">best-effort</span></strong> ]</span><p><p id="EN-US_TASK_0194319216__p1646320719445">The function to recurse EVPN VPLSs to SRv6 TE Policies is enabled.</p>
<p id="EN-US_TASK_0194319216__p1293116341016">If an SRv6 BE path exists on the network, you can set the <strong><span id="EN-US_TASK_0194319216__cmdparmname19738711144318">best-effort</span></strong> parameter, allowing the SRv6 BE path to function as a best-effort path in the case of an SRv6 TE Policy fault.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep185311812112"><span id="EN-US_TASK_0194319216__cmd12522184114">(Optional) Run <a href="cmdqueryname=default-color"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname869719572217">default-color</span></b></a> <em id="EN-US_TASK_0194319216__i1169711215434">color-value</em></span><p><p id="EN-US_TASK_0194319216__p15614522124412">The default color value is specified for the EVPN service to recurse to an SRv6 TE Policy.</p>
<p id="EN-US_TASK_0194319216__p1341518421130">If a remote EVPN route without carrying the Color Extended Community is leaked to a local EVPN instance, the default color value is used for the recursion.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep784687662214049"><span id="EN-US_TASK_0194319216__cmd548459007214049">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname1434470395214049">quit</span></b></a></span><p><p id="EN-US_TASK_0194319216__p1230311191871">Return to the system view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep1947837265214049"><span id="EN-US_TASK_0194319216__cmd1060197987214049">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname437694357214049">commit</span></b></a></span><p><p id="EN-US_TASK_0194319216__p8905172812710">The configuration is committed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0194319216__substep10636101372119"><span id="EN-US_TASK_0194319216__cmd4635413152110">Apply a tunnel policy to services. For details, see <a href="dc_vrp_srv6_cfg_all_0114.html">Applying a Tunnel Policy to Services</a>.</span></li></ol>
</li><li id="EN-US_TASK_0194319216__step1798875554917"><span id="EN-US_TASK_0194319216__cmd10988155534916">(Optional) Configure the tunnel ID carried in the inclusive multicast route to be sent to an IPv6 neighbor.</span><p><ol type="a" id="EN-US_TASK_0194319216__ol1430575672"><li id="EN-US_TASK_0194319216__li167198521449">Run <a href="cmdqueryname=evpn"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname2934519182116">evpn</span></b></a><p id="EN-US_TASK_0194319216__p125001320152118">The global EVPN configuration view is displayed.</p>
</li><li id="EN-US_TASK_0194319216__li530511513719">Run <a href="cmdqueryname=evpn+tunnel-id"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname181951125172111">evpn tunnel-id</span></b></a> <i><span class="varname" id="EN-US_TASK_0194319216__varname16195102552111">tunnel-id-value</span></i><p id="EN-US_TASK_0194319216__p3810172517216">The tunnel ID carried in the inclusive multicast route to be sent to an IPv6 neighbor is specified.</p>
</li><li id="EN-US_TASK_0194319216__li4511157134410">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname294623072118">quit</span></b></a><p id="EN-US_TASK_0194319216__p8402831122114">Return to the system view.</p>
</li><li id="EN-US_TASK_0194319216__li22639184504">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname115313842118">commit</span></b></a><p id="EN-US_TASK_0194319216__p9563138162113">The configuration is committed.</p>
</li></ol>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0194319216__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0194319216__p11161453175817">After configuring EVPN VPLS over SRv6 TE Policy, verify the configuration.</p>
<ul id="EN-US_TASK_0194319216__ul44998281114"><li id="EN-US_TASK_0194319216__li5499728314">Run the <a href="cmdqueryname=display+bgp+evpn"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname621112508214049">display bgp evpn</span></b></a> { <strong><span id="EN-US_TASK_0194319216__cmdparmname1560587432214049">all</span></strong> | <strong><span id="EN-US_TASK_0194319216__cmdparmname794310193214049">route-distinguisher</span></strong> <i><span class="varname" id="EN-US_TASK_0194319216__varname654046266214049">route-distinguisher</span></i> | <strong><span id="EN-US_TASK_0194319216__cmdparmname1184097585214049">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0194319216__varname481649966214049">vpn-instance-name</span></i> } <strong><span id="EN-US_TASK_0194319216__cmdparmname1599138299214049">routing-table</span></strong> [ { <strong><span id="EN-US_TASK_0194319216__cmdparmname1396535204214049">ad-route</span></strong> | <strong><span id="EN-US_TASK_0194319216__cmdparmname1664571388214049">es-route</span></strong> | <strong><span id="EN-US_TASK_0194319216__cmdparmname2032321971214049">inclusive-route</span></strong> | <strong><span id="EN-US_TASK_0194319216__cmdparmname1506459724214049">mac-route</span></strong> } <i><span class="varname" id="EN-US_TASK_0194319216__varname865606763214049">prefix</span></i> ] command to check BGP EVPN route information. The command output shows that the value of <strong id="EN-US_TASK_0194319216__b436913145238">Relay Tunnel Out-Interface</strong> is <strong id="EN-US_TASK_0194319216__b11369171413236">SRv6 TE Policy</strong>.</li><li id="EN-US_TASK_0194319216__li196217616561">Run the <a href="cmdqueryname=display+evpn+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname17412767583">display evpn vpn-instance</span></b></a> [ <strong id="EN-US_TASK_0194319216__b1983393211717">name</strong><em id="EN-US_TASK_0194319216__i1483310321070"> vpn-instance-name</em> ] <strong id="EN-US_TASK_0194319216__b2834163219718">tunnel-info</strong> command to check information about the tunnel associated with a specified EVPN instance.</li><li id="EN-US_TASK_0194319216__li885613541000">Run the <a href="cmdqueryname=display+evpn+vpn-instance+name"><b><span class="cmdname" id="EN-US_TASK_0194319216__cmdname197619353209">display evpn vpn-instance name</span></b></a><strong id="EN-US_TASK_0194319216__b139312351171"> </strong><em id="EN-US_TASK_0194319216__i79311635079">vpn-instance-name</em> <strong id="EN-US_TASK_0194319216__b993211351074">tunnel-info</strong><strong id="EN-US_TASK_0194319216__b209321235177"> nexthop </strong><em id="EN-US_TASK_0194319216__i893373510716">nexthopIpv6Addr</em> command to check information about the tunnel that is associated with a specified EVPN instance and matches a specified next hop.</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0131.html">Configuring SRv6 TE Policy Services
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_evpn-vpws_over_srv6-te_policy.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0228.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>