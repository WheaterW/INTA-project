
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring EVPN VPWS over IS-IS SRv6 BE">
<meta name="abstract" content="This section provides an example for configuring SRv6 BE to carry EVPN VPWSs.">
<meta name="description" content="This section provides an example for configuring SRv6 BE to carry EVPN VPWSs.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0010.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0033.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0233.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00556928,w00606909,segment_routing_vrp,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00587852">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00587852">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368978">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring EVPN VPWS over IS-IS SRv6 BE</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172368978"></a><a name="EN-US_TASK_0172368978"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring EVPN VPWS over IS-IS SRv6 BE</h1>
<div class="taskbody" id="taskbody2050663944214049"><p id="shortdesc1809086753214049">This section provides an example for configuring SRv6 BE to carry EVPN VPWSs.</p>
<div class="context"><a name="EN-US_TASK_0172368978__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0172368978__section_dc_vrp_srv6_cfg_all_002201"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0172368978__p656321012214049">On the network shown in <a href="#EN-US_TASK_0172368978__fig_dc_vrp_srv6_cfg_all_002201">Figure 1</a>, PE1, the P, and PE2 are in the same AS and need to run IS-IS to implement IPv6 network connectivity. In addition, a bidirectional SRv6 BE path needs to be deployed between PE1 and PE2 to carry EVPN VPWSs.</p>
<div class="fignone" id="EN-US_TASK_0172368978__fig_dc_vrp_srv6_cfg_all_002201"><a name="EN-US_TASK_0172368978__fig_dc_vrp_srv6_cfg_all_002201"></a><a name="fig_dc_vrp_srv6_cfg_all_002201"></a><span class="figcap"><b>Figure 1 </b>EVPN VPWS over SRv6 BE networking</span><div class="note" id="EN-US_TASK_0172368978__note1130967988214049"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172368978__p801214719214049">In this example, interface1 and interface2 represent GE<span>0/1/0</span> and GE<span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0172368978__image2063199950214049" src="images/fig_dc_vrp_srv6_cfg_all_002201.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368978__1.4.2"></a><a name="1.4.2"></a>
<div class="p" id="EN-US_TASK_0172368978__section_dc_vrp_srv6_cfg_all_002202"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0172368978__p610221846214049">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0172368978__ol1931618197214049"><li id="EN-US_TASK_0172368978__li366083158214049"><p id="EN-US_TASK_0172368978__p218987851214049"><a name="EN-US_TASK_0172368978__li366083158214049"></a><a name="li366083158214049"></a>Enable IPv6 forwarding and configure an IPv6 address for each interface on PE1, the P, and PE2.</p>
</li><li id="EN-US_TASK_0172368978__li867793286214049"><p id="EN-US_TASK_0172368978__p1440311025214049"><a name="EN-US_TASK_0172368978__li867793286214049"></a><a name="li867793286214049"></a>Enable IS-IS, configure an IS-IS level, and specify a network entity title (NET) on PE1, the P, and PE2.</p>
</li><li id="EN-US_TASK_0172368978__li1725588575214049"><p id="EN-US_TASK_0172368978__p200527290214049"><a name="EN-US_TASK_0172368978__li1725588575214049"></a><a name="li1725588575214049"></a>Configure EVPN VPWS and EVPL instances on each PE and bind the EVPL instance to an access-side sub-interface.</p>
</li><li id="EN-US_TASK_0172368978__li1222663081214049"><p id="EN-US_TASK_0172368978__p27384224214049"><a name="EN-US_TASK_0172368978__li1222663081214049"></a><a name="li1222663081214049"></a>Establish a BGP EVPN peer relationship between PEs.</p>
</li><li id="EN-US_TASK_0172368978__li2040584673214049"><p id="EN-US_TASK_0172368978__p792756521214049"><a name="EN-US_TASK_0172368978__li2040584673214049"></a><a name="li2040584673214049"></a>Configure SRv6 BE on PEs.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368978__1.4.3"></a><a name="1.4.3"></a>
<div class="p" id="EN-US_TASK_0172368978__section_dc_vrp_srv6_cfg_all_002203"><h4 class="sectiontitle">Data Preparation</h4><p id="EN-US_TASK_0172368978__p605539302214049">To complete the configuration, you need the following data:</p>
<ul id="EN-US_TASK_0172368978__ul899445098214049"><li id="EN-US_TASK_0172368978__li1604456756214049"><p id="EN-US_TASK_0172368978__p152542713214049"><a name="EN-US_TASK_0172368978__li1604456756214049"></a><a name="li1604456756214049"></a>EVPN instance name: evrf1</p>
</li><li id="EN-US_TASK_0172368978__li1728444054214049"><p id="EN-US_TASK_0172368978__p947922609214049"><a name="EN-US_TASK_0172368978__li1728444054214049"></a><a name="li1728444054214049"></a>RD and RT of the EVPN instance</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172368978__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0172368978__section_dc_vrp_srv6_cfg_all_002204"><li id="EN-US_TASK_0172368978__step362152787214049"><span id="EN-US_TASK_0172368978__cmd733235511214049">Enable IPv6 forwarding and configure an IPv6 address for each interface. The following example uses the configuration of PE1. The configurations of other devices are similar to the configuration of PE1. For configuration details, see <a href="#EN-US_TASK_0172368978__section_dc_vrp_srv6_cfg_all_002205">Configuration Files</a> in this section.</span><p><pre class="screen" id="EN-US_TASK_0172368978__screen1230104759214049">&lt;<span class="keyword" id="EN-US_TASK_0172368978__keyword393510418214049">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172368978__b386530312214049">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0172368978__keyword2011991856214049"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172368978__keyword1269618130214049">HUAWEI</span>] <strong id="EN-US_TASK_0172368978__b1302798650214049">sysname PE1</strong>
[<span class="keyword" id="EN-US_TASK_0172368978__keyword1478551779214049">*</span><span class="keyword" id="EN-US_TASK_0172368978__keyword1486470216214049">HUAWEI</span>] <strong id="EN-US_TASK_0172368978__b758780196214049">commit</strong>
[<span class="keyword" id="EN-US_TASK_0172368978__keyword1017457270214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172368978__b1773787764214049">interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword" id="EN-US_TASK_0172368978__keyword2067597535214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172368978__b413065376214049">ipv6 enable</strong>
[<span class="keyword" id="EN-US_TASK_0172368978__keyword1116890236214049">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172368978__b183421750214049">ipv6 address 2001:DB8:10::1 64</strong>
[<span class="keyword" id="EN-US_TASK_0172368978__keyword1087328600214049">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172368978__b1791300765214049">quit</strong>
[<span class="keyword" id="EN-US_TASK_0172368978__keyword1473247868214049">*</span>PE1] <strong id="EN-US_TASK_0172368978__b2025840177214049">interface LoopBack 1</strong>
[<span class="keyword" id="EN-US_TASK_0172368978__keyword24831052013">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172368978__b8591125212">ip address 1.1.1.1 32</strong>
[<span class="keyword" id="EN-US_TASK_0172368978__keyword1412460428214049">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172368978__b1157214332214049">ipv6 enable</strong>
[<span class="keyword" id="EN-US_TASK_0172368978__keyword385623960214049">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172368978__b1617933106214049">ipv6 address 2001:DB8:1::1 128</strong>
[<span class="keyword" id="EN-US_TASK_0172368978__keyword1823516083214049">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172368978__b432310683214049">quit</strong>
[<span class="keyword" id="EN-US_TASK_0172368978__keyword1968318815214049">*</span>PE1] <strong id="EN-US_TASK_0172368978__b613488894214049">commit</strong></pre>
<p id="EN-US_TASK_0172368978__p1833817407215">Configure an IPv4 address for the loopback interface because the EVPN source address needs to be an IPv4 address. This example uses the configuration of PE1. The configurations of other devices are similar to the configuration of PE1. For configuration details, see <a href="#EN-US_TASK_0172368978__section_dc_vrp_srv6_cfg_all_002205">Configuration Files</a> in this section.</p>
</p></li><li id="EN-US_TASK_0172368978__step357923238214049"><span id="EN-US_TASK_0172368978__cmd514165819214049">Configure IS-IS.</span><p><p id="EN-US_TASK_0172368978__p1535189562214049"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172368978__screen785884905214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword298075731214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172368978__b762136385214049">isis 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen743734967214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1125089739214049">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172368978__b1569020706214049">is-level level-1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen468299883214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1712668757214049">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172368978__b252728473214049">cost-style wide</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen728469209214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1035649525214049">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172368978__b1739506316214049">network-entity 10.0000.0000.0001.00</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen574897673214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword676614681214049">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172368978__b221645654815">ipv6 enable topology ipv6</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1331373884214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1917566291214049">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172368978__b1151126543214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen728231774214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1734166314214049">*</span>PE1] <strong id="EN-US_TASK_0172368978__b463743739214049">interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen693689608214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1490826180214049">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172368978__b283321712214049">isis ipv6 enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen707413671214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1257518116214049">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172368978__b5857322163017">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen637023287214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword644172953018">*</span>PE1] <strong id="EN-US_TASK_0172368978__b1333285188214049">interface loopback1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1274672364214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword789803435214049">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172368978__b1949431903214049">isis ipv6 enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1409486727214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1045246421214049">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172368978__b607524735214049">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1898726042214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1835043177214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-LoopBack1] <strong id="EN-US_TASK_0172368978__b1395410633214049">quit</strong></pre>
<p id="EN-US_TASK_0172368978__p464448101214049"># Configure the P.</p>
<pre class="screen" id="EN-US_TASK_0172368978__screen1960295824214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1707776704214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong id="EN-US_TASK_0172368978__b615440306214049">isis 1</strong> </pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1518141748214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1330838723214049">*</span>P-isis-1] <strong id="EN-US_TASK_0172368978__b2144683120214049">is-level level-1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1874291049214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1979968795214049">*</span>P-isis-1] <strong id="EN-US_TASK_0172368978__b1904367350214049">cost-style wide</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen66707107214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword661874908214049">*</span>P-isis-1] <strong id="EN-US_TASK_0172368978__b914359125214049">network-entity 10.0000.0000.0002.00</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1870503053214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword658546599214049">*</span>P-isis-1] <strong id="EN-US_TASK_0172368978__b204575314491">ipv6 enable topology ipv6</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1093259994214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1022569859214049">*</span>P-isis-1] <strong id="EN-US_TASK_0172368978__b1019473572214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1570439622214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword623350240214049">*</span>P] <strong id="EN-US_TASK_0172368978__b1735406943214049">interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen655009705214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1735183576214049">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172368978__b94065136214049">isis ipv6 enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1998933871214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword76873899214049">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172368978__b349853613300">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen2003398034214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword349455204214049">*</span>P] <strong id="EN-US_TASK_0172368978__b1265466888214049">interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1362333619214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword2053713681214049">*</span>P-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172368978__b1554010748214049">isis ipv6 enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1165283260214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1246953786214049">*</span>P-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172368978__b1557566368214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen241008884214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword874513913119">*</span>P] <strong id="EN-US_TASK_0172368978__b947734540214049">interface loopback1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen297385925214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1716718883214049">*</span>P-LoopBack1] <strong id="EN-US_TASK_0172368978__b1575022479214049">isis ipv6 enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen350955740214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1665906433214049">*</span>P-LoopBack1] <strong id="EN-US_TASK_0172368978__b966994208214049">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen574608279214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword146912277214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>P-LoopBack1] <strong id="EN-US_TASK_0172368978__b2078025768214049">quit</strong></pre>
<p id="EN-US_TASK_0172368978__p487960521214049"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172368978__screen1360488920214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword708852239214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172368978__b1370934326214049">isis 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen2000557978214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1027109285214049">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172368978__b1138615064214049">is-level level-1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen139693107214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword673508109214049">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172368978__b2049443539214049">cost-style wide</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen95268521214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1142484459214049">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172368978__b1556500225214049">network-entity 10.0000.0000.0003.00</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1805691413214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1149179699214049">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172368978__b1820919634917">ipv6 enable topology ipv6</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1749594891214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword233483085214049">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172368978__b1223513509214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1583004521214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword672103018214049">*</span>PE2] <strong id="EN-US_TASK_0172368978__b841956714214049">interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen335525944214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1156222076214049">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172368978__b1482202679214049">isis ipv6 enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen2094946404214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword559720044214049">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172368978__b968721983114">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen484480007214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword38131826123110">*</span>PE2] <strong id="EN-US_TASK_0172368978__b268056713214049">interface loopback1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen268322748214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1675930992214049">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172368978__b1649831023214049">isis ipv6 enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1235656146214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword752369382214049">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172368978__b805136530214049">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen664568904214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1505145915214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-LoopBack1] <strong id="EN-US_TASK_0172368978__b1056179927214049">quit</strong></pre>
</p><p><p id="EN-US_TASK_0172368978__p1791612592811">After the configuration is complete, perform the following operations to check whether IS-IS is successfully configured:</p>
<p id="EN-US_TASK_0172368978__p1971339643214049"># Display IS-IS neighbor information. The following example uses the command output on PE1.</p>
<pre class="screen" id="EN-US_TASK_0172368978__screen685388675214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword704107105214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172368978__b445792068214049">display isis peer</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1280948138214049">                          Peer information for ISIS(1)
                         
  System Id     Interface         Circuit Id        State HoldTime Type     PRI
--------------------------------------------------------------------------------
0000.0000.0002* GE<span>0/1/0</span>           0000.0000.0002.01  Up   8s       L1       64 

Total Peer(s): 1</pre>
<p id="EN-US_TASK_0172368978__p53606322214049"># Display IS-IS routing table information. The following example uses the command output on PE1.</p>
<pre class="screen" id="EN-US_TASK_0172368978__screen56629899214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1411392614214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172368978__b1389768972214049">display isis route</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1303269036214049">                         Route information for ISIS(1)
                         -----------------------------

                        ISIS(1) Level-1 Forwarding Table
                        --------------------------------

 IPV6 Dest.        ExitInterface      NextHop                    Cost     Flags    
--------------------------------------------------------------------------------
2001:DB8:1::1/128  GE<span>0/1/0</span>            Direct                     10       D/-/L/-  
2001:DB8:2::2/128  GE<span>0/1/0</span>            FE80::3A5D:67FF:FE31:307   10       A/-/-/-  
2001:DB8:3::3/128  GE<span>0/1/0</span>            FE80::3A5D:67FF:FE31:307   20       A/-/-/-  
2001:DB8:10::/64   GE<span>0/1/0</span>            Direct                     20       A/-/-/-  
2001:DB8:20::/64   GE<span>0/1/0</span>            FE80::3A5D:67FF:FE31:307   20       A/-/-/-  
     Flags: D-Direct, A-Added to URT, L-Advertised in LSPs, S-IGP Shortcut, 
            U-Up/Down Bit Set, LP-Local Prefix-Sid
<span>     Protect Type: L-Link Protect, N-Node Protect</span></pre>
</p></li><li id="EN-US_TASK_0172368978__step1551236115214049"><span id="EN-US_TASK_0172368978__cmd1173910225214049">Configure EVPN and EVPL instances on each PE and bind the EVPL instance to an access-side sub-interface.</span><p><p id="EN-US_TASK_0172368978__p622518194314"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172368978__screen3395111394314">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1499064203213"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172368978__b9398113174312">evpn source-address 1.1.1.1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1477952931214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword563417162502">*</span>PE1] <strong id="EN-US_TASK_0172368978__b1674604616214049">evpn vpn-instance evrf1 vpws</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen435888195214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword103116012214049">*</span>PE1-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0172368978__b301988144214049">route-distinguisher 100:1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1089246612214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword182359158214049">*</span>PE1-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0172368978__b624853702214049">vpn-target 1:1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1877220967214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1836432812214049">*</span>PE1-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0172368978__b352219618214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1057315599214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword562054266214049">*</span>PE1] <strong id="EN-US_TASK_0172368978__b2074621256214049">evpl instance 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen534803867214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1622621584214049">*</span>PE1-evpl1] <strong id="EN-US_TASK_0172368978__b327965478214049">evpn binding vpn-instance evrf1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1209970131214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1612839901214049">*</span>PE1-evpl1] <strong id="EN-US_TASK_0172368978__b443634078214049">local-service-id 100 remote-service-id 200</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen783945107214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword859933608214049">*</span>PE1-evpl1] <strong id="EN-US_TASK_0172368978__b1602651084214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1620507750214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword223035515214049">*</span>PE1] <strong id="EN-US_TASK_0172368978__b688208329214049">interface gigabitethernet <span>0/2/0</span>.1 mode l2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1904102002214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1593550343214049">*</span>PE1-GigabitEthernet<span>0/2/0</span>.1] <strong id="EN-US_TASK_0172368978__b93647169214049">encapsulation dot1q vid 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1022479854214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword893584160214049">*</span>PE1-GigabitEthernet<span>0/2/0</span>.1] <strong id="EN-US_TASK_0172368978__b1865528956214049">evpl instance 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1265447900214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1667337701214049">*</span>PE1-GigabitEthernet<span>0/2/0</span>.1] <strong id="EN-US_TASK_0172368978__b1126549826214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen741115490214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword672675286214049">*</span>PE1] <strong id="EN-US_TASK_0172368978__b556223521214049">commit</strong></pre>
<p id="EN-US_TASK_0172368978__p1429244812214049"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172368978__screen1463451816430">[<span class="keyword" id="EN-US_TASK_0172368978__keyword076587183214"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172368978__b5634181874312">evpn source-address 3.3.3.3</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen613268641214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword2611162417500">*</span>PE2] <strong id="EN-US_TASK_0172368978__b212954057214049">evpn vpn-instance evrf1 vpws</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1361276458214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword723022824214049">*</span>PE2-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0172368978__b98753695214049">route-distinguisher 200:1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1312681281214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword514704745214049">*</span>PE2-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0172368978__b1512026924214049">vpn-target 1:1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen420639057214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword353061836214049">*</span>PE2-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0172368978__b2115712280214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1414193609214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword717391988214049">*</span>PE2] <strong id="EN-US_TASK_0172368978__b715431727214049">evpl instance 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen2012247041214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword2084715181214049">*</span>PE2-evpl1] <strong id="EN-US_TASK_0172368978__b1754967588214049">evpn binding vpn-instance evrf1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1693220974214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1626885499214049">*</span>PE2-evpl1] <strong id="EN-US_TASK_0172368978__b216147011214049">local-service-id 200 remote-service-id 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1590633886214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword236243053214049">*</span>PE2-evpl1] <strong id="EN-US_TASK_0172368978__b1408338661214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen911496045214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1418507274214049">*</span>PE2] <strong id="EN-US_TASK_0172368978__b616225303214049">interface gigabitethernet <span>0/2/0</span>.1 mode l2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1107065422214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword2017906486214049">*</span>PE2-GigabitEthernet<span>0/2/0</span>.1] <strong id="EN-US_TASK_0172368978__b28097616214049">encapsulation dot1q vid 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen559926378214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword612321503214049">*</span>PE2-GigabitEthernet<span>0/2/0</span>.1] <strong id="EN-US_TASK_0172368978__b280278288214049">evpl instance 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen146186370214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1646000073214049">*</span>PE2-GigabitEthernet<span>0/2/0</span>.1] <strong id="EN-US_TASK_0172368978__b1347453984214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1460411964214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1121796763214049">*</span>PE2] <strong id="EN-US_TASK_0172368978__b2042651379214049">commit</strong></pre>
</p></li><li id="EN-US_TASK_0172368978__step970588754214049"><span id="EN-US_TASK_0172368978__cmd399405866214049">Establish a BGP EVPN peer relationship between PEs.</span><p><p id="EN-US_TASK_0172368978__p283252037214049"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172368978__screen932064351214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword295570498214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172368978__b1175305219214049">bgp 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1933550475214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1599163331214049">*</span>PE1-bgp] <strong id="EN-US_TASK_0172368978__b943600090214049">router-id 1.1.1.1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1568291414214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1635262885214049">*</span>PE1-bgp] <strong id="EN-US_TASK_0172368978__b1987523651214049">peer 2001:DB8:3::3 as-number 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen2007403891214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1572227710214049">*</span>PE1-bgp] <strong id="EN-US_TASK_0172368978__b925126105214049">peer 2001:DB8:3::3 connect-interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1299662618214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword223503220214049">*</span>PE1-bgp] <strong id="EN-US_TASK_0172368978__b433094787214049">l2vpn-family evpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen726527453214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword414267139214049">*</span>PE1-bgp-af-evpn] <strong id="EN-US_TASK_0172368978__b353170010214049">peer 2001:DB8:3::3 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen2048484443214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1455791843214049">*</span>PE1-bgp-af-evpn] <strong id="EN-US_TASK_0172368978__b53866474214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1814691054214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword872632237214049">*</span>PE1-bgp] <strong id="EN-US_TASK_0172368978__b681618255214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1332953116214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1239487396214049">*</span>PE1] <strong id="EN-US_TASK_0172368978__b1076260394214049">commit</strong></pre>
<p id="EN-US_TASK_0172368978__p1487889689214049"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172368978__screen1486238015214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword316517468214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172368978__b1394566003214049">bgp 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen975550578214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword540966967214049">*</span>PE2-bgp] <strong id="EN-US_TASK_0172368978__b639299877214049">router-id 3.3.3.3</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1676708496214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1985767182214049">*</span>PE2-bgp] <strong id="EN-US_TASK_0172368978__b1906038284214049">peer 2001:DB8:1::1 as-number 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen2133645543214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword875625502214049">*</span>PE2-bgp] <strong id="EN-US_TASK_0172368978__b1663933871214049">peer 2001:DB8:1::1 connect-interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen16828772214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword957875735214049">*</span>PE2-bgp] <strong id="EN-US_TASK_0172368978__b1069252830214049">l2vpn-family evpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen481081326214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1157539843214049">*</span>PE2-bgp-af-evpn] <strong id="EN-US_TASK_0172368978__b1365387097214049">peer 2001:DB8:1::1 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1500229447214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword355677942214049">*</span>PE2-bgp-af-evpn] <strong id="EN-US_TASK_0172368978__b1679317975214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen44154291214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1664664280214049">*</span>PE2-bgp] <strong id="EN-US_TASK_0172368978__b842106441214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1353459563214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword554558368214049">*</span>PE2] <strong id="EN-US_TASK_0172368978__b264149125214049">commit</strong></pre>
<p id="EN-US_TASK_0172368978__p1379656748214049">After the configuration is complete, run the <strong id="EN-US_TASK_0172368978__b14147131873714">display bgp evpn peer</strong> command on the PEs and check whether BGP EVPN peer relationships have been established between the PEs. If the <strong id="EN-US_TASK_0172368978__b13148118193710">Established</strong> state is displayed in the command output, the BGP EVPN peer relationships have been established successfully.</p>
</p></li><li id="EN-US_TASK_0172368978__step466832878214049"><span id="EN-US_TASK_0172368978__cmd1302418055214049">Deploy SRv6 BE between PEs.</span><p><p id="EN-US_TASK_0172368978__p1600374026214049"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172368978__screen1249436101214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword325905682214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172368978__b1188782754214049">segment-routing ipv6</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen10982205819198">[<span class="keyword" id="EN-US_TASK_0172368978__keyword3484935192312">*</span>PE1-segment-routing-ipv6] <strong id="EN-US_TASK_0172368978__b13164257102312">encapsulation source-address 2001:DB8:1::1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen94278208214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword2041014330214049">*</span>PE1-segment-routing-ipv6] <strong id="EN-US_TASK_0172368978__b1152568200214049">locator PE1 ipv6-prefix 2001:DB8:11:: 64 static 32</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1529331463214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword2106192868214049">*</span>PE1-segment-routing-ipv6-locator] <strong id="EN-US_TASK_0172368978__b557554835214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1641596652214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1347131524214049">*</span>PE1-segment-routing-ipv6] <strong id="EN-US_TASK_0172368978__b10506929214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen114872841616">[<span class="keyword" id="EN-US_TASK_0172368978__keyword17451154131619">*</span>PE1] <strong id="EN-US_TASK_0172368978__b1645154141617">isis 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1536965715151">[<span class="keyword" id="EN-US_TASK_0172368978__keyword20187232214049">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172368978__b1816798967214049">segment-routing ipv6 locator PE1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1074414166163">[<span class="keyword" id="EN-US_TASK_0172368978__keyword127271939101613">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172368978__b072763981610">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen431294795214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword798778694214049">*</span>PE1] <strong id="EN-US_TASK_0172368978__b1341419252214049">bgp 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen817634061214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1920826764214049">*</span>PE1-bgp] <strong id="EN-US_TASK_0172368978__b2024552195214049">l2vpn-family evpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1526199856214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword692904553214049">*</span>PE1-bgp-af-evpn] <strong id="EN-US_TASK_0172368978__b635546293214049">peer 2001:DB8:3::3 advertise encap-type srv6</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1382568566214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword274682817214049">*</span>PE1-bgp-af-evpn] <strong id="EN-US_TASK_0172368978__b406119443214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen545793016214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword233276302214049">*</span>PE1-bgp] <strong id="EN-US_TASK_0172368978__b1699297942214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1475137434214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword591730261214049">*</span>PE1] <strong id="EN-US_TASK_0172368978__b1523249806214049">evpl instance 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen581424924214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1018483920214049">*</span>PE1-evpl1] <strong id="EN-US_TASK_0172368978__b206548146214049">segment-routing ipv6 locator PE1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen579631112214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword883568970214049">*</span>PE1-evpl1] <strong id="EN-US_TASK_0172368978__b2116851101214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1404381732214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1580438166214049">*</span>PE1] <strong id="EN-US_TASK_0172368978__b1401624354214049">evpn vpn-instance evrf1 vpws</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen714584297214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1866634414214049">*</span>PE1-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0172368978__b192146672214049">segment-routing ipv6 best-effort</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen502404772214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword990960064214049">*</span>PE1-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0172368978__b947321066214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1466873935214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1921488071214049">*</span>PE1] <strong id="EN-US_TASK_0172368978__b1724041049214049">commit</strong></pre>
<p id="EN-US_TASK_0172368978__p544352939214049"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172368978__screen1213955104214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword612606953214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172368978__b1285794236214049">segment-routing ipv6</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1399241472014">[<span class="keyword" id="EN-US_TASK_0172368978__keyword0481216172016">*</span>PE2-segment-routing-ipv6] <strong id="EN-US_TASK_0172368978__b114917163203">encapsulation source-address 2001:DB8:3::3</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1740905501214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword2078357623214049">*</span>PE2-segment-routing-ipv6] <strong id="EN-US_TASK_0172368978__b1503042219214049">locator PE2 ipv6-prefix 2001:DB8:30:: 64 static 32</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen2089622875214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword66279838214049">*</span>PE2-segment-routing-ipv6-locator] <strong id="EN-US_TASK_0172368978__b620638621214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen950400772214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword855638323214049">*</span>PE2-segment-routing-ipv6] <strong id="EN-US_TASK_0172368978__b983435943214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen756912413177">[<span class="keyword" id="EN-US_TASK_0172368978__keyword2056913243175">*</span>PE2] <strong id="EN-US_TASK_0172368978__b115691624171712">isis 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen6569224191715">[<span class="keyword" id="EN-US_TASK_0172368978__keyword95691724201713">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172368978__b195691124191718">segment-routing ipv6 locator PE2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen95691924151715">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1856952411173">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172368978__b15569724171718">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1552005571214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword2137200966214049">*</span>PE2] <strong id="EN-US_TASK_0172368978__b1900691045214049">bgp 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen6062893214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1148836504214049">*</span>PE2-bgp] <strong id="EN-US_TASK_0172368978__b1448021932214049">l2vpn-family evpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen253562574214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword300321106214049">*</span>PE2-bgp-af-evpn] <strong id="EN-US_TASK_0172368978__b34251016214049">peer 2001:DB8:1::1 advertise encap-type srv6</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1903306590214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword14843777214049">*</span>PE2-bgp-af-evpn] <strong id="EN-US_TASK_0172368978__b1276185974214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen599775566214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword717164237214049">*</span>PE2-bgp] <strong id="EN-US_TASK_0172368978__b1010093554214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1955992209214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1711814505214049">*</span>PE2] <strong id="EN-US_TASK_0172368978__b1501282174214049">evpl instance 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1174080934214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword342357743214049">*</span>PE2-evpl1] <strong id="EN-US_TASK_0172368978__b575324947214049">segment-routing ipv6 locator PE2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen2130227213214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1804748412214049">*</span>PE2-evpl1] <strong id="EN-US_TASK_0172368978__b578471330214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen542101337214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1757571843214049">*</span>PE2] <strong id="EN-US_TASK_0172368978__b1569656443214049">evpn vpn-instance evrf1 vpws</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1410660315214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1409698796214049">*</span>PE2-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0172368978__b1232493537214049">segment-routing ipv6 best-effort</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1627207682214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword729819365214049">*</span>PE2-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0172368978__b34682110214049">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen80612214214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword701977142214049">*</span>PE2] <strong id="EN-US_TASK_0172368978__b1257869918214049">commit</strong></pre>
</p></li><li id="EN-US_TASK_0172368978__step1789365703214049"><span id="EN-US_TASK_0172368978__cmd508377733214049">Verify the configuration.</span><p><p id="EN-US_TASK_0172368978__p660123756214049">Run the <strong id="EN-US_TASK_0172368978__b1642823198214049">display bgp evpn evpl</strong> command on each PE. The command output shows the EVPL status. The following example uses the command output on PE1.</p>
<pre class="screen" id="EN-US_TASK_0172368978__screen1791570157214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword1621532868214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172368978__b1842894770214049">display bgp evpn evpl</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen1774699983214049">Total EVPLs: 1      1 Up     0 Down

EVPL ID : 1
State : up
EVPL Down Causes : --
EVPL Type : none
Interface : GigabitEthernet<span>0/2/0</span>.1
Interface Status : up
Ignore AcState : disable
Local MTU : 1500
Local Control Word : false
Local Redundancy Mode : all-active
Local DF State : primary
Local ESI : 0000.0000.0000.0000.0000
Remote Redundancy Mode : all-active
Remote Primary DF Number : 1
Remote Backup DF Number : 0
Remote None DF Number : 0
Peer IP : 2001:DB8:3::3
 Origin Nexthop IP : 2001:DB8:3::3
 DF State : primary
 Remote MTU : 1500
 Remote Control Word : false
 Remote ESI : 0000.0000.0000.0000.0000
 Tunnel info : 1 tunnels
  NO.0   Tunnel Type : srv6-be, Tunnel ID : 
Last Interface UP Timestamp : 2020-02-12 7:37:20:398
Last Designated Primary Timestamp : --
Last Designated Backup Timestamp : --
Last EVPL UP Timestamp: --
Last EVPL DOWN Timestamp: --</pre>
<p id="EN-US_TASK_0172368978__p229801621214049">Run the <strong id="EN-US_TASK_0172368978__b2014456017214049">display bgp evpn all routing-table</strong> command on each PE. The command output shows the EVPN route sent from the peer end. The following example uses the command output on PE1.</p>
<pre class="screen" id="EN-US_TASK_0172368978__screen1660022752214049">[<span class="keyword" id="EN-US_TASK_0172368978__keyword140470761214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172368978__b431058678214049">display bgp evpn all routing-table</strong></pre>
<pre class="screen" id="EN-US_TASK_0172368978__screen137519087214049"> Local AS number : 100

 BGP Local router ID is 1.1.1.1
 Status codes: * - valid, &gt; - best, d - damped, x - best external, a - add path,
               h - history,  i - internal, s - suppressed, S - Stale
               Origin : i - IGP, e - EGP, ? - incomplete

 
 EVPN address family:
 Number of A-D Routes: 2
 Route Distinguisher: 100:1
       Network(ESI/EthTagId)                                  NextHop
 *&gt;    0000.0000.0000.0000.0000:100                           127.0.0.1
 *&gt;i   0000.0000.0000.0000.0000:200                           2001:DB8:3::3
    

 EVPN-Instance evrf1:
 Number of A-D Routes: 2
       Network(ESI/EthTagId)                                  NextHop
 *&gt;    0000.0000.0000.0000.0000:100                           127.0.0.1
 *&gt;i   0000.0000.0000.0000.0000:200                           2001:DB8:3::3</pre>
<p id="EN-US_TASK_0172368978__p6790184815591">Run the <strong id="EN-US_TASK_0172368978__b879044816591">display bgp evpn all routing-table ad-route</strong> command on PE1. The command output shows the A-D EVPN routes sent from the peer end. </p>
<pre class="screen" id="EN-US_TASK_0172368978__screen27909488598">[<font style="font-size:8pt" Face="Courier New" >~</font>PE1] <strong id="EN-US_TASK_0172368978__b20790184811595">display bgp evpn all routing-table ad-route 0000.0000.0000.0000.0000:200</strong> 

 BGP local router ID : 1.1.1.1                          
 Local AS number : 100                                  
 Total routes of Route Distinguisher(200:1): 1          
 BGP routing table entry information of 0000.0000.0000.0000.0000:200:           
 Label information (Received/Applied): 3/NULL           
 From: 2001:DB8:3::3 (3.3.3.3)                          
 Route Duration: 0d00h03m43s                            
 Relay IP Nexthop: FE80::3AC2:67FF:FE31:307             
 Relay IP Out-Interface:GigabitEthernet<span>0/1/0</span>                   
 Relay Tunnel Out-Interface:                            
 Original nexthop: 2001:DB8:3::3                        
 Qos information : 0x0                                  
 Ext-Community: RT &lt;1 : 1&gt;, SoO &lt;3.3.3.3 : 0&gt;, EVPN L2 Attributes &lt;MTU:1500 C:0 P:1 B:0&gt;           
 <strong id="EN-US_TASK_0172368978__b1381383844218">Prefix-sid: 2001:DB8:30::1:0:3C</strong>, Endpoint Behavior: DX2(21)              
 AS-path Nil, origin incomplete, localpref 100, pref-val 0, valid, internal, best, select, pre 255, IGP cost 20                     
 Route Type: 1 (Ethernet Auto-Discovery (A-D) route)    
 ESI: 0000.0000.0000.0000.0000, Ethernet Tag ID: 200    
 Not advertised to any peer yet         



 EVPN-Instance evrf1:                                   
 Number of A-D Routes: 1                                
 BGP routing table entry information of 0000.0000.0000.0000.0000:200:           
 Route Distinguisher: 200:1                             
 Remote-Cross route                                     
 Label information (Received/Applied): 3/NULL           
 From: 2001:DB8:3::3 (3.3.3.3)                          
 Route Duration: 0d00h03m44s                            
 Relay IP Nexthop: FE80::3AC2:67FF:FE31:307             
 Relay IP Out-Interface:GigabitEthernet<span>0/1/0</span>                   
 Relay Tunnel Out-Interface:                            
 Original nexthop: 2001:DB8:3::3                        
 Qos information : 0x0                                  
 Ext-Community: RT &lt;1 : 1&gt;, SoO &lt;3.3.3.3 : 0&gt;, EVPN L2 Attributes &lt;MTU:1500 C:0 P:1 B:0&gt;           
 <strong id="EN-US_TASK_0172368978__b128812414425">Prefix-sid: 2001:DB8:30::1:0:3C</strong>, Endpoint Behavior: DX2(21)                        
 AS-path Nil, origin incomplete, localpref 100, pref-val 0, valid, internal, best, select, pre 255, IGP cost 20                     
 Route Type: 1 (Ethernet Auto-Discovery (A-D) route)    
 ESI: 0000.0000.0000.0000.0000, Ethernet Tag ID: 200    
 Not advertised to any peer yet </pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172368978__section_dc_vrp_srv6_cfg_all_002205"><a name="EN-US_TASK_0172368978__section_dc_vrp_srv6_cfg_all_002205"></a><a name="section_dc_vrp_srv6_cfg_all_002205"></a><a name="EN-US_TASK_0172368978__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul id="EN-US_TASK_0172368978__ul499006314214049"><li id="EN-US_TASK_0172368978__li1745977844214049"><p id="EN-US_TASK_0172368978__p1433071500214049"><a name="EN-US_TASK_0172368978__li1745977844214049"></a><a name="li1745977844214049"></a>PE1 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172368978__screen775261915214049">#
sysname PE1
#
evpn vpn-instance evrf1 vpws
 route-distinguisher 100:1
 segment-routing ipv6 best-effort
 vpn-target 1:1 export-extcommunity
 vpn-target 1:1 import-extcommunity
#
evpl instance 1
 evpn binding vpn-instance evrf1
 local-service-id 100 remote-service-id 200
 segment-routing ipv6 locator PE1 
#
segment-routing ipv6
 encapsulation source-address 2001:DB8:1::1
 locator PE1 ipv6-prefix 2001:DB8:11:: 64 static 32
#
isis 1
 is-level level-1
 cost-style wide
 network-entity 10.0000.0000.0001.00
 #
 ipv6 enable topology ipv6
 segment-routing ipv6 locator PE1
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:10::1/64
 isis ipv6 enable 1
#
interface GigabitEthernet<span>0/2/0</span>.1 mode l2
 encapsulation dot1q vid 1
 evpl instance 1
#
interface LoopBack1
 ipv6 enable
 ip address 1.1.1.1 255.255.255.255
 ipv6 address 2001:DB8:1::1/128
 isis ipv6 enable 1
#
bgp 100
 router-id 1.1.1.1
 peer 2001:DB8:3::3 as-number 100
 peer 2001:DB8:3::3 connect-interface LoopBack1
 #
 ipv4-family unicast
  undo synchronization
 #              
 l2vpn-family evpn
  policy vpn-target
  peer 2001:DB8:3::3 enable
  peer 2001:DB8:3::3 advertise encap-type srv6
#
evpn source-address 1.1.1.1
#
return</pre>
</li><li id="EN-US_TASK_0172368978__li999798410214049"><p id="EN-US_TASK_0172368978__p1699822742214049"><a name="EN-US_TASK_0172368978__li999798410214049"></a><a name="li999798410214049"></a>P configuration file</p>
<pre class="screen" id="EN-US_TASK_0172368978__screen1542176577214049">#
sysname P
#
isis 1
 is-level level-1
 cost-style wide
 network-entity 10.0000.0000.0002.00
 #
 ipv6 enable topology ipv6
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:10::2/64
 isis ipv6 enable 1
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:20::1/64
 isis ipv6 enable 1
#
interface LoopBack1
 ipv6 enable
 ipv6 address 2001:DB8:2::2/128
 isis ipv6 enable 1
#
return</pre>
</li><li id="EN-US_TASK_0172368978__li1824096835214049"><p id="EN-US_TASK_0172368978__p118961273214049"><a name="EN-US_TASK_0172368978__li1824096835214049"></a><a name="li1824096835214049"></a>PE2 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172368978__screen1557173383214049">#
sysname PE2
#
evpn vpn-instance evrf1 vpws
 route-distinguisher 200:1
 segment-routing ipv6 best-effort
 vpn-target 1:1 export-extcommunity
 vpn-target 1:1 import-extcommunity
#
evpl instance 1
 evpn binding vpn-instance evrf1
 local-service-id 200 remote-service-id 100
 segment-routing ipv6 locator PE2 
#
segment-routing ipv6
 encapsulation source-address 2001:DB8:3::3
 locator PE2 ipv6-prefix 2001:DB8:30:: 64 static 32
#
isis 1
 is-level level-1
 cost-style wide
 network-entity 10.0000.0000.0003.00
 #
 ipv6 enable topology ipv6
 segment-routing ipv6 locator PE2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:20::2/64
 isis ipv6 enable 1
#
interface GigabitEthernet<span>0/2/0</span>.1 mode l2
 encapsulation dot1q vid 1
 evpl instance 1
#
interface LoopBack1
 ipv6 enable
 ip address 3.3.3.3 255.255.255.255
 ipv6 address 2001:DB8:3::3/128
 isis ipv6 enable 1
#
bgp 100
 router-id 3.3.3.3
 peer 2001:DB8:1::1 as-number 100
 peer 2001:DB8:1::1 connect-interface LoopBack1
 #
 ipv4-family unicast
  undo synchronization
 #              
 l2vpn-family evpn
  policy vpn-target
  peer 2001:DB8:1::1 enable
  peer 2001:DB8:1::1 advertise encap-type srv6
#
evpn source-address 3.3.3.3
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0010.html">Configuration Examples for SRv6 BE (IS-IS)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0033.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0233.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>