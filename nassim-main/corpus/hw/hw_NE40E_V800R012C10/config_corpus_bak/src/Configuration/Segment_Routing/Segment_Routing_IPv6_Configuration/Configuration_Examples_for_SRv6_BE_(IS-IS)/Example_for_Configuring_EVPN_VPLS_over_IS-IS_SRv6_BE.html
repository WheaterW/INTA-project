
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring EVPN VPLS over IS-IS SRv6 BE">
<meta name="abstract" content="This section provides an example for configuring SRv6 BE to carry EVPN E-LAN services.">
<meta name="description" content="This section provides an example for configuring SRv6 BE to carry EVPN E-LAN services.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0010.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0234.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0231.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00587852">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00587852">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0176648717">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring EVPN VPLS over IS-IS SRv6 BE</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0176648717"></a><a name="EN-US_TASK_0176648717"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring EVPN VPLS over IS-IS SRv6 BE</h1>
<div class="taskbody"><p>This section provides an example for configuring SRv6 BE to carry EVPN E-LAN services.</p>
<div class="context"><a name="EN-US_TASK_0176648717__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0176648717__fig_dc_vrp_srv6_cfg_all_002201">Figure 1</a>, PE1, the P, and PE2 are in the same AS and need to run IS-IS to implement IPv6 network connectivity. In addition, a bidirectional SRv6 BE path needs to be deployed between PE1 and PE2 to carry EVPN E-LAN services.</p>
<div class="fignone" id="EN-US_TASK_0176648717__fig_dc_vrp_srv6_cfg_all_002201"><a name="EN-US_TASK_0176648717__fig_dc_vrp_srv6_cfg_all_002201"></a><a name="fig_dc_vrp_srv6_cfg_all_002201"></a><span class="figcap"><b>Figure 1 </b>EVPN VPLS over SRv6 BE networking</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 and interface2 represent GE<span>0/1/0</span> and GE<span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_srv6_cfg_all_002201.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0176648717__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Enable IPv6 forwarding and configure an IPv6 address for each interface on PE1, the P, and PE2.</p>
</li><li><p>Enable IS-IS, configure an IS-IS level, and specify a network entity title on PE1, the P, and PE2.</p>
</li><li><p>Configure an EVPN instance in BD mode on each PE and bind the EVPN instance to an access-side sub-interface.</p>
</li><li><p>Establish a BGP EVPN peer relationship between PEs.</p>
</li><li><p>Configure SRv6 BE on PEs.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0176648717__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>EVPN instance name: evrf1</p>
</li><li><p>RD and RT of the EVPN instance</p>
</li><li><p>BD ID: 100</p>
</li><li><p>Names of locators on PE1: PE1_ARG and PE1; names of locators on PE2: PE2_ARG and PE2; dynamically generated opcodes</p>
</li><li><p>Length of the locators PE1_ARG and PE2_ARG: 10 (as specified in the args parameter)</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0176648717__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enable IPv6 forwarding and configure an IPv6 address for each interface.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>ipv6 address 2001:DB8:10::1 64</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface LoopBack 1</strong>
[<span class="keyword">*</span>PE1-LoopBack1] <strong>ip address 1.1.1.1 32</strong>
[<span class="keyword">*</span>PE1-LoopBack1] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>PE1-LoopBack1] <strong>ipv6 address 2001:DB8:1::1 128</strong>
[<span class="keyword">*</span>PE1-LoopBack1] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p>Configure an IPv4 address for the loopback interface because the EVPN source address needs to be an IPv4 address. The preceding example uses the configuration of PE1. The configurations of other devices are similar to the configuration of PE1. For configuration details, see <a href="#EN-US_TASK_0176648717__section_dc_vrp_srv6_cfg_all_002205">Configuration Files</a> in this section.</p>
</p></li><li><span>Configure IS-IS.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>is-level level-1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>network-entity 10.0000.0000.0001.00</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>ipv6 enable topology ipv6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>isis ipv6 enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface loopback1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-LoopBack1] <strong>isis ipv6 enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-LoopBack1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-LoopBack1] <strong>quit</strong></pre>
<p># Configure the P.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong>isis 1</strong> </pre>
<pre class="screen">[<span class="keyword">*</span>P-isis-1] <strong>is-level level-1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-isis-1] <strong>cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-isis-1] <strong>network-entity 10.0000.0000.0002.00</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-isis-1] <strong>ipv6 enable topology ipv6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-isis-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong>isis ipv6 enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/2/0</span>] <strong>isis ipv6 enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P] <strong>interface loopback1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-LoopBack1] <strong>isis ipv6 enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-LoopBack1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P-LoopBack1] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>is-level level-1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>network-entity 10.0000.0000.0003.00</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>ipv6 enable topology ipv6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>isis ipv6 enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface loopback1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-LoopBack1] <strong>isis ipv6 enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-LoopBack1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-LoopBack1] <strong>quit</strong></pre>
</p><p><p>After the configuration is complete, perform the following operations to check whether IS-IS is successfully configured:</p>
<p># Display IS-IS neighbor information. PE1 is used as an example.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display isis peer</strong></pre>
<pre class="screen">                          Peer information for ISIS(1)
                         
  System Id     Interface         Circuit Id        State HoldTime Type     PRI
--------------------------------------------------------------------------------
0000.0000.0002* GE<span>0/1/0</span>           0000.0000.0002.01  Up   8s       L1       64 

Total Peer(s): 1</pre>
<p># Display IS-IS routing table information. PE1 is used as an example.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display isis route</strong></pre>
<pre class="screen">                         Route information for ISIS(1)
                         -----------------------------

                        ISIS(1) Level-1 Forwarding Table
                        --------------------------------

 IPV6 Dest.        ExitInterface      NextHop                    Cost     Flags    
--------------------------------------------------------------------------------
2001:DB8:1::1/128  GE<span>0/1/0</span>            Direct                     10       D/-/L/-  
2001:DB8:2::2/128  GE<span>0/1/0</span>            FE80::3A5D:67FF:FE31:307   10       A/-/-/-
2001:DB8:3::3/128  GE<span>0/1/0</span>            FE80::3A5D:67FF:FE31:307   20       A/-/-/-  
2001:DB8:10::/64   GE<span>0/1/0</span>            Direct                     20       D/-/L/-  
2001:DB8:20::/64   GE<span>0/1/0</span>            FE80::3A5D:67FF:FE31:307   20       A/-/-/-  
     Flags: D-Direct, A-Added to URT, L-Advertised in LSPs, S-IGP Shortcut, 
            U-Up/Down Bit Set, LP-Local Prefix-Sid
<span>     Protect Type: L-Link Protect, N-Node Protect</span></pre>
</p></li><li><span>Configure an EVPN instance in BD mode on each PE and bind the EVPN instance to an access-side sub-interface.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>evpn source-address 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>evpn vpn-instance evrf1 bd-mode</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-evpn-instance-evrf1] <strong>route-distinguisher 100:1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-evpn-instance-evrf1] <strong>vpn-target 1:1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-evpn-instance-evrf1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>bridge-domain 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bd100] <strong>evpn binding vpn-instance evrf1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bd100] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/2/0</span>.1 mode l2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet <span>0/2/0</span>.1] <strong>encapsulation dot1q vid 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet <span>0/2/0</span>.1] <strong>rewrite pop single</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet <span>0/2/0</span>.1] <strong>bridge-domain 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet <span>0/2/0</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>evpn source-address 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>evpn vpn-instance evrf1 bd-mode</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-evpn-instance-evrf1] <strong>route-distinguisher 200:1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-evpn-instance-evrf1] <strong>vpn-target 1:1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-evpn-instance-evrf1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>bridge-domain 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bd100] <strong>evpn binding vpn-instance evrf1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bd100] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet <span>0/2/0</span>.1 mode l2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet <span>0/2/0</span>.1] <strong>encapsulation dot1q vid 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet <span>0/2/0</span>.1] <strong>rewrite pop single</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet <span>0/2/0</span>.1] <strong>bridge-domain 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet <span>0/2/0</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</p></li><li><span>Establish a BGP EVPN peer relationship between PEs.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>router-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>peer 2001:DB8:3::3 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>peer 2001:DB8:3::3 connect-interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>l2vpn-family evpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-af-evpn] <strong>peer 2001:DB8:3::3 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-af-evpn] <strong>peer 2001:DB8:3::3 </strong><strong>advertise encap-type srv6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-af-evpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>router-id 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>peer 2001:DB8:1::1 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>peer 2001:DB8:1::1 connect-interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>l2vpn-family evpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-af-evpn] <strong>peer 2001:DB8:1::1 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-af-evpn] <strong>peer 2001:DB8:1::1 </strong><strong>advertise encap-type srv6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-af-evpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p>After the configuration is complete, run the <strong>display bgp evpn peer</strong> command on the PEs and check whether BGP EVPN peer relationships have been established between the PEs. If the <strong>Established</strong> state is displayed in the command output, the BGP EVPN peer relationships have been established successfully.</p>
</p></li><li><span>Deploy SRv6 BE between PEs.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>segment-routing ipv6</strong>
[<span class="keyword">*</span>PE1-segment-routing-ipv6] <strong>encapsulation source-address 2001:DB8:1::1</strong>
[<span class="keyword">*</span>PE1-segment-routing-ipv6] <strong>locator PE1_ARG ipv6-prefix 2001:DB8:12:: 64 args 10</strong>
[<span class="keyword">*</span>PE1-segment-routing-ipv6-locator] <strong>quit</strong>
[<span class="keyword">*</span>PE1-segment-routing-ipv6] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>isis 1</strong>
[<span class="keyword">*</span>PE1-isis-1] <strong>segment-routing ipv6 locator PE1_ARG</strong><strong> auto-sid-disable</strong>
[<span class="keyword">*</span>PE1-isis-1] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>evpn vpn-instance evrf1 bd-mode</strong>
[<span class="keyword">*</span>PE1-evpn-instance-evrf1] <strong>segment-routing ipv6 locator PE1_ARG unicast-locator PE1</strong>
[<span class="keyword">*</span>PE1-evpn-instance-evrf1] <strong>segment-routing ipv6 best-effort</strong>
[<span class="keyword">*</span>PE1-evpn-instance-evrf1] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>segment-routing ipv6</strong>
[<span class="keyword">*</span>PE2-segment-routing-ipv6] <strong>encapsulation source-address 2001:DB8:3::3</strong>
[<span class="keyword">*</span>PE2-segment-routing-ipv6] <strong>locator PE2_ARG ipv6-prefix 2001:DB8:22:: 64 args 10</strong>
[<span class="keyword">*</span>PE2-segment-routing-ipv6-locator] <strong>quit</strong>
[<span class="keyword">*</span>PE2-segment-routing-ipv6] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>isis 1</strong>
[<span class="keyword">*</span>PE2-isis-1] <strong>segment-routing ipv6 locator PE2_ARG auto-sid-disable</strong>
[<span class="keyword">*</span>PE2-isis-1] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>evpn vpn-instance evrf1 bd-mode</strong>
[<span class="keyword">*</span>PE2-evpn-instance-evrf1] <strong>segment-routing ipv6 locator PE2_ARG unicast-locator PE2</strong>
[<span class="keyword">*</span>PE2-evpn-instance-evrf1] <strong>segment-routing ipv6 best-effort</strong>
[<span class="keyword">*</span>PE2-evpn-instance-evrf1] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>Run the <strong>display segment-routing ipv6 local-sid</strong> { <strong>end-dt2u</strong> | <strong>end-dt2ul</strong> | <strong>end-dt2m</strong> } <strong>forwarding</strong> command on each PE to check information about the SRv6 BE local SID table. PE1 is used as an example.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display segment-routing ipv6 local-sid end-dt2m forwarding</strong></pre>
<pre class="screen">                    My Local-SID End.DT2M Forwarding Table
                     --------------------------------------
SID             : 2001:DB8:12::400/118                         FuncType    : End.DT2M
Bridge-domain ID: 100                                          
LocatorName     : PE1_ARG                                      LocatorID   : 5
Flavor          : NO-FLAVOR                                    SidCompress : NO
UpdateTime      : 2023-05-10 01:46:05.713

Total SID(s): 1</pre>
<p>Run the <strong>display bgp evpn all routing-table</strong> command on each PE. The command output shows the EVPN route sent from the peer end. PE1 is used as an example.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display bgp evpn all routing-table</strong></pre>
<pre class="screen"> Local AS number : 100

 BGP Local router ID is 1.1.1.1
 Status codes: * - valid, &gt; - best, d - damped, x - best external, a - add path,
               h - history,  i - internal, s - suppressed, S - Stale
               Origin : i - IGP, e - EGP, ? - incomplete


 EVPN address family:
 Number of Inclusive Multicast Routes: 2
 Route Distinguisher: 100:1
       Network(EthTagId/IpAddrLen/OriginalIp)                 NextHop
 *&gt;    0:32:1.1.1.1                                           127.0.0.1                                    
 *&gt;i   0:32:3.3.3.3                                           2001:DB8:3::3                                


 EVPN-Instance evrf1:
 Number of Inclusive Multicast Routes: 2
       Network(EthTagId/IpAddrLen/OriginalIp)                 NextHop
 *&gt;    0:32:1.1.1.1                                           127.0.0.1                                    
 *&gt;i   0:32:3.3.3.3                                           2001:DB8:3::3</pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0176648717__section_dc_vrp_srv6_cfg_all_002205"><a name="EN-US_TASK_0176648717__section_dc_vrp_srv6_cfg_all_002205"></a><a name="section_dc_vrp_srv6_cfg_all_002205"></a><a name="EN-US_TASK_0176648717__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#
sysname PE1
#
evpn vpn-instance evrf1 bd-mode
 route-distinguisher 100:1
 segment-routing ipv6 best-effort
 segment-routing ipv6 locator PE1_ARG unicast-locator PE1 
 vpn-target 1:1 export-extcommunity
 vpn-target 1:1 import-extcommunity
#
bridge-domain 100
 evpn binding vpn-instance evrf1
#               
segment-routing ipv6
 encapsulation source-address 2001:db8:1::1
 locator PE1_ARG ipv6-prefix 2001:DB8:12:: 64 args 10
#               
isis 1          
 is-level level-1
 cost-style wide
 network-entity 10.0000.0000.0001.00
 #              
 ipv6 enable topology ipv6
 segment-routing ipv6 locator PE1_ARG auto-sid-disable
 #              
# 
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ipv6 enable    
 ipv6 address 2001:DB8:10::1/64
 isis ipv6 enable 1
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
#
interface GigabitEthernet<span>0/2/0</span>.1 mode l2
 encapsulation dot1q vid 1
 rewrite pop single
 bridge-domain 100
#
interface LoopBack1
 ipv6 enable    
 ip address 1.1.1.1 255.255.255.255
 ipv6 address 2001:DB8:1::1/128
 isis ipv6 enable 1
#               
bgp 100         
 router-id 1.1.1.1
 peer 2001:DB8:3::3 as-number 100
 peer 2001:DB8:3::3 connect-interface LoopBack1
 #              
 ipv4-family unicast
  undo synchronization
 #              
 l2vpn-family evpn
  policy vpn-target
  peer 2001:DB8:3::3 enable
  peer 2001:DB8:3::3 advertise encap-type srv6
#
evpn source-address 1.1.1.1
#
return</pre>
</li><li>P configuration file<pre class="screen">#
sysname P
#               
isis 1          
 is-level level-1
 cost-style wide
 network-entity 10.0000.0000.0002.00
 #              
 ipv6 enable topology ipv6
 #              
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ipv6 enable    
 ipv6 address 2001:DB8:10::2/64
 isis ipv6 enable 1
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown  
 ipv6 enable    
 ipv6 address 2001:DB8:20::1/64
 isis ipv6 enable 1
#
interface LoopBack1
 ipv6 enable    
 ip address 2.2.2.2 255.255.255.255
 ipv6 address 2001:DB8:2::2/128
 isis ipv6 enable 1
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2
#
evpn vpn-instance evrf1 bd-mode
 route-distinguisher 200:1
 segment-routing ipv6 best-effort
 segment-routing ipv6 locator PE2_ARG unicast-locator PE2 
 vpn-target 1:1 export-extcommunity
 vpn-target 1:1 import-extcommunity
#
bridge-domain 100
 evpn binding vpn-instance evrf1
#               
segment-routing ipv6
 encapsulation source-address 2001:db8:3::3
 locator PE2_ARG ipv6-prefix 2001:DB8:22:: 64 args 10
#               
isis 1          
 is-level level-1
 cost-style wide
 network-entity 10.0000.0000.0003.00
 #              
 ipv6 enable topology ipv6
 segment-routing ipv6 locator PE2_ARG auto-sid-disable
 #              
# 
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ipv6 enable    
 ipv6 address 2001:DB8:20::2/64
 isis ipv6 enable 1
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
#
interface GigabitEthernet<span>0/2/0</span>.1 mode l2
 encapsulation dot1q vid 1
 rewrite pop single
 bridge-domain 100
#
interface LoopBack1
 ipv6 enable    
 ip address 3.3.3.3 255.255.255.255
 ipv6 address 2001:DB8:3::3/128
 isis ipv6 enable 1
#               
bgp 100         
 router-id 3.3.3.3
 peer 2001:DB8:1::1 as-number 100
 peer 2001:DB8:1::1 connect-interface LoopBack1
 #              
 ipv4-family unicast
  undo synchronization
 #              
 l2vpn-family evpn
  policy vpn-target
  peer 2001:DB8:1::1 enable
  peer 2001:DB8:1::1 advertise encap-type srv6
# 
evpn source-address 3.3.3.3
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0010.html">Configuration Examples for SRv6 BE (IS-IS)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0234.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0231.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>