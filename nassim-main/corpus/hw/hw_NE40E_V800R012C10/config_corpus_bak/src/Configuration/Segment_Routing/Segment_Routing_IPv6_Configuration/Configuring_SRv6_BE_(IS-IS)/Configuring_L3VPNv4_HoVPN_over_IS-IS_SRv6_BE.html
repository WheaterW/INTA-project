
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring L3VPNv4 HoVPN over IS-IS SRv6 BE">
<meta name="abstract" content="This section describes how to configure L3VPNv4 HoVPN over SRv6 BE.">
<meta name="description" content="This section describes how to configure L3VPNv4 HoVPN over SRv6 BE.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0002.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0036.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00556928,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00587852">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00587852">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0226968185">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring L3VPNv4 HoVPN over IS-IS SRv6 BE</title>
</head>
<body><a name="EN-US_TASK_0226968185"></a><a name="EN-US_TASK_0226968185"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring L3VPNv4 HoVPN over IS-IS SRv6 BE</h1>
<div class="taskbody"><p>This section describes how to configure L3VPNv4 HoVPN over SRv6 BE.</p>
<div class="context"><a name="EN-US_TASK_0226968185__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>Currently, the typical structure of a MAN consists of three layers: core layer, aggregation layer, and access layer. To implement VPN functions on such a hierarchical network for achieving end-to-end VPN data transmission and improving the performance and scalability of the entire network, you need to deploy hierarchical VPN solutions, among which the hierarchy of VPN (HoVPN) solution is commonly used.</p>
<p>During network evolution, the core and aggregation layers may use different forwarding modes, that is, SRv6 forwarding and MPLS forwarding. When the HoVPN solution is used to implement hierarchical VPN deployment, the methods used to forward L3VPNv4 data over a public network fall into three categories (as shown in <a href="#EN-US_TASK_0226968185__fig1910417183547">Figure 1</a>): L3VPNv4 over MPLS plus SRv6, L3VPNv4 over SRv6 plus MPLS, and L3VPNv4 over SRv6 plus SRv6.</p>
<div class="fignone" id="EN-US_TASK_0226968185__fig1910417183547"><a name="EN-US_TASK_0226968185__fig1910417183547"></a><a name="fig1910417183547"></a><span class="figcap"><b>Figure 1 </b>HoVPN solution networking</span><br><span><img class="vsd" src="figure/en-us_image_0235784736.png" width="NaN" height="NaN"></span></div>
<p>This section uses L3VPNv4 over SRv6 BE plus SRv6 BE as an example. On the network shown in <a href="#EN-US_TASK_0226968185__fig_dc_vrp_srv6_cfg_all_001201">Figure 2</a>, L3VPNv4 HoVPN over SRv6 BE is deployed. It allows SRv6 BE paths on a public network to carry L3VPNv4 data on condition that hierarchical VPN deployment is implemented through the HoVPN solution.</p>
<div class="fignone" id="EN-US_TASK_0226968185__fig_dc_vrp_srv6_cfg_all_001201"><a name="EN-US_TASK_0226968185__fig_dc_vrp_srv6_cfg_all_001201"></a><a name="fig_dc_vrp_srv6_cfg_all_001201"></a><span class="figcap"><b>Figure 2 </b>L3VPNv4 HoVPN over SRv6 BE networking</span><br><span><img class="vsd" src="figure/en-us_image_0235768722.png" width="NaN" height="NaN"></span></div>
<h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring L3VPNv4 HoVPN over SRv6 BE, complete the following tasks:</p>
<ul><li>Configure a link layer protocol.</li><li>Configure addresses for interfaces to ensure that neighboring devices are reachable at the network layer.</li></ul>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0226968185__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure IPv6 IS-IS on the UPE, SPE, and NPE. For configuration details, see <a href="dc_vrp_isis_cfg_1023.html">Configuring Basic IS-IS Functions (IPv6)</a>.</span></li><li><span>Configure IPv4 route exchange between the UPE and CE1 and between the NPE and CE2. For configuration details, see <a href="dc_vrp_mpls-l3vpn-v4_cfg_0158.html">Configuring Route Exchange Between PEs and CEs</a>.</span></li><li><span>Enable IS-IS SRv6 on the UPE, SPE, and NPE, and establish an MP-IBGP peer relationship between the UPE and SPE and another one between the NPE and SPE. In addition, configure a VPN instance, enable the IPv4 address family for the VPN instance, and configure SRv6 BE on each of the three devices. For configuration details, see <a href="dc_vrp_srv6_cfg_all_0012.html">Configuring L3VPNv4 over IS-IS SRv6 BE</a>.</span></li><li><span>Specify the UPE as the peer of the SPE and configure the SPE to advertise the default route to the UPE.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> { <em><i><span class="varname">as-number-plain</span></i></em> | <em><i><span class="varname">as-number-dot</span></i></em><i><span class="varname"> </span></i>}</span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family+vpnv4"><b><span class="cmdname">ipv4-family vpnv4</span></b></a></span><p><p>The BGP-VPNv4 address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <em>peerIpv6Addr </em><strong><span>upe</span></strong></span><p><p>The peer is specified as a UPE.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <em>ipv6-address </em><strong><span>default-originate vpn-instance</span></strong> <em>vpn-instance-name</em></span><p><p>The device is configured to automatically generate a default route and advertise it to the UPE.</p>
<p>If you do not run this command to automatically generate a default route, you can manually configure a static route with the next hop set to the NPE's public or private address. If the next hop is set to the SPE's address and a fault occurs on the link between the SPE and NPE, traffic black holes may occur. Then, run the <a href="cmdqueryname=ip+route-static+recursive-lookup+inherit-label-route+segment-routing-ipv6"><b><span class="cmdname">ip route-static recursive-lookup inherit-label-route segment-routing-ipv6</span></b></a> command to recurse the static route to an SRv6 route.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the BGP-VPNv4 address family view.</p>
</p></li></ol>
</li><li><span>Enable route regeneration on the SPE and configure the SPE to advertise regenerated routes to the NPE.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family+vpn-instance"><b><span class="cmdname">ipv4-family vpn-instance</span></b></a> <em><i><span class="varname">vpn-instance-name</span></i></em></span><p><p>The BGP-VPN instance IPv4 address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=advertise+best-route+route-reoriginate"><b><span class="cmdname">advertise best-route route-reoriginate</span></b></a></span><p><p>Route regeneration is enabled.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the BGP-VPN instance IPv4 address family view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family+vpnv4"><b><span class="cmdname">ipv4-family vpnv4</span></b></a></span><p><p>The BGP-VPNv4 address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <em>ipv6-address</em> <strong><span>advertise route-reoriginated vpnv4</span></strong></span><p><p>The SPE is configured to advertise regenerated routes in the BGP-VPNv4 address family to the NPE.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0226968185__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After configuring L3VPNv4 HoVPN over SRv6 BE, verify the configuration.</p>
<ul><li>Run the <a href="cmdqueryname=display+bgp+vpnv4+all+routing-table"><b><span class="cmdname">display bgp vpnv4 all routing-table</span></b></a> command to check BGP VPNv4 routing information.</li><li>Run the <a href="cmdqueryname=display+ip+routing-table+vpn-instance"><b><span class="cmdname">display ip routing-table vpn-instance </span></b></a><i><span class="varname">vpn-instance</span></i> command to check the routing tables of the NPE and UPE.</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0002.html">Configuring SRv6 BE (IS-IS)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0036.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>