
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring BFD for SR-MPLS BE (SR and LDP Interworking Scenario)">
<meta name="abstract" content="This section describes how to use BFD to detect an LSP fault in an SR+LDP interworking scenario.">
<meta name="description" content="This section describes how to use BFD to detect an LSP fault in an SR+LDP interworking scenario.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0048.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0130.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="segment_routing_vrp,w00604599,l00455378,l00587852,w00606909,w00800033">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00468467">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00425560">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368833">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring BFD for SR-MPLS BE (SR and LDP Interworking Scenario)</title>
</head>
<body><a name="EN-US_TASK_0172368833"></a><a name="EN-US_TASK_0172368833"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring BFD for SR-MPLS BE (SR and LDP Interworking Scenario)</h1>
<div class="taskbody"><p>This section describes how to use BFD to detect an LSP fault in an SR+LDP interworking scenario.</p>
<div class="context"><a name="EN-US_TASK_0172368833__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>SR and LDP interworking enables SR and LDP to work together on the same network. SR-MPLS BE and LDP networks can be connected through this technology to implement MPLS forwarding.</p>
<p>If BFD for SR-MPLS BE detects a fault on the primary tunnel when SR communicates with LDP, an application, such as VPN FRR, rapidly switches traffic to minimize the impact on traffic.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368833__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring BFD for SR-MPLS BE (in the SR and LDP interworking scenario), complete the following tasks:</p>
<ul><li><p><a href="dc_vrp_sr_all_cfg_0018.html">Configure IS-IS SR to communicate with LDP</a> or <a href="dc_vrp_sr_all_cfg_0032.html">OSPF SR to communicate with LDP</a>.</p>
</li><li><p>Set each LSR ID using the <a href="cmdqueryname=mpls+lsr-id"><b><span class="cmdname">mpls lsr-id</span></b></a> <i><span class="varname">lsr-id</span></i> command. Ensure that the route to the local <i><span class="varname">lsr-id</span></i> is reachable.</p>
</li></ul>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172368833__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Create a BFD session on the SR side.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a></span><p><p>The BFD view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mpls-passive"><b><span class="cmdname">mpls-passive</span></b></a></span><p><p>The egress is enabled to create a BFD session passively.</p>
<p>The egress has to receive an LSP ping request carrying a BFD TLV before creating a BFD session.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=segment-routing"><b><span class="cmdname">segment-routing</span></b></a></span><p><p>The Segment Routing view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bfd+enable"><b><span class="cmdname">bfd enable</span></b></a> <strong><span>mode</span></strong> <strong><span>tunnel</span></strong> [ <strong><span>filter-policy</span></strong> <strong><span>ip-prefix</span></strong> <i><span class="varname">ip-prefix-name</span></i> | <strong><span>effect-sr-lsp</span></strong> | <strong><span>nil-fec</span></strong> ] <sup>*</sup></span><p><p>BFD is enabled for SR LSPs.</p>
</p><p><p>If <strong><span>effect-sr-lsp</span></strong> is specified and BFD goes down, the SR LSPs are withdrawn.</p>
<p>In an SR and LDP interworking scenario, the ingress node cannot detect whether LDP LSPs are stitched to SR LSPs in the LDP to SR direction. In the LSP ping packet triggered by BFD, the encapsulated FEC type is LDP. When the packet arrives at the egress node (SR node), the FEC type fails to be verified, preventing BFD from going Up. To resolve this issue, configure the <strong><span id="EN-US_TASK_0172368833__en-us_cliref_0172381543_cmdparmname1571926085214520">nil-fec</span></strong> parameter.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a> <strong><span>tunnel</span></strong> { <strong><span>min-rx-interval</span></strong> <i><span class="varname">receive-interval</span></i> | <strong><span>min-tx-interval</span></strong> <i><span class="varname">transmit-interval</span></i> | <strong><span>detect-multiplier</span></strong> <i><span class="varname">multiplier-value</span></i> } <sup>*</sup></span><p><p>BFD parameters are set for SR tunnels.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Create a BFD session on the LDP side.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a></span><p><p>The BFD view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mpls-passive"><b><span class="cmdname">mpls-passive</span></b></a></span><p><p>The egress is enabled to create a BFD session passively.</p>
<p>The egress has to receive an LSP ping request carrying a BFD TLV before creating a BFD session.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mpls"><b><span class="cmdname">mpls</span></b></a></span><p><p>The MPLS view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mpls+bfd+enable"><b><span class="cmdname">mpls bfd enable</span></b></a></span><p><p>An MPLS device to dynamically establish a BFD session.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mpls+bfd-trigger"><b><span class="cmdname">mpls bfd-trigger</span></b></a> <strong><span>host</span></strong></span><p><p>Host IP routes are used as the policy for triggering LDP BFD sessions.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure a device that connects the LDP area to the SR area.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mpls"><b><span class="cmdname">mpls</span></b></a></span><p><p>The MPLS view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=lsp-trigger+segment-routing-interworking+best-effort+host"><b><span class="cmdname">lsp-trigger segment-routing-interworking best-effort host</span></b></a></span><p><p>A device is enabled to stitch SR LSPs to the proxy egress LSPs and transit LSPs that are established over non-local host routes with a 32-bit mask.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
<div class="postreq"><a name="EN-US_TASK_0172368833__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After successfully configuring BFD for SR-MPLS BE, run the <a href="cmdqueryname=display+segment-routing+bfd+tunnel+session"><b><span class="cmdname">display segment-routing bfd tunnel session</span></b></a> [ <strong><span>prefix</span></strong> <i><span class="varname">ip-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } ] command to check information about the BFD session that monitors SR LSPs.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0000.html">Segment Routing MPLS Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0048.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0130.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>