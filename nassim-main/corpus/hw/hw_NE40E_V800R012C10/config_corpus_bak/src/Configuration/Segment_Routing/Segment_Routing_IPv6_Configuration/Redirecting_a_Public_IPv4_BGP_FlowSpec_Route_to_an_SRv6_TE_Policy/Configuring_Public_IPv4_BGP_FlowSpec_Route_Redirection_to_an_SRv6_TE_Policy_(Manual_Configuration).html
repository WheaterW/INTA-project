
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Public IPv4 BGP FlowSpec Route Redirection to an SRv6 TE Policy (Manual Configuration)">
<meta name="abstract" content="Manually generate a BGP FlowSpec route and configure redirection rules to redirect the route to an SRv6 TE Policy.">
<meta name="description" content="Manually generate a BGP FlowSpec route and configure redirection rules to redirect the route to an SRv6 TE Policy.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0123.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0125.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00587852">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0200607314">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Public IPv4 BGP FlowSpec Route Redirection to an SRv6 TE Policy (Manual Configuration)</title>
</head>
<body><a name="EN-US_TASK_0200607314"></a><a name="EN-US_TASK_0200607314"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Public IPv4 BGP FlowSpec Route Redirection to an SRv6 TE Policy (Manual Configuration)</h1>
<div class="taskbody"><p>Manually generate a BGP FlowSpec route and configure redirection rules to redirect the route to an SRv6 TE Policy.</p>
<div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0200607314__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before redirecting a public IPv4 BGP FlowSpec route to an SRv6 TE Policy in manual configuration mode, complete the following tasks:</p>
<ul><li><a href="dc_vrp_bgp_cfg_3006.html">Configure a BGP peer relationship.</a></li><li><a href="dc_vrp_srv6_cfg_all_0110.html">Configure an SRv6 TE Policy in manual configuration mode.</a></li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0200607314__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>If no controller is deployed, perform the following operations to manually redirect a public IPv4 BGP FlowSpec route to an SRv6 TE Policy:</p>
<ol><li>Manually configure an SRv6 TE Policy.</li><li>Manually configure a BGP FlowSpec route and define redirection rules. BGP FlowSpec route redirection is based on &lt;Redirection IP address, Color, Public End.DT4 SID&gt;. If the redirection IP address, color, and public End.DT4 SID attributes of a BGP FlowSpec route match the endpoint, color, and public End.DT4 SID attributes of an SRv6 TE Policy, the route can be successfully redirected to the SRv6 TE Policy.</li><li>To enable the device to advertise the BGP FlowSpec route to another device, establish a BGP peer relationship in the BGP-Flow address family.</li></ol>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0200607314__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure a public End.DT4 SID.</span><p><ol><li>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a><p>The system view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=segment-routing+ipv6"><b><span class="cmdname">segment-routing ipv6</span></b></a></p>
<p>SRv6 is enabled, and the SRv6 view is displayed.</p>
</li><li id="EN-US_TASK_0200607314__li1036194221111">Configure a source address for SRv6 VPN encapsulation. Note that you only need to perform one of the following operations. If both of the operations are performed, the latest configuration overrides the previous one.<ul id="EN-US_TASK_0200607314__ul148941944201215"><li id="EN-US_TASK_0200607314__en-us_task_0172368959_li761411538546">Run the <a href="cmdqueryname=encapsulation+source-address"><b><span class="cmdname" id="EN-US_TASK_0200607314__en-us_task_0172368959_cmdname23368553547">encapsulation source-address</span></b></a> <i><span class="varname" id="EN-US_TASK_0200607314__en-us_task_0172368959_varname6336145515412">ipv6-address</span></i> [ <strong><span id="EN-US_TASK_0200607314__en-us_task_0172368959_cmdparmname1633612551542">ip-ttl</span></strong> <i><span class="varname" id="EN-US_TASK_0200607314__en-us_task_0172368959_varname2033635519549">ttl-value</span></i> ] command to specify a source address for SRv6 encapsulation.</li><li id="EN-US_TASK_0200607314__en-us_task_0172368959_li1554119145516">Run the <a href="cmdqueryname=encapsulation+source-interface"><b><span class="cmdname" id="EN-US_TASK_0200607314__en-us_task_0172368959_cmdname10488513573">encapsulation source-interface</span></b></a> { <i><span class="varname" id="EN-US_TASK_0200607314__en-us_task_0172368959_varname0729113313571">intfname</span></i> | <i><span class="varname" id="EN-US_TASK_0200607314__en-us_task_0172368959_varname17377153912578">interfaceType</span></i> <i><span class="varname" id="EN-US_TASK_0200607314__en-us_task_0172368959_varname1951134465716">interfaceNum</span></i> } [ <strong id="EN-US_TASK_0200607314__en-us_task_0172368959_b7945154716571">ip-ttl</strong> <i><span class="varname" id="EN-US_TASK_0200607314__en-us_task_0172368959_varname2091014584572">ttl-value</span></i> ] command to specify the interface to which the source address used for SRv6 encapsulation belongs.<p id="EN-US_TASK_0200607314__en-us_task_0172368959_p2488153115910">If no IPv6 global address is configured for the interface specified using the <a href="cmdqueryname=encapsulation+source-interface"><b><span class="cmdname" id="EN-US_TASK_0200607314__en-us_task_0172368959_cmdname2054948195915">encapsulation source-interface</span></b></a> command, the source address for SRv6 encapsulation is not configured.</p>
</li></ul>
</li><li><p>Run <span><a href="cmdqueryname=locator"><b><span class="cmdname">locator</span></b></a> <i><span class="varname">locator-name</span></i> [ <strong><span>ipv6-prefix</span></strong> <i><span class="varname">ipv6-address</span></i> <i><span class="varname">prefix-length</span></i> [ <strong><span>static</span></strong> <i><span class="varname">static-length</span></i> | <strong><span>args</span></strong> <i><span class="varname">args-length</span></i> ] <sup>*</sup> ]</span></p>
<p>An SRv6 locator is configured, and the SRv6 locator view is displayed.</p>
</li><li>Run <a href="cmdqueryname=opcode"><b><span class="cmdname">opcode</span></b></a> <i><span class="varname">func-opcode</span></i> <strong><span>end-dt4</span></strong><p>A public End.DT4 SID is configured.</p>
</li><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>Exit the SRv6 locator view.</p>
</li><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>Exit the SRv6 view.</p>
</li><li>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a><p>The configuration is committed.</p>
</li></ol>
</p></li><li><span>Configure a BGP FlowSpec route.</span><p><ol><li>Run <a href="cmdqueryname=flow-route"><b><span class="cmdname">flow-route</span></b></a> <i><span class="varname">flowroute-name</span></i><p>A static BGP FlowSpec route is created, and the Flow-Route view is displayed.</p>
</li><li>Configure <a href="cmdqueryname=if-match"><b><span class="cmdname">if-match</span></b></a> clauses. For details, see "BGP Flow Specification Configuration" in <em>Configuration</em> - <em>Security</em>.</li><li><p>Run <a href="cmdqueryname=apply+redirect"><b><span class="cmdname">apply redirect</span></b></a> <strong><span>ipv6</span></strong> <i><span class="varname">redirectIPv6RT</span></i> <strong><span>color</span></strong> <i><span class="varname">colorValue</span></i> [ <strong><span>prefix-sid</span></strong> <i><span class="varname">prefix-sid-value</span></i> ]</p>
<p>The traffic that matches the <strong>if-match</strong> clauses is precisely redirected to the specified SRv6 TE Policy.</p>
</li><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>Exit the Flow-Route view.</p>
</li><li>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a><p>The configuration is committed.</p>
</li></ol>
</p></li><li><span>Configure a BGP peer relationship in the BGP-Flow address family.</span><p><p>Establish a BGP FlowSpec peer relationship between the ingress of the SRv6 TE Policy and the device on which the BGP FlowSpec route is manually generated.</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family+flow"><b><span class="cmdname">ipv4-family flow</span></b></a></span><p><p>The BGP-Flow address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <a href="cmdqueryname=enable"><b><span class="cmdname">enable</span></b></a></span><p><p>The BGP FlowSpec peer relationship is enabled.</p>
<p>After the BGP FlowSpec peer relationship is established in the BGP-Flow address family view, the manually generated BGP FlowSpec route is automatically imported to the BGP-Flow routing table and then sent to each peer.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>redirect tunnelv6</span></strong></span><p><p>The device is enabled to process the redirection next-hop IPv6 address, color, and prefix SID attributes carried in BGP FlowSpec routes received from a peer.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the BGP-Flow address family view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the BGP view.</p>
</p></li></ol>
</li><li><span>Allow the device to recurse static BGP IPv6 FlowSpec routes to corresponding SRv6 TE Policies.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=tunnel-selector"><b><span class="cmdname">tunnel-selector</span></b></a><strong> </strong><em>name</em><em> matchMode </em><strong>node </strong><em>node</em></span><p><p>A tunnel selector is created and its view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the tunnel selector view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family+flow"><b><span class="cmdname">ipv4-family flow</span></b></a></span><p><p>The BGP-Flow address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=redirect+tunnelv6+tunnel-selector"><b><span class="cmdname">redirect tunnelv6 tunnel-selector</span></b></a> <i><span class="varname">tunnel-selector-name</span></i></span><p><p>The device is enabled to recurse received routes with the redirection next-hop IPv6 address, color, and prefix SID attributes to SRv6 TE Policies.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
<div class="example"><a name="EN-US_TASK_0200607314__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After configuring the redirection, verify the configuration.</p>
<ul><li><p>Run the <a href="cmdqueryname=display+bgp+flow+peer"><b><span class="cmdname">display bgp flow peer</span></b></a> [ [ <i><span class="varname">ipv4-address</span></i> ] <strong><span>verbose</span></strong> ] command to check information about BGP FlowSpec peers.</p>
</li><li><p>Run the <a href="cmdqueryname=display+bgp+flow+routing-table"><b><span class="cmdname">display bgp flow routing-table</span></b></a> command to check BGP FlowSpec routing information.</p>
</li><li><p>Run the <a href="cmdqueryname=display+flowspec+statistics"><b><span class="cmdname">display flowspec statistics</span></b></a> <i><span class="varname">reindex</span></i> command to check statistics about traffic transmitted over BGP FlowSpec routes.</p>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0123.html">Redirecting a Public IPv4 BGP FlowSpec Route to an SRv6 TE Policy
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0125.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>