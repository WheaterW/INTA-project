
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Dynamic BFD for SR-MPLS TE LSP">
<meta name="abstract" content="Dynamic BFD for SR-MPLS TE LSP rapidly detects faults of SR-MPLS TE LSPs, which protects traffic transmitted on SR-MPLS TE LSPs.">
<meta name="description" content="Dynamic BFD for SR-MPLS TE LSP rapidly detects faults of SR-MPLS TE LSPs, which protects traffic transmitted on SR-MPLS TE LSPs.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr-te_cfg_0307.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr-te_cfg_0300.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909,l00587852">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00468467">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368837">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Dynamic BFD for SR-MPLS TE LSP</title>
</head>
<body><a name="EN-US_TASK_0172368837"></a><a name="EN-US_TASK_0172368837"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Dynamic BFD for SR-MPLS TE LSP</h1>
<div class="taskbody"><p>Dynamic BFD for SR-MPLS TE LSP rapidly detects faults of SR-MPLS TE LSPs, which protects traffic transmitted on SR-MPLS TE LSPs.</p>
<div class="context"><a name="EN-US_TASK_0172368837__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>BFD detects the connectivity of SR-MPLS TE LSPs. Dynamic BFD for SR-MPLS TE LSP is configured to rapidly switch traffic from a primary LSP to a backup LSP if the primary LSP fails. Unlike static BFD for SR-MPLS TE LSP, dynamic BFD for SR-MPLS TE LSP simplifies the configuration and minimizes manual configuration errors.</p>
<p>Dynamic BFD can only monitor a part of an SR-MPLS TE tunnel.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368837__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring dynamic BFD for SR-MPLS TE LSP, complete the following task:</p>
<ul><li>Configure an SR-MPLS TE tunnel.</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172368837__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enable BFD globally.</span><ol type="a"><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a></span></span><p><p>BFD is enabled globally, and the BFD view is displayed.</p>
<p>You can set BFD parameters only after running the <a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a> command to enable BFD globally.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Enable the ingress to dynamically create a BFD session to monitor SR-MPLS TE LSPs.</span><p><p>Perform either of the following operations to enable the ingress to dynamically create a BFD session to monitor SR-MPLS TE LSPs:</p>
<ul><li><p>Globally enable the capability if BFD sessions need to be automatically created for most SR-MPLS TE tunnels on the ingress.</p>
</li><li><p>Enable the capability on a specific tunnel interface if a BFD session needs to be automatically created for a specific or some SR-MPLS TE tunnels on the ingress.</p>
</li></ul>
<p>Perform the following operations as required:</p>
</p><ul><li><strong>Globally enable the capability.</strong><ol type="a"><li><p>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></p>
<p>The system view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=mpls"><b><span class="cmdname">mpls</span></b></a></p>
<p>The MPLS view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=mpls+te+bfd+enable"><b><span class="cmdname">mpls te bfd enable</span></b></a> [ <strong><span>one-arm-echo</span></strong> ]</p>
<p>The ingress is configured to automatically create a BFD session for each SR-MPLS TE tunnel.</p>
<p>After this command is run in the MPLS view, BFD for SR-MPLS TE LSP is enabled on all tunnel interfaces, except the tunnel interfaces on which BFD for SR-MPLS TE LSP is blocked.</p>
<p>If <strong><span>one-arm-echo</span></strong> is configured, a one-arm BFD echo session is established to monitor an SR-MPLS TE LSP.</p>
<p>If the egress does not support BFD for SR-MPLS TE, BFD sessions cannot be created. To address this issue, configure one-arm BFD.</p>
</li><li>(Optional) If some SR-MPLS TE tunnels do not need to be monitored using BFD for SR-MPLS TE LSP, block BFD for SR-MPLS TE LSP on each tunnel interface:<ol class="substepthirdol"><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>Return to the system view.</p>
</li><li>Run <a href="cmdqueryname=interface+tunnel"><b><span class="cmdname">interface tunnel</span></b></a> <i><span class="varname">interface-number</span></i><p>The SR-MPLS TE tunnel interface view is displayed.</p>
</li><li>Run <a href="cmdqueryname=mpls+te+bfd+block"><b><span class="cmdname">mpls te bfd block</span></b></a><p>The tunnel interface is disabled from automatically creating a BFD session to monitor an SR-MPLS TE tunnel.</p>
</li></ol>
</li><li><p>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></p>
<p>The configuration is committed.</p>
</li></ol>
</li><li><strong>Enable the capability on a tunnel interface.</strong><ul><li>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a><p>The system view is displayed.</p>
</li><li>Run <a href="cmdqueryname=interface+tunnel"><b><span class="cmdname">interface tunnel</span></b></a> <i><span class="varname">interface-number</span></i><p>The view of the SR-MPLS TE tunnel interface is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=mpls+te+bfd+enable"><b><span class="cmdname">mpls te bfd enable</span></b></a> [ <strong><span>one-arm-echo</span></strong> ]</p>
<p>The ingress is configured to automatically create a BFD session for the tunnel.</p>
<p>This command run in the tunnel interface view takes effect only on the tunnel interface.</p>
<p>If <strong><span>one-arm-echo</span></strong> is configured, a one-arm BFD echo session is established to monitor an SR-MPLS TE LSP. A Huawei device at the ingress cannot use BFD for SR-MPLS TE LSP to communicate with a non-Huawei device at the egress. In this situation, no BFD session can be established. To address this issue, configure one-arm BFD.</p>
</li><li>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a><p>The configuration is committed.</p>
</li></ul>
</li></ul>
</li><li><span>Enable the egress to passively create a BFD session.</span><ol type="a"><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a></span></span><p><p>The BFD view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=mpls-passive"><b><span class="cmdname">mpls-passive</span></b></a></span></span><p><p>The egress is enabled to create a BFD session passively.</p>
<p>The egress has to receive an LSP ping request carrying a BFD TLV before creating a BFD session.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>(Optional) Adjust BFD parameters on the ingress.</span><p><p>Adjust BFD parameters on the ingress in either of the following modes:</p>
<ul><li><p>Adjust BFD parameters globally. This method is used when BFD parameters for most SR-MPLS TE tunnels need to be adjusted on the ingress.</p>
</li><li><p>Adjust BFD parameters on a specific tunnel interface. If an SR-MPLS TE tunnel interface needs BFD parameters different from the globally configured ones, adjust BFD parameters on the specific tunnel interface.</p>
</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p"><ul><li>Effective local interval at which BFD packets are sent = MAX { Locally configured interval at which BFD packets are sent, Remotely configured interval at which BFD packets are received }</li><li>Effective local interval at which BFD packets are received = MAX { Remotely configured interval at which BFD packets are sent, Locally configured interval at which BFD packets are received }</li><li>Effective local BFD detection period = Effective local interval at which BFD packets are received x Remotely configured BFD detection multiplier</li></ul>
</div>
<p>On the egress that passively creates a BFD session, the BFD parameters cannot be adjusted, because the default values are the smallest values that can be set on the ingress. Therefore, if BFD for TE is used, the effective BFD detection period on both ends of an SR-MPLS TE tunnel is as follows:</p>
<ul><li><p>Effective detection period on the ingress = Configured interval at which BFD packets are received on the ingress x 3</p>
</li><li><p>Effective detection period on the egress = Configured interval at which BFD packets are sent on the ingress x Configured detection multiplier on the ingress</p>
</li></ul>
</div></div>
<p>Perform the following operations as required:</p>
</p><ul><li><strong>Adjust BFD parameters globally.</strong><ul><li>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a><p>The system view is displayed.</p>
</li><li>Run <a href="cmdqueryname=mpls"><b><span class="cmdname">mpls</span></b></a><p>The MPLS view is displayed.</p>
</li><li>Run <a href="cmdqueryname=mpls+te+bfd"><b><span class="cmdname">mpls te bfd</span></b></a> { <strong><span>min-tx-interval</span></strong> <i><span class="varname">tx-interval</span></i> | <strong><span>min-rx-interval</span></strong> <i><span class="varname">rx-interval</span></i> | <strong><span>detect-multiplier</span></strong> <i><span class="varname">multiplier</span></i> }*<p>The BFD parameters are set.</p>
</li><li>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a><p>The configuration is committed.</p>
</li></ul>
</li><li><strong>Adjust BFD parameters on a specific tunnel interface.</strong><ul><li>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a><p>The system view is displayed.</p>
</li><li>Run <a href="cmdqueryname=interface+tunnel"><b><span class="cmdname">interface tunnel</span></b></a> <i><span class="varname">interface-number</span></i><p>The tunnel interface view is displayed.</p>
</li><li>Run <a href="cmdqueryname=mpls+te+bfd"><b><span class="cmdname">mpls te bfd</span></b></a> { <strong><span>min-tx-interval</span></strong> <i><span class="varname">tx-interval</span></i> | <strong><span>min-rx-interval</span></strong> <i><span class="varname">rx-interval</span></i> | <strong><span>detect-multiplier</span></strong> <i><span class="varname">multiplier</span></i> }*<p>The BFD parameters are set.</p>
</li><li>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a><p>The configuration is committed.</p>
</li></ul>
</li></ul>
</li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0172368837__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><div class="p">After the configuration of dynamic BFD for SR-MPLS TE LSP is complete, verify the configurations.<ul><li>Run the <a href="cmdqueryname=display+bfd+session"><b><span class="cmdname">display bfd session</span></b></a> <strong><span>dynamic</span></strong> [ <strong><span>verbose</span></strong> ] command to check information about BFD sessions on the ingress.</li><li>Run the <a href="cmdqueryname=display+bfd+session"><b><span class="cmdname">display bfd session</span></b></a> <span><strong><span>passive-dynamic</span></strong> </span>[ <strong><span>peer-ip</span></strong> <i><span class="varname">peer-ip</span></i> <strong><span>remote-discriminator</span></strong> <i><span class="varname">discriminator</span></i> ] [ <strong><span>verbose</span></strong> ] command to check information about BFD sessions that are passively created on the egress.</li><li>Run the following commands to check BFD statistics:<ul><li>Run the <a href="cmdqueryname=display+bfd+statistics"><b><span class="cmdname">display bfd statistics</span></b></a> command to check all BFD statistics.</li><li>Run the <a href="cmdqueryname=display+bfd+statistics+session"><b><span class="cmdname">display bfd statistics session</span></b></a> <strong><span>dynamic</span></strong> command to check statistics about dynamic BFD sessions.</li></ul>
</li><li>Run the <a href="cmdqueryname=display+mpls+bfd+session"><b><span class="cmdname">display mpls bfd session</span></b></a> { <strong><span>protocol</span></strong> <strong><span>rsvp-te</span></strong> | <strong><span>outgoing-interface</span></strong> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> } [ <strong><span>verbose</span></strong> ] command to check information about BFD sessions for MPLS.</li></ul>
</div>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0000.html">Segment Routing MPLS Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr-te_cfg_0307.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr-te_cfg_0300.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>