
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring an SRv6 SFC to Carry IPv4 Services (SFF-to-SF Packets Are Forwarded at Layer 2)">
<meta name="abstract" content="This section provides an example for configuring an SRv6 TE Policy to carry IPv4 services in an SRv6 SFC scenario (SFF-to-SF packets are forwarded at Layer 2).">
<meta name="description" content="This section provides an example for configuring an SRv6 TE Policy to carry IPv4 services in an SRv6 SFC scenario (SFF-to-SF packets are forwarded at Layer 2).">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0101.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0224.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0230.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00587852">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0223624848">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/thickbox.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/imageResize.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery-migrate-1.2.1.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery-ui.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery.mousewheel.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/thickbox.js"></script>
<title>Example for Configuring an SRv6 SFC to Carry IPv4 Services (SFF-to-SF Packets Are Forwarded at Layer 2)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0223624848"></a><a name="EN-US_TASK_0223624848"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring an SRv6 SFC to Carry IPv4 Services (SFF-to-SF Packets Are Forwarded at Layer 2)</h1>
<div class="taskbody"><p>This section provides an example for configuring an SRv6 TE Policy to carry IPv4 services in an SRv6 SFC scenario (SFF-to-SF packets are forwarded at Layer 2).</p>
<div class="context"><a name="EN-US_TASK_0223624848__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0223624848__fig184238288365">Figure 1</a>, SF1 and SF2 are connected to SFF1 and SFF2, respectively. SF1 and SF2 provide different SFC functions. For the service flow direction from the SC to the tail end, it is required that the SFC function be configured on the network to ensure that IPv4 service packets are processed by SF1 and SF2 in sequence.</p>
<div class="fignone" id="EN-US_TASK_0223624848__fig184238288365"><a name="EN-US_TASK_0223624848__fig184238288365"></a><a name="fig184238288365"></a><span class="figcap"><b>Figure 1 </b>Configuring an SRv6 SFC to carry IPv4 services (SFF-to-SF packets are forwarded at Layer 2)</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 3 in this example represent GE <span>0/1/0</span>, GE <span>0/2/0</span>, and GE <span>0/3/0</span>, respectively.</p>
</div></div>
<br><span><img class="imgResize" src="figure/en-us_image_0223626265.png" width="518.7" height="327.35316600000004" title="Click to enlarge"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0223624848__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>Before configuring an SRv6 SFC to carry IPv4 services (SFF-to-SF packets are forwarded at Layer 2), note the following:</p>
<ul><li>The configuration in this example focuses on the SC, SFFs, and tail end. The configuration on the SFs is not mentioned.</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0223624848__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Enable IPv6 forwarding and configure an IPv6 address for each interface.</p>
</li><li><p>Enable IS-IS, configure an IS-IS level, and specify a network entity title (NET) on each device.</p>
</li><li>Configure basic SRv6 functions on each device.</li><li>Configure SF access on SFFs.</li><li>Configure SFC on SFFs.</li><li><p>Configure an SRv6 TE Policy on the SC.</p>
</li><li>Configure a traffic policy on the SC to redirect traffic to the SRv6 TE Policy.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0223624848__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Interface IPv6 addresses on each device</p>
</li><li><p>IS-IS process ID of each device</p>
</li><li><p>IS-IS level of each device</p>
</li><li>Locators of each device</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0223624848__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enable IPv6 forwarding and configure an IP address for each interface.</span><p><p># Configure SFF1. The configurations of other devices are similar to the configuration of SFF1. For configuration details, see <a href="#EN-US_TASK_0223624848__example201171946201118">Configuration Files</a> in this section.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <strong>sysname SFF1</strong>
[*<span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SFF1] <strong>interface gigabitethernet <span>0/1/0</span></strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SFF1-GigabitEthernet<span>0/1/0</span>] <strong>ipv6 enable</strong>
[*SFF1-GigabitEthernet<span>0/1/0</span>] <strong>ipv6 address 2001:db8:1::2 96</strong>
[*SFF1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[*SFF1] <strong>interface gigabitethernet <span>0/2/0</span></strong>
[*SFF1-GigabitEthernet<span>0/2/0</span>] <strong>ipv6 enable</strong>
[*SFF1-GigabitEthernet<span>0/2/0</span>] <strong>ipv6 address 2001:db8:2::1 96</strong>
[*SFF1-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong>
[*SFF1] <strong>interface loopback1</strong>
[*SFF1-LoopBack1] <strong>ipv6 enable</strong>
[*SFF1-LoopBack1] <strong>ipv6 address 2001:db8:22::2 128</strong>
[*SFF1-LoopBack1] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SFF1-LoopBack1] <strong>quit</strong></pre>
</p></li><li><span>Configure IS-IS.</span><p><p># Configure SFF1. The configurations of other devices are similar to the configuration of SFF1. For configuration details, see <a href="#EN-US_TASK_0223624848__example201171946201118">Configuration Files</a> in this section.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>SFF1] <strong>isis 1</strong>
[*SFF1-isis-1] <strong>is-level level-1</strong>
[*SFF1-isis-1] <strong>cost-style wide</strong>
[*SFF1-isis-1] <strong>network-entity 10.0000.0000.0002.00</strong>
[*SFF1-isis-1] <strong>ipv6 enable topology ipv6</strong>
[*SFF1-isis-1] <strong>quit</strong>
[*SFF1] <strong>interface gigabitethernet <span>0/1/0</span></strong>
[*SFF1-GigabitEthernet<span>0/1/0</span>] <strong>isis ipv6 enable 1</strong>
[*SFF1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[*SFF1] <strong>interface gigabitethernet <span>0/2/0</span></strong>
[*SFF1-GigabitEthernet<span>0/2/0</span>] <strong>isis ipv6 enable 1</strong>
[*SFF1-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong>
[*SFF1] <strong>interface loopback1</strong>
[*SFF1-LoopBack1] <strong>isis ipv6 enable 1</strong>
[*SFF1-LoopBack1] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SFF1-LoopBack1] <strong>quit</strong></pre>
</p></li><li><span>Configure SRv6 SIDs and enable IS-IS SRv6.</span><p><p># Configure the SC.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>SC] <strong>segment-routing ipv6</strong>
[*SC-segment-routing-ipv6] <strong>encapsulation source-address 2001:db8:10::1</strong>
[*SC-segment-routing-ipv6] <strong>locator as1 ipv6-prefix 2001:db8:11:: 64 static 32</strong>
[*SC-segment-routing-ipv6-locator] <strong>opcode ::1 end</strong><span> <strong>psp</strong></span>
[*SC-segment-routing-ipv6-locator] <strong>quit</strong>
[*SC-segment-routing-ipv6] <strong>quit</strong>
[*SC] <strong>isis 1</strong>
[*SC-isis-1] <strong>segment-routing ipv6 locator as1</strong><strong> auto-sid-disable</strong>
[*SC-isis-1] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SC-isis-1] <strong>quit</strong></pre>
<p># Configure SFF1.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>SFF1] <strong>segment-routing ipv6</strong>
[*SFF1-segment-routing-ipv6] <strong>encapsulation source-address 2001:db8:22::2</strong>
[*SFF1-segment-routing-ipv6] <strong>locator as1 ipv6-prefix 2001:db8:12:: 64 static 32</strong>
[*SFF1-segment-routing-ipv6-locator] <strong>opcode ::1 end</strong><span> <strong>psp</strong></span>
[*SFF1-segment-routing-ipv6-locator] <strong>quit</strong>
[*SFF1-segment-routing-ipv6] <strong>quit</strong>
[*SFF1] <strong>isis 1</strong>
[*SFF1-isis-1] <strong>segment-routing ipv6 locator as1 auto-sid-disable</strong>
[*SFF1-isis-1] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SFF1-isis-1] <strong>quit</strong></pre>
<p># Configure SFF2.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>SFF2] <strong>segment-routing ipv6</strong>
[*SFF2-segment-routing-ipv6] <strong>encapsulation source-address 2001:db8:33::3</strong>
[*SFF2-segment-routing-ipv6] <strong>locator as1 ipv6-prefix 2001:db8:13:: 64 static 32</strong>
[*SFF2-segment-routing-ipv6-locator] <strong>opcode ::1 end</strong><span> <strong>psp</strong></span>
[*SFF2-segment-routing-ipv6-locator] <strong>quit</strong>
[*SFF2-segment-routing-ipv6] <strong>quit</strong>
[*SFF2] <strong>isis 1</strong>
[*SFF2-isis-1] <strong>segment-routing ipv6 locator as1</strong><strong> auto-sid-disable</strong>
[*SFF2-isis-1] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SFF2-isis-1] <strong>quit</strong></pre>
<p># Configure the tail end.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>Tail] <strong>ip vpn-instance vpna</strong>
[*Tail-vpn-instance-vpna] <strong>ipv4-family</strong>
[*Tail-vpn-instance-vpna-af-ipv4] <strong>route-distinguisher 500:1</strong>
[*Tail-vpn-instance-vpna-af-ipv4] <strong>vpn-target 111:1 both</strong>
[*Tail-vpn-instance-vpna-af-ipv4] <strong>quit</strong>
[*Tail-vpn-instance-vpna] <strong>quit</strong>
[*Tail] <strong>segment-routing ipv6</strong>
[*Tail-segment-routing-ipv6] <strong>encapsulation source-address 2001:db8:55::5</strong>
[*Tail-segment-routing-ipv6] <strong>locator as1 ipv6-prefix 2001:db8:15:: 64 static 32</strong>
[*Tail-segment-routing-ipv6-locator] <strong>opcode ::1 end</strong><span> <strong>psp</strong></span>
[*Tail-segment-routing-ipv6-locator] <strong>opcode ::100 end-dt4 vpn-instance vpna</strong>
[*Tail-segment-routing-ipv6-locator] <strong>quit</strong>
[*Tail-segment-routing-ipv6] <strong>quit</strong>
[*Tail] <strong>isis 1</strong>
[*Tail-isis-1] <strong>segment-routing ipv6 locator as1</strong><strong> auto-sid-disable</strong>
[*Tail-isis-1] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>Tail-isis-1] <strong>quit</strong></pre>
<p>After the configuration is complete, run the <a href="cmdqueryname=display+segment-routing+ipv6+locator"><b><span class="cmdname">display segment-routing ipv6 locator</span></b></a> [ <i><span class="varname">locator-name</span></i> ] <strong><span>verbose</span></strong> command to check SRv6 locator information.</p>
</p></li><li><span>Configure SF access on SFFs.</span><p><p># Configure SFF1.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>SFF1] <strong>interface gigabitethernet <span>0/3/0</span>.1 mode l2</strong>
[*SFF1-GigabitEthernet<span>0/3/0</span>.1] <strong>encapsulation dot1q vid 1</strong>
[*SFF1-GigabitEthernet<span>0/3/0</span>.1] <strong>quit</strong>
[*SFF1] <strong>commit</strong></pre>
</p><p><p># Configure SFF2.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>SFF2] <strong>interface gigabitethernet <span>0/3/0</span>.1 mode l2</strong>
[*SFF2-GigabitEthernet<span>0/3/0</span>.1] <strong>encapsulation dot1q vid 1</strong>
[*SFF2-GigabitEthernet<span>0/3/0</span>.1] <strong>quit</strong>
[*SFF2] <strong>commit</strong></pre>
</p></li><li><span>Configure basic SFC functions on SFFs.</span><p><p># Configure SFF1.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>SFF1] <strong>segment-routing ipv6</strong>
[*SFF1-segment-routing-ipv6] <strong>locator as1</strong>
[*SFF1-segment-routing-ipv6-locator] <strong>opcode ::100 end</strong><strong>-a</strong><strong>s</strong>
[*SFF1-segment-routing-ipv6-locator-endas-::100] <strong>inner-type ipv4</strong>
[*SFF1-segment-routing-ipv6-locator-endas-::100] <strong>encapsulation eth out-interface gigabitethernet <span>0/3/0</span>.1 </strong><strong>out-vlan</strong><strong> 1</strong> <strong>in-interface gigabitethernet <span>0/3/0</span>.1</strong> <strong>in-vlan</strong><strong> 1</strong>
[*SFF1-segment-routing-ipv6-locator-endas-::100] <strong>cache source-address 2001:db8:10::1</strong>
[*SFF1-segment-routing-ipv6-locator-endas-::100] <strong>cache list</strong><strong> </strong><strong>2001:db8:15::100 </strong><strong>2001:db8:15::1</strong><strong> 2001:db8:13::100</strong><strong> 2001:db8:12::100</strong>
[*SFF1-segment-routing-ipv6-locator-endas-::100] <strong>quit</strong>
[*SFF1-segment-routing-ipv6-locator] <strong>quit</strong>
[*SFF1-segment-routing-ipv6] <strong>quit</strong>
[*SFF1] <strong>commit</strong></pre>
</p><p><p># Configure SFF2.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>SFF2] <strong>segment-routing ipv6</strong>
[*SFF2-segment-routing-ipv6] <strong>locator as1</strong>
[*SFF2-segment-routing-ipv6-locator] <strong>opcode ::100 end</strong><strong>-a</strong><strong>s</strong>
[*SFF2-segment-routing-ipv6-locator-endas-::100] <strong>inner-type ipv4</strong>
[*SFF2-segment-routing-ipv6-locator-endas-::100] <strong>encapsulation eth out-interface gigabitethernet <span>0/3/0</span>.1 </strong><strong>out-vlan</strong><strong> 1</strong> <strong>in-interface gigabitethernet <span>0/3/0</span>.1</strong> <strong>in-vlan</strong><strong> 1</strong>
[*SFF2-segment-routing-ipv6-locator-endas-::100] <strong>cache source-address 2001:db8:10::1</strong>
[*SFF2-segment-routing-ipv6-locator-endas-::100] <strong>cache list </strong><strong>2001:db8:15::100 </strong><strong>2001:db8:15::1 2001:db8:13::100</strong><strong> 2001:db8:12::100</strong>
[*SFF2-segment-routing-ipv6-locator-endas-::100] <strong>quit</strong>
[*SFF2-segment-routing-ipv6-locator] <strong>quit</strong>
[*SFF2-segment-routing-ipv6] <strong>quit</strong>
[*SFF2] <strong>commit</strong></pre>
</p></li><li><span>Configure an SRv6 TE Policy on the SC.</span><p><p># Configure the SC.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>SC] <strong>segment-routing ipv6</strong> 
[<font style="font-size:8pt" Face="Courier New" >~</font>SC-segment-routing-ipv6] <strong>segment-list list1</strong> 
[*SC-segment-routing-ipv6-segment-list-list1] <strong>index 5 sid ipv6 </strong><strong>2001:db8:12::100</strong>
[*SC-segment-routing-ipv6-segment-list-list1] <strong>index 10 sid ipv6 </strong><strong>2001:db8:13::100</strong>
[*SC-segment-routing-ipv6-segment-list-list1] <strong>index 15 sid ipv6 </strong><strong>2001:db8:15::1</strong>
[*SC-segment-routing-ipv6-segment-list-list1] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SC-segment-routing-ipv6-segment-list-list1] <strong>quit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SC-segment-routing-ipv6] <strong>srv6-te-policy locator as1</strong> 
[*SC-segment-routing-ipv6] <strong>srv6-te policy policy1 endpoint </strong><strong>2001:db8:55::5</strong><strong> color 101</strong>
[*SC-segment-routing-ipv6-policy-policy1] <strong>binding-sid </strong><strong>2001:db8:11::11</strong>
[*SC-segment-routing-ipv6-policy-policy1] <strong>candidate-path preference 100</strong>
[*SC-segment-routing-ipv6-policy-policy1-path] <strong>segment-list list1</strong> 
[*SC-segment-routing-ipv6-policy-policy1-path] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SC-segment-routing-ipv6-policy-policy1-path] <strong>quit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SC-segment-routing-ipv6-policy-policy1] <strong>quit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SC-segment-routing-ipv6] <strong>quit</strong></pre>
</p><p><p>After the configuration is complete, run the <a href="cmdqueryname=display+srv6-te+policy"><b><span class="cmdname">display srv6-te policy</span></b></a> command to check SRv6 TE Policy information.</p>
</p></li><li><span>Configure a traffic policy on the SC to redirect traffic to the SRv6 TE Policy.</span><p><p># Configure the SC.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>SC] <strong>traffic classifier c1</strong>
[*SC-classifier-c1] <strong>if-match any</strong>
[*SC-classifier-c1] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SC-classifier-c1] <strong>quit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SC] <strong>traffic behavior b1</strong>
[*SC-behavior-b1]<strong> redirect srv6-te policy 2001:db8:55::5 101 vpnsid 2001:db8:15::100</strong>
[*SC-behavior-b1] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SC-behavior-b1] <strong>quit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SC] <strong>traffic policy p1</strong>
[*SC-trafficpolicy-p1] <strong>classifier c1 behavior b1</strong>
[*SC-trafficpolicy-p1] <strong>statistic enable</strong>
[*SC-trafficpolicy-p1] <strong>commi</strong><strong>t</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SC-trafficpolicy-p1] <strong>quit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SC] <strong>bridge-domain 1</strong>
[*SC-bd1] <strong>quit</strong>
[*SC] <strong>interface gigabitethernet <span>0/1/0</span>.1 mode l2</strong>
[*SC-GigabitEthernet<span>0/1/0</span>.1] <strong>encapsulation dot1q vid 1</strong>
[*SC-GigabitEthernet<span>0/1/0</span>.1] <strong>rewrite pop single</strong>
[*SC-GigabitEthernet<span>0/1/0</span>.1] <strong>bridge-domain 1</strong>
[*SC-GigabitEthernet<span>0/1/0</span>.1] <strong>quit</strong>
[*SC] <strong>interface Vbdif1</strong>
[*SC-Vbdif1] <strong>ip binding vpn-instance vpna</strong>
[*SC-Vbdif1] <strong>ip address 10.0.0.1 30</strong>
[*SC-Vbdif1] <strong>traffic-policy p1 inbound</strong>
[*SC-Vbdif1] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>SC-Vbdif1] <strong>quit</strong></pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0223624848__example201171946201118"><a name="EN-US_TASK_0223624848__example201171946201118"></a><a name="example201171946201118"></a><a name="EN-US_TASK_0223624848__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>SC configuration file</p>
<pre class="screen">#
sysname SC
#
ip vpn-instance vpna
 ipv4-family
  route-distinguisher 100:1
  apply-label per-instance
  vpn-target 111:1 export-extcommunity
  vpn-target 111:1 import-extcommunity
#                
segment-routing ipv6
 encapsulation source-address 2001:db8:10::1
 locator as1 ipv6-prefix 2001:db8:11:: 64 static 32 
  opcode ::1 end<span> psp</span>
 srv6-te-policy locator as1
 segment-list list1
  index 5 sid ipv6 2001:db8:12::100
  index 10 sid ipv6 2001:db8:13::100
  index 15 sid ipv6 2001:db8:15::1
 srv6-te policy policy1 endpoint 2001:db8:55::5 color 101
  binding-sid 2001:db8:11::11
  candidate-path preference 100
   segment-list list1
#               
isis 1          
 is-level level-1
 cost-style wide
 network-entity 10.0000.0000.0001.00
 #              
 ipv6 enable topology ipv6
 segment-routing ipv6 locator as1 auto-sid-disable
 #              
# 
bridge-domain 1
#
traffic classifier c1
 if-match any
#
traffic behavior b1
  redirect srv6-te policy 2001:db8:55::5 101 vpnsid 2001:db8:15::100
#
traffic policy p1
 classifier c1 behavior b1
 statistic enable
#
interface Vbdif1
 ip binding vpn-instance vpna
 ip address 10.0.0.1 255.255.255.252
 traffic-policy p1 inbound
#               
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
#
interface GigabitEthernet<span>0/1/0</span>.1 mode l2
 encapsulation dot1q vid 1
 rewrite pop single
 bridge-domain 1
#               
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown  
 ipv6 enable    
 ipv6 address 2001:db8:1::1/96
 isis ipv6 enable 1
#               
interface LoopBack1
 ipv6 enable    
 ipv6 address 2001:db8:10::1/128
 isis ipv6 enable 1
#                             
return</pre>
</li><li><p>SFF1 configuration file</p>
<pre class="screen">#
sysname SFF1
#               
segment-routing ipv6
 encapsulation source-address 2001:db8:22::2
 locator as1 ipv6-prefix 2001:db8:12:: 64 static 32
  opcode ::1 end<span> psp</span>
  opcode ::100 end-as
   inner-type ipv4
   encapsulation eth out-interface GigabitEthernet<span>0/3/0</span>.1 out-vlan 1 in-interface GigabitEthernet<span>0/3/0</span>.1 in-vlan 1
   cache source-address 2001:db8:10::1
   cache list 2001:db8:15::100 2001:db8:15::1 2001:db8:13::100 2001:db8:12::100
#               
isis 1          
 is-level level-1
 cost-style wide
 network-entity 10.0000.0000.0002.00
 #              
 ipv6 enable topology ipv6
 segment-routing ipv6 locator as1 auto-sid-disable
 #
#               
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ipv6 enable    
 ipv6 address 2001:db8:1::2/96
 isis ipv6 enable 1
#               
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown  
 ipv6 enable    
 ipv6 address 2001:db8:2::1/96
 isis ipv6 enable 1
#               
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown  
#
interface GigabitEthernet<span>0/3/0</span>.1 mode l2
 encapsulation dot1q vid 1
#               
interface LoopBack1
 ipv6 enable    
 ipv6 address 2001:db8:22::2/128
 isis ipv6 enable 1
#               
return </pre>
</li><li><p>SFF2 configuration file</p>
<pre class="screen">#
sysname SFF2
#               
segment-routing ipv6
 encapsulation source-address 2001:db8:33::3
 locator as1 ipv6-prefix 2001:db8:13:: 64 static 32
  opcode ::1 end<span> psp</span>
  opcode ::100 end-as
   inner-type ipv4
   encapsulation eth out-interface GigabitEthernet<span>0/3/0</span>.1 out-vlan 1 in-interface GigabitEthernet<span>0/3/0</span>.1 in-vlan 1
   cache source-address 2001:db8:10::1
   cache list 2001:db8:15::100 2001:db8:15::1 2001:db8:13::100 2001:db8:12::100
#               
isis 1          
 is-level level-1
 cost-style wide
 network-entity 10.0000.0000.0003.00
 #              
 ipv6 enable topology ipv6
 segment-routing ipv6 locator as1 auto-sid-disable
 #              
#               
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ipv6 enable    
 ipv6 address 2001:db8:2::2/96
 isis ipv6 enable 1
#               
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown  
 ipv6 enable    
 ipv6 address 2001:db8:3::1/96
 isis ipv6 enable 1
#               
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown  
#
interface GigabitEthernet<span>0/3/0</span>.1 mode l2
 encapsulation dot1q vid 1
#               
interface LoopBack1
 ipv6 enable    
 ipv6 address 2001:db8:33::3/128
 isis ipv6 enable 1
#               
return </pre>
</li><li><p>Tail end configuration file</p>
<pre class="screen">#
sysname Tail End
#
ip vpn-instance vpna
 ipv4-family
  route-distinguisher 500:1
  apply-label per-instance
  vpn-target 111:1 export-extcommunity
  vpn-target 111:1 import-extcommunity
#               
segment-routing ipv6
 encapsulation source-address 2001:db8:55::5
 locator as1 ipv6-prefix 2001:db8:15:: 64 static 32
  opcode ::1 end<span> psp</span>
  opcode ::100 end-dt4 vpn-instance vpna
#               
isis 1          
 is-level level-1
 cost-style wide
 network-entity 10.0000.0000.0004.00
 #              
 ipv6 enable topology ipv6
 segment-routing ipv6 locator as1 auto-sid-disable
 #              
#               
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ipv6 enable    
 ipv6 address 2001:db8:3::2/96
 isis ipv6 enable 1
#               
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown  
 ip binding vpn-instance vpna    
 ip address 10.5.1.2 255.255.255.252
#               
interface LoopBack1
 ipv6 enable    
 ipv6 address 2001:db8:55::5/128
 isis ipv6 enable 1
#               
return </pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0101.html">Configuration Examples for SRv6 TE Policy (IS-IS)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0224.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0230.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>

<script language="JavaScript">
<!--
image_size('.imgResize');
var msg_imageMax = "view original image";
var msg_imageClose = "close";
//--></script></body>
</html>