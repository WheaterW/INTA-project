
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring SBFD for SR-MPLS TE LSP">
<meta name="abstract" content="This section describes how to configure SBFD to detect SR-MPLS TE LSP faults.">
<meta name="description" content="This section describes how to configure SBFD to detect SR-MPLS TE LSP faults.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0145.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0051.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="segment_routing_vrp,w00604599,l00455378,l00587852,w00606909,w00800033">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00468467">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00468467">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0161511728">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring SBFD for SR-MPLS TE LSP</title>
</head>
<body><a name="EN-US_TASK_0161511728"></a><a name="EN-US_TASK_0161511728"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring SBFD for SR-MPLS TE LSP</h1>
<div class="taskbody"><p>This section describes how to configure SBFD to detect SR-MPLS TE LSP faults.</p>
<div class="context"><a name="EN-US_TASK_0161511728__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>If SBFD for SR-MPLS TE LSP detects a fault on the primary LSP, traffic is rapidly switched to the backup LSP, which minimizes the impact on traffic.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0161511728__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring SBFD for SR-MPLS TE LSP, complete the following task:</p>
<ul><li><p>Configure an SR-MPLS TE tunnel.</p>
</li><li><p>Run the <a href="cmdqueryname=mpls+lsr-id"><b><span class="cmdname">mpls lsr-id</span></b></a> <i><span class="varname">lsr-id</span></i> command to configure an LSR ID and ensure that the route from the peer to the local address specified using <i><span class="varname">lsr-id</span></i> is reachable.</p>
</li></ul>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0161511728__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure an SBFD initiator.</span><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a></span></span><p><p>BFD is enabled globally.</p>
<p>You can set BFD parameters only after running the <a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a> command to enable global BFD.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=sbfd"><b><span class="cmdname">sbfd</span></b></a></span><p><p>SBFD is enabled globally, and the SBFD view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=destination+ipv4"><b><span class="cmdname" id="EN-US_TASK_0161511728__en-us_task_0172368831_cmdname997633621214048">destination ipv4</span></b></a> <i><span class="varname" id="EN-US_TASK_0161511728__en-us_task_0172368831_varname1349269702214048">ip-address</span></i> <a href="cmdqueryname=remote-discriminator"><b><span class="cmdname" id="EN-US_TASK_0161511728__en-us_task_0172368831_cmdname1949284797214048">remote-discriminator</span></b></a> <i><span class="varname" id="EN-US_TASK_0161511728__en-us_task_0172368831_varname186970532214048">discriminator-value</span></i></span><p><p id="EN-US_TASK_0161511728__en-us_task_0172368831_p614020275419">The mapping between the SBFD reflector IP address and discriminator is configured.</p>
</p><p><p id="EN-US_TASK_0161511728__en-us_task_0172368831_p63691039173514">On the device functioning as an SBFD initiator, if the mapping between the SBFD reflector IP address and discriminator is configured using the <a href="cmdqueryname=destination+ipv4+remote-discriminator"><b><span class="cmdname" id="EN-US_TASK_0161511728__en-us_task_0172368831_cmdname96080537358">destination ipv4 remote-discriminator</span></b></a> command, the initiator uses the configured discriminator to negotiate with the reflector in order to establish an SBFD session. If such a mapping is not configured, the SBFD initiator uses the reflector IP address as a discriminator by default to complete the negotiation.</p>
<p id="EN-US_TASK_0161511728__en-us_task_0172368831_p168531811389">This step is optional. If it is performed, the value of <i><span class="varname" id="EN-US_TASK_0161511728__en-us_task_0172368831_varname9928825123820">discriminator-value</span></i> must be the same as that of <i><span class="varname" id="EN-US_TASK_0161511728__en-us_task_0172368831_varname15715493911">unsigned-integer-value</span></i> in the <a href="cmdqueryname=reflector+discriminator"><b><span class="cmdname" id="EN-US_TASK_0161511728__en-us_task_0172368831_cmdname1624275019386">reflector discriminator</span></b></a> command configured on the reflector.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=interface+tunnel"><b><span class="cmdname">interface tunnel</span></b></a> <i><span class="varname">tunnel-number</span></i></span></span><p><p>The SR-MPLS TE tunnel interface view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=mpls+te+bfd+enable"><b><span class="cmdname">mpls te bfd enable</span></b></a> <strong><span>seamless</span></strong></span></span><p><p>SBFD for SR-MPLS TE LSP is enabled.</p>
</p><p><p>After the configuration is complete, the SBFD initiator automatically establishes an SBFD session destined for the destination address of an SR-MPLS TE tunnel.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=mpls+te+reverse-lsp+binding-sid"><b><span class="cmdname">mpls te reverse-lsp binding-sid</span></b></a> <strong><span>label</span></strong> <i><span class="varname">label-value</span></i></span><p><p>A label is configured for the SR-MPLS TE tunnel used for BFD return packets. This label must be the binding SID of the tunnel.</p>
</p><p><p>Before running this command, ensure that the <a href="cmdqueryname=mpls+te+binding-sid+label"><b><span class="cmdname">mpls te binding-sid label</span></b></a><em> label-value</em> command has been run on the ingress of the reverse SR-MPLS TE tunnel.</p>
<p>In SBFD for SR-MPLS TE LSP scenarios, SBFD packets from the initiator to the reflector are forwarded along an SR-MPLS TE LSP, whereas the return packets from the reflector to the initiator are forwarded along a multi-hop IP path. To allow the return packets to be forwarded also along an LSP, run the <a href="cmdqueryname=mpls+te+reverse-lsp+binding-sid"><b><span class="cmdname">mpls te reverse-lsp binding-sid</span></b></a> command.</p>
<p>Both the forward and reverse SR-MPLS TE tunnels may have a primary LSP and a backup LSP. After the <a href="cmdqueryname=mpls+te+reverse-lsp+binding-sid"><b><span class="cmdname">mpls te reverse-lsp binding-sid</span></b></a> command is run, the SBFD packet sent by the initiator carries the primary/backup LSP flag. If the SBFD packet sent by the initiator is forwarded through the primary LSP of the forward tunnel, the SBFD return packet sent by the reflector is forwarded through the primary LSP of the reverse tunnel. If the SBFD packet sent by the initiator is forwarded through the backup LSP of the forward tunnel, the SBFD return packet sent by the reflector is forwarded through the backup LSP of the reverse tunnel.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure the SBFD reflector.</span><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a></span></span><p><p>BFD is enabled globally.</p>
<p>You can set BFD parameters only after running the <a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a> command to enable global BFD.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=sbfd"><b><span class="cmdname">sbfd</span></b></a></span><p><p>SBFD is enabled globally, and the SBFD view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=reflector+discriminator"><b><span class="cmdname">reflector discriminator</span></b></a> { <i><span class="varname">unsigned-integer-value</span></i> | <i><span class="varname">ip-address-value</span></i> }</span></span><p><p>The discriminator of an SBFD reflector is configured.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
<div class="postreq"><a name="EN-US_TASK_0161511728__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After you configure SBFD for SR-MPLS TE LSP, run the <a href="cmdqueryname=display+bfd+session"><b><span class="cmdname">display bfd session</span></b></a> { <strong><span>all</span></strong> | <strong><span>discriminator</span></strong> <i><span class="varname">discr-value</span></i> } [ <strong><span>verbose</span></strong> ] command to check information about the SBFD session that monitors an SR-MPLS TE tunnel.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0000.html">Segment Routing MPLS Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0145.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0051.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>