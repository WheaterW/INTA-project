
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Association Between ARP and Interface Status">
<meta name="abstract" content="This section describes how to configure association between ARP and interface status.">
<meta name="description" content="This section describes how to configure association between ARP and interface status.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_arp_cfg_2060.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_arp_cfg_2072.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="y00852169,x00504385">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="ARP">
<meta name="featuretype" content="IP Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ARP">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="ARP">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="ARP">
<meta name="featuretype" content="IP Services">
<meta name="OWNER" content="y00852169">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="x00504385">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172364529">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Association Between ARP and Interface Status</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172364529"></a><a name="EN-US_TASK_0172364529"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Association Between ARP and Interface Status</h1>
<div class="taskbody"><p>This section describes how to configure association between ARP and interface status.</p>
<div class="context"><a name="EN-US_TASK_0172364529__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0172364529__fig_dc_vrp_cfg_00214301">Figure 1</a>, DeviceA and DeviceB are connected over a switch. If the link between DeviceA and the switch works properly, the link between DeviceB and the switch becomes faulty. If both the physical status and protocol status of interface 1 on DeviceA are up, DeviceA does not get aware of the link fault between DeviceB and the switch. Instead, DeviceA still sends packets to DeviceB over the switch. The packets, however, are discarded by the switch. Then, association between ARP and interface status is enabled on DeviceA to detect the status of interface 1 on DeviceB. In this manner, DeviceA rapidly adjusts the status of interface 1 based on the status of the link between DeviceB and the switch.</p>
<div class="fignone" id="EN-US_TASK_0172364529__fig_dc_vrp_cfg_00214301"><a name="EN-US_TASK_0172364529__fig_dc_vrp_cfg_00214301"></a><a name="fig_dc_vrp_cfg_00214301"></a><span class="figcap"><b>Figure 1 </b>Configuring association between ARP and interface status</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interface 1 in this example represents <span>GigabitEthernet</span> <span>0/1/1</span>.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_arp_cfg_203604.png"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172364529__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure an IP address for the interface.</p>
</li><li><p>Enable association between ARP and interface status.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172364529__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Interface IP addresses</p>
</li><li><p>Destination IP address of the ARP probe messages sent by the interface</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172364529__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure an IP address for the interface.</span><p><p># Configure DeviceA.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>]<strong> sysname DeviceA</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> interface <span>gigabitethernet</span> <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>GigabitEthernet</span><span>0/1/1</span>]<strong> ip address 10.1.1.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA-<span>GigabitEthernet</span><span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA-<span>GigabitEthernet</span><span>0/1/1</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>GigabitEthernet</span><span>0/1/1</span>]<strong> quit</strong></pre>
<p># Configure DeviceB.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>]<strong> sysname DeviceB</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong> interface <span>gigabitethernet</span> <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>GigabitEthernet</span><span>0/1/1</span>]<strong> ip address 10.1.1.2 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceB-<span>GigabitEthernet</span><span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceB-<span>GigabitEthernet</span><span>0/1/1</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>GigabitEthernet</span><span>0/1/1</span>]<strong> quit</strong></pre>
<p># Run the <strong>ping</strong> command on DeviceA and ensure that <span>GigabitEthernet</span> <span>0/1/1</span> on DeviceB is reachable.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> ping 10.1.1.2</strong></pre>
<pre class="screen">  PING 10.1.1.2: 56  data bytes, press CTRL_C to break
    Reply from 10.1.1.2: bytes=56 Sequence=1 ttl=255 time=62 ms
    Reply from 10.1.1.2: bytes=56 Sequence=2 ttl=255 time=1 ms
    Reply from 10.1.1.2: bytes=56 Sequence=3 ttl=255 time=1 ms
    Reply from 10.1.1.2: bytes=56 Sequence=4 ttl=255 time=2 ms
    Reply from 10.1.1.2: bytes=56 Sequence=5 ttl=255 time=2 ms

  --- 10.1.1.2 ping statistics ---
    5 packet(s) transmitted
    5 packet(s) received
    0.00% packet loss
    round-trip min/avg/max = 1/13/62 ms</pre>
<p># Run the <strong>display interface</strong> command on both DeviceA and DeviceB to view the status of <span>GigabitEthernet</span> <span>0/1/1</span> and check that both the physical status and protocol status of the interface are Up.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display interface <span>gigabitethernet</span> <span>0/1/1</span></strong></pre>
<pre class="screen"><strong><span>GigabitEthernet</span><span>0/1/1</span> current state : UP (ifindex: 9)
Line protocol current state : UP </strong>
Last line protocol up time : 2018-01-24 11:03:06
Link quality grade : GOOD
Description: 
Route Port,The Maximum Transmit Unit is 1500 
Internet Address is 10.1.1.1/24
IP Sending Frames' Format is PKTFMT_ETHNT_2, Hardware address is 00e0-fc21-0302
Loopback:none, LAN full-duplex mode, Pause Flowcontrol: Receive Enable and Send Enable
Last physical up time   : 2018-01-24 09:00:21
Last physical down time : 2018-01-24 08:58:14
Current system time: 2018-01-24 11:22:58
Statistics last cleared:never
    Last 300 seconds input rate: 0 bits/sec, 0 packets/sec
    Last 300 seconds output rate: 0 bits/sec, 0 packets/sec
    Input peak rate 0 bits/sec, Record time: -
    Output peak rate 0 bits/sec, Record time: -
    Input: 0 bytes, 1254 packets
    Output: 0 bytes, 1261 packets
    Input: 
      Unicast: 10 packets, Multicast: 46 packets
      Broadcast: 1198 packets, JumboOctets: 0 packets
      CRC: 0 packets, Symbol: 0 packets
      Overrun: 0 packets, InRangeLength: 0 packets
      LongPacket: 0 packets, Jabber: 0 packets, Alignment: 0 packets
      Fragment: 0 packets, Undersized Frame: 0 packets
      RxPause: 0 packets
    Output:
      Unicast: 11 packets, Multicast: 46 packets
      Broadcast: 1204 packets, JumboOctets: 0 packets
      Lost: 0 packets, Overflow: 0 packets, Underrun: 0 packets
      System: 0 packets, Overruns: 0 packets
      TxPause: 0 packets
    Last 300 seconds input utility rate:  0.00%
    Last 300 seconds output utility rate: 0.00%</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display interface <span>gigabitethernet</span> <span>0/1/1</span></strong></pre>
<pre class="screen"><strong><span>GigabitEthernet</span><span>0/1/1</span> current state : UP (ifindex: 9)
Line protocol current state : UP </strong>
Last line protocol up time : 2018-01-24 11:03:28
Link quality grade : GOOD
Description: 
Route Port,The Maximum Transmit Unit is 1500 
Internet Address is 10.1.1.2/24
IP Sending Frames' Format is PKTFMT_ETHNT_2, Hardware address is 00e0-fc41-0302
Loopback:none, LAN full-duplex mode, Pause Flowcontrol: Receive Enable and Send Enable
Last physical up time   : 2018-01-24 09:00:22
Last physical down time : 2018-01-24 09:00:21
Current system time: 2018-01-24 11:23:25
Statistics last cleared:never
    Last 300 seconds input rate: 0 bits/sec, 0 packets/sec
    Last 300 seconds output rate: 0 bits/sec, 0 packets/sec
    Input peak rate 0 bits/sec, Record time: -
    Output peak rate 0 bits/sec, Record time: -
    Input: 0 bytes, 1262 packets
    Output: 0 bytes, 1255 packets
    Input: 
      Unicast: 11 packets, Multicast: 47 packets
      Broadcast: 1204 packets, JumboOctets: 0 packets
      CRC: 0 packets, Symbol: 0 packets
      Overrun: 0 packets, InRangeLength: 0 packets
      LongPacket: 0 packets, Jabber: 0 packets, Alignment: 0 packets
      Fragment: 0 packets, Undersized Frame: 0 packets
      RxPause: 0 packets
    Output:
      Unicast: 10 packets, Multicast: 47 packets
      Broadcast: 1198 packets, JumboOctets: 0 packets
      Lost: 0 packets, Overflow: 0 packets, Underrun: 0 packets
      System: 0 packets, Overruns: 0 packets
      TxPause: 0 packets
    Last 300 seconds input utility rate:  0.00%
    Last 300 seconds output utility rate: 0.00%</pre>
</p></li><li><span>Simulate an interface fault.</span><p><p># Run the <strong>shutdown</strong> command on <span>GigabitEthernet</span> <span>0/1/1</span> of DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>interface <span>gigabitethernet</span> <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>GigabitEthernet</span><span>0/1/1</span>] <strong>shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceB-<span>GigabitEthernet</span><span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>GigabitEthernet</span><span>0/1/1</span>] <strong>quit</strong></pre>
<p># Run the <strong>display interface</strong> command on DeviceA to view the status of <span>GigabitEthernet</span> <span>0/1/1</span> and check that both the physical status and protocol status of the interface are Up.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display interface <span>gigabitethernet</span> <span>0/1/1</span></strong></pre>
<pre class="screen"><strong><span>GigabitEthernet</span><span>0/1/1</span> current state : UP (ifindex: 9)
Line protocol current state : UP </strong>
Last line protocol up time : 2018-01-24 11:03:06
Link quality grade : GOOD
Description: 
Route Port,The Maximum Transmit Unit is 1500 
Internet Address is 10.1.1.1/24
IP Sending Frames' Format is PKTFMT_ETHNT_2, Hardware address is 00e0-fc21-0302
Loopback:none, LAN full-duplex mode, Pause Flowcontrol: Receive Enable and Send Enable
Last physical up time   : 2018-01-24 09:00:21
Last physical down time : 2018-01-24 08:58:14
Current system time: 2018-01-24 11:25:18
Statistics last cleared:never
    Last 300 seconds input rate: 0 bits/sec, 0 packets/sec
    Last 300 seconds output rate: 0 bits/sec, 0 packets/sec
    Input peak rate 0 bits/sec, Record time: -
    Output peak rate 0 bits/sec, Record time: -
    Input: 0 bytes, 1254 packets
    Output: 0 bytes, 1261 packets
    Input: 
      Unicast: 10 packets, Multicast: 46 packets
      Broadcast: 1198 packets, JumboOctets: 0 packets
      CRC: 0 packets, Symbol: 0 packets
      Overrun: 0 packets, InRangeLength: 0 packets
      LongPacket: 0 packets, Jabber: 0 packets, Alignment: 0 packets
      Fragment: 0 packets, Undersized Frame: 0 packets
      RxPause: 0 packets
    Output:
      Unicast: 11 packets, Multicast: 46 packets
      Broadcast: 1204 packets, JumboOctets: 0 packets
      Lost: 0 packets, Overflow: 0 packets, Underrun: 0 packets
      System: 0 packets, Overruns: 0 packets
      TxPause: 0 packets
    Last 300 seconds input utility rate:  0.00%
    Last 300 seconds output utility rate: 0.00%</pre>
<p># Run the <strong>ping</strong> command on DeviceA and ensure that <span>GigabitEthernet</span> <span>0/1/1</span> on DeviceB is reachable.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> ping 10.1.1.2</strong></pre>
<pre class="screen">  PING 10.1.1.2: 56  data bytes, press CTRL_C to break
    Request time out
    Request time out
    Request time out
    Request time out
    Request time out

  --- 10.1.1.2 ping statistics ---
    5 packet(s) transmitted
    0 packet(s) received
    100.00% packet loss</pre>
</p></li><li><span>Enable association between ARP and interface status on DeviceA.</span><p><p># Enable the interface on DeviceA to send ARP probe messages.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface <span>gigabitethernet</span> <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>GigabitEthernet</span><span>0/1/1</span>] <strong>arp status-detect 10.1.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA-<span>GigabitEthernet</span><span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>GigabitEthernet</span><span>0/1/1</span>] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># After the detection period elapses, the physical status of <span>GigabitEthernet</span> <span>0/1/1</span> of DeviceA becomes Up and the protocol status becomes Down.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display interface <span>gigabitethernet</span> <span>0/1/1</span></strong></pre>
<pre class="screen"><strong><span>GigabitEthernet</span><span>0/1/1</span> current state : UP (ifindex: 9)
Line protocol current state : DOWN </strong>
Link quality grade : GOOD
Description: 
Route Port,The Maximum Transmit Unit is 1500 
Internet Address is 10.1.1.1/24
IP Sending Frames' Format is PKTFMT_ETHNT_2, Hardware address is 00e0-fc21-0302
Loopback:none, LAN full-duplex mode, Pause Flowcontrol: Receive Enable and Send Enable
Last physical up time   : 2018-01-24 12:03:24
Last physical down time : 2018-01-24 11:40:45
Current system time: 2018-01-24 12:06:25
Statistics last cleared:never
    Last 300 seconds input rate: 0 bits/sec, 0 packets/sec
    Last 300 seconds output rate: 0 bits/sec, 0 packets/sec
    Input peak rate 0 bits/sec, Record time: -
    Output peak rate 0 bits/sec, Record time: -
    Input: 0 bytes, 1354 packets
    Output: 0 bytes, 1370 packets
    Input: 
      Unicast: 64 packets, Multicast: 91 packets
      Broadcast: 1199 packets, JumboOctets: 0 packets
      CRC: 0 packets, Symbol: 0 packets
      Overrun: 0 packets, InRangeLength: 0 packets
      LongPacket: 0 packets, Jabber: 0 packets, Alignment: 0 packets
      Fragment: 0 packets, Undersized Frame: 0 packets
      RxPause: 0 packets
    Output:
      Unicast: 12 packets, Multicast: 90 packets
      Broadcast: 1268 packets, JumboOctets: 0 packets
      Lost: 0 packets, Overflow: 0 packets, Underrun: 0 packets
      System: 0 packets, Overruns: 0 packets
      TxPause: 0 packets
    Last 300 seconds input utility rate:  0.00%
    Last 300 seconds output utility rate: 0.00%</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172364529__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>DeviceA configuration file</p>
<pre class="screen">#
sysname DeviceA
#
interface <span>GigabitEthernet</span><span>0/1/1</span>
<span> undo shutdown  </span>
 ip address 10.1.1.1 255.255.255.0
 arp status-detect 10.1.1.2
#
return</pre>
</li><li><p>DeviceB configuration file</p>
<pre class="screen">#
sysname DeviceB
#
interface <span>GigabitEthernet</span><span>0/1/1</span>
<span> undo shutdown  </span>
 ip address 10.1.1.2 255.255.255.0
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_arp_cfg_2060.html">Configuration Examples for ARP
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_arp_cfg_2072.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>