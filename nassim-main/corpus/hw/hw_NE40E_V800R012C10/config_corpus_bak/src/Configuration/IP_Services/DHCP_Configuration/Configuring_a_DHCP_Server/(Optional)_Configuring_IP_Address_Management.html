
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring IP Address Management">
<meta name="abstract" content="IP address management includes backing up and restoring data in an address pool, configuring alarm thresholds, and reclaiming IP addresses.">
<meta name="description" content="IP address management includes backing up and restoring data in an address pool, configuring alarm thresholds, and reclaiming IP addresses.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcp_server_cfg_0011.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcp_server_cfg_0012.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcp_server_cfg_0014.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,z00485179,w00556928,w00606909,dhcpvrp">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="DHCP">
<meta name="featuretype" content="IP Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="DHCP">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="DHCP">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="DHCP">
<meta name="featuretype" content="IP Services">
<meta name="OWNER" content="z00485179,x00504385">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="x00504385">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172364702">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring IP Address Management</title>
</head>
<body><a name="EN-US_TASK_0172364702"></a><a name="EN-US_TASK_0172364702"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring IP Address Management</h1>
<div class="taskbody"><p>IP address management includes backing up and restoring data in an address pool, configuring alarm thresholds, and reclaiming IP addresses.</p>
<div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0172364702__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p id="EN-US_TASK_0172364702__en-us_task_0172364701_p901528154918">DHCP server packet receiving has been enabled using the <a href="cmdqueryname=dhcp+server+enable"><b><span class="cmdname" id="EN-US_TASK_0172364702__en-us_task_0172364701_cmdname1191514464617">dhcp server enable</span></b></a> command on an interface if the interface needs to be used as a DHCP server.</p>
<div class="note" id="EN-US_TASK_0172364702__en-us_task_0172364701_note927783814490"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul id="EN-US_TASK_0172364702__en-us_task_0172364701_ul148851851145912"><li id="EN-US_TASK_0172364702__en-us_task_0172364701_li13885125117590">If multiple interfaces need to be used as DHCP servers, for security purposes, you are advised to preferentially run the <a href="cmdqueryname=dhcp+server+enable"><b><span class="cmdname" id="EN-US_TASK_0172364702__en-us_task_0172364701_cmdname198051032104718">dhcp server enable</span></b></a> command on the interfaces to enable DHCP server packet receiving. If high security is not required, you run the <a href="cmdqueryname=dhcp+server+request-packet+all-interface+enable"><b><span class="cmdname" id="EN-US_TASK_0172364702__en-us_task_0172364701_cmdname1111113865112">dhcp server request-packet all-interface enable</span></b></a> command in the system view to enable DHCP server packet receiving for all interfaces.</li><li id="EN-US_TASK_0172364702__en-us_task_0172364701_li4657653185916">If DHCP server packet receiving is not enabled, a DHCP server does not process DHCP request messages.</li></ul>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172364702__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Configure DHCP data saving and restoration.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=dhcp+server+database"><b><span class="cmdname">dhcp server database</span></b></a> <strong><span>enable</span></strong></span><p><p>The system is enabled to save IP addresses assigned from a DHCP address pool to a CF card.</p>
</p><p><p>After this command is run, the system generates and saves the <strong>lease.txt</strong> and <strong>conflict.txt</strong> files in the DHCP folder on a CF card. The <strong>lease.txt</strong> and <strong>conflict.txt</strong> files store address lease and conflict information, respectively. <span>After one-to-many mapping between one MAC address and many sessions is enabled on a device, the device generates an <span>option82_index.data</span> file to save Option 82 information.</span></p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>To configure an integrity authentication mode for the <strong>lease.txt</strong> and <strong>conflict.txt</strong> files, run the <a href="cmdqueryname=dhcp+server+database+authentication-mode"><b><span class="cmdname">dhcp server database authentication-mode</span></b></a> command. This prevents the files from being tampered with. After this command is run, an encrypted file integrity authentication code is added to the files. After the device restarts, the system decrypts this code and uses it to verify the file integrity before restoring the address lease and conflict information from the <strong>lease.txt</strong> and <strong>conflict.txt</strong> files. If the verification is successful, the data is restored; otherwise, it is discarded and a <strong>DHCP_FILE_RECOVER_FAIL</strong> log is recorded.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=dhcp+server+database"><b><span class="cmdname">dhcp server database</span></b></a> <strong><span>write-delay</span></strong> <i><span class="varname">interval</span></i></span><p><p>The interval at which DHCP global address pool data is automatically saved is set.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=dhcp+server+database"><b><span class="cmdname">dhcp server database</span></b></a> <strong><span>recover</span></strong></span><p><p>The DHCP server is enabled to restore DHCP global address pool data from the CF card.</p>
</p><p><p>After this function is enabled, the DHCP server restores DHCP global address pool data from the CF card after system restart.</p>
</p></li></ol>
</li><li><span>Configure the address resource alarm function.</span><ol type="a"><li class="substepexpand"><span>Run <span><a href="cmdqueryname=ip+pool"><b><span class="cmdname">ip pool</span></b></a> <i><span class="varname">ip-pool-name</span></i> [ <strong><span>server</span></strong> ]</span></span><p><p>The address pool view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=warning-threshold"><b><span class="cmdname">warning-threshold</span></b></a> <i><span class="varname">threshold-value</span></i></span></span><p><p>The alarm threshold for the address usage of the address pool is specified.</p>
</p><p><p>If the address usage exceeds a specified threshold, an alarm will be generated. If the address usage falls below 90% of the alarm threshold, this alarm will be cleared.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=warning-exhaust"><b><span class="cmdname">warning-exhaust</span></b></a></span></span><p><p>The address exhaustion alarm function is enabled for the address pool.</p>
</p><p><p>When the address pool is exhausted, an alarm will be generated. When the address usage of the address pool falls below 90% of the threshold, this alarm will be cleared.</p>
</p></li></ol>
</li><li><span>Configure the IP address reclaiming function.</span><ol type="a"><li class="substepexpand"><span>Run <span><a href="cmdqueryname=recycle"><b><span class="cmdname">recycle</span></b></a> <i><span class="varname">start-ip-address</span></i> [ <i><span class="varname">end-ip-address</span></i> ]</span></span><p><p>The IP address status is configured as idle.</p>
</p><p><p>When an IP address is being used by an offline client, the IP address can be reclaimed, preventing IP address waste.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=conflict+auto-recycle"><b><span class="cmdname">conflict auto-recycle</span></b></a> <strong><span>interval</span></strong> <i><span class="varname">interval-time</span></i></span></span><p><p>The interval at which conflicting addresses are automatically reclaimed is set.</p>
</p><p><div class="p">If conflicting addresses exist in an address pool, the DHCP server supports automatic IP address reclaiming by default. You can configure an IP address reclaiming interval as follows:<ul><li>If the <i><span class="varname">interval-time</span></i> value is not 0 and the usage of IP addresses in the address pool exceeds the alarm threshold specified in the <a href="cmdqueryname=warning-threshold"><b><span class="cmdname">warning-threshold</span></b></a> command, the server automatically reclaims some conflicting IP addresses and re-assigns them to users when the address conflict time exceeds the <i><span class="varname">interval-time</span></i> value.</li><li>If the <i><span class="varname">interval-time</span></i> value is set to 0, the automatic address reclaim function is disabled, and conflicting addresses will not be assigned to users. In this case, you need to run the <a href="cmdqueryname=reset+conflict-ip-address"><b><span class="cmdname">reset conflict-ip-address</span></b></a> command to reclaim conflicting addresses.</li></ul>
</div>
</p></li></ol>
</li><li><span>Run <span><a href="cmdqueryname=lock"><b><span class="cmdname">lock</span></b></a></span></span><p><p>The address pool is locked.</p>
</p><p><p>If you want to delete an address pool that is currently in use, you can run this command to lock the address pool and then delete the address pool after all the users using this address pool go offline.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcp_server_cfg_0011.html">Configuring a DHCP Server
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcp_server_cfg_0012.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcp_server_cfg_0014.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>