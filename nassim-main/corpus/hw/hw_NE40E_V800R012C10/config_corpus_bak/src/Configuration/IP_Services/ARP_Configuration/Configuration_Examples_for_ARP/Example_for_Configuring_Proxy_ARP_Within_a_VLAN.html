
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Proxy ARP Within a VLAN">
<meta name="abstract" content="If user isolation is configured for different users in the same virtual local area network (VLAN), the users cannot communicate with each other. To resolve this problem, you can configure proxy Address Resolution Protocol (ARP) for the VLAN.">
<meta name="description" content="If user isolation is configured for different users in the same virtual local area network (VLAN), the users cannot communicate with each other. To resolve this problem, you can configure proxy Address Resolution Protocol (ARP) for the VLAN.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_arp_cfg_2060.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_arp_cfg_2062.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_arp_cfg_2064.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="y00852169,x00504385">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="ARP">
<meta name="featuretype" content="IP Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ARP">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="ARP">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="ARP">
<meta name="featuretype" content="IP Services">
<meta name="OWNER" content="y00852169">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="x00504385">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172364520">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Proxy ARP Within a VLAN</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172364520"></a><a name="EN-US_TASK_0172364520"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Proxy ARP Within a VLAN</h1>
<div class="taskbody"><p>If user isolation is configured for different users in the same virtual local area network (VLAN), the users cannot communicate with each other. To resolve this problem, you can configure proxy Address Resolution Protocol (ARP) for the VLAN.</p>
<div class="context"><a name="EN-US_TASK_0172364520__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0172364520__fig_dc_vrp_arp_cfg_206301">Figure 1</a>, CE is connected to the sub-interface Eth-Trunk 1.1 of PE. Eth-Trunk 1.1 is associated with VLAN 10.</p>
<p>Host A and Host B are two users connected with CE. On CE, the interfaces connected with Host A and Host B belong to the same VLAN. User isolation in a VLAN is configured on CE.</p>
<p>To implement communication between Host A and Host B, enable proxy ARP within a VLAN on Eth-Trunk 1.1 of PE.</p>
<div class="fignone" id="EN-US_TASK_0172364520__fig_dc_vrp_arp_cfg_206301"><a name="EN-US_TASK_0172364520__fig_dc_vrp_arp_cfg_206301"></a><a name="fig_dc_vrp_arp_cfg_206301"></a><span class="figcap"><b>Figure 1 </b>Configuring proxy ARP within a VLAN</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 3 in this example represent GE <span>0/1/1</span>, GE <span>0/1/2</span>, and GE <span>0/1/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001577331473.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172364520__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Create a VLAN on the CE and configure the users that need to communicate with each other to belong to the same VLAN.</p>
</li><li><p>Create Eth-Trunk 1.1 on the PE and configure an IP address for the interface as the gateway IP address.</p>
</li><li><p>Associate Eth-Trunk 1.1 with VLAN 10.</p>
</li><li><p>Enable proxy ARP on Eth-Trunk 1.1 so that isolated users in VLAN 10 can communicate with each other.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172364520__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>ID of the VLAN to which hosts belong: 10</p>
</li><li><p>IP address of Eth-Trunk 1.1: 10.10.10.1/24</p>
</li><li><p>ID of the VLAN associated with Eth-Trunk 1.1: 10</p>
</li><li><p>Host A's IP address: 10.10.10.2/24; Host B's IP address: 10.10.10.3/24</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172364520__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Create VLANs on CEs and determine the VLANs to which users belong.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname CE</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-vlan 10] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE-vlan 10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE-GigabitEthernet<span>0/1/1</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/1/1</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/1/1</span>] <strong>port default vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE] <strong>interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE-GigabitEthernet<span>0/1/2</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/1/2</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/1/2</span>] <strong>port default vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/1/2</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-vlan 10] <strong>port isolate</strong> <strong>gigabitethernet <span>0/1/1</span></strong> <strong>gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-vlan 10] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE-vlan 10] <strong>quit</strong></pre>
</p></li><li><span>On CE, configure the trunk interface GE <span>0/1/3</span> to allow VLAN 10 to pass through.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE] <strong>interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE-GigabitEthernet<span>0/1/3</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/1/3</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/1/3</span>] <strong>port link-type trunk</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/1/3</span>] <strong>port trunk</strong> <strong>allow-pass vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE-GigabitEthernet<span>0/1/3</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE-GigabitEthernet<span>0/1/3</span>] <strong>quit</strong></pre>
</p></li><li><span>Create Eth-Trunk 1.1 on the PE and configure an IP address for Eth-Trunk 1.1.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE] <strong>interface eth-trunk 1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Eth-Trunk1.1] <strong>ip address 10.10.10.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Eth-Trunk1.1] <strong>commit</strong></pre>
</p></li><li><span>Configure IP addresses for Host A and Host B.</span><p><p># Configure IP addresses for Host A and Host B. The IP addresses must be in the same network segment with the IP address of Eth-Trunk 1.1.</p>
<p>After successful configuration, Host A and Host B can ping the PE, but cannot ping each other.</p>
</p></li><li><span>Associate Eth-Trunk 1.1 with VLAN 10.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE-Eth-Trunk1.1] <strong>vlan-type dot1q 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Eth-Trunk1.1] <strong>commit</strong></pre>
</p></li><li><span>Enable proxy ARP in VLAN 10 on Eth-Trunk 1.1.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE-Eth-Trunk1.1] <strong>arp-proxy inner-sub-vlan-proxy enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Eth-Trunk1.1] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>Host A and Host B can ping each other.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172364520__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE configuration file</p>
<pre class="screen">#
sysname PE
#
interface Eth-Trunk1
 undo shutdown
#
interface Eth-Trunk1.1
 undo shutdown
 vlan-type dot1q 10
 ip address 10.10.10.1 255.255.255.0
 <span>arp-proxy inner-sub-vlan-proxy enable</span>
#
return</pre>
</li><li><p>CE configuration file</p>
<pre class="screen">#
sysname CE
#
vlan 10
#
interface GigabitEthernet<span>0/1/1</span>
 portswitch
 undo shutdown
 port default vlan 10
#
interface GigabitEthernet<span>0/1/2</span>
 portswitch
 undo shutdown
 port default vlan 10
#
vlan 10
 port isolate GigabitEthernet<span>0/1/1</span> GigabitEthernet<span>0/1/2</span>
#
interface GigabitEthernet<span>0/1/3</span> 
 portswitch 
 undo shutdown 
 port link-type trunk 
 port trunk allow-pass vlan 10
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_arp_cfg_2060.html">Configuration Examples for ARP
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_arp_cfg_2062.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_arp_cfg_2064.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>