
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring DHCPv6 Relay Dual-Device Hot Standby in a VRRP/VRRP6 Master/Backup Backup Scenario">
<meta name="abstract" content="DHCPv6 relay dual-device hot standby can be enabled to back up user entries between devices. If a network node or link fails, a rapid user service switchover is triggered, improving service reliability.">
<meta name="description" content="DHCPv6 relay dual-device hot standby can be enabled to back up user entries between devices. If a network node or link fails, a rapid user service switchover is triggered, improving service reliability.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcpv6_relay_cfg_0003.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcpv6_relay_cfg_0014.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcpv6_relay_cfg_0005.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,z00485179,w00556928,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="DHCP v6">
<meta name="featuretype" content="IP Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="DHCP v6">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="DHCP v6">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="DHCP v6">
<meta name="featuretype" content="IP Services">
<meta name="OWNER" content="z00485179,x00504385">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="x00504385">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0208478032">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring DHCPv6 Relay Dual-Device Hot Standby in a VRRP/VRRP6 Master/Backup Backup Scenario</title>
</head>
<body><a name="EN-US_TASK_0208478032"></a><a name="EN-US_TASK_0208478032"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring DHCPv6 Relay Dual-Device Hot Standby in a VRRP/VRRP6 Master/Backup Backup Scenario</h1>
<div class="taskbody"><p>DHCPv6 relay dual-device hot standby can be enabled to back up user entries between devices. If a network node or link fails, a rapid user service switchover is triggered, improving service reliability.</p>
<div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0208478032__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before configuring DHCPv6 relay dual-device hot standby, complete the following tasks:</p>
<ul><li>Ensure that the same DHCPv6 relay configurations have been performed on the master and backup devices (the DHCPv6 relay interface types and VLANs configured on the master and backup devices must be the same).</li><li>Ensure that the system time of the master device is the same as that of the backup device (you are advised to configure clock synchronization).</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0208478032__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>On the network shown in <a href="#EN-US_TASK_0208478032__fig631274682315">Figure 1</a>, a VRRP or VRRP6 group is configured on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B to establish a master/backup relationship. <span class="keyword">Device</span>A and <span class="keyword">Device</span>B are the master and backup, respectively. Both <span class="keyword">Device</span>A and <span class="keyword">Device</span>B are DHCPv6 relay agents that forward DHCPv6 client and server messages.</p>
<p>In normal situations, <span class="keyword">Device</span>A forwards user packets, and <span class="keyword">Device</span>B receives user entries synchronized from <span class="keyword">Device</span>A and generates PD routes based on the user entries. If <span class="keyword">Device</span>A or the link between <span class="keyword">Device</span>A and the switch fails, a master/backup VRRP or VRRP6 switchover is performed, and <span class="keyword">Device</span>B becomes the master. In this case, user packets are switched to <span class="keyword">Device</span>B for forwarding. Users are unaware of the fault.</p>
<div class="fignone" id="EN-US_TASK_0208478032__fig631274682315"><a name="EN-US_TASK_0208478032__fig631274682315"></a><a name="fig631274682315"></a><span class="figcap"><b>Figure 1 </b>DHCPv6 relay dual-device hot standby</span><br><span><img class="vsd" src="figure/en-us_image_0202292078.png"></span></div>
<p>Perform the following steps on the DHCPv6 relay agents that back up each other. The following uses a VRRP6 group as an example to describe how to configure DHCPv6 relay dual-device hot standby. The procedure for configuring a VRRP group is similar to that for configuring a VRRP6 group.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0208478032__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure basic VRRP6 group functions.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> [ .<i><span class="varname">subinterface-number</span></i> ]</span><p><p>The view of the interface where a VRRP6 group needs to be configured is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv6+enable"><b><span class="cmdname">ipv6 enable</span></b></a></span><p><p>IPv6 is enabled for the interface.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv6+address"><b><span class="cmdname">ipv6 address</span></b></a> { <i><span class="varname">ipv6-address prefix-length</span></i> | <i><span class="varname">ipv6-address-mask</span></i> }</span><p><p>An IPv6 address is configured for the interface.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=vrrp6+vrid"><b><span class="cmdname">vrrp6 vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>virtual-ip</span></strong> <i><span class="varname">virtual-address</span></i> <strong><span>link-local</span></strong></span><p><p>A VRRP6 group is created and assigned the first virtual IPv6 address.</p>
</p><p><p>When a VRRP6 group is created on an interface, the first virtual IPv6 address assigned to the VRRP6 group must be a link-local address.</p>
<p>When the first virtual IPv6 address is assigned to a VRRP6 group, the system creates the VRRP6 group. If another virtual IPv6 address is assigned to the VRRP6 group, the system adds the address to the virtual IPv6 address list.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=vrrp6+vrid"><b><span class="cmdname">vrrp6 vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>virtual-ip</span></strong> <i><span class="varname">virtual-address</span></i></span><p><p>A virtual IPv6 address is configured for the VRRP6 group.</p>
</p><p><p>Multiple virtual IPv6 addresses can be assigned to a VRRP6 group. A single virtual IPv6 address serves a separate user group, in which users have the same reliability requirements. This setting helps prevent the default gateway addresses from varying according to changes in VRRP6 device locations.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=vrrp6+vrid"><b><span class="cmdname">vrrp6 vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>preempt-mode</span></strong> <strong><span>timer</span></strong> <strong><span>delay</span></strong> <i><span class="varname">delay-time</span></i></span><p><p>A preemption delay is set for the device in the VRRP6 group.</p>
</p><p><p>You are advised to set the preemption delay to 0 on a backup device to allow it to preempt the master role immediately after the master device fails or set the preemption delay to a non-0 value on the master device so that it can preempt the master role after a specified delay if a master/backup VRRP6 switchover is performed.</p>
<div class="notice"><span class="noticetitle"><img src="../../../../public_sys-resources/notice_3.0-en-us.png"> </span><div class="noticebody"><ul><li>The interface on which a VRRP6 group is created and the interface on which DHCPv6 relay is configured must belong to the same main interface. Otherwise, VRRP6 cannot detect link faults on the DHCPv6 relay interface.</li><li>In DHCPv6 relay dual-device hot standby scenarios, to ensure that the master device can completely back up user session information to the backup device, you are advised to set a preemption delay greater than or equal to 1800s for the master device.</li></ul>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=vrrp6+vrid"><b><span class="cmdname">vrrp6 vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>priority</span></strong> <i><span class="varname">priority-value</span></i></span><p><p>A priority is configured for the device in the VRRP6 group.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Before running this command to perform a master/backup VRRP6 switchover, ensure that the routing entries on the master and backup devices are the same. If they are different, user packet loss may occur.</p>
</div></div>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=vrrp6+vrid"><b><span class="cmdname">vrrp6 vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>timer</span></strong> <strong><span>advertise</span></strong> <i><span class="varname">advertise-interval</span></i></span><p><p>An interval for sending VRRP6 Advertisement packets is set.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The interval at which a device sends VRRP6 Advertisement packets cannot be less than the time that the device takes to perform a master/slave main control board switchover. If the interval is less than the switchover time, protocol flapping may occur during a master/slave main control board switchover. It is recommended that the interval be set to a value greater than 1s.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the interface view.</p>
</p></li></ol>
</li><li><span>Configure an RBS.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=remote-backup-service"><b><span class="cmdname">remote-backup-service</span></b></a> <i><span class="varname">remote-backup-service-name</span></i></span><p><p>An RBS is created, and the RBS view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=bind+ssl-policy"><b><span class="cmdname">bind ssl-policy</span></b></a> <i><span class="varname">ssl-policy-name</span></i></span><p><p>An SSL policy is bound to a TCP connection.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">peer-ip-address</span></i> <a href="cmdqueryname=source"><b><span class="cmdname">source</span></b></a> <i><span class="varname">source-ip-address</span></i> <a href="cmdqueryname=port"><b><span class="cmdname">port</span></b></a> <i><span class="varname">port-id</span></i></span><p><p>TCP connection parameters are configured for the RBS.</p>
</p><p><p><i><span class="varname">source-ip-address</span></i> and <i><span class="varname">peer-ip-address</span></i> specify the IP addresses of the master and backup devices, respectively. The IP addresses must have been configured on their own interfaces, sub-interfaces, or logical interfaces (such as loopback interfaces) and be able to ping each other.</p>
<p><i><span class="varname">port-id</span></i> specifies a TCP port number. The TCP port numbers configured on the master and backup devices must be the same.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=batch-backup"><b><span class="cmdname">batch-backup</span></b></a> <strong><span>service-type</span></strong> <strong><span>dhcpv6-relay</span></strong> <strong><span>now</span></strong></span><p><p>The DHCPv6 relay service configured in the RBS is immediately backed up.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=batch-backup+service-type+dhcpv6-relay+daily"><b><span class="cmdname">batch-backup service-type dhcpv6-relay daily</span></b></a> <i><span class="varname">daytime</span></i></span><p><p>The DHCPv6 relay service configured in the RBS is backed up at a specified time on a daily basis.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the RBS view.</p>
</p></li></ol>
</li><li><span>Configure an RBP.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=remote-backup-profile"><b><span class="cmdname">remote-backup-profile</span></b></a> <i><span class="varname">profile-name</span></i></span><p><p>An RBP is created, and the RBP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer-backup"><b><span class="cmdname">peer-backup</span></b></a> <strong><span>hot</span></strong></span><p><p>A backup mode is configured for user information backup.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=vrrp6-id"><b><span class="cmdname">vrrp6-id</span></b></a> <i><span class="varname">vrid</span></i> <strong><span>interface</span></strong> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span><p><p>The RBP is bound to a VRRP6 group.</p>
</p><p><p><i><span class="varname">vrid</span></i> specifies the ID of a VRRP6 group. The ID must be the same as the VRRP6 group's ID that was configured using the <a href="cmdqueryname=vrrp6+vrid"><b><span class="cmdname">vrrp6 vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> [ <strong><span>virtual-ip</span></strong> <i><span class="varname">virtual-address</span></i> ] command in the corresponding interface view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=backup-id"><b><span class="cmdname">backup-id</span></b></a> <i><span class="varname">backup-id</span></i> <a href="cmdqueryname=remote-backup-service"><b><span class="cmdname">remote-backup-service</span></b></a> <i><span class="varname">service-name</span></i></span><p><p>A backup ID is configured for the RBP, and the RBP is associated with a specified RBS.</p>
</p><p><p><i><span class="varname">backup-id</span></i> specifies a backup ID for an RBP. You can use a backup ID and an RBS to determine an RBP. The backup IDs configured for the same RBP must be the same on the master and backup devices and can no longer be configured for other RBPs.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the RBP view.</p>
</p></li></ol>
</li><li><span>Enable DHCPv6 relay remote backup.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=remote-backup-profile"><b><span class="cmdname">remote-backup-profile</span></b></a> <i><span class="varname">profile-name</span></i></span><p><p>The RBP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=service-type+dhcpv6-relay"><b><span class="cmdname">service-type dhcpv6-relay</span></b></a></span><p><p>DHCPv6 relay remote backup is enabled.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the RBP view.</p>
</p></li></ol>
</li><li><span>Bind the RBP to an interface.</span><ol type="a"><li class="substepexpand"><span>Run <strong>interface</strong> <em>interface-type</em> <em>interface-number</em> [ .<i><span class="varname">subinterface-number</span></i> ]</span><p><p>The view of the DHCPv6 relay interface where DHCPv6 relay dual-device hot standby needs to be configured is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=remote-backup-profile"><b><span class="cmdname">remote-backup-profile</span></b></a> <i><span class="varname">profile-name</span></i></span><p><p>The RBP is bound to the DHCPv6 relay interface.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>DHCPv6 relay must be configured on the interface to which the RBP is to be bound. Otherwise, DHCPv6 relay dual-device hot standby does not take effect.</p>
</div></div>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=dhcpv6+relay+pd-route+degrade-cost"><b><span class="cmdname">dhcpv6 relay pd-route degrade-cost</span></b></a> <i><span class="varname">cost-value</span></i></span><p><p>A cost value is configured for PD routes generated by the backup device in the DHCPv6 relay dual-device hot standby scenario.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcpv6_relay_cfg_0003.html">Configuring DHCPv6 Relay
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcpv6_relay_cfg_0014.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcpv6_relay_cfg_0005.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>