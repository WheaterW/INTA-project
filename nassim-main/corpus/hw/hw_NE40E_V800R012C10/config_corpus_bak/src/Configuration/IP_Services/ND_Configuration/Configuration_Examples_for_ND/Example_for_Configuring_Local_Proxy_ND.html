
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Local Proxy ND">
<meta name="abstract" content="This section provides an example for configuring local proxy ND in a scenario where hosts are on the same network segment and BD but the BD is configured with user isolation.">
<meta name="description" content="This section provides an example for configuring local proxy ND in a scenario where hosts are on the same network segment and BD but the BD is configured with user isolation.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0009.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0013.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0015.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,ndvrp,w00556928">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Services">
<meta name="OWNER" content="z00648985">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00648985">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172365201">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Local Proxy ND</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172365201"></a><a name="EN-US_TASK_0172365201"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Local Proxy ND</h1>
<div class="taskbody"><p>This section provides an example for configuring local proxy ND in a scenario where hosts are on the same network segment and BD but the BD is configured with user isolation.</p>
<div class="context"><a name="EN-US_TASK_0172365201__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In the EVC model, the member interfaces of a BD broadcast the received packets in the BD. To reduce broadcast operations, network administrators usually configure split horizon on the member interfaces that do not need to intercommunicate to isolate these member interfaces.</p>
<div class="p">On the network shown in <a href="#EN-US_TASK_0172365201__fig_dc_vrp_nd_feature_002903">Figure 1</a>, the network administrator configures intra-BD split horizon on DeviceA to prevent HostA and HostB from communicating with each other. As user services develop, HostA and HostB need to communicate with each other. To meet this requirement, enable local proxy ND on DeviceA.<div class="fignone" id="EN-US_TASK_0172365201__fig_dc_vrp_nd_feature_002903"><a name="EN-US_TASK_0172365201__fig_dc_vrp_nd_feature_002903"></a><a name="fig_dc_vrp_nd_feature_002903"></a><span class="figcap"><b>Figure 1 </b>Local proxy ND</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent GE <span>0/1/1</span> and GE <span>0/1/2</span>, respectively.</p>
<p>The IPv6 address configured for a proxy ND-enabled interface must be on the same network segment as the IPv6 address of the host connected to the interface.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_nd_feature_003712.png"></span><br></div>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365201__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure Layer 2 forwarding on DeviceB and DeviceC.</p>
<ol type="a"><li>Create a VLAN and add downstream interfaces to the VLAN.</li><li>Configure Layer 2 forwarding on upstream interfaces so that the packets sent to DeviceA carry a single VLAN tag.</li></ol>
</li><li>Create an EVC model on DeviceA.<ol type="a"><li>Configure a BD for service forwarding.</li><li>Create a Layer 2 sub-interface and add the sub-interface to the BD.</li></ol>
</li><li>Enable local proxy ND on DeviceA.<ol type="a"><li>Create a VBDIF interface and assign an IPv6 address to it.</li><li>Enable local proxy ND to allow HostA and HostB to intercommunicate.</li></ol>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365201__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IPv6 addresses of interfaces</p>
</li><li><p>IPv6 addresses of hosts</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172365201__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure Layer 2 forwarding on DeviceB and DeviceC.</span><p><p># Configure DeviceB.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceB</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceB-vlan10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceB] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceB-GigabitEthernet<span>0/1/1</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceB-GigabitEthernet<span>0/1/1</span>] <strong>port link-type access</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceB-GigabitEthernet<span>0/1/1</span>] <strong>port default vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceB-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceB]<strong> interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceB-GigabitEthernet<span>0/1/2</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceB-GigabitEthernet<span>0/1/2</span>] <strong>port link-type trunk</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceB-GigabitEthernet<span>0/1/2</span>] <strong>port trunk allow-pass vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceB-GigabitEthernet<span>0/1/2</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<p>The configuration of DeviceC is similar to the configuration of DeviceB. For configuration details, see <a href="#EN-US_TASK_0172365201__file1">Configuration Files</a> in this section.</p>
</p></li><li><span>Create an EVC model on DeviceA.</span><p><p># Create a BD.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>bridge-domain 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA-bd10] <strong>split-horizon enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA-bd10] <strong>quit</strong></pre>
<p># Create a Layer 2 sub-interface and add the sub-interface to the BD.</p>
<pre class="screen">[<span class="keyword">*</span>DeviceA] <strong>interface gigabitethernet <span>0/1/1</span>.1 mode l2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA-GigabitEthernet<span>0/1/1</span>.1] <strong>encapsulation dot1q vid 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA-GigabitEthernet<span>0/1/1</span>.1] <strong>rewrite pop single</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA-GigabitEthernet<span>0/1/1</span>.1] <strong>bridge-domain 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA] <strong>interface gigabitethernet <span>0/1/2</span>.1 mode l2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA-GigabitEthernet<span>0/1/2</span>.1] <strong>encapsulation dot1q vid 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA-GigabitEthernet<span>0/1/2</span>.1] <strong>rewrite pop single</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA-GigabitEthernet<span>0/1/2</span>.1] <strong>bridge-domain 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA-GigabitEthernet<span>0/1/2</span>.1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
</p></li><li><span>Enable local proxy ND on DeviceA.</span><p><p># Create a VBDIF interface and assign an IPv6 address to it.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface Vbdif 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA-Vbdif10] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA-Vbdif10] <strong>ipv6 address 2001:db8:300:400::4 64</strong></pre>
<p># Enable local proxy ND.</p>
<pre class="screen">[<span class="keyword">*</span>DeviceA-Vbdif10] <strong>ipv6 nd proxy local enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DeviceA-Vbdif10] <strong>commit</strong></pre>
</p></li><li><span>Configure the IPv6 addresses of hosts.</span><p><p># Configure the IPv6 address of HostA as 2001:db8:300:400::1/64.</p>
<p># Configure the IPv6 address of HostB as 2001:db8:300:400::3/64.</p>
</p></li><li><span>Verify the configuration.</span><p><p>After the configurations are complete, HostA and HostB can ping each other.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172365201__file1"><a name="EN-US_TASK_0172365201__file1"></a><a name="file1"></a><a name="EN-US_TASK_0172365201__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>DeviceA configuration file</p>
<pre class="screen">#
sysname DeviceA
#
bridge-domain 10
 split-horizon enable
#
interface Vbdif10
 ipv6 enable
 ipv6 address 2001:DB8:300:400::4/64
 ipv6 nd proxy local enable
#
interface GigabitEthernet<span>0/1/1</span>
#
interface GigabitEthernet<span>0/1/1</span>.1 mode l2
 encapsulation dot1q vid 10
<span> rewrite pop single</span>
 bridge-domain 10
#
interface GigabitEthernet<span>0/1/2</span>
#
interface GigabitEthernet<span>0/1/2</span>.1 mode l2
 encapsulation dot1q vid 10
<span> rewrite pop single</span>
 bridge-domain 10
#
return</pre>
</li><li><p>DeviceB configuration file</p>
<pre class="screen">#
sysname DeviceB
#
vlan batch 10
#
interface GigabitEthernet<span>0/1/1</span>
<span> portswitch  </span>
<span> port link-type access</span>
 port default vlan 10
#
interface GigabitEthernet<span>0/1/2</span>
<span> portswitch</span>
 port link-type trunk
 port trunk allow-pass vlan 10
#
return</pre>
</li><li><p>DeviceC configuration file</p>
<pre class="screen">#
sysname DeviceC
#
vlan batch 10
#
interface GigabitEthernet<span>0/1/1</span>
<span> portswitch  </span>
<span> port link-type access</span>
 port default vlan 10
#
interface GigabitEthernet<span>0/1/2</span>
<span> portswitch</span>
 port link-type trunk
 port trunk allow-pass vlan 10
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0009.html">Configuration Examples for ND
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0013.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0015.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>