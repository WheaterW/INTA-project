
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Outputting Original Flow Packets">
<meta name="abstract" content="To ensure that original flow packets can be correctly output to the NMS, configure the aging time, output format, and source and destination addresses for original flows.">
<meta name="description" content="To ensure that original flow packets can be correctly output to the NMS, configure the aging time, output format, and source and destination addresses for original flows.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0003.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0041.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0049.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="NetStream">
<meta name="featuretype" content="System Monitor">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NetStream">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="NetStream">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="Netstream">
<meta name="featuretype" content="System Monitor">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00799643">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172372946">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Outputting Original Flow Packets</title>
</head>
<body><a name="EN-US_TASK_0172372946"></a><a name="EN-US_TASK_0172372946"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Outputting Original Flow Packets</h1>
<div class="taskbody"><p>To ensure that original flow packets can be correctly output to the NMS, configure the aging time, output format, and source and destination addresses for original flows.</p>
<div class="steps"><a name="EN-US_TASK_0172372946__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=ip+netstream+export+version"><b><span class="cmdname">ip netstream export version</span></b></a> { <strong><span>5</span></strong> [ <strong><span>origin-as</span></strong> | <strong><span>peer-as</span></strong> ] | <strong><span>9</span></strong> [ <strong><span>origin-as</span></strong> | <strong><span>peer-as</span></strong> ] [ <strong><span>bgp-nexthop</span></strong> ] <span>[ <strong><span>ttl</span></strong> ]</span> [ <strong><span>route-distinguisher</span></strong> ] <span>| <strong><span>ipfix</span></strong> [ <strong><span>origin-as</span></strong> | <strong><span>peer-as</span></strong> ] [ <strong><span>bgp-nexthop</span></strong> ]<span> [ <strong><span>ttl</span></strong> ]</span></span> [ <strong><span>route-distinguisher</span></strong> ] }</span><p><p>The format of output packets is configured.</p>
</p><p><p>NetStream original flow packets can be output in V5, V9, or IPFIX format. V5, V9, and IPFIX formats are mutually exclusive.</p>
<p>Using a template to output original flow packets, V9 allows statistics to be output more flexibly, newly defined flow elements to be extended more easily, and new records to be generated more easily.</p>
<p>Compared with the V9 format, the IPFIX format improves packet extensibility and compatibility, security, and reliability. In addition, the IPFIX format has an enterprise identifier field added. When setting this field, you must use the IPFIX format for outputting NetStream IPv4 original flow packets.</p>
<div class="p">The V5 format is fixed, and the system cost is low. In most cases, NetStream original flow packets can be output in V5 format. In the following cases, however, NetStream original flow packets must be output in V9 or IPFIX format.<ul><li><p>The output NetStream packets need to carry BGP next-hop information.</p>
</li><li><p>Interface indexes carried in the output NetStream packets need to be extended from 16 bits to 32 bits.</p>
</li></ul>
</div>
</p></li><li><span>(Optional) Configure NetStream packets to carry the flow sequence field.</span><p><ol type="a"><li>Run the <a href="cmdqueryname=slot"><b><span class="cmdname">slot</span></b></a> <i><span class="varname">slot-id</span></i> command to enter the view of the slot in which the interface board for NetStream sampling resides.</li><li><div class="p">Run the <a href="cmdqueryname=ip+netstream+export+sequence-mode+flow"><b><span class="cmdname">ip netstream export sequence-mode flow</span></b></a> command to configure NetStream packets to carry the flow sequence field.<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command applies to the V9 format only.</p>
</div></div>
</div>
</li><li>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</li></ol>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=ip+netstream+export+template+sequence-number+fixed"><b><span class="cmdname">ip netstream export template sequence-number fixed</span></b></a></span><p><p>The sequence numbers of template packets and option template packets in the IPFIX format are configured to remain unchanged, but data packets and option data packets in the IPFIX format are still consecutively numbered.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=ip+netstream+export+template+timeout-rate"><b><span class="cmdname">ip netstream export template timeout-rate</span></b></a><i><span class="varname"> timeout-interval</span></i></span><p><p>The interval at which the template is refreshed when original flows are output in the V9 or IPFIX format is set.</p>
</p></li><li><span>Run <a href="cmdqueryname=ip+netstream+export+source"><b><span class="cmdname">ip netstream export source</span></b></a> { <i><span class="varname">ip-address</span></i> | <strong><span>ipv6</span></strong> <i><span class="varname">ipv6-address</span></i> }<span> [ <i><span class="varname">port</span></i> ]</span></span><p><p>The source IP address<span> and source port</span> are specified for original flows to be output.</p>
</p></li><li><span>In the system<span> or slot</span> view: specify the destination IP address and UDP port number of the peer NetStream Collector (NSC) for the statistics to be output.</span><p><ul><li><p>In the system view:</p>
<p>Run the <a href="cmdqueryname=ip+netstream+export+host"><b><span class="cmdname">ip netstream export host</span></b></a> [ <strong><span>ipv6</span></strong> ] <em>ip-address</em> <i><span class="varname">port</span></i><span> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ]</span><span> [ <strong><span>dscp</span></strong> <i><span class="varname">dscp-value</span></i> ]</span> command to configure a destination IP address and a UDP port number for outputting statistics.</p>
</li><li><p>In the slot view:</p>
<ol type="a"><li><p>Run the <a href="cmdqueryname=slot"><b><span class="cmdname">slot</span></b></a> <i><span class="varname">slot-id</span></i> command to enter the view of the slot in which the interface board for NetStream sampling resides.</p>
</li><li><p>Run the <a href="cmdqueryname=ip+netstream+export+host"><b><span class="cmdname">ip netstream export host</span></b></a> [ <strong><span>ipv6</span></strong> ] <em>ip-address</em> <i><span class="varname">port</span></i><span> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ]</span><span> [ <strong><span>dscp</span></strong> <i><span class="varname">dscp-value</span></i> ]</span> command to configure a destination IP address and a UDP port number for outputting statistics.</p>
</li><li><p>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</p>
</li></ol>
</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>NetStream packets are output to the NSC through the service interface instead of the management interface.</p>
</div></div>
</p></li><li><span>(Optional) Set parameters for aging original flows as needed:</span><p><ul><li><p>Run the <a href="cmdqueryname=ip+netstream+timeout"><b><span class="cmdname">ip netstream timeout</span></b></a> <strong><span>active</span></strong> <span>{ </span><i><span class="varname">active-interval</span></i><span> | <strong><span>interval-second</span></strong> <i><span class="varname">active-interval-second</span></i> }</span> to set the active aging time for NetStream original flows.</p>
</li><li><p>Run the <a href="cmdqueryname=ip+netstream+timeout"><b><span class="cmdname">ip netstream timeout</span></b></a> <strong><span>inactive</span></strong> <i><span class="varname">inactive-interval</span></i> command to set the inactive aging time for NetStream original flows.</p>
</li></ul>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0003.html">Collecting Statistics About IPv4 Original Flows
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0041.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0049.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>