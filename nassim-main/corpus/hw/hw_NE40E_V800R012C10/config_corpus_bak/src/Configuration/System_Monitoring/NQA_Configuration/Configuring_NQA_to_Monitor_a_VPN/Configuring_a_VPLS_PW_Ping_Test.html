
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a VPLS PW Ping Test">
<meta name="abstract" content="A virtual private local area network service (VPLS) pseudo wire (PW) ping test can be used to check the PW connectivity and measure the packet loss rate, delay, and other indicators of a VPLS network.">
<meta name="description" content="A virtual private local area network service (VPLS) pseudo wire (PW) ping test can be used to check the PW connectivity and measure the packet loss rate, delay, and other indicators of a VPLS network.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nqa_cfg_0039.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nqa_cfg_0044.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nqa_cfg_0045.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="NQA">
<meta name="featuretype" content="System Monitor">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NQA">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="NQA">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="NQA">
<meta name="featuretype" content="System Monitor">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="c00511010">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172373096">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a VPLS PW Ping Test</title>
</head>
<body><a name="EN-US_TASK_0172373096"></a><a name="EN-US_TASK_0172373096"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a VPLS PW Ping Test</h1>
<div class="taskbody"><p><span>A virtual private local area network service (VPLS) pseudo wire (PW) ping test can be used to check the PW connectivity and measure the packet loss rate, delay, and other indicators of a VPLS network.</span></p>
<div class="steps"><a name="EN-US_TASK_0172373096__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Create an NQA test instance and set the test instance type to VPLS PW ping.</span><ol type="a"><li><span>Run the <a href="cmdqueryname=nqa"><b><span class="cmdname">nqa</span></b></a> <strong><span>test-instance</span></strong> <i><span class="varname">admin-name test-name</span></i> command to create an NQA test instance and enter its view.</span></li><li><span>Run the <a href="cmdqueryname=test-type"><b><span class="cmdname">test-type</span></b></a> <strong><span>vplspwping</span></strong> command to set the test instance type to VPLS PW ping.</span></li><li><span>(Optional) Run the <a href="cmdqueryname=description"><b><span class="cmdname">description</span></b></a> <i><span class="varname">description</span></i> command to configure a description for the test instance.</span></li></ol>
</li><li><span>(Optional) Run <a href="cmdqueryname=fragment+enable"><b><span class="cmdname">fragment enable</span></b></a></span><p><p>MPLS packet fragmentation is enabled for the NQA test instance.</p>
</p></li><li><span>Set parameters for the VPLS network to be tested. Specifically:</span><ol type="a"><li><span>Run the <a href="cmdqueryname=vc-type+ldp"><b><span class="cmdname" id="EN-US_TASK_0172373096__cmdname159445591324250">vc-type ldp</span></b></a> command to set the VC protocol type to LDP.</span></li><li><span>Run the <a href="cmdqueryname=vsi"><b><span class="cmdname">vsi</span></b></a> <i><span class="varname">vsi-name</span></i> command to configure the name of a VSI to be tested.</span></li><li id="EN-US_TASK_0172373096__substep1416183038214103"><span id="EN-US_TASK_0172373096__cmd1227059965214103">Run the <a href="cmdqueryname=destination-address"><b><span class="cmdname" id="EN-US_TASK_0172373096__cmdname41614112954419">destination-address</span></b></a> <strong><span id="EN-US_TASK_0172373096__cmdparmname167335716454419">ipv4</span></strong> <i><span class="varname" id="EN-US_TASK_0172373096__varname109833521454419">destAddress</span></i> command to configure an IP address for the remote PE.</span></li></ol>
</li><li><span>(Optional) Configure information about the remote PE when an MS-PW is to be tested.</span><p><p>An MS-PW can be monitored only after you specify <strong><span>control-word</span></strong>.</p>
</p><ol type="a"><li class="substepexpand" id="EN-US_TASK_0172373096__substep1257970934214103"><span id="EN-US_TASK_0172373096__cmd740983023214103">Run the <a href="cmdqueryname=label-type"><b><span class="cmdname" id="EN-US_TASK_0172373096__cmdname1926414978214103">label-type</span></b></a> { <strong><span id="EN-US_TASK_0172373096__cmdparmname242936384214103">label-alert</span></strong> | <strong><span id="EN-US_TASK_0172373096__cmdparmname2083335104214103">control-word</span></strong> } command to configure a packet encapsulation type.</span></li><li class="substepexpand" id="EN-US_TASK_0172373096__substep212226734214103"><span id="EN-US_TASK_0172373096__cmd2071864318214103">(Optional) Run the <a href="cmdqueryname=local-pw-id"><b><span class="cmdname" id="EN-US_TASK_0172373096__cmdname1551491679214103">local-pw-id</span></b></a> <i><span class="varname" id="EN-US_TASK_0172373096__varname33821349151811">pwIdValue</span></i> command to configure a PW ID for the local PE.</span><p><div class="note" id="EN-US_TASK_0172373096__note224906306214103"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172373096__p13387240135217">If the VSI configured using the <a href="cmdqueryname=vsi"><b><span class="cmdname" id="EN-US_TASK_0172373096__cmdname65906528214103">vsi</span></b></a> <i><span class="varname" id="EN-US_TASK_0172373096__varname696205563214103">vsi-name</span></i> command has a specified <strong><span id="EN-US_TASK_0172373096__cmdparmname1598993783214103">negotiation-vc-id</span></strong>, the <a href="cmdqueryname=local-pw-id"><b><span class="cmdname" id="EN-US_TASK_0172373096__cmdname1270386995214103">local-pw-id</span></b></a> <i><span class="varname" id="EN-US_TASK_0172373096__varname186224539358">pwIdValue</span></i> command must be run.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=remote-pw-id"><b><span class="cmdname">remote-pw-id</span></b></a> <i><span class="varname">pwIdValue</span></i> command to configure a PW ID for the remote PE.</span></li><li class="substepexpand"><span>(Optional) Run the <a href="cmdqueryname=sender-address"><b><span class="cmdname">sender-address</span></b></a> <strong><span>ipv4</span></strong> <i><span class="varname">ip-address</span></i> command to configure a source IP address for the public network session between the device and the remote PE. This IP address is usually the IP address of a superstratum provider edge (SPE) that switches and forwards adjacent labels or a user-end provider edge (UPE), which is an edge device on a backbone network</span><p><p>The <a href="cmdqueryname=sender-address"><b><span class="cmdname">sender-address</span></b></a> command needs to be configured only when a Huawei device interworks with a non-Huawei device.</p>
</p></li></ol>
</li><li><span>(Optional) Set optional parameters for the test instance and simulate real service flows.</span><ol type="a"><li><span>Run the <a href="cmdqueryname=lsp-exp"><b><span class="cmdname">lsp-exp</span></b></a> <i><span class="varname">exp</span></i> command to configure an LSP EXP value for the NQA test instance.</span></li><li><span>Run the <a href="cmdqueryname=lsp-replymode"><b><span class="cmdname">lsp-replymode</span></b></a><span> { <strong><span>level-control-channel</span></strong> | <strong><span>no-reply</span></strong> | <strong><span>udp</span></strong> }</span> command to configure a reply mode for the NQA test instance.</span></li><li><span>Run the <a href="cmdqueryname=datafill"><b><span class="cmdname">datafill</span></b></a> <i><span class="varname">fill-string</span></i> command to configure the padding characters to be filled into test packets.</span></li><li><span>Run the <a href="cmdqueryname=datasize"><b><span class="cmdname">datasize</span></b></a> <i><span class="varname">datasizeValue</span></i> command to set the size of the Data field in an NQA test packet.</span></li><li><span>Run the <a href="cmdqueryname=probe-count"><b><span class="cmdname">probe-count</span></b></a> <i><span class="varname">number</span></i> command to set the number of probes in a test for the NQA test instance.</span></li><li><span>Run the <a href="cmdqueryname=interval"><b><span class="cmdname">interval</span></b></a> <strong><span>seconds</span></strong> <i><span class="varname">interval</span></i> command to set the interval at which NQA test packets are sent.</span></li><li><span>Run the <a href="cmdqueryname=ttl"><b><span class="cmdname">ttl</span></b></a> <i><span class="varname">ttlValue</span></i> command to configure a TTL value for NQA test packets.</span></li></ol>
</li><li><span>(Optional) Configure test failure conditions.</span><ol type="a"><li><span>Run the <a href="cmdqueryname=timeout"><b><span class="cmdname">timeout</span></b></a> <i><span class="varname">time</span></i> command to configure a timeout period for response packets.</span></li><li><span>Run the <a href="cmdqueryname=fail-percent"><b><span class="cmdname">fail-percent</span></b></a> <i><span class="varname">percent</span></i> command to configure a failure percentage for the NQA test instance.</span></li></ol>
</li><li><span>(Optional) Configure NQA statistics collection.</span><p><p>Run <a href="cmdqueryname=records"><b><span class="cmdname">records</span></b></a> { <strong><span>history</span></strong> <i><span class="varname">number</span></i> | <strong><span>result</span></strong> <i><span class="varname">number</span></i> }</p>
<p>The maximum numbers of historical records and test results that can be saved for the NQA test instance are configured.</p>
</p></li><li><span>(Optional) Configure the device to send trap messages.</span><p><ol type="a"><li><p>Run the <a href="cmdqueryname=probe-failtimes"><b><span class="cmdname">probe-failtimes</span></b></a> <i><span class="varname">failTimes</span></i> command to configure the device to send trap messages to the NMS after the number of consecutive probe failures in an NQA test reaches the specified threshold.</p>
</li><li><p>Run the <a href="cmdqueryname=test-failtimes"><b><span class="cmdname">test-failtimes</span></b></a> <i><span class="varname">failTimes</span></i> command to configure the device to send trap messages to the NMS after the number of consecutive NQA test failures reaches the specified threshold.</p>
</li><li>Run the <a href="cmdqueryname=threshold"><b><span class="cmdname">threshold</span></b></a> <strong><span>rtd</span></strong> <i><span class="varname">thresholdRtd</span></i> command to configure a round-trip delay (RTD) threshold.</li><li>Run the <a href="cmdqueryname=send-trap"><b><span class="cmdname">send-trap</span></b></a> { <strong><span>all</span></strong> | { <strong><span>rtd</span></strong> | <strong><span>testfailure</span></strong><span> | <strong><span>probefailure</span></strong> | <strong><span>testcomplete</span></strong></span> | <strong><span>testresult-change</span></strong> }<sup>*</sup> } command to configure conditions for sending trap messages.</li></ol>
</p></li><li><span>Schedule the NQA test instance.</span><ol type="a"><li class="substepexpand"><span>(Optional) Run the <a href="cmdqueryname=frequency"><b><span class="cmdname">frequency</span></b></a> <i><span class="varname">frequencyValue</span></i> command to configure the interval at which the NQA test instance is automatically executed.</span></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=start"><b><span class="cmdname">start</span></b></a> command to start the NQA test instance.</span><p><p>The <a href="cmdqueryname=start"><b><span class="cmdname">start</span></b></a> command has multiple formats. Choose one of the following as needed.</p>
<ul><li><p>To start an NQA test instance immediately, run the <a href="cmdqueryname=start+now"><b><span class="cmdname">start now</span></b></a> [ <strong><span>end</span></strong> { <strong><span>at</span></strong> [ <i><span class="varname">yyyy</span></i>/<i><span class="varname">mm</span></i>/<i><span class="varname">dd</span></i> ] <i><span class="varname">hh</span></i>:<i><span class="varname">mm</span></i>:<i><span class="varname">ss</span></i> | <strong><span>delay</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh</span></i>:<i><span class="varname">mm</span></i>:<i><span class="varname">ss</span></i> } | <strong><span>lifetime</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh</span></i>:<i><span class="varname">mm</span></i>:<i><span class="varname">ss</span></i> } } ] command.</p>
</li><li><p>To start an NQA test instance at a specified time, run the <a href="cmdqueryname=start"><b><span class="cmdname">start</span></b></a> <strong><span>at</span></strong> [ <i><span class="varname">yyyy/mm/dd</span></i> ] <i><span class="varname">hh:mm:ss</span></i> [ <strong><span>end</span></strong> { <strong><span>at</span></strong> [ <i><span class="varname">yyyy/mm/dd</span></i> ] <i><span class="varname">hh:mm:ss</span></i> | <strong><span>delay</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh:mm:ss</span></i> } | <strong><span>lifetime</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh:mm:ss</span></i> } } ] command.</p>
</li><li><p>To start an NQA test instance after a specified delay, run the <a href="cmdqueryname=start+delay"><b><span class="cmdname">start delay</span></b></a> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh</span></i>:<i><span class="varname">mm</span></i>:<i><span class="varname">ss</span></i> } [ <strong><span>end</span></strong> { <strong><span>at</span></strong> [ <i><span class="varname">yyyy</span></i>/<i><span class="varname">mm</span></i>/<i><span class="varname">dd</span></i> ] <i><span class="varname">hh</span></i>:<i><span class="varname">mm</span></i>:<i><span class="varname">ss</span></i> | <strong><span>delay</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh</span></i>:<i><span class="varname">mm</span></i>:<i><span class="varname">ss</span></i> } | <strong><span>lifetime</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh</span></i>:<i><span class="varname">mm</span></i>:<i><span class="varname">ss</span></i> } } ] command.</p>
</li><li><p>To start an NQA test instance at a specified time every day, run the <a href="cmdqueryname=start"><b><span class="cmdname">start</span></b></a> <strong><span>daily</span></strong> <i><span class="varname">hh:mm:ss</span></i> <strong><span>to</span></strong> <i><span class="varname">hh:mm:ss</span></i> [ <strong><span>begin</span></strong> <i><span class="varname">yyyy/mm/dd</span></i> ] [ <strong><span>end</span></strong> <i><span class="varname">yyyy/mm/dd</span></i> ] command.</p>
</li></ul>
</p></li></ol>
</li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nqa_cfg_0039.html">Configuring NQA to Monitor a VPN
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nqa_cfg_0044.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nqa_cfg_0045.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>