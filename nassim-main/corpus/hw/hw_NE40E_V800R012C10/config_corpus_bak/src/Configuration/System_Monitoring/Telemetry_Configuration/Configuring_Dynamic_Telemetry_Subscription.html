
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Dynamic Telemetry Subscription">
<meta name="abstract" content="In dynamic telemetry subscription, a collector functioning as a client initiates a connection to a device functioning as a server, and the device collects and reports data.">
<meta name="description" content="In dynamic telemetry subscription, a collector functioning as a client initiates a connection to a device functioning as a server, and the device collects and reports data.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_telemetry_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_telemetry_cfg_00195.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_telemetry_cfg_0019.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Telemetry">
<meta name="featuretype" content="System Monitor">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Telemetry">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="Telemetry">
<meta name="featuretype" content="System Monitor">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="c00511010">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0139427981">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Dynamic Telemetry Subscription</title>
</head>
<body><a name="EN-US_TASK_0139427981"></a><a name="EN-US_TASK_0139427981"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Dynamic Telemetry Subscription</h1>
<div class="taskbody"><p>In dynamic telemetry subscription, a collector functioning as a client initiates a connection to a device functioning as a server, and the device collects and reports data. </p>
<div class="context"><a name="EN-US_TASK_0139427981__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The dynamic subscription capability based on the YANG-Push model is provided by NETCONF. For details, see "YANG Push" in <span><i><cite><span class="keyword">HUAWEI NE40E-M2 series</span> Product Documentation </cite></i></span> &gt; Feature Description &gt; System Management &gt; NETCONF Description. The following configuration process about dynamic telemetry subscription is based on the OpenConfig model.</p>
</div></div>
<p>A collector functioning as a client initiates a connection to a device functioning as a server. To dynamically subscribe to the sampled data, you need to configure the source IP address and number of the port to be listened for, and enable the gRPC service. gRPC can be used as the protocol to send data.</p>
<p>If the connection where dynamic telemetry subscription resides is interrupted, the device automatically cancels the subscription and stops data sampling and reporting. The configuration cannot be restored unless the collector sends a connection request again. For example, if a user wants to monitor an interface for a period of time, dynamic telemetry subscription can be configured. To stop monitoring, tear down the connection. The subscription is automatically canceled and cannot be restored. This avoids long-term loads on devices and simplifies the interaction between users and devices.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0139427981__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring dynamic telemetry subscription, complete the following tasks:</p>
<ul><li><p>Configure a dynamic routing protocol or static routes to ensure that devices can communicate at the network layer.</p>
</li><li>Create a local user, add the user to the administrator group, and configure the service type of the user.</li><li><p>Create an ACL if it is needed for the gRPC service to control which clients can connect to the server. For details about how to create an ACL, see <span>"ACL Configuration" in Configuration Guide &gt; IP Services</span>.</p>
</li><li><p>Create an SSL policy if it is needed for the gRPC service so that a secure SSL connection can be established between the server and client. For details about how to create an SSL policy, see <span>"Configuring and Binding an SSL Policy" in <em>Configuration Guide &gt; Basic Configuration &gt; Accessing Other Devices Configuration</em></span>.</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0139427981__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=grpc"><b><span class="cmdname">grpc</span></b></a></span></span><p><p>The gRPC view is displayed.</p>
</p></li><li><span>(Optional) Based on the collector type, run either of the following commands to enter the corresponding server view:</span><p><ul><li>For an IPv4 collector, run the <a href="cmdqueryname=grpc+server"><b><span class="cmdname">grpc server</span></b></a> command to enter the gRPC server view.</li><li>For an IPv6 collector, run the <a href="cmdqueryname=grpc+server+ipv6"><b><span class="cmdname">grpc server ipv6</span></b></a> command to enter the gRPC IPv6 server view.</li></ul>
</p></li><li><span>Run <a href="cmdqueryname=source-ip"><b><span class="cmdname">source-ip</span></b></a> <i><span class="varname">ip-address</span></i> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ]</span><p><p>The source IP address to be listened for during dynamic telemetry subscription is configured.</p>
</p><p></p></li><li><span>(Optional) Run <a href="cmdqueryname=compression+gzip"><b><span class="cmdname">compression gzip</span></b></a></span><p><p>The gRPC server is configured to transmit data in gzip compression mode.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=server-port"><b><span class="cmdname">server-port</span></b></a> <i><span class="varname">port-number</span></i></span><p><p>The number of the port to be listened for during dynamic telemetry subscription is set.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=acl"><b><span class="cmdname">acl</span></b></a> { <i><span class="varname">acl-name</span></i> | <i><span class="varname">acl-number</span></i> }</span></span><p><p>An ACL is configured for the gRPC service during dynamic telemetry subscription.</p>
</p><p></p></li><li><span>(Optional) Run <a href="cmdqueryname=idle-timeout"><b><span class="cmdname">idle-timeout</span></b></a> <i><span class="varname">time</span></i></span><p><p>An idle timeout period is configured for the gRPC service during dynamic telemetry subscription.</p>
</p><p></p></li><li><span>(Optional) Run <a href="cmdqueryname=ssl-policy"><b><span class="cmdname">ssl-policy</span></b></a> <i><span class="varname">ssl-policy-name</span></i></span><p><p>An SSL policy is configured for the gRPC service during dynamic telemetry subscription.</p>
</p><p></p></li><li><span>(Optional) Run <span><a href="cmdqueryname=ssl-verify+peer"><b><span class="cmdname">ssl-verify peer</span></b></a></span></span><p><p>The server is configured to perform SSL verification on a client during dynamic telemetry subscription.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=dscp"><b><span class="cmdname">dscp</span></b></a> <i><span class="varname">value</span></i></span><p><p>A DSCP value is set for data packets to be sent.</p>
</p></li><li><span>Run <a href="cmdqueryname=server+enable"><b><span class="cmdname">server enable</span></b></a></span><p><p>The gRPC service is enabled.</p>
</p></li><li><span>(Optional) Configure a maximum usage for the main control board's CPU used when telemetry collects data.</span><p><ol type="a"><li><p>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></p>
<p>Return to the gRPC view.</p>
</li><li><p>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></p>
<p>Return to the system view.</p>
</li><li><p>Run <a href="cmdqueryname=telemetry"><b><span class="cmdname">telemetry</span></b></a> [ <strong><span>openconfig</span></strong> ]</p>
<p>The telemetry view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=cpu-usage+max-percent"><b><span class="cmdname">cpu-usage max-percent</span></b></a> <i><span class="varname">usage</span></i></p>
<p>A maximum usage is configured for the amount of CPU resources the main control board occupies when telemetry collects data.</p>
</li></ol>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command is supported only by the admin VS.</p>
</div></div>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0139427981__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After the preceding configurations are performed and the collector delivers the sampled data, verify the configuration.</p>
<p>Run the <a href="cmdqueryname=display+telemetry+dynamic-subscription"><b><span class="cmdname">display telemetry dynamic-subscription</span></b></a> [ <i><span class="varname">subName</span></i> ] command to check the dynamic subscription information.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_telemetry_cfg_0001.html">Telemetry Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_telemetry_cfg_00195.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_telemetry_cfg_0019.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>