
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Performance Measurement Based on Static IFIT Flows with the IFIT Header Encapsulated into the DOH on an SRv6 Network">
<meta name="abstract" content="This section describes how to configure performance measurement based on static IFIT flows with the IFIT header encapsulated into the DOH on an SRv6 network.">
<meta name="description" content="This section describes how to configure performance measurement based on static IFIT flows with the IFIT header encapsulated into the DOH on an SRv6 network.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ifit_cfg_0021_02.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ifit_cfg_0031.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IFIT">
<meta name="featuretype" content="System Monitor">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IFIT">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="IFIT">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="IFIT">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="IFIT">
<meta name="featuretype" content="System Monitor">
<meta name="OWNER" content="c00511010">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="c00511010">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001232913654">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring Performance Measurement Based on Static IFIT Flows with the IFIT Header Encapsulated into the DOH on an SRv6 Network</title>
</head>
<body><a name="EN-US_TASK_0000001232913654"></a><a name="EN-US_TASK_0000001232913654"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Performance Measurement Based on Static IFIT Flows with the IFIT Header Encapsulated into the DOH on an SRv6 Network</h1>
<div class="taskbody"><p>This section describes how to configure performance measurement based on static IFIT flows with the IFIT header encapsulated into the DOH on an SRv6 network.</p>
<div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001232913654__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>When an IFIT instance with Header Type being 16 is configured, each SRv6 SID node (including SRv6 BE ingress and egress) must be able to identify the DOH and SRH in packets. Otherwise, traffic will be interrupted (for example, some nodes do not support IFIT instances with Header Type being 16). To use new functions related to IFIT instances with Header Type being 16, upgrade SRv6 SID nodes on the network to versions that support this type of instance in an end-to-end manner.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001232913654__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Static IFIT flows with the IFIT header encapsulated into the DOH can be generated in many modes, including those generated based on 5-tuple, peer,  and multicast information. After creating a static IFIT flow, you can select end-to-end or hop-by-hop measurement as required. <a href="#EN-US_TASK_0000001232913654__fig339555465014">Figure 1</a> shows the typical networking of performance measurement based on a static IFIT flow. The target flow enters the transit network through <span class="keyword">Device</span>A, traverses <span class="keyword">Device</span>B, and leaves the transit network through <span class="keyword">Device</span>C.</p>
<ul><li>End-to-end measurement: To monitor transit network performance in real time or diagnose faults, configure IFIT end-to-end measurement on both <span class="keyword">Device</span>A and <span class="keyword">Device</span>C.</li><li>Hop-by-hop measurement: To measure the packet loss and delay hop by hop for fault locating when a performance fault occurs on the transit network, configure hop-by-hop measurement on <span class="keyword">Device</span>A, <span class="keyword">Device</span>B, and <span class="keyword">Device</span>C.</li></ul>
<div class="fignone" id="EN-US_TASK_0000001232913654__fig339555465014"><a name="EN-US_TASK_0000001232913654__fig339555465014"></a><a name="fig339555465014"></a><span class="figcap"><b>Figure 1 </b>Performance measurement based on static IFIT flows</span><br><span><img class="vsd" src="figure/en-us_image_0000001386386516.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001232913654__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=ifit"><b><span class="cmdname">ifit</span></b></a></span><p><p>IFIT is enabled globally, and its view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=node-id"><b><span class="cmdname">node-id</span></b></a> <i><span class="varname">node-id</span></i></span><p><p>A node ID is configured.</p>
</p><p><p>Only steps 1 to 3 need to be configured on <span class="keyword">Device</span>B and <span class="keyword">Device</span>C that function as the transit node and egress, respectively.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=measure+disable"><b><span class="cmdname">measure disable</span></b></a></span><p><p>Global IFIT measurement is disabled.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=decapsulation+peer-locator"><b><span class="cmdname">decapsulation peer-locator</span></b></a> <i><span class="varname">locator-ipv6-prefix</span></i> <i><span class="varname">locator-prefix-length</span></i></span><p><p>The device is enabled to remove the IFIT header from packets destined for a specified next-hop locator.</p>
</p><p><p>In SRv6 HoVPN-based interworking scenarios, to ensure that the IFIT header is not carried in packets across domains in an E2E manner, you can perform this step on inter-domain devices to terminate IFIT packets within a domain. This allows the NMS to display statistics in a unified manner.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=clock-source"><b><span class="cmdname">clock-source</span></b></a> { <strong><span>ntp</span></strong> | <strong><span>auto</span></strong> }</span><p><p>The clock source for IFIT measurement is set to NTP or is automatically selected.</p>
</p><p><p>By default, the clock source is automatically selected. In this mode, the high-precision clock source is preferentially selected. This step allows you to manually select a clock type in order to cope with measurement failures caused by asynchronous clocks in cross-domain interconnection scenarios where multiple clock protocols are deployed. In addition, you can run the <a href="cmdqueryname=period-clock-mode"><b><span class="cmdname">period-clock-mode</span></b></a> { <strong><span>ptp</span></strong> <strong><span>current-leap</span></strong> <i><span class="varname">current-leap-value</span></i> [ { <strong><span>leap59</span></strong> | <strong><span>leap61</span></strong> } <strong><span>date</span></strong> <i><span class="varname">utc-date</span></i> ] } command to configure a timing mode for the IFIT measurement interval and timestamp sampling.</p>
</p></li><li><span>Run <a href="cmdqueryname=instance-ht16"><b><span class="cmdname">instance-ht16</span></b></a><strong> </strong><i><span class="varname">instance-id</span></i></span><p><p>An IFIT instance with Header Type being 16 is created, and its view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=measure-mode"><b><span class="cmdname">measure-mode</span></b></a> { <strong><span>e2e</span></strong> | <strong><span>trace</span></strong> }</span><p><p>The IFIT measurement mode is set to end-to-end or hop-by-hop.</p>
</p><p><p>By default, end-to-end measurement is used. In multicast flow measurement scenarios, only end-to-end measurement is supported.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=interval"><b><span class="cmdname">interval</span></b></a> <i><span class="varname">interval-value</span></i></span><p><p>A measurement interval is set for the IFIT instance.</p>
</p></li><li><span>Run different commands to create static IFIT flows based on service scenarios, as described in <a href="#EN-US_TASK_0000001232913654__table1026131313513">Table 1</a>.</span><p>
<div class="tableBorder"><a name="EN-US_TASK_0000001232913654__table1026131313513"></a><a name="table1026131313513"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0000001232913654__table1026131313513" width="90%" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Creating static IFIT flows in different service scenarios</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="24.98%" id="mcps1.4.3.10.2.1.2.4.1.1" liSelected="liSelected"><p>Service Scenario</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="45.019999999999996%" id="mcps1.4.3.10.2.1.2.4.1.2" liSelected="liSelected"><p>Command</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="30%" id="mcps1.4.3.10.2.1.2.4.1.3" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="24.98%" headers="mcps1.4.3.10.2.1.2.4.1.1 "><p>L3VPNv4/EVPN L3VPNv4 (HVPN)</p>
</td>
<td class="cellrowborder" valign="top" width="45.019999999999996%" headers="mcps1.4.3.10.2.1.2.4.1.2 "><p><a href="cmdqueryname=flow"><b><span class="cmdname">flow</span></b></a> <strong><span>unidirectional</span></strong> <strong><span>source</span></strong> { <i><span class="varname">source-ip</span></i> [ <i><span class="varname">source-mask</span></i> ] | <strong><span>any</span></strong> } <strong><span>destination</span></strong> { <i><span class="varname">destination-ip</span></i> [ <i><span class="varname">destination-mask</span></i> ] | <strong><span>any</span></strong> } [ <strong><span>protocol</span></strong> { { <strong><span>tcp</span></strong> | <strong><span>udp</span></strong> | <strong><span>sctp</span></strong> | <i><span class="varname">protocol-number4</span></i> | <i><span class="varname">protocol-number5</span></i> | <i><span class="varname">protocol-number6</span></i> } [ <strong><span>source-port</span></strong> <i><span class="varname">source-port</span></i> ] [ <strong><span>destination-port</span></strong> <i><span class="varname">destination-port</span></i> ] | { <i><span class="varname">protocol-number</span></i> | <i><span class="varname">protocol-number7</span></i> | <i><span class="varname">protocol-number8</span></i> | <i><span class="varname">protocol-number3</span></i> } } <span>]</span> [ <span><strong><span>dscp</span></strong></span> <i><span class="varname">dscp-value</span></i> ] [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ]</p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="mcps1.4.3.10.2.1.2.4.1.3 "><p>Create a static IFIT flow based on 5-tuple information.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="24.98%" headers="mcps1.4.3.10.2.1.2.4.1.1 "><p>L3VPNv6/EVPN L3VPNv6 (HVPN)</p>
</td>
<td class="cellrowborder" valign="top" width="45.019999999999996%" headers="mcps1.4.3.10.2.1.2.4.1.2 "><p><a href="cmdqueryname=flow"><b><span class="cmdname">flow</span></b></a> <strong><span>unidirectional</span></strong> <strong><span>source-ipv6</span></strong> { <i><span class="varname">src-ipv6-address</span></i> [ <i><span class="varname">src6-mask-length</span></i> ] | <strong><span>any</span></strong> } <strong><span>destination-ipv6</span></strong> { <i><span class="varname">dest-ipv6-address</span></i> [ <i><span class="varname">dest6-mask-length</span></i> ] | <strong><span>any</span></strong> } [ <strong><span>protocol</span></strong> { { <strong><span>tcp</span></strong> | <strong><span>udp</span></strong> | <strong><span>sctp</span></strong> | <i><span class="varname">protocol-number4</span></i> | <i><span class="varname">protocol-number5</span></i> | <i><span class="varname">protocol-number6</span></i> } [ <strong><span>source-port</span></strong> <i><span class="varname">source-port</span></i> ] [ <strong><span>destination-port</span></strong> <i><span class="varname">destination-port</span></i> ] | { <i><span class="varname">protocol-number</span></i> | <i><span class="varname">protocol-number7</span></i> | <i><span class="varname">protocol-number8</span></i> | <i><span class="varname">protocol-number3</span></i> } } <span>]</span> [ <span><strong><span>dscp</span></strong></span> <i><span class="varname">dscp-value</span></i> ] [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ]</p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="mcps1.4.3.10.2.1.2.4.1.3 "><p>Create a static IFIT flow based on 5-tuple information.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="24.98%" headers="mcps1.4.3.10.2.1.2.4.1.1 "><p>IPv4 public network</p>
</td>
<td class="cellrowborder" valign="top" width="45.019999999999996%" headers="mcps1.4.3.10.2.1.2.4.1.2 "><p><a href="cmdqueryname=flow"><b><span class="cmdname">flow</span></b></a> <strong><span>unidirectional</span></strong> <strong><span>source</span></strong> { <i><span class="varname">source-ip</span></i> [ <i><span class="varname">source-mask</span></i> ] | <strong><span>any</span></strong> } <strong><span>destination</span></strong> { <i><span class="varname">destination-ip</span></i> [ <i><span class="varname">destination-mask</span></i> ] | <strong><span>any</span></strong> } [ <strong><span>protocol</span></strong> { { <strong><span>tcp</span></strong> | <strong><span>udp</span></strong> | <strong><span>sctp</span></strong> | <i><span class="varname">protocol-number4</span></i> | <i><span class="varname">protocol-number5</span></i> | <i><span class="varname">protocol-number6</span></i> } [ <strong><span>source-port</span></strong> <i><span class="varname">source-port</span></i> ] [ <strong><span>destination-port</span></strong> <i><span class="varname">destination-port</span></i> ] | { <i><span class="varname">protocol-number</span></i> | <i><span class="varname">protocol-number7</span></i> | <i><span class="varname">protocol-number8</span></i> | <i><span class="varname">protocol-number3</span></i> } } <span>]</span> [ <span><strong><span>dscp</span></strong></span> <i><span class="varname">dscp-value</span></i> ]</p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="mcps1.4.3.10.2.1.2.4.1.3 "><p>Create a static IFIT flow based on 5-tuple information.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="24.98%" headers="mcps1.4.3.10.2.1.2.4.1.1 "><p>IPv6 public network</p>
</td>
<td class="cellrowborder" valign="top" width="45.019999999999996%" headers="mcps1.4.3.10.2.1.2.4.1.2 "><p><a href="cmdqueryname=flow"><b><span class="cmdname">flow</span></b></a> <strong><span>unidirectional</span></strong> <strong><span>source-ipv6</span></strong> { <i><span class="varname">src-ipv6-address</span></i> [ <i><span class="varname">src6-mask-length</span></i> ] | <strong><span>any</span></strong> } <strong><span>destination-ipv6</span></strong> { <i><span class="varname">dest-ipv6-address</span></i> [ <i><span class="varname">dest6-mask-length</span></i> ] | <strong><span>any</span></strong> } [ <strong><span>protocol</span></strong> { { <strong><span>tcp</span></strong> | <strong><span>udp</span></strong> | <strong><span>sctp</span></strong> | <i><span class="varname">protocol-number4</span></i> | <i><span class="varname">protocol-number5</span></i> | <i><span class="varname">protocol-number6</span></i> } [ <strong><span>source-port</span></strong> <i><span class="varname">source-port</span></i> ] [ <strong><span>destination-port</span></strong> <i><span class="varname">destination-port</span></i> ] | { <i><span class="varname">protocol-number</span></i> | <i><span class="varname">protocol-number7</span></i> | <i><span class="varname">protocol-number8</span></i> | <i><span class="varname">protocol-number3</span></i> } } <span>]</span> [ <span><strong><span>dscp</span></strong></span> <i><span class="varname">dscp-value</span></i> ]</p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="mcps1.4.3.10.2.1.2.4.1.3 "><p>Create a static IFIT flow based on 5-tuple information.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="24.98%" headers="mcps1.4.3.10.2.1.2.4.1.1 "><p>MVPNv4/GTMv4</p>
</td>
<td class="cellrowborder" valign="top" width="45.019999999999996%" headers="mcps1.4.3.10.2.1.2.4.1.2 "><p><a href="cmdqueryname=flow"><b><span class="cmdname">flow</span></b></a> <strong><span>unidirectional</span></strong><strong> <strong><span>source</span></strong> </strong><i><span class="varname">source-address</span></i><strong> </strong><strong><span>group</span></strong><em> </em><i><span class="varname">group-address</span></i> [ <strong><span>vpn-instance</span></strong><strong> </strong><i><span class="varname">vpn-name</span></i> ]</p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="mcps1.4.3.10.2.1.2.4.1.3 "><p>Create a static IFIT flow based on the multicast source and multicast group.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="24.98%" headers="mcps1.4.3.10.2.1.2.4.1.1 "><p>MVPNv6/GTMv6</p>
</td>
<td class="cellrowborder" valign="top" width="45.019999999999996%" headers="mcps1.4.3.10.2.1.2.4.1.2 "><p><a href="cmdqueryname=flow"><b><span class="cmdname">flow</span></b></a> <strong><span>unidirectional</span></strong><strong> <strong><span>source-ipv6</span></strong> </strong><i><span class="varname">source-ipv6-address</span></i><strong> </strong><strong><span>group-ipv6</span></strong><em> </em><i><span class="varname">group-ipv6-address</span></i> [ <strong><span>vpn-instance</span></strong><strong> </strong><i><span class="varname">vpn-name</span></i> ]</p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="mcps1.4.3.10.2.1.2.4.1.3 "><p>Create a static IFIT flow based on the multicast source and multicast group.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="24.98%" headers="mcps1.4.3.10.2.1.2.4.1.1 "><p>EVPN VPWS</p>
</td>
<td class="cellrowborder" valign="top" width="45.019999999999996%" headers="mcps1.4.3.10.2.1.2.4.1.2 "><p><a href="cmdqueryname=flow"><b><span class="cmdname">flow</span></b></a> <strong><span>unidirectional</span></strong> <strong><span>evpl-instance</span></strong> <i><span class="varname">evpl-instance-value</span></i> <strong><span>peer-locator</span></strong> <i><span class="varname">locator-ipv6-prefix</span></i> <i><span class="varname">locator-prefix-length</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="mcps1.4.3.10.2.1.2.4.1.3 "><p>Create a static IFIT flow based on the peer locator.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>Static IFIT flows based on DOH encapsulation support only SRv6 tunnels. Because tunnel types cannot be distinguished based on the configured 5-tuple, IFIT does not take effect for unsupported tunnel types.</li><li>In multicast flow measurement scenarios, the <strong><span>vpn-instance</span></strong><strong> </strong><i><span class="varname">vpn-name</span></i> keyword applies only to MVPN scenarios, not to GTM scenarios.</li></ul>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=binding+interface"><b><span class="cmdname">binding interface</span></b></a><strong> </strong>{ <i><span class="varname">interface-type</span></i><em> </em><i><span class="varname">interface-number</span></i> | <i><span class="varname">interface-name</span></i> }</span><p><p>The IFIT flow is bound to an interface.</p>
</p><p><p>Different IFIT instances can be configured with the same flow characteristics, but cannot be bound to the same interface.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=measure+disable"><b><span class="cmdname">measure disable</span></b></a></span><p><p>Measurement is disabled for an IFIT instance.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=delay-measure+enable"><b><span class="cmdname">delay-measure enable</span></b></a></span><p><p>Delay measurement is enabled.</p>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ifit_cfg_0021_02.html">Configuring Performance Measurement based on Static IFIT Flows
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ifit_cfg_0031.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>