
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring an Aggregation Mode for IPv4 Flows">
<meta name="abstract" content="Configuring an aggregation mode is to specify an attribute type for original flows to be aggregated. An aggregation mode must be specified before original flows with the same attributes are aggregated as one flow and output to the NetStream Collector (NSC).">
<meta name="description" content="Configuring an aggregation mode is to specify an attribute type for original flows to be aggregated. An aggregation mode must be specified before original flows with the same attributes are aggregated as one flow and output to the NetStream Collector (NSC).">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0010.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0044.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0012.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="NetStream">
<meta name="featuretype" content="System Monitor">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NetStream">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="NetStream">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="Netstream">
<meta name="featuretype" content="System Monitor">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00799643">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172372959">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring an Aggregation Mode for IPv4 Flows</title>
</head>
<body><a name="EN-US_TASK_0172372959"></a><a name="EN-US_TASK_0172372959"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring an Aggregation Mode for IPv4 Flows</h1>
<div class="taskbody"><p>Configuring an aggregation mode is to specify an attribute type for original flows to be aggregated. An aggregation mode must be specified before original flows with the same attributes are aggregated as one flow and output to the NetStream Collector (NSC).</p>
<div class="steps"><a name="EN-US_TASK_0172372959__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=ip+netstream+aggregation"><b><span class="cmdname">ip netstream aggregation</span></b></a></span> { <strong><span>as</span></strong> | <strong><span>as-tos</span></strong> | <strong><span>bgp-nexthop-tos</span></strong> | <strong><span>destination-prefix</span></strong> | <strong><span>destination-prefix-tos</span></strong> | <strong><span>index-tos</span></strong> | <strong><span>mpls-label</span></strong> | <strong><span>prefix</span></strong> | <strong><span>prefix-tos</span></strong> | <strong><span>protocol-port</span></strong> | <strong><span>protocol-port-tos</span></strong> | <strong><span>source-prefix</span></strong> | <strong><span>source-prefix-tos</span></strong><span> | <strong><span>source-index-tos</span></strong> | <strong><span>vlan-id</span></strong></span><span> | <strong><span>bgp-community</span></strong></span><span>  | <strong><span>vni-sip-dip</span></strong></span> }</span><p><p>The aggregation configuration mode view is displayed.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the NetStream flow aggregation function is enabled on a device, the device classifies and aggregates original flows based on specified rules and sends the aggregated flows to the NetStream Data Analyzer (NDA) for analysis. Aggregating original flows can significantly reduce the consumption of network bandwidth, CPU, and memory resources. Flow attributes based on which flows are aggregated vary according to flow aggregation modes.</p>
</div></div>
<div class="p">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Mapping between aggregation modes and flow attributes</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="32.440000000000005%" id="mcps1.4.1.2.3.2.1.2.3.1.1" liSelected="liSelected"><p>Aggregation mode</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="67.56%" id="mcps1.4.1.2.3.2.1.2.3.1.2" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>as</p>
</td>
<td class="cellrowborder" valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>NetStream combines flows with the same source AS number, destination AS number, inbound interface index, and outbound interface index into an aggregated flow and generates one aggregation record.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>as-tos</p>
</td>
<td class="cellrowborder" valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>NetStream combines flows with the same source AS number, destination AS number, inbound interface index, outbound interface index, and type of service (ToS) into an aggregated flow and generates one aggregation record.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>bgp-nexthop-tos</p>
</td>
<td class="cellrowborder" valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>NetStream combines flows with the same destination AS number, source AS number, BGP next hop, inbound interface index, and outbound interface index into an aggregated flow and generates one aggregation record.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>destination-prefix</p>
</td>
<td class="cellrowborder" valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>NetStream combines flows with the same destination AS number, destination mask length, destination prefix, and outbound interface index into an aggregated flow and generates one aggregation record.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>destination-prefix-tos</p>
</td>
<td class="cellrowborder" valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>NetStream combines flows with the same destination AS number, destination mask length, destination prefix, ToS, and outbound interface index into an aggregated flow and generates one aggregation record.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>index-tos</p>
</td>
<td class="cellrowborder" valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>NetStream combines flows with the same inbound interface index, outbound interface index, and ToS into an aggregated flow and generates one aggregation record.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>mpls-label</p>
</td>
<td class="cellrowborder" valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>Indicates the MPLS label aggregation, which aggregates flows with the same first layer label, second layer label, third layer label, TopLabelIpAddress, stack bottom symbol of the first layer label, and the EXP value of the first layer label.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>prefix</p>
</td>
<td class="cellrowborder" valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>NetStream combines flows with the same source AS number, destination AS number, source mask length, destination mask length, source prefix, destination prefix, inbound interface index, and outbound interface index into an aggregated flow and generates one aggregation record.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>prefix-tos</p>
</td>
<td class="cellrowborder" valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>NetStream combines flows with the same source AS number, destination AS number, source mask length, destination mask length, source prefix, destination prefix, ToS, inbound interface index, and outbound interface index into an aggregated flow and generates one aggregation record.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>protocol-port</p>
</td>
<td class="cellrowborder" valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>NetStream combines flows with the same protocol number, source port, and destination port into an aggregated flow and generates one aggregation record.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>protocol-port-tos</p>
</td>
<td class="cellrowborder" valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>NetStream combines flows with the same protocol number, source port, destination port, ToS, inbound interface index, and outbound interface index into an aggregated flow and generates one aggregation record.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>source-prefix</p>
</td>
<td class="cellrowborder" valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>NetStream combines flows with the same source AS number, source mask length, source prefix, and inbound interface index into an aggregated flow and generates one aggregation record.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>source-prefix-tos</p>
</td>
<td class="cellrowborder" valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>NetStream combines flows with the same source AS number, source mask length, source prefix, ToS, and inbound interface index into an aggregated flow and generates one aggregation record.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>source-index-tos</p>
</td>
<td class="cellrowborder" char="." valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>NetStream combines flows with the same inbound interface index, ToS and BGP next hop into an aggregated flow and generates one aggregation record.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>vlan-id</p>
</td>
<td class="cellrowborder" char="." valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>NetStream combines flows with the same VLAN ID and inbound interface index into an aggregated flow and generates one aggregation record.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>bgp-community</p>
</td>
<td class="cellrowborder" char="." valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>NetStream combines flows with the same inbound and outbound interface indexes and BGP community into an aggregated flow generates one aggregation record.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.440000000000005%" headers="mcps1.4.1.2.3.2.1.2.3.1.1 "><p>vni-sip-dip</p>
</td>
<td class="cellrowborder" char="." valign="top" width="67.56%" headers="mcps1.4.1.2.3.2.1.2.3.1.2 "><p>Indicates a VNI aggregation mode. NetStream combines flows with the same VNI ID and the same source and destination IP addresses of tenants into an aggregated flow and generates one aggregation record.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</p></li><li><span>Run <a href="cmdqueryname=enable"><b><span class="cmdname">enable</span></b></a></span><p><p>Statistics collection of flows aggregated in a specified aggregation mode is enabled.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=mask"><b><span class="cmdname">mask</span></b></a> { <strong><span>source</span></strong> | <strong><span>destination</span></strong> } <strong><span>minimum</span></strong> <i><span class="varname">mask-length</span></i></span><p><p>The length of the aggregate mask is set. The effective mask is the greater one between the mask in the FIB table and the configured mask. If no aggregate mask is set, the system uses the mask in the FIB table for flow aggregation.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The aggregate mask takes effect only on flows aggregated in the following modes: destination-prefix, destination-prefix-tos, prefix, prefix-tos, source-prefix, and source-prefix-tos.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0010.html">Collecting Statistics About IPv4 Aggregated Flows
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0044.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0012.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>