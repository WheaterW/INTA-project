
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Bit-Error-Triggered Section Switching">
<meta name="abstract" content="This section provides an example for configuring bit-error-triggered section switching.">
<meta name="description" content="This section provides an example for configuring bit-error-triggered section switching.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_error-code_000010.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_error-code_000022.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909,m00390128,q00824768,z00545680">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Bit-Error-Triggered Protection Switching">
<meta name="featuretype" content="Network Reliability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Bit-Error-Triggered Protection Switching">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Bit-Error-Triggered Protection Switching">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Bit-Error-Triggered Protection Switching">
<meta name="featuretype" content="Network Reliability">
<meta name="OWNER" content="z00545680">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00800033">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172362290">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring Bit-Error-Triggered Section Switching</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172362290"></a><a name="EN-US_TASK_0172362290"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Bit-Error-Triggered Section Switching</h1>
<div class="taskbody"><p>This section provides an example for configuring bit-error-triggered section switching. </p>
<div class="context"><a name="EN-US_TASK_0172362290__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0172362290__fig_dc_ne_cfg_error-code_00001601">Figure 1</a>, an LDP LSP is deployed between the user provider edge (UPE) and superstratum provider edge (SPE), and LDP auto fast reroute (FRR) is configured. The primary and backup paths of the LDP LSP are UPE &lt;-&gt; SPE and UPE &lt;-&gt; P &lt;-&gt; SPE, respectively. In normal circumstances, traffic between the UPE and SPE travels along the primary path.</p>
<p>If a bit error event occurs on GE<span>0/1/1</span> of the UPE, traffic traveling along the primary path is affected. To resolve this problem, configure bit-error-triggered section switching. Then, if GE<span>0/1/1</span> on the UPE encounters a bit error event and goes down, Interior Gateway Protocol (IGP) routes converge, triggering the LDP LSP to switch to the backup path.</p>
<div class="fignone" id="EN-US_TASK_0172362290__fig_dc_ne_cfg_error-code_00001601"><a name="EN-US_TASK_0172362290__fig_dc_ne_cfg_error-code_00001601"></a><a name="fig_dc_ne_cfg_error-code_00001601"></a><span class="figcap"><b>Figure 1 </b>Networking diagram for bit-error-triggered LDP LSP switching</span><br><span><img class="vsd" src="images/fig_dc_ne_cfg_error-code_00001601.png" width="NaN" height="NaN"></span></div>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 and interface2 represent GE<span>0/1/0</span> and GE<span>0/1/1</span>, respectively.</p>
</div></div>

<div class="tableBorder"><a name="EN-US_TASK_0172362290__tab_01"></a><a name="tab_01"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172362290__tab_01" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Interface IP address list</caption><thead align="left"><tr><th align="left" class="cellrowborder" char="." valign="top" width="33.33333333333333%" id="mcps1.4.1.6.2.4.1.1" liSelected="liSelected"><p>Device</p>
</th>
<th align="left" class="cellrowborder" char="." valign="top" width="33.33333333333333%" id="mcps1.4.1.6.2.4.1.2" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" char="." valign="top" width="33.33333333333333%" id="mcps1.4.1.6.2.4.1.3" liSelected="liSelected"><p>IP Address</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="3" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.2.4.1.1 "><p>UPE</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.2.4.1.2 "><p>GE<span>0/1/0</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.2.4.1.3 "><p>10.1.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.6.2.4.1.2 "><p>GE<span>0/1/1</span></p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.6.2.4.1.3 "><p>10.1.5.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.6.2.4.1.2 "><p>Loopback0</p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.6.2.4.1.3 "><p>1.1.1.1/32</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.2.4.1.1 "><p>P</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.2.4.1.2 "><p>GE<span>0/1/0</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.2.4.1.3 "><p>10.1.1.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.6.2.4.1.2 "><p>GE<span>0/1/1</span></p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.6.2.4.1.3 "><p>10.1.3.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.6.2.4.1.2 "><p>Loopback0</p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.6.2.4.1.3 "><p>2.2.2.2/32</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.2.4.1.1 "><p>SPE</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.2.4.1.2 "><p>GE<span>0/1/0</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.2.4.1.3 "><p>10.1.3.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.6.2.4.1.2 "><p>GE<span>0/1/1</span></p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.6.2.4.1.3 "><p>10.1.5.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.6.2.4.1.2 "><p>Loopback0</p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.6.2.4.1.3 "><p>4.4.4.4/32</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362290__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure an IP address and a routing protocol for each interface so that all nodes can communicate at the network layer. This example uses Open Shortest Path First (OSPF) as the routing protocol.</p>
</li><li><p>Enable BFD globally on each node.</p>
</li><li><p>Configure an LDP LSP between the UPE and SPE and configure LDP auto FRR.</p>
</li><li><p>Enable bit error detection on interfaces along the primary and backup paths of the LDP LSP, configure the switching type of each interface as trigger-section, and set the thresholds for triggering bit error event alarms.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362290__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Interface IP addresses (see <a href="#EN-US_TASK_0172362290__tab_01">Table 1</a>)</p>
</li><li><p>OSPF process ID (100) and area ID (0.0.0.0)</p>
</li><li><p>Multiprotocol Label Switching (MPLS) label switching router (LSR) IDs (Loopback0 interface IP addresses) of each node</p>
</li><li><p>Bit error alarm threshold for GE interfaces along the LDP LSP: 3 x 10<sup>-4</sup>; alarm clear threshold: 2 x 10<sup>-5</sup></p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362290__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Configuration Procedure</h4><ol><li><p>Configure interface IP addresses.</p>
<p>Configure interface IP addresses according to <a href="#EN-US_TASK_0172362290__tab_01">Table 1</a> and create a loopback interface on each node. For configuration details, see <a href="#EN-US_TASK_0172362290__section_05">Configuration Files</a> in this section.</p>
</li><li><p>Configure OSPF.</p>
<p>Configure OSPF on each node to allow the nodes to communicate at the network layer. For configuration details, see <a href="#EN-US_TASK_0172362290__section_05">Configuration Files</a> in this section.</p>
</li><li><p>Enable BFD globally.</p>
<p># Configure the UPE.</p>
<pre class="screen">&lt;UPE&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE] <strong>bfd</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-bfd] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE-bfd] <strong>quit</strong></pre>
<p>Repeat this step for the P and SPE. For configuration details, see <a href="#EN-US_TASK_0172362290__section_05">Configuration Files</a> in this section.</p>
</li><li><p>Enable MPLS and MPLS LDP on each node and the interfaces of each node.</p>
<p># Configure the UPE.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE] <strong>mpls lsr-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-mpls] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-GigabitEthernet<span>0/1/0</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-GigabitEthernet<span>0/1/1</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-GigabitEthernet<span>0/1/1</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>commit</strong></pre>
<p># Configure the P.</p>
<pre class="screen">&lt;P&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong>mpls lsr-id 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-mpls] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P] <strong>commit</strong></pre>
<p># Configure the SPE.</p>
<pre class="screen">&lt;SPE&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SPE] <strong>mpls lsr-id 4.4.4.4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE-mpls] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE-GigabitEthernet<span>0/1/0</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE-GigabitEthernet<span>0/1/1</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE-GigabitEthernet<span>0/1/1</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE] <strong>commit</strong></pre>
</li><li><p>Configure OSPF FRR.</p>
<p># Configure the UPE.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE] <strong>ospf 100</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE-ospf-100] <strong>frr</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-ospf-100-frr] <strong>loop-free-alternate</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-ospf-100-frr] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE-ospf-100-frr] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE-ospf-100] <strong>quit</strong></pre>
</li><li><p>Configure LDP auto FRR.</p>
<p># Configure the UPE.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE-mpls] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE-mpls-ldp] <strong>auto-frr lsp-trigger all</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>commit</strong></pre>
<p># Run the <a href="cmdqueryname=display+mpls+lsp"><b><span class="cmdname">display mpls lsp</span></b></a> command on the UPE to view LDP LSP configurations.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE] <strong>display mpls lsp</strong></pre>
<pre class="screen">-------------------------------------------------------------------------------
                 LSP Information: LDP LSP
-------------------------------------------------------------------------------
FEC                In/Out Label    In/Out IF                      Vrf Name
1.1.1.1/32        remote-ip 4190/NULL       -/-remote-ip
2.2.2.2/32         NULL/3          -/GE<span>0/1/0</span>
2.2.2.2/32         4191/3          -/GE<span>0/1/0</span>
   **LDP FRR**     NULL/4163       -/GE<span>0/1/1</span>
   **LDP FRR**     4191/4163       -/GE<span>0/1/1</span>
4.4.4.4/32         NULL/4161       -/GE<span>0/1/1</span>
4.4.4.4/32         4192/4161       -/GE<span>0/1/1</span>
   <strong>**LDP FRR**     NULL/4163       -/GE<span>0/1/0</span></strong>
   <strong>**LDP FRR**     4192/4163       -/GE<span>0/1/0</span></strong></pre>
</li><li><p>Enable bit error detection on interfaces along the primary and backup paths of the LDP LSP, configure the switching type of each interface as trigger-section, and set the thresholds for triggering bit error event alarms.</p>
<p># Configure the UPE.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE-GigabitEthernet<span>0/1/0</span>] <strong>trap-threshold crc-error packet-error-ratio alarm-threshold 3 4 resume-threshold 2 5 trigger-section</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-GigabitEthernet<span>0/1/1</span>] <strong>trap-threshold crc-error packet-error-ratio alarm-threshold 3 4 resume-threshold 2 5 trigger-section</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<p># Configure the P.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P-GigabitEthernet<span>0/1/0</span>] <strong>trap-threshold crc-error packet-error-ratio alarm-threshold 3 4 resume-threshold 2 5 trigger-section</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>] <strong>trap-threshold crc-error packet-error-ratio alarm-threshold 3 4 resume-threshold 2 5 trigger-section</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<p># Configure the SPE.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SPE] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SPE-GigabitEthernet<span>0/1/0</span>] <strong>trap-threshold crc-error packet-error-ratio alarm-threshold 3 4 resume-threshold 2 5 trigger-section</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE-GigabitEthernet<span>0/1/1</span>] <strong>trap-threshold crc-error packet-error-ratio alarm-threshold 3 4 resume-threshold 2 5 trigger-section</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SPE-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
</li><li><p>Verify the configuration.</p>
<p>In this example, the bit error rate (BER) detected by GE<span>0/1/1</span> on the UPE is 9 x 10<sup>-1</sup>, exceeding 3 x 10<sup>-4</sup>, the threshold for triggering an alarm indicating that a bit error event has occurred. As a result, GE <span>0/1/1</span> goes down. The status change of GE<span>0/1/1</span> triggers OSPF route convergence, which in turn triggers the LDP LSP to switch to the backup path.</p>
<p># Run the <strong>display interface GigabitEthernet <span>0/1/1</span></strong> command on the UPE. The command output shows that the link protocol status of GE <span>0/1/1</span> is <strong>DOWN(bit-error-detection down).</strong></p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE] <strong>display interface GigabitEthernet <span>0/1/1</span></strong></pre>
<pre class="screen">GigabitEthernet<span>0/1/1</span> current state : UP (ifindex: 10)  
Line protocol current state : <strong>DOWN(bit-error-detection down)</strong> 
Description: 
Route Port,The Maximum Transmit Unit is 1500
Internet Address is 10.1.5.1/24
IP Sending Frames' Format is PKTFMT_ETHNT_2, Hardware address is 00e0-fc12-7890
Loopback:none, LAN full-duplex mode, Pause Flowcontrol: Receive Enable and Send Enable
Last physical up time   : 0000-00-00 00:00:00
Last physical down time : 0000-00-00 00:00:00
Current system time: 2013-01-26 11:42:36
Statistics last cleared:2013-01-16 10:21:54
    Last 300 seconds input rate: 0 bits/sec, 0 packets/sec
    Last 300 seconds output rate: 0 bits/sec, 0 packets/sec
    Input peak rate 0 bits/sec, Record time: -
    Output peak rate 0 bits/sec, Record time: -
    Input: 0 bytes, 13522 packets
    Output: 0 bytes, 13201 packets
    Input: 
      Unicast: 1953 packets, Multicast: 11559 packets
      Broadcast: 10 packets, JumboOctets: 0 packets
      CRC: 0 packets, Symbol: 0 packets
      Overrun: 0 packets, InRangeLength: 0 packets
      LongPacket: 0 packets, Jabber: 0 packets, Alignment: 0 packets
      Fragment: 0 packets, Undersized Frame: 0 packets
      RxPause: 0 packets
    Output:     
      Unicast: 7009 packets, Multicast: 6184 packets
      Broadcast: 8 packets, JumboOctets: 0 packets
      Lost: 0 packets, Overflow: 0 packets, Underrun: 0 packets
      System: 0 packets, Overruns: 0 packets
      TxPause: 0 packets
    Last 300 seconds input utility rate:  0.00%
    Last 300 seconds output utility rate: 0.00%</pre>
<p># Run the <a href="cmdqueryname=tracert+lsp+ip+4.4.4.4+32"><b><span class="cmdname">tracert lsp ip 4.4.4.4 32</span></b></a> command on the UPE. The command output shows that the LDP LSP switched to the backup path.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE] <strong>tracert lsp ip 4.4.4.4 32</strong></pre>
<pre class="screen">  LSP Trace Route FEC: IPV4 PREFIX 4.4.4.4/32 , press CTRL_C to break.
TTL    Replier            Time    Type      Downstream
0                                 Ingress   <strong>10.1.1.2/[4163 ]</strong>
1      10.1.1.2           9       Transit   10.1.3.2/[4161 ]
2      4.4.4.4            8       Egress </pre>
</li></ol>
</div></div>
<div class="example" id="EN-US_TASK_0172362290__section_05"><a name="EN-US_TASK_0172362290__section_05"></a><a name="section_05"></a><a name="EN-US_TASK_0172362290__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>UPE configuration file</p>
<pre class="screen">#                                                                               
sysname UPE                                                                     
#
bfd
#
mpls lsr-id 1.1.1.1
#
mpls
#
mpls ldp        
 #              
 ipv4-family    
  auto-frr lsp-trigger all
#
interface GigabitEthernet<span>0/1/0</span>                                                  
 undo shutdown  
 ip address 10.1.1.1 255.255.255.0
 mpls
 mpls ldp
 trap-threshold crc-error packet-error-ratio alarm-threshold 3 4 resume-threshold 2 5 trigger-section
#                                                                               
interface GigabitEthernet<span>0/1/1</span>                                                  
 undo shutdown  
 ip address 10.1.5.1 255.255.255.0
 mpls           
 mpls ldp
 trap-threshold crc-error packet-error-ratio alarm-threshold 3 4 resume-threshold 2 5 trigger-section
#              
interface LoopBack0
 ip address 1.1.1.1 255.255.255.255
#
ospf 100        
 frr            
  loop-free-alternate
 area 0.0.0.0   
  network 1.1.1.1 0.0.0.0
  network 10.1.1.0 0.0.0.255
  network 10.1.5.0 0.0.0.255
#                                                                             
return</pre>
</li><li><p>P configuration file</p>
<pre class="screen">#                                                                               
sysname P                                                                     
#                                                                               
bfd                                                                   
#
mpls lsr-id 2.2.2.2
#
mpls
#
mpls ldp
 #
 ipv4-family
#
interface GigabitEthernet<span>0/1/0</span>                                                  
 undo shutdown  
 ip address 10.1.1.2 255.255.255.0
 mpls           
 mpls ldp
 trap-threshold crc-error packet-error-ratio alarm-threshold 3 4 resume-threshold 2 5 trigger-section
#                                                                               
interface GigabitEthernet<span>0/1/1</span>                                                  
 undo shutdown  
 ip address 10.1.3.1 255.255.255.0
 mpls           
 mpls ldp
 trap-threshold crc-error packet-error-ratio alarm-threshold 3 4 resume-threshold 2 5 trigger-section
#
interface LoopBack0
 ip address 2.2.2.2 255.255.255.255
#
ospf 100        
 area 0.0.0.0   
  network 2.2.2.2 0.0.0.0
  network 10.1.1.0 0.0.0.255
  network 10.1.3.0 0.0.0.255
#
return</pre>
</li><li><p>SPE configuration file</p>
<pre class="screen">#                                                                               
sysname SPE                                                                     
#
bfd
#
mpls lsr-id 4.4.4.4
#
mpls
#
mpls ldp
 #
 ipv4-family
#
interface GigabitEthernet<span>0/1/0</span>                                                  
 undo shutdown  
 ip address 10.1.3.2 255.255.255.0
 mpls           
 mpls ldp
 trap-threshold crc-error packet-error-ratio alarm-threshold 3 4 resume-threshold 2 5 trigger-section
#                                                                               
interface GigabitEthernet<span>0/1/1</span>                                                  
 undo shutdown  
 ip address 10.1.5.2 255.255.255.0
 mpls           
 mpls ldp
 trap-threshold crc-error packet-error-ratio alarm-threshold 3 4 resume-threshold 2 5 trigger-section
#              
interface LoopBack0
 ip address 4.4.4.4 255.255.255.255
#
ospf 100        
 area 0.0.0.0   
  network 4.4.4.4 0.0.0.0
  network 10.1.3.0 0.0.0.255
  network 10.1.5.0 0.0.0.255
#                                                                             
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_error-code_000010.html">Configuration Examples for Bit-Error-Triggered Protection Switching
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_error-code_000022.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>