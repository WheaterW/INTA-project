
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Single-ended SLM in VPLS Networking">
<meta name="abstract" content="This section provides an example for configuring single-ended synthetic packet loss measurement (LM) in virtual private LAN service (VPLS) networking.">
<meta name="description" content="This section provides an example for configuring single-ended synthetic packet loss measurement (LM) in virtual private LAN service (VPLS) networking.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011531.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011539.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011540.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,c00376497,z00603461,w00800033,jwx1168690,w00556928,w00437000,eoam-vrp,w00606909,m00390128,l00455378,wwx1270540">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="OWNER" content="z00545680">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="p00915595">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172362167">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Single-ended SLM in VPLS Networking</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172362167"></a><a name="EN-US_TASK_0172362167"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Single-ended SLM in VPLS Networking</h1>
<div class="taskbody"><p>This section provides an example for configuring single-ended synthetic packet loss measurement (LM) in virtual private LAN service (VPLS) networking.</p>
<div class="context"><a name="EN-US_TASK_0172362167__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As networks rapidly develop and applications diversify, various value-added services, such as Internet Protocol television (IPTV), video conferencing, and Voice over Internet Protocol (VoIP), are more widely used than ever before. Therefore, performance monitoring is especially important for service transport.</p>
<p>On the point-to-multipoint network shown in <a href="#EN-US_TASK_0172362167__fig_dc_vrp_y1731_cfg_007401">Figure 1</a>, a carrier wants to collect accurate performance statistics about LM on the link between PE1 and PE2. To monitor network performance in real time, the carrier can configure single-ended SLM on the VPLS network. This configuration allows the carrier to immediately adjust the network in case of voice quality deterioration.</p>
<div class="fignone" id="EN-US_TASK_0172362167__fig_dc_vrp_y1731_cfg_007401"><a name="EN-US_TASK_0172362167__fig_dc_vrp_y1731_cfg_007401"></a><a name="fig_dc_vrp_y1731_cfg_007401"></a><span class="figcap"><b>Figure 1 </b>Single-ended synthetic packet LM in VPLS networking</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 and interface2 represent GE <span>0/1/1</span> and GE <span>0/1/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_y1731_cfg_007401.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362167__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><div class="p">The configuration roadmap is as follows:<ol><li><p>Configure single-ended on-demand SLM on <span>a PW</span> between provider edges (PEs).</p>
</li><li><p>Configure single-ended proactive SLM on <span>a PW</span> between PEs.</p>
</li></ol>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362167__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Layer 2 virtual circuit (L2VC) ID</p>
</li><li><p>Names of the maintenance domain (MD) and maintenance association (MA) in which CE1, PE1, and PE2 reside</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172362167__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure single-ended on-demand SLM on <span>a PW</span> between PEs.</span><p><ol type="a"><li><p>Configure a VPLS connection.</p>
<p>Configure a VPLS connection between PE1 and PE2. For configuration details, see "VPLS Configuration" in <em>Configuration Guide - VPN</em> or configuration files in this section.</p>
<p>After the preceding configuration is complete, run the <a href="cmdqueryname=display+vsi"><b><span class="cmdname">display vsi</span></b></a> command on each PE to view VC and attachment circuit (AC) information. The following example uses the command output on PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display vsi name ethoam verbose</strong>                                           
                                                                              
 ***VSI Name               : ethoam                                             
    Administrator VSI      : no                                                 
    Isolate Spoken         : disable                                            
    VSI Index              : 0                                                  
    PW Signaling           : ldp                                                
    Member Discovery Style : static                                             
    Bridge-domain Mode     : disable
    PW MAC Learn Style     : unqualify                                          
    Encapsulation Type     : vlan                                               
    MTU                    : 1500                                               
    Diffserv Mode          : uniform                                            
    Service Class          : --                                                 
    Color                  : --                                                 
    DomainId               : 255                                                
    Domain Name            :                                                    
    Ignore AcState         : disable                                            
    P2P VSI                : disable                                            
    Create Time            : 5 days, 19 hours, 40 minutes, 31 seconds           
    VSI State              : up                                                 
                                                                                
    VSI ID                 : 80000                                              
   *Peer Router ID         : 10.1.1.24                                           
    primary or secondary   : primary                                            
    ignore-standby-state   : no                                                 
    VC Label               : 527                                                
    Peer Type              : dynamic                                            
    Session                : up                                                 
    Tunnel ID              : 0x25f                                              
    Broadcast Tunnel ID    : 0x25f                                              
    Broad BackupTunnel ID  : 0x0                                                
    CKey                   : 2                                                  
    NKey                   : 1                                                  
    Stp Enable             : 0                                                  
    PwIndex                : 0                                                  
    Control Word           : enable
                                                                                
    Interface Name         : Eth-Trunk2.1                                       
    State                  : up                                                 
    Access Port            : false                                              
    Last Up Time           : 2013/04/15 17:37:09                                
    Total Up Time          : 0 days, 0 hours, 1 minutes, 37 seconds             
                                                                                
  **PW Information:                                                             
                                                                                
   *Peer Ip Address        : 10.1.1.24                                           
    PW State               : up                                                 
    Local VC Label         : 527                                                
    Remote VC Label        : 527                                                
    Remote Control Word    : enable
    PW Type                : label                                              
    Tunnel ID              : 0x25f                                              
    Broadcast Tunnel ID    : 0x25f                                              
    Broad BackupTunnel ID  : 0x0                                                
    Ckey                   : 0x2                                                
    Nkey                   : 0x1                                                
    Main PW Token          : 0x25f                                              
    Slave PW Token         : 0x0                                                
    Tnl Type               : LSP                                                
    OutInterface           : GigabitEthernet<span>0/2/1</span>                               
    Backup OutInterface    :                                                    
    Stp Enable             : 0                                                  
    PW Last Up Time        : 2013/04/15 17:37:28                                
    PW Total Up Time       : 0 days, 0 hours, 1 minutes, 18 seconds     
</pre>
</li><li><p>Configure basic Ethernet connectivity fault management (CFM) functions and set the maintenance association end point (MEP) type to inward.</p>
<p>Configure basic Ethernet CFM functions on each PE. Specify the Ethernet CFM protocol as IEEE Standard 802.1ag-2007. Create an MD named <strong>md1</strong> and an MA named <strong>ma1</strong>, and bind the MA to the VPLS.</p>
<p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>cfm enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>cfm version standard</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>cfm md md1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>ma ma1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>map vsi ethoam</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>mep mep-id 1 interface Eth-Trunk2.1 inward</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>mep ccm-send mep-id 1 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>remote-mep mep-id 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>remote-mep ccm-receive mep-id 2 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>test-id 1 mep 1 remote-mep 2 peer 10.1.1.24</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>cfm enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>cfm version standard</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>cfm md md1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1] <strong>ma ma1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>map vsi ethoam</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>mep mep-id 2 interface Eth-Trunk2.1 inward</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>mep ccm-send mep-id 2 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>remote-mep mep-id 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>remote-mep ccm-receive mep-id 1 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>test-id 1 mep 2 remote-mep 1 peer 10.1.1.25</strong></pre>
</li><li><p>Enable PE2 to receive SLM packets.</p>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>loss-measure single-ended-synthetic receive test-id 1 time-out 300</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-md-md1-ma-ma1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-md-md1] <strong>quit</strong></pre>
</li><li><p>Enable PE1 to send SLM packets.</p>
<p># Configure PE1.</p>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>loss-measure single-ended-synthetic send test-id 1 interval 1000 sending-count 10 time-out 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-md-md1-ma-ma1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-md-md1] <strong>quit</strong></pre>
</li><li><p>Verify the configuration.</p>
<p>Run the <a href="cmdqueryname=display+y1731+statistic-type"><b><span class="cmdname">display y1731 statistic-type</span></b></a> command on PE1 to view statistics about single-ended on-demand SLM.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong>display y1731 statistic-type single-synthetic-loss test-id 1</strong>
--------------------------------------------------------------------------------
Index       L-send R-send L-recv Unack  L-loss R-loss L-loss-ratio R-loss-ratio 
--------------------------------------------------------------------------------
1016        10     10     10     0           0      0      0.0000%      0.0000% 
--------------------------------------------------------------------------------
Average Local-loss  :          0    Average Local-loss Ratio  :         0.0000% 
Maximum Local-loss  :          0    Maximum Local-loss Ratio  :         0.0000% 
Minimum Local-loss  :          0    Minimum Local-loss Ratio  :         0.0000% 
Average Remote-loss :          0    Average Remote-loss Ratio :         0.0000% 
Maximum Remote-loss :          0    Maximum Remote-loss Ratio :         0.0000% 
Minimum Remote-loss :          0    Minimum Remote-loss Ratio :         0.0000% 
</pre>
</li></ol>
</p></li><li><span>Configure single-ended proactive SLM on <span>a PW</span> between PEs.</span><p><ol type="a"><li><p>Enable PE2 to receive SLM packets.</p>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>cfm md md1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-md-md1] <strong>ma ma1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-md-md-ma-ma1] <strong>loss-measure single-ended-synthetic receive test-id 1 time-out 300</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-md-md1-ma-ma1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-md-md1] <strong>quit</strong></pre>
</li><li><p>Enable PE1 to send SLM packets.</p>
<p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>cfm md md1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-md-md1] <strong>ma ma1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-md-md1-ma-ma1] <strong>loss-measure single-ended-synthetic continual send test-id 1 interval 1000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-md-md1-ma-ma1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-md-md1] <strong>quit</strong></pre>
</li><li><p>Verify the configuration.</p>
<p>Run the <a href="cmdqueryname=display+y1731+statistic-type"><b><span class="cmdname">display y1731 statistic-type</span></b></a> command on PE1 to view statistics about single-ended proactive SLM.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> display  y1731  statistic-type single-synthetic-loss test-id 1</strong></pre>
<pre class="screen">--------------------------------------------------------------------------------
Index       L-send R-send L-recv Unack  L-loss R-loss L-loss-ratio R-loss-ratio 
--------------------------------------------------------------------------------
1016        10     10     10     0           0      0      0.0000%      0.0000% 
1017        10     10     10     0           0      0      0.0000%      0.0000% 
1018        10     10     10     0           0      0      0.0000%      0.0000% 
1019        10     10     10     0           0      0      0.0000%      0.0000% 
1020        10     10     10     0           0      0      0.0000%      0.0000% 
1021        10     10     10     0           0      0      0.0000%      0.0000% 
--------------------------------------------------------------------------------
Average Local-loss  :          0    Average Local-loss Ratio  :         0.0000% 
Maximum Local-loss  :          0    Maximum Local-loss Ratio  :         0.0000% 
Minimum Local-loss  :          0    Minimum Local-loss Ratio  :         0.0000% 
Average Remote-loss :          0    Average Remote-loss Ratio :         0.0000% 
Maximum Remote-loss :          0    Maximum Remote-loss Ratio :         0.0000% 
Minimum Remote-loss :          0    Minimum Remote-loss Ratio :         0.0000% </pre>
</li></ol>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172362167__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#                                                                               
sysname PE1
#                                                                               
cfm version standard                                                            
cfm enable                                                                      
#                                                                              
mpls lsr-id 10.1.1.25                                                            
mpls                                                                            
#                                                                               
mpls l2vpn                                                                      
#                                                                           
mpls ldp                                                                        
#                                                                              
interface Eth-Trunk2                                                            
#                                                                               
interface Eth-Trunk2.1                                                          
 vlan-type dot1q 1                                                              
 l2 binding vsi ethoam                                                       
#                                                                               
interface GigabitEthernet<span>0/1/1</span>                                                  
 undo shutdown                                                                  
 eth-trunk 2                                                                                                                               #                                          
interface GigabitEthernet<span>0/1/2</span>                                                  
 undo shutdown                                                                  
 ip address 192.168.1.3 255.255.255.0                                           
 mpls                                                                           
 mpls ldp                                                                       
#                                          
interface LoopBack0                                                             
 ip address 10.1.1.25 255.255.255.255                                            
#                                                             
ospf 1                                                                          
 opaque-capability enable                                                       
 area 0.0.0.1                                                                   
  network 1.1.1.1 0.0.0.0                                                       
  network 10.1.1.25 0.0.0.0                                                      
  network 2.2.2.2 0.0.0.0                                                      
  network 10.1.1.0 0.0.0.255                                                                                               
  network 192.168.1.0 0.0.0.255                                                 
  network 192.168.2.0 0.0.0.255                                                 
#                                                                    
cfm md md1                      
 ma ma1
  map vsi ethoam                                                    
  mep mep-id 1 interface Eth-Trunk2.1 inward                                    
  mep ccm-send mep-id 1 enable                                                  
  remote-mep mep-id 2
  remote-mep ccm-receive mep-id 2 enable                                     
  test-id 1 mep 1 remote-mep 2 peer 10.1.1.24
  loss-measure single-ended-synthetic continual send test-id 1 interval 1000    
#                                                                               
return  </pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#                                                                               
sysname PE2
# 
cfm version standard                                                           
cfm enable                                                                      
#                                                                               
mpls lsr-id 10.1.1.24                                                            
mpls                                                                            
#                                                                               
mpls l2vpn                                                                      
#                                                                           
mpls ldp                                                                        
#                                                                               
interface Eth-Trunk2                                                            
#                                                                               
interface Eth-Trunk2.1                                                          
 vlan-type dot1q 1                                                              
 l2 binding vsi ethoam                                                       
#                                                                               
interface GigabitEthernet<span>0/1/1</span>                                                  
 undo shutdown                                                                  
 eth-trunk 2                                                                    
#                                                           
interface GigabitEthernet<span>0/1/2</span>                                                  
 undo shutdown                                                                  
 ip address 192.168.1.4 255.255.255.0                                           
 mpls                                                                           
 mpls ldp                                                                       
#                                                                                              
interface NULL0                                                                 
#                                                                               
interface LoopBack0                                                             
 ip address 10.1.1.24 255.255.255.255                                            
#                                                                       
ospf 1                                                                          
 opaque-capability enable                                                       
 area 0.0.0.1                                                                   
  network 10.1.1.24 0.0.0.0                                                      
  network 2.2.2.2 0.0.0.0                                                       
  network 10.1.1.0 0.0.0.255                                                                                                  
  network 192.168.1.0 0.0.0.255                                                 
  network 192.168.2.0 0.0.0.255                                                 
#                                               
cfm md md1   
 ma ma1
  map vsi ethoam                                                    
  mep mep-id 2 interface Eth-Trunk2.1 inward                                 
  mep ccm-send mep-id 2 enable                                               
  remote-mep mep-id 1                                                          
  remote-mep ccm-receive mep-id 1 enable                                        
  test-id 1 mep 2 remote-mep 1 peer 10.1.1.25                                               
  loss-measure single-ended-synthetic receive test-id 1 time-out 300 
#                                                                               
return </pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011531.html">Configuration Examples for Y.1731
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011539.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011540.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>