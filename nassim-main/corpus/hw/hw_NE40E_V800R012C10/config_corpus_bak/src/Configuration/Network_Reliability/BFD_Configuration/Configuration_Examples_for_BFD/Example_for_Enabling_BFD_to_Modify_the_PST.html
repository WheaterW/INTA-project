
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Enabling BFD to Modify the PST">
<meta name="abstract" content="This section provides an example for enabling BFD to modify the port status table (PST). After the configuration is complete, an upper-layer protocol switches traffic to a backup link if a link fault occurs.">
<meta name="description" content="This section provides an example for enabling BFD to modify the port status table (PST). After the configuration is complete, an upper-layer protocol switches traffic to a backup link if a link fault occurs.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bfd_cfg_0058.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bfd_cfg_2025.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bfd_cfg_0049.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="q00824768,w00606909,m00390128">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BFD">
<meta name="featuretype" content="Network Reliability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BFD">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="BFD">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="BFD">
<meta name="featuretype" content="Network Reliability">
<meta name="OWNER" content="q00824768,p00915595">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="s00826690">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172361724">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/thickbox.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/imageResize.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery-migrate-1.2.1.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery-ui.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery.mousewheel.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/thickbox.js"></script>
<title>Example for Enabling BFD to Modify the PST</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172361724"></a><a name="EN-US_TASK_0172361724"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Enabling BFD to Modify the PST</h1>
<div class="taskbody"><p>This section provides an example for enabling BFD to modify the port status table (PST). After the configuration is complete, an upper-layer protocol switches traffic to a backup link if a link fault occurs.</p>
<div class="context"><a name="EN-US_TASK_0172361724__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>If BFD is enabled to modify the PST of an interface, BFD will modify the PST when it detects that the interface goes down. This function allows the underlying layer to detect the fault based on the change in the PST.</p>
<p><span>LDP FRR and </span>IP FRR can obtain a BFD detection result based on a PST change.</p>
<p>On the network shown in <a href="#EN-US_TASK_0172361724__fig_dc_vrp_bfd_cfg_200501">Figure 1</a>, a BFD session in asynchronous mode is established to detect faults in the link between <span class="keyword">Device</span>A and <span class="keyword">Device</span>B.</p>
<div class="fignone" id="EN-US_TASK_0172361724__fig_dc_vrp_bfd_cfg_200501"><a name="EN-US_TASK_0172361724__fig_dc_vrp_bfd_cfg_200501"></a><a name="fig_dc_vrp_bfd_cfg_200501"></a><span class="figcap"><b>Figure 1 </b>Enabling BFD to modify the PST</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 represents GE <span>0/1/0</span>.</p>
</div></div>
<p><span><img class="imgResize" src="figure/en-us_image_0000001508150189.png" width="357.09103500000003" height="81.23041500000001" title="Click to enlarge"></span></p>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172361724__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>BFD sessions must be established on both ends.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172361724__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><div class="p">The configuration roadmap is as follows:<ol><li><p>Enable BFD globally on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B.</p>
</li><li><p>Create single-hop BFD sessions and bind them to the outbound interfaces on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B.</p>
</li><li><p>Enable BFD to modify the PST.</p>
</li></ol>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172361724__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><div class="p">To complete the configuration, you need the following data:<ul><li><p>Peer IP address monitored by BFD</p>
</li><li><p>Local and remote discriminators of the BFD session</p>
</li><li><p>Name of the BFD session</p>
</li></ul>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172361724__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign IP addresses to the interfaces on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B.</span><p><p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>A</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>ip address 10.1.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>B</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>ip address 10.1.1.2 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>quit</strong></pre>
<p>After the configuration is complete, <span class="keyword">Device</span>A and DeviceB can ping each other. The following example uses the command output on <span class="keyword">Device</span>A.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>A&gt; <strong>ping 10.1.1.2</strong></pre>
<pre class="screen">PING 10.1.1.2 : 56  data bytes, press CTRL_C to break
    Reply from 10.1.1.2: bytes=56 Sequence=1 ttl=255 time=3 ms
    Reply from 10.1.1.2: bytes=56 Sequence=2 ttl=255 time=1 ms
    Reply from 10.1.1.2: bytes=56 Sequence=3 ttl=255 time=1 ms
    Reply from 10.1.1.2: bytes=56 Sequence=4 ttl=255 time=1 ms
    Reply from 10.1.1.2: bytes=56 Sequence=5 ttl=255 time=1 ms

  --- 10.1.1.2 ping statistics ---
    5 packet(s) transmitted
    5 packet(s) received
    0.00% packet loss
    round-trip min/avg/max = 1/1/3 ms          </pre>
</p></li><li><span>Configure single-hop BFD.</span><p><p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>bfd</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>bfd pst bind peer-ip 10.1.1.2 interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-pst] <strong>discriminator local 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-pst] <strong>discriminator remote 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-pst] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-bfd-session-pst] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>bfd</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>bfd pst bind peer-ip 10.1.1.1 interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-session-pst] <strong>discriminator local 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-session-pst] <strong>discriminator remote 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-session-pst] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-bfd-session-pst] <strong>quit</strong></pre>
<p>After completing the configurations, run the <a href="cmdqueryname=display+bfd+session+all+verbose"><b><span class="cmdname">display bfd session all verbose</span></b></a> command on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B. The command output shows that a single-hop BFD session is established and its status is Up. The following example uses the command output on <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display bfd session all verbose</strong></pre>
<pre class="screen"><span>(w): State in WTR 
(*): State is invalid</span>
------------------------------------------------------------------------------
  <strong>(One Hop)   State : Up</strong>                    Name : pst
------------------------------------------------------------------------------
  Local Discriminator    : 2                Remote Discriminator   : 1
  Session Detect Mode    : Asynchronous Mode Without Echo Function
  BFD Bind Type          : Interface(GigabitEthernet<span>0/1/0</span>)
  Bind Session Type      : Static
  Bind Peer IP Address   : 10.1.1.1
  Bind Interface         : GigabitEthernet<span>0/1/0</span>
  FSM Board Id           : 1                TOS-EXP                : 7
  Min Tx Interval (ms)   : 10               Min Rx Interval (ms)   : 10
  Actual Tx Interval (ms): 10               Actual Rx Interval (ms): 10
  Local Detect Multi     : 3                Detect Interval (ms)   : 30
  Echo Passive           : Disable          Acl Number             : -
  Destination Port       : 3784             TTL                    : 255
  Proc Interface Status  : Disable          Process PST            : Disable
  WTR Interval (ms)      : 0                Config PST             : Disable
  Active Multi           : 3
  Last Local Diagnostic  : No Diagnostic
  Bind Application       : No Application Bind
  Session TX TmrID       : 0                Session Detect TmrID   : 0
  Session Init TmrID     : -                Session WTR TmrID      : -
  Session Echo Tx TmrID  : -
  Session Description    : -
<span>  Track Group Name       : -</span>
------------------------------------------------------------------------------

     Total UP/DOWN Session Number : 1/0</pre>
</p></li><li><span>Enable BFD to modify the PST on DeviceA and DeviceB.</span><p><p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>bfd pst</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-pst] <strong>process-pst</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-pst] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-bfd-session-pst] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>bfd pst</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-session-pst] <strong>process-pst</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-session-pst] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-bfd-session-pst] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>After completing the configurations, run the <a href="cmdqueryname=display+bfd+session+all+verbose"><b><span class="cmdname">display bfd session all verbose</span></b></a> command on <span class="keyword">Device</span>A and DeviceB. The command output shows that the value of <strong>Process PST</strong> is <strong>Enable</strong>. The following example uses the command output on <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display bfd session all verbose</strong></pre>
<pre class="screen"><span>(w): State in WTR 
(*): State is invalid</span>
------------------------------------------------------------------------------
  (One Hop)   State : Up                    Name : pst
------------------------------------------------------------------------------
  Local Discriminator    : 2                Remote Discriminator   : 1
  Session Detect Mode    : Asynchronous Mode Without Echo Function
  BFD Bind Type          : Interface(GigabitEthernet<span>0/1/0</span>)
  Bind Session Type      : Static
  Bind Peer IP Address   : 10.1.1.1
  Bind Interface         : GigabitEthernet<span>0/1/0</span>
  FSM Board Id           : 1                TOS-EXP                : 7
  Min Tx Interval (ms)   : 10               Min Rx Interval (ms)   : 10
  Actual Tx Interval (ms): 10               Actual Rx Interval (ms): 10
  Local Detect Multi     : 3                Detect Interval (ms)   : 30
  Echo Passive           : Disable          Acl Number             : -
  Destination Port       : 3784             TTL                    : 255
  Proc Interface Status  : Disable          <strong>Process PST         : Enable</strong>
  WTR Interval (ms)      : 0                Local Demand Mode      : Disable
  Active Multi           : 3
  Last Local Diagnostic  : No Diagnostic
  Bind Application       : No Application Bind
  Session TX TmrID       : 0                Session Detect TmrID   : 0
  Session Init TmrID     : -                Session WTR TmrID      : -
  Session Echo Tx TmrID  : -
  Session Description    : -
<span>  Track Group Name       : -</span>
------------------------------------------------------------------------------

     Total UP/DOWN Session Number : 1/0</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172361724__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span>A configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>A
#
bfd
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.1.1 255.255.255.0
#
bfd pst bind peer-ip 10.1.1.2 interface GigabitEthernet<span>0/1/0</span>
 discriminator local 1
 discriminator remote 2
 process-pst 
#
return</pre>
</li><li><p><span class="keyword">Device</span>B configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>B
#
bfd
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.1.2 255.255.255.0
#
bfd pst bind peer-ip 10.1.1.1 interface GigabitEthernet<span>0/1/0</span>
 discriminator local 2
 discriminator remote 1
 process-pst
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bfd_cfg_0058.html">Configuration Examples for BFD
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bfd_cfg_2025.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bfd_cfg_0049.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>

<script language="JavaScript">
<!--
image_size('.imgResize');
var msg_imageMax = "view original image";
var msg_imageClose = "close";
//--></script></body>
</html>