
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Two-way Packet Delay Measurement in EVPN Networking">
<meta name="abstract" content="This section provides an example showing how to configure two-way packet delay measurement in EVPN networking.">
<meta name="description" content="This section provides an example showing how to configure two-way packet delay measurement in EVPN networking.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011531.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011561.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011563.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,c00376497,z00603461,w00800033,jwx1168690,w00556928,w00437000,eoam-vrp,w00606909,m00390128,l00455378,wwx1270540">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="OWNER" content="z00545680">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00800033">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172362195">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Two-way Packet Delay Measurement in EVPN Networking</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172362195"></a><a name="EN-US_TASK_0172362195"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Two-way Packet Delay Measurement in EVPN Networking</h1>
<div class="taskbody"><p>This section provides an example showing how to configure two-way packet delay measurement in EVPN networking.</p>
<div class="context"><a name="EN-US_TASK_0172362195__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0172362195__fig_dc_vrp_cfg_01153501">Figure 1</a>, connectivity fault management (CFM) is configured between each customer edge (CE) and provider edge (PE) and between PEs. To provide high-quality video services, providers hope to monitor the bidirectional delay over mobile bearer links in real time, while monitoring link connectivity. Monitoring the bidirectional delay over mobile bearer links allows the providers to respond quickly to video service quality deterioration.</p>
<div class="fignone" id="EN-US_TASK_0172362195__fig_dc_vrp_cfg_01153501"><a name="EN-US_TASK_0172362195__fig_dc_vrp_cfg_01153501"></a><a name="fig_dc_vrp_cfg_01153501"></a><span class="figcap"><b>Figure 1 </b>Configuring Y.1731 functions in EVPN networking</span><div class="note" id="EN-US_TASK_0172362195__en-us_task_0172362192_note1678238306214024"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172362195__en-us_task_0172362192_p1100989244214024">In this example, interface1 and interface2 represent GE <span>0/1/1</span> and GE <span>0/1/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0172362195__en-us_task_0172362192_image945445184214024" src="images/fig_dc_vrp_cfg_01151605.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362195__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><div class="p">The configuration roadmap is as follows:<ol><li><p>Configure on-demand two-way packet delay measurement to periodically collect statistics about the delay in packet transmission</p>
</li><li><p>Configure proactive two-way packet delay measurement to continuously collect statistics about the delay in packet transmission.</p>
</li></ol>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362195__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Configure the name of EVPN instance of PE and RT, RD.</p>
</li><li><p>Configure the names of the MD and MA between PE1 and PE2 and between CE1 and PE1.</p>
</li><li><p>The CE device interface VLAN ID.</p>
</li><li><p>Interval at which delay measurement messages (DMMs) are sent and the number of times when on-demand DMMs are sent.</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172362195__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure on-demand two-way packet delay measurement.</span><p><ol type="a"><li><p id="EN-US_TASK_0172362195__en-us_task_0172362192_p998513344214024">Configure an EVPN connection.</p>
<p id="EN-US_TASK_0172362195__en-us_task_0172362192_p1505807964214024">Configure an EVPN connection between PE1 and PE2. The configuration details are not provided here. For details, see the <a href="dc_vrp_evpn_cfg_0000.html">EVPN Configuration</a> or configuration files in this configuration example.</p>
</li><li><p id="EN-US_TASK_0172362195__en-us_task_0172362192_p1210747766214024">Configure basic Ethernet CFM functions and specify the MEP type as inward.</p>
<p id="EN-US_TASK_0172362195__en-us_task_0172362192_p298328033214024">Configure basic Ethernet CFM functions on each PE. Specify the Ethernet CFM protocol as IEEE Standard 802.1ag-2007. Create an MD named <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b113071839267">md1</strong> and an MA named <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b107237429613">ma1</strong>, and bind the MA to the EVPN instance.</p>
<p id="EN-US_TASK_0172362195__en-us_task_0172362192_p1292616594214024"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen1485872137214024">&lt;<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword782843015214024">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1239540939214024">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen921191780214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword422766957214024"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword1568342023214024">HUAWEI</span>] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1626501447214024">sysname PE1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen1610697209214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword515892485214024">*</span><span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword1213512456214024">HUAWEI</span>] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b743934176214024">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen75481792214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword2071811779214024"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1843868885214024">cfm enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen1629738567214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword761912901214024">*</span>PE1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1621958310214024">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen1197926414214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword1837891356214024"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1751669183214024">cfm md md1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen1912048784214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword1866572667214024">*</span>PE1-md-md1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b55127603214024">ma ma1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen2070720933214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword834455320214024">*</span>PE1-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b208516351214024">map evpn vpn-instance evpna</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen1293266386214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword1920593961214024">*</span>PE1-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1183397682214024">mep mep-id 1 interface gigabitethernet<span>0/1/1</span> inward</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen2077054962214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword1188134433214024">*</span>PE1-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b716303792214024">mep ccm-send mep-id 1 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen941118856214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword1499087420214024">*</span>PE1-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b987940559214024">remote-mep mep-id 2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen2035348986214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword1541627473214024">*</span>PE1-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b2016828028214024">remote-mep ccm-receive mep-id 2 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen1864582213214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword234312097214024">*</span>PE1-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b2092866735214024">test-id 1 mep 1 remote-mep 2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen430162548214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword227522842214024">*</span>PE1-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b834785061214024">commit</strong></pre>
<p id="EN-US_TASK_0172362195__en-us_task_0172362192_p1071375529214024"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen763161272214024">&lt;<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword1536321113214024">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1252835626214024">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen324268005214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword307728333214024"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword849470755214024">HUAWEI</span>] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b440245907214024">sysname PE2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen1816474959214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword696447385214024">*</span><span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword1405323545214024">HUAWEI</span>] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1577999655214024">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen664387247214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword2020583387214024"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1041115720214024">cfm enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen21217107214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword699171046214024">*</span>PE2] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1985528890214024">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen1041435144214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword722241331214024"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b397963950214024">cfm md md1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen1597121391214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword361372054214024">*</span>PE2-md-md1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1460101686214024">ma ma1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen516572552214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword1944655378214024">*</span>PE2-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b263781573214024">map evpn vpn-instance evpna</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen1428817809214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword548520943214024">*</span>PE2-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1272220350214024">mep mep-id 2 interface gigabitethernet<span>0/1/1</span> inward</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen779959243214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword1430306396214024">*</span>PE2-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1496503271214024">mep ccm-send mep-id 2 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen464615169214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword1434569284214024">*</span>PE2-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1192896426214024">remote-mep mep-id 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen772939895214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword334816667214024">*</span>PE2-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1740851262214024">remote-mep ccm-receive mep-id 1 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen1051664810214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword2094662376214024">*</span>PE2-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1816232639214024">test-id 1 mep 2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362195__en-us_task_0172362192_screen187874183214024">[<span class="keyword" id="EN-US_TASK_0172362195__en-us_task_0172362192_keyword1032992129214024">*</span>PE2-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362195__en-us_task_0172362192_b1756556268214024">commit</strong></pre>
</li><li><p>Configure the DMM reception function on PE2. </p>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>delay-measure two-way receive test-id 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</li><li><p>Enable on-demand two-way packet delay measurement on the EVPN network.</p>
<p># Configure PE1.</p>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>delay-measure two-way send test-id 1 interval 1000 count 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
</li><li><p>Verify the configuration.</p>
<p>Run the <a href="cmdqueryname=display+y1731+statistic-type"><b><span class="cmdname">display y1731 statistic-type</span></b></a> command on PE1 to view the statistics about the delay in bidirectional packet transmission.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display y1731 statistic-type twoway-delay</strong>
Latest two-way delay statistics of test-id 1:
--------------------------------------------------------------------------------
Index    Delay(usec)    Delay variation(usec)
--------------------------------------------------------------------------------
    1            422                        -
    2            320                      102
    3            467                      147
    4            309                      158
    5            328                       19
    6            316                       12
    7            336                       20
    8            282                       54
    9            421                      139
   10            287                      134
   11            322                       35
   12            446                      124
   13            275                      171
   14            291                       16
   15            341                       50
--------------------------------------------------------------------------------
Average delay(usec) :        344    Average delay variation(usec) :         84
Maximum delay(usec) :        467    Maximum delay variation(usec) :        171
Minimum delay(usec) :        275    Minimum delay variation(usec) :         12

</pre>
</li></ol>
</p></li><li><span>Configure proactive two-way packet delay measurement.</span><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Proactive two-way packet delay measurement can be configured to continuously monitor the performance.</p>
</div></div>
<ol type="a"><li><p>Configure a test instance.</p>
<p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>cfm md md1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>ma ma1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>test-id 2 mep 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>delay-measure two-way receive test-id 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>cfm md md1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1] <strong>ma ma1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>test-id 2 mep 2 remote-mep 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</li><li><p>Enable proactive two-way packet delay measurement.</p>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>cfm md md1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1] <strong>ma ma1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>test-id 2 mep 2 remote-mep 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>delay-measure two-way continual send test-id 2 interval 30000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</li><li><p>Verify the configuration.</p>
<p>Run the <a href="cmdqueryname=display+y1731+statistic-type"><b><span class="cmdname">display y1731 statistic-type</span></b></a> command on PE2 to view the statistics about the delay in bidirectional packet transmission.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>display y1731 statistic-type twoway-delay</strong>
Latest two-way delay statistics of test-id 2:
--------------------------------------------------------------------------------
Index    Delay(usec)    Delay variation(usec)
--------------------------------------------------------------------------------
    1            322                        -
    2            430                      108
--------------------------------------------------------------------------------
Average delay(usec) :        376    Average delay variation(usec) :        108
Maximum delay(usec) :        430    Maximum delay variation(usec) :        108
Minimum delay(usec) :        322    Minimum delay variation(usec) :        108</pre>
</li></ol>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172362195__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#
sysname PE1
#
cfm enable
#
evpn vpn-instance evpna
  route-distinguisher 100:1
  vpn-target 1:1 export-extcommunity
  vpn-target 1:1 import-extcommunity
#
mpls lsr-id 1.1.1.1
#
mpls
#
mpls ldp
#
 ipv4-family
#
interface GigabitEthernet<span>0/1/1</span>
  undo shutdown
  evpn binding vpn-instance evpna
#
interface GigabitEthernet<span>0/1/2</span>
  ip address 10.1.1.1 255.255.255.0
  mpls
  mpls ldp
#
interface LoopBack0
  ip address 1.1.1.1 255.255.255.255
#
bgp 100
  peer 2.2.2.2 as-number 100
  peer 2.2.2.2 connect-interface LoopBack0
#
ipv4-family unicast
   undo synchronization
   peer 2.2.2.2 enable
#
  l2vpn-family evpn
   peer 2.2.2.2 enable
#
ospf 1
  area 0.0.0.0
   network 1.1.1.1 0.0.0.0
   network 10.1.1.0 0.0.0.255
#
evpn source-address 1.1.1.1 
#</pre>
<pre class="screen"> cfm md md1
 ma ma1
  map evpn vpn-instance evpna
  mep mep-id 1 interface GigabitEthernet<span>0/1/1</span> inward
  mep ccm-send mep-id 1 enable
  remote-mep mep-id 2
  remote-mep ccm-receive mep-id 2 enable
  test-id 1 mep 1 remote-mep 2
  test-id 2 mep 1
  delay-measure two-way receive test-id 2
#                                              
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2
#
cfm enable
#
evpn vpn-instance evpna
  route-distinguisher 200:1
  vpn-target 1:1 export-extcommunity
  vpn-target 1:1 import-extcommunity
#
mpls lsr-id 2.2.2.2
#
mpls
#
mpls ldp
#
ipv4-family
#
interface GigabitEthernet<span>0/1/1</span>
 evpn binding vpn-instance evpna
#
interface GigabitEthernet<span>0/1/2</span>
  ip address 10.2.1.1 255.255.255.0
  mpls
  mpls ldp
#
 interface LoopBack0
  ip address 2.2.2.2 255.255.255.255
#
bgp 100
  peer 1.1.1.1 as-number 100
  peer 1.1.1.1 connect-interface LoopBack0
#
ipv4-family unicast
   undo synchronization
   peer 1.1.1.1 enable
#
l2vpn-family evpn
   peer 1.1.1.1 enable
#
ospf 1
  area 0.0.0.0
   network 2.2.2.2 0.0.0.0
   network 10.2.1.0 0.0.0.255
#
evpn source-address 2.2.2.2
#</pre>
<pre class="screen"> cfm md md1
 ma ma1
  map evpn vpn-instance evpna
  mep mep-id 2 interface GigabitEthernet<span>0/1/1</span> inward
  mep ccm-send mep-id 2 enable
  remote-mep mep-id 1
  remote-mep ccm-receive mep-id 1 enable
  test-id 1 mep 2
  delay-measure two-way receive test-id 1
  test-id 2 mep 2 remote-mep 1
  delay-measure two-way continual send test-id 2 interval 30000
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011531.html">Configuration Examples for Y.1731
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011561.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011563.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>