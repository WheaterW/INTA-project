
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Basic Detection Functions">
<meta name="abstract" content="This section describes how to configure proper MPLS OAM parameters on both ends of a PW for network loads.">
<meta name="description" content="This section describes how to configure proper MPLS OAM parameters on both ends of a PW for network loads.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mplsoam_cfg_0012.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mplsoam_cfg_0015.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,z00603461,w00800033,mpls-oam-vrp,jwx1168690,w00556928,w00437000,w00606909,m00390128,l00455378,wwx1270540">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MPLS OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MPLS OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="MPLS OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="MPLS OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="OWNER" content="z00545680">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00545680">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172362362">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Basic Detection Functions</title>
</head>
<body><a name="EN-US_TASK_0172362362"></a><a name="EN-US_TASK_0172362362"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Basic Detection Functions</h1>
<div class="taskbody"><p>This section describes how to configure proper MPLS OAM parameters on both ends of a PW for network loads.</p>
<div class="context"><a name="EN-US_TASK_0172362362__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Perform the following steps on both ends:</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172362362__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=mpls"><b><span class="cmdname">mpls</span></b></a></span></span><p><p>The MPLS view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=mpls+oam"><b><span class="cmdname">mpls oam</span></b></a></span></span><p><p>MPLS OAM is globally enabled.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=mpls-oam"><b><span class="cmdname">mpls-oam</span></b></a></span></span><p><p>The MPLS-OAM view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=mpls+oam+l2vc"><b><span class="cmdname">mpls oam l2vc</span></b></a> <strong><span>peer-ip</span></strong> <i><span class="varname">peer-ip</span></i> <strong><span>vc-id</span></strong> <i><span class="varname">vc-id</span></i> <strong><span>vc-type</span></strong> <i><span class="varname">vc-type</span></i> [ <strong><span>remote-peer-ip</span></strong> <i><span class="varname">remote-peer-ip</span></i> <strong><span>remote-vc-id</span></strong> <i><span class="varname">remote-vc-id</span></i> <strong><span>remote-vc-type</span></strong> <i><span class="varname">remote-vc-type</span></i> ] <strong><span>type</span></strong> { <strong><span>cv</span></strong> | <strong><span>ffd</span></strong> <strong><span>frequency</span></strong> { <strong><span>3</span></strong> | <strong><span>10</span></strong> | <strong><span>20</span></strong> |<strong><span> 50</span></strong> | <strong><span>100</span></strong> | <strong><span>200</span></strong> |<strong><span> 500</span></strong> } } [ <strong><span>auto-protocol</span></strong> [ <strong><span>overtime</span></strong> <i><span class="varname">overtime</span></i> ] ] [ <strong><span>compatibility-mode</span></strong> <i><span class="varname">compati-mode-val</span></i> ] [ <strong><span>bdi-frequency</span></strong> <i><span class="varname">bdi-freq-val </span></i>]<span> [ <strong><span>exp</span></strong> <i><span class="varname">exp-value</span></i> ]</span></span><p><p>MPLS OAM parameters are configured on nodes at both ends of the PW.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>If OAM auto protocol extension is enabled in Step 6, Step 7 does not need to be performed. When OAM auto protocol extension is enabled, a device automatically sends or receives OAM detection packets.</p>
</li><li><p>After receiving the first CV or FFD packet, the egress automatically records OAM parameters, such as the detection packet type and interval at which detection packets are sent. The egress then uses these parameters to monitor link connectivity.</p>
</li><li><p>The same compatibility mode must be set to ensure interworking between different products.</p>
</li><li><p>When OAM auto protocol extension is enabled, the modification of configurations on the local and peer devices must be in the same mode. Otherwise, the interconnection may fail.</p>
</li></ul>
</div></div>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=mpls+oam+l2vc+enable"><b><span class="cmdname">mpls oam l2vc enable</span></b></a> { <strong><span>send</span></strong> | <strong><span>receive</span></strong> } <strong><span>peer-ip</span></strong> <i><span class="varname">peer-ip</span></i> <strong><span>vc-id</span></strong> <i><span class="varname">vc-id</span></i> <strong><span>vc-type</span></strong> <i><span class="varname">vc-type</span></i></span></span><p><p>MPLS OAM is enabled on the node at each end of the PW.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=mpls+oam+l2vc+loss-measure+oam-packet+loss-ratio"><b><span class="cmdname">mpls oam l2vc loss-measure oam-packet loss-ratio</span></b></a> <span>{ <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377227_cmdparmname1155801830214437">threshold1</span></strong> <i><span class="varname" id="EN-US_TASK_0172362362__en-us_cliref_0172377227_varname323752532214437">threshold1-value</span></i> | <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377227_cmdparmname543995844214437">threshold2</span></strong> <i><span class="varname" id="EN-US_TASK_0172362362__en-us_cliref_0172377227_varname2101052974214437">threshold2-value</span></i> } <sup id="EN-US_TASK_0172362362__en-us_cliref_0172377227_sup790494679214437">*</sup> <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377227_cmdparmname1329838625214437">peer-ip</span></strong> <i><span class="varname" id="EN-US_TASK_0172362362__en-us_cliref_0172377227_varname1525840751214437">peer-ip</span></i> <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377227_cmdparmname596284199214437">vc-id</span></strong> <i><span class="varname" id="EN-US_TASK_0172362362__en-us_cliref_0172377227_varname655416969214437">vc-id</span></i> <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377227_cmdparmname71590887214437">vc-type</span></strong> <i><span class="varname" id="EN-US_TASK_0172362362__en-us_cliref_0172377227_varname510807366214437">vc-type</span></i></span></span></span><p><p>The packet loss alarm threshold of OAM packets is set.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=mpls+oam+l2vc+lost-measure+single-ended+proactive"><b><span class="cmdname">mpls oam l2vc lost-measure single-ended proactive</span></b></a> <span>[ <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377230_cmdparmname722578167214437">exp</span></strong> <i><span class="varname" id="EN-US_TASK_0172362362__en-us_cliref_0172377230_varname1475603715214437">exp-value</span></i> ] <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377230_cmdparmname1083970255214437">peer-ip</span></strong> <i><span class="varname" id="EN-US_TASK_0172362362__en-us_cliref_0172377230_varname1673120244214437">peer-ip</span></i> <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377230_cmdparmname83005845214437">vc-id</span></strong> <i><span class="varname" id="EN-US_TASK_0172362362__en-us_cliref_0172377230_varname548243959214437">vc-id</span></i> <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377230_cmdparmname604893716214437">vc-type</span></strong> <i><span class="varname" id="EN-US_TASK_0172362362__en-us_cliref_0172377230_varname369218851214437">vc-type</span></i></span></span></span><p><p>The single-ended packet loss measurement of PW MPLS OAM is enabled.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=mpls+oam+l2vc+delay-measure+two-way+proactive"><b><span class="cmdname">mpls oam l2vc delay-measure two-way proactive</span></b></a> <span>[ <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377224_cmdparmname286261522214437">exp</span></strong> <i><span class="varname" id="EN-US_TASK_0172362362__en-us_cliref_0172377224_varname1208712443214437">exp-value</span></i> | <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377224_cmdparmname2006094901214437">packet-size</span></strong> <i><span class="varname" id="EN-US_TASK_0172362362__en-us_cliref_0172377224_varname51364125214437">packet-size-value</span></i> [ <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377224_cmdparmname472212243214437">padding-value</span></strong> { <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377224_cmdparmname35335391214437">0</span></strong> | <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377224_cmdparmname1076839520214437">1</span></strong> } ] ] <sup id="EN-US_TASK_0172362362__en-us_cliref_0172377224_sup1950739371214437">*</sup> <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377224_cmdparmname2025058733214437">peer-ip</span></strong> <i><span class="varname" id="EN-US_TASK_0172362362__en-us_cliref_0172377224_varname885473577214437">peer-ip</span></i> <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377224_cmdparmname954070212214437">vc-id</span></strong> <i><span class="varname" id="EN-US_TASK_0172362362__en-us_cliref_0172377224_varname2007776213214437">vc-id</span></i> <strong><span id="EN-US_TASK_0172362362__en-us_cliref_0172377224_cmdparmname685881925214437">vc-type</span></strong> <i><span class="varname" id="EN-US_TASK_0172362362__en-us_cliref_0172377224_varname1991521821214437">vc-type</span></i></span></span></span><p><p>The proactive PW two-way delay measurement is enabled.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="postreq-steps"><a name="EN-US_TASK_0172362362__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Exception Handling</h4>
<div class="p">
<div class="p">If the transmit end has FFD configured and the receive end has <strong><span>auto-protocol</span></strong> configured, the receive end receives FFD packets at the interval that the transmit end sends packets. After the following operations are performed, an unknown alarm is automatically reported and cannot be cleared:<ol><li>Run the <a href="cmdqueryname=shutdown"><b><span class="cmdname">shutdown</span></b></a> command on the service interface of the receive end to disable services.</li><li>Run the <a href="cmdqueryname=mpls+oam+l2vc"><b><span class="cmdname">mpls oam l2vc</span></b></a> command on the transmit end to modify <strong><span>frequency</span></strong> <i><span class="varname">ffd-fre</span></i>.</li><li> Run the <a href="cmdqueryname=undo+shutdown"><b><span class="cmdname">undo shutdown</span></b></a> command on the service interface of the receive end to enable services. Then, the receive end will receive FFD packets at an interval different from the locally recorded one.</li></ol>
</div>

<div class="p">In this situation, run the <a href="cmdqueryname=undo+mpls+oam+l2vc+enable"><b><span class="cmdname">undo mpls oam l2vc enable</span></b></a> command on the transmit end to disable FFD. Then, reconfigure FFD.</div>
</div></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mplsoam_cfg_0012.html">Configuring MPLS OAM for a PW
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mplsoam_cfg_0015.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>