
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Establishing a Dual-Device Backup Platform">
<meta name="abstract" content="This section describes how to establish a dual-device backup platform to back up user information between devices. This allows fast service switching if a network node or link fails, enhancing service reliability.">
<meta name="description" content="This section describes how to establish a dual-device backup platform to back up user information between devices. This allows fast service switching if a network node or link fails, enhancing service reliability.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_rbs_cfg_0003.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_rbs_cfg_0005.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00604599">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Dual-Device Backup">
<meta name="featuretype" content="Network Reliability">
<meta name="Solution" content="html_ismerge">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Dual-Device Backup">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Dual-Device Backup">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Dual-Device Backup">
<meta name="featuretype" content="Network Reliability">
<meta name="OWNER" content="w00604599">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00604599">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172362241">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Establishing a Dual-Device Backup Platform</title>
</head>
<body><a name="EN-US_TASK_0172362241"></a><a name="EN-US_TASK_0172362241"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Establishing a Dual-Device Backup Platform</h1>
<div class="taskbody"><p>This section describes how to establish a dual-device backup platform to back up user information between devices. This allows fast service switching if a network node or link fails, enhancing service reliability.</p>
<div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0172362241__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before binding an SSL policy to a TCP connection, an SSL policy has been configured and a digital certificate has been loaded.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362241__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Context</h4><p>Dual-device backup provides a unified platform for backing up user information between devices in a VRRP group through a remote backup service (RBS) channel. This facilitates flexible control and management of user services and improves service continuity. Establishing a dual-device backup platform includes configuring basic Virtual Router Redundancy Protocol (VRRP) group functions, a remote backup service (RBS), and a remote backup profile (RBP).</p>
<p>Perform the following steps on both the master and backup devices:</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172362241__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure basic VRRP group functions.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> {<i><span class="varname"> interface-name </span></i>| <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> }</span><p><p>The interface view for a VRRP group is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=vrrp+vrid"><b><span class="cmdname">vrrp vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>virtual-ip</span></strong> <i><span class="varname">virtual-address</span></i></span><p><p>A VRRP group is created, and a virtual IP address is assigned to the VRRP group.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=vrrp+vrid"><b><span class="cmdname">vrrp vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>preempt-mode</span></strong> <strong><span>timer</span></strong> <strong><span>delay</span></strong> <i><span class="varname">delay<span>-time</span></span></i></span><p><p>A preemption delay is set for devices in the VRRP group.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In ARP dual-device hot backup scenarios, to ensure that the master device can completely back up ARP entries to the backup device, setting a preemption delay greater than or equal to 600s for the devices in the VRRP group is recommended.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=admin-vrrp+vrid"><b><span class="cmdname">admin-vrrp vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> [ <strong><span>ignore-if-down</span></strong> ]</span><p><p>The VRRP group is configured as an mVRRP group.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=vrrp+vrid"><b><span class="cmdname">vrrp vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>priority</span></strong> <i><span class="varname">priority-value</span></i></span><p><p>A priority is configured for a device in the VRRP group.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure an RBP.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=remote-backup-profile"><b><span class="cmdname">remote-backup-profile</span></b></a> <i><span class="varname">profile-name</span></i></span><p><p>An RBP is created, and the RBP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer-backup"><b><span class="cmdname">peer-backup</span></b></a> <strong><span>hot</span></strong></span><p><p>A backup mode is configured for user information backup.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=vrrp-id"><b><span class="cmdname">vrrp-id</span></b></a> <i><span class="varname">v<span>rid</span></span></i> <strong><span>interface</span></strong> {<i><span class="varname"> interface-name</span></i> |<i><span class="varname"> interface-type</span></i> <i><span class="varname">interface-number </span></i><span><span>}</span> { <strong><span>odd-mac</span></strong> | <strong><span>even-mac</span></strong> }</span></span><p><p>A binding relationship between the RBP and the VRRP group is configured.</p>
</p><p><p><i><span class="varname">vrid</span></i> specifies the ID of a VRRP group. The ID must be the same as the VRRP group's ID that was configured using the <a href="cmdqueryname=vrrp+vrid"><b><span class="cmdname">vrrp vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> [ <strong><span>virtual-ip</span></strong> <i><span class="varname">virtual-address</span></i> ] command in the corresponding interface view.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In a dual-device backup scenario where load balancing is implemented based on odd and even MAC addresses, if the <strong>mac-address</strong> parameter is not set under the <strong>static-user</strong> command but the <strong>initiative detect static user</strong> parameter is configured, only static users with odd MAC addresses can go online.</p>
<p>When load balancing based on odd and even MAC addresses is deployed in a dual-device backup scenario, two VRRP groups need to be configured in the same RBP. One of the VRRP groups is bound to an odd MAC address, and the other is bound to an even MAC address. The same VRRP group on two BNGs must be bound to the same odd or even MAC address. Otherwise, the BNGs with the same odd or even MAC address will be master or backup in the two VRRP groups at the same time, and users cannot go online.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=backup-id"><b><span class="cmdname">backup-id</span></b></a> <i><span class="varname">backup-id</span></i> <a href="cmdqueryname=remote-backup-service"><b><span class="cmdname">remote-backup-service</span></b></a> <i><span class="varname">service-name</span></i></span><p><p>A user backup ID is configured for the RBP, and the RBP is associated with a specified RBS.</p>
<p>The <i><span class="varname">backup-id</span></i> parameter specifies a user backup ID for an RBP. You can use a backup ID and an RBS to determine an RBP. The backup IDs configured for the same RBP must be the same on the master and backup devices and can no longer be configured for other RBPs.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure an RBS.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=remote-backup-service"><b><span class="cmdname">remote-backup-service</span></b></a> <i><span class="varname"><span>remote-backup-</span>service-name</span></i></span><p><p>An RBS is created, and the RBS view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=bind+ssl-policy"><b><span class="cmdname">bind ssl-policy</span></b></a> <i><span class="varname">ssl-policy-name</span></i></span><p><p>An SSL policy is bound to a TCP connection.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>You are advised to bind an SSL policy to the RBS to enhance RBS security. If no SSL policy is bound to the RBS, data may be leaked or tampered with.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">peer-ip-address</span></i> <a href="cmdqueryname=source"><b><span class="cmdname">source</span></b></a> <i><span class="varname">source-ip-address</span></i> <a href="cmdqueryname=port"><b><span class="cmdname">port</span></b></a> <i><span class="varname">port-id</span></i></span><p><p>TCP connection parameters are set for the RBS.</p>
<p>The <i><span class="varname">source-ip-address</span></i> and <i><span class="varname">peer-ip-address</span></i> parameters specify the IP addresses of the local and remote devices, respectively. The IP addresses must have been configured on their own interfaces, sub-interfaces, or logical interfaces (such as loopback interfaces) and can ping each other.</p>
<p>The <i><span class="varname">port-id</span></i> parameter specifies a TCP port number. The TCP port numbers configured on the local and remote devices must be the same.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=batch-backup+service-type"><b><span class="cmdname">batch-backup service-type</span></b></a><span> { <strong><span>arp</span></strong> | <strong><span>all</span></strong><span> | <strong><span>ipsec</span></strong></span><span> | <strong><span>bras</span></strong> | <strong><span>l2tp</span></strong></span> | <span><strong><span>dhcp-server</span></strong></span> <span>| <strong><span>nd</span></strong> </span>| <strong><span>dhcpv6-relay</span></strong> } <strong><span>now</span></strong></span></span><p><p>The device is enabled to immediately back up user services configured in the RBS.</p>
</p><p><p>The <strong><span>multicast</span></strong><span>, <strong><span>l2tp,</span></strong></span> and <strong><span>bras</span></strong> parameters are supported only by the admin VS.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure a delay for disabling the forwarding function when the master device becomes the backup device.</span><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The configuration is supported only on the <span class="keyword">NE40E</span><span class="keyword">-M2F</span>, <span class="keyword">NE40E</span><span class="keyword">-M2H</span>, <span class="keyword">NE40E</span><span class="keyword">-M2K</span>, and <span class="keyword">NE40E</span><span class="keyword">-M2K-B</span>.</p>
</div></div>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer-backup+download-vrrp-table+delay-time"><b><span class="cmdname">peer-backup download-vrrp-table delay-time</span></b></a> <i><span class="varname">delay-time-value</span></i></span><p><p>The delay for disabling the forwarding function when the master device becomes the backup device is configured.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_rbs_cfg_0003.html">Configuring Manually Triggered Dual-Device ARP Hot Backup in VRRP Scenarios
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_rbs_cfg_0005.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>