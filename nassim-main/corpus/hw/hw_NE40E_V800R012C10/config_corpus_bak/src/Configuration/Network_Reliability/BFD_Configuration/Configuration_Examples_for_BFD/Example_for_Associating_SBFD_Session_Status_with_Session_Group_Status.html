
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Associating SBFD Session Status with Session Group Status">
<meta name="abstract" content="In this example, the SBFD session status is associated with the session group status to implement fast switching upon multiple points of failure on a segmented cascaded network.">
<meta name="description" content="In this example, the SBFD session status is associated with the session group status to implement fast switching upon multiple points of failure on a segmented cascaded network.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bfd_cfg_0058.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bfd_cfg_2024.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bfd_cfg_2005.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909,m00390128">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BFD">
<meta name="featuretype" content="Network Reliability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BFD">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="BFD">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="BFD">
<meta name="featuretype" content="Network Reliability">
<meta name="OWNER" content="c00376497,p00915595">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00414125">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001343300977">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Associating SBFD Session Status with Session Group Status</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001343300977"></a><a name="EN-US_TASK_0000001343300977"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Associating SBFD Session Status with Session Group Status</h1>
<div class="taskbody"><p>In this example, the SBFD session status is associated with the session group status to implement fast switching upon multiple points of failure on a segmented cascaded network.</p>
<div class="context"><a name="EN-US_TASK_0000001343300977__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0000001343300977__fig_dc_vrp_bfd_cfg_200401">Figure 1</a>, transmission devices exist on the link. When the link between transmission devices fails, fast switching upon multiple points of failure is required on the segmented cascaded network. BFD session 1 is established between DeviceA and DeviceB, and BFD session 2 is established between DeviceB and DeviceD. DeviceB is the SBFD reflector and establishes an SBFD session with DeviceC. BFD session 1 and BFD session 2 are added to the session group on DeviceB. After the SBFD reflector discriminator is associated with the session group, the status change of the BFD session group on DeviceB affects the status of the session between DeviceB and DeviceC.</p>
<div class="fignone" id="EN-US_TASK_0000001343300977__fig_dc_vrp_bfd_cfg_200401"><a name="EN-US_TASK_0000001343300977__fig_dc_vrp_bfd_cfg_200401"></a><a name="fig_dc_vrp_bfd_cfg_200401"></a><span class="figcap"><b>Figure 1 </b>Association between the SBFD session status and the session group status</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1, interface2, and interface3 represent GE <span>0/1/0</span>, GE <span>0/2/0</span>, and GE <span>0/3/0</span>, respectively.</p>
</div></div>
<p><span><img class="vsd" src="figure/en-us_image_0000001359569081.png"></span></p>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001343300977__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Create BFD session 1 between DeviceA and DeviceB, and BFD session 2 between DeviceB and DeviceD.</p>
</li><li><p>Add BFD sessions to a session group on <span class="keyword">Device</span>B.</p>
</li><li>Configure <span class="keyword">Device</span>B as an SBFD reflector.</li><li>Configure <span class="keyword">Device</span>C as an SBFD initiator.</li><li><p>Associate the SBFD session status with the session group status on <span class="keyword">Device</span>B.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001343300977__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><ul><li>A BFD session needs to be established.</li><li>An SBFD session needs to be established.</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001343300977__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li>Peer IP address monitored by BFD</li><li>Local interface that sends and receives BFD packets</li><li>Local and remote discriminators of BFD sessions</li><li>SBFD initiator and reflector</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001343300977__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure IP addresses for interfaces on each device.</span><p><p># Assign an IP address to the interface on <span class="keyword">Device</span>A.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>A</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>ip address 10.1.1.1 24</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>B</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>ip address 10.1.1.2 24</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> interface gigabitethernet <span>0/2/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>ipv6 address 2001:DB8:11::2 64</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>]<strong> quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> interface gigabitethernet <span>0/3/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/3/0</span>] <strong>ip address 10.3.1.1 24</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/3/0</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/3/0</span>] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span>C.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>C</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C]<strong> interface gigabitethernet <span>0/2/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/2/0</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/2/0</span>] <strong>ipv6 address 2001:DB8:11::1 64</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-GigabitEthernet<span>0/2/0</span>]<strong> quit</strong></pre>
<p># Configure <span class="keyword">Device</span>D.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>D</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D]<strong> interface gigabitethernet <span>0/3/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-GigabitEthernet<span>0/3/0</span>] <strong>ip address 10.3.1.2 24</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-GigabitEthernet<span>0/3/0</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D-GigabitEthernet<span>0/3/0</span>]<strong> quit</strong></pre>
</p></li><li><span>Configure single-hop BFD.</span><p><p># Configure a BFD session between <span class="keyword">Device</span>A and <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> bfd</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>bfd singlehop1 bind peer-ip 10.1.1.2 interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-singlehop1]<strong> discriminator local 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-singlehop1]<strong> discriminator remote 2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-singlehop1]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-bfd-session-singlehop1] <strong>quit</strong></pre>
<p># Configure a BFD session between <span class="keyword">Device</span>B and <span class="keyword">Device</span>A, and between <span class="keyword">Device</span>B and <span class="keyword">Device</span>D.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> bfd</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> bfd singlehop1 bind peer-ip 10.1.1.1 interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-session-singlehop1]<strong> discriminator local 2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-session-singlehop1]<strong> discriminator remote 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-session-singlehop1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-bfd-session-singlehop1]<strong> quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> bfd singlehop2 bind peer-ip 10.3.1.2 interface gigabitethernet <span>0/3/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-session-singlehop2]<strong> discriminator local 3</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-session-singlehop2]<strong> discriminator remote 4</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-session-singlehop2] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-bfd-session-singlehop2]<strong> quit</strong></pre>
<p># Configure a BFD session between <span class="keyword">Device</span>D and <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D]<strong> bfd</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-bfd] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D]<strong> bfd singlehop2 bind peer-ip 10.3.1.1 interface gigabitethernet <span>0/3/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-bfd-session-singlehop2]<strong> discriminator local 4</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-bfd-session-singlehop2]<strong> discriminator remote 3</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-bfd-session-singlehop2] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D-bfd-session-singlehop2]<strong> quit</strong></pre>
<p># After completing the configurations, run the <a href="cmdqueryname=display+bfd+session+all+verbose"><b><span class="cmdname">display bfd session all verbose</span></b></a> command on <span class="keyword">Device</span>A, <span class="keyword">Device</span>B, and <span class="keyword">Device</span>D. The command output shows that a single-hop BFD session has been established on each device and its status is Up. The following example uses the command output on <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display bfd session all verbose</strong>
(w): State in WTR
(*): State is invalid
--------------------------------------------------------------------------------
  (One Hop)   State : Up                    Name : singlehop1
--------------------------------------------------------------------------------
  Local Discriminator    : 1                Remote Discriminator   : 2
  Session Detect Mode    : Asynchronous Mode Without Echo Function
  BFD Bind Type          : Interface(GigabitEthernet<span>0/1/0</span>)
  Bind Session Type      : Static
  Bind Peer IP Address   : 10.1.1.2
  Bind Interface         : gigabitethernet<span>0/1/0</span>
  Track Interface        : -
  FSM Board Id           : 3                TOS-EXP                : 7
  Min Tx Interval (ms)   : 10               Min Rx Interval (ms)   : 10
  Actual Tx Interval (ms): 2027             Actual Rx Interval (ms): 2027
  Local Detect Multi     : 3                Detect Interval (ms)   : 30
  Echo Passive           : Disable          Acl Number             : -
  Destination Port       : 3784             TTL                    : 255
  Proc Interface Status  : Disable          Process PST            : Disable
  WTR Interval (ms)      : -                Config PST             : Disable
  Active Multi           : 3
  Last Local Diagnostic  : No Diagnostic
  Bind Application       : No Application Bind
  Session TX TmrID       : 4022103096       Session Detect TmrID   : -
  Session Init TmrID     : -                Session WTR TmrID      : -
  Session Echo Tx TmrID  : -
  Session Description    : -
<span>  Track Group Name       : -</span>
------------------------------------------------------------------------------ 
 
     Total UP/DOWN Session Number : 1/0</pre>
</p></li><li><span>Add BFD sessions to a session group on <span class="keyword">Device</span>B.</span><p><p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>bfd-track-manager </strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-track-manager] <strong>group a</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-track-manager-group-a] <strong>bfd session singlehop1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-track-manager-group-a] <strong>bfd session singlehop2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-track-manager-group-a] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-bfd-track-manager-group-a] <strong>quit</strong></pre>
<p># After completing the configuration, run the <strong>display bfd track-manager all</strong> command on <span class="keyword">Device</span>B. The command output shows that a session group containing single-hop BFD sessions has been established and is in the Up state.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] display bfd track-manager all
--------------------------------------------------------------------------------
  Group Name                    : a
  Group Name Index              : 1
  Group State                   : Up
  Group Down Count              : 10
  Last Down Time                : 2022-06-17 10:51:11
  Last Up Time                  : 2022-06-17 10:49:39
  Group Session Count           : 2
  Total Up/Down Session Number  : 2/0
--------------------------------------------------------------------------------
      Group Session Number      : 1
      Session Name              : singlehop1
      Local Discriminator       : 2
      Session State             : Up
      BFD Bind Type             : Interface(GigabitEthernet<span>0/1/0</span>)
      Process PST               : Disable
--------------------------------------------------------------------------------
      Group Session Number      : 2
      Session Name              : singlehop2
      Local Discriminator       : 3
      Session State             : Up
      BFD Bind Type             : Interface(GigabitEthernet<span>0/3/0</span>)
      Process PST               : Disable
--------------------------------------------------------------------------------</pre>
</p></li><li><span>Configure SBFD for SRv6 TE Policy.</span><p><p># Enable BFD and SBFD on <span class="keyword">Device</span>B and configure it as an SBFD reflector.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> bfd</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>sbfd</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-sbfd] <strong>reflector discriminator 167772160</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-sbfd] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
<p># Configure an SRv6 TE Policy.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> segment-routing ipv6</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-segment-routing-ipv6] <strong>encapsulation source-address </strong><strong>2001:DB8:2::2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-segment-routing-ipv6] <strong>locator asl ipv6-prefix 2001:DB8:20::1 64 static 32</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-segment-routing-ipv6-locator]<strong> </strong><strong>opcode ::1 end psp</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-segment-routing-ipv6-locator]<strong> quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-segment-routing-ipv6] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
<p># Configure IS-IS.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>isis 1</strong>
[<span class="keyword">*</span>DeviceB-isis-1] <strong>is-level level-1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-isis-1] <strong>cost-style wide-compatible</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-isis-1] <strong>network-entity 10.0000.0000.0002.00</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-isis-1] <strong>ipv6 enable topology ipv6</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-isis-1] <strong>segment-routing ipv6 locator as1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-isis-1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface LoopBack 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1] <strong>ipv6 address </strong><strong>2001:DB8:2::2 64</strong> 
[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1] <strong>isis ipv6 enable 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> interface gigabitethernet<span>0/2/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>isis ipv6 enable 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
<p># Enable BFD and SBFD on DeviceC and configure it as an SBFD initiator.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C]<strong> bfd</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-bfd] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>sbfd</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-sbfd] <strong>destination ipv6 </strong><strong>2001:DB8:2::</strong><strong>2 remote-discriminator 167772160</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-sbfd] <strong>commit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-sbfd] <strong>quit</strong></pre>
<p>Configure a global TE IPv6 router ID.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C]<strong> te ipv6-router-id</strong> <strong>2001:DB8:1::1</strong> 
[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>commit</strong></pre>
<p># Configure an SRv6 TE Policy.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C]<strong> segment-routing ipv6</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-segment-routing-ipv6] <strong>encapsulation source-address </strong><strong>2001:DB8:1::1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-segment-routing-ipv6] <strong>locator asl ipv6-prefix 2001:DB8:10::1 64 static 32</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-segment-routing-ipv6-locator] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-segment-routing-ipv6] <strong>srv6-te-policy locator as1</strong> 
[<span class="keyword">*</span><span class="keyword">Device</span>C-segment-routing-ipv6] <strong>segment-list list1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-segment-routing-ipv6-segment-list-list1] <strong>index 5 sid ipv6 2001:DB8:20::1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-segment-routing-ipv6-segment-list-list1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-segment-routing-ipv6-segment] <strong>srv6-te policy policy1 endpoint 2001:DB8:2::2 color 101</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-segment-routing-ipv6-policy-policy1]<strong> </strong><strong>bfd seamless enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-segment-routing-ipv6-policy-policy1]<strong> </strong><strong>candidate-path preference 100</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-segment-routing-ipv6-policy-policy1-path]<strong> </strong><strong>segment-list list1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-segment-routing-ipv6-policy-policy1-path]<strong> quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-segment-routing-ipv6-policy-policy1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-segment-routing-ipv6] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>commit</strong></pre>
<p># Configure IS-IS.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>isis 1</strong>
[<span class="keyword">*</span>DeviceC-isis-1] <strong>is-level level-1</strong>
[<span class="keyword">*</span>DeviceC-isis-1] <strong>cost-style wide-compatible</strong>
[<span class="keyword">*</span>DeviceC-isis-1] <strong>network-entity 10.0000.0000.0001.00</strong>
[<span class="keyword">*</span>DeviceC-isis-1] <strong>ipv6 enable topology ipv6</strong>
[<span class="keyword">*</span>DeviceC-isis-1] <strong>segment-routing ipv6 locator as1</strong>
[<span class="keyword">*</span>DeviceC-isis-1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC] <strong>interface LoopBack 2</strong>
[<span class="keyword">*</span>DeviceC-LoopBack2] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>DeviceC-LoopBack2] <strong>ipv6 address </strong><strong>2001:DB8:1::1 64</strong> 
[<span class="keyword">*</span>DeviceC-LoopBack2] <strong>isis ipv6 enable 1</strong>
[<span class="keyword">*</span>DeviceC-LoopBack2] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC]<strong> interface gigabitethernet<span>0/2/0</span></strong>
[<span class="keyword">*</span>DeviceC-GigabitEthernet<span>0/2/0</span>] <strong>isis ipv6 enable 1</strong>
[<span class="keyword">*</span>DeviceC-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC] <strong>commit</strong></pre>
<p># After completing the configuration, run the <strong>display bfd session all verbose</strong> command on DeviceC. The command output shows that an SBFD session has been established and is in the Up state. The following example uses the command output on DeviceC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] display bfd session all verbose
(w): State in WTR
(*): State is invalid
--------------------------------------------------------------------------------
State : Up                    Name : dyn_16385
--------------------------------------------------------------------------------
Local Discriminator    : 16385            Remote Discriminator   : 167772160
Session Detect Mode    : Seamless Mode Without Echo Function
    BFD Bind Type      : SID_LIST
Bind Session Type      : Dynamic
SID_LIST Id            : 1                Color                  : 101
Bind Peer IP Address   : 2001:db8:2::2
Bind Interface         : -
FSM Board Id           : 3                TOS-EXP                : 7
Min Tx Interval (ms)   : 10               Min Rx Interval (ms)   : 10
Actual Tx Interval (ms): 10             Actual Rx Interval (ms): 10
Local Detect Multi     : 3                Detect Interval (ms)   : 30
Echo Passive           : Disable          Acl Number             : -
Destination Port       : 7784             TTL                    : 255
Proc Interface Status  : Disable          Process PST            : Enable
WTR Interval (ms)      : 1000             Config PST             : Enable
Active Multi           : 50
Last Local Diagnostic  : No Diagnostic
Bind Application       : SRPOLICY6
Session TX TmrID       : -                Session Detect TmrID   : -
Session Init TmrID     : -                Session WTR TmrID      : -
Session Echo Tx TmrID  : -
Session Description    : -
<span>Track Group Name       : -</span>
--------------------------------------------------------------------------------
 
  Total UP/DOWN Session Number : 1/0</pre>
</p></li><li><span>Associate the SBFD reflector with the session group status.</span><p><p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>bfd-track-manager </strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-track-manager]<strong>sbfd reflector 167772160 track group a</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd-track-manager] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-bfd-track-manager] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Run the <strong>shutdown</strong> command on GE <span>0/1/0</span> and GE <span>0/3/0</span> of <span class="keyword">Device</span>B. Both BFD sessions <strong>singlehop1</strong> and <strong>singlehop2</strong> go down.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>shutdown</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>interface gigabitethernet <span>0/3/0</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/3/0</span>] <strong>shutdown</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/3/0</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/3/0</span>] <strong>quit</strong></pre>
<p># Run the <strong>display bfd track-manager all</strong> command on <span class="keyword">Device</span>B. The command output shows that the status of BFD session group <strong>a</strong> is Down.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] display bfd track-manager all
--------------------------------------------------------------------------------
  Group Name                    : a
  Group Name Index              : 1
  Group State                   : Down
  Group Down Count              : 1
  Last Down Time                : 2022-06-17 10:55:11
  Last Up Time                  : 2022-06-17 10:53:39
  Group Session Count           : 1
  Total Up/Down Session Number  : 0/2
--------------------------------------------------------------------------------
      Group Session Number      : 1
      Session Name              : singlehop1
      Local Discriminator       : 2
      Session State             : Down
      BFD Bind Type             : Interface(GigabitEthernet<span>0/1/0</span>)
      Process PST               : Disable
--------------------------------------------------------------------------------
      Group Session Number      : 2
      Session Name              : singlehop2
      Local Discriminator       : 6
      Session State             : Down
      BFD Bind Type             : Interface(GigabitEthernet<span>0/3/0</span>)
      Process PST               : Disable</pre>
<p>Run the <strong>display bfd session all verbose</strong> command on DeviceC. The command output shows that the SBFD session associated with the session group goes down.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C]display bfd session all verbose
(w): State in WTR
(*): State is invalid
--------------------------------------------------------------------------------
<strong>State : Down </strong>                 Name : dyn_16385
--------------------------------------------------------------------------------
Local Discriminator    : 16385            Remote Discriminator   : 167772160
Session Detect Mode    : Seamless Mode Without Echo Function
BFD Bind Type          : SID_LIST
Bind Session Type      : Dynamic
SID_LIST Id            : 1                Color                  : 101
Bind Peer IP Address   : 2001:db8:2::2
Bind Interface         : -
FSM Board Id           : 3                TOS-EXP                : 7
Min Tx Interval (ms)   : 10               Min Rx Interval (ms)   : 10
Actual Tx Interval (ms): 1000             Actual Rx Interval (ms): 1000
Local Detect Multi     : 3                Detect Interval (ms)   : 50000
Echo Passive           : Disable          Acl Number             : -
Destination Port       : 7784             TTL                    : 255
Proc Interface Status  : Disable          Process PST            : Enable
WTR Interval (ms)      : 1000             Config PST             : Enable
Active Multi           : 50
Last Local Diagnostic  : Control Detection Time Expired
Bind Application       : SRPOLICY6
Session TX TmrID       : -                Session Detect TmrID   : -
Session Init TmrID     : -                Session WTR TmrID      : -
Session Echo Tx TmrID  : -
Session Not Up Reason  : In negotiation
Session Description    : -
<span>Track Group Name       : -</span>
--------------------------------------------------------------------------------
 
  Total UP/DOWN Session Number : 0/1</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001343300977__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span>A configuration file</p>
<pre class="screen"># 
sysname DeviceA 
# 
bfd 
# 
interface GigabitEthernet<span>0/1/0</span> 
 undo shutdown 
 ip address 10.1.1.1 255.255.255.0 
# 
bfd singlehop1 bind peer-ip 10.1.1.2 interface GigabitEthernet<span>0/1/0</span> 
 discriminator local 1 
 discriminator remote 2 
#
return</pre>
</li><li><p><span class="keyword">Device</span>B configuration file</p>
<pre class="screen"># 
sysname DeviceB 
# 
bfd 
#
sbfd
 reflector discriminator 167772160
#
segment-routing ipv6
 encapsulation source-address 2001:DB8:2::2
 locator asl ipv6-prefix 2001:DB8:20::1 64 static 32
  opcode ::1 end psp
# 
isis 1
 is-level level-1
 cost-style wide-compatible
 network-entity 10.0000.0000.0002.00
#
ipv6 enable topology ipv6
 segment-routing ipv6 locator asl
#
interface GigabitEthernet<span>0/2/0</span>
 ipv6 enable
 ipv6 address 2001:DB8:11::2/64
 isis ipv6 enable 1
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown 
 ip address 10.1.1.2 255.255.255.0 
#
interface GigabitEthernet<span>0/3/0</span> 
 undo shutdown 
 ip address 10.3.1.1 255.255.255.0
#
interface LoopBack1
 ipv6 enable
 ipv6 address 2001:DB8:2::2/64
 isis ipv6 enable 1
#
bfd singlehop1 bind peer-ip 10.1.1.1 interface GigabitEthernet<span>0/1/0</span> 
 discriminator local 2 
 discriminator remote 1
#
bfd singlehop2 bind peer-ip 10.3.1.2 interface GigabitEthernet<span>0/3/0</span>
 discriminator local 3 
 discriminator remote 4 
#
bfd-track-manager
 group a
  bfd session singlehop1
  bfd session singlehop2
 sbfd reflector 167772160 track group a
#
return</pre>
</li><li><span class="keyword">Device</span>C configuration file<pre class="screen"># 
sysname DeviceC 
# 
bfd 
#
sbfd
 destination ipv6 2001:DB8:2::2 remote-discriminator 167772160
#
te ipv6-router-id 2001:DB8:1::1
#
segment-routing ipv6
 encapsulation source-address 2001:DB8:1::1
 locator asl ipv6-prefix 2001:DB8:10::1 64 static 32
 srv6-te-policy locator asl
 segment-list list1
  index 5 sid ipv6 2001:DB8:20::1
 srv6-te policy policy1 endpoint 2001:DB8:2::2 color 101
  bfd seamless enable
  candidate-path preference 100
   segment-list list1
#
isis 1
 is-level level-1
 cost-style wide-compatible
 network-entity 10.0000.0000.0001.00
#
ipv6 enable topology ipv6
 segment-routing ipv6 locator asl
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown 
 ip address 10.1.1.2 255.255.255.0
#
interface GigabitEthernet<span>0/3/0</span>
 ipv6 enable
 ipv6 address 2001:DB8:11::1/64
 isis ipv6 enable 1
#
interface LoopBack2
 ipv6 enable
 ipv6 address 2001:DB8:1::1/64
 isis ipv6 enable 1
#
return</pre>
</li><li><span class="keyword">Device</span>D configuration file<pre class="screen"># 
sysname DeviceD 
# 
bfd 
# 
interface GigabitEthernet<span>0/3/0</span> 
 undo shutdown 
 ip address 10.3.1.2 255.255.255.0 
# 
bfd singlehop bind peer-ip 10.3.1.1 interface GigabitEthernet<span>0/3/0</span> 
 discriminator local 4 
 discriminator remote 3
# 
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bfd_cfg_0058.html">Configuration Examples for BFD
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bfd_cfg_2024.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bfd_cfg_2005.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>