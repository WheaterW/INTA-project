
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Associating a VRRP Group with an NQA Test Instance">
<meta name="abstract" content="In this example, a VRRP group is associated with an NQA test instance. When NQA detects that a cross-device uplink goes Down, it instructs the VRRP group to perform a master/backup switchover.">
<meta name="description" content="In this example, a VRRP group is associated with an NQA test instance. When NQA detects that a cross-device uplink goes Down, it instructs the VRRP group to perform a master/backup switchover.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_0120.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_0206.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_0208.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00604599">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="Network Reliability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="Network Reliability">
<meta name="OWNER" content="w00604599">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00604599">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172361826">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Associating a VRRP Group with an NQA Test Instance</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172361826"></a><a name="EN-US_TASK_0172361826"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Associating a VRRP Group with an NQA Test Instance</h1>
<div class="taskbody"><p>In this example, a VRRP group is associated with an NQA test instance. When NQA detects that a cross-device uplink goes Down, it instructs the VRRP group to perform a master/backup switchover.</p>
<div class="context"><a name="EN-US_TASK_0172361826__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>VRRP can detect an uplink VRRP-disabled interface fault on a VRRP-enabled <span class="keyword" id="EN-US_TASK_0172361826__en-us_task_0172361779_keyword254322388214306">Router</span>. However, if <span class="keyword" id="EN-US_TASK_0172361826__en-us_task_0172361779_keyword843549024214306">Device</span> C's Interface2 shown in <a href="dc_vrp_vrrp_cfg_0140.html#EN-US_TASK_0172361779__fig_dc_vrp_vrrp_cfg_014001">Figure 1</a> goes Down and its IP address is unreachable, VRRP cannot detect the fault. As a result, user traffic is lost.</p>
<p>The <span class="keyword" id="EN-US_TASK_0172361826__en-us_task_0172361779_keyword1169734069214023">NE40E</span> supports NQA. NQA uses a test instance to send probe packets to check destination IP address reachability.</p>
<p>You can associate VRRP with an NQA test instance to track the master device's uplink (cross-device). If the uplink fails and hosts on the LAN cannot access the external network through the master <span class="keyword" id="EN-US_TASK_0172361826__en-us_task_0172361779_keyword133580207214023">Router</span>, NQA instructs VRRP to reduce the master <span class="keyword" id="EN-US_TASK_0172361826__en-us_task_0172361779_keyword2079808475214023">Router</span>'s priority by a specified value. In this way, another <span class="keyword" id="EN-US_TASK_0172361826__en-us_task_0172361779_keyword1208843593214023">Router</span> in the group has a higher priority, becomes the master, and takes over services, ensuring communication continuity between hosts on a LAN and an external network. After the uplink recovers, NQA instructs VRRP to restore the <span class="keyword" id="EN-US_TASK_0172361826__en-us_task_0172361779_keyword1936114102515">Router</span>'s priority.</p>
<div class="p">As shown in <a href="#EN-US_TASK_0172361826__fig_dc_vrp_vrrp_cfg_014101">Figure 1</a>, a VRRP group is configured on DeviceA and DeviceB, and the IP address of <span class="keyword">Device</span>C's uplink interface is 10.2.1.1. Associate the VRRP group with an NQA test instance with a destination IP address of 10.2.1.1 on DeviceA so that the VRRP group can perform a master/backup VRRP switchover based on the status change in DeviceC's uplink interface. When the uplink interface goes Up, traffic is switched back to the Master device. <div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent GE <span>0/1/0</span> and GE <span>0/2/0</span>, respectively.</p>
</div></div>
</div>
<div class="fignone" id="EN-US_TASK_0172361826__fig_dc_vrp_vrrp_cfg_014101"><a name="EN-US_TASK_0172361826__fig_dc_vrp_vrrp_cfg_014101"></a><a name="fig_dc_vrp_vrrp_cfg_014101"></a><span class="figcap"><b>Figure 1 </b>Associating a VRRP group with an NQA test instance</span><br><span><img class="vsd" src="images/fig_dc_vrp_vrrp_cfg_014101.png"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172361826__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><div class="p"><h4 class="sectiontitle">Precautions</h4><p>To improve security, you are advised to configure a VRRP security policy. For details, see "Example for Configuring a VRRP Group."</p>
<h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Assign an IP address to each interface and configure a routing protocol to ensure link connectivity.</p>
</li><li><p>Create a VRRP group on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B, and ensure that <span class="keyword">Device</span>A is the master and <span class="keyword">Device</span>B is the backup.</p>
</li><li><p>Create an NQA test instance with a destination IP address of 10.2.1.1 (IP address of <span class="keyword">Device</span>C's uplink interface) on <span class="keyword">Device</span>A.</p>
</li><li><p>Associate the VRRP group with the NQA test instance on <span class="keyword">Device</span>A.</p>
</li></ol>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172361826__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Interface IP addresses of the <span class="keyword">Device</span>E, <span class="keyword">Device</span>A, <span class="keyword">Device</span>B, and <span class="keyword">Device</span>C (For details, see <a href="#EN-US_TASK_0172361826__fig_dc_vrp_vrrp_cfg_014101">Figure 1</a>.)</p>
</li><li><p>ID of the VRRP group created on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B: 1; virtual IP address: 10.1.1.10</p>
</li><li><p><span class="keyword">Device</span>A's priority: 120; <span class="keyword">Device</span>B's priority: 100; <span class="keyword">Device</span>B's preemption delay: 20 seconds</p>
</li><li><p>Name of the NQA test instance created on <span class="keyword">Device</span>A: test1; destination IP address of the NQA test instance: 10.2.1.1/24; type of the NQA test instance: ICMP; TTL value carried in an NQA test packet: 10; interval at which NQA tests are performed: 20 seconds</p>
</li><li><p>Value by which <span class="keyword">Device</span>A's priority reduces if the master link goes Down: 40</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172361826__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign IP addresses to <span class="keyword">Device</span>A's interfaces. The configurations of the <span class="keyword">Device</span>E, <span class="keyword">Device</span>B, and <span class="keyword">Device</span>C are similar to the configuration of <span class="keyword">Device</span>A. For configuration details, see <a href="#EN-US_TASK_0172361826__section_05">Configuration Files</a> in this section.</span><p><p># Assign IP addresses to GE <span>0/1/0</span> and GE <span>0/2/0</span>.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>A</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> ip address 10.1.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>]<strong> ip address 10.1.2.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> ip route-static 10.2.1.0 255.255.255.0 10.1.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> commit</strong></pre>
</p></li><li><span>Configure basic VRRP group functions.</span><p><p># Create VRRP group 1 on <span class="keyword">Device</span>A, and set <span class="keyword">Device</span>A's priority to 120 so that <span class="keyword">Device</span>A functions as the master device.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> vrrp vrid 1 virtual-ip 10.1.1.10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> vrrp vrid 1 priority 120</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> vrrp vrid 1 preempt-mode timer delay 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>vrrp recover-delay 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> commit</strong></pre>
<p># Create VRRP group 1 on <span class="keyword">Device</span>B.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>B</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>]<strong> vrrp vrid 1 virtual-ip 10.1.1.10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> commit</strong></pre>
<div class="p">After completing the configurations, run the <a href="cmdqueryname=display+vrrp"><b><span class="cmdname">display vrrp</span></b></a> command on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B. The command outputs show that <span class="keyword">Device</span>A's and <span class="keyword">Device</span>B's VRRP statuses are <strong>Master</strong> and <strong>Backup</strong>, respectively.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display vrrp interface gigabitethernet <span>0/1/0</span> verbose</strong>
GigabitEthernet<span>0/1/0</span> | Virtual Router 1
State          : <strong>Master</strong>
Virtual IP     : 10.1.1.10
Master IP      : 10.1.1.1
Local IP       : 10.1.1.1
PriorityRun    : 120
PriorityConfig : 120
MasterPriority : 120
Preempt        : YES   Delay Time : 20s
Hold Multiplier: 4
TimerRun       : 1s
TimerConfig    : 1s
Auth Type      : NONE
Virtual MAC    : 0000-5e00-0101
Passive Mode      : NO
Check TTL      : YES
Config Type    : normal-vrrp
Backup-forward : disabled
Create Time       : 2013-09-24 15:08:16
Last Change Time  : 2013-09-24 15:08:22</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display vrrp interface gigabitethernet <span>0/1/0</span> verbose</strong>
GigabitEthernet<span>0/1/0</span> | Virtual Router 1
State          : <strong>Backup</strong>
Virtual IP     : 10.1.1.10
Master IP      : 10.1.1.1
Local IP       : 10.1.1.2
PriorityRun    : 100
PriorityConfig : 100
MasterPriority : 120
Preempt        : YES   Delay Time : 0s
Hold Multiplier: 4
TimerRun       : 1s
TimerConfig    : 1s
Auth Type      : NONE
Virtual MAC    : 0000-5e00-0102
Passive Mode      : NO
Check TTL      : YES
Config Type    : normal-vrrp
Backup-forward : disabled
Create Time       : 2013-09-24 15:21:13
Last Change Time  : 2013-09-24 15:21:19</pre>
</div>
</p></li><li><span>Create an NQA test instance with a destination IP address of 10.2.1.1/24 on <span class="keyword">Device</span>A.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> nqa test-instance admin test1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-nqa-admin-test1]<strong> test-type icmp</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-nqa-admin-test1]<strong> destination-address ipv4 10.2.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-nqa-admin-test1]<strong> ttl 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-nqa-admin-test1]<strong> frequency 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-nqa-admin-test1]<strong> start now</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> commit</strong></pre>
<p>After completing the configurations, run the <a href="cmdqueryname=display+nqa+results+test-instance+admin+test1"><b><span class="cmdname">display nqa results test-instance admin test1</span></b></a> command. The command output shows that the status of the NQA test instance is <strong>success</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display nqa results test-instance admin test1</strong>
NQA entry(admin, test1) :testflag is active ,testtype is icmp
  1 .Test 1 result   The test is finished
   Send operation times: 3              Receive response times: 3
   Completion:<strong>success</strong>                  RTD OverThresholds number: 0
   Attempts number:1                    Drop operation number:0
   Disconnect operation number:0        Operation timeout number:0
   System busy operation number:0       Connection fail number:0
   Operation sequence errors number:0   RTT Stats errors number:0
   Destination ip address:10.2.1.1
   Min/Max/Average Completion Time: 60/90/80
   Sum/Square-Sum  Completion Time: 240/19800
   Last Good Probe Time: 2013-09-24 15:30:38.7
   Lost packet ratio: 0 %        </pre>
</p></li><li><span>Associate the VRRP group with the NQA test instance.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> vrrp vrid 1 track nqa admin test1 reduced 40</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>Run the <a href="cmdqueryname=shutdown"><b><span class="cmdname">shutdown</span></b></a> command on <span class="keyword">Device</span>C's GE <span>0/2/0</span> to simulate a link fault.</p>
<p>Run the <a href="cmdqueryname=display+nqa+results+test-instance+admin+test1"><b><span class="cmdname">display nqa results test-instance admin test1</span></b></a> command on <span class="keyword">Device</span>A. The command output shows that the status of the NQA test instance is <strong>failed</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display nqa results test-instance admin test1</strong>
NQA entry(admin, test1) :testflag is active ,testtype is icmp
  1 .Test 1 result   The test is finished
   Send operation times: 3              Receive response times: 0               
   Completion:<strong>failed</strong>                   RTD OverThresholds number: 0            
   Attempts number:1                    Drop operation number:3                 
   Disconnect operation number:0        Operation timeout number:0              
   System busy operation number:0       Connection fail number:0                
   Operation sequence errors number:0   RTT Stats errors number:0               
   Destination ip address:10.2.1.1                                              
   Min/Max/Average Completion Time: 0/0/0                                       
   Sum/Square-Sum  Completion Time: 0/0                                         
   Last Good Probe Time: 2013-09-24 15:40:26.7                                  
   Lost packet ratio: 100 %    </pre>
<div class="p">After 20 seconds, run the <a href="cmdqueryname=display+vrrp"><b><span class="cmdname">display vrrp</span></b></a> command on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B. The command outputs show that <span class="keyword">Device</span>A's and <span class="keyword">Device</span>B's VRRP statuses become <strong>Backup</strong> and <strong>Master</strong>, respectively.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display vrrp</strong>
GigabitEthernet<span>0/1/0</span> | Virtual Router 1
State          : <strong>Backup</strong>
Virtual IP     : 10.1.1.10
Master IP      : 10.1.1.2
PriorityRun    : 80
PriorityConfig : 120
MasterPriority : 100
Preempt        : YES   Delay Time : 20s
Hold Multiplier: 4
TimerRun       : 1s
TimerConfig    : 1s
Auth Type      : NONE
Virtual MAC    : 0000-5e00-0101
Passive Mode      : NO
Check TTL      : YES
Config Type    : normal-vrrp
Backup-forward : disabled
Track NQA         : admin  test1   Priority Reduced : 40
NQA State         : <strong>failed</strong>
Create Time       : 2013-09-24 15:08:16
Last Change Time  : 2013-09-24 15:40:48</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display vrrp</strong>
GigabitEthernet<span>0/1/0</span> | Virtual Router 1
State          : <strong>Master</strong>
Virtual IP     : 10.1.1.10
Master IP      : 10.1.1.2
PriorityRun    : 100
PriorityConfig : 100
MasterPriority : 100
Preempt        : YES   Delay Time : 0s
Hold Multiplier: 4
TimerRun       : 1s
TimerConfig    : 1s
Auth Type      : NONE
Virtual MAC    : 0000-5e00-0102
Passive Mode      : NO
Check TTL      : YES
Config Type    : normal-vrrp
Backup-forward : disabled
Create Time       : 2013-09-24 15:21:13
Last Change Time  : 2013-09-24 15:40:48</pre>
</div>
<div class="p">Run the <a href="cmdqueryname=undo+shutdown"><b><span class="cmdname">undo shutdown</span></b></a> command on <span class="keyword">Device</span>C's GE <span>0/2/0</span>. After GE <span>0/2/0</span> goes Up, wait 20 seconds and then run the <a href="cmdqueryname=display+vrrp"><b><span class="cmdname">display vrrp</span></b></a> command on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B. The command outputs show that <span class="keyword">Device</span>A's and <span class="keyword">Device</span>B's VRRP statuses become <strong>Master</strong> and <strong>Backup</strong>, respectively.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display vrrp interface gigabitethernet </strong><span>0/1/0</span><strong> verbose</strong>
GigabitEthernet<span>0/1/0</span> | Virtual Router 1
State          : <strong>Master</strong>
Virtual IP     : 10.1.1.10
Master IP      : 10.1.1.1
Local IP       : 10.1.1.1
PriorityRun    : 120
PriorityConfig : 120
MasterPriority : 120
Preempt        : YES   Delay Time : 20s
Hold Multiplier: 4
TimerRun       : 1s
TimerConfig    : 1s
Auth Type      : NONE
Virtual Mac    :  0000-5e00-0101
Passive Mode      : NO
Check TTL      : YES
Config type    : normal-vrrp
Backup-forward : disabled
Track NQA      : admin  test1   Priority reduced : 40
NQA state      : <strong>success</strong>
Create Time       : 2013-09-24 15:08:16
Last Change Time  : 2013-09-24 15:58:45</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display vrrp interface gigabitethernet </strong><span>0/1/0</span><strong> verbose</strong>
GigabitEthernet<span>0/1/0</span> | Virtual Router 1
State          : <strong>Backup</strong>
Virtual IP     : 10.1.1.10
Master IP      : 10.1.1.1
Local IP       : 10.1.1.2
PriorityRun    : 100
PriorityConfig : 100
MasterPriority : 120
Preempt        : YES   Delay Time : 0s
Hold Multiplier: 4
TimerRun       : 1s
TimerConfig    : 1s
Auth Type      : NONE
Virtual Mac    :  0000-5e00-0102
Passive Mode      : NO
Check TTL      : YES
Config type    : normal-vrrp
Backup-forward : disabled
Create Time       : 2013-09-24 15:21:13
Last Change Time  : 2013-09-24 15:58:45</pre>
</div>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172361826__section_05"><a name="EN-US_TASK_0172361826__section_05"></a><a name="section_05"></a><a name="EN-US_TASK_0172361826__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span>A configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>A
#
interface GigabitEthernet<span>0/1/0</span>
 ip address 10.1.1.1 255.255.255.0
 vrrp vrid 1 virtual-ip 10.1.1.10
 vrrp vrid 1 priority 120
<span> vrrp vrid 1 preempt-mode timer delay 20</span>
 vrrp recover-delay 20
<span> vrrp vrid 1 track nqa admin test1 reduced 40</span>
#
interface GigabitEthernet<span>0/2/0</span>
 ip address 10.1.2.1 255.255.255.0
#
 ip route-static 10.2.1.0 255.255.255.0 10.1.2.2
#
nqa test-instance admin test1
 test-type icmp
 destination-address ipv4 10.2.1.1
 frequency 20
 ttl 10
 start now
#
return</pre>
</li><li><p><span class="keyword">Device</span>B configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>B
#
interface GigabitEthernet<span>0/1/0</span>
 ip address 10.1.1.2 255.255.255.0
 vrrp vrid 1 virtual-ip 10.1.1.10
#
interface GigabitEthernet<span>0/2/0</span>
 ip address 10.1.2.1 255.255.255.0
#
 ip route-static 10.2.1.0 255.255.255.0 10.1.2.2
#
return </pre>
</li><li><p><span class="keyword">Device</span>C configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>C
#
interface GigabitEthernet<span>0/1/0</span>
 ip address 10.1.2.2 255.255.255.0
#
interface GigabitEthernet<span>0/2/0</span>
 ip address 10.2.1.1 255.255.255.0
#
return </pre>
</li><li><p><span class="keyword">Device</span>E configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>E
#
vlan batch 10
#
interface Vlanif10
 ip address 10.1.1.3 255.255.255.0
#
interface GigabitEthernet<span>0/1/0</span>
 portswitch
 undo shutdown
 port default vlan 10
#
interface GigabitEthernet<span>0/2/0</span>
 portswitch
 undo shutdown
 port default vlan 10
#
return    </pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_0120.html">Configuration Examples for VRRP
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_0206.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_0208.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>