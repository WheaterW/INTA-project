
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring Dual-Root 1+1 Protection">
<meta name="abstract" content="In a GTMv4 over BIERv6 scenario, if a node or link fails, multicast services can be restored only after BGP peer convergence is complete. However, such convergence takes a long time and therefore cannot meet the high reliability requirements of multicast services. To speed up BGP convergence, which in turn accelerates multicast service convergence, you can configure BFD for BGP. You can also deploy the dual-root 1+1 protection solution, which further improves the performance of multicast service convergence.">
<meta name="description" content="In a GTMv4 over BIERv6 scenario, if a node or link fails, multicast services can be restored only after BGP peer convergence is complete. However, such convergence takes a long time and therefore cannot meet the high reliability requirements of multicast services. To speed up BGP convergence, which in turn accelerates multicast service convergence, you can configure BFD for BGP. You can also deploy the dual-root 1+1 protection solution, which further improves the performance of multicast service convergence.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0032.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0037.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0039.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001188582639">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/thickbox.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/imageResize.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery-migrate-1.2.1.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery-ui.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery.mousewheel.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/thickbox.js"></script>
<title>(Optional) Configuring Dual-Root 1+1 Protection</title>
</head>
<body><a name="EN-US_TASK_0000001188582639"></a><a name="EN-US_TASK_0000001188582639"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring Dual-Root 1+1 Protection</h1>
<div class="taskbody"><p>In a GTMv4 over BIERv6 scenario, if a node or link fails, multicast services can be restored only after BGP peer convergence is complete. However, such convergence takes a long time and therefore cannot meet the high reliability requirements of multicast services. To speed up BGP convergence, which in turn accelerates multicast service convergence, you can configure BFD for BGP. You can also deploy the dual-root 1+1 protection solution, which further improves the performance of multicast service convergence.</p>
<div class="context"><a name="EN-US_TASK_0000001188582639__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>In <a href="#EN-US_TASK_0000001188582639__fig2048117501308">Figure 1</a>, the GTMv4 over BIERv6 dual-root 1+1 protection solution is deployed as follows:</p>
<ol><li>Two sender PEs (Root1 and Root2) are deployed. Root1 and Root2 each set up a PMSI tunnel with themselves as the BFIRs. PE1 is a leaf node on the two tunnels.</li><li><p>Flow detection-based multicast FRR is configured on PE1.</p>
</li></ol>
<div class="fignone" id="EN-US_TASK_0000001188582639__fig2048117501308"><a name="EN-US_TASK_0000001188582639__fig2048117501308"></a><a name="fig2048117501308"></a><span class="figcap"><b>Figure 1 </b>GTMv4 over BIERv6 dual-root 1+1 protection networking</span><br><span><img class="imgResize" src="figure/en-us_image_0000001188582655.png" width="522.37828125" height="227.307486301875" title="Click to enlarge"></span></div>
<div class="note" id="EN-US_TASK_0000001188582639__note5177844164813"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001188582639__p11771644194815">When leaf nodes establish dual-plane BGP peer relationships with the same root node, public network unicast supports FRR between IPv4 and IPv6 peers. As a result, the primary and backup multicast routes may pass through the same root node, and dual-root protection cannot be implemented. To address this problem, configure BGP preferences or use a route-policy so that primary and backup BGP public network unicast routes are formed on the two root nodes.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001188582639__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Two sender PEs (Root1 and Root2) are deployed. Root1 and Root2 each set up a PMSI tunnel with themselves as the BFIRs.</span><p><p>For details, see <a href="dc_bierv6_cfg_0009.html">Configuring BGP MVPN Peer Relationships</a>, <a href="dc_bierv6_cfg_0010.html">(Optional) Configuring Multicast Traffic Forwarding over a BIERv6 I-PMSI Tunnel</a>, and <a href="dc_bierv6_cfg_0011.html">(Optional) Enabling the BIERv6 S-PMSI Tunnel Function and Configuring Switching Criteria</a>.</p>
</p></li><li><span>Configure flow detection-based multicast FRR on PE1.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=acl"><b><span class="cmdname">acl</span></b></a> [ <strong><span>number</span></strong> ] <i><span class="varname">basic-acl-number</span></i></span><p><p>A basic ACL to be associated with C-multicast FRR is created, and the basic ACL view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=rule"><b><span class="cmdname">rule </span></b></a>[ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } [ <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">src-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>vpn-instance-any</span></strong> ] | <strong><span>logging</span></strong> ] <sup>*</sup></span><p><p>A rule is configured for the ACL.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the basic ACL view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=multicast+mvpn+ipv6-underlay"><b><span class="cmdname">multicast mvpn ipv6-underlay</span></b></a> <i><span class="varname">mvpnid</span></i></span><p><p>An MVPN IPv6 ID is configured.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=multicast+vpn-public"><b><span class="cmdname">multicast vpn-public</span></b></a></span><p><p>The public network IPv4 address family MVPN view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=c-multicast+frr"><b><span class="cmdname">c-multicast frr</span></b></a> [ <i><span class="varname">frrPlyNum</span></i> | <strong><span>acl-name</span></strong> <i><span class="varname">acl-name</span></i> ]</span><p><p>C-multicast FRR is enabled.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=c-multicast+frr+flow-detection-based"><b><span class="cmdname">c-multicast frr flow-detection-based</span></b></a> { <i><span class="varname">frrPlyNum</span></i> | <strong><span>acl-name</span></strong> <i><span class="varname">acl-name</span></i> }</span><p><p>The flow detection mode is configured for C-multicast FRR. </p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the public network IPv4 address family MVPN view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0032.html">Configuring GTMv4 over BIERv6
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0037.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0039.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>

<script language="JavaScript">
<!--
image_size('.imgResize');
var msg_imageMax = "view original image";
var msg_imageClose = "close";
//--></script></body>
</html>