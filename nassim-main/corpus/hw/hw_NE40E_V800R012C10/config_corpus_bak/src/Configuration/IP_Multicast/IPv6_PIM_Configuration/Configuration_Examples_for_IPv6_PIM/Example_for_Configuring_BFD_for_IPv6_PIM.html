
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring BFD for IPv6 PIM">
<meta name="abstract" content="This section provides an example for configuring Bidirectional Forwarding Detection (BFD) for IPv6 PIM, so that user hosts can quickly respond to Designated router (DR) changes.">
<meta name="description" content="This section provides an example for configuring Bidirectional Forwarding Detection (BFD) for IPv6 PIM, so that user hosts can quickly respond to Designated router (DR) changes.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2036.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2163.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPv6 PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv6 PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IPv6 PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IPv6 PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172367531">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring BFD for IPv6 PIM</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172367531"></a><a name="EN-US_TASK_0172367531"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring BFD for IPv6 PIM</h1>
<div class="taskbody"><p>This section provides an example for configuring Bidirectional Forwarding Detection (BFD) for IPv6 PIM, so that user hosts can quickly respond to Designated router (DR) changes.</p>
<div class="context"><a name="EN-US_TASK_0172367531__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In multicast applications, if the current DR is faulty on the shared network segment, other PIM neighbors do not trigger a new round of DR election until the neighbor relationships time out. Consequently, multicast data transmission is interrupted. The period during which multicast data transmission is interrupted, usually in seconds, is not shorter than the timeout period of the neighbor relationship. BFD can detect the link status on the shared network segment within milliseconds and fast respond to the faults of PIM neighbors. You can use both BFD for IPv6 PIM and the DR switching delay, shortening the transmission interruption time of multicast data and improving the reliability of multicast data transmission.</p>
<p>On the network shown in <a href="#EN-US_TASK_0172367531__fig_dc_vrp_multicast_cfg_216401">Figure 1</a>, the downstream interface GE <span>0/2/0</span> of <span class="keyword">Device</span> C functions as the current DR and is responsible for forwarding multicast data to Receiver and the host can receive VoD information from the multicast source. After BFD for IPv6 PIM is deployed on the shared network segment where <span class="keyword">Device</span> B and <span class="keyword">Device</span> C reside, PIM can quickly detect the fault if the GE <span>0/2/0</span> of <span class="keyword">Device</span> C is faulty. Then, PIM triggers a DR election. The GE <span>0/2/0</span> of <span class="keyword">Device</span> B is immediately elected as the new DR and is responsible for forwarding multicast data. Then, multicast data is immediately switched to the new path. This shortens the period during which multicast data transmission is interrupted and increases the reliability of multicast data transmission. In addition, the DR switchover delay needs to be set. Then, after the faulty DR (the GE <span>0/2/0</span> of <span class="keyword">Device</span> C) on the network recovers, DR election is re-performed and the routing table is rebuilt. During this process, the interface maintains the original multicast forwarding entry to shorten the interruption period of multicast data transmission to the maximum extent.</p>
<div class="fignone" id="EN-US_TASK_0172367531__fig_dc_vrp_multicast_cfg_216401"><a name="EN-US_TASK_0172367531__fig_dc_vrp_multicast_cfg_216401"></a><a name="fig_dc_vrp_multicast_cfg_216401"></a><span class="figcap"><b>Figure 1 </b>Configuring BFD for IPv6 PIM</span><br><span><img class="vsd" src="images/fig_dc_vrp_multicast_cfg_216401.png"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="25%" id="mcps1.4.1.5.1.5.1.1" liSelected="liSelected"><p>Device</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="25%" id="mcps1.4.1.5.1.5.1.2" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="25%" id="mcps1.4.1.5.1.5.1.3" liSelected="liSelected"><p>IPv6 Address</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="25%" id="mcps1.4.1.5.1.5.1.4" liSelected="liSelected"><p>Link-local address</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="4" valign="top" width="25%" headers="mcps1.4.1.5.1.5.1.1 "><p><span class="keyword">Device</span>A</p>
<p></p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.5.1.5.1.2 "><p>interface1, GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.5.1.5.1.3 "><p>2001:db8:1::2/64</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.5.1.5.1.4 "><p>FE80::2</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.5.1.2 "><p>interface2, GigabitEthernet<span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.5.1.3 "><p>2001:db8:2::1/64</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.5.1.4 "><p>FE80::3</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.5.1.2 "><p>interface3, GigabitEthernet<span>0/3/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.5.1.3 "><p>2001:db8:3::1/64</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.5.1.4 "><p>FE80::4</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.5.1.2 "><p>Loopback0</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.5.1.3 "><p>2001:db8:7::7/128</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.5.1.4 "><p>FE80::1</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" valign="top" width="25%" headers="mcps1.4.1.5.1.5.1.1 "><p><span class="keyword">Device</span>B</p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.5.1.5.1.2 "><p>interface1, GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.5.1.5.1.3 "><p>2001:db8:2::2/64</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.5.1.5.1.4 "><p>FE80::5</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.5.1.2 "><p>interface2, GigabitEthernet<span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.5.1.3 "><p>2001:db8:4::1/64</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.5.1.4 "><p>FE80::6</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" valign="top" width="25%" headers="mcps1.4.1.5.1.5.1.1 "><p><span class="keyword">Device</span>C</p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.5.1.5.1.2 "><p>interface1, GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.5.1.5.1.3 "><p>2001:db8:3::2/64</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.5.1.5.1.4 "><p>FE80::8</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.5.1.2 "><p>interface2, GigabitEthernet<span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.5.1.3 "><p>2001:db8:4::2/64</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.5.1.4 "><p>FE80::7</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172367531__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure basic functions of IPv6 multicast.</p>
</li><li><p>Enable BFD globally.</p>
</li><li><p>Enable BFD for IPv6 PIM on the interface connecting the <span class="keyword">Router</span> to the network segment to which user hosts belong and configure BFD parameters.</p>
</li><li><p>Configure the DR switch delay on the interface connecting the <span class="keyword">Router</span> to the network segment to which user hosts belong.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172367531__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Multicast source address</p>
</li><li><p>Multicast group address</p>
</li><li><p>BFD parameters: minimum sending interval, minimum receiving interval, and local detection multiplier of PIM IPv6 BFD packets</p>
</li><li><p>DR switchover delay</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172367531__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure an IPv6 address and a link-local address for each interface on the <span class="keyword">Router</span> and configure a unicast routing protocol. For configuration details, see <a href="#EN-US_TASK_0172367531__section_dc_vrp_multicast_cfg_216405">Configuration Files</a> in this section.</span><p><p># Configure an IPv6 address and a link-local address for each interface on the <span class="keyword">Router</span> based on <a href="#EN-US_TASK_0172367531__fig_dc_vrp_multicast_cfg_216401">Figure 1</a> and run OSPFv3 between <span class="keyword">Router</span>s to ensure that they communicate with each other. For configuration details, see Configuration Files in this section.</p>
</p></li><li><span>Enable IPv6 multicast routing on all <span class="keyword">Router</span>s. Enable IPv6 PIM-SM on each interface of <span class="keyword">Router</span>s and enable MLD on the interfaces connecting <span class="keyword">Router</span>s to user hosts.</span><p><p># Configure <span class="keyword">Device</span> B. The configurations of <span class="keyword">Device</span> A and <span class="keyword">Device</span> C are similar to the configuration of <span class="keyword">Device</span> B. For configuration details, see Configuration Files in this section.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>multicast ipv6 routing-enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>pim ipv6 sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>mld enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>pim ipv6 sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
</p></li><li><span>Configure an RP.</span><p><p># Create a loopback interface on <span class="keyword">Device</span> A and enable IPv6 PIM-SM; configure the loopback interface to function as both Candidate-Rendezvous Points (C-RPs) and Candidate-BootStrap Routers (C-BSRs).</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Loopback0] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Loopback0] <strong>ipv6 address 2001:db8:7::7 128</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Loopback0] <strong>pim ipv6 sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Loopback0] <strong>ospfv3 1 area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Loopback0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>pim-ipv6</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-pim6] <strong>c-bsr 2001:db8:7::7</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-pim6] <strong>c-rp 2001:db8:7::7</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-pim6] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-pim6] <strong>quit</strong></pre>
</p></li><li><span>Enable BFD globally, configure BFD for IPv6 PIM on the interfaces connecting the <span class="keyword">Router</span>s to the user network segment, and configure BFD parameters.</span><p><p># Configure <span class="keyword">Device</span> B. The configuration of <span class="keyword">Device</span> C is similar to the configuration of <span class="keyword">Device</span> B. For configuration details, see Configuration Files in this section.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>bfd</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>pim ipv6 bfd enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>pim ipv6 bfd min-tx-interval 200 min-rx-interval 200 detect-multiplier 4</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
</p></li><li><span>Configure the DR switch delay on the interfaces that connect <span class="keyword">Router</span>s to the user network segment.</span><p><p># Configure <span class="keyword">Router</span> B. The configuration of <span class="keyword">Router</span> C is similar to the configuration of <span class="keyword">Router</span> B. For configuration details, see Configuration Files in this section.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>pim ipv6 timer dr-switch-delay 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Have the multicast source (2001:db8:1::1) send data to the multicast group (FF2E::1) and have Receiver send an MLD Report message to the multicast group. Ensure that Receiver can receive the data from the multicast source. Run the <strong>display pim ipv6 interface gigabitethernet <span>0/2/0</span> verbose</strong> command to check detailed configurations of the PIM interface connecting the <span class="keyword">Router</span> to the user host.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>B&gt; <strong>display pim ipv6 interface gigabitethernet <span>0/2/0</span> verbose</strong></pre>
<pre class="screen"> VPN-Instance: public net
 Interface: GigabitEthernet<span>0/2/0</span>, FE80::6
     PIM version: 2
     PIM mode: Sparse
     PIM state: up
     PIM DR: FE80::7
     PIM DR Priority (configured): 1
     PIM neighbor count: 1
     PIM hello interval: 30 s
     PIM LAN delay (negotiated): 500 ms
     PIM LAN delay (configured): 500 ms
     PIM hello override interval (negotiated): 2500 ms
     PIM hello override interval (configured): 2500 ms
     PIM Silent: disabled
     PIM neighbor tracking (negotiated): disabled
     PIM neighbor tracking (configured): disabled
     PIM generation ID: 0X1DD32289
     PIM require-GenID: disabled
     PIM hello hold interval: 105 s
     PIM assert hold interval: 180 s
     PIM triggered hello delay: 5 s
     PIM J/P interval: 60 s
     PIM J/P hold interval: 210 s
     PIM BSR domain border: disabled
     <strong>PIM BFD: enabled</strong>
     <strong>PIM BFD min-tx-interval: 200 ms</strong>
     <strong>PIM BFD min-rx-interval: 200 ms</strong>
     <strong>PIM BFD detect-multiplier: 4</strong>
     <strong>PIM dr-switch-delay timer: 20 s</strong>
     Number of routers on link not using DR priority: 0
     Number of routers on link not using LAN delay: 0
     Number of routers on link not using neighbor tracking: 2
     ACL of PIM neighbor policy: -
     ACL of PIM ASM join policy: -
     ACL of PIM SSM join policy: -
     ACL of PIM join policy: -
     <span>PIM ipsec: enabled (sa-name: 1)</span></pre>
<pre class="screen">&lt;<span class="keyword">Device</span>C&gt; <strong>display pim ipv6 interface gigabitethernet <span>0/2/0</span> verbose</strong></pre>
<pre class="screen"> VPN-Instance: public net
 Interface: GigabitEthernet<span>0/2/0</span>, FE80::7
     PIM version: 2
     PIM mode: Sparse
     PIM state: up
     PIM DR: FE80::7 (local)
     PIM DR Priority (configured): 1
     PIM neighbor count: 1
     PIM hello interval: 30 s
     PIM LAN delay (negotiated): 500 ms
     PIM LAN delay (configured): 500 ms
     PIM hello override interval (negotiated): 2500 ms
     PIM hello override interval (configured): 2500 ms
     PIM Silent: disabled
     PIM neighbor tracking (negotiated): disabled
     PIM neighbor tracking (configured): disabled
     PIM generation ID: 0X8365186A
     PIM require-GenID: disabled
     PIM hello hold interval: 105 s
     PIM assert hold interval: 180 s
     PIM triggered hello delay: 5 s
     PIM J/P interval: 60 s
     PIM J/P hold interval: 210 s
     PIM BSR domain border: disabled
     <strong>PIM BFD: enabled</strong>
     <strong>PIM BFD min-tx-interval: 200 ms</strong>
     <strong>PIM BFD min-rx-interval: 200 ms</strong>
     <strong>PIM BFD detect-multiplier: 4</strong>
     <strong>PIM dr-switch-delay timer: 20 s</strong>
     Number of routers on link not using DR priority: 0
     Number of routers on link not using LAN delay: 0
     Number of routers on link not using neighbor tracking: 2
     ACL of PIM neighbor policy: -
     ACL of PIM ASM join policy: -
     ACL of PIM SSM join policy: -
     ACL of PIM join policy: -
     <span>PIM ipsec: enabled (sa-name: 1)</span></pre>
<p>The preceding information indicates that the downstream interface GE <span>0/2/0</span> of <span class="keyword">Device</span> C is the current DR. BFD for IPv6 PIM is enabled on the interfaces connecting <span class="keyword">Device</span> B and <span class="keyword">Device</span> C to user hosts, and detection parameters and a DR switchover delay are configured.</p>
<p># Run the <strong>display pim ipv6 neighbor interface gigabitethernet <span>0/2/0</span> verbose</strong> command on <span class="keyword">Device</span> B to check whether BFD sessions are set up.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>B&gt; <strong>display pim ipv6 neighbor interface gigabitethernet <span>0/2/0</span> verbose</strong></pre>
<pre class="screen"> VPN-Instance: public net

 Total Number of Neighbors on this interface  = 1

 Neighbor: FE80::7
     Interface: GigabitEthernet<span>0/2/0</span>
     Uptime: 00:00:52
     Expiry time: 00:01:39
     DR Priority: 1
     Generation ID: 0X8365186A
     Holdtime: 105 s
     LAN delay: 500 ms
     Override interval: 2500 ms
     Neighbor tracking: Disabled
     <strong>PIM BFD-Session: Y</strong>
     PIM BFD-Session min-tx-interval: 200 ms
     PIM BFD-Session min-rx-interval: 200 ms
     PIM BFD-Session detect-multiplier: 4
     Neighbor Secondary Address(es):
     2001:DB8:4::2</pre>
<p>The command output shows that the BFD sessions are set up.</p>
<p># Run the <strong>display pim ipv6 bfd session</strong> command to check configurations of BFD sessions on each <span class="keyword">Router</span>.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>B&gt; <strong>display pim ipv6 bfd session</strong></pre>
<pre class="screen"> VPN-Instance: public net
 Total 1 BFD session Created

 GigabitEthernet<span>0/2/0</span> (FE80::6): Total 1 BFD session Created

 Neighbor        ActTx(ms) ActRx(ms) ActMulti Local/Remote State
 FE80::7         200       200       4         8208/8206   Up
</pre>
<pre class="screen">&lt;<span class="keyword">Device</span>C&gt; <strong>display pim ipv6 bfd session</strong></pre>
<pre class="screen"> VPN-Instance: public net
 Total 1 BFD session Created

 GigabitEthernet<span>0/2/0</span> (FE80::7): Total 1 BFD session Created

 Neighbor        ActTx(ms) ActRx(ms) ActMulti Local/Remote State
 FE80::6         200       200       4         8206/8208   Up
</pre>
<p>The command output shows that the BFD session is in the Up state, and the sending interval and receiving interval of BFD packets are both 200 ms, and the detection multiplier is 4.</p>
<p># Run the <strong>display pim ipv6 routing-table</strong> command to check the IPv6 PIM routing table. The command output on <span class="keyword">Device</span> C shows that multicast routing entries exist.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>C&gt; <strong>display pim ipv6 routing-table</strong></pre>
<pre class="screen"> VPN-Instance: public net
 Total 1 (*, G) entry; 1 (S, G) entry

 (*, FF2E::1)
     RP: 2001:DB8:7::7
     Protocol: pim-sm, Flag: WC
     UpTime: 00:00:53
     Upstream interface: GigabitEthernet<span>0/1/0</span>, Refresh time: 00:00:53
         Upstream neighbor: FE80::4
         RPF prime neighbor: FE80::4
     Downstream interface(s) information:
     Total number of downstreams: 1
         1: GigabitEthernet<span>0/2/0</span>
             Protocol: mld, UpTime: 00:00:53, Expires: -

 (2001:DB8:1::1, FF2E::1)
     RP: 2001:DB8:7::7
     Protocol: pim-sm, Flag: SPT ACT
     UpTime: 00:00:53
     Upstream interface: GigabitEthernet<span>0/1/0</span>, Refresh time: 00:00:53
         Upstream neighbor: FE80::4
         RPF prime neighbor: FE80::4
     Downstream interface(s) information:
     Total number of downstreams: 1
         1: GigabitEthernet<span>0/2/0</span>
             Protocol: pim-sm, UpTime: 00:00:53, Expires: -
</pre>
<p># Simulate a fault on the downstream GE <span>0/2/0</span> of <span class="keyword">Device</span> C and run the <strong>display pim ipv6 interface gigabitethernet <span>0/2/0</span> verbose</strong> command on <span class="keyword">Device</span> B to check detailed information about the PIM interface. The command output is as follows:</p>
<pre class="screen">&lt;<span class="keyword">Device</span>B&gt; <strong>display pim ipv6 interface gigabitethernet <span>0/2/0</span> verbose</strong></pre>
<pre class="screen"> VPN-Instance: public net
 Interface: GigabitEthernet<span>0/2/0</span>, FE80::6
     PIM version: 2
     PIM mode: Sparse
     PIM state: up
     PIM DR: FE80::6 (local)
     PIM DR Priority (configured): 1
     PIM neighbor count: 1
     PIM hello interval: 30 s
     PIM LAN delay (negotiated): 500 ms
     PIM LAN delay (configured): 500 ms
     PIM hello override interval (negotiated): 2500 ms
     PIM hello override interval (configured): 2500 ms
     PIM Silent: disabled
     PIM neighbor tracking (negotiated): disabled
     PIM neighbor tracking (configured): disabled
     PIM generation ID: 0X1DD32289
     PIM require-GenID: disabled
     PIM hello hold interval: 105 s
     PIM assert hold interval: 180 s
     PIM triggered hello delay: 5 s
     PIM J/P interval: 60 s
     PIM J/P hold interval: 210 s
     PIM BSR domain border: disabled
     PIM BFD: enabled
     PIM BFD min-tx-interval: 200 ms
     PIM BFD min-rx-interval: 200 ms
     PIM BFD detect-multiplier: 4
     PIM dr-switch-delay timer: 20 s
     Number of routers on link not using DR priority: 0
     Number of routers on link not using LAN delay: 0
     Number of routers on link not using neighbor tracking: 2
     ACL of PIM neighbor policy: -
     ACL of PIM ASM join policy: -
     ACL of PIM SSM join policy: -
     ACL of PIM join policy: -
     <span>PIM ipsec: enabled (sa-name: 1)</span></pre>
<p>The command output shows that after GE <span>0/2/0</span> of <span class="keyword">Device</span> C fails, GE <span>0/2/0</span> of <span class="keyword">Device</span> B is elected as the DR.</p>
<p># Run the <strong>display pim ipv6 routing-table</strong> command to check the IPv6 PIM routing table. The command output on <span class="keyword">Device</span> B shows that multicast routing entries exist.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>B&gt; <strong>display pim ipv6 routing-table</strong></pre>
<pre class="screen"> VPN-Instance: public net
 Total 1 (*, G) entry; 1 (S, G) entry

 (*, FF2E::1)
     RP: 2001:DB8:7::7
     Protocol: pim-sm, Flag: WC
     UpTime: 00:00:53
     Upstream interface: GigabitEthernet<span>0/1/0</span>, Refresh time: 00:00:53
         Upstream neighbor: FE80::3
         RPF prime neighbor: FE80::3
     Downstream interface(s) information:
     Total number of downstreams: 1
         1: GigabitEthernet<span>0/2/0</span>
             Protocol: mld, UpTime: 00:00:53, Expires: -

 (2001:DB8:1::1, FF2E::1)
     RP: 2001:DB8:7::7
     Protocol: pim-sm, Flag: SPT ACT
     UpTime: 00:00:53
     Upstream interface: GigabitEthernet<span>0/1/0</span>, Refresh time: 00:00:53
         Upstream neighbor: FE80::3
         RPF prime neighbor: FE80::3
     Downstream interface(s) information:
     Total number of downstreams: 1
         1: GigabitEthernet<span>0/2/0</span>
             Protocol: pim-sm, UpTime: 00:00:53, Expires: -
</pre>
<p>The command output shows that after GE <span>0/2/0</span> of <span class="keyword">Device</span> C fails, multicast traffic is fast switched to a new path. GE <span>0/2/0</span> of <span class="keyword">Device</span> B is elected as a new DR.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172367531__section_dc_vrp_multicast_cfg_216405"><a name="EN-US_TASK_0172367531__section_dc_vrp_multicast_cfg_216405"></a><a name="section_dc_vrp_multicast_cfg_216405"></a><a name="EN-US_TASK_0172367531__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span> A configuration file</p>
<pre class="screen">#</pre>
<pre class="screen"> sysname <span class="keyword">Device</span>A</pre>
<pre class="screen">#
 ipv6
#
 multicast ipv6 routing-enable
#
ospfv3 1
 router-id 10.2.2.2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:1::2/64
 ipv6 address FE80::2 link-local
 ospfv3 1 area 0.0.0.0
 pim ipv6 sm
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:2::1/64
 ipv6 address FE80::3 link-local
 ospfv3 1 area 0.0.0.0
 pim ipv6 sm
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:3::1/64
 ipv6 address FE80::4 link-local
 ospfv3 1 area 0.0.0.0
 pim ipv6 sm
#
interface LoopBack0
 ipv6 enable
 ipv6 address 2001:DB8:7::7/128
 ipv6 address FE80::1 link-local
 ospfv3 1 area 0.0.0.0
 pim ipv6 sm
#
<span>pim-ipv6</span>
 c-bsr 2001:DB8:7::7
 c-rp 2001:DB8:7::7
#
return</pre>
</li><li><p><span class="keyword">Device</span> B configuration file</p>
<pre class="screen">#</pre>
<pre class="screen"> sysname <span class="keyword">Device</span>B</pre>
<pre class="screen">#
 ipv6
#
 multicast ipv6 routing-enable
#
 bfd
#
ospfv3 1
 router-id 10.3.3.3
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:2::2/64
 ipv6 address FE80::5 link-local
 ospfv3 1 area 0.0.0.0
 pim ipv6 sm
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:4::1/64
 ipv6 address FE80::6 link-local
 ospfv3 1 area 0.0.0.0
 pim ipv6 timer dr-switch-delay 20
 pim ipv6 sm
 pim ipv6 bfd enable
 pim ipv6 bfd min-tx-interval 200 min-rx-interval 200 detect-multiplier 4
 mld enable
#
return
</pre>
</li><li><p><span class="keyword">Device</span> C configuration file</p>
<pre class="screen">#</pre>
<pre class="screen"> sysname <span class="keyword">Device</span>C</pre>
<pre class="screen">#
 ipv6
#
 multicast ipv6 routing-enable
#
 bfd
#
ospfv3 1
 router-id 10.4.4.4
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:3::2/64
 ipv6 address FE80::8 link-local
 ospfv3 1 area 0.0.0.0
 pim ipv6 sm
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:4::2/64
 ipv6 address FE80::7 link-local
 ospfv3 1 area 0.0.0.0
 pim ipv6 timer dr-switch-delay 20
 pim ipv6 sm
 pim ipv6 bfd enable
 pim ipv6 bfd min-tx-interval 200 min-rx-interval 200 detect-multiplier 4
 mld enable
#
return
</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2036.html">Configuration Examples for IPv6 PIM
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2163.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>