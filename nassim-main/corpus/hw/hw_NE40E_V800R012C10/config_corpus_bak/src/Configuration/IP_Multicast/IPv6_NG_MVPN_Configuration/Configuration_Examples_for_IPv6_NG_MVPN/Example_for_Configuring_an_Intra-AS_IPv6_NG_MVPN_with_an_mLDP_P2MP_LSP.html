
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring an Intra-AS IPv6 NG MVPN with an mLDP P2MP LSP">
<meta name="abstract" content="This section provides an example for configuring an intra-AS IPv6 NG MVPN to carry multicast traffic over an mLDP P2MP LSP.">
<meta name="description" content="This section provides an example for configuring an intra-AS IPv6 NG MVPN to carry multicast traffic over an mLDP P2MP LSP.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0212.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0273.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPv6 Multicast VPN">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv6 Multicast VPN">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IPv6 Multicast VPN">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IPv6 Multicast VPN">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172367584">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring an Intra-AS IPv6 NG MVPN with an mLDP P2MP LSP</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172367584"></a><a name="EN-US_TASK_0172367584"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring an Intra-AS IPv6 NG MVPN with an mLDP P2MP LSP</h1>
<div class="taskbody"><p>This section provides an example for configuring an intra-AS IPv6 NG MVPN to carry multicast traffic over an mLDP P2MP LSP.</p>
<div class="context"><a name="EN-US_TASK_0172367584__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>A next-generation multicast virtual private network (NG MVPN) is deployed on the service provider's backbone network to solve multicast service issues related to traffic congestion, transmission reliability, and data security. On the IPv6 NG MVPN networking shown in <a href="#EN-US_TASK_0172367584__fig_dc_vrp_cfg_ngmvpn_021301">Figure 1</a>, MPLS LDP LSPs have been deployed to carry BGP MPLS/IP VPN services. The service provider wants to provide MVPN services for users based on the existing IPv6 network. To meet this requirement, configure an intra-AS NG MVPN to carry multicast traffic over a Multipoint extensions for LDP (mLDP) point-to-multipoint (P2MP) LSP.</p>
<div class="fignone" id="EN-US_TASK_0172367584__fig_dc_vrp_cfg_ngmvpn_021301"><a name="EN-US_TASK_0172367584__fig_dc_vrp_cfg_ngmvpn_021301"></a><a name="fig_dc_vrp_cfg_ngmvpn_021301"></a><span class="figcap"><b>Figure 1 </b>Intra-AS NG MVPN networking</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example are GE <span>0/1/0</span>, GE <span>0/1/1</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_cfg_ngmvpn_021301.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172367584__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure BGP MPLS/IP VPN to ensure that unicast VPN services are properly transmitted. In this example, configure CE1 to communicate with CE2.</p>
</li><li><p>Enable mLDP globally on the provider edges (PEs) so that the PEs can use mLDP to establish a P2MP LSP.</p>
</li><li><p>Establish BGP MVPN peer relationships between the PEs so that the PEs can use BGP to exchange BGP A-D and BGP C-multicast routes.</p>
</li><li><p>Configure PE1 to use mLDP to establish an Inclusive-Provider Multicast Service Interface (I-PMSI) tunnel.</p>
</li><li><p>Configure PE1 to use mLDP to establish a Selective-Provider Multicast Service Interface (S-PMSI) tunnel so that an mLDP P2MP LSP can be triggered.</p>
</li><li><p>Configure PIM on the PE interfaces bound to VPN instances and on the CE interfaces connecting to PEs to allow a VPN multicast routing table to be established to guide multicast traffic forwarding.</p>
</li><li><p>Configure MLD on the interfaces connecting a multicast device to a user network segment to allow the device to manage multicast group members on the network segment.</p>
</li><li><p>Configure the interface connecting a user network segment to statically join an IPv6 multicast group.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172367584__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IS-IS process ID: 1</p>
</li><li><div class="p">VPN instance name on PE1 and PE2: VPNA (as shown in <a href="#EN-US_TASK_0172367584__table_dc_vrp_cfg_ngmvpn_021301">Table 1</a>)
<div class="tableBorder"><a name="EN-US_TASK_0172367584__table_dc_vrp_cfg_ngmvpn_021301"></a><a name="table_dc_vrp_cfg_ngmvpn_021301"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172367584__table_dc_vrp_cfg_ngmvpn_021301" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Data needed for each device</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="17.421731123388582%" id="mcps1.4.3.3.2.1.2.2.8.1.1" liSelected="liSelected"><p>Device</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="17.421731123388582%" id="mcps1.4.3.3.2.1.2.2.8.1.2" liSelected="liSelected"><p>IP Address of Loopback0</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="17.421731123388582%" id="mcps1.4.3.3.2.1.2.2.8.1.3" liSelected="liSelected"><p>MPLS LSR-ID</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="17.421731123388582%" id="mcps1.4.3.3.2.1.2.2.8.1.4" liSelected="liSelected"><p>MVPN ID</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="6.445672191528545%" id="mcps1.4.3.3.2.1.2.2.8.1.5" liSelected="liSelected"><p>RD</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="6.445672191528545%" id="mcps1.4.3.3.2.1.2.2.8.1.6" liSelected="liSelected"><p>VPN-Target</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="17.421731123388582%" id="mcps1.4.3.3.2.1.2.2.8.1.7" liSelected="liSelected"><p>AS Number</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="middle" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.1 "><p>CE1</p>
</td>
<td class="cellrowborder" valign="middle" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.2 "><p>1.1.1.1</p>
</td>
<td class="cellrowborder" valign="top" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.3 "><p>-</p>
</td>
<td class="cellrowborder" valign="top" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.4 "><p>-</p>
</td>
<td class="cellrowborder" valign="top" width="6.445672191528545%" headers="mcps1.4.3.3.2.1.2.2.8.1.5 "><p>-</p>
</td>
<td class="cellrowborder" valign="middle" width="6.445672191528545%" headers="mcps1.4.3.3.2.1.2.2.8.1.6 "><p>-</p>
</td>
<td class="cellrowborder" valign="middle" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.7 "><p>â</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="middle" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.1 "><p>PE1</p>
</td>
<td class="cellrowborder" valign="middle" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.2 "><p>2.2.2.2</p>
</td>
<td class="cellrowborder" valign="top" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.3 "><p>2.2.2.2</p>
</td>
<td class="cellrowborder" valign="top" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.4 "><p>2.2.2.2</p>
</td>
<td class="cellrowborder" valign="top" width="6.445672191528545%" headers="mcps1.4.3.3.2.1.2.2.8.1.5 "><p>2:2</p>
</td>
<td class="cellrowborder" valign="middle" width="6.445672191528545%" headers="mcps1.4.3.3.2.1.2.2.8.1.6 "><p>3:3</p>
</td>
<td class="cellrowborder" valign="middle" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.7 "><p>AS100</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="middle" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.1 "><p>PE2</p>
</td>
<td class="cellrowborder" valign="middle" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.2 "><p>3.3.3.3</p>
</td>
<td class="cellrowborder" valign="top" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.3 "><p>3.3.3.3</p>
</td>
<td class="cellrowborder" valign="top" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.4 "><p>3.3.3.3</p>
</td>
<td class="cellrowborder" valign="top" width="6.445672191528545%" headers="mcps1.4.3.3.2.1.2.2.8.1.5 "><p>3:3</p>
</td>
<td class="cellrowborder" valign="middle" width="6.445672191528545%" headers="mcps1.4.3.3.2.1.2.2.8.1.6 "><p>3:3</p>
</td>
<td class="cellrowborder" valign="middle" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.7 "><p>AS100</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="middle" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.1 "><p>CE2</p>
</td>
<td class="cellrowborder" valign="middle" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.2 "><p>4.4.4.4</p>
</td>
<td class="cellrowborder" valign="top" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.3 "><p>-</p>
</td>
<td class="cellrowborder" valign="top" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.4 "><p>-</p>
</td>
<td class="cellrowborder" valign="top" width="6.445672191528545%" headers="mcps1.4.3.3.2.1.2.2.8.1.5 "><p>-</p>
</td>
<td class="cellrowborder" valign="middle" width="6.445672191528545%" headers="mcps1.4.3.3.2.1.2.2.8.1.6 "><p>-</p>
</td>
<td class="cellrowborder" valign="middle" width="17.421731123388582%" headers="mcps1.4.3.3.2.1.2.2.8.1.7 "><p>â</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172367584__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure BGP/MPLS IP VPN.</span><ol type="a"><li class="substepexpand"><span>Configure the VPN backbone network and the IP address of each interface in each VPN site.</span><p><p>Assign an IP address to each interface according to <a href="#EN-US_TASK_0172367584__fig_dc_vrp_cfg_ngmvpn_021301">Figure 1</a>. For configuration details, see <a href="#EN-US_TASK_0172367584__example_dc_vrp_cfg_ngmvpn_021301">Configuration Files</a> in this section.</p>
</p></li><li class="substepexpand"><span>Configure an IGP to interconnect devices on the BGP MPLS/IP VPN backbone network.</span><p><p>IS-IS is used in this example. For configuration details, see <a href="#EN-US_TASK_0172367584__example_dc_vrp_cfg_ngmvpn_021301">Configuration Files</a> in this section.</p>
</p></li><li class="substepexpand"><span>Configure basic MPLS functions, enable MPLS Label Distribution Protocol (LDP), and establish LDP Label Switch Paths (LSPs) on the backbone network.</span><p><ul><li><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>mpls lsr-id 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
</li><li><p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>mpls lsr-id 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</li></ul>
</p></li><li class="substepexpand"><span>Establish a Multiprotocol Internal Border Gateway Protocol (MP-IBGP) peer relationship between PEs.</span><p><ul><li><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>peer 3.3.3.3 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>peer 3.3.3.3 connect-interface LoopBack0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>ipv6-family vpnv6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-af-vpnv6] <strong>peer 3.3.3.3 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-af-vpnv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
</li><li><p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>peer 2.2.2.2 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>peer 2.2.2.2 connect-interface LoopBack0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>ipv6-family vpnv6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-af-vpnv6] <strong>peer 2.2.2.2 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-af-vpnv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</li></ul>
</p></li><li class="substepexpand"><span>Configure a VPN instance on each PE and bind the VPN instance on each PE to its interface connecting to a CE.</span><p><ul><li><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>ip vpn-instance VPNA</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA] <strong>ipv6-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv6] <strong>route-distinguisher 2:2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv6] <strong>vpn-target 3:3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>ip binding vpn-instance VPNA</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>ipv6 address 2001:db8:1::1 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
</li><li><p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>ip vpn-instance VPNA</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-VPNA] <strong>ipv6-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-VPNA-af-ipv6] <strong>route-distinguisher 3:3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-VPNA-af-ipv6] <strong>vpn-target 3:3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-VPNA-af-ipv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-VPNA] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>ip binding vpn-instance VPNA</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>ipv6 address 2001:db8:2::1 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</li></ul>
</p></li><li class="substepexpand"><span>Configure ISIS on each PE to import VPN routes.</span><p><ul><li><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>isis 1 vpn-instance VPNA</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>is-level level-1-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>network-entity 10.0000.0000.0002.00</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>ipv6 enable topology ipv6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>ipv6 import-route bgp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>isis ipv6 enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>ipv6-family vpn-instance VPNA</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-VPNA] <strong>import-route isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-VPNA] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
</li><li><p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>isis 1 vpn-instance VPNA</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>is-level level-1-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>network-entity 10.0000.0000.0003.00</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>ipv6 enable topology ipv6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>ipv6 import-route bgp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>isis ipv6 enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>ipv6-family vpn-instance VPNA</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-VPNA] <strong>import-route isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-VPNA] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</li></ul>
</p></li><li class="substepexpand"><span># Configure IS-IS on each CE.</span><p><ul><li><p># Configure CE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong>isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-isis-1] <strong>is-level level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-isis-1] <strong>network-entity 10.0000.0000.0001.00</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-isis-1] <strong>ipv6 enable topology ipv6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-isis-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/0</span>] <strong>isis ipv6 enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/1</span>] <strong>isis ipv6 enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>commit</strong></pre>
</li><li><p># Configure CE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2] <strong>isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-isis-1] <strong>is-level level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-isis-1] <strong>network-entity 10.0000.0000.0004.00</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-isis-1] <strong>ipv6 enable topology ipv6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-isis-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/0</span>] <strong>isis ipv6 enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>isis ipv6 enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>commit</strong></pre>
</li></ul>
<p>After the configurations are complete, run the <a href="cmdqueryname=display+ipv6+routing-table"><b><span class="cmdname">display ipv6 routing-table</span></b></a> command on CE2. The command outputs show that CE2 has a route to CE1. Run the <a href="cmdqueryname=ping"><b><span class="cmdname">ping</span></b></a> command on CE2 to ping CE1. The command output shows that the ping operation is successful. The following example uses the command output on CE2:</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2] <strong>display ipv6 routing-table</strong></pre>
<pre class="screen"><span class="keyword">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route</span>
------------------------------------------------------------------------------
Routing Table : _Public_
         Destinations : 2        Routes : 2

 Destination  : 2001:DB8:1::2                   PrefixLength : 64
 NextHop      : 2001:DB8:2::1                   Preference   : 0
 Cost         : 0                               Protocol     : IS-IS
 RelayNextHop : ::                              TunnelID     : 0x0
 Interface    : GigabitEthernet<span>0/1/0</span>            Flags        : D

 Destination  : 2001:DB8:4::2                   PrefixLength : 64
 NextHop      : 2001:DB8:4::2                   Preference   : 0
 Cost         : 0                               Protocol     : Direct
 RelayNextHop : ::                              TunnelID     : 0x0
 Interface    : GigabitEthernet<span>0/1/1</span>            Flags        : D</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2] <strong>ping ipv6 2001:db8:1::2</strong></pre>
<pre class="screen">  PING 2001:DB8:1::2: 56  data bytes, press CTRL_C to break
    Reply from 2001:DB8:1::2: bytes=56 Sequence=1 ttl=253 time=118 ms
    Reply from 2001:DB8:1::2: bytes=56 Sequence=2 ttl=253 time=3 ms
    Reply from 2001:DB8:1::2: bytes=56 Sequence=3 ttl=253 time=4 ms
    Reply from 2001:DB8:1::2: bytes=56 Sequence=4 ttl=253 time=3 ms
    Reply from 2001:DB8:1::2: bytes=56 Sequence=5 ttl=253 time=3 ms

  --- 2001:DB8:1::2 ping statistics ---
    5 packet(s) transmitted
    5 packet(s) received
    0.00% packet loss
    round-trip min/avg/max = 3/26/118 ms                     </pre>
</p></li></ol>
</li><li><span>Enable mLDP globally.</span><p><ul><li><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-ldp] <strong>mldp p2mp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-ldp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-mpls-ldp] <strong>quit</strong></pre>
</li><li><p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls-ldp] <strong>mldp p2mp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls-ldp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-mpls-ldp] <strong>quit</strong></pre>
</li></ul>
</p></li><li><span>Establish a BGP MVPN peer relationship between the PEs.</span><p><ul><li><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp] <strong>ipv6-family mvpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-af-mvpnv6] <strong>peer 3.3.3.3 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-af-mvpnv6] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp-af-mvpnv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp] <strong>quit</strong></pre>
</li><li><p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-bgp] <strong>ipv6-family mvpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-af-mvpnv6] <strong>peer 2.2.2.2 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-af-mvpnv6] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-bgp-af-mvpnv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-bgp] <strong>quit</strong></pre>
</li></ul>
<p>After the configurations are complete, run the <a href="cmdqueryname=display+bgp+mvpn+vpnv6+all+peer"><b><span class="cmdname">display bgp mvpn vpnv6 all peer</span></b></a> command on the PEs. The command output shows that PE1 has established a BGP MVPN peer relationship with PE2. The following example uses the command output on PE1:</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display bgp mvpn vpnv6 all peer</strong></pre>
<pre class="screen"> BGP local router ID : 2.2.2.2
 Local AS number : 100
 Total number of peers : 1                 Peers in established state : 1

  Peer            V          AS  MsgRcvd  MsgSent  OutQ  Up/Down       State  PrefRcv
  3.3.3.3         4         100      107      112     0 01:22:50 <strong>Established</strong>        3</pre>
</p></li><li><span>Configure each PE to use mLDP to establish an I-PMSI tunnel, and configure S-PMSI.</span><p><ul><li><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>multicast ipv6 mvpn 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>ip vpn-instance VPNA</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA] <strong>ipv6-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv6] <strong>multicast ipv6 routing-enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv6] <strong>mvpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv6-mvpn] <strong>sender-enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv6-mvpn] <strong>c-multicast signaling bgp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv6-mvpn] <strong>ipmsi-tunnel</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv6-mvpn-ipmsi] <strong>mldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv6-mvpn-ipmsi] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv6-mvpn] <strong>spmsi-tunnel</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv6-mvpn-spmsi] <strong>group FF15:: 64 source 2001:DB8:3::9 64 mldp limit 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv6-mvpn-spmsi] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv6-mvpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
</li><li><p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>multicast ipv6 mvpn 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>ip vpn-instance VPNA</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-VPNA] <strong>ipv6-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-VPNA-af-ipv6] <strong>multicast ipv6 routing-enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-VPNA-af-ipv6] <strong>mvpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-VPNA-af-ipv6-mvpn] <strong>c-multicast signaling bgp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-VPNA-af-ipv6-mvpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-VPNA-af-ipv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-VPNA] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</li></ul>
</p></li><li><span>Configure PIM.</span><p><ul><li><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>pim ipv6 sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
</li><li><p># Configure CE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong>multicast ipv6 routing-enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/0</span>] <strong>pim ipv6 sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/1</span>] <strong>pim ipv6 sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>commit</strong></pre>
</li><li><p># Configure PE2.</p>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>pim ipv6 sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</li><li><p># Configure CE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2] <strong>multicast ipv6 routing-enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/0</span>] <strong>pim ipv6 sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>pim ipv6 sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>commit</strong></pre>
</li></ul>
</p></li><li><span>Configure MLD.</span><p><ul><li><p># Configure CE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>mld enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>mld static-group FF3E::1 source 2001:DB8:3::2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
</li></ul>
</p></li><li><span>Verify the configuration.</span><p><p>After the configurations are complete, IPv6 NG MVPN functions have been configured. If CE2 has access users, CE1 can use the BGP MPLS/IP VPN to forward multicast data to the users. After a static multicast entry is configured users of CE2 to join the multicast group FF3E::1 and the multicast source 2001:DB8:3::2 to send multicast data, check multicast routing entries to verify whether the IPv6 NG MVPN is configured successfully.</p>
<p>Run the <a href="cmdqueryname=display+pim+ipv6+routing-table"><b><span class="cmdname">display pim ipv6 routing-table</span></b></a> command on CE2 and CE1 to check their PIM routing tables.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2] <strong>display pim ipv6 routing-table</strong></pre>
<pre class="screen"> VPN-Instance: public net
 Total 1 (S, G) entry

 (2001:DB8:3::2, FF3E::1)
     Protocol: pim-ssm, Flag: SG_RCVR
     UpTime: 00:24:07
     Upstream interface: GigabitEthernet<span>0/1/0</span>, Refresh time: 00:24:07
         Upstream neighbor: 2001:DB8:2::1
         RPF prime neighbor: 2001:DB8:2::1
     Downstream interface(s) information:
     Total number of downstreams: 1
        1: GigabitEthernet<span>0/1/1</span>
             Protocol: static, UpTime: 00:24:07, Expires: -
</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>display pim ipv6 vpn-instance VPNA routing-table</strong></pre>
<pre class="screen"> VPN-Instance: VPNA
 Total 1 (S, G) entry

 (2001:DB8:3::2, FF3E::1)
     Protocol: pim-ssm, Flag:
     UpTime: 00:24:09
     Upstream interface: through-BGP, Refresh time: 00:24:09
         Upstream neighbor: ::FFFF:2.2.2.2
         RPF prime neighbor: ::FFFF:2.2.2.2
     Downstream interface(s) information:
     Total number of downstreams: 1
        1: GigabitEthernet<span>0/1/1</span>
             Protocol: pim-ssm, UpTime: 00:24:09, Expires: 00:02:35
</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong>display pim ipv6 routing-table</strong></pre>
<pre class="screen"> VPN-Instance: public net
 Total 1 (S, G) entry

 (2001:DB8:3::2, FF3E::1)
      Protocol: pim-ssm, Flag: LOC
     UpTime: 00:24:09
     Upstream interface: GigabitEthernet<span>0/1/1</span>, Refresh time: 00:24:09
         Upstream neighbor: NULL
         RPF prime neighbor: NULL
     Downstream interface(s) information:
     Total number of downstreams: 1
        1: GigabitEthernet<span>0/1/0</span>
             Protocol: pim-ssm, UpTime: 00:24:09, Expires: -
</pre>
<p>The command outputs show that the CE connected to the multicast source has received PIM Join messages from the CE connected to multicast receivers and that PIM routing entries are generated.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172367584__example_dc_vrp_cfg_ngmvpn_021301"><a name="EN-US_TASK_0172367584__example_dc_vrp_cfg_ngmvpn_021301"></a><a name="example_dc_vrp_cfg_ngmvpn_021301"></a><a name="EN-US_TASK_0172367584__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>CE1 configuration file</p>
<pre class="screen">#
sysname CE1
#
multicast ipv6 routing-enable
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:1::2/64
 isis ipv6 enable 1
 pim ipv6 sm
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:3::1/64
 isis ipv6 enable 1
 pim ipv6 sm
#
interface LoopBack0
 ip address 1.1.1.1 255.255.255.255
#
isis 1
 is-level level-2
 ipv6 enable topology ipv6
 network-entity 10.0000.0000.0001.00
#
return</pre>
</li><li><p>PE1 configuration file</p>
<pre class="screen">#
sysname PE1
#
multicast ipv6 mvpn 2.2.2.2
#
ip vpn-instance VPNA
 ipv6-family
  route-distinguisher 2:2
  apply-label per-instance
  vpn-target 3:3 export-extcommunity
  vpn-target 3:3 import-extcommunity
  multicast ipv6 routing-enable
  mvpn
   sender-enable
   c-multicast signaling bgp
   ipmsi-tunnel
    mldp
   spmsi-tunnel
    group FF15:: 64 source 2001:DB8:3:: 64 mldp limit 1
#
mpls lsr-id 2.2.2.2
mpls
#
mpls ldp
 mldp p2mp
#
isis 1 vpn-instance VPNA
 is-level level-1-2
 network-entity 10.0000.0000.0002.00
 ipv6 enable topology ipv6
 ipv6 import-route bgp
#
isis 2
 is-level level-2
 network-entity 49.0002.0010.0010.1023.00
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.1.1 255.255.255.0
 isis enable 2
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip binding vpn-instance VPNA
 ipv6 enable
 ipv6 address 2001:DB8:1::1/64
 isis ipv6 enable 1
 pim ipv6 sm
#
interface LoopBack0
 ip address 2.2.2.2 255.255.255.255
 isis enable 2
#
bgp 100
 router-id 2.2.2.2
 peer 3.3.3.3 as-number 100
 peer 3.3.3.3 connect-interface LoopBack0
 #
 ipv4-family unicast
  undo synchronization
  peer 3.3.3.3 enable
 #
 ipv6-family mvpn
  policy vpn-target
  peer 3.3.3.3 enable
 #
 ipv6-family vpnv6
  policy vpn-target
  peer 3.3.3.3 enable
 #
 ipv6-family vpn-instance VPNA
  import-route isis 1
#
return
</pre>
</li><li><p>CE2 configuration file</p>
<pre class="screen">#
sysname CE2
#
multicast ipv6 routing-enable
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:2::2/64
 isis ipv6 enable 1
 pim ipv6 sm
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:4::1/64
 isis ipv6 enable 1
 mld enable
 mld static-group FF3E::1 source 2001:DB8:3::2
 pim ipv6 sm
#
interface LoopBack0
 ip address 4.4.4.4 255.255.255.255
#
isis 1
 is-level level-2
 ipv6 enable topology ipv6
 network-entity 10.0000.0000.0004.00
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2
#
multicast ipv6 mvpn 3.3.3.3
#
ip vpn-instance VPNA
 ipv6-family
  route-distinguisher 3:3
  apply-label per-instance
  vpn-target 3:3 export-extcommunity
  vpn-target 3:3 import-extcommunity
  multicast ipv6 routing-enable
  mvpn
   c-multicast signaling bgp
#
mpls lsr-id 3.3.3.3
mpls
#
mpls ldp
 mldp p2mp
#
isis 1 vpn-instance VPNA
 is-level level-1-2
 network-entity 10.0000.0000.0003.00
 ipv6 enable topology ipv6
 ipv6 import-route bgp
#
isis 2
 is-level level-2
 network-entity 49.0002.0010.0010.1024.00
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.1.2 255.255.255.0
 isis enable 2
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip binding vpn-instance VPNA
 ipv6 enable
 ipv6 address 2001:DB8:2::1/64
 isis ipv6 enable 1
 pim ipv6 sm
#
interface LoopBack0
 ip address 3.3.3.3 255.255.255.255
 isis enable 2
#
bgp 100
 router-id 3.3.3.3
 peer 2.2.2.2 as-number 100
 peer 2.2.2.2 connect-interface LoopBack0
 #
 ipv4-family unicast
  undo synchronization
  peer 2.2.2.2 enable
 #
 ipv6-family mvpn
  policy vpn-target
  peer 2.2.2.2 enable
 #
 ipv6-family vpnv6
  policy vpn-target
  peer 2.2.2.2 enable
 #
 ipv6-family vpn-instance VPNA
  import-route isis 1
#
return
</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0212.html">Configuration Examples for IPv6 NG MVPN
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0273.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>