
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring the System to Retain the Original Tag and Add Another Tag to an MLD Report Message in L2VPN Access to L3VPN Scenarios">
<meta name="abstract" content="This section provides an example for configuring the system to reserve the original tag and add another tag to an MLD Report message when the message is forwarded from an L2VE sub-interface to an L3VE QinQ VLAN tag termination sub-interface.">
<meta name="description" content="This section provides an example for configuring the system to reserve the original tag and add another tag to an MLD Report message when the message is forwarded from an L2VE sub-interface to an L3VE QinQ VLAN tag termination sub-interface.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2mc_cfg_0033.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2mc_cfg_0070.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2mc_cfg_mld_snooping_qinq.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00800033,l2multicastvrp,c00549182,w00556928,w00437000,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Layer 2 Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Layer 2 Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="Layer 2 Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="Layer 2 Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368009">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring the System to Retain the Original Tag and Add Another Tag to an MLD Report Message in L2VPN Access to L3VPN Scenarios</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172368009"></a><a name="EN-US_TASK_0172368009"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring the System to Retain the Original Tag and Add Another Tag to an MLD Report Message in L2VPN Access to L3VPN Scenarios</h1>
<div class="taskbody"><p>This section provides an example for configuring the system to reserve the original tag and add another tag to an MLD Report message when the message is forwarded from an L2VE sub-interface to an L3VE QinQ VLAN tag termination sub-interface.</p>
<div class="context"><a name="EN-US_TASK_0172368009__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0172368009__fig_dc_vrp_l2mc_cfg_003401">Figure 1</a>, the NPE resides on the IP/MPLS backbone network, whereas the UPE resides on the VPWS access network; a VPWS connection is established between the UPE and NPE using LDP signaling. The receiver sends MLD request messages to the UPE, and the source sends multicast streams. Create two virtual interfaces VE 0/0/10 and VE 0/0/20 on the NPE. VE 0/0/10 is an L2VE interface used to terminate the VPWS, whereas VE 0/0/20 is used to access the L3VPN in QinQ mode.</p>
<div class="fignone" id="EN-US_TASK_0172368009__fig_dc_vrp_l2mc_cfg_003401"><a name="EN-US_TASK_0172368009__fig_dc_vrp_l2mc_cfg_003401"></a><a name="fig_dc_vrp_l2mc_cfg_003401"></a><span class="figcap"><b>Figure 1 </b>Configuring the system to retain the original tag and add another tag to an MLD report message in L2VPN access to L3VPN scenarios</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1, 2, 3, and 4 in this example represent GE <span>0/1/0</span>, GE <span>0/1/1</span>, VE 0/0/10, and VE 0/0/20, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_feature_image_ipv6_protocol-packet_encapsulation.png" width="NaN" height="NaN"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368009__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure OSPFv2 at each network layer to implement IPv4 interworking between the NPE and UPE. Configure an IPv6 static route to the source on the NPE.</p>
</li><li><p>Establish a VPWS neighbor relationship between the UPE and NPE.</p>
</li><li><p>Configure AC interfaces on the UPE.</p>
</li><li><p>Create a global L2VE interface and L3VE interface on the NPE, and bind them to the same VE-Group.</p>
</li><li><p>Configure single-tagged packet termination on the L2VE interface, and configure QinQ packet termination on the L3VE interface.</p>
</li><li><p>Enable IPv6 multicast and MLD snooping globally on the NPE and UPE.</p>
</li><li><p>Configure the system to retain the original tag and add another tag to an MLD report message in the VSI view of the UPE.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368009__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<p>Interface IP addresses and OSPFv2 process ID</p>
<p>VE-Group number</p>
<p>LSR ID of each node</p>
<p>VSI name and VSI ID</p>
<p>VLAN ID of the UPE's AC interface: 10; VLAN ID for single-tagged packet termination: 5; VLAN IDs for double-tagged packet termination: 10 and 5</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172368009__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure interface IP addresses.</span><p><p>Configure an IP address for each interface (including a loopback interface). Establish an OSPFv2 neighbor relationship between the UPE and NPE. Use OSPFv2 to advertise the network segment connected to the two devices' IPv4 interfaces and the loopback interface routes. For configuration details, see Configuration Files in this section.</p>
</p></li><li><span>Establish a VPWS neighbor relationship between the UPE and NPE.</span><p><p># Configure the UPE.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname UPE</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE] <strong>mpls lsr-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>mpls ldp remote-peer 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-ldp-remote-2.2.2.2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-l2vpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>vsi vsi1 static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-vsi-vsi1] <strong>pwsignal ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-vsi-vsi1-ldp] <strong>vsi-id 1112</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-vsi-vsi1-ldp] <strong>peer 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-vsi-vsi1-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-vsi-vsi1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>interface GigabitEthernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-GigabitEthernet<span>0/1/1</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-GigabitEthernet<span>0/1/1</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>commit</strong></pre>
<p># Configure the NPE.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NPE&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NPE] <strong>mpls lsr-id 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>mpls ldp remote-peer 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-ldp-remote-1.1.1.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-l2vpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>vsi vsi2 static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-vsi-vsi2] <strong>pwsignal ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-vsi-vsi2-ldp] <strong>vsi-id 1112</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-vsi-vsi2-ldp] <strong>peer 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-vsi-vsi2-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-vsi-vsi2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>interface GigabitEthernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-GigabitEthernet<span>0/1/0</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>commit</strong></pre>
</p></li><li><span>On the UPE, bind GigabitEthernet <span>0/1/0</span>.1 as an AC interface and set the VLAN ID is 10.</span><p><p># Configure the UPE.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE] <strong>interface GigabitEthernet<span>0/1/0</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-GigabitEthernet<span>0/1/0</span>.1] <strong>vlan-type dot1q 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-GigabitEthernet<span>0/1/0</span>.1] <strong>l2 binding vsi vsi1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-GigabitEthernet<span>0/1/0</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>commit</strong></pre>
</p></li><li><span>Create two virtual interfaces VE 0/1/10 and VE 0/1/20 on the NPE, and bind them to the same VE-Group.</span><p><p># Configure the NPE.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NPE&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NPE] <strong>interface Virtual-Ethernet 0/1/10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-Virtual-Ethernet0/1/10] <strong>ve-group 1 l2-terminate</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-Virtual-Ethernet0/1/10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>interface Virtual-Ethernet 0/1/20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-Virtual-Ethernet0/1/20] <strong>ve-group 1 l3-access</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-Virtual-Ethernet0/1/20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>commit</strong></pre>
</p></li><li><span>Configure single-tagged packet termination on VE 0/1/10.1, and configure QinQ packet termination on VE 0/1/20.1.</span><p><p># Bind VE 0/1/10.1 as an AC interface, and set the VLAN ID for single-tagged packet termination to 5.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NPE&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NPE] <strong>interface Virtual-Ethernet 0/1/10.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-Virtual-Ethernet0/1/10.1] <strong>vlan-type dot1q 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-Virtual-Ethernet0/1/10.1] <strong>l2 binding vsi vsi2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-Virtual-Ethernet0/1/10.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>commit</strong></pre>
<p># Configure QinQ termination on VE 0/1/20.1, and set the VLAN IDs for double-tagged packet termination to 5 and 10 respectively.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NPE&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NPE] <strong>interface Virtual-Ethernet 0/1/20.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-Virtual-Ethernet0/1/20.1] <strong>encapsulation qinq-termination</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-Virtual-Ethernet0/1/20.1] <strong>qinq termination pe-vid 5 ce-vid 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-Virtual-Ethernet0/1/20.1] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-Virtual-Ethernet0/1/20.1] <strong>ipv6 address 2001:db8:4::1/64</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-Virtual-Ethernet0/1/20.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>commit</strong></pre>
</p></li><li><span>Enable IPv6 multicast and MLD snooping globally on the NPE and UPE.</span><p><p># Configure the UPE.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>UPE] <strong>multicast ipv6 routing-enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>mld-snooping enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>vsi vsi1 static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-vsi-vsi1] <strong>mld-snooping enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE-vsi-vsi1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>UPE] <strong>commit</strong></pre>
<p># Configure the NPE.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NPE&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NPE] <strong>multicast ipv6 routing-enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>mld-snooping enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>vsi vsi2 static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-vsi-vsi2] <strong>mld-snooping enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-vsi-vsi2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>interface Virtual-Ethernet 0/1/20.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-Virtual-Ethernet0/1/20.1] <strong>pim ipv6 sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-Virtual-Ethernet0/1/20.1] <strong>mld enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-Virtual-Ethernet0/1/20.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>interface GigabitEthernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-interface GigabitEthernet<span>0/1/1</span>] <strong>pim ipv6 sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-interface GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>commit</strong></pre>
</p></li><li><span>Configure the system to retain the original tag and add another tag to an MLD report message in the VSI view of the UPE.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NPE] <strong>vsi vsi2 static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-vsi-vsi2] <strong>l2-multicast ipv6 protocol-packet encapsulation raw</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE-vsi-vsi2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NPE] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>Run the <strong>display pim ipv6 routing-table</strong> command on the NPE to view multicast traffic entries.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NPE] <strong>display pim ipv6 routing-table</strong> 
 VPN-Instance: public net
 Total 1 (*, G) entry; 1 (S, G) entry
 
 (*, FF1E::1)
     RP: NULL
     Protocol: pim-sm, Flag: WC NIIF 
     UpTime: 00:02:12
     Upstream interface: NULL, Refresh time: 00:02:12
         Upstream neighbor: NULL
         RPF prime neighbor: NULL
     Downstream interface(s) information:
     Total number of downstreams: 1
        1: Virtual-Ethernet0/1/20.1
             Protocol: mld, UpTime: 00:02:12, Expires: -
 
 (2001:DB8:6::1, FF1E::1)
     RP: NULL
     Protocol: pim-sm, Flag: SPT LOC ACT 
     UpTime: 00:05:55
     Upstream interface: GigabitEthernet<span>0/1/1</span>, Refresh time: 00:05:55
         Upstream neighbor: NULL
         RPF prime neighbor: NULL
     Downstream interface(s) information:
     Total number of downstreams: 1
        1: Virtual-Ethernet0/1/20.1
             Protocol: pim-sm, UpTime: 00:02:12, Expires: -</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172368009__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>NPE configuration file</p>
<pre class="screen">#
sysname NPE
#
multicast ipv6 routing-enable
#
mld-snooping enable
#
mpls lsr-id 2.2.2.2
#
mpls
#
mpls l2vpn
#
vsi vsi2 static
 pwsignal ldp
  vsi-id 1112
  peer 1.1.1.1 
 mld-snooping enable
 l2-multicast ipv6 protocol-packet encapsulation raw
#
mpls ldp
#
mpls ldp remote-peer 1.1.1.1
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 172.16.1.1 255.255.255.0
 mpls
 mpls ldp
 dcn
#
interface GigabitEthernet<span>0/1/1</span>
 undo negotiation auto
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:6::2/64
 pim ipv6 sm
#
interface LoopBack0
 ip address 2.2.2.2 255.255.255.255
#
interface Virtual-Ethernet0/1/10
 ve-group 1 l2-terminate
#
interface Virtual-Ethernet0/1/10.1
 vlan-type dot1q 5
 l2 binding vsi vsi2
#
interface Virtual-Ethernet0/1/20
 ve-group 1 l3-access
#
interface Virtual-Ethernet0/1/20.1
 ipv6 enable
 ipv6 address 2001:DB8:4::1/64
 encapsulation qinq-termination
 qinq termination pe-vid 5 ce-vid 10
 pim ipv6 sm
 mld enable
#
ospf 1
 area 0.0.0.0
  network 2.2.2.2 0.0.0.0
  network 172.16.1.0 0.0.0.255
#
return
</pre>
</li><li><p>UPE configuration file</p>
<pre class="screen">#
sysname UPE
#
multicast ipv6 routing-enable
#
mld-snooping enable
#
mpls lsr-id 1.1.1.1
#
mpls
#
mpls l2vpn
#
vsi vsi1 static
 pwsignal ldp
  vsi-id 1112
  peer 2.2.2.2 
 mld-snooping enable
#
mpls ldp
#
mpls ldp remote-peer 2.2.2.2
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 172.16.1.2 255.255.255.0
 mpls
 mpls ldp
 undo dcn
#
interface GigabitEthernet<span>0/1/0</span>.1
 vlan-type dot1q 10
 l2 binding vsi vsi1
#
interface LoopBack0
 ip address 1.1.1.1 255.255.255.255
#
ospf 1
 area 0.0.0.0
  network 1.1.1.1 0.0.0.0
  network 172.16.1.0 0.0.0.255
#
return
</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2mc_cfg_0033.html">Configuration Examples for Layer 2 Multicast
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2mc_cfg_0070.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2mc_cfg_mld_snooping_qinq.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>