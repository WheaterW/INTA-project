
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Layer 2 Multicast CAC for a VSI">
<meta name="abstract" content="This section provides an example for configuring Layer 2 multicast CAC for a VSI.">
<meta name="description" content="This section provides an example for configuring Layer 2 multicast CAC for a VSI.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2mc_cfg_0033.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2mc_cfg_0056.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2mc_cfg_0065.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00800033,l2multicastvrp,c00549182,w00556928,w00437000,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Layer 2 Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Layer 2 Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="Layer 2 Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="Layer 2 Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172367997">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring Layer 2 Multicast CAC for a VSI</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172367997"></a><a name="EN-US_TASK_0172367997"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Layer 2 Multicast CAC for a VSI</h1>
<div class="taskbody"><p>This section provides an example for configuring Layer 2 multicast CAC for a VSI.</p>
<div class="context"><a name="EN-US_TASK_0172367997__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the VPLS network shown in <a href="#EN-US_TASK_0172367997__fig_dc_vrp_l2mc_cfg_06301">Figure 1</a>, PE1, PE2, and PE3 are responsible for transmitting multicast data from a source device to downstream receivers.</p>
<p>To limit the multicast group quantity and bandwidth over the VPLS network, configure Layer 2 multicast CAC for the VSI on each PE to prevent the needed bandwidth from exceeding the total bandwidth of the access or aggregation network and ensure service quality for subscribers. Layer 2 multicast CAC also helps service providers to control the number or bandwidth of multicast groups in each channel.</p>
<p>Configure Layer 2 multicast CAC on each PE as follows:</p>
<ul><li>On PE1, set the maximum number of multicast groups to 10 in the VSI named vsi1.</li><li>On PE2, create an ASM channel tv1 in vsi1, set the multicast group address to 225.0.0.1/24 for the channel, and limit the bandwidth to 10 kbit/s for each multicast group member. Limit the multicast group bandwidth to 2500 kbit/s on GE <span>0/1/1</span>.1 of PE2.</li><li>On PE3, set the maximum number of multicast groups to 10 for the VSI with the remote-peer address 1.1.1.1.</li></ul>
<div class="fignone" id="EN-US_TASK_0172367997__fig_dc_vrp_l2mc_cfg_06301"><a name="EN-US_TASK_0172367997__fig_dc_vrp_l2mc_cfg_06301"></a><a name="fig_dc_vrp_l2mc_cfg_06301"></a><span class="figcap"><b>Figure 1 </b>Configuring Layer 2 multicast CAC for a VSI</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interface 1.1, interface 2, interface 3, and interface 4 in this example represent GE <span>0/1/0</span>.1, GE <span>0/1/1</span>, GE <span>0/1/2</span>, and Eth-Trunk 1.1, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_l2mc_cfg_06301.png" width="NaN" height="NaN"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.1.7.1.4.1.1" liSelected="liSelected"><p>Device</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.1.7.1.4.1.2" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.1.7.1.4.1.3" liSelected="liSelected"><p>IP Address</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="3" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.7.1.4.1.1 "><p>PE1</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.7.1.4.1.2 "><p>GE <span>0/1/1</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.7.1.4.1.3 "><p>10.1.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.7.1.4.1.2 "><p>GE <span>0/1/2</span></p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.7.1.4.1.3 "><p>10.1.2.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.7.1.4.1.2 "><p>Loopback 0</p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.7.1.4.1.3 "><p>1.1.1.1/32</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.7.1.4.1.1 "><p>PE2</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.7.1.4.1.2 "><p>GE <span>0/1/1</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.7.1.4.1.3 "><p>10.1.1.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.7.1.4.1.2 "><p>Loopback 0</p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.7.1.4.1.3 "><p>2.2.2.2/32</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.7.1.4.1.1 "><p>PE3</p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.7.1.4.1.2 "><p>GE <span>0/1/1</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="33.33333333333333%" headers="mcps1.4.1.7.1.4.1.3 "><p>10.1.2.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.7.1.4.1.2 "><p>Loopback 0</p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.7.1.4.1.3 "><p>3.3.3.3/32</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172367997__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Assign an IP address for each interface and configure a routing protocol to ensure IP connectivity at the network layer. In this example, OSPF is used.</p>
</li><li><p>Configure basic MPLS LDP functions on PE1, PE2, and PE3.</p>
</li><li><p>Configure an LDP-based VSI and complete basic VSI configurations.</p>
</li><li><p>Configure IGMP snooping globally and in the VSI to manage the forwarding of multicast data messages to implement on-demand multicast data distribution on the Layer 2 VPLS network and reduce bandwidth usage at both the user side and network side.</p>
</li><li><p>On PE1, set the maximum number of multicast groups in the VSI.</p>
</li><li><p>Configure a VSI-based channel on PE2.</p>
</li><li><p>On PE2, limit the bandwidth to a specific value for a sub-interface.</p>
</li><li><p>On PE3, set the maximum number of multicast groups for a PW in the VSI.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172367997__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IP addresses of all interfaces, including loopback interfaces, listed in <a href="#EN-US_TASK_0172367997__fig_dc_vrp_l2mc_cfg_06301">Figure 1</a></p>
</li><li><p>OSPF process ID 1, and area ID 0.0.0.0 for each PE</p>
</li><li><p>MPLS LSR ID of each device (same as the loopback address of each device)</p>
</li><li><p>VSI name vsi1, and VSI ID 100</p>
</li><li><p>Sub-interface GE <span>0/1/0</span>.1 to be bound to the VSI on each PE and user-side VLAN 11</p>
</li><li><p>Layer 2 multicast CAC parameters</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172367997__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address for each interface and configure OSPF.</span><p><p>For configuration details, see <a href="#EN-US_TASK_0172367997__example_01">Configuration Files</a> in this section.</p>
</p></li><li><span>Configure basic MPLS LDP functions on PE1, PE2, and PE3.</span><p><p>For configuration details, see <a href="#EN-US_TASK_0172367997__example_01">Configuration Files</a> in this section.</p>
</p></li><li><span>Configure an LDP-based VSI.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-l2vpn] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-l2vpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>vsi vsi1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-vsi1] <strong>pwsignal ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-vsi1-ldp] <strong>vsi-id 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-vsi1-ldp] <strong>peer 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-vsi1-ldp] <strong>peer 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-vsi1-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-vsi1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface gigabitethernet<span>0/1/0</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>vlan-type dot1q 11</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>l2 binding vsi vsi1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p>The configurations of PE2 and PE3 are similar to the configuration of PE1. For configuration details, see <a href="#EN-US_TASK_0172367997__example_01">Configuration Files</a> in this section.</p>
</p></li><li><span>After the preceding configurations are complete, run the <a href="cmdqueryname=display+vsi"><b><span class="cmdname">display vsi</span></b></a> command on each PE to check the VSI status.</span><p><p>The following example uses the command output on PE1. The VSI is Up.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> display vsi</strong></pre>
<pre class="screen">Total VSI number is 1, 1 is up, 0 is down, 1 is LDP mode, 0 is BGP mode, 0 is BG
PAD mode, 0 is mixed mode, 0 is unspecified mode
--------------------------------------------------------------------------
Vsi                             Mem    PW    Mac       Encap     Mtu   Vsi
Name                            Disc   Type  Learn     Type      Value State
--------------------------------------------------------------------------
vsi1                            --     ldp   unqualify vlan      1500  <strong>up</strong></pre>
</p></li><li><span>Enable IGMP snooping globally and for the VSI on PE1, PE2, and PE3.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>igmp-snooping enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>vsi vsi1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-vsi1] <strong>igmp-snooping enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-vsi1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p>Repeat this step for PE2 and PE3. For configuration details, see <a href="#EN-US_TASK_0172367997__example_01">Configuration Files</a> in this section.</p>
</p></li><li><span>Configure GE <span>0/1/1</span>.1 on PE1 as a static router port.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface gigabitethernet <span>0/1/0</span>.1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>igmp-snooping static-router-port vsi vsi1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>vsi vsi1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vsi-vsi1] <strong>igmp-snooping static-router-port remote-peer 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vsi-vsi1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</p></li><li><span>Set the maximum number of multicast groups in the VSI on PE1.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>vsi vsi1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-vsi1] <strong>l2-multicast limit max-entry 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-vsi1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
</p></li><li><span>Configure a VSI-based channel on PE2.</span><p><p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>l2-multicast-channel vsi vsi1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-l2-channel-vsi-vsi1] <strong>channel tv1 type asm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-l2-channel-vsi-vsi1-tv1] <strong>group 225.0.0.1 24 per-bandwidth 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-l2-channel-vsi-vsi1-tv1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-l2-channel-vsi-vsi1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</p></li><li><span>Configure multicast CAC on the sub-interface of PE2.</span><p><p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface Eth-Trunk 1.1   </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2--Eth-Trunk1.1] <strong>encapsulation dot1q-termination </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2--Eth-Trunk1.1] <strong>dot1q termination vid 11</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2--Eth-Trunk1.1] <strong>l2 binding vsi vsi1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2--Eth-Trunk1.1] <strong>l2-multicast limit channel tv1 bandwidth 2500 dot1q vid 11 </strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2--Eth-Trunk1.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</p></li><li><span>Set the maximum number of multicast groups for a PW in the VSI.</span><p><p># Configure PE3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong>vsi vsi1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-vsi-vsi1] <strong>pwsignal ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-vsi-vsi1-ldp] <strong>l2-multicast limit max-entry 10 remote-peer 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-vsi-vsi1-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-vsi-vsi1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Run the <strong>display l2-multicast limit</strong> command on PE1 and PE2 to view Layer 2 multicast CAC configurations.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display l2-multicast limit</strong></pre>
<pre class="screen">L2-multicast limit information, The unit of bandwidth is Kbits/sec
------------------------------------------------------------------------------
                                               ConfigEntries  ConfigBandwidth
                                               CurrentEntries CurrentBandwidth
------------------------------------------------------------------------------
VSI vsi1 limit information:
------------------------------------------------------------------------------
                                               10             ----------
                                               0              ----------
</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>display l2-multicast limit</strong></pre>
<pre class="screen">L2-multicast limit information, The unit of bandwidth is Kbits/sec
------------------------------------------------------------------------------
                                               ConfigEntries  ConfigBandwidth
                                               CurrentEntries CurrentBandwidth
------------------------------------------------------------------------------
interface Eth-Trunk1.1 dot1q vid 11 limit information:
------------------------------------------------------------------------------
                                       tv1     ----           2500
                                               ----           0
</pre>
<p># Run the <strong>display l2-multicast-channel</strong> command on PE2 to view channel information.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>display l2-multicast-channel</strong></pre>
<pre class="screen">Channel information on VSI vsi1
 ChannelName                    Group/Mask         Source/Mask        Bandwidth
-------------------------------------------------------------------------------
 tv1                            225.0.0.0/24       *                  10
------------------------------------------------------------------------------- </pre>
<p># Run the <strong>display l2-multicast limit</strong> command on PE3 to view Layer 2 multicast CAC configurations.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3]<strong> display l2-multicast limit</strong></pre>
<pre class="screen">L2-multicast limit information, The unit of bandwidth is Kbits/sec
------------------------------------------------------------------------------
                                               ConfigEntries  ConfigBandwidth
                                               CurrentEntries CurrentBandwidth
------------------------------------------------------------------------------
PW(Peer:1.1.1.1, VCID:100) limit information:
------------------------------------------------------------------------------
                                               10
                                               0
------------------------------------------------------------------------------
</pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172367997__example_01"><a name="EN-US_TASK_0172367997__example_01"></a><a name="example_01"></a><a name="EN-US_TASK_0172367997__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#
sysname PE1
#
vlan batch 11
#
igmp-snooping enable
#
mpls lsr-id 1.1.1.1
#
mpls
#
mpls l2vpn
#
vsi vsi1
 pwsignal ldp
  vsi-id 100
  peer 2.2.2.2
  peer 3.3.3.3
 igmp-snooping enable
 l2-multicast limit max-entry 10
#
mpls ldp
 #
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/0</span>.1
 vlan-type dot1q 11
 l2 binding vsi vsi1
 igmp-snooping static-router-port vsi vsi1
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.1.1.1 255.255.255.0
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 10.1.2.1 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack0
 ip address 1.1.1.1 255.255.255.255
#
ospf 1
 area 0.0.0.0
  network 1.1.1.1 0.0.0.0
  network 10.1.1.0 0.0.0.255
  network 10.1.2.0 0.0.0.255
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2
#
vlan batch 11
#
igmp-snooping enable
#
mpls lsr-id 2.2.2.2
#
mpls
#
mpls l2vpn
#
vsi vsi1
 pwsignal ldp
  vsi-id 100
  peer 1.1.1.1
 igmp-snooping enable
 igmp-snooping static-router-port remote-peer 1.1.1.1
#
mpls ldp
#  
interface Eth-Trunk1  
# 
interface Eth-Trunk1.1        
 encapsulation dot1q-termination   
 dot1q termination vid 11 
 l2 binding vsi vsi1 
 l2-multicast limit channel tv1 bandwidth 2500 dot1q vid 11                     
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.1.1.2 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack0
 ip address 2.2.2.2 255.255.255.255
#
ospf 1
 area 0.0.0.0
  network 2.2.2.2 0.0.0.0
  network 10.1.1.0 0.0.0.255
#
l2-multicast-channel vsi vsi1
 channel tv1 type asm
  group 225.0.0.0 255.255.255.0 per-bandwidth 10
#
return</pre>
</li><li><p>PE3 configuration file</p>
<pre class="screen">#
sysname PE3
#
vlan batch 11
#
igmp-snooping enable
#
mpls lsr-id 3.3.3.3
#
mpls
# 
mpls l2vpn
#
vsi vsi1  
 pwsignal ldp 
  vsi-id 100 
  peer 1.1.1.1
  l2-multicast limit max-entry 10 remote-peer 1.1.1.1 
 igmp-snooping enable
 igmp-snooping static-router-port remote-peer 1.1.1.1 
# 
mpls ldp  
# 
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
#
interface GigabitEthernet<span>0/1/0</span>.1 
 vlan-type dot1q 11 
 l2 binding vsi vsi1
 igmp-snooping static-router-port vsi vsi1
# 
interface GigabitEthernet<span>0/1/1</span> 
 undo shutdown  
 ip address 10.1.2.2 255.255.255.0 
 mpls 
 mpls ldp 
#  
interface LoopBack0 
 ip address 3.3.3.3 255.255.255.255 
#
ospf 1
 area 0.0.0.0 
  network 3.3.3.3 0.0.0.0
  network 10.1.2.0 0.0.0.255
#
return </pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2mc_cfg_0033.html">Configuration Examples for Layer 2 Multicast
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2mc_cfg_0056.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2mc_cfg_0065.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>