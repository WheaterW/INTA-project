
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Enabling the BIERv6 S-PMSI Tunnel Function and Configuring Switching Criteria">
<meta name="abstract" content="An S-PMSI tunnel connects to some PEs on the network-side public network and is used to transmit user-side public network multicast traffic to the PEs that require the traffic. To enable the S-PMSI tunnel function, perform this task.">
<meta name="description" content="An S-PMSI tunnel connects to some PEs on the network-side public network and is used to transmit user-side public network multicast traffic to the PEs that require the traffic. To enable the S-PMSI tunnel function, perform this task.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0032.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0034.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0036.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001142662724">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Enabling the BIERv6 S-PMSI Tunnel Function and Configuring Switching Criteria</title>
</head>
<body><a name="EN-US_TASK_0000001142662724"></a><a name="EN-US_TASK_0000001142662724"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Enabling the BIERv6 S-PMSI Tunnel Function and Configuring Switching Criteria</h1>
<div class="taskbody"><p>An S-PMSI tunnel connects to some PEs on the network-side public network and is used to transmit user-side public network multicast traffic to the PEs that require the traffic. To enable the S-PMSI tunnel function, perform this task.</p>
<div class="context"><a name="EN-US_TASK_0000001142662724__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Perform this task only on the sender PE.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001142662724__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=multicast+mvpn+ipv6-underlay"><b><span class="cmdname">multicast mvpn ipv6-underlay</span></b></a> <i><span class="varname">mvpnid</span></i></span><p><p>An MVPN IPv6 ID is configured.</p>
</p></li><li><span>Run <a href="cmdqueryname=multicast+vpn-public"><b><span class="cmdname">multicast vpn-public</span></b></a></span><p><p>MVPN is enabled on the public network, and the public network IPv4 address family MVPN view is displayed.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=bier+load-balance-entropy+source-group"><b><span class="cmdname">bier load-balance-entropy source-group</span></b></a></span><p><p>The entropy mode is configured for GTMv4 over BIERv6 load balancing.</p>
</p><p><p>Perform this operation only if BIERv6 load balancing has been enabled using the <a href="cmdqueryname=max-load-balance"><b><span class="cmdname">max-load-balance</span></b></a> <i><span class="varname">number</span></i> command.</p>
</p></li><li><span>Run <a href="cmdqueryname=spmsi-tunnel"><b><span class="cmdname">spmsi-tunnel</span></b></a></span><p><p>The public network MVPN S-PMSI view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=group"><b><span class="cmdname">group</span></b></a><i><span class="varname"> group-address</span></i> { <i><span class="varname">group-mask</span></i> | <i><span class="varname">group-mask-length</span></i> } [ <strong><span>source</span></strong> <i><span class="varname">source-address</span></i> { <i><span class="varname">source-mask</span></i> | <i><span class="varname">source-mask-length</span></i> } ] [ <strong><span>threshold</span></strong> <i><span class="varname">threshold-value</span></i> ] <strong><span>bier</span></strong> [ <strong><span>sub-domain</span></strong> <i><span class="varname">sub-domain-val</span></i> ] [ <strong><span>bsl</span></strong> { <strong><span>64</span></strong> | <strong><span>128</span></strong> | <strong><span>256</span></strong> } ] [ <strong><span>limit</span></strong> <i><span class="varname">number</span></i> ], <a href="cmdqueryname=group"><b><span class="cmdname">group</span></b></a><i><span class="varname"> group-address</span></i> { <i><span class="varname">group-mask</span></i> | <i><span class="varname">group-mask-length</span></i> } <strong><span>source</span></strong> <strong><span>wildcard</span></strong> { <strong><span>bier</span></strong> [ <strong><span>sub-domain</span></strong> <i><span class="varname">sub-domain-val</span></i> ] [ <strong><span>bsl</span></strong> { <strong><span>64</span></strong> | <strong><span>128</span></strong> | <strong><span>256</span></strong> } ] } [ <strong><span>limit</span></strong> <i><span class="varname">number</span></i> ], or <a href="cmdqueryname=group"><b><span class="cmdname">group</span></b></a> <strong><span>wildcard</span></strong> <strong><span>source wildcard</span></strong> <strong><span>bier</span></strong> [ <strong><span>sub-domain</span></strong> <i><span class="varname">sub-domain-val</span></i> ] [ <strong><span>bsl</span></strong> { <strong><span>64 </span></strong>| <strong><span>128</span></strong> | <strong><span>256</span></strong> } ]</span><p><p>The address pool range and criteria for switching between I-PMSI and S-PMSI tunnels are configured.</p>
</p><p><p>The preceding command without <strong><span>wildcard</span></strong> specified is used to match (C-S, C-G) multicast services. The preceding commands with <strong><span>wildcard</span></strong> specified are used to match (C-*, C-G) multicast services.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=switch-delay"><b><span class="cmdname">switch-delay</span></b></a> <i><span class="varname">switch-delay</span></i></span><p><p>A delay to switch multicast traffic from the I-PMSI tunnel to an S-PMSI tunnel is configured.</p>
</p><p><p>After the switchover delay is configured using this command, the device starts the delay timer when using the I-PMSI tunnel to transmit multicast traffic. The device keeps monitoring the multicast traffic forwarding rate before the switchover delay timer expires. If the forwarding rate is consistently higher than the specified switchover threshold throughout the timer period, the device switches multicast traffic from the I-PMSI tunnel to an S-PMSI tunnel. If the forwarding rate is consistently lower than the specified switchover threshold throughout the timer period, the device still uses the I-PMSI tunnel to transmit multicast traffic.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=tunnel-withdraw-delay"><b><span class="cmdname">tunnel-withdraw-delay</span></b></a> <i><span class="varname">tunnel-withdraw-delay</span></i></span><p><p>A delay is configured to withdraw the S-PMSI tunnel after traffic is switched from the S-PMSI tunnel back to the I-PMSI tunnel.</p>
</p></li><li><span>Run <a href="cmdqueryname=holddown-time"><b><span class="cmdname">holddown-time</span></b></a> <i><span class="varname">interval</span></i></span><p><p>A delay for switching traffic from an S-PMSI tunnel back to the I-PMSI tunnel is configured.</p>
</p><p><p>In some cases, the multicast traffic forwarding rate may fluctuate around the specified switchover threshold. To prevent multicast data traffic from being frequently switched between S-PMSI and I-PMSI tunnels, the device starts the switchback delay timer when the forwarding rate falls below the specified threshold rather than performing an immediate switchback. The device keeps monitoring the forwarding rate before the delay timer for the switchback from the S-PMSI tunnel expires. If the rate remains consistently lower than the threshold throughout the timer period, the device switches multicast traffic back to the I-PMSI tunnel. Otherwise, the device still uses the S-PMSI tunnel to forward multicast traffic.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the public network MVPN S-PMSI view.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the public network IPv4 address family MVPN view.</p>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0032.html">Configuring GTMv4 over BIERv6
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0034.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0036.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>