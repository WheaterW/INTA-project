
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Enabling the BIERv6 S-PMSI Tunnel Function and Configuring Switching Criteria">
<meta name="abstract" content="An S-PMSI tunnel connects some PEs in the same MVPN and is used to transmit VPN data only to the PEs that require the data. To enable the S-PMSI tunnel function, perform this task.">
<meta name="description" content="An S-PMSI tunnel connects some PEs in the same MVPN and is used to transmit VPN data only to the PEs that require the data. To enable the S-PMSI tunnel function, perform this task.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0016.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0018.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0020.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0283676507">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Enabling the BIERv6 S-PMSI Tunnel Function and Configuring Switching Criteria</title>
</head>
<body><a name="EN-US_TASK_0283676507"></a><a name="EN-US_TASK_0283676507"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Enabling the BIERv6 S-PMSI Tunnel Function and Configuring Switching Criteria</h1>
<div class="taskbody"><p>An S-PMSI tunnel connects some PEs in the same MVPN and is used to transmit VPN data only to the PEs that require the data. To enable the S-PMSI tunnel function, perform this task.</p>
<div class="context"><a name="EN-US_TASK_0283676507__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Perform this task only on the sender PE.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0283676507__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</span></li><li><span>Run the <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i> command to enter the VPN instance view.</span></li><li><span>Run the <a href="cmdqueryname=ipv6-family"><b><span class="cmdname">ipv6-family</span></b></a> command to enter the VPN instance IPv6 address family view.</span></li><li><span>Run the <a href="cmdqueryname=mvpn"><b><span class="cmdname">mvpn</span></b></a> command to enter the VPN instance IPv6 address family MVPN view.</span></li><li><span>(Optional) Run the <a href="cmdqueryname=ipmsi-to-spmsi+switch+immediately"><b><span class="cmdname">ipmsi-to-spmsi switch immediately</span></b></a> command to enable immediate switching from an I-PMSI tunnel to an S-PMSI tunnel.</span><p><p>After immediate switching from an I-PMSI tunnel to an S-PMSI tunnel is configured, upon the generation of an (S, G) entry with an MTI as the outbound interface on the sender PE, an S-PMSI tunnel is created and traffic is immediately switched from an I-PMSI tunnel to the S-PMSI tunnel.</p>
<p>Compared with the original implementation, immediate switching from an I-PMSI tunnel to an S-PMSI tunnel allows traffic corresponding to an (S, G) entry to be switched to an S-PMSI tunnel earlier, thereby reducing multicast traffic loss.</p>
</p></li><li><span>(Optional) Run the <a href="cmdqueryname=bier+load-balance-entropy+source-group"><b><span class="cmdname">bier load-balance-entropy source-group</span></b></a> command to configure the entropy mode for MVPNv6 over BIERv6 load balancing.</span><p><p>Perform this operation only if BIERv6 load balancing has been enabled using the <a href="cmdqueryname=max-load-balance"><b><span class="cmdname">max-load-balance</span></b></a> <i><span class="varname">number</span></i> command.</p>
</p></li><li><span>Run the <a href="cmdqueryname=spmsi-tunnel"><b><span class="cmdname">spmsi-tunnel</span></b></a> command to enter the IPv6 MVPN S-PMSI view.</span></li><li><span>Run the <a href="cmdqueryname=group"><b><span class="cmdname">group</span></b></a><i><span class="varname"> group-address</span></i> <i><span class="varname">group-mask-length</span></i> [ <strong><span>source</span></strong> <i><span class="varname">source-address</span></i> <i><span class="varname">source-mask-length</span></i> ] [ <strong><span>threshold</span></strong> <i><span class="varname">threshold-value</span></i> ] { <strong><span>bier</span></strong> [ <strong><span>sub-domain</span></strong> <i><span class="varname">sub-domain-val</span></i> ] [ <strong><span>bsl</span></strong> { <strong><span>64</span></strong> | <strong><span>128</span></strong> | <strong><span>256</span></strong> } ] } [ <strong><span>limit</span></strong> <i><span class="varname">number</span></i> ] command to configure the address pool range and criteria for switching between I-PMSI and S-PMSI tunnels.</span></li><li><span>(Optional) Run the <a href="cmdqueryname=switch-delay"><b><span class="cmdname">switch-delay</span></b></a> <i><span class="varname">switch-delay</span></i> command to configure a delay to switch multicast traffic of the VPN instance from the I-PMSI tunnel to an S-PMSI tunnel.</span><p><p>The device starts a switchover delay timer when using the I-PMSI tunnel to transmit multicast traffic. The device keeps monitoring the multicast traffic forwarding rate before the switchover delay timer expires. If the forwarding rate is consistently higher than the specified switchover threshold throughout the timer lifecycle, the device switches multicast traffic from the I-PMSI tunnel to an S-PMSI tunnel. If the forwarding rate is consistently lower than the specified switchover threshold throughout the timer lifecycle, the device still uses the I-PMSI tunnel to transmit multicast traffic.</p>
</p></li><li><span>Run the <a href="cmdqueryname=holddown-time"><b><span class="cmdname">holddown-time</span></b></a> <i><span class="varname">interval</span></i> command to set the delay for switching traffic from an S-PMSI tunnel back to the I-PMSI tunnel.</span><p><p>In some cases, the multicast traffic forwarding rate may fluctuate around the specified switchover threshold. To prevent multicast data traffic from being frequently switched between S-PMSI and I-PMSI tunnels, the device starts the switchback delay timer when the forwarding rate falls below the specified threshold rather than performing an immediate switchback. The device keeps monitoring the forwarding rate before the delay timer for the switchback from the S-PMSI tunnel expires. If the rate remains consistently lower than the threshold throughout the timer period, the device switches multicast traffic back to the I-PMSI tunnel. Otherwise, the device still uses the S-PMSI tunnel to forward multicast traffic.</p>
</p></li><li><span>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to exit the IPv6 MVPN S-PMSI view.</span></li><li><span>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to exit the VPN instance IPv6 address family MVPN view.</span></li><li><span>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to exit the VPN instance IPv6 address family view.</span></li><li><span>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to exit the VPN instance view.</span></li><li><span>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</span></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0016.html">Configuring MVPNv6 over BIERv6
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0018.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0020.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>