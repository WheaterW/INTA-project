
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a Routing Policy to Control Label Distribution on ASBRs">
<meta name="abstract" content="Configure a routing policy to control MPLS label allocation for each IPv4 route. The ASBR only allocates labels to the IPv4 routes that match the rules in the policy.">
<meta name="description" content="Configure a routing policy to control MPLS label allocation for each IPv4 route. The ASBR only allocates labels to the IPv4 routes that match the rules in the policy.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0038.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0043.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0045.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPv4 Multicast VPN_NG MVPN">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv4 Multicast VPN_NG MVPN">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IPv4 Multicast VPN_NG MVPN">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IPv4 Multicast VPN_NG MVPN">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IPv4 Multicast VPN_NG MVPN">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001225673468">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a Routing Policy to Control Label Distribution on ASBRs</title>
</head>
<body><a name="EN-US_TASK_0000001225673468"></a><a name="EN-US_TASK_0000001225673468"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a Routing Policy to Control Label Distribution on ASBRs</h1>
<div class="taskbody"><p>Configure a routing policy to control MPLS label allocation for each IPv4 route. The ASBR only allocates labels to the IPv4 routes that match the rules in the policy.</p>
<div class="steps"><a name="EN-US_TASK_0000001225673468__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=route-policy"><b><span class="cmdname">route-policy</span></b></a> <i><span class="varname">policy-name1</span></i> <strong><span>permit</span></strong> <strong><span>node</span></strong> <i><span class="varname">seq-number</span></i></span><p><p>The routing policy for local PE is configured. For the labeled IPv4 routes established to PEs in the same AS, allocate a new MPLS label for them.</p>
</p></li><li><span>Run <a href="cmdqueryname=if-match+mpls-label"><b><span class="cmdname">if-match mpls-label</span></b></a></span><p><p>A filter rule is configured to match IPv4 routes with labels.</p>
</p></li><li><span>Run <a href="cmdqueryname=apply+mpls-label"><b><span class="cmdname">apply mpls-label</span></b></a></span><p><p>New labels are allocated to matched IPv4 routes.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=route-policy"><b><span class="cmdname">route-policy</span></b></a> <i><span class="varname">policy-name2</span></i> <strong><span>permit</span></strong> <strong><span>node</span></strong> <i><span class="varname">seq-number</span></i></span><p><p>The routing policy for peer ASBRs is configured. For the routes received from PE of local AS, ASBR allocates MPLS labels to them before establish them to peer ASBRs.</p>
</p></li><li><span>Run <a href="cmdqueryname=apply+mpls-label"><b><span class="cmdname">apply mpls-label</span></b></a></span><p><p>New labels are allocated to matched IPv4 routes.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a> <strong><span>unicast</span></strong></span><p><p>The unicast IPv4 address family view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name1</span></i> <strong><span>export</span></strong></span><p><p>The route policy applicable to the local PE is applied.</p>
</p></li><li><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name2</span></i> <strong><span>export</span></strong></span><p><p>The route policy applicable to the peer ASBR is applied.</p>
</p></li><li><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>label-route-capability</span></strong></span><p><p>The capability to exchange labeled IPv4 routes with the local PE and the peer ASBR is configured.</p>
</p><p><p>In Option C, an inter-AS LSP must be established and the public network routes advertised between PEs and ASBRs carry MPLS labels.</p>
<p>An EBGP peer relationship must be established between ASBRs in different ASs for them to exchange labeled IPv4 routes.</p>
<p>The public network routes carrying MPLS labels are advertised through MP-BGP. According to relevant standards, label mappings about routes can be piggybacked inside the BGP Update messages that are used to advertise these routes. This feature is implemented through an extended BGP attribute, which enables BGP peers to process labeled IPv4 routes.</p>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0038.html">Configuring Inter-AS NG MVPN Option C
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0043.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0045.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>