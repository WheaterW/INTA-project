
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring PIM-SM Inter-domain Multicast">
<meta name="abstract" content="You can set up MSDP peer relationships between Rendezvous Points (RPs) in different PIM-SM domains in the same autonomous system (AS) or between the RPs in different ASs that have set up BGP peer relationships so that hosts can receive multicast data from the source in another PIM-SM domain in the AS or from the source in another AS.">
<meta name="description" content="You can set up MSDP peer relationships between Rendezvous Points (RPs) in different PIM-SM domains in the same autonomous system (AS) or between the RPs in different ASs that have set up BGP peer relationships so that hosts can receive multicast data from the source in another PIM-SM domain in the AS or from the source in another AS.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_0072.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_0074.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MSDP">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MSDP">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="MSDP">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="MSDP">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172367026">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring PIM-SM Inter-domain Multicast</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172367026"></a><a name="EN-US_TASK_0172367026"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring PIM-SM Inter-domain Multicast</h1>
<div class="taskbody"><p>You can set up MSDP peer relationships between Rendezvous Points (RPs) in different PIM-SM domains in the same autonomous system (AS) or between the RPs in different ASs that have set up BGP peer relationships so that hosts can receive multicast data from the source in another PIM-SM domain in the AS or from the source in another AS.</p>
<div class="context"><a name="EN-US_TASK_0172367026__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0172367026__fig_dc_vrp_multicast_cfg_007301">Figure 1</a>, there are two ASs. Each AS contains at least one PIM-SM domain and each PIM-SM domain may contain no or one multicast source and receiver. To enable the receiver in PIM-SM2 domain to receive both multicast data sent by S3 in PIM-SM3 domain and multicast data sent by S1 in PIM-SM1 domain, configure PIM-SM inter-domain multicast.</p>
<div class="fignone" id="EN-US_TASK_0172367026__fig_dc_vrp_multicast_cfg_007301"><a name="EN-US_TASK_0172367026__fig_dc_vrp_multicast_cfg_007301"></a><a name="fig_dc_vrp_multicast_cfg_007301"></a><span class="figcap"><b>Figure 1 </b>Configuring PIM-SM inter-domain multicast</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 3 in this example represent GE <span>0/1/0</span>, GE <span>0/2/0</span>, and GE <span>0/3/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001197814327.png"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.1.4.1.4.1.1" liSelected="liSelected"><p>Device</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.1.4.1.4.1.2" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.1.4.1.4.1.3" liSelected="liSelected"><p>IP Address</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="2" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.1 "><p><span class="keyword">Device</span>A</p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.2 "><p>GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.3 "><p>10.110.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.2 "><p>GigabitEthernet<span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.3 "><p>192.168.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="4" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.1 "><p><span class="keyword">Device</span>B</p>
<p></p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.2 "><p>Loopback0</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.3 "><p>1.1.1.1/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.2 "><p>GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.3 "><p>192.168.2.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.2 "><p>GigabitEthernet<span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.3 "><p>192.168.1.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.2 "><p>GigabitEthernet<span>0/3/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.3 "><p>192.168.6.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="4" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.1 "><p><span class="keyword">Device</span>C</p>
<p></p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.2 "><p>Loopback0</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.3 "><p>2.2.2.2/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.2 "><p>GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.3 "><p>192.168.2.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.2 "><p>GigabitEthernet<span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.3 "><p>192.168.3.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.2 "><p>GigabitEthernet<span>0/3/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.3 "><p>192.168.4.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.1 "><p><span class="keyword">Device</span>D</p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.2 "><p>GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.3 "><p>10.110.2.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.2 "><p>GigabitEthernet<span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.3 "><p>192.168.3.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="4" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.1 "><p><span class="keyword">Device</span>E</p>
<p></p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.2 "><p>Loopback0</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.3 "><p>3.3.3.3/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.2 "><p>GigabitEthernet<span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.3 "><p>192.168.5.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.2 "><p>GigabitEthernet<span>0/3/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.3 "><p>192.168.4.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.2 "><p>GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.3 "><p>192.168.6.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.1 "><p><span class="keyword">Device</span>F</p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.2 "><p>GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.4.1.4.1.3 "><p>10.110.3.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.2 "><p>GigabitEthernet<span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.1.4.1.3 "><p>192.168.5.2/24</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172367026__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>Note the following precautions during configuration:</p>
<ul><li><p>Establish an MSDP peer relationship between BGP peers only when the RP and the unicast autonomous system boundary router (ASBR) are configured on the same <span class="keyword">Router</span>.</p>
</li><li><p>The address of the interface on which the MSDP peer is configured must be the same as that of the interface on which the External Border Gateway Protocol (EBGP) peer is configured.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172367026__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure an IP address for each <span class="keyword">Router</span> interface and configure OSPF in the ASs to ensure that unicast routes are reachable between the ASs.</p>
</li><li><p>Establish an EBGP peer relationship between ASs and configure BGP and OSPF to import routes from each other to ensure that unicast routes are reachable between the ASs.</p>
</li><li><p>Enable multicast routing, enable PIM-SM on each interface, configure BSR boundaries to divide PIM-SM domains, and enable IGMP on interfaces connected to hosts.</p>
</li><li><p>Configure the Candidate-BootStrap Router (C-BSR) and the Candidate-Rendezvous Point (C-RP). Configure the RPs of PIM-SM1 and PIM-SM2 on the ASBRs in the two domains.</p>
</li><li><p>Establish MSDP peer relationships between RPs of PIM-SM domains.</p>
</li><li><p>Add all MSDP peers in the same and different ASs to the same mesh group.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172367026__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Multicast group address</p>
</li><li><p>AS number of <span class="keyword">Device</span>A and <span class="keyword">Device</span>B; router ID of <span class="keyword">Device</span>B</p>
</li><li><p>AS number of <span class="keyword">Device</span>C and <span class="keyword">Device</span>D; router ID of <span class="keyword">Device</span>C</p>
</li><li><p>AS number of <span class="keyword">Device</span>E and <span class="keyword">Device</span>F</p>
</li><li><p>Name of the mesh group that MSDP peers join</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172367026__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure an IP address for each <span class="keyword">Router</span> interface and configure OSPF in the ASs. For configuration details, see Configuration Files in this section.</span></li><li><span>Establish an EBGP peer relationship between ASs and configure BGP and OSPF to import routes from each other.</span><p><p># Configure EBGP on <span class="keyword">Device</span>B and import OSPF routes.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bgp] <strong>router-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bgp] <strong>peer 192.168.2.2 as-number 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bgp] <strong>peer 192.168.2.2 ebgp-max-hop 255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bgp] <strong>peer 192.168.6.2 as-number 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bgp] <strong>peer 192.168.6.2 ebgp-max-hop 255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bgp] <strong>import-route ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bgp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-bgp] <strong>quit</strong></pre>
<p># Configure EBGP on <span class="keyword">Device</span>C and import OSPF routes.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>bgp 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp] <strong>router-id 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp] <strong>peer 192.168.2.1 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp] <strong>peer 192.168.2.1 ebgp-max-hop 255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp] <strong>import-route ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-bgp] <strong>quit</strong></pre>
<p># Configure EBGP on <span class="keyword">Device</span>E and import OSPF routes.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>E] <strong>bgp 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-bgp] <strong>router-id 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-bgp] <strong>peer 192.168.6.1 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-bgp] <strong>peer 192.168.6.1 ebgp-max-hop 255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-bgp] <strong>import-route ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-bgp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>E-bgp] <strong>quit</strong></pre>
<p># Import BGP routes to OSPF on <span class="keyword">Device</span>B. Repeat this step for <span class="keyword">Device</span>C and <span class="keyword">Device</span>E. The configurations of <span class="keyword">Device</span>C and <span class="keyword">Device</span>E are similar to that of <span class="keyword">Device</span>B. For configuration details, see Configuration Files in this section.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1] <strong>import-route bgp</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ospf-1] <strong>quit</strong></pre>
</p></li><li><span>Enable multicast routing, enable PIM-SM on interfaces, and configure BSR boundaries.</span><p><p># Enable multicast routing on <span class="keyword">Device</span>B and enable PIM-SM on each interface. Repeat this step for other <span class="keyword">Router</span>s. The configurations of other <span class="keyword">Router</span>s are similar to that of <span class="keyword">Device</span>B. For configuration details, see Configuration Files in this section.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>multicast routing-enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface GigabitEthernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>pim sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>pim sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface GigabitEthernet <span>0/3/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/3/0</span>] <strong>pim sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/3/0</span>] <strong>commit</strong></pre>
<p># Configure a BSR boundary on GE <span>0/1/0</span> and GE <span>0/3/0</span> on <span class="keyword">Device</span>B.</p>
<p>Repeat this step for GE <span>0/3/0</span> and GE <span>0/1/0</span> on <span class="keyword">Device</span>E, as well as GE <span>0/1/0</span> and GE <span>0/3/0</span> on <span class="keyword">Device</span>C. The configurations of <span class="keyword">Device</span>E and <span class="keyword">Device</span>C are similar to that of <span class="keyword">Device</span>B. For configuration details, see Configuration Files in this section.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>pim bsr-boundary</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>interface GigabitEthernet <span>0/3/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/3/0</span>] <strong>pim bsr-boundary</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/3/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/3/0</span>] <strong>quit</strong></pre>
</p></li><li><span>Enable IGMP on interfaces connected to hosts.</span><p><p># Enable IGMP on the interface connecting <span class="keyword">Device</span>D to hosts.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D-GigabitEthernet<span>0/1/0</span>] <strong>igmp enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
</p></li><li><span>Configure a C-BSR and a C-RP.</span><p><p># Create Loopback 0 on <span class="keyword">Device</span>B and configure Loopback 0 as both a C-BSR and a C-RP. The configurations of <span class="keyword">Device</span>C and <span class="keyword">Device</span>E are similar to the configuration of <span class="keyword">Device</span>B. For configuration details, see Configuration Files in this section.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>interface loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack0] <strong>ip address 1.1.1.1 255.255.255.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack0] <strong>pim sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>pim</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-pim] <strong>c-bsr loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-pim] <strong>c-rp loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-pim] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-pim] <strong>quit</strong></pre>
</p></li><li><span>Establish MSDP peer relationships.</span><p><p># Configure an MSDP peer on <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>msdp</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-msdp] <strong>peer 192.168.2.2 connect-interface GigabitEthernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-msdp] <strong>peer 192.168.6.2 connect-interface GigabitEthernet<span>0/3/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-msdp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-msdp] <strong>quit</strong></pre>
<p># Configure an MSDP peer on <span class="keyword">Device</span>C.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>msdp</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-msdp] <strong>peer 192.168.2.1 connect-interface GigabitEthernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-msdp] <strong>peer 192.168.4.2 connect-interface GigabitEthernet<span>0/3/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-msdp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-msdp] <strong>quit</strong></pre>
<p># Configure an MSDP peer on <span class="keyword">Device</span>E.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>E] <strong>msdp</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-msdp] <strong>peer 192.168.4.1 connect-interface GigabitEthernet<span>0/3/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-msdp] <strong>peer 192.168.6.1 connect-interface GigabitEthernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-msdp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>E-msdp] <strong>quit</strong></pre>
</p></li><li><span>Add all MSDP peers in the same and different ASs to the same mesh group.</span><p><p># Add <span class="keyword">Device</span>B to the mesh group <strong>group1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>msdp</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-msdp] <strong>peer 192.168.2.2 mesh-group group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-msdp] <strong>peer 192.168.6.2 mesh-group group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-msdp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-msdp] <strong>quit</strong></pre>
<p># Add <span class="keyword">Device</span>C to the mesh group <strong>group1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>msdp</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-msdp] <strong>peer 192.168.2.1 mesh-group group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-msdp] <strong>peer 192.168.4.2 mesh-group group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-msdp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-msdp] <strong>quit</strong></pre>
<p># Add <span class="keyword">Device</span>E to the mesh group <strong>group1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>E] <strong>msdp</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-msdp] <strong>peer 192.168.4.1 mesh-group group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-msdp] <strong>peer 192.168.6.1 mesh-group group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-msdp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>E-msdp] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Run the <strong>display bgp peer</strong> command. The command output shows BGP peer relationships established between <span class="keyword">Router</span>s. For example, the BGP peer relationship between <span class="keyword">Device</span>B and <span class="keyword">Device</span>C is displayed as follows:</p>
<pre class="screen">&lt;<span class="keyword">Device</span>B&gt; <strong>display bgp peer</strong></pre>
<pre class="screen"></pre>
<pre class="screen"> BGP local router ID : 1.1.1.1
 Local AS number : 100
 Total number of peers : 1         Peers in established state : 1

  Peer              V    AS  MsgRcvd  MsgSent  OutQ  Up/Down       State PrefRcv

  192.168.2.2       4   200       52       49     0 00:42:37 Established        7</pre>
<p># Run the <strong>display bgp routing-table</strong> command. The command output shows BGP routing tables on <span class="keyword">Router</span>s. For example, the BGP routing table on <span class="keyword">Device</span>C is displayed as follows:</p>
<pre class="screen">&lt;<span class="keyword">Device</span>C&gt; <strong>display bgp routing-table</strong></pre>
<pre class="screen"></pre>
<pre class="screen"> 
 BGP Local router ID is 2.2.2.2
 Status codes: * - valid, &gt; - best, d - damped,<span> x - best external,</span><span> a - add path,</span>
               h - history,  i - internal, s - suppressed, S - Stale
               Origin : i - IGP, e - EGP, ? - incomplete

 Total Number of Routes: 10
      Network            NextHop        MED        LocPrf    PrefVal Path/Ogn

 *&gt;   1.1.1.1/32         192.168.2.1     0                     0      100?
 *&gt;   2.2.2.2/32         0.0.0.0         0                     0      ?
 *&gt;   3.3.3.3/32         0.0.0.0         1                     0      ?
 *&gt;   10.110.1.0/24      192.168.2.1     2                     0      100?
 *&gt;   10.110.2.0/24      0.0.0.0         2                     0      ?
 *&gt;   10.110.3.0/24      0.0.0.0         3                     0      ?
 *&gt;   192.168.1.0        192.168.2.1     1                     0      100?
 *&gt;   192.168.3.0        0.0.0.0         1                     0      ?
 *&gt;   192.168.4.0        0.0.0.0         1                     0      ?
 *&gt;   192.168.5.0        0.0.0.0         2                     0      ?</pre>
<p># Run the <strong>display msdp brief</strong> command. The command output shows MSDP peer relationships established between <span class="keyword">Router</span>s. The brief information about MSDP peer relationships established between <span class="keyword">Device</span>B and <span class="keyword">Device</span>C and <span class="keyword">Device</span>E is displayed as follows:</p>
<pre class="screen">&lt;<span class="keyword">Device</span>B&gt;<strong> display msdp brief</strong></pre>
<pre class="screen"></pre>
<pre class="screen">MSDP Peer Brief Information of VPN-Instance: public net</pre>
<pre class="screen">  Configured   Up           Listen       Connect      Shutdown     Down</pre>
<pre class="screen">  2            2            0            0            0            0</pre>
<pre class="screen"></pre>
<pre class="screen">  Peer's Address     State     Up/Down time    AS     SA Count   Reset Count</pre>
<pre class="screen">  192.168.2.2        Up        00:12:27        200    13         0</pre>
<pre class="screen">  192.168.6.2        Up        01:13:08        200    13         0</pre>
<pre class="screen">&lt;<span class="keyword">Device</span>C&gt; <strong>display msdp brief</strong></pre>
<pre class="screen"></pre>
<pre class="screen">MSDP Peer Brief Information of VPN-Instance: public net</pre>
<pre class="screen">  Configured   Up           Listen       Connect      Shutdown     Down</pre>
<pre class="screen">  2            2            0            0            0            0</pre>
<pre class="screen"></pre>
<pre class="screen">  Peer's Address     State     Up/Down time    AS     SA Count   Reset Count</pre>
<pre class="screen">  192.168.2.1        Up        01:07:08        100    8          0</pre>
<pre class="screen">  192.168.4.2        Up        00:06:39        200    13         0</pre>
<pre class="screen"></pre>
<pre class="screen">&lt;<span class="keyword">Device</span>E&gt; <strong>display msdp brief</strong></pre>
<pre class="screen"></pre>
<pre class="screen">MSDP Peer Brief Information of VPN-Instance: public net</pre>
<pre class="screen">  Configured   Up           Listen       Connect      Shutdown     Down</pre>
<pre class="screen">  2            2            0            0            0            0</pre>
<pre class="screen">  Peer's Address     State     Up/Down time    AS     SA Count   Reset Count</pre>
<pre class="screen">  192.168.4.1        Up        00:15:32        200    8          0</pre>
<pre class="screen">  192.168.6.1        Up        01:18:40        100    8          0</pre>
<p># Run the <strong>display msdp peer-status</strong> command. The command output shows detailed information about MSDP peer relationships established between <span class="keyword">Router</span>s. The detailed information about MSDP peer relationships on <span class="keyword">Device</span>B is displayed as follows:</p>
<pre class="screen">&lt;<span class="keyword">Device</span>B&gt; <strong>display msdp peer-status</strong></pre>
<pre class="screen"></pre>
<pre class="screen">MSDP Peer Information of VPN-Instance: public net</pre>
<pre class="screen">  MSDP Peer 192.168.2.2, AS 200</pre>
<pre class="screen">  Description:</pre>
<pre class="screen">  Information about connection status:</pre>
<pre class="screen">    State: Up</pre>
<pre class="screen">    Up/down time: 00:15:47</pre>
<pre class="screen">    Resets: 0</pre>
<pre class="screen">    Connection interface: GigabitEthernet<span>0/1/0</span> (192.168.2.1)</pre>
<pre class="screen">    Number of sent/received messages: 16/16</pre>
<pre class="screen">    Number of discarded output messages: 0</pre>
<pre class="screen">    Elapsed time since last connection or counters clear: 00:17:51</pre>
<pre class="screen">    Mesh group peer joined: group1</pre>
<pre class="screen">  Information about (Source, Group)-based SA filtering policy:</pre>
<pre class="screen">    Import policy: none</pre>
<pre class="screen">    Export policy: none</pre>
<pre class="screen">  Information about SA-Requests:</pre>
<pre class="screen">    Policy to accept SA-Request messages: none</pre>
<pre class="screen">    Sending SA-Requests status: disable</pre>
<pre class="screen">  Minimum TTL to forward SA with encapsulated data: 0</pre>
<pre class="screen">  SAs learned from this peer: 0, SA-cache maximum for the peer: none</pre>
<pre class="screen">  Input queue size: 0, Output queue size: 0</pre>
<pre class="screen">  Counters for MSDP message:</pre>
<pre class="screen">    Count of RPF check failure: 0</pre>
<pre class="screen">    Incoming/outgoing SA messages: 0/0</pre>
<pre class="screen">    Incoming/outgoing SA requests: 0/0</pre>
<pre class="screen">    Incoming/outgoing SA responses: 0/0</pre>
<pre class="screen">    Incoming/outgoing data packets: 0/0</pre>
<pre class="screen">    Peer authentication: unconfigured
    Peer authentication: none
</pre>
<pre class="screen">  MSDP Peer 192.168.6.2, AS 200
  Description:
  Information about connection status:
    State: Up
    Up/down time: 01:10:49
    Resets: 0
    Connection interface: GigabitEthernet<span>0/3/0</span> (192.168.6.1)
    Number of sent/received messages: 71/71
    Number of discarded output messages: 0
    Elapsed time since last connection or counters clear: 01:11:50
    Mesh group peer joined: group1
  Information about (Source, Group)-based SA filtering policy:
    Import policy: none
    Export policy: none
  Information about SA-Requests:
    Policy to accept SA-Request messages: none
    Sending SA-Requests status: disable
  Minimum TTL to forward SA with encapsulated data: 0
  SAs learned from this peer: 0, SA-cache maximum for the peer: none
  Input queue size: 0, Output queue size: 0
  Counters for MSDP message:
    Count of RPF check failure: 0
    Incoming/outgoing SA messages: 0/0
    Incoming/outgoing SA requests: 0/0
    Incoming/outgoing SA responses: 0/0
    Incoming/outgoing data packets: 0/0
  Peer authentication: unconfigured
  Peer authentication type: none</pre>
<p># Run the <strong>display pim routing-table</strong> command. The command output shows PIM routing tables on <span class="keyword">Router</span>s. When S1 (10.110.1.2/24) in PIM-SM1 domain and S3 (10.110.3.2/24) in PIM-SM3 domain send multicast data to G (225.1.1.1/24), Receiver (10.110.2.2/24) in PIM-SM2 domain can receive the multicast data. Information about the PIM routing tables on <span class="keyword">Device</span>B and <span class="keyword">Device</span>C is as follows:</p>
<pre class="screen">&lt;<span class="keyword">Device</span>B&gt; <strong>display pim routing-table</strong></pre>
<pre class="screen">VPN-Instance: public net</pre>
<pre class="screen"> Total 0 (*, G) entry; 1 (S, G) entry</pre>
<pre class="screen"></pre>
<pre class="screen"> (10.110.1.2, 225.1.1.1)</pre>
<pre class="screen">     RP: 1.1.1.1(local)</pre>
<pre class="screen">     Protocol: pim-sm, Flag: SPT 2MSDP ACT</pre>
<pre class="screen">     UpTime: 00:00:42</pre>
<pre class="screen">     Upstream interface: GigabitEthernet<span>0/2/0</span>, Refresh time: 00:00:42</pre>
<pre class="screen">         Upstream neighbor: 192.168.1.1</pre>
<pre class="screen">         RPF neighbor: 192.168.1.1</pre>
<pre class="screen">     Downstream interface(s) information:</pre>
<pre class="screen">     Total number of downstreams: 1</pre>
<pre class="screen">         1: GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen">             Protocol: pim-sm, UpTime: 00:00:42, Expires:-</pre>
<pre class="screen"></pre>
<pre class="screen">&lt;<span class="keyword">Device</span>C&gt; <strong>display pim routing-table</strong></pre>
<pre class="screen">VPN-Instance: public net</pre>
<pre class="screen"> Total 1 (*, G) entry; 2 (S, G) entries</pre>
<pre class="screen"></pre>
<pre class="screen">(*, 225.1.1.1)</pre>
<pre class="screen">     RP: 2.2.2.2(local)</pre>
<pre class="screen">     Protocol: pim-sm, Flag: WC</pre>
<pre class="screen">     UpTime: 00:13:46</pre>
<pre class="screen">     Upstream interface: NULL, Refresh time: 00:13:46</pre>
<pre class="screen">         Upstream neighbor: NULL</pre>
<pre class="screen">         RPF prime neighbor: NULL</pre>
<pre class="screen">    Downstream interface(s) information:</pre>
<pre class="screen">     Total number of downstreams: 1</pre>
<pre class="screen">         1: GigabitEthernet<span>0/2/0</span>,</pre>
<pre class="screen">             Protocol: pim-sm, UpTime: 00:13:46, Expires:-</pre>
<pre class="screen">(10.110.1.2, 225.1.1.1)</pre>
<pre class="screen">     RP: 2.2.2.2</pre>
<pre class="screen">     Protocol: pim-sm, Flag: SPT MSDP ACT</pre>
<pre class="screen">     UpTime: 00:00:42</pre>
<pre class="screen">     Upstream interface: GigabitEthernet<span>0/1/0</span>, Refresh time: 00:00:42</pre>
<pre class="screen">         Upstream neighbor: 192.168.2.1</pre>
<pre class="screen">         RPF neighbor: 192.168.2.1</pre>
<pre class="screen">     Downstream interface(s) information:</pre>
<pre class="screen">     Total number of downstreams: 1</pre>
<pre class="screen">         1: GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen">             Protocol: pim-sm, UpTime: 00:00:42, Expires:-</pre>
<pre class="screen">(10.110.3.2, 225.1.1.1)</pre>
<pre class="screen">     RP: 2.2.2.2</pre>
<pre class="screen">     Protocol: pim-sm, Flag: SPT MSDP ACT</pre>
<pre class="screen">     UpTime: 00:00:42</pre>
<pre class="screen">     Upstream interface: GigabitEthernet<span>0/3/0</span>, Refresh time: 00:00:42</pre>
<pre class="screen">         Upstream neighbor: 192.168.4.2</pre>
<pre class="screen">         RPF neighbor: 192.168.4.2</pre>
<pre class="screen">     Downstream interface(s) information:</pre>
<pre class="screen">     Total number of downstreams: 1</pre>
<pre class="screen">         1: GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen">             Protocol: pim-sm, UpTime: 00:00:42, Expires:-</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172367026__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><span class="keyword">Device</span>A configuration file<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>A</pre>
<pre class="screen">#</pre>
<pre class="screen">multicast routing-enable</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.110.1.1 255.255.255.0</pre>
<pre class="screen"> pim sm</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 192.168.1.1 255.255.255.0</pre>
<pre class="screen"> pim sm</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 192.168.1.0 0.0.0.255</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p><span class="keyword">Device</span>B configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>B</pre>
<pre class="screen">#</pre>
<pre class="screen">multicast routing-enable</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 192.168.2.1 255.255.255.0</pre>
<pre class="screen"> pim bsr-boundary</pre>
<pre class="screen"> pim sm</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 192.168.1.2 255.255.255.0</pre>
<pre class="screen"> pim sm</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/3/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 192.168.6.1 255.255.255.0</pre>
<pre class="screen"> pim bsr-boundary</pre>
<pre class="screen"> pim sm</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack0</pre>
<pre class="screen"> ip address 1.1.1.1 255.255.255.255</pre>
<pre class="screen"> pim sm</pre>
<pre class="screen">#</pre>
<pre class="screen">pim</pre>
<pre class="screen"> c-bsr LoopBack0</pre>
<pre class="screen"> c-rp LoopBack0</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> import-route BGP</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 192.168.1.0 0.0.0.255</pre>
<pre class="screen">  network 1.1.1.1 0.0.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">bgp 100</pre>
<pre class="screen"> router-id 1.1.1.1</pre>
<pre class="screen"> peer 192.168.2.2 as-number 200</pre>
<pre class="screen"> peer 192.168.6.2 as-number 200</pre>
<pre class="screen"> peer 192.168.2.2 ebgp-max-hop 255</pre>
<pre class="screen"> peer 192.168.6.2 ebgp-max-hop 255</pre>
<pre class="screen"> #</pre>
<pre class="screen"> ipv4-family unicast</pre>
<pre class="screen">  import-route ospf 1</pre>
<pre class="screen">  peer 192.168.2.2 enable</pre>
<pre class="screen">  peer 192.168.6.2 enable</pre>
<pre class="screen">  peer 192.168.2.2 route-update-interval 0</pre>
<pre class="screen">#</pre>
<pre class="screen">msdp</pre>
<pre class="screen"> peer 192.168.2.2 connect-interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> peer 192.168.2.2 mesh-group group1</pre>
<pre class="screen"> peer 192.168.6.2 connect-interface GigabitEthernet<span>0/3/0</span>
 peer 192.168.6.2 mesh-group group1</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p><span class="keyword">Device</span>C configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>C</pre>
<pre class="screen">#</pre>
<pre class="screen">multicast routing-enable</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 192.168.2.2 255.255.255.0</pre>
<pre class="screen"> pim bsr-boundary</pre>
<pre class="screen"> pim sm</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 192.168.3.1 255.255.255.0</pre>
<pre class="screen"> pim sm</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/3/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 192.168.4.1 255.255.255.0</pre>
<pre class="screen"> pim bsr-boundary</pre>
<pre class="screen"> pim sm</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack0</pre>
<pre class="screen"> ip address 2.2.2.2 255.255.255.255</pre>
<pre class="screen"> pim sm</pre>
<pre class="screen">#</pre>
<pre class="screen">pim</pre>
<pre class="screen"> c-bsr LoopBack0</pre>
<pre class="screen"> c-rp LoopBack0</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> import-route BGP</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 192.168.3.0 0.0.0.255</pre>
<pre class="screen">  network 192.168.4.0 0.0.0.255</pre>
<pre class="screen">  network 2.2.2.2 0.0.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">bgp 200</pre>
<pre class="screen"> router-id 2.2.2.2</pre>
<pre class="screen"> peer 192.168.2.1 as-number 100</pre>
<pre class="screen"> peer 192.168.2.1 ebgp-max-hop 255</pre>
<pre class="screen"> #</pre>
<pre class="screen"> ipv4-family unicast</pre>
<pre class="screen">  import-route ospf 1</pre>
<pre class="screen">  peer 192.168.2.1 enable</pre>
<pre class="screen">  peer 192.168.2.1 route-update-interval 0</pre>
<pre class="screen">#</pre>
<pre class="screen">msdp</pre>
<pre class="screen"> peer 192.168.2.1 connect-interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> peer 192.168.2.1 mesh-group group1</pre>
<pre class="screen"> peer 192.168.4.2 connect-interface GigabitEthernet<span>0/3/0</span></pre>
<pre class="screen"> peer 192.168.4.2 mesh-group group1</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><span class="keyword">Device</span>D configuration file<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>D</pre>
<pre class="screen">#</pre>
<pre class="screen">multicast routing-enable</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.110.2.1 255.255.255.0</pre>
<pre class="screen"> pim sm</pre>
<pre class="screen"> igmp enable</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 192.168.3.2 255.255.255.0</pre>
<pre class="screen"> pim sm</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 192.168.3.0 0.0.0.255</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p><span class="keyword">Device</span>E configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>E</pre>
<pre class="screen">#</pre>
<pre class="screen">multicast routing-enable</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 192.168.5.1 255.255.255.0</pre>
<pre class="screen"> pim sm</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/3/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 192.168.4.2 255.255.255.0</pre>
<pre class="screen"> pim bsr-boundary</pre>
<pre class="screen"> pim sm</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 192.168.6.2 255.255.255.0</pre>
<pre class="screen"> pim bsr-boundary</pre>
<pre class="screen"> pim sm</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack0</pre>
<pre class="screen"> ip address 3.3.3.3 255.255.255.255</pre>
<pre class="screen"> pim sm</pre>
<pre class="screen">#</pre>
<pre class="screen">pim</pre>
<pre class="screen"> c-bsr LoopBack0</pre>
<pre class="screen"> c-rp LoopBack0</pre>
<pre class="screen"># </pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> import-route BGP</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 192.168.4.0 0.0.0.255</pre>
<pre class="screen">  network 192.168.5.0 0.0.0.255</pre>
<pre class="screen">  network 3.3.3.3 0.0.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">bgp 200</pre>
<pre class="screen"> router-id 3.3.3.3</pre>
<pre class="screen"> peer 192.168.6.1 as-number 100</pre>
<pre class="screen"> peer 192.168.6.1 ebgp-max-hop 255</pre>
<pre class="screen"> #</pre>
<pre class="screen"> ipv4-family unicast</pre>
<pre class="screen">  import-route ospf 1</pre>
<pre class="screen">  peer 192.168.6.1 enable</pre>
<pre class="screen">#</pre>
<pre class="screen">msdp</pre>
<pre class="screen"> peer 192.168.4.1 connect-interface GigabitEthernet<span>0/3/0</span></pre>
<pre class="screen"> peer 192.168.4.1 mesh-group group1</pre>
<pre class="screen"> peer 192.168.6.1 connect-interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> peer 192.168.6.1 mesh-group group1</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_0072.html">Configuration Examples for MSDP
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_0074.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>