
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Routing Loop Detection for Routes Imported from OSPF to IS-IS">
<meta name="abstract" content="This section provides an example for configuring routing loop detection for routes imported from OSPF to IS-IS.">
<meta name="description" content="This section provides an example for configuring routing loop detection for routes imported from OSPF to IS-IS.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_isis_cfg_0078.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_isis_cfg_2012.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_isis_cfg_0111.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IS-IS">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IS-IS">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="IS-IS">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="IS-IS">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00875216">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00875216">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001208210957">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Routing Loop Detection for Routes Imported from OSPF to IS-IS</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001208210957"></a><a name="EN-US_TASK_0000001208210957"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Routing Loop Detection for Routes Imported from OSPF to IS-IS</h1>
<div class="taskbody"><p>This section provides an example for configuring routing loop detection for routes imported from OSPF to IS-IS.</p>
<div class="context"><a name="EN-US_TASK_0000001208210957__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the live network, IS-IS routes can be imported to an OSPF process for redistribution. In such a scenario, routing policies are usually configured on multiple devices to prevent routing loops. If routing policies are incorrectly configured on the devices that import routes, routing loops may occur. To prevent this problem, configure routing loop detection for the routes imported to IS-IS.</p>
<p>On the network shown in <a href="#EN-US_TASK_0000001208210957__fig799521210588">Figure 1</a>, IS-IS process 2 is configured on <span class="keyword">Device</span>A, <span class="keyword">Device</span>B, and <span class="keyword">Device</span>F, an OSPF process is configured on <span class="keyword">Device</span>B, <span class="keyword">Device</span>C, <span class="keyword">Device</span>E, and <span class="keyword">Device</span>F, and IS-IS process 1 is configured on <span class="keyword">Device</span>C, <span class="keyword">Device</span>D, and <span class="keyword">Device</span>E. <span class="keyword">Device</span>C is configured to import routes from IS-IS process 1 to the OSPF process, <span class="keyword">Device</span>B is configured to import routes from the OSPF process to IS-IS process 2, and <span class="keyword">Device</span>F is configured to import routes from IS-IS process 2 to the OSPF process.</p>
<div class="fignone" id="EN-US_TASK_0000001208210957__fig799521210588"><a name="EN-US_TASK_0000001208210957__fig799521210588"></a><a name="fig799521210588"></a><span class="figcap"><b>Figure 1 </b>Routing loop detection for routes imported from OSPF to IS-IS</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1, interface2, and interface3 represent GE<span>0/1/0</span>, GE<span>0/2/0</span>, and GE<span>0/3/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001162652626.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001208210957__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>To improve security, you are advised to configure IS-IS authentication. For details, see "Configuring IS-IS Authentication." IS-IS interface authentication is used as an example. For details, see Example for Configuring Basic IS-IS Functions.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001208210957__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure IP addresses for interfaces on each device to implement area connectivity.</p>
</li><li><p>Enable IS-IS and OSPF, and configure basic IS-IS and OSPF functions.</p>
</li><li>Configure route import to construct a routing loop.</li><li><p>View routing entries to check whether a routing loop occurs.</p>
</li><li>Enable routing loop detection and view routing entries to check whether the routing loop is eliminated.</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001208210957__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure an IP address for each interface.</span><p><p><span class="keyword">Device</span>A, <span class="keyword">Device</span>B, <span class="keyword">Device</span>C, and <span class="keyword">Device</span>D are used as examples.</p>
<p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">&lt;DeviceA&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface</strong> <strong>gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword">*</span>DeviceA-GigabitEthernet<span>0/1/0</span>] <strong>ip address 10.12.1.1 24</strong>
[<span class="keyword">*</span>DeviceA-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface</strong> <strong>gigabitethernet <span>0/2/0</span></strong>
[<span class="keyword">*</span>DeviceA-GigabitEthernet<span>0/2/0</span>] <strong>ip address 10.16.1.1 24</strong>
[<span class="keyword">*</span>DeviceA-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">&lt;DeviceB&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>interface</strong> <strong>gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword">*</span>DeviceB-GigabitEthernet<span>0/1/0</span>] <strong>ip address 10.12.1.2 24</strong>
[<span class="keyword">*</span>DeviceB-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface</strong> <strong>gigabitethernet <span>0/2/0</span></strong>
[<span class="keyword">*</span>DeviceB-GigabitEthernet<span>0/2/0</span>] <strong>ip address 10.26.1.2 24</strong>
[<span class="keyword">*</span>DeviceB-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface</strong> <strong>gigabitethernet <span>0/3/0</span></strong>
[<span class="keyword">*</span>DeviceB-GigabitEthernet<span>0/3/0</span>] <strong>ip address 10.23.1.2 24</strong>
[<span class="keyword">*</span>DeviceB-GigabitEthernet<span>0/3/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span>C.</p>
<pre class="screen">&lt;DeviceC&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>interface</strong> <strong>gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword">*</span>DeviceC-GigabitEthernet<span>0/1/0</span>] <strong>ip address 10.23.1.3 24</strong>
[<span class="keyword">*</span>DeviceC-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC] <strong>interface</strong> <strong>gigabitethernet <span>0/2/0</span></strong>
[<span class="keyword">*</span>DeviceC-GigabitEthernet<span>0/2/0</span>] <strong>ip address 10.35.1.3 24</strong>
[<span class="keyword">*</span>DeviceC-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC] <strong>interface</strong> <strong>gigabitethernet <span>0/3/0</span></strong>
[<span class="keyword">*</span>DeviceC-GigabitEthernet<span>0/3/0</span>] <strong>ip address 10.34.1.3 24</strong>
[<span class="keyword">*</span>DeviceC-GigabitEthernet<span>0/3/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span>D. The route 10.1.1.1/32 on the loopback interface of <span class="keyword">Device</span>D is used as the locally originated route.</p>
<pre class="screen">&lt;DeviceD&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D] <strong>interface</strong> <strong>loopBack 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack1] <strong>ip address 10.1.1.1 32</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack1] <strong>commit</strong></pre>
<p>The configurations of other devices are similar to those of the preceding devices. For details, see <a href="#EN-US_TASK_0000001208210957__section_dc_vrp_isis_cfg_201205">Configuration Files</a> in this section.</p>
</p></li><li><span>Enable IS-IS and OSPF, and configure basic IS-IS and OSPF functions and a link cost to implement intra-area interworking.</span><p><p># Configure IS-IS process 2 on <span class="keyword">Device</span>A, <span class="keyword">Device</span>B, and <span class="keyword">Device</span>F. <span class="keyword">Device</span>A is used as an example.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>isis 2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-isis-2] <strong>cost-style wide</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-isis-2] <strong>network-entity 10.1111.0000.0001.00</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-isis-2] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>isis enable 2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>isis circuit-type p2p</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>isis cost 10</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface gigabitethernet <span>0/2/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>] <strong>isis enable 2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>] <strong>isis circuit-type p2p</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>] <strong>isis cost 10</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
<p>The configurations of <span class="keyword">Device</span>B and <span class="keyword">Device</span>F are similar to the configuration of <span class="keyword">Device</span>A. For detailed configurations, see <a href="#EN-US_TASK_0000001208210957__section_dc_vrp_isis_cfg_201205">Configuration Files</a>.</p>
<p># Configure IS-IS process 1 on <span class="keyword">Device</span>C, <span class="keyword">Device</span>D, and <span class="keyword">Device</span>E. <span class="keyword">Device</span>D is used as an example.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D] <strong>isis 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-isis-1] <strong>cost-style wide</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-isis-1] <strong>network-entity 10.4444.0000.0001.00</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-isis-1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-GigabitEthernet<span>0/1/0</span>] <strong>isis enable 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-GigabitEthernet<span>0/1/0</span>] <strong>isis circuit-type p2p</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-GigabitEthernet<span>0/1/0</span>] <strong>isis cost 10</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>interface gigabitethernet <span>0/2/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-GigabitEthernet<span>0/2/0</span>] <strong>isis enable 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-GigabitEthernet<span>0/2/0</span>] <strong>isis circuit-type p2p</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-GigabitEthernet<span>0/2/0</span>] <strong>isis cost 10</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>interface</strong> <strong>loopBack 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack1] <strong>isis enable 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>commit</strong></pre>
<p>The configurations of <span class="keyword">Device</span>C and <span class="keyword">Device</span>E are similar to the configuration of <span class="keyword">Device</span>D. For detailed configurations, see <a href="#EN-US_TASK_0000001208210957__section_dc_vrp_isis_cfg_201205">Configuration Files</a>.</p>
<p># Configure OSPF on <span class="keyword">Device</span>B, <span class="keyword">Device</span>C, <span class="keyword">Device</span>E, and <span class="keyword">Device</span>F. <span class="keyword">Device</span>B is used as an example.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ospf 1</strong> <strong>router-id 2.2.2.2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1] <strong>area 0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface gigabitethernet <span>0/3/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/3/0</span>] <strong>ospf enable 1 area 0.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/3/0</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface gigabitethernet <span>0/2/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>ospf enable 1 area 0.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
<p>The configurations of <span class="keyword">Device</span>C, <span class="keyword">Device</span>E, and <span class="keyword">Device</span>F are similar to the configuration of <span class="keyword">Device</span>B. For detailed configurations, see <a href="#EN-US_TASK_0000001208210957__section_dc_vrp_isis_cfg_201205">Configuration Files</a>.</p>
</p></li><li><span>Configure route import.</span><p><p># Configure <span class="keyword">Device</span>C to import routes from IS-IS process 1 to the OSPF process.</p>
</p><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>ospf 1</strong> <strong>router-id 3.3.3.3</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1] <strong>import-route isis 1 cost 100 type 2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span>B to import routes from the OSPF process to IS-IS process 2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>isis 2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-isis-2] <strong>import-route ospf 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span>F to import routes from IS-IS process 2 to the OSPF process.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>F] <strong>ospf 1</strong> <strong>router-id 6.6.6.6</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>F-ospf-1] <strong>import-route isis 2 cost 10 type 2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>F-ospf-1] <strong>commit</strong></pre>
</p></li><li><span>View the routing tables on <span class="keyword">Device</span>B, <span class="keyword">Device</span>E, and <span class="keyword">Device</span>F to check whether a routing loop occurs.</span><p><p># Check OSPF neighbor information on <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display ospf peer</strong></pre>
<pre class="screen">(M) Indicates MADJ neighbor


          OSPF Process 1 with Router ID 2.2.2.2
                Neighbors

 Area 0.0.0.0 interface 10.23.1.2 (GigabitEthernet<span>0/3/0</span>)'s neighbors
 <strong>Router ID: 3.3.3.3</strong>             <strong> Address: 10.23.1.3</strong>
   State: Full           Mode:Nbr is Master     Priority: 1
   DR: 10.23.1.3        BDR: 10.23.1.2        MTU: 0
   Dead timer due in  3  sec
   Retrans timer interval: 5
   Neighbor is up for 28h43m46s
   Neighbor Up Time : 2021-08-23 09:20:09
   Authentication Sequence: [ 0 ]

 Area 0.0.0.0 interface 10.26.1.2 (GigabitEthernet<span>0/2/0</span>)'s neighbors
 <strong>Router ID: 6.6.6.6</strong>             <strong> Address: 10.26.1.6</strong>
   State: Full           Mode:Nbr is Master     Priority: 1
   DR: None              BDR: None              MTU: 0
   Dead timer due in  4  sec
   Retrans timer interval: 5
   Neighbor is up for 28h43m46s
   Neighbor Up Time : 2021-08-23 09:20:09
   Authentication Sequence: [ 0 ]</pre>
<p># Check IS-IS neighbor information on <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display isis peer</strong></pre>
<pre class="screen">                          Peer information for ISIS(2)

  System Id      Interface          Circuit Id        State HoldTime Type     PRI
--------------------------------------------------------------------------------
<strong>6666.0000.0001</strong>  GE<span>0/3/0</span>           0000000011         Up   29s      L1L2     --
<strong>1111.0000.0001</strong>  GE<span>0/2/0</span>           0000000025         Up   27s      L1L2     --

Total Peer(s): 2</pre>
<p>The preceding command outputs show that <span class="keyword">Device</span>B has established connections with <span class="keyword">Device</span>A, <span class="keyword">Device</span>C, and <span class="keyword">Device</span>F.</p>
<p># Check the routing table on <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display ip routing-table 10.1.1.1</strong></pre>
<pre class="screen">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route
------------------------------------------------------------------------------
Routing Table : _public_
Summary Count : 1

Destination/Mask    Proto   Pre  Cost        Flags NextHop         Interface

        10.1.1.1/24  O_ASE   150  1             D   <strong>10.26.1.6</strong>      GigabitEthernet<span>0/3/0</span></pre>
<p>The preceding command output shows that the next hop of the route displayed on <span class="keyword">Device</span>B is <span class="keyword">Device</span>F.</p>
</p><p><p># Check OSPF neighbor information on <span class="keyword">Device</span>F.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>F] <strong>display ospf peer</strong></pre>
<pre class="screen">(M) Indicates MADJ neighbor


          OSPF Process 1 with Router ID 6.6.6.6
                Neighbors

 Area 0.0.0.0 interface 10.56.1.6 (GigabitEthernet<span>0/3/0</span>)'s neighbors
<strong> Router ID: 5.5.5.5              Address: 10.56.1.5</strong>
   State: Full           Mode:Nbr is Slave      Priority: 1
   DR: 10.56.1.6        BDR: 10.56.1.5        MTU: 0
   Dead timer due in  4  sec
   Retrans timer interval: 5
   Neighbor is up for 28h52m49s
   Neighbor Up Time : 2021-08-23 09:20:11
   Authentication Sequence: [ 0 ]

 Area 0.0.0.0 interface 10.26.1.6 (GigabitEthernet<span>0/2/0</span>)'s neighbors
 <strong>Router ID: 2.2.2.2              Address: 10.26.1.2</strong>
   State: Full           Mode:Nbr is Slave      Priority: 1
   DR: None              BDR: None              MTU: 0
   Dead timer due in  3  sec
   Retrans timer interval: 5
   Neighbor is up for 28h52m51s
   Neighbor Up Time : 2021-08-23 09:20:09
   Authentication Sequence: [ 0 ]</pre>
<p># Check IS-IS neighbor information on <span class="keyword">Device</span>F.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>F] <strong>display isis peer</strong></pre>
<pre class="screen">                          Peer information for ISIS(2)

  System Id       Interface          Circuit Id        State HoldTime Type     PRI
--------------------------------------------------------------------------------
<strong>2222.0000.0001</strong>  GE<span>0/2/0</span>           0000000011         Up   28s      L1L2     --
<strong>1111.0000.0001</strong>  GE<span>0/1/0</span>           0000000011         Up   25s      L1L2     --

Total Peer(s): 2</pre>
<p>The preceding command outputs show that <span class="keyword">Device</span>F has established connections with <span class="keyword">Device</span>A, <span class="keyword">Device</span>B, and <span class="keyword">Device</span>E.</p>
<p># Check the routing table on <span class="keyword">Device</span>F.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>F] <strong>display ip routing-table 10.1.1.1</strong></pre>
<pre class="screen">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route
------------------------------------------------------------------------------
Routing Table : _public_
Summary Count : 1

Destination/Mask    Proto   Pre  Cost        Flags NextHop         Interface

        10.1.1.1/24  ISIS-L2 15   10            D  <strong> 10.26.1.2 </strong>     GigabitEthernet<span>0/2/0</span></pre>
<p>The preceding command output shows that the next hop of the route displayed on <span class="keyword">Device</span>F is <span class="keyword">Device</span>B.</p>
<p>In this case, a routing loop is formed between <span class="keyword">Device</span>B and <span class="keyword">Device</span>F.</p>
</p></li><li><span>Enable routing loop detection on each device.</span><p><p># Configure <span class="keyword">Device</span>A, which is used as an example.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>route loop-detect isis enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>route loop-detect ospf enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
<p>The configurations of other devices are similar to the configuration of <span class="keyword">Device</span>A. For detailed configurations, see <a href="#EN-US_TASK_0000001208210957__section_dc_vrp_isis_cfg_201205">Configuration Files</a>.</p>
</p></li><li><span>Check whether the routing loop is eliminated.</span><p><p># Check the routing table on <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display ip routing-table 10.1.1.1</strong></pre>
<pre class="screen">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route
------------------------------------------------------------------------------
Routing Table : _public_
Summary Count : 1

Destination/Mask    Proto   Pre  Cost        Flags NextHop         Interface

        10.1.1.1/24  O_ASE   150  100           D   <strong>10.23.1.3 </strong>      GigabitEthernet<span>0/3/0</span></pre>
<p>The preceding command output shows that the next hop of the route displayed on <span class="keyword">Device</span>B is <span class="keyword">Device</span>C.</p>
</p><p><p># Check the routing table on <span class="keyword">Device</span>F.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>F] <strong>display ip routing-table 10.1.1.1</strong></pre>
<pre class="screen">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route
------------------------------------------------------------------------------
Routing Table : _public_
Summary Count : 1

Destination/Mask    Proto   Pre  Cost        Flags NextHop         Interface

        10.1.1.1/24  ISIS-L2 15   10            D   <strong>10.26.1.2</strong>       GigabitEthernet<span>0/2/0</span></pre>
<p>The preceding command output shows that the next hop of the route displayed on <span class="keyword">Device</span>F is <span class="keyword">Device</span>B and that <span class="keyword">Device</span>B no longer prefers the route received from <span class="keyword">Device</span>F. This means that the routing loop between <span class="keyword">Device</span>B and <span class="keyword">Device</span>F is eliminated.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001208210957__section_dc_vrp_isis_cfg_201205"><a name="EN-US_TASK_0000001208210957__section_dc_vrp_isis_cfg_201205"></a><a name="section_dc_vrp_isis_cfg_201205"></a><a name="EN-US_TASK_0000001208210957__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span>A configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>A</pre>
<pre class="screen">#</pre>
<pre class="screen">isis 2</pre>
<pre class="screen"> cost-style wide</pre>
<pre class="screen"> network-entity 10.1111.0000.0001.00</pre>
<pre class="screen">#</pre>
<pre class="screen">route loop-detect isis enable</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.12.1.1 255.255.255.0</pre>
<pre class="screen"> isis enable 2</pre>
<pre class="screen"> isis circuit-type p2p</pre>
<pre class="screen"> isis cost 10</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.16.1.1 255.255.255.0</pre>
<pre class="screen"> isis enable 2</pre>
<pre class="screen"> isis circuit-type p2p</pre>
<pre class="screen"> isis cost 10</pre>
<pre class="screen">#</pre>
<pre class="screen">route loop-detect ospf enable</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p><span class="keyword">Device</span>B configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>B</pre>
<pre class="screen">#</pre>
<pre class="screen">isis 2</pre>
<pre class="screen"> cost-style wide</pre>
<pre class="screen"> network-entity 10.2222.0000.0001.00</pre>
<pre class="screen"> import-route ospf 1 </pre>
<pre class="screen">#</pre>
<pre class="screen">route loop-detect isis enable</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.12.1.2 255.255.255.0</pre>
<pre class="screen"> isis enable 2</pre>
<pre class="screen"> isis circuit-type p2p</pre>
<pre class="screen"> isis cost 10</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.26.1.2 255.255.255.0</pre>
<pre class="screen"> ospf network-type p2p</pre>
<pre class="screen"> ospf timer hello 1</pre>
<pre class="screen"> ospf enable 1 area 0.0.0.0</pre>
<pre class="screen"> isis enable 2</pre>
<pre class="screen"> isis circuit-type p2p</pre>
<pre class="screen"> isis cost 10</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/3/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.23.1.2 255.255.255.0</pre>
<pre class="screen"> ospf timer hello 1</pre>
<pre class="screen"> ospf enable 1 area 0.0.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1 router-id 2.2.2.2</pre>
<pre class="screen"> opaque-capability enable </pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">route loop-detect ospf enable</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p><span class="keyword">Device</span>C configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>C</pre>
<pre class="screen">#</pre>
<pre class="screen">isis 1</pre>
<pre class="screen"> cost-style wide</pre>
<pre class="screen"> network-entity 10.3333.0000.0001.00</pre>
<pre class="screen">#</pre>
<pre class="screen">route loop-detect isis enable</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.23.1.3 255.255.255.0</pre>
<pre class="screen"> ospf timer hello 1</pre>
<pre class="screen"> ospf enable 1 area 0.0.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.35.1.3 255.255.255.0</pre>
<pre class="screen"> ospf timer hello 1</pre>
<pre class="screen"> ospf enable 1 area 0.0.0.0</pre>
<pre class="screen"> isis enable 1</pre>
<pre class="screen"> isis circuit-type p2p</pre>
<pre class="screen"> isis cost 10</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/3/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.34.1.3 255.255.255.0</pre>
<pre class="screen"> isis enable 1</pre>
<pre class="screen"> isis circuit-type p2p</pre>
<pre class="screen"> isis cost 10</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1 router-id 3.3.3.3</pre>
<pre class="screen"> import-route isis 1 cost 100 type 2</pre>
<pre class="screen"> opaque-capability enable </pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">route loop-detect ospf enable</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p><span class="keyword">Device</span>D configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>D</pre>
<pre class="screen">#</pre>
<pre class="screen">isis 1</pre>
<pre class="screen"> cost-style wide</pre>
<pre class="screen"> network-entity 10.4444.0000.0001.00</pre>
<pre class="screen">#</pre>
<pre class="screen">route loop-detect isis enable</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack1</pre>
<pre class="screen"> ip address 10.1.1.1 255.255.255.255</pre>
<pre class="screen"> isis enable 1</pre>
<pre class="screen"> isis cost 10</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.45.1.4 255.255.255.0</pre>
<pre class="screen"> isis enable 1</pre>
<pre class="screen"> isis circuit-type p2p</pre>
<pre class="screen"> isis cost 10</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.34.1.4 255.255.255.0</pre>
<pre class="screen"> isis enable 1</pre>
<pre class="screen"> isis circuit-type p2p</pre>
<pre class="screen"> isis cost 10</pre>
<pre class="screen">#</pre>
<pre class="screen">route loop-detect ospf enable</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p><span class="keyword">Device</span>E configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>E</pre>
<pre class="screen">#</pre>
<pre class="screen">isis 1</pre>
<pre class="screen"> cost-style wide</pre>
<pre class="screen"> network-entity 10.5555.0000.0001.00</pre>
<pre class="screen">#</pre>
<pre class="screen">route loop-detect isis enable</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.56.1.5 255.255.255.0</pre>
<pre class="screen"> ospf timer hello 1</pre>
<pre class="screen"> ospf enable 1 area 0.0.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.35.1.5 255.255.255.0</pre>
<pre class="screen"> ospf timer hello 1</pre>
<pre class="screen"> ospf enable 1 area 0.0.0.0</pre>
<pre class="screen"> isis enable 1</pre>
<pre class="screen"> isis circuit-type p2p</pre>
<pre class="screen"> isis cost 10</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/3/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.45.1.5 255.255.255.0</pre>
<pre class="screen"> isis enable 1</pre>
<pre class="screen"> isis circuit-type p2p</pre>
<pre class="screen"> isis cost 10</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1 router-id 5.5.5.5</pre>
<pre class="screen"> import-route isis 1 cost 100 type 2</pre>
<pre class="screen"> opaque-capability enable </pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">route loop-detect ospf enable</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p><span class="keyword">Device</span>F configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>F</pre>
<pre class="screen">#</pre>
<pre class="screen">isis 2</pre>
<pre class="screen"> cost-style wide</pre>
<pre class="screen"> network-entity 10.6666.0000.0001.00</pre>
<pre class="screen">#</pre>
<pre class="screen">route loop-detect isis enable</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.16.1.6 255.255.255.0</pre>
<pre class="screen"> isis enable 2</pre>
<pre class="screen"> isis circuit-type p2p</pre>
<pre class="screen"> isis cost 10</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.26.1.6 255.255.255.0</pre>
<pre class="screen"> ospf network-type p2p</pre>
<pre class="screen"> ospf timer hello 1</pre>
<pre class="screen"> ospf enable 1 area 0.0.0.0</pre>
<pre class="screen"> isis enable 2</pre>
<pre class="screen"> isis circuit-type p2p</pre>
<pre class="screen"> isis cost 10</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/3/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.56.1.6 255.255.255.0</pre>
<pre class="screen"> ospf timer hello 1</pre>
<pre class="screen"> ospf enable 1 area 0.0.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1 router-id 6.6.6.6</pre>
<pre class="screen"> import-route isis 2 cost 10 type 2</pre>
<pre class="screen"> opaque-capability enable</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">route loop-detect ospf enable</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_isis_cfg_0078.html">IS-IS Configuration Examples
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_isis_cfg_2012.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_isis_cfg_0111.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>