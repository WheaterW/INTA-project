
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring BFD for OSPF">
<meta name="abstract" content="This section describes how to configure BFD for OSPF. After BFD for OSPF is configured, BFD can fast detect link faults and report them to OSPF so that service traffic can be transmitted through the backup link.">
<meta name="description" content="This section describes how to configure BFD for OSPF. After BFD for OSPF is configured, BFD can fast detect link faults and report them to OSPF so that service traffic can be transmitted through the backup link.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0093.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_2008.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0103.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00875216">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00875216">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172365671">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring BFD for OSPF</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172365671"></a><a name="EN-US_TASK_0172365671"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring BFD for OSPF</h1>
<div class="taskbody"><p>This section describes how to configure BFD for OSPF. After BFD for OSPF is configured, BFD can fast detect link faults and report them to OSPF so that service traffic can be transmitted through the backup link.</p>
<div class="context"><a name="EN-US_TASK_0172365671__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>OSPF enables the device to periodically send Hello packets to a neighboring device for fault detection. Detecting a fault takes more than 1s. With the development of technologies, voice, video, and other VOD services are widely used. These services are quite sensitive to packet loss and delays. When traffic is transmitted at gigabit rates, long-time fault detection will cause packet loss. This cannot meet high reliability requirements of the carrier-class network. BFD for OSPF is used to resolve the problem. After BFD for OSPF is configured, the link status can be rapidly detected and fault detection can be completed in milliseconds. This speeds up OSPF convergence when the link status changes.</p>
<p>For example, as shown in <a href="#EN-US_TASK_0172365671__fig_dc_vrp_ospf_cfg_010201">Figure 1</a>, the primary link <span class="keyword">Device</span>A -&gt; <span class="keyword">Device</span>B and the secondary link <span class="keyword">Device</span>A -&gt; <span class="keyword">Device</span>C -&gt; <span class="keyword">Device</span>B are deployed on the network. Traffic is transmitted on the primary link normally. When the primary link becomes faulty, the <span class="keyword">Device</span> is expected to rapidly detect the fault and switch traffic to the secondary link.</p>
<p>You can configure BFD for OSPF to detect the OSPF neighbor relationship between <span class="keyword">Device</span>A and <span class="keyword">Device</span>B. When the link between <span class="keyword">Device</span>A and <span class="keyword">Device</span>B fails, BFD can rapidly detect the failure and report it to OSPF. Traffic is then switched to the secondary link.</p>
<div class="fignone" id="EN-US_TASK_0172365671__fig_dc_vrp_ospf_cfg_010201"><a name="EN-US_TASK_0172365671__fig_dc_vrp_ospf_cfg_010201"></a><a name="fig_dc_vrp_ospf_cfg_010201"></a><span class="figcap"><b>Figure 1 </b>Networking for configuring BFD for OSPF</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 3 in this example represent GE<span>0/1/0</span>, GE<span>0/2/0</span>, and GE<span>0/3/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_ospf_cfg_010201.png"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365671__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>To improve security, OSPF area authentication or interface authentication is recommended. For details, see "Improving OSPF Network Security". OSPF area authentication is used as an example. For details, see Example for Configuring Basic OSPF Functions.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365671__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure basic OSPF functions on each <span class="keyword">Router</span> for interconnection.</p>
</li><li><p>Enable global BFD.</p>
</li><li><p>Enable OSPF BFD on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365671__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Data of <span class="keyword">Device</span>A, including the router ID (1.1.1.1), OSPF process number (1), and network segment addresses of Area 0 (3.3.3.0/24 and 1.1.1.0/24)</p>
</li><li><p>Data of <span class="keyword">Device</span>B, including the router ID (2.2.2.2), OSPF process number (1), and network segment addresses of Area 0 (3.3.3.0/24, 2.2.2.0/24, and 172.16.1.0/24)</p>
</li><li><p>Data of <span class="keyword">Device</span>C, including the router ID (3.3.3.3), OSPF process number (1), and network segment addresses of Area 0 (1.1.1.0/24 and 2.2.2.0/24)</p>
</li><li><p>Minimum interval at which BFD packets are received and sent and local detection multiplier on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172365671__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface. For configuration details, see <a href="#EN-US_TASK_0172365671__section_dc_vrp_ospf_cfg_010206">Configuration Files</a> in this section.</span></li><li><span>Configure basic OSPF functions.</span><p><p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>router id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1-area-0.0.0.0] <strong>network 1.1.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1-area-0.0.0.0] <strong>network 3.3.3.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1-area-0.0.0.0] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-ospf-1] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>router id 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0] <strong>network 2.2.2.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0] <strong>network 3.3.3.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0] <strong>network 172.16.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ospf-1] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span>C.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C]<strong> router id 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C]<strong> ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1]<strong> area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1-area-0.0.0.0]<strong> network 1.1.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1-area-0.0.0.0]<strong> network 2.2.2.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1-area-0.0.0.0]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-ospf-1-area-0.0.0.0]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-ospf-1]<strong> quit</strong></pre>
<p># After the preceding configurations, run the <strong>display ospf peer</strong> command. You can view that a neighbor relationship is established between <span class="keyword">Device</span>A and <span class="keyword">Device</span>B, and between <span class="keyword">Device</span>B and <span class="keyword">Device</span>C. The following example uses the command output on <span class="keyword">Device</span>A.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>A&gt; <strong>display ospf peer</strong></pre>
<pre class="screen">(M) Indicates MADJ neighbor
           OSPF Process 1 with Router ID 1.1.1.1
                 Neighbors

 Area 0.0.0.0 interface 3.3.3.1 ( GE<span>0/2/0</span> )'s neighbors
 Router ID: 2.2.2.2         Address: 3.3.3.2
   <strong>State: Full</strong>  Mode:Nbr is  Master   Priority: 1
   DR: 3.3.3.1   BDR: 3.3.3.2    MTU: 0
   Dead timer due in  35  sec
   Retrans timer interval: 5
   Neighbor is up for 1h15m4s
   Neighbor up time : 2020-06-08 01:41:57
   Authentication Sequence: [ 0 ]

 Area 0.0.0.0 interface 1.1.1.1 ( GE<span>0/1/0</span> )'s neighbors
 Router ID: 3.3.3.3         Address: 1.1.1.2
   <strong>State: Full</strong>  Mode:Nbr is  Master   Priority: 1
   DR: 1.1.1.1  BDR: 1.1.1.2  MTU: 0
   Dead timer due in  39  sec
   Retrans timer interval: 5
   Neighbor is up for 1h15m4s
   Neighbor up time : 2020-06-08 01:41:57
   Authentication Sequence: [ 0 ]</pre>
<p># Display information about the OSPF routing table on <span class="keyword">Device</span>A, and you can view the routing entries to <span class="keyword">Device</span>B and <span class="keyword">Device</span>C. The next hop address of the route to 172.16.1.0/24 is 3.3.3.2, and service traffic is transmitted on the primary link (<span class="keyword">Device</span>A â <span class="keyword">Device</span>B).</p>
<pre class="screen">&lt;<span class="keyword">Device</span>A&gt; <strong>display ospf routing</strong></pre>
<pre class="screen">          OSPF Process 1 with Router ID 1.1.1.1
                   Routing Tables

 Routing for Network
 Destination        Cost       Type       NextHop         AdvRouter       Area
 2.2.2.0/24         2          Stub       1.1.1.2         3.3.3.3         0.0.0.0
 <strong>172.16.1.0/24      2          Stub       3.3.3.2         2.2.2.2         0.0.0.0</strong>

 Total Nets: 2
 Intra Area: 2  Inter Area: 0  ASE: 0  NSSA: 0</pre>
</p></li><li><span>Configure OSPF BFD.</span><p><p># Enable global BFD on <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>bfd</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1] <strong>bfd all-interfaces enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-ospf-1] <strong>quit</strong></pre>
<p># Enable global BFD on <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>bfd</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bfd] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1] <strong>bfd all-interfaces enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ospf-1] <strong>quit</strong></pre>
<p># Enable global BFD on <span class="keyword">Device</span>C.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>bfd</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bfd] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1] <strong>bfd all-interfaces enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-ospf-1] <strong>quit</strong></pre>
<p># After the preceding configurations, run the <strong>display ospf bfd session all</strong> command on <span class="keyword">Device</span>A, <span class="keyword">Device</span>B, or <span class="keyword">Device</span>C. You can view that the BFD session is Up.</p>
<p>Use the command output <span class="keyword">Device</span>A as an example.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display ospf bfd session all</strong></pre>
<pre class="screen">          OSPF Process 1 with Router ID 1.1.1.1
  Area 0.0.0.0 interface 1.1.1.1(GE<span>0/1/0</span>)'s BFD Sessions

 NeighborId:2.2.2.2          AreaId:0.0.0.0          Interface:GE<span>0/1/0</span>
 <strong>BFDState:up</strong>                 rx    :1000             tx       :1000
 Multiplier:3                BFD Local Dis:0         LocalIpAdd:1.1.1.1
 RemoteIpAdd:1.1.1.2         Diagnostic Info:0

  Area 0.0.0.0 interface 3.3.3.1(GE<span>0/2/0</span>)'s BFD Sessions

 NeighborId:3.3.3.3          AreaId:0.0.0.0          Interface:GE<span>0/2/0</span>
 <strong>BFDState:up</strong>                 rx    :1000             tx       :1000
 Multiplier:3                BFD Local Dis:0         LocalIpAdd:3.3.3.1
 RemoteIpAdd:3.3.3.2         Diagnostic Info:0</pre>
</p></li><li><span>Configure BFD on an interface.</span><p><p># Configure BFD on GigabitEthernet <span>0/2/0</span> of <span class="keyword">Device</span>A. Set the minimum intervals at which packets are received and sent to 500 ms and the local detection multiplier to 4.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>] <strong>ospf bfd enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>] <strong>ospf bfd min-tx-interval 500 min-rx-interval 500 detect-multiplier 4</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<p># Configure BFD on GigabitEthernet <span>0/2/0</span> of <span class="keyword">Device</span>B. Set the minimum intervals at which packets are received and sent to 500 ms and the local detection multiplier to 4.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>ospf bfd enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>ospf bfd min-tx-interval 500 min-rx-interval 500 detect-multiplier 4</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<p># After the preceding configurations, run the <strong>display ospf bfd session all</strong> command on <span class="keyword">Device</span>A or <span class="keyword">Device</span>B. You can check that the minimum intervals at which packets are sent and received are 500 ms and that the local detection multiplier is 4.</p>
<p>Use the command output <span class="keyword">Device</span>B as an example.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display ospf bfd session all</strong></pre>
<pre class="screen">          OSPF Process 1 with Router ID 2.2.2.2
  Area 0.0.0.0 interface 3.3.3.2(GE<span>0/2/0</span>)'s BFD Sessions

 NeighborId:1.1.1.1          AreaId:0.0.0.0          Interface: GigabitEthernet<span>0/2/0</span>
 <strong>BFDState:up                 rx    :500             tx       :500</strong>
 <strong>Multiplier:4</strong>                BFD Local Dis:0         LocalIpAdd:3.3.3.2
 RemoteIpAdd:3.3.3.1         Diagnostic Info:0

  Area 0.0.0.0 interface 2.2.2.2(GE<span>0/1/0</span>)'s BFD Sessions

 NeighborId:3.3.3.3          AreaId:0.0.0.0          Interface: GE<span>0/1/0</span>
 <strong>BFDState:up</strong>                 rx    :1000              tx       :1000
 Multiplier:3                BFD Local Dis:0         LocalIpAdd:2.2.2.2
 RemoteIpAdd:2.2.2.1         Diagnostic Info:0</pre>
</p></li><li><span>Verify the configuration.</span><p><p># Run the <strong>shutdown</strong> command on GigabitEthernet <span>0/2/0</span> of <span class="keyword">Device</span>B to simulate a primary link failure.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<p># Display the routing table on <span class="keyword">Router</span><span class="keyword">Device</span>A. You can view that the backup link (<span class="keyword">Device</span>A - <span class="keyword">Device</span>C - <span class="keyword">Device</span>B) takes effect after the primary link fails and that the next hop address of the route to 172.16.1.0/24 is 1.1.1.2.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>A&gt; <strong>display ospf routing</strong></pre>
<pre class="screen">          OSPF Process 1 with Router ID 1.1.1.1
                   Routing Tables

 Routing for Network
 Destination        Cost       Type       NextHop         AdvRouter       Area
 2.2.2.0/24         2          Stub       1.1.1.2         3.3.3.3         0.0.0.0
 <strong>172.16.1.0/24    3         Stub      1.1.1.2       2.2.2.2       0.0.0.0</strong>

 Total Nets: 2
 Intra Area: 2  Inter Area: 0  ASE: 0  NSSA: 0</pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172365671__section_dc_vrp_ospf_cfg_010206"><a name="EN-US_TASK_0172365671__section_dc_vrp_ospf_cfg_010206"></a><a name="section_dc_vrp_ospf_cfg_010206"></a><a name="EN-US_TASK_0172365671__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span>A configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>A
#
router id 1.1.1.1
#
bfd
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 1.1.1.1 255.255.255.0
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 3.3.3.1 255.255.255.0
 ospf bfd enable
 ospf bfd min-tx-interval 500 min-rx-interval 500 detect-multiplier 4
#
ospf 1
 bfd all-interfaces enable
 area 0.0.0.0
  network 3.3.3.0 0.0.0.255
  network 1.1.1.0 0.0.0.255
#
return</pre>
</li><li><p><span class="keyword">Device</span>B configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>B</pre>
<pre class="screen">#</pre>
<pre class="screen">router id 2.2.2.2</pre>
<pre class="screen">#</pre>
<pre class="screen">bfd</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 2.2.2.2 255.255.255.0
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 3.3.3.2 255.255.255.0
 ospf bfd enable
 ospf bfd min-tx-interval 500 min-rx-interval 500 detect-multiplier 4
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 ip address 172.16.1.1 255.255.255.0
#
ospf 1
 bfd all-interfaces enable
 area 0.0.0.0
  network 3.3.3.0 0.0.0.255
  network 2.2.2.0 0.0.0.255
  network 172.16.1.0 0.0.0.255
#
return</pre>
</li><li><p><span class="keyword">Device</span>C configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>C</pre>
<pre class="screen">#</pre>
<pre class="screen">router id 3.3.3.3</pre>
<pre class="screen">#</pre>
<pre class="screen">bfd</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 1.1.1.2 255.255.255.0
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 2.2.2.1 255.255.255.0
 ospf bfd enable
#
ospf 1
 bfd all-interfaces enable
 area 0.0.0.0
  network 1.1.1.0 0.0.0.255
  network 2.2.2.0 0.0.0.255
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0093.html">Configuration Examples for OSPF
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_2008.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0103.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>