
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring OSPF Local MT">
<meta name="abstract" content="On a network where multicast and an MPLS TE tunnel are deployed, you can configure OSPF local MT to create a correct multicast routing table and guide multicast packet forwarding.">
<meta name="description" content="On a network where multicast and an MPLS TE tunnel are deployed, you can configure OSPF local MT to create a correct multicast routing table and guide multicast packet forwarding.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_2015.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0099.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="ospf,w00800033,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00875216">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00875216">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172365605">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring OSPF Local MT</title>
</head>
<body><a name="EN-US_TASK_0172365605"></a><a name="EN-US_TASK_0172365605"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring OSPF Local MT</h1>
<div class="taskbody"><p>On a network where multicast and an MPLS TE tunnel are deployed, you can configure OSPF local MT to create a correct multicast routing table and guide multicast packet forwarding.</p>
<div class="context"><a name="EN-US_TASK_0172365605__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>When multicast and an Interior Gateway Protocol (IGP) Shortcut-enabled MPLS TE tunnel are configured on a network, the outbound interface of the route calculated by an IGP may not be a physical interface but a TE tunnel interface. Based on a unicast route to a multicast source address, the <span class="keyword">Router</span> sends a Join message through a TE tunnel interface. In this case, devices spanned by the TE tunnel cannot detect the Join message so that they do not create any multicast forwarding entry.</p>
<p>To resolve this problem, enable OSPF local MT. After local MT is enabled, if the outbound interface of a calculated route is an IGP Shortcut-enabled TE tunnel interface, the route management (RM) module creates an independent Multicast IGP (MIGP) routing table for the multicast protocol, calculates a physical outbound interface for the route, and adds the route to the MIGP routing table. Multicast packets are then forwarded along this route.</p>
<p>Configuring filtering policies for local MT controls the number of entries in the MIGP routing table and speeds up the MIGP routing table lookup.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365605__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring local MT, complete the following tasks:</p>
<ul><li>Configure addresses for interfaces to ensure that neighboring devices are reachable at the network layer.</li><li><a href="dc_vrp_ospf_cfg_0003.html">Configure basic OSPF functions</a>.</li><li><a href="dc_vrp_te-p2p_cfg_0034.html">Configure the IGP Shortcut</a>.</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172365605__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=ospf"><b><span class="cmdname">ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ]</span></span><p><p>The OSPF view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=local-mt+enable"><b><span class="cmdname">local-mt enable</span></b></a></span></span><p><p>Local MT is enabled.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>Local MT takes effect only in the OSPF process of a public network instance.</li><li>Local MT does not support Forwarding Adjacency (FA).</li></ul>
</div></div>
</p></li><li><span>(Optional) Run any of the following commands as required:</span><p><ul><li>Based on a basic ACL:<ol type="a"><li><p>Run <span><a href="cmdqueryname=local-mt+filter-policy"><b><span class="cmdname">local-mt filter-policy</span></b></a> <strong><span>acl</span></strong> { <i><span class="varname">acl-number</span></i> | <i><span class="varname">acl-name</span></i> }</span></p>
<p>A filtering policy is configured for OSPF local MT.</p>
</li><li><p>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></p>
<p>Return to the system view.</p>
</li><li>Run <span><a href="cmdqueryname=acl"><b><span class="cmdname">acl</span></b></a> { <strong><span>name</span></strong> <i><span class="varname">basic-acl-name</span></i> { <strong><span>basic</span></strong> | [ <strong><span>basic</span></strong> ] <strong><span>number</span></strong> <i><span class="varname">basic-acl-number</span></i> } | [ <strong><span>number</span></strong> ] <i><span class="varname">basic-acl-number</span></i> } [ <strong><span>match-order</span></strong> { <strong><span>config</span></strong> | <strong><span>auto</span></strong> } ]</span><p>The ACL view is displayed.</p>
</li><li><p>Run <span><a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> [ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>deny</span></strong> | <strong><span>permit</span></strong> } [ <strong><span>fragment-type</span></strong> { <strong><span>fragment</span></strong> | <strong><span>non-fragment</span></strong> | <strong><span>non-subseq</span></strong> | <strong><span>fragment-subseq</span></strong> | <strong><span>fragment-spe-first</span></strong> } | <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong><span> | <i><span class="varname">src-netmask</span></i></span> } | <strong><span>any</span></strong> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <sup>*</sup></span></p>
<p>An ACL rule is configured.</p>
<p>When the <a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> command is used to configure a filtering rule for a named ACL, only the configurations specified by <strong><span>source</span></strong> and <strong><span>time-range</span></strong> take effect.</p>
<div class="p">When a filter-policy of a routing protocol is used to filter routes:<ul><li><p>If the action specified in an ACL rule is <strong>permit</strong>, a route matching the rule will be accepted or advertised by the system.</p>
</li><li><p>If the action specified in an ACL rule is <strong>deny</strong>, a route matching the rule will not be accepted or advertised by the system.</p>
</li><li><p>If the network segment of a route is not within the range specified in an ACL rule, the route will not be accepted or advertised by the system.</p>
</li><li><p>If an ACL does not contain any rules, none of the routes matched against the filter-policy that uses this ACL will be accepted or advertised by the system.</p>
</li><li><p>Routes can be filtered using a blacklist or whitelist:</p>
<p>If ACL rules are used for matching in configuration order, the system matches the rules in ascending order of their IDs.</p>
<p>Filtering using a blacklist: Configure a rule with a smaller ID and specify the action <strong>deny</strong> in this rule to filter out the unwanted routes. Then, configure another rule with a larger ID in the same ACL and specify the action <strong>permit</strong> in this rule to accept or advertise the other routes.</p>
<p>Filtering using a whitelist: Configure a rule with a smaller ID and specify the action <strong>permit</strong> in this rule to permit the routes to be accepted or advertised. Then, configure another rule with a larger ID in the same ACL and specify the action <strong>deny</strong> in this rule to filter out the unwanted routes.</p>
</li></ul>
</div>
</li></ol>
</li><li><p>Based on an IP prefix list:</p>
<p>Run <span><a href="cmdqueryname=local-mt+filter-policy"><b><span class="cmdname">local-mt filter-policy</span></b></a> <strong><span>ip-prefix</span></strong> <i><span class="varname">ip-prefix-name</span></i></span></p>
<p>A routing policy is configured for OSPF local MT.</p>
</li><li><p>Based on a route-policy:</p>
<p>Run <span><a href="cmdqueryname=local-mt+filter-policy"><b><span class="cmdname">local-mt filter-policy</span></b></a> <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i></span></p>
<p>A route-policy is configured for OSPF local MT.</p>
</li><li><p>Based on a route-filter:</p>
<p>Run <span><a href="cmdqueryname=local-mt+filter-policy"><b><span class="cmdname">local-mt filter-policy</span></b></a> <strong><span>route-filter</span></strong> <i><span class="varname">route-filter-name</span></i></span></p>
<p>A route-filter is configured for OSPF local MT.</p>
</li></ul>
<p>After an MIGP routing table is created, OSPF performs route calculation. If the outbound interface of the calculated route is an IGP Shortcut-enabled TE tunnel interface, the <span class="keyword">Router</span> saves the physical interface on which the tunnel interface is configured as the outbound interface in the MIGP routing table. Multicast packets are then forwarded along this route.</p>
<p>After the routing policy is configured, only the matching routes to the multicast source address are added to the MIGP routing table, which controls the number of entries in the MIGP routing table and speeds up MIGP routing table lookup.</p>
<p>Configure a routing policy before you enable local MT, because if an excessive number of routes to a non-multicast source address exist in an MIGP routing table, the number of entries may exceed the upper limit.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0172365605__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ul><li>Run the <a href="cmdqueryname=display+ospf"><b><span class="cmdname">display ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ] <strong><span>migp-routing</span></strong> [ <i><span class="varname">ip-address</span></i> [ <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> ] ] [ <strong><span>interface</span></strong> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> ] [ <strong><span>nexthop</span></strong> <i><span class="varname">nexthop-address</span></i> ] command to check information about the OSPF MIGP routing table.</li><li>Run the <a href="cmdqueryname=display+ospf"><b><span class="cmdname">display ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ] <strong><span>routing</span></strong> command to check OSPF routing information.</li><li>Run the <a href="cmdqueryname=display+ospf"><b><span class="cmdname">display ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ] <strong><span>brief</span></strong> command to check brief OSPF information.</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0000.html">OSPF Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_2015.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0099.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>