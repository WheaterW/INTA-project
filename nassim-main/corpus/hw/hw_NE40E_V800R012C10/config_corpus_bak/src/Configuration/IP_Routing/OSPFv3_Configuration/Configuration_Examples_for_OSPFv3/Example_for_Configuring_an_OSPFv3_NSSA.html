
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring an OSPFv3 NSSA">
<meta name="abstract" content="This section provides an example for configuring an OSPFv3 not-so-stubby area (NSSA).">
<meta name="description" content="This section provides an example for configuring an OSPFv3 not-so-stubby area (NSSA).">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_2062.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_2091.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_2107.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,56675587z00801081,w00556928,w00606909,l00455378,">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00875216">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00875216">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172365819">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring an OSPFv3 NSSA</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172365819"></a><a name="EN-US_TASK_0172365819"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring an OSPFv3 NSSA</h1>
<div class="taskbody"><p>This section provides an example for configuring an OSPFv3 not-so-stubby area (NSSA).</p>
<div class="context"><a name="EN-US_TASK_0172365819__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>An excessive number of entries in a routing table waste network resources and cause high CPU usage. To address the problem, configure a non-backbone area on the border of an AS as an NSSA. NSSAs can import AS external routes and advertise them within the entire OSPFv3 AS, without learning external routes from other areas in the AS, which reduces bandwidth and storage resource consumption on the <span class="keyword">Router</span>.</p>
<p>In <a href="#EN-US_TASK_0172365819__fig_dc_vrp_ospfv3_cfg_209301">Figure 1</a>, OSPFv3 runs on all <span class="keyword">Router</span>s, and the entire AS is partitioned into two areas. <span class="keyword">Device</span> A and <span class="keyword">Device</span> B function as ABRs to forward inter-area routes; <span class="keyword">Device</span> D functions as an ASBR and imports the external static route 2001:DB8:6::1/128. To import AS external routes but reduce the number of LSAs to be advertised to area 1 without affecting route reachability, configure area 1 as an NSSA.</p>
<div class="fignone" id="EN-US_TASK_0172365819__fig_dc_vrp_ospfv3_cfg_209301"><a name="EN-US_TASK_0172365819__fig_dc_vrp_ospfv3_cfg_209301"></a><a name="fig_dc_vrp_ospfv3_cfg_209301"></a><span class="figcap"><b>Figure 1 </b>Networking for configuring an OSPFv3 NSSA</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 3 in this example represent GE<span>0/1/0</span>, GE<span>0/2/0</span>, and GE<span>0/3/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_ospfv3_cfg_209301.png"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365819__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>To improve security, you are advised to deploy OSPFv3 authentication. For details, see "Configuring OSPFv3 Authentication". OSPFv3 IPsec is used as an example. For details, see "Example for Configuring IPsec for OSPFv3."</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365819__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Configure basic OSPFv3 functions on all <span class="keyword">Router</span>s to ensure that they can communicate with each other using OSPFv3.</li><li>Configure area 1 as an NSSA.</li><li>Configure <span class="keyword">Device</span> C to import the static route 2001:DB8:7::1/128.</li><li>Configure <span class="keyword">Device</span> D to import the static route 2001:DB8:6::1/128.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365819__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li>Router ID 1.1.1.1 of <span class="keyword">Device</span> A, OSPFv3 process ID 1, network segment 2001:DB8:1::0/64 of area 0, and network segments 2001:DB8:2::0/64 and 2001:DB8:4::0/64 of area 1</li><li>Router ID 2.2.2.2 of <span class="keyword">Device</span> B, OSPFv3 process ID 1, network segment 2001:DB8:3::0/64 of area 0, and network segments 2001:DB8:2::0/64 and 2001:DB8:5::0/64 of area 1</li><li>Router ID 3.3.3.3 of <span class="keyword">Device</span> C, OSPFv3 process ID 1, and network segments 2001:DB8:1::0/64 and 2001:DB8:3::0/64 of area 0</li><li>Router ID 4.4.4.4 of <span class="keyword">Device</span> D, OSPFv3 process ID 1, and network segments 2001:DB8:4::0/64 and 2001:DB8:5::0/64 of area 1</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172365819__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure an IP address for each interface.</span><p><p>Configure an IP address to each interface according to <a href="#EN-US_TASK_0172365819__fig_dc_vrp_ospfv3_cfg_209301">Figure 1</a>. For details about the configuration, see Configuration Files in this section.</p>
</p></li><li><span>Configure basic OSPFv3 functions.</span><p><p>For detailed operations, see <a href="dc_vrp_ospfv3_cfg_2063.html">Example for Configuring Basic OSPFv3 Functions</a>. </p>
</p></li><li><span>Configure area 1 as an NSSA.</span><p><p># Configure <span class="keyword">Device</span> A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>ospfv3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospfv3-1] <strong>area 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospfv3-1-area-0.0.0.1] <strong>nssa</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospfv3-1-area-0.0.0.1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-ospfv3-1-area-0.0.0.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-ospfv3-1] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span> B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ospfv3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospfv3-1] <strong>area 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospfv3-1-area-0.0.0.1] <strong>nssa</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospfv3-1-area-0.0.0.1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ospfv3-1-area-0.0.0.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ospfv3-1] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span> D.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D] <strong>ospfv3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-ospfv3-1] <strong>area 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-ospfv3-1-area-0.0.0.1] <strong>nssa</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-ospfv3-1-area-0.0.0.1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D-ospfv3-1-area-0.0.0.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D-ospfv3-1] <strong>quit</strong></pre>
</p></li><li><span>Configure <span class="keyword">Device</span> C to import the static route 2001:DB8:7::1/128.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>ipv6 route-static 2001:DB8:7::1 128 NULL0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>ospfv3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1] <strong>import-route static</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-ospfv3-1] <strong>quit</strong></pre>
</p></li><li><span>Configure <span class="keyword">Device</span> D to import the static route 2001:DB8:6::1/128.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D] <strong>ipv6 route-static 2001:DB8:6::1 128 NULL0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>ospfv3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-ospfv3-1] <strong>import-route static</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-ospfv3-1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D-ospfv3-1] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Display the OSPFv3 routing tables on <span class="keyword">Device</span> C and <span class="keyword">Device</span> D.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>display ospfv3 routing</strong></pre>
<pre class="screen">Codes : E2 - Type 2 External, E1 - Type 1 External, IA - Inter-Area,
        N - NSSA
Flags : A - Added to URT6, LT - Locator Routing

OSPFv3 Process (1)
     Destination                                                         Metric
       Next-hop
     2001:DB8:1::/64                                                          1
       directly connected, GE<span>0/1/0</span>, Flags : A
IA   2001:DB8:2::/64                                                          2
       via FE80::3A6D:7CFF:FE21:1200, GE<span>0/1/0</span>, Flags : A
IA   2001:DB8:2::/64                                                          2
       via FE80::3A6D:7CFF:FE41:1200, GE<span>0/2/0</span>, Flags : A
     2001:DB8:3::/64                                                          1
       directly connected, GE<span>0/2/0</span>, Flags : A
IA   2001:DB8:4::/64                                                          2
       via FE80::3A6D:7CFF:FE21:1200, GE<span>0/1/0</span>, Flags : A
IA   2001:DB8:5::/64                                                          2
       via FE80::3A6D:7CFF:FE41:1200, GE<span>0/2/0</span>, Flags : A
<strong>E2   2001:DB8:6::1/128                                              1   </strong>
<strong>      via FE80::3A6D:7CFF:FE41:1200, GE<span>0/2/0</span> Flags : A</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D] <strong>display ospfv3 routing</strong></pre>
<pre class="screen">Codes : E2 - Type 2 External, E1 - Type 1 External, IA - Inter-Area,
        N - NSSA
Flags : A - Added to URT6, LT - Locator Routing

OSPFv3 Process (1)
     Destination                                                         Metric
       Next-hop
E2   ::/0                                                                     1
N      via FE80::3A6D:7CFF:FE21:1200, GE<span>0/1/0</span>, Flags : A
E2   ::/0                                                                     1
N      via FE80::3A6D:7CFF:FE41:1200, GE<span>0/2/0</span>, Flags : A
IA   2001:DB8:1::/64                                                          2
       via FE80::3A6D:7CFF:FE21:1200, GE<span>0/1/0</span>, Flags : A
     2001:DB8:2::/64                                                          2
       via FE80::3A6D:7CFF:FE21:1200, GE<span>0/1/0</span>, Flags : A
     2001:DB8:2::/64                                                          2
       via FE80::3A6D:7CFF:FE41:1200, GE<span>0/2/0</span>, Flags : A
IA   2001:DB8:3::/64                                                          2
       via FE80::3A6D:7CFF:FE41:1200, GE<span>0/2/0</span>, Flags : A
     2001:DB8:4::/64                                                          1
       directly connected, GE<span>0/1/0</span>, Flags : A
     2001:DB8:5::/64                                                          1
       directly connected, GE<span>0/2/0</span>, Flags : A</pre>
<p>The command output shows that <span class="keyword">Device</span> C has imported an AS external route (2001:DB8:6::1/128) and that the <span class="keyword">Router</span> that advertises this route is <span class="keyword">Device</span> B. In addition, the NSSA does not learn the 2001:DB8:7::1/128 route from area 0.</p>
<p># Display routing information of the NSSA on <span class="keyword">Router</span>s. In the following example, the command output on <span class="keyword">Device</span> A is used.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display ospfv3 routing nssa-routes</strong></pre>
<pre class="screen">Codes : E2 - Type 2 External, E1 - Type 1 External, IA - Inter-Area,
        N - NSSA
Flags : A - Added to URT6

OSPFv3 Process (1)
     Destination                                                         Metric
       Next-hop
<strong>E2   2001:DB8:6::1/128                                            1</strong>
<strong>N      via FE80::3A6D:7CFF:FE11:1200, GE<span>0/2/0</span> Flags : A</strong></pre>
<p># Display NSSA LSA information on <span class="keyword">Router</span>s. In the following example, the command output on <span class="keyword">Device</span> A is used.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display ospfv3 lsdb nssa</strong></pre>
<pre class="screen">           OSPFv3 Router with ID (1.1.1.1) (Process 1)

               NSSA-external-LSA (Area 0.0.0.1)

  LS Age: 391
  LS Type: NSSA-external-LSA
  Link State ID: 0.0.0.0
  Originating Router: 1.1.1.1
  LS Seq Number: 0x80000001
  Retransmit Count: 0
  Checksum: 0x6ebe
  Length: 32
  Flags: (E|-|T)
   Metric Type: 2 (Larger than any link state path)
      Metric: 1
   Prefix: ::/0
    Prefix Options: 0 (-|-|-|-|-)
    Tag: 0

  LS Age: 378
  LS Type: NSSA-external-LSA
  Link State ID: 0.0.0.0
  Originating Router: 2.2.2.2
  LS Seq Number: 0x80000001
  Retransmit Count: 0
  Checksum: 0x50d8
  Length: 32    
  Flags: (E|-|T)
   Metric Type: 2 (Larger than any link state path)
      Metric: 1
   Prefix: ::/0
    Prefix Options: 0 (-|-|-|-|-)
    Tag: 0      
                
  LS Age: 429   
  LS Type: NSSA-external-LSA
  Link State ID: 0.0.0.1
  Originating Router: 4.4.4.4
  LS Seq Number: 0x80000001
  Retransmit Count: 0
  Checksum: 0xb7e0
  Length: 48    
  Flags: (E|-|T)
   Metric Type: 2 (Larger than any link state path)
      Metric: 1 
   Prefix: 2001:DB8:6::1/128
    Prefix Options: 8 (-|P|-|-|-)</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172365819__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span> A configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>A
#               
ospfv3 1        
 router-id 1.1.1.1
 area 0.0.0.0   
 area 0.0.0.1   
  nssa            
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable    
 ipv6 address 2001:DB8:1::2/64
 ospfv3 1 area 0.0.0.0
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ipv6 enable    
 ipv6 address 2001:DB8:4::1/64
 ospfv3 1 area 0.0.0.1
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown 
 ipv6 enable    
 ipv6 address 2001:DB8:2::1/64
 ospfv3 1 area 0.0.0.1
#
return</pre>
</li><li><p><span class="keyword">Device</span> B configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>B
#               
ospfv3 1        
 router-id 2.2.2.2
 area 0.0.0.0   
 area 0.0.0.1   
  nssa            
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ipv6 enable    
 ipv6 address 2001:DB8:2::2/64
 ospfv3 1 area 0.0.0.1
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown 
 ipv6 enable    
 ipv6 address 2001:DB8:3::1/64
 ospfv3 1 area 0.0.0.0
 #
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 ipv6 enable    
 ipv6 address 2001:DB8:5::2/64
 ospfv3 1 area 0.0.0.1
#
return</pre>
</li><li><p><span class="keyword">Device</span> C configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>C
#               
ospfv3 1        
 router-id 3.3.3.3
 import-route static
 area 0.0.0.0   
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable    
 ipv6 address 2001:DB8:1::1/64
 ospfv3 1 area 0.0.0.0
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ipv6 enable    
 ipv6 address 2001:DB8:3::2/64
 ospfv3 1 area 0.0.0.0
#               
ipv6 route-static 2001:DB8:7::1 128 NULL0 
#
return</pre>
</li><li><p><span class="keyword">Device</span> D configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>D
#               
ospfv3 1        
 router-id 4.4.4.4
 import-route static
 area 0.0.0.1   
  nssa          
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable    
 ipv6 address 2001:DB8:4::2/64
 ospfv3 1 area 0.0.0.1
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ipv6 enable    
 ipv6 address 2001:DB8:5::1/64
 ospfv3 1 area 0.0.0.1
#
ipv6 route-static 2001:DB8:6::1 128 NULL0 
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_2062.html">Configuration Examples for OSPFv3
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_2091.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_2107.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>