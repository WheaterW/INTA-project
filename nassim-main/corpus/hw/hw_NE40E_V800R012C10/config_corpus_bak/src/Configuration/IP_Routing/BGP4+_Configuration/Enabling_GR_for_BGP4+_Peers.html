
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Enabling GR for BGP4+ Peers">
<meta name="abstract" content="After graceful restart (GR) is enabled for BGP4+ peers specified on a BGP4+ speaker, the BGP4+ speaker can negotiate the GR capability with these peers and establish BGP4+ connections with them if negotiation succeeds.">
<meta name="description" content="After graceful restart (GR) is enabled for BGP4+ peers specified on a BGP4+ speaker, the BGP4+ speaker can negotiate the GR capability with these peers and establish BGP4+ connections with them if negotiation succeeds.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0051.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0092.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP IPv6">
<meta name="featuretype" content="IP Route">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP IPv6">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00615954">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0209678823">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Enabling GR for BGP4+ Peers</title>
</head>
<body><a name="EN-US_TASK_0209678823"></a><a name="EN-US_TASK_0209678823"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Enabling GR for BGP4+ Peers</h1>
<div class="taskbody"><p>After graceful restart (GR) is enabled for BGP4+ peers specified on a BGP4+ speaker, the BGP4+ speaker can negotiate the GR capability with these peers and establish BGP4+ connections with them if negotiation succeeds.</p>
<div class="context"><a name="EN-US_TASK_0209678823__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>A BGP4+ restart causes re-establishment of all the involved peer relationships, resulting in traffic interruption. Enabling GR globally can prevent traffic interruption. However, this will disconnect all the BGP4+ peer relationships on a device and cause the device to re-negotiate the GR capability with these peers, which affects all the BGP4+-dependent services running on the live network. To prevent this problem, you can enable GR on a BGP4+ speaker for specified BGP4+ peers so that the BGP4+ speaker can establish GR-capable BGP4+ sessions with the specified peers through negotiation.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0209678823__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li><span>Run <strong><span>peer</span></strong> <i><span class="varname">ipv6-address</span></i><strong><span> capability-advertise graceful-restart</span></strong></span><p><p>GR is enabled for a specified BGP4+ peer, and the device is configured to advertise the GR capability to the specified peer.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=peer+graceful-restart+timer+restart"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv6-address</span></i><strong><span> </span></strong><strong><span>graceful-restart timer restart</span></strong> <i><span class="varname">time-value</span></i></span><p><p>The maximum duration is set for a specified peer to wait for the local BGP4+ peer relationship to be re-established, the device is configured to advertise the duration to the peer.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the specified peer does not support GR, you are advised to run the <strong><span>peer</span></strong> <i><span class="varname">ipv6-address</span></i><strong><span> local-graceful-restart timer restart</span></strong> <i><span class="varname">restart-time</span></i> command instead to set the maximum duration for the device to wait for its BGP4+ peer relationship to be reestablished with the specified peer.</p>
</div></div>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv6-address</span></i> <a href="cmdqueryname=graceful-restart+peer-reset"><b><span class="cmdname">graceful-restart peer-reset</span></b></a></span><p><p>The device is enabled to use the GR mode to reset the BGP4+ connection with the specified peer.</p>
</p><p><p>Currently, BGP4+ does not support dynamic capability negotiation. Therefore, a change in a BGP4+ capability causes peer relationship re-establishment. If a BGP4+ capability changes when BGP IPv6 unicast peer relationships have been established and IPv6 services are running properly, the BGP IPv6 unicast peer relationships will be reestablished, affecting the ongoing IPv6 services. To address this issue, run the <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv6-address</span></i> <a href="cmdqueryname=graceful-restart+peer-reset"><b><span class="cmdname">graceful-restart peer-reset</span></b></a> command in advance.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv6-address</span></i> <a href="cmdqueryname=graceful-restart+timer+wait-for-rib"><b><span class="cmdname">graceful-restart timer wait-for-rib</span></b></a> <i><span class="varname">time-value</span></i></span><p><p>The maximum duration is set for the device to wait for the End-of-RIB flag from the specified peer.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If a specified peer does not support GR, run the <strong><span>peer</span></strong> <i><span class="varname">ipv6-address</span></i><strong><span> local-graceful-restart</span></strong> <strong><span>timer wait-for-rib</span></strong> <i><span class="varname">wfrtime</span></i> command instead to set the maximum duration.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0209678823__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ul><li>Run the <a href="cmdqueryname=display+bgp+ipv6+peer+verbose"><b><span class="cmdname">display bgp ipv6 peer</span></b></a> <strong><span>verbose</span></strong> command to check the BGP4+ GR status.</li><li>Run the <a href="cmdqueryname=display+bgp+graceful-restart+status"><b><span class="cmdname">display bgp</span></b></a> <strong><span>graceful-restart status</span></strong> command to check GR information on the BGP speaker.</li><li>Run the <a href="cmdqueryname=display+bgp+local-graceful-restart+status"><b><span class="cmdname">display bgp</span></b></a> <strong><span>local-graceful-restart status</span></strong> command to check information about local GR on the BGP speaker.</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0000.html">BGP4+ Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0051.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0092.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>