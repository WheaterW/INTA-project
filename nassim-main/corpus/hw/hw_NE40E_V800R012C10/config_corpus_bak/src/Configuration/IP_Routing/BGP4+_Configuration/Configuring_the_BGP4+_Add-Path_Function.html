
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring the BGP4+ Add-Path Function">
<meta name="abstract" content="BGP4+ Add-Path allows a device to send multiple routes with the same prefix to a specified IBGP peer. These routes can back up each other or load-balance traffic, which improves network reliability.">
<meta name="description" content="BGP4+ Add-Path allows a device to send multiple routes with the same prefix to a specified IBGP peer. These routes can back up each other or load-balance traffic, which improves network reliability.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_3045.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0046.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP IPv6">
<meta name="featuretype" content="IP Route">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP IPv6">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="w00604599">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00615954">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001264191518">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring the BGP4+ Add-Path Function</title>
</head>
<body><a name="EN-US_TASK_0000001264191518"></a><a name="EN-US_TASK_0000001264191518"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring the BGP4+ Add-Path Function</h1>
<div class="taskbody"><p>BGP4+ Add-Path allows a device to send multiple routes with the same prefix to a specified IBGP peer. These routes can back up each other or load-balance traffic, which improves network reliability.</p>
<div class="context"><a name="EN-US_TASK_0000001264191518__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>In a scenario with a route reflector (RR) and clients, if the RR has multiple routes to the same destination (with the same prefix), the RR selects an optimal route from these routes according to BGP4+ route selection rules and then sends only the optimal route to its clients. Therefore, the clients have only one route to the destination. If a link along this route fails, route convergence takes a long time, which cannot meet the requirements for high reliability.</p>
<p>To address this issue, deploy BGP4+ Add-Path on the RR. With BGP4+ Add-Path, the RR can send two or more routes with the same prefix to a specified peer. These routes can back up each other or load-balance traffic, which ensures high reliability in data transmission. The BGP4+ Add-Path feature does not affect BGP4+ route selection rules.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p></p>
<p>Add-Path takes effect only for routes learned from peers, not for local routes.</p>
<p>If BGP4+ Add-Path is enabled and the device is also configured to change the next hops of the routes to be advertised to the local address, a routing loop may occur.</p>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001264191518__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring the BGP4+ Add-Path function, complete the following task:</p>
<ul><li><a href="dc_vrp_bgp6_cfg_0003.html">Configure basic BGP4+ functions</a>.</li></ul>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0000001264191518__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Perform the following steps on a device that needs to send Add-Path routes:</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=route-policy+node"><b><span class="cmdname">route-policy</span></b></a> <i><span class="varname">route-policy-name</span></i> <i><span class="varname">matchMode</span></i> <strong><span>node</span></strong> <i><span class="varname">node</span></i></span><p><p>A route-policy is created, and the route-policy view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=xpl+route-filter"><b><span class="cmdname">xpl route-filter</span></b></a> <i><span class="varname">route-filter-name</span></i></span><p><p>A route-filter is created, and the route-filter view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=end-filter"><b><span class="cmdname">end-filter</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">peerGroupName</span></i> } <a href="cmdqueryname=as-number"><b><span class="cmdname">as-number</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>An IP address and AS number are specified for a peer.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv6-family+unicast"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>unicast</span></strong></span><p><p>The IPv6 unicast address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> } <a href="cmdqueryname=enable"><b><span class="cmdname">enable</span></b></a></span><p><p>The IPv6 peer is enabled.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bestroute+add-path+path-number"><b><span class="cmdname">bestroute add-path</span></b></a> <strong><span>path-number</span></strong> <i><span class="varname">path-number</span></i></span><p><p>BGP Add-Path is enabled, and the number of preferred routes is specified.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer+capability-advertise+add-path+send"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>capability-advertise</span></strong> <strong><span>add-path</span></strong> <strong><span>send</span></strong></span><p><p>The device is enabled to send Add-Path routes to the specified peer.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer+advertise+add-path+path-number+route-policy+route-filter"><b><span class="cmdname">peer</span></b></a> { <em>peerIpv4Addr</em> | <i><span class="varname">peerIpv6Addr</span></i> | <em>groupName</em> } <strong><span>advertise add-path path-number</span></strong> <i><span class="varname">number</span></i> { <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> | <strong><span>route-filter</span></strong> <i><span class="varname">route-filter-name</span></i> }</span><p><p>The maximum number of preferred routes to be advertised to a specified peer is specified.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>To configure <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i>, you need to enter the route-policy view.</p>
<p>To configure <strong><span>route-filter</span></strong> <i><span class="varname">route-filter-name</span></i>, you need to enter the route-filter view.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Perform the following steps on a device that needs to accept Add-Path routes:</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv6-family"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>unicast</span></strong></span><p><p>The IPv6 unicast address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer+capability-advertise+add-path+receive"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>capability-advertise</span></strong> <strong><span>add-path</span></strong> <strong><span>receive</span></strong></span><p><p>The device is enabled to accept the Add-Path routes received from the specified peer.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
<div class="example"><a name="EN-US_TASK_0000001264191518__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After completing the configurations, check the configurations on the device that advertises Add-Path routes.</p>
<p>Run the <a href="cmdqueryname=display+bgp+peer+verbose"><b><span class="cmdname">display bgp peer</span></b></a> <strong><span>verbose</span></strong> command to check the status of BGP4+ Add-Path.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0000.html">BGP4+ Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_3045.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0046.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>