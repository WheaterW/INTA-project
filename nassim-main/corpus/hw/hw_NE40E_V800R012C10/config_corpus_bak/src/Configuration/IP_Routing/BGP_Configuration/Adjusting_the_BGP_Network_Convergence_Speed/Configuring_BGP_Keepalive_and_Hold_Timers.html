
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring BGP Keepalive and Hold Timers">
<meta name="abstract" content="The values of BGP Keepalive and Hold timers determine the speed at which BGP detects network faults. You can adjust the values of these timers to improve network performance.">
<meta name="description" content="The values of BGP Keepalive and Hold timers determine the speed at which BGP detects network faults. You can adjust the values of these timers to improve network performance.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3046.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3048.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00615954">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172366221">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring BGP Keepalive and Hold Timers</title>
</head>
<body><a name="EN-US_TASK_0172366221"></a><a name="EN-US_TASK_0172366221"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring BGP Keepalive and Hold Timers</h1>
<div class="taskbody"><p>The values of BGP Keepalive and Hold timers determine the speed at which BGP detects network faults. You can adjust the values of these timers to improve network performance.</p>
<div class="context"><a name="EN-US_TASK_0172366221__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>BGP uses Keepalive messages to maintain peer relationships. After establishing a BGP connection, two peers periodically send Keepalive messages to each other to detect BGP peer relationship status. If a device receives no Keepalive message from its peer after the Hold timer expires, the device considers the BGP connection interrupted.</p>
<div class="p"><ul><li>If short Keepalive time and holdtime are set, BGP can fast detect link faults. This speeds up BGP network convergence, but increases the number of Keepalive messages on the network and loads of <span class="keyword">Router</span>s, and consumes more network bandwidth resources.</li><li>If large values are set for the Keepalive timer and Hold timer, the number of Keepalive messages on the network and the burden on <span class="keyword">Router</span>s are reduced. However, if the Keepalive time is too long, BGP cannot detect link status changes immediately after the changes occur, which slows down BGP network convergence and may cause packet loss.</li></ul>
</div>
<div class="notice"><span class="noticetitle"><img src="../../../../public_sys-resources/notice_3.0-en-us.png"> </span><div class="noticebody"><p>Changing timer values using the <a href="cmdqueryname=timer"><b><span class="cmdname">timer</span></b></a> command or the <a href="cmdqueryname=peer+timer"><b><span class="cmdname">peer timer</span></b></a> command interrupts BGP peer relationships between <span class="keyword">Router</span>s. Therefore, exercise caution when changing the values of the timers.</p>
</div></div>
<p>Keepalive and Hold timers can be configured either for all BGP peers or peer groups, or for a specific peer or peer group. Keepalive and Hold timers configured for a specific peer take precedence over those configured for the peer group of this peer. In addition, Keepalive and Hold timers configured for a specific peer or peer group take precedence over those configured for all peers or peer groups.</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172366221__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Set timers for all peers or peer groups.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=timer+keepalive+hold+min-holdtime"><b><span class="cmdname">timer</span></b></a> <strong><span>keepalive</span></strong> <i><span class="varname">keepalive-time</span></i> <strong><span>hold</span></strong> <i><span class="varname">hold-time</span></i><span> [ <strong><span>min-holdtime</span></strong> <i><span class="varname">min-hold-value</span></i> ]</span> command to set the BGP keepalive time and hold time, or run the <a href="cmdqueryname=timer+send-hold"><b><span class="cmdname">timer</span></b></a> <strong><span>send-hold</span></strong> <i><span class="varname">send-hold-time</span></i> command to set the hold time during which the local device does not proactively disconnect from the peer device.</span><p><div class="p">The proper maximum interval at which Keepalive messages are sent is one third the hold timer and cannot be less than 1s. If the hold time is not set to 0, it is 3s at least. <div class="note" id="EN-US_TASK_0172366221__note2102343800214038"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172366221__p740913259215">You are advised to configure <i><span class="varname" id="EN-US_TASK_0172366221__varname92431524112016">hold-time</span></i> according to the total number of peers in all BGP address families. The more peers, the larger the recommended minimum hold time value. You can adjust the hold time based on <a href="#EN-US_TASK_0172366221__table410763711163">Table 1</a>.</p>
</div></div>

<div class="tableBorder"><a name="EN-US_TASK_0172366221__table410763711163"></a><a name="table410763711163"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172366221__table410763711163" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Mapping between the total number of BGP peers in all address families and the recommended minimum hold time</caption><thead align="left"><tr id="EN-US_TASK_0172366221__row510713710160"><th align="left" class="cellrowborder" valign="top" width="12.47%" id="mcps1.4.2.1.2.3.2.1.2.2.3.1.1" liSelected="liSelected"><p id="EN-US_TASK_0172366221__p1110717372163">Total Number of Peers</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="87.53%" id="mcps1.4.2.1.2.3.2.1.2.2.3.1.2" liSelected="liSelected"><p id="EN-US_TASK_0172366221__p010753721612">Recommended Minimum Hold Time</p>
</th>
</tr>
</thead>
<tbody><tr id="EN-US_TASK_0172366221__row51071037111610"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.4.2.1.2.3.2.1.2.2.3.1.1 "><p id="EN-US_TASK_0172366221__p9530101461916">0â100</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.4.2.1.2.3.2.1.2.2.3.1.2 "><p id="EN-US_TASK_0172366221__p35301714161911">20s</p>
</td>
</tr>
<tr id="EN-US_TASK_0172366221__row610823741614"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.4.2.1.2.3.2.1.2.2.3.1.1 "><p id="EN-US_TASK_0172366221__p205305142194">101â200</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.4.2.1.2.3.2.1.2.2.3.1.2 "><p id="EN-US_TASK_0172366221__p55301414181920">30s</p>
</td>
</tr>
<tr id="EN-US_TASK_0172366221__row201081337131615"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.4.2.1.2.3.2.1.2.2.3.1.1 "><p id="EN-US_TASK_0172366221__p1753001441911">201â300</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.4.2.1.2.3.2.1.2.2.3.1.2 "><p id="EN-US_TASK_0172366221__p45301514151919">45s</p>
</td>
</tr>
<tr id="EN-US_TASK_0172366221__row171082371165"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.4.2.1.2.3.2.1.2.2.3.1.1 "><p id="EN-US_TASK_0172366221__p125301614101919">301â400</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.4.2.1.2.3.2.1.2.2.3.1.2 "><p id="EN-US_TASK_0172366221__p053021419191">60s</p>
</td>
</tr>
<tr id="EN-US_TASK_0172366221__row15108123731613"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.4.2.1.2.3.2.1.2.2.3.1.1 "><p id="EN-US_TASK_0172366221__p1053011141191">401â500</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.4.2.1.2.3.2.1.2.2.3.1.2 "><p id="EN-US_TASK_0172366221__p1153014149193">75s</p>
</td>
</tr>
<tr id="EN-US_TASK_0172366221__row1710883716168"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.4.2.1.2.3.2.1.2.2.3.1.1 "><p id="EN-US_TASK_0172366221__p2530191421918">Greater than or equal to 501</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.4.2.1.2.3.2.1.2.2.3.1.2 "><p id="EN-US_TASK_0172366221__p953071414192">90s</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Avoid the following situations when setting values for the three timers:</p>
<ul><li><p>The <i><span class="varname">keepalive-time</span></i> and <i><span class="varname">hold-time</span></i> values are both set to 0. In this case, BGP timers become invalid, and BGP will not send Keepalive messages.</p>
</li><li><p>The <i><span class="varname">hold-time</span></i> value is much greater than the <i><span class="varname">keepalive-time</span></i> value, for example, <i><span class="varname">keepalive-time</span></i> is set to 1 and <i><span class="varname">hold-time</span></i> is set to 65535. If the hold time is too long, BGP cannot detect the validity of the connection in time.</p>
</li><li><p>The <i><span class="varname">keepalive-time</span></i> value is set to 0. In this case, the keepalive timer does not start. As a result, the <i><span class="varname">send-hold-time</span></i> function does not take effect.</p>
</li></ul>
<p>After a connection is established between peers, the <i><span class="varname">keepalive-time</span></i> and <i><span class="varname">hold-time</span></i> values are negotiated by the peers. The smaller of the <i><span class="varname">hold-time</span></i> values carried in the Open messages exchanged between the peers is used as the final <i><span class="varname">hold-time</span></i> value. The smaller of one third of the negotiated <i><span class="varname">hold-time</span></i> value and the locally configured <i><span class="varname">keepalive-time</span></i> value is used as the final <i><span class="varname">keepalive-time</span></i>.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure timers for a specific peer or peer group.</span><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=peer+timer+keepalive+hold+min-holdtime"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>timer</span></strong> <strong><span>keepalive</span></strong> <i><span class="varname">keepalive-time</span></i> <strong><span>hold</span></strong> <i><span class="varname">hold-time</span></i><span> [ <strong><span>min-holdtime</span></strong> <i><span class="varname">min-hold-value</span></i> ]</span> command to set the interval at which Keepalive messages are sent and the hold time for a peer or peer group. Alternatively, run the <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <a href="cmdqueryname=timer+send-hold"><b><span class="cmdname">timer</span></b></a> <strong><span>send-hold</span></strong> <i><span class="varname">send-hold-time</span></i> command to set the hold time during which the local device does not proactively disconnect from the peer end.</span><p><div class="p">The relationship between the Keepalive and hold timer values in this case is the same as that in the scenario where global timers are configured.<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>You are advised to configure <i><span class="varname">hold-time</span></i> according to the total number of peers in all BGP address families. The more peers, the larger the recommended minimum hold time value. You can adjust the hold time based on <a href="#EN-US_TASK_0172366221__table128097318210">Table 2</a>.</p>
</div></div>
</div>

<div class="tableBorder"><a name="EN-US_TASK_0172366221__table128097318210"></a><a name="table128097318210"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172366221__table128097318210" frame="border" border="1" rules="all"><caption><b>Table 2 </b>Mapping between the total number of BGP peers in all address families and the recommended minimum hold time</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="12.47%" id="mcps1.4.2.2.2.3.2.2.2.3.1.1" liSelected="liSelected"><p>Total Number of Peers</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="87.53%" id="mcps1.4.2.2.2.3.2.2.2.3.1.2" liSelected="liSelected"><p>Recommended Minimum Hold Time</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.4.2.2.2.3.2.2.2.3.1.1 "><p>0â100</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.4.2.2.2.3.2.2.2.3.1.2 "><p>20s</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.4.2.2.2.3.2.2.2.3.1.1 "><p>101â200</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.4.2.2.2.3.2.2.2.3.1.2 "><p>30s</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.4.2.2.2.3.2.2.2.3.1.1 "><p>201â300</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.4.2.2.2.3.2.2.2.3.1.2 "><p>45s</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.4.2.2.2.3.2.2.2.3.1.1 "><p>301â400</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.4.2.2.2.3.2.2.2.3.1.2 "><p>60s</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.4.2.2.2.3.2.2.2.3.1.1 "><p>401â500</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.4.2.2.2.3.2.2.2.3.1.2 "><p>75s</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.4.2.2.2.3.2.2.2.3.1.1 "><p>Greater than or equal to 501</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.4.2.2.2.3.2.2.2.3.1.2 "><p>90s</p>
</td>
</tr>
</tbody>
</table>
</div>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3046.html">Adjusting the BGP Network Convergence Speed
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3048.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>