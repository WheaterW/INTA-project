
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring Inbound BGP Soft Reset">
<meta name="abstract" content="The inbound BGP soft reset allows the system to apply new import policies immediately and refresh BGP routing table dynamically without tearing down any BGP connection.">
<meta name="description" content="The inbound BGP soft reset allows the system to apply new import policies immediately and refresh BGP routing table dynamically without tearing down any BGP connection.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3112.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_31160.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3216.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="w00604599">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00615954">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001347611048">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring Inbound BGP Soft Reset</title>
</head>
<body><a name="EN-US_TASK_0000001347611048"></a><a name="EN-US_TASK_0000001347611048"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring Inbound BGP Soft Reset</h1>
<div class="taskbody"><p>The inbound BGP soft reset allows the system to apply new import policies immediately and refresh BGP routing table dynamically without tearing down any BGP connection.</p>
<div class="context"><a name="EN-US_TASK_0000001347611048__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>After an import BGP policy is changed, you can reset the BGP connection for the new policy to take effect immediately. This, however, interrupts the BGP connection temporarily. BGP route-refresh allows the system to refresh the BGP routing table dynamically without tearing down any BGP connection when a policy is changed.</p>
<ul><li><p>If a BGP peer supports route-refresh, you can run the <a href="cmdqueryname=refresh+bgp"><b><span class="cmdname">refresh bgp</span></b></a> command to softly reset the BGP connection to refresh the routing table.</p>
</li><li><p>If a BGP peer does not support route-refresh, you can run the <a href="cmdqueryname=peer+keep-all-routes"><b><span class="cmdname">peer keep-all-routes</span></b></a> command to reserve all the original routes of the peer. In this manner, the routing table can be refreshed without resetting the BGP connection.</p>
</li></ul>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0000001347611048__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>For BGP peers that support route-refresh:</span><ol><li class="substepexpand"><span>(Optional) Enable route-refresh.</span><p><ol type="a"><li>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a><p>The system view is displayed.</p>
</li><li>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i><p>The BGP view is displayed.</p>
</li><li>Run <a href="cmdqueryname=peer+capability-advertise"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <a href="cmdqueryname=peer+capability-advertise"><b><span class="cmdname">capability-advertise</span></b></a> <strong><span>route-refresh</span></strong><p>Route-refresh is enabled.</p>
</li><li>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a><p>The configuration is committed.</p>
</li></ol>
<p>If route-refresh is enabled on all BGP peers and the import routing policy of the local <span class="keyword">Router</span> is changed, the local <span class="keyword">Router</span> sends a Route-refresh message to its peers or peer groups. Upon receipt, the peers or peer groups re-send their routing information to the local <span class="keyword">Router</span>. This enables the local <span class="keyword">Router</span> to dynamically update its BGP routing table and apply the new policy without terminating any BGP connections.</p>
</p></li><li class="substepexpand"><span>Configure BGP soft reset.</span><p><ol type="a"><li>Run the <a href="cmdqueryname=refresh+bgp+vpn-instance+ipv4-family+vpnv4+all+group+external"><b><span class="cmdname">refresh bgp</span></b></a> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> <strong><span>ipv4-family</span></strong> | <strong><span>vpnv4</span></strong> ] { <strong><span>all</span></strong> | <i><span class="varname">ipv4-address</span></i> | <strong><span>group</span></strong> <i><span class="varname">group-name</span></i> | <strong><span>external</span></strong> | <strong><span>internal</span></strong> } <strong><span>import</span></strong> command in the user view to trigger BGP soft reset immediately.</li></ol>
<p><strong><span>external</span></strong> softly resets an EBGP connection, and <strong><span>internal</span></strong> softly resets an IBGP connection.</p>
</p></li></ol>
</li><li><span>For BGP peers that do not support route-refresh:</span><ul><li><p>Configure the device to retain all the routing updates received from a specified peer or peer group.</p>
<ol><li>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a><p>The system view is displayed.</p>
</li><li>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i><p>The BGP view is displayed.</p>
</li><li>Run <a href="cmdqueryname=ipv4-family+unicast"><b><span class="cmdname">ipv4-family</span></b></a> <strong><span>unicast</span></strong><p>The IPv4 unicast address family view is displayed.</p>
</li><li>Run <a href="cmdqueryname=peer+keep-all-routes"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <a href="cmdqueryname=peer+keep-all-routes"><b><span class="cmdname">keep-all-routes</span></b></a><p>The device is configured to retain all routing updates received from the specified peer or peer group.</p>
<p>After this command is run, all routing updates received from the specified peer or peer group are retained, regardless of whether an import policy is used. If the local routing policy changes, the retained information can be used to regenerate BGP routes.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command needs to be run on both the local device and its peers. If the <a href="cmdqueryname=peer+keep-all-routes"><b><span class="cmdname">peer keep-all-routes</span></b></a> command is run on the device for the first time, the sessions between the device and its peers are re-established.</p>
<p>The <a href="cmdqueryname=peer+keep-all-routes"><b><span class="cmdname">peer keep-all-routes</span></b></a> command does not need to be run on the <span class="keyword">Router</span> that supports route-refresh. If this command is run, the sessions between the <span class="keyword">Router</span> and its peers are not reestablished, but the <a href="cmdqueryname=refresh+bgp"><b><span class="cmdname">refresh bgp</span></b></a> command does not take effect on the <span class="keyword">Router</span>.</p>
</div></div>
</li><li>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a><p>The configuration is committed.</p>
</li></ol>
</li></ul>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3112.html">Configuring BGP Routing Policies
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_31160.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3216.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>