
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring OSPFv3 Neighbor Relationship Flapping Suppression">
<meta name="abstract" content="OSPFv3 neighbor relationship flapping suppression works by delaying OSPFv3 neighbor relationship reestablishment or setting the link cost to the maximum value.">
<meta name="description" content="OSPFv3 neighbor relationship flapping suppression works by delaying OSPFv3 neighbor relationship reestablishment or setting the link cost to the maximum value.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_2000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_2128.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_0121.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,56675587z00801081,w00556928,w00606909,l00455378,">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00875216">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="ccms">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172365749">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring OSPFv3 Neighbor Relationship Flapping Suppression</title>
</head>
<body><a name="EN-US_TASK_0172365749"></a><a name="EN-US_TASK_0172365749"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring OSPFv3 Neighbor Relationship Flapping Suppression</h1>
<div class="taskbody"><p>OSPFv3 neighbor relationship flapping suppression works by delaying OSPFv3 neighbor relationship reestablishment or setting the link cost to the maximum value.</p>
<div class="context"><a name="EN-US_TASK_0172365749__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>If an interface carrying OSPFv3 services alternates between up and down, OSPFv3 neighbor relationship flapping occurs on the interface. During the flapping, OSPFv3 frequently sends Hello packets to reestablish the neighbor relationship, synchronizes LSDBs, and recalculates routes. In this process, a large number of packets are exchanged, adversely affecting neighbor relationship stability, OSPFv3 services, and other OSPFv3-dependent services. OSPFv3 neighbor relationship flapping suppression can address this problem by delaying OSPFv3 neighbor relationship reestablishment or preventing service traffic from passing through flapping links.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365749__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring OSPFv3 neighbor relationship flapping suppression, complete the following tasks:</p>
<ul><li><p>Configure an IP address for each interface to ensure that neighboring devices are reachable at the network layer.</p>
</li><li><p><a href="dc_vrp_ospfv3_cfg_2003.html">Configure basic OSPFv3 functions</a>.</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172365749__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>(Optional) Disable OSPFv3 neighbor relationship flapping suppression globally.</span><p><ol type="a"><li><p>Run <a href="cmdqueryname=ospfv3"><b><span class="cmdname">ospfv3</span></b></a> [ <i><span class="varname">process-id</span></i> ]</p>
<p>The OSPFv3 view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=suppress-flapping+peer+disable"><b><span class="cmdname">suppress-flapping peer disable</span></b></a></p>
<p>OSPFv3 neighbor relationship flapping suppression is disabled.</p>
</li><li><p>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></p>
<p>Return to the system view.</p>
</li></ol>
</p><p><p>To disable the function globally, perform this step.</p>
</p></li><li><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span><p><p>The interface view is displayed.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=ospfv3+suppress-flapping+peer+disable"><b><span class="cmdname">ospfv3 suppress-flapping peer disable</span></b></a></span><p><p>OSPFv3 neighbor relationship flapping suppression is disabled on the interface.</p>
</p><p><p>To disable the function on one of the interfaces, perform this step.</p>
</p></li><li><span>Configure an OSPFv3 neighbor relationship flapping suppression mode, which can be Hold-down or Hold-max-cost mode.</span><p><ul><li>Hold-down mode:<p>Run the <a href="cmdqueryname=ospfv3+suppress-flapping+peer+hold-down"><b><span class="cmdname">ospfv3 suppress-flapping peer hold-down</span></b></a> <i><span class="varname">interval</span></i> [ <strong><span>instance</span></strong> <i><span class="varname">instance-id</span></i> ] command to configure the Hold-down mode and set its duration.</p>
<p>If flooding and topology changes frequently occur during OSPFv3 neighbor relationship establishment, you can configure the Hold-down mode to prevent OSPFv3 neighbor relationship reestablishment within a period of time. This prevents frequent LSDB synchronization and a large number of packets from being exchanged.</p>
</li><li>Hold-max-cost mode:<div class="p">If user service traffic is frequently switched, you can configure OSPFv3 neighbor relationship flapping suppression to work in Hold-max-cost mode. In this mode, the link cost is set to the maximum value (Max-cost) within a period of time, preventing user service traffic from passing through flapping links.<ol type="a"><li>(Optional) Set the maximum cost for OSPFv3 links. If the value needs to be modified, perform this step.<ol class="substepthirdol"><li><p>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></p>
<p>Return to the system view.</p>
</li><li><p>Run <a href="cmdqueryname=ospfv3"><b><span class="cmdname">ospfv3</span></b></a> [ <i><span class="varname">process-id</span></i> ]</p>
<p>The OSPFv3 view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=maximum-link-cost"><b><span class="cmdname">maximum-link-cost</span></b></a> <i><span class="varname">cost</span></i></p>
<p>The maximum cost of OSPFv3 is set.</p>
</li><li><p>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></p>
<p>Return to the system view.</p>
</li><li><p>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></p>
<p>The interface view is displayed.</p>
</li></ol>
</li><li><p>(Optional) Run <a href="cmdqueryname=ospfv3+suppress-flapping+peer+hold-max-cost+disable"><b><span class="cmdname">ospfv3 suppress-flapping peer hold-max-cost disable</span></b></a> [ <strong><span>instance</span></strong> <i><span class="varname">instance-id</span></i> ]</p>
<p>The Hold-max-cost neighbor relationship flapping mode is disabled.</p>
<p>To disable the Hold-max-cost neighbor relationship flapping suppression mode, perform this step.</p>
</li></ol>
</div>
</li></ul>
</p><p><p>Flapping suppression can also work first in Hold-down mode and then in Hold-max-cost mode.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=ospfv3+suppress-flapping+peer"><b><span class="cmdname">ospfv3 suppress-flapping peer</span></b></a> { <strong><span>detecting-interval</span></strong> <i><span class="varname">detecting-interval</span></i> | <strong><span>threshold</span></strong> <i><span class="varname">threshold</span></i> | <strong><span>resume-interval</span></strong> <i><span class="varname">resume-interval</span></i> }<sup>*</sup> [ <strong><span>instance</span></strong> <i><span class="varname">instance-id</span></i> ]</span><p><p>Detection parameters are configured for OSPFv3 neighbor relationship flapping suppression.</p>
</p><p><p>Each OSPFv3 interface on which OSPFv3 neighbor relationship flapping suppression is enabled starts a flapping counter. If the interval between two successive neighbor status changes from Full to a non-Full state is shorter than <i><span class="varname">detecting-interval</span></i>, a valid flapping_event is recorded, and the flapping_count is incremented by 1.</p>
<p>When the flapping_count reaches or exceeds <i><span class="varname">threshold</span></i>, flapping suppression takes effect.</p>
<p>If the interval between two successive neighbor status changes from Full to a non-Full state is longer than <i><span class="varname">resume-interval</span></i>, the flapping_count is reset.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The value of <i><span class="varname">resume-interval</span></i> must be greater than that of <i><span class="varname">detecting-interval</span></i>.</p>
</div></div>
<p>You can configure detection parameters for OSPFv3 neighbor relationship flapping suppression on specific interfaces according to network conditions. However, using the default values of these parameters is recommended. </p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the user view.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=reset+ospfv3"><b><span class="cmdname">reset ospfv3</span></b></a> <i><span class="varname">process-id</span></i> <strong><span>suppress-flapping peer</span></strong> [ <i><span class="varname">interface-type interface-number</span></i> ] [ <strong><span>notify-peer</span></strong> ]</span><p><p>The OSPFv3 interface is configured to exit neighbor relationship flapping suppression.</p>
</p><p><p>To exit neighbor relationship flapping suppression in advance after the fault that causes OSPFv3 neighbor relationship flapping is rectified, perform this step.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p">Interfaces exit flapping suppression in the following scenarios:<ul><li>The suppression timer expires.</li><li>The corresponding OSPFv3 process is reset.</li><li>An OSPFv3 neighbor relationship is reset using the <a href="cmdqueryname=reset+ospfv3+peer"><b><span class="cmdname">reset ospfv3 peer</span></b></a> command.</li><li>OSPFv3 neighbor relationship flapping suppression is disabled globally using the <a href="cmdqueryname=suppress-flapping+peer+disable"><b><span class="cmdname">suppress-flapping peer disable</span></b></a> command in the OSPFv3 view.</li><li>The <a href="cmdqueryname=reset+ospfv3+suppress-flapping+peer"><b><span class="cmdname">reset ospfv3 suppress-flapping peer</span></b></a> command is run to exit flapping suppression.</li></ul>
</div>
</div></div>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0172365749__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+ospfv3"><b><span class="cmdname">display ospfv3</span></b></a> [ <i><span class="varname">process-id</span></i> ] <strong><span>interface</span></strong> [ <span><strong><span>no-peer</span></strong> | </span><strong><span>area</span></strong> <i><span class="varname">area-id</span></i> ] [ <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> ] command to check the status of OSPFv3 neighbor relationship flapping suppression.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_2000.html">OSPFv3 Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_2128.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_0121.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>