
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring NQA for IPv6 Static Routes">
<meta name="abstract" content="NQA for IPv6 static routes can quickly detect network faults and control the advertisement of static routes.">
<meta name="description" content="NQA for IPv6 static routes can quickly detect network faults and control the advertisement of static routes.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_static-route_disjoin_cfg_0050.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_static-route_disjoin_cfg_0030.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_static-route_disjoin_cfg_0077.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,static-routevrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Static Route">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Static Route">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="Static Route">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="Static Route">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00809835">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="ccms">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172365502">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring NQA for IPv6 Static Routes</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172365502"></a><a name="EN-US_TASK_0172365502"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring NQA for IPv6 Static Routes</h1>
<div class="taskbody"><p>NQA for IPv6 static routes can quickly detect network faults and control the advertisement of static routes.</p>
<div class="context"><a name="EN-US_TASK_0172365502__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On a simple network or when the <span class="keyword">Router</span> cannot use a dynamic routing protocol to generate routes, you can configure static routes. Unlike dynamic routing protocols, static routes do not have a detection mechanism. If a link fails, a network administrator must manually delete the corresponding static route from the IPv6 routing table, which delays link switchovers and causes a lengthy service interruption.</p>
<p>Bidirectional Forwarding Detection (BFD) for static routes is adaptable to link changes but requires that both ends of a link support BFD. If either end of a link does not support BFD, configure NQA for IPv6 static routes. If an NQA test instance detects a link fault, it instructs the routing management module to delete the associated static route from the IPv6 routing table. Then traffic is switched to a backup route to prevent lengthy service interruptions.</p>
<div class="p">In <a href="#EN-US_TASK_0172365502__fig_dc_vrp_static-route_disjoin_cfg_004201">Figure 1</a>, backup links are deployed on the IP metropolitan area network (MAN).<ul><li>Static routes are configured on <span class="keyword">Device</span> B and <span class="keyword">Device</span> C. <span class="keyword">Device</span> B is the master device, while <span class="keyword">Device</span> C is the backup device.</li><li>In most cases, traffic is transmitted over the primary link (<span class="keyword">Device</span> B -&gt; Switch A).</li><li>If the primary link fails, traffic switches to the backup link (<span class="keyword">Device</span> C -&gt; Switch A).</li></ul>
</div>
<div class="fignone" id="EN-US_TASK_0172365502__fig_dc_vrp_static-route_disjoin_cfg_004201"><a name="EN-US_TASK_0172365502__fig_dc_vrp_static-route_disjoin_cfg_004201"></a><a name="fig_dc_vrp_static-route_disjoin_cfg_004201"></a><span class="figcap"><b>Figure 1 </b>NQA for IPv6 static routes</span><br><span><img class="vsd" src="images/fig_dc_vrp_static-route_disjoin_cfg_004201.png"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.1.6.1.4.1.1" liSelected="liSelected"><p>Device Name</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.1.6.1.4.1.2" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.1.6.1.4.1.3" liSelected="liSelected"><p>IP Address</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="2" valign="middle" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.1 "><p><span class="keyword">Device</span>A</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.3 "><p>2001:db8:1::1/64</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.2 "><p>GE <span>0/2/3</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.3 "><p>2001:db8:2::1/64</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" valign="middle" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.1 "><p><span class="keyword">Device</span>B</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.3 "><p>2001:db8:1::2/64</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.2 "><p>GE <span>0/1/1</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.3 "><p>2001:db8:3::1/64</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" valign="middle" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.1 "><p><span class="keyword">Device</span>C</p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.3 "><p>2001:db8:6::1/64</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.2 "><p>GE <span>0/2/3</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.3 "><p>2001:db8:2::2/64</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" valign="middle" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.1 "><p>SwitchA</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.2 "><p>VLANIF 10</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.3 "><p>2001:db8:3::2/64</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.2 "><p>VLANIF 20</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.3 "><p>2001:db8:6::2/64</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.2 "><p>VLANIF 30</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.3 "><p>2001:db8:7::1/64</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this networking, Switch A provides access services for users. In actual networking, optical line terminals (OLTs), digital subscriber line access multiplexers (DSLAMs), multiservice access nodes (MSANs), or x digital subscriber lines (xDSLs) can be used for user access. The configurations on <span class="keyword">Device</span> A, <span class="keyword">Device</span> B, and <span class="keyword">Device</span> C are the same. </p>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365502__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Create an Internet Control Message Protocol (ICMP) NQA test instance to monitor the status of the primary link.</p>
<p>Create an ICMP NQA test instance on the NQA client <span class="keyword">Device</span> B to test whether the primary link is running properly.</p>
</li><li><p>Configure static routes and associate the static route along the primary link with the ICMP NQA test instance.</p>
<p>Configure static routes on <span class="keyword">Device</span> B and <span class="keyword">Device</span> C, and associate the static route configured on <span class="keyword">Device</span> B with the ICMP NQA test instance. If the ICMP NQA test instance detects a link fault, it instructs the routing management module to delete the associated static route from the IPv6 routing table.</p>
</li><li><p>Configure a dynamic routing protocol.</p>
<p>Configure a dynamic routing protocol on <span class="keyword">Device</span> A, <span class="keyword">Device</span> B, and <span class="keyword">Device</span> C so that they can learn routes from one another.</p>
</li><li><p>Configure the dynamic routing protocol to import static routes and set a higher cost for the static route along the backup link than for the one along the primary link.</p>
<p>Configure the dynamic routing protocol on <span class="keyword">Device</span> B and <span class="keyword">Device</span> C to import static routes, and set a higher cost for the static route imported by <span class="keyword">Device</span> C than for the one imported by <span class="keyword">Device</span> B. This configuration allows <span class="keyword">Device</span> A to preferentially select the link (<span class="keyword">Device</span> B -&gt; Switch A).</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365502__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li>Interface IPv6 addresses</li><li>NQA item values (for details, see <a href="#EN-US_TASK_0172365502__table_02">Table 1</a>)
<div class="tableBorder"><a name="EN-US_TASK_0172365502__table_02"></a><a name="table_02"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172365502__table_02" frame="border" border="1" rules="all"><caption><b>Table 1 </b>NQA item values</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="50%" id="mcps1.4.3.3.2.2.2.3.1.1" liSelected="liSelected"><p>Item</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="50%" id="mcps1.4.3.3.2.2.2.3.1.2" liSelected="liSelected"><p>Value</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.4.3.3.2.2.2.3.1.1 "><p>Administrator name</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.4.3.3.2.2.2.3.1.2 "><p>admin</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.4.3.3.2.2.2.3.1.1 "><p>Name of the test instance</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.4.3.3.2.2.2.3.1.2 "><p>test</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.4.3.3.2.2.2.3.1.1 "><p>Test type</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.4.3.3.2.2.2.3.1.2 "><p>ICMP</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.4.3.3.2.2.2.3.1.1 "><p>Destination address</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.4.3.3.2.2.2.3.1.2 "><p>2001:db8:3::2</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.4.3.3.2.2.2.3.1.1 "><p>Interval at which the NQA test automatically runs</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.4.3.3.2.2.2.3.1.2 "><p>3 seconds</p>
</td>
</tr>
</tbody>
</table>
</div>
</li><li>OSPFv3 backbone area (Area 0) of <span class="keyword">Device</span> A, <span class="keyword">Device</span> B, and <span class="keyword">Device</span> C, and their router IDs (1.1.1.1, 2.2.2.2, and 3.3.3.3)</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172365502__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure interface IPv6 addresses. For configuration details, see <a href="#EN-US_TASK_0172365502__title_01">Configuration Files</a> in this section.</span></li><li><span>Create an NQA test instance on <span class="keyword">Device</span> B to test the link between <span class="keyword">Device</span> B and Switch A.</span><p><pre class="screen">&lt;<span class="keyword">Device</span>B&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> nqa test-instance admin test</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-nqa-admin-test]<strong> test-type icmp</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-nqa-admin-test]<strong> destination-address ipv6 2001:db8:3::2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-nqa-admin-test]<strong> frequency 9</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-nqa-admin-test]<strong> interval seconds 3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-nqa-admin-test]<strong> start now</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-nqa-admin-test]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-nqa-admin-test]<strong> quit</strong></pre>
</p></li><li><span>Configure IPv6 static routes.</span><p><p># Configure an IPv6 static route on <span class="keyword">Device</span> B and associate it with the NQA test instance.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ipv6 route-static 2001:db8:7:: 64 GigabitEthernet <span>0/1/1</span> 2001:db8:3::2 track nqa admin test</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
<p># Configure an IPv6 static route on <span class="keyword">Device</span> C.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>ipv6 route-static 2001:db8:7:: 64 GigabitEthernet <span>0/1/0</span> 2001:db8:6::2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>commit</strong></pre>
<div class="p"><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The next hop address of the IPv6 static route configured on the local end must be the link-local address of the peer end, which can be obtained using the <a href="cmdqueryname=display+ipv6+interface"><b><span class="cmdname">display ipv6 interface</span></b></a> [ <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> ] command on the peer end.</p>
</div></div>
</div>
</p></li><li><span>Configure a dynamic routing protocol on <span class="keyword">Device</span> A, <span class="keyword">Device</span> B, and <span class="keyword">Device</span> C.</span><p><p># Configure OSPFv3 on <span class="keyword">Device</span> A.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>A&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>ospfv3 1 area 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface GigabitEthernet <span>0/2/3</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/3</span>] <strong>ospfv3 1 area 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/3</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/3</span>] <strong>quit</strong></pre>
<p># Configure OSPFv3 on <span class="keyword">Device</span> B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>ospfv3 1 area 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<p># Configure OSPFv3 on <span class="keyword">Device</span> C.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>interface GigabitEthernet <span>0/2/3</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-GigabitEthernet<span>0/2/3</span>] <strong>ospfv3 1 area 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/2/3</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-GigabitEthernet<span>0/2/3</span>] <strong>quit</strong></pre>
</p></li><li><span>Configure OSPFv3 on <span class="keyword">Device</span> B and <span class="keyword">Device</span> C to import static routes.</span><p><p># Configure OSPFv3 on <span class="keyword">Device</span> B to import a static route and set the cost to 10 for the static route.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ospfv3 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospfv3-1] <strong>import-route static cost 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospfv3-1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ospfv3-1] <strong>quit</strong></pre>
<p># Configure OSPFv3 on <span class="keyword">Device</span> C to import a static route and set the cost to 20 for the static route.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>ospfv3 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1] <strong>import-route static cost 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-ospfv3-1] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>After the configuration is complete, run the <strong>display current-configuration | include nqa</strong> command on <span class="keyword">Device</span> B in the system view. The command output shows that the IPv6 static route has been associated with the NQA test instance. Run the <strong>display nqa results</strong> command. The command output shows that an NQA test instance has been created.</p>
<p># Display configurations of NQA for IPv6 static routes.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display current-configuration | include nqa</strong></pre>
<pre class="screen">ipv6 route-static 2001:db8:7:: 64 GigabitEthernet<span>0/1/1</span> 2001:db8:3::2 track nqa admin test
nqa test-instance admin test
</pre>
<p># Display NQA test results.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display nqa results test-instance admin test</strong></pre>
<pre class="screen"> NQA entry(admin, test) : testflag is active ,testtype is icmp
  1 . Test 359 result     The test is finished
   Send operation times: 3                Receive response times: 3
   <strong>Completion:success</strong>                   RTD OverThresholds number:0
   Attempts number:1                      Drop operation number:0
   Disconnect operation number:0          Operation timeout number:0
   System busy operation number:0         Connection fail number:0
   Operation sequence errors number:0     RTT Stats errors number:0
   Destination ip address:2001:db8:3::2
   Min/Max/Average Completion Time: 1/3/2
   Sum/Square-Sum  Completion Time: 7/19
   Last Good Probe Time: 2012-11-14 12:15:22.3
   <strong>Lost packet ratio: 0 %</strong></pre>
<p>The command output shows "Lost packet ratio 0 %," indicating that the link is running properly.</p>
<p># Display the routing table on <span class="keyword">Device</span> B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display ipv6 routing-table 2001:db8:7::</strong></pre>
<pre class="screen">Routing Table : _public_
Summary Count : 1

Destination  : 2001:db8:7::                            PrefixLength : 64
NextHop      : 2001:db8:3::2                           Preference   : 60
Cost         : 0                                       Protocol     : Static
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : GigabitEthernet<span>0/1/1</span>                    Flags        : D</pre>
<p>The command output shows that the static route exists in the routing table.</p>
<p># Display the routing table on <span class="keyword">Device</span> A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display ipv6 routing-table 2001:db8:7::</strong></pre>
<pre class="screen">Routing Table : _public_
Summary Count : 1

Destination  : 2001:db8:7::                            PrefixLength : 64
NextHop      : FE80::2200:10FF:FE03:0                  Preference   : 150
Cost         : 10                                      Protocol     : OSPFv3ASE
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : <strong>GigabitEthernet<span>0/1/0</span></strong>                  Flags        : D</pre>
<p>The command output shows that a route to 2001:db8:7::1/128 exists in the routing table. The outbound interface of the route is GE <span>0/1/0</span> and the cost is 10. Traffic is preferentially transmitted along the link <span class="keyword">Device</span> B -&gt; Switch A.</p>
<p># Shut down GE <span>0/1/1</span> on <span class="keyword">Device</span> B to simulate a link fault.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>interface GigabitEthernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/1</span>] <strong>shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<p># Display NQA test results.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display nqa results test-instance admin test</strong></pre>
<pre class="screen"> NQA entry(admin, test) : testflag is active ,testtype is icmp
  1 . Test 1156 result    The test is finished
   Send operation times: 3                Receive response times: 0
   <strong>Completion:failed</strong>                    RTD OverThresholds number:0
   Attempts number:1                      Drop operation number:0
   Disconnect operation number:0          Operation timeout number:3
   System busy operation number:0         Connection fail number:0
   Operation sequence errors number:0     RTT Stats errors number:0
   Destination ip address:2001:db8:3::2
   Min/Max/Average Completion Time: 0/0/0
   Sum/Square-Sum  Completion Time: 0/0
   Last Good Probe Time: 0000-00-00 00:00:00.0
   <strong>Lost packet ratio: 100 %</strong></pre>
<p>The command output shows "Completion:failed" and "Lost packet ratio is 100 %," indicating that the link is faulty.</p>
<p># Display the routing table on <span class="keyword">Device</span> B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display ipv6 routing-table 2001:db8:7::</strong></pre>
<pre class="screen">Routing Table : _public_
Summary Count : 1

Destination  : 2001:db8:7::                            PrefixLength : 64
NextHop      : FE80::3A00:10FF:FE03:0                  Preference   : 150
Cost         : 20                                      Protocol     : OSPFv3ASE
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : GigabitEthernet<span>0/1/0</span>                    Flags        : D</pre>
<p>The command output shows that the static route has been deleted and that the route has become an OSPFv3 route learned from <span class="keyword">Device</span> A.</p>
<p># Display the routing table on Device A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display ipv6 routing-table 2001:db8:7::</strong></pre>
<pre class="screen">Routing Table : _public_
Summary Count : 1

Destination  : 2001:db8:7::                            PrefixLength : 64
NextHop      : FE80::3A00:10FF:FE03:107                Preference   : 150
Cost         : 20                                      Protocol     : OSPFv3ASE
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : <strong>GigabitEthernet<span>0/2/3</span></strong>                 Flags        : D</pre>
<p>The static route has been associated with the NQA test instance on <span class="keyword">Device</span> B. If NQA detects a link fault, it rapidly notifies <span class="keyword">Device</span> B that the associated static route is unavailable. <span class="keyword">Device</span> A cannot learn the route to 2001:db8:7::/64 from <span class="keyword">Device</span> B. However, <span class="keyword">Device</span> A can learn the route to 2001:db8:7::/64 from <span class="keyword">Device</span> C. The route's outbound interface is GE <span>0/2/3</span>, and the cost is 20. Traffic switches to the link <span class="keyword">Device</span> C -&gt; Switch A.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172365502__title_01"><a name="EN-US_TASK_0172365502__title_01"></a><a name="title_01"></a><a name="EN-US_TASK_0172365502__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span> A configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>A
#
ospfv3 1
 router-id 1.1.1.1
 area 0.0.0.0
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:1::1/64
 ospfv3 1 area 0.0.0.0
#
interface GigabitEthernet<span>0/2/3</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:2::1/64
 ospfv3 1 area 0.0.0.0
#
return</pre>
</li><li><p><span class="keyword">Device</span> B configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>B
#
ospfv3 1
 router-id 2.2.2.2
 import-route static cost 10
 area 0.0.0.0
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:1::2/64
 ospfv3 1 area 0.0.0.0
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:3::1/64
#
interface GigabitEthernet<span>0/1/3</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:5::1/64
#
ipv6 route-static 2001:db8:7:: 64 GigabitEthernet<span>0/1/1</span> 2001:db8:3::2 track nqa admin test
#
nqa test-instance admin test
 test-type icmp
 destination-address ipv6 2001:db8:3::2
 interval seconds 3
 frequency 9
 start now
#
return</pre>
</li><li><p><span class="keyword">Device</span> C configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>C
#
ospfv3 1
 router-id 3.3.3.3
 import-route static cost 20
 area 0.0.0.0
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:6::1/64
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:4::1/64
#
interface GigabitEthernet<span>0/2/3</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:2::2/64
 ospfv3 1 area 0.0.0.0
#
ipv6 route-static 2001:db8:7:: 64 GigabitEthernet<span>0/1/0</span> 2001:db8:6::2
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_static-route_disjoin_cfg_0050.html">Configuration Examples for IPv6 Static Routes
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_static-route_disjoin_cfg_0030.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_static-route_disjoin_cfg_0077.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>