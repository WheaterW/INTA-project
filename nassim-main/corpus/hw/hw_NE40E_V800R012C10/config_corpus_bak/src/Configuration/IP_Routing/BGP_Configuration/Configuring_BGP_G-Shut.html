
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring BGP G-Shut">
<meta name="abstract" content="After EBGP and IBGP sessions between BGP devices are shut down during maintenance, the BGP devices are temporarily unreachable to each other during BGP convergence. To minimize traffic loss during session closure and re-establishment, you can configure the g-shut function to gracefully shut down one or more BGP sessions.">
<meta name="description" content="After EBGP and IBGP sessions between BGP devices are shut down during maintenance, the BGP devices are temporarily unreachable to each other during BGP convergence. To minimize traffic loss during session closure and re-establishment, you can configure the g-shut function to gracefully shut down one or more BGP sessions.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_5002.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3091.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="w00604599">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00615954">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001714668597">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring BGP G-Shut</title>
</head>
<body><a name="EN-US_TASK_0000001714668597"></a><a name="EN-US_TASK_0000001714668597"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring BGP G-Shut</h1>
<div class="taskbody"><p>After EBGP and IBGP sessions between BGP devices are shut down during maintenance, the BGP devices are temporarily unreachable to each other during BGP convergence. To minimize traffic loss during session closure and re-establishment, you can configure the g-shut function to gracefully shut down one or more BGP sessions.</p>
<div class="steps"><a name="EN-US_TASK_0000001714668597__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_steps575679658214038"><li id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_step1916273526214038"><span id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmd996897423214038">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdname58073073214038">system-view</span></b></a></span><p><p id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_p139568507237">The system view is displayed.</p>
</p></li><li id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_step1272706400214038"><span id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmd1439340680214038">Run <a href="cmdqueryname=bgp"><b><span class="cmdname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdname927027537214038">bgp</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_varname1671930021214038">as-number</span></i></span><p><p id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_p193782112416">The BGP view is displayed.</p>
</p></li><li id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_step1499856990214038"><span id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmd933382444214038">Enable and activate BGP g-shut globally or for a specified peer as required.</span><p><ul id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_ul81594422133"><li id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_li161594423137">Enable and activate BGP g-shut globally.<ol type="a" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_ol847184410148"><li id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_li047144410140">Run the <a href="cmdqueryname=graceful-shutdown+all-peer"><b><span class="cmdname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdname1867136101615">graceful-shutdown all-peer</span></b></a> command to enable the g-shut function globally.</li><li id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_li102265147178">Run the <a href="cmdqueryname=graceful-shutdown+manual-activate"><b><span class="cmdname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdname13238184811185">graceful-shutdown manual-activate</span></b></a> command to activate the g-shut function globally.</li></ol>
</li><li id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_li12782101917198">Enable and activate BGP g-shut for a peer.<ol type="a" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_ol17741639212"><li id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_li12927245112520">Run the <a href="cmdqueryname=peer+graceful-shutdown"><b><span class="cmdname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdname14618759142410">peer </span></b></a>{ <i><span class="varname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_varname17618205942415">peerIpv4Addr</span></i> | <i><span class="varname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_varname2994020132911">groupName</span></i> } <a href="cmdqueryname=peer+graceful-shutdown"><b><span class="cmdname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdname9398191611216">graceful-shutdown</span></b></a> [ <strong><span id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdparmname1361817591242">local-preference</span></strong> <i><span class="varname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_varname1161811598244">local-preference-value</span></i> | <strong><span id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdparmname106181059152411">as-prepend</span></strong> <i><span class="varname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_varname12618125918242">as-prepend-value</span></i> ] command to enable the g-shut function for a peer or peer group.</li><li id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_li1783114613215">Run the <a href="cmdqueryname=peer+graceful-shutdown+manual-activate"><b><span class="cmdname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdname4731115915249">peer </span></b></a>{ <i><span class="varname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_varname13731759152416">peerIpv4Addr</span></i> | <i><span class="varname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_varname121975375913">groupName</span></i> } <a href="cmdqueryname=peer+graceful-shutdown+manual-activate"><b><span class="cmdname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdname201811456413">graceful-shutdown manual-activate</span></b></a> command to activate the g-shut function for a peer or peer group.</li></ol>
<div class="note" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_note1250122716015"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_p833818217918">If a peer group has been configured with g-shut but peer A in it does not need to inherit g-shut from the peer group, run the <a href="cmdqueryname=peer+graceful-shutdown"><b><span class="cmdname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdname591914171117">peer </span></b></a><i><span class="varname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_varname1591964111113">peerIpv4Addr</span></i> <a href="cmdqueryname=peer+graceful-shutdown"><b><span class="cmdname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdname347655312310">graceful-shutdown</span></b></a> <strong><span id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdparmname891910413115">disable</span></strong> command. To prevent this peer from inheriting the g-shut activation status from the peer group, run the <a href="cmdqueryname=peer+graceful-shutdown+manual-activate"><b><span class="cmdname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdname6922162816347">peer </span></b></a><i><span class="varname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_varname08981641181110">peerIpv4Addr</span></i> <a href="cmdqueryname=peer+graceful-shutdown+manual-activate"><b><span class="cmdname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdname159128416410">graceful-shutdown manual-activate</span></b></a> <strong><span id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdparmname18922928153412">disable</span></strong> command.</p>
</div></div>
</li></ul>
</p></li><li id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_step787186778214038"><span id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmd1748912326214038">(Optional) Run <a href="cmdqueryname=advertise-community-gshut+ibgp+ebgp"><b><span class="cmdname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdname124571419151514">advertise-community-gshut </span></b></a>[ <strong><span id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdparmname164571419151513">ibgp</span></strong> | <strong><span id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdparmname145714196151">ebgp</span></strong> ]</span><p><p id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_p1670351312208">The device is configured to advertise the g-shut community attribute of the address family level.</p>
</p></li><li id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_step1707638725214038"><span id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmd1312592567214038">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdname2139625449214038">commit</span></b></a></span><p><p id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_p1091028132510">The configuration is committed.</p>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0000001714668597__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_p13505108173318">After the configuration is complete, verify it.</p>
<p id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_p2242171216337">Run the <a href="cmdqueryname=display+bgp+peer+verbose"><b><span class="cmdname" id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdname2194354214038">display bgp peer</span></b></a> <strong><span id="EN-US_TASK_0000001714668597__en-us_task_0000001289206288_cmdparmname1205124787214038">verbose</span></strong> command to check the status of BGP g-shut.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3000.html">BGP Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_5002.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3091.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>