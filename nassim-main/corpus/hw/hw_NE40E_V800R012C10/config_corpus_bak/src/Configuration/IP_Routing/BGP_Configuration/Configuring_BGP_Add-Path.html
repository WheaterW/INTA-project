
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring BGP Add-Path">
<meta name="abstract" content="BGP Add-Path allows a device to send multiple routes with the same prefix to a specified IBGP peer. These routes can back up each other or load-balance traffic, which improves network reliability.">
<meta name="description" content="BGP Add-Path allows a device to send multiple routes with the same prefix to a specified IBGP peer. These routes can back up each other or load-balance traffic, which improves network reliability.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_4101.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_4093.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00615954">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172366275">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring BGP Add-Path</title>
</head>
<body><a name="EN-US_TASK_0172366275"></a><a name="EN-US_TASK_0172366275"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring BGP Add-Path</h1>
<div class="taskbody"><p>BGP Add-Path allows a device to send multiple routes with the same prefix to a specified IBGP peer. These routes can back up each other or load-balance traffic, which improves network reliability.</p>
<div class="context"><a name="EN-US_TASK_0172366275__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>In a scenario with an RR and clients, if the RR has multiple routes to the same destination (with the same prefix), the RR selects an optimal route from these routes and then sends only the optimal route to its clients. Therefore, the clients have only one route to the destination. If a link along this route fails, route convergence takes a long time, which cannot meet the requirements for high reliability.</p>
<p>To address this issue, deploy the BGP Add-Path feature on the RR. With BGP Add-Path, the RR can send two or more routes with the same prefix to a specified IBGP peer. These routes can back up each other or load-balance traffic, which ensures high reliability in data transmission. The BGP Add-Path feature does not affect BGP route selection rules.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p></p>
<p>Add-Path takes effect only for routes learned from peers, not for local routes.</p>
<p>If BGP Add-Path is enabled and the device is also configured to change the next hops of the routes to be advertised to the local address, a routing loop may occur.</p>
</div></div>
<p>Generally, BGP Add-Path is configured on an RR, and the Add-Path route receiver needs to be configured to accept such routes. In <a href="#EN-US_TASK_0172366275__fig_dc_vrp_bgp_cfg_309601">Figure 1</a>, you can enable BGP Add-Path on the RR, enable <span class="keyword">Device</span>A to accept BGP Add-Path routes received from the RR so that <span class="keyword">Device</span>A obtains two routes destined for 1.1.1.1/32, with next hops of 172.16.6.2 and 172.16.7.2. The two routes can back up each other or load-balance traffic.</p>
<div class="fignone" id="EN-US_TASK_0172366275__fig_dc_vrp_bgp_cfg_309601"><a name="EN-US_TASK_0172366275__fig_dc_vrp_bgp_cfg_309601"></a><a name="fig_dc_vrp_bgp_cfg_309601"></a><span class="figcap"><b>Figure 1 </b>Networking for configuring BGP Add-Path</span><br><span><img class="vsd" src="images/fig_dc_vrp_bgp_cfg_309601.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172366275__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring BGP Add-Path, <a href="dc_vrp_bgp_cfg_3004.html">configure basic BGP functions</a>.</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172366275__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Perform the following steps on the RR that needs to advertise Add-Path routes:</span><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=route-policy+node"><b><span class="cmdname">route-policy</span></b></a> <i><span class="varname">route-policy-name</span></i> <i><span class="varname">matchMode</span></i> <strong><span>node</span></strong> <i><span class="varname">node</span></i></span><p><p>A route-policy is created, and the route-policy view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=xpl+route-filter"><b><span class="cmdname">xpl route-filter</span></b></a> <i><span class="varname">route-filter-name</span></i></span><p><p>A route-filter is created, and the route-filter view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=end-filter"><b><span class="cmdname">end-filter</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">peerGroupName</span></i> } <a href="cmdqueryname=as-number"><b><span class="cmdname">as-number</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>An IP address and AS number are specified for a peer.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family+unicast"><b><span class="cmdname">ipv4-family</span></b></a> <strong><span>unicast</span></strong></span><p><p>The IPv4 unicast address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bestroute+add-path+path-number"><b><span class="cmdname">bestroute add-path</span></b></a> <strong><span>path-number</span></strong> <i><span class="varname">path-number</span></i></span><p><p>BGP Add-Path is enabled, and the number of preferred routes is specified.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer+capability-advertise+add-path+send"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>capability-advertise</span></strong> <strong><span>add-path</span></strong> <strong><span>send</span></strong></span><p><p>The device is enabled to send Add-Path routes to the specified peer.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer+advertise+add-path+path-number+route-policy+route-filter"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">peerIpv4Addr</span></i> | <i><span class="varname">groupName</span></i> } <strong><span>advertise add-path path-number</span></strong> <i><span class="varname">number</span></i> [ <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> | <strong><span>route-filter</span></strong> <i><span class="varname">route-filter-name</span></i> ]</span><p><p>The maximum number of preferred routes to be advertised to a specified peer is specified.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>To configure <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i>, you need to enter the route-policy view.</p>
<p>To configure <strong><span>route-filter</span></strong> <i><span class="varname">route-filter-name</span></i>, you need to enter the route-filter view.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Perform the following steps on the device (<span class="keyword">Device</span>A in this example) that needs to accept Add-Path routes:</span><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer+capability-advertise+add-path+receive"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>capability-advertise</span></strong> <strong><span>add-path</span></strong> <strong><span>receive</span></strong></span><p><p>The device is enabled to accept Add-Path routes from the specified peer.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
<div class="example"><a name="EN-US_TASK_0172366275__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After the configuration is complete, run the <a href="cmdqueryname=display+bgp+peer+verbose"><b><span class="cmdname">display bgp peer</span></b></a> <strong><span>verbose</span></strong> command to check the BGP Add-Path status.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3000.html">BGP Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_4101.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_4093.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>