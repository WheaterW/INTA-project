
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring VPNv4 FRR">
<meta name="abstract" content="In an H-VPN scenario in which VPNv4 FRR is configured, if the primary LSP between an ASBR or SPE and its next hop is unreachable, traffic quickly switches to the secondary LSP.">
<meta name="description" content="In an H-VPN scenario in which VPNv4 FRR is configured, if the primary LSP between an ASBR or SPE and its next hop is unreachable, traffic quickly switches to the secondary LSP.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_2013.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_3100.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,l3vpnvrp,w00556928,l00468467,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="h00847023">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00847023">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369428">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring VPNv4 FRR</title>
</head>
<body><a name="EN-US_TASK_0172369428"></a><a name="EN-US_TASK_0172369428"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring VPNv4 FRR</h1>
<div class="taskbody"><p>In an H-VPN scenario in which VPNv4 FRR is configured, if the primary LSP between an ASBR or SPE and its next hop is unreachable, traffic quickly switches to the secondary LSP.</p>
<div class="context"><a name="EN-US_TASK_0172369428__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>In an H-VPN scenario in which VPNv4 FRR is configured on an SPE, the SPE immediately switches VPN services to the standby link if the active link fails.</p>
<div class="fignone"><span class="figcap"><b>Figure 1 </b>VPNv4 FRR</span><br><span><img class="vsd" src="images/fig_dc_vrp_mpls-l3vpn-v4_cfg_201601.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369428__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before you configure VPNv4 FRR, complete the following tasks:</p>
<ul><li><p>Configure a routing protocol on <span class="keyword">Router</span>s for them to communicate.</p>
</li><li><p>Configure two unequal-cost routes between the SPE and remote PE.</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172369428__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a> <strong><span>vpnv4</span></strong></span><p><p>The BGP VPNv4 address family view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=auto-frr"><b><span class="cmdname">auto-frr</span></b></a></span><p><p>VPNv4 FRR is enabled.</p>
</p></li><li><span>Run <a href="cmdqueryname=bestroute+nexthop-resolved"><b><span class="cmdname">bestroute nexthop-resolved</span></b></a> <strong><span>tunnel</span></strong><span> [ <strong><span>inherit-ip-cost</span></strong> ]</span></span><p><p>A VPNv4 route is configured to participate in route selection only when its next hop recurses to a tunnel. This configuration ensures that packets are not lost during traffic switchback.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=route-select+delay"><b><span class="cmdname">route-select delay</span></b></a> <i><span class="varname">delay-value</span></i></span><p><p>A delay for route selection is configured. Delayed route selection ensures that after the primary path recovers, the device on the primary path performs route selection only after the corresponding forwarding entries on the device are stable. This prevents traffic loss during traffic switchback.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172369428__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+mpls+lsp"><b><span class="cmdname">display mpls lsp</span></b></a> <strong><span>include</span></strong> <i><span class="varname">ip-address</span></i> <i><span class="varname">mask-length</span></i> <strong><span>verbose</span></strong> command to check the index and label of the backup LSP to which the VPNv4 route recurses.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0000.html">BGP/MPLS IP VPN Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_2013.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_3100.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>