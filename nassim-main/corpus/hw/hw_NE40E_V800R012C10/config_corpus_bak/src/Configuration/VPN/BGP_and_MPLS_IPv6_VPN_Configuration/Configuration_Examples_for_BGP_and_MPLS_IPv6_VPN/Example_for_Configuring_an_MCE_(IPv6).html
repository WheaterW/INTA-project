
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring an MCE (IPv6)">
<meta name="abstract" content="Open Shortest Path First (OSPF) multi-VPN-instance can be configured on a customer edge (CE) to isolate different types of services on a local area network (LAN).">
<meta name="description" content="Open Shortest Path First (OSPF) multi-VPN-instance can be configured on a customer edge (CE) to isolate different types of services on a local area network (LAN).">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2039.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2111.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2044.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,l3vpnvrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="h00847023">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00847023">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369734">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring an MCE (IPv6)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172369734"></a><a name="EN-US_TASK_0172369734"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring an MCE (IPv6)</h1>
<div class="taskbody"><p>Open Shortest Path First (OSPF) multi-VPN-instance can be configured on a customer edge (CE) to isolate different types of services on a local area network (LAN).</p>
<div class="context"><a name="EN-US_TASK_0172369734__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><div class="p">Branch A at site 1 and branch B at site 2 need to communicate with the headquarters over the operator's backbone network. Branches A and B are responsible for different types of services and need to access service-related departments or servers in different areas of the headquarters. In this example, the services in branches A and B need to be isolated. If the traditional BGP/MPLS IPv6 VPN technology is used, one CE needs to be deployed at the headquarters separately for branches A and B. This deployment is expensive. To resolve this issue, use a multi-VPN-instance CE (MCE) at the headquarters to connect to sites on different VPNs, on the network shown in <a href="#EN-US_TASK_0172369734__fig_dc_vrp_mpls-l3vpn-v6_cfg_208101">Figure 1</a>:<ul><li><p>CE1 in branch A and CE2 in branch B belong to vpna and vpnb, respectively.</p>
</li><li><p>The MCE connects to the sites on vpna and vpnb at the headquarters.</p>
</li><li><p>vpna and vpnb use different VPN targets.</p>
</li><li><p>The headquarters use <span class="keyword">Device</span> A and <span class="keyword">Device</span> B to communicate with branches A and B, respectively.</p>
</li></ul>
</div>
<p>This configuration ensures that users on the same VPN can communicate with each other and that users on different VPNs cannot communicate with each other.</p>
<div class="fignone" id="EN-US_TASK_0172369734__fig_dc_vrp_mpls-l3vpn-v6_cfg_208101"><a name="EN-US_TASK_0172369734__fig_dc_vrp_mpls-l3vpn-v6_cfg_208101"></a><a name="fig_dc_vrp_mpls-l3vpn-v6_cfg_208101"></a><span class="figcap"><b>Figure 1 </b>Networking for configuring an MCE</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>interface1, interface2, interface3, and interface4 in this example represent GE<span>0/1/0</span>, GE<span>0/2/0</span>, GE<span>0/3/0</span>, and GE<span>0/1/1</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_mpls-l3vpn-v6_cfg_208101.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369734__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Notes</h4><p>When configuring an MCE, note the following points:</p>
<ul><li><p>Different VPN instances must be configured on the MCE and bound to different interfaces.</p>
</li><li><p>Routing loop detection must be disabled on the MCE so that the MCE exchanges routing information with the PEs using OSPFv3 multi-vpn-instance.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369734__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure OSPF on PEs and enable MP-IBGP on the PEs to exchange VPN routing information.</p>
</li><li><p>Establish BGP4+ peer relationships between the PEs and CEs and import VPN routes into the PEs' VRF tables.</p>
</li><li><p>Configure OSPFv3 multi-vpn-instance on the MCE and PE2 to exchange VPN routing information.</p>
</li><li><p>Configure RIPng on the MCE, <span class="keyword">Device</span> A, and <span class="keyword">Device</span> B to exchange VPN routing information.</p>
</li></ol>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Configuring OSPFv3 multi-vpn-instance on the MCE and PE2 includes the following configurations:</p>
<ul><li><p>Import BGP routes to PE2's OSPFv3 process in which OSPFv3 multi-vpn-instance is configured on the MCE and PE2. Then advertise PE1's VPN routes to the MCE.</p>
</li><li><p>Import all routes to PE2's OSPFv3 process in the BGP-VPN instance IPv6 address family, in which OSPFv3 multi-VPN-instance is configured on the MCE and PE2, in PE2's BGP view. Then advertise MCE's VPN routes to PE1.</p>
</li></ul>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369734__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>VPN instances (vpna and vpnb) on PE1, PE2, and the MCE for each service; vpna's import and export VPN targets (111:1); and vpnb's import and export VPN targets (222:2)</p>
</li><li><p>vpna's OSPFv3 process ID 100 and vpnb's OSPFv3 process ID 200</p>
</li><li><p>vpna's RIPng process ID 100 and vpnb's RIPng process ID 200 used for importing VPN routes of sites 3 and 4 on the MCE</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172369734__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enable OSPF on the PEs on the backbone network to ensure that the PEs interwork with each other.</span><p><p>For configuration details, see <a href="#EN-US_TASK_0172369734__example1010854147214051">Configuration Files</a> in this section.</p>
<p>After this configuration is complete, the PEs can learn the IP address of each other's loopback1 interface.</p>
<p>The following example uses the command output on PE2.</p>
<pre class="screen">&lt;PE2&gt; <strong>display ip routing-table</strong></pre>
<pre class="screen"><span class="keyword">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route</span>
------------------------------------------------------------------------------
Routing Table : _public_
         Destinations : 9        Routes : 9

Destination/Mask    Proto  Pre  Cost        Flags NextHop         Interface

        1.1.1.1/32  OSPF   10   1             D  172.16.1.1      GigabitEthernet<span>0/1/0</span>
        2.2.2.2/32  Direct 0    0             D  127.0.0.1       LoopBack1
      127.0.0.0/8   Direct 0    0             D  127.0.0.1       InLoopBack0
      127.0.0.1/32  Direct 0    0             D  127.0.0.1       InLoopBack0
127.255.255.255/32  Direct 0    0             D  127.0.0.1       InLoopBack0
     172.16.1.0/24  Direct 0    0             D  172.16.1.2      GigabitEthernet<span>0/1/0</span>
     172.16.1.2/32  Direct 0    0             D  127.0.0.1       GigabitEthernet<span>0/1/0</span>
   172.16.1.255/32  Direct 0    0             D  127.0.0.1       GigabitEthernet<span>0/1/0</span>
255.255.255.255/32  Direct 0    0             D  127.0.0.1       InLoopBack0</pre>
</p></li><li><span>Configure basic MPLS functions and enable MPLS LDP on the PEs on the backbone network. Then establish LDP LSPs between the PEs.</span><p><p>For configuration details, see <a href="#EN-US_TASK_0172369734__example1010854147214051">Configuration Files</a> in this section.</p>
<p>After this configuration is complete, run the <strong>display mpls ldp session</strong> command on the PEs. The command output shows that an MPLS LDP session has been established between the PEs and its status is <strong>Operational</strong>.</p>
<p>In the following example, the display on PE2 is used.</p>
<pre class="screen">&lt;PE2&gt; <strong>display mpls ldp session</strong></pre>
<pre class="screen"> LDP Session(s) in Public Network
 Codes: LAM(Label Advertisement Mode), SsnAge Unit(DDDD:HH:MM)
<span> An asterisk (*) before a session means the session is being deleted.</span>

--------------------------------------------------------------------------
 PeerID             Status       LAM  SsnRole  SsnAge       KASent/Rcv
--------------------------------------------------------------------------
 1.1.1.1:0          <strong>Operational</strong> DU   Active   0000:00:07   32/32
--------------------------------------------------------------------------
TOTAL: 1 Session(s) Found.</pre>
</p></li><li><span>Configure VPN instances on PE1 and PE2, and bind the VPN instances on PE1 to PE1's interfaces connected to CE1 and CE2 and bind the VPN instances on PE2 to PE2's interfaces connected to the MCE.</span><p><p># Configure PE1.</p>
<pre class="screen">&lt;PE1&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>ip vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpna] <strong>ipv6-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpna-af-ipv6] <strong>route-distinguisher 100:1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpna-af-ipv6] <strong>vpn-target 111:1 both</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpna-af-ipv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpna] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>ip vpn-instance vpnb</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpnb] <strong>ipv6-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpnb-af-ipv6] <strong>route-distinguisher 100:2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpnb-af-ipv6] <strong>vpn-target 222:2 both</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpnb-af-ipv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpnb] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>ip binding vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>ipv6 address 2001:db8:1::2 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong>ip binding vpn-instance vpnb</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong>ipv6 address 2001:db8:2::2 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">&lt;PE2&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>ip vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-vpna] <strong>ipv6-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-vpna-af-ipv6] <strong>route-distinguisher 200:1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-vpna-af-ipv6] <strong>vpn-target 111:1 both</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-vpna-af-ipv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-vpna] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>ip vpn-instance vpnb</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-vpnb] <strong>ipv6-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-vpnb-af-ipv6] <strong>route-distinguisher 200:2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-vpnb-af-ipv6] <strong>vpn-target 222:2 both</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-vpnb-af-ipv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-vpnb] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>] <strong>ip binding vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>] <strong>ipv6 address 2001:db8:8::1 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong>interface gigabitethernet<span>0/3/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/3/0</span>] <strong>ip binding vpn-instance vpnb</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/3/0</span>] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/3/0</span>] <strong>ipv6 address 2001:db8:9::1 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/3/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</p></li><li><span>Configure VPN instances on the MCE, and bind the VPN instances to the MCE's interfaces connected to site 3, site 4, and PE2.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname MCE</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>MCE] <strong>ip vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-vpn-instance-vpna] <strong>ipv6-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-vpn-instance-vpna-af-ipv6] <strong>route-distinguisher 100:1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-vpn-instance-vpna-af-ipv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-vpn-instance-vpna] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE] <strong>ip vpn-instance vpnb</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-vpn-instance-vpnb] <strong>ipv6-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-vpn-instance-vpnb-af-ipv6] <strong>route-distinguisher 200:2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-vpn-instance-vpnb-af-ipv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-vpn-instance-vpnb] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE] <strong>interface gigabitethernet<span>0/3/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/3/0</span>] <strong>ip binding vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/3/0</span>] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/3/0</span>] <strong>ipv6 address 2001:db8:3::2 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/3/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/1/1</span>] <strong>ip binding vpn-instance vpnb</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/1/1</span>] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/1/1</span>] <strong>ipv6 address 2001:db8:4::2 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE] <strong>interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/1/0</span>] <strong>ip binding vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/1/0</span>] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/1/0</span>] <strong>ipv6 address 2001:db8:8::2 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE] <strong>interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/2/0</span>] <strong>ip binding vpn-instance vpnb</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/2/0</span>] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/2/0</span>] <strong>ipv6 address 2001:db8:9::2 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE] <strong>commit</strong></pre>
</p></li><li><span>Establish an MP-IBGP peer relationship between the PEs and BGP4+ peer relationships between PE1 and CE1 and between PE1 and CE2.</span><p><p>For configuration details, see <a href="#EN-US_TASK_0172369734__example1010854147214051">Configuration Files</a> in this section.</p>
<p>After the configuration is complete, run the <strong>display bgp vpnv6 all peer</strong> command on PE1. The command output shows that an IBGP peer relationship has been established between PE1 and PE2 and that EBGP peer relationships have been established between PE1 and CE1 and between PE1 and CE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display bgp vpnv6 all peer</strong></pre>
<pre class="screen"> BGP local router ID : 172.16.1.1
 Local AS number : 100
 Total number of peers : 3                 Peers in established state : 3

  Peer            V          AS  MsgRcvd  MsgSent  OutQ  Up/Down       State  PrefRcv
  2.2.2.2         4         100      140      146     0 01:57:45 <strong>Established</strong>     0

  Peer of IPv6-family for vpn instance :

  VPN-Instance vpna :
  Peer            V          AS  MsgRcvd  MsgSent  OutQ  Up/Down       State  PrefRcv
  2001:db8:1::1   4       65410       11      334     0 00:05:42 <strong>Established</strong>     2
  VPN-Instance vpnb :
  Peer            V          AS  MsgRcvd  MsgSent  OutQ  Up/Down       State  PrefRcv
  2001:db8:2::1   4       65420        6      336     0 00:01:37 <strong>Established</strong>     2</pre>
</p></li><li><span>Configure the OSPF multi-VPN-instance on PE2 and the MCE.</span><p><p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>ospfv3 100 vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospfv3-100] <strong>import-route bgp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospfv3-100]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface GigabitEthernet<span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>] <strong>ospfv3 100 area 1 instance 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>ospfv3 200 vpn-instance vpnb</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospfv3-100] <strong>import-route bgp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospfv3-100]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface GigabitEthernet<span>0/3/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/3/0</span>] <strong>ospfv3 200 area 2 instance 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/3/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>ipv6-family vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-6-vpna] <strong>import-route ospfv3 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-6-vpna] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>ipv6-family vpn-instance vpnb</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-6-vpnb] <strong>import-route ospfv3 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-6-vpnb] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure the MCE.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>MCE]<strong> ospfv3 100 vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-ospfv3-100]<strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE] <strong>interface GigabitEthernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/1/0</span>] <strong>ospfv3 100 area 1 instance 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE] <strong>ospfv3 200 vpn-instance vpnb</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-ospfv3-200]<strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE] <strong>interface GigabitEthernet<span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/2/0</span>] <strong>ospfv3 200 area 2 instance 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE] <strong>commit</strong></pre>
</p></li><li><span>Disable routing loop detection on the MCE, and import RIPng routes destined for the VPN sites.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>MCE] <strong>ospfv3 100 vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-ospfv3-100] <strong>vpn-instance-capability simple</strong>
Warning: This operation may cause a routing loop. Continue? [Y/N]:Y</pre>
<pre class="screen">[<span class="keyword">*</span>MCE-ospfv3-100] <strong>import-route ripng 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-ospfv3-100] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE] <strong>ospfv3 200 vpn-instance vpnb</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-ospfv3-200] <strong>vpn-instance-capability simple</strong>
Warning: This operation may cause a routing loop. Continue? [Y/N]:Y</pre>
<pre class="screen">[<span class="keyword">*</span>MCE-ospfv3-200] <strong>import-route ripng 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-ospfv3-200] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>MCE-ospfv3-200] <strong>quit</strong></pre>
</p></li><li><span>Configure RIPng on the MCE to import the VPN routes of sites 3 and 4.</span><p><p># Configure the MCE.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>MCE] <strong>ripng 100 vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-ripng-100] <strong>import-route ospfv3 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-ripng-100] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE] <strong>interface GigabitEthernet<span>0/3/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/3/0</span>] <strong>ripng 100 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/3/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE]<strong> ripng 200 vpn-instance vpnb</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-rip-200] <strong>import-route ospfv3 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-rip-200] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE] <strong>interface GigabitEthernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/1/1</span>] <strong>ripng 200 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>MCE] <strong>commit</strong></pre>
</p></li><li><span>Configure RIPng on <span class="keyword">Device</span> A and <span class="keyword">Device</span> B to implement interworking with the MCE.</span><p><p># Configure <span class="keyword">Device</span> A.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>A</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> ripng 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ripng-100] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface GigabitEthernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>ripng 100 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface Loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack1] <strong>ripng 100 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span> B.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>B</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ripng 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ripng-200] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface GigabitEthernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>ripng 200 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface Loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1] <strong>ripng 200 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Run the <strong>display ipv6 routing-table</strong> <strong>vpn-instance</strong> command on the MCE to view the routes to the peer CEs.</p>
<p>The following example uses vpna.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>MCE] <strong>display ipv6 routing-table vpn-instance vpna</strong></pre>
<pre class="screen">Routing Table : vpna
         Destinations : 8        Routes : 8

Destination  : 2001:db8:11::1                          PrefixLength : 128
NextHop      : FE80::3A00:10FF:FE03:107                Preference   : 150
Cost         : 1                                       Protocol     : OSPFv3ASE
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : GigabitEthernet<span>0/1/0</span>                    Flags        : D

Destination  : 2001:db8:13::3                          PrefixLength : 128
NextHop      : FE80::2200:10FF:FE03:0                  Preference   : 100
Cost         : 1                                       Protocol     : RIPng
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : GigabitEthernet<span>0/3/0</span>                    Flags        : D

Destination  : 2001:db8:8::                            PrefixLength : 64
NextHop      : 2001:db8:8::2                           Preference   : 0
Cost         : 0                                       Protocol     : Direct
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : GigabitEthernet<span>0/1/0</span>                    Flags        : D

Destination  : 2001:db8:8::2                           PrefixLength : 128
NextHop      : ::1                                     Preference   : 0
Cost         : 0                                       Protocol     : Direct
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : GigabitEthernet<span>0/1/0</span>                    Flags        : D

Destination  : 2001:db8:1::                            PrefixLength : 64
NextHop      : FE80::3A00:10FF:FE03:107                Preference   : 150
Cost         : 1                                       Protocol     : OSPFv3ASE
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : GigabitEthernet<span>0/1/0</span>                    Flags        : D

Destination  : 2001:db8:3::                            PrefixLength : 64
NextHop      : 2001:db8:3::2                           Preference   : 0
Cost         : 0                                       Protocol     : Direct
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : GigabitEthernet<span>0/3/0</span>                    Flags        : D

Destination  : 2001:db8:3::2                           PrefixLength : 128
NextHop      : ::1                                     Preference   : 0
Cost         : 0                                       Protocol     : Direct
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : GigabitEthernet<span>0/3/0</span>                    Flags        : D

Destination  : FE80::                                  PrefixLength : 10
NextHop      : ::                                      Preference   : 0
Cost         : 0                                       Protocol     : Direct
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : NULL0                                   Flags        : D</pre>
<p>Run the <a href="cmdqueryname=display+ipv6+routing-table"><b><span class="cmdname">display ipv6 routing-table</span></b></a> <strong><span>vpn-instance</span></strong> command on the PEs to check for routes to the peer sites.</p>
<p>The following example uses vpna on PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display ipv6 routing-table vpn-instance vpna</strong></pre>
<pre class="screen">Routing Table : vpna
         Destinations : 7        Routes : 7

Destination  : 2001:db8:11::1                          PrefixLength : 128
NextHop      : 2001:db8:1::1                           Preference   : 255
Cost         : 0                                       Protocol     : EBGP
RelayNextHop : 2001:db8:1::1                           TunnelID     : 0x0
Interface    : GigabitEthernet<span>0/1/0</span>                    Flags        : RD

Destination  : 2001:db8:13::3                          PrefixLength : 128
NextHop      : ::FFFF:2.2.2.2                          Preference   : 255
Cost         : 2                                       Protocol     : IBGP
RelayNextHop : --                                      TunnelID     : LDP LSP
Interface    : LDP LSP                                 Flags        : RD

Destination  : 2001:db8:8::                            PrefixLength : 64
NextHop      : ::FFFF:2.2.2.2                          Preference   : 255
Cost         : 2                                       Protocol     : IBGP
RelayNextHop : --                                      TunnelID     : LDP LSP
Interface    : LDP LSP                                 Flags        : RD

Destination  : 2001:db8:1::                            PrefixLength : 64
NextHop      : 2001:db8:1::2                           Preference   : 0
Cost         : 0                                       Protocol     : Direct
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : GigabitEthernet<span>0/1/0</span>                    Flags        : D

Destination  : 2001:db8:1::2                           PrefixLength : 128
NextHop      : ::1                                     Preference   : 0
Cost         : 0                                       Protocol     : Direct
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : GigabitEthernet<span>0/1/0</span>                    Flags        : D

Destination  : 2001:db8:3::                            PrefixLength : 64
NextHop      : ::FFFF:2.2.2.2                          Preference   : 255
Cost         : 2                                       Protocol     : IBGP
RelayNextHop : --                                      TunnelID     : LDP LSP
Interface    : LDP LSP                                 Flags        : RD

Destination  : FE80::                                  PrefixLength : 10
NextHop      : ::                                      Preference   : 0
Cost         : 0                                       Protocol     : Direct
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : NULL0                                   Flags        : D</pre>
<p># Run the <a href="cmdqueryname=ping"><b><span class="cmdname">ping</span></b></a> command on the CEs to view the connectivity between CE1 and <span class="keyword">Device</span> A, and between CE2 and <span class="keyword">Device</span> B.</p>
<p>The following example uses the command output on CE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong>ping ipv6 -a 2001:db8:11::1 2001:db8:13::3</strong></pre>
<pre class="screen">  PING 2001:db8:13::3 : 56  data bytes, press CTRL_C to break
    Reply from 2001:db8:13::3
    bytes=56 Sequence=1 hop limit=61 time=26 ms
    Reply from 2001:db8:13::3
    bytes=56 Sequence=2 hop limit=61 time=2 ms
    Reply from 2001:db8:13::3
    bytes=56 Sequence=3 hop limit=61 time=2 ms
    Reply from 2001:db8:13::3
    bytes=56 Sequence=4 hop limit=61 time=2 ms
    Reply from 2001:db8:13::3
    bytes=56 Sequence=5 hop limit=61 time=123 ms

  ---2001:db8:13::3 ping statistics---
    5 packet(s) transmitted
    5 packet(s) received
    0.00% packet loss
    round-trip min/avg/max=2/31/123 ms</pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172369734__example1010854147214051"><a name="EN-US_TASK_0172369734__example1010854147214051"></a><a name="example1010854147214051"></a><a name="EN-US_TASK_0172369734__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>CE1 configuration file</p>
<pre class="screen">#
sysname CE1
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:1::1/64
#
interface LoopBack1
 ipv6 enable
 ipv6 address 2001:db8:11::1/128
#
bgp 65410
 router-id 1.1.1.1
 peer 2001:db8:1::2 as-number 100
 #
 ipv6-family unicast
  undo synchronization
  import-route direct
  peer 2001:db8:1::2 enable
#
return</pre>
</li><li><p>CE2 configuration file</p>
<pre class="screen">#
sysname CE2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:2::1/64
#
interface LoopBack1
 ipv6 enable
 ipv6 address 2001:db8:12::2/128
#
bgp 65420
 router-id 2.2.2.2
 peer 2001:db8:2::2 as-number 100
 #
 ipv6-family unicast
  undo synchronization
  import-route direct
  peer 2001:db8:2::2 enable
#
return </pre>
</li><li><p>PE1 configuration file</p>
<pre class="screen">#
sysname PE1
#
ip vpn-instance vpna
 ipv6-family
  route-distinguisher 100:1
  apply-label per-instance
  vpn-target 111:1 export-extcommunity
  vpn-target 111:1 import-extcommunity
#
ip vpn-instance vpnb
 ipv6-family
  route-distinguisher 100:2
  apply-label per-instance
  vpn-target 222:2 export-extcommunity
  vpn-target 222:2 import-extcommunity
#
mpls lsr-id 1.1.1.1
#
mpls
#
mpls ldp
 #
 ipv4-family
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip binding vpn-instance vpna
 ipv6 enable
 ipv6 address 2001:db8:1::2/64
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip binding vpn-instance vpnb
 ipv6 enable
 ipv6 address 2001:db8:2::2/64
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 ip address 172.16.1.1 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 1.1.1.1 255.255.255.255
#
bgp 100
 peer 2.2.2.2 as-number 100
 peer 2.2.2.2 connect-interface LoopBack1
 #
 ipv4-family unicast
  undo synchronization
  peer 2.2.2.2 enable
 #
 ipv6-family vpnv6
  policy vpn-target
  peer 2.2.2.2 enable
 #
 ipv6-family vpn-instance vpna
  peer 2001:db8:1::1 as-number 65410
 #
 ipv6-family vpn-instance vpnb
  peer 2001:db8:2::1 as-number 65420
#
ospf 1
 area 0.0.0.0
  network 1.1.1.1 0.0.0.0
  network 172.16.1.0 0.0.0.255
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2
#
ip vpn-instance vpna
 ipv6-family
  route-distinguisher 200:1
  apply-label per-instance
  vpn-target 111:1 export-extcommunity
  vpn-target 111:1 import-extcommunity
#
ip vpn-instance vpnb
 ipv6-family
  route-distinguisher 200:2
  apply-label per-instance
  vpn-target 222:2 export-extcommunity
  vpn-target 222:2 import-extcommunity
#
mpls lsr-id 2.2.2.2
#
mpls
#
mpls ldp
 #
 ipv4-family
#
ospfv3 100 vpn-instance vpna
 router-id 5.5.5.5
 import-route bgp
 area 0.0.0.1
#
ospfv3 200 vpn-instance vpnb
 router-id 6.6.6.6
 import-route bgp
 area 0.0.0.2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 172.16.1.2 255.255.255.0
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip binding vpn-instance vpna
 ipv6 enable
 ipv6 address 2001:db8:8::1/64
 ospfv3 100 area 0.0.0.1 instance 1
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 ip binding vpn-instance vpnb
 ipv6 enable
 ipv6 address 2001:db8:9::1/64
 ospfv3 200 area 0.0.0.2 instance 2
#
interface LoopBack1
 ip address 2.2.2.2 255.255.255.255
#
bgp 100
 peer 1.1.1.1 as-number 100
 peer 1.1.1.1 connect-interface LoopBack1
 #
 ipv4-family unicast
  undo synchronization
  peer 1.1.1.1 enable
 #
 ipv4-family vpnv4
  policy vpn-target
  peer 1.1.1.1 enable
 #
 ipv6-family vpnv6
  policy vpn-target
  peer 1.1.1.1 enable
 #
 ipv6-family vpn-instance vpna
  import-route ospfv3 100
 #
 ipv6-family vpn-instance vpnb
  import-route ospfv3 200
#
ospf 1
 area 0.0.0.0
  network 2.2.2.2 0.0.0.0
  network 172.16.1.0 0.0.0.255
#
return</pre>
</li><li><p>MCE configuration file</p>
<pre class="screen">#
sysname MCE
#
ip vpn-instance vpna
 ipv6-family
  route-distinguisher 100:1
  apply-label per-instance
#
ip vpn-instance vpnb
 ipv6-family
  route-distinguisher 200:2
  apply-label per-instance
#
ospfv3 100 vpn-instance vpna
 router-id 7.7.7.7
 vpn-instance-capability simple
 import-route ripng 100
 area 0.0.0.1
#
ospfv3 200 vpn-instance vpnb
 router-id 8.8.8.8
 vpn-instance-capability simple
 import-route ripng 200
 area 0.0.0.2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip binding vpn-instance vpna
 ipv6 enable
 ipv6 address 2001:db8:8::2/64
 ospfv3 100 area 0.0.0.1 instance 1
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip binding vpn-instance vpnb
 ipv6 enable
 ipv6 address 2001:db8:9::2/64
 ospfv3 200 area 0.0.0.2 instance 2
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 ip binding vpn-instance vpna
 ipv6 enable
 ipv6 address 2001:db8:3::2/64
 ripng 100 enable
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip binding vpn-instance vpnb
 ipv6 enable
 ipv6 address 2001:db8:4::2/64
 ripng 200 enable
#
ripng 100 vpn-instance vpna
 import-route ospfv3 100
#
ripng 200 vpn-instance vpnb
 import-route ospfv3 200
#
return</pre>
</li><li><p><span class="keyword">Device</span> A configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>A
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:3::1/64
 ripng 100 enable
#
interface LoopBack1
 ipv6 enable
 ipv6 address 2001:db8:13::3/128
 ripng 100 enable
#
ripng 100
#
return</pre>
</li><li><p><span class="keyword">Device</span> B configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>B
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:4::1/64
 ripng 200 enable
#
interface LoopBack1
 ipv6 enable
 ipv6 address 2001:db8:14::4/128
 ripng 200 enable
#
ripng 200
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2039.html">Configuration Examples for BGP/MPLS IPv6 VPN
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2111.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2044.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>