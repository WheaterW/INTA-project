
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Inter-AS LDP VPLS Option C">
<meta name="abstract" content="In inter-AS LDP VPLS Option C, ASBRs do not need to maintain inter-AS LDP VPLS information or reserve interfaces for inter-AS LDP VPLS PWs. As LDP VPLS information is exchanged only between PEs, this solution requires few resources and is easy to deploy.">
<meta name="description" content="In inter-AS LDP VPLS Option C, ASBRs do not need to maintain inter-AS LDP VPLS information or reserve interfaces for inter-AS LDP VPLS PWs. As LDP VPLS information is exchanged only between PEs, this solution requires few resources and is easy to deploy.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_6023.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_6024.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_6016.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,vpls,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00415692">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00425560">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172370136">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Inter-AS LDP VPLS Option C</title>
</head>
<body><a name="EN-US_TASK_0172370136"></a><a name="EN-US_TASK_0172370136"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Inter-AS LDP VPLS Option C</h1>
<div class="taskbody"><p>In inter-AS LDP VPLS Option C, ASBRs do not need to maintain inter-AS LDP VPLS information or reserve interfaces for inter-AS LDP VPLS PWs. As LDP VPLS information is exchanged only between PEs, this solution requires few resources and is easy to deploy.</p>
<div class="steps"><a name="EN-US_TASK_0172370136__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure the capability to exchange labeled IPv4 routes.</span><p><div class="p"><ul><li>Perform the following steps on each PE:<ol type="a"><li>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p>The system view is displayed.</p>
</li><li>Run <span><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p>The BGP view is displayed.</p>
</li><li>Run <span><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>label-route-capability</span></strong></span><p>The capability to exchange labeled IPv4 routes with the local ASBR is configured.</p>
</li><li>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p>The configuration is committed.</p>
</li></ol>
</li><li>Perform the following steps on each ASBR:<ol type="a"><li>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p>The system view is displayed.</p>
</li><li>Run <span><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span><p>The view of the interface connecting to the peer ASBR is displayed.</p>
</li><li>Run <span><a href="cmdqueryname=ip+address"><b><span class="cmdname">ip address</span></b></a> <i><span class="varname">ip-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> }</span><p>An IP address is configured for the interface.</p>
</li><li>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p>Return to the system view.</p>
</li><li>Run <span><a href="cmdqueryname=mpls"><b><span class="cmdname">mpls</span></b></a></span><p>MPLS is enabled.</p>
</li><li>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p>Return to the system view.</p>
</li><li>Run <span><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p>The BGP view is displayed.</p>
</li><li>Run <span><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>label-route-capability</span></strong></span><p>The capability to exchange labeled IPv4 routes with the local PE is configured.</p>
</li><li>Run <span><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>as-number</span></strong> <i><span class="varname">as-number</span></i></span><p>The peer ASBR is configured as an EBGP peer.</p>
</li><li>Run <span><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>label-route-capability</span></strong></span><p>The capability to exchange labeled IPv4 routes with the peer ASBR is configured.</p>
<p>In inter-AS LDP VPLS Option C, an inter-AS LSP must be established and the public network routes advertised between PEs and ASBRs carry MPLS labels.</p>
<p>An EBGP peer relationship must be established between ASBRs in different ASs for them to exchange labeled IPv4 routes.</p>
<p>The public network routes carrying MPLS labels are advertised through MP-BGP. According to relevant standards, label mappings about routes can be piggybacked inside the BGP Update messages that are used to advertise these routes. This feature is implemented through an extended BGP attribute, which enables BGP peers to process labeled IPv4 routes.</p>
</li><li>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p>The configuration is committed.</p>
</li></ol>
</li></ul>
</div>
</p></li><li><span>Configure routing policies on each ASBR, so that an ASBR reallocates MPLS labels to the labeled IPv4 routes to be advertised to the local PE and allocates MPLS labels to the routes to be advertised to the peer ASBR.</span><p><p>ASBRs allocate MPLS labels to IPv4 routes based on the configured routing policies.</p>
<p>Perform the following steps on each ASBR:</p>
</p><ol type="a"><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=route-policy"><b><span class="cmdname">route-policy</span></b></a> <i><span class="varname">policy-name1</span></i> <strong><span>permit</span></strong> <strong><span>node</span></strong> <i><span class="varname">seq-number</span></i></span></span><p><p>A routing policy applicable to the local PE is created.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=if-match+mpls-label"><b><span class="cmdname">if-match mpls-label</span></b></a></span></span><p><p>Filtering out labeled IPv4 routes is configured as a matching rule for the routing policy.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=apply+mpls-label"><b><span class="cmdname">apply mpls-label</span></b></a></span></span><p><p>Allocating MPLS labels to IPv4 routes is configured as an action for the routing policy.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=route-policy"><b><span class="cmdname">route-policy</span></b></a> <i><span class="varname">policy-name2</span></i> <strong><span>permit</span></strong> <strong><span>node</span></strong> <i><span class="varname">seq-number</span></i></span></span><p><p>A routing policy applicable to the peer ASBR is created.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=apply+mpls-label"><b><span class="cmdname">apply mpls-label</span></b></a></span></span><p><p>Allocating MPLS labels to IPv4 routes is configured as an action for the routing policy.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>route-policy</span></strong> <i><span class="varname">policy-name1</span></i> <strong><span>export</span></strong></span></span><p><p>The routing policy applicable to the local PE is applied.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>route-policy</span></strong> <i><span class="varname">policy-name2</span></i> <strong><span>export</span></strong></span></span><p><p>The routing policy applicable to the peer ASBR is applied.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Establish a remote MPLS LDP session between the PEs in different ASs, so that the PEs can exchange PW information.</span><p><div class="p"><ul><li>Perform the following steps on each ASBR:<ol type="a"><li>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p>The system view is displayed.</p>
</li><li>Run <span><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p>The BGP view is displayed.</p>
</li><li>Run <span><a href="cmdqueryname=network"><b><span class="cmdname">network</span></b></a> <i><span class="varname">ip-address</span></i> [ <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> ] [ <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> ]</span><p>The capability to advertise the local PE's loopback interface address used for BGP sessions to the peer ASBR is configured.</p>
</li><li>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p>Return to the system view.</p>
</li><li>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p>The configuration is committed.</p>
</li></ol>
</li><li>Perform the following steps on each PE:<ol type="a"><li>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p>The system view is displayed.</p>
</li><li>Run <span><a href="cmdqueryname=mpls+ldp+remote-peer"><b><span class="cmdname">mpls ldp remote-peer</span></b></a> <i><span class="varname">peer-name</span></i></span><p>The name of the remote MPLS LDP session is specified.</p>
</li><li>Run <span><a href="cmdqueryname=remote-ip"><b><span class="cmdname">remote-ip</span></b></a> <i><span class="varname">ip-address</span></i></span><p>The peer IP address of the remote MPLS LDP session is specified.</p>
</li><li>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p>The configuration is committed.</p>
</li></ol>
</li></ul>
</div>
</p></li><li><span>Configure LDP VPLS on each PE. For configuration details, see <a href="dc_vrp_vpls_cfg_5003.html">Configuring LDP VPLS</a>.</span></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_6023.html">Configuring Inter-AS VPLS
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_6024.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_6016.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>