
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a DCI Scenario with EVPN L3VPN over VXLAN Accessing Common L3VPN">
<meta name="abstract" content="This section provides an example for configuring a DCI scenario with EVPN L3VPN over VXLAN accessing common L3VPN. In this example, a DC gateway connects to a PE on the DCI network through a VXLAN tunnel, and a common L3VPN is deployed on the DCI network for DC interconnection.">
<meta name="description" content="This section provides an example for configuring a DCI scenario with EVPN L3VPN over VXLAN accessing common L3VPN. In this example, a DC gateway connects to a PE on the DCI network through a VXLAN tunnel, and a common L3VPN is deployed on the DCI network for DC interconnection.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0010.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dci_cfg_0011.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dci_cfg_0013_IPv6.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00878323">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172363964">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring a DCI Scenario with EVPN L3VPN over VXLAN Accessing Common L3VPN</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172363964"></a><a name="EN-US_TASK_0172363964"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a DCI Scenario with EVPN L3VPN over VXLAN Accessing Common L3VPN</h1>
<div class="taskbody"><p>This section provides an example for configuring a DCI scenario with EVPN L3VPN over VXLAN accessing common L3VPN. In this example, a DC gateway connects to a PE on the DCI network through a VXLAN tunnel, and a common L3VPN is deployed on the DCI network for DC interconnection.</p>
<div class="context"><a name="EN-US_TASK_0172363964__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="dc_vrp_dci_cfg_0013.html#EN-US_TASK_0172363964__fig_dc_vrp_dci_cfg_001301">Figure 1</a>, the DC GWs GW1 and GW2 are connected to the DCI backbone network with BGP/MPLS IP VPN configured. After EVPN and VXLAN tunnels are deployed between the DC GWs and DCI-PEs, VM host IP routes can be exchanged between different DCs, implementing communication between DC A and DC B (for example, communication between VMa1 and VMb2).</p>
<div class="fignone" id="EN-US_TASK_0172363964__fig_dc_vrp_dci_cfg_001301"><a name="EN-US_TASK_0172363964__fig_dc_vrp_dci_cfg_001301"></a><a name="fig_dc_vrp_dci_cfg_001301"></a><span class="figcap"><b>Figure 1 </b>Configuring a DCI scenario with EVPN L3VPN over VXLAN accessing common L3VPN</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent GE <span>0/1/0</span> and GE <span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_dci_cfg_001301.png" width="NaN" height="NaN"></span><br></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Interface IP addresses</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="12.62126212621262%" id="mcps1.4.1.4.2.4.1.1" liSelected="liSelected"><p>Device</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="43.85438543854385%" id="mcps1.4.1.4.2.4.1.2" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="43.52435243524352%" id="mcps1.4.1.4.2.4.1.3" liSelected="liSelected"><p>IP Address</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="4" valign="middle" width="12.62126212621262%" headers="mcps1.4.1.4.2.4.1.1 "><p>DCI-PE1</p>
</td>
<td class="cellrowborder" valign="top" width="43.85438543854385%" headers="mcps1.4.1.4.2.4.1.2 "><p>GigabitEthernet <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="43.52435243524352%" headers="mcps1.4.1.4.2.4.1.3 "><p>192.168.20.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.2 "><p>GigabitEthernet <span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.3 "><p>192.168.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.2 "><p>LoopBack1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.3 "><p>1.1.1.1/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.2 "><p>LoopBack2</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.3 "><p>11.11.11.11/32</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" valign="middle" width="12.62126212621262%" headers="mcps1.4.1.4.2.4.1.1 "><p>RR</p>
</td>
<td class="cellrowborder" valign="top" width="43.85438543854385%" headers="mcps1.4.1.4.2.4.1.2 "><p>GigabitEthernet <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="43.52435243524352%" headers="mcps1.4.1.4.2.4.1.3 "><p>192.168.1.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.2 "><p>GigabitEthernet <span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.3 "><p>192.168.10.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.2 "><p>LoopBack1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.3 "><p>2.2.2.2/32</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="4" valign="middle" width="12.62126212621262%" headers="mcps1.4.1.4.2.4.1.1 "><p>DCI-PE2</p>
</td>
<td class="cellrowborder" valign="top" width="43.85438543854385%" headers="mcps1.4.1.4.2.4.1.2 "><p>GigabitEthernet <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="43.52435243524352%" headers="mcps1.4.1.4.2.4.1.3 "><p>192.168.30.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.2 "><p>GigabitEthernet <span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.3 "><p>192.168.10.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.2 "><p>LoopBack1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.3 "><p>3.3.3.3/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.2 "><p>LoopBack2</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.3 "><p>33.33.33.33/32</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363964__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure OSPF on the DCI backbone network to implement communication between DCI-PEs.</p>
</li><li><p>Configure an MPLS TE tunnel on the DCI backbone network.</p>
</li><li><p>Configure static routes destined for the loopback interface addresses of DC GWs on DCI-PEs.</p>
</li><li><p>Configure an EVPN instance and a BD on each DCI-PE.</p>
</li><li><p>Configure a source address on each DCI-PE.</p>
</li><li><p>Configure VXLAN tunnels between DCI-PEs and DC GWs.</p>
</li><li><p>Configure a VPN instance on each DCI-PE and bind the interface connected to a gateway to the VPN instance.</p>
</li><li><p>Configure an MP-IBGP peer relationship between each DCI-PE and RR to exchange VPNv4 routes and configure RR in the figure as a route reflector.</p>
</li><li><p>Configure route re-origination on each DCI-PE.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363964__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>MPLS LSR IDs of the DCI-PEs and RR</p>
</li><li><p>VPN instance RD</p>
</li><li><p>VPN targets used for route import and export by the VPN instance</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172363964__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure interface IP addresses, including loopback interface addresses, on each node.</span><p><p>For details about how to configure interface IP addresses and masks, see <a href="#EN-US_TASK_0172363964__dc_vrp_dci_cfg_001301">Configuration Files</a>.</p>
</p></li><li><span>Configure an IGP on the DCI backbone network. OSPF is used in this example.</span><p><p>For detailed configurations, see <a href="#EN-US_TASK_0172363964__dc_vrp_dci_cfg_001301">Configuration Files</a>.</p>
</p></li><li><span>Configure a TE tunnel on the DCI backbone network.</span><p><p>For detailed configurations, see <a href="#EN-US_TASK_0172363964__dc_vrp_dci_cfg_001301">Configuration Files</a>.</p>
</p></li><li><span>Configure static routes destined for the loopback interface addresses of DC GWs on DCI-PEs.</span><p><p>For detailed configurations, see <a href="#EN-US_TASK_0172363964__dc_vrp_dci_cfg_001301">Configuration Files</a>.</p>
</p></li><li><span>Configure an EVPN instance and a BD on each DCI-PE.</span><p><p># Configure DCI-PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE1] <strong>evpn vpn-instance evrf1 bd-mode</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-evpn-instance-evrf1] <strong>route-distinguisher 10:1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-evpn-instance-evrf1] <strong>vpn-target 11:1 both</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-evpn-instance-evrf1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1] <strong>bridge-domain 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bd10] <strong>vxlan vni 5010 split-horizon-mode</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bd10] <strong>evpn binding vpn-instance evrf1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bd10] <strong>esi 0000.1111.1111.4444.5555</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bd10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1] <strong>interface GigabitEthernet <span>0/1/0</span>.1 mode l2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>encapsulation qinq</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>bridge-domain 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1] <strong>commit</strong></pre>
<p># Configure DCI-PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE2] <strong>evpn vpn-instance evrf1 bd-mode</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-evpn-instance-evrf1] <strong>route-distinguisher 20:1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-evpn-instance-evrf1] <strong>vpn-target 11:1 both</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-evpn-instance-evrf1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2] <strong>bridge-domain 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bd10] <strong>vxlan vni 5020 split-horizon-mode</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bd10] <strong>evpn binding vpn-instance evrf1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bd10] <strong>esi 0000.1111.3333.4444.5555</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bd10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2] <strong>interface GigabitEthernet <span>0/1/0</span>.1 mode l2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-GigabitEthernet<span>0/1/0</span>.1] <strong>encapsulation qinq</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-GigabitEthernet<span>0/1/0</span>.1] <strong>bridge-domain 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-GigabitEthernet<span>0/1/0</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2] <strong>commit</strong></pre>
</p></li><li><span>Configure a source address on each DCI-PE.</span><p><p># Configure DCI-PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE1] <strong>evpn source-address 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1] <strong>commit</strong></pre>
<p># Configure DCI-PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE2] <strong>evpn source-address 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2] <strong>commit</strong></pre>
</p></li><li><span>Configure a VXLAN tunnel.</span><ol type="a"><li class="substepexpand"><span>Establish an EBGP EVPN peer relationship between each DCI-PE and its connected gateway.</span><p><p># Configure DCI-PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE1] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp] <strong>peer 4.4.4.4 as-number 65410</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp] <strong>peer 4.4.4.4 ebgp-max-hop 255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp] <strong>peer 4.4.4.4 connect-interface loopback 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp] <strong>l2vpn-family evpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-af-evpn] <strong>peer 4.4.4.4 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-af-evpn] <strong>peer 4.4.4.4 advertise encap-type vxlan</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-af-evpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1] <strong>commit</strong></pre>
<p># Configure DCI-PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE2] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp] <strong>peer 5.5.5.5 as-number 65420</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp] <strong>peer 5.5.5.5 ebgp-max-hop 255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp] <strong>peer 5.5.5.5 connect-interface loopback 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp] <strong>l2vpn-family evpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp-af-evpn] <strong>peer 5.5.5.5 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp-af-evpn] <strong>peer 5.5.5.5 advertise encap-type vxlan</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp-af-evpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2] <strong>commit</strong></pre>
</p></li><li class="substepexpand"><span>Configure a VPN instance.</span><p><p># Configure DCI-PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE1] <strong>ip vpn-instance vpn1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-vpn-instance-vpn1] <strong>vxlan vni 555</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-vpn-instance-vpn1] <strong>ipv4-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-vpn-instance-vpn1-af-ipv4] <strong>route-distinguisher 11:11</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-vpn-instance-vpn1-af-ipv4] <strong>vpn-target 1:1 both</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-vpn-instance-vpn1-af-ipv4] <strong>vpn-target 11:1 both evpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-vpn-instance-vpn1-af-ipv4] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-vpn-instance-vpn1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1] <strong>interface Vbdif10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-Vbdif10] <strong>ip binding vpn-instance vpn1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-Vbdif10] <strong>ip address 10.10.10.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-Vbdif10] <strong>arp collect host enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-Vbdif10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1] <strong>commit</strong></pre>
<p># Configure DCI-PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE2] <strong>ip vpn-instance vpn1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-vpn-instance-vpn1] <strong>vxlan vni 555</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-vpn-instance-vpn1] <strong>ipv4-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-vpn-instance-vpn1-af-ipv4] <strong>route-distinguisher 22:22</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-vpn-instance-vpn1-af-ipv4] <strong>vpn-target 1:1 both</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-vpn-instance-vpn1-af-ipv4] <strong>vpn-target 11:1 both evpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-vpn-instance-vpn1-af-ipv4] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-vpn-instance-vpn1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2] <strong>interface Vbdif10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-Vbdif10] <strong>ip binding vpn-instance vpn1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-Vbdif10] <strong>ip address 10.20.10.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-Vbdif10] <strong>arp collect host enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-Vbdif10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2] <strong>commit</strong></pre>
</p></li><li class="substepexpand"><span>Configure an IP address for the source VTEP.</span><p><p># Configure DCI-PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE1] <strong>interface nve 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-Nve1] <strong>source 11.11.11.11</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-Nve1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1] <strong>commit</strong></pre>
<p># Configure DCI-PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE2] <strong>interface nve 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-Nve1] <strong>source 33.33.33.33</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-Nve1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2] <strong>commit</strong></pre>
</p></li></ol>
</li><li><span>Apply a tunnel policy to each VPN instance.</span><p><p># Configure DCI-PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE1] <strong>tunnel-policy te-lsp1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-tunnel-policy-te-lsp1] <strong>tunnel select-seq cr-lsp load-balance-number 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-tunnel-policy-te-lsp1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1] <strong>ip vpn-instance vpn1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-vpn-instance-vpn1] <strong>ipv4-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-vpn-instance-vpn1-af-ipv4] <strong>tnl-policy te-lsp1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-vpn-instance-vpn1-af-ipv4] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-vpn-instance-vpn1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1] <strong>commit</strong></pre>
<p># Configure DCI-PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE2] <strong>tunnel-policy te-lsp1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-tunnel-policy-te-lsp1] <strong>tunnel select-seq cr-lsp load-balance-number 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-tunnel-policy-te-lsp1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2] <strong>ip vpn-instance vpn1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-vpn-instance-vpn1] <strong>ipv4-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-vpn-instance-vpn1-af-ipv4] <strong>tnl-policy te-lsp1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-vpn-instance-vpn1-af-ipv4] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-vpn-instance-vpn1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2] <strong>commit</strong></pre>
</p></li><li><span>Configure an MP-IBGP peer relationship between each DCI-PE and RR to exchange VPNv4 routes and configure RR in the figure as a route reflector.</span><p><p># Configure DCI-PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE1] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp] <strong>peer 2.2.2.2 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp] <strong>peer 2.2.2.2 connect-interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp] <strong>ipv4-family vpnv4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-af-vpnv4] <strong>peer 2.2.2.2 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-af-vpnv4] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1] <strong>commit</strong></pre>
<p># Configure RR.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>RR] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RR-bgp] <strong>peer 1.1.1.1 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RR-bgp] <strong>peer 1.1.1.1 connect-interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RR-bgp] <strong>peer 3.3.3.3 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RR-bgp] <strong>peer 3.3.3.3 connect-interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RR-bgp] <strong>ipv4-family vpnv4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RR-bgp-af-vpnv4] <strong>peer 1.1.1.1 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RR-bgp-af-vpnv4] <strong>peer 1.1.1.1 reflect-client</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RR-bgp-af-vpnv4] <strong>peer 3.3.3.3 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RR-bgp-af-vpnv4] <strong>peer 3.3.3.3 reflect-client</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RR-bgp-af-vpnv4] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RR-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RR] <strong>commit</strong></pre>
<p># Configure DCI-PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE2] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp] <strong>peer 2.2.2.2 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp] <strong>peer 2.2.2.2 connect-interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp] <strong>ipv4-family vpnv4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp-af-vpnv4] <strong>peer 2.2.2.2 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp-af-vpnv4] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2] <strong>commit</strong></pre>
</p></li><li><span>Configure each DCI-PE to advertise the re-originated EVPN routes to VPNv4 peers and to advertise the re-originated VPNv4 routes to EVPN peers.</span><p><p># Configure DCI-PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE1] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp] <strong>l2vpn-family evpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-af-evpn] <strong>peer 4.4.4.4 import reoriginate</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-af-evpn] <strong>peer 4.4.4.4 advertise route-reoriginated vpnv4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-af-evpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp] <strong>ipv4-family vpnv4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-af-vpnv4] <strong>peer 3.3.3.3 advertise route-reoriginated evpn mac-ip</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-af-vpnv4] <strong>peer 3.3.3.3 advertise route-reoriginated evpn ip</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-af-vpnv4] <strong>peer 3.3.3.3 import reoriginate</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-af-vpnv4] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp] <strong>ipv4-family vpn-instance vpn1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-vpn1] <strong>advertise l2vpn evpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-vpn1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1] <strong>commit</strong></pre>
<p># Configure DCI-PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE2] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp] <strong>l2vpn-family evpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-af-evpn] <strong>peer 5.5.5.5 import reoriginate</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-af-evpn] <strong>peer 5.5.5.5 advertise route-reoriginated vpnv4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE1-bgp-af-evpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp] <strong>ipv4-family vpnv4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp-af-vpnv4] <strong>peer 1.1.1.1 import reoriginate</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp-af-vpnv4] <strong>peer 1.1.1.1 advertise route-reoriginated evpn mac-ip</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp-af-vpnv4] <strong>peer 1.1.1.1 advertise route-reoriginated evpn ip</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp-af-vpnv4] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp] <strong>ipv4-family vpn-instance vpn1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp-vpn1] <strong>advertise l2vpn evpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp-vpn1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DCI-PE2] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>Run the <strong>display ip routing-table vpn-instance</strong> command on DCI-PEs. The following example uses the command output on DCI-PE1. The command output shows that DCI-PE1 has a route to the loopback interface of the peer gateway.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE1] <strong>display ip routing-table vpn-instance vpn1</strong></pre>
<pre class="screen"><span class="keyword">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route</span></pre>
<pre class="screen">------------------------------------------------------------------------------
Routing Table : vpn1
         Destinations : 6        Routes : 6         

Destination/Mask    Proto   Pre  Cost        Flags NextHop         Interface

       10.1.1.0/24  EBGP    255  0             RD  4.4.4.4         VXLAN
       10.1.1.1/32  EBGP    255  0             RD  4.4.4.4         VXLAN
      <strong>10.2.1.0/24</strong>  IBGP    255  0             RD  3.3.3.3         Tunnel10
      <strong>10.2.1.1/32</strong>  IBGP    255  0             RD  3.3.3.3         Tunnel10
      127.0.0.0/8   Direct  0    0             D   127.0.0.1       InLoopBack0
255.255.255.255/32  Direct  0    0             D   127.0.0.1       InLoopBack0</pre>
<p>Run the <strong>display vxlan tunnel</strong> command on DCI-PEs to check VXLAN tunnel information. The following example uses the command output on DCI-PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DCI-PE1] <strong>display vxlan tunnel</strong></pre>
<pre class="screen">Number of vxlan tunnel : 1
Tunnel ID   Source                Destination           State  Type     Uptime
-----------------------------------------------------------------------------------
4026531843  11.11.11.11           4.4.4.4               up     dynamic  00:51:23 </pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172363964__dc_vrp_dci_cfg_001301"><a name="EN-US_TASK_0172363964__dc_vrp_dci_cfg_001301"></a><a name="dc_vrp_dci_cfg_001301"></a><a name="EN-US_TASK_0172363964__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>DCI-PE1 configuration file</p>
<pre class="screen">#
sysname DCI-PE1
#
evpn vpn-instance evrf1 bd-mode
 route-distinguisher 10:1
 vpn-target 11:1 export-extcommunity
 vpn-target 11:1 import-extcommunity
#
ip vpn-instance vpn1
 ipv4-family
  route-distinguisher 11:11
<span>  apply-label per-instance</span>
  tnl-policy te-lsp1
  vpn-target 1:1 export-extcommunity
  vpn-target 11:1 export-extcommunity evpn
  vpn-target 1:1 import-extcommunity
  vpn-target 11:1 import-extcommunity evpn
 vxlan vni 555
#
mpls lsr-id 1.1.1.1
#
mpls
 mpls te
 mpls rsvp-te
 mpls te cspf
#
bridge-domain 10
 vxlan vni 5010 split-horizon-mode
 evpn binding vpn-instance evrf1
 esi 0000.1111.1111.4444.5555
#
interface Vbdif10
 ip binding vpn-instance vpn1
 ip address 10.10.10.1 255.255.255.0
 arp collect host enable
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 192.168.20.1 255.255.255.0
#
interface GigabitEthernet<span>0/1/0</span>.1 mode l2
 encapsulation qinq
 bridge-domain 10
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 192.168.1.1 255.255.255.0
 mpls
 mpls te
 mpls rsvp-te
#
interface LoopBack1
 ip address 1.1.1.1 255.255.255.255
 isis enable 1
#
interface LoopBack2
 ip address 11.11.11.11 255.255.255.255
#
interface Nve1
 source 11.11.11.11
#
interface Tunnel10
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 3.3.3.3
 mpls te tunnel-id 100
#
bgp 100
 peer 2.2.2.2 as-number 100
 peer 2.2.2.2 connect-interface LoopBack1
 peer 4.4.4.4 as-number 65410
 peer 4.4.4.4 ebgp-max-hop 255
 peer 4.4.4.4 connect-interface LoopBack2
 #
 ipv4-family unicast
  undo synchronization
  peer 2.2.2.2 enable
  peer 4.4.4.4 enable
 #
 ipv4-family vpnv4
  policy vpn-target
  peer 2.2.2.2 enable
  peer 2.2.2.2 import reoriginate
  peer 2.2.2.2 advertise route-reoriginated evpn mac-ip
  peer 2.2.2.2 advertise route-reoriginated evpn ip
 #
 ipv4-family vpn-instance vpn1
  advertise l2vpn evpn
 #
 l2vpn-family evpn
  undo policy vpn-target
  peer 4.4.4.4 enable
  peer 4.4.4.4 advertise encap-type vxlan
  peer 4.4.4.4 import reoriginate
  peer 4.4.4.4 advertise route-reoriginated vpnv4
#               
ospf 1
 opaque-capability enable
 area 0.0.0.0
  network 1.1.1.1 0.0.0.0
  network 192.168.1.0 0.0.0.255
  mpls-te enable
#
ip route-static 4.4.4.4 255.255.255.255 192.168.20.2
#
tunnel-policy te-lsp1
 tunnel select-seq cr-lsp load-balance-number 1
#
evpn source-address 1.1.1.1
#
return</pre>
</li><li><p>RR configuration file</p>
<pre class="screen">#
sysname RR
#
mpls lsr-id 2.2.2.2
#
mpls
 mpls te
 mpls rsvp-te
 mpls te cspf
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 192.168.1.2 255.255.255.0
 mpls
 mpls te
 mpls rsvp-te
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 192.168.10.1 255.255.255.0
 mpls
 mpls te
 mpls rsvp-te
#
interface LoopBack1
 ip address 2.2.2.2 255.255.255.255
#
bgp 100
 peer 1.1.1.1 as-number 100
 peer 1.1.1.1 connect-interface LoopBack1
 peer 3.3.3.3 as-number 100
<strong> </strong>peer 3.3.3.3 connect-interface LoopBack1
 #
 ipv4-family unicast
  undo synchronization
  peer 1.1.1.1 enable
  peer 3.3.3.3 enable
 #
 ipv4-family vpnv4
  undo policy vpn-target
  peer 1.1.1.1 enable
  peer 1.1.1.1 reflect-client
  peer 3.3.3.3 enable
  peer 3.3.3.3 reflect-client
#
ospf 1
 opaque-capability enable
 area 0.0.0.0
  network 2.2.2.2 0.0.0.0
  network 192.168.1.0 0.0.0.255
  network 192.168.10.0 0.0.0.255
  mpls-te enable
#
return</pre>
</li><li><p>DCI-PE2 configuration file</p>
<pre class="screen">#
sysname DCI-PE2
#
evpn vpn-instance evrf1 bd-mode
 route-distinguisher 20:1
 vpn-target 11:1 export-extcommunity
 vpn-target 11:1 import-extcommunity
#
ip vpn-instance vpn1
 ipv4-family
  route-distinguisher 22:22
<span>  apply-label per-instance</span>
  tnl-policy te-lsp1
  vpn-target 1:1 export-extcommunity
  vpn-target 11:1 export-extcommunity evpn
  vpn-target 1:1 import-extcommunity
  vpn-target 11:1 import-extcommunity evpn
 vxlan vni 555
#
mpls lsr-id 3.3.3.3
#
mpls
 mpls te
 mpls rsvp-te
 mpls te cspf
#
bridge-domain 10
 vxlan vni 5020 split-horizon-mode
 evpn binding vpn-instance evrf1
 esi 0000.1111.3333.4444.5555
#
interface Vbdif10
 ip binding vpn-instance vpn1
 ip address 10.20.10.1 255.255.255.0
 arp collect host enable
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 192.168.30.1 255.255.255.0
#
interface GigabitEthernet<span>0/1/0</span>.1 mode l2
 encapsulation qinq
 bridge-domain 10
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 192.168.10.2 255.255.255.0
 mpls
 mpls te        
 mpls rsvp-te
#
interface LoopBack1
 ip address 3.3.3.3 255.255.255.255
 isis enable 1
#
interface LoopBack2
 ip address 33.33.33.33 255.255.255.255
#
interface Nve1
 source 33.33.33.33
#
interface Tunnel10
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 1.1.1.1
 mpls te tunnel-id 100
#
bgp 100
 peer 2.2.2.2 as-number 100
 peer 2.2.2.2 connect-interface LoopBack1
 peer 5.5.5.5 as-number 65420
 peer 5.5.5.5 ebgp-max-hop 255
 peer 5.5.5.5 connect-interface LoopBack2
 #
 ipv4-family unicast
  undo synchronization
  peer 2.2.2.2 enable
  peer 5.5.5.5 enable
 #
 ipv4-family vpnv4
  policy vpn-target
  peer 2.2.2.2 enable
  peer 2.2.2.2 import reoriginate
  peer 2.2.2.2 advertise route-reoriginated evpn mac-ip
  peer 2.2.2.2 advertise route-reoriginated evpn ip
 #
 ipv4-family vpn-instance vpn1
  advertise l2vpn evpn
 #
 l2vpn-family evpn
  undo policy vpn-target
  peer 5.5.5.5 enable
  peer 5.5.5.5 advertise encap-type vxlan
  peer 5.5.5.5 import reoriginate
  peer 5.5.5.5 advertise route-reoriginated vpnv4
#               
ospf 1
 opaque-capability enable
 area 0.0.0.0
  network 3.3.3.3 0.0.0.0
  network 192.168.10.0 0.0.0.255
  mpls-te enable
#
ip route-static 5.5.5.5 255.255.255.255 192.168.30.2
#
tunnel-policy te-lsp1
 tunnel select-seq cr-lsp load-balance-number 1
#
evpn source-address 3.3.3.3
#
return</pre>
</li><li><p>GW1 configuration file</p>
<p>See the configuration file of a DC device.</p>
</li><li><p>Device1 configuration file</p>
<p>See the configuration file of a DC device.</p>
</li><li><p>Device2 configuration file</p>
<p>See the configuration file of a DC device.</p>
</li><li><p>GW2 configuration file</p>
<p>See the configuration file of a DC device.</p>
</li><li><p>Device3 configuration file</p>
<p>See the configuration file of a DC device.</p>
</li><li><p>Device4 configuration file</p>
<p>See the configuration file of a DC device.</p>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0010.html">EVPN Configuration Examples
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dci_cfg_0011.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dci_cfg_0013_IPv6.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>