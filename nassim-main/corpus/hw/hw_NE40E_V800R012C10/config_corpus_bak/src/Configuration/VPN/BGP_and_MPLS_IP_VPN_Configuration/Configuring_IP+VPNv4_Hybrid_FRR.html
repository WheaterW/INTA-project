
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring IP+VPNv4 Hybrid FRR">
<meta name="abstract" content="This section describes how to configure IP+VPNv4 hybrid FRR. On a network where a CE is dual-homed to two PEs, if the link between the master PE and the CE is unreachable, the master PE switches traffic to the link between the backup PE and the CE for transmission. IP+VPNv4 hybrid FRR improves network reliability.">
<meta name="description" content="This section describes how to configure IP+VPNv4 hybrid FRR. On a network where a CE is dual-homed to two PEs, if the link between the master PE and the CE is unreachable, the master PE switches traffic to the link between the backup PE and the CE for transmission. IP+VPNv4 hybrid FRR improves network reliability.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_2012.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_2016.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,l3vpnvrp,w00556928,l00468467,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="h00847023">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00847023">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369425">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring IP+VPNv4 Hybrid FRR</title>
</head>
<body><a name="EN-US_TASK_0172369425"></a><a name="EN-US_TASK_0172369425"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring IP+VPNv4 Hybrid FRR</h1>
<div class="taskbody"><p>This section describes how to configure IP+VPNv4 hybrid FRR. On a network where a CE is dual-homed to two PEs, if the link between the master PE and the CE is unreachable, the master PE switches traffic to the link between the backup PE and the CE for transmission. IP+VPNv4 hybrid FRR improves network reliability.</p>
<div class="context"><a name="EN-US_TASK_0172369425__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>IP+VPNv4 hybrid FRR can quickly switch traffic from a PE to another PE that serves as the backup next hop if the primary route to a CE is unreachable.</p>
<p>A PE learns VPN routes with the same prefix from a CE and other PEs. In this situation, IP+VPNv4 hybrid FRR can be configured on the PE. After being enabled with IP+VPNv4 hybrid FRR, the PE generates a primary route and a backup route to the VPN prefix. If the link between the PE and CE fails, the traffic quickly switches to the backup next hop (backup PE).</p>
<p>On the network shown in <a href="dc_vrp_mpls-l3vpn-v4_cfg_2013.html#EN-US_TASK_0172369425__fig_dc_vrp_mpls-l3vpn-v4_cfg_201301">Figure 1</a>, in normal situations, PE1 selects Link_A to forward traffic to the CE and uses Link_B as the backup link. If PE2 detects that the route to the CE is unreachable, it immediately switches traffic to Link_B and performs VPN route convergence, minimizing the impact on VPN services.</p>
<div class="fignone" id="EN-US_TASK_0172369425__fig_dc_vrp_mpls-l3vpn-v4_cfg_201301"><a name="EN-US_TASK_0172369425__fig_dc_vrp_mpls-l3vpn-v4_cfg_201301"></a><a name="fig_dc_vrp_mpls-l3vpn-v4_cfg_201301"></a><span class="figcap"><b>Figure 1 </b>IP+VPNv4 hybrid FRR</span><br><span><img class="vsd" src="images/fig_dc_vrp_mpls-l3vpn-v4_cfg_201301.png"></span></div>
<p>At present, the <span class="keyword">NE40E</span> supports the following IP+VPNv4 hybrid FRR modes:</p>
<ul><li><p>VPN IP FRR: applies to the networking where a non-BGP routing protocol runs between the PEs and CE.</p>
</li><li><p>VPN BGP auto FRR: applies to the networking where BGP runs between the PEs and CE.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369425__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring IP+VPNv4 hybrid FRR, complete the following tasks:</p>
<ul><li><p>Configure a BGP/MPLS IP VPN.</p>
</li><li><p>Configure a PE to learn IP routes with the same prefix from a CE and other VPNv4 peers.</p>
</li></ul>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172369425__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure VPN IP FRR.</span><ol><li><span>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</span></li><li><span>Run the <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i> command to enter the VPN instance view.</span></li><li><span>Run the <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a> command to enter the VPN instance IPv4 address family view.</span></li><li><span>Run the <a href="cmdqueryname=ip+frr"><b><span class="cmdname">ip frr</span></b></a> command to enable VPN IP FRR.</span></li><li><span>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</span></li></ol>
</li><li><span>Configure VPN BGP auto FRR.</span><ol><li class="substepexpand"><span>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</span></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i> command to enter the BGP view.</span></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a> <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> command to enter the BGP VPN instance IPv4 address family view.</span></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=auto-frr"><b><span class="cmdname">auto-frr</span></b></a> command to enable BGP auto FRR.</span></li><li class="substepexpand"><span>(Optional) Run the <a href="cmdqueryname=route-select+delay"><b><span class="cmdname">route-select delay</span></b></a> <i><span class="varname">delay-value</span></i> command to configure a route selection delay. Delayed route selection ensures that after the primary path recovers, the device on the primary path performs route selection only after the corresponding forwarding entries on the device are stable. This prevents traffic loss during traffic switchback.</span><p></p></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</span></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0000.html">BGP/MPLS IP VPN Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_2012.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_2016.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>