
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring 6VPE">
<meta name="abstract" content="With the 6VPE function, separate IPv6 networks belonging to the same VPN instance can be connected using an LSP.">
<meta name="description" content="With the 6VPE function, separate IPv6 networks belonging to the same VPN instance can be connected using an LSP.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2039.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2046.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2123.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,l3vpnvrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="h00847023">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00415692">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369750">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring 6VPE</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172369750"></a><a name="EN-US_TASK_0172369750"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring 6VPE</h1>
<div class="taskbody"><p>With the 6VPE function, separate IPv6 networks belonging to the same VPN instance can be connected using an LSP.</p>
<div class="context"><a name="EN-US_TASK_0172369750__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0172369750__fig_dc_vrp_mpls-l3vpn-v6_cfg_211901">Figure 1</a>, CE1 and CE2 belong to a VPN instance named vpna. If you want to implement communication between the IPv6 networks belong to vpna through an IPv4 network and shield the VPN IPv6 routes on the PEs over the IPv4 network, you can configure the 6VPE function.</p>
<div class="fignone" id="EN-US_TASK_0172369750__fig_dc_vrp_mpls-l3vpn-v6_cfg_211901"><a name="EN-US_TASK_0172369750__fig_dc_vrp_mpls-l3vpn-v6_cfg_211901"></a><a name="fig_dc_vrp_mpls-l3vpn-v6_cfg_211901"></a><span class="figcap"><b>Figure 1 </b>Networking diagram for configuring 6VPE</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent GE<span>0/1/0</span> and GE<span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_mpls-l3vpn-v6_cfg_211901.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369750__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure an IGP over the IPv4 backbone network to implement communication between PEs.</p>
</li><li><p>Configure MPLS and MPLS LDP on each PE and the P to establish an LDP LSP between the PEs.</p>
</li><li><p>Configure MP-IBGP on PE1 and PE2 to enable PEs to exchange IPv6 VPN routing information through BGP.</p>
</li><li><p>Configure a VPN instance that supports the IPv4 and IPv6 address families on each PE and bind the VPN instance to the PE interface connecting to a CE.</p>
</li><li><p>Configure BGP VPN peer relationships between PEs and CEs (tunnel forwarding).</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369750__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>AS numbers of PEs and CEs</p>
</li><li><p>VPN instance name</p>
</li><li><p>Attributes of the VPN instance IPv4 and IPv6 address families, such as RDs and VPN targets</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172369750__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IPv4 address and IPv6 address to each device interface.</span><p><p>For configuration details, see <a href="#EN-US_TASK_0172369750__file1">Configuration Files</a> in this section.</p>
</p></li><li><span>Configure an IGP over the IPv4 backbone network to implement communication between PEs. IS-IS is used in this example.</span><p><p>For configuration details, see <a href="#EN-US_TASK_0172369750__file1">Configuration Files</a> in this section.</p>
</p></li><li><span>Enable MPLS and MPLS LDP on each device and device interface over the IPv4 backbone network. Create an LDP LSP between PE1 and PE2.</span><p><p>For configuration details, see <a href="#EN-US_TASK_0172369750__file1">Configuration Files</a> in this section.</p>
</p></li><li><span>Set up a BGP VPNv6 peer relationship between the PEs.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>peer 3.3.3.9 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp]<strong> peer 3.3.3.9 connect-interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>ipv6-family vpnv6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-af-vpnv6] <strong>peer 3.3.3.9 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-af-vpnv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>peer 1.1.1.9 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp]<strong> peer 1.1.1.9 connect-interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>ipv6-family vpnv6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-af-vpnv6] <strong>peer 1.1.1.9 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-af-vpnv6]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p>After completing the preceding configuration, run the <strong>display bgp vpnv6 all peer</strong> command on each PE to check information about the BGP VPNv6 peer relationship. The following example uses the command output on PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> display bgp vpnv6 all peer</strong></pre>
<pre class="screen"> BGP local router ID : 192.168.1.1
 Local AS number : 100
 Total number of peers : 1                 Peers in established state : 1

  Peer            V          AS  MsgRcvd  MsgSent  OutQ  Up/Down       State     PrefRcv

  3.3.3.9         4         100        4        3     0 00:01:50  <strong>Established</strong>    0</pre>
<p>The command output shows that <strong>State</strong> is <strong>Established</strong>, indicating that the BGP VPNv6 peer relationship between PE1 and PE2 has been established.</p>
</p></li><li><span>On each PE, configure a VPN instance that supports the IPv4 and IPv6 address families and bind the VPN instance to the PE interface connecting to a CE.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>ip vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpna] <strong>ipv4-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpna-af-ipv4] <strong>route-distinguisher 100:1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpna-af-ipv4] <strong>vpn-target 1:1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpna-af-ipv4] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpna] <strong>ipv6-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpna-af-ipv6] <strong>route-distinguisher 100:2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpna-af-ipv6] <strong>vpn-target 2:2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpna-af-ipv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-vpna] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong>ip binding vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong>ip address 10.1.1.2 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface Loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-LoopBack0] <strong>ip binding vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-LoopBack0] <strong>ip address 1.1.1.1 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-LoopBack0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p>Repeat this step for PE2. For configuration details, see <a href="#EN-US_TASK_0172369750__file1">Configuration Files</a> in this section.</p>
</p></li><li><span>Configure VPN peer relationships between PEs and CEs (tunnel forwarding).</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>mpls ldp vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-ldp-vpn-instance-vpna] <strong>lsr-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-ldp-vpn-instance-vpna] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>ospf 1 vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>network 1.1.1.1 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>network 10.1.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-instance-vpna] <strong>peer 4.4.4.9 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-instance-vpna] <strong>peer 4.4.4.9 connect-interface LoopBack0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-instance-vpna] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>ipv6-family vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-6-vpna] <strong>peer 4.4.4.9 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-6-vpna] <strong>peer 4.4.4.9 label-route-capability</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure CE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong>mpls lsr-id 4.4.4.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-mpls] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-ospf-1-area-0.0.0.0] <strong>network 4.4.4.9 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-ospf-1-area-0.0.0.0] <strong>network 10.1.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/0</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-bgp] <strong>peer 1.1.1.1 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-bgp] <strong>peer 1.1.1.1 connect-interface LoopBack1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-bgp] <strong>ipv6-family unicast</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-bgp-af-ipv6] <strong>peer 1.1.1.1 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-bgp-af-ipv6] <strong>peer 1.1.1.1 label-route-capability</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-bgp-af-ipv6] <strong>network 2001:DB8:8:: 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-bgp-af-ipv6] <strong>unicast-route recursive-lookup tunnel-v4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-bgp-af-ipv6] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>commit</strong></pre>
<p>The configurations of PE2 and CE2 are similar to those of PE1 and CE1, respectively. For configuration details, see <a href="#EN-US_TASK_0172369750__file1">Configuration Files</a> in this section.</p>
</p></li><li><span>Verify the configuration.</span><p><p>After completing the preceding configuration, CE1 and CE2 can learn IPv6 routes from each other and they can ping each other with ping packets carrying the source IP address. The following example uses the command output on CE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong>display ipv6 routing-table</strong></pre>
<pre class="screen">Routing Table : _public_
         Destinations : 7        Routes : 7         

Destination  : ::1                                     PrefixLength : 128
NextHop      : ::1                                     Preference   : 0
Cost         : 0                                       Protocol     : Direct
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : InLoopBack0                             Flags        : D

Destination  : ::FFFF:127.0.0.0                        PrefixLength : 104
NextHop      : ::FFFF:127.0.0.1                        Preference   : 0
Cost         : 0                                       Protocol     : Direct
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : InLoopBack0                             Flags        : D

Destination  : ::FFFF:127.0.0.1                        PrefixLength : 128
NextHop      : ::1                                     Preference   : 0
Cost         : 0                                       Protocol     : Direct
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : InLoopBack0                             Flags        : D

Destination  : 2001:DB8:8::                            PrefixLength : 64
NextHop      : 2001:DB8:8::1                           Preference   : 0
Cost         : 0                                       Protocol     : Direct
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : LoopBack0                               Flags        : D

Destination  : 2001:DB8:8::1                           PrefixLength : 128
NextHop      : ::1                                     Preference   : 0
Cost         : 0                                       Protocol     : Direct
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : LoopBack0                               Flags        : D

Destination  : <strong>2001:DB8:9::</strong>                          PrefixLength : 64
NextHop      : ::FFFF:1.1.1.1                          Preference   : 255
Cost         : 0                                       Protocol     : IBGP
RelayNextHop : ::FFFF:10.1.1.2                         TunnelID     : 0x0000000001004c4b42
Interface    : GigabitEthernet<span>0/2/0</span>                    Flags        : RD

Destination  : FE80::                                  PrefixLength : 10
NextHop      : ::                                      Preference   : 0
Cost         : 0                                       Protocol     : Direct
RelayNextHop : ::                                      TunnelID     : 0x0
Interface    : NULL0                                   Flags        : DB</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong>ping ipv6 -a 2001:db8:8::1 2001:db8:9::1</strong></pre>
<pre class="screen">  PING 2001:db8:9::1 : 56  data bytes, press CTRL_C to break
    Reply from 2001:db8:9::1
    bytes=56 Sequence=1 hop limit=62  time = 170 ms
    Reply from 2001:db8:9::1
    bytes=56 Sequence=2 hop limit=62  time = 140 ms
    Reply from 2001:db8:9::1
    bytes=56 Sequence=3 hop limit=62  time = 150 ms
    Reply from 2001:db8:9::1
    bytes=56 Sequence=4 hop limit=62  time = 140 ms
    Reply from 2001:db8:9::1
    bytes=56 Sequence=5 hop limit=62  time = 170 ms

  --- 2001:db8:9::1 ping statistics ---
    5 packet(s) transmitted
    5 packet(s) received
    0.00% packet loss
    round-trip min/avg/max = 140/154/170 ms</pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172369750__file1"><a name="EN-US_TASK_0172369750__file1"></a><a name="file1"></a><a name="EN-US_TASK_0172369750__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#
sysname PE1
#
ip vpn-instance vpna
 ipv4-family
  route-distinguisher 100:1
  apply-label per-instance
  vpn-target 1:1 export-extcommunity
  vpn-target 1:1 import-extcommunity
 ipv6-family
  route-distinguisher 100:2
  apply-label per-instance
  vpn-target 2:2 export-extcommunity
  vpn-target 2:2 import-extcommunity
#               
mpls lsr-id 1.1.1.9
#
mpls
#
mpls ldp
#
mpls ldp vpn-instance vpna
 lsr-id 1.1.1.1
#
isis 1
 network-entity 10.1111.1111.1111.00
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 192.168.1.1 255.255.255.0
 isis enable 1  
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip binding vpn-instance vpna
 ip address 10.1.1.2 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack0
 ip binding vpn-instance vpna
 ip address 1.1.1.1 255.255.255.255
#
interface LoopBack1
 ip address 1.1.1.9 255.255.255.255
 isis enable 1
#
bgp 100
 peer 3.3.3.9 as-number 100
 peer 3.3.3.9 connect-interface LoopBack1
 #
 ipv4-family unicast
  undo synchronization
  peer 3.3.3.9 enable
 #
 vpn-instance vpna
  peer 4.4.4.9 as-number 100
  peer 4.4.4.9 connect-interface LoopBack0
 #
 ipv6-family vpnv6
  policy vpn-target
  peer 3.3.3.9 enable
 #
 ipv6-family vpn-instance vpna
  peer 4.4.4.9 enable
  peer 4.4.4.9 label-route-capability
#
ospf 1 vpn-instance vpna
 area 0.0.0.0
  network 1.1.1.1 0.0.0.0
  network 10.1.1.0 0.0.0.255
#
return</pre>
</li><li><p>P configuration file</p>
<pre class="screen">#
sysname P
#
mpls lsr-id 2.2.2.9
#
mpls
#
mpls ldp
#
isis 1
 network-entity 20.2222.2222.2222.00
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 192.168.1.2 255.255.255.0
 isis enable 1
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 192.168.2.1 255.255.255.0
 isis enable 1
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 2.2.2.9 255.255.255.255
 isis enable 1
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2
#
ip vpn-instance vpna
 ipv4-family
  route-distinguisher 100:1
  apply-label per-instance
  vpn-target 1:1 export-extcommunity
  vpn-target 1:1 import-extcommunity
 ipv6-family
  route-distinguisher 100:2
  apply-label per-instance
  vpn-target 2:2 export-extcommunity
  vpn-target 2:2 import-extcommunity
#               
mpls lsr-id 3.3.3.9
#
mpls
#
mpls ldp
#
mpls ldp vpn-instance vpna
 lsr-id 3.3.3.3
#
isis 1
 network-entity 30.3333.3333.3333.00
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 192.168.2.2 255.255.255.0
 isis enable 1
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip binding vpn-instance vpna
 ip address 10.2.1.2 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack0
 ip binding vpn-instance vpna
 ip address 3.3.3.3 255.255.255.255
#
interface LoopBack1
 ip address 3.3.3.9 255.255.255.255
 isis enable 1
#
bgp 100         
 peer 1.1.1.9 as-number 100
 peer 1.1.1.9 connect-interface LoopBack1
 #
 ipv4-family unicast
  undo synchronization
  peer 1.1.1.9 enable
 #
 vpn-instance vpna
  peer 5.5.5.9 as-number 100
  peer 5.5.5.9 connect-interface LoopBack0
 #
 ipv6-family vpnv6
  policy vpn-target
  peer 1.1.1.9 enable
 #
 ipv6-family vpn-instance vpna
  import-route direct
  peer 5.5.5.9 enable
  peer 5.5.5.9 label-route-capability
#
ospf 1 vpn-instance vpna
 area 0.0.0.0
  network 3.3.3.3 0.0.0.0
  network 10.2.1.0 0.0.0.255
#
return</pre>
</li><li><p>CE1 configuration file</p>
<pre class="screen">#
sysname CE1
#
mpls lsr-id 4.4.4.9
#
mpls
#
mpls ldp
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.1.1.1 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack0
 ipv6 enable
 ipv6 address 2001:DB8:8::1/64
#
interface LoopBack1
 ip address 4.4.4.9 255.255.255.255
#
bgp 100
 peer 1.1.1.1 as-number 100
 peer 1.1.1.1 connect-interface LoopBack1
 #
 ipv4-family unicast
  undo synchronization
  peer 1.1.1.1 enable
 #
 ipv6-family unicast
  undo synchronization
  network 2001:DB8:8:: 64
  unicast-route recursive-lookup tunnel-v4
  peer 1.1.1.1 enable
  peer 1.1.1.1 label-route-capability
#
ospf 1
 area 0.0.0.0
  network 4.4.4.9 0.0.0.0
  network 10.1.1.0 0.0.0.255
#
return</pre>
</li><li><p>CE2 configuration file</p>
<pre class="screen">#
sysname CE2
#
mpls lsr-id 5.5.5.9
#
mpls
#
mpls ldp
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.2.1.1 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack0
 ipv6 enable
 ipv6 address 2001:DB8:9::1/64
#
interface LoopBack1
 ip address 5.5.5.9 255.255.255.255
#
bgp 100
 peer 3.3.3.3 as-number 100
 peer 3.3.3.3 connect-interface LoopBack1
 #
 ipv4-family unicast
  undo synchronization
  peer 3.3.3.3 enable
 #
 ipv6-family unicast
  undo synchronization
  network 2001:DB8:9:: 64
  unicast-route recursive-lookup tunnel-v4
  peer 3.3.3.3 enable
  peer 3.3.3.3 label-route-capability
#
ospf 1
 area 0.0.0.0
  network 5.5.5.9 0.0.0.0
  network 10.2.1.0 0.0.0.255
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2039.html">Configuration Examples for BGP/MPLS IPv6 VPN
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2046.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2123.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>