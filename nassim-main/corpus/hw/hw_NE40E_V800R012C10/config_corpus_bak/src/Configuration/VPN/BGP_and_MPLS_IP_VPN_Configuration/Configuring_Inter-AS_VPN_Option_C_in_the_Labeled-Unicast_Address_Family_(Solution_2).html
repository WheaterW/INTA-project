
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Configuring Inter-AS VPN Option C in the Labeled-Unicast Address Family (Solution 2)">
<meta name="abstract" content="After LDP LSPs are established for the labeled BGP routes of the public network, multi-hop EBGP connections are established between PEs of different ASs to exchange VPNv4 routes. The labeled-unicast address family (also known as the BGP-labeled or BGP-LU address family) can be used to negotiate the capability to distribute independent labels.">
<meta name="description" content="After LDP LSPs are established for the labeled BGP routes of the public network, multi-hop EBGP connections are established between PEs of different ASs to exchange VPNv4 routes. The labeled-unicast address family (also known as the BGP-labeled or BGP-LU address family) can be used to negotiate the capability to distribute independent labels.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0186.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_2029a.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0194.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0195.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0196.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0197.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0183.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0198.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0199.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0185.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,l3vpnvrp,w00556928,l00468467,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="h00847023">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00847023">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0172369354">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Inter-AS VPN Option C in the Labeled-Unicast Address Family (Solution 2)</title>
</head>
<body><a name="EN-US_CONCEPT_0172369354"></a><a name="EN-US_CONCEPT_0172369354"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Inter-AS VPN Option C in the Labeled-Unicast Address Family (Solution 2)</h1>
<div><p>After LDP LSPs are established for the labeled BGP routes of the public network, multi-hop EBGP connections are established between PEs of different ASs to exchange VPNv4 routes. The labeled-unicast address family (also known as the BGP-labeled or BGP-LU address family) can be used to negotiate the capability to distribute independent labels.</p>
<div class="section"><h4 class="sectiontitle">Usage Scenario</h4><p>If the MPLS backbone network carrying VPN routes spans multiple ASs, the inter-AS VPN is required.</p>
<p>If each AS needs to exchange a large number of VPN routes, inter-AS VPN-Option C is a good choice to prevent the ASBR from becoming a bottleneck that impedes network expansion. The following solutions can be used to implement inter-AS VPN-Option C:</p>
<ul><li>Solution 1: After learning the labeled BGP routes of the public network in the remote AS from the remote ASBR, the local ASBR allocates labels for these routes, and advertises these routes to the IBGP peer that supports the label switching capability. In this manner, a complete LSP is set up.</li><li>Solution 2: The IBGP peer relationship between the PE and ASBR is not needed. In this solution, an ASBR learns the labeled public BGP routes of the remote AS from the peer ASBR. These labeled public BGP routes are then imported into IGP to trigger the establishment of an LDP LSP. In this manner, a complete LDP LSP is established between the two PEs.</li></ul>
<p>If an ASBR is ready to access a large number of PEs, solution 2 is recommended for its easy configuration.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In inter-AS VPN-Option C networking, do not enable LDP between ASBRs. If LDP is enabled on the interfaces between ASBRs, LDP sessions are then established between the ASBRs. As a result, the ASBRs establish an egress LSP and send Mapping messages to upstream ASBRs. After receiving Mapping messages, the upstream ASBRs establish a transit LSP. When there are a large number of BGP routes, enabling LDP on the interfaces between ASBRs leads to the occupation of a large number of LDP labels.</p>
</div></div>
</div>
<div class="section"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring inter-AS VPN Option C (solution 2), complete the following tasks:</p>
<ul><li>Configure IGP on the MPLS backbone network in each AS to ensure IP connectivity within each AS.</li><li>Configure MPLS and MPLS LDP both globally and per interface on each node of the MPLS backbone network in each AS.</li><li>Configure a VPN instance on each PE and bind the interface that connects a PE to a CE to the VPN instance on that PE.</li><li>Configure an IP address for the interface connecting a CE to a PE.</li><li>Configure a name for the IP prefix list used to filter labeled BGP routes of the public network.</li></ul>
</div>
</div>

<ul class="ullinks">
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0194.html">Establishing an EBGP Peer Relationship Between ASBRs</a>
</dt>
<dd>
An EBGP peer relationship is established between ASBRs to advertise routes destined for the loopback interfaces on PEs.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0195.html">Advertising the Routes of a PE in the Local AS to the Remote PE</a>
</dt>
<dd>
After the routes of the loopback interface on a PE in an AS are advertised to the remote PE in another AS, the MP-EBGP peer relationship is established between PEs.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0196.html">Adding a BGP Peer to the Labeled Address Family</a>
</dt>
<dd>
To establish an inter-AS BGP LSP, enable ASBRs to exchange labeled IPv4 routes.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0197.html">Establishing an LDP LSP for the Labeled BGP Routes of the Public Network</a>
</dt>
<dd>
By enabling LDP on ASBRs to allocate labels for BGP routes, you can establish LDP LSPs for labeled BGP routes of the public network that are filtered in the IP prefix list</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0183.html">Importing Labeled Routes to a Public Network's Unicast Routing Table</a>
</dt>
<dd>
To allow mutual access between public network users and users with labeled routes, configure labeled routes to be imported into the public network's unicast routing table.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0198.html">Establishing an MP-EBGP Peer Relationship Between PEs</a>
</dt>
<dd>
By introducing extended community attributes into BGP, MP-IBGP can advertise VPNv4 routes between PEs. PEs of different ASs are generally not directly connected. To set up an EBGP connection between the PEs of different ASs, you must configure the permitted maximum number of hops between PEs.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0199.html">Configuring Route Exchange Between a CE and a PE</a>
</dt>
<dd>
A PE and a CE can communicate using BGP, IGP, or a static route.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0185.html">Verifying the Configuration</a>
</dt>
<dd>
After configuring inter-AS VPN Option C (solution 2), check information about all BGP peer relationships, VPNv4 routes on PEs, and labels of IPv4 routes on ASBRs.</dd>
</dl>
</ul>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0000.html">BGP/MPLS IP VPN Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0186.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_2029a.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>