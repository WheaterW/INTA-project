
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Interworking Between L3VPN HoVPN and EVPN L3VPN over MPLS">
<meta name="abstract" content="During evolution from L3VPN HoVPN to EVPN HoVPN over MPLS, interworking between L3VPN HoVPN and EVPN L3VPN over MPLS occurs. L3VPN HoVPN is deployed between the UPE and SPE, and EVPN L3VPN over MPLS is deployed between the SPE and NPE.">
<meta name="description" content="During evolution from L3VPN HoVPN to EVPN HoVPN over MPLS, interworking between L3VPN HoVPN and EVPN L3VPN over MPLS occurs. L3VPN HoVPN is deployed between the UPE and SPE, and EVPN L3VPN over MPLS is deployed between the SPE and NPE.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0079.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0082.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0084.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="p00915595,w00800033,w00556928,l00468467,w00606909,evpnvrp,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="p00915595">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00878323">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172370560">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Interworking Between L3VPN HoVPN and EVPN L3VPN over MPLS</title>
</head>
<body><a name="EN-US_TASK_0172370560"></a><a name="EN-US_TASK_0172370560"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Interworking Between L3VPN HoVPN and EVPN L3VPN over MPLS</h1>
<div class="taskbody"><p>During evolution from L3VPN HoVPN to EVPN HoVPN over MPLS, interworking between L3VPN HoVPN and EVPN L3VPN over MPLS occurs. L3VPN HoVPN is deployed between the UPE and SPE, and EVPN L3VPN over MPLS is deployed between the SPE and NPE.</p>
<div class="context"><a name="EN-US_TASK_0172370560__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><div class="p">In a scenario where L3VPN HoVPN interworks with EVPN L3VPN over MPLS, perform the following configurations:<ul><li><div class="p"><a href="dc_vrp_evpn_cfg_0039.html">Create a VPN instance</a> on the SPE and NPE and bind the access-side interface to the <a href="dc_vrp_mpls-l3vpn-v4_cfg_0156.html">IPv4 VPN instance</a><span> or <a href="dc_vrp_mpls-l3vpn-v6_cfg_2059.html">IPv6 VPN instance</a></span> on the NPE. <div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172370560__en-us_task_0172370557_p570058839214055">According to related standards, the VPN instance status obtained through an NMS can be up only when at least one interface bound to the VPN instance is up. In an HoVPN scenario, an SPE does not require any interface to be bound to a VPN instance. Consequently, the VPN instance status obtained by an NMS is down according to the standards, which is opposite to the actual VPN instance status. In this case, you can run the <a href="cmdqueryname=transit-vpn"><b><span class="cmdname" id="EN-US_TASK_0172370560__en-us_task_0172370557_cmdname1753245486214055">transit-vpn</span></b></a> command in the VPN instance view or VPN instance IPv4<span>/IPv6</span> address family view on the SPE. Then, the VPN instance status obtained by the NMS remains up, regardless of the binding status between the VPN instance and interface.</p>
</div></div>
</div>
</li><li><p><a href="dc_vrp_mpls-l3vpn-v4_cfg_0155.html">Create a VPN instance</a> and <a href="dc_vrp_mpls-l3vpn-v4_cfg_0156.html">bind the access-side interface to the VPN instance</a> on the UPE.</p>
</li><li><p>Configure a BGP EVPN peer relationship between the SPE and NPE. For details, see <a href="dc_vrp_evpn_cfg_0006.html">Configuring BGP EVPN Peer Relationships</a>.</p>
</li><li><p>Configure a BGP VPNv4 peer relationship between the SPE and UPE. This configuration is similar to configuring a BGP VPNv4 peer relationship between PEs on a basic BGP/MPLS IP VPN. For details, see <a href="dc_vrp_mpls-l3vpn-v4_cfg_0157.html">Establishing MP-IBGP Peer Relationships Between PEs</a>.</p>
</li><li><p>Configure routing protocols for the NPE and UPE to exchange routes with connected CEs. This configuration is similar to configuring the PE and CE to exchange routes on a basic BGP/MPLS IP VPN. For details, see <a href="dc_vrp_mpls-l3vpn-v4_cfg_0158.html">Configuring Route Exchange Between PEs and CEs</a>.</p>
</li><li><p>Configure the SPE to advertise only default or summary routes to the UPE.</p>
</li><li><p>Configure the SPE to advertise re-encapsulated EVPN routes to the NPE. For details, see <a href="#EN-US_TASK_0172370560__process1">Procedure</a>.</p>
</li></ul>
</div>
<p>Perform the following steps on the SPE.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172370560__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<a name="EN-US_TASK_0172370560__process1"></a><a name="process1"></a><ol id="EN-US_TASK_0172370560__process1"><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a> <strong><span>vpnv4</span></strong></span><p><p>The BGP-VPNv4 address family view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=peer+import+reoriginate"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>import</span></strong> <strong><span>reoriginate</span></strong></span><p><p>The function to add a re-origination flag to routes received from the UPE is enabled.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the BGP view.</p>
</p></li><li><span>Run <a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname">l2vpn-family evpn</span></b></a></span><p><p>The BGP-EVPN address family view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=peer+advertise+route-reoriginate+vpnv4d"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>advertise</span></strong> <strong><span>route-reoriginated</span></strong> <strong><span>vpnv4</span></strong></span><p><p>The SPE is configured to re-encapsulate the BGP VPNv4 routes received from the UPE into EVPN routes and advertise them to the NPE.</p>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0079.html">Configuring EVPN L3VPN HVPN over MPLS
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0082.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0084.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>