
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Static PW FRR">
<meta name="abstract" content="In static PW FRR scenarios with static MS-PWs, configuring dynamic BFD for PW helps facilitate traffic switching between primary and secondary PWs.">
<meta name="description" content="In static PW FRR scenarios with static MS-PWs, configuring dynamic BFD for PW helps facilitate traffic switching between primary and secondary PWs.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_3012.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6018.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6009.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00415692">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00415692">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369972">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Static PW FRR</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172369972"></a><a name="EN-US_TASK_0172369972"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Static PW FRR</h1>
<div class="taskbody"><p>In static PW FRR scenarios with static MS-PWs, configuring dynamic BFD for PW helps facilitate traffic switching between primary and secondary PWs.</p>
<div class="context"><a name="EN-US_TASK_0172369972__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the public network shown in <a href="#EN-US_TASK_0172369972__fig_dc_vrp_vpws_cfg_605301">Figure 1</a>, dynamically associated bidirectional LSPs need to be established between PEs. CE1 and CE2 need to reliably communicate through the PEs and SPEs.</p>
<p>PW redundancy needs to be deployed on PE1 and PE2. For a pair of primary and secondary PWs that share the same source and destination and traverse dynamically associated bidirectional LSPs, you can configure static PW FRR to enhance network reliability. Because the PEs and SPEs belong to different IGP domains, multi-segment pseudo wires (MS-PWs) are required.</p>
<div class="fignone" id="EN-US_TASK_0172369972__fig_dc_vrp_vpws_cfg_605301"><a name="EN-US_TASK_0172369972__fig_dc_vrp_vpws_cfg_605301"></a><a name="fig_dc_vrp_vpws_cfg_605301"></a><span class="figcap"><b>Figure 1 </b>Configuring static PW FRR</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p"><ul><li>In this example, interface1, subinterface1.1, interface2, and interface3 represent GE<span>0/1/0</span>, GE<span>0/1/0</span>.1, GE<span>0/1/1</span>, and GE<span>0/1/2</span>, respectively.</li></ul>
</div>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_vpws_cfg_605301.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369972__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Assign an IP address to each interface and configure a routing protocol.</p>
</li><li><p>Configure basic MPLS functions and public network tunnels.</p>
</li><li><p>Configure a PW protection group, which includes:</p>
<ul><li><p>Configure VPN-tunnel binding.</p>
</li><li><p>Configure a pair of primary and secondary static PWs on PE1 and PE2 and PW switching on SPE1 and SPE2.</p>
</li></ul>
</li><li><p>Configure BFD for PW.</p>
</li><li><p>Configure a revertive switching policy.</p>
</li></ol>
<h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Interface numbers and IP addresses of CE1, CE2, PE1, PE2, SPE1, and SPE2 (see <a href="#EN-US_TASK_0172369972__fig_dc_vrp_vpws_cfg_605301">Figure 1</a>)</p>
</li><li>OSPF process IDs (1) of PE1, PE2, SPE1, and SPE2</li><li><p>LSR IDs of PE1, PE2, SPE1, and SPE2</p>
</li><li><p>Local and remote IP addresses, VC IDs, and VC types of PWs</p>
</li></ul>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172369972__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface. For configuration details, see <a href="#EN-US_TASK_0172369972__example_01">Configuration Files</a> in this section.</span></li><li><span>Configure a routing protocol on each PE and SPE. For configuration details, see <a href="#EN-US_TASK_0172369972__example_01">Configuration Files</a> in this section.</span></li><li><span>Configure basic MPLS functions and public network tunnels.</span><ol type="a"><li class="substepexpand"><span>Configure basic MPLS functions and enable MPLS TE, RSVP-TE, and CSPF.</span><p><p>Enable MPLS, MPLS TE, and CSPF globally for each node and enable MPLS, MPLS TE, and RSVP-TE on each interface along a TE tunnel.</p>
<p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>mpls lsr-id 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls] <strong>mpls rsvp-te </strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls] <strong>mpls rsvp-te hello </strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls] <strong>mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>mpls rsvp-te hello</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>mpls rsvp-te hello</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>mpls lsr-id 5.5.5.5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls] <strong>mpls rsvp-te </strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls] <strong>mpls rsvp-te hello</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls] <strong>mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te hello</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>mpls rsvp-te hello</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure SPE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SPE1] <strong>mpls lsr-id 6.6.6.6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-mpls] <strong>mpls rsvp-te </strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-mpls] <strong>mpls rsvp-te hello</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-mpls] <strong>mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te hello</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-GigabitEthernet<span>0/1/1</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-GigabitEthernet<span>0/1/1</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-GigabitEthernet<span>0/1/1</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-GigabitEthernet<span>0/1/1</span>] <strong>mpls rsvp-te hello</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1] <strong>commit</strong></pre>
<p># Configure SPE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SPE2] <strong>mpls lsr-id 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-mpls] <strong>mpls rsvp-te </strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-mpls] <strong>mpls rsvp-te hello</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-mpls] <strong>mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te hello</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-GigabitEthernet<span>0/1/1</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-GigabitEthernet<span>0/1/1</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-GigabitEthernet<span>0/1/1</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-GigabitEthernet<span>0/1/1</span>] <strong>mpls rsvp-te hello</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2] <strong>commit</strong></pre>
</p></li><li class="substepexpand"><span>Configure OSPF TE.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1] <strong>opaque-capability enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>mpls-te enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1] <strong>opaque-capability enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1-area-0.0.0.0] <strong>mpls-te enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure SPE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SPE1] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-ospf-1] <strong>opaque-capability enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-ospf-1-area-0.0.0.0] <strong>mpls-te enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1] <strong>commit</strong></pre>
<p># Configure SPE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SPE2] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-ospf-1] <strong>opaque-capability enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-ospf-1-area-0.0.0.0] <strong>mpls-te enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2] <strong>commit</strong></pre>
</p></li><li class="substepexpand"><span>Configure MPLS TE explicit paths.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>explicit-path PE1toSPE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-explicit-path-PE1toSPE1] <strong>next hop 10.1.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-explicit-path-PE1toSPE1] <strong>next hop 6.6.6.6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-explicit-path-PE1toSPE1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>explicit-path PE1toSPE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-explicit-path-PE1toSPE2] <strong>next hop 10.1.3.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-explicit-path-PE1toSPE2] <strong>next hop 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-explicit-path-PE1toSPE2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>explicit-path PE2toSPE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-explicit-path-PE2toSPE1] <strong>next hop 10.1.4.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-explicit-path-PE2toSPE1] <strong>next hop 6.6.6.6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-explicit-path-PE2toSPE1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>explicit-path PE2toSPE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-explicit-path-PE2toSPE2] <strong>next hop 10.1.5.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-explicit-path-PE2toSPE2] <strong>next hop 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-explicit-path-PE2toSPE2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure SPE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SPE1] <strong>explicit-path SPE1toPE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-explicit-path-PE2toSPE1] <strong>next hop 10.1.2.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-explicit-path-PE2toSPE1] <strong>next hop 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-explicit-path-PE2toSPE1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1] <strong>explicit-path SPE1toPE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-explicit-path-SPE1toPE2] <strong>next hop 10.1.4.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-explicit-path-SPE1toPE2] <strong>next hop 5.5.5.5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-explicit-path-SPE1toPE2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1] <strong>commit</strong></pre>
<p># Configure SPE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SPE2] <strong>explicit-path SPE2toPE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-explicit-path-SPE2toPE1] <strong>next hop 10.1.3.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-explicit-path-SPE2toPE1] <strong>next hop 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-explicit-path-SPE2toPE1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2] <strong>explicit-path SPE2toPE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-explicit-path-SPE2toPE2] <strong>next hop 10.1.5.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-explicit-path-SPE2toPE2] <strong>next hop 5.5.5.5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-explicit-path-SPE2toPE2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2] <strong>commit</strong></pre>
</p></li><li class="substepexpand"><span>Configure dynamically associated bidirectional LSPs.</span><p><p># On PE1, configure an LSP to SPE1 and an LSP to SPE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface Tunnel11</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel11] <strong>ip address unnumbered interface loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel11] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel11] <strong>destination 6.6.6.6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel11] <strong>mpls te tunnel-id 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel11] <strong>mpls te path explicit-path PE1toSPE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel11] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface Tunnel13</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel13] <strong>ip address unnumbered interface loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel13] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel13] <strong>destination 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel13] <strong>mpls te tunnel-id 3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel13] <strong>mpls te path explicit-path PE1toSPE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel13] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># On PE2, configure an LSP to SPE1 and an LSP to SPE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface Tunnel12</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Tunnel12] <strong>ip address unnumbered interface loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Tunnel12] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Tunnel12] <strong>destination 6.6.6.6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Tunnel12] <strong>mpls te tunnel-id 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Tunnel12] <strong>mpls te path explicit-path PE2toSPE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Tunnel12] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface Tunnel14</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Tunnel14] <strong>ip address unnumbered interface loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Tunnel14] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Tunnel14] <strong>destination 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Tunnel14] <strong>mpls te tunnel-id 4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Tunnel14] <strong>mpls te path explicit-path PE2toSPE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Tunnel14] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># On SPE1, configure an LSP to PE1 and an LSP to PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SPE1] <strong>interface Tunnel11</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-Tunnel11] <strong>ip address unnumbered interface loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-Tunnel11] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-Tunnel11] <strong>destination 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-Tunnel11] <strong>mpls te tunnel-id 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-Tunnel11] <strong>mpls te path explicit-path SPE1toPE1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-Tunnel11] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1] <strong>interface Tunnel12</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-Tunnel12] <strong>ip address unnumbered interface loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-Tunnel12] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-Tunnel12] <strong>destination 5.5.5.5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-Tunnel12] <strong>mpls te tunnel-id 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-Tunnel12] <strong>mpls te path explicit-path SPE1toPE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-Tunnel12] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1] <strong>commit</strong></pre>
<p># On SPE2, configure an LSP to PE1 and an LSP to PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SPE2] <strong>interface Tunnel13</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-Tunnel13] <strong>ip address unnumbered interface loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-Tunnel13] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-Tunnel13] <strong>destination 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-Tunnel13] <strong>mpls te tunnel-id 3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-Tunnel13] <strong>mpls te path explicit-path SPE2toPE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-Tunnel13] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2] <strong>interface Tunnel14</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-Tunnel14] <strong>ip address unnumbered interface loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-Tunnel14] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-Tunnel14] <strong>destination 5.5.5.5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-Tunnel14] <strong>mpls te tunnel-id 4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-Tunnel14] <strong>mpls te path explicit-path SPE2toPE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-Tunnel14] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2] <strong>commit</strong></pre>
</p></li></ol>
</li><li><span>Configure a static PW protection group.</span><ol type="a"><li class="substepexpand"><span>Configure VPN-tunnel binding.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface Tunnel11</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel11] <strong>mpls te reserved-for-binding</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel11] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface Tunnel13</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel13] <strong>mpls te reserved-for-binding</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel13] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>tunnel-policy bind</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-tunnel-policy-bind] <strong>tunnel binding destination 6.6.6.6 te Tunnel11</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-tunnel-policy-bind] <strong>tunnel binding destination 2.2.2.2 te Tunnel13</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-tunnel-policy-bind] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface Tunnel12</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Tunnel12] <strong>mpls te reserved-for-binding</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Tunnel12] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface Tunnel14</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Tunnel14] <strong>mpls te reserved-for-binding</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Tunnel14] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>tunnel-policy bind</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-tunnel-policy-bind] <strong>tunnel binding destination 6.6.6.6 te Tunnel12</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-tunnel-policy-bind] <strong>tunnel binding destination 2.2.2.2 te Tunnel14</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-tunnel-policy-bind] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure SPE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SPE1] <strong>interface Tunnel11</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-Tunnel11] <strong>mpls te reserved-for-binding</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-Tunnel11] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1] <strong>interface Tunnel12</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-Tunnel12] <strong>mpls te reserved-for-binding</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-Tunnel12] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1] <strong>tunnel-policy bind</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-tunnel-policy-bind] <strong>tunnel binding destination 3.3.3.3 te Tunnel11</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-tunnel-policy-bind] <strong>tunnel binding destination 5.5.5.5 te Tunnel12</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-tunnel-policy-bind] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1] <strong>commit</strong></pre>
<p># Configure SPE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SPE2] <strong>interface Tunnel13</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-Tunnel13] <strong>mpls te reserved-for-binding</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-Tunnel13] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2] <strong>interface Tunnel14</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-Tunnel14] <strong>mpls te reserved-for-binding</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-Tunnel14] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2] <strong>tunnel-policy bind</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-tunnel-policy-bind] <strong>tunnel binding destination 3.3.3.3 te Tunnel13</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-tunnel-policy-bind] <strong>tunnel binding destination 5.5.5.5 te Tunnel14</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-tunnel-policy-bind] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2] <strong>commit</strong></pre>
</p></li><li class="substepexpand"><span>Configure static PWs.</span><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In static PW FRR scenarios, if you do not configure the primary and secondary PWs to both receive packets, severe packet loss or service interruption may occur after a traffic switchover.</p>
</div></div>
<p># Configure the primary and secondary static PWs on PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-l2vpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface GigabitEthernet<span>0/1/0</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>vlan-type dot1q 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>mpls static-l2vc destination 6.6.6.6 1 transmit-vpn-label 1001 receive-vpn-label 1001 tunnel-policy bind control-word</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>mpls static-l2vc destination 2.2.2.2 3 transmit-vpn-label 1003 receive-vpn-label 1003 tunnel-policy bind control-word secondary</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>mpls l2vpn stream-dual-receiving</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure the primary and secondary static PWs on PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-l2vpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface GigabitEthernet<span>0/1/2</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>.1] <strong>vlan-type dot1q 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>.1] <strong>mpls static-l2vc destination 6.6.6.6 2 transmit-vpn-label 1002 receive-vpn-label 1002 tunnel-policy bind control-word</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>.1] <strong>mpls static-l2vc destination 2.2.2.2 4 transmit-vpn-label 1004 receive-vpn-label 1004 tunnel-policy bind control-word secondary</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>.1] <strong>mpls l2vpn stream-dual-receiving</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure PW switching on SPE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SPE1] <strong>mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1-l2vpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1] <strong>mpls switch-l2vc 3.3.3.3 1 trans 1001 recv 1001 tunnel-policy bind between 5.5.5.5 2 trans 1002 recv 1002 tunnel-policy bind encapsulation vlan control-word</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE1] <strong>commit</strong></pre>
<p># Configure PW switching on SPE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SPE2] <strong>mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2-l2vpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2] <strong>mpls switch-l2vc 3.3.3.3 3 trans 1003 recv 1003 tunnel-policy bind between 5.5.5.5 4 trans 1004 recv 1004 tunnel-policy bind encapsulation vlan control-word</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SPE2] <strong>commit</strong></pre>
</p></li></ol>
</li><li><span>Configure BFD for PW.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>bfd</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bfd] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface GigabitEthernet<span>0/1/0</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>mpls l2vpn pw bfd remote-vcid 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>mpls l2vpn pw bfd remote-vcid 4 secondary</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>bfd</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bfd] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface GigabitEthernet<span>0/1/2</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>.1] <strong>mpls l2vpn pw bfd remote-vcid 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>.1] <strong>mpls l2vpn pw bfd remote-vcid 3 secondary</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</p></li><li><span>Configure a revertive switching policy.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface GigabitEthernet<span>0/1/0</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>mpls l2vpn reroute delay 40 </strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface GigabitEthernet<span>0/1/2</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>.1] <strong>mpls l2vpn reroute delay 40</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><ul><li><p>After the configurations are complete, the PW status on each PE and SPE is up. The following example uses the command output on PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display mpls static-l2vc interface gigabitethernet<span>0/1/0</span>.1</strong></pre>
<pre class="screen"> *Client Interface     : GigabitEthernet<span>0/1/0</span>.1 is up
  AC Status            : up
  VC State             : <strong>up</strong>
  VC ID                : 1
  VC Type              : VLAN
  Destination          : 6.6.6.6
  Transmit VC Label    : 1001
  Receive VC Label     : 1001
  Label Status         : 0
  Token Status         : 0
  Control Word         : Enable
  VCCV Capability       : cw alert ttl lsp-ping bfd
  active state         : active
  OAM Protocol         : --
  OAM Status           : --
  OAM Fault Type       : --
  PW APS ID            : --
  PW APS Status        : --
  TTL Value            : 1
  Link State           : up
  Tunnel Policy        : bind
  PW Template Name     : --
  Main or Secondary    : Main
  load balance type    : flow
  Access-port          : false
  VC tunnel info       : 1 tunnels
  NO.0  TNL Type       : te    , TNL ID : 0x000000000300000001
  Create time          : 0 days, 0 hours, 41 minutes, 49 seconds
  UP time              : 0 days, 0 hours, 40 minutes, 12 seconds
  Last change time     : 0 days, 0 hours, 40 minutes, 12 seconds
  VC last up time      : 2015/08/04 07:35:02
  VC total up time     : 0 days, 0 hours, 40 minutes, 12 seconds
  CKey                 : 1
  NKey                 : 3506438260
  Dynamic BFD for PW   : enable
  Detect Multiplier     : 3
  Min Transit Interval : 10
  Min Receive Interval : 10
  Dynamic BFD Session  : built
  BFD for PW           : available
    BFD sessionIndex   : --             BFD state : up

 *Client Interface     : GigabitEthernet<span>0/1/0</span>.1 is up
  AC Status            : up
  VC State             : <strong>up</strong>
  VC ID                : 3
  VC Type              : VLAN
  Destination          : 2.2.2.2
  Transmit VC Label    : 1003
  Receive VC Label     : 1003
  Label Status         : 0
  Token Status         : 0
  Control Word         : Enable
  VCCV Capability       : cw alert ttl lsp-ping bfd
  active state         : inactive
  OAM Protocol         : --
  OAM Status           : --
  OAM Fault Type       : --
  PW APS ID            : --
  PW APS Status        : --
  TTL Value            : 1
  Link State           : up
  Tunnel Policy        : bind
  PW Template Name     : --
  Main or Secondary    : Secondary
  load balance type    : flow
  Access-port          : false
  VC tunnel info       : 1 tunnels
  NO.0  TNL Type       : te    , TNL ID : 0x000000000300000002
  Create time          : 0 days, 0 hours, 41 minutes, 49 seconds
  UP time              : 0 days, 0 hours, 40 minutes, 31 seconds
  Last change time     : 0 days, 0 hours, 40 minutes, 31 seconds
  VC last up time      : 2015/08/04 07:34:43
  VC total up time     : 0 days, 0 hours, 40 minutes, 31 seconds
  CKey                 : 2
  NKey                 : 3506438259
  Dynamic BFD for PW   : enable
  Detect Multiplier     : 3
  Min Transit Interval : 10
  Min Receive Interval : 10
  Dynamic BFD Session  : built
  BFD for PW           : available
    BFD sessionIndex   : --             BFD state : up

 Reroute policy        : delay 40 seconds
 Reason of last reroute: --
 Time of last reroute  : -- days, -- hours, -- minutes, -- seconds
 Delay timer ID        : --           Residual time :--</pre>
</li><li><p>CE1 and CE2 can ping each other. The following example uses the command output on CE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong>ping 192.168.1.2</strong></pre>
<pre class="screen">  PING 192.168.1.2: 56  data bytes, press CTRL_C to break
    Reply from 192.168.1.2: bytes=56 Sequence=1 ttl=255 time=55 ms
    Reply from 192.168.1.2: bytes=56 Sequence=2 ttl=255 time=1 ms
    Reply from 192.168.1.2: bytes=56 Sequence=3 ttl=255 time=1 ms
    Reply from 192.168.1.2: bytes=56 Sequence=4 ttl=255 time=1 ms
    Reply from 192.168.1.2: bytes=56 Sequence=5 ttl=255 time=1 ms

  --- 192.168.1.2 ping statistics ---
    5 packet(s) transmitted
    5 packet(s) received
    0.00% packet loss
    round-trip min/avg/max = 1/11/55 ms</pre>
</li></ul>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172369972__example_01"><a name="EN-US_TASK_0172369972__example_01"></a><a name="example_01"></a><a name="EN-US_TASK_0172369972__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>CE1 configuration file</p>
<pre class="screen">#
sysname CE1
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/0</span>.1
 vlan-type dot1q 1
 ip address 192.168.1.1 255.255.255.0
# 
return</pre>
</li><li><p>PE1 configuration file</p>
<pre class="screen">#
sysname PE1
# 
bfd
#
mpls lsr-id 3.3.3.3
#
mpls
 mpls te
 mpls rsvp-te
 mpls rsvp-te hello
 mpls te cspf
#
mpls l2vpn
#
explicit-path PE1toSPE1  
 next hop 10.1.2.2
 next hop 6.6.6.6
#
explicit-path PE1toSPE2  
 next hop 10.1.3.2  
 next hop 2.2.2.2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
#
interface GigabitEthernet<span>0/1/0</span>.1
 vlan-type dot1q 1
 mpls static-l2vc destination 6.6.6.6 1 transmit-vpn-label 1001 receive-vpn-label 1001 tunnel-policy bind control-word  
 mpls l2vpn pw bfd remote-vcid 2
 mpls static-l2vc destination 2.2.2.2 3 transmit-vpn-label 1003 receive-vpn-label 1003 tunnel-policy bind control-word secondary 
 mpls l2vpn pw bfd remote-vcid 4 secondary 
 mpls l2vpn reroute delay 40
 mpls l2vpn stream-dual-receiving
#
interface GigabitEthernet<span>0/1/1</span> 
 undo shutdown
 ip address 10.1.2.1 255.255.255.0
 mpls
 mpls te
 mpls rsvp-te
 mpls rsvp-te hello
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 10.1.3.1 255.255.255.0
 mpls
 mpls te
 mpls rsvp-te
 mpls rsvp-te hello 
 #
interface LoopBack0 
 ip address 3.3.3.3 255.255.255.255
#
interface Tunnel11
 ip address unnumbered interface LoopBack0 
 tunnel-protocol mpls te
 destination 6.6.6.6
 mpls te reserved-for-binding
 mpls te tunnel-id 1
 mpls te path explicit-path PE1toSPE1
#
interface Tunnel13
 ip address unnumbered interface LoopBack0 
 tunnel-protocol mpls te
 destination 2.2.2.2
 mpls te reserved-for-binding
 mpls te tunnel-id 3
 mpls te path explicit-path PE1toSPE2
#
ospf 1
 opaque-capability enable
 graceful-restart
 area 0.0.0.0
  network 3.3.3.3 0.0.0.0
  network 10.1.2.0 0.0.0.255
  network 10.1.3.0 0.0.0.255
  mpls-te enable
#
tunnel-policy bind  
 tunnel binding destination 2.2.2.2 te Tunnel13 
 tunnel binding destination 6.6.6.6 te Tunnel11 
#
return</pre>
</li><li><p>SPE1 configuration file</p>
<pre class="screen">#
sysname SPE1
#
mpls lsr-id 6.6.6.6
#
mpls
 mpls te
 mpls rsvp-te
 mpls rsvp-te hello 
 mpls te cspf
#
mpls l2vpn
#
mpls switch-l2vc 3.3.3.3 1 trans 1001 recv 1001 tunnel-policy bind between 5.5.5.5 2 trans 1002 recv 1002 tunnel-policy bind encapsulation vlan control-word
#
explicit-path SPE1toPE1
 next hop 10.1.2.1
 next hop 3.3.3.3
#
explicit-path SPE1toPE2
 next hop 10.1.4.1
 next hop 5.5.5.5
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.4.2 255.255.255.0
 mpls
 mpls te
 mpls rsvp-te
 mpls rsvp-te hello
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.1.2.2 255.255.255.0
 mpls
 mpls te
 mpls rsvp-te
 mpls rsvp-te hello
#
interface LoopBack0 
 ip address 6.6.6.6 255.255.255.255 
#
interface Tunnel11
 ip address unnumbered interface LoopBack0
 tunnel-protocol mpls te
 destination 3.3.3.3
 mpls te reserved-for-binding
 mpls te tunnel-id 1
 mpls te path explicit-path SPE1toPE1
#
interface Tunnel12
 ip address unnumbered interface LoopBack0 
 tunnel-protocol mpls te
 destination 5.5.5.5
 mpls te reserved-for-binding
 mpls te tunnel-id 2
 mpls te path explicit-path SPE1toPE2
#
ospf 1  
 opaque-capability enable
 graceful-restart
 area 0.0.0.0
  network 6.6.6.6 0.0.0.0
  network 10.1.2.0 0.0.0.255
  network 10.1.4.0 0.0.0.255
  mpls-te enable
#
tunnel-policy bind
 tunnel binding destination 3.3.3.3 te Tunnel11
 tunnel binding destination 5.5.5.5 te Tunnel12
#
return </pre>
</li><li><p>SPE2 configuration file</p>
<pre class="screen">#
sysname SPE2
#
mpls lsr-id 2.2.2.2
#
mpls
 mpls te
 mpls rsvp-te
 mpls rsvp-te hello 
 mpls te cspf
#
mpls l2vpn
#
mpls switch-l2vc 3.3.3.3 3 trans 1003 recv 1003 tunnel-policy bind between 5.5.5.5 4 trans 1004 recv 1004 tunnel-policy bind encapsulation vlan control-word
#
explicit-path SPE2toPE1  
 next hop 10.1.3.1
 next hop 3.3.3.3
#
explicit-path SPE2toPE2  
 next hop 10.1.5.2  
 next hop 5.5.5.5
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.3.2 255.255.255.0
 mpls
 mpls te
 mpls rsvp-te
 mpls rsvp-te hello
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.1.5.1 255.255.255.0
 mpls
 mpls te
 mpls rsvp-te
 mpls rsvp-te hello
#
interface LoopBack0 
 ip address 2.2.2.2 255.255.255.255 
#
interface Tunnel13
 ip address unnumbered interface LoopBack0 
 tunnel-protocol mpls te
 destination 3.3.3.3
 mpls te reserved-for-binding
 mpls te tunnel-id 3
 mpls te path explicit-path SPE2toPE1
#
interface Tunnel14
 ip address unnumbered interface LoopBack0 
 tunnel-protocol mpls te
 destination 5.5.5.5
 mpls te reserved-for-binding
 mpls te tunnel-id 4
 mpls te path explicit-path SPE2toPE2
#
ospf 1
 opaque-capability enable
 graceful-restart
 area 0.0.0.0
  network 2.2.2.2 0.0.0.0
  network 10.1.3.0 0.0.0.255
  network 10.1.5.0 0.0.0.255
  mpls-te enable
#
tunnel-policy bind  
 tunnel binding destination 3.3.3.3 te Tunnel13 
 tunnel binding destination 5.5.5.5 te Tunnel14
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2 
#
bfd 
#
mpls lsr-id 5.5.5.5
#
mpls
 mpls te
 mpls rsvp-te
 mpls rsvp-te hello 
 mpls te cspf  
#
mpls l2vpn
#
explicit-path PE2toSPE1
 next hop 10.1.4.2
 next hop 6.6.6.6
#
explicit-path PE2toSPE2
 next hop 10.1.5.1
 next hop 2.2.2.2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.4.1 255.255.255.0
 mpls
 mpls te
 mpls rsvp-te
 mpls rsvp-te hello
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.1.5.2 255.255.255.0
 mpls
 mpls te
 mpls rsvp-te
 mpls rsvp-te hello
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/2</span>.1
 vlan-type dot1q 1
 mpls static-l2vc destination 6.6.6.6 2 transmit-vpn-label 1002 receive-vpn-label 1002 tunnel-policy bind control-word  
 mpls l2vpn pw bfd remote-vcid 1
 mpls static-l2vc destination 2.2.2.2 4 transmit-vpn-label 1004 receive-vpn-label 1004 tunnel-policy bind control-word secondary 
 mpls l2vpn pw bfd remote-vcid 3 secondary
 mpls l2vpn reroute delay 40
 mpls l2vpn stream-dual-receiving
#
interface LoopBack0
 ip address 5.5.5.5 255.255.255.255
#
interface Tunnel12
 ip address unnumbered interface LoopBack0 
 tunnel-protocol mpls te
 destination 6.6.6.6
 mpls te reserved-for-binding
 mpls te tunnel-id 2
 mpls te path explicit-path PE2toSPE1
#
interface Tunnel14
 ip address unnumbered interface LoopBack0 
 tunnel-protocol mpls te
 destination 2.2.2.2
 mpls te reserved-for-binding
 mpls te tunnel-id 4
 mpls te path explicit-path PE2toSPE2
#
ospf 1
 opaque-capability enable
 graceful-restart
 area 0.0.0.0
  network 5.5.5.5 0.0.0.0
  network 10.1.4.0 0.0.0.255
  network 10.1.5.0 0.0.0.255
  mpls-te enable
#
tunnel-policy bind
 tunnel binding destination 2.2.2.2 te Tunnel14
 tunnel binding destination 6.6.6.6 te Tunnel12
#
return </pre>
</li><li><p>CE2 configuration file</p>
<pre class="screen">#
sysname CE2 
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/0</span>.1
 vlan-type dot1q 1
 ip address 192.168.1.2 255.255.255.0 
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_3012.html">Configuration Examples for VPWS
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6018.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6009.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>