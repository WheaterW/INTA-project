
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring EVPN Functions">
<meta name="abstract" content="EVPN VPWS is deployed based on the EVPN service architecture. Before configuring EVPN VPWS over SRv6 BE, you need to configure EVPN functions.">
<meta name="description" content="EVPN VPWS is deployed based on the EVPN service architecture. Before configuring EVPN VPWS over SRv6 BE, you need to configure EVPN functions.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0230.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0260.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0233.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="p00915595">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="p00915595">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001317978493">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring EVPN Functions</title>
</head>
<body><a name="EN-US_TASK_0000001317978493"></a><a name="EN-US_TASK_0000001317978493"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring EVPN Functions</h1>
<div class="taskbody"><p>EVPN VPWS is deployed based on the EVPN service architecture. Before configuring EVPN VPWS over SRv6 BE, you need to configure EVPN functions.</p>
<div class="steps"><a name="EN-US_TASK_0000001317978493__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=evpn+vpn-instance"><b><span class="cmdname">evpn vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i> <strong><span>vpws</span></strong></span><p><p>A VPWS EVPN instance is created, and its view is displayed.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=description"><b><span class="cmdname">description</span></b></a> <i><span class="varname">description-information</span></i></span><p><p>A description is configured for the EVPN instance.</p>
</p><p><p>Similar to a hostname or an interface description, an EVPN instance description helps you memorize the EVPN instance.</p>
</p></li><li><span>Run <a href="cmdqueryname=route-distinguisher"><b><span class="cmdname">route-distinguisher</span></b></a> <i><span class="varname">route-distinguisher</span></i></span><p><p>An RD is configured for the EVPN instance.</p>
</p><p><p>An EVPN instance takes effect only after an RD is configured for it. The RDs of different EVPN instances on the same PE must be different.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If you need to create a large number of EVPN instances and plan a large number of RDs, you can run the <strong>evpn route-distinguisher auto</strong> <em>rd-ip</em> command in the system view to enable automatic RD allocation, thereby avoiding RD conflicts. The <em>rd-ip</em> parameter specifies an IPv4 address, enabling a device to allocate RDs in the format of <em>X.X.X.X</em>:<em>index</em> to all EVPN instances that are not allocated RDs. <em>X.X.X.X</em> indicates a user-defined RD-IP value, and <em>index</em> indicates a 2-byte number ranging from 1 to 65535 automatically allocated by the system.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=vpn-target"><b><span class="cmdname">vpn-target</span></b></a> <i><span class="varname">vpn-target</span></i> &amp;&lt;1-8&gt; [ <strong><span>both</span></strong> | <strong><span>export-extcommunity</span></strong> | <strong><span>import-extcommunity</span></strong> ]</span><p><p>VPN targets are configured for the EVPN instance.</p>
</p><p><p>VPN targets are BGP extended community attributes used to control the import and export of EVPN routes. A maximum of eight import VPN targets and eight export VPN targets can be configured each time the <a href="cmdqueryname=vpn-target"><b><span class="cmdname">vpn-target</span></b></a> command is run. To configure more VPN targets for an EVPN instance address family, run the <a href="cmdqueryname=vpn-target"><b><span class="cmdname">vpn-target</span></b></a> command several times.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=tnl-policy"><b><span class="cmdname">tnl-policy</span></b></a> <i><span class="varname">policy-name</span></i></span><p><p>The EVPN instance is associated with a tunnel policy.</p>
</p><p><p>This configuration enables PEs to use TE tunnels to transmit data packets.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=timer+revert+delay"><b><span class="cmdname">timer revert delay</span></b></a> <i><span class="varname">delay-value</span></i></span><p><p>A switchback delay is configured.</p>
</p><p><p>In a dual-homing scenario, after a fault on the access-side link of the master PE or the master PE is rectified, the master PE generates Ethernet A-D per-EVI routes and then advertise these routes to the remote PE through the BGP EVPN peer relationship. Upon receipt of these routes, the remote PE generates forwarding entries accordingly and switches traffic from the path destined for the backup PE to one destined for the master PE. In this case, if the master PE fails to generate some forwarding entries in a timely manner, a few packets will be lost. To prevent this problem, run the <a href="cmdqueryname=timer+revert+delay"><b><span class="cmdname">timer revert delay</span></b></a> <i><span class="varname">delay-value</span></i> command on the remote PE to configure an appropriate switchback delay. Then, after the remote PE receives Ethernet A-D per-EVI routes, it delays generating forwarding entries. Specifically, the remote PE generates forwarding entries only after the forwarding entries on the master PE become stable. After the delay times out, the remote PE generates new forwarding entries and sends traffic to the master PE, preventing packet loss.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname">l2vpn-family evpn</span></b></a></span><p><p>The BGP-EVPN address family view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0230.html">Configuring Static EVPN VPWS over SRv6 BE
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0260.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0233.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>