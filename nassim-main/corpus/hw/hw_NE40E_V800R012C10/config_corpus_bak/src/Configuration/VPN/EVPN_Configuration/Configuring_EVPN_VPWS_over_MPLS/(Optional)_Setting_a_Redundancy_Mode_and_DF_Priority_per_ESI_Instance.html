
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Setting a Redundancy Mode and DF Priority per ESI Instance">
<meta name="abstract" content="In a scenario where multiple CEs are dual-homed to PEs, if you want to use different transmission modes (load balancing and non-load balancing) to send unicast traffic to different CEs or if you want to specify DFs for traffic forwarding by setting priority values, you can set a redundancy mode and DF priority values based on ESIs.">
<meta name="description" content="In a scenario where multiple CEs are dual-homed to PEs, if you want to use different transmission modes (load balancing and non-load balancing) to send unicast traffic to different CEs or if you want to specify DFs for traffic forwarding by setting priority values, you can set a redundancy mode and DF priority values based on ESIs.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0020.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0024.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0025.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00878323">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0273479577">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Setting a Redundancy Mode and DF Priority per ESI Instance</title>
</head>
<body><a name="EN-US_TASK_0273479577"></a><a name="EN-US_TASK_0273479577"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Setting a Redundancy Mode and DF Priority per ESI Instance</h1>
<div class="taskbody"><p>In a scenario where multiple CEs are dual-homed to PEs, if you want to use different transmission modes (load balancing and non-load balancing) to send unicast traffic to different CEs or if you want to specify DFs for traffic forwarding by setting priority values, you can set a redundancy mode and DF priority values based on ESIs.</p>
<div class="context"><a name="EN-US_TASK_0273479577__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>On the network shown in <a href="#EN-US_TASK_0273479577__fig_dc_vrp_evpn_cfg_011001">Figure 1</a>, CE1 and CE2 are both dual-homed to PE1 and PE2. The PE interfaces that connect to CE1 have ESI 1, and the PE interfaces that connect to CE2 have ESI 2. If you want CE3-to-CE1 unicast traffic and CE3-to-CE2 unicast traffic to be transmitted in load balancing and non-load balancing mode, respectively, you can set a redundancy mode per ESI instance. Specifically, you can set the redundancy mode of the ESI 1 instance to all-active and that of the ESI 2 instance to single-active.</p>
<p>If you want CE3-to-CE2 BUM traffic to be forwarded by PE1, configure ESI-based DF priority election on PE1 and PE2 and specify PE1 as the primary DF.</p>
<div class="fignone" id="EN-US_TASK_0273479577__fig_dc_vrp_evpn_cfg_011001"><a name="EN-US_TASK_0273479577__fig_dc_vrp_evpn_cfg_011001"></a><a name="fig_dc_vrp_evpn_cfg_011001"></a><span class="figcap"><b>Figure 1 </b>Setting a redundancy mode per ESI</span><br><span><img class="vsd" src="figure/en-us_image_0273480764.png"></span></div>
<p>An ESI can be dynamically generated or statically configured. A redundancy mode per ESI instance must be set based on the ESI generation mode.</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0273479577__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Set a redundancy mode based on a statically configured ESI.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=evpn+%28system+view%29"><b><span class="cmdname">evpn</span></b></a></span><p><p>The global EVPN configuration view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=esi"><b><span class="cmdname">esi</span></b></a> <i><span class="varname">esi</span></i></span><p><p>A static ESI instance name is configured.</p>
<p>The <i><span class="varname">esi</span></i> value must be the same as the name of the statically configured ESI on the interface.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=evpn+redundancy-mode"><b><span class="cmdname">evpn redundancy-mode</span></b></a> { <strong><span>single-active</span></strong> | <strong><span>all-active</span></strong> }</span><p><p>A redundancy mode is configured for the static ESI instance.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=df-election+type+preference-based"><b><span class="cmdname">df-election type preference-based</span></b></a></span><p><p>Priority-based DF election is enabled in EVPN VPWS scenarios.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=preference"><b><span class="cmdname">preference</span></b></a> <i><span class="varname">preference</span></i></span><p><p>A priority value is set. A larger <i><span class="varname">preference</span></i> value indicates a higher priority.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=non-revertive"><b><span class="cmdname">non-revertive</span></b></a></span><p><p>The non-revertive mode is enabled.</p>
</p><p><p>On the network shown in <a href="#EN-US_TASK_0273479577__fig_dc_vrp_evpn_cfg_011001">Figure 1</a>, CE2 is dual-homed to PE1 and PE2. PE1 is elected as the primary DF to forward traffic because it has a higher priority. If PE1 fails, traffic is switched to PE2 for forwarding. After PE1 recovers, traffic is switched back to PE1. To reduce traffic switching times and maintain service topology stability, run the <a href="cmdqueryname=non-revertive"><b><span class="cmdname">non-revertive</span></b></a> command to disable traffic switchback.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Set a redundancy mode based on a dynamically generated ESI.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=evpn+%28system+view%29"><b><span class="cmdname">evpn</span></b></a></span><p><p>The global EVPN configuration view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=esi+dynamic-name"><b><span class="cmdname">esi dynamic-name</span></b></a> <i><span class="varname">esi-name</span></i></span><p><p>A dynamic ESI instance name is configured.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=evpn+redundancy-mode"><b><span class="cmdname">evpn redundancy-mode</span></b></a> { <strong><span>single-active</span></strong> | <strong><span>all-active</span></strong> }</span><p><p>A redundancy mode is configured for the dynamic ESI instance.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=df-election+type+preference-based"><b><span class="cmdname">df-election type preference-based</span></b></a></span><p><p>Priority-based DF election is enabled in EVPN VPWS scenarios.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=preference"><b><span class="cmdname">preference</span></b></a> <i><span class="varname">preference</span></i></span><p><p>A priority value is set. A larger <i><span class="varname">preference</span></i> value indicates a higher priority.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=non-revertive"><b><span class="cmdname">non-revertive</span></b></a></span><p><p>The non-revertive mode is enabled.</p>
</p><p><p>On the network shown in <a href="#EN-US_TASK_0273479577__fig_dc_vrp_evpn_cfg_011001">Figure 1</a>, CE2 is dual-homed to PE1 and PE2. PE1 is elected as the primary DF to forward traffic because it has a higher priority. If PE1 fails, traffic is switched to PE2 for forwarding. After PE1 recovers, traffic is switched back to PE1. To reduce traffic switching times and maintain service topology stability, run the <a href="cmdqueryname=non-revertive"><b><span class="cmdname">non-revertive</span></b></a> command to disable traffic switchback.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the ESI-dynamic view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the global EVPN configuration view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=interface+eth-trunk"><b><span class="cmdname">interface eth-trunk</span></b></a> <i><span class="varname">trunk-id</span></i></span><p><p>The Eth-Trunk interface view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=esi+dynamic"><b><span class="cmdname">esi dynamic</span></b></a> <i><span class="varname">esi-name</span></i></span><p><p>A dynamic ESI instance is bound to the Eth-Trunk interface.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0020.html">Configuring EVPN VPWS over MPLS
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0024.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0025.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>