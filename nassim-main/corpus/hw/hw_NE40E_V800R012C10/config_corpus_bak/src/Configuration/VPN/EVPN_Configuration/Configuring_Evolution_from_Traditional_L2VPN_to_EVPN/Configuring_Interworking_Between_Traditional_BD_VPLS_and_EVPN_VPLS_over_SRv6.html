
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Interworking Between Traditional BD VPLS and EVPN VPLS over SRv6">
<meta name="abstract" content="During the convergence of a traditional BD VPLS network and an EVPN VPLS over SRv6 network, interworking between traditional BD VPLS and EVPN VPLS over SRv6 must be configured.">
<meta name="description" content="During the convergence of a traditional BD VPLS network and an EVPN VPLS over SRv6 network, interworking between traditional BD VPLS and EVPN VPLS over SRv6 must be configured.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2vpn_to_evpn_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2vpn_to_evpn_cfg_0006.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2vpn_to_evpn_cfg_0018.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00878323">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0263090300">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Interworking Between Traditional BD VPLS and EVPN VPLS over SRv6</title>
</head>
<body><a name="EN-US_TASK_0263090300"></a><a name="EN-US_TASK_0263090300"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Interworking Between Traditional BD VPLS and EVPN VPLS over SRv6</h1>
<div class="taskbody"><p>During the convergence of a traditional BD VPLS network and an EVPN VPLS over SRv6 network, interworking between traditional BD VPLS and EVPN VPLS over SRv6 must be configured.</p>
<div class="context"><a name="EN-US_TASK_0263090300__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Traditional L2VPNs use VPLS over MPLS for Layer 2 communication. Compared with VPLS, EVPN â a next-generation VPN technology â has many advantages, such as support for multi-homing all-active networking and control plane-based MAC address learning. Particularly, EVPN over SRv6 can accommodate the growth of IPv6 networks and 5G services. Therefore, VPLS over MPLS is gradually evolving to EVPN over SRv6. However, the live network with a large number of existing VPLS services cannot be upgraded to EVPN VPLS over SRv6 at one time. In this case, you can configure interworking between BD VPLS and EVPN VPLS over SRv6.</p>
<p>On the network shown in <a href="#EN-US_TASK_0263090300__fig94817594118">Figure 1</a>, VPLS over MPLS is deployed between UPEs and SPEs to carry services; EVPN VPLS over SRv6 is deployed between SPEs and NPEs to carry services. In this case, you need to configure interworking between traditional BD VPLS and EVPN VPLS over SRv6 on SPE1 and SPE2.</p>
<div class="fignone" id="EN-US_TASK_0263090300__fig94817594118"><a name="EN-US_TASK_0263090300__fig94817594118"></a><a name="fig94817594118"></a><span class="figcap"><b>Figure 1 </b>Configuring interworking between traditional BD VPLS and EVPN VPLS over SRv6</span><br><span><img class="vsd" src="figure/en-us_image_0000001187210102.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0263090300__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring interworking between traditional BD VPLS and EVPN VPLS over SRv6, complete the following tasks:</p>
<ul><li><p><a href="dc_vrp_vpls_cfg_5003.html">Configure LDP VPLS</a> between UPEs and SPEs.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Create a BD VSI using the <a href="cmdqueryname=vsi+bd-mode"><b><span class="cmdname">vsi bd-mode</span></b></a> command.</p>
</div></div>
</li><li><p>Complete the task of <a href="dc_vrp_srv6_cfg_all_0023.html">Configuring EVPN VPLS over IS-IS SRv6 BE</a> or <a href="dc_vrp_cfg_evpn-vpls_over_srv6-te_policy.html">Configuring EVPN VPLS over SRv6 TE Policy</a> between an SPE and an NPE.</p>
</li></ul>
<p>Perform the following steps on SPE1 and SPE2.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0263090300__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure an ESI instance and set its redundancy mode to single-active.</span><ol type="a"><li><span>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</span></li><li><span>Run the <a href="cmdqueryname=evpn"><b><span class="cmdname">evpn</span></b></a> command to enter the global EVPN configuration view.</span></li><li><span>Run the <a href="cmdqueryname=esi"><b><span class="cmdname">esi</span></b></a> <i><span class="varname">esi</span></i> command to configure a static ESI instance name.</span></li><li><span>Run the <a href="cmdqueryname=evpn+redundancy-mode"><b><span class="cmdname">evpn redundancy-mode</span></b></a> <strong><span>single-active</span></strong> command to set the redundancy mode of the static ESI instance to single-active.</span></li><li><span>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the global EVPN configuration view.</span></li><li><span>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</span></li><li><span>Run the <strong>commit</strong> command to commit the configuration.</span></li></ol>
</li><li><span>Configure a specified SPE as a UPE and configure an ESI for the VSI.</span><ol type="a"><li><span>Run the <a href="cmdqueryname=vsi"><b><span class="cmdname">vsi</span></b></a> <i><span class="varname">vsi-name</span></i> <strong><span>bd-mode</span></strong> command to enter the VSI view.</span></li><li><span>Run the <a href="cmdqueryname=pwsignal"><b><span class="cmdname">pwsignal</span></b></a> <strong><span>ldp</span></strong> command to configure LDP as the PW signaling protocol and enter the VSI-LDP view.</span></li><li><span>Run the <a href="cmdqueryname=vsi-id"><b><span class="cmdname">vsi-id</span></b></a> <i><span class="varname">vsi-id</span></i> command to configure a VSI ID.</span></li><li><span>Run the <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">peer-address</span></i> [ <strong><span>negotiation-vc-id</span></strong> <i><span class="varname">vc-id</span></i> ] [ <strong><span>tnl-policy</span></strong> <i><span class="varname">policy-name</span></i> ] <strong><span>upe</span></strong> command to configure a specified SPE as a UPE.</span></li><li><span>Run the <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">peer-address</span></i> [ <strong><span>negotiation-vc-id</span></strong> <i><span class="varname">vc-id</span></i> ] <strong><span>pw</span></strong> <i><span class="varname">pw-name</span></i> command to create a PW and enter the VSI-LDP-PW view.</span></li><li><span>Run the <a href="cmdqueryname=esi"><b><span class="cmdname">esi</span></b></a> <i><span class="varname">esi</span></i> command to configure an ESI for the PW interface. The value of <i><span class="varname">esi</span></i> must be the same as the name of the static ESI instance.</span></li><li><span>(Optional) Run the <a href="cmdqueryname=evpn+e-tree-leaf"><b><span class="cmdname">evpn e-tree-leaf</span></b></a> command to configure the leaf attribute for the PW interface. If you do not want the traffic sent from CE1 to UPE1 to be sent back to CE1 through SPE1, SPE2, and UPE1, you can configure the leaf attribute in the VSI-LDP-PW view of SPE1 and SPE2.</span></li><li><span>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the VSI-LDP view.</span></li><li><span>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the VSI view.</span></li><li><span>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</span></li><li><span>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</span></li></ol>
</li><li><span>Bind the BD to the VSI and EVPN instance.</span><ol type="a"><li><span>Run the <a href="cmdqueryname=bridge-domain"><b><span class="cmdname">bridge-domain</span></b></a> <i><span class="varname">bd-id</span></i> command to enter the BD view.</span></li><li><span>Run the <a href="cmdqueryname=l2+binding"><b><span class="cmdname">l2 binding</span></b></a> <strong><span>vsi</span></strong> <i><span class="varname">vsi-name</span></i> [ <strong><span>pw-tag</span></strong> <i><span class="varname">pw-tag-value</span></i> ] command to bind the BD to the VSI.</span></li><li><span>Run the <a href="cmdqueryname=evpn+binding+vpn-instance"><b><span class="cmdname">evpn binding vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i> command to bind the BD to the EVPN instance.</span></li><li><span>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</span></li><li><span>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</span></li></ol>
</li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0263090300__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ul><li><p>Run the <a href="cmdqueryname=display+bgp+evpn"><b><span class="cmdname">display bgp evpn</span></b></a> { <strong><span>all</span></strong> | <strong><span>route-distinguisher</span></strong> <i><span class="varname">route-distinguisher</span></i> } <strong><span>routing-table</span></strong> { <strong><span>ad-route</span></strong> | <strong><span>es-route</span></strong> | <strong><span>inclusive-route</span></strong> | <strong><span>mac-route</span></strong> | <strong><span>prefix-route</span></strong> } <i><span class="varname">prefix</span></i> command on the SPE to check detailed BGP EVPN route information, including PW information.</p>
</li><li>Run the <a href="cmdqueryname=display+bgp+evpn"><b><span class="cmdname">display bgp evpn</span></b></a> <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> <strong><span>routing-table</span></strong> { <strong><span>ad-route</span></strong> | <strong><span>es-route</span></strong> | <strong><span>inclusive-route</span></strong> | <strong><span>mac-route</span></strong> } <i><span class="varname">prefix</span></i> command on the SPE to check the EVPN route information (including PW information) of the specified EVPN instance.</li><li><p>Run the <a href="cmdqueryname=display+evpn+vpn-instance+name"><b><span class="cmdname">display evpn vpn-instance name</span></b></a> <i><span class="varname">vpn-instance-name</span></i> <strong><span>df result</span></strong> [ <strong><span>esi</span></strong> <i><span class="varname">esi</span></i> ] command on the SPE to check the DF election result (including access-side PW information) of an EVPN instance.</p>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2vpn_to_evpn_cfg_0000.html">Configuring Evolution from Traditional L2VPN to EVPN
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2vpn_to_evpn_cfg_0006.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2vpn_to_evpn_cfg_0018.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>