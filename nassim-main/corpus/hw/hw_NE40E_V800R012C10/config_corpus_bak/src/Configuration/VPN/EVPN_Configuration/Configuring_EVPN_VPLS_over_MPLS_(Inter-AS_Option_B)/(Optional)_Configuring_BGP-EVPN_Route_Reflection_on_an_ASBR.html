
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring BGP-EVPN Route Reflection on an ASBR">
<meta name="abstract" content="When multiple PEs exist in the ASs, you can configure an ASBR as an RR to lower configuration complexity.">
<meta name="description" content="When multiple PEs exist in the ASs, you can configure an ASBR as an RR to lower configuration complexity.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0029.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0035.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0034.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00878323">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172370552">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring BGP-EVPN Route Reflection on an ASBR</title>
</head>
<body><a name="EN-US_TASK_0172370552"></a><a name="EN-US_TASK_0172370552"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring BGP-EVPN Route Reflection on an ASBR</h1>
<div class="taskbody"><p>When multiple PEs exist in the ASs, you can configure an ASBR as an RR to lower configuration complexity.</p>
<div class="context"><a name="EN-US_TASK_0172370552__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>In the inter-AS EVPN Option B scenario shown in <a href="#EN-US_TASK_0172370552__fig157308815308">Figure 1</a>, if multiple PEs exist in an AS, you can configure an ASBR as an RR to reduce the number of MP-IBGP connections needed between PEs. Configuring an ASBR as an RR will burden the ASBR. Therefore, it is recommended that a high-performance device be used as the ASBR. On the network shown in the figure, ASBR1 is configured as an RR so that PE1 and PE2 do not need to set up an MP-IBGP peer relationship.</p>
<div class="fignone" id="EN-US_TASK_0172370552__fig157308815308"><a name="EN-US_TASK_0172370552__fig157308815308"></a><a name="fig157308815308"></a><span class="figcap"><b>Figure 1 </b>Inter-AS EVPN Option B solution</span><br><span><img class="vsd" src="images/fig_dc_vrp_mpls-l3vpn-v4_cfg_004701.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172370552__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The ASBR1's system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname">l2vpn-family evpn</span></b></a></span><p><p>The BGP-EVPN address family view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=peer+reflect-client"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">peerIpv4Addr</span></i> <strong><span>reflect-client</span></strong></span><p><p>ASBR1 is configured as an RR, and a PE is configured as its client. To configure both PE1 and PE2 as clients, run this command once again.</p>
</p></li><li><span>Run <a href="cmdqueryname=peer+next-hop-local"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">peerIpv4Addr</span></i> <strong><span>next-hop-local</span></strong></span><p><p>The ASBR is configured to change the next hop address of a route to the device's own IP address before the device advertises the route to IBGP peers PE1 and PE2.</p>
</p></li><li><span>(Optional) If the clients are fully meshed, run <a href="cmdqueryname=undo+reflect+between-clients"><b><span class="cmdname">undo reflect between-clients</span></b></a></span><p><p>Route reflection between the clients through RRs is disabled.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=rr-filter"><b><span class="cmdname">rr-filter</span></b></a> <i><span class="varname">extended-list-number</span></i></span><p><p>A reflection policy is configured for the RR.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=reflect+change-path-attribute"><b><span class="cmdname">reflect change-path-attribute</span></b></a></span><p><p>The RR is enabled to modify the path attributes of BGP routes using an export policy.</p>
</p><p><div class="p"><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>After the <a href="cmdqueryname=reflect+change-path-attribute"><b><span class="cmdname">reflect change-path-attribute</span></b></a> command is run on the RR:</p>
<ul><li>In the BGP-EVPN address family view, the <a href="cmdqueryname=peer+route-policy"><b><span class="cmdname">peer route-policy</span></b></a> <strong><span>export</span></strong> command takes precedence over the <a href="cmdqueryname=peer+next-hop-invariable"><b><span class="cmdname">peer next-hop-invariable</span></b></a> command.</li><li>In the BGP-EVPN address family view, the <a href="cmdqueryname=peer+next-hop-local"><b><span class="cmdname">peer next-hop-local</span></b></a> command takes precedence over the <a href="cmdqueryname=peer+route-policy"><b><span class="cmdname">peer route-policy</span></b></a> <strong><span>export</span></strong> command.</li></ul>
</div></div>
</div>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0029.html">Configuring EVPN VPLS over MPLS (Inter-AS Option B)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0035.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0034.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>