
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring the Keepalive Function for GRE">
<meta name="abstract" content="This section provides an example for configuring the keepalive function for GRE. This function helps prevent the VPN from selecting the GRE tunnel unreachable to the remote end, thereby avoiding data loss.">
<meta name="description" content="This section provides an example for configuring the keepalive function for GRE. This function helps prevent the VPN from selecting the GRE tunnel unreachable to the remote end, thereby avoiding data loss.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gre_cfg_2020.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gre_cfg_2040.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gre_cfg_2032.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00415692">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369111">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring the Keepalive Function for GRE</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172369111"></a><a name="EN-US_TASK_0172369111"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring the Keepalive Function for GRE</h1>
<div class="taskbody"><p>This section provides an example for configuring the keepalive function for GRE. This function helps prevent the VPN from selecting the GRE tunnel unreachable to the remote end, thereby avoiding data loss.</p>
<div class="context"><a name="EN-US_TASK_0172369111__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0172369111__fig_dc_vrp_gre_cfg_203701">Figure 1</a>, GRE is configured on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B. It is required that the two ends of the GRE tunnel support the keepalive function.</p>
<div class="fignone" id="EN-US_TASK_0172369111__fig_dc_vrp_gre_cfg_203701"><a name="EN-US_TASK_0172369111__fig_dc_vrp_gre_cfg_203701"></a><a name="fig_dc_vrp_gre_cfg_203701"></a><span class="figcap"><b>Figure 1 </b>Configuring the keepalive function for GRE</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interfaces 1 through 3 represent GE<span>0/1/0</span>, GE<span>0/2/0</span>, and Tunnel1, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_gre_cfg_203701.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369111__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>To enable the keepalive function on one end of the GRE tunnel, run the <strong>keepalive</strong> command in the tunnel interface view of the <span class="keyword">Router</span> on the end.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The keepalive function does not need to be configured on both ends of a tunnel. After this function is enabled on the source end, the destination end only needs to provide the forwarding function.</p>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369111__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Data for configuring the routing protocol for the backbone network</p>
</li><li><p>Source and destination addresses of the GRE tunnel as well as the tunnel interface IP address</p>
</li><li><p>Interval for sending Keepalive packets</p>
</li><li><p>Retry times</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172369111__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure a routing protocol on the backbone network for <span class="keyword">Device</span>A and <span class="keyword">Device</span>B to communicate.</span><p><p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>A</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>port link-type hybrid</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>port default vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface vlanif 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Vlanif10] <strong>ip address 172.16.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Vlanif10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> interface loopback1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack1]<strong> ip address 1.1.1.9 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-LoopBack1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1-area-0.0.0.0] <strong>network 172.16.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1-area-0.0.0.0] <strong>network 1.1.1.9 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>B</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>vlan 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-vlan20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>port link-type hybrid</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>port default vlan 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface vlanif 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-Vlanif20] <strong>ip address 172.17.1.2 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-Vlanif20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> interface loopback1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1]<strong> ip address 2.2.2.9 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-LoopBack1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0] <strong>network 172.17.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0] <strong>network 2.2.2.9 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span>C.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>C</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>vlan batch 10 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-vlan20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/0</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/0</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/0</span>] <strong>port link-type hybrid</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/0</span>] <strong>port default vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>interface GigabitEthernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/2/0</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/2/0</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/2/0</span>] <strong>port link-type hybrid</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/2/0</span>] <strong>port default vlan 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>interface vlanif 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-Vlanif10] <strong>ip address 172.16.1.2 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-Vlanif10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>interface vlanif 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-Vlanif20] <strong>ip address 172.17.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-Vlanif20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1-area-0.0.0.0] <strong>network 172.16.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1-area-0.0.0.0] <strong>network 172.17.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>commit</strong></pre>
</p></li><li><span>Configure a tunnel on <span class="keyword">Device</span>A and enable the keepalive function.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> interface loopback1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack1]<strong> binding tunnel gre</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-LoopBack1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface tunnel 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel1] <strong>ip address 172.18.1.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel1] <strong>tunnel-protocol gre</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel1] <strong>source 1.1.1.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel1] <strong>destination 2.2.2.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel1] <strong>keepalive period 20 retry-times 3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</p></li><li><span>Configure a tunnel on <span class="keyword">Device</span>B and enable the keepalive function.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> interface loopback1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1]<strong> binding tunnel gre</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-LoopBack1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>interface tunnel 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-Tunnel1] <strong>ip address 172.18.1.2 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-Tunnel1] <strong>tunnel-protocol gre</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-Tunnel1] <strong>source 2.2.2.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-Tunnel1] <strong>destination 1.1.1.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-Tunnel1] <strong>keepalive period 20 retry-times 3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-Tunnel1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># The tunnel interface on <span class="keyword">Device</span>A can ping the tunnel interface on <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>ping -a 172.18.1.1 172.18.1.2</strong></pre>
<pre class="screen">  PING 172.18.1.2: 56  data bytes, press CTRL_C to break
    Reply from 172.18.1.2: bytes=56 Sequence=1 ttl=255 time=9 ms
    Reply from 172.18.1.2: bytes=56 Sequence=2 ttl=255 time=5 ms
    Reply from 172.18.1.2: bytes=56 Sequence=3 ttl=255 time=5 ms
    Reply from 172.18.1.2: bytes=56 Sequence=4 ttl=255 time=6 ms
    Reply from 172.18.1.2: bytes=56 Sequence=5 ttl=255 time=6 ms

  --- 172.18.1.2 ping statistics ---
    5 packet(s) transmitted
    5 packet(s) received
    0.00% packet loss
    round-trip min/avg/max = 5/6/9 ms</pre>
<p># View information about Keepalive packets in the tunnel interface view on <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface tunnel 1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-Tunnel1] <strong>display keepalive packets count</strong></pre>
<pre class="screen">Send 7 keepalive packets to peers, Receive 7 keepalive response packets from peers
Receive 0 keepalive packets from peers, Send 0 keepalive response packets to peers. </pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172369111__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span>A configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>A
#
vlan batch 10
#
interface Vlanif10
 ip address 172.16.1.1 255.255.255.0
#
interface GigabitEthernet <span>0/1/0</span>
 portswitch
 undo shutdown
 port default vlan 10
<span>#
interface LoopBack1
 ip address 1.1.1.9 255.255.255.255
 binding tunnel gre</span>
#
interface Tunnel1
 ip address 172.18.1.1 255.255.255.0
 tunnel-protocol gre
 keepalive period 20
 source 1.1.1.9
 destination 2.2.2.9
#
ospf 1
 area 0.0.0.0
<span>  network 1.1.1.9 0.0.0.0</span>
  network 172.16.1.0 0.0.0.255
#
return</pre>
</li><li><p><span class="keyword">Device</span>B configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>B
#
vlan batch 20
#
interface Vlanif20
 ip address 172.17.1.2 255.255.255.0
#
interface GigabitEthernet <span>0/1/0</span>
 portswitch
 undo shutdown
 port default vlan 20
#
interface LoopBack1
 ip address 2.2.2.9 255.255.255.255 
 binding tunnel gre
#
interface Tunnel1
 ip address 172.18.1.2 255.255.255.0
 tunnel-protocol gre
 keepalive period 20
 source 2.2.2.9
 destination 1.1.1.9
#
ospf 1
 area 0.0.0.0
<span>  network 2.2.2.9 0.0.0.0</span>
  network 172.17.1.0 0.0.0.255
#
return</pre>
</li><li><p><span class="keyword">Device</span>C configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>C
#
vlan batch 10 20
#
interface Vlanif10
 ip address 172.16.1.2 255.255.255.0
#
interface Vlanif20
 ip address 172.17.1.1 255.255.255.0
#
interface GigabitEthernet <span>0/1/0</span>
 portswitch
 undo shutdown
 port default vlan 10
#
interface GigabitEthernet <span>0/2/0</span>
 portswitch
 undo shutdown
 port default vlan 20
#
ospf 1
 area 0.0.0.0
  network 172.16.1.0 0.0.0.255
  network 172.17.1.0 0.0.0.255
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gre_cfg_2020.html">Configuration Examples for GRE
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gre_cfg_2040.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gre_cfg_2032.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>