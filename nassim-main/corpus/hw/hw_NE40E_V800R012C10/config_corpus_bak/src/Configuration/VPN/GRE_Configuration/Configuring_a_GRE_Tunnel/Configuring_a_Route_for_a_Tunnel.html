
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a Route for a Tunnel">
<meta name="abstract" content="A route for a tunnel must be available on both the source and destination devices so that packets encapsulated with GRE can be forwarded correctly. A route passing through a tunnel interface can be either a static or dynamic route.">
<meta name="description" content="A route for a tunnel must be available on both the source and destination devices so that packets encapsulated with GRE can be forwarded correctly. A route passing through a tunnel interface can be either a static or dynamic route.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gre_cfg_2003.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gre_cfg_2004.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_gre_cfg_1001.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00556928,grevrp,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="h00847023">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00847023">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369081">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a Route for a Tunnel</title>
</head>
<body><a name="EN-US_TASK_0172369081"></a><a name="EN-US_TASK_0172369081"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a Route for a Tunnel</h1>
<div class="taskbody"><p>A route for a tunnel must be available on both the source and destination devices so that packets encapsulated with GRE can be forwarded correctly. A route passing through a tunnel interface can be either a static or dynamic route.</p>
<div class="context"><a name="EN-US_TASK_0172369081__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><div class="p">A route for a tunnel must be available on both the local and remote devices so that packets encapsulated by GRE can be forwarded properly. The route can be either a static or dynamic route. When configuring a route for a tunnel, note the following:<ul><li><p>If the route is a static route, it must be configured on both the source and destination devices. The destination address of the route is the original destination address of the packet before GRE encapsulation, rather than the destination address of the tunnel or the address of the peer tunnel interface. The outbound interface is the local tunnel interface.</p>
</li><li><p>When configuring a dynamic routing protocol, you need to enable the protocol on both the tunnel interface and the <span class="keyword">Router</span> interface connected to the VPN. When configuring a route to the actual destination interface address of a tunnel, ensure that the next hop is not the tunnel interface address. Otherwise, GRE-encapsulated packets cannot be forwarded properly.</p>
<p>As shown in <a href="#EN-US_TASK_0172369081__fig_dc_vrp_gre_cfg_200501">Figure 1</a>, the source interface of Tunnel1 is interface1 on <span class="keyword">Device</span>A, and the destination physical interface of Tunnel1 is interface2 on <span class="keyword">Device</span>C. When configuring a dynamic routing protocol, you need to enable the protocol on both the tunnel interface and the interface connected to the PC. In the routing table, the outbound interface for the route to interface2 on <span class="keyword">Device</span>C cannot be Tunnel1.</p>
<p>In practical configurations, different routing protocols or different processes of the same routing protocol need to be used for tunnel interfaces and public network physical interfaces. This prevents a tunnel interface from being selected as an outbound interface of routes to the destination of the tunnel. In addition, this also ensures that users packets are forwarded through the tunnel instead of the physical interface.</p>
<div class="fignone" id="EN-US_TASK_0172369081__fig_dc_vrp_gre_cfg_200501"><a name="EN-US_TASK_0172369081__fig_dc_vrp_gre_cfg_200501"></a><a name="fig_dc_vrp_gre_cfg_200501"></a><span class="figcap"><b>Figure 1 </b>Configuring a GRE dynamic routing protocol</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 4 in this example represent GE<span>0/1/0</span>, GE<span>0/2/0</span>, Tunnel1, and Tunnel2, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001571737800.png"></span></div>
</li></ul>
</div>
<p>Perform the following steps on the endpoint <span class="keyword">Router</span>s of a tunnel.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172369081__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Choose one of the following methods to configure routes passing through the tunnel interface.</span><p><ul><li><p>Run the <a href="cmdqueryname=ip+route-static"><b><span class="cmdname">ip route-static</span></b></a> <i><span class="varname">dest-ip-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } <strong><span>tunnel</span></strong> <i><span class="varname">interface-number</span></i> [ <strong><span>description</span></strong> <i><span class="varname">text</span></i> ] command to configure a static route.</p>
</li><li><p>Configure a dynamic routing protocol, which can be IGP or BGP. The detailed configuration is not provided here. For the configuration of dynamic routes, see the <em><span class="keyword">NE40E</span> Configuration Guide - IP Routing</em>.</p>
</li></ul>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0172369081__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Follow-up Procedure</h4>
<div class="p"><div class="p">To implement millisecond-level fault detection for a GRE tunnel, configure the following BFD functions on the GRE tunnel interface:<ul><li><p><a href="dc_vrp_rip_cfg_0055.html">Configure dynamic BFD for RIP</a></p>
</li><li><p><a href="dc_vrp_ospf_cfg_2048.html">Configure BFD for OSPF on a specified interface</a></p>
</li><li><p><a href="dc_vrp_isis_cfg_0043.html">Configure dynamic BFD for IS-IS</a></p>
</li></ul>
</div>
</div></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gre_cfg_2003.html">Configuring a GRE Tunnel
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gre_cfg_2004.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_gre_cfg_1001.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>