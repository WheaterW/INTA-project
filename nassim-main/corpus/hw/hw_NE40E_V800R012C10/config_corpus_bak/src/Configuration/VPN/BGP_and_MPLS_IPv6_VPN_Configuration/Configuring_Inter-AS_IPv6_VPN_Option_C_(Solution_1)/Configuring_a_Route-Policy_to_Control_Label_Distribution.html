
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a Route-Policy to Control Label Distribution">
<meta name="abstract" content="You need to configure a route-policy to control label allocation for the inter-AS BGP LSP. If labeled IPv4 routes are advertised to the PE of the local AS, you need to re-allocate the MPLS label to these routes. If routes sent by the PE of the local AS are advertised to the peer ASBR, you need to allocate the MPLS label to these routes.">
<meta name="description" content="You need to configure a route-policy to control label allocation for the inter-AS BGP LSP. If labeled IPv4 routes are advertised to the PE of the local AS, you need to re-allocate the MPLS label to these routes. If routes sent by the PE of the local AS are advertised to the peer ASBR, you need to allocate the MPLS label to these routes.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2083.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2084.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2086.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,l3vpnvrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="h00847023">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00847023">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369645">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a Route-Policy to Control Label Distribution</title>
</head>
<body><a name="EN-US_TASK_0172369645"></a><a name="EN-US_TASK_0172369645"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a Route-Policy to Control Label Distribution</h1>
<div class="taskbody"><p>You need to configure a route-policy to control label allocation for the inter-AS BGP LSP. If labeled IPv4 routes are advertised to the PE of the local AS, you need to re-allocate the MPLS label to these routes. If routes sent by the PE of the local AS are advertised to the peer ASBR, you need to allocate the MPLS label to these routes.</p>
<div class="context"><a name="EN-US_TASK_0172369645__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>The MPLS label distribution for IPv4 routes is controlled by the routing policy. Labels are distributed to the routes that satisfy certain requirements.</p>
<p>Perform the following steps on the ASBR.</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172369645__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Create a route-policy.</span><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=route-policy"><b><span class="cmdname">route-policy</span></b></a> <i><span class="varname">policy-name1</span></i> <strong><span>permit</span></strong> <strong><span>node</span></strong> <i><span class="varname">seq-number</span></i></span></span><p><p>A route-policy applied to the local PE is created. For labeled IPv4 routes advertised to PEs in the same AS, the PE reallocates MPLS labels to the routes.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=if-match+mpls-label"><b><span class="cmdname">if-match mpls-label</span></b></a></span></span><p><p>IPv4 routes with labels are matched.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=apply+mpls-label"><b><span class="cmdname">apply mpls-label</span></b></a></span></span><p><p>Labels are allocated to IPv4 routes.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=route-policy"><b><span class="cmdname">route-policy</span></b></a> <i><span class="varname">policy-name2</span></i> <strong><span>permit</span></strong> <strong><span>node</span></strong> <i><span class="varname">seq-number</span></i></span></span><p><p>The route-policy applied to the peer ASBR is created.</p>
<p>For labeled IPv4 routes advertised to PEs in the same AS, the ASBR re-allocates MPLS labels to the routes.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=apply+mpls-label"><b><span class="cmdname">apply mpls-label</span></b></a></span></span><p><p>The label is allocated to the IPv4 route.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Apply the route-policy.</span><p><p>The route-policy applies to the ASBR.</p>
</p><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>route-policy</span></strong> <i><span class="varname">policy-name1</span></i> <strong><span>export</span></strong></span></span><p><p>The route-policy adopted when routes are advertised to the local PE is applied.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>route-policy</span></strong> <i><span class="varname">policy-name2</span></i> <strong><span>export</span></strong></span></span><p><p>The route-policy adopted when the routes are advertised to the peer ASBR is applied.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2083.html">Configuring Inter-AS IPv6 VPN Option C (Solution 1)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2084.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2086.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>