
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a BGP EVPN Peer Relationship">
<meta name="abstract" content="After two provider edges (PEs) establish a Border Gateway Protocol (BGP) Ethernet VPN (EVPN) peer relationship, they can exchange EVPN routes.">
<meta name="description" content="After two provider edges (PEs) establish a Border Gateway Protocol (BGP) Ethernet VPN (EVPN) peer relationship, they can exchange EVPN routes.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_pbb-evpn_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_pbb-evpn_cfg_0006.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_pbb-evpn_cfg_0008.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,pbb-evpnvrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="PBB-EVPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="PBB-EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="PBB-EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="PBB-EVPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="p00915595">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00878323">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172370736">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a BGP EVPN Peer Relationship</title>
</head>
<body><a name="EN-US_TASK_0172370736"></a><a name="EN-US_TASK_0172370736"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a BGP EVPN Peer Relationship</h1>
<div class="taskbody"><p>After two provider edges (PEs) establish a Border Gateway Protocol (BGP) Ethernet VPN (EVPN) peer relationship, they can exchange EVPN routes.</p>
<div class="context"><a name="EN-US_TASK_0172370736__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>In provider backbone bridge (PBB)-EVPN networking, PEs need to have BGP EVPN peer relationships established before they can exchange EVPN routes and implement communication between EVPN instances.</p>
<p>Perform the following steps on each PE.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172370736__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span></span><p><p>The BGP view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=peer+as-number"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>as-number</span></strong> <i><span class="varname">as-number</span></i></span><p><p>A remote PE is configured as a peer.</p>
</p></li><li><span>Run <a href="cmdqueryname=peer+connect-interface"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <a href="cmdqueryname=connect-interface"><b><span class="cmdname">connect-interface</span></b></a> <strong><span>loopback</span></strong> <i><span class="varname">interface-number</span></i></span><p><p>The interface used by BGP to set up a TCP connection is specified.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>A PE must use a loopback interface address with a 32-bit mask to set up an MP-IBGP peer relationship with the peer PE, so that routes can recurse to tunnels. EVPN routes destined for a loopback interface address are advertised to the peer device using an Interior Gateway Protocol (IGP) on the Multiprotocol Label Switching (MPLS) backbone network.</p>
</div></div>
</p></li><li><span>Run <span><a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname">l2vpn-family evpn</span></b></a></span></span><p><p>The BGP-EVPN address family view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=peer+enable"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>enable</span></strong></span><p><p>The capability to exchange EVPN routes with the specified peer or peer group is enabled.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=peer+group"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>group</span></strong> <i><span class="varname">group-name</span></i></span><p><p>The BGP EVPN peer is added to a peer group.</p>
<p>Adding BGP EVPN peers to peer groups simplifies BGP network configuration and management.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=timer+df-delay"><b><span class="cmdname">timer df-delay</span></b></a> <i><span class="varname">delay-value</span></i></span><p><p>A designated forwarder (DF) election delay is configured.</p>
</p><p><p>If a network is unstable, PE interfaces connecting to CEs will frequently alternate between up and down, resulting in frequent DF elections and subsequent network performance deterioration. To prevent frequent DF elections, run the <a href="cmdqueryname=timer+df-delay"><b><span class="cmdname">timer df-delay</span></b></a> command to set a longer DF election delay to improve network stability.</p>
<p>In a PBB-EVPN dual-homing scenario where interface-based DF election is enabled, you need to run this command to set the DF election delay to 0s to prevent traffic interruption caused by the long-time existence of dual backup devices during switchback.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=peer+mac-limit"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">group-name</span></i> | <i><span class="varname">ipv4-address</span></i> } <a href="cmdqueryname=mac-limit"><b><span class="cmdname">mac-limit</span></b></a> <i><span class="varname">number</span></i> [ <i><span class="varname">percentage</span></i> ] [ <strong><span>alert-only</span></strong> | <strong><span>idle-forever</span></strong> | <strong><span>idle-timeout</span></strong> <i><span class="varname">times</span></i> ]</span><p><p>The maximum number of MAC advertisement routes that can be received from each peer is configured.</p>
</p><p><p>If an EVPN instance imports many invalid MAC advertisement routes from peers and these routes occupy a large proportion of the total MAC advertisement routes, run the <a href="cmdqueryname=mac-limit"><b><span class="cmdname">mac-limit</span></b></a> command to configure the maximum number of MAC advertisement routes that can be received from each peer. If the number of received MAC advertisement routes exceeds the specified maximum number, the system displays an alarm, instructing you to check the validity of the MAC advertisement routes received in the EVPN instance.</p>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_pbb-evpn_cfg_0001.html">Configuring PBB-EVPN
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_pbb-evpn_cfg_0006.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_pbb-evpn_cfg_0008.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>