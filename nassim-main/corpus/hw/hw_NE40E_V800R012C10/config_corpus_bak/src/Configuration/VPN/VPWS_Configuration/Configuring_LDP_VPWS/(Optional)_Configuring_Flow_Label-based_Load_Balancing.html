
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring Flow Label-based Load Balancing">
<meta name="abstract" content="Flow label-based load balancing enables L2VPN data flows on a PW to be load-balanced over tunnels between P devices based on flow labels, improving forwarding efficiency.">
<meta name="description" content="Flow label-based load balancing enables L2VPN data flows on a PW to be load-balanced over tunnels between P devices based on flow labels, improving forwarding efficiency.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_3004.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6006.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00415692">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="q00824768">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369796">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring Flow Label-based Load Balancing</title>
</head>
<body><a name="EN-US_TASK_0172369796"></a><a name="EN-US_TASK_0172369796"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring Flow Label-based Load Balancing</h1>
<div class="taskbody" id="taskbody1966772985214052"><p id="shortdesc251865462214052">Flow label-based load balancing enables L2VPN data flows on a PW to be load-balanced over tunnels between P devices based on flow labels, improving forwarding efficiency.</p>
<div class="context"><a name="EN-US_TASK_0172369796__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p" id="EN-US_TASK_0172369796__context486689969214052"><p id="EN-US_TASK_0172369796__p33097560214052">When multiple links exist between P devices, configure flow label-based load balancing to improve L2VPN traffic forwarding efficiency. After flow label-based load balancing is enabled on a PE, the PE adds different labels for different L2VPN data flows to distinguish them one from the other. After a P device receives a data packet carrying a flow label, it performs the Hash calculation and selects a forwarding path based on the flow label in the data packet. This processing implements load balancing. To enable flow label-based load balancing for PWs, run the <a href="cmdqueryname=flow-label"><b><span class="cmdname" id="EN-US_TASK_0172369796__cmdname21552368214342">flow-label</span></b></a> command.</p>
<div class="note" id="EN-US_TASK_0172369796__note1793869827214052"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172369796__p1047262156214052">Currently, only LDP VPWS, LDP VPLS, static VPWS, and static VPLS support flow label-based load balancing.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172369796__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0172369796__steps1733116262214052"><li id="EN-US_TASK_0172369796__step1499871725214052"><span id="EN-US_TASK_0172369796__cmd558995197214342">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172369796__cmdname2007169366214342">system-view</span></b></a></span><p><p id="EN-US_TASK_0172369796__p1092223210214342">The system view is displayed.</p>
</p></li><li id="EN-US_TASK_0172369796__step1446511217214052"><span id="EN-US_TASK_0172369796__cmd1999140079214052">(Optional) Run <a href="cmdqueryname=flow-label+hash-fields"><b><span class="cmdname" id="EN-US_TASK_0172369796__cmdname458823780214342">flow-label hash-fields</span></b></a> { <strong><span id="EN-US_TASK_0172369796__cmdparmname252636510214342">l2</span></strong> | <strong><span id="EN-US_TASK_0172369796__cmdparmname1152723553214342">l3</span></strong> | <strong><span id="EN-US_TASK_0172369796__cmdparmname1431015372214342">l4</span></strong> }</span><p><p id="EN-US_TASK_0172369796__p12619114218299">The hash factor for flow label-based load balancing is configured.</p>
</p><p><p id="EN-US_TASK_0172369796__p752418495214052">This command takes effect only after PW L2VPN flow label-based load balancing is enabled in the interface view.</p>
<p id="EN-US_TASK_0172369796__p1267681047214052">This command is supported only by the admin VS.</p>
</p></li><li id="EN-US_TASK_0172369796__step952207813214052"><span id="EN-US_TASK_0172369796__cmd1927827016214342">Run <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0172369796__cmdname1204672777214342">interface</span></b></a> <i><span class="varname" id="EN-US_TASK_0172369796__varname1728016554214342">interface-type</span></i> <i><span class="varname" id="EN-US_TASK_0172369796__varname93460707214342">interface-number</span></i></span><p><p id="EN-US_TASK_0172369796__p1278201251214342">The AC interface view is displayed.</p>
</p></li><li id="EN-US_TASK_0172369796__step1933687978214052"><span id="EN-US_TASK_0172369796__cmd1623816195214052">Run <a href="cmdqueryname=mpls+l2vpn+flow-label"><b><span class="cmdname" id="EN-US_TASK_0172369796__cmdname774911068214342">mpls l2vpn flow-label</span></b></a> { <strong><span id="EN-US_TASK_0172369796__cmdparmname448045195214342">both</span></strong> | <strong><span id="EN-US_TASK_0172369796__cmdparmname1988379784214342">send</span></strong> | <strong><span id="EN-US_TASK_0172369796__cmdparmname720288723214342">receive</span></strong> } [ <strong><span id="EN-US_TASK_0172369796__cmdparmname1322557955214342">secondary</span></strong> ] [ <strong><span id="EN-US_TASK_0172369796__cmdparmname1523380352214342">static</span></strong> ]</span><p><p id="EN-US_TASK_0172369796__p207071717613">Flow label-based load balancing is enabled for PWs on the interface.</p>
</p><p><div class="note" id="EN-US_TASK_0172369796__note1198445959214052"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul id="EN-US_TASK_0172369796__ul1032107700214052"><li id="EN-US_TASK_0172369796__li2112115839214052"><div class="p" id="EN-US_TASK_0172369796__p426221163214052"><a name="EN-US_TASK_0172369796__li2112115839214052"></a><a name="li2112115839214052"></a>Flow label-based load balancing can be enabled only when any of the following conditions is met:<ul id="EN-US_TASK_0172369796__ul307692791214052"><li id="EN-US_TASK_0172369796__li334443796214052">The <strong><span id="EN-US_TASK_0172369796__cmdparmname19973437214342">receive</span></strong> parameter is configured on the local PE, and the <strong><span id="EN-US_TASK_0172369796__cmdparmname643659256214342">send</span></strong> parameter is configured on the remote PE.</li><li id="EN-US_TASK_0172369796__li499740844214052">The <strong><span id="EN-US_TASK_0172369796__cmdparmname2075122050214342">send</span></strong> parameter is configured on the local PE, and the <strong><span id="EN-US_TASK_0172369796__cmdparmname395712195214342">receive</span></strong> parameter is configured on the remote PE.</li><li id="EN-US_TASK_0172369796__li954852485214052">Both the <strong><span id="EN-US_TASK_0172369796__cmdparmname509603500214342">send</span></strong> and <strong><span id="EN-US_TASK_0172369796__cmdparmname1737779448214342">receive</span></strong> parameters are configured on the local and remote PEs.</li></ul>
</div>
</li><li id="EN-US_TASK_0172369796__li456734084214052"><p id="EN-US_TASK_0172369796__p1223195410214052"><a name="EN-US_TASK_0172369796__li456734084214052"></a><a name="li456734084214052"></a>If <strong><span id="EN-US_TASK_0172369796__cmdparmname2031742000214342">secondary</span></strong> is configured, the flow label-based load balancing capability takes effect only for the secondary PW on the interface. If <strong><span id="EN-US_TASK_0172369796__cmdparmname718145808214342">secondary</span></strong> is not configured, the flow label-based load balancing capability takes effect only for the primary PW on the interface.</p>
</li><li id="EN-US_TASK_0172369796__li1490041983214052"><p id="EN-US_TASK_0172369796__p1328800614214052"><a name="EN-US_TASK_0172369796__li1490041983214052"></a><a name="li1490041983214052"></a>If <strong><span id="EN-US_TASK_0172369796__cmdparmname1982990781214342">static</span></strong> is configured, the flow label-based load balancing capability is statically configured. The endpoint PEs deliver the flow label-based load balancing capability, irrespective of whether the other end has the capability enabled. For dynamic PWs, if <strong><span id="EN-US_TASK_0172369796__cmdparmname444893890214342">static</span></strong> is not configured, the flow label-based load balancing capability of the local end is negotiated by the remote end. For static PWs, the flow label-based load balancing capability is statically configured, irrespective of whether <strong><span id="EN-US_TASK_0172369796__cmdparmname731081893214342">static</span></strong> is configured.</p>
<p id="EN-US_TASK_0172369796__p83324148214052">If the static flow label-based load balancing configuration does not match on both ends, the device discards packets carrying a flow label, causing packet loss.</p>
</li></ul>
</div></div>
</p></li><li id="EN-US_TASK_0172369796__step299966368214052"><span id="EN-US_TASK_0172369796__cmd1584998140214342">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172369796__cmdname543803810214342">commit</span></b></a></span><p><p id="EN-US_TASK_0172369796__p422999197214342">The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_3004.html">Configuring LDP VPWS
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6006.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>