
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a Routing Protocol on an MCE">
<meta name="abstract" content="To enable a multi-VPN-instance customer edge (MCE) to communicate with provider edge (PE) and virtual private network (VPN) devices, configure a routing protocol for each type of service on the MCE.">
<meta name="description" content="To enable a multi-VPN-instance customer edge (MCE) to communicate with provider edge (PE) and virtual private network (VPN) devices, configure a routing protocol for each type of service on the MCE.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2070.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2072.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,l3vpnvrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="h00847023">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="ccms">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369670">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a Routing Protocol on an MCE</title>
</head>
<body><a name="EN-US_TASK_0172369670"></a><a name="EN-US_TASK_0172369670"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a Routing Protocol on an MCE</h1>
<div class="taskbody"><p>To enable a multi-VPN-instance customer edge (MCE) to communicate with provider edge (PE) and virtual private network (VPN) devices, configure a routing protocol for each type of service on the MCE.</p>
<div class="context"><a name="EN-US_TASK_0172369670__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><div class="p">An MCE can communicate with PEs and VPN devices using any of the following routing protocols: BGP4+, IPv6 static route, RIPng, OSPFv3, or IS-ISv6. Select one of the following configuration procedures:<ul><li><a href="#EN-US_TASK_0172369670__step_dc_vrp_mpls-l3vpn-v6_cfg_207101">Configure BGP4+ on the MCE.</a></li><li><a href="#EN-US_TASK_0172369670__step_dc_vrp_mpls-l3vpn-v6_cfg_207103">Configure a static route on the MCE.</a></li><li><a href="#EN-US_TASK_0172369670__step_dc_vrp_mpls-l3vpn-v6_cfg_207104">Configure RIPng on the MCE.</a></li><li><a href="#EN-US_TASK_0172369670__step_dc_vrp_mpls-l3vpn-v6_cfg_207105">Configure OSPFv3 on the MCE.</a></li><li><a href="#EN-US_TASK_0172369670__step_dc_vrp_mpls-l3vpn-v6_cfg_207106">Configure IS-ISv6 on the MCE.</a></li></ul>
</div>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172369670__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li id="EN-US_TASK_0172369670__step_dc_vrp_mpls-l3vpn-v6_cfg_207101"><span id="EN-US_TASK_0172369670__">Configure BGP4+ on the MCE.</span><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=ipv6-family"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i></span></span><p><p>The BGP-VPN instance IPv6 address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv6-address</span></i> <strong><span>as-number</span></strong> <i><span class="varname">as-number</span></i></span></span><p><p>A PE is configured as a VPN BGP peer for the MCE.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <span><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> } <a href="cmdqueryname=ebgp-max-hop"><b><span class="cmdname">ebgp-max-hop</span></b></a> [ <i><span class="varname">hop-count</span></i> ]</span></span><p><p>The maximum number of hops between the MCE and its EBGP peer (the PE) is set.</p>
</p><p><p>This step is mandatory if the MCE is not directly connected to the PE. Generally, EBGP peers are directly connected. If they are not directly connected, run the <a href="cmdqueryname=peer+ebgp-max-hop"><b><span class="cmdname">peer ebgp-max-hop</span></b></a> command so that EBGP peers can establish a multi-hop Transmission Control Protocol (TCP) connection.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0172369670__step_dc_vrp_mpls-l3vpn-v6_cfg_207103"><span id="EN-US_TASK_0172369670__">Configure a static route on the MCE.</span><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=ipv6+route-static+vpn-instance"><b><span class="cmdname">ipv6 route-static vpn-instance</span></b></a> <i><span class="varname">vpn-source-name</span></i> <i><span class="varname">destination-ipv6-address</span></i> <i><span class="varname">prefix-length</span></i> <i><span class="varname">interface-type interface-number</span></i> [ <i><span class="varname">nexthop-ipv6-address</span></i> ] [ <strong><span>preference</span></strong> <i><span class="varname">preference</span></i> | <strong><span>tag</span></strong> <i><span class="varname">tag</span></i> ] <sup>*</sup></span></span><p><p>A static route is configured for a specified VPN instance IPv6 address family.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0172369670__step_dc_vrp_mpls-l3vpn-v6_cfg_207104"><span id="EN-US_TASK_0172369670__">Configure RIPng on the MCE.</span><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=ripng"><b><span class="cmdname">ripng</span></b></a> <i><span class="varname">process-id</span></i> <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i></span></span><p><p>A RIPng process is created, and the RIPng view is displayed. A RIPng process can be bound only to one VPN instance. If you do not specify a VPN instance when creating a RIPng process, this RIPng process is a public network process and can no longer be bound to a VPN instance.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
<p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Deleting a VPN instance or disabling a VPN instance IPv6 address family will also delete all the RIPng processes bound to this VPN instance or VPN instance IPv6 address family.</p>
</div></div>
</p></li><li id="EN-US_TASK_0172369670__step_dc_vrp_mpls-l3vpn-v6_cfg_207105"><span id="EN-US_TASK_0172369670__">Configure OSPFv3 on the MCE.</span><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=ospfv3"><b><span class="cmdname">ospfv3</span></b></a> [ <i><span class="varname">process-id</span></i> ] <strong><span>vpn-instance</span></strong> <i><span class="varname">vpnname</span></i></span></span><p><p>An OSPFv3 process is created, and the OSPFv3 view is displayed.</p>
</p><p><p>Create the same OSPFv3 process on the MCE and its connected PE. An OSPFv3 process can be bound only to one VPN instance.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <span><a href="cmdqueryname=domain-id"><b><span class="cmdname">domain-id</span></b></a> { <i><span class="varname">domain-id-int</span></i> | <i><span class="varname">domain-id-ipaddr</span></i> }</span></span><p><p>A domain ID is set.</p>
<p>The domain ID can be an integer or in dotted decimal notation.</p>
<p>Generally, the routes that are imported from a PE are advertised as External-LSAs. The routes that belong to different nodes of the same OSPFv3 domain are advertised as Type-3 LSAs (intra-domain routes). This requires that different nodes in the same OSPFv3 domain have the same domain ID.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <span><a href="cmdqueryname=route-tag"><b><span class="cmdname">route-tag</span></b></a> <i><span class="varname">tag-value</span></i></span></span><p><p>A tag value is set.</p>
</p><p></p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=vpn-instance-capability+simple"><b><span class="cmdname">vpn-instance-capability simple</span></b></a></span></span><p><p>Rout loop detection is disabled.</p>
<p>If OSPFv3 VPN multi-VPN-instance has been deployed on the MCE and PE, the PE sends the MCE a link-state advertisement (LSA) with the Down (DN) bit set to 1. Because VPN instances have been configured on the MCE, the MCE has routing loop detection enabled. If the MCE detects that the LSA contains the DN bit with the value 1, this LSA cannot be used to calculate routes. Run the <a href="cmdqueryname=vpn-instance-capability+simple"><b><span class="cmdname">vpn-instance-capability simple</span></b></a> command to disable OSPFv3 routing loop detection. When OSPFv3 routing loop detection is disabled, the MCE calculates all OSPFv3 routes without checking the DN bit and route tag.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span></span><p><p>The view of the interface bound to the VPN instance is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=ospfv3"><b><span class="cmdname">ospfv3</span></b></a> <i><span class="varname">process-id</span></i> <strong><span>area</span></strong> <i><span class="varname">area-id</span></i> [ <strong><span>instance</span></strong> <i><span class="varname">instance-id</span></i> ]</span></span><p><p>OSPFv3 is enabled on the interface.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
<p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Deleting a VPN instance or disabling a VPN instance IPv6 address family will also delete all the OSPFv3 processes bound to this VPN instance or VPN instance IPv6 address family.</p>
</div></div>
</p></li><li id="EN-US_TASK_0172369670__step_dc_vrp_mpls-l3vpn-v6_cfg_207106"><span id="EN-US_TASK_0172369670__">Configure IS-ISv6 on the MCE.</span><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=isis"><b><span class="cmdname">isis</span></b></a> <i><span class="varname">process-id</span></i> <strong><span>vpn-instance</span></strong> <em>vpn-instance-name</em></span><p><p>An IS-IS instance is created on the MCE, and the IS-IS view is displayed.</p>
<p>An IS-IS process can be bound only to one VPN instance. If you do not specify a VPN instance when creating an IS-IS process, this IS-IS process is a public network process and can no longer be bound to a VPN instance.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=network-entity"><b><span class="cmdname">network-entity</span></b></a> <i><span class="varname">net-addr</span></i></span></span><p><p>The network entity title (NET) is set.</p>
<p>A NET contains the current IS-IS area address and the system ID of the router. A maximum of three NETs can be set in one IS-IS process.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <span><a href="cmdqueryname=is-level"><b><span class="cmdname">is-level</span></b></a> { <strong><span>level-1</span></strong> | <strong><span>level-1-2</span></strong> | <strong><span>level-2</span></strong> }</span></span><p><p>An IS-IS level is specified for the router.</p>
</p><p></p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv6+enable+%28IS-IS+view%29"><b><span class="cmdname">ipv6 enable</span></b></a> [ <strong><span>topology</span></strong> { <strong><span>compatible</span></strong> [ <strong><span>enable-mt-spf</span></strong> ] | <strong><span>ipv6</span></strong> | <strong><span>standard</span></strong> } ]</span><p><p>IPv6 is enabled for the IS-IS process.</p>
<p>IPv6 can be enabled for an IS-IS process only after being enabled in the system view.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span></span><p><p>The view of the interface to be bound to the VPN instance is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=isis+ipv6+enable"><b><span class="cmdname">isis ipv6 enable</span></b></a> [ <i><span class="varname">process-id</span></i> ]</span></span><p><p>IS-ISv6 is enabled on the interface.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
<p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Deleting a VPN instance or disabling a VPN instance IPv6 address family will also delete all the IS-IS processes bound to this VPN instance or VPN instance IPv6 address family.</p>
</div></div>
</p></li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2070.html">Configuring an MCE (IPv6)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2072.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>