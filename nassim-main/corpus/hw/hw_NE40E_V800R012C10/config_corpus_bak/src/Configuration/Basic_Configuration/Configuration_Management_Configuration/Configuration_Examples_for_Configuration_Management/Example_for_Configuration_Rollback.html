
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuration Rollback">
<meta name="abstract" content="This section provides an example for configuration rollback where a user detects an IP address configuration error and expects system configurations to roll back to what they were before the IP addresses were configured.">
<meta name="description" content="This section provides an example for configuration rollback where a user detects an IP address configuration error and expects system configurations to roll back to what they were before the IP addresses were configured.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfgm_cfg_0031.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfgm_cfg_0035.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfgm_cfg_0036.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,cfgmvrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Configuration Management">
<meta name="featuretype" content="Basic Configurations">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Configuration Management">
<meta name="featuretype" content="Basic Configurations">
<meta name="featurename" content="Configuration Management">
<meta name="featuretype" content="Basic Configurations">
<meta name="featurename" content="Configuration Management">
<meta name="featuretype" content="Basic Configurations">
<meta name="OWNER" content="lwx1238418">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00830490">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172360025">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuration Rollback</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172360025"></a><a name="EN-US_TASK_0172360025"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuration Rollback</h1>
<div class="taskbody"><p>This section provides an example for configuration rollback where a user detects an IP address configuration error and expects system configurations to roll back to what they were before the IP addresses were configured.</p>
<div class="context"><a name="EN-US_TASK_0172360025__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0172360025__fig_dc_vrp_cfgm_cfg_004501">Figure 1</a>, a user logs in to the <span class="keyword">Router</span> and configures IP addresses for interfaces on the <span class="keyword">Router</span>. After the IP addresses of interfaces are configured, the user detects an IP address planning error and expects to reconfigure the IP addresses of interfaces. Traditionally speaking, the user must delete the IP addresses one by one and reconfigure them.</p>
<p>Configuration rollback simplifies configuration restoration. Configuration rollback allows the user to easily roll system configurations back to what they were before the IP addresses were configured.</p>
<div class="fignone" id="EN-US_TASK_0172360025__fig_dc_vrp_cfgm_cfg_004501"><a name="EN-US_TASK_0172360025__fig_dc_vrp_cfgm_cfg_004501"></a><a name="fig_dc_vrp_cfgm_cfg_004501"></a><span class="figcap"><b>Figure 1 </b>Configuration rollback</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 4 in this example represent GE <span>0/1/0</span>, GE <span>0/1/1</span>, GE <span>0/1/2</span>, and GE <span>0/1/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_cfgm_cfg_004501.png"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172360025__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>None</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172360025__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure IP addresses for interfaces on the <span class="keyword">Router</span>.</p>
</li><li><p>Check information about configuration rollback points and configuration changes at the most recent configuration rollback points.</p>
</li><li><p>Perform configuration rollback by selecting a configuration rollback point to which system configurations are expected to roll back or the number of configuration rollback points that a configuration rollback operation is expected to undergo.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172360025__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>GE <span>0/1/0</span>, GE <span>0/1/1</span>, GE <span>0/1/2</span>, and GE <span>0/1/3</span> on the <span class="keyword">Router</span></p>
</li><li><p>IP addresses for the preceding interfaces: 10.0.0.1/30, 10.0.1.1/30, 10.0.2.1/30, and 10.0.3.1/30</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172360025__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure IP addresses for GE <span>0/1/0</span>, GE <span>0/1/1</span>, GE 0/1/2, and GE <span>0/1/3</span> on the <span class="keyword">Router</span>.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/0</span>] <strong>ip address 10.0.0.1 30</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/1</span>] <strong>ip address 10.0.1.1 30</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/2</span>] <strong>ip address 10.0.2.1 30</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/3</span>] <strong>ip address 10.0.3.1 30</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/3</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit description IP address</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>quit</strong></pre>
</p></li><li><span>Check information about configuration rollback points and the differences between the previous and current configurations.</span><p><p># Display information about configuration rollback points.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>display configuration commit list verbose</strong></pre>
<pre class="screen">1) CommitId: 1000000006
        Label: -
        User: root
        User-Intf: VTY 1
        Type: CLI
        TimeStamp: 2012-06-29 15:55:20
        Description: IP address 

2) CommitId: 1000000005
        Label: -
        User: root
        User-Intf: VTY 0
        Type: CLI
        TimeStamp: 2012-06-29 11:04:05
        Description: 

3) CommitId: 1000000004
        Label: -
        User: root
        User-Intf: VTY 0
        Type: CLI
        TimeStamp: 2012-06-29 09:57:34
        Description: 

4) CommitId: 1000000003
        Label: -
        User: root
        User-Intf: VTY 0
        Type: CLI
        TimeStamp: 2012-06-29 09:57:21
        Description: 

5) CommitId: 1000000002
        Label: -
        User: anonymous
        User-Intf: CON 1023
        Type: CLI
        TimeStamp: 2012-06-28 16:31:48
        Description: 

6) CommitId: 1000000001
        Label: -
        User: anonymous
        User-Intf: CON 1023
        Type: CLI
        TimeStamp: 2012-06-28 16:31:48
        Description:</pre>
<p># Display the configuration changes at the most recent configuration rollback point.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>display configuration commit changes last 1</strong></pre>
<pre class="screen">Building configuration

  #
  interface GigabitEthernet<span>0/1/0</span>
+  ip address 10.0.0.1 255.255.255.252
  #
  interface GigabitEthernet<span>0/1/1</span>
+  ip address 10.0.1.1 255.255.255.252
  #
  interface GigabitEthernet<span>0/1/2</span>
+  ip address 10.0.2.1 255.255.255.252
  #
  interface GigabitEthernet<span>0/1/3</span>
+  ip address 10.0.3.1 255.255.255.252
  #</pre>
</p></li><li><span>Perform configuration rollback.</span><p><p># Roll system configurations back to what they were before the most recent configuration rollback point was created.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, the <a href="cmdqueryname=rollback+configuration+last+1"><b><span class="cmdname">rollback configuration last 1</span></b></a> command has the same return result as the <a href="cmdqueryname=rollback+configuration+to+commit-id+1000000005"><b><span class="cmdname">rollback configuration to commit-id 1000000005</span></b></a> command, both indicating that system configurations are rolled back to what they were before configuration rollback point 6 was generated.</p>
</div></div>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> rollback configuration last 1</strong></pre>
<p># After the configuration rollback operation is complete, check whether a configuration rollback point has been generated.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> display configuration commit list verbose</strong></pre>
<pre class="screen">1) CommitId: 1000000007
        Label: -
        User: root
        User-Intf: VTY 1
        Type: ROLLBACK
        TimeStamp: 2012-06-29 15:58:22
        Description: 

2) CommitId: 1000000006
        Label: -
        User: root
        User-Intf: VTY 1
        Type: CLI
        TimeStamp: 2012-06-29 15:55:20
        Description: IP address 

3) CommitId: 1000000005
        Label: -
        User: root
        User-Intf: VTY 0
        Type: CLI
        TimeStamp: 2012-06-29 11:04:05
        Description: 

4) CommitId: 1000000004
        Label: -
        User: root
        User-Intf: VTY 0
        Type: CLI
        TimeStamp: 2012-06-29 09:57:34
        Description: 

5) CommitId: 1000000003
        Label: -
        User: root
        User-Intf: VTY 0
        Type: CLI
        TimeStamp: 2012-06-29 09:57:21
        Description: 

6) CommitId: 1000000002
        Label: -
        User: anonymous
        User-Intf: CON 1023
        Type: CLI
        TimeStamp: 2012-06-28 16:31:48
        Description: 

7) CommitId: 1000000001
        Label: -
        User: anonymous
        User-Intf: CON 1023
        Type: CLI
        TimeStamp: 2012-06-28 16:31:48
        Description: </pre>
</p></li><li><span>Verify the configuration.</span><p><p># Check that the configuration rollback operation is successful.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> display current-configuration interface</strong></pre>
<pre class="screen">#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/3</span>
 undo shutdown
#</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172360025__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><p>None.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfgm_cfg_0031.html">Configuration Examples for Configuration Management
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfgm_cfg_0035.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfgm_cfg_0036.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>