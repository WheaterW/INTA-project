
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Using SFTP to Log In to Another Device for File Access (SM2 Authentication Mode)">
<meta name="abstract" content="To allow an SFTP client to log in to an SSH server, configure the client and server to generate local key pairs, configure the server to generate an SM2 public key, and bind the public key to the corresponding user.">
<meta name="description" content="To allow an SFTP client to log in to an SSH server, configure the client and server to generate local key pairs, configure the server to generate an SM2 public key, and bind the public key to the corresponding user.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vfm_cfg_0022.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_basic_cfg_0121_2.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vfm_cfg_0027.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="basicvrp,w00800033,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Accessing Other Devices">
<meta name="featuretype" content="Basic Configurations">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="File System Management">
<meta name="featuretype" content="Basic Configurations">
<meta name="featurename" content="File System Management">
<meta name="featuretype" content="Basic Configurations">
<meta name="featurename" content="File System Management">
<meta name="featuretype" content="Basic Configurations">
<meta name="OWNER" content="lwx1238418">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="lwx1238418">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000002055415256">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Using SFTP to Log In to Another Device for File Access (SM2 Authentication Mode)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000002055415256"></a><a name="EN-US_TASK_0000002055415256"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Using SFTP to Log In to Another Device for File Access (SM2 Authentication Mode)</h1>
<div class="taskbody"><p>To allow an SFTP client to log in to an SSH server, configure the client and server to generate local key pairs, configure the server to generate an SM2 public key, and bind the public key to the corresponding user.</p>
<div class="context"><a name="EN-US_TASK_0000002055415256__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_context1643602008214018"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p1750722256214018">SFTP is a secure service over SSH connections. It allows remote users to log in to a device to manage and transfer files with higher security guarantee. Because the device can function as an SFTP client, you can log in to a remote SSH server from the device to implement secure file transfer.</p>
<p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p445074693214018">As shown in <a href="#EN-US_TASK_0000002055415256__en-us_task_0172360145_fig_dc_vrp_basic_cfg_011301">Figure 1</a>, after the SFTP service is enabled on the SSH server, the SFTP clients can log in to the SSH server in RSA, DSA, ECC,<span> SM2,</span> X509v3-SSH-RSA, password, password-RSA, password-ECC, password-DSA,<span> password-SM2,</span> password-X509v3-RSA, or all authentication mode for file access.</p>
<div class="fignone" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_fig_dc_vrp_basic_cfg_011301"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_fig_dc_vrp_basic_cfg_011301"></a><a name="en-us_task_0172360145_fig_dc_vrp_basic_cfg_011301"></a><span class="figcap"><b>Figure 1 </b>Network diagram of using SFTP to log in to another device for file access</span><div class="note" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_note1525024346214018"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p866856277214018">In this example, Interface1 represents <span>GigabitEthernet0/0/0</span>.</p>
</div></div>
<br><span><img id="EN-US_TASK_0000002055415256__en-us_task_0172360145_image16636101873718" src="figure/en-us_image_0000002111416816.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000002055415256__1.4.2"></a><a name="1.4.2"></a>
<div class="p" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_context161743529214018"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p736601280214018">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0000002055415256__en-us_task_0172360145_ol246155479214018"><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_li530388962214018"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p42665637214018"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_li530388962214018"></a><a name="en-us_task_0172360145_li530388962214018"></a>Configure users client001 and client002 on the SSH server to use different authentication modes to log in to the server.</p>
</li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_li841902347214018"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p82995946214018"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_li841902347214018"></a><a name="en-us_task_0172360145_li841902347214018"></a>Configure the SFTP client client002 and SSH server to generate local key pairs, and bind the SM2 public key of the SFTP client to the user client002 so that the client is authenticated when it logs in to the server.</p>
</li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_li1112850892214018"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p1249860121214018"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_li1112850892214018"></a><a name="en-us_task_0172360145_li1112850892214018"></a>Enable the SFTP service on the SSH server.</p>
</li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_li916821360214018"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p821430295214018"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_li916821360214018"></a><a name="en-us_task_0172360145_li916821360214018"></a>Configure a service type and authorized directory for the SSH users.</p>
</li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_li1533810541214018"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p360063999214018"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_li1533810541214018"></a><a name="en-us_task_0172360145_li1533810541214018"></a>Configure users client001 and client002 to log in to the SSH server through SFTP for file access.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000002055415256__1.4.3"></a><a name="1.4.3"></a>
<div class="p" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_context1379188542214018"><h4 class="sectiontitle">Data Preparation</h4><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p1386432872214018">To complete the configuration, you need the following data:</p>
<ul id="EN-US_TASK_0000002055415256__en-us_task_0172360145_ul841507617214018"><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_li1386859283214018"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p156464843214018"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_li1386859283214018"></a><a name="en-us_task_0172360145_li1386859283214018"></a>Authentication mode of the user client001: password authentication</p>
</li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_li230232343214018"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p1896940554214018"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_li230232343214018"></a><a name="en-us_task_0172360145_li230232343214018"></a>Authentication mode of the user client002: SM2 authentication (public key: sm2key001)</p>
</li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_li1052255876214018"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p736674887214018"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_li1052255876214018"></a><a name="en-us_task_0172360145_li1052255876214018"></a>IP address of the SSH server: 10.1.1.2</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000002055415256__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000002055415256__en-us_task_0172360145_steps230300648214018"><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_step1816466013214018"><span id="EN-US_TASK_0000002055415256__en-us_task_0172360145_cmd716754739214018">Configure the server to generate a local key pair.</span><p><pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1286573477214018">&lt;<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword453750472214301">HUAWEI</span>&gt;<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b978818077214301"> system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1450028337214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword311614786214301">*</span><span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1744576916214301">HUAWEI</span>]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1667019248214301"> sysname SSH Server</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1319187506214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword30342278214301">*</span><span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1009042007214301">HUAWEI</span>]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1598417752214301"> commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen2007285421214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword967149881214018"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b321406237214018">ssh server publickey sm2</strong></pre>
</p></li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_step2296535214018"><span id="EN-US_TASK_0000002055415256__en-us_task_0172360145_cmd2090641746214018">Create SSH users on the server.</span><p><div class="note" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_note493511149340"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_p1375967860214018">SSH users can be authenticated in password, RSA, password-RSA, ECC, password-ECC, DSA, password-DSA,<span> SM2, password-SM2,</span> or all mode.</p>
<ul id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_ul1159929835214018"><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_li1926653127214018"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_p1500676023214018"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_li1926653127214018"></a><a name="en-us_task_0172360145_en-us_task_0172360129_li1926653127214018"></a>If the authentication mode of an SSH user is password, password-RSA, password-DSA,<span> password-SM2,</span> or password-ECC, a local user with the same name as the SSH user must be configured.</p>
</li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_li2014671656214018"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_p1211860143214018"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_li2014671656214018"></a><a name="en-us_task_0172360145_en-us_task_0172360129_li2014671656214018"></a>If the authentication mode of an SSH user is RSA, password-RSA, DSA, password-DSA,<span> SM2, password-SM2,</span><span> ECC, password-ECC,</span> or all, the RSA, DSA,<span> SM2,</span><span> or ECC</span> public key generated on the SSH client needs to be saved to the server.</p>
</li></ul>
</div></div>
<p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p1304747404214018"># Configure VTY user interfaces.</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1305021807214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1205288526214301">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1684437032214301"> user-interface vty 0 4</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen2435593214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword2026243954214301">*</span>SSH Server-ui-vty0-4]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b2035005937214301"> authentication-mode aaa</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen991077431214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1009430119214301">*</span>SSH Server-ui-vty0-4]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b297110996214301"> protocol inbound ssh</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1889558203214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1098024309214301">*</span>SSH Server-ui-vty0-4]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b2004221805214301"> commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1392532694214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword573600725214301"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server-ui-vty0-4]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1382585535214301"> quit</strong></pre>
<ul id="EN-US_TASK_0000002055415256__en-us_task_0172360145_ul1317488993214018"><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_li90596821214018"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p94864824214018"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_li90596821214018"></a><a name="en-us_task_0172360145_li90596821214018"></a>Create an SSH user named client001.</p>
<p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p261028253214018"># Create an SSH user named client001 and configure password authentication for it.</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen91256884214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1447828100214018"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1901645965214018"> ssh user client001</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen15307145882310">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1330911581239">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b103093587231"> ssh user client001 authentication-type password</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen5437202613133">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword124478268135">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b8447526111320"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b844712265137">ssh server cipher aes256_gcm aes128_gcm aes256_ctr aes192_ctr aes128_ctr</strong> </pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen273213110133">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword874053111138">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1774063141315"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b0747918111415">ssh server hmac sha2_512 sha2_256</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen988215428135">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1188310424130">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b138835421138"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b212502211144">ssh server key-exchange dh_group_exchange_sha256</strong> </pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1078412488133">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword9792154820136">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b87932048101311"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b4897112513141">ssh server publickey rsa_sha2_256 rsa_sha2_512</strong> </pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen316733075520">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword31771030195519">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b5177133018556"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b81771330205519">ssh server dh-exchange min-len 3072</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen15569191655614">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword257791685610">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b11577181615569"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b2577141617568">ssh client publickey rsa_sha2_256 rsa_sha2_512</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1765015533133">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword56581536137">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b3658553171310"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b12619143211149">ssh client cipher aes256_gcm aes128_gcm aes256_ctr aes192_ctr aes128_ctr </strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen231765871313">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword13261058161310">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b532765851313"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b397963612147">ssh client hmac sha2_512 sha2_256 </strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen168154331414">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword9824531142">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b168241931146"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b0463040131419">ssh client key-exchange dh_group_exchange_sha256</strong> </pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1317494467214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword171884007214018">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b210377169214018"> commit</strong></pre>
<p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p1043851172214018"># Configure a password for the SSH user client001.</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen677599350214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1602553557214018"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b577122243214018"> aaa</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen713915706214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1906765670214018">*</span>SSH Server-aaa]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1587253344214018"> local-user client001 password</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen198865938214018">Please configure the password (<span>8-128</span>)
Enter Password:
Confirm Password:</pre>
<div class="note" id="EN-US_TASK_0000002055415256__note2089184755214018"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_en-us_task_0172359668_p1613320501544">The password must meet the following requirements:</p>
<ul id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_en-us_task_0172359668_ul813517501544"><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_en-us_task_0172359668_li141338508412"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_en-us_task_0172359668_p_1"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_en-us_task_0172359668_li141338508412"></a><a name="en-us_task_0172360145_en-us_task_0172360129_en-us_task_0172359668_li141338508412"></a>The password is entered in man-machine interaction mode. The system does not display the entered password.</p>
</li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_en-us_task_0172359668_li1713412501143"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_en-us_task_0172359668_p_2"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_en-us_task_0172359668_li1713412501143"></a><a name="en-us_task_0172360145_en-us_task_0172360129_en-us_task_0172359668_li1713412501143"></a>A password is a string of 8 to 16 case-sensitive characters and must contain at least two types of the following characters: uppercase letters, lowercase letters, digits, and special characters.</p>
</li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_en-us_task_0172359668_p_3">Special characters exclude question marks (?) and spaces. However, spaces are allowed in the password if the password is enclosed in quotation marks.<ul id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_en-us_task_0172359668_ul7134165012419"><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_en-us_task_0172359668_li14134115012414">Double quotation marks cannot contain double quotation marks if spaces are used in a password.</li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_en-us_task_0172359668_li81341508418">Double quotation marks can contain double quotation marks if no space is used in a password.</li></ul>
<p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_en-us_task_0172359668_p_4">For example, the password "Aa123"45"" is valid, but the password "Aa 123"45"" is invalid.</p>
</li></ul>
<p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_en-us_task_0172360129_en-us_task_0172359668_p2135950540">The configured password is displayed in ciphertext in the configuration file.</p>
</div></div>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1570548835214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1282443456214301">*</span>SSH Server-aaa]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1333411119214301"> local-user client001 service-type ssh</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen279655214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1369115607214301">*</span>SSH Server-aaa]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1411043757214301"> local-user client001 level 3</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen67114409214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword639541071214301">*</span>SSH Server-aaa]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1945731080214301"> commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen827920796214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1137211688214301"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server-aaa]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b193437742214301"> quit</strong></pre>
</li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_li222934272214018"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p1644829136214018"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_li222934272214018"></a><a name="en-us_task_0172360145_li222934272214018"></a>Create an SSH user named client002.</p>
<p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p908117522214018"># Create an SSH user named client002 and configure SM2 authentication for it.</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen468007788214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword545964777214301"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b366483120214301"> ssh user client002</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen567822862419">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword146796284242">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1467982842415"> ssh user client002 authentication-type sm2</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen10851329142411">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword58511129162417">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b5851112912414"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b128516299241">ssh server cipher aes256_gcm aes128_gcm aes256_ctr aes192_ctr aes128_ctr</strong> </pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen19851192916240">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword685182952414">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b12851172914241"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b168512293246">ssh server hmac sha2_512 sha2_256</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen78511729182413">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword14851162919243">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b12851122912249"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b18519290241">ssh server key-exchange dh_group_exchange_sha256</strong> </pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen885172972418">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword08511129182419">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b7851102915248"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b7851142919245">ssh server publickey rsa_sha2_256 rsa_sha2_512</strong> </pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen128511429172420">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword2851129152413">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b2085112912244"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b118511429142420">ssh server dh-exchange min-len 3072</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen17851132912416">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword7851112912413">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b0851152972414"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b585162920249">ssh client publickey rsa_sha2_256 rsa_sha2_512</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen785162913246">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword185142915245">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1085162915249"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b11852429122415">ssh client cipher aes256_gcm aes128_gcm aes256_ctr aes192_ctr aes128_ctr </strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen8852629142415">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword118527295248">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b985282912414"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1185217296244">ssh client hmac sha2_512 sha2_256 </strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1785219295249">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword15852122912418">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b485222912414"> </strong><strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b18522299249">ssh client key-exchange dh_group_exchange_sha256</strong> </pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen735531191214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1602516384214301">*</span>SSH Server] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1319724996214301">ssh authorization-type default root</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen215373735214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1112554547214301">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b646397495214301"> commit</strong></pre>
</li></ul>
</p></li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_step208535617214018"><span id="EN-US_TASK_0000002055415256__en-us_task_0172360145_cmd164803015214018">Configure an SM2 public key on the server.</span><p><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p1226497042214018"># Configure the specified client to generate a local key pair.</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen147781382214018">&lt;<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword251299226214018">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1350965794214018">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen858642062214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword187175449214301"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1941712135214301">HUAWEI</span>] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b963457822214301">sysname client002</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen584985286214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword349994997214301">*</span><span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword408205446214301">HUAWEI</span>] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1019699727214301">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen581949608214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword667556508214301"><font style="font-size:8pt" Face="Courier New" >~</font></span>client002] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1122910310214301">ssh client publickey sm2</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1399367212214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1760295213214301"><font style="font-size:8pt" Face="Courier New" >~</font></span>client002] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1711595351214301">sm2 key-pair label sm2key001</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen244229682214018">Info: Key pair generation will take a short while. Please wait...
Info: Creating the key pair succeeded.</pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen363330314214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword811538797214301"><font style="font-size:8pt" Face="Courier New" >~</font></span>client002] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b751073807214301">ssh client assign sm2-host-key sm2key001</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1979485085214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1427641306214301">*</span>client002]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1402438181214301"> commit</strong></pre>
<p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p1203000499214018"># Check the SM2 public key generated on the client.</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1661261723214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword2120011098214301"><font style="font-size:8pt" Face="Courier New" >~</font></span>client002]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1438567612214301"> display sm2 key-pair</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen313707451214018">=====================================
 Label Name: sm2key001
 Modulus: 521
 Time of Key pair created: 2018-06-19 15:39:45
=====================================
Key : 
    0474F110 F90F131B B6F6D929 9A23A41E F1AB1666 AC4BE4EE EF2CD876
    2B633F80 DD5CF42F 147A722F DE527F39 247F3744 C23296BE FE3BE502
    EEF7D9EC BC28A576 7E
=====================================</pre>
<p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p463897856214018"># Copy the SM2 public key generated on the client to the server.</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1938312385214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1832673884214018"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b191352873214018">sm2 peer-public-key sm2key001</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1437225326214018">Enter "SM2 public key" view, return system view with "peer-public-key end".</pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen956448494214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword802348013214018">*</span>SSH Server-sm2-public-key] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b2042438183214018">public-key-code begin</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen23552320214018">Enter "SM2 key code" view, return last view with "public-key-code end".</pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen168448740214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword76840056214301">*</span>SSH Server-sm2-public-key-sm2-key-code] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b15111907214301">0474F110 F90F131B B6F6D929 9A23A41E F1AB1666</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen103921127214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword298854340214301">*</span>SSH Server-sm2-public-key-sm2-key-code] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1848093874214301">AC4BE4EE EF2CD876 2B633F80 DD5CF42F 147A722F</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen880936749214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword251295239214301">*</span>SSH Server-sm2-public-key-sm2-key-code] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1951994618214301">DE527F39 247F3744 C23296BE FE3BE502 EEF7D9EC</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1648307857214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword127910561214301">*</span>SSH Server-sm2-public-key-sm2-key-code] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b588607105214301">BC28A576 7E</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen401403995214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword771654368214301">*</span>SSH Server-sm2-public-key-sm2-key-code] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1670168556214301">public-key-code end</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen287859116214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1167794732214301">*</span>SSH Server-sm2-public-key] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b112789276214301">peer-public-key end</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1753384693214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword604096989214018">*</span>SSH Server] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1625659354214018">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_step375142513214018"><span id="EN-US_TASK_0000002055415256__en-us_task_0172360145_cmd8228399214018">Bind the SM2 public key of the SSH client to the SSH user client002.</span><p><pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen616046010214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1180735627214018"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1626535379214018">ssh user client002 assign sm2-key sm2key001</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen193846069214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword336097480214018">*</span>SSH Server] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b257036727214018">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_step1605719950214018"><span id="EN-US_TASK_0000002055415256__en-us_task_0172360145_cmd2055691448214018">Enable the SFTP service on the SSH server.</span><p><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p1759017793214018"># Enable the SFTP service.</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen2033005422317">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1994783337214018"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b19814122914213">interface LoopBack 0</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen74425092314">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1924617593128"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server-LoopBack0] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b169481144164112">ip address 10.1.1.1 255.255.255.255</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen185692425233">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1549437194016">*</span>SSH Server-LoopBack0] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b17311327428">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen872730548214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword853419315405">*</span>SSH Server] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b2091271524214018">sftp server enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen796723132614">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword14136158181515">*</span>SSH Server] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b13351173611140">ssh server-source</strong> <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b0995336124116">-i loopback 0</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen24224202214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword425656763214301">*</span>SSH Server] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b243094984214301">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_step68914824214018"><span id="EN-US_TASK_0000002055415256__en-us_task_0172360145_cmd757761235214018">Configure a service type and authorized directory for the SSH users.</span><p><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p857331000214018">Two SSH users are configured on the SSH server: client001 in password authentication mode and client002 in SM2 authentication mode.</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen958999319214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1407717346214301">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b50698332214301"> ssh user client001 service-type sftp</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1240027398214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1417551444214301">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1122943649214301"> ssh user client001 sftp-directory cfcard:</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen194602926214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1390003075214301">*</span>SSH Server]<strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b2142543612214301"> ssh user client002 service-type sftp</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen717314466214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword634674926214301">*</span>SSH Server] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b2052925029214301">ssh user client002 sftp-directory cfcard:</strong></pre>
</p></li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_step1861093941214018"><span id="EN-US_TASK_0000002055415256__en-us_task_0172360145_cmd1306547832214018">Connect the SFTP clients to the SSH server.</span><p><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p1097571711214018"># For the first login, enable SSH client first-time authentication.</p>
<p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p415431754214018">Enable first-time authentication for the client client001.</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen97916568214018">&lt;<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1447767607214301">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b323770188214301">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen778676783214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1533853580214018"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1083420472214018">HUAWEI</span>] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1107897924214018">sysname client001</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen883401102214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1561826987214301">*</span><span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword933553228214301">HUAWEI</span>] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1556996450214301">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1733114033214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword04817241541"><font style="font-size:8pt" Face="Courier New" >~</font></span>client001] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1876538301214018">ssh client first-time enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1029664990214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1761125610214301">*</span>client001] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b819661041214301">commit</strong></pre>
<p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p860971904214018">Enable first-time authentication for the client client002.</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1944697763214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword755878413214018"><font style="font-size:8pt" Face="Courier New" >~</font></span>client002] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1183664459214018">ssh client first-time enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1805040503214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword587225602214018">*</span>client002] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1778372566214018">commit</strong></pre>
<p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p1774094063214018"># Connect the SFTP client client001 to the SSH server in password authentication mode.</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen10615064214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword84950482214018"><font style="font-size:8pt" Face="Courier New" >~</font></span>client001] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1082279912214018">sftp 10.1.1.1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1667006953214018">Trying 10.1.1.1 ...</pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen895283968214018">Press CTRL+K to abort</pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1955836248214018">Connected to 10.1.1.1 ...      </pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen69039774214018">Please input the username:client001</pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen356190393214018">Enter password:   </pre>
<p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p972949945214018"># Connect the SFTP client client002 to the SSH server in SM2 authentication mode.</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1587667404214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword1351116670214018"><font style="font-size:8pt" Face="Courier New" >~</font></span>client002] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b633851824214018">sftp 10.1.1.1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen2017499674214018">Trying 10.1.1.1 ...</pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1497910558214018">Press CTRL+K to abort</pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1364974815214018">Connected to 10.1.1.1 ...      </pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen77798039214018">The server is not authenticated. Continue to access it? [Y/N] :y </pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen2087216204214018">Save the server's public key? [Y/N] :y </pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1826940902214018">The server's public key will be saved with the name 10.1.1.1. Please wait.</pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen681527643214018">Please input the username: client002</pre>
</p></li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_step797634373214018"><span id="EN-US_TASK_0000002055415256__en-us_task_0172360145_cmd1247982437214018">Verify the configuration.</span><p><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p1784697782214018"># Check the status of the SSH server.</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1606950612214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword338845725214018"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b404301526214018">display ssh server status</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_server_status_1">SSH Version                                : <span>2.0</span>
SSH authentication timeout (Seconds)       : 60
SSH authentication retries (Times)         : 3
SSH server key generating interval (Hours) : 0
SSH version 1.x compatibility              : Enable
SSH server keepalive                       : Disable
SFTP IPv4 server                           : Enable
<span>SFTP IPv6 server                           : Enable</span>
STELNET IPv4 server                        : Enable
<span>STELNET IPv6 server                        : Enable</span>
SNETCONF IPv4 server                       : Enable
<span>SNETCONF IPv6 server                       : Enable</span>
SNETCONF IPv4 server port(830)             : Disable
<span>SNETCONF IPv6 server port(830)             : Disable</span>
SCP IPv4 server                            : Enable
<span>SCP IPv6 server                            : Enable</span>
SSH port forwarding                        : Disable
SSH IPv4 server port                       : 22
<span>SSH IPv6 server port                       : 22</span>
ACL name                                   :
ACL number                                 :
<span>ACL6 name                                  : </span>
<span>ACL6 number                                :</span>
SSH server ip-block                        : Enable</pre>
<p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p92971713214018"># Check SSH user information.</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1047759966214018">[<span class="keyword" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_keyword928999418214018"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server] <strong id="EN-US_TASK_0000002055415256__en-us_task_0172360145_b1352933466214018">display ssh user-information</strong></pre>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1336824909214018">----------------------------------------------------
Username                : client001
Authentication-type     : password
User-public-key-name    : 
User-public-key-type    : -
Sftp-directory          : cfcard:
Service-type            : sftp

Username                : client002
Authentication-type     : sm2
User-public-key-name    : sm2key001
User-public-key-type    : SM2
Sftp-directory          : cfcard:
Service-type            : sftp
----------------------------------------------------
Total 2, 2 printed</pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_example693322617214018"><a name="EN-US_TASK_0000002055415256__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul id="EN-US_TASK_0000002055415256__en-us_task_0172360145_ul866270468214018"><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_li632359785214018"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p174337492214018"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_li632359785214018"></a><a name="en-us_task_0172360145_li632359785214018"></a>SSH server configuration file</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen189208212214018">#
 sysname SSH Server
#
interface <span>GigabitEthernet0/0/0</span>   
 undo shutdown 
 ip address 10.1.1.2 255.255.0.0 
#
sm2 peer-public-key sm2key001
public-key-code begin
    0474F110 F90F131B B6F6D929 9A23A41E F1AB1666
    AC4BE4EE EF2CD876 2B633F80 DD5CF42F 147A722F
    DE527F39 247F3744 C23296BE FE3BE502 EEF7D9EC
    BC28A576 7E
#
interface loopback 0
 ip address 10.1.1.1 255.255.255.255
<span>sftp server enable</span>
ssh server-source -i loopback 0
ssh user client001
ssh user client001 authentication-type password
ssh user client001 sftp-directory cfcard:
ssh user client001 service-type sftp
ssh user client002
ssh user client002 assign sm2-key sm2key001
ssh user client002 authentication-type sm2
ssh authorization-type default root
ssh user client002 sftp-directory cfcard:
ssh user client002 service-type sftp
#
ssh server cipher aes256_gcm aes128_gcm aes256_ctr aes192_ctr aes128_ctr 
ssh server hmac sha2_512 sha2_256 
ssh server key-exchange dh_group_exchange_sha256
#
ssh server publickey rsa_sha2_256 rsa_sha2_512
#
ssh server dh-exchange min-len 3072
#
ssh client publickey dsa ecc rsa rsa_sha2_256 rsa_sha2_512
#
ssh client cipher aes256_gcm aes128_gcm aes256_ctr aes192_ctr aes128_ctr
ssh client hmac sha2_512 sha2_256
ssh client key-exchange dh_group_exchange_sha256
#
aaa
 local-user client001 password cipher @%@%UyQs4,KTtSwJo(4QmW#K,LC:@%@%
 local-user client001 level 3
 local-user client001 service-type ssh
#
user-interface vty 0 4
 authentication-mode aaa
 protocol inbound ssh
#
return</pre>
</li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_li873439292214018"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p1843453399214018"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_li873439292214018"></a><a name="en-us_task_0172360145_li873439292214018"></a>SSH client client001 configuration file</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1394708397214018">#
 sysname client001
#
interface <span>GigabitEthernet0/0/0</span>
 undo shutdown
 ip address 10.1.2.2 255.255.0.0
#
 ssh client first-time enable
#
return</pre>
</li><li id="EN-US_TASK_0000002055415256__en-us_task_0172360145_li575495881214018"><p id="EN-US_TASK_0000002055415256__en-us_task_0172360145_p92925879214018"><a name="EN-US_TASK_0000002055415256__en-us_task_0172360145_li575495881214018"></a><a name="en-us_task_0172360145_li575495881214018"></a>SSH client client002 configuration file</p>
<pre class="screen" id="EN-US_TASK_0000002055415256__en-us_task_0172360145_screen1256105063214018">#
 sysname client002
#
interface <span>GigabitEthernet0/0/0</span>
 undo shutdown
ip address 10.1.3.3 255.255.0.0
#
ssh client first-time enable
ssh client assign sm2-host-key sm2key001
#
ssh client publickey sm2
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vfm_cfg_0022.html">Configuration Examples for File System Management
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_basic_cfg_0121_2.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vfm_cfg_0027.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>