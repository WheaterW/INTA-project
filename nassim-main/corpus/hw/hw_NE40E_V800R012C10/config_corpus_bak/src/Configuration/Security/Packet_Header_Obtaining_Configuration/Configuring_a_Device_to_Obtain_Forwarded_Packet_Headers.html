
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a Device to Obtain Forwarded Packet Headers">
<meta name="abstract" content="This section describes how to configure a device to obtain forwarded packet headers.">
<meta name="description" content="This section describes how to configure a device to obtain forwarded packet headers.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_capture-packet_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_capture-packet_cfg_0003.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_capture-packet_cfg_0009.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="packetcapture,w00800033,z00603461,w00556928,w00606909,h00522387,l00455378,z00805567">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Packet Header Obtaining">
<meta name="featuretype" content="Security">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Packet Header Obtaining">
<meta name="featuretype" content="Security">
<meta name="featurename" content="Packet Header Obtaining">
<meta name="featuretype" content="Security">
<meta name="OWNER" content="q00517581">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="j00655225">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172372299">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring a Device to Obtain Forwarded Packet Headers</title>
</head>
<body><a name="EN-US_TASK_0172372299"></a><a name="EN-US_TASK_0172372299"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a Device to Obtain Forwarded Packet Headers</h1>
<div class="taskbody"><p>This section describes how to configure a device to obtain forwarded packet headers.</p>
<div class="context"><a name="EN-US_TASK_0172372299__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>To check whether a traffic exception (such as voice quality deterioration and mosaic) that occurs in network maintenance is caused by packet errors or packet loss, specify filter criteria and configure devices to obtain forwarded packet headers based on the criteria. You can then analyze the obtained packet headers and rectify packet issues accordingly, thereby ensuring proper transmission of network data.</p>
<p>Before using an access control list (ACL) as a filter criterion, you must create it. For details about the ACL configuration, see "ACL Configuration" in <em><span class="keyword">NE40E</span> Configuration Guide - IP Services</em>.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172372299__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring a device to obtain forwarded packet headers, complete the following tasks:</p>
<ul><li>Configure link layer protocol parameters for interfaces to ensure that the link layer protocol status of the interfaces is Up.</li><li>Create an ACL.</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172372299__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>(Optional) Configure an ACL rule.</span><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>After an ACL rule is configured, the headers of packets that match the ACL rule can be obtained.</p>
<div class="p">With the packet header obtaining function, packets are processed as follows:<ul><li>If packets match the ACL rule with the permit action, their headers are obtained.</li><li>If packets match the ACL rule with the deny action, they are dropped instead of being forwarded. This may adversely affect services.</li><li>If packets match no ACL rule, they are properly forwarded, without having their headers obtained.</li><li>If the referenced ACL does not exist or an existent ACL in which no rule is defined is referenced, packets are properly forwarded, without having their headers obtained.</li><li>When packets are matched against an ACL rule, the <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> parameter configured in the rule does not take effect.</li></ul>
</div>
</div></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><caption><b>Table 1 </b>ACL rule configuration</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.3.2.2.2.2.4.1.1" liSelected="liSelected"><p>ACL Configuration Category</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.3.2.2.2.2.4.1.2" liSelected="liSelected"><p>Step 1: ACL Creation Through the <a href="cmdqueryname=acl"><b><span class="cmdname">acl</span></b></a> Command</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.3.2.2.2.2.4.1.3" liSelected="liSelected"><p>Step 2: ACL Rule Configuration Through the <a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> Command</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.2.2.2.2.4.1.1 "><p>Configuring a Basic ACL</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.2.2.2.2.4.1.2 "><p><a href="dc_vrp_acl4_cfg_0050.html">Creating a Basic ACL</a></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.2.2.2.2.4.1.3 "><p><a href="dc_vrp_acl4_cfg_0051.html">Configuring a Basic ACL Rule</a></p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.2.2.2.2.4.1.1 "><p>Configuring an Advanced ACL</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.2.2.2.2.4.1.2 "><p><a href="dc_vrp_acl4_cfg_0056.html">Creating an Advanced ACL</a></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.2.2.2.2.4.1.3 "><p><a href="dc_vrp_acl4_cfg_0057.html">Configuring an Advanced ACL Rule</a></p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.2.2.2.2.4.1.1 "><p>Configuring a Layer 2 ACL</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.2.2.2.2.4.1.2 "><p><a href="dc_vrp_acl4_cfg_0079.html">Creating a Layer 2 ACL</a></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.2.2.2.2.4.1.3 "><p><a href="dc_vrp_acl4_cfg_0080.html">Configuring Rules for a Layer 2 ACL</a></p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.2.2.2.2.4.1.1 "><p>Configuring a Basic ACL6</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.2.2.2.2.4.1.2 "><p><a href="dc_vrp_acl6_cfg_0050.html">Creating a Basic ACL6</a></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.2.2.2.2.4.1.3 "><p><a href="dc_vrp_acl6_cfg_0051.html">Configuring a Basic ACL6 Rule</a></p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.2.2.2.2.4.1.1 "><p>Configuring an Advanced ACL6</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.2.2.2.2.4.1.2 "><p><a href="dc_vrp_acl6_cfg_0056.html">Creating an Advanced ACL6</a></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.2.2.2.2.4.1.3 "><p><a href="dc_vrp_acl6_cfg_0057.html">Configuring an Advanced ACL6 Rule</a></p>
</td>
</tr>
</tbody>
</table>
</div>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li><span>Run <a href="cmdqueryname=capture-packet+forwarding+interface"><b><span class="cmdname">capture-packet forwarding interface </span></b></a>{ <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-num</span></i> | <i><span class="varname">interface-name</span></i> } [ <strong><span>inbound</span></strong> | <strong><span>outbound</span></strong> ] [ <strong><span>vlan</span></strong> <i><span class="varname">vlan-id</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id</span></i> ] | <strong><span>pvlan</span></strong> <i><span class="varname">pe-vlan-value</span></i> <strong><span>cvlan</span></strong> <i><span class="varname">ce-vlan-value</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id</span></i> ] ] [ [ <strong><span>ipv6</span></strong> ] <strong><span>acl</span></strong> { <i><span class="varname">acl-number</span></i> | <strong><span>name</span></strong> <i><span class="varname">acl-name</span></i> } ] [ [ <strong><span>time-out</span></strong> <i><span class="varname">time-out</span></i> ] | [ <strong><span>packet-num</span></strong> <i><span class="varname">packet-number</span></i> ] | [ <strong><span>overwrite</span></strong> ] | [ <strong><span>packet-len</span></strong> <i><span class="varname">length</span></i> ] | { [ <strong><span>file</span></strong> <i><span class="varname">file-name</span></i> [ <i><span class="varname">filesize</span></i> ] ] | [ <strong><span>buffer-only</span></strong> ] } ] <sup>*</sup></span><p><p>The device is configured to obtain forwarded packet headers.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>In the preceding command, the <i><span class="varname">time-out</span></i> and <i><span class="varname">packet-number</span></i> parameters can be configured to specify the timeout period and the number of packet headers to be obtained, respectively. If the specified timeout period expires or if the device has obtained the specified number of packet headers, packet header obtaining ends.</li><li><p>To control the rate at which a device obtains forwarded packet headers, set the <i><span class="varname">cir</span></i> parameter in the <a href="cmdqueryname=car"><b><span class="cmdname">car</span></b></a> command to specify a packet forwarding bandwidth. The default value of the <i><span class="varname">cir</span></i> parameter is 2 Mbit/s. A larger value indicates a higher packet forwarding bandwidth and a higher packet header obtaining rate.</p>
</li><li><p>When configuring parameters for a packet header obtaining instance, set the parameter values based on the traffic volume on the target interface. Specifically, if a large number of packets are forwarded on the interface, set a small value for <i><span class="varname">time-out</span></i> but a large value for <i><span class="varname">packet-number</span></i>. Otherwise, set a large value for <i><span class="varname">time-out</span></i> but a small value for <i><span class="varname">packet-number</span></i>.</p>
</li></ul>
</div></div>
<div class="notice"><span class="noticetitle"><img src="../../../../public_sys-resources/notice_3.0-en-us.png"> </span><div class="noticebody"><p>Enabling the function of obtaining forwarded packet headers affects device forwarding performance. Therefore, exercise caution when you enable the device to obtain forwarded packet headers.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=capture-packet+file+limit"><b><span class="cmdname">capture-packet file limit</span></b></a> <i><span class="varname">limit-value</span></i></span><p><p>The maximum number of packet header obtaining files (.cap files) in the packet header obtaining directory is specified.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172372299__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ul><li><p>Run the <a href="cmdqueryname=display+capture-packet+config-state"><b><span class="cmdname">display capture-packet config-state</span></b></a> command to check the configuration of obtaining forwarded packet headers, such as the packet header obtaining index and packet header obtaining file name.</p>
</li><li><p>Run the <a href="cmdqueryname=display+capture-packet+file"><b><span class="cmdname">display capture-packet file</span></b></a> <i><span class="varname">file-name</span></i><span> [ <strong><span>original-packet</span></strong> ]</span> command to check information about the packet header obtaining file.</p>
</li><li><p>Run the <a href="cmdqueryname=display+capture-packet+information"><b><span class="cmdname">display capture-packet information</span></b></a> [ <strong><span>instance-id</span></strong> <i><span class="varname">instance-id</span></i> [ <strong><span>from</span></strong> <i><span class="varname">begin-packet-number</span></i> [ <strong><span>to</span></strong> <i><span class="varname">end-packet-number</span></i> ] ] [ <strong><span>format-cap</span></strong> ] [ <strong><span>verbose</span></strong> ] ] command to check information about the packet header obtaining instance.</p>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_capture-packet_cfg_0000.html">Packet Header Obtaining Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_capture-packet_cfg_0003.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_capture-packet_cfg_0009.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>