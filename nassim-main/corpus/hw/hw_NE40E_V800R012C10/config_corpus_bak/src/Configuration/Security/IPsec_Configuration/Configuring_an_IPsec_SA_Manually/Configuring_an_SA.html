
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring an SA">
<meta name="abstract" content="Configure a Security Association (SA) and specify a security protocol, a security parameter index (SPI), and authentication keys.">
<meta name="description" content="Configure a Security Association (SA) and specify a security protocol, a security parameter index (SPI), and authentication keys.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ipsec_cfg_all_0002.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ipsec_cfg_all_0003.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ipsec_cfg_all_0005.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,z00603461,ipsec,w00556928,w00606909,h00522387,l00455378,z00805567">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPSec">
<meta name="featuretype" content="Security">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPSec">
<meta name="featuretype" content="Security">
<meta name="featurename" content="IPSec">
<meta name="featuretype" content="Security">
<meta name="featurename" content="IPSec">
<meta name="featuretype" content="Security">
<meta name="OWNER" content="z00485179">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00485179">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172372417">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring an SA</title>
</head>
<body><a name="EN-US_TASK_0172372417"></a><a name="EN-US_TASK_0172372417"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring an SA</h1>
<div class="taskbody"><p>Configure a Security Association (SA) and specify a security protocol, a security parameter index (SPI), and authentication keys.</p>
<div class="context"><a name="EN-US_TASK_0172372417__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><div class="p">An SA is unidirectional. Incoming and outgoing protocol packets are processed by different SAs. To ensure smooth SA negotiation, configure the same parameters for the SAs that apply to incoming protocol packets and outgoing protocol packets of the same flow, respectively. The parameters are as follows:<ul><li>Security proposal: defines the specific protection, including the authentication and encryption algorithms.</li><li>SPI: is a Security Parameter Index that identifies an SA.</li><li>Key: is used to calculate message digests and encrypt protocol packets.</li></ul>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172372417__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0172372417__step1"><li id="EN-US_TASK_0172372417__step1144481584214400"><span id="EN-US_TASK_0172372417__cmd290956109214400">Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172372417__cmdname1042728309214400">system-view</span></b></a></span></span><p><p id="EN-US_TASK_0172372417__p1037589350214400">The system view is displayed.</p>
</p></li><li id="EN-US_TASK_0172372417__step558057976214400"><span id="EN-US_TASK_0172372417__cmd1219316183214400">Run <span><a href="cmdqueryname=ipsec+sa"><b><span class="cmdname" id="EN-US_TASK_0172372417__cmdname672877700214400">ipsec sa</span></b></a> <i><span class="varname" id="EN-US_TASK_0172372417__varname657887863214400">sa-name</span></i></span></span><p><p id="EN-US_TASK_0172372417__p334548169214400">An SA is created, and the SA view is displayed.</p>
</p></li><li id="EN-US_TASK_0172372417__step1818056235214400"><span id="EN-US_TASK_0172372417__cmd1673812129214400">Run <span><a href="cmdqueryname=proposal"><b><span class="cmdname" id="EN-US_TASK_0172372417__cmdname57981026214400">proposal</span></b></a> <i><span class="varname" id="EN-US_TASK_0172372417__varname1786553061214400">proposal-name</span></i></span></span><p><p id="EN-US_TASK_0172372417__p248876479214400">A security proposal is applied to the SA.</p>
<div class="note" id="EN-US_TASK_0172372417__note1220885604214400"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172372417__p218099343214400">A security proposal must be configured before it can be associated with protocol packet flows.</p>
<p id="EN-US_TASK_0172372417__p373013072214400">One SA can use only one security proposal. If a security proposal has been applied to an SA, the SA can use another security proposal only after the original one is deleted.</p>
</div></div>
</p></li><li id="EN-US_TASK_0172372417__step1907108439214400"><span id="EN-US_TASK_0172372417__cmd1578102798214400">Run <span><a href="cmdqueryname=sa+spi+inbound+outbound+ah+esp"><b><span class="cmdname" id="EN-US_TASK_0172372417__cmdname299946423214400">sa spi</span></b></a> { <strong><span id="EN-US_TASK_0172372417__cmdparmname1271659768214400">inbound</span></strong> | <strong><span id="EN-US_TASK_0172372417__cmdparmname1550700528214400">outbound</span></strong> } { <strong><span id="EN-US_TASK_0172372417__cmdparmname187793460214400">ah</span></strong> | <strong><span id="EN-US_TASK_0172372417__cmdparmname1824115741214400">esp</span></strong> } <i><span class="varname" id="EN-US_TASK_0172372417__varname428072479214400">spi-number</span></i></span></span><p><p id="EN-US_TASK_0172372417__p2074786976214400">An SPI is <span>set</span>.</p>
<div class="note" id="EN-US_TASK_0172372417__note1484530841214400"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172372417__p1044833841214400">The SPI uniquely identifies an SA. The inbound and outbound SPIs are set, and the inbound SPI on the local end must be the same as the outbound SPI on the peer end.</p>
</div></div>
</p></li><li id="EN-US_TASK_0172372417__step52217497214400"><span id="EN-US_TASK_0172372417__cmd1446144103214400">To configure the authentication key, run either of the following commands:</span><ol type="a" id="EN-US_TASK_0172372417__substeps1051647392214400"><li class="substepexpand" id="EN-US_TASK_0172372417__substep1825810571214400"><span id="EN-US_TASK_0172372417__cmd1004434814214400">Run <span><a href="cmdqueryname=sa+authentication-hex+inbound+outbound+ah+esp+cipher"><b><span class="cmdname" id="EN-US_TASK_0172372417__cmdname550568145214400">sa authentication-hex</span></b></a> { <strong><span id="EN-US_TASK_0172372417__cmdparmname1273558245214400">inbound</span></strong> | <strong><span id="EN-US_TASK_0172372417__cmdparmname101717849214400">outbound</span></strong> } { <strong><span id="EN-US_TASK_0172372417__cmdparmname143088421214400">ah</span></strong> | <strong><span id="EN-US_TASK_0172372417__cmdparmname970842049214400">esp</span></strong> } [ <strong><span id="EN-US_TASK_0172372417__cmdparmname504940484214400">cipher</span></strong> ] <i><span class="varname" id="EN-US_TASK_0172372417__varname219335433214400">key-cipher-key</span></i></span></span><p><p id="EN-US_TASK_0172372417__p603307339214400">An authentication key in hexadecimal format or ciphertext is set.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372417__substep1337313532214400"><span id="EN-US_TASK_0172372417__cmd664682822214400">Run <span><a href="cmdqueryname=sa+string-key+inbound+outbound+ah+esp+cipher"><b><span class="cmdname" id="EN-US_TASK_0172372417__cmdname1878648587214400">sa string-key</span></b></a> { <strong><span id="EN-US_TASK_0172372417__cmdparmname1871271961214400">inbound</span></strong> | <strong><span id="EN-US_TASK_0172372417__cmdparmname12748862214400">outbound</span></strong> } { <strong><span id="EN-US_TASK_0172372417__cmdparmname2102665697214400">ah</span></strong> | <strong><span id="EN-US_TASK_0172372417__cmdparmname966644904214400">esp</span></strong> } [ <strong><span id="EN-US_TASK_0172372417__cmdparmname290139994214400">cipher</span></strong> ] <i><span class="varname" id="EN-US_TASK_0172372417__varname1391644581214400">string-cipher-key</span></i></span></span><p><p id="EN-US_TASK_0172372417__p1430660708214400">An authentication key in string format is set.</p>
</p></li></ol>
<p><div class="note" id="EN-US_TASK_0172372417__note1149439888214400"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172372417__p2020792851214400">An authentication key for outgoing protocol packets on the local end must be identical with that for incoming protocol packets on the peer end.</p>
<p id="EN-US_TASK_0172372417__p578263172214400">If multiple authentication keys are configured, the latest one takes effect.</p>
<p id="EN-US_TASK_0172372417__p1308958502214400">Updating keys periodically is recommended.</p>
</div></div>
</p></li><li id="EN-US_TASK_0172372417__step1341362433214400"><span id="EN-US_TASK_0172372417__cmd2142568872214400">(Optional) Run <span><a href="cmdqueryname=sa+encryption-hex+inbound+outbound+esp+cipher"><b><span class="cmdname" id="EN-US_TASK_0172372417__cmdname1830963682214400">sa encryption-hex</span></b></a> { <strong><span id="EN-US_TASK_0172372417__cmdparmname1857604192214400">inbound</span></strong> | <strong><span id="EN-US_TASK_0172372417__cmdparmname15041758214400">outbound</span></strong> } <strong><span id="EN-US_TASK_0172372417__cmdparmname858928430214400">esp</span></strong> [ <strong><span id="EN-US_TASK_0172372417__cmdparmname198908619214400">cipher</span></strong> ] <i><span class="varname" id="EN-US_TASK_0172372417__varname315388270214400">hex-cipher-key</span></i></span></span><p><p id="EN-US_TASK_0172372417__p1379991123214400">An encryption key is set.</p>
</p></li><li id="EN-US_TASK_0172372417__step1325295764214400"><span id="EN-US_TASK_0172372417__cmd545518864214400">Run <span><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172372417__cmdname2139298540214400">commit</span></b></a></span></span><p><p id="EN-US_TASK_0172372417__p1276984941214400">The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ipsec_cfg_all_0002.html">Configuring an IPsec SA Manually
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ipsec_cfg_all_0003.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ipsec_cfg_all_0005.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>