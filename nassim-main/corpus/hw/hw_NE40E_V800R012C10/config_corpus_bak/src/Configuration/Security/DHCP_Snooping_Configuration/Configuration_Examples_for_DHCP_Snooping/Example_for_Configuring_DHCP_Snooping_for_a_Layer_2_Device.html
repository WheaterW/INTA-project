
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring DHCP Snooping for a Layer 2 Device">
<meta name="abstract" content="DHCP snooping is used on Layer 2 devices to prevent bogus DHCP server attacks, man-in-the-middle attacks, IP/MAC spoofing attacks, attacks by changing the CHADDR value, attacks by sending bogus DHCP renew packets, and attacks by sending DHCP request packets.">
<meta name="description" content="DHCP snooping is used on Layer 2 devices to prevent bogus DHCP server attacks, man-in-the-middle attacks, IP/MAC spoofing attacks, attacks by changing the CHADDR value, attacks by sending bogus DHCP renew packets, and attacks by sending DHCP request packets.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcp-snooping_cfg_0034_1.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcp-snooping_cfg_0047.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00800033,w00556928,dhcpsnp,w00606909,l00455378,z00805567">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="DHCP Snooping">
<meta name="featuretype" content="Security">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="DHCP Snooping">
<meta name="featuretype" content="Security">
<meta name="featurename" content="DHCP Snooping">
<meta name="featuretype" content="Security">
<meta name="featurename" content="DHCP Snooping">
<meta name="featuretype" content="Security">
<meta name="OWNER" content="y00852169">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="y00852169">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172372033">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring DHCP Snooping for a Layer 2 Device</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172372033"></a><a name="EN-US_TASK_0172372033"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring DHCP Snooping for a Layer 2 Device</h1>
<div class="taskbody"><p>DHCP snooping is used on Layer 2 devices to prevent bogus DHCP server attacks, man-in-the-middle attacks, IP/MAC spoofing attacks, attacks by changing the CHADDR value, attacks by sending bogus DHCP renew packets, and attacks by sending DHCP request packets.</p>
<div class="context"><a name="EN-US_TASK_0172372033__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0172372033__fig_dc_vrp_dhcp-snooping_cfg_004601">Figure 1</a>, a DHCP client is connected to <span class="keyword">Device</span>A through VLAN 10. Configure DHCP snooping on the Layer 2 interfaces, GE<span>0/1/0</span> and GE<span>0/1/1</span>, of <span class="keyword">Device</span>A. Configure the interfaces connecting to DHCP clients as untrusted interfaces and the interface connecting to the DHCP relay agent as a trusted interface.</p>
<p>Configure DHCP snooping on <span class="keyword">Device</span>A to prevent the following attacks:</p>
<ul><li><p>Bogus DHCP server attacks</p>
</li><li><p>Man-in-the-middle attacks and IP/MAC address spoofing</p>
</li><li><p>Denial of service (DoS) attacks by changing the CHADDR field value</p>
</li><li><p>Attacks by sending bogus DHCP request packets for extending IP address lease</p>
</li></ul>
<p>DHCP client 1 uses a dynamic IP address, and DHCP client 2 uses a static IP address.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1, interface2, and interface3 represent GE<span>0/1/0</span>, GE<span>0/1/1</span>, and GE<span>0/1/2</span>, respectively.</p>
</div></div>
<div class="fignone" id="EN-US_TASK_0172372033__fig_dc_vrp_dhcp-snooping_cfg_004601"><a name="EN-US_TASK_0172372033__fig_dc_vrp_dhcp-snooping_cfg_004601"></a><a name="fig_dc_vrp_dhcp-snooping_cfg_004601"></a><span class="figcap"><b>Figure 1 </b>Networking diagram for configuring DHCP snooping for a Layer 2 device</span><br><span><img class="vsd" src="images/fig_dc_vrp_dhcp-snooping_cfg_004601.png" width="NaN" height="NaN"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172372033__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Enable DHCP snooping in the system view and VLAN view.</p>
</li><li><p>Configure trusted and untrusted interfaces to prevent bogus DHCP server attacks.</p>
</li><li><p>Configure the DHCP snooping binding table so that the device can check ARP, IP, and DHCP request packets to prevent man-in-the-middle attacks, IP/MAC address spoofing, and attacks by sending bogus DHCP request packets for extending IP address lease.</p>
</li><li><p>Enable CHADDR field check to prevent attacks that change CHADDR field values in packets.</p>
</li><li><p>Configure Option 82 to create a binding table containing accurate interface information.</p>
</li><li><p>Configure the device to report alarms to the Network Management System (NMS).</p>
</li><li><p>(Optional) Configure the whitelist function for DHCP snooping.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172372033__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>ID of the VLAN to which the interface belongs</p>
</li><li><p>Static IP address to which packets can be forwarded</p>
</li><li><p>Threshold of reporting alarms to the NMS</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172372033__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enable DHCP snooping.</span><p><p># Enable DHCP snooping globally.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>]<strong> sysname <span class="keyword">Device</span>A</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> dhcp snooping enable</strong></pre>
<p># Switch Layer 3 interfaces to Layer 2 interfaces.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> port default vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>]<strong> portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>]<strong> port default vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>]<strong> portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>]<strong> port default vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>]<strong> quit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the interfaces are Layer 2 ones, running the <strong>portswitch</strong> command is not required.</p>
</div></div>
<p># Enable DHCP snooping on the Layer 2 interfaces.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>port gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp snooping enable interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>port gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp snooping enable interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> port gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp snooping enable interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-vlan10]<strong> quit</strong></pre>
</p></li><li><span>Configure trusted interfaces.</span><p><p># Configure the interface connecting to the DHCP server as a trusted interface, and enable DHCP snooping on all the interfaces connecting to the DHCP client. (If the interface on the client side is not configured as a trusted interface, the default interface mode is untrusted after DHCP snooping is enabled on the interface.) This prevents bogus DHCP server attacks.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp snooping trusted interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-vlan10]<strong> quit</strong></pre>
</p></li><li><span>Enable packet check and configure the DHCP snooping binding table.</span><p><p># Configure the device to check Address Resolution Protocol (ARP) and IP packets on the interface on the DHCP client side. This prevents man-in-the-middle attacks and IP/MAC address spoofing.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp snooping check arp enable interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp snooping check arp enable interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp snooping check ip enable interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp snooping check ip enable interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-vlan10]<strong> quit</strong></pre>
<p># Configure the device to check DHCP request packets on the interface on the DHCP client side. This prevents attacks in which the attacker sends bogus DHCP request packets for extending IP address lease.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp snooping check dhcp-request enable interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp snooping check dhcp-request enable interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-vlan10]<strong> quit</strong></pre>
<p># Configure the device to check packets containing the CHADDR field on the interface on the DHCP client side. This prevents DoS attacks in which the attacker changes the CHADDR field value.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp check chaddr enable interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp check chaddr enable interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-vlan10]<strong> quit</strong></pre>
<p># Configure static DHCP snooping binding table entries.</p>
<p>For users using static IP addresses, static DHCP snooping binding table entries must be manually configured.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp snooping bind-table static ip-address 10.1.3.1 mac-address 00e0-fc5e-008a interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-vlan10]<strong> quit</strong></pre>
</p></li><li><span>Configure Option 82 field insertion.</span><p><p># Enable Option 82 field insertion to set up dynamic binding table entries with accurate interface information.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp option82 insert enable interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp option82 insert enable interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-vlan10]<strong> quit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>To configure a Layer 2 device to strip the Option 82 field before sending DHCP Relay packets to the client, perform either of the following operations:</p>
<ul><li><p>Enable Option 82 field insertion on the interfaces connecting to the client and server.</p>
</li><li><p>Enable DHCP snooping for the VLAN to which the interface connecting to the client belongs, and configure this interface as a trusted interface.</p>
</li></ul>
</div></div>
</p></li><li><span>Configure the device to report alarms to the NMS.</span><p><p># Enable alarm reporting to the NMS.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp snooping alarm dhcp-reply enable interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp snooping alarm dhcp-reply enable interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp snooping alarm arp enable interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp snooping alarm arp enable interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp snooping alarm ip enable interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp snooping alarm ip enable interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp snooping alarm dhcp-chaddr enable interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp snooping alarm dhcp-chaddr enable interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp snooping alarm dhcp-request enable interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp snooping alarm dhcp-request enable interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-vlan10]<strong> quit</strong></pre>
<p># Configure the alarm thresholds.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp snooping alarm dhcp-reply threshold 10 interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp snooping alarm dhcp-reply threshold 10 interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp snooping alarm arp threshold 10 interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp snooping alarm arp threshold 10 interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp snooping alarm ip threshold 10 interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp snooping alarm ip threshold 10 interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp snooping alarm dhcp-chaddr threshold 10 interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10]<strong> dhcp snooping alarm dhcp-chaddr threshold 10 interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp snooping alarm dhcp-request threshold 10 interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>dhcp snooping alarm dhcp-request threshold 10 interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan10] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-vlan10]<strong> quit</strong></pre>
</p></li><li><span>(Optional) Configure the whitelist function for DHCP snooping.</span><p><p># Create a whitelist.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>dhcp snooping packet whitelist whitelist1</strong></pre>
<p># Configure rules for the whitelist.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-dhcpsnp-whitelist-whitelist1] <strong>dhcp packet-rule 1 source-ip 1.1.1.1 255.255.255.0 destination-ip 2.2.2.2 255.255.255.0 source-port bootps destination-port bootpc</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-dhcpsnp-whitelist-whitelist1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-dhcpsnp-whitelist-whitelist1] <strong>quit</strong></pre>
<p># Apply the whitelist.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>dhcp snooping apply packet whitelist whitelist1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>Run the <strong>display dhcp snooping global</strong> command on <span class="keyword">Device</span>A. You can see that DHCP snooping is enabled in the system view and interface view. You can also view the statistics on the alarms sent to the NMS.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display dhcp snooping global</strong></pre>
<pre class="screen"> dhcp snooping enable</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display dhcp snooping vlan 10 interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">dhcp snooping enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping check arp enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm arp enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm arp threshold 10 interface gigabitethernet <span>0/1/0</span>
 dhcp snooping check ip enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm ip enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm ip threshold 10 interface gigabitethernet <span>0/1/0</span>
 dhcp snooping alarm dhcp-reply enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm dhcp-reply threshold 10 interface GigabitEthernet<span>0/1/0</span>
 dhcp check chaddr enable interface gigabitethernet <span>0/1/0</span>
 dhcp snooping alarm dhcp-chaddr enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm dhcp-chaddr threshold 10 interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping check dhcp-request enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm dhcp-request enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm dhcp-request threshold 10 interface GigabitEthernet<span>0/1/0</span>
 arp total                  0
 ip total                   0
 dhcp-request total         0
 chaddr&amp;src mac total       0
 dhcp-reply total           0</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display dhcp snooping vlan 10 interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">dhcp snooping enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping check arp enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm arp enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm arp threshold 10 interface gigabitethernet <span>0/1/1</span> 
 dhcp snooping check ip enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm ip enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm ip threshold 10 interface gigabitethernet <span>0/1/1</span> 
 dhcp snooping alarm dhcp-reply enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm dhcp-reply threshold 10 interface GigabitEthernet<span>0/1/1</span>
 dhcp check chaddr enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm dhcp-chaddr enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm dhcp-chaddr threshold 10 interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping check dhcp-request enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm dhcp-request enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm dhcp-request threshold 10 interface GigabitEthernet<span>0/1/1</span>
 arp total                  0
 ip total                   0
 dhcp-request total         0
 chaddr&amp;src mac total       0
 dhcp-reply total           0</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display dhcp snooping vlan 10 interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen"> dhcp snooping enable interface GigabitEthernet<span>0/1/2</span>
 dhcp snooping trusted interface GigabitEthernet<span>0/1/2</span>
 arp total                  0
 ip total                   0
 dhcp-request total         0
 chaddr&amp;src mac total       0
 dhcp-reply total           0</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display dhcp snooping bind-table static</strong></pre>
<pre class="screen">bind-table:
ifname         vrf/vsi/bdid   p/cvlan   mac-address    ip-address      tp lease     
-------------------------------------------------------------------------------
GE<span>0/1/1</span>     --        0100/0000 00e0-fc5e-008a 010.001.003.001 S  0
-------------------------------------------------------------------------------
binditem count:      1                   binditem total count: 1
</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display dhcp option82 vlan 10 interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen"> dhcp option82 insert enable interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display dhcp option82 vlan 10 interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen"> dhcp option82 insert enable interface GigabitEthernet<span>0/1/1</span></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172372033__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>A</pre>
<pre class="screen">#</pre>
<pre class="screen">vlan batch 10</pre>
<pre class="screen">#</pre>
<pre class="screen">dhcp snooping enable</pre>
<pre class="screen">#</pre>
<pre class="screen">dhcp snooping packet whitelist whitelist1</pre>
<pre class="screen">dhcp packet-rule 1 source-ip 1.1.1.1 255.255.255.0 destination-ip 2.2.2.2 255.255.255.0 source-port bootps destination-port bootpc</pre>
<pre class="screen">#</pre>
<pre class="screen">dhcp snooping apply packet whitelist whitelist1</pre>
<pre class="screen">#</pre>
<pre class="screen">vlan 10
 dhcp snooping alarm dhcp-reply threshold 1000
 dhcp check chaddr enable
 dhcp snooping alarm dhcp-chaddr enable
 dhcp snooping alarm dhcp-chaddr threshold 100
 dhcp snooping check dhcp-request enable
 dhcp snooping alarm dhcp-request enable
 dhcp snooping alarm dhcp-request threshold 100
 dhcp snooping enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping check arp enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm arp enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm arp threshold 10 interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping check ip enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm ip enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm ip threshold 10 interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm dhcp-reply enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm dhcp-reply threshold 10 interface GigabitEthernet<span>0/1/0</span>
 dhcp check chaddr enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm dhcp-chaddr enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm dhcp-chaddr threshold 10 interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping check dhcp-request enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm dhcp-request enable interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping alarm dhcp-request threshold 10 interface GigabitEthernet<span>0/1/0</span>
 dhcp snooping enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping check arp enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm arp enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm arp threshold 10 interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping check ip enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm ip enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm ip threshold 10 interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm dhcp-reply enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm dhcp-reply threshold 10 interface GigabitEthernet<span>0/1/1</span>
 dhcp check chaddr enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm dhcp-chaddr enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm dhcp-chaddr threshold 10 interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping check dhcp-request enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm dhcp-request enable interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping alarm dhcp-request threshold 10 interface GigabitEthernet<span>0/1/1</span>
 dhcp snooping enable interface GigabitEthernet<span>0/1/2</span>
 dhcp snooping trusted interface GigabitEthernet<span>0/1/2</span>
 dhcp check chaddr enable interface GigabitEthernet<span>0/1/2</span>
<strong> </strong>dhcp snooping bind-table static ip-address 10.1.3.1 mac-address 00e0-fc5e-008a interface gigabitethernet <span>0/1/1</span>
 dhcp option82 insert enable interface GigabitEthernet<span>0/1/0</span>
 dhcp option82 insert enable interface GigabitEthernet<span>0/1/1</span>
 dhcp option82 insert enable interface GigabitEthernet<span>0/1/2</span>
#                                                                     </pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> portswitch</pre>
<pre class="screen"> port default vlan 10</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/1</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> portswitch</pre>
<pre class="screen"> port default vlan 10</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/2</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> portswitch</pre>
<pre class="screen"> port default vlan 10</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcp-snooping_cfg_0034_1.html">Configuration Examples for DHCP Snooping
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcp-snooping_cfg_0047.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>