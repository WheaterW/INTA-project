
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="NTP">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_sec_hardening_management_level1.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_hardening_2023.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_hardening_3030.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00588052,w00845984">
<meta name="DC.Publisher" content="20240229">
<meta name="OWNER" content="z00588052,w00845984">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="lWX1238418">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001180623013">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>NTP</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CONCEPT_0000001180623013"></a><a name="EN-US_CONCEPT_0000001180623013"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">NTP</h1>
<div><p></p>
<div class="section"><h4 class="sectiontitle">Security Policy</h4><p>Rapid network development poses higher network security requirements. The Network Time Protocol (NTP) packets transmitted on the network may be modified. NTP packet attacks may cause network interruption, disturb synchronization, and cause network data loss. Therefore, packets need to be protected.</p>
<div class="p">NTP supports the following security policies:<ul><li><p>NTP support authentication to prevent receiving of bad synchronization data, error packets, and replay attacks from the networks.</p>
</li><li>NTP supports the whitelist function. NTP creates a whitelist security label for each known port to rapidly exchange packets. This function is necessary for quick convergence on the network. If ports that send packets are not in the whitelist, they will only be assigned a default low bandwidth to prevent DOS attacks.</li><li>NTP allows you to run commands to change the default port number that receives NTP packets.</li><li><p>You can set access authority to protect local NTP services. This is a simple measure to ensure security.</p>
</li></ul>
</div>
</div>
<div class="section"><h4 class="sectiontitle">Attack Methods</h4><p>If authentication is configured on the client and server, NTP will accept the packets only if packets are authenticated to prevent accepting packets from unauthenticated peers.</p>
<p>To protect against subnet attacks, you can choose trusted time servers and allow only these trusted time servers to be the synchronization source.</p>
</div>
<div class="section"><h4 class="sectiontitle">Configuration and Maintenance Methods</h4><p>NTP can authenticate protocol packets and provide HMAC-SHA256 authentication to enhance security.</p>
<ol><li><p># Set the authentication key of the key to <strong>Huawei-12345</strong> and authentication algorithm to <strong>HMAC-SHA256</strong> on the client.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ntp<span>-service</span> authentication enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>ntp<span>-service</span> authentication-keyid 1 authentication-mode hmac-sha256 cipher Huawei-12345</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>ntp<span>-service</span> reliable authentication-keyid 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>display current-configuration | include ntp</strong></pre>
<pre class="screen">#</pre>
<pre class="screen">ntp<span>-service</span> authentication-keyid 1 authentication-mode hmac-sha256 cipher %^%#5_TD+l')]GVp&gt;0:^0zBMN{%V;&lt;_rw:v7E3,1X}C/%^%#</pre>
<pre class="screen">ntp<span>-service</span> reliable authentication-keyid 1</pre>
<pre class="screen">ntp<span>-service</span> authentication enable</pre>
<pre class="screen">#</pre>
</li><li><p># Set the authentication key of the key to <strong>Huawei-12345</strong> and authentication algorithm to <strong>HMAC-SHA256</strong> on the server.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ntp<span>-service</span> authentication enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>ntp<span>-service</span> authentication-keyid 1 authentication-mode hmac-sha256 cipher Huawei-12345</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>display current-configuration | include ntp</strong></pre>
<pre class="screen">#</pre>
<pre class="screen">ntp<span>-service</span> authentication-keyid 1 authentication-mode hmac-sha256 cipher %@%@rob%'[{S0IcI6$Y.xM]+,1e*%@%@</pre>
<pre class="screen">ntp<span>-service</span> authentication enable</pre>
<pre class="screen">#</pre>
</li><li><p># Allow the peers matching IPv4 ACL 2000<span> and IPv6 ACL 2002</span> to perform time request, query control, and time synchronization on the local device.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ntp<span>-service</span> access peer 2000<span> ipv6 2002</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>display current-configuration | include ntp</strong></pre>
<pre class="screen">#</pre>
<pre class="screen">ntp<span>-service</span> access peer 2000<span> ipv6 2002</span></pre>
<pre class="screen">#</pre>
</li></ol>
<p>NTP allows you to run commands to change the default port number that receives NTP packets.</p>
<ol><li><div class="p">Set the number of the port that receives NTP packets to 1026.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ntp<span>-service</span> port 1026</strong></pre>
</div>
</li></ol>
</div>
<div class="section"><h4 class="sectiontitle">Configuration and Maintenance Suggestions</h4><p>As the HMAC-SHA256 algorithm is more secure, using the HMAC-SHA256 algorithm is recommended.</p>
<p>The last rule in the ACL needs to deny all IP addresses. If an ACL is used to filter VPN addresses, run the <a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> [ <i><span class="varname">rule-id</span></i> ] <strong><span>deny</span></strong> <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> command in the ACL.</p>
</div>
<div class="section"><h4 class="sectiontitle">Verifying the Security Hardening Result</h4><ul><li>Run the <strong><a href="cmdqueryname=display+ntp-service+sessions"><b><span class="cmdname">display ntp-service sessions</span></b></a></strong> [ <strong><strong><span>verbose</span></strong></strong> ] command to check the status of sessions maintained by the NTP service.</li><li>Run the <a href="cmdqueryname=display+ntp-service+statistics+packet"><b><span class="cmdname">display ntp-service statistics packet</span></b></a> command to check statistics about global NTP packets.</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_sec_hardening_management_level1.html">Management Plane
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_hardening_2023.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_hardening_3030.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>