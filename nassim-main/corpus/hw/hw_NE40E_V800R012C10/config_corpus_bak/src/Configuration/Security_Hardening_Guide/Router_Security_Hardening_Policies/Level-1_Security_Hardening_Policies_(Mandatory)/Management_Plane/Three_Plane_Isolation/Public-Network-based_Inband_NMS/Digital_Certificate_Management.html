
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Digital Certificate Management">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_sec_hardening_management_level1.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_hardening_3030.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0020.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00588052,y00852169">
<meta name="DC.Publisher" content="20240229">
<meta name="OWNER" content="z00588052,y00852169">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00485179">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001221878845">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Digital Certificate Management</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CONCEPT_0000001221878845"></a><a name="EN-US_CONCEPT_0000001221878845"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Digital Certificate Management</h1>
<div><div class="section"><h4 class="sectiontitle">Function Description</h4><p>A digital certificate, which a user applies for from a trusted certificate authority (CA), provides multiple services, such as identity authentication, access control, and integrity and confidentiality assurance, for IPsec, SSH, SSL, and other security features.</p>
<p>For security purposes, the validity period of a digital certificate is specified when the digital certificate is issued. An expired digital certificate does not pass verification and therefore cannot be used. Because certificate expiration adversely affects network services, you need to periodically perform command- or alarm-based queries to check whether certificates are about to expire or have expired.</p>
<p>The following table lists the preset digital certificates provided by the device. If a new certificate needs to be configured based on service requirements, you can run commands for certificate configuration and update.</p>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Preset digital certificates</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="12.691269126912694%" id="mcps1.3.1.5.2.4.1.1" liSelected="liSelected"><p><strong>Certificate Type</strong></p>
</th>
<th align="left" class="cellrowborder" valign="top" width="20.192019201920193%" id="mcps1.3.1.5.2.4.1.2" liSelected="liSelected"><p><strong>Certificate Function</strong></p>
</th>
<th align="left" class="cellrowborder" valign="top" width="67.11671167116712%" id="mcps1.3.1.5.2.4.1.3" liSelected="liSelected"><p><strong>Description</strong></p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="12.691269126912694%" headers="mcps1.3.1.5.2.4.1.1 "><p>Preset CA certificate</p>
</td>
<td class="cellrowborder" valign="top" width="20.192019201920193%" headers="mcps1.3.1.5.2.4.1.2 "><p>Used to verify the identity of a peer Huawei device.</p>
</td>
<td class="cellrowborder" valign="top" width="67.11671167116712%" headers="mcps1.3.1.5.2.4.1.3 "><p>Import and query of a preset CA certificate:</p>
<p>To import a preset CA certificate, run the <strong>pki load preset-ca domain </strong><em>default</em> command. By default, no preset CA certificate is imported. To query the certificate content, run the <strong>display pki ca_list domain </strong><em>default</em> command.</p>
<p>Deletion and replacement of a preset CA certificate:</p>
<p>To remove the preset CA certificate that has been imported to the default domain, run the <strong>undo pki load preset-ca domain </strong><em>default</em> command. If other CA certificates are required, import them to the default domain for certificate authentication.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="12.691269126912694%" headers="mcps1.3.1.5.2.4.1.1 "><p>Preset local certificate</p>
</td>
<td class="cellrowborder" valign="top" width="20.192019201920193%" headers="mcps1.3.1.5.2.4.1.2 "><p>Used by other devices to verify the identity of a local device.</p>
</td>
<td class="cellrowborder" valign="top" width="67.11671167116712%" headers="mcps1.3.1.5.2.4.1.3 "><p>Import and query of a preset local certificate:</p>
<p>To import a preset local certificate, run the <strong>pki load preset-local domain </strong><em>default</em> command. By default, a preset local certificate is imported. To query the certificate content, run the <strong>display pki cert_list domain</strong> <em>default</em> command.</p>
<p>Deletion and replacement of a preset local certificate:</p>
<p>To remove the preset local certificate that has been imported to the default domain, run the <strong>undo pki load preset-local domain </strong><em>default</em> command. Other local certificates cannot be imported to the default domain. To replace the preset local certificate with another user certificate, you can create a PKI domain, import the user certificate to the new domain, and then bind services to this domain.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section"><h4 class="sectiontitle">Configuration and Maintenance Methods</h4><p><strong>Methods of Certificate Expiration Query</strong></p>
<ul><li>Command-based query<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>display pki ca_list</strong>
 The x509 object type is certificate:
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            49:71:c8:f9:31:04:3e:1b:42:bc:29:f6:bb:06:40:33:b3:f7:53:d9
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: CN=root,OU=HW,O=HW,L=NJ,ST=JS,C=CN
        Validity
            <strong>Not Before: Jun  16  01:01:45 2021 GMT</strong>
            <strong>Not After : Jun  16  01:01:45 2022 GMT</strong></pre>
</li><li>Alarm-based query<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>display alarm active</strong>
1:Critical  2:Major  3:Minor  4:Warning
-------------------------------------------------------------------------------
Sequence   AlarmId    Level Date Time  Description
-------------------------------------------------------------------------------
1393       0xF10091   1     2024-01-02 The CA certificate is invalid. (CACertSta
                   20:53:26  rtTime=2022-02-14 06:48:00, CACertFinishT
                   ime=2023-02-14 06:48:00, CACertIssuer=CN=
                   11,OU=11,O=11,C=11,E=11, CACertSubject=CN   
                   =11,O=11,C=11, FileName=huawei1.cer, Inva   
                   lidReason=The current time is not within       
                   the validity period of the certificate) 
-------------------------------------------------------------------------------</pre>
</li></ul>
<p><strong>Certificate Update Procedure</strong></p>
<p>For details, see "Updating the Expired Local Certificate and CRL Certificate" in Configuration &gt; Security &gt; PKI Configuration &gt; Maintaining PKI.</p>
<p>A certificate can be updated in offline or CMP mode. The following uses the CMP mode as an example to describe how to implement an automatic certificate update. Before performing relevant operations, ensure that the CA server has been configured so that it can automatically issue certificates. In addition, in the case of initial authentication, check that the device has been preconfigured with an external certificate, such as <strong>abc.cer</strong> involved in <a href="#EN-US_CONCEPT_0000001221878845__li139131324153213">1</a>, for mutual authentication with the CA server.</p>
<ol><li id="EN-US_CONCEPT_0000001221878845__li139131324153213"><a name="EN-US_CONCEPT_0000001221878845__li139131324153213"></a><a name="li139131324153213"></a>Configure certificate application in CMP mode.<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <strong>rsa pki local-key-pair abc create</strong>
Info: The name of the new RSA key will be:abc.
Info: The name of the new RSA key will be:abc.
The range of public key size is (2048 <font style="font-size:8pt" Face="Courier New" >~</font> 4096).
NOTES: If the key modulus is greater than 2048,
it will take a few minutes.
Input the bits in the modulus[default = 3072]:
Info: Operating, please wait for a moment.......done.
Info: Create RSA local-key-pair success.
&lt;<span class="keyword">HUAWEI</span>&gt;<strong> system-view</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <strong>pki entity abc</strong>
[*<span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>-pki-entity-abc] <strong>common-name <span class="keyword">HUAWEI</span></strong>
[*<span class="keyword">HUAWEI</span>-pki-entity-abc] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>-pki-entity-abc] <strong>quit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <strong>pki domain abc</strong>
[*<span class="keyword">HUAWEI</span>-pki-domain-abc] <strong>pki cmp session abc</strong>
[*<span class="keyword">HUAWEI</span>-pki-domain-abc-pki-cmp-session-abc] <strong>cmp request entity abc</strong>
[*<span class="keyword">HUAWEI</span>-pki-domain-abc-pki-cmp-session-abc] <strong>cmp request rsa local-key-pair abc regenerate 4096</strong>
[*<span class="keyword">HUAWEI</span>-pki-domain-abc-pki-cmp-session-abc] <strong>cmp request ca-name "/C=CN/O=JIT/CN=CMPSignCert"</strong>
[*<span class="keyword">HUAWEI</span>-pki-domain-abc-pki-cmp-session-abc] <strong>cmp request authentication-cert abc.cer</strong>
[*<span class="keyword">HUAWEI</span>-pki-domain-abc-pki-cmp-session-abc] <strong>cmp request server url http://10.10.10.10:10000/cmp</strong>
[*<span class="keyword">HUAWEI</span>-pki-domain-abc-pki-cmp-session-abc] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>-pki-domain-abc-pki-cmp-session-abc] <strong>quit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>-pki-domain-abc] <strong>pki cmp initial-request</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>-pki-domain-abc]<strong> quit</strong></pre>
</li><li>Import CA and local certificates.<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <strong>pki import-certificate local filename abc_ir.cer</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <strong>pki import-certificate ca filename abc_ca0.cer</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <strong>pki import-certificate ca filename abc_ca1.cer</strong></pre>
</li><li>Enable PKI-based strict check.<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <a href="cmdqueryname=pki+strict-mode"><b><span class="cmdname">pki strict-mode</span></b></a></pre>
</li><li>Enable the automatic certificate update function.<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <strong>pki domain abc</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>-pki-domain-abc] <strong>pki cmp session abc</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>-pki-domain-abc-pki-cmp-session-abc] <strong>cmp request authentication-cert abc_ir.cer</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>-pki-domain-abc-pki-cmp-session-abc] <strong>certificate</strong> <strong>auto-update</strong> <strong>enable</strong></pre>
</li></ol>
</div>
<div class="section"><h4 class="sectiontitle">Verifying the Security Hardening Result</h4><ol><li>Run the <strong>display rsa pki local-key-pair</strong> <strong>public</strong> command to check information about the RSA key pair.</li><li>Run the <strong>display pki match-rsa-key certificate-filename file-name</strong> command to check the RSA key pair used by a specific certificate.</li><li>Run the <strong>display pki cert-req</strong> <strong>filename</strong> <em>file-name</em> command to check the content of the certificate request file with a specific name.</li><li>Run the <strong>display pki certificate</strong> <strong>filename</strong> <em>file-name</em> command to check the content of the certificate file with a specific name.</li><li>Run the <strong>display pki crl</strong> <strong>filename</strong> <em>file-name</em> command to check the content of the CRL file with a specific name.</li><li>Run the <strong>display pki ca_list</strong> [ <strong>domain</strong> <em>domainName</em> ] command to check the content of the CA certificates and CRL imported to the memory.</li><li>Run the <strong>display pki cert_list</strong> [ <strong>domain</strong> <em>domainName</em> ] command to check the content of the local certificates imported to the memory.</li></ol>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_sec_hardening_management_level1.html">Management Plane
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_hardening_3030.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0020.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>