
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring the Peer Mode">
<meta name="abstract" content="In peer mode, the two peers synchronize clocks with each other. One end can send the clock synchronization request message to the other and respond to the clock synchronization request message from the peer.">
<meta name="description" content="In peer mode, the two peers synchronize clocks with each other. One end can send the clock synchronization request message to the other and respond to the clock synchronization request message from the peer.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ntp_cfg_0004.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ntp_cfg_0006.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ntp_cfg_0008.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,jwx1168690,w00556928,w00437000,w00845984,w00606909,l00455378,ntpvrp">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="NTP">
<meta name="featuretype" content="System Management">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NTP">
<meta name="featuretype" content="System Management">
<meta name="featurename" content="NTP">
<meta name="featuretype" content="System Management">
<meta name="OWNER" content="w00845984,lwx1238418,l00587852">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00845984">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001847727685">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring the Peer Mode</title>
</head>
<body><a name="EN-US_TASK_0000001847727685"></a><a name="EN-US_TASK_0000001847727685"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring the Peer Mode</h1>
<div class="taskbody"><p>In peer mode, the two peers synchronize clocks with each other. One end can send the clock synchronization request message to the other and respond to the clock synchronization request message from the peer. </p>
<div class="steps-unordered"><a name="EN-US_TASK_0000001847727685__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure the NTP proactive peer end.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ntp-service+authentication-keyid"><b><span class="cmdname">ntp-service authentication-keyid </span></b></a><i><span class="varname">key-Id</span></i> <strong><span>authentication-mode</span></strong> { <strong><span>md5</span></strong> | <strong><span>hmac-sha256</span></strong> | <strong><span>aes-128-cmac</span></strong> | <strong><span>aes-256-cmac</span></strong> } { <i><span class="varname">password</span></i> | <strong><span>cipher</span></strong> <i><span class="varname">password</span></i> }</span><p><p>The NTP authentication key is configured.</p>
</p><p><p>Using the HMAC-SHA256 algorithm for NTP key authentication is recommended.</p>
<div class="notice"><span class="noticetitle"><img src="../../../../public_sys-resources/notice_3.0-en-us.png"> </span><div class="noticebody"><p>The algorithm specified using <strong>md5</strong> in the command is a weak security algorithm, which is not recommended. To use such an algorithm, run the <strong>undo crypto weak-algorithm disable</strong> command to enable the weak security algorithm function. To avoid security risks, you are advised to use a more secure algorithm.</p>
</div></div>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=ntp-service+authentication-password+complexity-check+enable"><b><span class="cmdname">ntp-service authentication-password complexity-check enable</span></b></a></span><p><p>Password strength check is enabled for NTP authentication.</p>
</p><p><p>After this command is configured, the system automatically verifies the strength of an entered password. Only the password that meets the strength requirements can be configured. You are advised to run this command on a network that requires high security.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=ntp-service"><b><span class="cmdname">ntp-service</span></b></a><span> [ <strong><span>ipv6</span></strong> ]</span> <strong><span>source-interface</span></strong> { <em><i><span class="varname">interface-name</span></i></em><i><span class="varname"> </span></i>| <em><i><span class="varname">interface_type</span></i></em><em><i><span class="varname"> </span></i><i><span class="varname">interface_num</span></i></em><i><span class="varname">ber </span></i>} [<strong><span> </span></strong><strong><strong><span>vpn-instance</span></strong></strong><em> vpnName</em> ]</span><p><p>The local source interface for sending NTP packets is specified.</p>
</p></li><li class="substepexpand"><span>Configure an IP address for the NTP peer.</span><p><ul><li>To specify an IP address for the remote peer, run the <a href="cmdqueryname=ntp-service+unicast-peer"><b><span class="cmdname">ntp-service unicast-peer</span></b></a> <i><span class="varname">ip-address</span></i> [ <strong><span>version</span></strong> <i><span class="varname">number</span></i> | <strong><span>authentication-keyid</span></strong> <i><span class="varname">key-id</span></i> | <strong><span>source-interface</span></strong> <i><span class="varname">interface-type interface-number</span></i><span> | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i></span> | <strong><span>preference</span></strong><span> | <strong><span>maxpoll</span></strong> <i><span class="varname">max-number</span></i> | <strong><span>minpoll</span></strong> <i><span class="varname">min-number</span></i> | <strong><span>preempt</span></strong> | <strong><span>port</span></strong> <i><span class="varname">port-number</span></i></span> ] <sup>*</sup> command.</li><li>To specify an IPv6 address for the remote peer, run the <span><a href="cmdqueryname=ntp-service+unicast-peer"><b><span class="cmdname">ntp-service unicast-peer</span></b></a> <span> <strong><span>ipv6</span></strong> <i><span class="varname">ipv6-address</span></i></span> [ <strong><span>authentication-keyid</span></strong> <i><span class="varname">key-id</span></i> | <strong><span>source-interface</span></strong> <i><span class="varname">interface-type interface-number</span></i> | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>preference</span></strong><span> | <strong><span>maxpoll</span></strong> <i><span class="varname">max-number</span></i> | <strong><span>minpoll</span></strong> <i><span class="varname">min-number</span></i> | <strong><span>preempt</span></strong> | <strong><span>port</span></strong> <i><span class="varname">port-number</span></i></span> ] <sup>*</sup></span> command.</li></ul>
<p>Step 3 is optional. If Step 3 is performed, and the <strong><span>source-interface</span></strong> parameter is configured in Step 4 to specify the source interface, the source interface specified in Step 4 is preferentially used.</p>
<p><i><span class="varname">ip-address</span></i> is the NTP peer IP address. It can be a host address, but not a broadcast address<span>, a multicast address,</span> or the IP address of the reference clock.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>After the NTP peer is specified, the local <span class="keyword">Router</span> runs in proactive peer mode. The passive peer end does not need to be configured.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>(Optional) Configure the NTP passive peer end.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ntp-service+authentication-keyid"><b><span class="cmdname">ntp-service authentication-keyid </span></b></a><i><span class="varname">key-Id</span></i> <strong><span>authentication-mode</span></strong> { <strong><span>md5</span></strong> | <strong><span>hmac-sha256</span></strong> } { <i><span class="varname">password</span></i> | <strong><span>cipher</span></strong> <i><span class="varname">password</span></i> }</span><p><p>The NTP authentication key is configured.</p>
</p><p><p>Using the HMAC-SHA256 algorithm for NTP key authentication is recommended.</p>
<div class="notice"><span class="noticetitle"><img src="../../../../public_sys-resources/notice_3.0-en-us.png"> </span><div class="noticebody"><p>The algorithm specified using <strong>md5</strong> in the command is a weak security algorithm, which is not recommended. To use such an algorithm, run the <strong>undo crypto weak-algorithm disable</strong> command to enable the weak security algorithm function. To avoid security risks, you are advised to use a more secure algorithm.</p>
</div></div>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=ntp-service+authentication-password+complexity-check+enable"><b><span class="cmdname">ntp-service authentication-password complexity-check enable</span></b></a></span><p><p>Password strength check is enabled for NTP authentication.</p>
</p><p><p>After this command is configured, the system automatically verifies the strength of an entered key. Only the key that meets the strength requirements can be configured. You are advised to run this command on a network that requires high security.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ntp-service"><b><span class="cmdname">ntp-service</span></b></a><span> [ <strong><span>ipv6</span></strong> ]</span> <strong><span>source-interface</span></strong> { <em><i><span class="varname">interface-name</span></i></em><i><span class="varname"> </span></i>| <em><i><span class="varname">interface_type</span></i></em><em><i><span class="varname"> </span></i><i><span class="varname">interface_num</span></i></em><i><span class="varname"> </span></i>} [<strong><span> </span></strong><strong><strong><span>vpn-instance</span></strong></strong><em> vpnName</em> ]</span><p><p>The local source interface for sending NTP packets is specified.</p>
</p><p><p>Generally, you only need to specify the IP address of the passive peer end on the proactive peer end. As such, the peer ends can then exchange NTP packets using this IP address.</p>
<p>If the source interface for sending NTP packets is specified on the passive peer end, the peer IP address configured on the proactive peer end must be the same as the IP address of the source interface. Otherwise, the proactive peer end cannot process NTP packets sent from the passive peer end and clock synchronization fails.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ntp_cfg_0004.html">Configuring Basic NTP Functions
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ntp_cfg_0006.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ntp_cfg_0008.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>