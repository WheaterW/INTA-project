
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring TDM on the CPOS-TRUNK Configured with LMSP">
<meta name="abstract" content="This section provides an example for configuring LMSP-based TDM on a CPOS interface.">
<meta name="description" content="This section provides an example for configuring LMSP-based TDM on a CPOS interface.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_lmsp_cfg_0019.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_lmsp_cfg_0021.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="lmspvrp,w00800033,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="LMSP">
<meta name="featuretype" content="WAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="LMSP">
<meta name="featuretype" content="WAN Access">
<meta name="featurename" content="LMSP">
<meta name="featuretype" content="WAN Access">
<meta name="featurename" content="LMSP">
<meta name="featuretype" content="WAN Access">
<meta name="OWNER" content="f00453093">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00830490">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172364412">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring TDM on the CPOS-TRUNK Configured with LMSP</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172364412"></a><a name="EN-US_TASK_0172364412"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring TDM on the CPOS-TRUNK Configured with LMSP</h1>
<div class="taskbody"><p>This section provides an example for configuring LMSP-based TDM on a CPOS interface.</p>
<div class="context"><a name="EN-US_TASK_0172364412__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>TDMoPSN service can enable mobile operators to receive transparent transmission of 2G services between BTSs and BSCs in the same city through TDM links in a Metro Ethernet (ME) network. This simple and cost-reducing service can be essential, because usually, it requires one to three E1 interfaces on a BTS to connect to a BSC on a 2G RAN, and some mobile operators do not own fixed network infrastructure and have to rent E1 lines at high prices.</p>
<p>In <a href="#EN-US_TASK_0172364412__fig_dc_ne_lmsp_cfg_002001">Figure 1</a>, it is required that the BTS and PE1 be connected through two E1 links. The BSC and PE2 should be connected through two CPOS interfaces, which are configured with LMSP so as to increase reliability of data. The encapsulation protocol on the channelized serial interface of the E1 links needs to be configured as TDM. Finally, a PW needs to be set up between PE1 and PE2 to transparently transmit TDM cells.</p>
<div class="fignone" id="EN-US_TASK_0172364412__fig_dc_ne_lmsp_cfg_002001"><a name="EN-US_TASK_0172364412__fig_dc_ne_lmsp_cfg_002001"></a><a name="fig_dc_ne_lmsp_cfg_002001"></a><span class="figcap"><b>Figure 1 </b>TDMoPSN networking</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The configurations in this example are performed on PE-1 and PE-2. <span class="keyword">HUAWEI NE40E-M2 series</span> can function as PE-1 and PE-2.</p>
<p>Interfaces 1 through 2 in this example are GE <span>0/1/0</span>, GE <span>0/2/0</span> respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_ne_lmsp_cfg_002001.png"></span><br><div class="tableBorder"><table cellpadding="4" cellspacing="0" summary=""><tr><td valign="top"><p><strong>Device Name</strong></p>
</td>
<td valign="top"><p><strong>Interface Name</strong></p>
</td>
<td valign="top"><p><strong>IP Address and Mask</strong></p>
</td>
</tr>
<tr><td valign="top"><p>PE1</p>
</td>
<td valign="top"><p>GE <span>0/1/0</span></p>
<p>Loopback0</p>
</td>
<td valign="top"><p>10.1.1.1/24</p>
<p>192.168.1.2/32</p>
</td>
</tr>
<tr><td valign="top"><p>P</p>
</td>
<td valign="top"><p>GE <span>0/1/0</span></p>
<p>GE <span>0/2/0</span></p>
<p>Loopback0</p>
</td>
<td valign="top"><p>10.1.1.2/24</p>
<p>10.2.1.1/24</p>
<p>192.168.1.4/32</p>
</td>
</tr>
<tr><td valign="top"><p>PE2</p>
</td>
<td valign="top"><p>GE <span>0/2/0</span></p>
<p>Loopback0</p>
</td>
<td valign="top"><p>10.2.1.2/24</p>
<p>192.168.1.3/32</p>
</td>
</tr>
</table></div>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172364412__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Run an IGP protocol on the backbone network so that devices can communicate with each other.</p>
</li><li><p>Configure basic MPLS functions on the backbone network, as well as MPLS L2VPN functions on PEs. Establish a remote MPLS LDP peer relationship between PEs at both ends of a PW.</p>
</li><li><p>Configure LMSP on PE2.</p>
</li><li><p>Configure TDM interface parameters.</p>
</li><li><p>Configure a PW template.</p>
</li><li><p>Establish MPLS L2VC connections on PE1 and PE2.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172364412__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li>L2VC ID at both ends of the PW (must be the same)</li><li>MPLS LSR IDs of the PEs and P device</li><li>IP addresses of the remote peers of PEs</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172364412__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run an IGP protocol on the backbone network so that devices can communicate with each other. For detailed configurations, see the configuration file of this example.</span></li><li><span>Configure basic MPLS functions on the backbone network, as well as MPLS L2VPN functions on PEs. Then, establish the remote MPLS LDP peer relationship between PEs at both ends of the PW. For configuration details, see <a href="#EN-US_TASK_0172364412__section_dc_ne_lmsp_cfg_002005">Configuration Files</a> in this section.</span><p><p>The remote MPLS LDP peer relationship is only required for dynamic PWs.</p>
</p></li><li><span>Configure LMSP.</span><p><div class="notice"><span class="noticetitle"><img src="../../../../public_sys-resources/notice_3.0-en-us.png"> </span><div class="noticebody"><p>The BSC device connected to PE2 must support LMSP.</p>
</div></div>
<p>Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface cpos-trunk 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-cpos-trunk1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-cpos-trunk1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>controller cpos <span>0/3/1</span></strong>
[<span class="keyword">*</span>PE2-Cpos<span>0/3/1</span>] <strong>aps group 1</strong>
[<span class="keyword">*</span>PE2-Cpos<span>0/3/1</span>] <strong>aps working </strong>
[<span class="keyword">*</span>PE2-Cpos<span>0/3/1</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Cpos<span>0/3/1</span>] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>controller cpos <span>0/3/2</span></strong>
[<span class="keyword">*</span>PE2-Cpos<span>0/3/2</span>] <strong>aps group 1</strong>
[<span class="keyword">*</span>PE2-Cpos<span>0/3/2</span>] <strong>aps protect </strong>
[<span class="keyword">*</span>PE2-Cpos<span>0/3/2</span>] <strong>aps mode one-plus-one unidirection</strong>
[<span class="keyword">*</span>PE2-Cpos<span>0/3/2</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Cpos<span>0/3/2</span>] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>controller cpos <span>0/3/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Cpos<span>0/3/1</span>] <strong>cpos-trunk 1</strong>
[<span class="keyword">*</span>PE2-Cpos<span>0/3/1</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Cpos<span>0/3/1</span>] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>controller cpos <span>0/3/2</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Cpos<span>0/3/2</span>] <strong>cpos-trunk 1</strong>
[<span class="keyword">*</span>PE2-Cpos<span>0/3/2</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Cpos<span>0/3/2</span>] <strong>quit</strong></pre>
<p># Run the <a href="cmdqueryname=display+aps+group"><b><span class="cmdname">display aps group</span></b></a> command on PE2 to view LMSP group configurations. Run the <a href="cmdqueryname=display+cpos-trunk"><b><span class="cmdname">display cpos-trunk</span></b></a> command on also on PE2 to view CPOS-Trunk interface configurations.</p>
<pre class="screen">&lt;PE2&gt; <strong>display aps group 1</strong></pre>
<pre class="screen">APS Group  1: Cpos <span>0/3/1</span> working channel 1(Active)
               Cpos<span>0/3/2</span> protection channel 0(Inactive)
               Unidirection, 1+1 mode, No Revert mode
               No Request on Both Working and Protection Side

------------------------------------------------------------------------
Group Work-Channel Protect-Channel Wtr W-State P-State Switch-Cmd Switch-Result
------------------------------------------------------------------------
1        Cpos <span>0/3/1</span>   Cpos <span>0/3/2</span>    NA    ok         ok         NA          idle
------------------------------------------------------------------------
total entry: 1
</pre>
<pre class="screen">&lt;PE2&gt; <strong>display cpos-trunk 1</strong></pre>
<pre class="screen">Interface Cpos-Trunk1's state information is:,
Operate status: up     Number Of Up Port In Trunk: 2
--------------------------------------------------------------------------------
PortName     Status     Active Status
Cpos<span>0/3/1</span>    Up         Active
Cpos<span>0/3/2</span>    Up         Inactive</pre>
</p></li><li><span>Configure TDM interface parameters.</span><p><ol type="a"><li><p>Configure PE1.</p>
<p># Configure the clear channelized mode for CE1 <span>0/2/1</span> and CE1 <span>0/2/2</span> on PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>controller e1 <span>0/2/1</span></strong>
[<span class="keyword">*</span>PE1-E1 <span>0/2/1</span>] <strong>using e1</strong>
[<span class="keyword">*</span>PE1-E1 <span>0/2/1</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-E1 <span>0/2/1</span>] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>controller e1 <span>0/2/2</span></strong>
[<span class="keyword">*</span>PE1-E1 <span>0/2/2</span>] <strong>using e1</strong>
[<span class="keyword">*</span>PE1-E1 <span>0/2/2</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-E1 <span>0/2/2</span>] <strong>quit</strong></pre>
</li><li><p>Configure PE2.</p>
<p># Set CPOS-Trunk interface parameters on PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface cpos-trunk 1</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Cpos-trunk1] <strong>e1 1 unframed</strong>
[<span class="keyword">*</span>PE2-Cpos-trunk1] <strong>e1 2 unframed</strong>
[<span class="keyword">*</span>PE2-Cpos-trunk1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Cpos-trunk1] <strong>quit</strong></pre>
</li></ol>
</p></li><li><span>Configure TDM as an encapsulation protocol on the serial interface.</span><p><ol type="a"><li><p>Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface serial<span>0/2/1</span>:0</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Serial<span>0/2/1</span>:0] <strong>link-protocol tdm</strong>
[<span class="keyword">*</span>PE1-Serial<span>0/2/1</span>:0] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Serial<span>0/2/1</span>:0] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface serial<span>0/2/2</span>:0</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Serial<span>0/2/2</span>:0] <strong>link-protocol tdm</strong>
[<span class="keyword">*</span>PE1-Serial<span>0/2/2</span>:0] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Serial<span>0/2/2</span>:0] <strong>quit</strong></pre>
</li><li><p>Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface trunk-serial1/1:0</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Trunk-Serial1/1:0] <strong>link-protocol tdm</strong>
[<span class="keyword">*</span>PE2-Trunk-Serial1/1:0] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Trunk-Serial1/1:0] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface trunk-serial1/2:0</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Trunk-Serial1/2:0] <strong>link-protocol tdm</strong>
[<span class="keyword">*</span>PE2-Trunk-Serial1/2:0] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Trunk-Serial1/2:0] <strong>quit</strong></pre>
</li></ol>
</p></li><li><span>Configuring PWs.</span><p><ol type="a"><li><p>Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>pw-template 1to3</strong>
[<span class="keyword">*</span>PE1-pw-template-1to3] <strong>peer-address 192.168.1.3</strong>
[<span class="keyword">*</span>PE1-pw-template-1to3] <strong>jitter-buffer depth 20</strong>
[<span class="keyword">*</span>PE1-pw-template-1to3] <strong>tdm-encapsulation-number 40</strong>
[<span class="keyword">*</span>PE1-pw-template-1to3] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-pw-template-1to3] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface serial<span>0/2/1</span>:0</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Serial<span>0/2/1</span>:0] <strong>mpls l2vc pw-template 1to3 100</strong>
[<span class="keyword">*</span>PE1-Serial<span>0/2/1</span>:0] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Serial<span>0/2/1</span>:0] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface serial<span>0/2/2</span>:0</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Serial<span>0/2/2</span>:0] <strong>mpls l2vc pw-template 1to3 200</strong>
[<span class="keyword">*</span>PE1-Serial<span>0/2/2</span>:0] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Serial<span>0/2/2</span>:0] <strong>quit</strong></pre>
</li><li><p>Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>pw-template 3to1</strong>
[<span class="keyword">*</span>PE2-pw-template-3to1] <strong>peer-address 192.168.1.2</strong>
[<span class="keyword">*</span>PE2-pw-template-3to1] <strong>jitter-buffer depth 20</strong>
[<span class="keyword">*</span>PE2-pw-template-3to1] <strong>tdm-encapsulation-number 40</strong>
[<span class="keyword">*</span>PE2-pw-template-3to1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-pw-template-3to1] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface trunk-serial1/1:0</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Trunk-Serial1/1:0] <strong>mpls l2vc pw-template 3to1 100</strong>
[<span class="keyword">*</span>PE2-Trunk-Serial1/1:0] <strong>undo shutdown</strong>
[<span class="keyword">*</span>PE2-Trunk-Serial1/1:0] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Trunk-Serial1/1:0] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface trunk-serial1/2:0</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Trunk-Serial1/2:0] <strong>mpls l2vc pw-template 3to1 200</strong>
[<span class="keyword">*</span>PE2-Trunk-Serial1/2:0] <strong>undo shutdown</strong>
[<span class="keyword">*</span>PE2-Trunk-Serial1/2:0] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Trunk-Serial1/2:0] <strong>quit</strong></pre>
<p>Run the <strong>display mpls l2vc</strong> command on PE1. The command output shows that the PW status is Up.</p>
<pre class="screen">&lt;PE1&gt; <strong>display mpls l2vc interface serial<span>0/2/1</span>:0</strong>
*client interface       : Serial<span>0/2/1</span>:0 is up
<strong>  session state          : up</strong>
<strong>  AC state               : up</strong>
<strong>  VC state               : up</strong>
  VC ID                  : 100
  VC type                : SAT E1 over Packet
  destination            : 192.168.1.3
  local group ID         : 0 
  remote group ID        : 0
  local VC label         : 146432
  remote VC label        : 145287
  TDM encapsulation number : 40
  jitter-buffer            : 20
  idle-code                : FF
  rtp-header               : disable
  local AC OAM State     : up
  local PSN State        : up
  local forwarding state : forwarding
  local status code      : 0x0
  remote AC OAM state    : up
  remote PSN state       : up
  remote forwarding state: forwarding
  remote statuscode      : 0x0   
  BFD for PW             : unavailable
  manual fault           : not set
  active state           : active
  forwarding entry       : not exist
  link state             : up
  local VC MTU           : 1500         
  remote VC MTU          : 1500
  local VCCV             : alert lsp-ping bfd
  remote VCCV            : none
  local control word     : disable      
  remote control word    : disable
  tunnel policy name     : --
  traffic behavior name  : --
  PW template name       : --
  primary or secondary   : primary
  VC tunnel/token info   : 0 tunnels/tokens
  create time            : 0 days, 4 hours, 48 minutes, 51 seconds
  up time                : 0 days, 3 hours, 43 minutes, 49 seconds
  last change time       : 0 days, 0 hours, 39 minutes, 29 seconds
  VC last up time        : 2008/12/26 12:02:49
  VC total up time       : 0 days, 3 hours, 43 minutes, 49 seconds
  CKey                   : 11
  NKey                   : 10
</pre>
</li></ol>
</p></li><li><span>Verify the configuration.</span><p><p>Simulate a fault on the side of PE2 connecting to the BSC.</p>
<p># Run the <a href="cmdqueryname=shutdown"><b><span class="cmdname">shutdown</span></b></a> command on CPOS <span>0/3/1</span>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>controller cpos <span>0/3/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Cpos<span>0/3/1</span>] <strong>shutdown</strong></pre>
<p>Run the <a href="cmdqueryname=display+aps+group+1"><b><span class="cmdname">display aps group 1</span></b></a> command on PE2. The LMSP status changes to Switch. Run the <a href="cmdqueryname=display+cpos-trunk+1"><b><span class="cmdname">display cpos-trunk 1</span></b></a> command to view the CPOS-Trunk member interface status. CPOS <span>0/3/2</span> becomes Active.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>display aps group 1</strong></pre>
<pre class="screen">APS Group  1: Cpos <span>0/3/1</span> working channel 1(Inactive)
               Cpos<span>0/3/2</span> protection channel 0(<strong>Active</strong>)
               Unidirection, 1+1 mode, No Revert mode
               No Request on Both Working and Protection Side

------------------------------------------------------------------------
Group Work-Channel Protect-Channel Wtr W-State P-State Switch-Cmd Switch-Result
------------------------------------------------------------------------
1       Cpos <span>0/3/1</span>   Cpos <span>0/3/2</span>    NA    sf     ok         NA          <strong>switch</strong>
------------------------------------------------------------------------
total entry: 1
</pre>
<pre class="screen">&lt;PE2&gt; <strong>display cpos-trunk 1</strong></pre>
<pre class="screen">Interface Cpos-Trunk1's state information is:,
Operate status: up     Number Of Up Port In Trunk: 2
--------------------------------------------------------------------------------
PortName     Status     Active Status
Cpos<span>0/3/1</span>   <strong>Down</strong>         Inactive
Cpos<span>0/3/2</span>    Up         <strong>Active</strong></pre>
<p>Run the <strong>display mpls l2vc</strong> command on PE1. The command output shows that the PW status is Up and has not been affected by the fault in CPOS <span>0/3/1</span> on PE2.</p>
<pre class="screen">&lt;PE1&gt; <strong>display mpls l2vc interface serial<span>0/2/1</span>:0</strong>
*client interface       : Serial<span>0/2/1</span>:0 is up
<strong>  session state          : up</strong>
<strong>  AC state               : up</strong>
<strong>  VC state               : up</strong>
  VC ID                  : 100
  VC type                : SAT E1 over Packet
  destination            : 192.168.1.3
  local group ID         : 0 
  remote group ID        : 0
  local VC label         : 146432
  remote VC label        : 145287
  TDM encapsulation number : 40
  jitter-buffer            : 20
  idle-code                : FF
  rtp-header               : disable
  local AC OAM State     : up
  local PSN State        : up
  local forwarding state : forwarding
  local status code      : 0x0
  remote AC OAM state    : up
  remote PSN state       : up
  remote forwarding state: forwarding
  remote statuscode      : 0x0   
  BFD for PW             : unavailable
  manual fault           : not set
  active state           : active
  forwarding entry       : not exist
  link state             : up
  local VC MTU           : 1500         
  remote VC MTU          : 1500
  local VCCV             : alert lsp-ping bfd
  remote VCCV            : none
  local control word     : disable      
  remote control word    : disable
  tunnel policy name     : --
  traffic behavior name  : --
  PW template name       : --
  primary or secondary   : primary
  VC tunnel/token info   : 0 tunnels/tokens
  create time            : 0 days, 4 hours, 48 minutes, 51 seconds
  up time                : 0 days, 4 hours, 02 minutes, 39 seconds
  last change time       : 0 days, 0 hours, 39 minutes, 29 seconds
  VC last up time        : 2008/12/26 12:02:49
  VC total up time       : 0 days, 4 hours, 02 minutes, 39 seconds
  CKey                   : 11
  NKey                   : 10
</pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172364412__section_dc_ne_lmsp_cfg_002005"><a name="EN-US_TASK_0172364412__section_dc_ne_lmsp_cfg_002005"></a><a name="section_dc_ne_lmsp_cfg_002005"></a><a name="EN-US_TASK_0172364412__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#
 sysname PE1
#
 mpls lsr-id 192.168.1.2
 mpls
#
 mpls l2vpn
#
pw-template 1to3
 peer-address 192.168.1.3
 jitter-buffer depth 20
 tdm-encapsulation-number 40
#
mpls ldp
#
 mpls ldp remote-peer 192.168.1.3
 remote-ip 192.168.1.3 
#
controller e1 <span>0/2/1</span>
using e1
undo shutdown
#
controller e1 <span>0/2/2</span>
using e1
undo shutdown
#
interface serial<span>0/2/1</span>:0
link-protocol tdm
mpls l2vc pw-template 1to3 100
undo shutdown
#
interface serial<span>0/2/2</span>:0
link-protocol tdm
mpls l2vc pw-template 1to3 200
undo shutdown
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.1.1 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack0
 ip address 192.168.1.2 255.255.255.255
#
ospf 1
area 0.0.0.0
  network 192.168.1.2 0.0.0.0
  network 10.1.1.0 0.0.0.255
#
return
</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
 sysname PE2
#
 mpls lsr-id 192.168.1.3
 mpls
#
 mpls l2vpn
#
pw-template 3to1
 peer-address 192.168.1.2
 jitter-buffer depth 20
 tdm-encapsulation-number 40
#
mpls ldp
#
 mpls ldp remote-peer 192.168.1.2
 remote-ip 192.168.1.2
#
controller Cpos<span>0/3/1</span>
 undo shutdown
 aps group 1
 aps working
#
controller Cpos<span>0/3/2</span>
 undo shutdown
 aps group 1
 aps protect
 aps mode one-plus-one unidirection
#
interface cpos-trunk1
e1 1 unframed
e1 2 unframed
 Cpos<span>0/3/1</span>
 Cpos<span>0/3/2</span>
#
interface trunk-serial1/1:0
link-protocol tdm
mpls l2vc pw-template 3to1 100
undo shutdown
#
interface trunk-serial1/2:0
link-protocol tdm
mpls l2vc pw-template 3to1 200
undo shutdown
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.2.2.2 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack0
 ip address 192.168.1.3 255.255.255.255
#
ospf 1
 area 0.0.0.0
  network 192.168.1.3 0.0.0.0
  network 10.2.1.0 0.0.0.255
#
return
</pre>
</li><li><p>P configuration file</p>
<pre class="screen">#
 sysname P
#
 mpls lsr-id 192.168.1.4
 mpls
#
mpls ldp
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.1.2 255.255.255.0
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.2.2.1 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack0
 ip address 192.168.1.4 255.255.255.255
#
ospf 1
 area 0.0.0.0
  network 192.168.1.4 0.0.0.0
  network 10.1.1.0 0.0.0.255
  network 10.2.1.0 0.0.0.255
#
return
</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_lmsp_cfg_0019.html">Configuration Examples
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_lmsp_cfg_0021.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>