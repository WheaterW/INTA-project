
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Priority Mappings for MPLS Packets">
<meta name="abstract" content="This section describes how to configure priority mappings for MPLS packets and the application environment of this function.">
<meta name="description" content="This section describes how to configure priority mappings for MPLS packets and the application environment of this function.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0037.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0051.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0126.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909,m00390128">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Class-based QoS">
<meta name="featuretype" content="QOS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Class-based QoS">
<meta name="featuretype" content="QOS">
<meta name="featurename" content="Class-based QoS">
<meta name="featuretype" content="QOS">
<meta name="OWNER" content="m00390128">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="m00915594">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172371268">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring Priority Mappings for MPLS Packets</title>
</head>
<body><a name="EN-US_TASK_0172371268"></a><a name="EN-US_TASK_0172371268"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Priority Mappings for MPLS Packets</h1>
<div class="taskbody"><p>This section describes how to configure priority mappings for MPLS packets and the application environment of this function.</p>
<div class="context"><a name="EN-US_TASK_0172371268__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Context</h4><p>A priority mapping based on BA classification maps network-specific traffic priorities between two networks of different types so that the traffic priorities can remain unchanged while traffic is being transmitted between various networks.</p>
<p>When the <span class="keyword">NE40E</span> serves as the border <span class="keyword">Router</span> for different networks, the original external priorities (EXP values) in the MPLS packets that go into the <span class="keyword">NE40E</span> are all mapped to the internal priorities represented by service classes of DiffServ and colors. When the <span class="keyword">NE40E</span> sends out a packet, the internal priority is mapped back to the external priority.</p>
<p>Generally, the priority mappings of MPLS packets are configured on the core device of the network.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172371268__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring priority mappings for MPLS packets, complete the following tasks:</p>
<ul><li><p>Configure physical parameters for interfaces.</p>
</li><li><p>Configure link layer attributes for interfaces to work properly.</p>
</li><li><p>Configure IP addresses for interfaces.</p>
</li><li><p>Enable a routing protocol for communication between devices.</p>
</li></ul>
<p>In VS mode, this configuration is supported only by the admin VS.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172371268__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=diffserv+domain"><b><span class="cmdname">diffserv domain</span></b></a> <i><span class="varname">ds-domain-name</span></i></span><p><p>A DiffServ domain is defined and its view is displayed.</p>
</p></li><li><span>Define traffic policies on the <span class="keyword">Router</span> based on the actual situation.</span><p><ul><li><p>To define a traffic policy for incoming MPLS traffic, run the <a href="cmdqueryname=mpls-exp-inbound"><b><span class="cmdname">mpls-exp-inbound</span></b></a> <i><span class="varname">exp</span></i> <strong><span>phb</span></strong> <i><span class="varname">service-class</span></i> [ <i><span class="varname">color</span></i> ] command.</p>
</li><li><p>To define a traffic policy for outgoing MPLS traffic, run the <a href="cmdqueryname=mpls-exp-outbound"><b><span class="cmdname">mpls-exp-outbound</span></b></a> <i><span class="varname">service-class</span></i> <i><span class="varname">color</span></i> <strong><span>map</span></strong> <i><span class="varname">exp-value</span></i> command.</p>
</li></ul>
<p>The system predefines a default domain. If you do not configure priority mappings in Step 3 for the DiffServ domain, the system uses the default mappings. The default domain describes the default mappings from the EXP values of MPLS packets to QoS service classes and colors, or from QoS service classes and colors to the EXP values of MPLS packets. You can change the mappings in the default domain. The EXP values of the packets from an upstream device are mapped to QoS service classes and colors. Their mappings are shown in <a href="#EN-US_TASK_0172371268__tab_dc_ne_qos_cfg_005206">Table 1</a>. The QoS service classes and colors of the packets entering a downstream device are mapped to EXP values. Their mappings are shown in <a href="#EN-US_TASK_0172371268__tab_dc_ne_qos_cfg_005208">Table 2</a>.</p>
<p>The default mappings between the EXP values of MPLS packets and QoS service classes are shown in <a href="#EN-US_TASK_0172371268__tab_dc_ne_qos_cfg_005206">Table 1</a>.</p>

<div class="tableBorder"><a name="EN-US_TASK_0172371268__tab_dc_ne_qos_cfg_005206"></a><a name="tab_dc_ne_qos_cfg_005206"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172371268__tab_dc_ne_qos_cfg_005206" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Default mappings between the EXP values and QoS service classes</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="14.788521147885211%" id="mcps1.4.3.3.2.4.2.7.1.1" liSelected="liSelected"><p>EXP</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="17.658234176582344%" id="mcps1.4.3.3.2.4.2.7.1.2" liSelected="liSelected"><p>Service</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="16.698330166983304%" id="mcps1.4.3.3.2.4.2.7.1.3" liSelected="liSelected"><p>Color</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="16.028397160283973%" id="mcps1.4.3.3.2.4.2.7.1.4" liSelected="liSelected"><p>EXP</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="16.108389161083892%" id="mcps1.4.3.3.2.4.2.7.1.5" liSelected="liSelected"><p>Service</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="18.718128187181282%" id="mcps1.4.3.3.2.4.2.7.1.6" liSelected="liSelected"><p>Color</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="14.788521147885211%" headers="mcps1.4.3.3.2.4.2.7.1.1 "><p>0</p>
</td>
<td class="cellrowborder" valign="top" width="17.658234176582344%" headers="mcps1.4.3.3.2.4.2.7.1.2 "><p>BE</p>
</td>
<td class="cellrowborder" valign="top" width="16.698330166983304%" headers="mcps1.4.3.3.2.4.2.7.1.3 "><p>Green</p>
</td>
<td class="cellrowborder" valign="top" width="16.028397160283973%" headers="mcps1.4.3.3.2.4.2.7.1.4 "><p>4</p>
</td>
<td class="cellrowborder" valign="top" width="16.108389161083892%" headers="mcps1.4.3.3.2.4.2.7.1.5 "><p>AF4</p>
</td>
<td class="cellrowborder" valign="top" width="18.718128187181282%" headers="mcps1.4.3.3.2.4.2.7.1.6 "><p>Green</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="14.788521147885211%" headers="mcps1.4.3.3.2.4.2.7.1.1 "><p>1</p>
</td>
<td class="cellrowborder" valign="top" width="17.658234176582344%" headers="mcps1.4.3.3.2.4.2.7.1.2 "><p>AF1</p>
</td>
<td class="cellrowborder" valign="top" width="16.698330166983304%" headers="mcps1.4.3.3.2.4.2.7.1.3 "><p>Green</p>
</td>
<td class="cellrowborder" valign="top" width="16.028397160283973%" headers="mcps1.4.3.3.2.4.2.7.1.4 "><p>5</p>
</td>
<td class="cellrowborder" valign="top" width="16.108389161083892%" headers="mcps1.4.3.3.2.4.2.7.1.5 "><p>EF</p>
</td>
<td class="cellrowborder" valign="top" width="18.718128187181282%" headers="mcps1.4.3.3.2.4.2.7.1.6 "><p>Green</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="14.788521147885211%" headers="mcps1.4.3.3.2.4.2.7.1.1 "><p>2</p>
</td>
<td class="cellrowborder" valign="top" width="17.658234176582344%" headers="mcps1.4.3.3.2.4.2.7.1.2 "><p>AF2</p>
</td>
<td class="cellrowborder" valign="top" width="16.698330166983304%" headers="mcps1.4.3.3.2.4.2.7.1.3 "><p>Green</p>
</td>
<td class="cellrowborder" valign="top" width="16.028397160283973%" headers="mcps1.4.3.3.2.4.2.7.1.4 "><p>6</p>
</td>
<td class="cellrowborder" valign="top" width="16.108389161083892%" headers="mcps1.4.3.3.2.4.2.7.1.5 "><p>CS6</p>
</td>
<td class="cellrowborder" valign="top" width="18.718128187181282%" headers="mcps1.4.3.3.2.4.2.7.1.6 "><p>Green</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="14.788521147885211%" headers="mcps1.4.3.3.2.4.2.7.1.1 "><p>3</p>
</td>
<td class="cellrowborder" valign="top" width="17.658234176582344%" headers="mcps1.4.3.3.2.4.2.7.1.2 "><p>AF3</p>
</td>
<td class="cellrowborder" valign="top" width="16.698330166983304%" headers="mcps1.4.3.3.2.4.2.7.1.3 "><p>Green</p>
</td>
<td class="cellrowborder" valign="top" width="16.028397160283973%" headers="mcps1.4.3.3.2.4.2.7.1.4 "><p>7</p>
</td>
<td class="cellrowborder" valign="top" width="16.108389161083892%" headers="mcps1.4.3.3.2.4.2.7.1.5 "><p>CS7</p>
</td>
<td class="cellrowborder" valign="top" width="18.718128187181282%" headers="mcps1.4.3.3.2.4.2.7.1.6 "><p>Green</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>The default mappings between the EXP values of MPLS packets and QoS service classes are shown in <a href="#EN-US_TASK_0172371268__tab_dc_ne_qos_cfg_005208">Table 2</a>.</p>

<div class="tableBorder"><a name="EN-US_TASK_0172371268__tab_dc_ne_qos_cfg_005208"></a><a name="tab_dc_ne_qos_cfg_005208"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172371268__tab_dc_ne_qos_cfg_005208" frame="border" border="1" rules="all"><caption><b>Table 2 </b>Default mappings between the EXP values and QoS service classes</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.32%" id="mcps1.4.3.3.2.6.2.4.1.1" liSelected="liSelected"><p>Service</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.339999999999996%" id="mcps1.4.3.3.2.6.2.4.1.2" liSelected="liSelected"><p>Color</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.339999999999996%" id="mcps1.4.3.3.2.6.2.4.1.3" liSelected="liSelected"><p>MPLS EXP</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="33.32%" headers="mcps1.4.3.3.2.6.2.4.1.1 "><p>BE</p>
</td>
<td class="cellrowborder" valign="top" width="33.339999999999996%" headers="mcps1.4.3.3.2.6.2.4.1.2 "><p>Green</p>
</td>
<td class="cellrowborder" valign="top" width="33.339999999999996%" headers="mcps1.4.3.3.2.6.2.4.1.3 "><p>0</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.32%" headers="mcps1.4.3.3.2.6.2.4.1.1 "><p>AF1</p>
</td>
<td class="cellrowborder" valign="top" width="33.339999999999996%" headers="mcps1.4.3.3.2.6.2.4.1.2 "><p>Green, Yellow, Red</p>
</td>
<td class="cellrowborder" valign="top" width="33.339999999999996%" headers="mcps1.4.3.3.2.6.2.4.1.3 "><p>1</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.32%" headers="mcps1.4.3.3.2.6.2.4.1.1 "><p>AF2</p>
</td>
<td class="cellrowborder" valign="top" width="33.339999999999996%" headers="mcps1.4.3.3.2.6.2.4.1.2 "><p>Green, Yellow, Red</p>
</td>
<td class="cellrowborder" valign="top" width="33.339999999999996%" headers="mcps1.4.3.3.2.6.2.4.1.3 "><p>2</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.32%" headers="mcps1.4.3.3.2.6.2.4.1.1 "><p>AF3</p>
</td>
<td class="cellrowborder" valign="top" width="33.339999999999996%" headers="mcps1.4.3.3.2.6.2.4.1.2 "><p>Green, Yellow, Red</p>
</td>
<td class="cellrowborder" valign="top" width="33.339999999999996%" headers="mcps1.4.3.3.2.6.2.4.1.3 "><p>3</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.32%" headers="mcps1.4.3.3.2.6.2.4.1.1 "><p>AF4</p>
</td>
<td class="cellrowborder" valign="top" width="33.339999999999996%" headers="mcps1.4.3.3.2.6.2.4.1.2 "><p>Green, Yellow, Red</p>
</td>
<td class="cellrowborder" valign="top" width="33.339999999999996%" headers="mcps1.4.3.3.2.6.2.4.1.3 "><p>4</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.32%" headers="mcps1.4.3.3.2.6.2.4.1.1 "><p>EF</p>
</td>
<td class="cellrowborder" valign="top" width="33.339999999999996%" headers="mcps1.4.3.3.2.6.2.4.1.2 "><p>Green</p>
</td>
<td class="cellrowborder" valign="top" width="33.339999999999996%" headers="mcps1.4.3.3.2.6.2.4.1.3 "><p>5</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.32%" headers="mcps1.4.3.3.2.6.2.4.1.1 "><p>CS6</p>
</td>
<td class="cellrowborder" valign="top" width="33.339999999999996%" headers="mcps1.4.3.3.2.6.2.4.1.2 "><p>Green</p>
</td>
<td class="cellrowborder" valign="top" width="33.339999999999996%" headers="mcps1.4.3.3.2.6.2.4.1.3 "><p>6</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.32%" headers="mcps1.4.3.3.2.6.2.4.1.1 "><p>CS7</p>
</td>
<td class="cellrowborder" valign="top" width="33.339999999999996%" headers="mcps1.4.3.3.2.6.2.4.1.2 "><p>Green</p>
</td>
<td class="cellrowborder" valign="top" width="33.339999999999996%" headers="mcps1.4.3.3.2.6.2.4.1.3 "><p>7</p>
</td>
</tr>
</tbody>
</table>
</div>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span></span><p><p>The interface view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=trust+upstream"><b><span class="cmdname">trust upstream</span></b></a> { <i><span class="varname">ds-domain-name</span></i> | <strong><span>default</span></strong> }</span><p><p>The DiffServ domain is bound to the interface, and BA classification is enabled on the interface.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=mpls+l2vc+diffserv+domain"><b><span class="cmdname">mpls l2vc diffserv domain</span></b></a> { <span><strong><span>5p3d</span></strong> | </span><i><span class="varname">domain-name</span></i> | <strong><span>default</span></strong> }</span><p><p>A DiffServ domain to which the private network label priority to be marked belongs is bound to a VLL interface.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=slot"><b><span class="cmdname">slot</span></b></a> <i><span class="varname">slot-id</span></i></span></span><p><p>The slot view is displayed.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=mpls-inner-exp+phb+disable+vll"><b><span class="cmdname">mpls-inner-exp phb disable vll</span></b></a></span><p><p>The device is disabled from obtaining the private network label priority for downstream traffic on the PW interface in VLL scenarios.</p>
</p><p></p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0172371268__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the following commands to check the previous configuration.</p>
<ul><li>Run the <a href="cmdqueryname=display+diffserv+domain"><b><span class="cmdname">display diffserv domain</span></b></a> [ <i><span class="varname">ds-domain-name</span></i> ] [ <strong><span>8021p</span></strong> | <span><strong><span>atm</span></strong> | </span><strong><span>dscp</span></strong> | <strong><span>exp</span></strong> ] [ <strong><span>inbound</span></strong>| <strong><span>outbound</span></strong> ] command to check the DiffServ domain configuration.</li><li>Run the <a href="cmdqueryname=display+diffserv+domain+application"><b><span class="cmdname">display diffserv domain application</span></b></a> <i><span class="varname">ds-domain-name</span></i> command to check the interface list applied to a specified DiffServ domain.</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0037.html">Class-based QoS Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0051.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0126.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>