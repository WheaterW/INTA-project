
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Queue Scheduling on Low-Speed Links">
<meta name="abstract" content="This section provides an example for configuring queue scheduling on low-speed links to ensure that higher-priority packets are forwarded ahead of lower-priority packets.">
<meta name="description" content="This section provides an example for configuring queue scheduling on low-speed links to ensure that higher-priority packets are forwarded ahead of lower-priority packets.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cmca-qos_cfg_0029.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cmca-qos_cfg_0032.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909,m00390128">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Congestion Management and Congestion Avoidance">
<meta name="featuretype" content="QOS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Congestion Management and Congestion Avoidance">
<meta name="featuretype" content="QOS">
<meta name="featurename" content="Congestion Management and Congestion Avoidance">
<meta name="featuretype" content="QOS">
<meta name="featurename" content="Congestion Management and Congestion Avoidance">
<meta name="featuretype" content="QOS">
<meta name="OWNER" content="m00390128">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="m00915594">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172371207">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Queue Scheduling on Low-Speed Links</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172371207"></a><a name="EN-US_TASK_0172371207"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Queue Scheduling on Low-Speed Links</h1>
<div class="taskbody"><p>This section provides an example for configuring queue scheduling on low-speed links to ensure that higher-priority packets are forwarded ahead of lower-priority packets.</p>
<div class="context"><a name="EN-US_TASK_0172371207__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0172371207__fig_dc_ne_qos_cfg_500601">Figure 1</a>, <span class="keyword">Device</span>A and <span class="keyword">Device</span>B are connected through a low-speed link with limited bandwidth resources. To ensure that packets of different priorities are allocated bandwidth resources based on their CoSs when congestion occurs, priority queuing (PQ) and weighted fair queuing (WFQ) need to be configured on the <span class="keyword">Device</span>A's interface connecting to <span class="keyword">Device</span>B. PQ applies to higher-priority packets, and WFQ applies to other packets.</p>
<p>In this example, PQ applies to packets in the EF queue, and the peak information rate (PIR) is set for the expedited forwarding (EF) queue; WFQ applies to packets in the assured forwarding 2 (AF2), AF3, and AF4 queues, and the same PIR is set for the AF2, AF3, and AF4 queues.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 represents Serial <span>0/2/0</span>:0.</p>
</div></div>
<div class="fignone" id="EN-US_TASK_0172371207__fig_dc_ne_qos_cfg_500601"><a name="EN-US_TASK_0172371207__fig_dc_ne_qos_cfg_500601"></a><a name="fig_dc_ne_qos_cfg_500601"></a><span class="figcap"><b>Figure 1 </b>Networking diagram for configuring queue scheduling on a low-speed link</span><br><span><img class="vsd" src="images/fig_dc_ne_qos_cfg_500601.png"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172371207__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>None</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172371207__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure IP addresses for interfaces on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B.</p>
</li><li><p>Configure PQ and WFQ on <span class="keyword">Device</span>A.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172371207__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IP addresses of interfaces</p>
</li><li><p>PIR for the EF queue to which PQ applies</p>
</li><li><p>PIR for the AF2, AF3, and AF4 queues to which WFQ applies</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172371207__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure serial interfaces on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B.</span><p><p>The configuration details are not provided here. For details, see the <em><span class="keyword">HUAWEI NE40E-M2 series</span> <span class="keyword">Universal Service Router</span> Configuration Guide - WAN Access</em>.</p>
</p></li><li><span>Configure IP addresses for interfaces on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B to ensure network connectivity.</span><p><p>The configuration details are not provided here. For details, see the <em><span class="keyword">HUAWEI NE40E-M2 series</span> <span class="keyword">Universal Service Router</span> Configuration Guide - IP Routing</em>.</p>
</p></li><li><span>Configure PQ and WFQ on Serial <span>0/2/0</span>:0 of <span class="keyword">Device</span>A.</span><p><p># Configure PQ.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>A&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong>interface serial <span>0/2/0</span>:0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-serial<span>0/2/0</span>:0] <strong>port-queue ef pq shaping pir percentage 60</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-serial<span>0/2/0</span>:0] <strong>commit</strong></pre>
<p># Configure WFQ.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-serial<span>0/2/0</span>:0] <strong>port-queue af4 wfq shaping cir 200 pir percentage 40</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-serial<span>0/2/0</span>:0] <strong>port-queue af3 wfq shaping cir 300 pir percentage 40</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-serial<span>0/2/0</span>:0] <strong>port-queue af2 wfq shaping cir 400 pir percentage 40</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-serial<span>0/2/0</span>:0] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-serial<span>0/2/0</span>:0] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># After the preceding configuration is complete, run the <strong>display ls-port-queue configuration interface</strong> command to check the detailed configuration of port queues.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong>display ls-port-queue configuration interface Serial<span>0/2/0</span>:0 outbound </strong>
 GigabitEthernet<span>0/2/0</span> outbound current port-queue configuration: 
 be :  arithmetic: wfq                weight: 10         tm weight: 3                                                               
       fact weight: 10.00             shaping(kbps): NA                                                                             
       port-wred: NA                                                                                                                
         green (low-high limit) (kbytes)                  712704 - 1425408                                                          
         yellow(low-high limit) (kbytes)                  712704 - 1425408                                                          
         red   (low-high limit) (kbytes)                  712704 - 1425408                                                          
       current queue-length     (kbytes)                  1425408 
       cir(kbps):123,000              cir-percentage:NA
       cir-arithmetic:pq              cir-weight:NA
       pir(kbps):123,000              pir-percentage:NA
       pir-arithmetic:lpq             pir-weight:NA                                                                  
 af1:  arithmetic: wfq                weight: 10         tm weight: 3                                                               
       fact weight: 10.00             shaping(kbps): NA                                                                             
       port-wred: NA                                                                                                                
         green (low-high limit) (kbytes)                  712704 - 1425408                                                          
         yellow(low-high limit) (kbytes)                  712704 - 1425408                                                          
         red   (low-high limit) (kbytes)                  712704 - 1425408                                                          
       current queue-length     (kbytes)                  1425408    
       cir(kbps):NA                   cir-percentage:10
       cir-arithmetic:pq              cir-weight:NA
       pir(kbps):NA                   pir-percentage:20
       pir-arithmetic:wfq             pir-weight:15                                                               
 af2:  arithmetic: wfq                weight: 10         tm weight: 3                                                               
       fact weight: 10.00             shaping(kbps): NA                                                                             
       port-wred: NA                                                                                                                
         green (low-high limit) (kbytes)                  712704 - 1425408                                                          
         yellow(low-high limit) (kbytes)                  712704 - 1425408                                                          
         red   (low-high limit) (kbytes)                  712704 - 1425408                                                          
       current queue-length     (kbytes)                  1425408
       cir(kbps):NA                   cir-percentage:NA
       cir-arithmetic:NA              cir-weight:NA
       pir(kbps):NA                   pir-percentage:NA
       pir-arithmetic:NA              pir-weight:NA                                                                    
 af3:  arithmetic: wfq                weight: 15         tm weight: 2                                                               
       fact weight: 15.00             shaping(kbps): NA                                                                             
       port-wred: NA                                                                                                                
         green (low-high limit) (kbytes)                  712704 - 1425408                                                          
         yellow(low-high limit) (kbytes)                  712704 - 1425408                                                          
         red   (low-high limit) (kbytes)                  712704 - 1425408                                                          
       current queue-length     (kbytes)                  1425408     
       cir(kbps):NA                   cir-percentage:NA
       cir-arithmetic:NA              cir-weight:NA
       pir:(kbps)NA                   pir-percentage:NA
       pir-arithmetic:NA              pir-weight:NA                                                                
 af4:  arithmetic: wfq                weight: 15         tm weight: 2                                                               
       fact weight: 15.00             shaping(kbps): NA                                                                             
       port-wred: NA                                                                                                                
         green (low-high limit) (kbytes)                  712704 - 1425408                                                          
         yellow(low-high limit) (kbytes)                  712704 - 1425408                                                          
         red   (low-high limit) (kbytes)                  712704 - 1425408                                                          
       current queue-length     (kbytes)                  1425408
       cir(kbps):NA                   cir-percentage:NA
       cir-arithmetic:NA              cir-weight:NA
       pir(kbps):NA                   pir-percentage:NA
       pir-arithmetic:NA              pir-weight:NA                                                                     
 ef :  arithmetic: pq                 weight: NA         tm weight: NA                                                              
       fact weight: NA                shaping(kbps): NA                                                                             
       port-wred: NA                                                                                                                
         green (low-high limit) (kbytes)                  6096 - 12192                                                              
         yellow(low-high limit) (kbytes)                  6096 - 12192                                                              
         red   (low-high limit) (kbytes)                  6096 - 12192                                                              
       current queue-length     (kbytes)                  12192
       cir(kbps):NA                   cir-percentage:NA
       cir-arithmetic:NA              cir-weight:NA
       pir:(kbps)NA                   pir-percentage:NA
       pir-arithmetic:NA              pir-weight:NA                                                                      
 cs6:  arithmetic: pq                 weight: NA         tm weight: NA                                                              
       fact weight: NA                shaping(kbps): NA                                                                             
       port-wred: NA                                                                                                                
         green (low-high limit) (kbytes)                  6096 - 12192                                                              
         yellow(low-high limit) (kbytes)                  6096 - 12192                                                              
         red   (low-high limit) (kbytes)                  6096 - 12192                                                              
       current queue-length     (kbytes)                  12192 
       cir(kbps):NA                   cir-percentage:NA
       cir-arithmetic:NA              cir-weight:NA
       pir(kbps):NA                   pir-percentage:NA
       pir-arithmetic:NA              pir-weight:NA                                                                     
 cs7:  arithmetic: pq                 weight: NA         tm weight: NA                                                              
       fact weight: NA                shaping(kbps): NA                                                                             
       port-wred: NA                                                                                                                
         green (low-high limit) (kbytes)                  6096 - 12192                                                              
         yellow(low-high limit) (kbytes)                  6096 - 12192                                                              
         red   (low-high limit) (kbytes)                  6096 - 12192                                                              
       current queue-length     (kbytes)                  12192   
       cir(kbps):NA                   cir-percentage:NA
       cir-arithmetic:NA              cir-weight:NA
       pir:(kbps)NA                   pir-percentage:NA
       pir-arithmetic:NA              pir-weight:NA</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172371207__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span>A configuration file</p>
</li></ul>
<pre class="screen">#</pre>
<pre class="screen"> Sysname <span class="keyword">Device</span>A</pre>
<pre class="screen">#</pre>
<pre class="screen"> controller e1 <span>0/2/0</span></pre>
<pre class="screen">  channel-set 0 timeslot-list 1-31</pre>
<pre class="screen">  undo shutdown</pre>
<pre class="screen">#</pre>
<pre class="screen">interface Serial<span>0/2/0</span>:0 </pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 3.3.3.1 255.255.255.0</pre>
<pre class="screen"> port-queue af2 wfq shaping cir 400 pir percentage 40                                       </pre>
<pre class="screen"> port-queue af3 wfq shaping cir 300 pir percentage 40                                       </pre>
<pre class="screen"> port-queue af4 wfq shaping cir 200 pir percentage 40                                       </pre>
<pre class="screen"> port-queue ef pq shaping pir percentage 60  </pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
<ul><li><p><span class="keyword">Device</span>B configuration file</p>
</li></ul>
<pre class="screen">#</pre>
<pre class="screen"> Sysname <span class="keyword">Device</span>B</pre>
<pre class="screen">#</pre>
<pre class="screen"> controller e1 <span>0/2/0</span></pre>
<pre class="screen">  channel-set 0 timeslot-list 1-31</pre>
<pre class="screen">  undo shutdown</pre>
<pre class="screen">#</pre>
<pre class="screen">interface Serial<span>0/2/0</span>:0 </pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 3.3.3.2 255.255.255.0</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cmca-qos_cfg_0029.html">Configuration Examples for Congestion Management and Congestion Avoidance
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cmca-qos_cfg_0032.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>