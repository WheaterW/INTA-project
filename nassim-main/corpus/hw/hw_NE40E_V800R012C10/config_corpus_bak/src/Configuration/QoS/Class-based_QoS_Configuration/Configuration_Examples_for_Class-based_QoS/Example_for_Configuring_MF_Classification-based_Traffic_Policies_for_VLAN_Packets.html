
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring MF Classification-based Traffic Policies for VLAN Packets">
<meta name="abstract" content="This section provides an example for configuring and applying an MF classification-based traffic policy in a VLAN QoS scenario.">
<meta name="description" content="This section provides an example for configuring and applying an MF classification-based traffic policy in a VLAN QoS scenario.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0068.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0069.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_2054.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909,m00390128">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Class-based QoS">
<meta name="featuretype" content="QOS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Class-based QoS">
<meta name="featuretype" content="QOS">
<meta name="featurename" content="Class-based QoS">
<meta name="featuretype" content="QOS">
<meta name="featurename" content="Class-based QoS">
<meta name="featuretype" content="QOS">
<meta name="OWNER" content="m00390128">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="m00390128">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172371309">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring MF Classification-based Traffic Policies for VLAN Packets</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172371309"></a><a name="EN-US_TASK_0172371309"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring MF Classification-based Traffic Policies for VLAN Packets</h1>
<div class="taskbody"><p>This section provides an example for configuring and applying an MF classification-based traffic policy in a VLAN QoS scenario.</p>
<div class="context"><a name="EN-US_TASK_0172371309__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0172371309__fig_dc_ne_qos_cfg_009901">Figure 1</a>, <span class="keyword">Device</span>A and <span class="keyword">Device</span>B connect to each other through a VLAN. When IP packets sent by <span class="keyword">Device</span>A enter the VLAN, by default, the precedence of these IP packets is mapped to the 802.1p value. When these IP packets (carrying VLAN frame priority) leave the VLAN and arrive at <span class="keyword">Device</span>B, the VLAN frame priority is mapped to the IP precedence according to the configuration on <span class="keyword">Device</span>B. Then, these packets are forwarded according to their IP precedence.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>interface1, interface2, and interface3 in this example represent GE <span>0/1/0</span>, GE <span>0/2/0</span>.1, and GE <span>0/3/0</span>, respectively.</p>
</div></div>
<div class="fignone" id="EN-US_TASK_0172371309__fig_dc_ne_qos_cfg_009901"><a name="EN-US_TASK_0172371309__fig_dc_ne_qos_cfg_009901"></a><a name="fig_dc_ne_qos_cfg_009901"></a><span class="figcap"><b>Figure 1 </b>Networking diagram for configuring VLAN QoS</span><br><span><img class="vsd" src="images/fig_dc_ne_qos_cfg_009901.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172371309__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Notes</h4><p>When configuring VLAN QoS, pay attention to the following:</p>
<ul><li>The statistical function of traffic policies is disabled by default. To display the statistics about a traffic policy, you can enable statistics for the traffic policy by running the <strong>statistics enable</strong> command.</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172371309__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure the VLAN and routes on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B.</p>
</li><li><p>Configure QoS policies on <span class="keyword">Device</span>B.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172371309__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Names of traffic classification, traffic behaviors, and traffic policies</p>
</li><li><p>Preferences for re-marking</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172371309__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Define a classifier to match packets whose 802.1p value is 2.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>B</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>traffic classifier test</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-classifier-test] <strong>if-match 8021p 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-classifier-test] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-classifier-test] <strong>quit</strong></pre>
</p></li><li><span>Define a traffic behavior to re-mark the IP precedence of packets as 4.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> traffic behavior test</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-behavior-test]<strong> remark ip-precedence 4</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-behavior-test] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-behavior-test] <strong>quit</strong></pre>
</p></li><li><span>Define a QoS policy to associate a configured traffic behavior with a specified traffic classifier.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>traffic policy test</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-trafficpolicy-test]<strong> classifier test behavior test</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-trafficpolicy-test]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-trafficpolicy-test]<strong> quit</strong></pre>
</p></li><li><span>Apply the QoS policy to the incoming traffic of GE <span>0/2/0</span>.1 on <span class="keyword">Device</span>B.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>interface Gigabitethernet <span>0/2/0</span>.1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-Gigabitethernet<span>0/2/0</span>.1]<strong> traffic-policy test inbound link-layer</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-Gigabitethernet<span>0/2/0</span>.1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-Gigabitethernet<span>0/2/0</span>.1]<strong> quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>After the preceding configurations, when packets whose IP precedence is 2 are forwarded by GE <span>0/1/0</span>.1 on <span class="keyword">Device</span>A reach the VLAN, the IP precedence 2 is mapped to the VLAN priority 2. After these VLAN frames reach <span class="keyword">Device</span>B, <span class="keyword">Device</span>B forwards these VLAN frames as IP packets with the IP precedence of 4 to the network segment 10.1.2.0/24.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172371309__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><div class="p"><span class="keyword">Device</span>B configuration file<pre class="screen">#</pre>
<pre class="screen"> sysname <span class="keyword">Device</span>B</pre>
<pre class="screen">#</pre>
<pre class="screen">traffic classifier test operator or</pre>
<pre class="screen"> if-match 8021p 2</pre>
<pre class="screen">#</pre>
<pre class="screen">traffic behavior test</pre>
<pre class="screen"> remark ip-precedence 4</pre>
<pre class="screen">#</pre>
<pre class="screen">traffic policy test</pre>
<pre class="screen"> classifier test behavior test precedence 1</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span>.1</pre>
<pre class="screen"> traffic-policy test inbound link-layer</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</div>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0068.html">Configuration Examples for Class-based QoS
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0069.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_2054.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>