
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a Route-Policy on a Route Sender">
<meta name="abstract" content="This section describes how to configure a route-policy on a route sender.">
<meta name="description" content="This section describes how to configure a route-policy on a route sender.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_2029.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_2031.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909,m00390128">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="QPPB">
<meta name="featuretype" content="QOS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="QPPB">
<meta name="featuretype" content="QOS">
<meta name="featurename" content="QPPB">
<meta name="featuretype" content="QOS">
<meta name="featurename" content="QPPB">
<meta name="featuretype" content="QOS">
<meta name="OWNER" content="m00390128">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00596142">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172371429">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a Route-Policy on a Route Sender</title>
</head>
<body><a name="EN-US_TASK_0172371429"></a><a name="EN-US_TASK_0172371429"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a Route-Policy on a Route Sender</h1>
<div class="taskbody" id="taskbody1700738344214058"><p id="shortdesc190962488214058">This section describes how to configure a route-policy on a route sender.</p>
<div class="context"><a name="EN-US_TASK_0172371429__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p" id="EN-US_TASK_0172371429__context2104601383214058"><p id="EN-US_TASK_0172371429__p832294344214058">Perform the following operations on a BGP route sender:</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172371429__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0172371429__steps2059917467214058"><li id="EN-US_TASK_0172371429__step787382694214058"><span id="EN-US_TASK_0172371429__cmd746705244214058">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname409446224214058">system-view</span></b></a></span><p><p id="EN-US_TASK_0172371429__p7757181053415">The system view is displayed.</p>
</p></li><li id="EN-US_TASK_0172371429__step1402646484214058"><span id="EN-US_TASK_0172371429__cmd1351463469214058">(Optional) Create a basic ACL and configure a rule for it.</span><p><ol type="a" id="EN-US_TASK_0172371429__ol1126093941214058"><li id="EN-US_TASK_0172371429__li516601127214058">Run <a href="cmdqueryname=acl"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname1283866480214058">acl</span></b></a> { <strong><span id="EN-US_TASK_0172371429__cmdparmname592282825214058">name</span></strong> <i><span class="varname" id="EN-US_TASK_0172371429__varname1749575287214058">basic-acl-name</span></i> { <strong><span id="EN-US_TASK_0172371429__cmdparmname940818445214058">basic</span></strong> | [ <strong><span id="EN-US_TASK_0172371429__cmdparmname561041157214058">basic</span></strong> ] <strong><span id="EN-US_TASK_0172371429__cmdparmname428764913214058">number</span></strong> <i><span class="varname" id="EN-US_TASK_0172371429__varname500987299214058">basic-acl-number</span></i> } | [ <strong><span id="EN-US_TASK_0172371429__cmdparmname1023306984214058">number</span></strong> ] <i><span class="varname" id="EN-US_TASK_0172371429__varname751077491214058">basic-acl-number</span></i> } [ <strong><span id="EN-US_TASK_0172371429__cmdparmname1246597440214058">match-order</span></strong> { <strong><span id="EN-US_TASK_0172371429__cmdparmname641461100214058">config</span></strong> | <strong><span id="EN-US_TASK_0172371429__cmdparmname302967913214058">auto</span></strong> }]<p id="EN-US_TASK_0172371429__p8439143513343">A basic ACL is created, and the basic ACL view is displayed.</p>
</li><li id="EN-US_TASK_0172371429__li571278123214058">Run <a href="cmdqueryname=rule"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname1533302607214058">rule</span></b></a> [ <i><span class="varname" id="EN-US_TASK_0172371429__varname826178641214058">rule-id</span></i> ] { <strong><span id="EN-US_TASK_0172371429__cmdparmname479876027214058">deny</span></strong> | <strong><span id="EN-US_TASK_0172371429__cmdparmname2136762258214058">permit</span></strong> } [ <strong><span id="EN-US_TASK_0172371429__cmdparmname881062536214058">fragment-type</span></strong> { <strong><span id="EN-US_TASK_0172371429__cmdparmname833767101214058">fragment</span></strong> | <strong><span id="EN-US_TASK_0172371429__cmdparmname2118973247214058">non-fragment</span></strong> | <strong><span id="EN-US_TASK_0172371429__cmdparmname47439470214058">non-subseq</span></strong> | <strong><span id="EN-US_TASK_0172371429__cmdparmname30304458214058">fragment-subseq</span></strong> | <strong><span id="EN-US_TASK_0172371429__cmdparmname1612837211214058">fragment-spe-first</span></strong> } | <strong><span id="EN-US_TASK_0172371429__cmdparmname1000284543214058">source</span></strong> { <i><span class="varname" id="EN-US_TASK_0172371429__varname859480011214058">source-ip-address</span></i> { <i><span class="varname" id="EN-US_TASK_0172371429__varname1356878313214058">source-wildcard</span></i> | <strong><span id="EN-US_TASK_0172371429__cmdparmname1876510171214058">0</span></strong> } | <strong><span id="EN-US_TASK_0172371429__cmdparmname774622899214058">any</span></strong> } | <strong><span id="EN-US_TASK_0172371429__cmdparmname383423932214058">time-range</span></strong> <i><span class="varname" id="EN-US_TASK_0172371429__varname1452013575214058">time-name</span></i> | <strong><span id="EN-US_TASK_0172371429__cmdparmname363863280214058">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0172371429__varname1974271030214058">vpn-instance-name</span></i> ]<sup id="EN-US_TASK_0172371429__sup1553640231214058">*</sup><p id="EN-US_TASK_0172371429__p749775716343">A rule is configured for the basic ACL.</p>
</li></ol>
<div class="p" id="EN-US_TASK_0172371429__p1953626486214058">The system processes packets based on the ACL rule as follows:<ul id="EN-US_TASK_0172371429__ul1774565232214058"><li id="EN-US_TASK_0172371429__li1144704673214058">If packets match the ACL rule and the action of the rule is permit, the system permits the packets.</li><li id="EN-US_TASK_0172371429__li559044008214058">If packets match the ACL rule and the action of the rule is deny, the system discards the packets.</li><li id="EN-US_TASK_0172371429__li1688013915214058">If packets do not match the ACL rule, the system does not apply the action to the packets. Instead, it forwards them.</li><li id="EN-US_TASK_0172371429__li243254989214058">If the referenced ACL does not exist or an existent ACL in which no rule is defined is referenced, the system does not apply any action to the packets. Instead, it forwards them.</li></ul>
</div>
</p></li><li id="EN-US_TASK_0172371429__step166901471818"><span id="EN-US_TASK_0172371429__cmd20689373117">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname15990126318">quit</span></b></a></span><p><p id="EN-US_TASK_0172371429__p11877718173511">Return to the system view.</p>
</p></li><li id="EN-US_TASK_0172371429__step1022755434214058"><span id="EN-US_TASK_0172371429__cmd991468650214058">Run <a href="cmdqueryname=route-policy"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname1061833625214135">route-policy</span></b></a> <em id="EN-US_TASK_0172371429__i1682964513306">route-policy-name</em> <i><span class="varname" id="EN-US_TASK_0172371429__varname1886405618458">matchMode</span></i> <strong><span id="EN-US_TASK_0172371429__cmdparmname509522582214135">node</span></strong> <i><span class="varname" id="EN-US_TASK_0172371429__varname1584317308214135">node</span></i></span><p><p id="EN-US_TASK_0172371429__p17978381359">A route-policy with a node is created, and the route-policy view is displayed.</p>
</p></li><li id="EN-US_TASK_0172371429__step1051442965214058"><span id="EN-US_TASK_0172371429__cmd2106465239214058">Configure a matching rule for the route-policy as required:</span><p><ul id="EN-US_TASK_0172371429__ul1631035589214058"><li id="EN-US_TASK_0172371429__li1631757650214058"><p id="EN-US_TASK_0172371429__p1584651360214058"><a name="EN-US_TASK_0172371429__li1631757650214058"></a><a name="li1631757650214058"></a>To match routes against an ACL, run the <a href="cmdqueryname=if-match+acl"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname1873594142214058">if-match acl</span></b></a> { <i><span class="varname" id="EN-US_TASK_0172371429__varname705742231214058">acl-number</span></i> | <i><span class="varname" id="EN-US_TASK_0172371429__varname1806885368214058">acl-name</span></i> } command.</p>
<div class="note" id="EN-US_TASK_0172371429__note1411178464214058"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172371429__p867046980214058">Route-policies support only basic ACLs (with the number ranging from 2000 to 2999).</p>
</div></div>
</li><li id="EN-US_TASK_0172371429__li1462716676214058"><p id="EN-US_TASK_0172371429__p1633866323214058"><a name="EN-US_TASK_0172371429__li1462716676214058"></a><a name="li1462716676214058"></a>To match BGP routes against an AS_Path filter, run the <a href="cmdqueryname=if-match+as-path-filter"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname534783613214058">if-match as-path-filter</span></b></a> { <i><span class="varname" id="EN-US_TASK_0172371429__varname441284181214058">as-path-filter-number</span></i> | <i><span class="varname" id="EN-US_TASK_0172371429__varname1640841488214058">as-path-filter-name</span></i> } &amp;&lt;1-16&gt; command.</p>
</li><li id="EN-US_TASK_0172371429__li743026349214058"><p id="EN-US_TASK_0172371429__p426440338214058"><a name="EN-US_TASK_0172371429__li743026349214058"></a><a name="li743026349214058"></a>To match BGP routes against a community filter, run the <a href="cmdqueryname=if-match+community-filter"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname1794317516214058">if-match community-filter</span></b></a> { <i><span class="varname" id="EN-US_TASK_0172371429__varname1712342660214058">basic-comm-filter-num</span></i> [ <strong><span id="EN-US_TASK_0172371429__cmdparmname682041311214058">whole-match</span></strong> ] | <i><span class="varname" id="EN-US_TASK_0172371429__varname1177847235214058">adv-comm-filter-num</span></i> }* &amp;&lt;1-16&gt; or <a href="cmdqueryname=if-match+community-filter"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname1508408267214058">if-match community-filter</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371429__varname1263121333214058">comm-filter-name</span></i> [ <strong><span id="EN-US_TASK_0172371429__cmdparmname1702707262214058">whole-match</span></strong> ] command.</p>
</li><li id="EN-US_TASK_0172371429__li737263626214058"><p id="EN-US_TASK_0172371429__p209118992214058"><a name="EN-US_TASK_0172371429__li737263626214058"></a><a name="li737263626214058"></a>To match routes against a route cost, run the <a href="cmdqueryname=if-match+cost"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname1431101305214058">if-match cost</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371429__varname1413597251214058">cost</span></i> command.</p>
</li><li id="EN-US_TASK_0172371429__li1412561603214058"><p id="EN-US_TASK_0172371429__p491144036214058"><a name="EN-US_TASK_0172371429__li1412561603214058"></a><a name="li1412561603214058"></a>To match routes against an IP prefix list, run the <a href="cmdqueryname=if-match+ip-prefix"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname333176964214058">if-match ip-prefix</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371429__varname496461683214058">ip-prefix</span></i> command.</p>
</li></ul>
</p></li><li id="EN-US_TASK_0172371429__step328037414214058"><span id="EN-US_TASK_0172371429__cmd734295249214058">Set route attributes for matched BGP routes as required.</span><p><ul id="EN-US_TASK_0172371429__ul1770840878214058"><li id="EN-US_TASK_0172371429__li527470298214058"><p id="EN-US_TASK_0172371429__p380803670214058"><a name="EN-US_TASK_0172371429__li527470298214058"></a><a name="li527470298214058"></a>To set the AS_Path attribute, run the <a href="cmdqueryname=apply+as-path"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname2115505467">apply as-path</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371429__varname31150016461">as-number</span></i> &amp;&lt;1-<span>128</span>&gt; [ <strong><span id="EN-US_TASK_0172371429__cmdparmname15115160164614">additive</span></strong> ] command.</p>
</li><li id="EN-US_TASK_0172371429__li1234488334214058"><p id="EN-US_TASK_0172371429__p1205915871214058"><a name="EN-US_TASK_0172371429__li1234488334214058"></a><a name="li1234488334214058"></a>To set a community attribute, run the <a href="cmdqueryname=apply+community"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname768970497214058">apply community</span></b></a> { [ <i><span class="varname" id="EN-US_TASK_0172371429__varname309580881214058">community-number</span></i> | <i><span class="varname" id="EN-US_TASK_0172371429__varname716029546214058">aa:nn</span></i> ] &amp;&lt;1-32&gt; | <strong><span id="EN-US_TASK_0172371429__cmdparmname31441223214058">internet</span></strong> | <strong><span id="EN-US_TASK_0172371429__cmdparmname934414994214058">no-advertise</span></strong> | <strong><span id="EN-US_TASK_0172371429__cmdparmname1299743088214058">no-export</span></strong> | <strong><span id="EN-US_TASK_0172371429__cmdparmname1672905706214058">no-export-subconfed</span></strong> } * [ <strong><span id="EN-US_TASK_0172371429__cmdparmname2113208800214058">additive</span></strong> ] command.</p>
</li><li id="EN-US_TASK_0172371429__li1936587782214058"><p id="EN-US_TASK_0172371429__p968698142214058"><a name="EN-US_TASK_0172371429__li1936587782214058"></a><a name="li1936587782214058"></a>To set a route cost, run the <a href="cmdqueryname=apply+cost"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname2098252088214058">apply cost</span></b></a> { [ <strong><span id="EN-US_TASK_0172371429__cmdparmname2146713156214058">+</span></strong> | <strong><span id="EN-US_TASK_0172371429__cmdparmname1932083793214058">-</span></strong> ] <i><span class="varname" id="EN-US_TASK_0172371429__varname1970459877214058">cost</span></i> | <strong><span id="EN-US_TASK_0172371429__cmdparmname500300431214058">inherit</span></strong> } command.</p>
</li></ul>
<p id="EN-US_TASK_0172371429__p1459233472214058">You can set one BGP attribute, such as the AS_Path, community attribute, or extended community attribute, for the matched BGP routes as required.</p>
</p></li><li id="EN-US_TASK_0172371429__step944705848214058"><span id="EN-US_TASK_0172371429__cmd1324585065214058">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname1412125302214058">quit</span></b></a></span><p><p id="EN-US_TASK_0172371429__p1612576362">Return to the system view.</p>
</p></li><li id="EN-US_TASK_0172371429__step117554684214058"><span id="EN-US_TASK_0172371429__cmd56618748214058">Run <a href="cmdqueryname=bgp"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname1888401164214058">bgp</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371429__varname154824114211">as-number</span></i></span><p><p id="EN-US_TASK_0172371429__p1963192283610">The BGP view is displayed.</p>
</p></li><li id="EN-US_TASK_0172371429__step41594340214058"><span id="EN-US_TASK_0172371429__cmd1143887105214058">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname1454253932214058">peer</span></b></a> { <em id="EN-US_TASK_0172371429__i13218162618164">ipv4-address</em> | <i><span class="varname" id="EN-US_TASK_0172371429__varname1428390225214058">group-name</span></i> } <strong><span id="EN-US_TASK_0172371429__cmdparmname389469793214058">route-policy</span></strong> <i><span class="varname" id="EN-US_TASK_0172371429__varname912676033214058">route-policy-name</span></i> <strong><span id="EN-US_TASK_0172371429__cmdparmname2093044460214058">export</span></strong></span><p><p id="EN-US_TASK_0172371429__p1433520364364">The route-policy is applied to the routes to be advertised to the specified peer.</p>
</p><p><div class="note" id="EN-US_TASK_0172371429__note1578498242214058"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172371429__p1954461903214058">Ensure that the BGP peer relationship has been established before applying the route-policy.</p>
</div></div>
</p></li><li id="EN-US_TASK_0172371429__step1478845394214058"><span id="EN-US_TASK_0172371429__cmd2126290227214058">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname880491612214058">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371429__varname123536111215">peerIpv4Addr</span></i> <strong><span id="EN-US_TASK_0172371429__cmdparmname2001945742214058">advertise-community</span></strong></span><p><p id="EN-US_TASK_0172371429__p194621540366">The device is configured to advertise community attributes to the peer.</p>
</p></li><li id="EN-US_TASK_0172371429__step473540957214058"><span id="EN-US_TASK_0172371429__cmd228468517214058">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172371429__cmdname830065512214058">commit</span></b></a></span><p><p id="EN-US_TASK_0172371429__p8945191015377">The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_2029.html">Configuring Source-Based QPPB
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_2031.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>