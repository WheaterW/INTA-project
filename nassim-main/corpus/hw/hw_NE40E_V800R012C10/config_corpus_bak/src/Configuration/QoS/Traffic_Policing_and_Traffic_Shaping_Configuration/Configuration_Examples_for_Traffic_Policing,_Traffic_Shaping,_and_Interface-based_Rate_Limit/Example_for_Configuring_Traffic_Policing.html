
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Traffic Policing">
<meta name="abstract" content="This section provides an example for configuring traffic policing. It describes how to configure traffic policing to control the overall traffic volume that is received or forwarded, and to control the rate of specified packets.">
<meta name="description" content="This section provides an example for configuring traffic policing. It describes how to configure traffic policing to control the overall traffic volume that is received or forwarded, and to control the rate of specified packets.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0024.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909,m00390128">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Traffic Policing and Traffic Shaping">
<meta name="featuretype" content="QOS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Traffic Policing and Traffic Shaping">
<meta name="featuretype" content="QOS">
<meta name="featurename" content="Traffic Policing and Traffic Shaping">
<meta name="featuretype" content="QOS">
<meta name="featurename" content="Traffic Policing and Traffic Shaping">
<meta name="featuretype" content="QOS">
<meta name="OWNER" content="l00425560,m00390128">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="m00915594">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172371168">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Traffic Policing</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172371168"></a><a name="EN-US_TASK_0172371168"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Traffic Policing</h1>
<div class="taskbody"><p>This section provides an example for configuring traffic policing. It describes how to configure traffic policing to control the overall traffic volume that is received or forwarded, and to control the rate of specified packets.</p>
<div class="context"><a name="EN-US_TASK_0172371168__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>GE <span>0/3/0</span> of <span class="keyword">Device</span>A is connected to GE <span>0/1/0</span> of <span class="keyword">Device</span>B. Server, PC1, and PC2 can access the Internet through <span class="keyword">Device</span>A and <span class="keyword">Device</span>B.</p>
<p>Server, PC1, and GE <span>0/1/0</span> of <span class="keyword">Device</span>A are on the same network segment. PC2 and GE <span>0/2/0</span> of <span class="keyword">Device</span>A are on the same network segment.</p>
<p>The traffic from Server and PC1 to GE <span>0/1/0</span> is controlled on <span class="keyword">Device</span>A as follows:</p>
<ul><li><p>A bandwidth of up to 6 Mbit/s is assured for the traffic from Server. The default bandwidth is 5 Mbit/s. For traffic whose rate exceeds 5 Mbit/s but is less than or equal to 6 Mbit/s, packets are normally forwarded. When the traffic rate exceeds 6 Mbit/s, the nonconforming traffic is treated and forwarded as BE traffic flows.</p>
</li><li><p>The rate limit on the traffic from PC1 is 2 Mbit/s. When the traffic rate exceeds the rate limit, the nonconforming traffic is dropped.</p>
</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 3 in this example represent GE <span>0/1/0</span>, GE <span>0/2/0</span>, and GE <span>0/3/0</span>, respectively.</p>
</div></div>
<div class="fignone"><span class="figcap"><b>Figure 1 </b>Networking diagram for configuring traffic policing</span><br><span><img class="vsd" src="images/fig_dc_ne_qos_cfg_002501.png" width="NaN" height="NaN"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172371168__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Precautions</h4><div class="p">During the configuration, pay attention to the following:<ul><li><p>If the CoS of a packet is re-marked as EF, BE, CS6, or CS7, the packet can be re-marked only in green.</p>
</li><li><p>To display the statistics about a traffic policy, you can enable statistics for the traffic policy by running the <strong>statistics enable</strong> command.</p>
</li></ul>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172371168__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Configure IP addresses for interfaces.</li><li><p>On the inbound interface GE <span>0/1/0</span> of <span class="keyword">Device</span>A, configure MF classification-based traffic policing for traffic from Server and PC1.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172371168__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>ACL numbers, traffic classifier names, traffic behavior names, traffic policy names, and the interfaces where the traffic policies are applied, for the traffic of Server and PC1</p>
</li><li><p>CIR, PIR, CBS, and PBS</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172371168__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure IP addresses for interfaces (The detailed configuration is not mentioned here).</span></li><li><span>Configure <span class="keyword">Device</span>A.</span><p><p># Configure ACL rules for matching data flows from Server and PC1.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>A</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> acl number 2001</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-acl-basic-2001]<strong> rule permit source 1.1.1.1 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-acl-basic-2001]<strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-acl-basic-2001]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> acl number 2002</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-acl-basic-2002]<strong> rule permit source 1.1.1.2 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-acl-basic-2002] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-acl-basic-2002] <strong>quit</strong></pre>
<p># Configure traffic classifiers and define ACL-based traffic classifier matching rules.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic classifier class1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-classifier-class1]<strong> if-match acl 2001</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-classifier-class1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-classifier-class1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic classifier class2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-classifier-class2] <strong>if-match acl 2002</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-classifier-class2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-classifier-class2] <strong>quit</strong></pre>
<p># Define a traffic behavior. Set the bandwidth for the traffic from Server to 5 Mbit/s and the maximum bandwidth to 6 Mbit/s. For traffic whose rate exceeds 5 Mbit/s but is lower than or equal to 6 Mbit/s, the traffic is directly forwarded. When the traffic rate exceeds 6 Mbit/s, the nonconforming traffic is treated and forwarded as BE traffic flows.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> traffic behavior behavior1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-behavior-behavior1]<strong> car cir 5000 pir 6000 green pass yellow pass red pass service-class be color green</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-behavior-behavior1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-behavior-behavior1]<strong> quit</strong></pre>
<p># Define a traffic behavior. Set the rate limit on the traffic from PC1 to 2 Mbit/s. When the traffic rate exceeds 2 Mbit/s, the nonconforming traffic is dropped.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> traffic behavior behavior2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-behavior-behavior2] <strong>car cir 2000 green pass red discard</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-behavior-behavior2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-behavior-behavior2] <strong>quit</strong></pre>
<p># Define a traffic policy to associate traffic classifiers with traffic behaviors.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic policy policy1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-trafficpolicy-policy1]<strong> classifier class1 behavior behavior1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-trafficpolicy-policy1]<strong> classifier class2 behavior behavior2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-trafficpolicy-policy1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-trafficpolicy-policy1] <strong>quit</strong></pre>
<p># Apply the traffic policy to GE <span>0/1/0</span>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>traffic-policy policy1 inbound</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>Run the <strong>display interface</strong> command on <span class="keyword">Device</span>B to view interface-based traffic statistics.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172371168__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span>A configuration file</p>
<pre class="screen"># 
sysname <span class="keyword">Device</span>A
#
acl number 2001
 rule 5 permit source 1.1.1.1 0
acl number 2002
 rule 5 permit source 1.1.1.2 0
#
traffic classifier class1 operator or
 if-match acl 2001
traffic classifier class2 operator or
 if-match acl 2002
#
traffic behavior behavior1
 car cir 5000 pir 6000 green pass yellow pass red pass service-class be color green
traffic behavior behavior2
 car cir 2000 green pass red discard
#
traffic policy policy1
 classifier class1 behavior behavior1 precedence 1
 classifier class2 behavior behavior2 precedence 2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 1.1.1.3 255.255.255.0
 traffic-policy policy1 inbound
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0024.html">Configuration Examples for Traffic Policing, Traffic Shaping, and Interface-based Rate Limit
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
</div>
</div>
</body>
</html>