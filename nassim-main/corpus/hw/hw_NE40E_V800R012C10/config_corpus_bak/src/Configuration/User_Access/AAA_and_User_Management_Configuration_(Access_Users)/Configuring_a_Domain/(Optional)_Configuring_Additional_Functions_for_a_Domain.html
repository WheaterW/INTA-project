
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring Additional Functions for a Domain">
<meta name="abstract" content="Many additional functions, such as time-based control, policy-based routing, traffic statistics, and IP address usage alarms, can be configured for a domain.">
<meta name="description" content="Many additional functions, such as time-based control, policy-based routing, traffic statistics, and IP address usage alarms, can be configured for a domain.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_aaa_cfg_0111.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_aaa_cfg_0561.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_aaa_cfg_1124.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00588052,w00437000,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="AAA (Access User)">
<meta name="featurename" content="PPPoE">
<meta name="featuretype" content="User Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="AAA (Access User)">
<meta name="featurename" content="PPPoE">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="AAA (Access User)">
<meta name="featurename" content="PPPoE">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="AAA (Access User)">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="z00588052,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172373716">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring Additional Functions for a Domain</title>
</head>
<body><a name="EN-US_TASK_0172373716"></a><a name="EN-US_TASK_0172373716"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring Additional Functions for a Domain</h1>
<div class="taskbody"><p>Many additional functions, such as time-based control, policy-based routing, traffic statistics, and IP address usage alarms, can be configured for a domain.</p>
<div class="context"><a name="EN-US_TASK_0172373716__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Additional functions that can be configured for a domain include:</p>
<ul><li><p>Time-based control</p>
<p>Time-based control means that a domain is automatically blocked in a specified period. During this period, the users of this domain cannot access the network, and the online users are disconnected. After the time period expires, the domain automatically enters the activated state, and users in the domain can go online.</p>
</li><li><p>Idle cut</p>
<p>Idle cut enables the <span class="keyword">NE40E</span> to consider a user idle and disconnect the user if the traffic volume of the user keeps being lower than a threshold in a period. Idle cut takes effect based on the specified idle period and traffic volume threshold.</p>
<p>The idle cut function configured for a domain controls only the basic traffic of a user. The multicast traffic and the VAS traffic that is not configured with the summary feature are not included in the basic traffic. Therefore, the idle cut function is invalid for them.</p>
</li><li><p>Mandatory PPP authentication</p>
<p>Generally, the authentication mode (PAP, CHAP, or MSCHAP) of a PPP user is negotiated by the PPP client and the virtual template interface. After the mandatory authentication mode of PPP users is configured for a domain, the users in the domain are authenticated in the configured mode.</p>
</li><li><p>Policy-based routing</p>
<p>With policy-based routing configured for a domain, the <span class="keyword">NE40E</span> determines a forwarding egress according to the address specified for the user domain, not a packet destination address.</p>
</li><li><p>IP address usage alarm</p>
<p>After the alarm threshold for the usage (in percentage) of IP addresses is set in a domain, the <span class="keyword">NE40E</span> sends an alarm to the network management system (NMS) when the usage of IP addresses exceeds the threshold. If no alarm threshold is set, the <span class="keyword">NE40E</span> does not send any alarm to the NMS, regardless of the usage of IP addresses.</p>
</li><li><p>Traffic statistics collection</p>
<p>The traffic statistics function collects the total traffic of a domain and the upstream and downstream traffic of users.</p>
</li><li><p>Accounting packet copy</p>
<p>The accounting packet copy function allows the device to send accounting information to two RADIUS server groups at the same time and waits for their responses. If no response is received, the <span class="keyword">NE40E</span> retransmits accounting information after 5s. If the <span class="keyword">NE40E</span> does not receive any accounting response for three consecutive times, the <span class="keyword">NE40E</span> sends an accounting stop packet to the RADIUS copy server and does not send accounting packets to this server any more.</p>
<p>The function is used when original accounting information needs to be stored on multiple devices (for example, the multi-carrier networking scenario). In this case, accounting packet copies need to be sent to two RADIUS server groups at the same time, and will be used as the original accounting information in future settlement.</p>
</li><li><p>Function to stop sending real-time accounting packets to accounting copy servers</p>
<p>If an accounting copy server cannot process a large number of real-time accounting packets due to limited performance, configure the device to stop sending real-time accounting packets to the server.</p>
</li><li><p>Re-authentication timeout</p>
<p>The re-authentication timeout function allows the <span class="keyword">NE40E</span> to disconnect a Layer 3 pre-authentication user if the user fails to pass the authentication within the maximum re-authentication time.</p>
</li><li><p>Policy for online users when their quotas are used up</p>
<p>The <span class="keyword">NE40E</span> uses a policy on an online user after the user's quota (traffic or session time) is used up. It may log out the user, keep the user online, and forcibly redirect the user.</p>
</li><li><p>Host route tagging</p>
<p>The host route tagging function allows the device to import route tags based on routing policies and advertise different IPv4 host routes to different networks by setting and categorizing route tags for host routes of IPv4 users.</p>
</li><li><p>Function to stop accounting within a specified time period</p>
<p>This function enables a device to stop accounting for traffic from users in a domain within a specified time period. After the specified period elapses, the device starts accounting for the users again.</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172373716__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=aaa"><b><span class="cmdname">aaa</span></b></a></span></span><p><p>The AAA view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=domain"><b><span class="cmdname">domain</span></b></a> <i><span class="varname">domain-name</span></i></span></span><p><p>The domain view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=time-range+domain-block"><b><span class="cmdname">time-range domain-block</span></b></a> { <a href="cmdqueryname=name"><b><span class="cmdname">name</span></b></a> <i><span class="varname">range-name</span></i> | <strong><span>enable</span></strong> }</span><p><p>Time-based control is configured.</p>
<p>You can configure up to four time ranges. All of them can take effect.</p>
</p></li><li><span>Run <a href="cmdqueryname=idle-cut"><b><span class="cmdname">idle-cut</span></b></a> <i><span class="varname">idle-time</span></i> { <i><span class="varname">idle-data</span></i> | <strong><span>zero-rate</span></strong> } [ <strong><span>inbound</span></strong> | <strong><span>outbound</span></strong> ]</span><p><p>The idle cut function is configured for the domain.</p>
</p><p><p>This command is used when some users cannot access the Internet due to an exception but can access the Internet after being logged out once. The idle-cut function can take effect on upstream traffic, downstream traffic, or both according to the parameter you specify. If you do not specify the <strong><span>inbound</span></strong> parameter or the <strong><span>outbound</span></strong> parameter, the idle-cut function takes effect on both upstream and downstream traffic.</p>
</p></li><li><span>Run <a href="cmdqueryname=ppp-force-authtype"><b><span class="cmdname">ppp-force-authtype</span></b></a> { <strong><span>chap</span></strong> | <strong><span>mschap_v1</span></strong> | <strong><span>mschap_v2</span></strong> | <strong><span>pap</span></strong> }</span><p><p>Mandatory PPP authentication is configured for the domain.</p>
</p></li><li><span>Run <a href="cmdqueryname=policy-route"><b><span class="cmdname">policy-route</span></b></a> <span>{ </span><i><span class="varname">next-hop-ip-address</span></i><span> | <i><span class="varname">next-hop-ipv6-address</span></i> }</span></span><p><p>The policy-based routing function is configured for the domain.</p>
</p></li><li><span>Run <a href="cmdqueryname=ip-warning-threshold"><b><span class="cmdname">ip-warning-threshold</span></b></a><span> { </span><i><span class="varname">upper-limit-value</span></i><span> | <strong><span>lower-limit</span></strong> <i><span class="varname">lower-limit-value</span></i> }</span></span><p><p>The IP address usage alarm function is configured for the domain.</p>
</p></li><li><span>Run <a href="cmdqueryname=flow-bill"><b><span class="cmdname">flow-bill</span></b></a></span><p><p>The function to collect the total traffic statistics is enabled for the domain.</p>
</p></li><li><span>Run <a href="cmdqueryname=flow-statistic"><b><span class="cmdname">flow-statistic</span></b></a> { <strong><span>down</span></strong> | <strong><span>up</span></strong> } <sup>*</sup></span><p><p>The function to collect the user traffic statistics is enabled for the domain.</p>
</p></li><li><span>Run <a href="cmdqueryname=accounting-copy+radius-server"><b><span class="cmdname">accounting-copy radius-server</span></b></a> <i><span class="varname">group-name</span></i></span><p><p>The accounting packet copy function is enabled for the domain.</p>
</p></li><li><span>Run <a href="cmdqueryname=radius-server+accounting-copy+realtime+disable"><b><span class="cmdname">radius-server accounting-copy realtime disable</span></b></a></span><p><p>The device is configured to stop sending real-time accounting packets to RADIUS accounting copy servers.</p>
</p><p><p>After this command is run, the device will not send real-time accounting packets to copy servers, regardless of whether the servers have been configured in the domain.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=max-ipuser-reauthtime"><b><span class="cmdname">max-ipuser-reauthtime</span></b></a> <i><span class="varname">time-value</span></i></span></span><p><p>The re-authentication timeout function is configured.</p>
</p></li><li><span>Run <a href="cmdqueryname=quota-out"><b><span class="cmdname">quota-out</span></b></a> { <strong><span>offline</span></strong> | <strong><span>online</span></strong> | <strong><span>redirect</span></strong> <strong><span>url</span></strong> <i><span class="varname">url-string</span></i> <span>[ <strong><span>redirect-stop-accounting</span></strong> ]</span> | <strong>send-realtime-accounting</strong> }</span><p><p>A policy is set for online users after the user quota is used up.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command takes effect only when a user's quota is used up and the user is in the specified domain. If the user domain is changed by a CoA packet sent from a policy server and the <a href="cmdqueryname=quota-out"><b><span class="cmdname">quota-out</span></b></a> command is not configured in the new domain, the user will be logged out when the quota is used up.</p>
</div></div>
<ul><li><p>If the RADIUS protocol type is set to <strong>non-standard</strong>, a real-time accounting packet is sent to the RADIUS server to apply for a new quota when a user's quota is used up. If the RADIUS server responds with zero quota, the user is redirected based on the <strong>quota-out</strong> <strong><span>redirect</span></strong> <strong><span>url</span></strong> <i><span class="varname">url-string</span></i> <span>[ <strong><span>redirect-stop-accounting</span></strong> ]</span> command configuration.</p>
</li><li><p>If you want a user to be directly redirected when the user's quota is used up, you must set the RADIUS protocol type to <strong>standard</strong> and run the <a href="cmdqueryname=quota-out"><b><span class="cmdname">quota-out</span></b></a> <strong><span>redirect</span></strong> <strong><span>url</span></strong> <i><span class="varname">url-string</span></i> <span>[ <strong><span>redirect-stop-accounting</span></strong> ]</span> command.</p>
</li></ul>
</p></li><li><span>Run <a href="cmdqueryname=radius-no-response+lease-time"><b><span class="cmdname">radius-no-response lease-time</span></b></a> <i><span class="varname">time</span></i></span><p><p>The lease time is set for DHCP users when the RADIUS server does not respond.</p>
</p></li><li><span>Run <a href="cmdqueryname=redirect-domain+effect-attribute"><b><span class="cmdname">redirect-domain effect-attribute</span></b></a> { <strong><span>user-group</span></strong> | <strong><span>web-url</span></strong> | <strong><span>qos-profile</span></strong> | <strong><span>accounting-scheme</span></strong> | <strong><span>ip-unr-tag</span></strong> }</span><p><p>The fields that are allowed to take effect in the CoA delivery domain or quota exhaustion redirection domain are configured.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=ip+unr+tag"><b><span class="cmdname">ip unr tag</span></b></a> <em>tag-value</em> <strong><span>route-type</span></strong> <strong><span>host-route</span></strong> <strong><span>framed-route</span></strong></span></span><p><p>A route tag is set for host routes of IPv4 users and network segment routes generated based on the RADIUS-delivered Framed-Route attribute.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=reallocate-ip-address"><b><span class="cmdname">reallocate-ip-address</span></b></a></span><p><p>The device is configured to reallocate IP addresses during authentication in the post-authentication domain.</p>
</p><p><p>This command takes effect only for web users.</p>
</p></li><li><span>Run <a href="cmdqueryname=time-range+non-accounting"><b><span class="cmdname">time-range non-accounting</span></b></a> <i><span class="varname">time-range-name</span></i></span><p><p>The device is enabled to stop accounting in a domain within a specified time period.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_aaa_cfg_0111.html">Configuring a Domain
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_aaa_cfg_0561.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_aaa_cfg_1124.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>