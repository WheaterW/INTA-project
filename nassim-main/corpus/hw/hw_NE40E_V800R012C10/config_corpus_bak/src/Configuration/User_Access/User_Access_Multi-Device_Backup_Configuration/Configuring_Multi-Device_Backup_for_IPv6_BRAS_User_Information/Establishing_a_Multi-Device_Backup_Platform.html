
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Establishing a Multi-Device Backup Platform">
<meta name="abstract" content="A multi-device backup platform runs Huawei proprietary Redundancy User Information (RUI) protocol to back up user information between devices in a Virtual Router Redundancy Protocol (VRRP) group. This allows fast service switching to be performed if a network node or link fails, enhancing service reliability.">
<meta name="description" content="A multi-device backup platform runs Huawei proprietary Redundancy User Information (RUI) protocol to back up user information between devices in a Virtual Router Redundancy Protocol (VRRP) group. This allows fast service switching to be performed if a network node or link fails, enhancing service reliability.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0020.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0005_a.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00588052,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="UP Multi-Device Backup">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="UP Multi-Device Backup">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="UP Multi-Device Backup">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172374364">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Establishing a Multi-Device Backup Platform</title>
</head>
<body><a name="EN-US_TASK_0172374364"></a><a name="EN-US_TASK_0172374364"></a>

<div class="articleBoxWithoutHead">





<h1 class="topicTitle-h1">Establishing a Multi-Device Backup Platform</h1>
<div class="taskbody"><p>A multi-device backup platform runs Huawei proprietary Redundancy User Information (RUI) protocol to back up user information between devices in a Virtual Router Redundancy Protocol (VRRP) group. This allows fast service switching to be performed if a network node or link fails, enhancing service reliability.</p>
<div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0172374364__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p" id="EN-US_TASK_0172374364__en-us_task_0172374382_prereq1325565695214109"><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p787281887214109">Before establishing a multi-device backup platform, complete the following tasks:</p>
<ul id="EN-US_TASK_0172374364__en-us_task_0172374382_ul131336117214109"><li id="EN-US_TASK_0172374364__en-us_task_0172374382_li716168819214109"><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p3499498214109"><a name="EN-US_TASK_0172374364__en-us_task_0172374382_li716168819214109"></a><a name="en-us_task_0172374382_li716168819214109"></a>Configure peer BFD, link BFD, or Ethernet OAM on the user side.</p>
</li><li id="EN-US_TASK_0172374364__en-us_task_0172374382_li673903721214109"><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p471084569214109"><a name="EN-US_TASK_0172374364__en-us_task_0172374382_li673903721214109"></a><a name="en-us_task_0172374382_li673903721214109"></a>Configure peer BFD on the network side.</p>
</li><li id="EN-US_TASK_0172374364__en-us_task_0172374382_li1160400008214109"><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1543936049214109"><a name="EN-US_TASK_0172374364__en-us_task_0172374382_li1160400008214109"></a><a name="en-us_task_0172374382_li1160400008214109"></a>Configure a local or remote address pool. The same address pool must be configured on devices that back up one another.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172374364__1.4.2"></a><a name="1.4.2"></a>
<div class="p" id="EN-US_TASK_0172374364__en-us_task_0172374382_context1192323858214109"><h4 class="sectiontitle">Context</h4><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1900340590214109">Establishing a multi-device backup platform includes configuring basic VRRP group functions, an RBP, and an RBS.</p>
<ul id="EN-US_TASK_0172374364__en-us_task_0172374382_ul197255517513"><li id="EN-US_TASK_0172374364__en-us_task_0172374382_li8972455953">Configure basic VRRP functions to control the master/backup state of the RBP.</li><li id="EN-US_TASK_0172374364__en-us_task_0172374382_li129725551254">Configure an RBS to back up user information between the master and backup devices. If shared address pool mode is used, configure route control for the shared address pool and a traffic protection tunnel between the master and backup devices.<p id="EN-US_TASK_0172374364__en-us_task_0172374382_p25651441111617"><a name="EN-US_TASK_0172374364__en-us_task_0172374382_li129725551254"></a><a name="en-us_task_0172374382_li129725551254"></a>For details about how to configure route control for the shared address pool, see <a href="../ne/dc_ne_cfg_rui_0012.html">Controlling Advertisement of Address Pool UNRs</a>.</p>
<p id="EN-US_TASK_0172374364__en-us_task_0172374382_p11932195711163">For details about how to configure a traffic protection tunnel between the master and backup devices configured with shared address pool, see <a href="../ne/dc_ne_cfg_rui_0009.html">Configuring RUI in Shared Address Pool Mode</a>.</p>
</li><li id="EN-US_TASK_0172374364__en-us_task_0172374382_li1523412921216">Configure an RBP and bind it to VRRP and an RBS. If exclusive address pool mode is used, bind the RBP to an exclusive address pool.</li></ul>
<p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1991317651214109">Perform the following steps on both the master and backup devices:</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172374364__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul id="EN-US_TASK_0172374364__en-us_task_0172374382_steps-unordered593804418214109"><li id="EN-US_TASK_0172374364__en-us_task_0172374382_step1574878889214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd1253538148214109">Configure basic VRRP group functions.</span><ol id="EN-US_TASK_0172374364__en-us_task_0172374382_substeps436594692214109"><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep216309408214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd493306483214414">Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname60373671214414">system-view</span></b></a></span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p362608894214414">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep178118081214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd1540738134214414">Run <span><a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname341974484214414">interface</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname354979552214414">interface-type</span></i> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname1635541910214414">interface-number</span></i> [.<i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname1866227793214414">subinterface-number</span></i> ]</span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1413945315214414">The view of the interface on which a VRRP group is configured is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep764870007214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd3298105512349">Run <span><a href="cmdqueryname=vrrp+vrid"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname164394855214109">vrrp vrid</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname1631129245214414">virtual-router-id</span></i> <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname1524640999214414">virtual-ip</span></strong> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname603770036214414">virtual-address</span></i></span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p20640135063411">A VRRP group is created, and a virtual IP address is assigned to the VRRP group.</p>
</p><p><div class="note" id="EN-US_TASK_0172374364__en-us_task_0172374382_note208748291214109"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1591731286214109">The same VRID and virtual IP address must be set on each of the devices that back up one another.</p>
</div></div>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep666968880214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd2012225240214414">Run <span><a href="cmdqueryname=admin-vrrp+vrid"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname1716221820214414">admin-vrrp vrid</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname556727233214414">virtual-router-id</span></i> [ <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname570617189214414">ignore-if-down</span></strong> ]</span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p866354249214414">The VRRP group is configured as an mVRRP group.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep1799026873214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd1822388398214109">Run <span><a href="cmdqueryname=vrrp+vrid"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname22952569214109">vrrp vrid</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname716544422214414">virtual-router-id</span></i> <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname1830437440214414">priority</span></strong> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname1307928783214414">priority-value</span></i></span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1867079138214414">The priority of a device in the VRRP group is configured.</p>
<p id="EN-US_TASK_0172374364__en-us_task_0172374382_p216400742214414">The devices in the VRRP group must be assigned different VRRP priorities. The device with a higher priority serves as the master device.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep1175404569214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd17622030124914">Run <a href="cmdqueryname=vrrp+vrid"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname147659181214109">vrrp vrid</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname74216452214109">virtual-router-id</span></i> <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname269793134214109">preempt-mode</span></strong> <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname2023096613214109">timer</span></strong> <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname209477253214109">delay</span></strong> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname527412300214109">delay-time</span></i></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p173122112491">A preemption delay is set for the master device in the VRRP group.</p>
</p><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1978334462214414">This ensures that the device preempts the master role after the fault is rectified and services are fully restored.</p>
<p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1222020670214414">The preemption delay is related to service types on the live network in the following scenarios:</p>
<ul id="EN-US_TASK_0172374364__en-us_task_0172374382_ul1683672387214109"><li id="EN-US_TASK_0172374364__en-us_task_0172374382_li1597094336214109">In an IPv4 single-stack scenario, the minimum preemption delay is 10 minutes. Increase the value by 1 for every 6K users. If 256K users go online through a device, setting the value to 40 minutes is recommended.</li><li id="EN-US_TASK_0172374364__en-us_task_0172374382_li643733420214109">In an IPv4 and IPv6 dual-stack scenario, the minimum preemption delay is 10 minutes. Increase the value by 1 for every 6K users. If 128K users go online through a device, setting the value to 40 minutes is recommended.</li><li id="EN-US_TASK_0172374364__en-us_task_0172374382_li1836955025214109">When both IPv4 single-stack and EDSG services are configured, the minimum preemption delay is 15 minutes. Increase the value by 1 for every 4K users. If 256K users go online through a device, setting the value to 60 minutes is recommended.</li><li id="EN-US_TASK_0172374364__en-us_task_0172374382_li1278390281214109">When both IPv4 and IPv6 dual-stack and EDSG services are configured, the minimum preemption delay is 15 minutes. Increase the value by 1 for every 4K users. If 128K dual-stack users go online through a device, setting the value to 60 minutes is recommended.</li></ul>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep339894486214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd1542436773214414">Run <span><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname1778400631214414">commit</span></b></a></span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p44872650214414">The configuration is committed.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0172374364__en-us_task_0172374382_step18486112035914"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd648642085916">Configure an RBS.</span><ol id="EN-US_TASK_0172374364__en-us_task_0172374382_substeps848632065912"><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep240956016214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd539189274214414">Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname225219607214414">system-view</span></b></a></span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p992776112214414">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep638428803214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd1244591609214109">Run <a href="cmdqueryname=remote-backup-service"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname836239572214109">remote-backup-service</span></b></a><i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname501000819214109"> service-name</span></i></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p114697332112">An RBS is created, and its view is displayed.</p>
</p><p><div class="note" id="EN-US_TASK_0172374364__en-us_task_0172374382_note10519131133713"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p85201131183719">If both a dynamic BFD session and a static BFD session are configured on a BRAS to detect the same link, BFD parameters of one BFD session take effect. Specifically, when an RBS is configured, a dynamic BFD session is created, and BFD parameters are generated. The system compares BFD parameters of the static BFD session with dynamically generated BFD parameters, and BFD parameters with smaller values take effect.</p>
</div></div>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep1563596025214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd949710168586">(Optional) Run <span><a href="cmdqueryname=bind+ssl-policy"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname543309559214109">bind ssl-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname242473455214414">ssl-policy-name</span></i></span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1423402911576">An SSL policy is bound to a TCP connection.</p>
</p><p><div class="p" id="EN-US_TASK_0172374364__en-us_task_0172374382_p2023759019214109"><div class="note" id="EN-US_TASK_0172374364__en-us_task_0172374382_note1471831147214109"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p62031132115311">You are advised to bind an SSL policy to the RBS to enhance RBS security. If no SSL policy is bound to the RBS, data may be leaked or tampered with.</p>
</div></div>
</div>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep1590408523214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd662293016499">Run <span><a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname951640011214109">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname1734845260214414">peer-ip-address</span></i> <a href="cmdqueryname=source"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname1043279658214109">source</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname1148354738214414">source-ip-address</span></i> <a href="cmdqueryname=port"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname60834721214109">port</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname104125843214414">port-id</span></i></span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1643012419496">TCP connection parameters are set for the RBS.</p>
</p><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1844702373214414"><i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname691371272214414">peer-ip-address</span></i> sets the IP address of a remote device that backs up the local device. <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname1580440492214414">source-ip-address</span></i> sets the IP address of a local device. The remote IP address must be already assigned to the remote device's main interface, sub-interface, or logical interface (for example, loopback interface). The local IP address must be already assigned to the local device's main interface, sub-interface, or logical interface (for example, loopback interface). The local and remote IP addresses must be able to ping each other.</p>
<p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1754858202214414"><i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname361393116214414">port-id</span></i> indicates the listening port number of a server. The same TCP port number must be set on devices that back up one another.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep1669784089214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd744884827214109">(Optional) Run <a href="cmdqueryname=batch-backup"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname1213296129214109">batch-backup</span></b></a> <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname1011532653214109">service-type</span></strong> <span> { <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377308_cmdparmname1518195271214121">arp</span></strong> | <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377308_cmdparmname1930439161214121">all</span></strong><span>| <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377308_cmdparmname1083461430214121">bras</span></strong> | <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377308_cmdparmname1934971756214121">l2tp</span></strong> | <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377308_cmdparmname280610009214121">multicast</span></strong></span> | <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377308_cmdparmname561773505214121">igmp-snooping</span></strong><span> | <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377308_cmdparmname385147966214121">dhcp-server</span></strong></span> <span>| <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377308_cmdparmname1805466981214121">nd</span></strong> </span>} <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377308_cmdparmname40977655214121">now</span></strong></span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p193843331004">User services configured in the RBS are immediately backed up.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep1971800715214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd36225304490">(Optional) Run <span><a href="cmdqueryname=track+bfd-session"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname1206825437214109">track bfd-session</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname787501937214414">bfd-session</span></i></span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1662294312484">The RBS tracks the BFD status so that the RBS can rapidly monitor the remote device status.</p>
</p><p><div class="note" id="EN-US_TASK_0172374364__en-us_task_0172374382_note767328263214414"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p846816006214414">This step is recommended. Before running this command, ensure that a peer BFD session is established between the master and backup devices on the network side.</p>
</div></div>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep2048509952214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd1381612111214414">(Optional) Run <span><a href="cmdqueryname=radius-authorization+source"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname602830895214414">radius-authorization source</span></b></a> <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname1386405231214414">same-as</span></strong> <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname564003226214414">nas-logic-ip</span></strong></span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p21799070214414">The device is configured to reply to the RADIUS authorization server with packets in which the source IP address is the same as the NAS IP address.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep16486520135913"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd1848613209592">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname141486291214109">commit</span></b></a></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p917315432471">The configuration is committed.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0172374364__en-us_task_0172374382_step1510717584214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd931275807214109">Configure an RBP.</span><ol id="EN-US_TASK_0172374364__en-us_task_0172374382_substeps430945379214109"><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep622399863214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd1544855750214414">Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname1553918528214414">system-view</span></b></a></span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1858630185214414">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep2070557524214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd296844601214414">(Optional) Run <span><a href="cmdqueryname=peer-backup+batch+access+enable"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname817033953214414">peer-backup batch access enable</span></b></a></span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p707353764214414">The device is configured to allow users to go online during batch backup.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep1474856858214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd71552007214414">Run <span><a href="cmdqueryname=remote-backup-profile"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname650550692214414">remote-backup-profile</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname500066961214414">profile-name</span></i></span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1359804619214414">An RBP is created, and its view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep92699677214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd611898220214414">Run <a href="cmdqueryname=peer-backup"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname659192678214109">peer-backup</span></b></a> <span>{ </span><strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname2105370673214109">hot</span></strong><span> | <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname1973991042214109">virtual</span></strong> }</span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1011380829214414">Inter-device hot or virtual backup is enabled.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep1777961633214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd116224308495">Run <a href="cmdqueryname=vrrp-id"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname1188358225214109">vrrp-id</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname1039903472214109">vrid</span></i> <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname26400550214109">interface</span></strong> { <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname1082333663520">interface-name</span></i> | <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname190859938214109">interface-type</span></i> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname2032838226214109">interface-number </span></i>} </span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p206851959114715">The RBP is bound to the VRRP group.</p>
</p><p><div class="p" id="EN-US_TASK_0172374364__en-us_task_0172374382_p531452798214414"><ul id="EN-US_TASK_0172374364__en-us_task_0172374382_ul742688113214414"><li id="EN-US_TASK_0172374364__en-us_task_0172374382_li1426448640214414">In multi-device backup networking, load balancing improves link usage. To control the MAC address range of the terminals connected with the VRRP sub-interface and load-balance traffic, use either of the following parameters:<ul id="EN-US_TASK_0172374364__en-us_task_0172374382_ul11655707214414"><li id="EN-US_TASK_0172374364__en-us_task_0172374382_li1971443288214414"><strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname522151853214414">odd-mac</span></strong>: user packets with odd MAC addresses</li><li id="EN-US_TASK_0172374364__en-us_task_0172374382_li563764922214414"><strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname499193490214414">even-mac</span></strong>: user packets with even MAC addresses</li></ul>
</li><li id="EN-US_TASK_0172374364__en-us_task_0172374382_li1291581108214414">If <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname330325758214414">odd-mac</span></strong> or <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname1724233034214414">even-mac</span></strong> is not configured, the <a href="cmdqueryname=vrrp-id"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname418522403214414">vrrp-id</span></b></a> command only binds a single VRRP group ID to an RBP and associates the RBP with a single VRRP sub-interface. If load balancing is required, run the <a href="cmdqueryname=vrrp-id"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname749190489214414">vrrp-id</span></b></a> command twice, with <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname1774464657214414">odd-mac</span></strong> and <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname1881591075214414">even-mac</span></strong> configured, respectively. Two VRRP group IDs must be bound to the same RBP and be associated with different VRRP sub-interfaces. In addition, <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname997879665214414">odd-mac</span></strong> and <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname1684049850214414">even-mac</span></strong> must be configured for different VRRP groups with specific IDs. The two devices that load-balance traffic must have the same configuration, including the binding between the VRRP group ID and even or odd MAC address type.</li><li id="EN-US_TASK_0172374364__en-us_task_0172374382_li1915432152214414">Before modifying the setting of <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname1315086772214414">odd-mac</span></strong> or <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname153515448214414">even-mac</span></strong>, run the <a href="cmdqueryname=undo+vrrp-id"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname1680990123214109">undo vrrp-id</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname1065331278214109">vrid</span></i> command to delete the configuration. Then run the <a href="cmdqueryname=vrrp-id"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname143446180214414">vrrp-id</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname504200149214414">vrid</span></i> command to reconfigure the setting.</li></ul>
</div>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep1719585973214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd12622830104916">Run <a href="cmdqueryname=backup-id"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname366628518214109">backup-id</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname695121711214414">backup-id</span></i> <a href="cmdqueryname=remote-backup-service"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname2117319289214109">remote-backup-service</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname514429644214414">service-name</span></i></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p20396171524817">The RBP is associated with the RBS, and the user backup ID in the RBP is set.</p>
</p><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p586884056214414"><i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname367938521214414">backup-id</span></i> sets a user backup ID. The RBP to which a user belongs can be determined based on the <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname1520781345214414">backup-id</span></i> and RBS. Note that the same <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname379934919214414">backup-id</span></i> value must be set for devices that back up one another in the same RBP, and different <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname1898673725214414">backup-id</span></i> values must be set in other RBPs.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep1484401819214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd1023844734214109">Run <a href="cmdqueryname=service-type"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname1529842429214109">service-type</span></b></a> <span>{ <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377322_cmdparmname712995201214121">arp</span></strong><span> | <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377322_cmdparmname548328083214121">l2tp</span></strong></span><span>| <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377322_cmdparmname1753942438214121">bras</span></strong> | <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377322_cmdparmname2097086694214121">multicast</span></strong></span><span> | <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377322_cmdparmname1842562716214121">igmp</span></strong></span> | <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377322_cmdparmname1476900750214121">igmp-snooping</span></strong><span> | <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377322_cmdparmname1772406719214121">no-host-multicast</span></strong></span><span> | <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377322_cmdparmname1055183077214121">dhcp-server</span></strong></span><span> | <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_en-us_cliref_0172377322_cmdparmname1008117187214121">nd</span></strong></span> }</span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p66360558594">Remote backup is enabled for user services.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep175701410154013"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd857061094019">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname1281132013407">commit</span></b></a></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1684194016">The configuration is committed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep996495397214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd207664500214414">(Optional) Run <span><a href="cmdqueryname=acct-session-id+nas-logic-sysname"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname925502053214414">acct-session-id nas-logic-sysname</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname2038455297214414">host-name</span></i></span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1909336296214414">A logic host name used to generate RUI user accounting IDs is configured.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep2058539742214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd1526224799214414">(Optional) Run <a href="cmdqueryname=load-balance+hash-arithmetic"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname11146671214109">load-balance hash-arithmetic</span></b></a> { <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname2002221482214109">arithmetic1</span></strong> | <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname26686610214109">arithmetic2</span></strong> } [ <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname1175410562214109">hash-fields</span></strong> <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname883593054214109">mac offset</span></strong> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname551824684214109">mac-offset</span></i> ]</span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1892111063214414">A hash algorithm for load balancing based on odd and even MAC addresses is configured on the interface board.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep247423864214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd1957458989214414">(Optional) Run <a href="cmdqueryname=bras+access+remark+mac"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname1023190236214109">bras access remark mac</span></b></a> <i><span class="varname" id="EN-US_TASK_0172374364__en-us_task_0172374382_varname2017758639214109">mac-address</span></i> { <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname1145482245214109">odd-mac</span></strong> | <strong><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdparmname1722099325214109">even-mac</span></strong> }</span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1973434079214414">The device is enabled to mark a specified MAC address as an odd or even MAC address.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374364__en-us_task_0172374382_substep1996325197214109"><span id="EN-US_TASK_0172374364__en-us_task_0172374382_cmd1039078236214414">Run <span><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172374364__en-us_task_0172374382_cmdname641296113214414">commit</span></b></a></span></span><p><p id="EN-US_TASK_0172374364__en-us_task_0172374382_p1781220092214414">The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0020.html">Configuring Multi-Device Backup for IPv6 BRAS User Information
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0005_a.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>