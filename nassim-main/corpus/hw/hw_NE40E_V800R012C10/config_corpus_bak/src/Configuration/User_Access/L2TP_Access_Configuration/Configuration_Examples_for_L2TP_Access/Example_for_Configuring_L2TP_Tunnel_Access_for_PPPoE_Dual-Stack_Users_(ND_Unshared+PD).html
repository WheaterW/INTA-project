
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring L2TP Tunnel Access for PPPoE Dual-Stack Users (ND Unshared+PD)">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_013506.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_014416.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,z00588052,c00819848,l00593348,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="L2TP">
<meta name="featuretype" content="User Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="L2TP">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="L2TP">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="L2TP">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="l00593348">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001201216870">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring L2TP Tunnel Access for PPPoE Dual-Stack Users (ND Unshared+PD)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001201216870"></a><a name="EN-US_TASK_0000001201216870"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring L2TP Tunnel Access for PPPoE Dual-Stack Users (ND Unshared+PD)</h1>
<div class="taskbody"><p></p>
<div class="context"><a name="EN-US_TASK_0000001201216870__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0000001201216870__fig_dc_ne_l2tp_cfg_01350701">Figure 1</a>, users want to remotely access an enterprise's private network. As such, a point-to-point L2TP tunnel is established on the public network. The LAC and LNS are connected through a WAN. PPP data frames are encapsulated and transmitted through the L2TP tunnel. RADIUS authentication and accounting are used on both the LAC and LNS. After accessing the public network, remote users access internal network resources through the L2TP tunnel. To allow the users to access IPv4 and IPv6 networks, configure the LNS to use a local address pool to assign IPv4 addresses to the users, use DHCPv6 IA_PD to assign IPv6 prefixes to them, and use ND to assign IPv6 addresses to them.</p>
<div class="fignone" id="EN-US_TASK_0000001201216870__fig_dc_ne_l2tp_cfg_01350701"><a name="EN-US_TASK_0000001201216870__fig_dc_ne_l2tp_cfg_01350701"></a><a name="fig_dc_ne_l2tp_cfg_01350701"></a><span class="figcap"><b>Figure 1 </b>Configuring L2TP tunnel access for PPPoE dual-stack users (ND unshared+PD)</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interface1 in this example represents GE<span>0/1/0</span>.</p>
</div></div>
<p><span><img class="vsd" src="figure/en-us_image_0000001201376838.png"></span></p>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001201216870__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure the LAC.</p>
<ul><li>Configure an interface address for the LAC.</li><li>Enable basic L2TP functions.</li><li>Configure an L2TP tunnel connection on the LAC.</li><li>Configure a tunnel authentication mode.</li><li>Configure the PPPoE access service for the LAC.</li></ul>
</li><li><p>Configure the LNS.</p>
<ul><li>Configure an interface address for the LNS and enable IPv6 on the interface.</li><li>Configure a VT.</li><li>Enable basic L2TP functions.</li><li>Configure an L2TP tunnel connection on the LNS.</li><li>Configure a tunnel authentication mode and user authentication mode.</li><li>Configure LNS-side tunnel parameters.</li><li>Configure the DHCPv6 device to generate DUIDs in DUID-LLT mode.</li><li>Configure address pools, including a local IPv4 address pool and an IPv6 delegation prefix pool.</li><li>Configure an L2TP user domain and specify address pools in the domain.</li><li>Configure a RADIUS server group.</li></ul>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001201216870__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Identical domain names, usernames, and passwords on the LAC and LNS</p>
</li><li><p>LNS-side tunnel authentication mode (CHAP is used in this example) and tunnel password</p>
</li><li><p>LNS-side local and remote tunnel names</p>
</li><li><p>VT number</p>
</li><li><p>L2TP group ID</p>
</li><li><p>Names and address ranges of address pools</p>
</li><li>AAA domain name</li><li>User authentication mode on <span class="keyword">Device</span>A/<span class="keyword">Device</span>B (RADIUS authentication)</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001201216870__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure <span class="keyword">Device</span>A that functions as the LAC.</span><p><p># Configure network-side interfaces.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> sysname <span class="keyword">Device</span>A</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>ip address 10.38.160.1 255.255.255.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> interface </strong><strong>loopback1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack1] <strong>ip address 10.1.1.1 255.255.255.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack1] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack1] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-LoopBack1]<strong> quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface</strong> <strong>Loopback2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack2] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack2] <strong>ipv6 address 2001:db8::2:2 64</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack2] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack2] <strong>ip address 10.2.2.2 255.255.255.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack2] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
<p># Enable basic L2TP functions and configure an L2TP connection on the LAC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>l2tp enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> l2tp-group group1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-l2tp-group1]<strong> tunnel name LAC</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-l2tp-group1]<strong> start l2tp ip 10.38.160.2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-l2tp-group1]<strong> tunnel source loopback1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-l2tp-group1] <strong>commit</strong></pre>
<p># Configure a tunnel authentication mode.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-l2tp-group1] <strong>tunnel authentication</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-l2tp-group1] <strong>tunnel password cipher YsHsjx_202206</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-l2tp-group1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-l2tp-group1]<strong> quit</strong></pre>
<p># Configure the PPPoE access service.</p>
<ol type="a"><li># Create UDP sockets with the local port numbers 1645, 1646, and 3799 and with any local IP address.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> </strong><strong>radius local-ip all</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</li><li>Configure AAA schemes.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> aaa</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa]<strong> </strong><strong>authentication-scheme auth1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-authen-radius]<strong> </strong><strong>authentication-mode radius</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-authen-radius]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-authen-radius]<strong> quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa]<strong> accounting-scheme acct1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-accounting-acct1]<strong> accounting-mode radius</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-accounting-acct1]<strong> quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa] <strong>commit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa] <strong>quit</strong></pre>
</li><li>Configure a RADIUS server group.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> radius-server group rd1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-radius-rd1]<strong> radius-server authentication 192.168.7.249 1812 weight 0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-radius-rd1]<strong> radius-server accounting 192.168.7.249 1813 weight </strong><strong>0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-radius-rd1]<strong> radius-server shared-key-cipher YsHsjx_202206 </strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-radius-rd1]<strong> radius-server source interface Loopback2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-radius-rd1]<strong> commit </strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-radius-rd1]<strong> radius-server calling-station-id include mac</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-radius-rd1]<strong> </strong><strong>radius-server user-name original</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-radius-rd1]<strong> commit </strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-radius-rd1]<strong> </strong><strong>radius-server class-as-car</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-radius-rd1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</li><li># Configure the DHCPv6 device to generate DUIDs in DUID-LLT mode. (This step is not required if a DUID has been configured on <span class="keyword">Device</span>A.)<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>dhcpv6 duid llt</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</li><li>Configure a user access domain.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>aaa</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa]<strong> domain isp1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-isp1] <strong>authentication-scheme auth1 </strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-isp1] <strong>accounting-scheme acct1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-isp1] <strong>radius-server group rd1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-isp1] <strong>commit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-isp1] <strong>idle-cut 60 500</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-domain-isp1] <strong>l2tp-group group1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-isp1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-domain-isp1] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa] <strong>quit</strong></pre>
</li><li>Configure a VT.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> interface virtual-template 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-Virtual-Template1]<strong> ppp authentication-mode chap</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-Virtual-Template1]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-Virtual-Template1]<strong> quit</strong></pre>
</li><li># Configure the Eth-Trunk interface to work in static LACP mode, set a timeout period for the interface to receive LACPDUs, and specify the VT.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface Eth-Trunk2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-Eth-Trunk2]<strong> mode lacp-static</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-Eth-Trunk2]<strong> lacp timeout fast</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-Eth-Trunk2]<strong> </strong><strong>commit</strong></pre>
</li><li>Bind VT1 to Eth-Trunk2.10.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-Eth-Trunk2]<strong> </strong><strong>interface Eth-Trunk2.10</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-Eth-Trunk2.10] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-Eth-Trunk2.10] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-Eth-Trunk2.10]<strong> </strong><strong>pppoe-server bind virtual-template 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-Eth-Trunk2.10] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-Eth-Trunk2.10]<strong> user-vlan 1000 4000 qinq 2000 2001</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-Eth-Trunk2.10-user-vlan-1000-4000-qinq-2000-2001]<strong> </strong><strong>quit</strong></pre>
</li><li>Configure a BAS interface.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-Eth-Trunk2.10] <strong>bas</strong>
[<strong><span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span></strong><span class="keyword">Device</span>A-Eth-Trunk2.10-bas]<strong> access-type layer2-subscriber default-domain authentication isp1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-Eth-Trunk2.10-bas]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-Eth-Trunk2.10-bas]<strong> </strong><strong>quit</strong></pre>
</li></ol>
</p><p><div class="p">Configure a routing protocol.<ol type="a"><li>Enable the function to automatically control a route's cost preference.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>peer-backup route-cost auto-advertising</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</li><li>Configure MPLS.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>mpls</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-mpls] <strong>mpls ldp</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-mpls] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>mpls lsr-id 10.1.1.1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface GigabitEthernet</strong><strong><span>0/1/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>mpls ldp</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A ] <strong>commit</strong></pre>
</li><li># Configure OSPF to import UNRs.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>ospf 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1] <strong>default cost inherit-metric</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1] <strong>import-route unr</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1] <strong>area 0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1-area-0.0.0.0] <strong>network 10.1.1.0 0.0.0.255</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1-area-0.0.0.0] <strong>network 10.38.160.1 0.0.0.255</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</li></ol>
</div>
</p></li><li><span>Configure <span class="keyword">Device</span>B that functions as the LNS.</span><p><p># Assign an IP address to the interface connected to the tunnel and enable IPv6 on the interface.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> sysname <span class="keyword">Device</span>B</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-gigabitethernet<span>0/1/0</span>]<strong> ip address 10.38.160.2 255.255.255.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-gigabitethernet<span>0/1/0</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-gigabitethernet<span>0/1/0</span>] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-gigabitethernet<span>0/1/0</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-gigabitethernet<span>0/1/0</span>] <strong>quit</strong></pre>
<p># Configure the LNS-side source interface.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> interface </strong><strong>loopback1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1] <strong>ip address 10.3.3.3 255.255.255.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-LoopBack1]<strong> quit</strong></pre>
<p># Configure a source interface for RADIUS servers.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface</strong> <strong>Loopback2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1] <strong>ipv6 address 2001:db8::3:2 64</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1] <strong>ip address 10.4.4.4 255.255.255.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-LoopBack1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
<p># Create a VT and configure related information.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> interface virtual-template 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-Virtual-Template1]<strong> ppp authentication-mode chap</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-Virtual-Template1]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-Virtual-Template1]<strong> quit</strong></pre>
<p># Enable basic L2TP functions and configure an L2TP group.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>l2tp enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> l2tp-group group1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-l2tp-group1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-l2tp-group1] <strong>tunnel name LNS</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-l2tp-group1]<strong> allow l2tp virtual-template 1 remote LAC</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-l2tp-group1] <strong>tunnel authentication</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-l2tp-group1] <strong>tunnel password cipher YsHsjx_202206</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-l2tp-group1]<strong> </strong><strong>qos scheduling-mode session</strong> 
[<span class="keyword">*</span><span class="keyword">Device</span>B-l2tp-group1]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-l2tp-group1]<strong> </strong><strong>quit</strong></pre>
<p># Disable automatic user bandwidth adjustment on the board in slot <span>1</span>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> </strong><strong>slot <span>1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> undo hostcar drop-rate enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> commit</strong></pre>
<div class="p"># Configure an LNS group named <strong>group1</strong>.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> lns-group group1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-lns-group-group1]<strong> bind slot <span>1</span> </strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-lns-group-group1]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-lns-group-group1]<strong> bind source loopback1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-lns-group-group1]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-lns-group-group1]<strong> quit</strong></pre>
</div>
<div class="p"># Configure the DHCPv6 device to generate DUIDs in DUID-LLT mode.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> </strong><strong>dhcpv6 duid llt</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> commit</strong></pre>
</div>
<p># Configure address pools.</p>
<ol type="a"><li>Configure an IPv6 delegation prefix pool named <strong>pre_nd</strong> for ND users.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ipv6 prefix </strong><strong>pre_nd</strong> <strong>delegation</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-prefix-pre_nd] <strong>prefix 2001:db8:1::/48</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-prefix-pre_nd] <strong>slaac-unshare-only</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-prefix-pre_nd] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commi</strong><strong>t</strong></pre>
</li><li>Configure an IPv6 delegation prefix pool named <strong>pre_pd</strong> for PD users.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ipv6 prefix </strong><strong>pre_pd</strong> <strong>delegation</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-prefix-pre_pd] <strong>prefix 2001:db8:2::/48</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-prefix-pre_pd] <strong>commi</strong><strong>t</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ipv6-prefix-pre_pd] <strong>pd-unshare-only</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ipv6-prefix-pre_pd] <strong>quit</strong></pre>
</li><li>Configure an IPv6 delegation address pool named <strong>pool_nd</strong> and bind the IPv6 delegation prefix pool <strong>pre_nd</strong> to it.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ipv6 pool pool_nd bas delegation</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-pool-pool_nd] <strong>prefix pre_nd</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-pool-pool_nd] <strong>dns-server 2001:db8::2:2 2001:db8::2:3</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-pool-pool_nd] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commi</strong><strong>t</strong></pre>
</li><li>Configure an IPv6 delegation address pool named <strong>pool_pd</strong> and bind the IPv6 delegation prefix pool <strong>pre_pd</strong> to it.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ipv6 pool pool_pd bas delegation</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-pool-pool_pd] <strong>prefix pre_pd</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-pool-pool_pd] <strong>dns-server 2001:db8::2:2 2001:db8::2:3</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-pool-pool_pd] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commi</strong><strong>t</strong></pre>
</li><li>Configure a local IPv4 address pool named <strong>pool_v4</strong>.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ip pool </strong><strong>pool_v4</strong> <strong>bas local</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ip-pool-pool_v4] <strong>gateway 172.16.0.1 255.255.255.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ip-pool-pool_v4] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ip-pool-pool_v4] <strong>section 0 172.16.0.2 172.16.0.200</strong> 
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ip-pool-pool_v4] <strong>dns-server 10.179.155.161 10.179.155.177</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ip-pool-pool_v4] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
</li></ol>
<div class="p"># Create UDP sockets with the local port numbers 1645, 1646, and 3799 and with any local IP address.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> </strong><strong>radius local-ip all</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
</div>
<div class="p"># Configure AAA schemes.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> aaa</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-aaa]<strong> </strong><strong>authentication-scheme auth1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa-authen-radius]<strong> </strong><strong>authentication-mode radius</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa-authen-radius]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-aaa-authen-radius]<strong> quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-aaa]<strong> accounting-scheme acct1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa-accounting-acct1]<strong> accounting-mode radius</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa-accounting-acct1]<strong> quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa] <strong>commit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa] <strong>quit</strong></pre>
</div>
<div class="p"># Configure a RADIUS server group.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> radius-server group rd1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-radius-rd1]<strong> radius-server authentication 192.168.7.249 1812 weight 0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-radius-rd1]<strong> radius-server accounting 192.168.7.249 1813 weight </strong><strong>0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-radius-rd1]<strong> radius-server shared-key-cipher YsHsjx_202206 </strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-radius-rd1]<strong> commit </strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-radius-rd1]<strong> radius-server calling-station-id include mac</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-radius-rd1]<strong> </strong><strong>radius-server user-name original</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-radius-rd1]<strong> commit </strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-radius-rd1]<strong> </strong><strong>radius-server class-as-car</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-radius-rd1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
</div>
<div class="p"># Configure a user access domain.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>aaa</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa]<strong> domain isp1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-isp1]<strong> authentication-scheme auth1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-isp1]<strong> accounting-scheme acct1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-isp1]<strong> radius-server group rd1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-isp1]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-isp1] <strong>prefix-assign-mode unshared  </strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-isp1]<strong> ip-pool pool_v4</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-isp1] <strong>ipv6-pool </strong><strong>pool_nd</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-isp1] <strong>ipv6-pool pool_pd</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-isp1] <strong>accounting-start-delay 10 online user-type l2tp</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-isp1] <strong>accounting-start-delay traffic-forward before-start-accounting</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-isp1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-isp1] <strong>user-basic-service-ip-type ipv4</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-isp1]<strong> quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa]<strong> quit</strong></pre>
</div>
</p><p><div class="p">Configure a routing protocol.<ol type="a"><li>Enable the function to automatically control a route's cost preference.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>peer-backup route-cost auto-advertising</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
</li><li>Configure MPLS.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>mpls</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-mpls] <strong>mpls ldp</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-mpls] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>mpls lsr-id 10.3.3.3</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface GigabitEthernet</strong><strong><span>0/1/0</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>mpls ldp</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
</li><li>Configure OSPF to import UNRs.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ospf 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1] <strong>default cost inherit-metric</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1] <strong>import-route unr</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1] <strong>area 0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0] <strong>network 10.3.3.3 0.0.0.255</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0] <strong>network 10.38.160.1 0.0.0.255</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
</li></ol>
</div>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001201216870__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span>A configuration file</p>
</li></ul>
<pre class="screen">#
sysname <span class="keyword">Device</span>A
# 
radius local-ip all
#
l2tp enable
#
mpls lsr-id 10.1.1.1
#
mpls
#
mpls ldp
#
dhcpv6 duid 0001000124fbc193dc99141ea1e9
#
radius-server group rd1
 radius-server shared-key-cipher %^%#e,yC%f9z4M2)b)2<font style="font-size:8pt" Face="Courier New" >~</font>r+lA{$g*Fzc+5/bu7VHAN&lt;%(%^%
 radius-server authentication 192.168.7.249 1812 weight 0                       
 radius-server accounting 192.168.7.249 1813 weight 0                           
 radius-server class-as-car  
 radius-server source interface LoopBack2                                             
 radius-server calling-station-id include mac                                   
 radius-server user-name original                                               
# 
interface Virtual-Template1
 ppp authentication-mode chap
#                                                                               
interface Eth-Trunk2                                                                                                 
 mode lacp-static                                                               
 lacp timeout fast                                                              
#                                                                               
interface Eth-Trunk2.10  
 pppoe-server bind Virtual-Template 1                                                       
 ipv6 enable                                                                    
 ipv6 address auto link-local                                                                                                                  
 user-vlan 1000 4000 qinq 2000 2001                                             
 bas                                                                            
 #                                                                              
  access-type layer2-subscriber default-domain authentication isp1                                                           
 #                                                                              
#
interface gigabitethernet<span>0/1/0</span>
 undo shutdown
 ip address 10.38.160.1 255.255.255.0
 ipv6 enable
 mpls 
 mpls ldp
#
interface LoopBack1
 ip address 10.1.1.1 255.255.255.0
 ipv6 enable
 ipv6 address auto link-local 
#
interface LoopBack2
 ipv6 enable
 ip address 10.2.2.2 255.255.255.0
 ipv6 address 2001:DB8::2:2/64
 ipv6 address auto link-local
#
l2tp-group group1
 tunnel name LAC
 start l2tp ip 10.38.160.2
 tunnel source LoopBack1
 tunnel authentication
 tunnel password cipher %@%##!!!!!!!!!"!!!!"!!!!(!!!!1];16qfZ81fv"uMoKKZ.1k"`AO!X2K2N.b<font style="font-size:8pt" Face="Courier New" >~</font>'NB^V!!!!!!!!!!1!!!!o/4J(q"J1F.!K9%M!6x8%@%#
#
aaa
 #
 authentication-scheme auth1
 #
 accounting-scheme acct1
<em> </em>#                                                                              
 domain isp1                                                                  
  authentication-scheme auth1                                                 
  accounting-scheme acct1                                                     
  radius-server group rd1 
  idle-cut 60 500
  l2tp-group group1                                            
#
ospf 1
 default cost inherit-metric
 import-route unr
 opaque-capability enable
 area 0.0.0.0
  network 10.38.160.0 0.0.0.255
  network 10.1.1.1 0.0.0.255
#
peer-backup route-cost auto-advertising 
#
return</pre>
<ul><li><p><span class="keyword">Device</span>B configuration file</p>
</li></ul>
<pre class="screen">#
sysname <span class="keyword">Device</span>B
# 
radius local-ip all
#
mpls lsr-id 10.3.3.3
#
mpls
#
mpls ldp
#
l2tp enable
#
dhcpv6 duid 0001000124fbc193dc99141ea1e9
#
radius-server group rd1
 radius-server shared-key-cipher %^%#e,yC%f9z4M2)b)2<font style="font-size:8pt" Face="Courier New" >~</font>r+lA{$g*Fzc+5/bu7VHAN&lt;%(%^%
 radius-server authentication 192.168.7.249 1812 weight 0                       
 radius-server accounting 192.168.7.249 1813 weight 0                           
 radius-server class-as-car  
 radius-server source interface LoopBack2                                             
 radius-server calling-station-id include mac                                   
 radius-server user-name original                                               
# 
slot <strong><span>1</span></strong>
 undo hostcar drop-rate enable
#
interface Virtual-Template1
 ppp authentication-mode chap
#                                                                               
interface Eth-Trunk2                                                                                                 
 mode lacp-static                                                               
 lacp timeout fast                                                              
#                                                                               
interface gigabitethernet<span>0/1/0</span>
 undo shutdown
 ip address 10.38.160.2 255.255.255.0
 ipv6 enable
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 10.3.3.3 255.255.255.0
 ipv6 enable
 ipv6 address auto link-local 
#
interface LoopBack2
 ipv6 enable
 ip address 10.4.4.4 255.255.255.0
 ipv6 address 2001:DB8::3:2/64
 ipv6 address auto link-local
#
l2tp-group group1
 tunnel name LNS
 allow l2tp virtual-template 1 remote LAC
 tunnel authentication
 tunnel password cipher %@%##!!!!!!!!!"!!!!"!!!!(!!!!1];16qfZ81fv"uMoKKZ.1k"`AO!X2K2N.b<font style="font-size:8pt" Face="Courier New" >~</font>'NB^V!!!!!!!!!!1!!!!o/4J(q"J1F.!K9%M!6x8%@%#
 qos scheduling-mode session 
#
lns-group group1
 bind slot <span>1</span>
 bind source loopback1
#                                                                               
ip pool pool_v4 bas local                                                       
 gateway 172.16.0.1 255.255.255.0                                               
 section 0 172.16.0.2 172.16.0.200                                              
 dns-server 10.179.155.161 10.179.155.177                                       
#                                                                               
ipv6 prefix pre_nd delegation                                                   
 prefix 2001:DB8:1::/48                                                         
 slaac-unshare-only                                                             
#                                                                               
ipv6 pool pool_nd bas delegation                                                
 dns-server 2001:DB8::2:2 2001:DB8::2:3                                         
 prefix pre_nd                                                                  
#                                                                               
ipv6 prefix pre_pd delegation                                                   
 prefix 2001:DB8:2::/48                                                         
 pd-unshare-only                                                                
#                                                                               
ipv6 pool pool_pd bas delegation                                                
 dns-server 2001:DB8::2:2 2001:DB8::2:3                                         
 prefix pre_pd                                                                  
# 
aaa
 #
 authentication-scheme auth1
 #
 accounting-scheme acct1
<em> </em>#                                                                              
 domain isp1                                                                  
  authentication-scheme auth1                                                 
  accounting-scheme acct1                                                     
  radius-server group rd1                                                     
  prefix-assign-mode unshared                                                   
  ip-pool pool_v4                                                               
  ipv6-pool pool_nd                                                             
  ipv6-pool pool_pd 
  accounting-start-delay 10 online user-type l2tp                                
  accounting-start-delay traffic-forward before-start-accounting                
  user-basic-service-ip-type ipv4                                               
# 
ospf 1
 default cost inherit-metric
 import-route unr
 opaque-capability enable
 area 0.0.0.0
  network 10.38.160.0 0.0.0.255
  network 10.3.3.3 0.0.0.255
#
peer-backup route-cost auto-advertising
#
return</pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_013506.html">Configuration Examples for L2TP Access
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_014416.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>