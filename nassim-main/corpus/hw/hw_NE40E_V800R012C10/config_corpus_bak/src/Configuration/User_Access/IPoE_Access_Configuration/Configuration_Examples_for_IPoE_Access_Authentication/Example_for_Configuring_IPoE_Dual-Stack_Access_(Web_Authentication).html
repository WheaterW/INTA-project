
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring IPoE Dual-Stack Access (Web Authentication)">
<meta name="abstract" content="This section provides an example for configuring IPoE dual-stack user access through web authentication. When an IPoE dual-stack user connects to a BRAS, the BRAS implements RADIUS authentication and accounting, assigns an IPv4 address from the local address pool to the user, and assigns an IPv6 address through ND to the user. This allows the user to access the Internet.">
<meta name="description" content="This section provides an example for configuring IPoE dual-stack user access through web authentication. When an IPoE dual-stack user connects to a BRAS, the BRAS implements RADIUS authentication and accounting, assigns an IPv4 address from the local address pool to the user, and assigns an IPv6 address through ND to the user. This allows the user to access the Internet.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipox_cfg_0083.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipoxv6_cfg_0067.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_bras_v4v6_web_mac.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,z00603461,w00800033,z00588052,ipoxne,c00549182,w00556928,l00593348,w00606909,w00447999,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPoE">
<meta name="featuretype" content="User Access">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPoE">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="IPoE">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="IPoE">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172374031">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring IPoE Dual-Stack Access (Web Authentication)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172374031"></a><a name="EN-US_TASK_0172374031"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring IPoE Dual-Stack Access (Web Authentication)</h1>
<div class="taskbody"><p>This section provides an example for configuring IPoE dual-stack user access through web authentication. When an IPoE dual-stack user connects to a BRAS, the BRAS implements RADIUS authentication and accounting, assigns an IPv4 address from the local address pool to the user, and assigns an IPv6 address through ND to the user. This allows the user to access the Internet.</p>
<div class="context"><a name="EN-US_TASK_0172374031__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0172374031__fig_dc_ne_ipox_cfg_007201">Figure 1</a>, the user belong to the domain <strong>isp5</strong> and uses the dual-stack access mode. The <span class="keyword">Device</span> adopts RADIUS authentication and accounting, assigns an IPv4 address from a local address pool to the user, and assigns an IPv6 address to the user through ND. Web authentication is used. After passing web authentication, the user accesses the Internet through interface2 on the <span class="keyword">Device</span>.</p>
<div class="fignone" id="EN-US_TASK_0172374031__fig_dc_ne_ipox_cfg_007201"><a name="EN-US_TASK_0172374031__fig_dc_ne_ipox_cfg_007201"></a><a name="fig_dc_ne_ipox_cfg_007201"></a><span class="figcap"><b>Figure 1 </b>Configuring IPoE dual-stack access (web authentication)</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 3 in this example represent GE <span>0/1/1</span>, GE <span>0/1/2</span>, and GE <span>0/1/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_ne_ipox_cfg_007201.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172374031__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure AAA schemes.</p>
</li><li>Configure an interface IP address for the device to receive portal packets from the web authentication server.</li><li><p>Configure a web authentication server. (In this example, the web server and web authentication server are deployed on the same device.)</p>
</li><li><p>Configure a RADIUS server group.</p>
</li><li>Configure a user password.</li><li><p>Configure ACLs to allow the user to access only the web server address before web authentication succeeds.</p>
</li><li>Configure a DUID for the device.</li><li><p>Configure a local IPv4 address pool.</p>
</li><li><p>Configure a local IPv6 prefix pool.</p>
</li><li><p>Configure a local IPv6 address pool and bind the prefix pool to the local IPv6 address pool.</p>
</li><li><p>Configure a pre-authentication domain and an authentication domain for web authentication.</p>
</li><li><p>Configure a BAS interface and an upstream interface.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172374031__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Authentication scheme name and authentication mode</p>
</li><li><p>Accounting scheme name and accounting mode</p>
</li><li><p>RADIUS server group name, and IP address and port numbers of the RADIUS authentication and accounting server</p>
</li><li><p>Local prefix pool name</p>
</li><li><p>IPv6 prefix to be assigned/prefix length</p>
</li><li><p>Local address pool names</p>
</li><li><p>Domain names</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172374031__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure AAA schemes.</span><p><p># Configure an authentication scheme.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> aaa</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa]<strong> authentication-scheme auth5</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-authen-auth5]<strong> authentication-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-authen-auth5]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-authen-auth5]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa] <strong>authentication-scheme none</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-authen-none] <strong>authentication-mode none</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-authen-none] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-authen-none] <strong>quit</strong></pre>
<p># Configure an accounting scheme.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa]<strong> accounting-scheme acct5</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-accounting-acct5]<strong> accounting-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-accounting-acct5]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-accounting-acct5]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa]<strong> accounting-scheme none</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-accounting-none] <strong>accounting-mode none</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-accounting-none] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-accounting-none] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa]<strong> quit</strong></pre>
</p></li><li><span>Configure an IP address used by the device to receive portal packets from the web authentication server.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>interface</strong> <strong>LoopBack 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-LoopBack0] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-LoopBack0] <strong>ip address </strong><strong>10.6.55.1</strong><strong> 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-LoopBack0] <strong>ipv6 address </strong><strong>2001:db8:1::3</strong><strong> 128</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-LoopBack0] <strong>ipv6 address auto link-local</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-LoopBack0] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-LoopBack0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> web-auth-server source-ip 10.6.55.1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>web-auth-server source-ipv6 2001:db8:1::3</strong></pre>
</p></li><li><span>Configure a web authentication server.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> web-auth-server enable</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>web-auth-server source interface </strong><strong>LoopBack 0</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> web-auth-server 10.6.55.56 key <span>cipher YsHsjx_202206</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>web-auth-server 2001:db8:1::2 key cipher YsHsjx_202206</strong> </pre>
</p></li><li><span>Configure a RADIUS server group.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> radius-server group rd5</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-radius-rd5]<strong> radius-server authentication 10.6.55.55 1645</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-radius-rd5]<strong> radius-server accounting 10.6.55.55 1646</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-radius-rd5] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-radius-rd5]<strong> radius-server type standard</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-radius-rd5]<strong> radius-server shared-key-cipher YsHsjx_202206</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-radius-rd5]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-radius-rd5]<strong> quit</strong></pre>
</p></li><li><span>Configure the IPoE user password.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> aaa</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa]<strong> </strong><strong>default-password cipher YsHsjx_202206</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa]<strong> quit</strong></pre>
</p></li><li><span>Configure ACLs to allow the user to access only the web server address before web authentication succeeds.</span><p><p># Configure a user group.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> user-group huawei</strong></pre>
<p># Configure an ACL numbered 6000 to permit the traffic between the user group <strong>huawei</strong> and the web authentication server and between the user group <strong>huawei</strong> and the DNS server.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>acl number 6000</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl-ucl-6000]<strong> rule permit ip source user-group huawei destination ip-address 10.6.55.56 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl-ucl-6000] <strong>rule permit ip source ip-address 10.6.55.56 0.0.0.255 destination user-group huawei</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl-ucl-6000]<strong> </strong><strong>rule permit ip source user-group huawei destination ip-address 10.10.10.1 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl-ucl-6000] <strong>rule permit ip source ip-address 10.10.10.1 0.0.0.255 destination user-group huawei</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl-ucl-6000] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-acl-ucl-6000] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>acl ipv6 number 6000</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl6-ucl-6000]<strong> </strong><strong>rule permit ipv6 source user-group huawei destination ipv6-address </strong><strong>2001:db8:1::2/128</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl6-ucl-6000]<strong> </strong><strong>rule permit ipv6 </strong><strong>source ipv6-address </strong><strong>2001:db8:1::2/128</strong> <strong>destination </strong><strong>user-group huawei</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl6-ucl-6000] <strong>rule permit ipv6 source user-group huawei destination ipv6-address </strong><strong>2001:db8:1::1</strong><strong>/128</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl6-ucl-6000]<strong> rule permit ipv6 </strong><strong>source ipv6-address </strong><strong>2001:db8:1::1</strong><strong>/128</strong> <strong>destination </strong><strong>user-group huawei</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl6-ucl-6000] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-acl6-ucl-6000] <strong>quit</strong></pre>
<p># Configure an ACL numbered 6001 and create ACL rules to match TCP packets from the user group <strong>huawei</strong> and with a destination port of www or 8080, so that HTTP redirect can be performed for the packets.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>acl number 6001</strong> </pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl-ucl-6001] <strong>rule permit tcp source user-group huawei</strong> <strong>destination-port eq www</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl-ucl-6001] <strong>rule permit tcp source user-group huawei</strong> <strong>destination-port eq 8080</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl-ucl-6001] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-acl-ucl-6001] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>acl ipv6 number 6001</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl6-ucl-6001] <strong>rule permit tcp source user-group huawei destination-port eq www</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl6-ucl-6001] <strong>rule permit tcp source user-group huawei destination-port eq 8080</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl6-ucl-6001] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-acl6-ucl-6001] <strong>quit</strong></pre>
<p># Configure an ACL numbered 6002 to deny all the traffic originating from the user group <strong>huawei</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> acl 6002 match-order auto</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl-ucl-6002]<strong> rule permit ip source ip-address any destination user-group huawei</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl-ucl-6002]<strong> rule deny ip source user-group huawei destination ip-address any</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl-ucl-6002]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-acl-ucl-6002]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>acl ipv6 number 6002</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl6-ucl-6002]<strong> rule permit ipv6 source ipv6-address any destination </strong><strong>user-group huawei</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl6-ucl-6002] <strong>rule deny ipv6 source user-group huawei destination ipv6-address any</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-acl6-ucl-6002] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-acl6-ucl-6002] <strong>quit</strong></pre>
<p># Configure traffic classifiers.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> traffic classifier c1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-classifier-c1]<strong> if-match acl 6000</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-classifier-c1] <strong>if-match ipv6 acl 6000</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-classifier-c1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-classifier-c1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>traffic classifier c2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-classifier-c2] <strong>if-match acl 6001</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-classifier-c2] <strong>if-match ipv6 acl 6001</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-classifier-c2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-classifier-c2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>traffic classifier c3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-classifier-c3]<strong> </strong><strong>if-match acl 6002</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-classifier-c3] <strong>if-match ipv6 acl 6002</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-classifier-c3] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-classifier-c3] <strong>quit</strong></pre>
<p># Configure traffic behaviors.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> traffic behavior b1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-behavior-b1]<strong> permit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-behavior-b1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-behavior-b1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>traffic behavior b2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-behavior-b2] <strong>http-redirect</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-behavior-b2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-behavior-b2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> traffic behavior b3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-behavior-b3]<strong> </strong><strong>deny</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-behavior-b3]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-behavior-b3]<strong> quit</strong></pre>
<p># Configure a traffic policy.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> traffic policy policy</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-trafficpolicy-policy]<strong> classifier c1 behavior b1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-trafficpolicy-policy]<strong> classifier c2 behavior b2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-trafficpolicy-policy]<strong> classifier c3 behavior b3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-trafficpolicy-policy]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-trafficpolicy-policy]<strong> quit</strong></pre>
<p># Apply the traffic policy globally.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> traffic-policy policy inbound</strong></pre>
</p></li><li><span>Configure a DUID for the device.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>dhcpv6 duid 12345678</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>] <strong>commit</strong></pre>
</p></li><li><span>Configure a user-side local IPv4 address pool.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>ip pool pool2 bas local</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-ip-pool-pool2] <strong>gateway 10.10.10.2 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-ip-pool-pool2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-ip-pool-pool2] <strong>section 0 10.10.10.3 10.10.10.100</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-ip-pool-pool2] <strong>dns-server 10.10.10.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-ip-pool-pool2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-ip-pool-pool2] <strong>quit</strong></pre>
</p></li><li><span>Configure a delegation prefix pool for IPv6 users.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>ipv6 prefix pre1 delegation</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-ipv6-prefix-pre1] <strong>prefix 2001:db8:3::/48</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-ipv6-prefix-pre1] <strong>slaac-unshare-only</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-ipv6-prefix-pre1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-ipv6-prefix-pre1] <strong>quit</strong></pre>
</p></li><li><span>Configure a delegation address pool for IPv6 users.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>ipv6 pool pool1 bas delegation</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-ipv6-pool-pool1] <strong>prefix pre1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-ipv6-pool-pool1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-ipv6-pool-pool1] <strong>dns-server 2001:db8:1::1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-ipv6-pool-pool1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-ipv6-pool-pool1] <strong>quit</strong></pre>
</p></li><li><span>Configure domains.</span><p><p># Configure a pre-authentication domain named <strong>domain1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>aaa</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa] <strong>domain domain1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-domain1] <strong>authentication-scheme none</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-domain1] <strong>accounting-scheme none</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-domain1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-domain1] <strong>prefix-assign-mode unshared</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-domain1] <strong>user-group huawei</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-domain1] <strong>ip-pool pool2</strong> </pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-domain1] <strong>ipv6-pool pool1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-domain1] <strong>web-server 10.6.55.56 2001:db8:1::2</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-domain1] <strong>web-server url http://www.isp1.com</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-domain1] <strong>web-server identical-url</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-domain1] <strong>quit</strong></pre>
<p># Configure an authentication domain named <strong>isp5</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa] <strong>domain isp5</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-isp5] <strong>authentication-scheme auth5</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-isp5] <strong>accounting-scheme acct5</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-isp5] <strong>radius-server group rd5</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-isp5] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-isp5] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa] <strong>quit</strong></pre>
</p></li><li><span>Configure a BAS interface and an upstream interface.</span><p><p># Configure a BAS interface.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/2</span>] <strong>bas</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/2</span>-bas] <strong>access-type layer2-subscriber default-domain pre-authentication domain1 authentication isp5</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/2</span>-bas] <strong>authentication-method web</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/2</span>-bas] <strong>authentication-method-ipv6 web</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/2</span>-bas] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/2</span>-bas] <strong>ip-trigger</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/2</span>-bas] <strong>arp-trigger</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/2</span>-bas] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/2</span>-bas]<strong> ipv6-trigger</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/2</span>-bas] <strong>nd-trigger</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/2</span>-bas] <strong>quit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In dual-stack user access scenarios, if a user attempts to go offline from the second stack and the stack in the Logout NTF packets received by the portal server is inconsistent with the user stack in authentication packets, the portal server may fail to find this user due to a user stack mismatch. In this case, perform the following operations:</p>
<ul><li>If the portal server can identify users based on MAC addresses, run the <strong>web-server redirect-key user-mac-address </strong><em>user-mac-address</em> [ <strong>simple</strong> [ <strong>type1</strong> ] | <strong>cipher</strong> { <strong>aes128</strong> [ <strong>cbc</strong> | <strong>gcm</strong> ] | <strong>des</strong> }] or <strong>web-server redirect-key ap-mac-address </strong><em>ap-mac-key</em> [ <strong>simple</strong> [ <strong>type1</strong> ] | <strong>cipher</strong> { <strong>aes128</strong> [ <strong>cbc</strong> | <strong>gcm</strong> ] | <strong>des</strong> }] command to configure the keyword of the customized Portal attribute. For security purposes, you are advised not to use the DES encryption mode. If you need to use such a mode, run the <a href="cmdqueryname=undo+crypto+weak-algorithm+disable"><b><span class="cmdname">undo crypto weak-algorithm disable</span></b></a> command to enable the weak security algorithm function first.</li><li>If the portal server cannot identify users by MAC address, run the <strong>ipoe-service-type </strong>{ <strong>ipv4</strong> | <strong>ipv6</strong> } command to configure the base protocol stack of IPoE dual-stack users.</li></ul>
</div></div>
<p># Enable IPv6 on an interface.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/2</span>] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/2</span>] <strong>ipv6 address auto link-local</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/2</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Check information about the address pool named <strong>pool2</strong>. The command output shows that the IP address of <strong>pool2</strong>'s gateway is <strong>10.10.10.2</strong>, the IP address of the DNS server is <strong>10.10.10.1</strong>, and addresses in <strong>pool2</strong> range from <strong>10.10.10.3</strong> to <strong>10.10.10.100</strong>.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>&gt; <strong>display ip pool name pool2</strong></pre>
<pre class="screen">  Pool-Name      : pool2
  Pool-No        : 0<span>    Pool-constant-index :- </span>
  Lease          : 3 Days 0 Hours 0 Minutes
  Frameip-Lease-Manage:  disable 
  NetBios Type   : N-Node
  Auto recycle   : 30                                                           
  Option 3       : Enable 
  DNS-Suffix     : -
  Dom-Search-List0: -                                                           
  Dom-Search-List1: -                                                           
  Dom-Search-List2: -                                                           
  Dom-Search-List3: - 
  Option-Code 125 : enterprise-code : 2011, string: -

  DNS1           :<strong> 10.10.10.1</strong>
  Position       : Local           Status           : Unlocked
  RUI-Flag       : -                                                            
  Attribute      : Private 
  Gateway        : <strong>10.10.10.2</strong>      Mask             : 255.255.255.0
  Vpn instance   : --              Unnumbered gateway: - 
  Profile-Name   : -               Server-Name      : -
  Total Idle     : 199             Have Dhcp IP     : 1
  Timeouts       : 0                                                            
  Timeout Count  : 0               Sub Option Count : 0                         
  Option Count   : 0               Force-reply Count: 0                         
  Auto-Blocked Times: 0            IP Allocation Failures: 0 
  Codes: CFLCT(conflicted)         Wait-Request-Time: -- 
  IP Loose Check : 0 
  ------------------------------------------------------------------------------------------------
  ID           start             end total  used  idle CFLCT disable reserved static-bind delayed
  ------------------------------------------------------------------------------------------------
   0      10.10.10.3    10.10.10.100    98     0    98     0       0        0       0       0 
  ------------------------------------------------------------------------------------------------</pre>
<p># Check information about the prefix pool named <strong>pre1</strong>. The command output shows that the prefix pool is a local prefix pool and the prefix address is <strong>2001:db8:3::/64</strong>.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>&gt; <strong>display ipv6 prefix pre1</strong></pre>
<pre class="screen"> ------------------------------------------------------------------------------
 Prefix Name        : pre1                
 Prefix Index       : 3
<span> Prefix constant index: - </span> Prefix Type        : DELEGATION          
 Prefix Address     : <strong>2001:DB8:3::</strong>                                       
 Prefix Length      : 48                  
<span> </span>Link-Address       : -
<span> Reserved Type      : NONE  </span> 
 Valid Lifetime     : 3 Days 0 Hours 0 Minutes
 Preferred Lifetime : 2 Days 0 Hours 0 Minutes
 IfLocked           : Unlocked            
<span> Vpn instance       : -        </span> PD Prefix Len      : 64
 PD Prefix/C-DUID   : -
 slaac-unshare-only : TRUE                
 pd-unshare-only    : FALSE               
 Free Prefix Count  : 65536
 Used Prefix Count  : 0
 Bound Prefix Count (Free): 0
 Bound Prefix Count (Used): 0
 Flexibly-Allocted Prefix Count: 0
 Reserved Prefix Count: 0
 Excluded Prefix Count: 0
 Radius Used Total  : 0  
 Radius Used Online : 0  
 Auto-Blocked Times : 0 
 IP Allocation Failures : 0 
 ------------------------------------------------------------------------------</pre>
<p># Check information about the address pool named <strong>pool1</strong>. The command output shows that <strong>pool1</strong> is a local address pool and is bound to the local prefix pool <strong>pre1</strong>.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>&gt; <strong>display ipv6 pool pool1</strong></pre>
<pre class="screen"> ----------------------------------------------------------------------
 Pool name          : pool1                            
 Pool No            : 2     
<span> Pool constant index :-  </span> 
 Pool type          : BAS DELEGATION  
 RUI-Flag           : -  
 Preference         : 255   
 Renew time         : 50    
 Rebind time        : 80    
 Status             : UNLOCKED  
 Refresh interval   : infinite
 Used by domain     : 2     
 Dhcpv6 Unicast     : disable
 Dhcpv6 rapid-commit: disable
 Dns list           : -
 Dns server master  : 2001:DB8:1::1 
 Dns server slave   : -
<span> AFTR name          : -  </span> 
 Wait-Request-Time  : -- 
 Warning Threshold  : 10  
 Warning Exhaust Switch: TRUE 
 ----------------------------------------------------------------------
 Prefix-Name                      Prefix-Type 
 ----------------------------------------------------------------------
 pre1                             DELEGATION
 ----------------------------------------------------------------------</pre>
<p># Check information about the domain named <strong>domain1</strong>. The command output shows that the domain is bound to the IPv6 address pool named <strong>pool1</strong> and the IPv4 address pool named <strong>pool2</strong>.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>&gt; <strong>display domain domain1</strong></pre>
<pre class="screen">------------------------------------------------------------------------------
  Domain-name                     : domain1
  Domain-state                    : Active
  Authentication-scheme-name      : auth5
  Accounting-scheme-name          : acct5
  Authorization-scheme-name       :
  Primary-DNS-IP-address          : -
  Second-DNS-IP-address           : -
  Web-server-URL-parameter        : No
<span>  Slave Web-IP-address            : -   Slave Web-URL                   : -   Slave Web-auth-server           : -    Slave Web-auth-state            : -  </span>  Portal-server-URL-parameter     : No
  Primary-NBNS-IP-address         : -
  Second-NBNS-IP-address          : -
  User-group-name                 : -
  Idle-data-attribute (time,flow) : 0, 60
  Install-BOD-Count               : 0
  Report-VSM-User-Count           : 0
  Value-added-service             : default
  User-access-limit               : 279552
  Online-number                   : 0
  Web-IP-address                  : -
  Web-URL                         : -
  Portal-server-IP                : -
  Portal-URL                      : -
  Portal-force-times              : 2
  PPPoE-user-URL                  : Disable
  IPUser-ReAuth-Time              : 300
  mscg-name-portal-key            : -
  Portal-user-first-url-key       : -
  Ancp auto qos adapt             : Disable
  RADIUS-server-template          : rd5
  Two-acct-template               : -
  HWTACACS-server-template        : -
  Bill Flow                       : Disable
  Tunnel-acct-2867                : Disable

  Flow Statistic:
  Flow-Statistic-Up               : Yes
  Flow-Statistic-Down             : Yes
  Source-IP-route                 : Disable
  IP-warning-threshold            : -
<span>  IPv6-warning-threshold          : -  </span>  Multicast Forwarding            : Yes
  Multicast Virtual               : No
  Max-multilist num               : 4
  Multicast-profile               : -
<span>  Multicast-profile ipv6          : - </span>  IP-address-pool-name            : <strong>pool2</strong>
  IPv6-Pool-name                  : <strong>pool1</strong>
  Quota-out                       : Offline
<span>  Service-type                    : -   User-basic-service-ip-type      : -/-/-   PPP-ipv6-address-protocol       : Ndra   IPv6-information-protocol       : Stateless dhcpv6   IPv6-PPP-assign-interfaceid     : Disable   Trigger-packet-wait-delay       : 60s   Peer-backup                     : Enable     </span>  ------------------------------------------------------------------------------
</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172374031__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Router</span> configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>
#
radius-server group rd5
 radius-server shared-key-cipher %^%#vS%796FO7%C<font style="font-size:8pt" Face="Courier New" >~</font>pB%CR=q;j}gSCqR-X6+P!.DYI@)%^%#
 radius-server authentication 10.6.55.55 1645 weight 0
 radius-server accounting 10.6.55.55 1646 weight 0
#
ip pool pool2 bas local
 gateway 10.10.10.2 255.255.255.0
 section 0 10.10.10.3 10.10.10.100
 dns-server 10.10.10.1
#
ipv6 prefix pre1 delegation
 prefix 2001:DB8:3::/48
 slaac-unshare-only
#
ipv6 pool pool1 bas delegation
 dns-server 2001:DB8:1::1
 prefix pre1
# 
user-group huawei
#
acl number 6000
 rule 5 permit ip source user-group huawei destination ip-address 10.6.55.0 0.0.0.255
 rule 10 permit ip source ip-address 10.6.55.0 0.0.0.255 destination user-group huawei
 rule 15 permit ip source user-group huawei destination ip-address 10.10.10.0 0.0.0.255
 rule 20 permit ip source ip-address 10.10.10.0 0.0.0.255 destination user-group huawei
#
acl number 6001 
 rule 5 permit tcp source user-group huawei destination-port eq www 
 rule 10 permit tcp source user-group huawei destination-port eq 8080
#
acl number 6002 match-order auto
 rule 5 permit ip source ip-address any destination user-group huawei
 rule 10 deny ip source user-group huawei destination ip-address any
#
acl ipv6 number 6000
 rule 5 permit ipv6 source user-group huawei destination ipv6-address 2001:DB8:1::2/128
 rule 10 permit ipv6 source ipv6-address 2001:DB8:1::2/128 destination user-group huawei
 rule 15 permit ipv6 source user-group huawei destination ipv6-address 2001:DB8:1::1/128
 rule 20 permit ipv6 source ipv6-address 2001:DB8:1::1/128 destination user-group huawei
#
acl ipv6 number 6001 
 rule 5 permit tcp source user-group huawei destination-port eq www 
 rule 10 permit tcp source user-group huawei destination-port eq 8080
#
acl ipv6 number 6002 
 rule 5 permit ipv6 source ipv6-address any destination user-group huawei 
 rule 10 deny ipv6 source user-group huawei destination ipv6-address any
#
dhcpv6 duid 12345678
#
traffic classifier c1 operator or
 if-match acl 6000 precedence 8
 if-match ipv6 acl 6000 precedence 21
#
traffic classifier c2 operator or
 if-match acl 6001 precedence 9
 if-match ipv6 acl 6001 precedence 23
#
traffic classifier c3 operator or
 if-match acl 6002 precedence 24
 if-match ipv6 acl 6002 precedence 25
#
traffic behavior b1
#
traffic behavior b2
 http-redirect 
#
traffic behavior b3
 deny
#
traffic policy policy
 share-mode
 classifier c1 behavior b1 precedence 1
 classifier c2 behavior b2 precedence 2
 classifier c3 behavior b3 precedence 3
#
aaa
 default-password cipher $$e:TY%^%glhJ;yPG#$=tC&amp;(Is%q!S_";(k.Ef$%^%#:978 
 #
 authentication-scheme none
  authentication-mode none
 #
 authentication-scheme auth5
 #
 authorization-scheme default
 #
 accounting-scheme none
  accounting-mode none
 #
 accounting-scheme acct5
 #
 domain domain1
  authentication-scheme none
  accounting-scheme none
  prefix-assign-mode unshared
  ip-pool pool2
  ipv6-pool pool1
  user-group huawei
  web-server 10.6.55.56 2001:DB8:1::2
  web-server url http://www.isp1.com
  web-server identical-url
 #
 domain isp5
  authentication-scheme auth5
  accounting-scheme acct5
  radius-server group rd5
#
interface <span>GigabitEthernet</span><span>0/1/2</span>
 undo shutdown
 ipv6 enable
 ipv6 address auto link-local
 bas
 #
  access-type layer2-subscriber default-domain pre-authentication domain1 authentication isp5
  authentication-method web
  authentication-method-ipv6 web
  ip-trigger
  arp-trigger
  ipv6-trigger 
  nd-trigger
 #
#
interface LoopBack0
 ipv6 enable
 ip address 10.6.55.1 255.255.255.255
 ipv6 address 2001:DB8:1::3/128
 ipv6 address auto link-local
#
web-auth-server enable
web-auth-server source interface LoopBack0
web-auth-server 10.6.55.56 port 50100 key cipher %^%#NCpW"R\7zYnsG8-}qo7*Ceh4*af%5)|*O&gt;N{kOyP%^%# 
web-auth-server 2001:DB8:1::2 port 50100 key cipher %^%#\39J9tmKl#+;)]1yEd@V#i(1Jeq"vO=9ka=-\qN&lt;%^%# 
<span>#</span>
<span>undo web-auth-server source-ip all</span>
<span>web-auth-server source-ip 10.6.55.1</span>
<span>#</span>
<span>undo web-auth-server source-ipv6 all</span>
<span>web-auth-server source-ipv6 2001:DB8:1::3</span>
#
traffic-policy policy inbound
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipox_cfg_0083.html">Configuration Examples for IPoE Access Authentication
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipoxv6_cfg_0067.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_bras_v4v6_web_mac.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>