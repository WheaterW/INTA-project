
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring BRAS Access Through L2VPN Termination">
<meta name="abstract" content="This section provides an example for configuring BRAS access through L2VPN termination.">
<meta name="description" content="This section provides an example for configuring BRAS access through L2VPN termination.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipox_cfg_0083.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_bras_v4v6_web_mac.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_014579.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,z00603461,w00800033,z00588052,ipoxne,c00549182,w00556928,l00593348,w00606909,w00447999,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPoE">
<meta name="featuretype" content="User Access">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPoE">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="IPoE">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="IPoE">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0172374043">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring BRAS Access Through L2VPN Termination</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CONCEPT_0172374043"></a><a name="EN-US_CONCEPT_0172374043"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring BRAS Access Through L2VPN Termination</h1>
<div><p>This section provides an example for configuring BRAS access through L2VPN termination.</p>
<div class="section"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_CONCEPT_0172374043__fig_dc_ne_cfg_01457801">Figure 1</a>, PE1, P, and PE2 form a VLL backbone network in LDP mode. The <span class="keyword">Router</span> functions as PE2, which is the BRAS. The BRAS user connects to the Internet through the VLL. Two virtual interfaces VE <span>0/2/9</span> and VE <span>0/2/10</span> are created on the <span class="keyword">Router</span>. VE <span>0/2/9</span> terminates the VLL service, and VE <span>0/2/10</span>.1 functions as a BAS interface for user authentication. The requirements are as follows:</p>
<ul><li><p>The user belongs to the domain <strong>isp1</strong> and connects to the Internet through VE <span>0/2/10</span>.1 as a static user with an IP address of 172.30.0.8 and a MAC address of 00e0-fc12-3456.</p>
</li><li><p>RADIUS authentication and RADIUS accounting are used. The RADIUS server address is 192.168.7.249, and the authentication and accounting port numbers are 1812 and 1813, respectively. RADIUS+1.1 is used, with the key of <strong>YsHsjx_202206</strong>.</p>
</li><li><p>The accounting and authentication schemes are <strong>acct1</strong> and <strong>auth1</strong>, respectively.</p>
</li></ul>
<div class="fignone" id="EN-US_CONCEPT_0172374043__fig_dc_ne_cfg_01457801"><a name="EN-US_CONCEPT_0172374043__fig_dc_ne_cfg_01457801"></a><a name="fig_dc_ne_cfg_01457801"></a><span class="figcap"><b>Figure 1 </b>Configuring BRAS access through L2VPN termination</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 5 in this example represent GE <span>0/2/9</span>, GE <span>0/1/0</span>, GE <span>0/2/0</span>, VE <span>0/2/9</span>, and VE <span>0/2/10</span>.1, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001401148298.png" width="NaN" height="NaN"></span></div>
<p></p>
</div>
<div class="section"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure the VE interface for terminating the VLL service and the VE interface for accessing the Internet on the <span class="keyword">Router</span>. Bind the two VE interfaces to a VE-group.</p>
</li><li><p>Configure the VLL.</p>
</li><li><p>Enable VLL access.</p>
</li><li><p>Configure BRAS access on PE2, with VE <span>0/2/10</span>.1 functioning as a BAS interface.</p>
</li></ol>
</div>
<div class="section"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>VE-group number</p>
</li><li><p>L2VPN name</p>
</li><li>OSPF parameters</li><li><p>Static user authentication mode, accounting mode, and authentication domain name</p>
</li><li>Interface IP addresses</li></ul>
</div>
<div class="section"><h4 class="sectiontitle">Configuration Procedure</h4><ol><li><p>Create two VE interfaces on PE2 and bind them to a VE-group.</p>
<p># Create VE <span>0/2/9</span> for terminating the VLL service.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface virtual-ethernet<span>0/2/9</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/9</span>]<strong> ve-group 1 l2-terminate</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/9</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Create VE <span>0/2/10</span> for accessing the Internet.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface virtual-ethernet<span>0/2/10</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/10</span>]<strong> ve-group 1 l3-access</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/10</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</li><li><p>Configure the VLL.</p>
<p># Configure an IGP (for example, OSPF) on the VLL backbone network.</p>
<p>Assign an IP address to each interface on the PEs and P. Ensure that the 32-bit loopback addresses of PE1, the P, and PE2 are advertised after OSPF is enabled.</p>
<p>The configuration details are not provided here.</p>
<p># Configure basic MPLS functions and LDP.</p>
<ul><li><p>Configure PE1.</p>
</li></ul>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> mpls lsr-id 1.1.1.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-ldp]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<ul><li><p>Configure the P.</p>
</li></ul>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname P</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P]<strong> mpls lsr-id 2.2.2.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-mpls]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-mpls-ldp]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P]<strong> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P]<strong> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/2/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/2/0</span>]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/2/0</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/2/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P]<strong> quit</strong></pre>
<ul><li><p>Configure PE2.</p>
</li></ul>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> mpls lsr-id 3.3.3.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls-ldp]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> interface gigabitethernet<span>0/2/9</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/9</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/9</span>]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/9</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/9</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
<p># Set up a remote LDP session between the PEs.</p>
<ul><li><p>Configure PE1.</p>
</li></ul>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> mpls ldp remote-peer PE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-ldp-remote-PE2]<strong> remote-ip 3.3.3.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-ldp-remote-PE2]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-mpls-ldp-remote-PE2]<strong> quit</strong></pre>
<ul><li><p>Configure PE2.</p>
</li></ul>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> mpls ldp remote-peer PE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls-ldp-remote-PE1]<strong> remote-ip 1.1.1.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls-ldp-remote-PE1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-mpls-ldp-remote-PE1]<strong> </strong><strong>quit</strong></pre>
<p># Enable VLL on the PEs and create static VCs.</p>
<ul><li><p>Create an L2VC on PE1's GE <span>0/2/9</span>.1 that connects to the CE.</p>
</li></ul>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-l2vpn]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> interface gigabitethernet <span>0/2/9</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/9</span>.1]<strong> vlan-type dot1q 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/9</span>.1]<strong> mpls l2vc 3.3.3.9 101</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/9</span>.1]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/9</span>.1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> commit</strong></pre>
<ul><li><p>Create an L2VC on PE2's VE <span>0/2/9</span>.1.</p>
</li></ul>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-l2vpn]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface virtual-ethernet<span>0/2/9</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/9</span>.1]<strong> vlan-type dot1q 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/9</span>.1]<strong> mpls l2vc 1.1.1.9 101</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/9</span>.1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
<p># Verify the configuration.</p>
<p>Check the L2VPN connection information on the PEs. The command output on each PE shows that an L2VC has been set up and is in the Up state.</p>
<p>The following example uses the command output on PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> display mpls l2vc</strong>
  Total LDP VC : 1     0 up       1 down
  *client interface     : Virtual-Ethernet<span>0/2/9</span>.1 is up
  Administrator PW       : no 
  session state          : down
  AC status              : up
  VC state               : down
  Label state            : 0
  Token state            : 0
  VC ID                  : 101
  VC type                : VLAN
  destination            : 1.1.1.9
  local VC label         : 65665        remote VC label      : 0
  control word           : disable
  remote control word    : none
  forwarding entry       : not exist
  local group ID         : 0
  remote group ID        : 0
  local AC OAM State     : up
  local PSN OAM State    : up
  local forwarding state : not forwarding
  local status code      : 0x1 (not-forwarding)
  BFD for PW             : unavailable
  VCCV State             : up
  manual fault           : not set
  active state           : inactive
  OAM Protocol           : --
  OAM Status             : --
  OAM Fault Type         : --
  PW APS ID              : --
  PW APS Status          : --
  TTL Value              : 1
  link state             : down
  local VC MTU           : 1500         remote VC MTU        : 0
  local VCCV             : alert ttl lsp-ping bfd 
  remote VCCV            : none
  tunnel policy name     : -- 
  PW template name       : --  
  primary or secondary   : primary
  load balance type      : flow
  Access-port            : false
  Switchover Flag        : false
  VC tunnel info         : 0 tunnels 
  create time            : 0 days, 0 hours, 0 minutes, 17 seconds  
  up time                : 0 days, 0 hours, 0 minutes, 0 seconds
  last change time       : 0 days, 0 hours, 0 minutes, 17 seconds
  VC last up time        : 0000/00/00 00:00:00
  VC total up time       : 0 days, 0 hours, 0 minutes, 0 seconds
  CKey                   : 1
  NKey                   : 16782958
  PW redundancy mode     : frr
  AdminPw interface      : --
  AdminPw link state     : --
  Forward state          : send inactive, receive inactive
  Diffserv Mode          : uniform
  Service Class          : --
  Color                  : --
  DomainId               : --
  Domain Name            : --</pre>
</li><li><p>Configure BRAS access on PE2. Configure VE <span>0/2/10</span>.1 as a BAS interface to provide Internet access services for users.</p>
<p># Configure a username generation mode and a user password.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> aaa</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-aaa]<strong> default-user-name include sysname</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-aaa]<strong> default-password cipher YsHsjx_202206</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa]<strong> commit</strong></pre>
<p># Configure an authentication scheme.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-aaa]<strong> authentication-scheme auth1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa-authen-auth1]<strong> authentication-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa-authen-auth1]<strong> </strong><strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-aaa-authen-auth1]<strong> </strong><strong>quit</strong></pre>
<p># Configure an accounting scheme.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-aaa]<strong> accounting-scheme acct1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa-accounting-acct1]<strong> accounting-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa-accounting-acct1]<strong> </strong><strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-aaa-accounting-acct1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-aaa]<strong> quit</strong></pre>
<p># Configure a RADIUS server group.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> radius-server group rd1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-radius-rd1]<strong> radius-server authentication 192.168.7.249 1812</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-radius-rd1]<strong> radius-server accounting 192.168.7.249 1813</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-radius-rd1]<strong> </strong><strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-radius-rd1]<strong> radius-server type plus11</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-radius-rd1]<strong> radius-server shared-key-cipher YsHsjx_202206</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-radius-rd1]<strong> </strong><strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-radius-rd1]<strong> </strong><strong>quit</strong></pre>
<p># Configure a local address pool. </p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> ip pool pool1 bas local</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ip-pool-pool1]<strong> gateway 172.30.1.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ip-pool-pool1]<strong> </strong><strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-ip-pool-pool1]<strong> section 0 172.30.1.2 172.30.1.200</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-ip-pool-pool1] <strong>excluded-ip-address 172.30.1.8</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ip-pool-pool1]<strong> </strong><strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-ip-pool-pool1]<strong> </strong><strong>quit</strong></pre>
<p># Configure a domain named <strong>isp1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>aaa</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-aaa]<strong> domain isp1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa-domain-isp1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-aaa-domain-isp1]<strong> authentication-scheme auth1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa-domain-isp1]<strong> accounting-scheme acct1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa-domain-isp1]<strong> radius-server group rd1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa-domain-isp1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
<p># Configure a BAS interface.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> interface virtual-ethernet<span>0/2/10</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/10</span>.1]<strong> commit </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Virtual-Ethernet<span>0/2/10</span>.1]<strong> user-vlan 1 </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Virtual-Ethernet<span>0/2/10</span>.1.1-vlan-1-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Virtual-Ethernet<span>0/2/10</span>.1] <strong>bas</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Virtual-Ethernet<span>0/2/10</span>.1-bas]<strong> access-type layer2-subscriber</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/10</span>.1-bas]<strong> authentication-method bind</strong>
[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/10</span>.1-bas]<strong> default-domain authentication isp1</strong>
[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/10</span>.1-bas]<strong> ip-trigger</strong>
[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/10</span>.1-bas]<strong> arp-trigger</strong>
[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/10</span>.1-bas] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Virtual-Ethernet<span>0/2/10</span>.1-bas]<strong> quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Virtual-Ethernet<span>0/2/10</span>.1]<strong> quit</strong></pre>
<div class="p"># Configure a static user.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> static-user 172.30.1.8 172.30.1.8 gateway 172.30.1.1 domain-name </strong><strong>isp1</strong></pre>
</div>
<p># Configure an upstream interface.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>]<strong> ip address 10.3.1.2 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>]<strong> </strong><strong>commit</strong></pre>
</li></ol>
</div>
<div class="section"><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#
sysname PE1
#
mpls lsr-id 1.1.1.9
#
mpls
#
mpls l2vpn
#
mpls ldp
#
mpls ldp remote-peer PE2
 remote-ip 3.3.3.9
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.1.1 255.255.255.0
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/2/9</span>
 undo shutdown
#
interface GigabitEthernet<span>0/2/9</span>.1
 vlan-type dot1q 1
 mpls l2vc 3.3.3.9 101
#
interface LoopBack1
 ip address 1.1.1.9 255.255.255.255
#
ospf 1
 area 0.0.0.0
  network 1.1.1.9 0.0.0.0
  network 10.1.1.0 0.0.0.255  
#
return</pre>
</li></ul>
<ul><li><p>P configuration file</p>
<pre class="screen">#
sysname P
#
mpls lsr-id 2.2.2.9
#
mpls
#
mpls ldp
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.1.2 255.255.255.0
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.2.1.1 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 2.2.2.9 255.255.255.255
#
ospf 1
 area 0.0.0.0
  network 2.2.2.9 0.0.0.0
  network 10.1.1.0 0.0.0.255
  network 10.2.1.0 0.0.0.255
#
return</pre>
</li></ul>
<ul><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2
#
radius-server group rd1
 radius-server shared-key-cipher %^%#`E)v.Q@BHVzxxZ;ij{&gt;&amp;_M0!TGP7YRA@8a7mq&lt;\/%^%#
 radius-server authentication 192.168.7.249 1645 weight 0
 radius-server accounting 192.168.7.249 1646 weight 0
 radius-server type plus11
#
mpls lsr-id 3.3.3.9
#
mpls
#
mpls l2vpn
#
mpls ldp
#
mpls ldp remote-peer PE1
 remote-ip 1.1.1.9
#  
ip pool pool1 bas local
 gateway 172.30.1.1 255.255.255.0
 section 0 172.30.1.2 172.30.1.200
 excluded-ip-address 172.30.1.8
#
aaa
 default-password cipher %^%#oNUw%i-|"WcBgt8=fSVID7F&lt;=K_N+.(ip[H\:a{D%^%#
 default-user-name include sysname
 #
 authentication-scheme auth1
 #
 accounting-scheme acct1
 #
 domain isp1
  authentication-scheme auth1
  accounting-scheme acct1
  radius-server group rd1
  ip-pool pool1
#
interface GigabitEthernet<span>0/1/0</span>
 ip address 10.3.1.2 255.255.255.0
#  
interface GigabitEthernet<span>0/2/9</span>
 ip address 10.2.1.2 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 3.3.3.9 255.255.255.255
#
interface Virtual-Ethernet<span>0/2/9</span>
 ve-group 1 l2-terminate
#  
interface Virtual-Ethernet<span>0/2/9</span>.1
 vlan-type dot1q 1
 mpls l2vc 1.1.1.9 101
#
interface Virtual-Ethernet<span>0/2/10</span>
 ve-group 1 l3-access
#
interface Virtual-Ethernet<span>0/2/10</span>.1
 user-vlan 1 
 bas
 #
  access-type layer2-subscriber
  authentication-method bind
  ip-trigger
  arp-trigger
 #
#
ospf 1
 area 0.0.0.0
  network 3.3.3.9 0.0.0.0
  network 10.2.1.0 0.0.0.255
#
static-user 172.30.1.8 172.30.1.8 gateway 172.30.1.1 domain-name isp1
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipox_cfg_0083.html">Configuration Examples for IPoE Access Authentication
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_bras_v4v6_web_mac.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_014579.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>