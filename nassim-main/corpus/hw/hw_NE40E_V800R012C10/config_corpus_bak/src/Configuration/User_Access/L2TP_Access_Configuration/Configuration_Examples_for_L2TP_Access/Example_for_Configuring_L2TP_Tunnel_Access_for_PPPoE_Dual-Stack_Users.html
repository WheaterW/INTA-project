
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring L2TP Tunnel Access for PPPoE Dual-Stack Users">
<meta name="abstract" content="This section provides an example for configuring L2TP tunnel access for PPPoE dual-stack users. A networking diagram is provided to help you understand the configuration procedure. The configuration example includes the networking requirements, configuration roadmap, configuration procedure, and configuration files.">
<meta name="description" content="This section provides an example for configuring L2TP tunnel access for PPPoE dual-stack users. A networking diagram is provided to help you understand the configuration procedure. The configuration example includes the networking requirements, configuration roadmap, configuration procedure, and configuration files.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_013506.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_014415.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_014417.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00588052,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="L2TP">
<meta name="featuretype" content="User Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="L2TP">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="L2TP">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="L2TP">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0204897238">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring L2TP Tunnel Access for PPPoE Dual-Stack Users</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0204897238"></a><a name="EN-US_TASK_0204897238"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring L2TP Tunnel Access for PPPoE Dual-Stack Users</h1>
<div class="taskbody"><p>This section provides an example for configuring L2TP tunnel access for PPPoE dual-stack users. A networking diagram is provided to help you understand the configuration procedure. The configuration example includes the networking requirements, configuration roadmap, configuration procedure, and configuration files. </p>
<div class="context"><a name="EN-US_TASK_0204897238__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0204897238__p21951554195113">Figure1 Configuring L2TP tunnel access for PPPoE dual-stack users</a>, a point-to-point L2TP tunnel is established on a public network. PPP data frames are encapsulated as L2TP packets, which are then transmitted over the L2TP tunnel. The LAC and LNS reside on a WAN and communicate with each other through the L2TP tunnel. Both the LAC and LNS implement RADIUS authentication on the username and password of a user. An IPv6 address, ND prefix, PD prefix, and the DNS server's IPv6 address must be configured on the LNS. After remote users access the public network, they can access internal network resources over the L2TP tunnel. This provides a secure and cost-effective way for remote users to access a private enterprise network.</p>
<div class="fignone"><span class="figcap"><b>Figure 1 </b>Configuring L2TP tunnel access for PPPoE dual-stack users</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interface1 connecting the LAC to the tunnel represents GE<span>0/1/0</span>, and its IP address is 10.38.160.1. Interface1 connecting the LNS to the tunnel represents GE<span>0/1/0</span>, and its IP address is 10.38.160.2. Interface2 connecting the LAC to the remote user's private enterprise network is GE<span>0/2/0</span>.</p>
</div></div>
<p id="EN-US_TASK_0204897238__p21951554195113"><a name="EN-US_TASK_0204897238__p21951554195113"></a><a name="p21951554195113"></a><span><img class="vsd" src="figure/en-us_image_0206300925.png"></span></p>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0204897238__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure the LAC.</p>
<ul><li>Configure an interface address for the LAC.</li><li>Enable L2TP.</li><li>Configure an L2TP tunnel connection on the LAC.</li><li>Configure a tunnel authentication mode.</li><li>Configure the PPPoE access service for the LAC.</li></ul>
</li><li><p>Configure the LNS.</p>
<ul><li>Configure an interface address for the LNS and enable IPv6 on the interface.</li><li>Configure a VT.</li><li>Enable L2TP.</li><li>Configure an L2TP tunnel connection on the LNS.</li><li>Configure a tunnel authentication mode and user authentication mode.</li><li>Configure LNS-side tunnel parameters.</li><li>Configure the DHCPv6 device to generate DUIDs in DUID-LLT mode.</li><li>Configure address pools, including a local IPv4 address pool and an IPv6 delegation prefix pool.</li><li>Configure an L2TP user domain and specify address pools in the domain.</li><li>Configure a RADIUS server.</li></ul>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0204897238__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Identical domain names, usernames, and passwords on the LAC and LNS</p>
</li><li><p>LNS-side tunnel authentication mode (CHAP is used in this example) and tunnel password</p>
</li><li><p>LNS-side local and remote tunnel names</p>
</li><li><p>VT number</p>
</li><li><p>L2TP group ID</p>
</li><li><p>Names and address ranges of address pools</p>
</li><li>AAA domain name</li><li>User authentication mode on <span class="keyword">Device</span>A (RADIUS authentication)</li><li>User authentication mode on <span class="keyword">Device</span>B (RADIUS authentication)</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0204897238__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure <span class="keyword">Device</span>A that functions as the LAC.</span><p><p># Assign an IP address to GE <span>0/1/0</span>.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> sysname <span class="keyword">Device</span>A</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>ip address 10.38.160.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<p># Enable basic L2TP functions and configure an L2TP connection on the LAC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>l2tp enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> l2tp-group group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-l2tp-group1]<strong> tunnel name LAC</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-l2tp-group1]<strong> start l2tp ip 10.38.160.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-l2tp-group1]<strong> tunnel source gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-l2tp-group1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-l2tp-group1] <strong>quit</strong></pre>
<p># Configure a tunnel authentication mode.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-l2tp-group1] <strong>tunnel authentication</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-l2tp-group1] <strong>tunnel password cipher YsHsjx_202206</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-l2tp-group1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-l2tp-group1]<strong> quit</strong></pre>
<p># Configure the PPPoE access service.</p>
<ol type="a"><li>Configure AAA schemes.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> aaa</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa]<strong> </strong><strong>accounting-scheme radius1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-accounting-radius1]<strong> </strong><strong>authentication-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-accounting-radius1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-accounting-radius1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa]<strong> </strong><strong>authentication-scheme radius1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-authen-radius1]<strong> </strong><strong>authentication-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-authen-radius1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-authen-radius]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa]<strong> </strong><strong>quit</strong></pre>
</li><li>Configure a RADIUS server group.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>radius-server group radius1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-radius-radius1] <strong>radius-server authentication 10.20.20.1 1812</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-radius-radius1] <strong>radius-server accounting 10.20.20.1 1813</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-radius-radius1] <strong>radius-server shared-key itellin</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-radius-radius1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-radius-radius1] <strong>quit</strong></pre>
</li><li>Configure a user access domain.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>aaa</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa]<strong> domain huawei.com</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-huawei.com] <strong>authentication-scheme radius1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-huawei.com] <strong>accounting-scheme radius1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-huawei.com] <strong>radius-server group radius1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-huawei.com] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-huawei.com] <strong>idle-cut 50 600</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-domain-huawei.com] <strong>l2tp-group group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-huawei.com] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-domain-huawei.com] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa] <strong>quit</strong></pre>
</li><li>Configure a VT.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> interface virtual-template 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Virtual-Template1]<strong> ppp authentication-mode chap</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Virtual-Template1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-Virtual-Template1]<strong> quit</strong></pre>
</li><li>Bind the VT1 to GE<span>0/2/0</span>.100.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface gigabitethernet <span>0/2/0</span>.100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>.100] <strong>pppoe-server bind virtual-template 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>.100] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>.100] <strong>user-vlan 1 100</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>.100-vlan-1-100] <strong>quit</strong></pre>
</li><li>Configure a BAS interface.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>.100]<strong> bas</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>.100-bas]<strong> access-type layer2-subscriber default-domain authentication huawei.com</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>.100-bas]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>.100-bas]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>.100]<strong> quit</strong></pre>
</li></ol>
</p></li><li><span>Configure DeviceB that functions as the LNS.</span><p><p># Assign an IP address to the interface connecting the LNS to the tunnel and enable IPv6 on the interface.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> sysname <span class="keyword">Device</span>B</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-gigabitethernet<span>0/1/0</span>]<strong> ip address 10.38.160.2 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-gigabitethernet<span>0/1/0</span>] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-gigabitethernet<span>0/1/0</span>] <strong>ipv6 address auto link-local</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-gigabitethernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-gigabitethernet<span>0/1/0</span>] <strong>quit</strong></pre>
<p># Configure a VT and specify the tunnel authentication mode.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> interface virtual-template 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-Virtual-Template1] <strong>ppp authentication-mode chap</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-Virtual-Template1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-Virtual-Template1]<strong> quit</strong></pre>
<p># Enable L2TP.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>l2tp enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> l2tp-group group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
<p># Configure the local tunnel name and peer tunnel name on the LNS side.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-l2tp-group1] <strong>tunnel name LNS</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-l2tp-group1]<strong> allow l2tp virtual-template 1 remote LAC</strong></pre>
<p># Enable tunnel authentication and configure a tunnel authentication password.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-l2tp-group1] <strong>tunnel authentication</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-l2tp-group1] <strong>tunnel password cipher YsHsjx_202206</strong></pre>
<p># Configure the LNS to perform mandatory CHAP authentication.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-l2tp-group1]<strong> mandatory-chap</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-l2tp-group1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-l2tp-group1]<strong> quit</strong></pre>
<div class="p"># Configure an LNS group named <strong>group1</strong>.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> lns-group group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-lns-group-group1]<strong> bind slot <span>1</span> </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-lns-group-group1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-lns-group-group1]<strong> bind source gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-lns-group-group1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-lns-group-group1]<strong> quit</strong></pre>
</div>
<div class="p"># Configure the DHCPv6 device to generate DUIDs in DUID-LLT mode.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> </strong><strong>dhcpv6 duid llt</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> commit</strong></pre>
</div>
<p># Configure address pools.</p>
<ol type="a"><li>Configure an IPv6 delegation prefix pool named <strong>pre1</strong> for ND users.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ipv6 prefix pre1 delegation</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-prefix-pre1] <strong>prefix</strong> <strong>2001:db8:1::/48</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-prefix-pre1] <strong>slaac-unshare-only </strong> </pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-prefix-pre1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ipv6-prefix-pre1] <strong>quit</strong></pre>
</li><li>Configure an IPv6 delegation prefix pool named <strong>pre2</strong> for PD users.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ipv6 prefix pre2 delegation</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-prefix-pre2] <strong>prefix 2001:db8:10::/44</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-prefix-pre2] <strong>pd-unshare-only </strong> </pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-prefix-pre2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ipv6-prefix-pre2] <strong>quit</strong></pre>
</li><li>Configure an IPv6 delegation address pool named <strong>pool1</strong> and bind it to the IPv6 delegation prefix pool <strong>pre1</strong>.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ipv6 pool pool1 bas delegation</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-pool-pool1] <strong>prefix pre1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-pool-pool1] <strong>dns-server 2001:db8::1 2001:db8::2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-pool-pool1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ipv6-pool-pool1] <strong>quit</strong></pre>
</li><li>Configure an IPv6 delegation address pool named <strong>pool2</strong> and bind it to the IPv6 delegation prefix pool <strong>pre2</strong>.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ipv6 pool pool2 bas delegation</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-pool-pool2] <strong>prefix pre2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-pool-pool2] <strong>dns-server 2001:db8::1 2001:db8::2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ipv6-pool-pool2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ipv6-pool-pool2] <strong>quit</strong></pre>
</li><li>Configure a local IPv4 address pool named <strong>pppoe-pool</strong>.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ip pool pppoe-pool bas local</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ip-pool-pppoe-pool] <strong>gateway 10.179.180.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ip-pool-pppoe-pool] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ip-pool-pppoe-pool] <strong>section 0 10.179.180.2 10.179.180.254</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ip-pool-pppoe-pool] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ip-pool-pppoe-pool] <strong>quit</strong></pre>
</li></ol>
<p># Configure a RADIUS server group.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>radius-server group radius1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-radius-radius1] <strong>radius-server authentication 10.20.20.1 1812</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-radius-radius1] <strong>radius-server accounting 10.20.20.1 1813</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-radius-radius1] <strong>radius-server shared-key itellin</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-radius-radius1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-radius-radius1] <strong>quit</strong></pre>
<p># Configure a user access domain.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>aaa</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-aaa] <strong>accounting-scheme radius1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa-accounting-radius1]<strong> </strong><strong>authentication-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa-accounting-radius1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-aaa-accounting-radius1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-aaa] <strong>authentication-scheme radius1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa-authen-local1] <strong>authentication-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa-authen-local1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa] <strong> domain huawei.com</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa-domain-huawei.com] <strong>authentication-scheme radius1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa-domain-huawei.com] <strong>accounting-scheme radius1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa-domain-huawei.com] <strong>radius-server group radius1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa-domain-huawei.com] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-aaa-domain-huawei.com] <strong>ip-pool pppoe-pool</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa-domain-huawei.com] <strong>ipv6-pool pool1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa-domain-huawei.com] <strong>ipv6-pool pool2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-aaa-domain-huawei.com] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-aaa-domain-huawei.com] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-aaa] <strong>quit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0204897238__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span>A configuration file</p>
</li></ul>
<pre class="screen">#</pre>
<pre class="screen"> sysname <span class="keyword">Device</span>A</pre>
<pre class="screen">#</pre>
<pre class="screen"> l2tp enable</pre>
<pre class="screen">#</pre>
<pre class="screen">radius-server group radius1</pre>
<pre class="screen"> radius-server authentication 10.20.20.1 1812 </pre>
<pre class="screen"> radius-server accounting 10.20.20.1 1813 </pre>
<pre class="screen"> radius-server shared-key %^%#vS%796FO7%C<font style="font-size:8pt" Face="Courier New" >~</font>pB%CR=q;j}gSCqR-X6+P!.DYI@)%^% </pre>
<pre class="screen">#</pre>
<pre class="screen">interface Virtual-Template1</pre>
<pre class="screen">ppp authentication-mode chap</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span>.100</pre>
<pre class="screen"> pppoe-server bind Virtual-Template 1</pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> user-vlan 1 100</pre>
<pre class="screen"> bas</pre>
<pre class="screen">  access-type layer2-subscriber default-domain authentication huawei.com</pre>
<pre class="screen">#</pre>
<pre class="screen">interface gigabitethernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.38.160.1 255.255.255.0</pre>
<pre class="screen">#</pre>
<pre class="screen">l2tp-group group1</pre>
<pre class="screen"> tunnel password cipher %@%##!!!!!!!!!"!!!!"!!!!(!!!!1];16qfZ81fv"uMoKKZ.1k"`AO!X2K2N.b<font style="font-size:8pt" Face="Courier New" >~</font>'NB^V!!!!!!!!!!1!!!!o/4J(q"J1F.!K9%M!6x8%@%#</pre>
<pre class="screen"> tunnel name LAC</pre>
<pre class="screen"> start l2tp ip 10.38.160.2</pre>
<pre class="screen"> tunnel source gigabitethernet <span>0/1/0</span></pre>
<pre class="screen">#</pre>
<pre class="screen">local-aaa-server</pre>
<pre class="screen"> user vpdnuser@huawei.com password cipher %@%##!!!!!!!!!"!!!!"!!!!(!!!!1];16qfZ81wtNj:ej5XU&gt;Jf_&lt;1a"!)dspWPNxp5I!!!!!!!!!!1!!!!*M%{F9=pQ/,YelLM6Ad;%@%# authentication-type p</pre>
<pre class="screen">#</pre>
<pre class="screen">aaa</pre>
<pre class="screen"> #</pre>
<pre class="screen">  accounting-scheme radius1</pre>
<pre class="screen"> #</pre>
<pre class="screen">  accounting-scheme radius1  </pre>
<pre class="screen"> #</pre>
<pre class="screen">  radius-server group radius</pre>
<pre class="screen"> #</pre>
<pre class="screen">  domain huawei.com</pre>
<pre class="screen">   authentication-scheme radius1</pre>
<pre class="screen">   accounting-scheme radius1</pre>
<pre class="screen">   radius-server group radius1</pre>
<pre class="screen">   idle-cut 50 600</pre>
<pre class="screen">   l2tp-group group1</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
<ul><li><p><span class="keyword">Device</span>B configuration file</p>
</li></ul>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>B</pre>
<pre class="screen">#</pre>
<pre class="screen">l2tp enable</pre>
<pre class="screen">#</pre>
<pre class="screen">radius-server group radius1</pre>
<pre class="screen"> radius-server authentication 10.20.20.1 1812 </pre>
<pre class="screen"> radius-server accounting 10.20.20.1 1813 </pre>
<pre class="screen"> radius-server shared-key %^%#vS%796FO7%C<font style="font-size:8pt" Face="Courier New" >~</font>pB%CR=q;j}gSCqR-X6+P!.DYI@)%^% </pre>
<pre class="screen">#</pre>
<pre class="screen">dhcpv6 duid 0001000124fbc193dc99141ea1e9</pre>
<pre class="screen">#</pre>
<pre class="screen">interface gigabitethernet<span>0/1/0</span></pre>
<pre class="screen">undo shutdown</pre>
<pre class="screen">ip address 10.38.160.2 255.255.255.0</pre>
<pre class="screen">ipv6 enable</pre>
<pre class="screen">ipv6 address auto link-local</pre>
<pre class="screen">#</pre>
<pre class="screen">interface Virtual-Template1</pre>
<pre class="screen">ppp authentication-mode chap</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack0</pre>
<pre class="screen"> ip address 192.168.10.1 255.255.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">l2tp-group group1</pre>
<pre class="screen">mandatory-chap</pre>
<pre class="screen">allow l2tp virtual-template 1 remote LAC</pre>
<pre class="screen">tunnel password cipher %@%##!!!!!!!!!"!!!!"!!!!(!!!!1];16qfZ81fv"uMoKKZ.1k"`AO!X2K2N.b<font style="font-size:8pt" Face="Courier New" >~</font>'NB^V!!!!!!!!!!1!!!!o/4J(q"J1F.!K9%M!6x8%@%#  1qaz#EDC</pre>
<pre class="screen">tunnel name LNS</pre>
<pre class="screen">#</pre>
<pre class="screen">lns-group group1</pre>
<pre class="screen">bind slot <span>1</span> </pre>
<pre class="screen">bind source gigabitethernet<span>0/1/0</span></pre>
<pre class="screen">#</pre>
<pre class="screen">ip pool pppoe-pool bas local</pre>
<pre class="screen"> gateway 10.179.180.1 255.255.255.0</pre>
<pre class="screen"> section 0 10.179.180.2 10.179.180.254</pre>
<pre class="screen">#</pre>
<pre class="screen">ipv6 prefix pre1 delegation</pre>
<pre class="screen"> prefix 2001:db8:1::/48</pre>
<pre class="screen"> slaac-unshare-only</pre>
<pre class="screen">#</pre>
<pre class="screen">ipv6 prefix pre2 delegation</pre>
<pre class="screen"> prefix 2001:db8:10::/44</pre>
<pre class="screen"> pd-unshare-only  </pre>
<pre class="screen">#</pre>
<pre class="screen">ipv6 pool pool1 bas delegation</pre>
<pre class="screen"> prefix pre1</pre>
<pre class="screen"> dns-server 2001:db8::1 2001:db8::2</pre>
<pre class="screen">#</pre>
<pre class="screen">ipv6 pool pool2 bas delegation</pre>
<pre class="screen"> prefix pre2</pre>
<pre class="screen"> dns-server 2001:db8::1 2001:db8::2</pre>
<pre class="screen">#</pre>
<pre class="screen">aaa</pre>
<pre class="screen">#</pre>
<pre class="screen"> #</pre>
<pre class="screen">  authentication-scheme radius1</pre>
<pre class="screen"> #</pre>
<pre class="screen">  accounting-scheme radius1</pre>
<pre class="screen"> #</pre>
<pre class="screen">  domain huawei.com</pre>
<pre class="screen">   authentication-scheme radius1</pre>
<pre class="screen">   accounting-scheme radius1</pre>
<pre class="screen">   radius-server group radius1</pre>
<pre class="screen">   ip-pool pppoe-pool</pre>
<pre class="screen">   ipv6-pool pool1</pre>
<pre class="screen">   ipv6-pool pool2</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_013506.html">Configuration Examples for L2TP Access
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_014415.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_014417.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>