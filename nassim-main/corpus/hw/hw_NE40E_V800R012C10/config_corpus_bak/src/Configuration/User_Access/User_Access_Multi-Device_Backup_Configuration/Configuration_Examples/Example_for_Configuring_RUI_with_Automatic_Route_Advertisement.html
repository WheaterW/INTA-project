
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring RUI with Automatic Route Advertisement">
<meta name="abstract" content="This section describes an example for configuring RUI with automatic route advertisement.">
<meta name="description" content="This section describes an example for configuring RUI with automatic route advertisement.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0050.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0058.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0053.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,w00800033,z00588052,l00593348,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="UP Multi-Device Backup">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="UP Multi-Device Backup">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="UP Multi-Device Backup">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="l00593348">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172374401">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring RUI with Automatic Route Advertisement</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172374401"></a><a name="EN-US_TASK_0172374401"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring RUI with Automatic Route Advertisement</h1>
<div class="taskbody"><p>This section describes an example for configuring RUI with automatic route advertisement.</p>
<div class="context"><a name="EN-US_TASK_0172374401__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0172374401__fig_dc_ne_cfg_rui_001801">Figure 1</a>, users access <span class="keyword">Device</span> A and <span class="keyword">Device</span> B through a LAN switch. The two devices run VRRP to determine the master and backup status. Basic user access functions are configured on <span class="keyword">Device</span> A and <span class="keyword">Device</span> B, allowing the users to go online through the master device.</p>
<p>Enabling an address pool to advertise routes involves complex configuration of costs and route-policies if the configuration is performed manually. Furthermore, in dual-device hot backup scenarios, routes cannot be automatically advertised if both devices fail one after the other, nor can they be promptly advertised after a device recovers, resulting in reduced reliability of the entire link. The default cost value can be used to control the route priority. In dual-device hot backup scenarios, the cost value of the UNR imported by a routing protocol is trusted to ensure that the host route has a higher priority.</p>
<p>To improve link utilization, allow a VRRP group to transmit user packets with odd MAC addresses and another VRRP group to transmit user packets with even MAC addresses to load-balance user packets between <span class="keyword">Device</span> A and <span class="keyword">Device</span> B.</p>
<div class="fignone" id="EN-US_TASK_0172374401__fig_dc_ne_cfg_rui_001801"><a name="EN-US_TASK_0172374401__fig_dc_ne_cfg_rui_001801"></a><a name="fig_dc_ne_cfg_rui_001801"></a><span class="figcap"><b>Figure 1 </b>RUI with automatic route advertisement</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 3 in this example represent GE <span>0/1/0</span>, GE <span>0/2/0</span> and GE <span>0/3/0</span> respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_ne_cfg_rui_001802.png" width="NaN" height="NaN"></span><div class="tableBorder"><table cellpadding="4" cellspacing="0" summary=""><tr><td valign="top"><p><strong>Device</strong></p>
</td>
<td valign="top"><p><strong>Interface</strong></p>
</td>
<td valign="top"><p><strong>IP Address</strong></p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span> A</p>
</td>
<td valign="top"><p>GE <span>0/1/0</span></p>
</td>
<td valign="top"><p>10.0.1.1/24</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span> A</p>
</td>
<td valign="top"><p>GE <span>0/2/0</span></p>
</td>
<td valign="top"><p>10.0.0.1/24</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span> A</p>
</td>
<td valign="top"><p>GE <span>0/3/0</span></p>
</td>
<td valign="top"><p>10.1.1.6/24</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span> A</p>
</td>
<td valign="top"><p>Loopback0</p>
</td>
<td valign="top"><p>1.1.1.1/32</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span> A</p>
</td>
<td valign="top"><p>Loopback1</p>
</td>
<td valign="top"><p>22.22.22.22/32</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span> B</p>
</td>
<td valign="top"><p>GE <span>0/1/0</span></p>
</td>
<td valign="top"><p>10.0.1.2/24</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span> B</p>
</td>
<td valign="top"><p>GE <span>0/2/0</span></p>
</td>
<td valign="top"><p>10.0.2.1/24</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span> B</p>
</td>
<td valign="top"><p>GE <span>0/3/0</span></p>
</td>
<td valign="top"><p>10.1.1.7/24</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span> B</p>
</td>
<td valign="top"><p>Loopback0</p>
</td>
<td valign="top"><p>2.2.2.2/32</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span> B</p>
</td>
<td valign="top"><p>Loopback1</p>
</td>
<td valign="top"><p>88.88.88.88/32</p>
</td>
</tr>
</table></div>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172374401__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure basic user access functions and ensure that the two devices for backup have the same configuration. For details, see "User Access" in <em><span class="keyword">HUAWEI NE40E-M2 series</span><span class="keyword">Universal Service Router</span> Configuration Guide</em>.</p>
</li><li><p>Establish a multi-device backup platform.</p>
</li><li><p>Set NAS parameters and a traffic backup interval (or traffic threshold).</p>
</li><li><p>Configure a protection path for returned network-side traffic.</p>
</li><li><p>Bind an RBP to an interface through which the user goes online.</p>
</li><li><p>Enable a routing protocol to trust UNR cost values.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172374401__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>VRRP ID</p>
</li><li><p>Interface IP addresses of <span class="keyword">Router</span>s that back up each other</p>
</li><li><p>Backup ID, which works together with an RBS to identify an RBP to which users belong</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172374401__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Establish a multi-device backup platform. The configuration on <span class="keyword">Device</span> A is used as an example. The configuration on <span class="keyword">Device</span> B is similar to that on <span class="keyword">Device</span> A.</span><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, only RUI-related configuration is described.</p>
</div></div>
<p># Configure BFD sessions named <strong>bfd</strong> and <strong>bfd2</strong> at the access side to rapidly detect faults in interfaces or links of two VRRP groups and trigger a master/backup VRRP switchover if a fault occurs. Set the peer IP addresses for BFD sessions to 10.0.1.2 (IP address of <span class="keyword">Device</span> B's GE <span>0/1/0</span>.2) and 10.0.0.2 (IP address of <span class="keyword">Device</span> B's GE <span>0/1/0</span>.3).</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> bfd </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd]<strong> quit </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> bfd bfd bind peer-ip 10.0.1.2 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-bfd]<strong> discriminator local 1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-bfd]<strong> discriminator remote 2 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-bfd]<strong> commit </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-bfd-session-bfd]<strong> quit </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> bfd bfd2 bind peer-ip 10.0.0.2 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-bfd2]<strong> discriminator local 3 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-bfd2]<strong> discriminator remote 4 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-bfd2]<strong> commit </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-bfd-session-bfd2]<strong> quit </strong></pre>
<p># Configure a VRRP group on GE <span>0/1/0</span>.2 and another one on GE <span>0/1/0</span>.3, and enable each VRRP group to track a specific BFD session and the network-side interface status.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> interface gigabitethernet <span>0/1/0</span>.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> vlan-type dot1q 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> ip address 10.0.1.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> vrrp vrid 1 virtual-ip 10.0.1.100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> admin-vrrp vrid 1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> vrrp vrid 1 priority 120</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> </strong><strong>vrrp vrid 1 preempt-mode timer delay 600</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> vrrp vrid 1 track bfd-session session-name bfd peer</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> vrrp vrid 1 track interface gigabitethernet <span>0/2/0</span> reduced 50</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> commit </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> interface gigabitethernet <span>0/1/0</span>.3 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.3]<strong> vlan-type dot1q 201</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.3]<strong> ip address 10.10.0.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.3]<strong> vrrp vrid 2 virtual-ip 10.0.0.100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.3]<strong> admin-vrrp vrid 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.3]<strong> vrrp vrid 2 priority 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.3]<strong> vrrp vrid 2 track bfd-session session-name bfd2 peer</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.3]<strong> commit </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.3]<strong> quit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Different priorities must be configured for devices in a VRRP group. The device with a higher priority functions as the master device.</p>
</div></div>
<p># Configure an RBS.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> remote-backup-service service1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-srv-service1]<strong> peer 88.88.88.88 source 22.22.22.22 port 2046 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-srv-service1]<strong> track interface gigabitethernet <span>0/2/0</span> </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-srv-service1]<strong> commit </strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>You can run the <strong>track bfd-session</strong> command in the RBS view to track the peer BFD sessions established on the network side of the master and backup devices, achieving rapid peer status detection. For configuration details, see the corresponding command reference.</p>
</div></div>
<p># Configure an RBP.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> remote-backup-profile profile1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> peer-backup hot</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> vrrp-id 1 interface gigabitethernet <span>0/1/0</span>.2 even-mac</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> vrrp-id 2 interface gigabitethernet <span>0/1/0</span>.3 odd-mac</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> backup-id 10 remote-backup-service service1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> service-type bras</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> quit </strong></pre>
</p></li><li><span>Set NAS parameters and a traffic backup interval. The configuration on <span class="keyword">Device</span> A is used as an example. The configuration on <span class="keyword">Device</span> B is similar to that on <span class="keyword">Device</span> A.</span><p><p># Set NAS parameters.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> remote-backup-profile profile1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> nas logic-ip 1.2.3.4 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> nas logic-port gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> nas logic-sysname huawei</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> commit </strong></pre>
<p># Set a traffic backup interval.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> remote-backup-profile profile1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> traffic backup interval 10 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> commit </strong></pre>
</p></li><li><span>Bind <strong>pool1</strong> configured in the domain to the RBS and configure a protection path for returned network-side traffic. The configuration on <span class="keyword">Device</span> B is similar to that on <span class="keyword">Device</span> A.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> remote-backup-service service1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-srv-service1]<strong> ip-pool pool1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-srv-service1]<strong> protect redirect ip-nexthop 10.1.1.7 interface gigabitethernet <span>0/3/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-srv-profile1]<strong> commit </strong></pre>
</p></li><li><span>Bind the RBP to GE <span>0/1/0</span>.1 through which users go online. The configuration on <span class="keyword">Device</span> A is used as an example. The configuration on <span class="keyword">Device</span> B is similar to that on <span class="keyword">Device</span> A.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> interface gigabitethernet <span>0/1/0</span>.1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.1]<strong> remote-backup-profile profile1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.1]<strong> commit </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.1]<strong> quit </strong></pre>
</p></li><li><span>Enable each router to use the default cost values of imported routes to control address pool route priorities.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> peer-backup route-cost auto-advertising</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> commit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p">Perform one of the following steps based on the type of routing protocol:<ul><li>Run the <a href="cmdqueryname=import-route"><b><span class="cmdname">import-route</span></b></a> <strong><span>unr inherit-cost</span></strong> command in the IS-IS view.</li><li>Run the following commands in the OSPF view:<ol type="a"><li><a href="cmdqueryname=default"><b><span class="cmdname">default</span></b></a> <strong><span>cost inherit-metric</span></strong></li><li><a href="cmdqueryname=import-route"><b><span class="cmdname">import-route</span></b></a> <strong><span>unr</span></strong></li></ol>
</li><li>Run the <a href="cmdqueryname=import-route"><b><span class="cmdname">import-route</span></b></a> <strong><span>unr</span></strong> command in the BGP view.</li></ul>
</div>
</div></div>
</p></li><li><span>Verify the configuration.</span><p><p>After successfully configuring the RBP, run the <strong>display remote-backup-profile</strong> command. According to the command output, the RBS type is <strong>bras</strong>, the RBP named <strong>profile1</strong> is bound to <strong>GigabitEthernet <span>0/1/0</span>.1</strong> from which users go online, and <span class="keyword">Device</span> A is in the <strong>Master</strong> state.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>A&gt; <strong>display remote-backup-profile profile1 </strong>
-----------------------------------------------
 Profile-Index        : 0x802
 Profile-Name         : profile1
 Service              : <strong>bras</strong>
 Remote-backup-service: service1
 Backup-ID            : 10
 track protocol       : VRRP
 VRRP-ID              : 1
 VRRP-Interface       : GigabitEthernet<span>0/1/0</span>.2
 Access-Control       : <strong>Even-Mac</strong>
 State                : <strong>Master</strong>
 Peer-state           : <strong>Slave</strong>
 VRRP-ID              : 2
 VRRP-Interface       : GigabitEthernet<span>0/1/0</span>.3
 Access-Control       : <strong>Odd-Mac</strong>
 State                : <strong>Slave</strong>
 Peer-state           : <strong>Master</strong>
 Interface            :
                        <strong>GigabitEthernet<span>0/1/0</span>.1</strong>
 Backup mode          : hot
 Slot-Number          : 1
 Card-Number          : 0
 Port-Number          : 0
 Nas logic-port       : Gigabitethernet <span>0/1/0</span>
 Nas logic-ip         : 1.2.3.4                        
 Nas logic-sysname    : huawei
 Traffic interval     : 10(minutes)
</pre>
<p>After the RBS is configured successfully, the TCP connection status becomes <strong>Connected</strong>.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>A&gt; <strong>display remote-backup-service service1 </strong>
----------------------------------------------------------
 Service-Index    : 0
 Service-Name     : service1
 TCP-State        : <strong>Connected</strong>
 Peer-ip          : 88.88.88.88
 Source-ip        : 22.22.22.22
 TCP-Port         : 2046
 Track-BFD        : --
 Track-interface0 : GigabitEthernet<span>0/2/0</span>
 Track-interface1 : --
----------------------------------------------------------

 <span>IP Pool:
         pool1</span>
<span>ip pool:
         poolv4_yyz metric 10
         r3 metric 10
         r4 metric 20
         remotev4 metric 10
ipv6 pool:  
         1234 metric 10
         iana_yyz metric 10
         iapd_yyz metric 10
         lo metric 10
         loc_vpn metric 10
         nd metric 10
         pd metric 10
         remote_del_yyz metric 10
         remotev6_yyz metric 10</span>
<span> Failure ratio    : 100%
 Failure duration : 0 min
NAT instance : nat1</span>
 ----------------------------------------------------------
 Rbs-ID         : 0
 Protect-type   : ip-redirect
 Next-hop       : 10.1.1.7
 Vlanid         : 0
 Peer-ip        : 10.1.1.7
 Vrfid          : 0
 Tunnel-index   : 0x0
 Tunnel-state   : UP
 Tunnel-OperFlag: NORMAL
 Spec-interface : GigabitEthernet<span>0/3/0</span>
 Out-interface  : GigabitEthernet<span>0/3/0</span>
 User-number    : 0
</pre>
<p>After users go online, you can view the information about backup users. <span>The information includes the number of locally logged-in users and the number of remotely logged-in users whose information is backed up.</span></p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>display backup-user</strong></pre>
<pre class="screen">  Remote-backup-service: service1
  Total Users Numer: 10
------------------------------------------------------------------------
 100     101     102     103     104     105     106     107     108     109
------------------------------------------------------------------------
<span>  Local Users Number	:10
  Remote Users Number	:0</span>
</pre>
<p>The information about online users on a specified interface can be displayed. <span>The information includes the number of non-RUI users, the number of local RUI users, the number of remote RUI users, and the total number of users.</span></p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>display access-user interface GigabitEthernet <span>0/1/0</span>.1</strong></pre>
<pre class="screen">  ------------------------------------------------------------------------------
  UserID  Username                Interface      IP address       MAC
          Vlan          IPv6 address             Access type
  ------------------------------------------------------------------------------
  120     user@lsh                GE<span>0/1/0</span>.1      10.1.2.10         00e0-fc12-0101
          50/-            -                       IPoE
  101      user@lsh                GE<span>0/1/0</span>.1      10.1.2.9         00e0-fc12-0102          -
          50/-            -                       IPoE
  102      user@lsh                GE<span>0/1/0</span>.1      10.1.2.8         00e0-fc12-0103          -
          50/-            -                       IPoE
  103      user@lsh                GE<span>0/1/0</span>.1      10.1.2.7         00e0-fc12-0104          -
          50/-            -                       IPoE
  104      user@lsh                GE<span>0/1/0</span>.1      10.1.2.6         00e0-fc12-0105          -
          50/-            -                       IPoE
  105      user@lsh                GE<span>0/1/0</span>.1      10.1.2.5         00e0-fc12-0106          -
          50/-            -                       IPoE
  106      user@lsh                GE<span>0/1/0</span>.1      10.1.2.4         00e0-fc12-0107          -
          50/-            -                       IPoE
  107      user@lsh                GE<span>0/1/0</span>.1      10.1.2.3         00e0-fc12-0108          -
          50/-            -                       IPoE
  108      user@lsh                GE<span>0/1/0</span>.1      10.1.2.2         00e0-fc12-0109          -
          50/-            -                       IPoE
  109      user@lsh                GE<span>0/1/0</span>.1      10.1.2.1        00e0-fc12-0110          -
          50/-            -                       IPoE
  --------------------------------------------------------------------------
  Normal users                       : 0
  RUI Local users                    : 10
  RUI Remote users                   : 0
  Total users                        : 10</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172374401__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span> A configuration file</p>
<pre class="screen">#</pre>
<pre class="screen"> sysname <span class="keyword">Device</span>A</pre>
<pre class="screen">#</pre>
<pre class="screen"> bfd</pre>
<pre class="screen">#</pre>
<pre class="screen">ip pool pool1 bas local </pre>
<pre class="screen"> gateway 10.1.1.1 255.255.255.0 </pre>
<pre class="screen"> section 0 10.1.1.2 10.1.1.100 </pre>
<pre class="screen">#</pre>
<pre class="screen">aaa</pre>
<pre class="screen"> domain userdomain1 </pre>
<pre class="screen"> authentication-scheme default0 </pre>
<pre class="screen"> accounting-scheme default0 </pre>
<pre class="screen"> ip-pool pool1 </pre>
<pre class="screen">#</pre>
<pre class="screen">bfd bfd bind peer-ip 10.0.1.2 </pre>
<pre class="screen"> discriminator local 1 </pre>
<pre class="screen"> discriminator remote 2 </pre>
<pre class="screen">#</pre>
<pre class="screen">bfd bfd2 bind peer-ip 10.0.0.2 </pre>
<pre class="screen"> discriminator local 3 </pre>
<pre class="screen"> discriminator remote 4 </pre>
<pre class="screen">#</pre>
<pre class="screen">interface gigabitethernet <span>0/1/0</span>.2 </pre>
<pre class="screen"> vlan-type dot1q 200 </pre>
<pre class="screen"> ip address 10.0.1.1 255.255.255.0 </pre>
<pre class="screen"> vrrp vrid 1 virtual-ip 10.0.1.100 </pre>
<pre class="screen"> admin-vrrp vrid 1 </pre>
<pre class="screen"> vrrp vrid 1 priority 120 </pre>
<pre class="screen"> vrrp vrid 1 preempt-mode timer delay 600</pre>
<pre class="screen"> vrrp vrid 1 track bfd-session session-name bfd peer</pre>
<pre class="screen"> vrrp vrid 1 track interface gigabitethernet <span>0/2/0</span> reduced 50</pre>
<pre class="screen">#</pre>
<pre class="screen">interface gigabitethernet <span>0/1/0</span>.3 </pre>
<pre class="screen"> vlan-type dot1q 201 </pre>
<pre class="screen"> ip address 10.10.0.1 255.255.255.0 </pre>
<pre class="screen"> vrrp vrid 2 virtual-ip 10.0.0.100 </pre>
<pre class="screen"> admin-vrrp vrid 2 </pre>
<pre class="screen"> vrrp vrid 2 priority 100 </pre>
<pre class="screen"> vrrp vrid 2 track bfd-session session-name bfd2 peer</pre>
<pre class="screen">#</pre>
<pre class="screen">remote-backup-service service1 </pre>
<pre class="screen"> peer 88.88.88.88 source 22.22.22.22 port 2046 </pre>
<pre class="screen"> track interface gigabitethernet <span>0/2/0</span></pre>
<pre class="screen"> ip-pool pool1</pre>
<pre class="screen"> protect redirect ip-nexthop 10.1.1.7 interface gigabitethernet <span>0/3/0</span></pre>
<pre class="screen">#</pre>
<pre class="screen">remote-backup-profile profile1 </pre>
<pre class="screen"> service-type bras</pre>
<pre class="screen"> backup-id 10 remote-backup-service service1 </pre>
<pre class="screen"> peer-backup hot </pre>
<pre class="screen"> vrrp-id 1 interface gigabitethernet <span>0/1/0</span>.2 even-mac</pre>
<pre class="screen"> vrrp-id 2 interface gigabitethernet <span>0/1/0</span>.3 odd-mac</pre>
<pre class="screen"> nas logic-ip 1.2.3.4 </pre>
<pre class="screen"> nas logic-port gigabitethernet<span>0/1/0</span></pre>
<pre class="screen"> nas logic-sysname huawei </pre>
<pre class="screen"> traffic backup interval 10 </pre>
<pre class="screen">#</pre>
<pre class="screen">interface gigabitethernet <span>0/1/0</span>.1</pre>
<pre class="screen"> user-vlan 50 </pre>
<pre class="screen"> remote-backup-profile profile1 </pre>
<pre class="screen"> bas </pre>
<pre class="screen"> access-type layer2-subscriber </pre>
<pre class="screen"> authentication-method  web </pre>
<pre class="screen">#</pre>
<pre class="screen">interface gigabitethernet <span>0/3/0</span></pre>
<pre class="screen"> undo shutdown </pre>
<pre class="screen"> ip address 10.1.1.6 255.255.255.0 </pre>
<pre class="screen">#</pre>
<pre class="screen">peer-backup route-cost auto-advertising</pre>
<pre class="screen"> return </pre>
</li><li><p><span class="keyword">Device</span> B configuration file</p>
<pre class="screen">#</pre>
<pre class="screen"> sysname <span class="keyword">Device</span>B</pre>
<pre class="screen">#</pre>
<pre class="screen"> bfd</pre>
<pre class="screen">#</pre>
<pre class="screen">ip pool pool1 bas local rui-slave</pre>
<pre class="screen"> gateway 10.1.1.1 255.255.255.0 </pre>
<pre class="screen"> section 0 10.1.1.2 10.1.1.100 </pre>
<pre class="screen">#</pre>
<pre class="screen">aaa</pre>
<pre class="screen"> domain userdomain1 </pre>
<pre class="screen"> authentication-scheme default0 </pre>
<pre class="screen"> accounting-scheme default0 </pre>
<pre class="screen"> ip-pool pool1 </pre>
<pre class="screen">#</pre>
<pre class="screen">bfd bfd bind peer-ip 10.0.1.1 </pre>
<pre class="screen"> discriminator local 2 </pre>
<pre class="screen"> discriminator remote 1 </pre>
<pre class="screen">#</pre>
<pre class="screen">bfd bfd2 bind peer-ip 10.10.0.1 </pre>
<pre class="screen"> discriminator local 4 </pre>
<pre class="screen"> discriminator remote 3 </pre>
<pre class="screen">#</pre>
<pre class="screen">interface gigabitethernet <span>0/1/0</span>.2 </pre>
<pre class="screen"> vlan-type dot1q 200 </pre>
<pre class="screen"> ip address 10.0.1.2 255.255.255.0 </pre>
<pre class="screen"> vrrp vrid 1 virtual-ip 10.0.1.100 </pre>
<pre class="screen"> admin-vrrp vrid 1 </pre>
<pre class="screen"> vrrp vrid 1 priority 100 </pre>
<pre class="screen"> vrrp vrid 1 track bfd-session session-name bfd peer</pre>
<pre class="screen">#</pre>
<pre class="screen">interface gigabitethernet <span>0/1/0</span>.3</pre>
<pre class="screen"> vlan-type dot1q 201 </pre>
<pre class="screen"> ip address 10.0.0.2 255.255.255.0 </pre>
<pre class="screen"> vrrp vrid 2 virtual-ip 10.0.0.100 </pre>
<pre class="screen"> admin-vrrp vrid 2 </pre>
<pre class="screen"> vrrp vrid 2 priority 120 </pre>
<pre class="screen"> vrrp vrid 2 preempt-mode timer delay 600</pre>
<pre class="screen"> vrrp vrid 2 track bfd-session session-name bfd2 peer</pre>
<pre class="screen"> vrrp vrid 2 track interface gigabitethernet <span>0/2/0</span> reduced 50</pre>
<pre class="screen">#</pre>
<pre class="screen">remote-backup-service service1 </pre>
<pre class="screen"> peer 22.22.22.22 source 88.88.88.88 port 2046 </pre>
<pre class="screen"> ip-pool pool1</pre>
<pre class="screen"> track interface gigabitethernet <span>0/2/0</span>  </pre>
<pre class="screen"> protect redirect ip-nexthop 10.1.1.6 interface gigabitethernet <span>0/3/0</span></pre>
<pre class="screen">#</pre>
<pre class="screen">remote-backup-profile profile1 </pre>
<pre class="screen"> service-type bras</pre>
<pre class="screen"> backup-id 10 remote-backup-service service1 </pre>
<pre class="screen"> peer-backup hot </pre>
<pre class="screen"> vrrp-id 1 interface gigabitethernet <span>0/1/0</span>.2 even-mac</pre>
<pre class="screen"> vrrp-id 2 interface gigabitethernet <span>0/1/0</span>.3 odd-mac</pre>
<pre class="screen"> nas logic-ip 1.2.3.4 </pre>
<pre class="screen"> nas logic-port gigabitethernet<span>0/1/0</span></pre>
<pre class="screen"> nas logic-sysname huawei </pre>
<pre class="screen"> traffic backup interval 10 </pre>
<pre class="screen">#</pre>
<pre class="screen">interface gigabitethernet <span>0/1/0</span>.1</pre>
<pre class="screen"> user-vlan 50 </pre>
<pre class="screen"> remote-backup-profile profile1 </pre>
<pre class="screen"> bas </pre>
<pre class="screen"> access-type layer2-subscriber </pre>
<pre class="screen"> authentication-method  web </pre>
<pre class="screen">#</pre>
<pre class="screen">interface gigabitethernet <span>0/3/0</span></pre>
<pre class="screen"> undo shutdown </pre>
<pre class="screen"> ip address 10.1.1.7 255.255.255.0 </pre>
<pre class="screen">#</pre>
<pre class="screen">peer-backup route-cost auto-advertising</pre>
<pre class="screen"> return </pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0050.html">Configuration Examples
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0058.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0053.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>