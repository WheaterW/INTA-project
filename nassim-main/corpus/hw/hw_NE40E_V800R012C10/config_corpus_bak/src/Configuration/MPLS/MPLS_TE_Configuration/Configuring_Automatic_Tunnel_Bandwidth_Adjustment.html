
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Automatic Tunnel Bandwidth Adjustment">
<meta name="abstract" content="This section describes how to configure the automatic adjustment of the tunnel bandwidth.">
<meta name="description" content="This section describes how to configure the automatic adjustment of the tunnel bandwidth.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0171.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0231.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,te-p2pvrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="OWNER" content="l00468467">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00845984">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368181">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Automatic Tunnel Bandwidth Adjustment</title>
</head>
<body><a name="EN-US_TASK_0172368181"></a><a name="EN-US_TASK_0172368181"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Automatic Tunnel Bandwidth Adjustment</h1>
<div class="taskbody"><p>This section describes how to configure the automatic adjustment of the tunnel bandwidth.</p>
<div class="context"><a name="EN-US_TASK_0172368181__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>Automatic bandwidth adjustment can be enabled to adjust the bandwidth of the tunnel automatically.</p>
<p>The system periodically collects the traffic rate on the outbound interface of a TE tunnel and obtains multiple sampled traffic rates within a certain period. The average value of the sampled values within this period is used as the bandwidth constraint to request the establishment of a new LSP. After the new LSP is established, traffic is switched to the new one. With make-before-break enabled, the old LSP is torn down after the new LSP is established.</p>
<p>The sampling interval is configured in the MPLS view and takes effect for all MPLS TE tunnels. The rate of the outbound interface on an MPLS TE tunnel is recorded at each sampling interval. In this manner, the actual average bandwidth sampled within a period of time can be obtained.</p>
<p>After automatic bandwidth adjustment is enabled, the <a href="cmdqueryname=mpls+te+timer+auto-bandwidth"><b><span class="cmdname">mpls te timer auto-bandwidth</span></b></a> command can be run to configure periodic sampling in order to obtain the bandwidth of the tunnel in a sampling interval. After multiple times of sampling within an automatic bandwidth adjustment period, the average bandwidth is calculated as the new bandwidth, and a new LSP is established based on the new bandwidth. If a new LSP is successfully established, traffic is switched to it, and the original LSP is torn down. If a new LSP fails to be established, traffic is still transmitted along the original LSP. The bandwidth is adjusted in the next automatic bandwidth adjustment period.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368181__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring the bandwidth automatic adjustment, <a href="dc_vrp_te-p2p_cfg_0003.html">configure an RSVP-TE tunnel</a>.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172368181__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=mpls"><b><span class="cmdname">mpls</span></b></a></span></span><p><p>The MPLS view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=mpls+te+timer+auto-bandwidth"><b><span class="cmdname">mpls te timer auto-bandwidth</span></b></a> [ <i><span class="varname">interval</span></i> ]</span><p><p>The sampling interval for automatic bandwidth adjustment is configured. The larger value between the <b><span class="cmdname">mpls te timer auto-bandwidth</span></b> command setting and the <b><span class="cmdname">set flow-stat interval</span></b> command setting is used as the actual sampling interval for automatic bandwidth adjustment.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The <b><span class="cmdname">set flow-stat interval</span></b> command can be run in both the system view and tunnel interface view. If the command is not run in the tunnel interface view, the configuration in the system view is used. If no <i><span class="varname">interval</span></i> value is specified, the default interval is used.</p>
</div></div>
</p></li><li><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=interface+tunnel"><b><span class="cmdname">interface tunnel</span></b></a> <i><span class="varname">interface-number</span></i></span></span><p><p>The tunnel interface view of the MPLS TE tunnel is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=statistic+enable"><b><span class="cmdname">statistic enable</span></b></a></span></span><p><p>MPLS TE tunnel statistics can be collected.</p>
</p></li><li><span>To configure automatic bandwidth adjustment, run one of the following commands.</span><p><ul><li><p>Run the <a href="cmdqueryname=mpls+te+auto-bandwidth"><b><span class="cmdname">mpls te auto-bandwidth</span></b></a> <strong><span>adjustment</span></strong> <span>{ </span>[ <strong><span>threshold</span></strong> <i><span class="varname">percent</span></i><span> [ <span>[ <strong><span>or</span></strong> ] </span><strong><span>absolute-bw</span></strong> <i><span class="varname">absolute-bw</span></i> ]</span><span> ]</span> | <strong><span>frequency</span></strong> <i><span class="varname">interval</span></i> | <span>[ </span><strong><span>max-bw</span></strong> <i><span class="varname">max-bandwidth</span></i> <span>| </span><strong><span>min-bw</span></strong> <i><span class="varname">min-bandwidth</span></i><span> ] <sup>*</sup></span><span> |<span> [</span> <strong><span>overflow-limit</span></strong> <i><span class="varname">overflow-limit-value</span></i> <span>]</span> | <span>[ </span><strong><span>underflow-limit</span></strong> <i><span class="varname">underflow-limit-value</span></i> <span>]</span></span> <span> } <sup>*</sup></span> command to enable automatic bandwidth adjustment and configure the interval at which automatic bandwidth adjustment is performed and the allowed bandwidth adjustment range.</p>
<p>The following policies can be configured to control automatic bandwidth adjustment:</p>
<ul><li><p><strong><span>frequency</span></strong> <i><span class="varname">interval</span></i> sets the interval for bandwidth adjustment. After the <a href="cmdqueryname=mpls+te+auto-bandwidth"><b><span class="cmdname">mpls te auto-bandwidth</span></b></a> command is run, a device must sample bandwidth values for at least twice within a configured interval. If the device samples bandwidth values for less than twice within the specified interval, automatic bandwidth adjustment is not performed. The existing sampling times are counted in the next bandwidth adjustment interval.</p>
</li><li><p>You can run the <strong><span>threshold</span></strong> <i><span class="varname">percent</span></i> <span> [ <span> [ <strong><span>or</span></strong> ] </span><strong><span>absolute-bw</span></strong> <i><span class="varname">absolute-bw</span></i> ]</span> command to determine whether or not to adjust bandwidth.</p>
<p>The system compares the average bandwidth calculated within the automatic bandwidth adjustment period with the actual bandwidth. The bandwidth will be automatically adjusted if the ratio of bandwidth change to the actual bandwidth is greater than the <strong><span>threshold</span></strong> value. If the absolute threshold is also set, the bandwidth will be automatically adjusted if the bandwidth change value is greater than the absolute threshold value.</p>
<p>Therefore, if the network traffic changes frequently but frequent bandwidth adjustment is not needed, you can set a greater <strong><span>threshold</span></strong> value.</p>
<p>If the <strong><span>or</span></strong> parameter is configured, the system performs a bitwise OR operation between the absolute bandwidth threshold and the threshold percentage for bandwidth adjustment. That is, if either the absolute bandwidth threshold or the threshold percentage meets the traffic adjustment condition, automatic bandwidth adjustment is triggered. If <strong><span>or</span></strong> is not configured, the bitwise AND operation is performed by default, so that automatic bandwidth adjustment can only be triggered after both the absolute bandwidth threshold and threshold percentage are reached.</p>
</li><li><div class="p">Automatic bandwidth adjustment is performed if conditions are met in either of the following situations:<ul><li>1. If the <strong><span>overflow-limit</span></strong> <i><span class="varname">overflow-limit-value</span></i> and <strong><span>underflow-limit</span></strong> <i><span class="varname">underflow-limit-value</span></i> parameters are not specified and the interval for automatic bandwidth adjustment expires, bandwidth is automatically adjusted when the average bandwidth exceeds the upper or lower bandwidth adjustment threshold.</li><li>2. If <strong><span>overflow-limit</span></strong> <i><span class="varname">overflow-limit-value</span></i> and <strong><span>underflow-limit</span></strong> <i><span class="varname">underflow-limit-value</span></i> are specified, the device checks whether the average bandwidth exceeds the upper or lower bandwidth adjustment threshold at an interval specified by <b><span class="cmdname">mpls te timer auto-bandwidth</span></b>. If the average bandwidth exceeds the upper or lower bandwidth adjustment threshold for n consecutive times (n is the value specified by <strong><span>overflow-limit</span></strong> <i><span class="varname">overflow-limit-value</span></i> or <strong><span>underflow-limit</span></strong> <i><span class="varname">underflow-limit-value</span></i>), the device automatically adjusts bandwidth without waiting for the timer to reach the interval for automatic bandwidth adjustment.</li></ul>
The default <strong><span>overflow-limit</span></strong> <i><span class="varname">overflow-limit-value</span></i> and <strong><span>underflow-limit</span></strong> <i><span class="varname">underflow-limit-value</span></i> parameter values do not take effect. By default, after the configured interval expires, the device automatically adjusts bandwidth values if the average bandwidth exceeds the upper bandwidth adjustment threshold or falls below the lower bandwidth adjustment threshold.</div>
</li></ul>
</li><li><p>Run the <a href="cmdqueryname=mpls+te+auto-bandwidth"><b><span class="cmdname">mpls te auto-bandwidth</span></b></a> <strong><span>collect-bw</span></strong> <span>{ </span>[ <strong><span>frequency</span></strong> <i><span class="varname">interval</span></i><span> ]</span> | <span>[ </span><strong><span>max-bw</span></strong> <i><span class="varname">max-bandwidth</span></i> <span>| </span><strong><span>min-bw</span></strong> <i><span class="varname">min-bandwidth</span></i> ] <sup>*</sup><span>} <sup>*</sup></span> command to configure the interval at which the bandwidth of the outbound interface is collected and the bandwidth range.</p>
</li></ul>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172368181__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After completing the configuration, run the <a href="cmdqueryname=display+mpls+te+tunnel-interface"><b><span class="cmdname">display mpls te tunnel-interface</span></b></a> command on the ingress of the tunnel to check the tunnel configuration:</p>
<ul><li>Automatically adjusted bandwidth (Auto BW)</li><li>Automatically adjusted frequency <span>(Auto BW Freq)</span></li><li>Minimum bandwidth that can be adjusted <span>(Min BW)</span></li><li>Maximum bandwidth that can be adjusted <span>(Max BW)</span></li><li>Current bandwidth that is collected (Current Collected BW)</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0000.html">MPLS TE Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0171.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0231.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>