
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring LDP over TE">
<meta name="abstract" content="This section provides an example for configuring LDP over TE. The configuration procedure involves the establishment of a TE tunnel and a remote LDP peer.">
<meta name="description" content="This section provides an example for configuring LDP over TE. The configuration procedure involves the establishment of a TE tunnel and a remote LDP peer.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0038.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0080.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0065.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="ldp-p2pvrp,w00800033,z00545680,w00556928,w00606909,z00809835,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MPLS LDP">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MPLS LDP">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS LDP">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS LDP">
<meta name="featuretype" content="MPLS">
<meta name="OWNER" content="z00809835">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="b00896120">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368600">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring LDP over TE</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172368600"></a><a name="EN-US_TASK_0172368600"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring LDP over TE</h1>
<div class="taskbody"><p>This section provides an example for configuring LDP over TE. The configuration procedure involves the establishment of a TE tunnel and a remote LDP peer.</p>
<div class="context"><a name="EN-US_TASK_0172368600__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0172368600__fig_dc_vrp_ldp-p2p_cfg_004501">Figure 1</a>, LSRB and LSRD are on the edge of a backbone network. LDP over TE is to be deployed on this network to allow an LDP LSP to across an RSVP-TE area. LDP services can be transmitted between LSRA and LSRB, and between LSRD and LSRE. In addition, TE services are transmitted between LSR B, LSRC, and between LSRC and LSRD. A TE tunnel destined for LSRD is established on LSRB, and an RSVP tunnel destined for LSRB is established on LSRD. Traffic between LSRA and LSRE needs to be transmitted through the tunnel. LDP over TE can transmit VPN services.</p>
<div class="fignone" id="EN-US_TASK_0172368600__fig_dc_vrp_ldp-p2p_cfg_004501"><a name="EN-US_TASK_0172368600__fig_dc_vrp_ldp-p2p_cfg_004501"></a><a name="fig_dc_vrp_ldp-p2p_cfg_004501"></a><span class="figcap"><b>Figure 1 </b>LDP over TE</span><br><span><img class="vsd" src="figure/en-us_image_0000001308446286.png"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Interface IP addresses</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="17.330000000000002%" id="mcps1.4.1.4.2.4.1.1" liSelected="liSelected"><p>Device Name</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="49.669999999999995%" id="mcps1.4.1.4.2.4.1.2" liSelected="liSelected"><p>Interface Name</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33%" id="mcps1.4.1.4.2.4.1.3" liSelected="liSelected"><p>IP Address</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="2" valign="top" width="17.330000000000002%" headers="mcps1.4.1.4.2.4.1.1 "><p>LSRA</p>
</td>
<td class="cellrowborder" valign="top" width="49.669999999999995%" headers="mcps1.4.1.4.2.4.1.2 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" width="33%" headers="mcps1.4.1.4.2.4.1.3 "><p>1.1.1.1/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.2 "><p>GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.3 "><p>10.1.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" valign="top" width="17.330000000000002%" headers="mcps1.4.1.4.2.4.1.1 "><p>LSRB</p>
</td>
<td class="cellrowborder" valign="top" width="49.669999999999995%" headers="mcps1.4.1.4.2.4.1.2 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" width="33%" headers="mcps1.4.1.4.2.4.1.3 "><p>2.2.2.2/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.2 "><p>GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.3 "><p>10.1.1.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.2 "><p>GigabitEthernet<span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.3 "><p>10.2.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" valign="top" width="17.330000000000002%" headers="mcps1.4.1.4.2.4.1.1 "><p>LSRC</p>
</td>
<td class="cellrowborder" valign="top" width="49.669999999999995%" headers="mcps1.4.1.4.2.4.1.2 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" width="33%" headers="mcps1.4.1.4.2.4.1.3 "><p>3.3.3.3/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.2 "><p>GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.3 "><p>10.2.1.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.2 "><p>GigabitEthernet<span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.3 "><p>10.3.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" valign="top" width="17.330000000000002%" headers="mcps1.4.1.4.2.4.1.1 "><p>LSRD</p>
</td>
<td class="cellrowborder" valign="top" width="49.669999999999995%" headers="mcps1.4.1.4.2.4.1.2 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" width="33%" headers="mcps1.4.1.4.2.4.1.3 "><p>4.4.4.4/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.2 "><p>GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.3 "><p>10.3.1.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.2 "><p>GigabitEthernet<span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.3 "><p>10.4.1.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" valign="top" width="17.330000000000002%" headers="mcps1.4.1.4.2.4.1.1 "><p>LSRE</p>
</td>
<td class="cellrowborder" valign="top" width="49.669999999999995%" headers="mcps1.4.1.4.2.4.1.2 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" width="33%" headers="mcps1.4.1.4.2.4.1.3 "><p>5.5.5.5/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.2 "><p>GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.4.1.3 "><p>10.4.1.1/24</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368600__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Notes</h4><p>When configuring LDP over TE, note that the tunnel destination address must be the LSR ID of the egress.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368600__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Assign an IP address to each interface, configure the loopback address as the LSR ID, and configure an IGP to advertise routes.</p>
</li><li><p>Enable OSPF TE in a TE-aware area and establish an MPLS TE tunnel.</p>
</li><li><p>Enable MPLS LDP in each non-TE-aware area and configure remote LDP peers at the edge of the TE-aware area.</p>
</li><li><p>Configure the forwarding adjacency.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368600__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>OSPF process ID and OSPF area ID</p>
</li><li><p>Policy for triggering the LSP establishment</p>
</li><li><p>Name and IP address of each remote LDP peer of LSRB and LSRD</p>
</li><li><p>Link bandwidth attributes of the tunnel</p>
</li><li><p>Tunnel interface number, IP address, destination address, tunnel ID, RSVP-TE tunnel signaling protocol, tunnel bandwidth, TE metric value, link cost on LSRB and LSRD</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172368600__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface.</span><p><p>Assign an IP address to each interface, including the loopback interface according to <a href="#EN-US_TASK_0172368600__fig_dc_vrp_ldp-p2p_cfg_004501">Figure 1</a>. For configuration details, see the configuration files.</p>
</p></li><li><span>Configure OSPF to advertise the route to the network segment to which each interface is connected and the host route to each LSR ID. For configuration details, see <a href="#EN-US_TASK_0172368600__section_dc_vrp_ldp-p2p_cfg_004505">Configuration Files</a> in this section.</span></li><li><span>Enable MPLS on each LSR. Enable LDP to set up LDP sessions between LSRA and LSRB, and between LSRD and LSRE. Enable RSVP to establish RSVP neighbor relationships between LSRB and LSRC, and between LSRC and LSRD.</span><p><p># Configure LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> mpls lsr-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/0</span>]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<p># Configure LSRB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB] <strong>mpls lsr-id 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-mpls] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-mpls]<strong> mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-mpls-ldp]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/0</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/2/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/2/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/2/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<p># Configure LSRC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC] <strong>mpls lsr-id 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-mpls] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC]<strong> interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/2/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/2/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/2/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC-GigabitEthernet<span>0/2/0</span>]<strong> quit</strong></pre>
<p># Configure LSRD.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD]<strong> mpls lsr-id 4.4.4.4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-mpls] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-mpls]<strong> mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-mpls-ldp]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/2/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/2/0</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<p># Configure LSRE.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRE] <strong>mpls lsr-id 5.5.5.5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE-mpls]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE-GigabitEthernet<span>0/1/0</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRE-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<p>After the preceding configurations are complete, the local LDP sessions are successfully set up between LSRA and LSRB, and between LSRD and LSRE.</p>
<p># Run the <strong>display mpls ldp session</strong> command on LSRA, LSRB, LSRD, or LSRE to view information about the established LDP session. The following example uses the command output on LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>display mpls ldp session</strong></pre>
<pre class="screen"> LDP Session(s) in Public Network
 Codes: LAM(Label Advertisement Mode), SsnAge Unit(DDDD:HH:MM)
<span> An asterisk (*) before a session means the session is being deleted.</span>
--------------------------------------------------------------------------
 PeerID             Status      LAM  SsnRole  SsnAge       KASent/Rcv
--------------------------------------------------------------------------
 2.2.2.2:0          Operational DU   Passive  0000:00:05   23/23
--------------------------------------------------------------------------
TOTAL: 1 Session(s) Found.</pre>
<p># Run the <strong>display mpls ldp peer</strong> command on an LSR to view information about the established LDP peer. The following example uses the command output on LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>display mpls ldp peer</strong></pre>
<pre class="screen"> LDP Peer Information in Public network
<span> An asterisk (*) before a peer means the peer is being deleted.</span>
 -------------------------------------------------------------------------
 PeerID                 TransportAddress   DiscoverySource
 -------------------------------------------------------------------------
 2.2.2.2:0              2.2.2.2            GigabitEthernet<span>0/1/0</span>       
 -------------------------------------------------------------------------
TOTAL: 1 Peer(s) Found.</pre>
<p># Run the <strong>display mpls lsp</strong> command on an LSR. You can view information about LDP LSPs and RSVP tunnels are not set up. The following example uses the command output on LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>display mpls lsp</strong></pre>
<pre class="screen">Flag after Out IF: (I) - RLFA Iterated LSP, (I*) - Normal and RLFA Iterated LSP 
Flag after LDP FRR: (L) - Logic FRR LSP
-------------------------------------------------------------------------------
                 LSP Information: LDP LSP
-------------------------------------------------------------------------------
FEC                In/Out Label    In/Out IF                      Vrf Name
1.1.1.1/32         3/NULL          -/-                            
2.2.2.2/32         NULL/3          -/GE<span>0/1/0</span>                      
2.2.2.2/32         32841/3         -/GE<span>0/1/0</span>                      </pre>
</p></li><li><span>Configure a remote LDP session between LSRB and LSRD.</span><p><p># Configure LSRB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB] <strong>mpls ldp remote-peer lsrd</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-mpls-ldp-remote-lsrd] <strong>remote-ip 4.4.4.4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-mpls-ldp-remote-lsrd] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB-mpls-ldp-remote-lsrd] <strong>quit</strong></pre>
<p># Configure LSRD.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD] <strong>mpls ldp remote-peer lsrb</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-mpls-ldp-remote-lsrb] <strong>remote-ip 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-mpls-ldp-remote-lsrb] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD-mpls-ldp-remote-lsrb] <strong>quit</strong></pre>
<p># After completing the preceding configurations, run the <strong>display mpls ldp remote-peer</strong> command on LSRB or LSRD. The commando output shows that a remote LDP session has been established between LSRB and LSRD. The following example uses the command output on LSRB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB] <strong>display mpls ldp remote-peer lsrd</strong></pre>
<pre class="screen">                         LDP Remote Entity Information
 ------------------------------------------------------------------------------
 Remote Peer Name  : lsrd
 Description       : ----
 Remote Peer IP    : 4.4.4.4              LDP ID        : 2.2.2.2:0
 Transport Address : 2.2.2.2              Entity Status : Active

 Configured Keepalive Hold Timer : 45 Sec
 Configured Keepalive Send Timer : ----
 Configured Hello Hold Timer     : 45 Sec
 Negotiated Hello Hold Timer     : 45 Sec
 Configured Hello Send Timer     : ----
 Configured Delay Timer          : <span>10 Sec</span>
 Hello Packet sent/received      : 425/382
 Label Advertisement Mode        : Downstream Unsolicited
<span> Auto-config                     : ---- </span>
 Manual-config                   : effective
<span> Session-Protect effect          : <strong>YES</strong>
 Session-Protect Duration        : infinite
 Session-Protect Remain          : ----</span>
 ------------------------------------------------------------------------------
 TOTAL: 1 Remote-Peer(s) Found.
</pre>
</p></li><li><span>Configure bandwidth attributes on each outbound interface along the link of the TE tunnel.</span><p><p># Configure LSRB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB]<strong> interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB-GigabitEthernet<span>0/2/0</span>] <strong>mpls te bandwidth max-reservable-bandwidth 20000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/2/0</span>] <strong>mpls te bandwidth bc0 20000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<p># Configure LSRC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC-GigabitEthernet<span>0/1/0</span>]<strong> mpls te bandwidth max-reservable-bandwidth 20000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/1/0</span>]<strong> mpls te bandwidth bc0 20000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC]<strong> interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/2/0</span>]<strong> mpls te bandwidth max-reservable-bandwidth 20000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/2/0</span>]<strong> mpls te bandwidth bc0 20000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC-GigabitEthernet<span>0/2/0</span>]<strong> quit</strong></pre>
<p># Configure LSRD.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD-GigabitEthernet<span>0/1/0</span>]<strong> mpls te bandwidth max-reservable-bandwidth 20000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/0</span>]<strong> mpls te bandwidth bc0 20000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
</p></li><li><span>Configure a tunnel from LSRB to LSRD.</span><p><p># On LSRB, enable the forwarding adjacency on the tunnel interface and adjust the metric value of the forwarding adjacency to direct traffic destined for LSRD or LSRE to the tunnel.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB]<strong> interface tunnel1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-Tunnel1] <strong>ip address unnumbered interface LoopBack1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-Tunnel1] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-Tunnel1] <strong>destination 4.4.4.4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-Tunnel1] <strong>mpls te tunnel-id 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-Tunnel1] <strong>mpls te bandwidth ct0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-Tunnel1] <strong>mpls te igp advertise</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-Tunnel1] <strong>mpls te igp metric absolute 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-Tunnel1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-ospf-1] <strong>opaque-capability enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-ospf-1-area-0.0.0.0] <strong>mpls-te enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-ospf-1] <strong>enable traffic-adjustment advertise</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-ospf-1] <strong>commit</strong></pre>
</p></li><li><span>Configure a tunnel from LSRD to LSRB.</span><p><p># On LSRD, enable the forwarding adjacency on the tunnel interface and adjust the metric value of the forwarding adjacency to direct traffic destined for LSRA or LSRB to the tunnel.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD] <strong>interface tunnel1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-Tunnel1] <strong>ip address unnumbered interface LoopBack1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-Tunnel1] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-Tunnel1] <strong>destination 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-Tunnel1] <strong>mpls te tunnel-id 101</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-Tunnel1] <strong>mpls te bandwidth ct0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-Tunnel1] <strong>mpls te igp advertise</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-Tunnel1] <strong>mpls te igp metric absolute 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-Tunnel1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-ospf-1] <strong>opaque-capability enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-ospf-1-area-0.0.0.0] <strong>mpls-te enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-ospf-1] <strong>enable traffic-adjustment advertise</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-ospf-1] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># After completing the preceding configurations, run the <strong>display mpls te tunnel-interface</strong> command on LSRB. The command output shows that the tunnels have been successfully established.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB] <strong>display mpls te tunnel-interface</strong></pre>
<pre class="screen">    Tunnel Name       : Tunnel1
    Signalled Tunnel Name: -
    Tunnel State Desc : <strong>CR-LSP is Up</strong>
    Tunnel Attributes   :     
    Active LSP          : Primary LSP                                       
    Traffic Switch      : - 
    Session ID          : 100
    Ingress LSR ID      : 2.2.2.2               Egress LSR ID: 4.4.4.4
    Admin State         : UP                    Oper State   : UP
    Signaling Protocol  : RSVP
    FTid                : 1
    Tie-Breaking Policy : None                  Metric Type  : None
</pre>
<p># Run the <strong>display ip routing-table</strong> command on LSRB to view route information. The command output shows that the outbound interfaces destined for LSRD and LSRE are tunnel interfaces.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB] <strong>display ip routing-table</strong></pre>
<pre class="screen"><span class="keyword">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route</span>
------------------------------------------------------------------------------
Routing Table : _public_
         Destinations : 18       Routes : 19        

Destination/Mask    Proto   Pre  Cost        Flags NextHop         Interface

        1.1.1.1/32  OSPF    10   1             D  10.1.1.1        GigabitEthernet<span>0/1/0</span>
        2.2.2.2/32  Direct  0    0             D  127.0.0.1       LoopBack1
        3.3.3.3/32  OSPF    10   1             D  10.2.1.2        GigabitEthernet<span>0/2/0</span>
        4.4.4.4/32  OSPF    10   1             D  2.2.2.2         Tunnel1
        5.5.5.5/32  OSPF    10   2             D  2.2.2.2         Tunnel1
       10.1.1.0/24  Direct  0    0             D  10.1.1.2        GigabitEthernet<span>0/1/0</span>
       10.1.1.1/32  Direct  0    0             D  10.1.1.1        GigabitEthernet<span>0/1/0</span>
       10.1.1.2/32  Direct  0    0             D  127.0.0.1       GigabitEthernet<span>0/1/0</span>
     10.1.1.255/32  Direct  0    0             D  127.0.0.1       GigabitEthernet<span>0/1/0</span>
       10.2.1.0/24  Direct  0    0             D  10.2.1.1        GigabitEthernet<span>0/2/0</span>
       10.2.1.1/32  Direct  0    0             D  127.0.0.1       GigabitEthernet<span>0/2/0</span>
     10.2.1.255/32  Direct  0    0             D  127.0.0.1       GigabitEthernet<span>0/2/0</span>
       10.3.1.0/24  OSPF    10   2             D  2.2.2.2         Tunnel1
                    OSPF    10   2             D  10.2.1.2        GigabitEthernet<span>0/2/0</span>
       10.4.1.0/24  OSPF    10   2             D  2.2.2.2         Tunnel1
      127.0.0.0/8   Direct  0    0             D  127.0.0.1       InLoopBack0
      127.0.0.1/32  Direct  0    0             D  127.0.0.1       InLoopBack0
127.255.255.255/32  Direct  0    0             D  127.0.0.1       InLoopBack0
255.255.255.255/32  Direct  0    0             D  127.0.0.1       InLoopBack0</pre>
<p># Run the <strong>display mpls lsp</strong> command on LSRB, LSRC, or LSRD to view information about LSPs. You can view information about RSVP LSPs. The following example uses the command output on LSRB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB] <strong>display mpls lsp</strong></pre>
<pre class="screen">Flag after Out IF: (I) - RLFA Iterated LSP, (I*) - Normal and RLFA Iterated LSP 
Flag after LDP FRR: (L) - Logic FRR LSP
-------------------------------------------------------------------------------
                 LSP Information: RSVP LSP
-------------------------------------------------------------------------------
FEC                In/Out Label    In/Out IF                      Vrf Name
4.4.4.4/32         NULL/32832      -/GE<span>0/2/0</span>
2.2.2.2/32         3/NULL          GE<span>0/2/0</span>/-
-------------------------------------------------------------------------------
                 LSP Information: LDP LSP
-------------------------------------------------------------------------------
FEC                In/Out Label    In/Out IF                      Vrf Name
1.1.1.1/32         NULL/3          -/GE<span>0/1/0</span>                      
1.1.1.1/32         32834/3         -/GE<span>0/1/0</span>                      
2.2.2.2/32         3/NULL          -/-                            
4.4.4.4/32         NULL/3          -/Tun1                         
4.4.4.4/32         32844/3         -/Tun1                         
5.5.5.5/32         NULL/32837      -/Tun1                         
5.5.5.5/32         32845/32837     -/Tun1                         </pre>
<p># Run the <a href="cmdqueryname=display+ip+routing-table"><b><span class="cmdname">display ip routing-table</span></b></a> command to view the routing table on LSRA. The command output shows that the cost values change after the forwarding adjacency was configured.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>display ip routing-table</strong></pre>
<pre class="screen"><span class="keyword">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route</span>
------------------------------------------------------------------------------
Routing Table : _public_
         Destinations : 16       Routes : 16        

Destination/Mask    Proto   Pre  Cost        Flags NextHop         Interface

        1.1.1.1/32  Direct  0    0             D  127.0.0.1       LoopBack1
        2.2.2.2/32  OSPF    10   1             D  10.1.1.2        GigabitEthernet<span>0/1/0</span>
        3.3.3.3/32  OSPF    10   2             D  10.1.1.2        GigabitEthernet<span>0/1/0</span>
        4.4.4.4/32  OSPF    10   2             D  10.1.1.2        GigabitEthernet<span>0/1/0</span>
        5.5.5.5/32  OSPF    10   3             D  10.1.1.2        GigabitEthernet<span>0/1/0</span>
       10.1.1.0/24  Direct  0    0             D  10.1.1.1        GigabitEthernet<span>0/1/0</span>
       10.1.1.1/32  Direct  0    0             D  127.0.0.1       GigabitEthernet<span>0/1/0</span>
       10.1.1.2/32  Direct  0    0             D  10.1.1.2        GigabitEthernet<span>0/1/0</span>
     10.1.1.255/32  Direct  0    0             D  127.0.0.1       GigabitEthernet<span>0/1/0</span>
       10.2.1.0/24  OSPF    10   2             D  10.1.1.2        GigabitEthernet<span>0/1/0</span>
       10.3.1.0/24  OSPF    10   3             D  10.1.1.2        GigabitEthernet<span>0/1/0</span>
       10.4.1.0/24  OSPF    10   3             D  10.1.1.2        GigabitEthernet<span>0/1/0</span>
      127.0.0.0/8   Direct  0    0             D  127.0.0.1       InLoopBack0
      127.0.0.1/32  Direct  0    0             D  127.0.0.1       InLoopBack0
127.255.255.255/32  Direct  0    0             D  127.0.0.1       InLoopBack0
255.255.255.255/32  Direct  0    0             D  127.0.0.1       InLoopBack0</pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172368600__section_dc_vrp_ldp-p2p_cfg_004505"><a name="EN-US_TASK_0172368600__section_dc_vrp_ldp-p2p_cfg_004505"></a><a name="section_dc_vrp_ldp-p2p_cfg_004505"></a><a name="EN-US_TASK_0172368600__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>LSRA configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname LSRA</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls lsr-id 1.1.1.1</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls ldp</pre>
<pre class="screen"> #
 ipv4-family</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown </pre>
<pre class="screen"> ip address 10.1.1.1 255.255.255.0</pre>
<pre class="screen"> mpls</pre>
<pre class="screen"> mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack1</pre>
<pre class="screen"> ip address 1.1.1.1 255.255.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 1.1.1.1 0.0.0.0</pre>
<pre class="screen">  network 10.1.1.0 0.0.0.255</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p>LSRB configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname LSRB</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls lsr-id 2.2.2.2</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls</pre>
<pre class="screen">  mpls te</pre>
<pre class="screen">  mpls rsvp-te</pre>
<pre class="screen">  mpls te cspf</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls ldp</pre>
<pre class="screen"> #
 ipv4-family</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls ldp remote-peer lsrd</pre>
<pre class="screen"> remote-ip 4.4.4.4</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown </pre>
<pre class="screen"> ip address 10.1.1.2 255.255.255.0</pre>
<pre class="screen"> mpls</pre>
<pre class="screen"> mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown </pre>
<pre class="screen"> ip address 10.2.1.1 255.255.255.0</pre>
<pre class="screen"> mpls</pre>
<pre class="screen"> mpls te</pre>
<pre class="screen"> mpls te bandwidth max-reservable-bandwidth 20000</pre>
<pre class="screen"> mpls te bandwidth bc0 20000</pre>
<pre class="screen"> mpls rsvp-te</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack1</pre>
<pre class="screen"> ip address 2.2.2.2 255.255.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">interface Tunnel1</pre>
<pre class="screen"> ip address unnumbered interface LoopBack1</pre>
<pre class="screen"> tunnel-protocol mpls te</pre>
<pre class="screen"> destination 4.4.4.4</pre>
<pre class="screen"> mpls te igp advertise</pre>
<pre class="screen"> mpls te igp metric absolute 1</pre>
<pre class="screen"> mpls te bandwidth ct0 10000</pre>
<pre class="screen"> mpls te tunnel-id 100</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> opaque-capability enable</pre>
<pre class="screen"> enable traffic-adjustment advertise</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 2.2.2.2 0.0.0.0</pre>
<pre class="screen">  network 10.1.1.0 0.0.0.255</pre>
<pre class="screen">  network 10.2.1.0 0.0.0.255</pre>
<pre class="screen">  mpls-te enable</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p>LSRC configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname LSRC</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls lsr-id 3.3.3.3</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls</pre>
<pre class="screen">  mpls te</pre>
<pre class="screen">  mpls rsvp-te</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown </pre>
<pre class="screen"> ip address 10.2.1.2 255.255.255.0</pre>
<pre class="screen"> mpls</pre>
<pre class="screen"> mpls te</pre>
<pre class="screen"> mpls te bandwidth max-reservable-bandwidth 20000</pre>
<pre class="screen"> mpls te bandwidth bc0 20000</pre>
<pre class="screen"> mpls rsvp-te</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown </pre>
<pre class="screen"> ip address 10.3.1.1 255.255.255.0</pre>
<pre class="screen"> mpls</pre>
<pre class="screen"> mpls te</pre>
<pre class="screen"> mpls te bandwidth max-reservable-bandwidth 20000</pre>
<pre class="screen"> mpls te bandwidth bc0 20000</pre>
<pre class="screen"> mpls rsvp-te</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack1</pre>
<pre class="screen"> ip address 3.3.3.3 255.255.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> opaque-capability enable</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 3.3.3.3 0.0.0.0</pre>
<pre class="screen">  network 10.2.1.0 0.0.0.255</pre>
<pre class="screen">  network 10.3.1.0 0.0.0.255</pre>
<pre class="screen">  mpls-te enable</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p>LSRD configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname LSRD</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls lsr-id 4.4.4.4</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls</pre>
<pre class="screen">  mpls te</pre>
<pre class="screen">  mpls rsvp-te</pre>
<pre class="screen">  mpls te cspf</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls ldp</pre>
<pre class="screen"> #
 ipv4-family</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls ldp remote-peer lsrb</pre>
<pre class="screen"> remote-ip 2.2.2.2</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown </pre>
<pre class="screen"> ip address 10.3.1.2 255.255.255.0</pre>
<pre class="screen"> mpls</pre>
<pre class="screen"> mpls te</pre>
<pre class="screen"> mpls te bandwidth max-reservable-bandwidth 20000</pre>
<pre class="screen"> mpls te bandwidth bc0 20000</pre>
<pre class="screen"> mpls rsvp-te</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown </pre>
<pre class="screen"> ip address 10.4.1.2 255.255.255.0</pre>
<pre class="screen"> mpls</pre>
<pre class="screen"> mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack1</pre>
<pre class="screen"> ip address 4.4.4.4 255.255.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">interface Tunnel1</pre>
<pre class="screen"> ip address unnumbered interface LoopBack1</pre>
<pre class="screen"> tunnel-protocol mpls te</pre>
<pre class="screen"> destination 2.2.2.2</pre>
<pre class="screen"> mpls te igp advertise</pre>
<pre class="screen"> mpls te igp metric absolute 1</pre>
<pre class="screen"> mpls te bandwidth ct0 10000</pre>
<pre class="screen"> mpls te tunnel-id 101</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> opaque-capability enable</pre>
<pre class="screen"> enable traffic-adjustment advertise</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 4.4.4.4 0.0.0.0</pre>
<pre class="screen">  network 10.3.1.0 0.0.0.255</pre>
<pre class="screen">  network 10.4.1.0 0.0.0.255</pre>
<pre class="screen">  mpls-te enable</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p>LSRE configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname LSRE</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls lsr-id 5.5.5.5</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls ldp</pre>
<pre class="screen"> #
 ipv4-family</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown </pre>
<pre class="screen"> ip address 10.4.1.2 255.255.255.0</pre>
<pre class="screen"> mpls</pre>
<pre class="screen"> mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack1</pre>
<pre class="screen"> ip address 5.5.5.5 255.255.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 5.5.5.5 0.0.0.0</pre>
<pre class="screen">  network 10.4.1.0 0.0.0.255</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0038.html">Configuration Examples for MPLS LDP
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0080.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0065.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>