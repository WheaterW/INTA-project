
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Tunnel Re-optimization">
<meta name="abstract" content="Tunnel re-optimization is configured to allow a device to dynamically adjust paths for tunnels.">
<meta name="description" content="Tunnel re-optimization is configured to allow a device to dynamically adjust paths for tunnels.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0199.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0171.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,te-p2pvrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="OWNER" content="l00468467">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00845984">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368180">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Tunnel Re-optimization</title>
</head>
<body><a name="EN-US_TASK_0172368180"></a><a name="EN-US_TASK_0172368180"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Tunnel Re-optimization</h1>
<div class="taskbody"><p>Tunnel re-optimization is configured to allow a device to dynamically adjust paths for tunnels.</p>
<div class="context"><a name="EN-US_TASK_0172368180__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>Topology and link attributes of an IP/MPLS network are changeable. As a result, a path over which an MPLS TE tunnel has been established may not be optimal. Tunnel re-optimization can be configured to allow the MPLS TE tunnel to be reestablished over an optimal path.</p>
<div class="p">Re-optimization is implemented in either of the following modes:<ul><li><p>Automatic re-optimization: The system automatically re-optimizes TE tunnels when the re-optimization interval is reached or when changes occur in the network topology (such as link addition, link removal, or IGP link cost adjustment). This implementation does not involve manual intervention and reduces labor cost.</p>
</li><li><p>Manual re-optimization: Manual re-optimization can be configured for the TE tunnels if you want to immediately re-optimize the TE tunnels.</p>
</li></ul>
</div>
<div class="note" id="EN-US_TASK_0172368180__note980355186214045"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul id="EN-US_TASK_0172368180__ul1510516261268"><li id="EN-US_TASK_0172368180__li2105152618615">Tunnel re-optimization is performed based on tunnel path constraints. During path re-optimization, path constraints, such as explicit path constraints and bandwidth constraints, are also considered.</li><li id="EN-US_TASK_0172368180__li11105162611620">Tunnel re-optimization cannot be used on tunnels for which a system selects paths in most-fill tie-breaking mode.</li><li id="EN-US_TASK_0172368180__li61051926564">Tunnel re-optimization takes effect on the primary and hot-standby paths, but not on ordinary backup and best-effort paths.</li><li id="EN-US_TASK_0172368180__li16105102618611">Tunnel re-optimization cannot be configured if a bypass tunnel is configured, path locking is enabled, or the fixed filter (FF) resource reservation style is used.</li></ul>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368180__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring tunnel re-optimization, <a href="dc_vrp_te-p2p_cfg_0003.html">configure an RSVP-TE tunnel</a>.</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172368180__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>(Optional) Enable IGP metric-based re-optimization for an MPLS TE tunnel.</span><p><p>Perform this step if you want to re-optimize an MPLS TE tunnel based only on the IGP metric. The following constraints are ignored during re-optimization:</p>
<ul><li>Bandwidth usage: A link is selected based on the percentage of the used reservable bandwidth to the maximum reservable bandwidth.</li><li>Hop-counts: A link is selected based on the number of hops on the path.</li></ul>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run either of the following commands:</span><p><p>The global MPLS configuration takes effect on all MPLS TE tunnels and is used for batch configuration. A single tunnel configuration takes precedence over the global MPLS configuration.</p>
<ul><li>Configure global MPLS.<ol type="a"><li>Run <a href="cmdqueryname=mpls"><b><span class="cmdname">mpls</span></b></a><p>The MPLS view is displayed.</p>
</li><li>Run <a href="cmdqueryname=mpls+te"><b><span class="cmdname">mpls te</span></b></a><p>MPLS TE is enabled globally.</p>
</li><li>Run <a href="cmdqueryname=mpls+te+reoptimization-aggressive+enable"><b><span class="cmdname">mpls te reoptimization-aggressive enable</span></b></a> (MPLS view)<p>Re-optimization based only on IGP metric is enabled globally for MPLS TE tunnels.</p>
<p>This command takes effect on all MPLS TE tunnels. To delete the configuration for some tunnels, enter the interface views of the MPLS TE tunnels, and then run the <a href="cmdqueryname=mpls+te+reoptimization-aggressive+block"><b><span class="cmdname">mpls te reoptimization-aggressive block</span></b></a> command.</p>
</li><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>Return to the system view.</p>
</li></ol>
</li><li>Configure based on a single tunnel.<ol type="a"><li>Run <a href="cmdqueryname=interface+tunnel"><b><span class="cmdname">interface tunnel</span></b></a> <i><span class="varname">interface-number</span></i><p>The tunnel interface view of the MPLS TE tunnel to be established is displayed.</p>
</li><li>Run <a href="cmdqueryname=tunnel-protocol"><b><span class="cmdname">tunnel-protocol</span></b></a> <strong><span>mpls</span></strong> <strong><span>te</span></strong><p>MPLS TE is configured as the tunneling protocol.</p>
</li><li>Run <a href="cmdqueryname=mpls+te+reoptimization-aggressive+enable"><b><span class="cmdname">mpls te reoptimization-aggressive enable</span></b></a> (tunnel interface view)<p>Re-optimization based only on IGP metric is enabled globally for MPLS TE tunnels.</p>
</li></ol>
</li></ul>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure automatic tunnel re-optimization.</span><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=interface+tunnel"><b><span class="cmdname">interface tunnel</span></b></a> <i><span class="varname">interface-number</span></i></span></span><p><p>The tunnel interface view of the MPLS TE tunnel to be established is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=mpls+te+reoptimization"><b><span class="cmdname">mpls te reoptimization</span></b></a> [ <strong><span>frequency</span></strong> <i><span class="varname">interval</span></i> ]</span></span><p><p>Automatic tunnel re-optimization is enabled.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=mpls+te+inter-area+reoptimization"><b><span class="cmdname">mpls te inter-area reoptimization</span></b></a></span><p><p>Inter-IGP-area tunnel re-optimization is enabled.</p>
</p><p><p>In an inter-IGP-area scenario, when a better path exists in the downstream area and tunnel re-optimization is triggered on the ingress, the tunnel can only detect whether a better path exists in the area where the ingress resides, not in the downstream area. As a result, if a better path exists only in the downstream area, it is impossible to establish an RSVP-TE P2P LSP over that path through re-optimization. To address the issue, you can perform this step to enable inter-IGP-area tunnel re-optimization so that the RSVP-TE P2P LSP of the tunnel can be established over a better path in the downstream area.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=mpls"><b><span class="cmdname">mpls</span></b></a></span><p><p>The MPLS view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=mpls+te+reoptimization+link-up+disable"><b><span class="cmdname">mpls te reoptimization link-up disable</span></b></a></span><p><p>Link change-triggered RSVP-TE tunnel re-optimization is disabled.</p>
</p><p><p>If route flapping occurs on a network, tunnel re-optimization is repeatedly triggered, wasting network resources. To prevent the problem, run this command to disable link change-triggered RSVP-TE tunnel re-optimization so that tunnel re-optimization will not be performed.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command takes effect only for link change-triggered tunnel re-optimization. It does not take effect if the <a href="cmdqueryname=mpls+te+reoptimization+%28tunnel+interface+view%29"><b><span class="cmdname">mpls te reoptimization (tunnel interface view)</span></b></a> command is run with the <strong><span>frequency</span></strong> <i><span class="varname">interval</span></i> parameter specified.</p>
<p>This command disables the re-optimization function configured for all tunnels.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure manual tunnel re-optimization.</span><p><p>In the user view, run <a href="cmdqueryname=mpls+te+reoptimization"><b><span class="cmdname">mpls te reoptimization</span></b></a><span> [ <span><strong><span>auto-tunnel name</span></strong> </span><i><span class="varname">tunnel-interface</span></i> | <strong><span>tunnel</span></strong> <i><span class="varname">tunnel-number</span></i> ]</span></p>
<p>Manual re-optimization is configured.</p>
<p>Manual re-optimization can be enabled on a specific or all tunnels on a node.</p>
</p></li></ul></div>
<div class="example"><a name="EN-US_TASK_0172368180__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After completing the configuration, run the <a href="cmdqueryname=display+mpls+te+tunnel-interface"><b><span class="cmdname">display mpls te tunnel-interface</span></b></a> command on the ingress of the tunnel to view the following information:</p>
<ul><li>Whether automatic re-optimization is enabled</li><li>Interval between automatic re-optimization processes</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0000.html">MPLS TE Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0199.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0171.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>