
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Enabling LDP Auto FRR">
<meta name="abstract" content="If LDP auto FRR is needed, configure it on the ingress or a transit node of a tunnel.">
<meta name="description" content="If LDP auto FRR is needed, configure it on the ingress or a transit node of a tunnel.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0049.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0052.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MPLS LDP">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MPLS LDP">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS LDP">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS LDP">
<meta name="featuretype" content="MPLS">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="b00896120">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368495">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Enabling LDP Auto FRR</title>
</head>
<body><a name="EN-US_TASK_0172368495"></a><a name="EN-US_TASK_0172368495"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Enabling LDP Auto FRR</h1>
<div class="taskbody"><p>If LDP auto FRR is needed, configure it on the ingress or a transit node of a tunnel.</p>
<div class="context"><a name="EN-US_TASK_0172368495__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>LDP auto FRR depends on IGP auto FRR. LDP auto FRR will be automatically enabled after IGP auto FRR is enabled. To change a policy for triggering LDP LSP establishment, you can run the <a href="cmdqueryname=auto-frr+lsp-trigger"><b><span class="cmdname">auto-frr lsp-trigger</span></b></a> command.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Before you enable remote LFA FRR, configure the remote LFA algorithm when you configure IGP auto FRR.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172368495__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=mpls+ldp"><b><span class="cmdname">mpls ldp</span></b></a></span><p><p>The MPLS-LDP view is displayed.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a></span><p><p>The MPLS-LDP-IPv4 view is displayed.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=auto-frr+lsp-trigger+all+host+ip-prefix+none"><b><span class="cmdname">auto-frr lsp-trigger</span></b></a> { <strong><span>all</span></strong> | <strong><span>host</span></strong> | <strong><span>ip-prefix</span></strong> <i><span class="varname">ip-prefix-name</span></i> | <strong><span>none</span></strong> }</span><p><p>A policy for triggering LDP to establish backup LSPs is configured.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If both the <a href="cmdqueryname=auto-frr+lsp-trigger"><b><span class="cmdname">auto-frr lsp-trigger</span></b></a> and <a href="cmdqueryname=lsp-trigger"><b><span class="cmdname">lsp-trigger</span></b></a> commands are run, the established backup LSPs satisfy both the policy for triggering LDP LSP establishment and the policy for triggering backup LDP LSP establishment.</p>
</div></div>
<p>This command can be run in both the MPLS-LDP and MPLS-LDP-IPv4 views. If it is run in both views, only the later configuration takes effect.</p>
</p></li><li><span>To enable remote LFA FRR, perform the following steps in the MPLS-LDP view of a PQ node:</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the MPLS-LDP view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=accept+target-hello+all+peer-group+ip-prefix"><b><span class="cmdname">accept target-hello</span></b></a> { <strong><span>all</span></strong> | <strong><span>peer-group</span></strong> <strong><span>ip-prefix</span></strong> <i><span class="varname">ip-prefix-name</span></i> }</span><p><p>Automatic remote LDP session establishment upon the receiving of a Targeted Hello message is enabled.</p>
</p><p><p>In a Remote LFA FRR scenario, after an ingress uses the Remote LFA algorithm to calculate a PQ node, LDP automatically establishes a remote LDP session between the ingress and the PQ node. To enable the PQ node to implement this function, run the <a href="cmdqueryname=accept+target-hello"><b><span class="cmdname">accept target-hello</span></b></a> command on the PQ node.</p>
<p>In the preceding command:</p>
<ul><li><strong><span>all</span></strong>: enables a PQ node to establish remote LDP sessions based on all received Targeted Hello messages.</li><li><strong><span>peer-group</span></strong> <strong><span>ip-prefix</span></strong> <i><span class="varname">ip-prefix-name</span></i>: enables a PQ node to establish remote LDP sessions based on Targeted Hello messages sent by LDP peers that meet a specified IP prefix list.</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>After the <a href="cmdqueryname=accept+target-hello"><b><span class="cmdname">accept target-hello</span></b></a> command is run, the PQ node is prone to Targeted Hello packet-based attacks. If the PQ node receives a large number of Targeted Hello packets, it establishes many remote LDP sessions. To prevent such an issue, perform either of the following operations:</p>
<ul><li>Specify the <strong><span>peer-group</span></strong> <strong><span>ip-prefix</span></strong> <i><span class="varname">ip-prefix-name</span></i> parameter to limit the LDP peers with which a PQ node can establish remote LDP sessions.</li><li>Configure LDP security authentication for LDP peers in batches. For details, see <a href="dc_vrp_ldp-p2p_cfg_0055.html">Configuring LDP Security Features</a>.</li></ul>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=send-message+address+all-loopback"><b><span class="cmdname">send-message address all-loopback</span></b></a></span><p><p>The PQ node is enabled to advertise all local loopback interface addresses to LDP peers.</p>
</p><p><p>In a remote LFA FRR scenario, LDP uses the PQ node's address calculated using an IGP to establish a remote LDP session between a node and the PQ node. Then the two nodes establish a remote LFA FRR LSP over the session. The PQ node's IP address can be any loopback interface's IP address or an LSR ID. To advertise the loopback addresses to LDP peers, run this command on a PQ node so that a remote LFA FRR LSP can be established.</p>
</p></li></ol>
</li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li><span>(Optional) Enable poison reverse for LDP FRR/ECMP.</span><p></p><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span><p><p>The interface or sub-interface view is displayed.</p>
</p><p><p>You can enter the Eth-Trunk interface view, Eth-Trunk sub-interface view,<span> POS interface view,</span><span> IP-Trunk interface view,</span> GE interface view, or GE sub-interface view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mpls+poison-reverse+enable"><b><span class="cmdname">mpls poison-reverse enable</span></b></a></span><p><p>Poison reverse is enabled for LDP FRR/ECMP.</p>
</p><p><p>In an FRR or TI-LFA scenario on an LDP/SR-MPLS BE ring network, if the primary path fails, the ingress switches traffic from the primary path to the backup path. In this case, a transit node sends traffic back to the ingress before routes are converged. As a result, a traffic loop occurs. To address this issue, run this command on the inbound interface of the transit node. If the transit node finds that the outbound interface of traffic is the same as the inbound interface of the traffic, the transit node switches traffic from the primary path to the backup path in a timely manner, blocking looped traffic.</p>
<p>This command also applies to the scenario where two ECMP paths are formed on an LDP/SR-MPLS BE ring network to resolve similar issues.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0049.html">Configuring LDP Auto FRR
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0052.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>