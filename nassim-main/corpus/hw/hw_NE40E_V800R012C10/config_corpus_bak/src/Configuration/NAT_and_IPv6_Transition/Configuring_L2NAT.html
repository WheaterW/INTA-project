
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring L2NAT">
<meta name="abstract" content="L2-Aware NAT (L2NAT) translates private IP addresses into public IP addresses based on user location information.">
<meta name="description" content="L2-Aware NAT (L2NAT) translates private IP addresses into public IP addresses based on user location information.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_title_cfg_nat.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ds-lite_cfg_0001.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="c00549182">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="L2-Aware NAT">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="L2-Aware NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="c00549182">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001302983301">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring L2NAT</title>
</head>
<body><a name="EN-US_TASK_0000001302983301"></a><a name="EN-US_TASK_0000001302983301"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring L2NAT</h1>
<div class="taskbody"><p>L2-Aware NAT (L2NAT) translates private IP addresses into public IP addresses based on user location information.</p>
<div class="context"><a name="EN-US_TASK_0000001302983301__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><div class="p">Three NAT technologies are available on a network: NAT444, NAT44, and L2NAT.<ul><li>NAT444: A CPE performs NAT for user traffic before forwarding it to a NAT device, which then performs NAT again for the user traffic. NAT444 allows users on different private networks to use the same private IP address.</li><li>NAT44: A CPE does not perform NAT for user traffic. Instead, it directly forwards user traffic to a NAT device for NAT. NAT44 does not allow users on different private networks to use the same private IP address.</li><li>L2NAT: A CPE does not perform NAT for user traffic. Instead, it adds user location information into packets when forwarding them. A NAT device then translates the private IP address carried in each packet into a public IP address based on the user location information. L2NAT allows users on different private networks to use the same private IP address.</li></ul>
</div>
<p>After CPEs connected to an L2NAT device are assigned the same IP address, parameters related to external hosts must be configured on the L2NAT device to establish static mappings between the CPEs and external hosts. This allows external hosts to maintain access to online CPEs.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001302983301__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure the L2NAT license function.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=license"><b><span class="cmdname">license</span></b></a></span><p><p>The license view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=active+l2nat+vsuf+slot"><b><span class="cmdname">active l2nat vsuf slot</span></b></a> <i><span class="varname">slot-id</span></i></span><p><p>The L2NAT license is activated for the service board.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li></ol>
</li><li><span>Configure the L2NAT function.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=nat+instance"><b><span class="cmdname">nat instance</span></b></a> <i><span class="varname">instance-name</span></i> [ <strong><span>id</span></strong> <i><span class="varname">id</span></i> ]</span><p><p>The NAT instance view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=l2-aware+enable"><b><span class="cmdname">l2-aware enable</span></b></a></span><p><p>The L2NAT function is enabled.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li></ol>
</li><li><span>Binding the service board or the service board's CPU to the NAT instance.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=service-location"><b><span class="cmdname">service-location</span></b></a> <i><span class="varname">service-location-id</span></i></span><p><p>A service-location group is created, and its view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=location"><b><span class="cmdname">location</span></b></a> <strong><span>slot</span></strong> <i><span class="varname">slot-id</span></i> [ <strong><span>backup</span></strong> <strong><span>slot</span></strong> <i><span class="varname">slot-id</span></i> ]</span><p><p>The service board's CPU is bound.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=service-instance-group"><b><span class="cmdname">service-instance-group</span></b></a> <i><span class="varname">service-instance-group-name</span></i></span><p><p>A service-instance group is created, and its view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=service-location"><b><span class="cmdname">service-location</span></b></a> <i><span class="varname">service-location-id</span></i></span><p><p>The service-location group is bound.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=nat+instance"><b><span class="cmdname">nat instance</span></b></a> <i><span class="varname">instance-name</span></i> [ <strong><span>id</span></strong> <i><span class="varname">id</span></i> ]</span><p><p>The NAT instance view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=service-instance-group"><b><span class="cmdname">service-instance-group</span></b></a> <i><span class="varname">service-instance-group-name</span></i></span><p><p>The service-instance group is bound.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li></ol>
</li><li><span>(Optional) Configure parameters related to external hosts so that they can maintain access to CPEs connected to the L2NAT device.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=nat+external-host"><b><span class="cmdname">nat external-host</span></b></a> { <strong><span>tcp</span></strong> | <strong><span>udp</span></strong> | <strong><span>any</span></strong> } <strong><span>destination-ip</span></strong> <i><span class="varname">ip-address</span></i> [ <strong><span>destination-port</span></strong> <i><span class="varname">port-number</span></i> ]</span><p><p>Parameters related to the external host that needs to visit the CPEs are configured.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li></ol>
</li><li><span>Verify the configuration. Specifically, run the <strong>display l2nat vsuf status</strong> command to check license allocation for the L2NAT service.</span></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_title_cfg_nat.html">NAT and IPv6 Transition
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0001.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ds-lite_cfg_0001.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>