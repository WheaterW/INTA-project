
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a NAT64 Traffic Distribution Policy">
<meta name="abstract" content="You can configure a NAT64 traffic distribution policy to distribute user traffic to NAT64 service boards for translation.">
<meta name="description" content="You can configure a NAT64 traffic distribution policy to distribute user traffic to NAT64 service boards for translation.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat64_cfg_0013.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat64_cfg_0015_m2k.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="c00549182">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="NAT64">
<meta name="featuretype" content="NAT and IPv6 Transition">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NAT64">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="NAT64">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="NAT64">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="zwx1100870">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172374906">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a NAT64 Traffic Distribution Policy</title>
</head>
<body><a name="EN-US_TASK_0172374906"></a><a name="EN-US_TASK_0172374906"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a NAT64 Traffic Distribution Policy</h1>
<div class="taskbody"><p>You can configure a NAT64 traffic distribution policy to distribute user traffic to NAT64 service boards for translation.</p>
<div class="context"><a name="EN-US_TASK_0172374906__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>A service board does not provide any interfaces. Therefore, an interface board must distribute user traffic to a service board for NAT64 treatment. You can configure a traffic distribution policy to distribute the packets matching the traffic distribution policy to the NAT64 service board.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172374906__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure a traffic classification rule.</span><ol type="a"><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run either of the following commands:</span><p><ul><li><p>For a basic ACL (ACL number ranging from 2000 to 2999), run the <span><a href="cmdqueryname=acl+ipv6"><b><span class="cmdname" id="EN-US_TASK_0172374906__cmdname902577050214034">acl ipv6</span></b></a> { <strong><span id="EN-US_TASK_0172374906__cmdparmname1441160416214034">name</span></strong> <i><span class="varname" id="EN-US_TASK_0172374906__varname1001603808214034">basic-acl6-name</span></i> <strong><span id="EN-US_TASK_0172374906__cmdparmname119426288214034">basic</span></strong> | [ <strong><span id="EN-US_TASK_0172374906__cmdparmname1766942738214034">number</span></strong> ] <i><span class="varname" id="EN-US_TASK_0172374906__varname1818197482214034">basic-acl6-number</span></i> } [ <strong><span id="EN-US_TASK_0172374906__cmdparmname431232168214034">match-order</span></strong> { <strong><span id="EN-US_TASK_0172374906__cmdparmname520770577214034">config</span></strong> | <strong><span id="EN-US_TASK_0172374906__cmdparmname1339553828214034">auto</span></strong> } ]</span> command.</p>
</li><li><p>For an advanced ACL (ACL number ranging from 3000 to 3999), run the <span><a href="cmdqueryname=acl+ipv6"><b><span class="cmdname" id="EN-US_TASK_0172374906__cmdname1771878164213919">acl ipv6</span></b></a> { <strong><span id="EN-US_TASK_0172374906__cmdparmname2146547182213919">name</span></strong> <i><span class="varname" id="EN-US_TASK_0172374906__varname133037961213919">advance-acl6-name</span></i> [ <strong><span id="EN-US_TASK_0172374906__cmdparmname828016576213919">advance</span></strong> | [ <strong><span id="EN-US_TASK_0172374906__cmdparmname1484573091213919">advance</span></strong> ] <strong><span id="EN-US_TASK_0172374906__cmdparmname1604452427213919">number</span></strong> <i><span class="varname" id="EN-US_TASK_0172374906__varname107241100213919">advance-acl6-number</span></i> ] | [ <strong><span id="EN-US_TASK_0172374906__cmdparmname1971496885213919">number</span></strong> ] <i><span class="varname" id="EN-US_TASK_0172374906__varname2140889519213919">advance-acl6-number</span></i> } [ <strong><span id="EN-US_TASK_0172374906__cmdparmname1692141329213919">match-order</span></strong> { <strong><span id="EN-US_TASK_0172374906__cmdparmname211691899213919">config</span></strong> | <strong><span id="EN-US_TASK_0172374906__cmdparmname1181058952213919">auto</span></strong> } ]</span> command.</p>
</li></ul>
</p></li><li class="substepexpand"><span>Run either of the following commands to create an ACL rule:</span><p><ul><li id="EN-US_TASK_0172374906__li587577467214110"><p id="EN-US_TASK_0172374906__p1284678963214110"><a name="EN-US_TASK_0172374906__li587577467214110"></a><a name="li587577467214110"></a>For a basic ACL6 (ACL number ranging from 2000 to 2999), run the <span><a href="cmdqueryname=rule"><b><span class="cmdname" id="EN-US_TASK_0172374906__cmdname2556413218">rule</span></b></a> [ <i><span class="varname" id="EN-US_TASK_0172374906__varname8556419214">rule-id</span></i> ] [ <strong><span id="EN-US_TASK_0172374906__cmdparmname8554412218">name</span></strong> <i><span class="varname" id="EN-US_TASK_0172374906__varname125510432118">rule-name</span></i> ] { <strong><span id="EN-US_TASK_0172374906__cmdparmname1355164192115">deny</span></strong> | <strong><span id="EN-US_TASK_0172374906__cmdparmname45514202111">permit</span></strong> } [ <strong><span id="EN-US_TASK_0172374906__cmdparmname25517472110">fragment</span></strong> | <strong><span id="EN-US_TASK_0172374906__cmdparmname185554132112">source</span></strong> { <i><span class="varname" id="EN-US_TASK_0172374906__varname135510417216">source-ipv6-address</span></i> <span>{ </span><i><span class="varname" id="EN-US_TASK_0172374906__varname355342215">prefix-length</span></i><span> | <i><span class="varname" id="EN-US_TASK_0172374906__varname12555414218">source-wildcard</span></i> }</span> | <i><span class="varname" id="EN-US_TASK_0172374906__varname11551941211">source-ipv6-address</span></i>/<i><span class="varname" id="EN-US_TASK_0172374906__varname1355104152114">prefix-length</span></i> | <strong><span id="EN-US_TASK_0172374906__cmdparmname115594152118">any</span></strong> } | <strong><span id="EN-US_TASK_0172374906__cmdparmname55518412211">time-range</span></strong> <i><span class="varname" id="EN-US_TASK_0172374906__varname11551462114">time-name</span></i> | <span>[ </span><strong><span id="EN-US_TASK_0172374906__cmdparmname6557462113">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0172374906__varname85513452119">vpn-instance-name</span></i><span> | <strong><span id="EN-US_TASK_0172374906__cmdparmname4551446211">vpn-instance-any</span></strong> ]</span> | <strong><span id="EN-US_TASK_0172374906__cmdparmname35510416215">logging</span></strong> ] <sup id="EN-US_TASK_0172374906__sup9554472112">*</sup></span> command.</p>
</li></ul>
<ul><li id="EN-US_TASK_0172374906__li5600359213"><p id="EN-US_TASK_0172374906__p26023582118"><a name="EN-US_TASK_0172374906__li5600359213"></a><a name="li5600359213"></a>For an advanced ACL6 (ACL number ranging from 3000 to 3999), run:</p>
<p id="EN-US_TASK_0172374906__p1460173582115"><span><a href="cmdqueryname=rule"><b><span class="cmdname" id="EN-US_TASK_0172374906__cmdname1460153542116">rule</span></b></a> [ <i><span class="varname" id="EN-US_TASK_0172374906__varname20605356214">rule-id</span></i> ] [ <strong><span id="EN-US_TASK_0172374906__cmdparmname1160535132118">name</span></strong> <i><span class="varname" id="EN-US_TASK_0172374906__varname156013352212">rule-name</span></i> ] { <strong><span id="EN-US_TASK_0172374906__cmdparmname46043516211">permit</span></strong> | <strong><span id="EN-US_TASK_0172374906__cmdparmname176043513211">deny</span></strong> } { <i><span class="varname" id="EN-US_TASK_0172374906__varname260113532119">protocol</span></i> | <strong><span id="EN-US_TASK_0172374906__cmdparmname36023516218">udp</span></strong> } [ [ <strong><span id="EN-US_TASK_0172374906__cmdparmname116012352211">dscp</span></strong> <i><span class="varname" id="EN-US_TASK_0172374906__varname1860535102111">dscp</span></i> | [ <strong><span id="EN-US_TASK_0172374906__cmdparmname960335132111">precedence</span></strong> <i><span class="varname" id="EN-US_TASK_0172374906__varname16033515211">precedence</span></i> | <strong><span id="EN-US_TASK_0172374906__cmdparmname2060183572119">tos</span></strong> <i><span class="varname" id="EN-US_TASK_0172374906__varname86093512112">tos</span></i> ] <sup id="EN-US_TASK_0172374906__sup17603359216">*</sup> ] | <strong><span id="EN-US_TASK_0172374906__cmdparmname1460435162113">destination</span></strong> { <i><span class="varname" id="EN-US_TASK_0172374906__varname1460143542117">destination-ipv6-address</span></i> <i><span class="varname" id="EN-US_TASK_0172374906__varname13601435192117">prefix-length</span></i> | <i><span class="varname" id="EN-US_TASK_0172374906__varname460735142112">destination-ipv6-address</span></i>/<i><span class="varname" id="EN-US_TASK_0172374906__varname18601135152118">prefix-length</span></i> | <strong><span id="EN-US_TASK_0172374906__cmdparmname76063522118">any</span></strong> } | <strong><span id="EN-US_TASK_0172374906__cmdparmname26015352212">destination-port</span></strong> <i><span class="varname" id="EN-US_TASK_0172374906__varname1660135152119">operator</span></i> <i><span class="varname" id="EN-US_TASK_0172374906__varname7601635112118">port</span></i> | <strong><span id="EN-US_TASK_0172374906__cmdparmname1360135192120">fragment</span></strong> | <strong><span id="EN-US_TASK_0172374906__cmdparmname760173517211">source</span></strong> { <i><span class="varname" id="EN-US_TASK_0172374906__varname176083512115">source-ipv6-address</span></i> <i><span class="varname" id="EN-US_TASK_0172374906__varname1760193592119">prefix-length</span></i> | <i><span class="varname" id="EN-US_TASK_0172374906__varname160235172116">source-ipv6-address</span></i>/<i><span class="varname" id="EN-US_TASK_0172374906__varname160143552118">prefix-length</span></i> | <strong><span id="EN-US_TASK_0172374906__cmdparmname26053532118">any</span></strong> }<span> <strong><span id="EN-US_TASK_0172374906__cmdparmname16608357218">source-pool</span></strong> <i><span class="varname" id="EN-US_TASK_0172374906__varname360203511219">source-pool-name</span></i> }</span> | <strong><span id="EN-US_TASK_0172374906__cmdparmname36011355214">source-port</span></strong> <i><span class="varname" id="EN-US_TASK_0172374906__varname10601235122117">operator</span></i> <i><span class="varname" id="EN-US_TASK_0172374906__varname11601735192114">port</span></i> | <strong><span id="EN-US_TASK_0172374906__cmdparmname16602352218">time-range</span></strong> <i><span class="varname" id="EN-US_TASK_0172374906__varname1261735112116">time-name</span></i> | <span>[ </span><strong><span id="EN-US_TASK_0172374906__cmdparmname9611635192111">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0172374906__varname13611635132118">vpn-instance-name</span></i><span> | <strong><span id="EN-US_TASK_0172374906__cmdparmname76113514210">vpn-instance-any</span></strong> ]</span> ] <sup id="EN-US_TASK_0172374906__sup1661143512211">*</sup></span></p>
<p id="EN-US_TASK_0172374906__p561735152116">The preceding configuration uses UDP as the example protocol. The configurations of the other protocols are similar. For details, see the <strong id="EN-US_TASK_0172374906__b1189231932213">rule (Advanced ACL6 view) (tcp)</strong>, <strong id="EN-US_TASK_0172374906__b161265465119">rule (Advanced ACL6 view) (icmpv6)</strong>, and <strong id="EN-US_TASK_0172374906__b3313141365211">rule (Advanced ACL6 view) (protocol)</strong> commands.</p>
</li></ul>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>A source IP address is usually configured in an ACL rule.</p>
<p>To add multiple rules in an ACL, repeat Step c.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li></ol>
</li><li><span>Configure a traffic classifier.</span><ol type="a"><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=traffic+classifier"><b><span class="cmdname">traffic classifier</span></b></a> <i><span class="varname">classifier-name</span></i> [ <strong><span>operator</span></strong> { <strong><span>and</span></strong> | <strong><span>or</span></strong> } ]</span></span><p><p>A traffic classifier is configured, and the traffic classifier view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=if-match+ipv6+acl"><b><span class="cmdname">if-match ipv6 acl</span></b></a> <i><span class="varname">acl-number</span></i></span></span><p><p>A matching rule for multi-field (MA) traffic classification based on an ACL is configured.</p>
<p>To configure multiple matching rules based on ACLs, repeat Step c. Traffic matching the ACL rule must have the destination addresses with the prefix defined in the NAT64 instance.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li></ol>
</li><li><span>Configure a traffic behavior.</span><ol type="a"><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=traffic+behavior"><b><span class="cmdname">traffic behavior</span></b></a> <i><span class="varname">behavior-name</span></i></span></span><p><p>A traffic behavior is configured, and the traffic behavior view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=nat64+bind+instance"><b><span class="cmdname">nat64 bind instance</span></b></a> <i><span class="varname">instance-name</span></i></span></span><p><p>The traffic behavior is bound to a NAT64 instance.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li></ol>
</li><li><span>Configure a traffic policy.</span><ol type="a"><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=traffic+policy"><b><span class="cmdname">traffic policy</span></b></a> <i><span class="varname">policy-name</span></i></span></span><p><p>A traffic policy is configured, and the traffic policy view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=classifier"><b><span class="cmdname">classifier</span></b></a> <i><span class="varname">classifier-name</span></i> <strong><span>behavior</span></strong> <i><span class="varname">behavior-name</span></i></span></span><p><p>A traffic behavior is specified for a specified traffic classifier in the traffic policy.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li></ol>
</li><li><span>Apply the traffic policy to an interface.</span><p><p># In centralized NAT64 scenarios, apply the traffic policy to Layer 3 interfaces for Layer 3 traffic sent by the network side.</p>
</p><ol type="a"><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span></span><p><p>The interface view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=traffic-policy"><b><span class="cmdname">traffic-policy</span></b></a> <i><span class="varname">policy-name</span></i> <strong><span>inbound</span></strong> [ <strong><span>link-layer</span></strong> | <strong><span>all-layer</span></strong> | <strong><span>mpls-layer</span></strong> ]</span></span><p><p>A traffic policy is applied to an interface.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
<p><p># In centralized NAT64 scenarios, apply the traffic policy to Layer 2 VLANIF member interfaces for VLANIF interface traffic sent by the network side.</p>
</p><ol type="a"><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span></span><p><p>The interface view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=portswitch"><b><span class="cmdname">portswitch</span></b></a></span></span><p><p>The Layer 3 interface is switched to a Layer 2 interface.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=traffic-policy"><b><span class="cmdname">traffic-policy</span></b></a> <i><span class="varname">policy-name</span></i> <strong><span>inbound</span></strong> <strong><span>vlan</span></strong> { <strong><span>all</span></strong> | <i><span class="varname">vlan-id1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id2</span></i> ] } [ <strong><span>link-layer</span></strong> | <strong><span>all-layer</span></strong> | <strong><span>mpls-layer</span></strong> ]</span></span><p><p>A traffic policy is applied to the Layer 2 interface.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat64_cfg_0013.html">(Optional) Configuring Centralized NAT64 Translation
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat64_cfg_0015_m2k.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>