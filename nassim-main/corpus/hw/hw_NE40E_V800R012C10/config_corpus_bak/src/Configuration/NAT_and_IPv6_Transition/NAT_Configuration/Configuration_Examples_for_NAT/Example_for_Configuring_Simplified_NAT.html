
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Simplified NAT">
<meta name="abstract" content="This section provides an example for configuring the simplified NAT function to implement many-to-many IP address translation between private and public networks and allow PCs on a specified network segment to access the Internet.">
<meta name="description" content="This section provides an example for configuring the simplified NAT function to implement many-to-many IP address translation between private and public networks and allow PCs on a specified network segment to access the Internet.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0056.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0057_1.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0095.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="c00549182">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="c00549182">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172374585">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Simplified NAT</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172374585"></a><a name="EN-US_TASK_0172374585"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Simplified NAT</h1>
<div class="taskbody"><p>This section provides an example for configuring the simplified NAT function to implement many-to-many IP address translation between private and public networks and allow PCs on a specified network segment to access the Internet.</p>
<div class="context"><a name="EN-US_TASK_0172374585__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0172374585__fig_dc_ne_cfg_nat_005701">Figure 1</a>, the <span class="keyword">Router</span> performs the NAT function to help PCs within the enterprise network access the Internet. The <span class="keyword">Router</span> uses GE<span>0/2/0</span> to connect to the enterprise network and uses GE<span>0/2/1</span> to connect to the Internet. The enterprise is assigned five public IP addresses: 11.11.11.101/32 through 11.11.11.105/32.</p>
<div class="p"><a href="#EN-US_TASK_0172374585__fig_dc_ne_cfg_nat_005701">Figure 1</a> shows IP addresses of interfaces. The configuration requirements are as follows:<ul><li>Only PCs on the network segment of 192.168.10.0/24 can access the Internet.</li><li>Many-to-many NAT needs to be performed for IP addresses between the private and public networks.</li></ul>
</div>
<div class="fignone" id="EN-US_TASK_0172374585__fig_dc_ne_cfg_nat_005701"><a name="EN-US_TASK_0172374585__fig_dc_ne_cfg_nat_005701"></a><a name="fig_dc_ne_cfg_nat_005701"></a><span class="figcap"><b>Figure 1 </b>NAT networking</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent GE<span>0/2/0</span> and GE<span>0/2/1</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_ne_cfg_nat_0009.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172374585__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Configure basic simplified NAT functions.</li><li>Configure a simplified NAT traffic diversion policy.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172374585__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><div class="p">To complete the configuration, you need the following data:<ul><li><p>NAT instance name (nat1) and index (1)</p>
</li><li><p>NATA's NAT address pool name (address-group1), address pool number (1), a range of public IP addresses (11.11.11.101 through 11.11.11.105)</p>
</li><li><p>ACL number: 3001</p>
</li><li><p>Name and IP address of the interface to which a NAT traffic diversion policy is applied</p>
</li></ul>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172374585__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure basic NAT functions.</span><ol type="a"><li class="substepexpand"><span>Create a NAT instance named <strong>nat1</strong>.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA] <strong>nat instance nat1 id 1 simple-configuration</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NATA-nat-instance-nat1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA-nat-instance-nat1] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Configure a NAT address pool with addresses ranging from 11.11.11.101 to 11.11.11.105.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA] <strong>nat address-group address-group1 group-id 1 11.11.11.101 11.11.11.105</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NATA] <strong>commit</strong></pre>
</p></li></ol>
</li><li><span>Configure a NAT traffic diversion policy. Simplified NAT supports only outbound interface-based traffic diversion.</span><ol type="a"><li class="substepexpand"><span>Configure an ACL numbered <strong>3001</strong> and an ACL rule numbered <strong>1</strong> to allow hosts only within the network segment 192.168.10.0/24 to access the Internet.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA] <strong>acl 3001</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NATA-acl4-advance-3001] <strong>rule 1 permit ip source 192.168.10.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NATA-acl4-advance-3001] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA-acl4-advance-3001] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Apply the ACL-based traffic classification policy in the view of GE <span>0/2/1</span>. You can bind the traffic diversion policy either to the instance or to the address pool on one interface.</span><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>For simplified NAT, if only one address pool exists, you can bind either an instance or an address pool. If multiple address pools and outbound interfaces exist and address pools are specified in the outbound interface view for public address pool translation, you need to bind address pools.</p>
</div></div>
</p><p><ul><li>Bind the policy to the address pool.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA] <strong>interface gigabitEthernet <span>0/2/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA-GigabitEthernet<span>0/2/1</span>] <strong>ip address 1.1.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NATA-GigabitEthernet<span>0/2/1</span>] <strong>nat bind acl 3001 address-group address-group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NATA-GigabitEthernet<span>0/2/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA-GigabitEthernet<span>0/2/1</span>] <strong>quit</strong></pre>
</li></ul>
<ul><li>Bind the policy to the NAT instance.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA] <strong>interface gigabitEthernet <span>0/2/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA-GigabitEthernet<span>0/2/1</span>] <strong>ip address 1.1.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NATA-GigabitEthernet<span>0/2/1</span>] <strong>nat bind acl 3001 instance nat1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>NATA-GigabitEthernet<span>0/2/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA-GigabitEthernet<span>0/2/1</span>] <strong>quit</strong></pre>
</li></ul>
</p></li></ol>
</li><li><span>Verify the configuration.</span><p><p># Check NAT user information.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA] <strong>display nat user-information slot <span>3</span> verbose</strong></pre>
<pre class="screen">This operation will take a few minutes. Press 'Ctrl+C' to break ...             
Slot: <span>3</span> 
Total number:  1.                                                          
  ---------------------------------------------------------------------------                                                       
  User Type                             :  NAT444                                                                                   
  CPE IP                                :  192.168.10.100                                                                                 
  User ID                               :  -                                                                                        
  VPN Instance                          :  -                                                                                        
  Address Group                         :  address-group1                                                                                       
  NAT Instance                          :  nat1                                                                                       
  Public IP                             :  11.11.11.101                                                                                
  Total/TCP/UDP/ICMP Session Limit      :  8192/10240/10240/512                                                                                  
  Total/TCP/UDP/ICMP Session Current    :  1/0/1/0                                                                          
  Total/TCP/UDP/ICMP Rev Session Limit  :  8192/10240/10240/512                                                                     
  Total/TCP/UDP/ICMP Rev Session Current:  0/0/0/0                                                                                  
  Nat ALG Enable                        :  NULL                                                                                     
  Aging Time(s)                         :  -                                                                                        
  Left Time(s)                          :  -                                                                                        
  Session Limit Discard Count           :  0                                                                                        
  --&gt;Transmit Packets                   :  9753259                                                                                  
  --&gt;Transmit Bytes                     :  1111770864                                                                               
  --&gt;Drop Packets                       :  0                                                                                        
  &lt;--Transmit Packets                   :  0                                                                                        
  &lt;--Transmit Bytes                     :  0                                                                                        
  &lt;--Drop Packets                       :  0                                                                                        
  --------------------------------------------------------------------------- </pre>
<p># Check the address pool of the simplified instance.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>display nat simple-configuration address-group</strong></pre>
<pre class="screen">2019-02-19 10:21:03.156
nat address-group address-group1 group-id 1 11.11.11.101 11.11.11.105</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172374585__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><p>NATA configuration file when a NAT traffic diversion policy is used on an outbound interface (In this configuration file, the traffic diversion policy is bound to the NAT address pool.)</p>
<pre class="screen">#
sysname NATA
#
nat instance nat1 id 1 simple-configuration
#
nat address-group address-group1 group-id 1 11.11.11.101 11.11.11.105
#
acl number 3001
 rule 1 permit ip source 192.168.10.0 0.0.0.255
#
interface GigabitEthernet <span>0/2/1</span>
 undo shutdown
 ip address 1.1.1.1 255.255.255.0
 nat bind acl 3001 address-group address-group1
#
interface GigabitEthernet <span>0/2/0</span>
 undo shutdown
 ip address 192.168.10.1 255.255.255.0
#
return
</pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0056.html">Configuration Examples for NAT
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0057_1.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0095.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>