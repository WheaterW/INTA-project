
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Creating a NAT Address Pool">
<meta name="abstract" content="You can create a NAT address pool and bind it to a NAT instance to translate between private and public IPv4 addresses.">
<meta name="description" content="You can create a NAT address pool and bind it to a NAT instance to translate between private and public IPv4 addresses.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0010.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0012.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0112_1.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="c00549182">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="c00549182">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172374495">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Creating a NAT Address Pool</title>
</head>
<body><a name="EN-US_TASK_0172374495"></a><a name="EN-US_TASK_0172374495"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Creating a NAT Address Pool</h1>
<div class="taskbody"><p>You can create a NAT address pool and bind it to a NAT instance to translate between private and public IPv4 addresses.</p>
<div class="context"><a name="EN-US_TASK_0172374495__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>A NAT address pool can be configured in a NAT instance for address translation based on 5-tuple<span> or 3-tuple</span> information in user packets.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172374495__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=nat+instance+id"><b><span class="cmdname">nat instance</span></b></a> <i><span class="varname">instance-name</span></i> [ <strong><span>id</span></strong> <i><span class="varname">id</span></i> ]</span><p><p>The NAT instance view is displayed.</p>
</p></li><li><span>Use the non-Easy IP <span>or Easy IP</span> mode to configure a NAT address pool.</span><p><ul><li><p>In non-Easy IP mode, create or enter a NAT address pool. When a device performs NAT to access the public network, the device obtains a public IP address from the address pool as the source IP address.</p>
<ul><li><p>Run the <a href="cmdqueryname=nat+address-group+group-id+mask+vpn-instance+no-pat"><b><span class="cmdname">nat address-group</span></b></a> <i><span class="varname">address-group-name</span></i> [ <strong><span>group-id</span></strong> <i><span class="varname">id</span></i> ] [ <i><span class="varname">start-address</span></i> { <strong><span>mask</span></strong> { <i><span class="varname">address-mask-length</span></i> | <i><span class="varname">address-mask</span></i> } | <i><span class="varname">end-address</span></i> } ] [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] [ <strong><span>no-pat</span></strong> ] command.</p>
<p>When the <a href="cmdqueryname=nat+address-group+group-id"><b><span class="cmdname">nat address-group</span></b></a> mode is used to create a NAT address pool, the <strong><span>group-id</span></strong> parameter needs to be specified. <i><span class="varname">id</span></i> specifies the ID of an address pool. Different address pools have different IDs.</p>
<div class="p">The <a href="cmdqueryname=nat+address-group"><b><span class="cmdname">nat address-group</span></b></a> command configures a range of public IP addresses in a single public address pool. The configuration mode can be one of the following:<ul><li>Specify the <strong>mask</strong> parameter in the <a href="cmdqueryname=nat+address-group"><b><span class="cmdname">nat address-group</span></b></a> command. The device generates the same number of public UNR routes as there are NAT address pools, and each route mask is the same as the mask specified in the corresponding command.</li><li>Specify the start and end IP addresses (i.e., <strong>start-end</strong> mode) in the <a href="cmdqueryname=nat+address-group"><b><span class="cmdname">nat address-group</span></b></a> command. The device generates the same number of public UNR routes as there are public IP addresses in the range specified by the <strong>start-end</strong> mode. The mask of the public UNR routes is 32 bits. For details about UNR routes, see <a href="dc_ne_feature_013010.html">UNR Route Feature Description</a></li></ul>
</div>
</li><li><p>Run the <a href="cmdqueryname=nat+address-group"><b><span class="cmdname">nat address-group</span></b></a> <i><span class="varname">address-group-name</span></i> command to enter the NAT address pool view, and then run the <a href="cmdqueryname=section+mask"><b><span class="cmdname">section</span></b></a> <i><span class="varname">section-num</span></i> <i><span class="varname">start-ip-address</span></i> { <strong><span>mask</span></strong> { <i><span class="varname">mask-length</span></i> | <i><span class="varname">mask-ip</span></i> } | <i><span class="varname">end-ip-address</span></i> } command.</p>
<div class="p">The <a href="cmdqueryname=section"><b><span class="cmdname">section</span></b></a> command configures multiple public IP address ranges in a single public IP address pool. The configuration mode can be one of the following:<ul><li>Specify the <strong>mask</strong> parameter in the <a href="cmdqueryname=section"><b><span class="cmdname">section</span></b></a> command. The device generates the same number of public UNR routes as there are sections, and each route mask is the same as the mask specified in the corresponding command.</li><li>Specify the start and end IP addresses (i.e., <strong>start-end</strong> mode) in the <a href="cmdqueryname=section"><b><span class="cmdname">section</span></b></a> command. The device generates the same number of public UNR routes as there are public IP addresses in the range specified by the <strong>start-end</strong> mode. The mask of the public UNR routes is 32 bits. For details about UNR routes, see <a href="dc_ne_feature_013010.html">UNR Route Feature Description</a></li></ul>
</div>
<p>The <strong>mask</strong> mode is recommended. With this mode enabled in NAT public IP address pools, the mask of each public UNR route to be advertised is the same as the mask specified in the <a href="cmdqueryname=nat+address-group"><b><span class="cmdname">nat address-group</span></b></a> command. In <strong>start-end</strong> mode, the mask of public UNR routes to be advertised is 32 bits.</p>
</li></ul>
</li><li><p>In Easy IP mode, create the reusing relationship between a NAT address pool and an interface IP address and use the interface address to access the public network.</p>
<ul><li><p>Run the <a href="cmdqueryname=nat+address-group+group-id+unnumbered+interface"><b><span class="cmdname">nat address-group</span></b></a> <i><span class="varname">address-group-name</span></i> <strong><span>group-id</span></strong> <i><span class="varname">id</span></i> <strong><span>unnumbered interface</span></strong> { <i><span class="varname">interface-name</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> } command.</p>
<p></p>
</li><li><p>Run the <a href="cmdqueryname=nat+address-group"><b><span class="cmdname">nat address-group</span></b></a> <i><span class="varname">address-group-name</span></i> command to enter the NAT address pool view and then the <a href="cmdqueryname=section+unnumbered+interface"><b><span class="cmdname">section</span></b></a> <i><span class="varname">section-num</span></i> <strong><span>unnumbered interface</span></strong> { <i><span class="varname">interface-name</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> } command.</p>
</li></ul>
</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>A NAT address pool cannot contain a DHCP server address. You need to properly allocate address segments. Otherwise, NAT traffic cannot be forwarded.</p>
</div></div>
</p></li><li><span>(Optional) Create a NAT overloaded address pool and bind the public address pool to this overloaded address pool.</span><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Only the <span class="keyword">NE40E</span><span class="keyword">-M2K</span> and <span class="keyword">NE40E</span><span class="keyword">-M2K-B</span> support this configuration.</p>
</div></div>
<ol type="a"><li><p>Configure a NAT overloaded address pool or enter the view of a NAT overloaded address pool.</p>
<div class="p">You can configure an address segment for the NAT overloaded address pool using either of the following methods:<ul><li><p>Method 1: Run the <a href="cmdqueryname=nat+address-group+group-id+mask+vpn-instance+over-load"><b><span class="cmdname">nat address-group</span></b></a> <i><span class="varname">address-group-name</span></i> <strong><span>group-id</span></strong> <i><span class="varname">group-id</span></i> <i><span class="varname">start-address</span></i> { <strong><span>mask</span></strong> { <i><span class="varname">address-mask-length</span></i> | <i><span class="varname">address-mask</span></i> } | <i><span class="varname">end-address</span></i> } [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <strong><span>over-load</span></strong> command directly in the NAT instance view.</p>
</li><li><p>Method 2: Run the <a href="cmdqueryname=nat+address-group+group-id+vpn-instance+over-load"><b><span class="cmdname">nat address-group</span></b></a> <i><span class="varname">address-group-name</span></i> [ <strong><span>group-id</span></strong> <i><span class="varname">group-id</span></i> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] ] <strong><span>over-load</span></strong> command to enter the NAT overloaded address pool view first, and then run the <a href="cmdqueryname=section+mask"><b><span class="cmdname">section</span></b></a> <i><span class="varname">section-num</span></i> <i><span class="varname">start-ip-address</span></i> { <strong><span>mask</span></strong> { <i><span class="varname">mask-length</span></i> | <i><span class="varname">mask-ip</span></i> } | <i><span class="varname">end-ip-address</span></i> } command.</p>
</li></ul>
</div>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p">Note the following issues when configuring a NAT overloaded address pool:<ul><li><p>The common IP address pool in no-PAT mode cannot be used as a NAT overloaded address pool.</p>
</li><li><p>The address pool created in Easy IP mode cannot be used as, or bound to a NAT overloaded address pool.</p>
</li><li><p>The <a href="cmdqueryname=nat+outbound"><b><span class="cmdname">nat outbound</span></b></a> command cannot be run for a NAT overloaded address pool to configure a NAT conversion policy.</p>
</li></ul>
</div>
</div></div>
</li><li><p>Run the <a href="cmdqueryname=nat+address-group+bind-over-load"><b><span class="cmdname">nat address-group</span></b></a> <i><span class="varname">address-group-name</span></i> <strong><span>bind-over-load</span></strong> <i><span class="varname">address-group-name</span></i> command to bind a common address pool to the overloaded address pool.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p">After the common address pool is bound to the NAT overloaded address pool, note the following:<ul><li><p><a href="#EN-US_TASK_0172374495__exclude-ip">Step 5</a> is not allowed. This is because the binding is mutually exclusive with the <a href="cmdqueryname=nat+address-group+exclude-ip-address"><b><span class="cmdname">nat address-group exclude-ip-address</span></b></a> and <a href="cmdqueryname=section+exclude-ip-address"><b><span class="cmdname">section exclude-ip-address</span></b></a> commands.</p>
</li><li><p>The NAT instance in which the binding is configured cannot be configured as a load-balancing instance group.</p>
</li></ul>
</div>
</div></div>
</li></ol>
</p></li><li id="EN-US_TASK_0172374495__exclude-ip"><span id="EN-US_TASK_0172374495__">(Optional) Exclude an IP address or IP address range from a NAT address pool.</span><p><ul><li>If the <a href="cmdqueryname=nat+address-group"><b><span class="cmdname">nat address-group</span></b></a> mode is used, run the <a href="cmdqueryname=nat+address-group+exclude-ip-address"><b><span class="cmdname">nat address-group</span></b></a> <i><span class="varname">address-group-name</span></i> <strong><span>exclude-ip-address</span></strong> <i><span class="varname">start-address</span></i> [ <i><span class="varname">end-address</span></i> ] command.</li><li>If the <a href="cmdqueryname=section"><b><span class="cmdname">section</span></b></a> mode is used, run the <a href="cmdqueryname=section+exclude-ip-address"><b><span class="cmdname">section</span></b></a> <i><span class="varname">section-id</span></i> <strong><span>exclude-ip-address</span></strong> <i><span class="varname">start-address</span></i> [ <i><span class="varname">end-address</span></i> ] command.</li></ul>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=section+lock"><b><span class="cmdname">section</span></b></a> <i><span class="varname">section-num</span></i> <strong><span>lock</span></strong></span><p><p>An address segment in the address pool is locked.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Only the <span class="keyword">NE40E</span><span class="keyword">-M2K</span> and <span class="keyword">NE40E</span><span class="keyword">-M2K-B</span> support this configuration.</p>
</div></div>
<p>IP addresses in the locked address segment cannot be allocated to users anymore. To unlock this address segment, run the <a href="cmdqueryname=undo+section+lock"><b><span class="cmdname">undo section</span></b></a> <i><span class="varname">section-num</span></i> <strong><span>lock</span></strong> command.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the NAT instance view.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=nat+filter+mode+full-cone+5-tuple-session"><b><span class="cmdname">nat filter mode full-cone</span></b></a> [ <strong><span>5-tuple-session</span></strong> ]</span><p><p>The address translation mode of all address pools is set to the full-cone mode in the NAT instance.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Only the <span class="keyword">NE40E</span><span class="keyword">-M2K</span> and <span class="keyword">NE40E</span><span class="keyword">-M2K-B</span> support this configuration.</p>
</div></div>
<p>To configure the full-cone mode (3-tuple mode) to be implemented based on 5-tuple sessions in a NAT instance, run the <a href="cmdqueryname=nat+filter+mode+full-cone+5-tuple-session"><b><span class="cmdname">nat filter mode full-cone</span></b></a> <strong><span>5-tuple-session</span></strong> command. In a NAT444 scenario, when the full-cone mode is configured and a private network source communicates with multiple public network destinations, to record session logs of each destination, 5-tuple sessions are used for the full-cone mode. In this situation, 5- and 3-tuple sessions are generated, with both consuming session license resources.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=nat+no-pat+enhance"><b><span class="cmdname">nat no-pat enhance</span></b></a></span><p><p>The no-PAT conversion function is enabled for all IP protocol packets.</p>
<p>After this command is run, the address pool mode in the instance can only be no-PAT, and the PAT and no-PAT address pools cannot both be configured.</p>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0010.html">Configuring Basic NAT Functions
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0012.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0112_1.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>