
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a Manual IPv6 over IPv4 Tunnel">
<meta name="abstract" content="This section provides an example for configuring a manual IPv6 over IPv4 tunnel.">
<meta name="description" content="This section provides an example for configuring a manual IPv6 over IPv4 tunnel.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_6o4tnl_cfg_0008.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_6o4tnl_cfg_0010.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="c00549182">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPv6 over IPv4">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv6 over IPv4">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="IPv6 over IPv4">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="IPv6 over IPv4">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="g00814582">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172365296">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring a Manual IPv6 over IPv4 Tunnel</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172365296"></a><a name="EN-US_TASK_0172365296"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a Manual IPv6 over IPv4 Tunnel</h1>
<div class="taskbody"><p>This section provides an example for configuring a manual IPv6 over IPv4 tunnel.</p>
<div class="context"><a name="EN-US_TASK_0172365296__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0172365296__fig_dc_vrp_6o4tnl_cfg_000901">Figure 1</a>, two IPv6 networks are connected to <span class="keyword">Device</span>B on the IPv4 backbone network through <span class="keyword">Device</span>A and <span class="keyword">Device</span>C. To interconnect the two IPv6 networks, configure a manual IPv6 over IPv4 tunnel between <span class="keyword">Device</span>A and <span class="keyword">Device</span>C.</p>
<div class="fignone" id="EN-US_TASK_0172365296__fig_dc_vrp_6o4tnl_cfg_000901"><a name="EN-US_TASK_0172365296__fig_dc_vrp_6o4tnl_cfg_000901"></a><a name="fig_dc_vrp_6o4tnl_cfg_000901"></a><span class="figcap"><b>Figure 1 </b>Networking diagram for configuring a manual IPv6 over IPv4 tunnel</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent GE <span>0/1/0</span> and GE <span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_6o4tnl_cfg_000901.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365296__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>When configuring a manual IPv6 over IPv4 tunnel, note the following points:</p>
<ul><li><p>Create a tunnel interface and set parameters for the tunnel interface.</p>
</li><li><p>Perform the following configuration on the <span class="keyword">Router</span>s at both ends of the tunnel. The source IP address of the local end is the destination IP address of the remote end of the tunnel. Similarly, the destination IP address of the local end is the source IP address of the remote end.</p>
</li><li><p>Configure an IP address for the tunnel interface to support routing protocols.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365296__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Assign an IP address to each physical interface.</p>
</li><li><p>Configure IPv6 addresses for tunnel interfaces and source and destination addresses for the involved tunnel.</p>
</li><li><p>Set the protocol type to IPv6-IPv4.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365296__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IP addresses of interfaces</p>
</li><li><p>IPv6 addresses of the tunnel interfaces, and source and destination addresses of the tunnel</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172365296__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure IPv6 addresses for interfaces on <span class="keyword">Device</span>A, <span class="keyword">Device</span>B, and <span class="keyword">Device</span>C.</span><p><p># Configure <span class="keyword">Device</span>A.</p>
</p><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>A</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> ip address 192.168.50.2 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>]<strong> sysname <span class="keyword">Device</span>B</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>]<strong> ip address 192.168.50.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>]<strong> ip address 192.168.51.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span>C.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>]<strong> sysname <span class="keyword">Device</span>C</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/0</span>]<strong> ip address 192.168.51.2 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/0</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
</p></li><li><span>Create tunnel interfaces, and configure a tunnel mode, IPv6 addresses for the tunnel interfaces, and source and destination addresses for the tunnel.</span><p><p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> interface Tunnel 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel10]<strong> tunnel-protocol ipv6-ipv4</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel10]<strong> ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel10]<strong> ipv6 address 2001:db8::1 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel10]<strong> source 192.168.50.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel10]<strong> destination 192.168.51.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel10]<strong> quit</strong></pre>
</p><p><p># Configure <span class="keyword">Device</span>C.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C]<strong> interface Tunnel 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-Tunnel10]<strong> tunnel-protocol ipv6-ipv4</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-Tunnel10] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-Tunnel10]<strong> ipv6 address 2001:db8::2 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-Tunnel10]<strong> source 192.168.51.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-Tunnel10]<strong> destination 192.168.50.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-Tunnel10]<strong> quit</strong></pre>
</p></li><li><span>Configure static routes to ensure that <span class="keyword">Device</span>A and <span class="keyword">Device</span>C are reachable.</span><p><p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> ip route-static 192.168.51.0 255.255.255.0 192.168.50.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span>C.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C]<strong> ip route-static 192.168.50.0 255.255.255.0 192.168.51.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C]<strong> commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Ping the IPv4 address of GE <span>0/1/0</span> on <span class="keyword">Device</span>A from <span class="keyword">Device</span>C. <span class="keyword">Device</span> C can receive return packets from <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>ping</strong><strong> 192.168.50.2</strong></pre>
<pre class="screen">  PING 192.168.50.2: 56  data bytes, press CTRL_C to break</pre>
<pre class="screen">    Reply from 192.168.50.2: bytes=56 Sequence=1 ttl=254 time=84 ms</pre>
<pre class="screen">    Reply from 192.168.50.2: bytes=56 Sequence=2 ttl=254 time=27 ms</pre>
<pre class="screen">    Reply from 192.168.50.2: bytes=56 Sequence=3 ttl=254 time=25 ms</pre>
<pre class="screen">    Reply from 192.168.50.2: bytes=56 Sequence=4 ttl=254 time=3 ms</pre>
<pre class="screen">    Reply from 192.168.50.2: bytes=56 Sequence=5 ttl=254 time=24 ms</pre>
<pre class="screen">  --- 192.168.50.2 ping statistics ---</pre>
<pre class="screen">    5 packet(s) transmitted</pre>
<pre class="screen">    5 packet(s) received</pre>
<pre class="screen">    0.00% packet loss</pre>
<pre class="screen">    round-trip min/avg/max = 3/32/84 ms</pre>
<p># Ping the IPv6 address of Tunnel 10 on <span class="keyword">Device</span>A from <span class="keyword">Device</span>C. <span class="keyword">Device</span>C can receive return packets from <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>ping ipv6 2001:db8::1</strong></pre>
<pre class="screen">  PING 2001:db8::1 : 56  data bytes, press CTRL_C to break</pre>
<pre class="screen">    Reply from 2001:db8::1</pre>
<pre class="screen">    bytes=56 Sequence=1 hop limit=64  time = 28 ms</pre>
<pre class="screen">    Reply from 2001:db8::1</pre>
<pre class="screen">    bytes=56 Sequence=2 hop limit=64  time = 27 ms</pre>
<pre class="screen">    Reply from 2001:db8::1</pre>
<pre class="screen">    bytes=56 Sequence=3 hop limit=64  time = 26 ms</pre>
<pre class="screen">    Reply from 2001:db8::1</pre>
<pre class="screen">    bytes=56 Sequence=4 hop limit=64  time = 27 ms</pre>
<pre class="screen">    Reply from 2001:db8::1</pre>
<pre class="screen">    bytes=56 Sequence=5 hop limit=64  time = 26 ms</pre>
<pre class="screen">  --- 2001:db8::1 ping statistics ---</pre>
<pre class="screen">    5 packet(s) transmitted</pre>
<pre class="screen">    5 packet(s) received</pre>
<pre class="screen">    0.00% packet loss</pre>
<pre class="screen">round-trip min/avg/max = 26/26/28 ms</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172365296__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span>A configuration file</p>
<pre class="screen">#
 sysname <span class="keyword">Device</span>A
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 192.168.50.2 255.255.255.0
#
interface Tunnel 10
 ipv6 enable
 ipv6 address 2001:db8::1/64
 tunnel-protocol ipv6-ipv4
 source 192.168.50.2
 destination 192.168.51.2
#
ip route-static 192.168.51.0 255.255.255.0 192.168.50.1
#
return</pre>
</li><li><p><span class="keyword">Device</span>B configuration file</p>
<pre class="screen">#
 sysname <span class="keyword">Device</span>B
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 192.168.50.1 255.255.255.0
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 192.168.51.1 255.255.255.0
#
return</pre>
</li><li><p><span class="keyword">Device</span>C configuration file</p>
<pre class="screen">#
 sysname <span class="keyword">Device</span>C
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 192.168.51.2 255.255.255.0
#
interface Tunnel 10
 ipv6 enable
 ipv6 address 2001:db8::2/64
 tunnel-protocol ipv6-ipv4
 source 192.168.51.2
 destination 192.168.50.2
#
ip route-static 192.168.50.0 255.255.255.0 192.168.51.1
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_6o4tnl_cfg_0008.html">Configuration Examples for IPv6 over IPv4 Tunnel
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_6o4tnl_cfg_0010.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>