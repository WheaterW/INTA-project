
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring SPT Switchover Conditions">
<meta name="abstract" content="PIM-SM allows a Rendezvous Point (RP) or a receiver's Designated router (DR) to trigger a shortest path tree (SPT) switchover when the rate of multicast packets is high. You can configure SPT switchover conditions and set the interval for checking the forwarding rate of multicast packets on the receiver's DR.">
<meta name="description" content="PIM-SM allows a Rendezvous Point (RP) or a receiver's Designated router (DR) to trigger a shortest path tree (SPT) switchover when the rate of multicast packets is high. You can configure SPT switchover conditions and set the interval for checking the forwarding rate of multicast packets on the receiver's DR.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_0006.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_3153.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_0014.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172366840">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring SPT Switchover Conditions</title>
</head>
<body><a name="EN-US_TASK_0172366840"></a><a name="EN-US_TASK_0172366840"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring SPT Switchover Conditions</h1>
<div class="taskbody"><p>PIM-SM allows a Rendezvous Point (RP) or a receiver's Designated router (DR) to trigger a shortest path tree (SPT) switchover when the rate of multicast packets is high. You can configure SPT switchover conditions and set the interval for checking the forwarding rate of multicast packets on the receiver's DR.</p>
<div class="context"><a name="EN-US_TASK_0172366840__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>In PIM-SM forwarding, each multicast group corresponds to a rendezvous point tree (RPT) only. At first, all multicast sources encapsulate data in Register messages, and send the messages to the RP in unicast mode. The RP decapsulates the messages and forwards the data along the RPT.</p>
<p>Forwarding multicast data along an RPT has the following disadvantages:</p>
<ul><li><p>The source's DR and the RP need to frequently encapsulate and decapsulate messages.</p>
</li><li><p>The forwarding path may not be the shortest path from the source to receivers.</p>
</li><li><p>Heavy data traffic increases the load of the RP, which may cause a fault.</p>
</li></ul>
<p>The solutions to this problem are as follows:</p>
<ul><li><p>SPT switchover triggered by the RP</p>
<p>The RP sends a Join message to the source to create a multicast route along the shortest path from the source's DR to the RP. Then, subsequent multicast packets are directly transmitted along this path.</p>
</li><li><p>SPT switchover triggered by the receiver's DR</p>
<p>The receiver's DR checks the forwarding rate of multicast data. If the receiver's DR finds that the rate exceeds the threshold, the receiver's DR triggers the SPT switchover immediately. The receiver's DR then sends a Join message to the source to set up a multicast route along the shortest path from the source's DR to the receiver's DR. Subsequent packets are forwarded along this path.</p>
</li></ul>
<p>By default, the RP triggers the SPT switchover immediately after receiving the first Register message and the receiver's DR triggers the SPT switchover immediately after receiving the first multicast data packet. The <span class="keyword">Router</span> can work normally with default control parameters. You are allowed to adjust SPT switchover parameters based on the specific networking environment.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If there is no special requirement, default parameter values are recommended.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172366840__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Configure a basic numbered ACL or a named ACL as needed.</span><p><ul><li><p>Configure a basic numbered ACL.</p>
<ol type="a"><li>Run <span><a href="cmdqueryname=acl"><b><span class="cmdname">acl</span></b></a> [ <strong><span>number</span></strong> ] <i><span class="varname">basic-acl-number</span></i> [ <strong><span>match-order</span></strong> { <strong><span>auto</span></strong> | <strong><span>config</span></strong> } ]</span><p>A basic numbered ACL is created, and the basic numbered ACL view is displayed.</p>
</li><li>Run <span><a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> [ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>deny</span></strong> | <strong><span>permit</span></strong> } <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong> } | <strong><span>any</span></strong> }</span><p>Rules are configured for the basic numbered ACL.</p>
</li></ol>
</li><li><p>Configure a named ACL.</p>
<ol type="a"><li>Run <a href="cmdqueryname=acl"><b><span class="cmdname">acl</span></b></a> <strong><span>name</span></strong> <i><span class="varname">acl-name</span></i> <strong><span>basic</span></strong> [ <strong><span>match-order</span></strong> { <strong><span>auto</span></strong> | <strong><span>config</span></strong> } ]<p>A named ACL is created, and the named ACL view is displayed.</p>
</li><li>Run <span><a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> [ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>deny</span></strong> | <strong><span>permit</span></strong> } <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong> } | <strong><span>any</span></strong> }</span><p>Rules are configured for the named ACL.</p>
</li></ol>
</li></ul>
<p>If a basic numbered ACL is used, run the <a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> command and set the <strong><span>source</span></strong> parameter to a multicast group range to which the specified rate threshold applies.</p>
<p>If a named ACL is used, run the <a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> command and set the <strong><span>destination</span></strong> parameter to a multicast group range to which the specified rate threshold applies.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li><span>Run <a href="cmdqueryname=pim"><b><span class="cmdname">pim</span></b></a> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ]</span><p><p>The PIM view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=spt-switch-threshold"><b><span class="cmdname">spt-switch-threshold</span></b></a> { <i><span class="varname">traffic-rate</span></i> | <strong><span>infinity</span></strong> } [ <strong><span>group-policy</span></strong> { <i><span class="varname">basic-acl-number</span></i> | <strong><span>acl-name</span></strong> <i><span class="varname">acl-name</span></i> } [ <strong><span>order</span></strong> <i><span class="varname">order-value</span></i> ] ]</span><p><p>SPT switchover conditions are configured.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command takes effect on all <span class="keyword">Router</span>s that may function as a receiver's DRs, but does not take effect on the RP.</p>
</div></div>
<ul><li><p><i><span class="varname">traffic-rate</span></i>: specifies the rate threshold of the multicast data at which the receiver's DR triggers the SPT switchover.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If <i><span class="varname">traffic-rate</span></i> is specified, Step 4 is required.</p>
</div></div>
</li><li><p><strong><span>infinity</span></strong>: indicates that the receiver's DR never triggers the SPT switchover. Thus, multicast data can be transmitted to the receiver only along the RPT.</p>
</li><li><p><strong><span>group-policy</span></strong> <i><span class="varname">basic-acl-number</span></i>: specifies the range of the multicast groups to which the set rate threshold applies. </p>
</li><li><p><strong><span>order</span></strong> <i><span class="varname">order-value</span></i>: adjusts the order of the ACLs in the group-policy list. If a group matches multiple ACLs, the threshold is selected in the order specified by <i><span class="varname">order-value</span></i>.</p>
</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>If no ACL is configured, the device applies the specified rate threshold to all multicast groups.</li><li>If an ACL is configured, the device uses configured ACL rules to determine whether to apply the specified rate threshold to a multicast group.<ul><li>If a multicast group matches an ACL rule and the action is <strong>permit</strong>, the device applies the specified rate threshold to this group.</li><li>If a multicast group matches an ACL rule and the action is <strong>deny</strong>, the device performs an SPT switchover immediately after the SPT switchover condition is met.</li><li>If a multicast group does not match any ACL rule or if the specified ACL does not exist or does not contain rules, the device performs an SPT switchover immediately after the SPT switchover condition is met.</li></ul>
</li></ul>
</div></div>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=timer+spt-switch"><b><span class="cmdname">timer spt-switch</span></b></a> <i><span class="varname">interval</span></i></span><p><p>The interval for checking the forwarding rate of multicast packets is set.</p>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_0006.html">Configuring PIM-SM
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_3153.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_0014.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>