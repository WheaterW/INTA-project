
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Associating a Multicast VLAN with Specified User VLANs">
<meta name="abstract" content="If users in different VLANs need to receive the same multicast data flow, you can configure a multicast VLAN to manage the multicast source and multicast group members and save bandwidth.">
<meta name="description" content="If users in different VLANs need to receive the same multicast data flow, you can configure a multicast VLAN to manage the multicast source and multicast group members and save bandwidth.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2mc_cfg_0039.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2mc_cfg_0041.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00800033,l2multicastvrp,c00549182,w00556928,w00437000,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Layer 2 Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Layer 2 Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="Layer 2 Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="Layer 2 Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="c00549182">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172367877">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Associating a Multicast VLAN with Specified User VLANs</title>
</head>
<body><a name="EN-US_TASK_0172367877"></a><a name="EN-US_TASK_0172367877"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Associating a Multicast VLAN with Specified User VLANs</h1>
<div class="taskbody"><p>If users in different VLANs need to receive the same multicast data flow, you can configure a multicast VLAN to manage the multicast source and multicast group members and save bandwidth.</p>
<div class="context"><a name="EN-US_TASK_0172367877__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>The multicast VLAN function involves two concepts: multicast VLAN and user VLAN.</p>
<ul><li><p>A multicast VLAN is the VLAN to which the interface connecting the <span class="keyword">Router</span> to a multicast source belongs. A multicast VLAN is used to aggregate multicast flows. The system supports a maximum of 128 multicast VLANs.</p>
</li><li><p>A user VLAN is a VLAN to which member hosts of a multicast group belong. A user VLAN is used to receive multicast flows from the multicast VLAN. </p>
</li><li><p>A multicast VLAN can be associated with a maximum of <span>4093</span> user VLANs.</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172367877__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=vlan"><b><span class="cmdname">vlan</span></b></a> <i><span class="varname">vlan-id</span></i></span></span><p><p>The VLAN view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=igmp-snooping+enable"><b><span class="cmdname">igmp-snooping enable</span></b></a></span><p><p>IGMP snooping is enabled for the multicast VLAN.</p>
</p></li><li><span>Run <a href="cmdqueryname=multicast-vlan+enable"><b><span class="cmdname">multicast-vlan enable</span></b></a></span><p><p>The multicast VLAN function is enabled.</p>
</p></li><li><span>Run <a href="cmdqueryname=multicast-vlan+user-vlan"><b><span class="cmdname">multicast-vlan user-vlan</span></b></a> { { <i><span class="varname">vlan-id1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id2</span></i> ] } &amp;&lt;1-10&gt; }</span><p><p>The multicast VLAN is associated with the specified user VLANs.</p>
</p><p><p>A multicast VLAN can be associated with multiple user VLANs, but a user VLAN can be associated with only one multicast VLAN.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=multicast-vlan+igmp-querier-election+user-vlan"><b><span class="cmdname">multicast-vlan igmp-querier-election user-vlan</span></b></a> { <i><span class="varname">vlan-id1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id2</span></i> ] } &amp;&lt;1-10&gt;</span><p><p>Querier election is enabled in the user VLAN.</p>
</p><p><div class="p">If two <span class="keyword">Router</span>s are connected to the same user VLAN and the multicast VLAN function is enabled, the user VLAN will receive two copies of identical multicast data. To resolve this issue, enable the querier election function for the user VLAN. After querier election is configured for the user VLAN, the <span class="keyword">Router</span> that fails in querier election deletes forwarding entries and does not create forwarding entries even if it receives Report messages from the user VLAN. In this case, the <span class="keyword">Router</span> does not send multicast flows to the user VLAN.<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Before using this function, run the <a href="cmdqueryname=igmp-snooping+send-query+source-address"><b><span class="cmdname">igmp-snooping send-query source-address</span></b></a> command on each <span class="keyword">Router</span> to configure a source IP address for Query messages sent by the querier.</p>
</div></div>
</div>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=igmp-snooping+send-query+source-address"><b><span class="cmdname">igmp-snooping send-query source-address</span></b></a> <i><span class="varname">ip-source-address</span></i></span><p><p>The source IP address of IGMP Query messages sent by the device is configured.</p>
</p><p><p>If the default source IP address of IGMP Query messages is in use, perform this step to change this source IP address. If the <a href="cmdqueryname=igmp-snooping+send-query+source-address"><b><span class="cmdname">igmp-snooping send-query source-address</span></b></a> command is run in both the system view and VLAN view, the configuration in the VLAN view preferentially takes effect.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=multicast-vlan+send-query+prune-source-port"><b><span class="cmdname">multicast-vlan send-query prune-source-port</span></b></a></span><p><p>The multicast VLAN is configured not to send received General Query messages back to the source interface through user VLANs.</p>
</p><p><p>When the multicast VLAN and user VLANs are configured on the same interface, General Query messages are forwarded through this interface by default. The forwarding process does not change the source MAC address of the messages. Therefore, the upstream device learns the MAC entry with the MAC address of the interface as the source MAC address. If the upstream device has learned the source MAC address from another interface, MAC address flapping occurs on the device. To prevent this problem, perform this step.</p>
</p></li><li><span>Run <a href="cmdqueryname=port+isolate-state+exclude+multicast"><b><span class="cmdname">port isolate-state exclude multicast</span></b></a></span><p><p>The VLAN is configured not to isolate multicast traffic or multicast packets.</p>
</p><p></p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2mc_cfg_0039.html">Configuring a Multicast VLAN for Specified User VLANs
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2mc_cfg_0041.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>