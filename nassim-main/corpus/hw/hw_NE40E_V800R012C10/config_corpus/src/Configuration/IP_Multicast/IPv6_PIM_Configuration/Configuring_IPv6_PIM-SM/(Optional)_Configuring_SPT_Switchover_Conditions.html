
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring SPT Switchover Conditions">
<meta name="abstract" content="PIM-SM enables a Rendezvous Point (RP) or a receiver's Designated router (DR) to trigger a shortest path tree (SPT) switchover when the rate of IPv6 multicast packets is high. You can configure the SPT switchover conditions and the interval for checking the rate at which IPv6 multicast data is forwarded on the receiver's DR.">
<meta name="description" content="PIM-SM enables a Rendezvous Point (RP) or a receiver's Designated router (DR) to trigger a shortest path tree (SPT) switchover when the rate of IPv6 multicast packets is high. You can configure the SPT switchover conditions and the interval for checking the rate at which IPv6 multicast data is forwarded on the receiver's DR.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2005.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2012.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_ipv6vrf.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPv6 PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv6 PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IPv6 PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IPv6 PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172367466">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring SPT Switchover Conditions</title>
</head>
<body><a name="EN-US_TASK_0172367466"></a><a name="EN-US_TASK_0172367466"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring SPT Switchover Conditions</h1>
<div class="taskbody"><p>PIM-SM enables a Rendezvous Point (RP) or a receiver's Designated router (DR) to trigger a shortest path tree (SPT) switchover when the rate of IPv6 multicast packets is high. You can configure the SPT switchover conditions and the interval for checking the rate at which IPv6 multicast data is forwarded on the receiver's DR.</p>
<div class="context"><a name="EN-US_TASK_0172367466__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>During the forwarding of IPv6 multicast packets in a PIM-SM domain, only one rendezvous point tree (RPT) is set for each multicast group. All multicast sources encapsulate multicast data in Register messages, and then unicast the Register messages to the RP. After receiving the Register messages, the RP decapsulates them and then forwards multicast data along the RPT to group members.</p>
<p>Forwarding IPv6 multicast data along an RPT has the following disadvantages:</p>
<ul><li><p>The source's DR and the RP need to frequently encapsulate and decapsulate messages.</p>
</li><li><p>The forwarding path may not be the shortest path from the source to receivers.</p>
</li><li><p>Heavy IPv6 multicast traffic increases the load of the RP, which easily causes a fault.</p>
</li></ul>
<p>The solutions to the preceding disadvantages are as follows:</p>
<ul><li><p>SPT switchover triggered by the RP</p>
<p>The RP sends a Join message to the source to create an IPv6 multicast route along the shortest path from the source's DR to the RP to build an MDT. Then, subsequent packets are forwarded along this path.</p>
</li><li><p>SPT switchover triggered by the receiver's DR</p>
<p>The receiver's DR checks the forwarding rate of IPv6 multicast data. If the receiver's DR finds that the rate exceeds the threshold, the receiver's DR triggers the SPT switchover immediately. The receiver's DR sends a Join message to the source to set up an IPv6 multicast route along the shortest path from the source's DR to the receiver's DR. Subsequent IPv6 multicast packets are forwarded along this path.</p>
</li></ul>
<p>By default, the RP triggers the SPT switchover immediately after receiving the first Register message, and the receiver's DR triggers the SPT switchover immediately after receiving the first IPv6 multicast data packet. The <span class="keyword">Router</span> can work normally with default control parameters. You are allowed to adjust SPT switchover parameters based on the specific networking environment.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If there is no special requirement, default parameter values are recommended.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172367466__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Configure a basic numbered ACL6 or a named ACL6 as needed.</span><p><ul><li><p>Configure a basic numbered ACL6.</p>
<ol type="a"><li>Run <span><span><a href="cmdqueryname=acl+ipv6"><b><span class="cmdname">acl ipv6</span></b></a> [ <strong><span>number</span></strong> ] <i><span class="varname">basic-acl6-number</span></i> [ <strong><span>match-order</span></strong> { <strong><span>auto</span></strong> | <strong><span>config</span></strong> } ]</span></span><p>A basic numbered ACL6 is created, and the basic numbered ACL6 view is displayed.</p>
</li><li>Run <span><span><a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> [ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>deny</span></strong> | <strong><span>permit</span></strong> } [ <strong><span>fragment</span></strong> | <strong><span>source</span></strong> { <i><span class="varname">source-ipv6-address</span></i> <i><span class="varname">prefix-length</span></i> | <i><span class="varname">source-ipv6-address</span></i>/<i><span class="varname">prefix-length</span></i> | <strong><span>any</span></strong> } ] <sup>*</sup></span></span><p>Rules are configured for the basic numbered ACL6.</p>
</li></ol>
</li><li>Configure a named ACL6.<ol type="a"><li>Run <span><a href="cmdqueryname=acl+ipv6"><b><span class="cmdname">acl ipv6</span></b></a> <strong><span>name</span></strong> <i><span class="varname">acl6-name</span></i> <strong><span>basic</span></strong> [ <strong><span>match-order</span></strong> { <strong><span>auto</span></strong> | <strong><span>config</span></strong> } ]</span><p>A named ACL6 is created, and the named ACL6 view is displayed.</p>
</li><li>Run <span><span><a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> [ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>deny</span></strong> | <strong><span>permit</span></strong> } [ <strong><span>fragment</span></strong> | <strong><span>source</span></strong> { <i><span class="varname">source-ipv6-address</span></i> <i><span class="varname">prefix-length</span></i> | <i><span class="varname">source-ipv6-address</span></i>/<i><span class="varname">prefix-length</span></i> | <strong><span>any</span></strong> } ] <sup>*</sup></span></span><p>Rules are configured for the named ACL6.</p>
</li></ol>
</li></ul>
<p>You can use the <strong><span>source</span></strong> parameter in the <a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> command to define a multicast group range.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li><span>Run <a href="cmdqueryname=pim-ipv6"><b><span class="cmdname">pim-ipv6</span></b></a></span><p><p>The IPv6 PIM view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=spt-switch-threshold"><b><span class="cmdname">spt-switch-threshold</span></b></a> { <i><span class="varname">traffic-rate</span></i> | <strong><span>infinity</span></strong> } [ <strong><span>group-policy</span></strong> { <i><span class="varname">basic-acl6-number</span></i> |<strong><span>acl6-name</span></strong> <i><span class="varname">acl6-name</span></i> } [ <strong><span>order</span></strong> <i><span class="varname">order-value</span></i> ] ]</span></span><p><p>SPT switchover conditions are configured.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command takes effect on all <span class="keyword">Router</span>s that may become the receiver's DR, but does not take effect on the RP.</p>
</div></div>
<ul><li><p><i><span class="varname">traffic-rate</span></i>: specifies the threshold for the rate of IPv6 multicast data. When the rate of IPv6 multicast data exceeds the threshold, the receiver's DR triggers the SPT switchover.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The configuration in Step 4 makes sense only after <i><span class="varname">traffic-rate</span></i> is set.</p>
</div></div>
</li><li><p><strong><span>infinity</span></strong>: indicates that the receiver's DR never triggers the SPT switchover. IPv6 multicast data can be transmitted to receivers only along the RPT.</p>
</li><li><p><strong><span>group-policy</span></strong> { <i><span class="varname">basic-acl6-number</span></i> | <strong><span>acl6-name</span></strong> <i><span class="varname">acl6-name</span></i> }: specifies the range of multicast groups to which the threshold is applied. By default, the threshold is applicable to all multicast groups.</p>
</li><li><p><strong><span>order</span></strong> <i><span class="varname">order-value</span></i>: adjusts the order of the IPv6 ACLs in the group-policy list. If a group matches multiple IPv6 ACLs, the threshold is selected in the order specified by <i><span class="varname">order-value</span></i>.</p>
</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>If no ACL is configured, the device applies the specified rate threshold to all multicast groups.</li><li>If an ACL is configured, the device uses configured ACL rules to determine whether to apply the specified rate threshold to a multicast group.<ul><li>If a multicast group matches an ACL rule and the action is <strong>permit</strong>, the device applies the specified rate threshold to this group.</li><li>If a multicast group matches an ACL rule and the action is <strong>deny</strong>, the device performs an SPT switchover immediately after the SPT switchover condition is met.</li><li>If a multicast group does not match any ACL rule or if the specified ACL does not exist or does not contain rules, the device performs an SPT switchover immediately after the SPT switchover condition is met.</li></ul>
</li></ul>
</div></div>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=timer+spt-switch"><b><span class="cmdname">timer spt-switch</span></b></a> <i><span class="varname">interval</span></i></span></span><p><p>The interval for checking the forwarding rate of multicast packets is set.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2005.html">Configuring IPv6 PIM-SM
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2012.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_ipv6vrf.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>