
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring MVPN Extranet">
<meta name="abstract" content="To enable a service provider on a VPN to provide multicast services for users on other VPNs, configure MVPN extranet.">
<meta name="description" content="To enable a service provider on a VPN to provide multicast services for users on other VPNs, configure MVPN extranet.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2117.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2274.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2128.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPv4 Multicast VPN_Rosen">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv4 Multicast VPN_Rosen">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IPv4 Multicast VPN_Rosen">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001270432597">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring MVPN Extranet</title>
</head>
<body><a name="EN-US_TASK_0000001270432597"></a><a name="EN-US_TASK_0000001270432597"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring MVPN Extranet</h1>
<div class="taskbody"><p>To enable a service provider on a VPN to provide multicast services for users on other VPNs, configure MVPN extranet.</p>
<div class="context"><a name="EN-US_TASK_0000001270432597__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>In real-world application, a service provider may need to provide multicast services to users in a different VPN than its own VPN. This requires inter-VPN multicast distribution. To enable a service provider on a VPN to provide multicast services for users on other VPNs, configure MVPN extranet.</p>
<p>MVPN extranet applies to two scenarios: remote route leaking and local route leaking scenarios. For details, see <a href="#EN-US_TASK_0000001270432597__table_dc_vrp_multicast_cfg_225901">Table 1</a>.</p>

<div class="tableBorder"><a name="EN-US_TASK_0000001270432597__table_dc_vrp_multicast_cfg_225901"></a><a name="table_dc_vrp_multicast_cfg_225901"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0000001270432597__table_dc_vrp_multicast_cfg_225901" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Usage scenarios of MVPN extranet</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="17.241724172417243%" id="mcps1.4.1.4.2.5.1.1" liSelected="liSelected"><p>Usage Scenario</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="18.731873187318733%" id="mcps1.4.1.4.2.5.1.2" liSelected="liSelected"><p>Description</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="25.85258525852585%" id="mcps1.4.1.4.2.5.1.3" liSelected="liSelected"><p>Configuration</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="38.173817381738175%" id="mcps1.4.1.4.2.5.1.4" liSelected="liSelected"><p>Remarks</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="17.241724172417243%" headers="mcps1.4.1.4.2.5.1.1 "><p>remote route leaking</p>
</td>
<td class="cellrowborder" valign="top" width="18.731873187318733%" headers="mcps1.4.1.4.2.5.1.2 "><p>The source and receiver VPN instances reside on different PEs.</p>
</td>
<td class="cellrowborder" valign="top" width="25.85258525852585%" headers="mcps1.4.1.4.2.5.1.3 "><p>Configure a source VPN instance on a receiver PE</p>
</td>
<td class="cellrowborder" valign="top" width="38.173817381738175%" headers="mcps1.4.1.4.2.5.1.4 "><p>-</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="17.241724172417243%" headers="mcps1.4.1.4.2.5.1.1 "><p>Local leaking</p>
</td>
<td class="cellrowborder" valign="top" width="18.731873187318733%" headers="mcps1.4.1.4.2.5.1.2 "><p>The source and receiver VPN instances reside on the same PE, or the multicast source belongs to the public network instance.</p>
</td>
<td class="cellrowborder" valign="top" width="25.85258525852585%" headers="mcps1.4.1.4.2.5.1.3 "><p>-</p>
</td>
<td class="cellrowborder" valign="top" width="38.173817381738175%" headers="mcps1.4.1.4.2.5.1.4 "><p>In MVPN extranet scenarios where the multicast source resides on a public network and the receiver resides on a VPN, static routes to the multicast source and public network RP must be configured in the receiver VPN instance.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>The address range of multicast groups using the MVPN extranet service cannot overlap that of multicast groups using the intra-VPN service.</li><li>Only a static RP can be used in an MVPN extranet scenario, the same static RP address must be configured on the source and receiver VPN sides, and the static RP address must belong to the source VPN. If different RP addresses are configured, inconsistent multicast routing entries will be created on the two instances, causing service forwarding failures.</li><li>To provide an SSM service using MVPN extranet, the same SSM group address must be configured on the source and receiver VPN sides.</li></ul>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001270432597__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring MVPN extranet, complete the following tasks:</p>
<ul><li><p>Configure a unicast routing protocol to ensure that devices are reachable through IP routes.</p>
</li><li><p>Configure a BGP/MPLS IP VPN and ensure that the unicast VPN is working properly.</p>
</li><li><p>Configure basic MVPN functions and ensure that they are working properly.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001270432597__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p">Select the following required configuration steps to configure MVPN extranet based on usage scenarios:<ul><li><p>Remote leaking scenario where a source VPN instance is configured on a receiver PE: Perform steps 1, 2, and 4.</p>
</li><li><p>Local leaking scenario where the source and receiver VPN instances reside on the same PE: select steps 1 and 2.</p>
</li><li><p>Local leaking scenario where the multicast source belongs to the public network instance: select steps 1, 2, and 5.</p>
</li></ul>
</div>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001270432597__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure the same unicast routing policy on the receiver and source PEs so that the receiver VPN can import the routes to the source VPN. For detailed configurations, see <a href="dc_vrp_mpls-l3vpn-v4_cfg_0155.html">Configuring a VPN Instance</a>.</span></li><li><span>Configure a private network RP to serve the MVPN extranet. For details about how to configure an RP, see PIM Configuration &gt; Configuring PIM-SM. An RP is required only on a PIM-SM network.</span></li><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Configure a multicast route selection policy.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></span><p><p>The VPN instance view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a></span><p><p>The IPv4 address family is enabled for the VPN instance, and the VPN instance IPv4 address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=multicast+extranet+select-rpf"><b><span class="cmdname">multicast extranet select-rpf</span></b></a> { <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>public</span></strong> } <strong><span>group</span></strong> <i><span class="varname">group-address</span></i> { <i><span class="varname">group-mask</span></i> | <i><span class="varname">group-mask-length</span></i> }</span><p><p>A multicast route selection policy is configured, specifying that the upstream interface of the RPF route selected by the PIM entry corresponding to a multicast group address belongs to another VPN instance or the public network instance.</p>
</p></li><li class="substepexpand"><span>Run <strong><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></strong></span><p><p>Return to the VPN instance view.</p>
</p></li><li class="substepexpand"><span>Run <strong><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></strong></span><p><p>Return to the system view.</p>
</p></li></ol>
</li><li><span>Configure a static route to the source in the public network and public network RP. For detailed configurations, see <a href="dc_vrp_static-route_disjoin_cfg_0003.html">Configuring IPv4 Static Routes</a>.</span></li><li><strong>Optional: </strong><span>(Optional) Run <a href="cmdqueryname=multicast+extranet+traffic-forward+type"><b><span class="cmdname">multicast extranet traffic-forward type</span></b></a> { <strong><span>vlanif</span></strong> | <strong><span>qinq</span></strong> <span>| <strong><span>vbdif</span></strong></span> | <strong><strong><span>bas</span></strong></strong><strong> <strong><span>igmp</span></strong></strong> }</span><p><p>A VLANIF interface, QinQ/dot1q interface<span>, BAS interface</span>, or VBDIF interface is selected as the outbound interface for extranet in the local leaking scenario.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The VLANIF interface, QinQ/dot1q VLAN tag termination interface<span>, BAS interface</span>, or VBDIF interface can be used as the outbound interface only for extranet in the local leaking scenario.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001270432597__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ul><li>Run the <a href="cmdqueryname=display+pim"><b><span class="cmdname">display pim</span></b></a> <span>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>all-instance</span></strong> ] </span><strong><span>routing-table</span></strong> [ <i><span class="varname">group-address</span></i> [ <strong><span>mask</span></strong> { <i><span class="varname">group-mask-length</span></i> | <i><span class="varname">group-mask</span></i> } ] | <i><span class="varname">source-address</span></i> [ <strong><span>mask</span></strong> { <i><span class="varname">source-mask-length</span></i> | <i><span class="varname">source-mask</span></i> } ] | <strong><span>extranet</span></strong> { <strong><span>source-vpn-instance</span></strong> { <strong><span>all</span></strong> | <strong><span>public</span></strong> | <i><span class="varname">vpn-instance-name</span></i> } | <strong><span>receive-vpn-instance</span></strong> { <strong><span>all</span></strong> | <i><span class="varname">vpn-instance-name</span></i> } } | <strong><span>incoming-interface</span></strong> { <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> | <strong><span>register</span></strong> | <strong><span>mcast-extranet</span></strong> } | <strong><span>outgoing-interface</span></strong> { <strong><span>include</span></strong> | <strong><span>exclude</span></strong> | <strong><span>match</span></strong> } { <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> | <span><strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i></span> | <strong><span>register</span></strong> | <strong><span>none</span></strong> } | <strong><span>mode</span></strong> { <strong><span>ssm</span></strong> | <strong><span>sm</span></strong> } | <strong><span>flags</span></strong> <i><span class="varname">flag-value</span></i> | <strong><span>fsm</span></strong> ] <sup>*</sup> [ <strong><span>outgoing-interface-number</span></strong> [ <i><span class="varname">number</span></i> ] ] command to check information about the PIM routing table.</li><li>Run the <a href="cmdqueryname=display+multicast"><b><span class="cmdname">display multicast</span></b></a> <span>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>all-instance</span></strong> ] </span><strong><span>routing-table</span></strong> [ <i><span class="varname">group-address</span></i> [ <strong><span>mask</span></strong> { <i><span class="varname">group-mask</span></i> | <i><span class="varname">group-mask-length</span></i> } ] | <i><span class="varname">source-address</span></i> [ <strong><span>mask</span></strong> { <i><span class="varname">source-mask</span></i> | <i><span class="varname">source-mask-length</span></i> } ] | <strong><span>extranet</span></strong> { <strong><span>source-vpn-instance</span></strong> { <strong><span>all</span></strong> | <strong><span>public</span></strong> | <i><span class="varname">vpn-instance-name</span></i> } | <strong><span>receive-vpn-instance</span></strong> { <strong><span>all</span></strong> | <i><span class="varname">vpn-instance-name</span></i> } } | <strong><span>incoming-interface</span></strong> { <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> | <strong><span>register</span></strong> | <strong><span>mcast-extranet</span></strong> } | <strong><span>outgoing-interface</span></strong> { <strong><span>include</span></strong> | <strong><span>exclude</span></strong> | <strong><span>match</span></strong> } { <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> | <span><strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> </span>| <strong><span>register</span></strong> | <strong><span>none</span></strong> } ] <sup>*</sup> [ <strong><span>outgoing-interface-number</span></strong> [ <i><span class="varname">number</span></i> ] ] command to check information about the multicast routing table.</li><li>Run the <a href="cmdqueryname=display+multicast"><b><span class="cmdname">display multicast</span></b></a> <span>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>all-instance</span></strong> ] </span> <strong><span>rpf-info</span></strong> <i><span class="varname">source-address</span></i> [ <i><span class="varname">group-address</span></i> ] [ <strong><span>rpt</span></strong> | <strong><span>spt</span></strong> ] command to check information about source-specific or group-and-source-specific RPF routes.</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2117.html">Rosen MVPN Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2274.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2128.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>