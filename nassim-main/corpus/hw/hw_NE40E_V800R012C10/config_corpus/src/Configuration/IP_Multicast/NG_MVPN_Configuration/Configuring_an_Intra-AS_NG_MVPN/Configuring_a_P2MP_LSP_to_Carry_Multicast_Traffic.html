
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a P2MP LSP to Carry Multicast Traffic">
<meta name="abstract" content="An NG MVPN uses P2MP LSPs to carry multicast traffic. You can configure either RSVP-TE P2MP or mLDP P2MP LSPs.">
<meta name="description" content="An NG MVPN uses P2MP LSPs to carry multicast traffic. You can configure either RSVP-TE P2MP or mLDP P2MP LSPs.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0004.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0006.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0008.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPv4 Multicast VPN_NG MVPN">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv4 Multicast VPN_NG MVPN">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IPv4 Multicast VPN_NG MVPN">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IPv4 Multicast VPN_NG MVPN">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001225673368">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring a P2MP LSP to Carry Multicast Traffic</title>
</head>
<body><a name="EN-US_TASK_0000001225673368"></a><a name="EN-US_TASK_0000001225673368"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a P2MP LSP to Carry Multicast Traffic</h1>
<div class="taskbody"><p>An NG MVPN uses P2MP LSPs to carry multicast traffic. You can configure either RSVP-TE P2MP or mLDP P2MP LSPs.</p>
<div class="context"><a name="EN-US_TASK_0000001225673368__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>P2MP LSPs that carry multicast traffic can be either RSVP-TE P2MP or mLDP P2MP LSPs. <a href="#EN-US_TASK_0000001225673368__table_dc_vrp_feature_new_ngmvpn_000401">Table 1</a> lists the differences between RSVP-TE P2MP LSPs and mLDP P2MP LSPs.</p>

<div class="tableBorder"><a name="EN-US_TASK_0000001225673368__table_dc_vrp_feature_new_ngmvpn_000401"></a><a name="table_dc_vrp_feature_new_ngmvpn_000401"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0000001225673368__table_dc_vrp_feature_new_ngmvpn_000401" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Differences between RSVP-TE P2MP LSPs and mLDP P2MP LSPs</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="18.27%" id="mcps1.4.1.2.2.4.1.1" liSelected="liSelected"><p>Compared Aspect</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="39.87%" id="mcps1.4.1.2.2.4.1.2" liSelected="liSelected"><p>mLDP P2MP LSP</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="41.86%" id="mcps1.4.1.2.2.4.1.3" liSelected="liSelected"><p>RSVP-TE P2MP LSP</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="18.27%" headers="mcps1.4.1.2.2.4.1.1 "><p>Main features</p>
</td>
<td class="cellrowborder" valign="top" width="39.87%" headers="mcps1.4.1.2.2.4.1.2 "><p>mLDP P2MP LSPs do not support bandwidth reservation and cannot ensure service quality during network congestion. mLDP P2MP LSPs are easier to configure than RSVP-TE P2MP LSPs.</p>
</td>
<td class="cellrowborder" valign="top" width="41.86%" headers="mcps1.4.1.2.2.4.1.3 "><p>RSVP-TE P2MP LSPs support bandwidth reservation and can ensure service quality during network congestion.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="18.27%" headers="mcps1.4.1.2.2.4.1.1 "><p>Application scenario</p>
</td>
<td class="cellrowborder" valign="top" width="39.87%" headers="mcps1.4.1.2.2.4.1.2 "><p>Networks that do not require control over destination nodes</p>
<p>Use mLDP P2MP LSPs to carry multicast traffic if high service quality is not required.</p>
</td>
<td class="cellrowborder" valign="top" width="41.86%" headers="mcps1.4.1.2.2.4.1.3 "><p>Networks that require control over destination nodes</p>
<p>Use RSVP-TE P2MP LSPs to carry multicast traffic if high service quality is required.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="18.27%" headers="mcps1.4.1.2.2.4.1.1 "><p>Signaling</p>
</td>
<td class="cellrowborder" valign="top" width="39.87%" headers="mcps1.4.1.2.2.4.1.2 "><p>Signaling packets do not need to be periodically sent, reducing network load.</p>
</td>
<td class="cellrowborder" valign="top" width="41.86%" headers="mcps1.4.1.2.2.4.1.3 "><p>Signaling packets need to be periodically sent to maintain the tunnel. If a large number of leaf nodes exist, network congestion is likely to occur.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>Select the type of tunnel as needed.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If P2MP LSP that carry multicast traffic is RSVP-TE P2MP LSP, you need to configure a tunnel policy to bind a VPN service to specified RSVP-TE P2MP LSP.</p>
</div></div>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0000001225673368__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Perform the following steps on a PE to be configured as a sender PE:</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=multicast+mvpn"><b><span class="cmdname">multicast mvpn</span></b></a> <i><span class="varname">mvpn-id</span></i></span><p><p>An MVPN ID is configured.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></span><p><p>The VPN instance view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a></span><p><p>The VPN instance IPv4 address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=multicast+routing-enable"><b><span class="cmdname">multicast routing-enable</span></b></a></span><p><p>Multicast routing is enabled in for VPN instance IPv4 address family.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mvpn"><b><span class="cmdname">mvpn</span></b></a></span><p><p>The VPN instance IPv4 address family MVPN view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=c-multicast+signaling"><b><span class="cmdname">c-multicast signaling</span></b></a> <strong><span>bgp</span></strong></span><p><p>BGP is configured as the signaling protocol for transmitting C-multicast routes.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=sender-enable"><b><span class="cmdname">sender-enable</span></b></a></span><p><p>The PE is configured as a sender PE.</p>
<p></p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=vpn-target+%28VPN+instance+IPv4+address+family+MVPN+view%29"><b><span class="cmdname">vpn-target (VPN instance IPv4 address family MVPN view)</span></b></a></span><p><p>An MVPN target is configured for the VPN instance MVPN address family.</p>
</p><p></p></li><li class="substepexpand"><span>(Optional) Configure the PIM-SM MDT setup mode:</span><p><ul><li><p>If you want PIM-SM MDTs to be set up across the public network, run the <a href="cmdqueryname=rpt-spt+mode"><b><span class="cmdname">rpt-spt mode</span></b></a> command.</p>
</li><li>If you want PIM-SM MDTs to be set up not across the public network, run the <a href="cmdqueryname=spt-only+mode"><b><span class="cmdname">spt-only mode</span></b></a> command.</li></ul>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=import+msdp"><b><span class="cmdname">import msdp</span></b></a></span><p><p>The function of transmitting (S, G) entry information in Multicast Source Discovery Protocol (MSDP) Source Active (SA) messages to the remote PE through BGP Source Active A-D routes is enabled.</p>
<p>If PIM-SM MDT setup is not across the public network, you can configure a PE or CE as a VPN instance's rendezvous point (RP). If a CE is configured as an RP, the CE needs to establish an MSDP peer relationship with its connected PE and transmit (S, G) entry information to the PE through MSDP SA messages. To enable this PE to transmit the (S, G) entry information to the remote PE through BGP Source Active A-D routes, run the <a href="cmdqueryname=import+msdp"><b><span class="cmdname">import msdp</span></b></a> command.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipmsi-tunnel"><b><span class="cmdname">ipmsi-tunnel</span></b></a></span><p><p>The MVPN I-PMSI view is displayed.</p>
</p></li><li class="substepexpand"><span>Configure an I-PMSI tunnel establishment mode.</span><p><ul><li>To use mLDP to establish an I-PMSI tunnel, run the <a href="cmdqueryname=mldp+%28MVPN+I-PMSI+view%29"><b><span class="cmdname">mldp (MVPN I-PMSI view)</span></b></a> command.</li><li>To use RSVP-TE to establish an I-PMSI tunnel, run the following steps:<ol type="a"><li><p>Run the <a href="cmdqueryname=mpls+te+%28MVPN+I-PMSI+view%29"><b><span class="cmdname">mpls te (MVPN I-PMSI view)</span></b></a> command to use RSVP-TE to establish an I-PMSI tunnel.</p>
</li><li><p>Run the <a href="cmdqueryname=p2mp-template+%28I-PMSI+MPLS+TE+view%29"><b><span class="cmdname">p2mp-template (I-PMSI MPLS TE view)</span></b></a> <i><span class="varname">p2mp-template-name</span></i> command to specify the tunnel template to be referenced by an RSVP-TE P2MP LSP.</p>
<p>If the tunnel template specified in the <a href="cmdqueryname=p2mp-template+%28I-PMSI+MPLS+TE+view%29"><b><span class="cmdname">p2mp-template (I-PMSI MPLS TE view)</span></b></a> command does not exist, the RSVP-TE P2MP LSP cannot be established.<span> Before running the <a href="cmdqueryname=p2mp-template+%28I-PMSI+MPLS+TE+view%29"><b><span class="cmdname">p2mp-template (I-PMSI MPLS TE view)</span></b></a> command, ensure that the <a href="cmdqueryname=mpls+te+p2mp-template"><b><span class="cmdname">mpls te p2mp-template</span></b></a> command has been run.</span></p>
</li></ol>
</li></ul>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Perform the following steps on a PE to be configured as a receiver PE:</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=multicast+mvpn"><b><span class="cmdname">multicast mvpn</span></b></a> <i><span class="varname">mvpn-id</span></i></span><p><p>An MVPN ID is configured.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></span><p><p>The VPN instance view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a></span><p><p>The VPN instance IPv4 address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=multicast+routing-enable"><b><span class="cmdname">multicast routing-enable</span></b></a></span><p><p>Multicast routing is enabled in for VPN instance IPv4 address family.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mvpn"><b><span class="cmdname">mvpn</span></b></a></span><p><p>The VPN instance IPv4 address family MVPN view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=vpn-target+%28VPN+instance+IPv4+address+family+MVPN+view%29"><b><span class="cmdname">vpn-target (VPN instance IPv4 address family MVPN view)</span></b></a></span><p><p>An MVPN target is configured for the VPN instance MVPN address family.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=c-multicast+signaling"><b><span class="cmdname">c-multicast signaling</span></b></a> <strong><span>bgp</span></strong></span><p><p>BGP is configured as the signaling protocol for transmitting C-multicast routes.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=vrf-route-import+compatible+draft"><b><span class="cmdname">vrf-route-import compatible draft</span></b></a></span><p><p>The VRF Route Import Extended Community carried in BGP Update messages is configured to use the format defined in an IETF draft.</p>
<p>If a non-Huawei device uses the packet encapsulation format defined in an IETF draft, run the <a href="cmdqueryname=vrf-route-import+compatible+draft"><b><span class="cmdname">vrf-route-import compatible draft</span></b></a> command to enable a Huawei device to use the packet encapsulation format defined in the draft so that the Huawei and non-Huawei devices can communicate.</p>
</p></li><li class="substepexpand"><span>(Optional) Configure the PIM-SM MDT setup mode:</span><p><ul><li>If you want PIM-SM MDTs to be set up across the public network, run the <a href="cmdqueryname=rpt-spt+mode"><b><span class="cmdname">rpt-spt mode</span></b></a> command.</li><li>If you want PIM-SM MDTs to be set up not across the public network, run the <a href="cmdqueryname=spt-only+mode"><b><span class="cmdname">spt-only mode</span></b></a> command.</li></ul>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=export+msdp"><b><span class="cmdname">export msdp</span></b></a></span><p><p>The function of transmitting (S, G) entry information in BGP Source Active A-D routes to the RP through MSDP SA messages is enabled.</p>
<p>If PIM-SM MDT setup is not across the public network, you can configure a PE or CE as a VPN instance's RP. If a CE is configured as an RP, the CE needs to establish an MSDP peer relationship with its connected PE. To enable this PE to transmit (S, G) entry information in BGP Source Active A-D routes to the CE configured as the RP, run the <a href="cmdqueryname=export+msdp"><b><span class="cmdname">export msdp</span></b></a> command.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0004.html">Configuring an Intra-AS NG MVPN
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0006.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0008.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>