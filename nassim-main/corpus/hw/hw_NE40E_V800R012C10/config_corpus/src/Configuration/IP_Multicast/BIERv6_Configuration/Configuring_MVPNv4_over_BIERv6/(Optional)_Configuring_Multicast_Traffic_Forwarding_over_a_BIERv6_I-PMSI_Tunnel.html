
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring Multicast Traffic Forwarding over a BIERv6 I-PMSI Tunnel">
<meta name="abstract" content="An inclusive-PMSI (I-PMSI) tunnel connects all PEs in the same MVPN. If a wildcard is used when an address pool range and criteria are configured for switching from an I-PMSI tunnel to a selective-PMSI (S-PMSI) tunnel, this configuration task is not required.">
<meta name="description" content="An inclusive-PMSI (I-PMSI) tunnel connects all PEs in the same MVPN. If a wildcard is used when an address pool range and criteria are configured for switching from an I-PMSI tunnel to a selective-PMSI (S-PMSI) tunnel, this configuration task is not required.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0008.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0009.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0011.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0271431865">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring Multicast Traffic Forwarding over a BIERv6 I-PMSI Tunnel</title>
</head>
<body><a name="EN-US_TASK_0271431865"></a><a name="EN-US_TASK_0271431865"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring Multicast Traffic Forwarding over a BIERv6 I-PMSI Tunnel</h1>
<div class="taskbody"><p>An inclusive-PMSI (I-PMSI) tunnel connects all PEs in the same MVPN. If a wildcard is used when an address pool range and criteria are configured for switching from an I-PMSI tunnel to a selective-PMSI (S-PMSI) tunnel, this configuration task is not required.</p>
<div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0271431865__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>A VPN instance has been created for the unicast network. For details, see the configuration examples in this document.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0271431865__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>An I-PMSI tunnel is established between a sender PE and all receiver PEs. Therefore, you need to complete the following configurations on the sender PE and all receiver PEs.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0271431865__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure the sender PE.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=multicast+mvpn"><b><span class="cmdname">multicast mvpn</span></b></a> <strong><span>ipv6-underlay</span></strong> <em>mvpnid</em></span><p><p>An MVPN ID is configured.</p>
</p><p><p>You are advised to set the MVPN ID to the loopback interface address of the local device.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></span><p><p>The VPN instance view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a></span><p><p>The VPN instance IPv4 address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=multicast+routing-enable"><b><span class="cmdname">multicast routing-enable</span></b></a></span><p><p>Multicast routing is enabled in the VPN instance IPv4 address family view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mvpn"><b><span class="cmdname">mvpn</span></b></a></span><p><p>The VPN instance IPv4 address family MVPN view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=sender-enable"><b><span class="cmdname">sender-enable</span></b></a></span><p><p>The PE is configured as the sender PE.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv6+underlay+enable"><b><span class="cmdname">ipv6 underlay enable</span></b></a></span><p><p>IPv6 forwarding is enabled.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=src-dt4"><b><span class="cmdname">src-dt4</span></b></a>  <strong><span>locator </span></strong><i><span class="varname">locator-name</span></i> <strong><span>sid</span></strong> <i><span class="varname">sid-val</span></i> </span><p><p>A Src.DT4 SID is configured.</p>
</p><p><p>The Src.DT4 SID must be an IPv6 address of the network segment to which the locator of the local device belongs.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=vpn-target"><b><span class="cmdname">vpn-target</span></b></a></span><p><p>An MVPN target is configured for the VPN instance MVPN address family.</p>
</p><p></p></li><li class="substepexpand"><span>(Optional) Configure a PIM-SM RPT setup mode.</span><p><ul><li>Across the public network: To configure this mode, run the <a href="cmdqueryname=rpt-spt+mode"><b><span class="cmdname">rpt-spt mode</span></b></a> command.</li><li>Not across the public network: To configure this mode, run the <a href="cmdqueryname=spt-only+mode"><b><span class="cmdname">spt-only mode</span></b></a> command.</li></ul>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=bier+load-balance-entropy+source-group"><b><span class="cmdname">bier load-balance-entropy source-group</span></b></a></span><p><p>The entropy mode is configured for MVPNv4 over BIERv6 load balancing.</p>
</p><p><p>Perform this operation only if load balancing has been enabled using the <a href="cmdqueryname=max-load-balance"><b><span class="cmdname">max-load-balance</span></b></a> <i><span class="varname">number</span></i> command when configuring basic BIERv6 functions.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipmsi-tunnel"><b><span class="cmdname">ipmsi-tunnel</span></b></a></span><p><p>The MVPN I-PMSI view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bier+%28MVPN-IPMSI+view%29"><b><span class="cmdname">bier</span></b></a> [ <strong><span>sub-domain</span></strong> <i><span class="varname">sub-domain-val</span></i> ] [ <strong><span>bsl</span></strong> { <strong><span>64</span></strong> | <strong><span>128</span></strong> | <strong><span>256</span></strong> } ]</span><p><p>The I-PMSI tunnel type is set to BIER.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the MVPN I-PMSI view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the VPN instance IPv4 address family MVPN view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the VPN instance IPv4 address family view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the VPN instance view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure a receiver PE.</span><p><p>Perform the following operations on all receiver PEs.</p>
</p><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=multicast+mvpn"><b><span class="cmdname">multicast mvpn</span></b></a> <strong><span>ipv6-underlay</span></strong> <i><span class="varname">mvpn-id</span></i></span><p><p>An MVPN ID is configured.</p>
</p><p><p>You are advised to set the MVPN ID to the loopback interface address of the local device.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></span><p><p>The VPN instance view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a></span><p><p>The VPN instance IPv4 address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=multicast+routing-enable"><b><span class="cmdname">multicast routing-enable</span></b></a></span><p><p>Multicast routing is enabled in the VPN instance IPv4 address family view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mvpn"><b><span class="cmdname">mvpn</span></b></a></span><p><p>The VPN instance IPv4 address family MVPN view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=vpn-target"><b><span class="cmdname">vpn-target</span></b></a></span><p><p>An MVPN target is configured.</p>
</p><p></p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=c-multicast+signaling"><b><span class="cmdname">c-multicast signaling</span></b></a> <strong><span>bgp</span></strong></span><p><p>BGP is configured as the signaling protocol for transmitting C-multicast routes.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv6+underlay+enable"><b><span class="cmdname">ipv6 underlay enable</span></b></a></span><p><p>IPv6 forwarding is enabled.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=vrf-route-import+compatible+draft"><b><span class="cmdname">vrf-route-import compatible draft</span></b></a></span><p><p>The device is configured to encapsulate the VRF Route Import Extended Community in BGP Update messages using the format defined in a relevant IETF draft.</p>
</p><p><p>By default, a Huawei device uses the message encapsulation format defined in an RFC to encapsulate the VRF Route Import Extended Community. If a non-Huawei device uses the message encapsulation format defined in the IETF draft, run the <a href="cmdqueryname=vrf-route-import+compatible+draft"><b><span class="cmdname">vrf-route-import compatible draft</span></b></a> command to enable the Huawei device to use the format defined in the IETF draft so that the two devices can communicate.</p>
</p></li><li class="substepexpand"><span>(Optional) Configure a PIM-SM RPT setup mode.</span><p><ul><li>Across the public network: To configure this mode, run the <a href="cmdqueryname=rpt-spt+mode"><b><span class="cmdname">rpt-spt mode</span></b></a> command.</li><li>Not across the public network: To configure this mode, run the <a href="cmdqueryname=spt-only+mode"><b><span class="cmdname">spt-only mode</span></b></a> command.</li></ul>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=export+msdp"><b><span class="cmdname">export msdp</span></b></a></span><p><p>The function of transmitting (S, G) entry information in BGP Source Active A-D routes to the RP through MSDP SA messages is enabled.</p>
</p><p><p>If PIM-SM RPT setup is not across the public network, you can configure a PE or CE as the VPN instance's RP. If a CE is configured as an RP, the CE needs to establish an MSDP peer relationship with its connected PE. To enable this PE to transmit the (S, G) entry information learned through BGP Source Active A-D routes to the CE (RP), run the <a href="cmdqueryname=export+msdp"><b><span class="cmdname">export msdp</span></b></a> command.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the VPN instance IPv4 address family MVPN view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the VPN instance IPv4 address family view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the VPN instance view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0008.html">Configuring MVPNv4 over BIERv6
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0009.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0011.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>