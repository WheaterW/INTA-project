
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring GTMv6 over BIERv6 Network Slicing in a Public Network IPv6 over SRv6 Scenario">
<meta name="abstract" content="This section provides an example for configuring GTMv6 over BIERv6 and BIERv6 network slicing in a public network IPv6 over SRv6 scenario.">
<meta name="description" content="This section provides an example for configuring GTMv6 over BIERv6 and BIERv6 network slicing in a public network IPv6 over SRv6 scenario.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0023.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_1012.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0025.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="BIERv6">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="z00603461">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001436916485">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/thickbox.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/imageResize.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery-migrate-1.2.1.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery-ui.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery.mousewheel.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/thickbox.js"></script>
<title>Example for Configuring GTMv6 over BIERv6 Network Slicing in a Public Network IPv6 over SRv6 Scenario</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001436916485"></a><a name="EN-US_TASK_0000001436916485"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring GTMv6 over BIERv6 Network Slicing in a Public Network IPv6 over SRv6 Scenario</h1>
<div class="taskbody"><p>This section provides an example for configuring GTMv6 over BIERv6 and BIERv6 network slicing in a public network IPv6 over SRv6 scenario.</p>
<div class="context"><a name="EN-US_TASK_0000001436916485__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0000001436916485__fig35284409229">Figure 1</a>, public network IPv6 over SRv6 has been deployed. It is required that GTMv6 over BIERv6 be deployed on the existing network. Multicast service traffic in a public network MVPN instance needs to be isolated from other multicast service traffic in BIERv6 tunnels. In addition, the multicast stream with the multicast source address 2001:DB8:4::100 and multicast group address FF1E::1 in the public network MVPN instance needs to be isolated from other multicast streams in this instance, and independent SLA assurance is implemented. In this case, the network slicing function can be deployed in BIERv6 tunnels to carry different multicast service traffic through different slice planes.</p>
<div class="fignone" id="EN-US_TASK_0000001436916485__fig35284409229"><a name="EN-US_TASK_0000001436916485__fig35284409229"></a><a name="fig35284409229"></a><span class="figcap"><b>Figure 1 </b>GTMv6 over BIERv6 network slicing networking</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1, interface2, and interface3 represent GE <span>0/1/0</span>, GE <span>0/1/1</span>, and GE <span>0/1/2</span>, respectively.</p>
</div></div>
<br><span><img class="imgResize" src="figure/en-us_image_0000001386716980.png" width="517.1740549948098" height="277.08343741892696" title="Click to enlarge"></span></div>
<p></p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001436916485__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>(Optional) Configure public network IPv6 over SRv6 and ensure that unicast services are running properly. If the unicast network has been configured, skip this step.</p>
</li><li><p>Configure basic BIERv6 functions and enable IS-ISv6 for BIERv6 on PE1, PE2, PE3, and the P.</p>
</li><li><p>Establish BGP MVPN peer relationships between PEs.</p>
</li><li>Configure multicast traffic forwarding over a BIERv6 I-PMSI tunnel.</li><li>Enable the BIERv6 S-PMSI tunnel function and configure switching criteria.</li><li><p>Enable PIM on PEs.</p>
</li><li>Configure network slice instances, specify basic interfaces, and create network slice interfaces on PE1, PE2, PE3, and the P.</li><li>Enable BIERv6 network slicing on the ingress PE1 and transit node P of the BIERv6 tunnel.</li><li>Specify a network slice ID for the public network MVPN instance and another network slice ID for a multicast stream in this instance on the BIERv6 tunnel ingress PE1.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001436916485__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li>Addresses of key interfaces on each device, as shown in <a href="#EN-US_TASK_0000001436916485__fig35284409229">Figure 1</a></li><li>ID (1) of the public network IS-IS process, in a Level-2 area</li><li>PE2's BFR-ID (2), PE3's BFR-ID (3), sub-domain ID (0), BSL (256), and Max-SI (0)</li><li>Network slice ID (20) for a public network MVPN instance, and network slice ID (30) for the (2001:DB8:4::100, FF1E::1) multicast stream in this instance</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001436916485__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>(Optional) Configure public network IPv6 over SRv6.</span><p><p>This step is a part of configuring the unicast network, and its content is for reference only. In most cases, the unicast network has been configured before multicast services are deployed. If this is the case, skip this step and contact the configuration personnel for the configuration data related to the multicast services. For details about how to configure a unicast network, see <span class="uicontrol"><b>Segment Routing IPv6 Configuration</b></span> in the Configuration Guide.</p>
<p># Enable IPv6 forwarding on each interface and configure an IPv6 address for each interface. The configuration of PE1 is used as an example. The configurations of PE2, PE3, and the P are similar to the configuration of PE1. For configuration details, see configuration files in this section. Similar details will be omitted in the rest of the document.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>ipv6 address 2001:db8:1::2 96</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface LoopBack 1</strong>
[<span class="keyword">*</span>PE1-LoopBack1] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>PE1-LoopBack1] <strong>ipv6 address </strong><strong>2001:db8:10::1 128</strong>
[<span class="keyword">*</span>PE1-LoopBack1] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure IS-IS. The configuration of PE1 is used as an example. The configurations of PE2, PE3, and the P are similar to the configuration of PE1. </p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>isis 1</strong>
[<span class="keyword">*</span>PE1-isis-1] <strong>is-level level-2</strong>
[<span class="keyword">*</span>PE1-isis-1] <strong>cost-style wide</strong>
[<span class="keyword">*</span>PE1-isis-1] <strong>network-entity 10.0000.0000.0001.00</strong>
[<span class="keyword">*</span>PE1-isis-1] <strong>ipv6 enable topology ipv6</strong>
[<span class="keyword">*</span>PE1-isis-1] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>isis ipv6 enable 1</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface loopback1</strong>
[<span class="keyword">*</span>PE1-LoopBack1] <strong>isis ipv6 enable 1</strong>
[<span class="keyword">*</span>PE1-LoopBack1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-LoopBack1] <strong>quit</strong></pre>
<div class="p"># Establish an EBGP peer relationship between each PE and its connected CE. The establishment of an EBGP peer relationship between PE1 and CE1 is used as an example. The establishment of an EBGP peer relationship between PE2 and CE2, and between PE3 and CE3 is similar to that between PE1 and CE1.<ul><li>Configure CE1.<pre class="screen">[<span class="keyword">*</span>CE1] <strong>bgp 65410</strong>
[<span class="keyword">*</span>CE1-bgp] <strong>router-id 11.11.11.11</strong>
[<span class="keyword">*</span>CE1-bgp] <strong>peer 2001:db8:4::1 as-number 100</strong>
[<span class="keyword">*</span>CE1-bgp] <strong>ipv6-family unicast</strong>
[<span class="keyword">*</span>CE1-bgp-af-ipv6] <strong>peer </strong><strong>2001:db8:4::1</strong><strong> enable</strong>
[<span class="keyword">*</span>CE1-bgp-af-ipv6] <strong>quit</strong>
[<span class="keyword">*</span>CE1-bgp] <strong>quit</strong>
[<span class="keyword">*</span>CE1] <strong>commit</strong></pre>
</li><li>Configure PE1.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>bgp 100</strong>
[<span class="keyword">*</span>PE1-bgp] <strong>router-id 1.1.1.1</strong>
[<span class="keyword">*</span>PE1-bgp] <strong>peer 2001:db8:4::2 as-number 65410 </strong>
[<span class="keyword">*</span>PE1-bgp] <strong>ipv6-family unicast</strong>
[<span class="keyword">*</span>PE1-bgp-af-ipv6] <strong>peer 2001:db8:4::2</strong> <strong>enable</strong> 
[<span class="keyword">*</span>PE1-bgp-af-ipv6] <strong>quit</strong>
[<span class="keyword">*</span>PE1-bgp] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp] <strong>quit</strong></pre>
</li></ul>
</div>
<p># Establish an IBGP peer relationship between PE1 and PE2 and between PE1 and PE3. The configuration of PE1 is used as an example. The configurations of PE2 and PE3 are similar to the configuration of PE1. After the <a href="cmdqueryname=peer+enable"><b><span class="cmdname">peer enable</span></b></a> command is run, the system displays a confirmation message. Enter <span class="uicontrol"><b>Y</b></span> in this case. Similar details will be omitted in the rest of the document.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>bgp 100</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp] <strong>peer 2001:db8:20::1 as-number 100</strong>
[<span class="keyword">*</span>PE1-bgp] <strong>peer 2001:db8:30::1 as-number 100</strong>
[<span class="keyword">*</span>PE1-bgp] <strong>peer </strong><strong>2001:db8:20::1</strong><strong> connect-interface loopback 1</strong>
[<span class="keyword">*</span>PE1-bgp] <strong>peer 2001:db8:30::1 connect-interface loopback 1</strong>
[<span class="keyword">*</span>PE1-bgp] <strong>ipv6-family unicast</strong>
[<span class="keyword">*</span>PE1-bgp-af-ipv6] <strong>peer </strong><strong>2001:db8:20::1</strong><strong> enable</strong>
[<span class="keyword">*</span>PE1-bgp-af-ipv6] <strong>peer </strong><strong>2001:db8:30::1</strong><strong> enable</strong>
[<span class="keyword">*</span>PE1-bgp-af-ipv6] <strong>peer </strong><strong>2001:db8:20::1</strong><strong> advertise-ext-community</strong>
[<span class="keyword">*</span>PE1-bgp-af-ipv6] <strong>peer </strong><strong>2001:db8:30::1</strong><strong> advertise-ext-community</strong>
[<span class="keyword">*</span>PE1-bgp-af-ipv6] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp-af-ipv6] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp] <strong>quit</strong></pre>
<p># Configure SRv6 SIDs and enable PEs to exchange prefix SIDs with their peers. The configurations of PE1 and P are used as an example. The configurations of PE2 and PE3 are similar to the configuration of PE1. </p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>segment-routing ipv6</strong>
[<span class="keyword">*</span>PE1-segment-routing-ipv6] <strong>encapsulation source-address 2001:db8:10::1</strong>
[<span class="keyword">*</span>PE1-segment-routing-ipv6] <strong>locator PE1 ipv6-prefix </strong><strong>2001:db8:100::</strong><strong> 64 static 32</strong>
[<span class="keyword">*</span>PE1-segment-routing-ipv6] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>bgp 100</strong>
[<span class="keyword">*</span>PE1-bgp] <strong>ipv6-family unicast</strong>
[<span class="keyword">*</span>PE1-bgp-af-ipv6] <strong>import-route direct</strong>
[<span class="keyword">*</span>PE1-bgp-af-ipv6] <strong>peer </strong><strong>2001:db8:20::1</strong><strong> prefix-sid</strong> <strong>advertise-srv6-locator</strong>
[<span class="keyword">*</span>PE1-bgp-af-ipv6] <strong>peer </strong><strong>2001:db8:30::1</strong><strong> prefix-sid advertise-srv6-locator</strong>
[<span class="keyword">*</span>PE1-bgp-af-ipv6] <strong>segment-routing ipv6</strong><strong> </strong><strong>best-effort</strong>
[<span class="keyword">*</span>PE1-bgp-af-ipv6] <strong>segment-routing ipv6 locator PE1</strong>
[<span class="keyword">*</span>PE1-bgp-af-ipv6] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp-af-ipv6] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>isis 1</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-isis-1] <strong>ipv6 enable topology ipv6</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-isis-1] <strong>segment-routing ipv6 locator PE1 auto-sid-disable</strong> 
[<span class="keyword">*</span>PE1-isis-1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-isis-1] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong>segment-routing ipv6</strong>
[<span class="keyword">*</span>P-segment-routing-ipv6] <strong>encapsulation source-address </strong><strong>2001:db8:40::1</strong>
[<span class="keyword">*</span>P-segment-routing-ipv6] <strong>locator P ipv6-prefix <span>2001:db8:400::</span> 64 static 32</strong>
[<span class="keyword">*</span>P-segment-routing-ipv6] <strong>quit</strong>
[<span class="keyword">*</span>P] <strong>isis 1</strong>
[<span class="keyword">*</span>P-isis-1] <strong>ipv6 enable topology ipv6</strong>
[<span class="keyword">*</span>P-isis-1] <strong>segment-routing ipv6 locator P</strong><strong> auto-sid-disable</strong>
[<span class="keyword">*</span>P-isis-1] <strong>quit</strong>
[<span class="keyword">*</span>P] <strong>commit</strong></pre>
<p># Perform other unicast network configurations based on unicast service requirements.</p>
</p></li><li><span>Configure basic BIERv6 functions and enable IS-ISv6 for BIERv6 on PE1, PE2, PE3, and the P.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>bier</strong>
[<span class="keyword">*</span>PE1-bier] <strong>sub-domain 0</strong> <strong>ipv6</strong>
[<span class="keyword">*</span>PE1-bier-sub-domain-0-ipv6] <strong>bfr-id 1</strong>
[<span class="keyword">*</span>PE1-bier-sub-domain-0-ipv6] <strong>encapsulation-type ipv6 bsl 256 max-si 0</strong>
[<span class="keyword">*</span>PE1-bier-sub-domain-0-ipv6] <strong>bfr-prefix interface loopback1</strong>
[<span class="keyword">*</span>PE1-bier-sub-domain-0-ipv6] <strong>end-bier locator PE1 sid 2001:db8:100::1</strong>
[<span class="keyword">*</span>PE1-bier-sub-domain-0-ipv6]<strong> protocol isis</strong>
[<span class="keyword">*</span>PE1-bier-sub-domain-0-ipv6] <strong>quit</strong>
[<span class="keyword">*</span>PE1-bier] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>isis 1</strong>
[<span class="keyword">*</span>PE1-isis-1] <strong>bier enable</strong>
[<span class="keyword">*</span>PE1-isis-1] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>bier</strong>
[<span class="keyword">*</span>PE2-bier] <strong>sub-domain 0</strong> <strong>ipv6</strong>
[<span class="keyword">*</span>PE2-bier-sub-domain-0-ipv6] <strong>bfr-id 2</strong>
[<span class="keyword">*</span>PE2-bier-sub-domain-0-ipv6] <strong>encapsulation-type ipv6 bsl 256 max-si 0</strong>
[<span class="keyword">*</span>PE2-bier-sub-domain-0-ipv6] <strong>bfr-prefix interface loopback1</strong>
[<span class="keyword">*</span>PE2-bier-sub-domain-0-ipv6] <strong>end-bier locator PE2 sid 2001:db8:200::1</strong>
[<span class="keyword">*</span>PE2-bier-sub-domain-0-ipv6]<strong> protocol isis</strong>
[<span class="keyword">*</span>PE2-bier-sub-domain-0-ipv6] <strong>quit</strong>
[<span class="keyword">*</span>PE2-bier] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>isis 1</strong>
[<span class="keyword">*</span>PE2-isis-1] <strong>bier enable</strong>
[<span class="keyword">*</span>PE2-isis-1] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure PE3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong>bier</strong>
[<span class="keyword">*</span>PE3-bier] <strong>sub-domain 0</strong> <strong>ipv6</strong>
[<span class="keyword">*</span>PE3-bier-sub-domain-0-ipv6] <strong>bfr-id 3</strong>
[<span class="keyword">*</span>PE3-bier-sub-domain-0-ipv6] <strong>encapsulation-type ipv6 bsl 256 max-si 0</strong>
[<span class="keyword">*</span>PE3-bier-sub-domain-0-ipv6] <strong>bfr-prefix interface loopback1</strong>
[<span class="keyword">*</span>PE3-bier-sub-domain-0-ipv6] <strong>end-bier locator PE3 sid 2001:db8:300::1</strong>
[<span class="keyword">*</span>PE3-bier-sub-domain-0-ipv6]<strong> protocol isis</strong>
[<span class="keyword">*</span>PE3-bier-sub-domain-0-ipv6] <strong>quit</strong>
[<span class="keyword">*</span>PE3-bier] <strong>quit</strong>
[<span class="keyword">*</span>PE3] <strong>isis 1</strong>
[<span class="keyword">*</span>PE3-isis-1] <strong>bier enable</strong>
[<span class="keyword">*</span>PE3-isis-1] <strong>quit</strong>
[<span class="keyword">*</span>PE3] <strong>commit</strong></pre>
<p># Configure the P.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong>bier</strong>
[<span class="keyword">*</span>P-bier] <strong>sub-domain 0</strong> <strong>ipv6</strong>
[<span class="keyword">*</span>P-bier-sub-domain-0-ipv6] <strong>encapsulation-type ipv6 bsl 256 max-si 0</strong>
[<span class="keyword">*</span>P-bier-sub-domain-0-ipv6] <strong>bfr-prefix interface loopback1</strong>
[<span class="keyword">*</span>P-bier-sub-domain-0-ipv6] <strong>end-bier locator P sid 2001:db8:400::1</strong>
[<span class="keyword">*</span>P-bier-sub-domain-0-ipv6]<strong> protocol isis</strong>
[<span class="keyword">*</span>P-bier-sub-domain-0-ipv6] <strong>quit</strong>
[<span class="keyword">*</span>P-bier] <strong>quit</strong>
[<span class="keyword">*</span>P] <strong>isis 1</strong>
[<span class="keyword">*</span>P-isis-1] <strong>bier enable</strong>
[<span class="keyword">*</span>P-isis-1] <strong>quit</strong>
[<span class="keyword">*</span>P] <strong>commit</strong></pre>
</p></li><li><span>Establish BGP MVPN peer relationships between PEs.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>bgp 100</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp] <strong>ipv6-family mvpn</strong>
[<span class="keyword">*</span>PE1-bgp-af-mvpnv6] <strong>peer 2001:db8:20::1 enable</strong>
[<span class="keyword">*</span>PE1-bgp-af-mvpnv6] <strong>peer 2001:db8:30::1 enable</strong>
[<span class="keyword">*</span>PE1-bgp-af-mvpnv6] <strong>quit</strong>
[<span class="keyword">*</span>PE1-bgp] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>bgp 100</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-bgp] <strong>ipv6-family mvpn</strong>
[<span class="keyword">*</span>PE2-bgp-af-mvpnv6] <strong>peer 2001:db8:10::1 enable</strong>
[<span class="keyword">*</span>PE2-bgp-af-mvpnv6] <strong>quit</strong>
[<span class="keyword">*</span>PE2-bgp] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure PE3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong>bgp 100</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-bgp] <strong>ipv6-family mvpn</strong>
[<span class="keyword">*</span>PE3-bgp-af-mvpnv6] <strong>peer 2001:db8:10::1 enable</strong>
[<span class="keyword">*</span>PE3-bgp-af-mvpnv6] <strong>quit</strong>
[<span class="keyword">*</span>PE3-bgp] <strong>quit</strong>
[<span class="keyword">*</span>PE3] <strong>commit</strong></pre>
<p># Check information about BGP MVPN peers. The command output shows that a BGP MVPN peer relationship has been established between PE1 and PE2 and between PE1 and PE3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong>display bgp mvpn vpnv6 all peer</strong>

 BGP local router ID : 1.1.1.1
 Local AS number : 100
 Total number of peers : 2                 Peers in established state : 2

  Peer                             V          AS  MsgRcvd  MsgSent  OutQ  Up/Down       State  PrefRcv
  2001:DB8:20::1                   4         100   41      43    0 00:08:08        <strong>Established</strong>      0
  2001:DB8:30::1                   4         100   29      32    0 00:07:15        <strong>Established</strong>      0</pre>
</p></li><li><span>Configure multicast traffic forwarding over a BIERv6 I-PMSI tunnel.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>multicast ipv6 routing-enable</strong>
[<span class="keyword">*</span>PE1] <strong>multicast ipv6 mvpn ipv6-underlay 2001:DB8:10::1</strong>
[<span class="keyword">*</span>PE1] <strong>multicast ipv6 vpn-public</strong>
[<span class="keyword">*</span>PE1-mvpn-pub-ipv6] <strong>sender-enable</strong>
[<span class="keyword">*</span>PE1-mvpn-pub-ipv6] <strong>ipv6 underlay enable</strong>
[<span class="keyword">*</span>PE1-mvpn-pub-ipv6] <strong>src-dt6 locator PE1 sid 2001:db8:100::2</strong>
[<span class="keyword">*</span>PE1-mvpn-pub-ipv6] <strong>rpt-spt mode</strong>
[<span class="keyword">*</span>PE1-mvpn-pub-ipv6] <strong>ipmsi-tunnel</strong>
[<span class="keyword">*</span>PE1-mvpn-pub-ipv6-ipmsi] <strong>bier sub-domain 0 bsl 256</strong>
[<span class="keyword">*</span>PE1-mvpn-pub-ipv6-ipmsi] <strong>quit</strong>
[<span class="keyword">*</span>PE1-mvpn-pub-ipv6] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>multicast ipv6 routing-enable</strong>
[<span class="keyword">*</span>PE2]<strong> multicast ipv6 mvpn ipv6-underlay 2001:DB8:20::1</strong>
[<span class="keyword">*</span>PE2] <strong>multicast ipv6 vpn-public</strong>
[<span class="keyword">*</span>PE2-mvpn-pub-ipv6] <strong>c-multicast signaling bgp</strong>
[<span class="keyword">*</span>PE2-mvpn-pub-ipv6] <strong>ipv6 underlay enable</strong>
[<span class="keyword">*</span>PE2-mvpn-pub-ipv6] <strong>rpt-spt mode</strong>
[<span class="keyword">*</span>PE2-mvpn-pub-ipv6] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure PE3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong>multicast ipv6 routing-enable</strong>
[<span class="keyword">*</span>PE3] <strong>multicast ipv6 mvpn ipv6-underlay 2001:DB8:30::1</strong>
[<span class="keyword">*</span>PE3] <strong>multicast ipv6 vpn-public</strong>
[<span class="keyword">*</span>PE3-mvpn-pub-ipv6] <strong>c-multicast signaling bgp</strong>
[<span class="keyword">*</span>PE3-mvpn-pub-ipv6] <strong>ipv6 underlay enable</strong>
[<span class="keyword">*</span>PE3-mvpn-pub-ipv6] <strong>rpt-spt mode</strong>
[<span class="keyword">*</span>PE3-mvpn-pub-ipv6] <strong>quit</strong>
[<span class="keyword">*</span>PE3] <strong>commit</strong></pre>
<p># Check I-PMSI tunnel information of MVPN services in a specified VPN instance. The command output shows that an I-PMSI tunnel has been established, with PE1 as the root node and PE2 and PE3 as leaf nodes.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>PE1]<strong>display mvpn ipv6 public ipmsi</strong>
MVPN local I-PMSI information for VPN-Instance: _public_
Tunnel type: BIER IPv6
Tunnel state: Up
Src-dt6 SID: 2001:DB8:100::2
Sub-domain ID: 0
BFR-ID: 1
BFR prefix: 2001:DB8:10::1
Bit string ID: 1
Root: 2001:DB8:10::1 (local) 
Leaf: 
  1: 2001:DB8:20::1 (BFR-ID: 2, BFR prefix: 2001:DB8:20::1)
  2: 2001:DB8:30::1 (BFR-ID: 3, BFR prefix: 2001:DB8:30::1)</pre>
</p></li><li><span>Enable the BIERv6 S-PMSI tunnel function and configure switching criteria.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>multicast ipv6 vpn-public</strong>
[<span class="keyword">*</span>PE1-mvpn-pub-ipv6] <strong>ipmsi-to-spmsi switch immediately</strong>
[<span class="keyword">*</span>PE1-mvpn-pub-ipv6] <strong>spmsi-tunnel</strong>
[<span class="keyword">*</span>PE1-mvpn-pub-ipv6-spmsi] <strong>group </strong><strong>FF13::100 96</strong> <strong>source 2001:db8:111:: 64</strong><strong> threshold 10 bier</strong> 
[<span class="keyword">*</span>PE1-mvpn-pub-ipv6-spmsi] <strong>switch-delay 20</strong>
[<span class="keyword">*</span>PE1-mvpn-pub-ipv6-spmsi] <strong>holddown-time 80</strong>
[<span class="keyword">*</span>PE1-mvpn-pub-ipv6-spmsi] <strong>quit</strong>
[<span class="keyword">*</span>PE1-mvpn-pub-ipv6] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
</p></li><li><span>Enable PIM on PEs.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface gigabitethernet <span>0/1/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface LoopBack2</strong>
[<span class="keyword">*</span>PE1-Loopback2] <strong>ipv6 enable</strong> 
[<span class="keyword">*</span>PE1-Loopback2] <strong>ipv6 address 2001</strong><strong>:db8:50::1 64</strong>
[<span class="keyword">*</span>PE1-Loopback2] <strong>pim ipv6 sm</strong> 
[<span class="keyword">*</span>PE1-Loopback2] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>pim-ipv6</strong>
[<span class="keyword">*</span>PE1-pim6] <strong>static-rp </strong><strong>2001</strong><strong>:db8:50::1</strong>
[<span class="keyword">*</span>PE1-pim6] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface gigabitethernet <span>0/1/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>pim-ipv6</strong>
[<span class="keyword">*</span>PE2-pim6] <strong>static-rp </strong><strong>2001</strong><strong>:db8:50::1</strong>
[<span class="keyword">*</span>PE2-pim6] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure PE3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong>interface gigabitethernet <span>0/1/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-GigabitEthernet<span>0/1/1</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>PE3] <strong>pim-ipv6</strong>
[<span class="keyword">*</span>PE3-pim6] <strong>static-rp 2001:db8:50::1</strong>
[<span class="keyword">*</span>PE3-pim6] <strong>quit</strong>
[<span class="keyword">*</span>PE3] <strong>commit</strong></pre>
<p># Check S-PMSI tunnel information of MVPN services in a specified VPN instance. The command output on PE2 shows the S-PMSI tunnel and multicast user information.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>PE2]<strong>display mvpn ipv6 public spmsi</strong> <strong>verbose</strong>
MVPN local S-PMSI information for VPN-Instance : _public_ 
 Total number of tunnel: 1 
 S-PMSI A-D Route Type: -- 
 Tunnel type: BIER IPv6 
 Tunnel state: -- 
 Src-dt6 SID: 2001:DB8:100::1 
 Sub-domain ID: 0 
 BFR-ID: 1 
 BFR prefix: 2001:DB8:10::1 
 Root: 2001:DB8:10::1 
 Leaf: 
   1: 2001:DB8:20::1 (BFR-ID: 2, BFR prefix: 2001:DB8:20::1)(local)
 Total number of (S, G): 1 
     1. (2001:DB8:111::100, FF13::100) </pre>
</p></li><li><span>Configure network slice instances, specify basic interfaces, and create network slice interfaces on PE1, PE2, PE3, and the P. The configurations of PE1 and P are used as an example. The configurations of PE2 and PE3 are similar to the configuration of PE1. </span><p><div class="p"># Configure PE1.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>network-slice instance 10</strong>
[<span class="keyword">*</span>PE1-network-slice-instance-10] <strong>description Basic</strong>
[<span class="keyword">*</span>PE1-network-slice-instance-10] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>network-slice instance 20</strong>
[<span class="keyword">*</span>PE1-network-slice-instance-20] <strong>description VPNA</strong>
[<span class="keyword">*</span>PE1-network-slice-instance-20] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>network-slice instance 30</strong>
[<span class="keyword">*</span>PE1-network-slice-instance-30] <strong>description SG</strong>
[<span class="keyword">*</span>PE1-network-slice-instance-30] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>network-slice 10 data-plane</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/1/0</span>.1</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>vlan-type dot1q 11</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>mode channel enable</strong> 
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>mode channel </strong><strong>bandwidth 500</strong> 
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>basic-slice 10</strong> 
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>network-slice 20 data-plane</strong> 
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.1] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/1/0</span>.2</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.2] <strong>vlan-type dot1q 22</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.2] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.2] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.2] <strong>mode channel enable</strong> 
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.2] <strong>mode channel </strong><strong>bandwidth 500</strong> 
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.2] <strong>basic-slice 10</strong> 
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.2] <strong>network-slice 30 data-plane</strong> 
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>.2] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
</div>
</p><p><div class="p"># Configure the P.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong>network-slice instance 10</strong>
[<span class="keyword">*</span>P-network-slice-instance-10] <strong>description Basic</strong>
[<span class="keyword">*</span>P-network-slice-instance-10] <strong>quit</strong>
[<span class="keyword">*</span>P] <strong>network-slice instance 20</strong>
[<span class="keyword">*</span>P-network-slice-instance-20] <strong>description VPNA</strong>
[<span class="keyword">*</span>P-network-slice-instance-20] <strong>quit</strong>
[<span class="keyword">*</span>P] <strong>network-slice instance 30</strong>
[<span class="keyword">*</span>P-network-slice-instance-30] <strong>description SG</strong>
[<span class="keyword">*</span>P-network-slice-instance-30] <strong>quit</strong>
[<span class="keyword">*</span>P] <strong>interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong>network-slice 10 data-plane</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>P] <strong>interface gigabitethernet <span>0/1/0</span>.1</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>.1] <strong>vlan-type dot1q 11</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>.1] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>.1] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>.1] <strong>mode channel enable</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>.1] <strong>mode channel </strong><strong>bandwidth 500</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>.1] <strong>basic-slice 10</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>.1] <strong>network-slice 20 data-plane</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>.1] <strong>quit</strong>
[<span class="keyword">*</span>P] <strong>interface gigabitethernet <span>0/1/0</span>.2</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>.2] <strong>vlan-type dot1q 22</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>.2] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>.2] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>.2] <strong>mode channel enable</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>.2] <strong>mode channel </strong><strong>bandwidth 500</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>.2] <strong>basic-slice 10</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>.2] <strong>network-slice 30 data-plane</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>.2] <strong>quit</strong>
[<span class="keyword">*</span>P] <strong>interface gigabitethernet <span>0/1/1</span></strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>] <strong>network-slice 10 data-plane</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>P] <strong>interface gigabitethernet <span>0/1/1</span>.1</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>.1] <strong>vlan-type dot1q 11</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>.1] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>.1] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>.1] <strong>mode channel enable</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>.1] <strong>mode channel </strong><strong>bandwidth 500</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>.1] <strong>basic-slice 10</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>.1] <strong>network-slice 20 data-plane</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>.1] <strong>quit</strong>
[<span class="keyword">*</span>P] <strong>interface gigabitethernet <span>0/1/1</span>.2</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>.2] <strong>vlan-type dot1q 22</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>.2] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>.2] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>.2] <strong>mode channel enable</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>.2] <strong>mode channel </strong><strong>bandwidth 500</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>.2] <strong>basic-slice 10</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>.2] <strong>network-slice 30 data-plane</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>.2] <strong>quit</strong>
[<span class="keyword">*</span>P] <strong>interface gigabitethernet <span>0/1/2</span></strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>] <strong>network-slice 10 data-plane</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>P] <strong>interface gigabitethernet <span>0/1/2</span>.1</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>.1] <strong>vlan-type dot1q 11</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>.1] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>.1] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>.1] <strong>mode channel enable</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>.1] <strong>mode channel </strong><strong>bandwidth 500</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>.1] <strong>basic-slice 10</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>.1] <strong>network-slice 20 data-plane</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>.1] <strong>quit</strong>
[<span class="keyword">*</span>P] <strong>interface gigabitethernet <span>0/1/2</span>.2</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>.2] <strong>vlan-type dot1q 22</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>.2] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>.2] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>.2] <strong>mode channel enable</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>.2] <strong>mode channel </strong><strong>bandwidth 500</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>.2] <strong>basic-slice 10</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>.2] <strong>network-slice 30 data-plane</strong> 
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>.2] <strong>quit</strong>
[<span class="keyword">*</span>P1] <strong>commit</strong></pre>
</div>
</p></li><li><span>Enable BIERv6 network slicing on PE1 and the P. Use PE1 as an example and refer to PE1' configuration to configure the P.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>bier ipv6 network-slice enable</strong>
[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
</p></li><li><span>Specify a network slice ID for the public network MVPN instance and another network slice ID for a multicast stream in this instance on PE1.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>multicast ipv6 vpn-public</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-mvpn-pub-ipv6] <strong>bier ipv6 network-slice 20</strong>
[<span class="keyword">*</span>PE1-mvpn-pub-ipv6] <strong>bier ipv6 group FF1E::1 source 2001:DB8:4::100 network-slice 30</strong>
[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><div class="p">Run the <strong>display mvpn ipv6 public ingress bier ipv6</strong> command on the ingress PE1 of the BIERv6 tunnel to check BIERv6 stream information in the public network MVPN instance. The command output shows that the network slice ID corresponding to the multicast stream (2001:DB8:4::100, FF1E::1) is 30, and the network slice ID corresponding to other multicast streams is 20.<pre class="screen">&lt;PE1&gt; <strong>display mvpn ipv6 public ingress bier ipv6</strong>
BIER information of VPN-Instance: _public_
Sub-domain ID: 0 
BSL: 256 
Source-Dt: 2001:DB8:100::2 
Total Number of (S,G): 3 
-------------------------------------------------------------- 
Source       Group           Flow Label  SliceID 
-------------------------------------------------------------- 
2001:DB8:4::102    FF1E::3   1                 20 
2001:DB8:4::101    FF1E::2   2                 20 
2001:DB8:4::100    FF1E::1   3                 30 
--------------------------------------------------------------</pre>
</div>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0000001436916485__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li>CE1 configuration file<pre class="screen"># 
sysname CE1 
#
multicast ipv6 routing-enable
# 
interface GigabitEthernet <span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:4::2/96
 pim ipv6 sm
#
bgp 65410
 router-id 11.11.11.11
 peer 2001:DB8:4::1 as-number 100
 #
 ipv6-family unicast
  undo synchronization
  peer 2001:DB8:4::1 enable
#
return</pre>
</li><li>CE2 configuration file<pre class="screen"># 
sysname CE2 
#
multicast ipv6 routing-enable
# 
interface GigabitEthernet <span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:5::2/96
 pim ipv6 sm
#
interface GigabitEthernet <span>0/1/1</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:8::2/96
 mld enable
 mld version 1
 pim ipv6 sm
#
bgp 65411
 router-id 12.12.12.12
 peer 2001:DB8:5::1 as-number 100 
 #
 ipv6-family unicast
  undo synchronization
  peer 2001:DB8:5::1 enable
#
return</pre>
</li><li>CE3 configuration file<pre class="screen"># 
sysname CE3 
#
multicast ipv6 routing-enable
# 
interface GigabitEthernet <span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:6::2/96
 pim ipv6 sm
# 
interface GigabitEthernet <span>0/1/1</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:7::2/96
 mld enable
 mld version 1
 pim ipv6 sm
#
bgp 65412
 router-id 13.13.13.13
 peer 2001:DB8:6::1 as-number 100 
 #
 ipv6-family unicast
  undo synchronization
  peer 2001:DB8:6::1 enable
#
return</pre>
</li><li>PE1 configuration file<pre class="screen">#                                                                               
sysname PE1                                                                     
#
multicast ipv6 routing-enable
#
multicast ipv6 mvpn ipv6-underlay 2001:DB8:10::1                                     
#
network-slice instance 10
 description Basic
#
network-slice instance 20
 description VPNA
#
network-slice instance 30
 description SG
#   
multicast ipv6 vpn-public
 ipv6 underlay enable                                                         
 sender-enable                                                                
 src-dt6 locator PE1 sid 2001:DB8:100::2
 bier ipv6 network-slice 20
 bier ipv6 group FF1E::1 source 2001:DB8:4::100 network-slice 30
 rpt-spt mode
 ipmsi-tunnel
  bier sub-domain 0 bsl 256
 ipmsi-to-spmsi switch immediately
 spmsi-tunnel                                                                 
  holddown-time 80                                                            
  switch-delay 20                                                             
  group FF13:: 96 source 2001:DB8:111:: 64 threshold 10 bier
#                                                                               
segment-routing ipv6                                                            
 encapsulation source-address 2001:DB8:10::1 
 locator PE1 ipv6-prefix 2001:DB8:100:: 64 static 32                                                       
#                                                                               
isis 1                                                                          
 is-level level-2                                                               
 cost-style wide                                                                
 network-entity 10.0000.0000.0001.00                                            
 bier enable                                                                    
 #                                                                              
 ipv6 enable topology ipv6                                                      
 segment-routing ipv6 locator PE1 auto-sid-disable                              
 #                                                                              
#                                                                               
interface GigabitEthernet<span>0/1/0</span>                                                  
 undo shutdown                                                                  
 ipv6 enable                                                                    
 ipv6 address 2001:DB8:1::2/96                                                  
 isis ipv6 enable 1
 network-slice 10 data-plane                                              
#  
interface GigabitEthernet<span>0/1/0</span>.1 
 vlan-type dot1q 11
 ipv6 enable    
 ipv6 address auto link-local
 mode channel enable 
 mode channel bandwidth 500
 basic-slice 10 
 network-slice 20 data-plane
#               
interface GigabitEthernet<span>0/1/0</span>.2 
 vlan-type dot1q 22
 ipv6 enable    
 ipv6 address auto link-local
 mode channel enable 
 mode channel bandwidth 500
 basic-slice 10 
 network-slice 30 data-plane
#                                                                               
interface GigabitEthernet<span>0/1/1</span>                                                  
 undo shutdown                                                                  
 ipv6 enable                                                   
 ipv6 address 2001:DB8:4::1/96                                           
 pim ipv6 sm
#
interface LoopBack2
 ipv6 enable
 ipv6 address 2001:DB8:50::1/64
 pim ipv6 sm
#
pim-ipv6
 static-rp 2001:DB8:50::1
#                                                                               
interface LoopBack1                                                             
 ipv6 enable                                                                    
 ipv6 address 2001:DB8:10::1/128                                                
 isis ipv6 enable 1                                                             
#                                                                               
bgp 100                                                                         
 router-id 1.1.1.1 
 peer 2001:DB8:4::2 as-number 65410
 peer 2001:DB8:20::1 as-number 100                                              
 peer 2001:DB8:20::1 connect-interface LoopBack1                                
 peer 2001:DB8:30::1 as-number 100                                              
 peer 2001:DB8:30::1 connect-interface LoopBack1                                
 #                                                                              
 ipv4-family unicast                                                            
  undo synchronization
 #                                                                              
 ipv6-family unicast                                                              
  undo synchronization
  import-route direct
  segment-routing ipv6 locator PE1
  segment-routing ipv6 best-effort 
  peer 2001:DB8:4::2 enable
  peer 2001:DB8:20::1 enable                                                    
  peer 2001:DB8:20::1 advertise-ext-community
  peer 2001:DB8:20::1 prefix-sid advertise-srv6-locator                                               
  peer 2001:DB8:30::1 enable
  peer 2001:DB8:30::1 advertise-ext-community                                                    
  peer 2001:DB8:30::1 prefix-sid advertise-srv6-locator
 #
 ipv6-family mvpn                                                               
  policy vpn-target                                                             
  peer 2001:DB8:20::1 enable                                                    
  peer 2001:DB8:30::1 enable                                                                                             
#
bier                                                                            
 sub-domain 0 ipv6
  bfr-id 1                                                              
  bfr-prefix interface LoopBack1                                                
  protocol isis                                                                 
  end-bier locator PE1 sid 2001:DB8:100::1                                      
  encapsulation-type ipv6 bsl 256 max-si 0                                      
#
bier ipv6 network-slice enable
#
return</pre>
</li><li>PE2 configuration file<pre class="screen">#                                                                               
sysname PE2                                                                     
#
multicast ipv6 routing-enable
#                                                                               
multicast ipv6 mvpn ipv6-underlay 2001:DB8:20::1                                     
#
network-slice instance 10
 description Basic
#
network-slice instance 20
 description VPNA
#
network-slice instance 30
 description SG
#
multicast ipv6 vpn-public                                                             
  ipv6 underlay enable  
  c-multicast signaling bgp
  rpt-spt mode                                                    
#                                                                               
segment-routing ipv6                                                            
 encapsulation source-address 2001:DB8:20::1                                    
 locator PE2 ipv6-prefix 2001:DB8:200:: 64 static 32                                                       
#                        
isis 1                                                                          
 cost-style wide                                                                
 network-entity 10.0000.0000.0002.00                                            
 bier enable                                                                    
 #                                                                              
 ipv6 enable topology ipv6                                                      
 segment-routing ipv6 locator PE2 auto-sid-disable                              
 #                                                                              
#                                                                               
interface GigabitEthernet<span>0/1/0</span>                                                          
 undo shutdown                                                                  
 ipv6 enable                                                                    
 ipv6 address 2001:DB8:2::2/96                                                  
 isis ipv6 enable 1
 network-slice 10 data-plane                                                                         
#
interface GigabitEthernet<span>0/1/0</span>.1 
 vlan-type dot1q 11
 ipv6 enable    
 ipv6 address auto link-local
 mode channel enable 
 mode channel bandwidth 500
 basic-slice 10 
 network-slice 20 data-plane
#               
interface GigabitEthernet<span>0/1/0</span>.2 
 vlan-type dot1q 22
 ipv6 enable    
 ipv6 address auto link-local
 mode channel enable 
 mode channel bandwidth 500
 basic-slice 10 
 network-slice 30 data-plane
#                                                                               
interface GigabitEthernet<span>0/1/1</span>                                                         
 undo shutdown
 ipv6 enable                                           
 ipv6 address 2001:DB8:5::1/96  
 pim ipv6 sm
#
 pim-ipv6
  static-rp 2001:DB8:50::1
#
interface LoopBack1                                                             
 ipv6 enable                                                                    
 ipv6 address 2001:DB8:20::1/128                                                
 isis ipv6 enable 1                                                             
#                                                                               
bgp 100                                                                         
 router-id 1.1.1.2                                                              
 peer 2001:DB8:5::2 as-number 65411
 peer 2001:DB8:10::1 as-number 100                                              
 peer 2001:DB8:10::1 connect-interface LoopBack1                                
 #                                                                              
 ipv4-family unicast                                                            
  undo synchronization                                                          
 #                                                                              
 ipv6-family unicast                                                  
  undo synchronization
  import-route direct                                                           
  segment-routing ipv6 locator PE2                                              
  segment-routing ipv6 best-effort
  peer 2001:DB8:5::2 enable
  peer 2001:DB8:10::1 enable
  peer 2001:DB8:10::1 advertise-ext-community
  peer 2001:DB8:10::1 prefix-sid advertise-srv6-locator
 #                    
 ipv6-family mvpn                                                               
  policy vpn-target                                                             
  peer 2001:DB8:10::1 enable
#                                      
bier                                                                            
 sub-domain 0 ipv6                                                              
  bfr-id 2                                                                      
  bfr-prefix interface LoopBack1                                                
  protocol isis                                                                 
  end-bier locator PE2 sid 2001:DB8:200::1                                      
  encapsulation-type ipv6 bsl 256 max-si 0                                      
#                                                                               
return                                  </pre>
</li><li>PE3 configuration file<pre class="screen">#                                                                               
sysname PE3                                                                     
# 
multicast ipv6 routing-enable
#                                                                              
multicast ipv6 mvpn ipv6-underlay 2001:DB8:30::1                                     
#
network-slice instance 10
 description Basic
#
network-slice instance 20
 description VPNA
#
network-slice instance 30
 description SG
#
multicast ipv6 vpn-public                                                                                                                              
  ipv6 underlay enable
  c-multicast signaling bgp
  rpt-spt mode                                                    
#                                                                               
segment-routing ipv6                                                            
 encapsulation source-address 2001:DB8:30::1                                    
 locator PE3 ipv6-prefix 2001:DB8:300:: 64 static 32                                    
#                        
isis 1                                                                          
 cost-style wide                                                                
 network-entity 10.0000.0000.0003.00                                            
 bier enable                                                                    
 #                                                                              
 ipv6 enable topology ipv6                                                      
 segment-routing ipv6 locator PE3 auto-sid-disable                              
 #                                                                              
#                                                                               
interface GigabitEthernet<span>0/1/0</span>                                                          
 undo shutdown                                                                  
 ipv6 enable                                                                    
 ipv6 address 2001:DB8:3::2/96                                                  
 isis ipv6 enable 1
 network-slice 10 data-plane                                                                         
#
interface GigabitEthernet<span>0/1/0</span>.1 
 vlan-type dot1q 11
 ipv6 enable    
 ipv6 address auto link-local
 mode channel enable 
 mode channel bandwidth 500
 basic-slice 10 
 network-slice 20 data-plane
#               
interface GigabitEthernet<span>0/1/0</span>.2 
 vlan-type dot1q 22
 ipv6 enable    
 ipv6 address auto link-local
 mode channel enable 
 mode channel bandwidth 500
 basic-slice 10 
 network-slice 30 data-plane
#                                                                               
interface GigabitEthernet<span>0/1/1</span>                                                         
 undo shutdown
 ipv6 enable                                                 
 ipv6 address 2001:DB8:6::1/96   
 pim ipv6 sm
# 
 pim-ipv6
  static-rp 2001:DB8:50::1
#
interface LoopBack1                                                             
 ipv6 enable                                                                    
 ipv6 address 2001:DB8:30::1/128                                                
 isis ipv6 enable 1                                                             
#                                                                               
bgp 100                                                                         
 router-id 1.1.1.3                                                               
 peer 2001:DB8:6::2 as-number 65412
 peer 2001:DB8:10::1 as-number 100                                              
 peer 2001:DB8:10::1 connect-interface LoopBack1                                
 #                                                                              
 ipv4-family unicast                                                            
  undo synchronization                                                          
 #                      
 ipv6-family mvpn                                                               
  policy vpn-target                                                             
  peer 2001:DB8:10::1 enable                                              
 #                                                                              
 ipv6-family unicast
  undo synchronization                                                  
  import-route direct                                                           
  segment-routing ipv6 locator PE3                                              
  segment-routing ipv6 best-effort
  peer 2001:DB8:6::2 enable
  peer 2001:DB8:10::1 enable
  peer 2001:DB8:10::1 advertise-ext-community
  peer 2001:DB8:10::1 prefix-sid advertise-srv6-locator
#                                      
bier                                                                            
 sub-domain 0 ipv6                                                              
  bfr-id 3                                                                      
  bfr-prefix interface LoopBack1                                                
  protocol isis                                                                 
  end-bier locator PE3 sid 2001:DB8:300::1                                      
  encapsulation-type ipv6 bsl 256 max-si 0                                      
#                                                                               
return                                  </pre>
</li><li>P configuration file<pre class="screen">#                                                                               
sysname P                                                                       
#
network-slice instance 10
 description Basic
#
network-slice instance 20
 description VPNA
#
network-slice instance 30
 description SG
#
segment-routing ipv6                                                            
 encapsulation source-address 2001:DB8:40::1                                    
 locator P ipv6-prefix 2001:DB8:400:: 64 static 32                                                       
#                                                                               
isis 1                                                                          
 is-level level-2                                                               
 cost-style wide                                                                
 network-entity 10.0000.0000.0004.00                                            
 bier enable                                                                    
 #                                                                              
 ipv6 enable topology ipv6                                                      
 segment-routing ipv6 locator P auto-sid-disable                                
 #                                                                              
#                                                                               
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown                                                                  
 ipv6 enable                                                                    
 ipv6 address 2001:DB8:1::1/96        
 isis ipv6 enable 1
 network-slice 10 data-plane                                                             
#
interface GigabitEthernet<span>0/1/0</span>.1 
 vlan-type dot1q 11
 ipv6 enable    
 ipv6 address auto link-local
 mode channel enable 
 mode channel bandwidth 500
 basic-slice 10 
 network-slice 20 data-plane
#               
interface GigabitEthernet<span>0/1/0</span>.2 
 vlan-type dot1q 22
 ipv6 enable    
 ipv6 address auto link-local
 mode channel enable 
 mode channel bandwidth 500
 basic-slice 10 
 network-slice 30 data-plane
#                                                                               
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown                                                                  
 ipv6 enable                                                                    
 ipv6 address 2001:DB8:2::1/96                                                  
 isis ipv6 enable 1
 network-slice 10 data-plane                                                            
#
interface GigabitEthernet<span>0/1/1</span>.1 
 vlan-type dot1q 11
 ipv6 enable    
 ipv6 address auto link-local
 mode channel enable 
 mode channel bandwidth 500
 basic-slice 10 
 network-slice 20 data-plane
#               
interface GigabitEthernet<span>0/1/1</span>.2 
 vlan-type dot1q 22
 ipv6 enable    
 ipv6 address auto link-local
 mode channel enable 
 mode channel bandwidth 500
 basic-slice 10 
 network-slice 30 data-plane
#                                                                               
interface GigabitEthernet<span>0/1/2</span> 
 undo shutdown                                                                  
 ipv6 enable                                                                    
 ipv6 address 2001:DB8:3::1/96                                                  
 isis ipv6 enable 1
 network-slice 10 data-plane                                                             
#
interface GigabitEthernet<span>0/1/2</span>.1 
 vlan-type dot1q 11
 ipv6 enable    
 ipv6 address auto link-local
 mode channel enable 
 mode channel bandwidth 500
 basic-slice 10 
 network-slice 20 data-plane
#               
interface GigabitEthernet<span>0/1/2</span>.2 
 vlan-type dot1q 22
 ipv6 enable    
 ipv6 address auto link-local
 mode channel enable 
 mode channel bandwidth 500
 basic-slice 10 
 network-slice 30 data-plane
#                                                                               
interface LoopBack1                                                             
 ipv6 enable                                                                    
 ipv6 address 2001:DB8:40::1/128                                                
 isis ipv6 enable 1                                                             
#                                                                               
bier                                                                            
 sub-domain 0 ipv6                                                              
  bfr-prefix interface LoopBack1                                                
  protocol isis                                                                 
  end-bier locator P sid 2001:DB8:400::1                                        
  encapsulation-type ipv6 bsl 256 max-si 0                                    
#
bier ipv6 network-slice enable
#
return                                                                          </pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0023.html">Configuration Examples
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_1012.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_bierv6_cfg_0025.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>

<script language="JavaScript">
<!--
image_size('.imgResize');
var msg_imageMax = "view original image";
var msg_imageClose = "close";
//--></script></body>
</html>