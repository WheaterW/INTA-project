
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Multicast over P2MP TE Tunnels">
<meta name="abstract" content="This section provides an example of how to configure multicast over a point-to-multipoint (P2MP) Traffic Engineering (TE) tunnel.">
<meta name="description" content="This section provides an example of how to configure multicast over a point-to-multipoint (P2MP) Traffic Engineering (TE) tunnel.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_0036.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2153.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2295.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172366939">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring Multicast over P2MP TE Tunnels</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172366939"></a><a name="EN-US_TASK_0172366939"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Multicast over P2MP TE Tunnels</h1>
<div class="taskbody"><p>This section provides an example of how to configure multicast over a point-to-multipoint (P2MP) Traffic Engineering (TE) tunnel.</p>
<div class="context"><a name="EN-US_TASK_0172366939__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>The IP multicast service bearer technology used on the current IP/MPLS backbone network relies on the IP unicast technology. Like IP unicast, IP multicast fails to provide sufficient bandwidth, QoS capabilities, reliability and high real-time performance for multicast services such as IPTV and massively multiplayer online role-playing games (MMORPGs). A P2MP TE tunnel can solve this problem. A P2MP TE tunnel can be configured on a live IP/MPLS backbone network, and supports the P2MP TE FRR function, meeting multicast service requirements.</p>
<p>A P2MP TE tunnel is established on the network shown in <a href="#EN-US_TASK_0172366939__fig_dc_vrp_multicast_cfg_220101">Figure 1</a>. PE1 is the tunnel ingress. PE2, and PE3 are leaf nodes, and the tunnel bandwidth is 1000 kbit/s. For the IP address of each node, see <a href="#EN-US_TASK_0172366939__tab_dc_vrp_multicast_cfg_220101">Table 1</a>.</p>
<div class="fignone" id="EN-US_TASK_0172366939__fig_dc_vrp_multicast_cfg_220101"><a name="EN-US_TASK_0172366939__fig_dc_vrp_multicast_cfg_220101"></a><a name="fig_dc_vrp_multicast_cfg_220101"></a><span class="figcap"><b>Figure 1 </b>Networking for a P2MP TE tunnel</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1, 2, and 3 in this example represent GE <span>0/1/0</span>, GE <span>0/2/0</span>, and GE <span>0/3/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_multicast_cfg_220101.png"></span></div>
<div class="p">
<div class="tableBorder"><a name="EN-US_TASK_0172366939__tab_dc_vrp_multicast_cfg_220101"></a><a name="tab_dc_vrp_multicast_cfg_220101"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172366939__tab_dc_vrp_multicast_cfg_220101" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Interface IP addresses</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="16.66833316668333%" id="mcps1.4.1.5.1.2.7.1.1" liSelected="liSelected"><p>Device</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="32.666733326667334%" id="mcps1.4.1.5.1.2.7.1.2" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="12.668733126687332%" id="mcps1.4.1.5.1.2.7.1.3" liSelected="liSelected"><p>IP Address</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="6.829317068293171%" id="mcps1.4.1.5.1.2.7.1.4" liSelected="liSelected"><p>Device</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="22.997700229977003%" id="mcps1.4.1.5.1.2.7.1.5" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="8.16918308169183%" id="mcps1.4.1.5.1.2.7.1.6" liSelected="liSelected"><p>IP Address</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="3" valign="top" width="16.66833316668333%" headers="mcps1.4.1.5.1.2.7.1.1 "><p>PE1</p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="32.666733326667334%" headers="mcps1.4.1.5.1.2.7.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="12.668733126687332%" headers="mcps1.4.1.5.1.2.7.1.3 "><p>10.1.1.1/24</p>
</td>
<td class="cellrowborder" rowspan="3" valign="top" width="6.829317068293171%" headers="mcps1.4.1.5.1.2.7.1.4 "><p>PE2</p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="22.997700229977003%" headers="mcps1.4.1.5.1.2.7.1.5 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="8.16918308169183%" headers="mcps1.4.1.5.1.2.7.1.6 "><p>10.4.1.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.2 "><p>GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.3 "><p>10.7.1.1/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.5 "><p>GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.6 "><p>10.9.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.2 "><p>Loopback 1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.3 "><p>1.1.1.1/32</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.5 "><p>Loopback 1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.6 "><p>5.5.5.5/32</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" valign="top" width="16.66833316668333%" headers="mcps1.4.1.5.1.2.7.1.1 "><p>P1</p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="32.666733326667334%" headers="mcps1.4.1.5.1.2.7.1.2 "><p>GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="12.668733126687332%" headers="mcps1.4.1.5.1.2.7.1.3 "><p>10.1.1.2/24</p>
</td>
<td class="cellrowborder" rowspan="4" valign="top" width="6.829317068293171%" headers="mcps1.4.1.5.1.2.7.1.4 "><p>P2</p>
<p></p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="22.997700229977003%" headers="mcps1.4.1.5.1.2.7.1.5 "><p>GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="8.16918308169183%" headers="mcps1.4.1.5.1.2.7.1.6 "><p>10.2.1.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.2 "><p>GigabitEthernet<span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.3 "><p>10.2.1.1/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.5 "><p>GigabitEthernet<span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.6 "><p>10.4.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.2 "><p>Loopback 1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.3 "><p>2.2.2.2/32</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.5 "><p>GigabitEthernet <span>0/3/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.6 "><p>10.5.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" valign="top" headers="mcps1.4.1.5.1.2.7.1.1 "><p>SR1</p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.3 "><p>10.7.1.2/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.5 "><p>Loopback 1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.6 "><p>4.4.4.4/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.2 "><p>GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.3 "><p>10.8.1.2/24</p>
</td>
<td class="cellrowborder" rowspan="3" valign="top" headers="mcps1.4.1.5.1.2.7.1.4 "><p>PE3</p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.5 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.6 "><p>10.5.1.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.2 "><p>Loopback 1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.3 "><p>3.3.3.3/32</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.5 "><p>GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.6 "><p>10.10.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.1 "><p>Source</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.2 "><p>Loopback 1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.3 "><p>8.8.8.8/32</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.5 "><p>Loopback 1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.5.1.2.7.1.6 "><p>6.6.6.6/32</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172366939__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>When you configure multicast, enable IGMP on the PE interface connected to multicast data receivers.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172366939__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Assign an IP address to each interface and configure a loopback interface address as an LSR ID on each node.</p>
</li><li><p>Configure Intermediate System to Intermediate System (IS-IS) to advertise the route to each network segment of each interface and the host route to each loopback interface address that is an LSR ID.</p>
</li><li><p>Enable MPLS, MPLS TE, and MPLS Resource Reservation Protocol (RSVP) globally on each node and constraint shortest path first (CSPF) on the ingress to enable all nodes to have MPLS forwarding capabilities.</p>
</li><li><p>Enable the IS-IS TE capability to ensure that MPLS TE can advertise information about link status.</p>
</li><li><p>Enable the MPLS TE capability on the interfaces of each node, and configure link attributes for the interfaces so that the interfaces can send RSVP signaling packets.</p>
</li><li><p>Configure explicit paths and a leaf list on the ingress PE1 to specify the leaf nodes on the P2MP TE tunnel.</p>
</li><li><p>Configure a P2MP TE tunnel interface on PE1 to ensure that the ingress establishes a P2MP TE tunnel based on all configuration information on the interface.</p>
</li><li><p>Enable multicast on the device connected to the multicast source, ingress, and egresses.</p>
</li><li><p>On PE1, direct multicast traffic to the P2MP TE tunnel. On PE2 and PE3, direct multicast traffic out of the P2MP TE tunnel.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172366939__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IP addresses of all interfaces shown in <a href="#EN-US_TASK_0172366939__fig_dc_vrp_multicast_cfg_220101">Figure 1</a></p>
</li><li><p>IS-IS (used as an IGP protocol), IS-IS process ID (1), IS-IS system ID of each node (obtained by translating the IP address of loopback1 of each node), and IS-IS level (Level-2)</p>
</li><li><p>MPLS LSR ID of each node using the corresponding loopback interface address</p>
</li><li><p>Maximum reservable bandwidth (10000 kbit/s) of the outbound interface along the path and BC0 bandwidth (10000 kbit/s)</p>
</li><li><p>Name of an explicit path used by each leaf node (tope1, tope2, and tope3), name of the leaf list (iptv1), and addresses of each leaf node (MPLS LSR ID of each leaf node)</p>
</li><li><p>Tunnel interface number (Tunnel 10), tunnel ID (100), loopback interface address used as the IP address of the tunnel interface, and tunnel bandwidth (1000 kbit/s)</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172366939__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure IP addresses for the interfaces.</span><p><p>Configure IP addresses for the interfaces according to <a href="#EN-US_TASK_0172366939__fig_dc_vrp_multicast_cfg_220101">Figure 1</a>, and create a loopback interface on each node. For configuration details, see <a href="#EN-US_TASK_0172366939__section_dc_vrp_multicast_cfg_220105">Configuration Files</a> in this section.</p>
</p></li><li><span>Configure IS-IS to advertise the route to each network segment of each interface and to advertise the host route to each LSR ID.</span><p><p>Configure IS-IS on each node to allow the nodes to communicate at the network layer. For configuration details, see <a href="#EN-US_TASK_0172366939__section_dc_vrp_multicast_cfg_220105">Configuration Files</a> in this section.</p>
</p></li><li><span>Enable MPLS, MPLS TE, and MPLS RSVP globally on each node and CSPF on the ingress.</span><p><p># Configure PE1.</p>
<pre class="screen">&lt;PE1&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> mpls lsr-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls] <strong>mpls te p2mp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls] <strong>mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-mpls] <strong>quit</strong></pre>
<p># Configure P1.</p>
<pre class="screen">&lt;P1&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1]<strong> mpls lsr-id 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-mpls]<strong> mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-mpls]<strong> mpls te p2mp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-mpls]<strong> mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-mpls]<strong> mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-mpls] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1-mpls] <strong>quit</strong></pre>
<p># Configure P2.</p>
<pre class="screen">&lt;P2&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P2]<strong> mpls lsr-id 4.4.4.4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-mpls]<strong> mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-mpls]<strong> mpls te p2mp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-mpls]<strong> mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-mpls]<strong> mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-mpls]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P2-mpls]<strong> quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">&lt;PE2&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> mpls lsr-id 5.5.5.5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls]<strong> mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls]<strong> mpls te p2mp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls]<strong> mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls]<strong> mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-mpls]<strong> quit</strong></pre>
<p># Configure PE3.</p>
<pre class="screen">&lt;PE3&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3]<strong> mpls lsr-id 6.6.6.6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-mpls]<strong> mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-mpls]<strong> mpls te p2mp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-mpls]<strong> mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-mpls]<strong> mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-mpls]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-mpls]<strong> quit</strong></pre>
</p></li><li><span>Enable IS-IS TE on each node.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1]<strong> cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1]<strong> traffic-eng level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-isis-1]<strong> quit</strong></pre>
<p># Configure P1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1]<strong> isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-isis-1]<strong> cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-isis-1]<strong> traffic-eng level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-isis-1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1-isis-1]<strong> quit</strong></pre>
<p># Configure P2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P2]<strong> isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-isis-1]<strong> cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-isis-1]<strong> traffic-eng level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-isis-1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P2-isis-1]<strong> quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1]<strong> cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1]<strong> traffic-eng level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-isis-1]<strong> quit</strong></pre>
<p># Configure PE3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3]<strong> isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-isis-1]<strong> cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-isis-1]<strong> traffic-eng level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-isis-1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-isis-1]<strong> quit</strong></pre>
</p></li><li><span>Enable the MPLS TE capability on the interface of each node, and configure link attributes for the interfaces.</span><p><p># Configure PE1.</p>
<pre class="screen">&lt;PE1&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<p># Configure P1.</p>
<pre class="screen">&lt;P1&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1]<strong> interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1-GigabitEthernet<span>0/2/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/2/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/2/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/2/0</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/2/0</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/1/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/1/0</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/1/0</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<p># Configure P2.</p>
<pre class="screen">&lt;P2&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P2]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P2-GigabitEthernet<span>0/1/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/1/0</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/1/0</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2]<strong> interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/2/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/2/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/2/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/2/0</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/2/0</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2]<strong> interface gigabitethernet <span>0/3/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/3/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/3/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/3/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/3/0</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/3/0</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/3/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P2-GigabitEthernet<span>0/3/0</span>] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">&lt;PE2&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<p># Configure PE3.</p>
<pre class="screen">&lt;PE3&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-GigabitEthernet<span>0/1/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/0</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/0</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
</p></li><li><span>Configure explicit paths and a leaf list on the ingress PE1.</span><p><p># Configure explicit paths on PE1 to PE2, and PE3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> explicit-path tope3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-explicit-path-tope3]<strong> next hop 10.1.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-explicit-path-tope3]<strong> next hop 10.2.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-explicit-path-tope3]<strong> next hop 10.5.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-explicit-path-tope3]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-explicit-path-tope3]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> explicit-path tope2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-explicit-path-tope2]<strong> next hop 10.1.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-explicit-path-tope2]<strong> next hop 10.2.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-explicit-path-tope2]<strong> next hop 10.4.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-explicit-path-tope2]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-explicit-path-tope2]<strong> quit</strong></pre>
<p># Configure a leaf list <strong>iptv1</strong> on PE1 and add leaf node addresses to the leaf list.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> mpls te leaf-list iptv1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-te-leaf-list-iptv1]<strong> destination 5.5.5.5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-te-leaf-list-iptv1-destination-5.5.5.5]<strong> path explicit-path tope2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-te-leaf-list-iptv1-destination-5.5.5.5]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-te-leaf-list-iptv1]<strong> destination 6.6.6.6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-te-leaf-list-iptv1-destination-6.6.6.6]<strong> path explicit-path tope3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-te-leaf-list-iptv1-destination-6.6.6.6]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-mpls-te-leaf-list-iptv1-destination-6.6.6.6]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-mpls-te-leaf-list-iptv1]<strong> quit</strong></pre>
</p></li><li><span>Configure the P2MP TE tunnel interface on the ingress PE1.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> interface Tunnel 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel10]<strong> ip address unnumbered interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel10]<strong> tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel10]<strong> mpls te p2mp-mode</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel10]<strong> mpls te tunnel-id 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel10]<strong> mpls te leaf-list iptv1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel10]<strong> mpls te bandwidth ct0 1000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel10]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Tunnel10]<strong> quit</strong></pre>
<p>After completing the configurations, a P2MP TE tunnel is configured.</p>
</p></li><li><span>Enable multicast on the device connected to the multicast source, ingress, and egresses.</span><p><p># Configure SR1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>SR1]<strong> multicast routing-enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SR1]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>SR1-GigabitEthernet<span>0/1/0</span>]<strong> pim sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SR1-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SR1]<strong> interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>SR1-GigabitEthernet<span>0/2/0</span>]<strong> pim sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SR1-GigabitEthernet<span>0/2/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>SR1]<strong> commit</strong></pre>
<p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> multicast routing-enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/0</span>]<strong> pim sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> commit</strong></pre>
<p># Configure PE2. When you configure basic PIM-SM functions on PE2 interfaces, enable IGMP on the PE2 interface connected to multicast data receivers.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> multicast routing-enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>]<strong> pim sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>]<strong> igmp enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
<p># Configure PE3. When you configure basic PIM-SM functions on PE3 interfaces, enable IGMP on the PE3 interface connected to multicast data receivers.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3]<strong> multicast routing-enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3]<strong> interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/2/0</span>]<strong> pim sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/2/0</span>]<strong> igmp enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/2/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3]<strong> commit</strong></pre>
<p>After the preceding operations are complete, the multicast network can operate properly.</p>
</p></li><li><span>Direct multicast traffic into and out of a P2MP TE tunnel.</span><p><ul><li><p>On PE1, direct multicast traffic to the P2MP TE tunnel.</p>
<p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> interface Tunnel10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel10]<strong> pim sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel10]<strong> igmp static-group 226.1.1.1 source 8.8.8.8</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Tunnel10]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Tunnel10]<strong> quit</strong></pre>
</li><li><p>On PE2 and PE3, direct multicast traffic out of the P2MP TE tunnel.</p>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> pim</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-pim]<strong> rpf disable all</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-pim]<strong> traffic select p2mp-te root-ip 1.1.1.1 tunnel-id 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-pim]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-pim]<strong> quit</strong></pre>
<p># Configure PE3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3]<strong> pim</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-pim]<strong> rpf disable all</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-pim]<strong> traffic select p2mp-te root-ip 1.1.1.1 tunnel-id 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-pim]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-pim]<strong> quit</strong></pre>
</li></ul>
</p></li><li><span>Verify the configuration.</span><p><p>Receivers can receive multicast data from the multicast source.</p>
<p># Run the <strong>igmp static-group</strong> command on PE2 to configure an interface to statically join multicast groups.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/2/0</span>] <strong>igmp static-group 226.1.1.1 source 8.8.8.8</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<p># Run the <strong>display pim routing-table</strong> command on PE2 to view source/group information.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>display pim routing-table</strong></pre>
<pre class="screen">VPN-Instance: public net                                                                                                            
Total 0 (*, G) entry; 1 (S, G) entries                                                                                                                                                                                                                           (<strong>8.8.8.8, 226.1.1.1</strong>)                                                                                                                 
RP: NULL                                                                                                                     
Protocol: pim-sm, Flag: SPT SG_RCVR NORPF                                                                                           
UpTime: 00:00:06                                                                                                                    
Upstream interface: Mcast_In_IF, Refresh time: 00:00:06                                                                                                    Upstream neighbor: NULL                                                                                                             
RPF prime neighbor: NULL                                                                                                        
     Downstream interface(s) information:
Total number of downstreams: 1                                                                                                         
1: GigabitEthernet<span>0/2/0</span>                                                                           
    Protocol: static, UpTime: 00:00:06, Expires: - </pre>
<p>The preceding command output shows that receiver can receive multicast data from the multicast source, indicating that multicast has been configured successfully.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172366939__section_dc_vrp_multicast_cfg_220105"><a name="EN-US_TASK_0172366939__section_dc_vrp_multicast_cfg_220105"></a><a name="section_dc_vrp_multicast_cfg_220105"></a><a name="EN-US_TASK_0172366939__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>SR1 configuration file</p>
<pre class="screen">#
sysname SR1
#
multicast routing-enable
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 00.0005.0000.0000.0003.00
 traffic-eng level-2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.7.1.2 255.255.255.0
 pim sm
 isis enable 1
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.8.1.1 255.255.255.0
 pim sm
 isis enable 1
#
interface LoopBack1
 ip address 3.3.3.3 255.255.255.255
 isis enable 1
#
return</pre>
</li><li><p>PE1 configuration file</p>
<pre class="screen">#
sysname PE1
#
multicast routing-enable
#
mpls lsr-id 1.1.1.1
#
mpls
 mpls te
 mpls te p2mp-te
 mpls rsvp-te
 mpls te cspf
#
explicit-path tope3
 next hop 10.1.1.2
 next hop 10.2.1.2
 next hop 10.5.1.2
#
explicit-path tope2
 next hop 10.1.1.2
 next hop 10.2.1.2
 next hop 10.4.1.2
#
mpls te leaf-list iptv1
 #
 destination 5.5.5.5
  path explicit-path tope2
 #
 destination 6.6.6.6
  path explicit-path tope3
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 00.0005.0000.0000.0001.00
 traffic-eng level-2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.1.1.1 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown  
 ip address 10.7.1.1 255.255.255.0
 pim sm
 isis enable 1
#
interface LoopBack1
 ip address 1.1.1.1 255.255.255.255
 isis enable 1
#
interface Tunnel10
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 pim sm
 igmp static-group 226.1.1.1 source 8.8.8.8
 mpls te p2mp-mode
 mpls te bandwidth ct0 1000
 mpls te leaf-list iptv1
 mpls te tunnel-id 100
#
return</pre>
</li><li><p>P1 configuration file</p>
<pre class="screen">#
sysname P1
#
mpls lsr-id 2.2.2.2
#
mpls
 mpls te
 mpls te p2mp-te
 mpls rsvp-te
 mpls te cspf
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 00.0005.0000.0000.0002.00
 traffic-eng level-2
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.2.1.1 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.1.2 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface LoopBack1
 ip address 2.2.2.2 255.255.255.255
 isis enable 1
#
return</pre>
</li><li><p>P2 configuration file</p>
<pre class="screen">#
sysname P2
#
mpls lsr-id 4.4.4.4
#
mpls
 mpls te
 mpls te p2mp-te
 mpls rsvp-te
 mpls te cspf
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 00.0005.0000.0000.0004.00
 traffic-eng level-2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.2.1.2 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.4.1.1 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 ip address 10.5.1.1 255.255.255.0
 isis enable 1  
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface LoopBack1
 ip address 4.4.4.4 255.255.255.255
 isis enable 1
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2
#
multicast routing-enable
#
mpls lsr-id 5.5.5.5
#
mpls
 mpls te
 mpls te p2mp-te
 mpls rsvp-te
 mpls te cspf
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 00.0005.0000.0000.0005.00
 traffic-eng level-2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.4.1.2 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.9.1.1 255.255.255.0
 pim sm
 igmp enable
 igmp static-group 226.1.1.1 source 8.8.8.8
 isis enable 1
#               
interface LoopBack1
 ip address 5.5.5.5 255.255.255.255
 isis enable 1
#
pim
 rpf disable all
 traffic select p2mp-te root-ip 1.1.1.1 tunnel-id 100
#
return</pre>
</li><li><p>PE3 configuration file</p>
<pre class="screen">#
sysname PE3
#
multicast routing-enable
#
mpls lsr-id 6.6.6.6
#
mpls
 mpls te
 mpls te p2mp-te
 mpls rsvp-te
 mpls te cspf
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 00.0005.0000.0000.0006.00
 traffic-eng level-2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.5.1.2 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.10.1.1 255.255.255.0
 pim sm
 igmp enable
 isis enable 1
#
interface LoopBack1
 ip address 6.6.6.6 255.255.255.255
 isis enable 1
#
pim
 rpf disable all
 traffic select p2mp-te root-ip 1.1.1.1 tunnel-id 100
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_0036.html">Configuration Examples for PIM
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2153.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_2295.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>