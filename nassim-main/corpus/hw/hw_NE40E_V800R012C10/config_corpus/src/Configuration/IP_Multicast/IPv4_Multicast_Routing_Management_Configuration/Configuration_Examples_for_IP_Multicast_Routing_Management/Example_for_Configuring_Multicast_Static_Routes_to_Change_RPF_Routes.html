
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Multicast Static Routes to Change RPF Routes">
<meta name="abstract" content="To change the Reverse Path Forwarding (RPF) route and create a multicast path different from the source-to-receiver unicast path, configure multicast static routes on the multicast network.">
<meta name="description" content="To change the Reverse Path Forwarding (RPF) route and create a multicast path different from the source-to-receiver unicast path, configure multicast static routes on the multicast network.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_0093.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_0095.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IP Multicast Routing Management">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IP Multicast Routing Management">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IP Multicast Routing Management">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IP Multicast Routing Management">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172367127">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Multicast Static Routes to Change RPF Routes</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172367127"></a><a name="EN-US_TASK_0172367127"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Multicast Static Routes to Change RPF Routes</h1>
<div class="taskbody"><p>To change the Reverse Path Forwarding (RPF) route and create a multicast path different from the source-to-receiver unicast path, configure multicast static routes on the multicast network.</p>
<div class="context"><a name="EN-US_TASK_0172367127__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0172367127__fig_dc_vrp_multicast_cfg_009401">Figure 1</a>, the network runs PIM-SM, all <span class="keyword">Router</span>s support multicast, and the receiver can receive information from the multicast source. IS-IS is run between <span class="keyword">Router</span>s. Configure a multicast static route to create a multicast path from the source to the receiver different from the unicast path from the source to the receiver.</p>
<div class="fignone" id="EN-US_TASK_0172367127__fig_dc_vrp_multicast_cfg_009401"><a name="EN-US_TASK_0172367127__fig_dc_vrp_multicast_cfg_009401"></a><a name="fig_dc_vrp_multicast_cfg_009401"></a><span class="figcap"><b>Figure 1 </b>Configuring multicast static routes to change RPF routes</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 3 in this example represent GE <span>0/1/0</span>, GE <span>0/2/0</span>, and GE <span>0/3/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_multicast_cfg_009401.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172367127__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>During the configuration, pay attention to the following points:</p>
<ul><li><p>When configuring a multicast static route, if the next hop is a P2P interface, you can specify the outbound interface number. If the next hop is not a P2P interface, you must specify the next-hop address.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172367127__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure an IP address for each <span class="keyword">Router</span> interface and configure IS-IS on <span class="keyword">Router</span>s.</p>
</li><li><p>Enable multicast routing on each <span class="keyword">Router</span>, enable PIM-SM on each interface, and enable IGMP on interfaces connecting <span class="keyword">Router</span>s to hosts.</p>
</li><li><p>Configure Candidate-BootStrap Routers (C-BSRs) and Candidate-Rendezvous Points (C-RPs).</p>
</li><li><p>Configure multicast static routes on <span class="keyword">Device</span> B and specify <span class="keyword">Device</span> C as an RPF neighbor to the source.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172367127__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IP address of the source</p>
</li><li><p>Outbound interface of <span class="keyword">Device</span> B to the source</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172367127__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure an IP address for each <span class="keyword">Router</span> interface and a unicast routing protocol. For configuration details, see Configuration Files in this section.</span></li><li><span>Enable multicast routing on each <span class="keyword">Router</span> and PIM-SM on each <span class="keyword">Router</span> interface.</span><p><p># Configure <span class="keyword">Device</span> A. The configurations of <span class="keyword">Device</span> B, <span class="keyword">Device</span> C, and <span class="keyword">Device</span> D are similar to the configuration of <span class="keyword">Device</span> A. For configuration details, see Configuration Files in this section.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>multicast routing-enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>pim sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>] <strong>pim sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface GigabitEthernet <span>0/3/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/3/0</span>] <strong>pim sm</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/3/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/3/0</span>] <strong>quit</strong></pre>
</p></li><li><span>Enable IGMP on interfaces that connect to hosts.</span><p><p># Enable IGMP on the interface connecting <span class="keyword">Device</span> D to hosts.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D-GigabitEthernet<span>0/2/0</span>] <strong>igmp enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
</p></li><li><span>Configure C-BSRs and C-RPs.</span><p><p># Configure GE <span>0/3/0</span> on <span class="keyword">Device</span> C as both a C-BSR and a C-RP.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>pim</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-pim] <strong>c-bsr GigabitEthernet <span>0/3/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-pim] <strong>c-rp GigabitEthernet <span>0/3/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-pim] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-pim] <strong>quit</strong></pre>
<p># Run the <strong>display multicast rpf-info</strong> command on <span class="keyword">Device</span>B to view the RPF route information of the source. The command output shows that the RPF route is a unicast route and the RPF neighbor is <span class="keyword">Device</span>A.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>B&gt; <strong>display multicast rpf-info 10.5.1.2</strong></pre>
<pre class="screen">VPN-Instance: public net</pre>
<pre class="screen">RPF information about source 10.5.1.2:</pre>
<pre class="screen">     RPF interface: <strong>GigabitEthernet<span>0/1/0</span></strong>, RPF neighbor: <strong>10.4.1.1</strong></pre>
<pre class="screen">     Referenced route/mask: 10.5.1.0/24</pre>
<pre class="screen">     Referenced route type: <strong>unicast</strong></pre>
<pre class="screen">     Route selection rule: preference-preferred</pre>
<pre class="screen">     Load splitting rule: disable</pre>
</p></li><li><span>Configure multicast static routes.</span><p><p># Configure a multicast static route on <span class="keyword">Device</span> B and specify <span class="keyword">Device</span> C as an RPF neighbor to the source.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>B&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ip rpf-route-static 10.5.1.0 255.255.255.0 10.2.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Run the <strong>display multicast rpf-info</strong> command on <span class="keyword">Device</span>B to view the RPF route information of the source. The command output shows that the RPF route and the RPF neighbor have been updated according to the multicast static route. The command output is as follows.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>B&gt; <strong>display multicast rpf-info 10.5.1.2</strong></pre>
<pre class="screen">VPN-Instance: public net</pre>
<pre class="screen">RPF information about source 10.5.1.2:</pre>
<pre class="screen">     RPF interface: <strong>GigabitEthernet<span>0/2/0</span></strong>, RPF neighbor: <strong>10.2.1.2</strong></pre>
<pre class="screen">     Referenced route/mask: 10.5.1.0/24</pre>
<pre class="screen">     Referenced route type: <strong>mstatic</strong></pre>
<pre class="screen">     Route selection rule: preference-preferred</pre>
<pre class="screen">     Load splitting rule: disable </pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172367127__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span> A configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>A
#
multicast routing-enable
#
isis 1
 network-entity 10.0000.0000.0001.00
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.4.1.1 255.255.255.0
 pim sm
 isis enable 1
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.5.1.1 255.255.255.0
 pim sm
 isis enable 1
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 ip address 10.3.1.1 255.255.255.0
 pim sm
 isis enable 1
#
return
</pre>
</li><li><p><span class="keyword">Device</span> B configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>B
#
multicast routing-enable
#
isis 1
 network-entity 10.0000.0000.0002.00
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.4.1.2 255.255.255.0
 pim sm
 isis enable 1
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.2.1.1 255.255.255.0
 pim sm
 isis enable 1
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 ip address 10.1.1.2 255.255.255.0
 pim sm
 isis enable 1
#
ip rpf-route-static 10.5.1.0 255.255.255.0 10.2.1.2
#
return
</pre>
</li><li><p><span class="keyword">Device</span> C configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>C
#
multicast routing-enable
#
isis 1
 network-entity 10.0000.0000.0003.00
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.2.1.2 255.255.255.0
 pim sm
 isis enable 1
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 ip address 10.3.1.2 255.255.255.0
 pim sm
 isis enable 1
#
pim
 c-bsr GigabitEthernet<span>0/3/0</span>
 c-rp GigabitEthernet<span>0/3/0</span>
#
return
</pre>
</li><li><p><span class="keyword">Device</span> D configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>D
#
multicast routing-enable
#
isis 1
 network-entity 10.0000.0000.0004.00
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.6.1.1 255.255.255.0
 pim sm
 igmp enable
 isis enable 1
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 ip address 10.1.1.1 255.255.255.0
 pim sm
 isis enable 1
#
return
</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_0093.html">Configuration Examples for IP Multicast Routing Management
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_multicast_cfg_0095.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>