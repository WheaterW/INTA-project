
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring NG MVPN Extranet">
<meta name="abstract" content="To enable a service provider on a VPN to provide multicast services for users on other VPNs, configure NG MVPN extranet.">
<meta name="description" content="To enable a service provider on a VPN to provide multicast services for users on other VPNs, configure NG MVPN extranet.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0023.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0118.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPv4 Multicast VPN_NG MVPN">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv4 Multicast VPN_NG MVPN">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IPv4 Multicast VPN_NG MVPN">
<meta name="featuretype" content="IP Multicast">
<meta name="OWNER" content="w00447999">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00447999">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001225673372">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring NG MVPN Extranet</title>
</head>
<body><a name="EN-US_TASK_0000001225673372"></a><a name="EN-US_TASK_0000001225673372"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring NG MVPN Extranet</h1>
<div class="taskbody"><p>To enable a service provider on a VPN to provide multicast services for users on other VPNs, configure NG MVPN extranet.</p>
<div class="context"><a name="EN-US_TASK_0000001225673372__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>In real-world NG MVPN application, a service provider may need to provide multicast services to users in a different VPN than its own VPN. This requires inter-VPN multicast distribution. To enable a service provider on a VPN to provide multicast services for users on other VPNs, configure NG MVPN extranet.</p>
<p>NG MVPN extranet can be used in local or remote cross scenarios.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>The address range of multicast groups using the NG MVPN extranet service cannot overlap that of multicast groups using the intra-VPN service.</li><li>Extranet entries of the source and receiver VPNs support only a static RP, and the static RP address must be configured on the source VPN side. The RP on the receiver VPN side must be the same as the RP configured on the source VPN. Otherwise, the same multicast routing entries cannot be created on the receiver VPN and source VPN.</li><li>To provide an SSM service using NG MVPN extranet, the same SSM group address must be configured on the source and receiver VPN sides.</li><li>The MVPN target extended community attribute configured in the VPN instance IPv4 address family MVPN view cannot be the same as the VPN target extended community attribute configured in the VPN instance IPv4 address family view.</li><li>If receivers are on the public network and unicast routes are locally leaked routes, the <a href="cmdqueryname=multicast+extranet+receive-vpn-instance+public+enable"><b><span class="cmdname">multicast extranet receive-vpn-instance public enable</span></b></a> command needs to be run.</li></ul>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001225673372__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring NG MVPN extranet, complete the following tasks:</p>
<ul><li><p>Configure a unicast routing protocol to ensure that IP routes between nodes are reachable.</p>
</li><li><p>Configure BGP/MPLS IP VPN to ensure that the unicast VPN is running properly.</p>
</li><li><p>Configure basic NG MVPN functions and ensure that they are working properly.</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001225673372__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure the same unicast routing policy on the receiver and source PEs so that the receiver VPN can import the routes to the source VPN. For detailed configurations, see <a href="dc_vrp_mpls-l3vpn-v4_cfg_0155.html">Configuring a VPN Instance</a>.</span></li><li><span>Configure a private network RP to serve the NG MVPN extranet. For details about how to configure an RP, see PIM Configuration &gt; Configuring PIM-SM. An RP is required only on a PIM-SM network.</span></li><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Configure a multicast routing policy.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></span><p><p>The VPN instance view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a></span><p><p>The IPv4 address family is enabled for the VPN instance, and the VPN instance IPv4 address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=multicast+routing-enable"><b><span class="cmdname">multicast routing-enable</span></b></a></span><p><p>Multicast routing is enabled for the VPN instance IPv4 address family.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mvpn"><b><span class="cmdname">mvpn</span></b></a></span><p><p>The VPN instance IPv4 address family MVPN view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=multicast+extranet+select-rpf"><b><span class="cmdname">multicast extranet select-rpf</span></b></a> { <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>public</span></strong> } <strong><span>group</span></strong> <i><span class="varname">group-address</span></i> { <i><span class="varname">group-mask</span></i> | <i><span class="varname">group-mask-length</span></i> }</span><p><p>A multicast routing policy is configured, and the upstream interface of the RPF route selected by the PIM entry corresponding to a multicast group address is specified as belonging to another VPN instance or the public network instance.</p>
</p></li><li class="substepexpand"><span>Run <strong><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></strong></span><p><p>Return to the VPN instance IPv4 address family view.</p>
</p></li><li class="substepexpand"><span>Run <strong><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></strong></span><p><p>Return to the VPN instance view.</p>
</p></li><li class="substepexpand"><span>Run <strong><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></strong></span><p><p>Return to the system view.</p>
</p></li></ol>
</li><li><span>(Optional) Run <a href="cmdqueryname=multicast+extranet+traffic-forward+type"><b><span class="cmdname">multicast extranet traffic-forward type</span></b></a> { <strong><span>vlanif</span></strong> | <strong><span>qinq</span></strong><span> | <strong><span>vbdif</span></strong></span> | <strong><strong><span>bas</span></strong></strong><strong> <strong><span>igmp</span></strong></strong> }</span><p><p>The extranet is enabled to forward multicast traffic through a VLANIF outbound interface, QinQ/dot1q VLAN tag termination outbound interface<span>, BAS interface</span>, or VBDIF interface.</p>
</p><p><p>Configure the extranet to forward multicast traffic through a <span>VLANIF outbound interface, QinQ/dot1q VLAN tag termination interface, VBDIF interface</span><span>, or BAS interface</span> if the outbound interface used by NG MVPN extranet is any of the preceding interfaces.</p>
</p><p></p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001225673372__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ul><li>Run the <a href="cmdqueryname=display+pim"><b><span class="cmdname">display pim</span></b></a> <span>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>all-instance</span></strong> ] </span><strong><span>routing-table</span></strong> [ <i><span class="varname">group-address</span></i> [ <strong><span>mask</span></strong> { <i><span class="varname">group-mask-length</span></i> | <i><span class="varname">group-mask</span></i> } ] | <i><span class="varname">source-address</span></i> [ <strong><span>mask</span></strong> { <i><span class="varname">source-mask-length</span></i> | <i><span class="varname">source-mask</span></i> } ] | <strong><span>extranet</span></strong> { <strong><span>source-vpn-instance</span></strong> { <strong><span>all</span></strong> | <strong><span>public</span></strong> | <i><span class="varname">vpn-instance-name</span></i> } | <strong><span>receive-vpn-instance</span></strong> { <strong><span>all</span></strong> | <i><span class="varname">vpn-instance-name</span></i> } } | <strong><span>incoming-interface</span></strong> { <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> | <strong><span>register</span></strong> | <strong><span>mcast-extranet</span></strong> } | <strong><span>outgoing-interface</span></strong> { <strong><span>include</span></strong> | <strong><span>exclude</span></strong> | <strong><span>match</span></strong> } { <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> | <span><strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i></span> | <strong><span>register</span></strong> | <strong><span>none</span></strong> } | <strong><span>mode</span></strong> { <strong><span>ssm</span></strong> | <strong><span>sm</span></strong> } | <strong><span>flags</span></strong> <i><span class="varname">flag-value</span></i> | <strong><span>fsm</span></strong> ] <sup>*</sup> [ <strong><span>outgoing-interface-number</span></strong> [ <i><span class="varname">number</span></i> ] ] command to check information about the PIM routing table.</li><li>Run the <a href="cmdqueryname=display+multicast"><b><span class="cmdname">display multicast</span></b></a> <span>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>all-instance</span></strong> ] </span><strong><span>routing-table</span></strong> [ <i><span class="varname">group-address</span></i> [ <strong><span>mask</span></strong> { <i><span class="varname">group-mask</span></i> | <i><span class="varname">group-mask-length</span></i> } ] | <i><span class="varname">source-address</span></i> [ <strong><span>mask</span></strong> { <i><span class="varname">source-mask</span></i> | <i><span class="varname">source-mask-length</span></i> } ] | <strong><span>extranet</span></strong> { <strong><span>source-vpn-instance</span></strong> { <strong><span>all</span></strong> | <strong><span>public</span></strong> | <i><span class="varname">vpn-instance-name</span></i> } | <strong><span>receive-vpn-instance</span></strong> { <strong><span>all</span></strong> | <i><span class="varname">vpn-instance-name</span></i> } } | <strong><span>incoming-interface</span></strong> { <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> | <strong><span>register</span></strong> | <strong><span>mcast-extranet</span></strong> } | <strong><span>outgoing-interface</span></strong> { <strong><span>include</span></strong> | <strong><span>exclude</span></strong> | <strong><span>match</span></strong> } { <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> | <span><strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> </span>| <strong><span>register</span></strong> | <strong><span>none</span></strong> } ] <sup>*</sup> [ <strong><span>outgoing-interface-number</span></strong> [ <i><span class="varname">number</span></i> ] ] command to check information about the multicast routing table.</li><li>Run the <a href="cmdqueryname=display+multicast"><b><span class="cmdname">display multicast</span></b></a> <span>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>all-instance</span></strong> ] </span><strong><span>rpf-info</span></strong> <i><span class="varname">source-address</span></i> [ <i><span class="varname">group-address</span></i> ] [ <strong><span>rpt</span></strong> | <strong><span>spt</span></strong> ] command to check information about source-specific or group-and-source-specific RPF routes.</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0000.html">NG MVPN Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0023.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_ngmvpn_0118.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>