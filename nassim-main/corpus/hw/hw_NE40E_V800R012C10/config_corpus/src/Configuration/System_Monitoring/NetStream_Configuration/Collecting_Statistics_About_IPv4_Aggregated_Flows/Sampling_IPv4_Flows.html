
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Sampling IPv4 Flows">
<meta name="abstract" content="You can enable NetStream to sample and analyze the incoming or outgoing flows on an interface.">
<meta name="description" content="You can enable NetStream to sample and analyze the incoming or outgoing flows on an interface.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0010.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_3026_1.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0014.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,netstream_vrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="NetStream">
<meta name="featuretype" content="System Monitor">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NetStream">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="NetStream">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="Netstream">
<meta name="featuretype" content="System Monitor">
<meta name="OWNER" content="l00799643">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00799643">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172372962">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Sampling IPv4 Flows</title>
</head>
<body><a name="EN-US_TASK_0172372962"></a><a name="EN-US_TASK_0172372962"></a>

<div class="articleBoxWithoutHead">






<h1 class="topicTitle-h1">Sampling IPv4 Flows</h1>
<div class="taskbody"><p>You can enable NetStream to sample and analyze the incoming or outgoing flows on an interface.</p>
<div class="context"><a name="EN-US_TASK_0172372962__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p" id="EN-US_TASK_0172372962__en-us_task_0172372952_context616656079214103"><div class="note" id="EN-US_TASK_0172372962__en-us_task_0172372952_note382639331214103"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172372962__en-us_task_0172372952_p1453196999214103">If a NetStream-enabled interface is bound to a VPN instance, all packets in the VPN instance are sampled.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172372962__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0172372962__en-us_task_0172372952_steps1379222185214103"><li id="EN-US_TASK_0172372962__en-us_task_0172372952_step1230260820214103"><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmd1021048424214103">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdname601350779214103">system-view</span></b></a></span><p><p id="EN-US_TASK_0172372962__en-us_task_0172372952_p1677417163713">The system view is displayed.</p>
</p></li><li id="EN-US_TASK_0172372962__en-us_task_0172372952_step259027324214103"><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmd522881999214103">Configure a sampling mode and sampling ratio by performing at least one of the following steps:</span><p><ul id="EN-US_TASK_0172372962__en-us_task_0172372952_ul1764687983214103"><li id="EN-US_TASK_0172372962__en-us_task_0172372952_li100170129214103">Configure a sampling mode and sampling ratio globally.<ol type="a" id="EN-US_TASK_0172372962__en-us_task_0172372952_ol443832542214103"><li id="EN-US_TASK_0172372962__en-us_task_0172372952_li13198152915817"><p id="EN-US_TASK_0172372962__en-us_task_0172372952_p51691923814"><a name="EN-US_TASK_0172372962__en-us_task_0172372952_li13198152915817"></a><a name="en-us_task_0172372952_li13198152915817"></a>Run <a href="cmdqueryname=ip+netstream+sampler"><b><span class="cmdname" id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdname1620193917214155">ip netstream sampler</span></b></a> <span>{ <strong><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdparmname498412471214155">fix-packets</span></strong> <i><span class="varname" id="EN-US_TASK_0172372962__en-us_task_0172372952_varname1580499978214155">packet-interval</span></i> | <strong><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdparmname227489229214155">random-packets</span></strong> <i><span class="varname" id="EN-US_TASK_0172372962__en-us_task_0172372952_varname374617133214155">packet-interval</span></i> | <strong><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdparmname1031317456214155">fix-time</span></strong> <i><span class="varname" id="EN-US_TASK_0172372962__en-us_task_0172372952_varname1344844462214155">time-interval</span></i> }</span> { <strong><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdparmname1960266413214155">inbound</span></strong> | <strong><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdparmname1251912251214155">outbound</span></strong> }</p>
<p id="EN-US_TASK_0172372962__en-us_task_0172372952_p982591415371">A global sampling mode and sampling ratio are configured.</p>
</li><li id="EN-US_TASK_0172372962__en-us_task_0172372952_li1664889322214103">Run <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdname1973657052214103">interface</span></b></a> <i><span class="varname" id="EN-US_TASK_0172372962__en-us_task_0172372952_varname1458054312214103">interface-type</span></i> <i><span class="varname" id="EN-US_TASK_0172372962__en-us_task_0172372952_varname422232870214103">interface-number</span></i><p id="EN-US_TASK_0172372962__en-us_task_0172372952_p206607319395">The interface view is displayed.</p>
</li></ol>
</li><li id="EN-US_TASK_0172372962__en-us_task_0172372952_li1491452267214103">Configure a sampling mode and sampling ratio on an interface.<ol type="a" id="EN-US_TASK_0172372962__en-us_task_0172372952_ol692114679214103"><li id="EN-US_TASK_0172372962__en-us_task_0172372952_li36673673214103">Run <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdname1781350046214103">interface</span></b></a> <i><span class="varname" id="EN-US_TASK_0172372962__en-us_task_0172372952_varname966297333214103">interface-type</span></i> <i><span class="varname" id="EN-US_TASK_0172372962__en-us_task_0172372952_varname1369377980214103">interface-number</span></i><p id="EN-US_TASK_0172372962__en-us_task_0172372952_p18650262394">The interface view is displayed.</p>
</li><li id="EN-US_TASK_0172372962__en-us_task_0172372952_li2453144165815"><p id="EN-US_TASK_0172372962__en-us_task_0172372952_p216920963818"><a name="EN-US_TASK_0172372962__en-us_task_0172372952_li2453144165815"></a><a name="en-us_task_0172372952_li2453144165815"></a>Run <a href="cmdqueryname=ip+netstream+sampler"><b><span class="cmdname" id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdname845174111586">ip netstream sampler</span></b></a> <span>{ <strong><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdparmname1045154119581">fix-packets</span></strong> <i><span class="varname" id="EN-US_TASK_0172372962__en-us_task_0172372952_varname17451194111583">packet-interval</span></i> | <strong><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdparmname194517416584">random-packets</span></strong> <i><span class="varname" id="EN-US_TASK_0172372962__en-us_task_0172372952_varname18451114110582">packet-interval</span></i> | <strong><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdparmname144517414580">fix-time</span></strong> <i><span class="varname" id="EN-US_TASK_0172372962__en-us_task_0172372952_varname15451154111587">time-interval</span></i> }</span> { <strong><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdparmname20451124175811">inbound</span></strong> | <strong><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdparmname5451154185813">outbound</span></strong> }</p>
<p id="EN-US_TASK_0172372962__en-us_task_0172372952_p146549337378">A sampling mode and sampling ratio are configured on the interface.</p>
<div class="note" id="EN-US_TASK_0172372962__en-us_task_0172372952_note229983289214103"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172372962__en-us_task_0172372952_p142961610171514">The sampling mode and sampling ratio configured in the system view are applicable to all interfaces on the device. The sampling mode and sampling ratio configured in the interface view take precedence over those configured in the system view.</p>
</div></div>
</li></ol>
</li></ul>
</p></li><li id="EN-US_TASK_0172372962__en-us_task_0172372952_step498085218214103"><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmd427002920214103">Run <a href="cmdqueryname=ip+netstream"><b><span class="cmdname" id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdname73871827112412">ip netstream</span></b></a> { <strong><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdparmname1981952723214103">inbound</span></strong> | <strong><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdparmname1799029604214103">outbound</span></strong> }</span><p><p id="EN-US_TASK_0172372962__en-us_task_0172372952_p14839127154617">NetStream is enabled on the interface.</p>
<p id="EN-US_TASK_0172372962__en-us_task_0172372952_p1293994504614">Statistics about packets' BGP next-hop information can also be collected. Original flows output in V5 format, however, cannot carry the BGP next-hop information.</p>
</p></li><li id="EN-US_TASK_0172372962__en-us_task_0172372952_step1022133444416"><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmd1022112344443">(Optional) Run <a href="cmdqueryname=ip+netstream+statistics+enable"><b><span class="cmdname" id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdname11750928105017">ip netstream statistics enable</span></b></a></span><p><p id="EN-US_TASK_0172372962__en-us_task_0172372952_p153504273202">The traffic statistics diagnosis function is enabled so that you can compare the traffic statistics collected by the device with those restored by the NMS to determine the cause of inaccurate sampling.</p>
</p></li><li id="EN-US_TASK_0172372962__en-us_task_0172372952_step2127863571214103"><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmd957864306214103">(Optional) Run <a href="cmdqueryname=ip+netstream+sampler+except+deny-action"><b><span class="cmdname" id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdname327553450214103">ip netstream sampler except deny-action</span></b></a></span><p><p id="EN-US_TASK_0172372962__en-us_task_0172372952_p101929164818">NetStream is not applied to traffic matching the ACL rule or traffic behavior that contains <strong id="EN-US_TASK_0172372962__en-us_task_0172372952_b1892210814567">deny</strong>.</p>
</p><p><div class="note" id="EN-US_TASK_0172372962__en-us_task_0172372952_note1420184838214103"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172372962__en-us_task_0172372952_p1913319508214103">The traffic behavior view must be entered before you run this command.</p>
</div></div>
</p></li><li id="EN-US_TASK_0172372962__en-us_task_0172372952_step1623302396214103"><span id="EN-US_TASK_0172372962__en-us_task_0172372952_cmd1211118084214103">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172372962__en-us_task_0172372952_cmdname2039141845214103">commit</span></b></a></span><p><p id="EN-US_TASK_0172372962__en-us_task_0172372952_p166191648184810">The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0010.html">Collecting Statistics About IPv4 Aggregated Flows
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_3026_1.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0014.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>