
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Creating a Subscription">
<meta name="abstract" content="When configuring static telemetry subscription to the sampled data, you need to create a subscription to associate the configured destination group with the configured sampling sensor group so that data can be sent to the collector.">
<meta name="description" content="When configuring static telemetry subscription to the sampled data, you need to create a subscription to associate the configured destination group with the configured sampling sensor group so that data can be sent to the collector.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_telemetry_cfg_00190.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_telemetry_cfg_00192.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Telemetry">
<meta name="featuretype" content="System Monitor">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Telemetry">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="Telemetry">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="Telemetry">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="Telemetry">
<meta name="featuretype" content="System Monitor">
<meta name="OWNER" content="c00511010">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00799643">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001596589633">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Creating a Subscription</title>
</head>
<body><a name="EN-US_TASK_0000001596589633"></a><a name="EN-US_TASK_0000001596589633"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Creating a Subscription</h1>
<div class="taskbody"><p>When configuring static telemetry subscription to the sampled data, you need to create a subscription to associate the configured destination group with the configured sampling sensor group so that data can be sent to the collector.</p>
<div class="context"><a name="EN-US_TASK_0000001596589633__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>A device functions as a client, and a collector functions as a server. To statically subscribe to the sampled data, you need to create a subscription to set up a data sending channel. The protocol used to send data can be gRPC or UDP. The following uses UDP as an example.</p>
<p>Before configuring an SSL policy on the client to establish a secure SSL connection between the client and server, ensure that the SSL policy has been created. For details about how to create an SSL policy, see <span>"Configuring and Binding an SSL Policy" in <i><cite><span class="keyword">HUAWEI NE40E-M2 series</span> Product Documentation</cite></i></span> &gt; Configuration &gt; Basic Configuration &gt; Accessing Other Devices Configuration.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001596589633__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=telemetry"><b><span class="cmdname">telemetry</span></b></a> [ <strong><span>openconfig</span></strong> ]</span><p><p>The telemetry view is displayed.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=protocol+udp+message-header+ietf-netconf-udp-notif"><b><span class="cmdname">protocol udp message-header ietf-netconf-udp-notif</span></b></a></span><p><p>The UDP header in the draft-ietf-netconf-udp-notif-08 format is used.</p>
</p></li><li><span>Run <a href="cmdqueryname=subscription"><b><span class="cmdname">subscription</span></b></a> <i><span class="varname">subscription-name</span></i></span><p><p>A subscription is created to associate a destination group with a sampling sensor group, and the subscription view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=sensor-group"><b><span class="cmdname">sensor-group</span></b></a> <i><span class="varname">sensor-name</span></i> [ <strong><span>sample-interval</span></strong> <i><span class="varname">sample-interval</span></i> { [ <strong><span>suppress-redundant</span></strong> ] | [ <strong><span>heartbeat-interval</span></strong> <i><span class="varname">heartbeat-interval</span></i> ] } <sup>*</sup> ]</span><p><p>A sampling sensor group is associated with the subscription, and a sampling interval, a heartbeat interval, and redundancy suppression are configured for the sampling sensor group.</p>
</p></li><li><span>Run <a href="cmdqueryname=destination-group"><b><span class="cmdname">destination-group</span></b></a> <i><span class="varname">destination-name</span></i></span><p><p>A destination group is associated with the subscription.</p>
</p></li><li><span>(Optional) Run the following commands to configure telemetry adaptive sampling:</span><ol type="a"><li><span>Run the <a href="cmdqueryname=sensor-group"><b><span class="cmdname">sensor-group</span></b></a> <i><span class="varname">sensor-group-name</span></i> <a href="cmdqueryname=sample-adaptive"><b><span class="cmdname">sample-adaptive</span></b></a> command to configure a sampling sensor group that requires adaptive sampling, and enter the sample-adaptive view.</span></li><li><span>Run the <a href="cmdqueryname=sample-interval"><b><span class="cmdname">sample-interval</span></b></a> <i><span class="varname">interval</span></i> <strong><span>op-field</span></strong> <i><span class="varname">field</span></i> <strong><span>op-type</span></strong> { <strong><span>eq</span></strong> | <strong><span>gt</span></strong> | <strong><span>ge</span></strong> | <strong><span>lt</span></strong> | <strong><span>le</span></strong> } <strong><span>op-value</span></strong> <i><span class="varname">value</span></i> command to configure an interval and conditions for adaptive sampling</span></li><li><span>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the subscription view.</span></li></ol>
<p><p>Generally, a small sampling interval is set for an analyzer to obtain more accurate data for analysis. However, a large amount of redundant data is generated when a small sampling interval is used. The data requires a large amount of storage space and is inconvenient for data management. If adaptive sampling is configured, telemetry dynamically adjusts the sampling interval based on preset conditions. When the monitoring indicators are normal, telemetry reduces the sampling interval. When the monitoring indicators reach the threshold, telemetry automatically adjusts the sampling interval based on the configuration to report collected data at a higher frequency, reducing the amount of data on the analyzer.</p>
</p></li><li><span>Run <a href="cmdqueryname=protocol"><b><span class="cmdname">protocol</span></b></a> <strong><span>udp</span></strong></span><p><p>A protocol and encryption mode are configured for sending data to the destination collector that is associated with this subscription.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p">Both this command and the <a href="cmdqueryname=ipv4-address+port"><b><span class="cmdname">ipv4-address port</span></b></a>/<a href="cmdqueryname=ipv6-address+port"><b><span class="cmdname">ipv6-address port</span></b></a> command in the destination group view can configure a protocol and encryption mode for sending data to the destination collector. If the destination collector is associated with the subscription, command configurations take effect based on the following rules:<ul><li><p>If this command has been run, the protocol and encryption mode configured using this command in the subscription view take effect.</p>
</li><li><p>If this command is not run, the protocol and encryption mode configured using the <a href="cmdqueryname=ipv4-address+port"><b><span class="cmdname">ipv4-address port</span></b></a>/<a href="cmdqueryname=ipv6-address+port"><b><span class="cmdname">ipv6-address port</span></b></a> command in the destination group view take effect.</p>
</li></ul>
</div>
</div></div>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=dampening-interval"><b><span class="cmdname">dampening-interval</span></b></a> <i><span class="varname">interval</span></i></span><p><p>A dampening interval is configured for the subscription.</p>
</p><p></p></li><li><span>(Optional) Run <a href="cmdqueryname=resync-interval"><b><span class="cmdname">resync-interval</span></b></a> <i><span class="varname">interval</span></i></span><p><p>A full data reporting interval is configured.</p>
</p><p><p>By default, no full data reporting interval is configured.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The dampening interval and full data reporting interval apply only to sampling of the OnChange+ type. If a non-zero sampling interval is configured using the <a href="cmdqueryname=sample-interval"><b><span class="cmdname">sample-interval</span></b></a> command, the dampening interval and full data reporting interval cannot be configured.</p>
</div></div>
</p></li><li><span>(Optional) Based on the collector type, run either of the following commands to configure a source IP address for UDP-based data sending:</span><p><ul><li>For an IPv4 collector, run the <a href="cmdqueryname=local-source-address+ipv4"><b><span class="cmdname">local-source-address ipv4</span></b></a> <i><span class="varname">ipv4-address</span></i> [ <a href="cmdqueryname=port"><b><span class="cmdname">port</span></b></a> <i><span class="varname">port-value</span></i> ] command.</li><li>For an IPv6 collector, run the <a href="cmdqueryname=local-source-address+ipv6"><b><span class="cmdname">local-source-address ipv6</span></b></a> <i><span class="varname">ipv6-address</span></i> [ <a href="cmdqueryname=port"><b><span class="cmdname">port</span></b></a> <i><span class="varname">port-value6</span></i> ] command.</li></ul>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=local-source-interface"><b><span class="cmdname">local-source-interface</span></b></a> { <i><span class="varname">if-name</span></i> | <i><span class="varname">if-type</span></i> <i><span class="varname">if-number</span></i> } [ <a href="cmdqueryname=port"><b><span class="cmdname">port</span></b></a> <i><span class="varname">port-value</span></i></span><p><p>A source interface and source port are configured for UDP-based data sending.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In the same subscription view, either the source interface or the source IP address can be configured for the packets to be sent.</p>
</div></div>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=dscp"><b><span class="cmdname">dscp</span></b></a> <i><span class="varname">value</span></i></span><p><p>A DSCP value is set for data packets to be sent.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=encoding"><b><span class="cmdname">encoding</span></b></a> { <strong><span>json</span></strong> | <strong><span>gpb</span></strong> }</span><p><p>An encoding format is configured for data packets to be sent.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=anchor-time"><b><span class="cmdname">anchor-time</span></b></a> <i><span class="varname">anchortime-value</span></i></span><p><p>The anchor time for periodically sampling data packets to be sent is configured.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the telemetry view.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=cpu-usage+max-percent"><b><span class="cmdname">cpu-usage max-percent</span></b></a> <i><span class="varname">usage</span></i></span><p><p>A maximum usage is configured for the amount of CPU resources the main control board occupies when telemetry collects data.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command is supported only by the admin VS.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_telemetry_cfg_00190.html">Configuring UDP-based Static Telemetry Subscription
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_telemetry_cfg_00192.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>