
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Outputting Aggregation Flow Packets">
<meta name="abstract" content="To ensure that aggregation flow packets are correctly output to the NMS, specify the aging time, output format, and source and destination addresses for aggregation flows.">
<meta name="description" content="To ensure that aggregation flow packets are correctly output to the NMS, specify the aging time, output format, and source and destination addresses for aggregation flows.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0010.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0011.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0045.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="NetStream">
<meta name="featuretype" content="System Monitor">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NetStream">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="NetStream">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="Netstream">
<meta name="featuretype" content="System Monitor">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00799643">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172372960">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Outputting Aggregation Flow Packets</title>
</head>
<body><a name="EN-US_TASK_0172372960"></a><a name="EN-US_TASK_0172372960"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Outputting Aggregation Flow Packets</h1>
<div class="taskbody"><p>To ensure that aggregation flow packets are correctly output to the NMS, specify the aging time, output format, and source and destination addresses for aggregation flows.</p>
<div class="steps"><a name="EN-US_TASK_0172372960__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=ip+netstream+export+host"><b><span class="cmdname">ip netstream export host</span></b></a> [ <strong><span>ipv6</span></strong> ] <em>ip-address</em> <i><span class="varname">port</span></i><span> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ]</span><span> [ <strong><span>dscp</span></strong> <i><span class="varname">dscp-value</span></i> ]</span></span><p><p>A destination IP address and a UDP port number are configured for outputting statistics.</p>
</p><p><p>If the destination IP addresses are specified in both the system and the aggregation views, the configuration in the aggregation view takes effect.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=ip+netstream+aggregation"><b><span class="cmdname">ip netstream aggregation</span></b></a></span> { <strong><span>as</span></strong> | <strong><span>as-tos</span></strong> | <strong><span>bgp-nexthop-tos</span></strong> | <strong><span>destination-prefix</span></strong> | <strong><span>destination-prefix-tos</span></strong> | <strong><span>index-tos</span></strong> | <strong><span>mpls-label</span></strong> | <strong><span>prefix</span></strong> | <strong><span>prefix-tos</span></strong> | <strong><span>protocol-port</span></strong> | <strong><span>protocol-port-tos</span></strong> | <strong><span>source-prefix</span></strong> | <strong><span>source-prefix-tos</span></strong><span> | <strong><span>source-index-tos</span></strong> | <strong><span>vlan-id</span></strong></span><span> | <strong><span>bgp-community</span></strong></span><span> <span></span>| <strong><span>vni-sip-dip</span></strong> </span>}</span><p><p>The IPv4 aggregation configuration mode view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=enable"><b><span class="cmdname">enable</span></b></a></span><p><p>The NetStream aggregation mode is enabled.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=export+version"><b><span class="cmdname">export version</span></b></a> { <strong><span>8</span></strong> | <strong><span>9</span></strong> | <strong><span>ipfix</span></strong> }</span><p><p>The format for outputting aggregation flow packets is set.</p>
</p><p><p>Flows aggregated in <strong><span>as</span></strong>, <strong><span>as-tos</span></strong>, <strong><span>destination-prefix</span></strong>, <strong><span>destination-prefix-tos</span></strong>, <strong><span>prefix</span></strong>, <strong><span>prefix-tos</span></strong>, <strong><span>protocol-port</span></strong>, <strong><span>protocol-port-tos</span></strong>, <strong><span>source-prefix</span></strong>, or <strong><span>source-prefix-tos</span></strong> mode are output in the V8 format by default. You can specify the output format for aggregation flows as needed.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>For the <span><strong><span>vlan-id</span></strong>, </span><strong><span>bgp-nhp-tos</span></strong><span>, <strong><span>vni-sip-dip</span></strong>,</span> and <strong><span>index-tos</span></strong> aggregation modes, aggregation flows are output in the V9 format by default. You can change the format to IPFIX using the <a href="cmdqueryname=export+version"><b><span class="cmdname">export version</span></b></a> command.</p>
</div></div>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=template+timeout-rate"><b><span class="cmdname">template timeout-rate</span></b></a> <i><span class="varname">timeout-interval</span></i></span><p><p>The interval at which the template for outputting aggregation flows in the V9 or IPFIX format is refreshed is set.</p>
</p></li><li><span>Run <a href="cmdqueryname=ip+netstream+export+source"><b><span class="cmdname">ip netstream export source</span></b></a> { <i><span class="varname">ip-address</span></i> | <strong><span>ipv6</span></strong> <i><span class="varname">ipv6-address</span></i> }<span> [ <i><span class="varname">port</span></i> ]</span></span><p><p>The source IP address<span> and source port</span> are specified for aggregation flows.</p>
<p>The source IP address<span> and source port</span> specified in the aggregation view take precedence over that specified in the system view. If no source IP address<span> or source port</span> is specified in the aggregation view, the source IP address<span> and source port</span> specified in the system view take effect.</p>
</p></li><li><span>Run <a href="cmdqueryname=ip+netstream+export+host"><b><span class="cmdname">ip netstream export host</span></b></a> [ <strong><span>ipv6</span></strong> ] <em>ip-address</em> <i><span class="varname">port</span></i><span> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ]</span><span> [ <strong><span>dscp</span></strong> <i><span class="varname">dscp-value</span></i> ]</span></span><p><p>A destination IP address and a UDP port number are configured for outputting statistics.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>The destination IP address configured in the system view takes precedence over that configured in the aggregation view.</li><li>NetStream packets are output to the NSC through the service interface instead of the management interface.</li></ul>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li><span>(Optional) Configure NetStream packets to carry the flow sequence field.</span><p><ol type="a"><li>Run the <a href="cmdqueryname=slot"><b><span class="cmdname">slot</span></b></a><i><span class="varname"> slot-id</span></i> command to enter the view of the slot in which the interface board for NetStream sampling resides.</li><li><div class="p">Run the <a href="cmdqueryname=ip+netstream+export+sequence-mode+flow"><b><span class="cmdname">ip netstream export sequence-mode flow</span></b></a> command to configure NetStream packets to carry the flow sequence field.<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The command applies to the V9 format only.</p>
</div></div>
</div>
</li><li>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</li></ol>
</p></li><li><span>(Optional) Set parameters for aging aggregation flows as required:</span><p><ul><li><p>Run the <a href="cmdqueryname=ip+netstream+aggregation+timeout"><b><span class="cmdname">ip netstream aggregation timeout </span></b></a><strong><span>active</span></strong> { <i><span class="varname">active-interval</span></i><span> | <strong><span>interval-second</span></strong> <i><span class="varname">active-interval-second</span></i> }</span> command to set the active aging time for NetStream aggregation flows.</p>
</li><li><p>Run the <a href="cmdqueryname=ip+netstream+aggregation+timeout"><b><span class="cmdname">ip netstream aggregation timeout</span></b></a> <strong><span>inactive</span></strong> <i><span class="varname">inactive-interval</span></i> command to set the inactive aging time for NetStream aggregation flows.</p>
</li></ul>
</p></li><li><span>(Optional) Exit the IPv4 aggregated configuration mode view. In the system view, run <a href="cmdqueryname=ip+netstream+export+template+sequence-number+fixed"><b><span class="cmdname">ip netstream export template sequence-number fixed</span></b></a></span><p><p>The sequence numbers of template packets and option template packets in IPFIX format are configured to remain unchanged, but data packets and option data packets in IPFIX format are still consecutively numbered.</p>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0010.html">Collecting Statistics About IPv4 Aggregated Flows
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0011.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ns_cfg_0045.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>