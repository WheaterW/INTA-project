
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Using Tracert to Check a Path on an IPv4 or IPv6 Network">
<meta name="abstract" content="A tracert operation is used to check network connectivity and locate network faults.">
<meta name="description" content="A tracert operation is used to check network connectivity and locate network faults.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ping_cfg_0002.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ping_cfg_0088.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,network-monitor_vrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Ping/Tracert">
<meta name="featuretype" content="System Monitor">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Ping/Tracert">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="Ping/Tracert">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="Ping/Tracert">
<meta name="featuretype" content="System Monitor">
<meta name="OWNER" content="c00511010">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00799643">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172373166">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Using Tracert to Check a Path on an IPv4 or IPv6 Network</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172373166"></a><a name="EN-US_TASK_0172373166"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Using Tracert to Check a Path on an IPv4 or IPv6 Network</h1>
<div class="taskbody"><p>A tracert operation is used to check network connectivity and locate network faults.</p>
<div class="context"><a name="EN-US_TASK_0172373166__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>The <a href="cmdqueryname=tracert"><b><span class="cmdname">tracert</span></b></a><span> and <a href="cmdqueryname=tracert+ipv6"><b><span class="cmdname">tracert ipv6</span></b></a></span> commands are used to trace the gateways through which a packet passes from the source to the destination. The maximum TTL value that can be set for packets using the <a href="cmdqueryname=tracert"><b><span class="cmdname">tracert</span></b></a><span> or <a href="cmdqueryname=tracert+ipv6"><b><span class="cmdname">tracert ipv6</span></b></a></span> command is 255. Each time the source does not receive a reply after the configured period of time elapses, it displays timeout information and sends another packet with the TTL value incremented by 1. If timeout information is still displayed when the TTL value is 255, the source considers that the destination is unreachable and the test fails.</p>
<p>To prevent malicious users from forging ICMP Port Unreachable or Time Exceeded messages in order to detect the IPv4<span> or IPv6</span> addresses of device interfaces, you can specify the source IPv4<span> or IPv6</span> address of Port Unreachable or Time Exceeded messages in the loopback interface view. If the <a href="cmdqueryname=tracert"><b><span class="cmdname">tracert</span></b></a><span> or <a href="cmdqueryname=tracert+ipv6"><b><span class="cmdname">tracert ipv6</span></b></a></span> command is run to detect a remote address, the device uses the address of the loopback interface as the source address of Port Unreachable or Time Exceeded messages.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The command format is for reference only. For details about the formats of the <a href="cmdqueryname=tracert"><b><span class="cmdname">tracert</span></b></a> or <a href="cmdqueryname=tracert+ipv6"><b><span class="cmdname">tracert ipv6</span></b></a> commands, see <em>Command Reference</em>.</p>
</div></div>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172373166__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>On an IPv4 network:</span><p><ol><li><p>(Optional) Configure the address of a loopback interface as the source IP address of ICMP Port Unreachable or Time Exceeded messages.</p>
<ol type="a"><li><p>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></p>
<p>The system view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=interface+loopback"><b><span class="cmdname">interface loopback</span></b></a> <i><span class="varname">loopback-number</span></i></p>
<p>A loopback interface is created, and its view is displayed.</p>
</li><li><p>(Optional) Run <a href="cmdqueryname=ip+binding+vpn-instance"><b><span class="cmdname">ip binding vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></p>
<p>The interface is bound to a VPN instance.</p>
</li><li><p>Run <a href="cmdqueryname=ip+icmp"><b><span class="cmdname">ip icmp</span></b></a> { <strong><span>ttl-exceeded</span></strong> | <strong><span>port-unreachable</span></strong> } <strong><span>source-address</span></strong></p>
<p>The address of the loopback interface is configured as the source IP address of ICMP Port Unreachable or Time Exceeded messages.</p>
</li><li><p>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></p>
<p>The configuration is committed.</p>
</li></ol>
</li><li><p>Run <a href="cmdqueryname=tracert"><b><span class="cmdname">tracert</span></b></a> <span>[ <strong><span>-a</span></strong> <i><span class="varname">source-ip-address</span></i> | <strong><span>-f</span></strong> <i><span class="varname">initTtl</span></i> | <strong><span>-m</span></strong> <i><span class="varname">maxTtl</span></i> | <strong><span>-p</span></strong> <i><span class="varname">destPort</span></i> | <strong><span>-q</span></strong> <i><span class="varname">nqueries</span></i> <span>| { <strong><span>-vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i></span> [ <strong><span>peer</span></strong> <i><span class="varname">peerIpv6</span></i> ] <span><span>| <strong><span>-as</span></strong> }</span></span> | <strong><span>-w</span></strong> <i><span class="varname">timeout</span></i> <span>| <strong><span>-v</span></strong> </span><span>| <strong><span>-s</span></strong> <i><span class="varname">size</span></i> </span><span>|<span><span> { { <strong><span>-i</span></strong> { <i><span class="varname">interface-name</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span></span><span><span> }</span></span> | <strong><span>-nexthop</span></strong> <i><span class="varname">nexthop-address</span></i> | <strong><span>-passroute</span></strong></span> | <strong><span>-service-class</span></strong><strong> </strong><i><span class="varname">classValue</span></i> | <strong><span>-pipe</span></strong> } <sup>*</sup> | <strong><span>-si</span></strong> { <i><span class="varname">source-interface-name</span></i> | <i><span class="varname">source-interface-type</span></i><em> </em><i><span class="varname">source-interface-number</span></i> } }<span> | <strong><span>-te-class</span></strong> <i><span class="varname">teClassValue</span></i></span><span><span><span><span><span><span><span></span></span></span></span></span> | <span><span><strong><span>-name</span></strong></span></span> | { <strong><span>-tos</span></strong> <i><span class="varname">tos-value</span></i> | <strong><span>-dscp</span></strong> <i><span class="varname">dscp</span></i> }</span></span> ] <sup>*</sup> <i><span class="varname">host</span></i></span></p>
<p>The fault is located.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the <strong><span>-as</span></strong> keyword is configured, the AS number of each hop is obtained by querying the local routing table based on the destination address. The AS number is displayed only when the corresponding routing entry is learned through BGP and the BGP route carries the AS number.</p>
</div></div>
<p>The following example uses the <a href="cmdqueryname=tracert"><b><span class="cmdname">tracert</span></b></a> command to analyze the network.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> tracert -m 10 10.1.1.1</strong></pre>
<pre class="screen">traceroute to 10.1.1.1 (10.1.1.1), max hops: 10 ,packet length: 40,press CTRL_C to break
1  172.16.112.1   19 ms   19 ms   1 ms
2  172.16.216.1   39 ms   39 ms   19 ms
3  172.16.136.23   39 ms   40 ms   39 ms
4  172.16.168.22   39 ms   39 ms   39 ms
5  172.16.197.4   40 ms   59 ms   59 ms
6  172.16.221.5   59 ms   59 ms   59 ms
7  172.31.70.13   99 ms   99 ms   80 ms
8  172.31.71.6   139 ms   239 ms   319 ms
9  172.31.81.7   220 ms   199 ms   199 ms
10 10.1.1.1   239 ms   239 ms   239 ms</pre>
<div class="p">If a loopback interface address is configured as the source IP address of ICMP Port Unreachable or Time Exceeded messages on a transit device (the loopback interface address 10.2.2.9 of the second hop is used as an example), the following information is displayed when a tracert operation is performed to check the IPv4 network:<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> tracert -m 10 10.1.1.1</strong></pre>
<pre class="screen">traceroute to 10.1.1.1 (10.1.1.1), max hops: 10 ,packet length: 40,press CTRL_C to break
1  172.16.112.1   19 ms   19 ms   1 ms
<strong>2  10.2.2.9   39 ms   39 ms   19 ms</strong>
3  172.16.136.23   39 ms   40 ms   39 ms
4  172.16.168.22   39 ms   39 ms   39 ms
5  172.16.197.4   40 ms   59 ms   59 ms
6  172.16.221.5   59 ms   59 ms   59 ms
7  172.31.70.13   99 ms   99 ms   80 ms
8  172.31.71.6   139 ms   239 ms   319 ms
9  172.31.81.7   220 ms   199 ms   199 ms
10 10.1.1.1   239 ms   239 ms   239 ms</pre>
</div>
<p>The situation is similar on an IPv6 network.</p>
</li></ol>
</p></li><li><span>On an IPv6 network:</span><p><ol><li><p>(Optional) Configure the address of a loopback interface as the source IPv6 address of ICMPv6 Port Unreachable or Time Exceeded messages.</p>
<ol type="a"><li><p>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></p>
<p>The system view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=interface+loopback"><b><span class="cmdname">interface loopback</span></b></a> <i><span class="varname">loopback-number</span></i></p>
<p>A loopback interface is created, and its view is displayed.</p>
</li><li><p>(Optional) Run <a href="cmdqueryname=ip+binding+vpn-instance"><b><span class="cmdname">ip binding vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></p>
<p>The interface is bound to a VPN instance.</p>
</li><li><p>Run <a href="cmdqueryname=ipv6+enable"><b><span class="cmdname">ipv6 enable</span></b></a></p>
<p>IPv6 is enabled on the interface.</p>
</li><li><p>Run <a href="cmdqueryname=ipv6+icmp"><b><span class="cmdname">ipv6 icmp</span></b></a> { <strong><span>hop-limit-exceeded</span></strong> | <strong><span>port-unreachable</span></strong> } <strong><span>source-address</span></strong></p>
<p>The address of the loopback interface is configured as the source IPv6 address of ICMPv6 Port Unreachable or Time Exceeded messages.</p>
</li><li><p>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></p>
<p>The configuration is committed.</p>
</li></ol>
</li><li><p>Run <a href="cmdqueryname=tracert+ipv6"><b><span class="cmdname">tracert ipv6</span></b></a> [ <strong><span>-f</span></strong> <i><span class="varname">first-hop-limit</span></i> | <strong><span>-m</span></strong> <i><span class="varname">max-hop-limit</span></i> | <strong><span>-p</span></strong> <i><span class="varname">port-number</span></i> | <strong><span>-fixedPort</span></strong> | <strong><span>-q</span></strong> <i><span class="varname">probes</span></i> | <strong><span>-w</span></strong> <i><span class="varname">timeout</span></i> | { <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> [ <strong><span>peer</span></strong> <i><span class="varname">peerIpv6</span></i> ] } <span>| <strong><span>-s</span></strong> <i><span class="varname">size</span></i><span> | <strong><span>-name</span></strong></span></span><span> | { { <strong><span>-nexthop</span></strong> <i><span class="varname">nextHopAddr</span></i> | <strong><span>-passroute</span></strong><span><span> | <strong><span>-service-class</span></strong><i><span class="varname"> classValue</span></i></span></span><span><span><span> | <strong><span>-pipe</span></strong></span></span><span> } <sup>*</sup> | <strong><span>-si</span></strong> { <i><span class="varname">source-interface-name</span></i> | <i><span class="varname">source-interface-type</span></i><em> </em><i><span class="varname">source-interface-number</span></i> } } | <strong><span>-a</span></strong> <i><span class="varname">source-ipv6-address</span></i> </span><span>| <strong><span>-v</span></strong></span> | { <strong><span>-tc</span></strong><em> </em><i><span class="varname">tc</span></i> | <strong><span>-dscp</span></strong><em> </em><i><span class="varname">dscp</span></i> }<span> | <strong><span>-te-class</span></strong> <i><span class="varname">teClassValue</span></i></span></span> | <strong><span>ignore-mtu</span></strong> </span>] <sup>*</sup> <i><span class="varname">host-name</span></i> [ <strong><span>-i</span></strong> { <i><span class="varname">ifName</span></i> | <i><span class="varname">ifType</span></i> <i><span class="varname">ifNum</span></i> } ]</p>
<p>The fault is located.</p>
<p>The following example uses the <a href="cmdqueryname=tracert+ipv6"><b><span class="cmdname">tracert ipv6</span></b></a> command to analyze the network.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> tracert ipv6 -q 5 -w 8000 2001:DB8:100::3</strong></pre>
<pre class="screen">traceroute to 2001:DB8:100::3 30 hops max,60 bytes packet
1 2001:DB8:200::2 26 ms 23 ms 26 ms 30 ms 29 ms 
2 2001:DB8:100::3 3020 ms 3024 ms 4040 ms 6820 ms 5584 ms</pre>
<div class="p">Note that on a network that carries APN6 services, <span>you need to run the <strong><a href="cmdqueryname=tracert+ipv6"><b><span class="cmdname">tracert ipv6</span></b></a> </strong><strong><span>-apn-id-ipv6</span></strong><strong> </strong><strong><span>instance</span></strong><strong> </strong><i><span class="varname">instName</span></i> [ <strong><span>-f</span></strong> <i><span class="varname">first-hop-limit</span></i> | <strong><span>-m</span></strong> <i><span class="varname">max-hop-limit</span></i> | <strong><span>-p</span></strong> <i><span class="varname">port-number</span></i> | <strong><span>-fixedPort</span></strong> | <strong><span>-q</span></strong> <i><span class="varname">probes</span></i> | <strong><span>-w</span></strong> <i><span class="varname">timeout</span></i> | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>-s</span></strong> <i><span class="varname">size</span></i> | <strong><span>-name</span></strong> | <strong><span>-a</span></strong> <i><span class="varname">source-ipv6-address</span></i> | <strong><span>-v</span></strong> | <strong><span>-si</span></strong> { <i><span class="varname">source-interface-name</span></i> | <i><span class="varname">source-interface-type</span></i><em> </em><i><span class="varname">source-interface-number</span></i> } | { <strong><span>-tc</span></strong> <i><span class="varname">tc</span></i> | <strong><span>-dscp</span></strong> <i><span class="varname">dscp</span></i> } ] <sup>*</sup> <i><span class="varname">host-name</span></i> command to check whether the network connection is normal. </span>The following is an example:<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> </strong><strong>tracert ipv6 -apn-id-ipv6 instance inst1 vpn-instance vpna -si Gigabitethernet <span>0/1/0</span> 2001:DB8:22::1</strong></pre>
<pre class="screen">  traceroute to vpna 2001:DB8:22::1  30 hops max,60 bytes packet
 1 2001:DB8:10::2 2 ms  3 ms  2 ms 
 2 2001:DB8:22::1 2 ms  1 ms  2 ms</pre>
</div>
</li></ol>
</p></li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ping_cfg_0002.html">Using Ping/Tracert to test an IP Network
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ping_cfg_0088.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>