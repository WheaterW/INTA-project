
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a DCP">
<meta name="abstract" content="A Data Collecting Point (DCP) manages and controls Target Logical Ports (TLPs), collects statistics generated by TLPs, and reports the statistics to a Measurement Control Point (MCP).">
<meta name="description" content="A Data Collecting Point (DCP) manages and controls Target Logical Ports (TLPs), collects statistics generated by TLPs, and reports the statistics to a Measurement Control Point (MCP).">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ipfpm_cfg_0004.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ipfpm_cfg_0006.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ipfpm_cfg_0008.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IP FPM">
<meta name="featuretype" content="System Monitor">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IP FPM">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="IP FPM">
<meta name="featuretype" content="System Monitor">
<meta name="featurename" content="IP FPM">
<meta name="featuretype" content="System Monitor">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="c00511010">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172372887">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a DCP</title>
</head>
<body><a name="EN-US_TASK_0172372887"></a><a name="EN-US_TASK_0172372887"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a DCP</h1>
<div class="taskbody"><p>A Data Collecting Point (DCP) manages and controls Target Logical Ports (TLPs), collects statistics generated by TLPs, and reports the statistics to a Measurement Control Point (MCP).</p>
<div class="context"><a name="EN-US_TASK_0172372887__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><div class="p">On the network shown in <a href="#EN-US_TASK_0172372887__fig_dc_vrp_ipfpm_cfg_000601">Figure 1</a>, IP Flow Performance Measurement (FPM) end-to-end performance statistics collection is implemented. The target flow enters the transport network through <span class="keyword">Device</span> A, travels across <span class="keyword">Device</span> B, and leaves the transport network through <span class="keyword">Device</span> C. To monitor transport network performance or diagnose faults, configure IP FPM end-to-end performance statistics collection on both <span class="keyword">Device</span> A and <span class="keyword">Device</span> C. <span class="keyword">Device</span> A and <span class="keyword">Device</span> C function as DCPs to manage and control TLP100 and TLP310, respectively. <span class="keyword">Device</span> A and <span class="keyword">Device</span> C collect statistics generated by TLP100 and TLP310 and report the statistics to the MCP.<div class="fignone" id="EN-US_TASK_0172372887__fig_dc_vrp_ipfpm_cfg_000601"><a name="EN-US_TASK_0172372887__fig_dc_vrp_ipfpm_cfg_000601"></a><a name="fig_dc_vrp_ipfpm_cfg_000601"></a><span class="figcap"><b>Figure 1 </b>IP FPM end-to-end performance statistics collection</span><br><span><img class="vsd" src="images/fig_dc_vrp_ipfpm_cfg_000601.png" width="NaN" height="NaN"></span><br></div>
</div>
<p>Perform the following steps on <span class="keyword">Device</span> A and <span class="keyword">Device</span> C:</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172372887__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=nqa+ipfpm+dcp"><b><span class="cmdname">nqa ipfpm dcp</span></b></a></span></span><p><p>DCP is enabled globally, and the IPFPM-DCP view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=dcp+id"><b><span class="cmdname">dcp id</span></b></a> <i><span class="varname">id-value</span></i></span><p><p>A DCP ID is configured.</p>
<p>Using the Router ID of a device that is configured as a DCP as its DCP ID is recommended.</p>
<p>The DCP ID configured on a DCP must be the same as that specified in the <a href="cmdqueryname=dcp"><b><span class="cmdname">dcp</span></b></a> <i><span class="varname">dcp-id</span></i> command run in the IP FPM instance view of the MCP associated with this DCP. Otherwise, the MCP cannot process the statistics reported by the DCP.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=authentication-mode"><b><span class="cmdname">authentication-mode</span></b></a> <strong><span>hmac-sha256</span></strong> <strong><span>key-id</span></strong> <i><span class="varname">key-id</span></i> [ <strong><span>cipher</span></strong> ] [ <i><span class="varname">password</span></i> | <strong><span>password</span></strong> ]</span><p><p>An authentication mode and password are configured on the DCP.</p>
</p><p><p>The authentication mode and password configured on the DCP must be the same as those configured using the <a href="cmdqueryname=authentication-mode"><b><span class="cmdname">authentication-mode</span></b></a> <strong><span>hmac-sha256</span></strong> <strong><span>key-id</span></strong> <i><span class="varname">key-id</span></i> [ <strong><span>cipher</span></strong> ] [ <i><span class="varname">password</span></i> | <strong><span>password</span></strong> ] command on the MCP to which the DCP belongs. Otherwise, the MCP cannot process the statistics reported by the DCP.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=color-flag"><b><span class="cmdname">color-flag</span></b></a> <strong><span>loss-measure</span></strong> { <strong><span>tos-bit</span></strong> <i><span class="varname">tos-bit</span></i> | <strong><span>flags-bit0</span></strong> } <strong><span>delay-measure</span></strong> { <strong><span>tos-bit</span></strong> <i><span class="varname">tos-bit</span></i> | <strong><span>flags-bit0</span></strong> }</span></span><p><p>IP FPM measurement flags are configured.</p>
<p>The loss and delay measurement flags cannot use the same bit, and the bits used for loss and delay measurement must not have been used in other measurement tasks.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=mcp"><b><span class="cmdname">mcp</span></b></a> <i><span class="varname">mcp-id</span></i> [ <strong><span>port</span></strong> <i><span class="varname">port-number</span></i> ] [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>net-manager-vpn</span></strong> ]</span></span><p><p>An MCP ID is specified for the DCP, and the UDP port number is configured for the DCP to communicate with the MCP.</p>
<p>The UDP port number configured on the DCP must be the same as that configured in the <a href="cmdqueryname=protocol+udp+port"><b><span class="cmdname">protocol udp port</span></b></a> <i><span class="varname">port-number</span></i> command run on the MCP associated with this DCP. Otherwise, the DCP cannot report the statistics to the MCP.</p>
<p>The VPN instance has been created on the DCP before you configure <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> or <strong><span>net-manager-vpn</span></strong> to allow the DCP to report the statistics to the MCP through the specified VPN or management VPN.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=period+source"><b><span class="cmdname">period source</span></b></a> <strong><span>ntp</span></strong></span></span><p><p>The DCP is configured to select NTP as the clock source when calculating an IP FPM statistical period ID.</p>
</p><p><p>In P2MP (MP being two points) delay measurement scenarios, if the ingress of the service traffic uses NTP as the clock source, but the egresses use a different clock source, for example, NTP<span> or 1588v2</span>, you must configure the egresses to select NTP as the clock source when calculating an IP FPM statistical period ID to ensure consistent clock sources on the ingress and egresses.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=instance"><b><span class="cmdname">instance</span></b></a> <i><span class="varname">instance-id</span></i></span></span><p><p>An IP FPM instance is created, and the instance view is displayed.</p>
<p><i><span class="varname">instance-id</span></i> must be unique on an MCP and all its associated DCPs. The MCP and all its associated DCPs must have the same IP FPM instance configured. Otherwise, statistics collection does not take effect.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=description"><b><span class="cmdname">description</span></b></a> <i><span class="varname">text</span></i></span></span><p><p>The description is configured for the IP FPM instance.</p>
<p>The description of an IP FPM instance can contain the functions of the instance, facilitating applications.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=interval"><b><span class="cmdname">interval</span></b></a> <i><span class="varname">interval</span></i></span></span><p><p>The statistical period is configured for the IP FPM instance.</p>
</p></li><li><span>Perform either of the following operations to configure the target flow characteristics in the IP FPM instance.</span><p><div class="p">Configure the forward or backward target flow characteristics.<ul><li><p>When <strong><span>protocol</span></strong> is specified as TCP or UDP, run:</p>
<p><a href="cmdqueryname=flow"><b><span class="cmdname">flow</span></b></a> { <strong><span>forward</span></strong> | <strong><span>backward</span></strong> } { <strong><span>protocol</span></strong> { <strong><span>tcp</span></strong> | <strong><span>udp</span></strong> } { <strong><span>source-port</span></strong> <i><span class="varname">src-port-number1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">src-port-number2</span></i> ] | <strong><span>destination-port</span></strong> <i><span class="varname">dest-port-number1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">dest-port-number2</span></i> ] } <sup>*</sup> | <strong><span>dscp</span></strong> <i><span class="varname">dscp-value</span></i> | <strong><span>source</span></strong> <i><span class="varname">src-ip-address</span></i> [ <i><span class="varname">src-mask-length</span></i> ] | <strong><span>destination</span></strong> <i><span class="varname">dest-ip-address</span></i> [ <i><span class="varname">dest-mask-length</span></i> ] } <sup>*</sup></p>
</li><li><p>When <strong><span>protocol</span></strong> is specified as any protocol other than TCP or UDP, run:</p>
<p><a href="cmdqueryname=flow"><b><span class="cmdname">flow</span></b></a> { <strong><span>forward</span></strong> | <strong><span>backward</span></strong> } { <strong><span>protocol</span></strong> <i><span class="varname">protocol-number</span></i> | <strong><span>dscp</span></strong> <i><span class="varname">dscp-value</span></i> | <strong><span>source</span></strong> <i><span class="varname">src-ip-address</span></i> [ <i><span class="varname">src-mask-length</span></i> ] | <strong><span>destination</span></strong> <i><span class="varname">dest-ip-address</span></i> [ <i><span class="varname">dest-mask-length</span></i> ] } <sup>*</sup></p>
</li></ul>
</div>
<div class="p">Configure the bidirectional target flow characteristics.<ul><li><p>When <strong><span>protocol</span></strong> is specified as TCP or UDP, run:</p>
<p><a href="cmdqueryname=flow"><b><span class="cmdname">flow</span></b></a> <strong><span>bidirectional</span></strong> { <strong><span>protocol</span></strong> { <strong><span>tcp</span></strong> | <strong><span>udp</span></strong> } { <strong><span>source-port</span></strong> <i><span class="varname">src-port-number1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">src-port-number2</span></i> ] | <strong><span>destination-port</span></strong> <i><span class="varname">dest-port-number1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">dest-port-number2</span></i> ] } <sup>*</sup> | <strong><span>dscp</span></strong> <i><span class="varname">dscp-value</span></i> | <strong><span>source</span></strong> <i><span class="varname">src-ip-address</span></i> [ <i><span class="varname">src-mask-length</span></i> ] | <strong><span>destination</span></strong> <i><span class="varname">dest-ip-address</span></i> [ <i><span class="varname">dest-mask-length</span></i> ] } <sup>*</sup></p>
</li><li><p>When <strong><span>protocol</span></strong> is specified as any protocol other than TCP or UDP, run:</p>
<p><a href="cmdqueryname=flow"><b><span class="cmdname">flow</span></b></a> <strong><span>bidirectional</span></strong> { <strong><span>protocol</span></strong> <i><span class="varname">protocol-number</span></i> | <strong><span>dscp</span></strong> <i><span class="varname">dscp-value</span></i> | <strong><span>source</span></strong> <i><span class="varname">src-ip-address</span></i> [ <i><span class="varname">src-mask-length</span></i> ] | <strong><span>destination</span></strong> <i><span class="varname">dest-ip-address</span></i> [ <i><span class="varname">dest-mask-length</span></i> ] } <sup>*</sup></p>
</li></ul>
</div>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>If the target flow in an IP FPM instance is unidirectional, only <strong><span>forward</span></strong> can be specified.</p>
</li><li><div class="p">If the target flow in an IP FPM instance is bidirectional, two situations are available:<ul><li>If the bidirectional target flow is asymmetrical, you must configure <strong><span>forward</span></strong> and <strong><span>backward</span></strong> in two command instances to configure the forward and backward flow characteristics.</li><li>If the bidirectional target flow is symmetrical, you can specify <strong><span>bidirectional</span></strong> to configure the bidirectional target flow characteristics. By default, the characteristics specified are used for the forward flow, and the reverse of those are used for the backward flow. Specifically, the source and destination IP addresses and port numbers specified for the forward flow are used respectively as the destination and source IP addresses and port numbers for the backward flow. If the target flow is symmetrical bidirectional, set <i><span class="varname">src-ip-address</span></i> to specify a source IP address and <i><span class="varname">dest-ip-address</span></i> to specify a destination IP address for the target flow.</li></ul>
</div>
</li></ul>
</div></div>
</p></li><li><span>Run <span><a href="cmdqueryname=tlp"><b><span class="cmdname">tlp</span></b></a> <i><span class="varname">tlp-id</span></i> { <strong><span>in-point</span></strong> | <strong><span>out-point</span></strong> } { <strong><span>ingress</span></strong> | <strong><span>egress</span></strong> }<span> [ <strong><span>vpn-label</span></strong> <i><span class="varname">vpn-label</span></i> <span>[ <strong><span>lsp-label</span></strong> <i><span class="varname">lsp-label</span></i> ] </span>]</span><span> [ <strong><span>backward-vpn-label</span></strong> <i><span class="varname">backward-vpn-label</span></i> <span>[ <strong><span>backward-lsp-label</span></strong> <i><span class="varname">backward-lsp-label</span></i> ] </span>]</span></span></span><p><p>A TLP and its role are configured for the IP FPM instance.</p>
</p><p><p>TLPs are the measurement points along the target flow in an IP FPM instance. They collect and generate statistics. TLPs in IP FPM instances are classified into in-point TLPs (<strong><span>in-point</span></strong> indicates an in-point TLP on which the system adds the color bit to a target flow) and out-point TLPs (<strong><span>out-point</span></strong> indicates an out-point TLP on which the system removes the color bit from a target flow.) On the network shown in <a href="#EN-US_TASK_0172372887__fig_dc_vrp_ipfpm_cfg_000601">Figure 1</a>, TLP100 and TLP310 are the in-point TLP and out-point TLP, respectively.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the IPFPM-DCP view.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li><span>Bind a TLP to an interface.</span><p><ol type="a"><li><p>Run the <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> { <i><span class="varname">interface-name</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> } command to enter the view of the interface to which a TLP is to be bound.</p>
</li><li><div class="p">Run either of the following commands to bind a TLP to the interface:<ul><li>If the interface is a Layer 3 interface, run the <a href="cmdqueryname=ipfpm+tlp"><b><span class="cmdname">ipfpm tlp</span></b></a> <i><span class="varname">tlp-id</span></i> command.</li><li>If the interface is a Layer 2 interface, run the <a href="cmdqueryname=ipfpm+tlp"><b><span class="cmdname">ipfpm tlp</span></b></a> <i><span class="varname">tlp-id</span></i> { <strong><span>ce-default-vlan</span></strong> | <strong><span>vlan-id</span></strong> <i><span class="varname">vlan-id</span></i> } command.</li></ul>
</div>
</li><li>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</li></ol>
</p></li><li><span>Configure IP FPM end-to-end performance statistics collection.</span><p><ol type="a"><li>Run the <a href="cmdqueryname=nqa+ipfpm+dcp"><b><span class="cmdname">nqa ipfpm dcp</span></b></a> command to enter the IPFPM-DCP view.</li><li>Run the <a href="cmdqueryname=instance"><b><span class="cmdname">instance</span></b></a> <i><span class="varname">instance-id</span></i> command to enter the IP FPM instance view.</li><li><div class="p">Enable packet loss measurement. Run either of the following commands as required:<ul><li><p>To enable on-demand packet loss measurement, run the <a href="cmdqueryname=loss-measure+enable"><b><span class="cmdname">loss-measure enable</span></b></a> [ <strong><span>time-range</span></strong> <i><span class="varname">time-range</span></i> ] command.</p>
</li><li><p>To enable proactive packet loss measurement, run the <a href="cmdqueryname=loss-measure+enable+continual"><b><span class="cmdname">loss-measure enable continual</span></b></a> command.</p>
</li></ul>
</div>
</li><li><p>Perform either of the following operations to enable delay measurement.</p>
<div class="p">If the target flow is unidirectional, run either of the following commands as required:<ul><li><p>To enable on-demand one-way delay measurement, run the <a href="cmdqueryname=delay-measure+enable+one-way"><b><span class="cmdname">delay-measure enable one-way</span></b></a> <strong><span>tlp</span></strong> <i><span class="varname">tlp-id</span></i> [ <strong><span>time-range</span></strong> <i><span class="varname">time-range</span></i> ] command.</p>
</li><li><p>To enable proactive one-way delay measurement, run the <a href="cmdqueryname=delay-measure+enable+one-way"><b><span class="cmdname">delay-measure enable one-way</span></b></a> <strong><span>tlp</span></strong> <i><span class="varname">tlp-id</span></i> <a href="cmdqueryname=continual"><b><span class="cmdname">continual</span></b></a> command.</p>
</li></ul>
</div>
<div class="p">If the target flow is a bidirectional, run either of the following commands as required:<ul><li><p>To enable on-demand two-way delay measurement, run the <a href="cmdqueryname=delay-measure+enable+two-way"><b><span class="cmdname">delay-measure enable two-way</span></b></a> <strong><span>tlp</span></strong> <i><span class="varname">tlp-id1</span></i> [ <i><span class="varname">tlp-id2</span></i> ] [ <strong><span>time-range</span></strong> <i><span class="varname">time-range</span></i> ] command.</p>
</li><li><p>To enable proactive two-way delay measurement, run the <a href="cmdqueryname=delay-measure+enable+two-way"><b><span class="cmdname">delay-measure enable two-way</span></b></a> <strong><span>tlp</span></strong> <i><span class="varname">tlp-id1</span></i> [ <i><span class="varname">tlp-id2</span></i> ] <a href="cmdqueryname=continual"><b><span class="cmdname">continual</span></b></a> command.</p>
</li></ul>
</div>
</li></ol>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ipfpm_cfg_0004.html">Configuring IP FPM End-to-End Performance Statistics Collection
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ipfpm_cfg_0006.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ipfpm_cfg_0008.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>