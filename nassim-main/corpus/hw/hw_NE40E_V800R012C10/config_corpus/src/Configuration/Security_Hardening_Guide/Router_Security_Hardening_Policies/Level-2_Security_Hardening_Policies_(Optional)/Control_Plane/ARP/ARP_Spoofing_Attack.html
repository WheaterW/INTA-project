
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="ARP Spoofing Attack">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0075.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0077.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00588052,y00852169">
<meta name="DC.Publisher" content="20240229">
<meta name="OWNER" content="z00588052,y00852169">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="y00852169">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001134623480">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>ARP Spoofing Attack</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CONCEPT_0000001134623480"></a><a name="EN-US_CONCEPT_0000001134623480"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">ARP Spoofing Attack</h1>
<div><div class="section"><h4 class="sectiontitle">Security Policies</h4><div class="p">ARP spoofing attack defense prevents devices from being attacked by bogus clients or gateways or by malformed ARP packets.<ul><li><p>Strict ARP learning</p>
<p>The device learns the MAC addresses of only the ARP reply packets in response to the ARP request packets sent by itself. This prevents attacks that send ARP request packets and ARP reply packets that are not in response to the request packets that the device itself sends. Strict ARP learning effectively protects the network or devices from bogus clients or gateways.</p>
</li><li><p>Validity check on ARP packets</p>
<p>After receiving an ARP packet, the device checks whether the source and destination MAC addresses in the Ethernet header match those in the Data field of the packet. If they match, the device considers the packet valid and allows it to pass. If they do not match, the device considers the packet an attack packet and discards it. Validity check on ARP packets effectively protects the network or devices from malformed ARP packet attacks.</p>
</li></ul>
</div>
</div>
<div class="section"><h4 class="sectiontitle">Attack Types</h4><div class="p">In ARP spoofing attacks, attackers send fake ARP packets to modify ARP entries on gateways or valid hosts. As a result, valid ARP packets cannot be transmitted.<ul><li><p>An attacker responds with a forged ARP reply packet to a client so that the client learns an incorrect gateway address.</p>
</li><li><p>An attacker sends a forged ARP request packet to the gateway so that the gateway learns incorrect ARP entries.</p>
</li><li><p>An attacker sends malformed ARP packets to a device so that the device learns incorrect ARP entries.</p>
</li></ul>
</div>
</div>
<div class="section"><h4 class="sectiontitle">Configuration Guide</h4><ul><li><p><strong>Configure strict ARP learning.</strong></p>
<div class="p">Strict ARP learning can be configured globally and in the interface view and takes effect as follows:<ul><li><p>If strict ARP learning is configured globally and in the interface view, strict ARP learning configured in the interface view is adopted.</p>
</li><li><p>If strict ARP learning is not configured in the interface view, strict ARP learning configured globally is adopted.</p>
</li></ul>
</div>
<div class="p">Enable strict ARP learning globally.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>arp learning strict</strong></pre>
</div>
<div class="p">Enable strict ARP learning in the interface view.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>interface gigabitethernet <span>0/2/3</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/2/3</span>] <strong>arp learning strict force-enable</strong></pre>
</div>
</li><li><p><strong>Configure validity check on ARP packets.</strong></p>
<div class="p">You can specify only source or destination MAC addresses or both source and destination MAC addresses to verify ARP packets. The check principles are as follows:<ul><li><p>If <strong>source-mac</strong> is specified:</p>
<ul><li><p>After receiving an ARP Request packet, an interface only checks whether the source MAC address in the Ethernet packet header is consistent with that in the Data field of the ARP packet.</p>
</li><li><p>After receiving an ARP Response packet, an interface only checks whether the source MAC address in the Ethernet packet header is consistent with that in the Data field of the ARP packet.</p>
</li></ul>
</li><li><p>If <strong>destination-mac</strong> is specified:</p>
<ul><li><p>After receiving an ARP Request packet, an interface does not check whether the destination MAC address in the Ethernet packet header is consistent with that in the Data field of the ARP packet because ARP packets are broadcast packets.</p>
</li><li><p>After receiving an ARP Response packet, an interface only checks whether the destination MAC address in the Ethernet packet header is consistent with that in the Data field of the ARP packet.</p>
</li></ul>
</li><li><p>If both <strong>source-mac</strong> and <strong>destination-mac</strong> are specified:</p>
<ul><li><p>After receiving an ARP Request packet, an interface only checks whether the source MAC address in the Ethernet packet header is consistent with that in the Data field of the ARP packet.</p>
</li><li><p>After receiving an ARP Response packet, an interface checks whether both the source MAC address and destination MAC address in the Ethernet packet header are respectively the same as those in the Data field of the ARP packet.</p>
</li></ul>
</li></ul>
</div>
<div class="p">Enable validity check on ARP packets in the interface view.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/1</span>] <strong>arp validate source-mac destination-mac</strong></pre>
</div>
</li></ul>
</div>
<div class="section"><h4 class="sectiontitle">Configuration Suggestions</h4><p>When static ARP is configured on a VLANIF interface, the downstream traffic cannot be forwarded if the user traffic is switched between member interfaces of a VLAN due to topology changes. Therefore, do not specify the outbound interface when configuring static ARP. The outbound interface can be learned by sending ARP packets.</p>
<p>The device can prevent ARP attacks by sending gratuitous ARP packets. However, services will be interrupted, affecting the service quality. If ARP attacks persist, manual intervention is required.</p>
<p>In some scenarios, a device has to learn multicast MAC addresses to generate ARP entries.</p>
</div>
<div class="section"><h4 class="sectiontitle">Verifying the Hardening Result</h4><ul><li>Run the <a href="cmdqueryname=display+arp+learning+strict"><b><span class="cmdname">display arp learning strict</span></b></a> command to check the configuration of strict ARP learning.</li><li>Run the <a href="cmdqueryname=display+arp-limit"><b><span class="cmdname">display arp-limit</span></b></a> [ <strong><span>interface</span></strong> { <i><span class="varname">interface-name</span></i> | <i><span class="varname">interface-type interface-number</span></i> } ] command to check the configuration of ARP entry limit.</li><li>Run the <a href="cmdqueryname=display+arp+speed-limit"><b><span class="cmdname">display arp speed-limit</span></b></a> <span>{ </span><strong><span>destination-ip</span></strong><span> | <strong><span>source-ip</span></strong> }</span><span> [ <strong><span>slot</span></strong> <i><span class="varname">slot-id</span></i> ]</span> command to check the configuration of ARP packet rate limit.</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0075.html">ARP
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0077.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>