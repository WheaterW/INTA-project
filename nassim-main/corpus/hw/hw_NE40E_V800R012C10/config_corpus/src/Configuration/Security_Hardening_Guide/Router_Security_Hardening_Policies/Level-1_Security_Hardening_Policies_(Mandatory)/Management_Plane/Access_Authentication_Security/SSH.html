
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="SSH">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0005.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0017.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0012.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="l00799643,z00588052">
<meta name="DC.Publisher" content="20240229">
<meta name="OWNER" content="l00799643,z00588052">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="m00915594">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001180503087">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>SSH</title>
</head>
<body><a name="EN-US_CONCEPT_0000001180503087"></a><a name="EN-US_CONCEPT_0000001180503087"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">SSH</h1>
<div><p></p>
<div class="section"><h4 class="sectiontitle">Security Policy</h4><ul><li><p>Authentication</p>
<p>The SSH server supports AAA authentication, PKI certificate authentication, and public-key authentication. Only authenticated users can log in to the desired device and enter the CLI. AAA authentication supports both remote and local authentication, and remote authentication takes precedence over local authentication.</p>
</li><li><p>Disabling services</p>
<p>When the SSH server is started, socket listening is enabled for devices. In this case, the devices are prone to scanning by attackers. If the SSH server does not need to be used, you can disable the SSH server and the corresponding port.</p>
</li><li><p>Disabling the SSHv1 service</p>
<p>The SSHv1 service is prone to attacks and the algorithm used by it is insecure. To reduce attack risks, you can disable the SSHv1 service.</p>
</li><li><p>Port number change</p>
<p>SSH server port 22 is a well-known port number, which is prone to scanning and attacks. You can change the SSH server port number to a private port number to reduce the possibility of being scanned or attacked. A private port number can be 22 or range from 1025 to 65535.</p>
</li><li><p>ACL</p>
<p>On the SSH server, you can configure ACL rules to control the login to the device's client IP address through STelnet, SFTP, SCP, or SNETCONF.</p>
<p>In the user interface view, you can configure an ACL rule for each VTY channel to control the IP addresses of clients that can log in to the device through STelnet. ACL rules do not control the IP addresses of clients that log in to the device in other modes.</p>
<p>You are advised to configure the SSH client on the SSH server, not on the VTY channel.</p>
</li><li><p>Source interface configuration</p>
<p>Source interfaces supported by the SSH server can be configured. Users must access a device using the IP addresses of the configured source interfaces. In this way, the access range is controlled and the device security is enhanced.</p>
</li><li><p>Configuring the source IPv6 address</p>
<p>You can configure the source IPv6 address supported by the SSH server to allow users to log in to the device only through this IPv6 address. This restricts the access range and improves device security.</p>
</li><li><p>CPCAR-based flood attack defense</p>
<p>In the scenario where Internet public addresses are deployed, a device may be attacked by traffic flooding on the management and control plane. You can configure a CPU defense policy to protect the device against traffic attacks.</p>
</li></ul>
</div>
<div class="section"><h4 class="sectiontitle">Attack Methods</h4><ul><li><p>Brute-force attack</p>
<p>After an attacker obtains the SSH port number, the attacker attempts to access a device. When the device asks authentication information, the attacker may crack the password, pass the authentication, and obtain the access right.</p>
</li><li><p>DoS attack</p>
<p>An SSH server supports only a limited number of users. When the number of login users reaches the upper limit, new users cannot access the server. This problem may be caused by normal use or attacks.</p>
</li></ul>
</div>
<div class="section"><h4 class="sectiontitle">Configuration and Maintenance Methods</h4><ul><li><p>Set the authentication mode to AAA.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>When the authentication mode is set to AAA, you must specify the access type of the local user.</p>
</div></div>
<ol><li>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</li><li>Run the <a href="cmdqueryname=aaa"><b><span class="cmdname">aaa</span></b></a> command to enter the AAA view.</li><li>Run the <a href="cmdqueryname=local-user"><b><span class="cmdname">local-user</span></b></a> <i><span class="varname">user-name</span></i> <strong><span>password</span></strong> [<strong><span>cipher</span></strong> <i><span class="varname">password</span></i> | <strong><span>irreversible-cipher</span></strong> <i><span class="varname">irreversible-cipher-password</span></i> ] command to configure a local username and password.</li><li>Run the <a href="cmdqueryname=local-user"><b><span class="cmdname">local-user</span></b></a> <i><span class="varname">user-name</span></i> <strong><span>user-group manage-ug</span></strong> command to configure administrator rights for the local user.</li><li>Run the <a href="cmdqueryname=local-user"><b><span class="cmdname">local-user</span></b></a> <i><span class="varname">user-name</span></i> <strong><span>service-type ssh</span></strong> command to configure the local user's access type as SSH.</li><li>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to exit the AAA view.</li><li>Run the <a href="cmdqueryname=user-interface"><b><span class="cmdname">user-interface</span></b></a> <strong><span>vty</span></strong> <i><span class="varname">first-ui-number</span></i> [ <em>last-ui-number</em> ] command to enter VTY user interface view.</li><li>Run the <a href="cmdqueryname=authentication-mode+aaa"><b><span class="cmdname">authentication-mode aaa</span></b></a> command to set the user authentication mode to AAA.</li><li>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</li></ol>
</li><li><p>Disable the SSH service. (By default, the SSH service is enabled.)</p>
<ol><li><p>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</p>
</li><li><p>Run the <a href="cmdqueryname=undo+stelnet+server+enable"><b><span class="cmdname">undo stelnet server enable</span></b></a> command to disable the STelnet service.</p>
</li><li>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</li></ol>
</li><li><p>Change the port number to 53555.</p>
<ol><li><p>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</p>
</li><li>Run the <a href="cmdqueryname=ssh+server+port"><b><span class="cmdname">ssh server port</span></b></a> <strong><span>53555</span></strong> command to change the port number to 53555.</li><li>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</li></ol>
</li><li><p>Configure an ACL to restrict login rights of users.</p>
<ol><li><p>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</p>
</li><li>Run the <a href="cmdqueryname=acl"><b><span class="cmdname">acl</span></b></a> { [ <strong><span>number</span></strong> ] <i><span class="varname">acl-number</span></i> | <strong><span>name</span></strong> <i><span class="varname">acl-name</span></i> [ <strong><span>advance</span></strong> ] [ <strong><span>number</span></strong> <i><span class="varname">acl-number</span></i> ] } [ <strong><span>match-order</span></strong> { <strong><span>auto</span></strong> | <strong><span>config</span></strong> } ] command to create an advanced ACL and enter the advanced ACL view.</li><li>Run the <a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> [ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>deny</span></strong> | <strong><span>permit</span></strong> } <i><span class="varname">protocol</span></i> [ <strong><span>destination</span></strong> { <i><span class="varname">destination-ip-address destination-wildcard</span></i> | <strong><span>any</span></strong> } | <strong><span>fragment</span></strong> | <strong><span>source</span></strong> { <i><span class="varname">source-ip-address source-wildcard</span></i> | <strong><span>any</span></strong> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | <strong><span>dscp</span></strong> <i><span class="varname">dscp</span></i> <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] command to configure an ACL rule.</li><li>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to exit the ACL view.</li><li>Run the <a href="cmdqueryname=user-interface"><b><span class="cmdname">user-interface</span></b></a> <strong><span>vty</span></strong> <i><span class="varname">first-ui-number</span></i> [ <i><span class="varname">last-ui-number</span></i> ] command to enter VTY user interface view.</li><li><p>Run the <a href="cmdqueryname=acl"><b><span class="cmdname">acl</span></b></a> <i><span class="varname">acl-number</span></i> { <strong><span>inbound</span></strong> | <strong><span>outbound</span></strong> } command to configure inbound and outbound limits for the VTY user interface.</p>
<p>To control the permission of users logging in to the <span class="keyword">Router</span> from a specified IP address or IP address segment, specify <strong>inbound</strong> in the command.</p>
<p>To prevent users who have logged in from logging in to other <span class="keyword">Router</span>s, specify <strong>outbound</strong> in the command.</p>
</li><li>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to exit the VTY user interface view.</li><li><p>Run the <a href="cmdqueryname=ssh+server+acl"><b><span class="cmdname">ssh server acl</span></b></a> { <i><span class="varname">acl-number</span></i> | <i><span class="varname">acl-name</span></i> } command to configure the IP address of the client that is allowed to log in to the device through SSH.</p>
</li><li>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</li></ol>
</li><li><p>Specify the source interface for a user to log in to the SSH server.</p>
<ol><li><p>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</p>
</li><li><p>Run the <a href="cmdqueryname=ssh+server-source"><b><span class="cmdname">ssh server-source</span></b></a> <strong><span>-i</span></strong> <strong><span>loopback</span></strong> <i><span class="varname">interface-number</span></i> command to specify the source interface of the SSH server.</p>
<div class="p"><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Before specifying the source interface for the SSH server, ensure that the loopback interface has been created. Otherwise, the configuration fails to be executed.</p>
</div></div>
</div>
</li><li>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</li></ol>
</li><li><p>Specify the source IPv6 address for a user to log in to the SSH server.</p>
<ol><li><p>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</p>
</li><li><p>Run the <a href="cmdqueryname=ssh+ipv6+server-source"><b><span class="cmdname">ssh ipv6 server-source</span></b></a> <strong><span>-a</span></strong> <i><span class="varname">ipv6-address</span></i> [ <strong><span>-vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] command to specify a source IPv6 address for the SSH server.</p>
<div class="p"><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>A VPN instance has been created before you specify it for an SSH server. Otherwise, the command cannot be executed.</p>
</div></div>
</div>
</li><li>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</li></ol>
</li><li><p>Configure CPCAR-based flood attack defense.</p>
<ol><li><p>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</p>
</li><li><p>Run the <a href="cmdqueryname=acl"><b><span class="cmdname">acl</span></b></a> { <strong><span>name</span></strong> <i><span class="varname">advance-acl-name</span></i> [ <strong><span>advance</span></strong> | [ <strong><span>advance</span></strong> ] <strong><span>number</span></strong> <i><span class="varname">advance-acl-number</span></i> ] | [ <strong><span>number</span></strong> ] <i><span class="varname">advance-acl-number</span></i> } [ <strong><span>match-order</span></strong> { <strong><span>config</span></strong> | <strong><span>auto</span></strong> } ] command to create an advanced ACL and enter the ACL view.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>SSH is a TCP-based protocol. You can use SSH to log in to a device. To ensure security, you are advised to configure an independent ACL to protect SSH. The device supports dynamic link protection for SSH. The protocol packets with session entries being set up can be forwarded through a dynamic whitelist. In this example, ACLs are used to limit the rate of SSH protocol packets for which no connection has been established. It is recommended that the management protocol directly filter and discard the access traffic from unknown sources.</p>
</div></div>
</li><li><p>Run the following commands to configure ACL rules to allow SSH packets with the source IP addresses in the specified range to be sent to the CPU and deny other SSH packets:</p>
<ul><li>Run the <a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> [ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] <strong><span>permit</span></strong> <strong><span>tcp</span></strong> <strong><span>source</span></strong> <i><span class="varname">source-ip-address</span></i> <i><span class="varname">source-wildcard</span></i> <strong><span>source-port</span></strong> <strong><span>eq 22</span></strong> command to configure the device to send protocol packets with a specified source address and the source interface type being SSH.</li><li>Run the <a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> [ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] <strong><span>permit</span></strong> <strong><span>tcp</span></strong> <strong><span>source</span></strong> <i><span class="varname">source-ip-address</span></i> <i><span class="varname">source-wildcard</span></i> <strong><span>destination-port</span></strong> <strong><span>eq 22</span></strong> command to configure the device to send protocol packets with a specified source address and the destination interface type being SSH.</li><li>Run the <a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> [ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] <strong><span>deny</span></strong> <strong><span>tcp</span></strong> <strong><span>destination-port</span></strong> <strong><span>eq 22</span></strong> command to deny the SSH packets that are not in the whitelist.</li></ul>
</li><li><p>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to exit the ACL view.</p>
</li><li>Run the <a href="cmdqueryname=cpu-defend+policy"><b><span class="cmdname">cpu-defend policy</span></b></a> <i><span class="varname">policy-number</span></i> command to create an attack defense policy.</li><li><p>Run the <a href="cmdqueryname=tcpsyn-flood+enable"><b><span class="cmdname">tcpsyn-flood enable</span></b></a> command to enable defense against TCP SYN flood attacks.</p>
</li><li><p>Run the <a href="cmdqueryname=fragment-flood+enable"><b><span class="cmdname">fragment-flood enable</span></b></a> command to enable defense against fragmented packet attacks.</p>
</li><li><p>Run the <a href="cmdqueryname=udp-packet-defend+enable"><b><span class="cmdname">udp-packet-defend enable</span></b></a> command to enable defense against UDP packet attacks.</p>
</li><li><p>Run the <a href="cmdqueryname=abnormal-packet-defend+enable"><b><span class="cmdname">abnormal-packet-defend enable</span></b></a> command to enable defense against malformed packet attacks.</p>
</li><li>Run the <a href="cmdqueryname=user-defined-flow"><b><span class="cmdname">user-defined-flow</span></b></a> <i><span class="varname">flow-id</span></i> <strong><span>acl</span></strong> { <i><span class="varname">acl-number</span></i> | <strong><span>name</span></strong> <i><span class="varname">acl-name</span></i> } [ <strong><span>prior</span></strong> ] command to configure a user-defined flow and associate it with the ACL.</li><li>Run the <a href="cmdqueryname=car"><b><span class="cmdname">car</span></b></a> <strong><span>user-defined-flow</span></strong> <i><span class="varname">flow-id</span></i> { <strong><span>cir</span></strong> <i><span class="varname">cir-value</span></i> | <strong><span>cbs</span></strong> <i><span class="varname">cbs-value</span></i> <span>| <strong><span>min-packet-length</span></strong> <i><span class="varname">min-packet-length-value</span></i> </span>} command to configure a CAR rule for packets in the user-defined flow.</li><li><p>Run the <a href="cmdqueryname=priority"><b><span class="cmdname">priority</span></b></a> {<span> <i><span class="varname">protocol-name</span></i><span> | <strong><span>index</span></strong> <i><span class="varname">index</span></i> | <strong><span>whitelist</span></strong> | <span><strong><span>whitelist-v6</span></strong> |</span> <strong><span>blacklist</span></strong> | <strong><span>tcpsyn</span></strong> | <strong><span>fragment</span></strong> | <strong><span>user-defined-flow</span></strong> <i><span class="varname">flow-id</span></i> }</span> { <strong><span>high</span></strong> | <strong><span>middle</span></strong> | <strong><span>low</span></strong> | <strong><span>be</span></strong> | <strong><span>af1</span></strong> | <strong><span>af2</span></strong> | <strong><span>af3</span></strong> | <strong><span>af4</span></strong> | <strong><span>ef</span></strong> | <strong><span>cs6</span></strong> }</span> command to configure a priority for packets to be sent to the CPU.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>SSH is an access protocol, which requires less processing bandwidth and does not have high requirements on real-time performance. Therefore, you are advised to set the priority to medium.</p>
</div></div>
</li><li><p>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to exit the attack defense policy view.</p>
</li><li>Run the <a href="cmdqueryname=slot"><b><span class="cmdname">slot</span></b></a> <i><span class="varname">slot-id</span></i> command to enter the view of the specified slot.</li><li>Run the <a href="cmdqueryname=cpu-defend-policy"><b><span class="cmdname">cpu-defend-policy</span></b></a> <i><span class="varname">policy-number</span></i> command to apply the attack defense policy to the specified LPU.</li><li>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</li></ol>
</li></ul>
</div>
<div class="section"><h4 class="sectiontitle">Configuration and Maintenance Suggestions</h4><ul><li><p>Plan IP addresses for managing devices separately to prevent the devices from being scanned and listened on.</p>
</li><li><p>Change the port number of the SSH server.</p>
</li><li><p>Configure an ACL policy to limit the IP addresses that can access the SSH server.</p>
</li><li><p>Configure public-key authentication for SSH users.</p>
</li></ul>
</div>
<div class="section"><h4 class="sectiontitle">Verifying the Security Hardening Result</h4><ul><li>Run the <a href="cmdqueryname=display+current-configuration"><b><span class="cmdname">display current-configuration</span></b></a> <strong><span>configuration aaa</span></strong> command to check the AAA configuration.</li><li>Run the <strong><a href="cmdqueryname=display+ssh+server+status"><b><span class="cmdname">display ssh server status</span></b></a></strong> command to check global configurations of the SSH server.</li><li>Run the <strong><a href="cmdqueryname=display+cpu-defend+policy"><b><span class="cmdname">display cpu-defend policy</span></b></a></strong> <em><i><span class="varname">policy-number</span></i></em> command to check the attack defense policy.</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0005.html">Access Authentication Security
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0017.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0012.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>