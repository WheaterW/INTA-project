
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Configuring Integrity Check for DHCP Server Backup Files">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0094.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0105.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00588052,y00852169">
<meta name="DC.Publisher" content="20240229">
<meta name="OWNER" content="z00588052,y00852169">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="x60031980">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001400291530">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Integrity Check for DHCP Server Backup Files</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CONCEPT_0000001400291530"></a><a name="EN-US_CONCEPT_0000001400291530"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Integrity Check for DHCP Server Backup Files</h1>
<div><div class="section"><h4 class="sectiontitle">Security Policy</h4><p>To prevent data loss caused by device faults, you can run the <strong><a href="cmdqueryname=dhcp+server+database"><b><span class="cmdname">dhcp server database</span></b></a></strong> command to enable the DHCP data saving function. After the function is enabled, the system generates and saves the <strong>lease.txt</strong> and <strong>conflict.txt</strong> files in the <strong>DHCP</strong> folder on a CF card. The <strong>lease.txt</strong> and <strong>conflict.txt</strong> files store address lease and conflict information, respectively. After one-to-many mapping between one MAC address and many sessions is enabled on a device, the device generates an option82_index.data file to save Option 82 information.</p>
<p>To configure an integrity authentication mode for the <strong>lease.txt</strong> and <strong>conflict.txt</strong> files, run the <a href="cmdqueryname=dhcp+server+database+authentication-mode"><b><span class="cmdname">dhcp server database authentication-mode</span></b></a> command. This prevents the files from being tampered with. After this command is run, an encrypted file integrity authentication code is added to the files. After the device restarts, the system decrypts this code and uses it to verify the file integrity before restoring the address lease and conflict information from the <strong>lease.txt</strong> and <strong>conflict.txt</strong> files. If the verification is successful, the data is restored; otherwise, it is discarded and a <strong>DHCP_FILE_RECOVER_FAIL</strong> log is recorded.</p>
</div>
<div class="section"><h4 class="sectiontitle">Attack Methods</h4><p>An attacker tampers with the <strong>lease.txt</strong> and <strong>conflict.txt</strong> files. After the device restarts, the address lease and conflict information in the address pool are incorrect. As a result, the server may fail to assign addresses.</p>
</div>
<div class="section"><h4 class="sectiontitle">Configuration and Maintenance Methods</h4><p>Set the file integrity authentication mode to force-check in the system view.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>]<strong> dhcp server database authentication-mode force-check</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong></pre>
</div>
<div class="section"><h4 class="sectiontitle">Configuration and Maintenance Suggestions</h4><p>If you use a backup file generated on another device to restore data, set the file integrity authentication mode to no-check before a restart.</p>
<p>For compatibility with earlier versions, data can be restored based on an earlier version of a file that does not carry the file integrity check code after a restart. To forcibly check whether data is tampered with based on an earlier version of a file, set the file integrity authentication mode to force-check before a restart.</p>
</div>
<div class="section"><h4 class="sectiontitle">Verifying the Security Hardening Result</h4><p>Run the <strong>display dhcp server database</strong> command to check the DHCPv4 server file integrity authentication mode.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0094.html">DHCP
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0105.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>