
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="GTSM">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0026.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0028.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00588052,y00852169">
<meta name="DC.Publisher" content="20240229">
<meta name="OWNER" content="z00588052,y00852169">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="x60031980">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001134463690">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>GTSM</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CONCEPT_0000001134463690"></a><a name="EN-US_CONCEPT_0000001134463690"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">GTSM</h1>
<div><p></p>
<div class="section"><h4 class="sectiontitle">Security Policy</h4><p>The Generalized TTL Security Mechanism (GTSM) checks whether time to live (TTL) values are valid to protect TCP/IP-based control plane protocols from CPU-utilization (CPU overload) attacks.</p>
<p>Currently, BGP<span>, BGP4+</span>, OSPF<span>, OSPFv3</span><span>, RIP</span><span>, and LDP</span> support GTSM.</p>
<ul><li><p>BGP<span>/BGP4+</span> supports BGP-peer-specific GTSM policies. A GTSM policy can be configured for each BGP peer relationship.</p>
</li><li><p>OSPF<span>/OSPFv3</span> supports protocol-specific GTSM policies. On a public network, only one type of GTSM policy can be deployed. On a private network, GTSM policies are deployed based on the VPN instances, and a GTSM policy can be configured for each OSPF VPN.</p>
</li><li><p>LDP supports LDP-peer-specific GTSM policies. A GTSM policy can be configured to each LDP peer.</p>
</li><li>RIP supports protocol-specific GTSM policies. On a public network, only one type of GTSM policy can be deployed. On a private network, GTSM policies are deployed based on the VPN instances, and a GTSM policy can be configured for each RIP VPN.</li></ul>
<p>A GTSM policy is generated after a GTSM command is executed on a service module. The policy matching conditions vary with protocols:</p>
<ul><li><p>BGP<span>/BGP4+</span>: GTSM policy matching conditions include the source IP address, VRF index, source port ID, and destination port ID.</p>
</li><li><p>OSPF<span>/OSPFv3</span>: A GTSM policy matching condition includes the VRF index.</p>
</li><li><p>LDP: GTSM policy matching conditions include the source IP address, source port ID, and destination port ID.</p>
</li><li>RIP: A GTSM policy matching condition includes the VRF index.</li></ul>
<p>A GTSM policy is deployed as follows:</p>
<ul><li><p>If GTSM for a specific protocol is disabled on a device, packets are sent to the control plane, without being verified.</p>
</li><li><p>If GTSM for a specific protocol is enabled on a device, the device performs GTSM policy matching. If a matching GTSM policy is found, the device checks whether the TTL in a packet is within the specified range. If the TTL is out of the specified range, the device determines that the packet is an attack packet and drops it.</p>
</li></ul>
</div>
<div class="section"><h4 class="sectiontitle">Attack Methods</h4><p>An attacker simulates a routing protocol and continuously sends packets to a device. The device becomes extremely busy processing these attack packets, leading to high CPU usage. To prevent CPU overload, GTSM can be deployed to protect IP-forwarded services by checking whether the TTL value in the IP header of an IP packet is within a pre-defined range.</p>
<div class="fignone"><span class="figcap"><b>Figure 1 </b>Security attack</span><br><span><img class="vsd" src="figure/en-us_image_0000001180623091.png" width="NaN" height="NaN"></span></div>
</div>
<div class="section"><h4 class="sectiontitle">Configuration and Maintenance Methods</h4><p>BGP is used as an example here. Set the valid TTL range for received packets to [255, 255].</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span><span class="keyword">Device</span>A</span>] <strong>bgp 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span><span class="keyword">Device</span>A</span>-bgp] <strong>peer 10.1.1.2 valid-ttl-hops 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span><span class="keyword">Device</span>A</span>-bgp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span><span class="keyword">Device</span>A</span>-bgp] <strong>quit</strong></pre>
</div>
<div class="section"><h4 class="sectiontitle">Verifying the Security Hardening Result</h4><p>Run the <strong>display gtsm statistics</strong> <strong>all</strong> command to view GTSM statistics, including the total number of packets, number of passed packets, and number of dropped packets. For example,</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span><span class="keyword">Device</span>A</span>&gt; <strong>display gtsm statistics all</strong>
GTSM Statistics Table
---------------------------------------------------------------
SlotId  Protocol   Total Counters  Drop Counters  Pass Counters
---------------------------------------------------------------
2       BGP                    18              0             18
2       BGPv6                   0              0              0
2       OSPF                    0              0              0
2       LDP                     0              0              0
2       OSPFv3                  0              0              0
2       RIP                     0              0              0
---------------------------------------------------------------</pre>
</div>
<div class="section"><h4 class="sectiontitle">Configuration and Maintenance Suggestions</h4><p>GTSM is suitable for small networks. The anti-attack effect can be achieved only when the GTSM policy is deployed on the entire network.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0026.html">IPv4 Protocol Stack
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sec_maintenance_0028.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>