
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Inter-VLAN Proxy ND">
<meta name="abstract" content="Inter-VLAN proxy ND can be deployed if hosts that are on the same network segment and physical network but belong to different VLANs need to communicate with each other at Layer 3.">
<meta name="description" content="Inter-VLAN proxy ND can be deployed if hosts that are on the same network segment and physical network but belong to different VLANs need to communicate with each other at Layer 3.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0003.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0006.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0008.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="y00852169,x00504385">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Services">
<meta name="OWNER" content="y00852169">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="x00504385">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0161511717">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Inter-VLAN Proxy ND</title>
</head>
<body><a name="EN-US_TASK_0161511717"></a><a name="EN-US_TASK_0161511717"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Inter-VLAN Proxy ND</h1>
<div class="taskbody"><p>Inter-VLAN proxy ND can be deployed if hosts that are on the same network segment and physical network but belong to different VLANs need to communicate with each other at Layer 3.</p>
<div class="context"><a name="EN-US_TASK_0161511717__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>If hosts are on the same network segment and physical network but belong to different VLANs, inter-VLAN proxy ND must be enabled on the associated VLAN interfaces to enable Layer 3 interworking between the hosts.</p>
<div class="p">In a VLAN aggregation scenario shown in <a href="#EN-US_TASK_0161511717__en-us_concept_0161511699_fig_dc_vrp_nd_feature_002903">Figure 1</a>, HostA and HostB are on the same network segment, but HostA belongs to sub-VLAN 2 and HostB belongs to sub-VLAN 3. HostA and HostB cannot implement Layer 2 interworking.<div class="fignone" id="EN-US_TASK_0161511717__en-us_concept_0161511699_fig_dc_vrp_nd_feature_002903"><a name="EN-US_TASK_0161511717__en-us_concept_0161511699_fig_dc_vrp_nd_feature_002903"></a><a name="en-us_concept_0161511699_fig_dc_vrp_nd_feature_002903"></a><span class="figcap"><b>Figure 1 </b>Typical networking of inter-VLAN proxy ND in a VLAN aggregation scenario</span><br><span><img class="vsd" id="EN-US_TASK_0161511717__en-us_concept_0161511699_image557611216214010" src="images/fig_dc_vrp_nd_feature_003708.png" width="NaN" height="NaN"></span><br></div>
</div>
<p>To address this problem, enable inter-VLAN proxy ND on Device's interface 1.</p>
<div class="p">On the L2VPN+L3VPN IP RAN shown in <a href="#EN-US_TASK_0161511717__en-us_concept_0161511699_fig_dc_vrp_nd_feature_002906">Figure 2</a>, the CSGs are connected to the ASG through L2VE sub-interfaces, and the ASG terminates L2VPN packets and is connected to the BGP/MPLS IPv6 VPN through an L3VE sub-interface. eNodeB1 and eNodeB2 belong to VLAN 2 and VLAN 3, respectively. As such, users on the same network segment on the eNodeBs cannot directly communicate with each other at Layer 2.<div class="fignone" id="EN-US_TASK_0161511717__en-us_concept_0161511699_fig_dc_vrp_nd_feature_002906"><a name="EN-US_TASK_0161511717__en-us_concept_0161511699_fig_dc_vrp_nd_feature_002906"></a><a name="en-us_concept_0161511699_fig_dc_vrp_nd_feature_002906"></a><span class="figcap"><b>Figure 2 </b>Typical networking of inter-VLAN proxy ND in an L2VPN+L3VPN IP RAN</span><br><span><img class="vsd" id="EN-US_TASK_0161511717__en-us_concept_0161511699_image209101851214010" src="images/fig_dc_vrp_nd_feature_003715.png" width="NaN" height="NaN"></span></div>
</div>
<div class="p">To address this problem, enable inter-VLAN proxy ND on the L3VE sub-interfaces of the ASG. <ol id="EN-US_TASK_0161511717__en-us_concept_0161511699_ol1063092525214010"><li id="EN-US_TASK_0161511717__en-us_concept_0161511699_li708741892214010">CSG1 sends an NS packet to request for the MAC address of CSG2.</li><li id="EN-US_TASK_0161511717__en-us_concept_0161511699_li1412566301214010">Upon receipt of the NS packet, the ASG finds that the destination IPv6 address in the packet is not its own IPv6 address and therefore determines that the NS packet does not request for its MAC address. The ASG then checks whether ND entries destined for CSG2 exist.<ul id="EN-US_TASK_0161511717__en-us_concept_0161511699_ul1801983587214010"><li id="EN-US_TASK_0161511717__en-us_concept_0161511699_li653412218214010">If such ND entries exist and the VLAN information in the ND entries is inconsistent with the VLAN information configured on the interface receiving the NS packet, the ASG determines whether inter-VLAN proxy ND is enabled on the L3VE sub-interface.<ul id="EN-US_TASK_0161511717__en-us_concept_0161511699_ul1935828423214010"><li id="EN-US_TASK_0161511717__en-us_concept_0161511699_li2117619891214010"><p id="EN-US_TASK_0161511717__en-us_concept_0161511699_p591026306214010"><a name="EN-US_TASK_0161511717__en-us_concept_0161511699_li2117619891214010"></a><a name="en-us_concept_0161511699_li2117619891214010"></a>If inter-VLAN proxy ND is enabled, the ASG sends the MAC address of the L3VE sub-interface to CSG1.</p>
<p id="EN-US_TASK_0161511717__en-us_concept_0161511699_p55117623214010">Upon receipt of the NA packet, CSG1 considers that this packet is sent by CSG2. CSG1 learns the MAC address of the ASG's L3VE sub-interface in the NA packet and sends data packets to CSG2 using this MAC address.</p>
</li><li id="EN-US_TASK_0161511717__en-us_concept_0161511699_li613191136214010">If inter-VLAN proxy ND is not enabled, the NS packet is discarded.</li></ul>
</li><li id="EN-US_TASK_0161511717__en-us_concept_0161511699_li903424323214010">If such ND entries do not exist, the NS packet sent by CSG1 is discarded and CSG2 checks whether inter-VLAN proxy ND is enabled on the associated L3VE sub-interface.<ul id="EN-US_TASK_0161511717__en-us_concept_0161511699_ul434129688214010"><li id="EN-US_TASK_0161511717__en-us_concept_0161511699_li1990293986214010">If inter-VLAN proxy ND is enabled, the NS packet is forwarded in VLAN 3 as a multicast packet and the destination IPv6 address of the NS packet is CSG2's IPv6 address. The corresponding ND entries are generated after the NA packet sent by CSG2 is received.</li><li id="EN-US_TASK_0161511717__en-us_concept_0161511699_li1190493962214010">If inter-VLAN proxy ND is not enabled, no action is required.</li></ul>
</li></ul>
</li></ol>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0161511717__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span><p><p>The interface view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=ipv6+enable"><b><span class="cmdname">ipv6 enable</span></b></a></span></span><p><p>IPv6 is enabled on the interface.</p>
</p></li><li><span>Run <a href="cmdqueryname=ipv6+address"><b><span class="cmdname">ipv6 address</span></b></a> { <i><span class="varname">ipv6-address</span></i> <i><span class="varname">prefix-length</span></i> | <i><span class="varname">ipv6-address</span></i>/<i><span class="varname">prefix-length</span></i> } [ <strong><span>tag</span></strong> <i><span class="varname">tag-value</span></i> ]</span><p><p>A global unicast address is configured for the interface.</p>
</p></li><li><span>Run <a href="cmdqueryname=ipv6+nd+proxy+inter-access-vlan+enable"><b><span class="cmdname">ipv6 nd proxy inter-access-vlan enable</span></b></a></span><p><p>Inter-VLAN proxy ND is enabled.</p>
</p><p></p><p></p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0003.html">Configuring Proxy ND
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0006.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0008.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>