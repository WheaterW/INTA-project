
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring NS Multicast Suppression on an EVPN MPLS Network">
<meta name="abstract" content="When a user accesses an EVPN MPLS network through a BD, NS multicast suppression can be configured to reduce or suppress excess NS messages.">
<meta name="description" content="When a user accesses an EVPN MPLS network through a BD, NS multicast suppression can be configured to reduce or suppress excess NS messages.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0003.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0017.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="y00852169,x00504385">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Services">
<meta name="OWNER" content="y00852169">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="x00504385">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172365175">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring NS Multicast Suppression on an EVPN MPLS Network</title>
</head>
<body><a name="EN-US_TASK_0172365175"></a><a name="EN-US_TASK_0172365175"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring NS Multicast Suppression on an EVPN MPLS Network</h1>
<div class="taskbody"><p>When a user accesses an EVPN MPLS network through a BD, NS multicast suppression can be configured to reduce or suppress excess NS messages.</p>
<div class="context"><a name="EN-US_TASK_0172365175__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>When a user is connected to an EVPN MPLS network through a BD, IPv6 host neighbors are discovered in NS multicast mode. When a device receives an NS message for IPv6 address resolution, the device forwards the NS message in multicast mode in its BD. If a large number of NS messages are received within a specified period, forwarding all these NS messages on the EVPN occupies excessive network resources, which affects service running.</p>
<p>On the network shown in <a href="#EN-US_TASK_0172365175__fig_dc_vrp_evpn_cfg_000301">Figure 1</a>, NS multicast suppression can be configured on a PE. When receiving an NS message, the PE checks whether it can obtain the destination user information in the NS message. If so, it performs proxy ND or multicast-to-unicast processing to reduce or suppress NS message flooding.</p>
<p>NS multicast suppression can also prevent ND spoofing attacks. <span>An ND spoofing attack means that an attacker associates its MAC address with the IPv6 address of a host so that any traffic destined for the IPv6 address can be sent to the attacker. With NS multicast suppression enabled, if such an attack is launched, the proxy ND table conflict detection mechanism triggers an IPv6 address conflict alarm, reminding users of the potential ND spoofing attack.</span></p>
<div class="fignone" id="EN-US_TASK_0172365175__fig_dc_vrp_evpn_cfg_000301"><a name="EN-US_TASK_0172365175__fig_dc_vrp_evpn_cfg_000301"></a><a name="fig_dc_vrp_evpn_cfg_000301"></a><span class="figcap"><b>Figure 1 </b>NS multicast suppression</span><br><span><img class="vsd" src="images/fig_dc_vrp_evpn_cfg_000304.png" width="NaN" height="NaN"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365175__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring NS multicast suppression, complete the following tasks:</p>
<ul><li><p><a href="dc_vrp_evpn_cfg_0065.html">Configure BD-based EVPN functions.</a></p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172365175__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enable NS multicast suppression.</span><p><ol type="a"><li><p>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</p>
</li><li><p>Run the <a href="cmdqueryname=bridge-domain"><b><span class="cmdname">bridge-domain</span></b></a> <i><span class="varname">bd-id</span></i> command to enter the BD view.</p>
</li><li><p>Run the <a href="cmdqueryname=ipv6+nd+multicast-suppress"><b><span class="cmdname">ipv6 nd multicast-suppress</span></b></a> { <strong><span>proxy-reply</span></strong> [ <strong><span>unknown-options-unicast</span></strong> ] | <strong><span>unicast-forward</span></strong> } [ <strong><span>mismatch-discard</span></strong> ] <strong><span>enable</span></strong> command to enable NS multicast suppression.</p>
</li><li><p>(Optional) Run the <a href="cmdqueryname=ipv6+nd+multicast-suppress"><b><span class="cmdname">ipv6 nd multicast-suppress</span></b></a> { <strong><span>host</span></strong> | <strong><span>router</span></strong> } command to configure the R flag for NA messages when proxy ND is performed.</p>
</li><li><p>(Optional) Run the <a href="cmdqueryname=ipv6+nd+multicast-suppress+dynamic+limit"><b><span class="cmdname">ipv6 nd multicast-suppress dynamic limit</span></b></a> <i><span class="varname">limit-value</span></i> command to configure the maximum number of dynamic proxy ND entries that can be learned in the BD.</p>
</li><li><p>(Optional) Run the <a href="cmdqueryname=ipv6+nd+multicast-suppress+dynamic+expire-time"><b><span class="cmdname">ipv6 nd multicast-suppress dynamic expire-time</span></b></a> <i><span class="varname">expire-time-value</span></i> command to configure an aging time for dynamic proxy ND entries.</p>
</li><li><p>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</p>
</li><li><p>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to exit the BD view.</p>
</li></ol>
</p></li><li><span>Enable the function to flood ND entries or proxy ND entries through EVPN routes.</span><p><p>Perform the following operations on a Layer 2 device:</p>
<ol type="a"><li><p>Run the <a href="cmdqueryname=bridge-domain"><b><span class="cmdname">bridge-domain</span></b></a> <i><span class="varname">bd-id</span></i> command to enter the BD view.</p>
</li><li><p>Run the <a href="cmdqueryname=ipv6+nd+collect+host+enable"><b><span class="cmdname">ipv6 nd collect host enable</span></b></a> command to enable the device to flood proxy ND entries through EVPN routes.</p>
</li><li><p>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</p>
</li><li><p>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to exit the BD view.</p>
</li></ol>
<p>Perform the following operations on a Layer 3 device:</p>
<ol type="a"><li><p>Run the <a href="cmdqueryname=interface+vbdif"><b><span class="cmdname">interface vbdif</span></b></a> <i><span class="varname">bd-id</span></i> command to create a VBDIF interface and enter its view.</p>
</li><li><p>Run the <a href="cmdqueryname=ipv6+enable"><b><span class="cmdname">ipv6 enable</span></b></a> command to enable IPv6 on the interface.</p>
</li><li><p>Run the <a href="cmdqueryname=ipv6+nd+collect+host+enable"><b><span class="cmdname">ipv6 nd collect host enable</span></b></a> command to enable the device to flood ND entries through EVPN routes.</p>
</li><li><p>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</p>
</li><li><p>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to exit the VBDIF interface view.</p>
</li></ol>
</p></li><li><span>Configure BGP EVPN to advertise routes.</span><p><ol type="a"><li>Run the <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i><span> [ <strong><span>instance</span></strong> <i><span class="varname">instance-name</span></i> ]</span> command to enter the BGP view<span> or BGP multi-instance view</span>.</li><li><p>Run the <a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname">l2vpn-family evpn</span></b></a> command to enter the BGP-EVPN address family view or BGP multi-instance EVPN address family view.</p>
</li><li><p>Run the <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>advertise</span></strong> <strong><span>nd</span></strong> command to enable the device to advertise ND routes.</p>
</li><li><p>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</p>
</li><li><p>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to exit the BGP-EVPN address family view or BGP multi-instance EVPN address family view.</p>
</li><li><p>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to exit the BGP view or BGP multi-instance view.</p>
</li></ol>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>For security purposes, you are advised not to use weak security algorithms in the BGP feature. If you need to use such an algorithm, run the <strong>undo crypto weak-algorithm disable</strong> command to enable the weak security algorithm function first.</p>
</div></div>
</p></li><li><span>(Optional) Configure performance limiting for ND message processing.</span><p><ol type="a"><li><p>Run the <a href="cmdqueryname=ipv6+nd"><b><span class="cmdname">ipv6 nd</span></b></a> { <strong><span>rs</span></strong> | <strong><span>ra</span></strong> | <strong><span>ns</span></strong> | <strong><span>na</span></strong> } <strong><span>anti-attack</span></strong> <strong><span>rate-limit</span></strong> <i><span class="varname">limit-number</span></i> command to configure a rate limit for sending ND messages to the CPU, that is, the number of ND messages that can be processed per second.</p>
</li><li><p>Run the <a href="cmdqueryname=ipv6+nd+miss+anti-attack+rate-limit"><b><span class="cmdname">ipv6 nd miss anti-attack rate-limit</span></b></a> <i><span class="varname">limit-number</span></i> command to configure a rate limit for sending ND Miss messages to the CPU, that is, the number of ND Miss messages that can be processed per second.</p>
</li><li><p>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</p>
</li></ol>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0172365175__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ul><li><p>Run the <a href="cmdqueryname=display+ipv6+nd+multicast-suppress+bridge-domain"><b><span class="cmdname">display ipv6 nd multicast-suppress bridge-domain</span></b></a> [ <i><span class="varname">bd-id</span></i> ] [ <strong><span>verbose</span></strong> ] command to check information about proxy ND tables in BDs. If the <i><span class="varname">bd-id</span></i> parameter is not specified, information about proxy ND tables in all BDs is displayed.</p>
</li><li><p>Run the <a href="cmdqueryname=display+ipv6+nd+packet+statistics+bridge-domain"><b><span class="cmdname">display ipv6 nd packet statistics bridge-domain</span></b></a> [ <i><span class="varname">bd-id</span></i> ] command to check ND message statistics in BDs. If the <i><span class="varname">bd-id</span></i> parameter is not specified, statistics about ND messages in all BDs are displayed.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In the user view, run the <a href="cmdqueryname=reset+ipv6+nd+multicast-suppress+dynamic+bridge-domain"><b><span class="cmdname">reset ipv6 nd multicast-suppress dynamic bridge-domain</span></b></a> [ <i><span class="varname">bd-id</span></i> ] command to clear dynamic proxy ND entries in BDs. If the <i><span class="varname">bd-id</span></i> parameter is not specified, dynamic proxy ND entries in all BDs are cleared.</p>
<p>In the user view, run the <a href="cmdqueryname=reset+ipv6+nd+packet+statistics+bridge-domain"><b><span class="cmdname">reset ipv6 nd packet statistics bridge-domain</span></b></a> [ <i><span class="varname">bd-id</span></i> ] command to clear ND message statistics in BDs. If the <i><span class="varname">bd-id</span></i> parameter is not specified, ND message statistics in all BDs are cleared.</p>
</div></div>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0000.html">ND Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0003.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_nd_cfg_0017.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>