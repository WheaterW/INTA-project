
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Configuring Unicast Route Load Balancing">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/load-balance_feature_043.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/load-balance_feature_045.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,56630517l00801610,z00485179,w00556928,w00606909,">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Load Balance">
<meta name="featuretype" content="IP Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Load Balance">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="Load Balance">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="Load Balance">
<meta name="featuretype" content="IP Services">
<meta name="OWNER" content="z00485179,z00648985">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00485179">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0172365019">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring Unicast Route Load Balancing</title>
</head>
<body><a name="EN-US_CONCEPT_0172365019"></a><a name="EN-US_CONCEPT_0172365019"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Unicast Route Load Balancing</h1>
<div><p></p>
<p>Before configuring unicast route load balancing, please attention to the maximum number of routes of the unicast routing table. The route load balancing increases the number of routes.</p>
<div class="section"><h4 class="sectiontitle">Configuring Load Balancing Among IGP Routes</h4><p>Configuration Procedure:</p>
<ol><li>Deploy multiple links of the same cost/metric to achieve load balancing.<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Modification of IGP cost impacts on BGP route selection.</p>
</div></div>
</li><li>(Optional) Set the maximum number of routes among which load balancing is performed. For different products and different protocols, the maximum number of equal-cost routes is different, as shown in <a href="#EN-US_CONCEPT_0172365019__tab_04401">Table 1</a>.</li></ol>

<div class="tableBorder"><a name="EN-US_CONCEPT_0172365019__tab_04401"></a><a name="tab_04401"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_CONCEPT_0172365019__tab_04401" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Configuration Guide for Maximum Number of IGP Load-balancing</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="15.939999999999998%" id="mcps1.4.2.4.2.4.1.1" liSelected="liSelected"><p>Route Type</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="58.26%" id="mcps1.4.2.4.2.4.1.2" liSelected="liSelected"><p>Command Format</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="25.8%" id="mcps1.4.2.4.2.4.1.3" liSelected="liSelected"><p>View</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="15.939999999999998%" headers="mcps1.4.2.4.2.4.1.1 "><p>OSPF</p>
</td>
<td class="cellrowborder" valign="top" width="58.26%" headers="mcps1.4.2.4.2.4.1.2 "><p><a href="cmdqueryname=maximum+load-balancing"><b><span class="cmdname">maximum load-balancing</span></b></a> <em>number</em></p>
</td>
<td class="cellrowborder" valign="top" width="25.8%" headers="mcps1.4.2.4.2.4.1.3 "><p>OSPF view</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.939999999999998%" headers="mcps1.4.2.4.2.4.1.1 "><p>OSPFv3</p>
</td>
<td class="cellrowborder" valign="top" width="58.26%" headers="mcps1.4.2.4.2.4.1.2 "><p><a href="cmdqueryname=maximum+load-balancing"><b><span class="cmdname">maximum load-balancing</span></b></a> <em>number</em></p>
</td>
<td class="cellrowborder" valign="top" width="25.8%" headers="mcps1.4.2.4.2.4.1.3 "><p>OSPFv3 view</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.939999999999998%" headers="mcps1.4.2.4.2.4.1.1 "><p>IS-IS</p>
</td>
<td class="cellrowborder" valign="top" width="58.26%" headers="mcps1.4.2.4.2.4.1.2 "><p><a href="cmdqueryname=maximum+load-balancing"><b><span class="cmdname">maximum load-balancing</span></b></a> <em>number</em></p>
</td>
<td class="cellrowborder" valign="top" width="25.8%" headers="mcps1.4.2.4.2.4.1.3 "><p>IS-IS view</p>
<p>IS-IS topology view</p>
<p>IS-IS IPv6 topology view</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.939999999999998%" headers="mcps1.4.2.4.2.4.1.1 "><p>IS-IS IPv6</p>
</td>
<td class="cellrowborder" valign="top" width="58.26%" headers="mcps1.4.2.4.2.4.1.2 "><p><a href="cmdqueryname=ipv6+maximum+load-balancing"><b><span class="cmdname">ipv6 maximum load-balancing</span></b></a> <em>number</em></p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>This command is valid only for an IPv6 base topology, and invalid for IPv6 routes in multi-topology.</p>
<p>The <a href="cmdqueryname=maximum+load-balancing"><b><span class="cmdname">maximum load-balancing</span></b></a> <em>number</em> command in the IS-IS IPv6 topology view is used to configure load balancing among IPv6 routes in multi-topology.</p>
</div></div>
</td>
<td class="cellrowborder" valign="top" width="25.8%" headers="mcps1.4.2.4.2.4.1.3 "><p>IS-IS view</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.939999999999998%" headers="mcps1.4.2.4.2.4.1.1 "><p>RIP</p>
</td>
<td class="cellrowborder" valign="top" width="58.26%" headers="mcps1.4.2.4.2.4.1.2 "><p><a href="cmdqueryname=maximum+load-balancing"><b><span class="cmdname">maximum load-balancing</span></b></a> <em>number</em></p>
</td>
<td class="cellrowborder" valign="top" width="25.8%" headers="mcps1.4.2.4.2.4.1.3 "><p>RIP view</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.939999999999998%" headers="mcps1.4.2.4.2.4.1.1 "><p>RIPng</p>
</td>
<td class="cellrowborder" valign="top" width="58.26%" headers="mcps1.4.2.4.2.4.1.2 "><p><a href="cmdqueryname=maximum+load-balancing"><b><span class="cmdname">maximum load-balancing</span></b></a> <em>number</em></p>
</td>
<td class="cellrowborder" valign="top" width="25.8%" headers="mcps1.4.2.4.2.4.1.3 "><p>RIPng view</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>For different products and different protocols, the maximum number of equal-cost routes is different. The maximum value can be adjusted by purchasing license files.</p>
</div></div>
</div>
<div class="section"><h4 class="sectiontitle">Configuring Load Balancing Among BGP Routes</h4><div class="p">There are three solutions for Load Balancing Among BGP Routes<ul><li><p><strong>Solution 1</strong>: Static routes or equal-cost IGP routes for BGP route recursion. Configuration Procedure:</p>
<ol><li>Establish the BGP peers relationship using Loopback interface.<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The default TTL value of an EBGP packet is 1. You must run the <a href="cmdqueryname=peer+ebgp-max-hop"><b><span class="cmdname">peer ebgp-max-hop</span></b></a> command to change the TTL value on both communication parties.</p>
</div></div>
</li><li>Deploy multiple links between the BGP peers.</li><li>Configure multiple static routes or equal-cost IGP routes to the loopback interface address of the remote BGP peer.</li><li>Set the maximum number of equal-cost routes to implement BGP route load balancing. For details on how to set the maximum number of equal-cost routes, see <a href="#EN-US_CONCEPT_0172365019__tab_04402">Table 2</a>.<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>By default, the maximum number of equal-cost BGP routes is 1, that is, the load balancing among BGP routes is not enabled by default.</p>
<p>If the <a href="cmdqueryname=maximum+load-balancing"><b><span class="cmdname">maximum load-balancing</span></b></a> command is configured, when the routes advertised from the EBGP peer are advertised to IBGP peers, the next hop address of the routes is set as the local IP address by which the IBGP peer is established. If the <a href="cmdqueryname=maximum+load-balancing"><b><span class="cmdname">maximum load-balancing</span></b></a> command is not configured, the next hop address of the routes is not changed when the routes are advertised to the IBGP peer, unless the <a href="cmdqueryname=peer+next-hop-local"><b><span class="cmdname">peer next-hop-local</span></b></a> command is configured.</p>
</div></div>
</li></ol>

<div class="tableBorder"><a name="EN-US_CONCEPT_0172365019__tab_04402"></a><a name="tab_04402"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_CONCEPT_0172365019__tab_04402" frame="border" border="1" rules="all"><caption><b>Table 2 </b>Configuration Guide for Maximum Number of BGP Load-balancing</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="13.750000000000002%" id="mcps1.4.3.2.1.1.3.2.5.1.1" liSelected="liSelected"><p>Route Type</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="50.24999999999999%" id="mcps1.4.3.2.1.1.3.2.5.1.2" liSelected="liSelected"><p>Command Format</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="22.25%" id="mcps1.4.3.2.1.1.3.2.5.1.3" liSelected="liSelected"><p>Views</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="13.750000000000002%" id="mcps1.4.3.2.1.1.3.2.5.1.4" liSelected="liSelected"><p>Default value</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="13.750000000000002%" headers="mcps1.4.3.2.1.1.3.2.5.1.1 "><p>BGP</p>
</td>
<td class="cellrowborder" valign="top" width="50.24999999999999%" headers="mcps1.4.3.2.1.1.3.2.5.1.2 "><ol><li>Run the <a href="cmdqueryname=maximum+load-balancing"><b><span class="cmdname">maximum load-balancing</span></b></a> [ <strong>ebgp</strong> | <strong>ibgp</strong> ] <em>number</em> command to set the maximum number of equal-cost routes.</li><li>(Optional) Run the <a href="cmdqueryname=load-balancing+as-path-ignore"><b><span class="cmdname">load-balancing as-path-ignore</span></b></a> command to configure a router to ignore comparing the AS_Path attributes of the routes among which load balancing is performed.</li><li>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a>.</li></ol>
</td>
<td class="cellrowborder" valign="top" width="22.25%" headers="mcps1.4.3.2.1.1.3.2.5.1.3 "><p>BGP view</p>
<p>BGP IPv4 unicast address family view</p>
<p>BGP IPv6 unicast address family view</p>
<p>BGP-VPN instance IPv4 address family view</p>
<p>BGP-VPN instance IPv6 address family view</p>
</td>
<td class="cellrowborder" valign="top" width="13.750000000000002%" headers="mcps1.4.3.2.1.1.3.2.5.1.4 "><p>1</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="13.750000000000002%" headers="mcps1.4.3.2.1.1.3.2.5.1.1 "><p>EBGP and IBGP</p>
</td>
<td class="cellrowborder" valign="top" width="50.24999999999999%" headers="mcps1.4.3.2.1.1.3.2.5.1.2 "><ol><li>Run the <a href="cmdqueryname=maximum+load-balancing+eibgp"><b><span class="cmdname">maximum load-balancing eibgp</span></b></a> <em>number</em> command to set the maximum number of equal-cost routes.</li><li>(Optional) Run the <a href="cmdqueryname=load-balancing+as-path-ignore"><b><span class="cmdname">load-balancing as-path-ignore</span></b></a> command to configure a router to ignore comparing the AS_Path attributes of the routes among which load balancing is performed.</li><li>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a>.</li></ol>
</td>
<td class="cellrowborder" valign="top" width="22.25%" headers="mcps1.4.3.2.1.1.3.2.5.1.3 "><p>BGP-VPN instance IPv4 address family view</p>
<p>BGP-VPN instance IPv6 address family view</p>
</td>
<td class="cellrowborder" valign="top" width="13.750000000000002%" headers="mcps1.4.3.2.1.1.3.2.5.1.4 "><p>1</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>For application case of <strong>Solution 1</strong>, see <a href="load-balance_feature_055.html">BGP Route Load Balancing in an RR Scenario</a>.</p>
</li><li><p><strong>Solution 2</strong>: Modify BGP route attributes according to the rule of BGP route selection. Configuration Procedure:</p>
<ol><li>Deploy multiple links between the BGP peers.</li><li>Modify BGP route attributes according to the rule of BGP route selection. For detailed information about the rule of BGP route selection, see <a href="load-balance_feature_013.html">Load Balancing Among BGP Routes</a>.</li><li>Set the maximum number of routes among which load balancing is performed, see the above table.</li></ol>
</li><li><p><strong>Solution 3</strong>: Divide the destination addresses into multiple groups and deploy multiple links between the BGP peers, one link for each group. Suitable scenarios: there are multiple EBGP peers in the same AS to the same destination. Configuration Procedure:</p>
<ol><li>Configure a static route to the virtual address of the remote EBGP peer on each EBGP router. Load balancing among EBGP routes is implemented through route recursion.</li><li>Configure ACL, IP-prefix, AS-Path filter, community-filter, extcommunity-filter, or Route Distinguisher (RD) filter to divide the destination addresses into multiple groups.</li><li>Configure route policies to set the next hop address as the Loopback address of the EBGP peer so that one link is used for each group.</li><li>Apply the route policies to the routes advertisement from the EBGP routers to RR or IBGP peer.</li></ol>
<p>For application case of <strong>Solution 3</strong>, see <a href="load-balance_feature_056.html">Solution to the Low Equal-Cost Route Specification on the Remote Device Without Interrupting Services</a>.</p>
</li></ul>
</div>
</div>
<div class="section"><h4 class="sectiontitle">Follow-up Procedure</h4><p>Run the <strong>save</strong> command to save the current configuration to the configuration file when a set of configuration is finished and the expected functions have been achieved.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/load-balance_feature_043.html">Configuring Load Balancing Conditions
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/load-balance_feature_045.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>