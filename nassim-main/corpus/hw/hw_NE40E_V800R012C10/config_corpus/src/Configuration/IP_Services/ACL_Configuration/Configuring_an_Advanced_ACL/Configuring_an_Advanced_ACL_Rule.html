
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring an Advanced ACL Rule">
<meta name="abstract" content="Advanced ACL rules are defined based on packets' source IP address, destination IP address, protocol type carried over IP, source port, and destination port to filter packets.">
<meta name="description" content="Advanced ACL rules are defined based on packets' source IP address, destination IP address, protocol type carried over IP, source port, and destination port to filter packets.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_acl4_cfg_0054.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_acl4_cfg_0103.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_acl4_cfg_0058.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,aclvrp,z00485179,w00556928,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="ACL">
<meta name="featuretype" content="IP Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ACL">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="ACL">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="ACL">
<meta name="featuretype" content="IP Services">
<meta name="OWNER" content="z00485179,z00648985">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00485179">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172364594">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring an Advanced ACL Rule</title>
</head>
<body><a name="EN-US_TASK_0172364594"></a><a name="EN-US_TASK_0172364594"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring an Advanced ACL Rule</h1>
<div class="taskbody"><p>Advanced ACL rules are defined based on packets' source IP address, destination IP address, protocol type carried over IP, source port, and destination port to filter packets.</p>
<div class="steps"><a name="EN-US_TASK_0172364594__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=acl+name+advance+advance+number+number+match-order+config+auto"><b><span class="cmdname">acl</span></b></a> { <strong><span>name</span></strong> <i><span class="varname">advance-acl-name</span></i> { <strong><span>advance</span></strong> | [ <strong><span>advance</span></strong> ] <strong><span>number</span></strong> <i><span class="varname">advance-acl-number</span></i> } | [ <strong><span>number</span></strong> ] <i><span class="varname">advance-acl-number</span></i> } [ <strong><span>match-order</span></strong> { <strong><span>config</span></strong> | <strong><span>auto</span></strong> } ]</span></span><p><p>The advanced ACL view is displayed.</p>
</p></li><li><span>Run any of the following commands to create an ACL rule:</span><p><ul><li><p>Create an advanced ACL rule when <i><span class="varname">protocol</span></i> is UDP.</p>
<p><a href="cmdqueryname=rule+name+permit+deny+udp+dscp+af11+af12+af13+af21+af22+af23"><b><span class="cmdname">rule </span></b></a>[ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } { <strong><span>udp</span></strong> | <i><span class="varname">17</span></i> } [ [ <strong><span>dscp</span></strong> { <i><span class="varname">dscp</span></i> | <strong><span>af11</span></strong> | <strong><span>af12</span></strong> | <strong><span>af13</span></strong> | <strong><span>af21</span></strong> | <strong><span>af22</span></strong> | <strong><span>af23</span></strong> | <strong><span>af31</span></strong> | <strong><span>af32</span></strong> | <strong><span>af33</span></strong> | <strong><span>af41</span></strong> | <strong><span>af42</span></strong> | <strong><span>af43</span></strong> | <strong><span>cs1</span></strong> | <strong><span>cs2</span></strong> | <strong><span>cs3</span></strong> | <strong><span>cs4</span></strong> | <strong><span>cs5</span></strong> | <strong><span>cs6</span></strong> | <strong><span>cs7</span></strong> | <strong><span>default</span></strong> | <strong><span>ef</span></strong> } | [ <strong><span>tos</span></strong> { <i><span class="varname">tos</span></i> | <strong><span>max-reliability</span></strong> | <strong><span>max-throughput</span></strong> | <strong><span>min-delay</span></strong> | <strong><span>min-monetary-cost</span></strong> | <strong><span>normal</span></strong> } | <strong><span>precedence</span></strong> { <i><span class="varname">precedence</span></i> | <strong><span>critical</span></strong> | <strong><span>flash</span></strong> | <strong><span>flash-override</span></strong> | <strong><span>immediate</span></strong> | <strong><span>internet</span></strong> | <strong><span>network</span></strong> | <strong><span>priority</span></strong> | <strong><span>routine</span></strong> } ] <sup>*</sup> ] | { <strong><span>destination</span></strong> { <i><span class="varname">destination-ip-address</span></i> { <i><span class="varname">destination-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">des-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>destination-pool</span></strong> <i><span class="varname">destination-pool-name</span></i> } | { <strong><span>destination-port</span></strong> { <strong><span>range</span></strong> { <i><span class="varname">port-number</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } | { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } } | <strong><span>destination-port-pool</span></strong> <i><span class="varname">destination-port-pool-name</span></i> } | [ <strong><span>fragment-type</span></strong> { <strong><span>fragment</span></strong> | <strong><span>fragment-subseq</span></strong> | <strong><span>non-fragment</span></strong> | <strong><span>non-subseq</span></strong> | <strong><span>fragment-spe-first</span></strong> } ] | { <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">src-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>source-pool</span></strong> <i><span class="varname">source-pool-name</span></i> } | { <strong><span>source-port</span></strong> { <strong><span>range</span></strong> { <i><span class="varname">port-number</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } | { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } } | <strong><span>source-port-pool</span></strong> <i><span class="varname">source-port-pool-name</span></i> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>vpn-instance-any</span></strong> ] | <strong><span>packet-length</span></strong> { { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } <i><span class="varname">begin-pktlen</span></i> | <strong><span>range</span></strong> <i><span class="varname">begin-pktlen</span></i> <i><span class="varname">end-pktlen</span></i> } | <strong><span>ttl</span></strong> { { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } <i><span class="varname">ttl-value</span></i> | <strong><span>range</span></strong> <i><span class="varname">ttl-value</span></i> <i><span class="varname">ttl-value</span></i> } ] <sup>*</sup></p>
<p><a href="cmdqueryname=rule+name+permit+deny+udp+%7B+vxlan+%7C+vxlan-gpe+%7D+vni+dscp+af11"><b><span class="cmdname">rule </span></b></a>[ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } { <strong><span>udp</span></strong> | <i><span class="varname">17</span></i> } <strong><span>{ vxlan | vxlan-gpe } </span></strong><strong><span>vni</span></strong> <i><span class="varname">vni</span></i> [ [ <strong><span>dscp</span></strong> { <i><span class="varname">dscp</span></i> | <strong><span>af11</span></strong> | <strong><span>af12</span></strong> | <strong><span>af13</span></strong> | <strong><span>af21</span></strong> | <strong><span>af22</span></strong> | <strong><span>af23</span></strong> | <strong><span>af31</span></strong> | <strong><span>af32</span></strong> | <strong><span>af33</span></strong> | <strong><span>af41</span></strong> | <strong><span>af42</span></strong> | <strong><span>af43</span></strong> | <strong><span>cs1</span></strong> | <strong><span>cs2</span></strong> | <strong><span>cs3</span></strong> | <strong><span>cs4</span></strong> | <strong><span>cs5</span></strong> | <strong><span>cs6</span></strong> | <strong><span>cs7</span></strong> | <strong><span>default</span></strong> | <strong><span>ef</span></strong> } | [ <strong><span>tos</span></strong> { <i><span class="varname">tos</span></i> | <strong><span>max-reliability</span></strong> | <strong><span>max-throughput</span></strong> | <strong><span>min-delay</span></strong> | <strong><span>min-monetary-cost</span></strong> | <strong><span>normal</span></strong> } | <strong><span>precedence</span></strong> { <i><span class="varname">precedence</span></i> | <strong><span>critical</span></strong> | <strong><span>flash</span></strong> | <strong><span>flash-override</span></strong> | <strong><span>immediate</span></strong> | <strong><span>internet</span></strong> | <strong><span>network</span></strong> | <strong><span>priority</span></strong> | <strong><span>routine</span></strong> } ] <sup>*</sup> ] | { <strong><span>destination</span></strong> { <i><span class="varname">destination-ip-address</span></i> { <i><span class="varname">destination-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">des-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>destination-pool</span></strong> <i><span class="varname">destination-pool-name</span></i> } | [ <strong><span>fragment-type</span></strong> { <strong><span>fragment</span></strong> | <strong><span>fragment-subseq</span></strong> | <strong><span>non-fragment</span></strong> | <strong><span>non-subseq</span></strong> | <strong><span>fragment-spe-first</span></strong> } ] | { <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">src-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>source-pool</span></strong> <i><span class="varname">source-pool-name</span></i> } | { <strong><span>source-port</span></strong> { <strong><span>range</span></strong> { <i><span class="varname">port-number</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } | { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } } | <strong><span>source-port-pool</span></strong> <i><span class="varname">source-port-pool-name</span></i> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>vpn-instance-any</span></strong> ] | <strong><span>packet-length</span></strong> { { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } <i><span class="varname">begin-pktlen</span></i> | <strong><span>range</span></strong> <i><span class="varname">begin-pktlen</span></i> <i><span class="varname">end-pktlen</span></i> } | <strong><span>ttl</span></strong> { { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } <i><span class="varname">ttl-value</span></i> | <strong><span>range</span></strong> <i><span class="varname">ttl-value</span></i> <i><span class="varname">ttl-value</span></i> } ] <sup>*</sup></p>
</li><li><p>Create an advanced ACL rule when <i><span class="varname">protocol</span></i> is TCP.</p>
<p><a href="cmdqueryname=rule+name+permit+deny+tcp+dscp+af11+af12+af13+af21+af22+af23"><b><span class="cmdname">rule </span></b></a>[ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } { <strong><span>tcp</span></strong> | <i><span class="varname">6</span></i> } [ [ <strong><span>dscp</span></strong> { <i><span class="varname">dscp</span></i> | <strong><span>af11</span></strong> | <strong><span>af12</span></strong> | <strong><span>af13</span></strong> | <strong><span>af21</span></strong> | <strong><span>af22</span></strong> | <strong><span>af23</span></strong> | <strong><span>af31</span></strong> | <strong><span>af32</span></strong> | <strong><span>af33</span></strong> | <strong><span>af41</span></strong> | <strong><span>af42</span></strong> | <strong><span>af43</span></strong> | <strong><span>cs1</span></strong> | <strong><span>cs2</span></strong> | <strong><span>cs3</span></strong> | <strong><span>cs4</span></strong> | <strong><span>cs5</span></strong> | <strong><span>cs6</span></strong> | <strong><span>cs7</span></strong> | <strong><span>default</span></strong> | <strong><span>ef</span></strong> } | [ <strong><span>precedence</span></strong> { <i><span class="varname">precedence</span></i> | <strong><span>critical</span></strong> | <strong><span>flash</span></strong> | <strong><span>flash-override</span></strong> | <strong><span>immediate</span></strong> | <strong><span>internet</span></strong> | <strong><span>network</span></strong> | <strong><span>priority</span></strong> | <strong><span>routine</span></strong> } | <strong><span>tos</span></strong> { <i><span class="varname">tos</span></i> | <strong><span>max-reliability</span></strong> | <strong><span>max-throughput</span></strong> | <strong><span>min-delay</span></strong> | <strong><span>min-monetary-cost</span></strong> | <strong><span>normal</span></strong> } ] <sup>*</sup> ] | { <strong><span>destination</span></strong> { <i><span class="varname">destination-ip-address</span></i> { <i><span class="varname">destination-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">des-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>destination-pool</span></strong> <i><span class="varname">destination-pool-name</span></i> } | { <strong><span>destination-port</span></strong> { <strong><span>range</span></strong> { <i><span class="varname">port-number</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } | { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } } | <strong><span>destination-port-pool</span></strong> <i><span class="varname">destination-port-pool-name</span></i> } | [ <strong><span>fragment-type</span></strong> { <strong><span>fragment</span></strong> | <strong><span>fragment-subseq</span></strong> | <strong><span>non-fragment</span></strong> | <strong><span>non-subseq</span></strong> | <strong><span>fragment-spe-first</span></strong> } ] | { <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">src-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>source-pool</span></strong> <i><span class="varname">source-pool-name</span></i> } | { <strong><span>source-port</span></strong> { <strong><span>range</span></strong> { <i><span class="varname">port-number</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } | { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } } | <strong><span>source-port-pool</span></strong> <i><span class="varname">source-port-pool-name</span></i> } | { <strong><span>syn-flag</span></strong> | <strong><span>tcp-flag</span></strong> } { <i><span class="varname">tcp-flag</span></i> [ <strong><span>mask</span></strong> <i><span class="varname">mask-value</span></i> ] | <strong><span>established</span></strong> | { <strong><span>ack</span></strong> [ <strong><span>fin</span></strong> | <strong><span>psh</span></strong> | <strong><span>rst</span></strong> | <strong><span>syn</span></strong> | <strong><span>urg</span></strong> ] <sup>*</sup> } | { <strong><span>fin</span></strong> [ <strong><span>ack</span></strong> | <strong><span>psh</span></strong> | <strong><span>rst</span></strong> | <strong><span>syn</span></strong> | <strong><span>urg</span></strong> ] <sup>*</sup> } | { <strong><span>psh</span></strong> [ <strong><span>fin</span></strong> | <strong><span>ack</span></strong> | <strong><span>rst</span></strong> | <strong><span>syn</span></strong> | <strong><span>urg</span></strong> ] <sup>*</sup> } | { <strong><span>rst</span></strong> [ <strong><span>fin</span></strong> | <strong><span>psh</span></strong> | <strong><span>ack</span></strong> | <strong><span>syn</span></strong> | <strong><span>urg</span></strong> ] <sup>*</sup> } | { <strong><span>syn</span></strong> [ <strong><span>fin</span></strong> | <strong><span>psh</span></strong> | <strong><span>rst</span></strong> | <strong><span>ack</span></strong> | <strong><span>urg</span></strong> ] <sup>*</sup> } | { <strong><span>urg</span></strong> [ <strong><span>fin</span></strong> | <strong><span>psh</span></strong> | <strong><span>rst</span></strong> | <strong><span>syn</span></strong> | <strong><span>ack</span></strong> ] <sup>*</sup> } } | [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>vpn-instance-any</span></strong> ] | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | <strong><span>packet-length</span></strong> { { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } <i><span class="varname">begin-pktlen</span></i> | <strong><span>range</span></strong> <i><span class="varname">begin-pktlen</span></i> <i><span class="varname">end-pktlen</span></i> } | <strong><span>ttl</span></strong> { { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } <i><span class="varname">ttl-value</span></i> | <strong><span>range</span></strong> <i><span class="varname">ttl-value</span></i> <i><span class="varname">ttl-value</span></i> } ] <sup>*</sup></p>
</li><li><p>Create an advanced ACL rule when <i><span class="varname">protocol</span></i> is ICMP.</p>
<p><a href="cmdqueryname=rule+name+permit+deny+icmp+dscp+af11+af12+af13+af21+af22+af23"><b><span class="cmdname">rule </span></b></a>[ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } { <strong><span>icmp</span></strong> | <i><span class="varname">1</span></i> } [ [ <strong><span>dscp</span></strong> { <i><span class="varname">dscp</span></i> | <strong><span>af11</span></strong> | <strong><span>af12</span></strong> | <strong><span>af13</span></strong> | <strong><span>af21</span></strong> | <strong><span>af22</span></strong> | <strong><span>af23</span></strong> | <strong><span>af31</span></strong> | <strong><span>af32</span></strong> | <strong><span>af33</span></strong> | <strong><span>af41</span></strong> | <strong><span>af42</span></strong> | <strong><span>af43</span></strong> | <strong><span>cs1</span></strong> | <strong><span>cs2</span></strong> | <strong><span>cs3</span></strong> | <strong><span>cs4</span></strong> | <strong><span>cs5</span></strong> | <strong><span>cs6</span></strong> | <strong><span>cs7</span></strong> | <strong><span>default</span></strong> | <strong><span>ef</span></strong> } | [ <strong><span>tos</span></strong> { <i><span class="varname">tos</span></i> | <strong><span>max-reliability</span></strong> | <strong><span>max-throughput</span></strong> | <strong><span>min-delay</span></strong> | <strong><span>min-monetary-cost</span></strong> | <strong><span>normal</span></strong> } | <strong><span>precedence</span></strong> { <i><span class="varname">precedence</span></i> | <strong><span>critical</span></strong> | <strong><span>flash</span></strong> | <strong><span>flash-override</span></strong> | <strong><span>immediate</span></strong> | <strong><span>internet</span></strong> | <strong><span>network</span></strong> | <strong><span>priority</span></strong> | <strong><span>routine</span></strong> } ] <sup>*</sup> ] | { <strong><span>destination</span></strong> { <i><span class="varname">destination-ip-address</span></i> { <i><span class="varname">destination-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">des-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>destination-pool</span></strong> <i><span class="varname">destination-pool-name</span></i> } | [ <strong><span>fragment-type</span></strong> { <strong><span>fragment</span></strong> | <strong><span>fragment-subseq</span></strong> | <strong><span>non-fragment</span></strong> | <strong><span>non-subseq</span></strong> | <strong><span>fragment-spe-first</span></strong> } ] | <strong><span>icmp-type</span></strong> { <i><span class="varname">icmp-name</span></i> | <i><span class="varname">icmp-type</span></i> [ <strong><span>to</span></strong> <i><span class="varname">icmp-type-end</span></i> ] [ <i><span class="varname">icmp-code</span></i> ] } | { <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">src-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>source-pool</span></strong> <i><span class="varname">source-pool-name</span></i> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>vpn-instance-any</span></strong> ] | <strong><span>packet-length</span></strong> { { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } <i><span class="varname">begin-pktlen</span></i> | <strong><span>range</span></strong> <i><span class="varname">begin-pktlen</span></i> <i><span class="varname">end-pktlen</span></i> } | <strong><span>ttl</span></strong> { { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } <i><span class="varname">ttl-value</span></i> | <strong><span>range</span></strong> <i><span class="varname">ttl-value</span></i> <i><span class="varname">ttl-value</span></i> } ] <sup>*</sup></p>
</li><li><p>Create an advanced ACL rule when <i><span class="varname">protocol</span></i> is any other protocol except the preceding well-known protocols.</p>
<p><a href="cmdqueryname=rule+name+permit+deny+zero+gre+igmp+ip+ipinip+ospf+dscp+af11"><b><span class="cmdname">rule </span></b></a>[ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } { <strong><span>zero</span></strong> | <i><span class="varname">protocol</span></i> | <strong><span>gre</span></strong> | <strong><span>igmp</span></strong> | <strong><span>ip</span></strong> | <strong><span>ipinip</span></strong> | <strong><span>ospf</span></strong> | <i><span class="varname">7-16</span></i> | <i><span class="varname">18-255</span></i> } [ [ <strong><span>dscp</span></strong> { <i><span class="varname">dscp</span></i> | <strong><span>af11</span></strong> | <strong><span>af12</span></strong> | <strong><span>af13</span></strong> | <strong><span>af21</span></strong> | <strong><span>af22</span></strong> | <strong><span>af23</span></strong> | <strong><span>af31</span></strong> | <strong><span>af32</span></strong> | <strong><span>af33</span></strong> | <strong><span>af41</span></strong> | <strong><span>af42</span></strong> | <strong><span>af43</span></strong> | <strong><span>cs1</span></strong> | <strong><span>cs2</span></strong> | <strong><span>cs3</span></strong> | <strong><span>cs4</span></strong> | <strong><span>cs5</span></strong> | <strong><span>cs6</span></strong> | <strong><span>cs7</span></strong> | <strong><span>default</span></strong> | <strong><span>ef</span></strong> } | [ <strong><span>tos</span></strong> { <i><span class="varname">value</span></i> | <strong><span>max-reliability</span></strong> | <strong><span>max-throughput</span></strong> | <strong><span>min-delay</span></strong> | <strong><span>min-monetary-cost</span></strong> | <strong><span>normal</span></strong> } | <strong><span>precedence</span></strong> { <i><span class="varname">precedence</span></i> | <strong><span>critical</span></strong> | <strong><span>flash</span></strong> | <strong><span>flash-override</span></strong> | <strong><span>immediate</span></strong> | <strong><span>internet</span></strong> | <strong><span>network</span></strong> | <strong><span>priority</span></strong> | <strong><span>routine</span></strong> } ] <sup>*</sup> ] | { <strong><span>destination</span></strong> { <i><span class="varname">destination-ip-address</span></i> { <i><span class="varname">destination-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">des-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>destination-pool</span></strong> <i><span class="varname">destination-pool-name</span></i> } | [ <strong><span>fragment-type</span></strong> { <strong><span>fragment</span></strong> | <strong><span>fragment-subseq</span></strong> | <strong><span>non-fragment</span></strong> | <strong><span>non-subseq</span></strong> | <strong><span>fragment-spe-first</span></strong> } ] | { <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">src-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>source-pool</span></strong> <i><span class="varname">source-pool-name</span></i> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>vpn-instance-any</span></strong> ] | <strong><span>packet-length</span></strong> { { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } <i><span class="varname">begin-pktlen</span></i> | <strong><span>range</span></strong> <i><span class="varname">begin-pktlen</span></i> <i><span class="varname">end-pktlen</span></i> } | <strong><span>ttl</span></strong> { { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } <i><span class="varname">ttl-value</span></i> | <strong><span>range</span></strong> <i><span class="varname">ttl-value</span></i> <i><span class="varname">ttl-value</span></i> } ] <sup>*</sup></p>
</li></ul>
</p><p><ul><li>Adding new rules to an ACL will not affect the existing rules.</li><li>If an existing rule is edited and the edited content conflicts with the original one, the edited content takes effect.</li></ul>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p">When a rule is configured for an advanced ACL:<ul><li><p>If no VPN instance is specified, (that is, <strong><span>vpn-instance</span></strong> is not configured), the traffic belongs to the public network.</p>
</li><li><p>If a destination IP address, destination port number, source IP address, and source port number are specified by <strong><span>destination</span></strong>, <strong><span>destination-port</span></strong>, <strong><span>source</span></strong>, and <strong><span>source-port</span></strong> respectively, the system filters only packets with the specified destination IP address, destination port number, source IP address, and source port number.</p>
</li><li><p>If all destination and source IP addresses are specified by <strong><span>any</span></strong>, the system does not check packets' destination or source IP addresses, and considers that all packets have matched the rule and directly takes an action (<strong><span>deny</span></strong> or <strong><span>permit</span></strong>) on the packets.</p>
</li><li><p>If <strong><span>time-range</span></strong> is specified, the specified time range name must exist. Otherwise, the ACL rule configuration fails.</p>
</li><li>If the wildcard mask configured for an IPv4 rule is all Fs or all 0s, services may be adversely affected. In addition, if you delete the IPv4 addresses specified in an ACL IPv4 rule by running the <strong>undo rule</strong> command, filtering will not be performed based on IPv4 addresses, potentially causing service interruptions. In this case, the service interruption risk warning function is enabled by default, indicating that the configuration may adversely affect services. If the risk warning function is disabled, run the <strong>undo configuration prevent-misoperation disable</strong> command to enable it.</li></ul>
</div>
</div></div>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> <i><span class="varname">rule-id</span></i> <a href="cmdqueryname=description"><b><span class="cmdname">description</span></b></a> <i><span class="varname">destext</span></i></span><p><p>The description for an ACL rule is configured.</p>
</p><p><div class="p">The description of an ACL rule can contain the functions of the ACL rule. Configuring a description for an ACL rule is recommended to prevent misuse of the rule in the following situations:<ul><li>A large number of ACL rules are configured, and their functions are difficult to identify.</li><li>An ACL rule is used at a long interval, and its function may be left forgotten.</li></ul>
</div>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_acl4_cfg_0054.html">Configuring an Advanced ACL
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_acl4_cfg_0103.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_acl4_cfg_0058.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>