
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring DHCPv6 PD Relay Functions">
<meta name="abstract" content="A DHCPv6 relay agent can be configured to advertise DHCPv6 PD routes, limit the maximum number of access DHCPv6 clients, and check the physical information of DHCPv6 messages.">
<meta name="description" content="A DHCPv6 relay agent can be configured to advertise DHCPv6 PD routes, limit the maximum number of access DHCPv6 clients, and check the physical information of DHCPv6 messages.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcpv6_relay_cfg_0003.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcpv6_relay_cfg_0004.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcpv6_relay_cfg_0018.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,z00485179,w00556928,w00606909,dhcpvrp">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="DHCP v6">
<meta name="featuretype" content="IP Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="DHCP v6">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="DHCP v6">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="DHCP v6">
<meta name="featuretype" content="IP Services">
<meta name="OWNER" content="z00485179,x00504385">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="x00504385">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172364787">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring DHCPv6 PD Relay Functions</title>
</head>
<body><a name="EN-US_TASK_0172364787"></a><a name="EN-US_TASK_0172364787"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring DHCPv6 PD Relay Functions</h1>
<div class="taskbody"><p>A DHCPv6 relay agent can be configured to advertise DHCPv6 PD routes, limit the maximum number of access DHCPv6 clients, and check the physical information of DHCPv6 messages.</p>
<div class="context"><a name="EN-US_TASK_0172364787__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><div class="p">In DHCPv6 (IA_PD) scenarios, a DHCPv6 relay agent generates a PD route based on the DHCPv6 PD prefix assigned by the DHCPv6 server to a DHCPv6 client. By default, this PD route applies only to the relay agent and is not advertised. Other devices cannot obtain the routes destined for the CPE and its attached user terminals. As a result, the user terminals cannot access the network. To resolve this issue, perform either of the following operations:<ul><li>Configure a summary route with a DHCPv6 PD prefix and use a routing protocol to advertise the route to other devices. This method is recommended because it does not require other devices to learn many routes, so it has little impact on the core network.</li><li>Run the <a href="cmdqueryname=dhcpv6+export+pd-route"><b><span class="cmdname">dhcpv6 export pd-route</span></b></a> command to enable a DHCPv6 relay agent to advertise a generated PD route to other devices using a routing protocol.</li></ul>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172364787__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=dhcpv6+export+pd-route"><b><span class="cmdname">dhcpv6 export pd-route</span></b></a></span><p><p>The DHCPv6 relay agent is enabled to automatically advertise DHCPv6 PD routes.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>After a device is enabled to advertise DHCPv6 PD routes, these routes can be advertised only after they are imported to the routing table of a dynamic routing protocol. Configure the device to import external routes based on the running routing protocol. For details, see <a href="dc_vrp_rip_cfg_0026.html">Configuring RIP to Import External Routes</a>, <a href="dc_vrp_route-policy_cfg_0039.html">Configuring OSPF to Import External Routes</a>, and <a href="dc_vrp_route-policy_cfg_0040.html">Configuring IS-IS to Import External Routes</a>.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=dhcpv6+relay+pd-route+auto-save"><b><span class="cmdname">dhcpv6 relay pd-route auto-save</span></b></a> <i><span class="varname">file-name</span></i></span><p><p>The DHCPv6 relay agent is enabled to automatically save PD routes.</p>
</p><p><p>PD routes are lost after a relay agent restarts, preventing users from accessing the network. You can run this command to enable the relay agent to automatically save PD routes to a file, from which the relay agent can restore the PD routes after restarting.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>An encrypted file integrity check code is added to the backup file to prevent tampering. After the device restarts, the system decrypts this code and uses it to verify the file integrity before restoring the PD routes from the backup file. If the verification is successful, the data is restored; otherwise, it is discarded and a log is recorded.</p>
<ul><li>If you manually modify the content of the backup file, run the <a href="cmdqueryname=dhcpv6+relay+database+authentication-mode+no-check"><b><span class="cmdname">dhcpv6 relay database authentication-mode no-check</span></b></a> command to set the file integrity authentication mode to no-check before the restart.</li><li>The root keys for decrypting and encrypting the file integrity check code must be the same. Otherwise, the decryption fails. The root key on each device is unique to that device. If you use a backup file generated on another device to restore data, run the <a href="cmdqueryname=dhcpv6+relay+database+authentication-mode+no-check"><b><span class="cmdname">dhcpv6 relay database authentication-mode no-check</span></b></a> command to set the file integrity authentication mode to no-check before the restart.</li><li>For compatibility with earlier versions, data can be restored based on an earlier version of a file that does not carry the file integrity check code after a restart. To forcibly check whether data is tampered with based on an earlier version of a file, run the <a href="cmdqueryname=dhcpv6+relay+database+authentication-mode+force-check"><b><span class="cmdname">dhcpv6 relay database authentication-mode force-check</span></b></a> command to set the file integrity authentication mode to force-check before a restart.</li></ul>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=dhcpv6+relay+pd-route+auto-save+maximum"><b><span class="cmdname">dhcpv6 relay pd-route auto-save maximum</span></b></a> <i><span class="varname">number</span></i></span><p><p>The maximum number of entries in the PD route user table to be written into a file is configured.</p>
</p><p></p></li><li><span>Run <a href="cmdqueryname=dhcpv6+relay+pd-route+auto-save+write-delay"><b><span class="cmdname">dhcpv6 relay pd-route auto-save write-delay</span></b></a> <i><span class="varname">delaytime</span></i></span><p><p>A delay for writing the PD route user table into a file during automatic file saving is configured.</p>
</p><p></p></li><li><span>Run <a href="cmdqueryname=set+dhcpv6+relay+pd-route+write+immediately"><b><span class="cmdname">set dhcpv6 relay pd-route write immediately</span></b></a></span><p><p>The function of immediately writing the PD route user table into a file is configured.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span></span><p><p>The view of a DHCPv6 relay interface is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=dhcpv6+relay+access-limit"><b><span class="cmdname">dhcpv6 relay access-limit</span></b></a></span><p><p>The maximum number of DHCPv6 clients that are allowed to access the DHCPv6 relay interface is configured.</p>
<p>After the maximum number is reached, new DHCPv6 clients are not allowed to access the DHCPv6 relay interface.</p>
</p><p><div class="p"><ul><li>The <a href="cmdqueryname=dhcpv6+relay+access-limit"><b><span class="cmdname">dhcpv6 relay access-limit</span></b></a> <i><span class="varname">limit-number</span></i> command configures the maximum number of access DHCPv6 clients on a DHCPv6 relay interface.</li><li>The <a href="cmdqueryname=dhcpv6+relay+access-limit"><b><span class="cmdname">dhcpv6 relay access-limit</span></b></a> <i><span class="varname">limit-number</span></i> <strong><span>vlan</span></strong> <i><span class="varname">vlan-id</span></i> [ <i><span class="varname">end-vlan-id</span></i> ] command configures the maximum number of access DHCPv6 clients in a specified VLAN on a DHCPv6 relay interface. If both <em>vlanid</em> and <em>end-vlan-id</em> are configured to specify a VLAN range, the maximum number of access DHCPv6 clients applies to all the VLANs in this range. Each relay interface supports 16 VLAN ranges. For example, if the <a href="cmdqueryname=dhcpv6+relay+access-limit+1+vlan+1+100"><b><span class="cmdname">dhcpv6 relay access-limit 1 vlan 1 100</span></b></a> command is run on GE <span>0/1/1</span>.1, one DHCPv6 client is allowed to go online through VLANs in the range 1â100.<p>If both <em>vlanid</em> and <em>end-vlan-id</em> are configured to specify a VLAN range, the maximum number of access DHCPv6 clients applies to all the VLANs in this range. Each relay interface supports 16 VLAN ranges. For example, if the <a href="cmdqueryname=dhcpv6+relay+access-limit+1+vlan+1+100"><b><span class="cmdname">dhcpv6 relay access-limit 1 vlan 1 100</span></b></a> command is run on GE <span>0/1/1</span>.1, one DHCPv6 client is allowed to go online through VLANs in the range 1â100.</p>
</li><li>The <a href="cmdqueryname=dhcpv6+relay+access-limit"><b><span class="cmdname">dhcpv6 relay access-limit</span></b></a> <i><span class="varname">limit-number</span></i> <strong><span>pevlan</span></strong> <i><span class="varname">pevlan-id</span></i> { <strong><span>cevlan</span></strong> <i><span class="varname">cevlan-id</span></i> [ <i><span class="varname">end-cevlan-id</span></i> ] | <strong><span>any</span></strong> } command configures the maximum number of DHCPv6 clients that send double-tagged packets to go online through a DHCPv6 relay interface.<p>Each relay interface supports 16 VLAN ranges. If you configure <strong><span>any</span></strong> for <strong><span>cevlan</span></strong>, the maximum number of DHCPv6 clients whose packets carry the outer VLAN ID specified by <em>pevlan-id</em> and any VLAN ID not in the CE-VLAN range is limited. This configuration is counted in the 16 VLAN ranges allowed. For example, if both the <a href="cmdqueryname=dhcpv6+relay+access-limit+1+pevlan+2+cevlan+1+100"><b><span class="cmdname">dhcpv6 relay access-limit 1 pevlan 2 cevlan 1 100</span></b></a> and <a href="cmdqueryname=dhcpv6+relay+access-limit+2+pevlan+2+cevlan+any"><b><span class="cmdname">dhcpv6 relay access-limit 2 pevlan 2 cevlan any</span></b></a> commands are run on GE <span>0/1/1</span>.1, one DHCPv6 client whose packets carry PE-VLAN 2 and any CE-VLAN ID in the range 1â100 is allowed to go online, and two DHCPv6 clients whose packets carry PE-VLAN 2 and any CE-VLAN ID in the range 101â4094 are allowed to go online</p>
</li><li>The <a href="cmdqueryname=dhcpv6+relay+access-limit"><b><span class="cmdname">dhcpv6 relay access-limit</span></b></a> <i><span class="varname">limit-number</span></i> <strong><span>vlan</span></strong> <strong><span>any</span></strong> command configures the maximum number of DHCPv6 clients that can go online through single or double VLANs that do not have such a limit configured. This configuration is not counted in the 16 VLAN ranges allowed.<p>To limit the maximum number of access DHCPv6 clients on a DHCPv6 relay interface in a specified VLAN, run this command. For example, if DHCPv6 clients send double-tagged packets to go online, each pair of VLAN tags identifies a VLAN. Run the <a href="cmdqueryname=dhcpv6+relay+access-limit+1+vlan+any"><b><span class="cmdname">dhcpv6 relay access-limit 1 vlan any</span></b></a> command to configure a DHCPv6 relay interface to allow only one client that sends double-tagged VLAN packets to go online. This configuration protects the device against packets with changing MAC addresses and DUIDs.</p>
</li></ul>
</div>
</p></li><li><span>Run <a href="cmdqueryname=dhcpv6+relay+strict-check+interface-info"><b><span class="cmdname">dhcpv6 relay strict-check interface-info</span></b></a></span><p><p>The DHCPv6 relay interface is enabled to check the physical information of DHCPv6 messages.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcpv6_relay_cfg_0003.html">Configuring DHCPv6 Relay
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcpv6_relay_cfg_0004.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcpv6_relay_cfg_0018.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>