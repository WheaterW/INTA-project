
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Using Advanced ACLs to Prevent User Hosts on Different Network Segments from Communicating">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_acl4_cfg_0074.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_acl4_cfg_0076.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,z00485179,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="ACL">
<meta name="featuretype" content="IP Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ACL">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="ACL">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="ACL">
<meta name="featuretype" content="IP Services">
<meta name="OWNER" content="z00485179,z00648985">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00485179">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0251067105">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Using Advanced ACLs to Prevent User Hosts on Different Network Segments from Communicating</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0251067105"></a><a name="EN-US_TASK_0251067105"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Using Advanced ACLs to Prevent User Hosts on Different Network Segments from Communicating</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0251067105__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0251067105__fig224411471769">Figure 1</a>, the departments of a company are connected through Device. To facilitate network management, the administrator plans IP addresses of different network segments for the R&amp;D and marketing departments. In addition, the administrator adds the two departments to different VLANs for broadcast domain isolation. The company requires that Device prevent the user hosts on different network segments from communicating to ensure information security.</p>
<div class="fignone" id="EN-US_TASK_0251067105__fig224411471769"><a name="EN-US_TASK_0251067105__fig224411471769"></a><a name="fig224411471769"></a><span class="figcap"><b>Figure 1 </b>Example for using advanced ACLs to prevent user hosts on different network segments from communicating</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent VLANIF 10 and VLANIF 20, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0251079856.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0251067105__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure an advanced ACL and ACL-based traffic classifier to filter the packets exchanged between the R&amp;D and marketing departments.</p>
</li><li><p>Configure a traffic behavior to deny the packets matching the ACL rules.</p>
</li><li>Configure and apply a traffic policy for the ACL and traffic behavior to take effect.</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0251067105__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure VLANs to which interfaces belong and allocate IP addresses to VLANIF interfaces.</span><p><p># Configure VLAN 10 and VLAN 20.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname D</strong><strong>evice</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>vlan batch 10 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Device] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>quit</strong></pre>
<p># Configure interfaces 1 and 2 on Device as trunk interfaces and add them to VLAN 10 and VLAN 20, respectively.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-GigabitEthernet<span>0/1/0</span>] <strong>port link-type trunk</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-GigabitEthernet<span>0/1/0</span>] <strong>port trunk allow-pass vlan 10</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-GigabitEthernet<span>0/2/0</span>] <strong>port link-type trunk</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-GigabitEthernet<span>0/2/0</span>] <strong>port trunk allow-pass vlan 20</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Device] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>quit</strong></pre>
</p><p><p># Create VLANIF 10 and VLANIF 20 and configure IP addresses for them.</p>
</p><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>interface vlanif 10</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-Vlanif10] <strong>ip address 10.1.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Device-Vlanif10] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-Vlanif10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>interface vlanif 20</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-Vlanif20] <strong>ip address 10.1.2.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Device-Vlanif20] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-Vlanif20] <strong>quit</strong></pre>
</p></li><li><span>Configure ACLs.</span><p><p># Create ACL 3001 and configure rules for the ACL to deny packets from the R&amp;D department to the marketing department.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>acl number 3001</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Device-acl4-advance-3001] <strong>rule deny ip source 10.1.1.0 0.0.0.255 destination 10.1.2.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-acl4-advance-3001] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-acl4-advance-3001] <strong>quit</strong></pre>
</p><p><p># Create ACL 3002 and configure rules for the ACL to deny packets from the marketing department to the R&amp;D department.</p>
</p><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>acl number 3002</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Device-acl4-advance-3002] <strong>rule deny ip source 10.1.2.0 0.0.0.255 destination 10.1.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-acl4-advance-3002] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-acl4-advance-3002] <strong>quit</strong></pre>
</p></li><li><span>Configure a traffic classifier based on the advanced ACLs.</span><p><p># Configure a traffic classifier named <strong>tc1</strong> to classify packets that match ACL 3001 and ACL 3002.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>traffic classifier tc1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Device-classifier-tc1] <strong>if-match acl 3001</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-classifier-tc1] <strong>if-match acl 3002</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-classifier-tc1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-classifier-tc1] <strong>quit</strong></pre>
</p></li><li><span>Configure a traffic behavior.</span><p><p># Configure a traffic behavior named <strong>tb1</strong> to deny packets.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>traffic behavior tb1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Device-behavior-tb1] <strong>deny</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-behavior-tb1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-behavior-tb1] <strong>quit</strong></pre>
</p></li><li><span>Configure a traffic policy.</span><p><p># Define a traffic policy, and associate the traffic classifier and traffic behavior with the traffic policy.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>traffic policy tp1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Device-trafficpolicy-tp1] <strong>classifier tc1 behavior tb1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-trafficpolicy-tp1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-trafficpolicy-tp1] <strong>quit</strong></pre>
</p></li><li><span>Apply the traffic policy in the inbound direction of interface 1 and interface 2.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-GigabitEthernet<span>0/1/0</span>] <strong>traffic-policy tp1 inbound</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>interface gigabitethernet </strong><strong><span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-GigabitEthernet<span>0/2/0</span>] <strong>traffic-policy tp1 inbound</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Check the ACL rule configuration.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>display acl 3001</strong></pre>
<pre class="screen">Advanced ACL 3001, 1 rule                                                        
Acl's step is 5                                                                  
 rule 5 deny ip source 10.1.1.0 0.0.0.255 destination 10.1.2.0 0.0.0.255</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>display acl 3002</strong></pre>
<pre class="screen">Advanced ACL 3002, 1 rule                                                        
Acl's step is 5                                                                  
 rule 5 deny ip source 10.1.2.0 0.0.0.255 destination 10.1.1.0 0.0.0.255 </pre>
<p># Check the traffic classifier configuration.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>display traffic classifier user-defined</strong></pre>
<pre class="screen">  User Defined Classifier Information:                                           
   Classifier: class1                                                            
    Operator: OR                                                                 
    Rule(s) :  -none-                                                            
   Classifier: tc1                                                               
    Operator: OR                                                                 
    Rule(s) :                                                                    
     if-match acl 3001 <span>precedence 1</span>                                                           
     if-match acl 3002 <span>precedence 2</span></pre>
<p># Check the traffic policy configuration.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong>display traffic policy user-defined tp1</strong></pre>
<pre class="screen">  User Defined Traffic Policy Information:                                       
  Policy: tp1                                                                    
   Classifier: tc1                                                               
    Operator: OR                                                                 
     Behavior: tb1                                                         
      Deny         
     Precedence: 5  </pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0251067105__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>Device configuration file</p>
<pre class="screen"># 
 sysname Device 
# 
vlan batch 10 20  
# 
acl number 3001                                                                  
 rule 5 deny ip source 10.1.1.0 0.0.0.255 destination 10.1.2.0 0.0.0.255         
acl number 3002                                                                  
 rule 5 deny ip source 10.1.2.0 0.0.0.255 destination 10.1.1.0 0.0.0.255 
# 
traffic classifier tc1 operator or    
 if-match acl 3001                                                               
 if-match acl 3002    
# 
traffic behavior tb1 
 deny 
# 
traffic policy tp1 
 classifier tc1 behavior tb1 precedence 5 
# 
interface Vlanif10 
 ip address 10.1.1.1 255.255.255.0 
# 
interface Vlanif20 
 ip address 10.1.2.1 255.255.255.0 
# 
interface GigabitEthernet<span>0/1/0</span> 
 port link-type trunk                                                            
 port trunk allow-pass vlan 10  
 traffic-policy tp1 inbound 
# 
interface GigabitEthernet<span>0/2/0</span> 
 port link-type trunk                                                            
 port trunk allow-pass vlan 20  
 traffic-policy tp1 inbound 
# 
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_acl4_cfg_0074.html">Configuration Examples for ACLs
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_acl4_cfg_0076.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>