
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="topic">
<meta name="DC.Title" content="Configuration Precautions for DHCP">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcp_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcp_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcp_relay_cfg_0003.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Publisher" content="20240229">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="DHCP">
<meta name="featuretype" content="IP Services">
<meta name="featurename" content="DHCP">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TOPIC_0000001174868332">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuration Precautions for DHCP</title>
</head>
<body><a name="EN-US_TOPIC_0000001174868332"></a><a name="EN-US_TOPIC_0000001174868332"></a>

<div class="articleBoxWithoutHead">

	<h1 class="topicTitle-h1">Configuration Precautions for DHCP</h1>

	<div>
		
		

		<div class="section"><h4 class="sectiontitle">Feature Requirements</h4>
			
		
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Feature requirements</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="60%" id="mcps1.3.1.2.2.4.1.1" liSelected="liSelected"><p>Feature Requirements</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="15%" id="mcps1.3.1.2.2.4.1.2" liSelected="liSelected"><p>Series</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="25%" id="mcps1.3.1.2.2.4.1.3" liSelected="liSelected"><p>Models</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.1.2.2.4.1.1 "><p>When a DHCPv4 client goes online with Option 82 information, if the path of the DHCPv4 relay return packet is different from that of the DHCPv4 request packet, you need to configure the backup DHCPv4 relay agent to parse Option 82 information to ignore the host name and forward the packet. In this case, the response packet does not contain Option 82 information in the DHCPv4 request packet. If a client needs to parse the Option 82 field in a DHCP Reply packet, the client may fail to go online. </p>
<p>Use the following methods to ensure that the incoming and outgoing paths of packets are consistent:</p>
<p>1. Use Option 82's sub-option 5 to specify the network segment for address allocation, and set a different IP address for the giaddr field. The server must support sub-option 5.</p>
<p>2. Set a different source IP address for Option 82's sub-option 9. The route between two relay agents must be reachable, and the agents must be Huawei devices.</p>
<p>3. Configure a different source IP address. The server must use the source IP address of a request message as the destination IP address of a reply message. </p>
<p>4. Set different IP addresses of the same network segment for the giaddr field on the master and backup relay agents. The server must reserve two IP addresses in the address pool as gateway IP addresses for the master and backup relay agents.</p>
</td>
<td class="cellrowborder" valign="top" width="15%" headers="mcps1.3.1.2.2.4.1.2 "><p>NE40E-M2</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.3.1.2.2.4.1.3 "><p>NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.1.2.2.4.1.1 "><p>When the UNR generated after a Layer 3 web user goes online from a BRAS conflicts with the ARP Vlink route, no Vlink route is generated.</p>
</td>
<td class="cellrowborder" valign="top" width="15%" headers="mcps1.3.1.2.2.4.1.2 "><p>NE40E-M2</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.3.1.2.2.4.1.3 "><p>NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.1.2.2.4.1.1 "><p>If the path of the DHCPv4 relay return packet is different from that of the DHCPv4 request packet, the relay service interface does not support address unnumbered. If the path for DHCPv4 relay return packets is different from that for DHCPv4 request packets and the address unnumbered function is enabled, the backup relay agent cannot forward packets after the master relay agent fails. As a result, service traffic is interrupted. </p>
<p>It is recommended that static routes be configured for the IP addresses that users apply for.</p>
</td>
<td class="cellrowborder" valign="top" width="15%" headers="mcps1.3.1.2.2.4.1.2 "><p>NE40E-M2</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.3.1.2.2.4.1.3 "><p>NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.1.2.2.4.1.1 "><p>One-to-many mapping between one MAC address and multiple sessions cannot be configured if an online user exists on the DHCP server. In addition, this function does not support multiple VRs. </p>
<p>Log out the online user for the one-to-many mapping between one MAC address and multiple sessions to take effect.</p>
</td>
<td class="cellrowborder" valign="top" width="15%" headers="mcps1.3.1.2.2.4.1.2 "><p>NE40E-M2</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.3.1.2.2.4.1.3 "><p>NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.1.2.2.4.1.1 "><p>When the path of the DHCPv4 relay return packet is different from that of the DHCPv4 request packet and the Sub5 suboption of the Option 82 field is used to ensure consistent incoming and outgoing paths, the server must allocate addresses based on the Sub5 suboption of the Option 82 field. Otherwise, users cannot go online. </p>
<p>Use the following methods:</p>
<p>1. Use Option 82 to ignore the host name matching check. The original request messages received by a relay agent cannot contain Option 82. </p>
<p>2. Set a different source IP address for Option 82's sub-option 9. The route between two relay agents must be reachable, and the agents must be Huawei devices.</p>
<p>3. Configure a different source IP address. The server must use the source IP address of a request message as the destination IP address of a reply message. </p>
<p>4. Set different IP addresses of the same network segment for the giaddr field on the master and backup relay agents. The server must reserve two IP addresses in the address pool as gateway IP addresses for the master and backup relay agents.</p>
</td>
<td class="cellrowborder" valign="top" width="15%" headers="mcps1.3.1.2.2.4.1.2 "><p>NE40E-M2</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.3.1.2.2.4.1.3 "><p>NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.1.2.2.4.1.1 "><p>When the BAS gateway address is the same as the network-side DHCP relay gateway address, users with the same MAC address are not allowed to exist. </p>
<p>You are advised to plan the network properly.</p>
</td>
<td class="cellrowborder" valign="top" width="15%" headers="mcps1.3.1.2.2.4.1.2 "><p>NE40E-M2</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.3.1.2.2.4.1.3 "><p>NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.1.2.2.4.1.1 "><p>When the return packet path of the DHCPv4 relay agent is different from the request packet path, the server needs to reserve two IP addresses as gateway addresses for the active and standby relay agents in the address pool to ensure that the forward and return paths are the same. Otherwise, users cannot go online.</p>
<p>The following solutions can be used:</p>
<p>1. If Option 82 sub5 is used to specify the allocated network segment and different gateway addresses are specified, the server must support Option 82 sub5.</p>
<p>2. Option 82 is used to ignore the host name, but the original request packet received by the relay agent cannot contain Option 82.</p>
<p>3. If Option 82 sub9 is used to carry different source IP addresses, routes between the active and standby devices must be reachable, and the two relay agents must be Huawei devices.</p>
<p>4. If different source IP addresses are configured, the server must use the source IP address of the request packet as the destination IP address of the response packet.</p>
</td>
<td class="cellrowborder" valign="top" width="15%" headers="mcps1.3.1.2.2.4.1.2 "><p>NE40E-M2</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.3.1.2.2.4.1.3 "><p>NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.1.2.2.4.1.1 "><p>When an interface functions as a DHCP server, you need to run the dhcp server enable command on the interface to enable the DHCP server function. Otherwise, users cannot go online.</p>
<p>1. When multiple interfaces are used as DHCP servers, you are advised to run the dhcp server enable command on the interfaces to enable the DHCP server function for security purposes. If the security requirement is not high, run the dhcp server request-packet all-interface enable command in the system view to enable the DHCP server function on all interfaces.</p>
<p>2. If the DHCP server function is disabled, the DHCP server does not process DHCP request messages.</p>
</td>
<td class="cellrowborder" valign="top" width="15%" headers="mcps1.3.1.2.2.4.1.2 "><p>NE40E-M2</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.3.1.2.2.4.1.3 "><p>NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.1.2.2.4.1.1 "><p>When the device is configured to send FORCERENEW packets to users in an address pool and reclaim IP addresses if the users do not respond, the device may incorrectly reclaim IP addresses. For example, if the network link connected to a user is faulty or the network is congested, the FORCERENEW packet fails to be sent or is lost, or the RENEW packet replied by the user is lost. When the DHCP server incorrectly reclaims an IP address, if the user is still using the IP address, a conflict occurs when other users apply for the IP address.</p>
</td>
<td class="cellrowborder" valign="top" width="15%" headers="mcps1.3.1.2.2.4.1.2 "><p>NE40E-M2</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.3.1.2.2.4.1.3 "><p>NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.1.2.2.4.1.1 "><p>If the path of DHCPv4 relay return packets is different from that of DHCPv4 request packets and the Sub9 suboption of Option 82 is used to ensure consistent incoming and outgoing paths, both the master and backup DHCPv4 relay agents must support the configuration of the Sub9 suboption of Option 82. Otherwise, users cannot go online. </p>
<p>Use the following methods:</p>
<p>1. Use Option 82's sub-option 5 to specify the network segment for address allocation, and set a different IP address for the giaddr field. The server must support sub-option 5. </p>
<p>2. Use Option 82 to ignore the host name matching check. The original request messages received by a relay agent cannot contain Option 82. </p>
<p>3. Configure a different source IP address. The server must use the source IP address of a request message as the destination IP address of a reply message. </p>
<p>4. Set different IP addresses of the same network segment for the giaddr field on the master and backup relay agents. The server must reserve two IP addresses in the address pool as gateway IP addresses for the master and backup relay agents.</p>
</td>
<td class="cellrowborder" valign="top" width="15%" headers="mcps1.3.1.2.2.4.1.2 "><p>NE40E-M2</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.3.1.2.2.4.1.3 "><p>NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.1.2.2.4.1.1 "><p>In a DHCPv6 relay dual-device hot backup scenario, the DHCPv6 relay service interface must be the same as the bound VRRP interface. The backup VRRP device does not process VRRP packets. If the DHCPv6 relay service interface is different from the bound VRRP interface, DHCPv6 relay services cannot go online after the interface connecting DHCP to the master VRRP device goes Down.</p>
</td>
<td class="cellrowborder" valign="top" width="15%" headers="mcps1.3.1.2.2.4.1.2 "><p>NE40E-M2</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.3.1.2.2.4.1.3 "><p>NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.1.2.2.4.1.1 "><p>After the DHCP server is enabled to assign IP addresses based on Option 60, Option 60 changes are not supported during user migration. If Option 60 changes, users may fail to go online.</p>
</td>
<td class="cellrowborder" valign="top" width="15%" headers="mcps1.3.1.2.2.4.1.2 "><p>NE40E-M2</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.3.1.2.2.4.1.3 "><p>NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.1.2.2.4.1.1 "><p>After a DHCP server is enabled to allocate IP addresses based on Option 60, a user fails to be migrated from address pool 1 to address pool 2 if the two address pools assign the same IP address to the user.</p>
<p>Users go offline from address pool 1 and then go online from address pool 2, or the address segments assigned to address pool 1 and address pool 2 are different.</p>
</td>
<td class="cellrowborder" valign="top" width="15%" headers="mcps1.3.1.2.2.4.1.2 "><p>NE40E-M2</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.3.1.2.2.4.1.3 "><p>NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.1.2.2.4.1.1 "><p>The FORCERENEW packet sent by the DHCP server does not support authentication. The interconnected DHCP client is required not to authenticate the FORCERENEW packet. If the DHCP client authenticates the FORCERENEW packet, the packet is discarded.</p>
</td>
<td class="cellrowborder" valign="top" width="15%" headers="mcps1.3.1.2.2.4.1.2 "><p>NE40E-M2</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.3.1.2.2.4.1.3 "><p>NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.1.2.2.4.1.1 "><p>When the return packet path of the DHCPv4 relay agent is different from the request packet path and the source IP address of the DHCP packet is specified by the relay agent to ensure consistent incoming and outgoing paths, the server must use the source IP address of the request packet as the destination IP address of the response packet. Otherwise, users cannot go online. </p>
<p>Use the following methods:</p>
<p>1. Use Option 82's sub-option 5 to specify the network segment for address allocation, and set a different IP address for the giaddr field. The server must support sub-option 5. </p>
<p>2. Use Option 82 to ignore the host name matching check. The original request messages received by a relay agent cannot contain Option 82. </p>
<p>3. Set a different source IP address for Option 82's sub-option 9. The route between two relay agents must be reachable, and the agents must be Huawei devices.</p>
<p>4. Set different IP addresses of the same network segment for the giaddr field on the master and backup relay agents. The server must reserve two IP addresses in the address pool as gateway IP addresses for the master and backup relay agents.</p>
</td>
<td class="cellrowborder" valign="top" width="15%" headers="mcps1.3.1.2.2.4.1.2 "><p>NE40E-M2</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.3.1.2.2.4.1.3 "><p>NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.1.2.2.4.1.1 "><p>The IPsec authentication protection function of DHCP does not support the AH security protocol.</p>
</td>
<td class="cellrowborder" valign="top" width="15%" headers="mcps1.3.1.2.2.4.1.2 "><p>NE40E-M2</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.3.1.2.2.4.1.3 "><p>NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

	</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcp_cfg_0000.html">DHCP Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcp_cfg_0001.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcp_relay_cfg_0003.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>