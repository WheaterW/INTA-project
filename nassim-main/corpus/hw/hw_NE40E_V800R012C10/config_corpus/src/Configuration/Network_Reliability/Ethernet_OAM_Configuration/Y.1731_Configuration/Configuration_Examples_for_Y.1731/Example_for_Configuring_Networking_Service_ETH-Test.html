
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Networking Service ETH-Test">
<meta name="abstract" content="Y.1731 ETH-Test functions can be used in VLL, VPLS, and VLAN scenarios. This section provides an example for configuring the ETH-Test function for a VLL network.">
<meta name="description" content="Y.1731 ETH-Test functions can be used in VLL, VPLS, and VLAN scenarios. This section provides an example for configuring the ETH-Test function for a VLL network.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011531.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011548.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_y1731_cfg_0081.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,c00376497,z00603461,w00800033,jwx1168690,w00556928,w00437000,eoam-vrp,w00606909,m00390128,l00455378,wwx1270540">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="OWNER" content="z00545680">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="p00915595">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172362188">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Networking Service ETH-Test</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172362188"></a><a name="EN-US_TASK_0172362188"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring <span>Networking Service </span>ETH-Test</h1>
<div class="taskbody"><p>Y.1731 ETH-Test functions can be used in VLL, VPLS, and VLAN scenarios. This section provides an example for configuring the ETH-Test function for a VLL network.</p>
<div class="context"><a name="EN-US_TASK_0172362188__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0172362188__fig_dc_vrp_y1731_cfg_007601">Figure 1</a>, MEP1 is configured on an AC interface of PE1, and MEP2 is configured on an AC interface of PE2. MEP1 initiates an ETH-Test and sends test packets with a specified size and code type at a specified rate and interval. Then check the number of packets MEP1 sends and the number of packets MEP2 receives. If MEP1 sends more packets than MEP2 receives, some packets have been dropped. Then MEP1 is configured to use the bisection method to continue the test and send test packets at a lower rate. In addition, check for bit errors on MEP2 that receives test packets. The bisection method is used to send test packets at different rates between the upper and lower rate thresholds. The test process repeats until a maximum bandwidth is found when no packets are dropped in a test.</p>
<div class="fignone" id="EN-US_TASK_0172362188__fig_dc_vrp_y1731_cfg_007601"><a name="EN-US_TASK_0172362188__fig_dc_vrp_y1731_cfg_007601"></a><a name="fig_dc_vrp_y1731_cfg_007601"></a><span class="figcap"><b>Figure 1 </b>ETH-Test function for a VLL network</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interface 1 in this example represents GE <span>0/1/1</span>.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_y1731_cfg_007601.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362188__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>L2VC ID used to establish a VLL between PEs</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>VLAN ID used in VLAN networking</li><li>VSI name used in VSI networking</li></ul>
</div></div>
</li><li><p>MD name, MA name, and MEP ID on each PE</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172362188__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure a VLL connection.</span><p><p>Configure a VLL connection between PE1 and PE2. For configuration details, see the section "VLL Configuration" in <i><cite>Configuration Guide - VPN</cite></i>.</p>
<p>By default, the interface type is tagged. You can successfully configure the <strong>raw</strong> parameter in the <a href="cmdqueryname=map+mpls+l2vc"><b><span class="cmdname">map mpls l2vc</span></b></a> command to bind the MA to the L2VC only after you configure the <strong>raw</strong> parameter in the <a href="cmdqueryname=mpls+l2vc"><b><span class="cmdname">mpls l2vc</span></b></a> command to create a dynamic VLL connection.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>When VLAN networking is used, configure a VLAN between PE1 and PE2. For configuration details, see the section "VLAN Configuration" in <i><cite>Configuration Guide - LAN Access and MAN Access</cite></i>.</p>
</li><li><p>Configure a VPLS connection between PE1 and PE2. For configuration details, see the section "VPLS Configuration" in <i><cite>Configuration Guide - VPN</cite></i>.</p>
</li></ul>
</div></div>
</p></li><li><span>Configure basic Ethernet CFM functions.</span><p><p>Configure basic Ethernet CFM functions on each PE. Create an MD named <strong>md1</strong> and an MA named <strong>ma1</strong> and bind the MA to the VLL.</p>
<p># Configure PE1.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>cfm enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>cfm md md1 level 3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>ma ma1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>map mpls l2vc 201 tagged</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p"><ul><li><p>In the VLAN, associate the MA with the VLAN.</p>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>map vlan 2</strong></pre>
</li><li><div class="p">On the VPLS network, associate the MA with the VSI.<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>map vsi ldp1</strong></pre>
</div>
</li></ul>
</div>
</div></div>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>mep mep-id 1 interface gigabitEthernet<span>0/1/1</span>.1 inward</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>mep ccm-send mep-id 1 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>remote-mep mep-id 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>remote-mep ccm-receive mep-id 2 enable</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>cfm enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>cfm md md1 level 3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1] <strong>ma ma1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>map mpls l2vc 201 tagged</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p"><ul><li><p>In the VLAN, associate the MA with the VLAN.</p>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>map vlan 2</strong></pre>
</li><li><div class="p">On the VPLS network, associate the MA with the VSI.<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>map vsi ldp1</strong></pre>
</div>
</li></ul>
</div>
</div></div>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>mep mep-id 2 interface gigabitEthernet<span>0/1/1</span>.1 inward</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>mep ccm-send mep-id 2 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>remote-mep mep-id 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>remote-mep ccm-receive mep-id 1 enable</strong></pre>
</p></li><li><span>Configure the ETH-Test function.</span><p><p>The receive end cannot detect the initiator's sending round. Therefore, you must clear statistics on the receive end before initiating an Eth-Test test. If the statistics are not cleared, disorder statistics appear.</p>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>eth-test enable mep 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>commit</strong> </pre>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>PE2-md-md1-ma-ma1] <strong>reset y1731 statistic-type eth-test md md1 ma ma1 mep 2</strong></pre>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>PE2-md-md1-ma-ma1] <strong>commit</strong></pre>
<p># Configure PE1.</p>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>eth-test enable mep 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>commit</strong></pre>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>PE1-md-md1-ma-ma1] <strong>eth-test start mep 1 remote-mep 2 rate 10</strong></pre>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>PE1-md-md1-ma-ma1] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>After completing the configuration, run the <a href="cmdqueryname=display+y1731+eth-test"><b><span class="cmdname">display y1731 eth-test</span></b></a> command on PE1 to view test configurations.</p>
<pre class="screen">&lt;PE1&gt;<strong>display y1731 eth-test md md1 ma ma1 mep 1</strong>
The total number of Eth-Test is : 1                        
--------------------------------------------------
 MD Name            : md1
 MA Name            : ma1
 MEP ID             : 1
 Sending            : Yes
 Remote MEP ID      : 2
 Mac                : --
 Interval           : 10 ms 
 Timeout            : 30 s
 Pattern            : zero-no-crc
 8021p              : 3
 Packet Size        : 64 bytes
 Out of Service     : Disabled
 Lck Level          : --
 Send Count         : 0
</pre>
<p>Run the <strong>display y1731 statistic-type eth-test</strong> command on PE2 to view test results.</p>
<pre class="screen">&lt;PE2&gt;<strong>display y1731 statistic-type eth-test md md1 ma ma1 mep 2</strong>
SrcMAC                       RcvPackets            ErrBitPackets            ErrSeqPackets            ErrCrcPackets
00e0-fc12-7890                  9208312            0                        0                        0</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172362188__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#                                                                               
sysname PE1                                                                      
#                                                                               
cfm enable                                                                      
#                                                                             
mpls lsr-id 2.2.2.2   
#                                                          
mpls                                                                            
#                                                                               
mpls l2vpn                                                                      
#                                                                               
mpls ldp                                                                        
#            
mpls ldp remote-peer 1.1.1.1                                                    
 remote-ip 1.1.1.1                                                              
#
interface gigabitEthernet<span>0/1/1</span>.1
 vlan-type dot1q 3
 mpls l2vc 1.1.1.1 201
#
interface gigabitEthernet<span>0/1/2</span>
 ip address 192.168.1.2 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack0
 ip address 2.2.2.2 255.255.255.0
#
ospf 1
 area 0.0.0.0
  network 2.2.2.2 0.0.0.0
  network 192.168.1.0 0.0.0.255   
#                                                                               
cfm md md1 level 3                                                                      
 ma ma1                                                                         
  map mpls l2vc 201 tagged                                                      
  mep mep-id 1 interface GigabitEthernet<span>0/1/1</span>.1 inward                         
  mep ccm-send mep-id 1 enable                                                  
  remote-mep mep-id 2                                                           
  remote-mep ccm-receive mep-id 2 enable                                        
  eth-test enable mep 1
  eth-test start mep 1 remote-mep 2 rate 10                                                         
#                                 </pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#                                                                               
sysname PE2                                                                      
#                                                                               
cfm enable                                                                      
#                                                                             
mpls lsr-id 1.1.1.1  
#                                                           
mpls                                                                            
#                                                                               
mpls l2vpn                                                                      
#                                                                               
mpls ldp                                                                        
#                                                                               
mpls ldp remote-peer 2.2.2.2                                                    
 remote-ip 2.2.2.2                                                              
#
interface gigabitEthernet<span>0/1/1</span>.1
 vlan-type dot1q 3
 mpls l2vc 2.2.2.2 201
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 192.168.1.1 255.255.255.0
 mpls
 mpls ldp
#                                                                               
interface LoopBack0
 ip address 1.1.1.1 255.255.255.0
#
ospf 1
 area 0.0.0.0
  network 1.1.1.1 0.0.0.0
  network 192.168.1.0 0.0.0.255
cfm md md1 level 3                                                                      
 ma ma1                                                                         
  map mpls l2vc 201 tagged                                                      
  mep mep-id 2 interface GigabitEthernet<span>0/1/1</span>.1 inward                         
  mep ccm-send mep-id 2 enable                                                  
  remote-mep mep-id 1                                                           
  remote-mep ccm-receive mep-id 1 enable                                        
  eth-test enable mep 2
#                                 </pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011531.html">Configuration Examples for Y.1731
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011548.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_y1731_cfg_0081.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>