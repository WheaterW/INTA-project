
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Single-ended Packet Loss Measurement in VPLS Networking">
<meta name="abstract" content="This section provides an example showing how to configure single-ended packet loss measurement in VPLS networking.">
<meta name="description" content="This section provides an example showing how to configure single-ended packet loss measurement in VPLS networking.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011531.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_y1731_cfg_0073.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011537.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,c00376497,z00603461,w00800033,jwx1168690,w00556928,w00437000,eoam-vrp,w00606909,m00390128,l00455378,wwx1270540">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="OWNER" content="z00545680">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00545680">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172362161">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Single-ended Packet Loss Measurement in VPLS Networking</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172362161"></a><a name="EN-US_TASK_0172362161"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Single-ended Packet Loss Measurement in VPLS Networking</h1>
<div class="taskbody"><p>This section provides an example showing how to configure single-ended packet loss measurement in VPLS networking.</p>
<div class="context"><a name="EN-US_TASK_0172362161__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0172362161__fig_dc_vrp_cfg_01153601">Figure 1</a>, CFM is configured between each CE and PE and between PEs. CCMs are not used to monitor link connectivity, preventing them from using a lot of network bandwidth resources. To provide higher-quality voice services, carriers hope to monitor packet loss performance on mobile bearer links in real time so that they can promptly respond to video service quality deterioration.</p>
<div class="fignone" id="EN-US_TASK_0172362161__fig_dc_vrp_cfg_01153601"><a name="EN-US_TASK_0172362161__fig_dc_vrp_cfg_01153601"></a><a name="fig_dc_vrp_cfg_01153601"></a><span class="figcap"><b>Figure 1 </b>Configuring Y.1731 functions in VPLS networking</span><div class="note" id="EN-US_TASK_0172362161__note1993384276214024"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172362161__p2064633532214024">In this example, interface1 and interface2 represent GE <span>0/1/1</span> and GE <span>0/1/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0172362161__image293129284214024" src="images/fig_dc_vrp_cfg_01153601.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362161__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><div class="p">The configuration roadmap is as follows:<ol><li><p>Configure single-ended packet loss measurement for the <span>PW</span> between the PEs to collect packet loss statistics.</p>
</li><li><p>Configure single-ended packet loss measurement for the AC between each PE and its attached CE to collect packet loss statistics.</p>
</li></ol>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362161__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Configure the name of a VSI and the IP address of the interface of a VPLS.</p>
</li><li><p>Configure the names of the MD and MA between PE1 and PE2 and between CE1 and PE1.</p>
</li><li><p>Configure a VLAN ID on CE interfaces for collecting AC-side packet statistics.</p>
</li><li><p>Configure the interval at which LM messages are sent and the number of times when LM messages are sent.</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172362161__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure on-demand single-ended packet loss measurement for <span>a PW</span> between the PEs.</span><p><ol type="a"><li id="EN-US_TASK_0172362161__li_01"><p id="EN-US_TASK_0172362161__p1098337076214024"><a name="EN-US_TASK_0172362161__li_01"></a><a name="li_01"></a>Configure a VPLS connection.</p>
<p id="EN-US_TASK_0172362161__p1315704561214024">Configure a VPLS connection between PE1 and PE2. For detailed configurations, see the chapter "VPLS Configuration" in the <em id="EN-US_TASK_0172362161__i174180351214308"><span class="keyword" id="EN-US_TASK_0172362161__keyword1563109857214024">HUAWEI NE40E-M2 series</span><span class="keyword" id="EN-US_TASK_0172362161__keyword1019912848214024">Universal Service Router</span> Configuration Guide - VPN</em> or configuration files in this example.</p>
<p id="EN-US_TASK_0172362161__p267828392214024">After the configuration is complete, run the <a href="cmdqueryname=display+vsi++name"><b><span class="cmdname" id="EN-US_TASK_0172362161__cmdname613366170214024">display vsi  name</span></b></a> <i><span class="varname" id="EN-US_TASK_0172362161__varname1691961182214024">vsi-name</span></i> <strong><span id="EN-US_TASK_0172362161__cmdparmname143020808214024">verbose</span></strong> command on each PE to view information about the related VSI and PW.</p>
<pre class="screen" id="EN-US_TASK_0172362161__screen1523497883214024">&lt;PE1&gt;<strong id="EN-US_TASK_0172362161__b49490279214024"> display vsi  name ldp1 verbose</strong>                                          
 ***VSI Name               : ldp1
    Administrator VSI      : no
    Isolate Spoken         : disable
    VSI Index              : 1
    PW Signaling           : ldp
    Member Discovery Style : static
    Bridge-domain Mode     : disable
    PW MAC Learn Style     : unqualify
    Encapsulation Type     : vlan
    MTU                    : 1500
    Diffserv Mode          : uniform
    Service Class          : --
    Color                  : --
    DomainId               : 255
    Domain Name            :
    Ignore AcState         : disable
    P2P VSI                : disable
    Create Time            : 0 days, 0 hours, 10 minutes, 10 seconds
    VSI State              : up

    VSI ID                 : 1
   *Peer Router ID         : 1.1.1.1
    primary or secondary   : primary
    ignore-standby-state   : no
    VC Label               : 4187
    Peer Type              : dynamic
    Session                : up
    Tunnel ID              : 0x0000000001004c4b42 
    Broadcast Tunnel ID    : --
    Broad BackupTunnel ID  : -- 
    CKey                   : 1
    NKey                   : 2281701546
    Stp Enable             : 0
    PwIndex                : 1
    Control Word           : enable
 
    Interface Name         : GigabitEthernet<span>0/1/1</span>.1
    State                  : up
    Access Port            : false
    Last Up Time           : 2013/02/21 08:44:46
    Total Up Time          : 0 days, 0 hours, 0 minutes, 14 seconds

  **PW Information:

   *Peer Ip Address        : 1.1.1.1
    PW State               : up
    Local VC Label         : 4187
    Remote VC Label        : 4187
    Remote Control Word    : enable
    PW Type                : label
    Tunnel ID              : 0x0000000001004c4b42 
    Broadcast Tunnel ID    : --
    Broad BackupTunnel ID  : --
    Ckey                   : 1
    Nkey                   : 2281701546
    Main PW Token          : 0x0
    Slave PW Token         : 0x0
    Tnl Type               : ldp
    OutInterface           : LDP LSP
    Backup OutInterface    : --
    Stp Enable             : 0
    PW Last Up Time        : 2013/02/21 08:44:46
    PW Total Up Time       : 0 days, 0 hours, 0 minutes, 14 seconds</pre>
</li><li id="EN-US_TASK_0172362161__li_02"><p id="EN-US_TASK_0172362161__p1523662289214024"><a name="EN-US_TASK_0172362161__li_02"></a><a name="li_02"></a>Configure basic Ethernet CFM functions and specify the MEP type as inward.</p>
<p id="EN-US_TASK_0172362161__p799322912214024">Configure basic Ethernet CFM functions on each PE. Specify the Ethernet CFM protocol as IEEE Standard 802.1ag-2007. Create an MD named <strong id="EN-US_TASK_0172362161__b821757308214308">md1</strong> and an MA named <strong id="EN-US_TASK_0172362161__b1025344319214308">ma1</strong>, and bind the MA to the VSI.</p>
<p id="EN-US_TASK_0172362161__p1839609039214024"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172362161__screen82110423214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword912508246214024"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172362161__b732807802214024">cfm enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen878611399214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword132785151214024">*</span>PE1] <strong id="EN-US_TASK_0172362161__b130559144214024">cfm md md1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen50734589214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword1330178456214024">*</span>PE1-md-md1] <strong id="EN-US_TASK_0172362161__b2014193587214024">ma ma1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen700359020214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword852369608214024">*</span>PE1-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362161__b1968765028214024">map vsi ldp1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen336593913214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword1757658091214024">*</span>PE1-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362161__b1292956980214024">mep mep-id 1 interface gigabitethernet<span>0/1/1</span>.1 inward</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen962812657214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword640003784214024">*</span>PE1-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362161__b323446962214024">mep ccm-send mep-id 1 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen2068255979214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword1699816819214024">*</span>PE1-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362161__b1331037763214024">remote-mep mep-id 2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen601398326214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword1277844739214024">*</span>PE1-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362161__b1199244121214024">remote-mep ccm-receive mep-id 2 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen257774536214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword655134940214024">*</span>PE1-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362161__b921055524813"> test-id 1 mep 1 remote-mep 2</strong> <strong id="EN-US_TASK_0172362161__b348942517487">peer-ip 1.1.1.1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen1414463798214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword853629669214024">*</span>PE1-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362161__b1188939555214024">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen645577282214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword1610091089214024">*</span>PE1-md-md1] <strong id="EN-US_TASK_0172362161__b1194176621214024">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen813080532214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword1635413810214024">*</span>PE1] <strong id="EN-US_TASK_0172362161__b571635085214024">commit</strong></pre>
<p id="EN-US_TASK_0172362161__p1515974907214024"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172362161__screen316371901214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword189383929214024"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172362161__b280294800214024">cfm enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen43016574214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword2142022238214024">*</span>PE2] <strong id="EN-US_TASK_0172362161__b730133313214024">cfm md md1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen89468650214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword706855174214024">*</span>PE2-md-md1] <strong id="EN-US_TASK_0172362161__b269536924214024">ma ma1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen1730598446214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword1612418177214024">*</span>PE2-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362161__b1212074833214024">map vsi ldp1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen1281656043214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword121424660214024">*</span>PE2-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362161__b434727983214024">mep mep-id 2 interface gigabitethernet<span>0/1/1</span>.1 inward</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen1618698052214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword927137181214024">*</span>PE2-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362161__b201928691214024">mep ccm-send mep-id 2 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen809139368214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword1645572538214024">*</span>PE2-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362161__b1884752725214024">remote-mep mep-id 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen1381487537214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword2070884055214024">*</span>PE2-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362161__b205409019214024">remote-mep ccm-receive mep-id 1 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen51362675214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword1422957671214024">*</span>PE2-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362161__b1427413591214024">test-id 1 mep 2 peer-ip 2.2.2.2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen1128790737214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword1764103021214024">*</span>PE2-md-md1-ma-ma1] <strong id="EN-US_TASK_0172362161__b942783006214024">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen661866117214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword165541098214024">*</span>PE2-md-md1] <strong id="EN-US_TASK_0172362161__b1884870279214024">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172362161__screen937274922214024">[<span class="keyword" id="EN-US_TASK_0172362161__keyword261861288214024">*</span>PE2] <strong id="EN-US_TASK_0172362161__b1339687574214024">commit</strong></pre>
</li><li><p>Configure the LMM reception function on PE2.</p>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-md-md1-ma-ma1] <strong>loss-measure single-ended receive test-id 1</strong></pre>
</li><li><p>Enable on-demand single-ended packet loss measurement on the VPLS network.</p>
<p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-md-md1-ma-ma1] <strong>loss-measure single-ended send test-id 1 interval 1000 count 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>quit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>When single-ended packet loss measurement is enabled on PE1, related configuration commands are not displayed in the configuration file.</p>
</div></div>
</li><li><p>Verify the configuration.</p>
<p>Run the <a href="cmdqueryname=display+y1731+statistic-type"><b><span class="cmdname">display y1731 statistic-type</span></b></a> command on PE1 to view single-ended packet loss statistics.</p>
<pre class="screen">[PE1]<strong> display y1731 statistic-type single-loss</strong>
Latest single-ended loss statistics of test-id 1:
--------------------------------------------------------------------------------
Index    Local-loss    Local-loss ratio    Remote-loss    Remote-loss ratio
--------------------------------------------------------------------------------
    1             0             0.0000%              0              0.0000%
    2             0             0.0000%              0              0.0000%
    3             0             0.0000%              0              0.0000%
    4             0             0.0000%              0              0.0000%
    5             0             0.0000%              0              0.0000%
    6             0             0.0000%              0              0.0000%
    7             0             0.0000%              0              0.0000%
    8             0             0.0000%              0              0.0000%
    9             0             0.0000%              0              0.0000%
   10             0             0.0000%              0              0.0000%
   11             0             0.0000%              0              0.0000%
--------------------------------------------------------------------------------
Average Local-loss  :          0    Average Local-loss Ratio  :   0.0000%
Maximum Local-loss  :          0    Maximum Local-loss Ratio  :   0.0000%
Minimum Local-loss  :          0    Minimum Local-loss Ratio  :   0.0000%
Average Remote-loss :          0    Average Remote-loss Ratio :   0.0000%
Maximum Remote-loss :          0    Maximum Remote-loss Ratio :   0.0000%
Minimum Remote-loss :          0    Minimum Remote-loss Ratio :   0.0000%
</pre>
</li></ol>
</p></li><li><span>Configure on-demand single-ended packet loss measurement for the AC between CE1 and PE1.</span><p><ol type="a"><li><p>Configure basic Ethernet CFM functions and specify the MEP type as outward.</p>
<p>Configure basic Ethernet CFM functions on each PE. Specify the Ethernet CFM protocol as IEEE Standard 802.1ag-2007. Create an MD named <strong>md1</strong> and an MA named <strong>ma2</strong>, and bind the MA to the VSI.</p>
<p># Configure CE1.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname CE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1-GigabitEthernet<span>0/1/1</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/1</span>] <strong>port default vlan 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>cfm enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>cfm md md1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md1] <strong>ma ma2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md1-ma-ma2] <strong>map vlan 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md1-ma-ma2] <strong>mep mep-id 3 interface gigabitethernet<span>0/1/1</span> outward</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md1-ma-ma2] <strong>mep ccm-send mep-id 3 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md1-ma-ma2] <strong>remote-mep mep-id 4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md1-ma-ma2] <strong>remote-mep ccm-receive mep-id 4 enable</strong></pre>
<p># Configure PE1.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>cfm md md1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>ma ma2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma2] <strong>map vsi ldp1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma2] <strong>mep mep-id 4 interface gigabitethernet<span>0/1/1</span>.1 outward</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma2] <strong>mep ccm-send mep-id 4 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma2] <strong>remote-mep mep-id 3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma2] <strong>remote-mep ccm-receive mep-id 3 enable</strong></pre>
</li><li><p>Configure the test instance.</p>
<p># Configure CE1.</p>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>cfm md md1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md1] <strong>ma ma2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md1-ma-ma2] <strong>test-id 2 mep 3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md1-ma-ma2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>commit</strong></pre>
<p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>cfm md md1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>ma ma2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma2] <strong>test-id 2 mep 4 remote-mep 3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
</li><li><p>Configure the LMM reception function on CE1.</p>
<p># Configure CE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1-md-md1-ma-ma2] <strong>loss-measure single-ended receive test-id 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md1-ma-ma2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>commit</strong></pre>
</li><li><p>Enable on-demand single-ended packet loss measurement.</p>
<p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-md-md1-ma-ma2] <strong>loss-measure single-ended send test-id 2 interval 1000 count 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
</li><li><p>Verify the configuration.</p>
<p>Run the <a href="cmdqueryname=display+y1731+statistic-type"><b><span class="cmdname">display y1731 statistic-type</span></b></a> command on PE1 to view single-ended packet loss statistics.</p>
<pre class="screen">&lt;PE1&gt;<strong> display y1731 statistic-type single-loss</strong>
Latest single-ended loss statistics of test-id 1:
--------------------------------------------------------------------------------
Index    Local-loss    Local-loss ratio    Remote-loss    Remote-loss ratio
--------------------------------------------------------------------------------
    1             0             0.0000%              0              0.0000%
    2             0             0.0000%              0              0.0000%
    3             0             0.0000%              0              0.0000%
    4             0             0.0000%              0              0.0000%
    5             0             0.0000%              0              0.0000%
    6             0             0.0000%              0              0.0000%
    7             0             0.0000%              0              0.0000%
    8             0             0.0000%              0              0.0000%
    9             0             0.0000%              0              0.0000%
   10             0             0.0000%              0              0.0000%
   11             0             0.0000%              0              0.0000%
--------------------------------------------------------------------------------
Average Local-loss  :          0    Average Local-loss Ratio  :   0.0000%
Maximum Local-loss  :          0    Maximum Local-loss Ratio  :   0.0000%
Minimum Local-loss  :          0    Minimum Local-loss Ratio  :   0.0000%
Average Remote-loss :          0    Average Remote-loss Ratio :   0.0000%
Maximum Remote-loss :          0    Maximum Remote-loss Ratio :   0.0000%
Minimum Remote-loss :          0    Minimum Remote-loss Ratio :   0.0000%
</pre>
</li></ol>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172362161__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>CE1 configuration file</p>
<pre class="screen">#
 sysname CE1
#
 vlan batch 2
#
 cfm version standard
 cfm enable
#
interface GigabitEthernet<span>0/1/1</span>
<span> portswitch</span>
 undo shutdown
 port default vlan 2
#
 cfm md md1
  ma ma2
   map vlan 2
   mep mep-id 3 interface GigabitEthernet<span>0/1/1</span> outward
   mep ccm-send mep-id 3 enable
   remote-mep mep-id 4
   remote-mep ccm-receive mep-id 4 enable
   test-id 2 mep 3
   loss-measure single-ended receive test-id 2
#
return</pre>
</li><li><p>PE1 configuration file</p>
<pre class="screen">#
 sysname PE1
#
 cfm version standard
 cfm enable
#
 mpls lsr-id 2.2.2.2
 mpls
#
 mpls l2vpn
#
vsi ldp1 static
 pwsignal ldp
  vsi-id 1
  peer 1.1.1.1
#
mpls ldp
#
interface GigabitEthernet<span>0/1/1</span>.1
 vlan-type dot1q 1
 l2 binding vsi ldp1
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 10.1.1.1 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack0
 ip address 2.2.2.2 255.255.255.0
#
ospf 1
 area 0.0.0.0
  network 2.2.2.2 0.0.0.0
  network 10.1.1.0 0.0.0.255
#
 cfm md md1
  ma ma1
   map vsi ldp1
   mep mep-id 1 interface GigabitEthernet<span>0/1/1</span>.1 inward
   mep ccm-send mep-id 1 enable
   remote-mep mep-id 2
   remote-mep ccm-receive mep-id 2 enable
   test-id 1 mep 1 remote-mep 2 peer-ip 1.1.1.1
   loss-measure single-ended send test-id 1 interval 1000 count 20
#
  ma ma2
   map vsi ldp1
   mep mep-id 4 interface GigabitEthernet<span>0/1/1</span>.1 outward
   mep ccm-send mep-id 4 enable
   remote-mep mep-id 3
   remote-mep ccm-receive mep-id 3 enable
   test-id 2 mep 4 remote-mep 3
   loss-measure single-ended receive test-id 2
   loss-measure single-ended send test-id 2 interval 1000 count 10
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
 sysname PE2
#
 cfm version standard
 cfm enable
#
 mpls lsr-id 1.1.1.1
 mpls
#
 mpls l2vpn
#
vsi ldp1 static
 pwsignal ldp
  vsi-id 1
  peer 2.2.2.2
#
mpls ldp
#
interface GigabitEthernet<span>0/1/1</span>.1
 vlan-type dot1q 2
 l2 binding vsi ldp1
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 10.1.1.2 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack0
 ip address 1.1.1.1 255.255.255.0
#
ospf 1
 area 0.0.0.0
  network 1.1.1.1 0.0.0.0
  network 10.1.1.0 0.0.0.255
#
 cfm md md1
  ma ma1
   map vsi ldp1
   mep mep-id 2 interface GigabitEthernet<span>0/1/1</span>.1 inward
   mep ccm-send mep-id 2 enable
   remote-mep mep-id 1
   remote-mep ccm-receive mep-id 1 enable
   test-id 1 mep 2 peer-ip 2.2.2.2
   loss-measure single-ended receive test-id 1
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011531.html">Configuration Examples for Y.1731
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_y1731_cfg_0073.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011537.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>