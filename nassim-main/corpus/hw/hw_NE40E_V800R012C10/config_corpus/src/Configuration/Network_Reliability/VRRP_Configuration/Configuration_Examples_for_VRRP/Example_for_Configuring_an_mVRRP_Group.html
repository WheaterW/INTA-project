
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring an mVRRP Group">
<meta name="abstract" content="In this example, an mVRRP group is configured to determine the master/backup status of service VRRP groups bound to it.">
<meta name="description" content="In this example, an mVRRP group is configured to determine the master/backup status of service VRRP groups bound to it.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_0120.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_0200.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_0202.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00604599">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="Network Reliability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="Network Reliability">
<meta name="OWNER" content="w00604599">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00604599">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172361805">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring an mVRRP Group</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172361805"></a><a name="EN-US_TASK_0172361805"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring an mVRRP Group</h1>
<div class="taskbody"><p>In this example, an mVRRP group is configured to determine the master/backup status of service VRRP groups bound to it.</p>
<div class="context"><a name="EN-US_TASK_0172361805__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><div class="p">On the network shown in <a href="#EN-US_TASK_0172361805__fig_dc_vrp_vrrp_cfg_012401">Figure 1</a>, each CE is dual-homed to two PEs. A VRRP backup group working in master/backup mode is configured on the PEs. If multiple VRRP groups are configured on the PEs, large numbers of VRRP Advertisement packets are exchanged between them, which consumes a lot of bandwidth and CPU resources. To reduce bandwidth and CPU resource consumption, configure an mVRRP group. The common VRRP groups can join the mVRRP group and become service VRRP groups. The mVRRP group determines the master/backup status of the service VRRP groups.<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>Interfaces 1, 2, 3, 4, and 5 in this example represent GE <span>0/1/1</span>, GE <span>0/1/2</span>, GE <span>0/1/3</span>, GE <span>0/1/4</span>, and GE <span>0/1/5</span>, respectively.</li><li>In this example, an mVRRP group and a service VRRP group are configured for each CE so that each CE is dual-homed to PE1 and PE2.</li></ul>
</div></div>
</div>
<div class="fignone" id="EN-US_TASK_0172361805__fig_dc_vrp_vrrp_cfg_012401"><a name="EN-US_TASK_0172361805__fig_dc_vrp_vrrp_cfg_012401"></a><a name="fig_dc_vrp_vrrp_cfg_012401"></a><span class="figcap"><b>Figure 1 </b>mVRRP group</span><br><span><img class="vsd" src="images/fig_dc_vrp_vrrp_cfg_012401.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172361805__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><div class="p"><h4 class="sectiontitle">Precautions</h4><p>To improve security, you are advised to configure a VRRP security policy. For details, see "Example for Configuring a VRRP Group."</p>
<h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Assign an IP address to each interface on each PE, configure a routing protocol to ensure IP connectivity on each PE, and configure Layer 2 transparent transmission on CE1 and CE2.</li><li>Create an mVRRP group on each PE.</li><li>Create a VRRP group on each interface connecting a PE to a CE and bind the VRRP groups to the mVRRP group.</li></ol>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172361805__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface on each PE and configure OSPF. For detailed CE configurations, see Configuration Files.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>ip address 10.10.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface gigabitethernet<span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>ip address 10.20.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface gigabitethernet<span>0/1/3</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/3</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/3</span>] <strong>ip address 192.168.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/3</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/3</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface gigabitethernet<span>0/1/4</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/4</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/4</span>] <strong>ip address 10.10.3.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/4</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/4</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface gigabitethernet<span>0/1/5</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/5</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/5</span>] <strong>ip address 10.20.3.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/5</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/5</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>ospf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>network 10.10.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>network 10.10.3.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>network 10.20.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>network 10.20.3.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>network 192.168.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-ospf-1] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>ip address 10.10.1.2 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface gigabitethernet<span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/2</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong>ip address 10.20.1.2 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface gigabitethernet<span>0/1/3</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/3</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong>ip address 192.168.2.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/3</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface gigabitethernet<span>0/1/4</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/4</span>] <strong>ip address 10.10.3.2 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/4</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/4</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface gigabitethernet<span>0/1/5</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2--GigabitEthernet<span>0/1/5</span>] <strong>ip address 10.20.3.2 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2--GigabitEthernet<span>0/1/5</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2--GigabitEthernet<span>0/1/5</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>ospf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1-area-0.0.0.0] <strong>network 10.10.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1-area-0.0.0.0] <strong>network 10.10.3.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1-area-0.0.0.0] <strong>network 10.20.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1-area-0.0.0.0] <strong>network 10.20.3.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1-area-0.0.0.0] <strong>network 192.168.2.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1-area-0.0.0.0] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-ospf-1]<strong>quit</strong></pre>
</p></li><li><span>Configure an mVRRP group on the interface of each PE and set a higher VRRP priority for PE1.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface gigabitethernet<span>0/1/4</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/4</span>] <strong>vrrp vrid 1 virtual-ip 10.10.3.111</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/4</span>] <strong>admin-vrrp vrid 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/4</span>] <strong>vrrp vrid 1 priority 120</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/4</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/4</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface gigabitethernet<span>0/1/5</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/5</span>] <strong>vrrp vrid 2 virtual-ip 10.20.3.111</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/5</span>] <strong>admin-vrrp vrid 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/5</span>] <strong>vrrp vrid 2 priority 120</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/5</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/5</span>] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface GigabitEthernet<span>0/1/4</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/4</span>] <strong>vrrp vrid 1 virtual-ip 10.10.3.111</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/4</span>] <strong>admin-vrrp vrid 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/4</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/4</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface gigabitethernet<span>0/1/5</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/5</span>] <strong>vrrp vrid 2 virtual-ip 10.20.3.111</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/5</span>] <strong>admin-vrrp vrid 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/5</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/5</span>] <strong>quit</strong></pre>
</p></li><li><span>Create a VRRP group on the interface connecting each PE to the CE and bind the VRRP groups to the mVRRP group, allowing the mVRRP group to determine the master/backup status of these service VRRP groups.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>vrrp vrid 10 virtual-ip 10.10.1.111</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>vrrp vrid 10 track admin-vrrp interface gigabitethernet<span>0/1/4</span> vrid 1 unflowdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface gigabitethernet<span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>vrrp vrid 20 virtual-ip 10.20.1.111</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>vrrp vrid 20 track admin-vrrp interface gigabitethernet<span>0/1/5</span> vrid 2 unflowdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>vrrp vrid 10 virtual-ip 10.10.1.111</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>vrrp vrid 10 track admin-vrrp interface gigabitethernet<span>0/1/4</span> vrid 1 unflowdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface gigabitethernet<span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/2</span>] <strong>vrrp vrid 20 virtual-ip 10.20.1.111</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong>vrrp vrid 20 track admin-vrrp interface gigabitethernet<span>0/1/5</span> vrid 2 unflowdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>After completing the configurations, run the <strong>display vrrp brief</strong> command on each PE.</p>
<div class="p">The command output on PE1 is as follows:<ul><li><p>In mVRRP group 1 and 2, the value of the <strong>State</strong> field is <strong>Master</strong> and the value of the <strong>Type</strong> field is <strong>Admin</strong>.</p>
</li><li><p>In each service VRRP group, the value of the <strong>State</strong> field is <strong>Master</strong> and the value of the <strong>Type</strong> field is <strong>Member</strong>.</p>
</li></ul>
</div>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display vrrp brief</strong></pre>
<pre class="screen">Total:3     Master:3    Backup:0    Non-active:0    
VRID   State       Interface        Type    Virtual IP      Master IP      Local IP         
------------------------------------------------------------------------------------
1     <strong>Master</strong>      GE<span>0/1/4</span>         <strong> Admin</strong>   10.10.3.111    10.10.3.1 24   10.10.3.1 24
2     <strong>Master</strong>      GE<span>0/1/5</span>         <strong> Admin</strong>   10.20.3.111    10.20.3.1 24   10.20.3.1 24
10    <strong>Master</strong>      GE<span>0/1/1</span>         <strong> Member</strong>  10.10.1.111    10.10.1.1 24   10.10.1.1 24
20    <strong>Master</strong>      GE<span>0/1/2</span>         <strong> Member</strong>  10.20.1.111    10.20.1.1 24   10.20.1.1 24</pre>
<div class="p">The command output on PE2 is as follows:<ul><li><p>In mVRRP group 1 and 2, the value of the <strong>State</strong> field is <strong>Backup</strong> and the value of the <strong>Type</strong> field is <strong>Admin</strong>.</p>
</li><li><p>In each service VRRP group, the value of the <strong>State</strong> field is <strong>Backup</strong> and the value of the <strong>Type</strong> field is <strong>Member</strong>.</p>
</li></ul>
</div>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>display vrrp brief</strong></pre>
<pre class="screen">Total:3     Master:0    Backup:3    Non-active:0    
VRID   State       Interface        Type    Virtual IP      Master IP       Local IP
------------------------------------------------------------------------------------------
1     <strong>Backup</strong>      GE<span>0/1/4</span>          <strong>Admin</strong>   10.10.3.111    10.10.3.1 24    10.10.3.2 24
2     <strong>Backup</strong>      GE<span>0/1/5</span>          <strong>Admin</strong>   10.20.3.111    10.20.3.1 24    10.20.3.2 24
10    <strong>Backup</strong>      GE<span>0/1/1</span>          <strong>Member</strong>  10.10.1.111    10.10.1.1 24    10.10.1.2 24
20    <strong>Backup</strong>      GE<span>0/1/2</span>          <strong>Member</strong>  10.20.1.111    10.20.1.1 24    10.20.1.2 24</pre>
<p>Run the <strong>shutdown</strong> command on GE <span>0/1/1</span>, GE <span>0/1/2</span>, GE <span>0/1/4</span>, and GE <span>0/1/5</span> of PE1 to simulate a device fault.</p>
<p>Then the mVRRP group performs a master/backup VRRP switchover. Run the <a href="cmdqueryname=display+vrrp"><b><span class="cmdname">display vrrp</span></b></a> command on each PE.</p>
<div class="p">The command output on PE1 is as follows:<ul><li><p>In mVRRP group 1 and 2, the value of the <strong>State</strong> field is <strong>Initialize</strong> and the value of the <strong>Type</strong> field is <strong>Admin</strong>.</p>
</li><li><p>In each service VRRP group, the value of the <strong>State</strong> field is <strong>Initialize</strong> and the value of the <strong>Type</strong> field is <strong>Member</strong>.</p>
</li></ul>
</div>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display vrrp brief</strong></pre>
<pre class="screen">Total:3     Master:0    Backup:0    Non-active:3    
VRID   State       Interface         Type    Virtual IP      Master IP      Local IP 
-------------------------------------------------------------------------------------------
1     <strong>Initialize</strong>  GE<span>0/1/4</span>           <strong>Admin</strong>   10.10.3.111     -              10.10.3.1 24
2     <strong>Initialize</strong>  GE<span>0/1/5</span>           <strong>Admin</strong>   10.20.3.111     -              10.20.3.1 24   
10    <strong>Initialize</strong>  GE<span>0/1/1</span>           <strong>Member</strong>  10.10.1.111     -              10.10.1.1 24
20    <strong>Initialize</strong>  GE<span>0/1/2</span>           <strong>Member</strong>  10.20.1.111     -              10.20.1.1 24  </pre>
<div class="p">The command output on PE2 is as follows:<ul><li><p>In mVRRP group 1 and 2, the value of the <strong>State</strong> field is <strong>Master</strong> and the value of the <strong>Type</strong> field is <strong>Admin</strong>.</p>
</li><li><p>In each service VRRP group, the value of the <strong>State</strong> field is <strong>Master</strong> and the value of the <strong>Type</strong> field is <strong>Member</strong>.</p>
</li></ul>
</div>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>display vrrp brief</strong></pre>
<pre class="screen">Total:3     Master:3    Backup:0    Non-active:0    
VRID   State       Interface         Type    Virtual IP        Master IP      Local IP 
---------------------------------------------------------------------------------------
1     <strong>Master</strong>      GE<span>0/1/4</span>           <strong>Admin</strong>   10.10.3.111      10.10.3.2 24    10.10.3.2 24
2     <strong>Master</strong>      GE<span>0/1/5</span>           <strong>Admin</strong>   10.20.3.111      10.20.3.2 24    10.20.3.2 24
10    <strong>Master</strong>      GE<span>0/1/1</span>           <strong>Member</strong>  10.10.1.111      10.10.1.2 24    10.10.1.2 24
20    <strong>Master</strong>      GE<span>0/1/2</span>           <strong>Member</strong>  10.20.1.111      10.20.1.2 24    10.20.1.2 24</pre>
<p>Run the <strong>undo shutdown</strong> command on GE <span>0/1/1</span>, GE <span>0/1/2</span>, GE <span>0/1/4</span>, and GE <span>0/1/5</span> of PE1 to restore PE1.</p>
<p>A VRRP switchback is performed and the VRRP status of each PE in each VRRP group is restored. Run the <a href="cmdqueryname=display+vrrp"><b><span class="cmdname">display vrrp</span></b></a> command on each PE.</p>
<div class="p">The command output on PE1 is as follows:<ul><li><p>In mVRRP group 1 and 2, the value of the <strong>State</strong> field is <strong>Master</strong> and the value of the <strong>Type</strong> field is <strong>Admin</strong>.</p>
</li><li><p>In each service VRRP group, the value of the <strong>State</strong> field is <strong>Master</strong> and the value of the <strong>Type</strong> field is <strong>Member</strong>.</p>
</li></ul>
</div>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display vrrp brief</strong></pre>
<pre class="screen">Total:3     Master:3    Backup:0    Non-active:0    
VRID   State       Interface        Type    Virtual IP       Master IP      Local IP 
------------------------------------------------------------------------------------
1     <strong>Master</strong>      GE<span>0/1/4</span>         <strong> Admin</strong>   10.10.3.111     10.10.3.1 24    10.10.3.1 24
1     <strong>Master</strong>      GE<span>0/1/5</span>         <strong> Admin</strong>   10.20.3.111     10.20.3.1 24    10.20.3.1 24
10    <strong>Master</strong>      GE<span>0/1/1</span>         <strong> Member</strong>  10.10.1.111     10.10.1.1 24    10.10.1.1 24
20    <strong>Master</strong>      GE<span>0/1/2</span>         <strong> Member</strong>  10.20.1.111     10.20.1.1 24    10.20.1.1 24</pre>
<div class="p">The command output on PE2 is as follows:<ul><li><p>In mVRRP group 1 and 2, the value of the <strong>State</strong> field is <strong>Backup</strong> and the value of the <strong>Type</strong> field is <strong>Admin</strong>.</p>
</li><li><p>In each service VRRP group, the value of the <strong>State</strong> field is <strong>Backup</strong> and the value of the <strong>Type</strong> field is <strong>Member</strong>.</p>
</li></ul>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>display vrrp brief</strong></pre>
<pre class="screen">Total:3     Master:0    Backup:3    Non-active:0    
VRID   State       Interface        Type    Virtual IP     Master IP      Local IP
------------------------------------------------------------------------------------------
1     <strong>Backup</strong>      GE<span>0/1/4</span>          <strong>Admin</strong>   10.10.3.111    10.10.3.1 24    10.10.3.2 24
2     <strong>Backup</strong>      GE<span>0/1/5</span>          <strong>Admin</strong>   10.20.3.111    10.20.3.1 24    10.20.3.2 24
10    <strong>Backup</strong>      GE<span>0/1/1</span>          <strong>Member</strong>  10.10.1.111    10.10.1.1 24    10.10.1.2 24
20    <strong>Backup</strong>      GE<span>0/1/2</span>          <strong>Member</strong>  10.20.1.111    10.20.1.1 24    10.20.1.2 24</pre>
</div>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172361805__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#
sysname PE1
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown 
 ip address 10.10.1.1 255.255.255.0
 vrrp vrid 10 virtual-ip 10.10.1.111
 vrrp vrid 10 track admin-vrrp interface gigabitethernet<span>0/1/4</span> vrid 1 unflowdown
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown 
 ip address 10.20.1.1 255.255.255.0
 vrrp vrid 20 virtual-ip 10.20.1.111
 vrrp vrid 20 track admin-vrrp interface gigabitethernet<span>0/1/5</span> vrid 2 unflowdown
#
interface GigabitEthernet<span>0/1/3</span>
 undo shutdown 
 ip address 192.168.1.1 255.255.255.0
#
interface GigabitEthernet<span>0/1/4</span>
 undo shutdown 
 ip address 10.10.3.1 255.255.255.0 
 vrrp vrid 1 virtual-ip 10.10.3.111
 <span>admin-vrrp vrid 1</span>
 vrrp vrid 1 priority 120
#
interface GigabitEthernet<span>0/1/5</span>
 undo shutdown 
 ip address 10.20.3.1 255.255.255.0 
 vrrp vrid 2 virtual-ip 10.20.3.111
 <span>admin-vrrp vrid 2</span>
 vrrp vrid 2 priority 120
#
ospf 1
 area 0.0.0.0
  network 10.10.1.0 0.0.0.255
  network 10.10.3.0 0.0.0.255
  network 10.20.1.0 0.0.0.255
  network 10.20.3.0 0.0.0.255
  network 192.168.1.0 0.0.0.255
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown 
 ip address 10.10.1.2 255.255.255.0
 vrrp vrid 10 virtual-ip 10.10.1.111
 vrrp vrid 10 track admin-vrrp interface gigabitethernet<span>0/1/4</span> vrid 1 unflowdown
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown 
 ip address 10.20.1.2 255.255.255.0
 vrrp vrid 20 virtual-ip 10.20.1.111
 vrrp vrid 20 track admin-vrrp interface gigabitethernet<span>0/1/5</span> vrid 2 unflowdown
#
interface GigabitEthernet<span>0/1/3</span>
 undo shutdown 
 ip address 192.168.2.1 255.255.255.0
#
interface GigabitEthernet<span>0/1/4</span>
 ip address 10.10.3.2 255.255.255.0 
 vrrp vrid 1 virtual-ip 10.10.3.111
 <span>admin-vrrp vrid 1</span>
#
interface GigabitEthernet<span>0/1/5</span>
 ip address 10.20.3.2 255.255.255.0 
 vrrp vrid 2 virtual-ip 10.20.3.111
 <span>admin-vrrp vrid 2</span>
#
ospf 1
 area 0.0.0.0
  network 10.10.1.0 0.0.0.255
  network 10.10.3.0 0.0.0.255
  network 10.20.1.0 0.0.0.255
  network 10.20.3.0 0.0.0.255
  network 192.168.2.0 0.0.0.255
#
return</pre>
</li><li><p>CE1 configuration file</p>
<pre class="screen">#
sysname CE1
#
vlan batch 10 20
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 port default vlan 10
#
interface gigabitethernet<span>0/1/2</span>
 undo shutdown
 port default vlan 10
#
interface gigabitethernet<span>0/1/3</span>
 undo shutdown
 port default vlan 20
#
interface gigabitethernet<span>0/1/4</span>
 undo shutdown
 port default vlan 20
#
return</pre>
</li><li><p>CE2 configuration file</p>
<pre class="screen">#
sysname CE2
#
vlan batch 10 20
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 port default vlan 10
#
interface gigabitethernet<span>0/1/2</span>
 undo shutdown
 port default vlan 10
#
interface gigabitethernet<span>0/1/3</span>
 undo shutdown
 port default vlan 20
#
interface gigabitethernet<span>0/1/4</span>
 undo shutdown
 port default vlan 20
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_0120.html">Configuration Examples for VRRP
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_0200.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_0202.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>