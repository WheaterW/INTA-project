
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Packet DM for an LSP">
<meta name="abstract" content="This section provides an example for configuring packet delay measurement (DM) for a bidirectional label switched path (LSP).">
<meta name="description" content="This section provides an example for configuring packet delay measurement (DM) for a bidirectional label switched path (LSP).">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-tp_oam_cfg_0023.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-tp_oam_cfg_0026.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-tp_oam_cfg_0029.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,z00603461,w00800033,jwx1168690,tpoam_vrp,w00556928,w00437000,w00606909,m00390128,l00455378,wwx1270540">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MPLS-TP OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MPLS-TP OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="MPLS-TP OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="MPLS-TP OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="OWNER" content="z00545680">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00545680">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172362434">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring Packet DM for an LSP</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172362434"></a><a name="EN-US_TASK_0172362434"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Packet DM for an LSP</h1>
<div class="taskbody"><p>This section provides an example for configuring packet delay measurement (DM) for a bidirectional label switched path (LSP).</p>
<div class="context"><a name="EN-US_TASK_0172362434__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As a connection-oriented packet switching technology, Multiprotocol Label Switching Transport Profile (MPLS-TP) is designed to convert a circuit switched transport network to a packet switched transport network. The purpose is to increase the transmission rate on the transport network.</p>
<p>Link reliability must be ensured when MPLS-TP is used. Voice services are used as an example. The coding and decoding of voice packets plus the transmission delay make the delay in VoIP transmission much longer than that in common circuit switched voice transmission. If the delay is longer than 400 ms, the voice quality is affected. If the delay is longer than 2 seconds, VoIP services are unavailable. In addition, if the delay variation (jitter) is longer than the transmission duration of a voice packet, voice quality will drop greatly.</p>
<p>Packet DM can be used to collect delay and jitter statistics and evaluate link performance. DM is a performance monitoring function provided by MPLS-TP and is classified as one-way packet DM or two-way packet DM.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The configuration of two-way packet DM is used as an example in this section. Regardless of one-way or two-way, DM configurations on LSRs are the same except the statistics display configurations.</p>
</div></div>
<p>On the network shown in <a href="#EN-US_TASK_0172362434__fig_dc_vrp_mpls-tp_oam_cfg_002401">Figure 1</a>, a bidirectional LSP is established to connect label switching routers (LSRs) A, B, and C. The following deployment is made to ensure connectivity between LSRA and LSRC:</p>
<div class="p"><ul><li>LSRA and LSRC serve as MEPs.</li><li>LSRB serves as a MIP.</li></ul>
</div>
<div class="fignone" id="EN-US_TASK_0172362434__fig_dc_vrp_mpls-tp_oam_cfg_002401"><a name="EN-US_TASK_0172362434__fig_dc_vrp_mpls-tp_oam_cfg_002401"></a><a name="fig_dc_vrp_mpls-tp_oam_cfg_002401"></a><span class="figcap"><b>Figure 1 </b>Bidirectional LSP</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 and interface2 represent GE <span>0/1/0</span> and GE <span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_mpls-tp_oam_cfg_002401.png" width="NaN" height="NaN"></span><br></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Interfaces and IP addresses</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="10.66893310668933%" id="mcps1.4.1.9.2.4.1.1" liSelected="liSelected"><p>Device</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="53.664633536646335%" id="mcps1.4.1.9.2.4.1.2" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="35.666433356664335%" id="mcps1.4.1.9.2.4.1.3" liSelected="liSelected"><p>IP Address</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="2" valign="top" width="10.66893310668933%" headers="mcps1.4.1.9.2.4.1.1 "><p>LSRA</p>
</td>
<td class="cellrowborder" valign="top" width="53.664633536646335%" headers="mcps1.4.1.9.2.4.1.2 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" width="35.666433356664335%" headers="mcps1.4.1.9.2.4.1.3 "><p>10.1.1.1/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.9.2.4.1.2 "><p>GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.9.2.4.1.3 "><p>10.1.2.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" valign="top" width="10.66893310668933%" headers="mcps1.4.1.9.2.4.1.1 "><p>LSRB</p>
</td>
<td class="cellrowborder" valign="top" width="53.664633536646335%" headers="mcps1.4.1.9.2.4.1.2 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" width="35.666433356664335%" headers="mcps1.4.1.9.2.4.1.3 "><p>10.1.1.2/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.9.2.4.1.2 "><p>GigabitEthernet<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.9.2.4.1.3 "><p>10.1.2.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.9.2.4.1.2 "><p>GigabitEthernet<span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.9.2.4.1.3 "><p>10.1.3.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" valign="top" width="10.66893310668933%" headers="mcps1.4.1.9.2.4.1.1 "><p>LSRC</p>
</td>
<td class="cellrowborder" valign="top" width="53.664633536646335%" headers="mcps1.4.1.9.2.4.1.2 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" width="35.666433356664335%" headers="mcps1.4.1.9.2.4.1.3 "><p>10.1.1.3/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.9.2.4.1.2 "><p>GigabitEthernet<span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.9.2.4.1.3 "><p>10.1.3.2/24</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362434__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Create a maintenance entity (ME) instance and bind it to a bidirectional LSP.</p>
</li><li><p>Configure an interval at which CCMs are sent and a priority for CCMs.</p>
</li><li><p>Enable continuity check (CC) and connectivity verification (CV) on the MEP and its remote MEP (RMEP).</p>
</li><li><p>Enable two-way packet DM.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362434__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>MEG name</p>
</li><li><p>Name of the tunnel interface to which an ME instance is bound</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172362434__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure a bidirectional LSP.</span><p><p>For configuration details, see "<a href="dc_vrp_te-p2p_cfg_0168.html">Example for Configuring a Static Bidirectional Co-routed CR-LSP</a>" in <em><span class="keyword">HUAWEI NE40E-M2 series</span><span class="keyword">Universal Service Router</span> Configuration Guide - MPLS</em> or Configuration Files.</p>
</p></li><li><span>Create an ME instance and bind it to the bidirectional LSP.</span><p><div class="p"># Create an ME instance named <strong>test</strong> on LSRA and bind it to Tunnel 10.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>mpls-tp meg test</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-mpls-tp-meg-test] <strong>me te interface Tunnel 10 mep-id 1 remote-mep-id 2</strong>
[<span class="keyword">*</span>LSRA-mpls-tp-meg-test] <strong>commit</strong></pre>
</div>
<div class="p"># Create an ME instance named <strong>test</strong> on LSRC and bind it to Tunnel 20.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC] <strong>mpls-tp meg test</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC-mpls-tp-meg-test] <strong>me te interface Tunnel 20 mep-id 2 remote-mep-id 1</strong>
[<span class="keyword">*</span>LSRC-mpls-tp-meg-test] <strong>commit</strong></pre>
</div>
</p></li><li><span>Configure an interval at which CCMs are sent and a priority for CCMs.</span><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The same interval at which CCMs are sent and priority of CCMs must be configured on the MEP and RMEP. If the configurations at both ends are different, an alarm indicating an error is reported.</p>
</div></div>
<div class="p"># Set the interval at which CCMs are sent to 100 ms and the priority of CCMs to 6 on LSRA.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-mpls-tp-meg-test] <strong>cc interval 100</strong>
[<span class="keyword">*</span>LSRA-mpls-tp-meg-test] <strong>cc exp 6</strong>
[<span class="keyword">*</span>LSRA-mpls-tp-meg-test] <strong>commit</strong></pre>
</div>
<div class="p"># Set the interval at which CCMs are sent to 100 ms and the priority of CCMs to 6 on LSRC.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC-mpls-tp-meg-test] <strong>cc interval 100</strong>
[<span class="keyword">*</span>LSRC-mpls-tp-meg-test] <strong>cc exp 6</strong>
[<span class="keyword">*</span>LSRA-mpls-tp-meg-test] <strong>commit</strong></pre>
</div>
</p></li><li><span>Enable CC and CV.</span><p><div class="p"># Enable CC and CV on LSRA.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-mpls-tp-meg-test] <strong>cc send enable</strong>
[<span class="keyword">*</span>LSRA-mpls-tp-meg-test] <strong>cc receive enable</strong>
[<span class="keyword">*</span>LSRA-mpls-tp-meg-test] <strong>return</strong></pre>
</div>
<div class="p"># Enable CC and CV on LSRC.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC-mpls-tp-meg-test] <strong>cc send enable</strong>
[<span class="keyword">*</span>LSRC-mpls-tp-meg-test] <strong>cc receive enable</strong>
[<span class="keyword">*</span>LSRA-mpls-tp-meg-test] <strong>commit</strong></pre>
</div>
</p></li><li><span>Enable two-way packet DM.</span><p><div class="p"><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-mpls-tp-meg-test] <strong>delay-measure two-way</strong>
Two-way delay measure statistics      
delay(us):        delay variation(us):
182               --
182               0                 
182               0                 
183               1                 
182               1                 
The Max delay:183, The Max delay variation:1                         
The Min delay:182, The Min delay variation:0                         
The delay average:182, The delay variation average:1                         
Total sent Packets Number:5, Total received Packets Number: 5</pre>
</div>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172362434__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>LSRA configuration file</p>
<pre class="screen">#
 sysname LSRA
#
 mpls lsr-id 10.1.1.1
 mpls
  mpls te
#
 bidirectional static-cr-lsp ingress Tunnel10
  forward nexthop 10.1.2.2 out-label 20
  backward in-label 20
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.2.1 255.255.255.0
 mpls
 mpls te
#
interface LoopBack1
 ip address 10.1.1.1 255.255.255.255
#
interface Tunnel10
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 10.1.1.3
 mpls te signal-protocol cr-static
 mpls te tunnel-id 100
 mpls te bidirectional
#
 ip route-static 10.1.1.2 255.255.255.255 10.1.2.2
 ip route-static 10.1.1.3 255.255.255.255 10.1.2.2
#
 mpls-tp meg test
  me te interface Tunnel10 mep-id 1 remote-mep-id 2
  cc interval 100
  cc exp 6
  cc send enable
  cc receive enable
#
delay-measure two-way
#
return  </pre>
</li><li><p>LSRB configuration file</p>
<pre class="screen">#
 sysname LSRB
#
 mpls lsr-id 10.1.1.2
 mpls
  mpls te
#
 bidirectional static-cr-lsp transit lsp1
  forward in-label 20 nexthop 10.1.3.2 out-label 40
  backward in-label 16 nexthop 10.1.2.1 out-label 20
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.2.2 255.255.255.0
 mpls
 mpls te
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.1.3.1 255.255.255.0
 mpls
 mpls te
#
interface LoopBack1
 ip address 10.1.1.2 255.255.255.255
#
 ip route-static 10.1.1.1 255.255.255.255 10.1.2.1
 ip route-static 10.1.1.3 255.255.255.255 10.1.3.2
#
return  </pre>
</li><li><p>LSRC configuration file</p>
<pre class="screen">#
 sysname LSRC
#
 mpls lsr-id 10.1.1.3
 mpls
  mpls te
#
 bidirectional static-cr-lsp egress lsp1
  forward in-label 40 lsrid 10.1.1.1 tunnel-id 100
  backward nexthop 10.1.3.1 out-label 16
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.3.2 255.255.255.0
 mpls
 mpls te
#
interface LoopBack1
 ip address 10.1.1.3 255.255.255.255
#
interface Tunnel20
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 10.1.1.1
 mpls te signal-protocol cr-static
 mpls te tunnel-id 200
 mpls te passive-tunnel
 mpls te binding bidirectional static-cr-lsp egress lsp1 
#
 ip route-static 10.1.1.1 255.255.255.255 10.1.3.1
 ip route-static 10.1.1.2 255.255.255.255 10.1.3.1
#
 mpls-tp meg test
  me te interface Tunnel20 mep-id 2 remote-mep-id 1
  cc interval 100
  cc exp 6
  cc send enable
  cc receive enable
#
delay-measure two-way
#
return  </pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-tp_oam_cfg_0023.html">Configuration Examples for MPLS-TP OAM
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-tp_oam_cfg_0026.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-tp_oam_cfg_0029.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>