
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Associating a VRRP Group with a BFD Session to Implement a Rapid Master/Backup VRRP Switchover">
<meta name="abstract" content="You can associate a VRRP group with a BFD session. If the status of a BFD session changes, BFD notifies the VRRP group of the change. After receiving the notification, the VRRP group rapidly performs a master/backup VRRP switchover.">
<meta name="description" content="You can associate a VRRP group with a BFD session. If the status of a BFD session changes, BFD notifies the VRRP group of the change. After receiving the notification, the VRRP group rapidly performs a master/backup VRRP switchover.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_0114.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_01128.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_0136.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00604599">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="Network Reliability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="Network Reliability">
<meta name="OWNER" content="w00604599">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00604599">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172361774">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Associating a VRRP Group with a BFD Session to Implement a Rapid Master/Backup VRRP Switchover</title>
</head>
<body><a name="EN-US_TASK_0172361774"></a><a name="EN-US_TASK_0172361774"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Associating a VRRP Group with a BFD Session to Implement a Rapid Master/Backup VRRP Switchover</h1>
<div class="taskbody"><p>You can associate a VRRP group with a BFD session. If the status of a BFD session changes, BFD notifies the VRRP group of the change. After receiving the notification, the VRRP group rapidly performs a master/backup VRRP switchover.</p>
<div class="context"><a name="EN-US_TASK_0172361774__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>If a link between devices in a VRRP group fails, VRRP Advertisement packets cannot be sent to negotiate the master/backup status. A backup device preempts the master role only after a period of three times the interval at which VRRP Advertisement packets are sent. During this period, service data is lost. To resolve this problem, associate the VRRP group with a BFD session. A BFD session is established between the master and backup devices to rapidly detect faults. If a fault occurs, BFD rapidly notifies the VRRP group of the fault and triggers a master/backup VRRP switchover.</p>
<div class="p"><a href="#EN-US_TASK_0172361774__tab_dc_vrp_vrrp_cfg_011601">Table 1</a> describes VRRP and BFD association modes. 
<div class="tableBorder"><a name="EN-US_TASK_0172361774__tab_dc_vrp_vrrp_cfg_011601"></a><a name="tab_dc_vrp_vrrp_cfg_011601"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172361774__tab_dc_vrp_vrrp_cfg_011601" frame="border" border="1" rules="all"><caption><b>Table 1 </b>VRRP and BFD association modes</caption><thead align="left"><tr id="EN-US_TASK_0172361774__row292226376214023"><th align="left" class="cellrowborder" valign="top" width="8.52914708529147%" id="mcps1.4.1.2.2.2.6.1.1" liSelected="liSelected"><p id="EN-US_TASK_0172361774__p2128944260214023">Association Mode</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="22.86771322867713%" id="mcps1.4.1.2.2.2.6.1.2" liSelected="liSelected"><p id="EN-US_TASK_0172361774__p1517562525214023">Usage Scenario</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="22.86771322867713%" id="mcps1.4.1.2.2.2.6.1.3" liSelected="liSelected"><p id="EN-US_TASK_0172361774__p629927406214023">Type of Associated BFD Session</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="22.86771322867713%" id="mcps1.4.1.2.2.2.6.1.4" liSelected="liSelected"><p id="EN-US_TASK_0172361774__p1855632459214023">Impact Mode</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="22.86771322867713%" id="mcps1.4.1.2.2.2.6.1.5" liSelected="liSelected"><p id="EN-US_TASK_0172361774__p261530438214023">BFD Support</p>
</th>
</tr>
</thead>
<tbody><tr id="EN-US_TASK_0172361774__row180638719214023"><td class="cellrowborder" valign="top" width="8.52914708529147%" headers="mcps1.4.1.2.2.2.6.1.1 "><p id="EN-US_TASK_0172361774__p1011235168214023">Association between a VRRP group and a common BFD session</p>
</td>
<td class="cellrowborder" valign="top" width="22.86771322867713%" headers="mcps1.4.1.2.2.2.6.1.2 "><p id="EN-US_TASK_0172361774__p448462023214023">A backup device monitors the status of the master device in a VRRP group. A common BFD session is used to monitor the link between the master and backup devices.</p>
</td>
<td class="cellrowborder" valign="top" width="22.86771322867713%" headers="mcps1.4.1.2.2.2.6.1.3 "><p id="EN-US_TASK_0172361774__p24925732214023">Static BFD sessions or static BFD sessions with automatically negotiated discriminators</p>
</td>
<td class="cellrowborder" valign="top" width="22.86771322867713%" headers="mcps1.4.1.2.2.2.6.1.4 "><p id="EN-US_TASK_0172361774__p580010726214023">The VRRP group adjusts priorities according to the BFD session status and determines whether to perform a master/backup switchover according to the adjusted priorities.</p>
</td>
<td class="cellrowborder" valign="top" width="22.86771322867713%" headers="mcps1.4.1.2.2.2.6.1.5 "><p id="EN-US_TASK_0172361774__p2140859943214023">VRRP-enabled devices must support BFD.</p>
</td>
</tr>
<tr id="EN-US_TASK_0172361774__row615421829214023"><td class="cellrowborder" valign="top" width="8.52914708529147%" headers="mcps1.4.1.2.2.2.6.1.1 "><p id="EN-US_TASK_0172361774__p831938694214023">Association between a VRRP group and link and peer BFD sessions</p>
</td>
<td class="cellrowborder" valign="top" width="22.86771322867713%" headers="mcps1.4.1.2.2.2.6.1.2 "><p id="EN-US_TASK_0172361774__p1622041875214023">The master and backup devices monitor the link and peer BFD sessions simultaneously. A link BFD session is established between the master and backup devices. A peer BFD session is established between a downstream switch and each VRRP device. BFD helps determine whether the fault occurs between the master device and downstream switch or between the backup device and downstream switch.</p>
</td>
<td class="cellrowborder" valign="top" width="22.86771322867713%" headers="mcps1.4.1.2.2.2.6.1.3 "><p id="EN-US_TASK_0172361774__p2048933557214023">Static BFD sessions or static BFD sessions with automatically negotiated discriminators </p>
</td>
<td class="cellrowborder" valign="top" width="22.86771322867713%" headers="mcps1.4.1.2.2.2.6.1.4 "><p id="EN-US_TASK_0172361774__p473374544214023">If the link or peer BFD session goes down, BFD notifies the VRRP group of the fault. After receiving the notification, the VRRP group immediately performs a master/backup VRRP switchover.</p>
</td>
<td class="cellrowborder" valign="top" width="22.86771322867713%" headers="mcps1.4.1.2.2.2.6.1.5 "><p id="EN-US_TASK_0172361774__p117687793214023">VRRP-enabled devices must support BFD.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Perform the following steps on the device that needs to perform a rapid master/backup VRRP switchover:</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172361774__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> { <i><span class="varname">interface-name</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> }</span><p><p>The view of the interface on which the VRRP group is configured is displayed.</p>
</p></li><li><span>Perform any of the following operations as required:</span><p><ul><li><p>To associate a VRRP group with a common BFD session, run the following command:</p>
<p>Run the <a href="cmdqueryname=vrrp+vrid"><b><span class="cmdname"> vrrp vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>track</span></strong> <strong><span>bfd-session</span></strong> { <i><span class="varname">bfd-session-id</span></i> | <strong><span>session-name</span></strong> <i><span class="varname">bfd-configure-name</span></i> } [ <strong><span>increased</span></strong> <i><span class="varname">value-increased</span></i> | <strong><span>reduced</span></strong> <i><span class="varname">value-reduced</span></i> ] command to associate the VRRP group with a common BFD session.</p>
</li><li><p>To associate a VRRP group with a link or peer BFD session, perform the following steps:</p>
<ol type="a"><li><p>Run the <a href="cmdqueryname=vrrp+vrid"><b><span class="cmdname">vrrp vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>track</span></strong> <strong><span>bfd-session</span></strong> { <i><span class="varname">bfd-session-id</span></i> | <strong><span>session-name</span></strong> <i><span class="varname">bfd-configure-name</span></i> } [ <strong><span>peer</span></strong> | <strong><span>link</span></strong> ] command to associate the VRRP group with a link or peer BFD session.</p>
</li><li><p><span>Run the <a href="cmdqueryname=vrrp+vrid"><b><span class="cmdname">vrrp vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>track link-bfd down-number</span></strong> <i><span class="varname">down-number</span></i> command to set a threshold for the number of times that the link BFD session tracked by the VRRP group goes down</span>.</p>
<p>When the number of times that the link BFD session tracked by the VRRP group goes down reaches or exceeds the <i><span class="varname">down-number</span></i>, the VRRP group performs a master/backup switchover.</p>
</li></ol>
</li></ul>
<div class="p">When associating a VRRP group with a BFD session, note the following points:<ul><li><p>If <strong><span>session-name</span></strong> <i><span class="varname">bfd-configure-name</span></i> is specified, the VRRP group can be associated only with static BFD sessions with automatically negotiated discriminators or static BFD session discriminators.</p>
</li><li><p>If <i><span class="varname">bfd-session-id</span></i> is specified, the VRRP group can be associated only with static BFD sessions.</p>
</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>If a VRRP group is bound to an mVRRP group, the mVRRP group maintains the VRRP group's status. The VRRP group is unable to track any BFD sessions.</p>
</li><li><p>When a VRRP group is associated with a link BFD session and a peer BFD session, a backup device's status becomes Master if the backup device detects the peer BFD session's status change before detecting the link BFD session's status change. The backup device's status changes from Master to Initialize after it detects the link BFD session's status is changed to down. To prevent the preceding situation, run the <a href="cmdqueryname=min-tx-interval"><b><span class="cmdname">min-tx-interval</span></b></a> command in the BFD session view to set the interval for sending link BFD control packets to be less than the interval for sending peer BFD control packets.</p>
</li><li><p><span>In VPLS aggregation scenarios, you must configure a link BFD session of the BFD for Default IP VSI type on the UPE and bind the session to an mPW. The default IP addresses on the PE-AGGs must also be different from those on the UPE and NPEs. For configuration details, see <a href="cmdqueryname=bfd+bind+peer-ip+default-ip+vsi"><b><span class="cmdname">bfd bind peer-ip default-ip vsi</span></b></a>. </span>You must configure a link BFD session of the BFD for Default IP type on the NPEs. For configuration details, see <a href="cmdqueryname=bfd+bind+peer-ip+default-ip"><b><span class="cmdname">bfd bind peer-ip default-ip</span></b></a>.</p>
</li></ul>
</div></div>
</div>
</p></li><li><span><span>(Optional) Run the <a href="cmdqueryname=vrrp+vrid"><b><span class="cmdname">vrrp vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>track link-bfd down-number</span></strong> <i><span class="varname">down-number</span></i> command to set the maximum number of link BFD sessions allowed in the down state tracked by the VRRP group.</span></span><p><p>If the number of associated link BFD sessions that are in the down state reaches the value specified by <i><span class="varname">down-number</span></i>, the VRRP group performs a master/backup switchover.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_0114.html">Configuring VRRP Association
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_01128.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vrrp_cfg_0136.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>