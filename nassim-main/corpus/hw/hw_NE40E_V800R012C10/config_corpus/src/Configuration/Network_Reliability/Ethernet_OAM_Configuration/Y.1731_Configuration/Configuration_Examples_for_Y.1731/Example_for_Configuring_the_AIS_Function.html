
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring the AIS Function">
<meta name="abstract" content="The AIS function defined in Y.1731 supports VLL, VPLS, and VLAN scenarios. This section provides an example showing how to configure the AIS function on a VLL network, and briefly describes the AIS application on a VLAN and VPLS network.">
<meta name="description" content="The AIS function defined in Y.1731 supports VLL, VPLS, and VLAN scenarios. This section provides an example showing how to configure the AIS function on a VLL network, and briefly describes the AIS application on a VLAN and VPLS network.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011531.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_y1731_cfg_0061.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_y1731_cfg_0076.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,c00376497,z00603461,w00800033,jwx1168690,w00556928,w00437000,eoam-vrp,w00606909,m00390128,l00455378,wwx1270540">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="featurename" content="Ethernet OAM">
<meta name="featuretype" content="Network Reliability">
<meta name="OWNER" content="z00545680">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="p00915595">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172362185">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring the AIS Function</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172362185"></a><a name="EN-US_TASK_0172362185"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring the AIS Function</h1>
<div class="taskbody"><p>The AIS function defined in Y.1731 supports VLL, <span>VPLS, </span>and VLAN scenarios. This section provides an example showing how to configure the AIS function on a VLL network, and briefly describes the AIS application on a VLAN <span>and </span><span>VPLS</span> network.</p>
<div class="context"><a name="EN-US_TASK_0172362185__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>AIS is used to prevent a MEP in an MD of a higher level from sending the same alarm as that sent by a MEP in an MD of a lower level to the NMS.</p>
<p>As shown in <a href="#EN-US_TASK_0172362185__fig_dc_vrp_cfg_01154801">Figure 1</a>, CE1 is connected to PE1 through sub-interfaces, and CE2 is connected to PE2 through sub-interfaces. A VLL is set up between the PEs, using LDP as the signaling protocol.</p>
<p>VLL AIS is configured on the PEs and alarm suppression is enabled on the CEs. In the scenarios of MD nesting, if a MEP in a low-level MD detects a fault, the MEP sends an alarm to the NMS. After a certain period, a MEP in the MD of a higher level also detects the fault and sends the same alarm to the NMS. In this case, the MEP in the MD of a higher level must be prohibited from sending the same alarm to the NMS.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The VLL between the PEs is used as an example.</p>
</div></div>
<div class="fignone" id="EN-US_TASK_0172362185__fig_dc_vrp_cfg_01154801"><a name="EN-US_TASK_0172362185__fig_dc_vrp_cfg_01154801"></a><a name="fig_dc_vrp_cfg_01154801"></a><span class="figcap"><b>Figure 1 </b>Networking diagram of configuring AIS</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 and interface2 represent GE <span>0/1/1</span> and GE <span>0/1/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_cfg_01154801.png" width="NaN" height="NaN"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362185__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Add the PEs to an MD, add each PE and its attached CE to an MD, and ensure that the level of the MD to which the PEs belong is lower than that to which each PE and its attached CE belong.</p>
</li><li><p>Configure alarm suppression to suppress MEPs in MDs of different levels from sending the same alarm to the NMS.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362185__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>VC ID</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>VLAN ID (in VLAN networking)</li><li>VSI name (in VPLS networking)</li></ul>
</div></div>
</li><li><p>MD names and MA names on CE1, CE2, PE1, and PE2</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172362185__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure a VLL connection.</span><p><p>Configure a VLL connection between PE1 and PE2. The configuration details are not provided here. For configuration details, see "VLL Configuration" in <em>Configuration Guide - VPN</em> or configuration files in this section.</p>
<p>By default, the interface type is tagged. The parameter <strong>raw</strong> can be set in the <strong>map mpls l2vc</strong> command used to bind the MA to the L2VC only when the parameter <strong>raw</strong> has been set in the <strong>mpls l2vc</strong> command used to create a dynamic VLL connection.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>In the case of VLAN networking, configure the VLAN between PE1 and PE2. The configuration details are not provided. For details, see the chapter "VLAN Configuration" in the <em>Configuration Guide - LAN Access and MAN Access</em> or configuration files in this configuration example.</p>
</li><li><p>In the case of VPLS networking, configure a VPLS connection between PE1 and PE2. The configuration details are not provided here. For details, see "VPLS Configuration" in <em>Configuration Guide - VPN</em> or configuration files in this example.</p>
</li></ul>
</div></div>
</p></li><li><span>Configure basic Ethernet CFM functions.</span><p><p>Configure basic Ethernet CFM functions on each PE. Specify the Ethernet CFM protocol as IEEE Standard 802.1ag-2007. Create an MD named <strong>md1</strong> and an MA named <strong>ma1</strong>, and bind the MA to the VLL.</p>
<p># Configure PE1.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>cfm version standard</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>cfm enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>cfm md md1 level 3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>ma ma1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>map mpls l2vc 100 tagged</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p"><ul><li><p>In VLAN networking, run the <strong><a href="cmdqueryname=map+vlan+2"><b><span class="cmdname">map vlan 2</span></b></a></strong> command.</p>
</li><li><p>In VPLS networking, run the <strong>map vsi ldp1</strong> command.</p>
</li></ul>
</div>
</div></div>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>cfm version standard</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>cfm enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>cfm md md1 level 3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1] <strong>ma ma1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>map mpls l2vc 100 tagged</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p"><ul><li><p>In VLAN networking, run the <strong>map vlan 2</strong> command.</p>
</li><li><p>In VPLS networking, run the <strong>map vsi ldp1</strong> command.</p>
</li></ul>
</div>
</div></div>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1] <strong>quit</strong></pre>
<p>Configure basic Ethernet CFM functions on each CE. Specify the Ethernet CFM protocol as IEEE Standard 802.1ag-2007. Create an MD named <strong>md2</strong> and an MA named <strong>ma2</strong>.</p>
<p># Configure CE1.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname CE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong>interface GigabitEthernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1-GigabitEthernet<span>0/1/1</span>] <strong>port trunk allow-pass vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>cfm version standard</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>cfm enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>cfm md md2 level 6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2] <strong>ma ma2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2-ma-ma2] <strong>map vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2-ma-ma2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2] <strong>quit</strong></pre>
<p># Configure CE2.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname CE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2] <strong>interface GigabitEthernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>port trunk allow-pass vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>cfm version standard</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>cfm enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>cfm md md2 level 6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2] <strong>ma ma2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2-ma-ma2] <strong>map vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2-ma-ma2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2] <strong>quit</strong></pre>
</p></li><li><span>Set the MEP type as inward on the AC-side interface of each PE (in VLAN networking, set the MEP type on the AC-side interface as outward).</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>cfm md md1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>ma ma1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>mep mep-id 31 interface gigabitEthernet<span>0/1/1</span>.1 inward</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p><span>In VPLS networking, the configuration is the same as in the VLL networking.</span></p>
<p>In VLAN networking, run the <strong>mep mep-id 31 interface gigabitEthernet<span>0/1/1</span> outward</strong> command to configure an outward-facing MEP.</p>
</div></div>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>mep ccm-send enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>remote-mep mep-id 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>remote-mep ccm-receive enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>cfm md md1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1] <strong>ma ma1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>mep mep-id 32 interface gigabitEthernet<span>0/1/1</span>.1 inward</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p><span>In VPLS networking, the configuration is the same as in the VLL networking.</span></p>
<p>In VLAN networking, run the <strong>mep mep-id 32 interface gigabitEthernet<span>0/1/1</span> outward</strong> command to configure an outward-facing MEP.</p>
</div></div>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>mep ccm-send enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>remote-mep mep-id 31</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>remote-mep ccm-receive enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1] <strong>quit</strong></pre>
</p></li><li><span>Set the MEP type as outward on each CE.</span><p><p># Configure CE1.</p>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>cfm md md2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2] <strong>ma ma2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2-ma-ma2] <strong>mep mep-id 61 interface gigabitEthernet<span>0/1/1</span> outward</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2-ma-ma2] <strong>ccm-interval 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2-ma-ma2] <strong>mep ccm-send enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2-ma-ma2] <strong>remote-mep mep-id 62</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2-ma-ma2] <strong>remote-mep ccm-receive enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2-ma-ma2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2] <strong>quit</strong></pre>
<p># Configure CE2.</p>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>cfm md md2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2] <strong>ma ma2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2-ma-ma2] <strong>mep mep-id 62 interface gigabitEthernet<span>0/1/1</span> outward</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2-ma-ma2] <strong>ccm-interval 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2-ma-ma2] <strong>mep ccm-send enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2-ma-ma2] <strong>remote-mep mep-id 61</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2-ma-ma2] <strong>remote-mep ccm-receive enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2-ma-ma2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2] <strong>quit</strong></pre>
</p></li><li><span>Configure the AIS function.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>cfm md md1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>ma ma1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>ais enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>ais link-status interface gigabitEthernet<span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>ais level 6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>ais interval 60</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1-ma-ma1] <strong>ais vlan vid 10 mep 31</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-md-md1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>cfm md md1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1] <strong>ma ma1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>ais enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>ais link-status interface gigabitEthernet<span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>ais level 6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>ais interval 60</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>ais vlan vid 10 mep 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1-ma-ma1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-md-md1] <strong>commit</strong></pre>
</p></li><li><span>Enable alarm suppression.</span><p><p># Configure CE1.</p>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>cfm md md2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2] <strong>ma ma2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2-ma-ma2] <strong>ais enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2-ma-ma2] <strong>ais suppress-alarm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2-ma-ma2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-md-md2] <strong>commit</strong></pre>
<p># Configure CE2</p>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>cfm md md2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2] <strong>ma ma2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2-ma-ma2] <strong>ais enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2-ma-ma2] <strong>ais suppress-alarm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2-ma-ma2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-md-md2] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>If a fault occurs in the VLL between PE1 and PE2 after the preceding configuration is complete, run the <strong>display cfm ma md md1 ma ma1</strong> command on PE1. The value of the <strong>Sending Ais Packet</strong> field is displayed as <strong>Yes</strong> in the command output. Run the <strong>display cfm ma md md2 ma ma2</strong> command on CE1. The value of the <strong>Suppressing Alarms</strong> field is displayed as <strong>Yes</strong> in the command output.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display cfm ma md md1 ma ma1</strong></pre>
<pre class="screen">The total number of MAs is 1
  MD Name            : md1
  MD Name Format     : string
  Level              : 3
  MIP Create-type    : none
  SenderID TLV-type  : Defer
  MA Name            : ma1
  MA Name Format     : string
  Interval           : 1000
  Priority           : 4
  Vlan ID            : --
<span>  VSI Name           : --
  L2VC ID            : 100 tagged
<span>  L2VPN Name         : --
  CE ID              : --
  CE Offset          : --</span>
<span>  L2TPV3 Tunnel Name            : --</span>
 <span> L2TPV3 Local Connection Name  : --</span></span>
  MEP Number         : 31
  RMEP Number        : 32
  <strong>Suppressing Alarms : No</strong>
  <strong>Sending Ais Packet : Yes</strong>
<span>  Interface TLV      : disabled  </span></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong>display cfm ma md md2 ma ma2</strong></pre>
<pre class="screen">  MD Name            : md2
  MD Name Format     : string
  Level              : 6
  MIP Create-type    : none
  SenderID TLV-type  : Defer
  MA Name            : ma2
  MA Name Format     : string
  Interval           : 10000
  Priority           : 4
  Vlan ID            : 10
<span> VSI Name           : --
  L2VC ID            : 100 tagged
<span>  L2VPN Name         : --
  CE ID              : --
  CE Offset          : --</span>
<span>  L2TPV3 Tunnel Name            : --</span>
 <span> L2TPV3 Local Connection Name  : --</span></span>
  MEP Number         : 61
  RMEP Number        : 62
  <strong>Suppressing Alarms : Yes</strong>
  Sending Ais Packet : NO
  Interface TLV      : disabled  </pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172362185__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#
sysname PE1
#
cfm version standard
cfm enable
#
mpls lsr-id 1.1.1.1
#
mpls
#
mpls l2vpn
#
mpls ldp
#
mpls ldp remote-peer 3.3.3.3
remote-ip 3.3.3.3
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/1</span>.1
 vlan-type dot1q 10
 mpls l2vc 3.3.3.3 100
#
interface GigabitEthernet<span>0/1/2</span>
 ip address 10.1.1.1 255.255.255.252
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 1.1.1.1 255.255.255.255
#
ospf 1
 area 0.0.0.0
  network 1.1.1.1 0.0.0.0
  network 10.1.1.0 0.0.0.3
#
 cfm md md1 
  ma ma1
   map mpls l2vc 100 tagged
   mep mep-id 31 interface GigabitEthernet<span>0/1/1</span>.1 inward
   mep ccm-send enable
   remote-mep mep-id 32
   remote-mep ccm-receive enable
   ais enable
   ais link-status interface gigabitEthernet<span>0/1/2</span>
   ais level 6
   ais interval 60
   ais vlan vid 10 mep 31
#
return </pre>
</li><li><p>P configuration file</p>
<pre class="screen">#
sysname P
#
mpls lsr-id 2.2.2.2
#
mpls
#
mpls ldp
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.2.1.1 255.255.255.252
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/1/2</span>
 ip address 10.1.1.2 255.255.255.252
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 2.2.2.2 255.255.255.255
#
ospf 1
 area 0.0.0.0
  network 2.2.2.2 0.0.0.0
  network 10.1.1.0 0.0.0.3
  network 10.2.1.0 0.0.0.3
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2
#
cfm version standard
cfm enable
#
mpls lsr-id 3.3.3.3
#
mpls
#
mpls l2vpn
#
mpls ldp
#
mpls ldp remote-peer 1.1.1.1
remote-ip 1.1.1.1
#
interface GigabitEthernet<span>0/1/1</span>
undo shutdown
#
interface GigabitEthernet<span>0/1/1</span>.1
 vlan-type dot1q 10
 mpls l2vc 1.1.1.1 100
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 10.2.1.2 255.255.255.252
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 3.3.3.3 255.255.255.255
#
ospf 1
 area 0.0.0.0
  network 5.5.5.5 0.0.0.0
  network 10.2.1.0 0.0.0.3
#
 cfm md md1 
  ma ma1
   map mpls l2vc 100 tagged
   mep mep-id 32 interface GigabitEthernet<span>0/1/1</span>.1 inward
   mep ccm-send enable
   remote-mep mep-id 31
   remote-mep ccm-receive enable
   ais enable
   ais link-status interface gigabitEthernet<span>0/1/2</span>
   ais level 6
   ais interval 60
   ais vlan vid 10 mep 32
#
return </pre>
</li><li><p>CE1 configuration file</p>
<pre class="screen">#
sysname CE1
#
cfm version standard
cfm enable
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 portswitch
 port trunk allow-pass vlan 10
#
cfm md md2 
 ma ma2
  map vlan 10
  mep mep-id 61 interface gigabitEthernet<span>0/1/1</span> outward
  ccm-interval 10000
  mep ccm-send enable
  remote-mep mep-id 62
  remote-mep ccm-receive enable
  ais enable
  ais suppress-alarm
#
return</pre>
</li><li><p>CE2 configuration file</p>
<pre class="screen">#
sysname CE2
#
cfm version standard
cfm enable
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 portswitch
 port trunk allow-pass vlan 10

#
cfm md md2 
  ma ma2
  map vlan 10
  mep mep-id 62 interface gigabitEthernet<span>0/1/1</span> outward
  ccm-interval 10000
  mep ccm-send enable
  remote-mep mep-id 61
  remote-mep ccm-receive enable
  ais enable
  ais suppress-alarm
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_011531.html">Configuration Examples for Y.1731
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_y1731_cfg_0061.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_y1731_cfg_0076.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>