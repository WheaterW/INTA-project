
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring the IETF DS-TE Mode (RDM)">
<meta name="abstract" content="This section provides an example for configuring the IETF DS-TE mode.">
<meta name="description" content="This section provides an example for configuring the IETF DS-TE mode.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0093.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0139.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_te-p2p_cfg_6002.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00845984">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368375">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring the IETF DS-TE Mode (RDM)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172368375"></a><a name="EN-US_TASK_0172368375"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring the IETF DS-TE Mode (RDM)</h1>
<div class="taskbody"><p>This section provides an example for configuring the IETF DS-TE mode.</p>
<div class="context"><a name="EN-US_TASK_0172368375__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0172368375__fig_dc_vrp_te-p2p_cfg_032201">Figure 1</a>, the PEs and P on the MPLS backbone network run IS-IS to implement connectivity between one another. The P does not support MPLS LDP. PE1 and PE2 access both VPN-A and VPN-B. LDP LSPs need to be established between PE3 and PE4 along the path PE1 - P - PE2.</p>
<p>VPN-A transmits AF2 and AF1 traffic. VPN-B transmits AF2, AF1, and BE traffic. The LDP LSPs transmit BE traffic. QoS requirements of each type of traffic are as follows.</p>
<div class="p">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="bottom" width="49.25373134328358%" id="mcps1.4.1.4.1.1.3.1.1" liSelected="liSelected"><p>Data Flow</p>
</th>
<th align="left" class="cellrowborder" valign="bottom" width="50.74626865671642%" id="mcps1.4.1.4.1.1.3.1.2" liSelected="liSelected"><p>Bandwidth</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="49.25373134328358%" headers="mcps1.4.1.4.1.1.3.1.1 "><p>VPN-A AF2 traffic</p>
</td>
<td class="cellrowborder" valign="top" width="50.74626865671642%" headers="mcps1.4.1.4.1.1.3.1.2 "><p>100 Mbit/s</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="49.25373134328358%" headers="mcps1.4.1.4.1.1.3.1.1 "><p>VPN-A AF1 traffic</p>
</td>
<td class="cellrowborder" valign="top" width="50.74626865671642%" headers="mcps1.4.1.4.1.1.3.1.2 "><p>50 Mbit/s</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="49.25373134328358%" headers="mcps1.4.1.4.1.1.3.1.1 "><p>VPN-B AF2 traffic</p>
</td>
<td class="cellrowborder" valign="top" width="50.74626865671642%" headers="mcps1.4.1.4.1.1.3.1.2 "><p>100 Mbit/s</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="49.25373134328358%" headers="mcps1.4.1.4.1.1.3.1.1 "><p>VPN-B AF1 traffic</p>
</td>
<td class="cellrowborder" valign="top" width="50.74626865671642%" headers="mcps1.4.1.4.1.1.3.1.2 "><p>50 Mbit/s</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="49.25373134328358%" headers="mcps1.4.1.4.1.1.3.1.1 "><p>VPN-B BE traffic</p>
</td>
<td class="cellrowborder" valign="top" width="50.74626865671642%" headers="mcps1.4.1.4.1.1.3.1.2 "><p>50 Mbit/s</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="49.25373134328358%" headers="mcps1.4.1.4.1.1.3.1.1 "><p>LDP LSP BE traffic</p>
</td>
<td class="cellrowborder" valign="top" width="50.74626865671642%" headers="mcps1.4.1.4.1.1.3.1.2 "><p>50 Mbit/s</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>A DS-TE tunnel is established between PE1 and PE2 to transfer the preceding types of traffic and satisfy various QoS requirements. The bandwidth constraints model is set to RDM to allow CTi to preempt lower-priority CTj bandwidth (0 &lt;= i &lt; j &lt;= 7) to guarantee higher-priority CT bandwidth.</p>
<div class="fignone" id="EN-US_TASK_0172368375__fig_dc_vrp_te-p2p_cfg_032201"><a name="EN-US_TASK_0172368375__fig_dc_vrp_te-p2p_cfg_032201"></a><a name="fig_dc_vrp_te-p2p_cfg_032201"></a><span class="figcap"><b>Figure 1 </b>IETF DS-TE networking</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 4 in this example represent GE <span>0/1/1</span>, GE <span>0/1/2</span>, GE <span>0/1/3</span>, and GE <span>0/1/4</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_te-p2p_cfg_032201.png"></span></div>
<p><a href="#EN-US_TASK_0172368375__fig636494771013">Figure 2</a> provides the configuration guidelines for IS-IS, RSVP-TE, OSPF, and LDP in this example.</p>
<div class="fignone" id="EN-US_TASK_0172368375__fig636494771013"><a name="EN-US_TASK_0172368375__fig636494771013"></a><a name="fig636494771013"></a><span class="figcap"><b>Figure 2 </b>Configuration guidelines for IS-IS, RSVP-TE, OSPF, and LDP in this example</span><br><span><img class="vsd" src="figure/en-us_image_0000001552021269.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368375__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>During the configuration, note the following:</p>
<ol><li>Since each tunnel can be configured with a single CT, establish a tunnel for LDP LSPs to carry CT0. Establish two tunnels in VPN-A, with each of them carrying a different CT, namely CT1 and CT2. Establish three tunnels in VPN-B, with each of them carrying a different CT, namely CT0, CT1, and CT2.</li><li>Configure CT0, CT1, and CT2 to carry BE, AF1, and AF2 flows, respectively.</li><li>Since the tunnels pass through the same path, configure the BCi link bandwidth value to be greater than or equal to the sum of CTi through CT7 bandwidth values of all TE tunnels, and configure the maximum link reservable bandwidth to be greater than or equal to the BC0 bandwidth value. Therefore, BC2 bandwidth â¥ Total AF2 bandwidth = 200 Mbit/s; BC1 bandwidth â¥ (BC2 bandwidth + Total AF1 bandwidth) = 300 Mbit/s; reservable link bandwidth â¥ BC0 bandwidth â¥ (BC1 bandwidth + Total BE bandwidth) = 400 Mbit/s.</li><li>Use a CT template to configure TE tunnels because the same type of service in different tunnels has the same bandwidth requirement.</li><li>Configure IGP forwarding adjacencies on PE1 and PE2 because LDP LSPs between PE3 and PE4 need to be implemented through LDP over TE.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368375__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Assign an IP address to each interface on the PEs and P and configure IS-IS to implement connectivity between the PEs and P.</li><li>Configure an LSR ID and enable MPLS on the PEs and P. Enable MPLS TE and RSVP-TE on PE1, PE2, and the P.</li><li>Configure IS-IS TE and enable CSPF on PE1, PE2, and the P.</li><li>Configure a DS-TE mode and a BCM on PE1, PE2, and the P.</li><li>Configure link bandwidth values on PE1, PE2, and the P.</li><li>Configure a TE-class mapping table on PE1 and PE2.</li><li>Configure explicit paths on PE1 and PE2.</li><li>Create tunnel interfaces on PE1 and PE2 to carry services of different levels using tunnels of different CTs.</li><li>Configure forwarding adjacencies on the ingresses of TE tunnels and establish remote LDP peer relationships between the ingresses and egresses of the TE tunnels.</li><li>Enable MPLS LDP on all PEs, establish an LDP peer relationship between PE1 and PE3, and establish an LDP peer relationship between PE2 and PE4. This step is performed to establish an LDP LSP between PE3 and PE4.</li><li>Establish an MP-IBGP peer relationship between PE1 and PE2, and establish EBGP peer relationships between the PEs and CEs.</li><li>Configure tunnel policies on PE1 and PE2.</li><li>Configure VPN instances on PE1 and PE2 to enable a CE to access the corresponding PE.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368375__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li>LSR IDs of PEs and the P</li><li>Number of each MPLS TE tunnel interface</li><li>TE-class mapping table</li><li>Maximum reservable bandwidth value and each BC bandwidth value of each link</li><li>VPN-A's and VPN-B's VPN instance names, route distinguishers, VPN-Targets, and tunnel policy name</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172368375__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface on the PEs and P and configure IS-IS to implement connectivity between the PEs and P.</span><p><p>For configuration details, see <a href="#EN-US_TASK_0172368375__section_dc_vrp_cfg_00694305">Configuration Files</a> in this section.</p>
<p>After the configuration, IS-IS neighbor relationships can be established between PE1, P, and PE2. Run the <strong>display ip routing-table</strong> command. The command output shows that the PEs have learned the routes to Loopback 1 of each other.</p>
</p></li><li><span>Configure an LSR ID and enable MPLS, MPLS TE, and RSVP-TE on PE1, PE2, and the P.</span><p><p># Configure PE1.</p>
<pre class="screen">&lt;PE1&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>mpls lsr-id 1.1.1.9</strong>
[<span class="keyword">*</span>PE1] <strong>mpls</strong>
[<span class="keyword">*</span>PE1-mpls] <strong>mpls te</strong>
[<span class="keyword">*</span>PE1-mpls] <strong>mpls rsvp-te</strong>
[<span class="keyword">*</span>PE1-mpls] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-mpls] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/1/3</span></strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/3</span>] <strong>mpls</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/3</span>] <strong>mpls te</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/3</span>] <strong>mpls rsvp-te</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/3</span>] <strong>quit</strong></pre>
<p># Configure the P.</p>
<pre class="screen">&lt;P&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong>mpls lsr-id 2.2.2.9</strong>
[<span class="keyword">*</span>P] <strong>mpls</strong>
[<span class="keyword">*</span>P-mpls] <strong>mpls te</strong>
[<span class="keyword">*</span>P-mpls] <strong>mpls rsvp-te</strong>
[<span class="keyword">*</span>P-mpls] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P-mpls] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong>interface gigabitethernet <span>0/1/1</span></strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>] <strong>mpls</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>] <strong>mpls te</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>] <strong>mpls rsvp-te</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong>interface gigabitethernet <span>0/1/2</span></strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>] <strong>mpls</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>] <strong>mpls te</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>] <strong>mpls rsvp-te</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">&lt;PE2&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>mpls lsr-id 3.3.3.9</strong>
[<span class="keyword">*</span>PE2] <strong>mpls</strong>
[<span class="keyword">*</span>PE2-mpls] <strong>mpls te</strong>
[<span class="keyword">*</span>PE2-mpls] <strong>mpls rsvp-te</strong>
[<span class="keyword">*</span>PE2-mpls] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-mpls] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet <span>0/1/3</span></strong>
[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong>mpls</strong>
[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong>mpls te</strong>
[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong>mpls rsvp-te</strong>
[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong>quit</strong></pre>
<p>After completing the configuration, run the <strong>display mpls rsvp-te interface</strong> command on PE1, PE2, or the P to check RSVP interface information and RSVP information.</p>
</p></li><li><span>Configure IS-IS TE and enable CSPF on PE1, PE2, and the P.</span><p><p># Enable IS-IS TE on all nodes and enable CSPF on the ingress of the TE tunnel.</p>
<p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>isis 1</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-isis-1] <strong>is-level level-1</strong>
[<span class="keyword">*</span>PE1-isis-1] <strong>cost-style wide</strong>
[<span class="keyword">*</span>PE1-isis-1] <strong>traffic-eng level-1</strong>
[<span class="keyword">*</span>PE1-isis-1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-isis-1] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>mpls</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-mpls] <strong>mpls te cspf</strong>
[<span class="keyword">*</span>PE1-mpls] <strong>commit</strong></pre>
<p># Configure the P.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong>isis 1</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P-isis-1]<strong> is-level level-1</strong>
[<span class="keyword">*</span>P-isis-1] <strong>cost-style wide</strong>
[<span class="keyword">*</span>P-isis-1] <strong>traffic-eng level-1</strong>
[<span class="keyword">*</span>P-isis-1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P-isis-1] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>isis 1</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-isis-1] <strong>is-level level-1</strong>
[<span class="keyword">*</span>PE2-isis-1] <strong>cost-style wide</strong>
[<span class="keyword">*</span>PE2-isis-1] <strong>traffic-eng level-1</strong>
[<span class="keyword">*</span>PE2-isis-1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-isis-1] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>mpls</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-mpls] <strong>mpls te cspf</strong>
[<span class="keyword">*</span>PE2-mpls] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-mpls] <strong>quit</strong></pre>
<p>After completing the configuration, run the <strong>display isis lsdb</strong> command on a PE or the P. The command output shows that the IS-IS link status information.</p>
</p></li><li><span>Configure a DS-TE mode and a BCM on PE1, PE2, and the P.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>mpls</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-mpls] <strong>mpls te ds-te mode ietf</strong>
[<span class="keyword">*</span>PE1-mpls] <strong>mpls te ds-te bcm rdm</strong>
[<span class="keyword">*</span>PE1-mpls] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-mpls] <strong>quit</strong></pre>
<p># Configure the P.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong>mpls</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P-mpls] <strong>mpls te ds-te mode ietf</strong>
[<span class="keyword">*</span>P-mpls] <strong>mpls te ds-te bcm rdm</strong>
[<span class="keyword">*</span>P-mpls] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P-mpls] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>mpls</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-mpls] <strong>mpls te ds-te mode ietf</strong>
[<span class="keyword">*</span>PE2-mpls] <strong>mpls te ds-te bcm rdm</strong>
[<span class="keyword">*</span>PE2-mpls] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-mpls] <strong>quit</strong></pre>
<p>After completing the configuration, run the <strong>display mpls te ds-te summary</strong> command on a PE or the P to check DS-TE configurations. The following example uses the command output on PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display mpls te ds-te summary</strong>
DS-TE IETF Supported :YES
DS-TE MODE           :IETF
Bandwidth Constraint Model  :RDM
TEClass Mapping (configured):
TE-Class ID    Class Type     Priority
TE-Class 0     0              0
TE-Class 1     1              0
TE-Class 2     2              0
TE-Class 3     3              0
TE-Class 4     0              7
TE-Class 5     1              7
TE-Class 6     2              7
TE-Class 7     3              7</pre>
</p></li><li><span>Configure link bandwidth values on PE1, PE2, and the P.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface gigabitethernet <span>0/1/3</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/3</span>] <strong>mpls te bandwidth max-reservable-bandwidth 400000</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/3</span>] <strong>mpls te bandwidth bc0 400000 bc1 300000 bc2 200000</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/3</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/3</span>] <strong>quit</strong></pre>
<p># Configure the P.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong>interface gigabitethernet <span>0/1/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P-GigabitEthernet<span>0/1/1</span>] <strong>mpls te bandwidth max-reservable-bandwidth 400000</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>] <strong>mpls te bandwidth bc0 400000 bc1 300000 bc2 200000</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong>interface gigabitethernet <span>0/1/2</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P-GigabitEthernet<span>0/1/2</span>] <strong>mpls te bandwidth max-reservable-bandwidth 400000</strong>
[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/2</span>] <strong>mpls te bandwidth bc0 400000 bc1 300000 bc2 200000</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface gigabitethernet <span>0/1/3</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/3</span>] <strong>mpls te bandwidth max-reservable-bandwidth 400000</strong>
[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong>mpls te bandwidth bc0 400000 bc1 300000 bc2 200000</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/3</span>] <strong>quit</strong></pre>
<p>After completing the configuration, run the <strong>display mpls te link-administration bandwidth-allocation interface gigabitethernet</strong> command on a PE to check BC bandwidth allocation information. The following example uses the command output on PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display mpls te link-administration bandwidth-allocation interface gigabitethernet <span>0/1/3</span></strong>
  Link ID:  GigabitEthernet<span>0/1/3</span>
  Bandwidth Constraint Model   :  Russian Dolls Model (RDM)
  Physical Link Bandwidth(Kbits/sec)         :  -
  Maximum Link Reservable Bandwidth(Kbit/sec):  400000
  Reservable Bandwidth BC0(Kbit/sec)         :  400000
  Reservable Bandwidth BC1(Kbit/sec)         :  300000
  Reservable Bandwidth BC2(Kbit/sec)         :  200000
  Reservable Bandwidth BC3(Kbit/sec)         :  0
  Reservable Bandwidth BC4(Kbit/sec)         :  0
  Reservable Bandwidth BC5(Kbit/sec)         :  0
  Reservable Bandwidth BC6(Kbit/sec)         :  0
  Reservable Bandwidth BC7(Kbit/sec)         :  0
  Downstream Bandwidth (Kbit/sec)           :   0
  IPUpdown Link Status                       :  UP
  PhysicalUpdown Link Status                 :  UP
  ----------------------------------------------------------------------
  TE-CLASS  CT    PRIORITY   BW RESERVED   BW AVAILABLE   DOWNSTREAM
                             (Kbit/sec)     (Kbit/sec) RSVPLSPNODE COUNT
  ----------------------------------------------------------------------
     0      0        0           0             400000           0
     1      1        0           0             300000           0
     2      2        0           0             200000           0
     3      0        7           0             400000           0
     4      1        7           0             300000           0
     5      2        7           0             200000           0
     6      -        -           -             -                -
     7      -        -           -             -                -
     8      -        -           -             -                -
     9      -        -           -             -                -
     10     -        -           -             -                -
     11     -        -           -             -                -
     12     -        -           -             -                -
     13     -        -           -             -                -
     14     -        -           -             -                -
     15     -        -           -             -                -
  ----------------------------------------------------------------------
</pre>
</p></li><li><span>Configure a TE-class mapping table on PE1 and PE2.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>te-class-mapping</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-te-class-mapping] <strong>te-class0 class-type ct0 priority 0 description For-BE</strong>
[<span class="keyword">*</span>PE1-te-class-mapping] <strong>te-class1 class-type ct1 priority 0 description For-AF1</strong>
[<span class="keyword">*</span>PE1-te-class-mapping] <strong>te-class2 class-type ct2 priority 0 description For-AF2</strong>
[<span class="keyword">*</span>PE1-te-class-mapping] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-te-class-mapping] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>te-class-mapping</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-te-class-mapping] <strong>te-class0 class-type ct0 priority 0 description For-BE</strong>
[<span class="keyword">*</span>PE2-te-class-mapping] <strong>te-class1 class-type ct1 priority 0 description For-AF1</strong>
[<span class="keyword">*</span>PE2-te-class-mapping] <strong>te-class2 class-type ct2 priority 0 description For-AF2</strong>
[<span class="keyword">*</span>PE2-te-class-mapping] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-te-class-mapping] <strong>quit</strong></pre>
<p>After completing the configuration, run the <strong>display mpls te ds-te te-class-mapping</strong> command on a PE to check TE-class mapping table information. The following example uses the command output on PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display mpls te ds-te te-class-mapping</strong>
  TE-Class ID         Class Type     Priority       Description
  TE-Class0           0              0              For-BE
  TE-Class1           1              0              For-AF1
  TE-Class2           2              0              For-AF2
  TE-Class3           -              -              -
  TE-Class4           -              -              -
  TE-Class5           -              -              -
  TE-Class6           -              -              -
  TE-Class7           -              -              -</pre>
</p></li><li><span>Configure explicit paths on PE1 and PE2.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>explicit-path path1</strong>
[<span class="keyword">*</span>PE1-explicit-path-path1] <strong>next hop 10.10.1.2</strong>
[<span class="keyword">*</span>PE1-explicit-path-path1] <strong>next hop 10.11.1.2</strong>
[<span class="keyword">*</span>PE1-explicit-path-path1] <strong>next hop 3.3.3.9</strong>
[<span class="keyword">*</span>PE1-explicit-path-path1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-explicit-path-path1] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>explicit-path path1</strong>
[<span class="keyword">*</span>PE2-explicit-path-path1] <strong>next hop 10.11.1.1</strong>
[<span class="keyword">*</span>PE2-explicit-path-path1] <strong>next hop 10.10.1.1</strong>
[<span class="keyword">*</span>PE2-explicit-path-path1] <strong>next hop 1.1.1.9</strong>
[<span class="keyword">*</span>PE2-explicit-path-path1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-explicit-path-path1] <strong>quit</strong></pre>
<p>After completing the configuration, run the <strong>display explicit-path</strong> command on a PE to check explicit path information. The following example uses the command output on PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display explicit-path path1</strong>
Path Name : path1       Path Status : Enabled
 1      10.10.1.2         Strict      Include
 2      10.11.1.2         Strict      Include
 3      3.3.3.9           Strict      Include</pre>
</p></li><li><span>Create tunnel interfaces on PE1 and PE2.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface tunnel10</strong>
[<span class="keyword">*</span>PE1-Tunnel10] <strong>description For VPN-A &amp; Non-VPN</strong>
[<span class="keyword">*</span>PE1-Tunnel10] <strong>ip address unnumbered interface loopback 1</strong>
[<span class="keyword">*</span>PE1-Tunnel10] <strong>tunnel-protocol mpls te</strong>
[<span class="keyword">*</span>PE1-Tunnel10] <strong>destination 3.3.3.9</strong>
[<span class="keyword">*</span>PE1-Tunnel10] <strong>mpls te tunnel-id 10</strong>
[<span class="keyword">*</span>PE1-Tunnel10] <strong>mpls te signal-protocol rsvp-te</strong>
[<span class="keyword">*</span>PE1-Tunnel10] <strong>mpls te path explicit-path path1</strong>
[<span class="keyword">*</span>PE1-Tunnel10] <strong>mpls te priority 0 0</strong>
[<span class="keyword">*</span>PE1-Tunnel10] <strong>mpls te bandwidth ct0 50000</strong>
[<span class="keyword">*</span>PE1-Tunnel10] <strong>mpls te reserved-for-binding</strong>
[<span class="keyword">*</span>PE1-Tunnel10] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Tunnel10] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface tunnel11</strong>
[<span class="keyword">*</span>PE1-Tunnel11] <strong>description For VPN-A &amp; Non-VPN</strong>
[<span class="keyword">*</span>PE1-Tunnel11] <strong>ip address unnumbered interface loopback 1</strong>
[<span class="keyword">*</span>PE1-Tunnel11] <strong>tunnel-protocol mpls te</strong>
[<span class="keyword">*</span>PE1-Tunnel11] <strong>destination 3.3.3.9</strong>
[<span class="keyword">*</span>PE1-Tunnel11] <strong>mpls te tunnel-id 11</strong>
[<span class="keyword">*</span>PE1-Tunnel11] <strong>mpls te signal-protocol rsvp-te</strong>
[<span class="keyword">*</span>PE1-Tunnel11] <strong>mpls te path explicit-path path1</strong>
[<span class="keyword">*</span>PE1-Tunnel11] <strong>mpls te priority 0 0</strong>
[<span class="keyword">*</span>PE1-Tunnel11] <strong>mpls te bandwidth ct1 50000</strong>
[<span class="keyword">*</span>PE1-Tunnel11] <strong>mpls te reserved-for-binding</strong>
[<span class="keyword">*</span>PE1-Tunnel11] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Tunnel11] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface tunnel12</strong>
[<span class="keyword">*</span>PE1-Tunnel12] <strong>description For VPN-A &amp; Non-VPN</strong>
[<span class="keyword">*</span>PE1-Tunnel12] <strong>ip address unnumbered interface loopback 1</strong>
[<span class="keyword">*</span>PE1-Tunnel12] <strong>tunnel-protocol mpls te</strong>
[<span class="keyword">*</span>PE1-Tunnel12] <strong>destination 3.3.3.9</strong>
[<span class="keyword">*</span>PE1-Tunnel12] <strong>mpls te tunnel-id 12</strong>
[<span class="keyword">*</span>PE1-Tunnel12] <strong>mpls te signal-protocol rsvp-te</strong>
[<span class="keyword">*</span>PE1-Tunnel12] <strong>mpls te path explicit-path path1</strong>
[<span class="keyword">*</span>PE1-Tunnel12] <strong>mpls te priority 0 0</strong>
[<span class="keyword">*</span>PE1-Tunnel12] <strong>mpls te bandwidth ct2 100000</strong>
[<span class="keyword">*</span>PE1-Tunnel12] <strong>mpls te reserved-for-binding</strong>
[<span class="keyword">*</span>PE1-Tunnel12] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Tunnel12] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface tunnel20</strong>
[<span class="keyword">*</span>PE1-Tunnel20] <strong>description For VPN-B</strong>
[<span class="keyword">*</span>PE1-Tunnel20] <strong>ip address unnumbered interface loopback 1</strong>
[<span class="keyword">*</span>PE1-Tunnel20] <strong>tunnel-protocol mpls te</strong>
[<span class="keyword">*</span>PE1-Tunnel20] <strong>destination 3.3.3.9</strong>
[<span class="keyword">*</span>PE1-Tunnel20] <strong>mpls te tunnel-id 20</strong>
[<span class="keyword">*</span>PE1-Tunnel20] <strong>mpls te signal-protocol rsvp-te</strong>
[<span class="keyword">*</span>PE1-Tunnel20] <strong>mpls te path explicit-path path1</strong>
[<span class="keyword">*</span>PE1-Tunnel20] <strong>mpls te priority 0 0</strong>
[<span class="keyword">*</span>PE1-Tunnel20] <strong><strong>mpls te bandwidth ct0 50000</strong></strong>
[<span class="keyword">*</span>PE1-Tunnel20] <strong>mpls te reserved-for-binding</strong>
[<span class="keyword">*</span>PE1-Tunnel20] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Tunnel20] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface tunnel2</strong><strong>1</strong>
[<span class="keyword">*</span>PE1-Tunnel21] <strong>description For VPN-B</strong>
[<span class="keyword">*</span>PE1-Tunnel21] <strong>ip address unnumbered interface loopback 1</strong>
[<span class="keyword">*</span>PE1-Tunnel21] <strong>tunnel-protocol mpls te</strong>
[<span class="keyword">*</span>PE1-Tunnel21] <strong>destination 3.3.3.9</strong>
[<span class="keyword">*</span>PE1-Tunnel21] <strong>mpls te tunnel-id 2</strong><strong>1</strong>
[<span class="keyword">*</span>PE1-Tunnel21] <strong>mpls te signal-protocol rsvp-te</strong>
[<span class="keyword">*</span>PE1-Tunnel21] <strong>mpls te path explicit-path path1</strong>
[<span class="keyword">*</span>PE1-Tunnel21] <strong>mpls te priority 0 0</strong>
[<span class="keyword">*</span>PE1-Tunnel21] <strong>mpls te bandwidth ct1 50000</strong>
[<span class="keyword">*</span>PE1-Tunnel21] <strong>mpls te reserved-for-binding</strong>
[<span class="keyword">*</span>PE1-Tunnel21] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Tunnel21] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface tunnel22</strong>
[<span class="keyword">*</span>PE1-Tunnel22] <strong>description For VPN-B</strong>
[<span class="keyword">*</span>PE1-Tunnel22] <strong>ip address unnumbered interface loopback 1</strong>
[<span class="keyword">*</span>PE1-Tunnel22] <strong>tunnel-protocol mpls te</strong>
[<span class="keyword">*</span>PE1-Tunnel22] <strong>destination 3.3.3.9</strong>
[<span class="keyword">*</span>PE1-Tunnel22] <strong>mpls te tunnel-id 22</strong>
[<span class="keyword">*</span>PE1-Tunnel22] <strong>mpls te signal-protocol rsvp-te</strong>
[<span class="keyword">*</span>PE1-Tunnel22] <strong>mpls te path explicit-path path1</strong>
[<span class="keyword">*</span>PE1-Tunnel22] <strong>mpls te priority 0 0</strong>
[<span class="keyword">*</span>PE1-Tunnel22] <strong>mpls te bandwidth ct2 100000</strong>
[<span class="keyword">*</span>PE1-Tunnel22] <strong>mpls te reserved-for-binding</strong>
[<span class="keyword">*</span>PE1-Tunnel22] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Tunnel22] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface tunnel10</strong>
[<span class="keyword">*</span>PE2-Tunnel10] <strong>description For VPN-A &amp; Non-VPN</strong>
[<span class="keyword">*</span>PE2-Tunnel10] <strong>ip address unnumbered interface loopback 1</strong>
[<span class="keyword">*</span>PE2-Tunnel10] <strong>tunnel-protocol mpls te</strong>
[<span class="keyword">*</span>PE2-Tunnel10] <strong>destination 1.1.1.9</strong>
[<span class="keyword">*</span>PE2-Tunnel10] <strong>mpls te tunnel-id 10</strong>
[<span class="keyword">*</span>PE2-Tunnel10] <strong>mpls te signal-protocol rsvp-te</strong>
[<span class="keyword">*</span>PE2-Tunnel10] <strong>mpls te path explicit-path path1</strong>
[<span class="keyword">*</span>PE2-Tunnel10] <strong>mpls te priority 0 0</strong>
[<span class="keyword">*</span>PE2-Tunnel10] <strong>mpls te bandwidth ct0 50000</strong>
[<span class="keyword">*</span>PE2-Tunnel10] <strong>mpls te reserved-for-binding</strong>
[<span class="keyword">*</span>PE2-Tunnel10] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Tunnel10] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface tunnel11</strong>
[<span class="keyword">*</span>PE2-Tunnel11] <strong>description For VPN-A &amp; Non-VPN</strong>
[<span class="keyword">*</span>PE2-Tunnel11] <strong>ip address unnumbered interface loopback 1</strong>
[<span class="keyword">*</span>PE2-Tunnel11] <strong>tunnel-protocol mpls te</strong>
[<span class="keyword">*</span>PE2-Tunnel11] <strong>destination 1.1.1.9</strong>
[<span class="keyword">*</span>PE2-Tunnel11] <strong>mpls te tunnel-id 11</strong>
[<span class="keyword">*</span>PE2-Tunnel11] <strong>mpls te signal-protocol rsvp-te</strong>
[<span class="keyword">*</span>PE2-Tunnel11] <strong>mpls te path explicit-path path1</strong>
[<span class="keyword">*</span>PE2-Tunnel11] <strong>mpls te priority 0 0</strong>
[<span class="keyword">*</span>PE2-Tunnel11] <strong>mpls te bandwidth ct1 50000</strong>
[<span class="keyword">*</span>PE2-Tunnel11] <strong>mpls te reserved-for-binding</strong>
[<span class="keyword">*</span>PE2-Tunnel11] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Tunnel11] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface tunnel12</strong>
[<span class="keyword">*</span>PE2-Tunnel12] <strong>description For VPN-A &amp; Non-VPN</strong>
[<span class="keyword">*</span>PE2-Tunnel12] <strong>ip address unnumbered interface loopback 1</strong>
[<span class="keyword">*</span>PE2-Tunnel12] <strong>tunnel-protocol mpls te</strong>
[<span class="keyword">*</span>PE2-Tunnel12] <strong>destination 1.1.1.9</strong>
[<span class="keyword">*</span>PE2-Tunnel12] <strong>mpls te tunnel-id 12</strong>
[<span class="keyword">*</span>PE2-Tunnel12] <strong>mpls te signal-protocol rsvp-te</strong>
[<span class="keyword">*</span>PE2-Tunnel12] <strong>mpls te path explicit-path path1</strong>
[<span class="keyword">*</span>PE2-Tunnel12] <strong>mpls te priority 0 0</strong>
[<span class="keyword">*</span>PE2-Tunnel12] <strong>mpls te bandwidth ct2 100000</strong>
[<span class="keyword">*</span>PE2-Tunnel12] <strong>mpls te reserved-for-binding</strong>
[<span class="keyword">*</span>PE2-Tunnel12] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Tunnel12] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface tunnel20</strong>
[<span class="keyword">*</span>PE2-Tunnel20] <strong>description For VPN-B</strong>
[<span class="keyword">*</span>PE2-Tunnel20] <strong>ip address unnumbered interface loopback 1</strong>
[<span class="keyword">*</span>PE2-Tunnel20] <strong>tunnel-protocol mpls te</strong>
[<span class="keyword">*</span>PE2-Tunnel20] <strong>destination 1.1.1.9</strong>
[<span class="keyword">*</span>PE2-Tunnel20] <strong>mpls te tunnel-id 20</strong>
[<span class="keyword">*</span>PE2-Tunnel20] <strong>mpls te signal-protocol rsvp-te</strong>
[<span class="keyword">*</span>PE2-Tunnel20] <strong>mpls te path explicit-path path1</strong>
[<span class="keyword">*</span>PE2-Tunnel20] <strong>mpls te priority 0 0</strong>
[<span class="keyword">*</span>PE2-Tunnel20] <strong>mpls te bandwidth ct0 50000</strong>
[<span class="keyword">*</span>PE2-Tunnel20] <strong>mpls te reserved-for-binding</strong>
[<span class="keyword">*</span>PE2-Tunnel20] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Tunnel20] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface tunnel21</strong>
[<span class="keyword">*</span>PE2-Tunnel21] <strong>description For VPN-B</strong>
[<span class="keyword">*</span>PE2-Tunnel21] <strong>ip address unnumbered interface loopback 1</strong>
[<span class="keyword">*</span>PE2-Tunnel21] <strong>tunnel-protocol mpls te</strong>
[<span class="keyword">*</span>PE2-Tunnel21] <strong>destination 1.1.1.9</strong>
[<span class="keyword">*</span>PE2-Tunnel21] <strong>mpls te tunnel-id 21</strong>
[<span class="keyword">*</span>PE2-Tunnel21] <strong>mpls te signal-protocol rsvp-te</strong>
[<span class="keyword">*</span>PE2-Tunnel21] <strong>mpls te path explicit-path path1</strong>
[<span class="keyword">*</span>PE2-Tunnel21] <strong>mpls te priority 0 0</strong>
[<span class="keyword">*</span>PE2-Tunnel21] <strong>mpls te bandwidth ct1 50000</strong>
[<span class="keyword">*</span>PE2-Tunnel21] <strong>mpls te reserved-for-binding</strong>
[<span class="keyword">*</span>PE2-Tunnel21] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Tunnel21] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface tunnel22</strong>
[<span class="keyword">*</span>PE2-Tunnel22] <strong>description For VPN-B</strong>
[<span class="keyword">*</span>PE2-Tunnel22] <strong>ip address unnumbered interface loopback 1</strong>
[<span class="keyword">*</span>PE2-Tunnel22] <strong>tunnel-protocol mpls te</strong>
[<span class="keyword">*</span>PE2-Tunnel22] <strong>destination 1.1.1.9</strong>
[<span class="keyword">*</span>PE2-Tunnel22] <strong>mpls te tunnel-id 2</strong><strong>2</strong>
[<span class="keyword">*</span>PE2-Tunnel22] <strong>mpls te signal-protocol rsvp-te</strong>
[<span class="keyword">*</span>PE2-Tunnel22] <strong>mpls te path explicit-path path1</strong>
[<span class="keyword">*</span>PE2-Tunnel22] <strong>mpls te priority 0 0</strong>
[<span class="keyword">*</span>PE2-Tunnel22] <strong>mpls te bandwidth ct2 100000</strong>
[<span class="keyword">*</span>PE2-Tunnel22] <strong>mpls te reserved-for-binding</strong>
[<span class="keyword">*</span>PE2-Tunnel22] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Tunnel22] <strong>quit</strong></pre>
<p>After completing the configuration, run the <strong>display interface tunnel</strong><em> interface-number</em> command on a PE to check whether the tunnel interface state is <strong>UP</strong>. The following example the command output for Tunnel10 of PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display interface tunnel10</strong>
Tunnel1 current state : UP(ifindex: 27)
Line protocol current state : <strong>UP</strong>
Description: For VPN-A &amp; Non-VPN
Route Port,The Maximum Transmit Unit is 1500
Internet Address is unnumbered, using address of LoopBack0(1.1.1.9/32)
Encapsulation is TUNNEL, loopback not set
Tunnel destination 3.3.3.9
Tunnel up/down statistics 0
Tunnel ct0 bandwidth is 0 Kbit/sec
Tunnel protocol/transport MPLS/MPLS, ILM is disabled
primary tunnel id is 0x0, secondary tunnel id is 0x0
Current system time: 2017-07-19 06:46:59
    0 seconds output rate 0 bits/sec, 0 packets/sec
    0 seconds output rate 0 bits/sec, 0 packets/sec
    0 packets output,  0 bytes
    0 output error
    0 output drop
    Last 300 seconds input utility rate:  --
    Last 300 seconds output utility rate: --</pre>
<p>Run the <strong>display mpls te te-class-tunnel</strong> command on a PE to check information about a TE tunnel associated with a TE-class. The following example uses the command output on PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display mpls te te-class-tunnel ct0</strong><strong> priority 0</strong>
----------------------------------------------------------
No. CT     priority      status       tunnel name         
----------------------------------------------------------
1   0       0            Valid         Tunnel10           
2   0       0            Valid         Tunnel20           </pre>
</p></li><li><span>Configure forwarding adjacencies on the ingresses (PE1 and PE2) of TE tunnels and establish remote LDP peer relationships between the ingresses and egresses of the TE tunnels.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface tunnel10</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Tunnel10] <strong>mpls te igp advertise</strong>
[<span class="keyword">*</span>PE1-Tunnel10] <strong>mpls te igp metric absolute 1</strong>
[<span class="keyword">*</span>PE1-Tunnel10] <strong>mpls</strong>
[<span class="keyword">*</span>PE1-Tunnel10] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface tunnel11</strong>
[<span class="keyword">*</span>PE1-Tunnel11] <strong>mpls te igp advertise</strong>
[<span class="keyword">*</span>PE1-Tunnel11] <strong>mpls te igp metric absolute 1</strong>
[<span class="keyword">*</span>PE1-Tunnel11] <strong>mpls</strong>
[<span class="keyword">*</span>PE1-Tunnel11] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface tunnel12</strong>
[<span class="keyword">*</span>PE1-Tunnel12] <strong>mpls te igp advertise</strong>
[<span class="keyword">*</span>PE1-Tunnel12] <strong>mpls te igp metric absolute 1</strong>
[<span class="keyword">*</span>PE1-Tunnel12] <strong>mpls</strong>
[<span class="keyword">*</span>PE1-Tunnel12] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface tunnel20</strong>
[<span class="keyword">*</span>PE1-Tunnel20] <strong>mpls te igp advertise</strong>
[<span class="keyword">*</span>PE1-Tunnel20] <strong>mpls te igp metric absolute 1</strong>
[<span class="keyword">*</span>PE1-Tunnel20] <strong>mpls</strong>
[<span class="keyword">*</span>PE1-Tunnel20] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface tunnel21</strong>
[<span class="keyword">*</span>PE1-Tunnel21] <strong>mpls te igp advertise</strong>
[<span class="keyword">*</span>PE1-Tunnel21] <strong>mpls te igp metric absolute 1</strong>
[<span class="keyword">*</span>PE1-Tunnel21] <strong>mpls</strong>
[<span class="keyword">*</span>PE1-Tunnel21] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface tunnel22</strong>
[<span class="keyword">*</span>PE1-Tunnel22] <strong>mpls te igp advertise</strong>
[<span class="keyword">*</span>PE1-Tunnel22] <strong>mpls te igp metric absolute 1</strong>
[<span class="keyword">*</span>PE1-Tunnel22] <strong>mpls</strong>
[<span class="keyword">*</span>PE1-Tunnel22] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>ospf 1</strong>
[<span class="keyword">*</span>PE1-ospf-1] <strong>opaque-capability enable</strong>
[<span class="keyword">*</span>PE1-ospf-1] <strong>enable traffic-adjustment advertise</strong>
[<span class="keyword">*</span>PE1-ospf-1] <strong>area 0</strong>
[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>network 1.1.1.9 0.0.0.0</strong>
[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>mpls-te enable</strong>
[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span>PE1-ospf-1] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>mpls ldp remote-peer pe1tope2</strong>
[<span class="keyword">*</span>PE1-mpls-ldp-remote-pe1tope2] <strong>remote-ip 3.3.3.9</strong>
[<span class="keyword">*</span>PE1-mpls-ldp-remote-pe1tope2] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-mpls-ldp-remote-pe1tope2] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface tunnel10</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Tunnel10] <strong>mpls te igp advertise</strong>
[<span class="keyword">*</span>PE2-Tunnel10] <strong>mpls te igp metric absolute 1</strong>
[<span class="keyword">*</span>PE2-Tunnel10] <strong>mpls</strong>
[<span class="keyword">*</span>PE2-Tunnel10] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>interface tunnel11</strong>
[<span class="keyword">*</span>PE2-Tunnel11] <strong>mpls te igp advertise</strong>
[<span class="keyword">*</span>PE2-Tunnel11] <strong>mpls te igp metric absolute 1</strong>
[<span class="keyword">*</span>PE2-Tunnel11] <strong>mpls</strong>
[<span class="keyword">*</span>PE2-Tunnel11] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>interface tunnel12</strong>
[<span class="keyword">*</span>PE2-Tunnel12] <strong>mpls te igp advertise</strong>
[<span class="keyword">*</span>PE2-Tunnel12] <strong>mpls te igp metric absolute 1</strong>
[<span class="keyword">*</span>PE2-Tunnel12] <strong>mpls</strong>
[<span class="keyword">*</span>PE2-Tunnel12] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>interface tunnel20</strong>
[<span class="keyword">*</span>PE2-Tunnel20] <strong>mpls te igp advertise</strong>
[<span class="keyword">*</span>PE2-Tunnel20] <strong>mpls te igp metric absolute 1</strong>
[<span class="keyword">*</span>PE2-Tunnel20] <strong>mpls</strong>
[<span class="keyword">*</span>PE2-Tunnel20] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>interface tunnel21</strong>
[<span class="keyword">*</span>PE2-Tunnel21] <strong>mpls te igp advertise</strong>
[<span class="keyword">*</span>PE2-Tunnel21] <strong>mpls te igp metric absolute 1</strong>
[<span class="keyword">*</span>PE2-Tunnel21] <strong>mpls</strong>
[<span class="keyword">*</span>PE2-Tunnel21] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>interface tunnel22</strong>
[<span class="keyword">*</span>PE2-Tunnel22] <strong>mpls te igp advertise</strong>
[<span class="keyword">*</span>PE2-Tunnel22] <strong>mpls te igp metric absolute 1</strong>
[<span class="keyword">*</span>PE2-Tunnel22] <strong>mpls</strong>
[<span class="keyword">*</span>PE2-Tunnel22] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>ospf 1</strong>
[<span class="keyword">*</span>PE2-ospf-1] <strong>opaque-capability enable</strong>
[<span class="keyword">*</span>PE2-ospf-1] <strong>enable traffic-adjustment advertise</strong>
[<span class="keyword">*</span>PE2-ospf-1] <strong>area 0</strong>
[<span class="keyword">*</span>PE2-ospf-1-area-0.0.0.0] <strong>network 3.3.3.9</strong> <strong>0.0.0.0</strong>
[<span class="keyword">*</span>PE2-ospf-1-area-0.0.0.0] <strong>mpls-te enable</strong>
[<span class="keyword">*</span>PE2-ospf-1-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span>PE2-ospf-1] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>mpls ldp remote-peer pe2tope1</strong>
[<span class="keyword">*</span>PE2-mpls-ldp-remote-pe2tope1] <strong>remote-ip 1.1.1.9</strong>
[<span class="keyword">*</span>PE2-mpls-ldp-remote-pe2tope1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-mpls-ldp-remote-pe2tope1] <strong>quit</strong></pre>
</p></li><li><span>Enable MPLS LDP on all PEs, establish an LDP peer relationship between PE1 and PE3, and establish an LDP peer relationship between PE2 and PE4.</span><p><p># Configure PE3.</p>
<pre class="screen">&lt;PE3&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong>mpls lsr-id 4.4.4.9</strong>
[<span class="keyword">*</span>PE3] <strong>mpls</strong>
[<span class="keyword">*</span>PE3] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-mpls] <strong>quit</strong>
[<span class="keyword">*</span>PE3] <strong>mpls ldp</strong>
[<span class="keyword">*</span>PE3-mpls-ldp] <strong>quit</strong>
[<span class="keyword">*</span>PE3] <strong>interface gigabitethernet <span>0/1/1</span></strong>
[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/1</span>] <strong>mpls</strong>
[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/1</span>] <strong>mpls ldp</strong>
[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<p># Configure PE1.</p>
<pre class="screen">&lt;PE1&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>mpls ldp</strong>
[<span class="keyword">*</span>PE1-mpls-ldp] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/1/4</span></strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/4</span>] <strong>mpls</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/4</span>] <strong>mpls ldp</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/4</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/4</span>] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">&lt;PE2&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]  <strong>mpls ldp</strong>
[<span class="keyword">*</span>PE2-mpls-ldp] <strong>quit</strong>
[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet <span>0/1/4</span></strong>
[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/4</span>] <strong>mpls</strong>
[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/4</span>] <strong>mpls ldp</strong>
[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/4</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/4</span>] <strong>quit</strong></pre>
<p># Configure PE4.</p>
<pre class="screen">&lt;PE4&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4] <strong>mpls lsr-id 5.5.5.9</strong>
[<span class="keyword">*</span>PE4] <strong>mpls</strong>
[<span class="keyword">*</span>PE4] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4-mpls] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4] <strong>mpls ldp</strong>
[<span class="keyword">*</span>PE4-mpls-ldp] <strong>quit</strong>
[<span class="keyword">*</span>PE4] <strong>interface gigabitethernet <span>0/1/1</span></strong>
[<span class="keyword">*</span>PE4-GigabitEthernet<span>0/1/1</span>] <strong>mpls</strong>
[<span class="keyword">*</span>PE4-GigabitEthernet<span>0/1/1</span>] <strong>mpls ldp</strong>
[<span class="keyword">*</span>PE4-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE4-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<p>After completing the configuration, run the <strong>display mpls ldp lsp</strong> command on PE1, PE2, PE3, or PE4. The command output shows that an LDP LSP has been established between the pair of PE3 and PE1 and that of PE2 and PE4.</p>
</p></li><li><span>Establish an MP-IBGP peer relationship between PE1 and PE2, and establish EBGP peer relationships between the PEs and CEs.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>bgp 100</strong>
[<span class="keyword">*</span>PE1-bgp] <strong>peer 3.3.3.9 as-number 100</strong>
[<span class="keyword">*</span>PE1-bgp] <strong>peer 3.3.3.9 connect-interface loopback 1</strong>
[<span class="keyword">*</span>PE1-bgp] <strong>ipv4-family vpnv4</strong>
[<span class="keyword">*</span>PE1-bgp-af-vpnv4] <strong>peer 3.3.3.9 enable</strong>
[<span class="keyword">*</span>PE1-bgp-af-vpnv4] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp-af-vpnv4] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp] <strong>ipv4-family vpn-instance vpna</strong>
[<span class="keyword">*</span>PE1-bgp-vpna] <strong>peer 10.1.1.1 as-number 65410</strong>
[<span class="keyword">*</span>PE1-bgp-vpna] <strong>import-route direct</strong>
[<span class="keyword">*</span>PE1-bgp-vpna] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp-vpna] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp] <strong>ipv4-family vpn-instance vpnb</strong>
[<span class="keyword">*</span>PE1-bgp-vpnb] <strong>peer 10.2.1.1 as-number 65420</strong>
[<span class="keyword">*</span>PE1-bgp-vpnb] <strong>import-route direct</strong>
[<span class="keyword">*</span>PE1-bgp-vpnb] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp-vpnb] <strong>quit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The procedure for configuring PE2 is similar to that of PE1. For configuration details, see <a href="#EN-US_TASK_0172368375__section_dc_vrp_cfg_00694305">Configuration Files</a> in this section.</p>
</div></div>
<p># Configure CE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong>bgp 65410</strong>
[<span class="keyword">*</span>CE1-bgp] <strong>peer 10.1.1.2 as-number 100</strong>
[<span class="keyword">*</span>CE1-bgp] <strong>import-route direct</strong>
[<span class="keyword">*</span>CE1-bgp] <strong>commit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Repeat this step on CE2 to CE4. For configuration details, see <a href="#EN-US_TASK_0172368375__section_dc_vrp_cfg_00694305">Configuration Files</a> in this section.</p>
</div></div>
<p>After completing the configuration, run the <strong>display bgp vpnv4 all peer</strong> command on each PE. The command output shows that BGP peer relationships have been established between the PEs and are in the <strong>Established</strong> state.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display bgp vpnv4 all peer</strong>
BGP local router ID : 1.1.1.9
 Local AS number : 100
 Total number of peers : 3                 Peers in established state : 3
Peer            V    AS  MsgRcvd  MsgSent  OutQ  Up/Down       State PrefRcv
3.3.3.9         4   100       12       18     0 00:09:38 <strong>Established</strong>       0
  Peer of vpn instance:
  VPN-Instance vpna, Router ID 1.1.1.9:
10.1.1.1        4 65410       25       25     0 00:17:57 <strong>Established</strong>       1
  VPN-Instance vpnb, Router ID 1.1.1.9:
10.2.1.1        4 65420       21       22     0 00:17:10 <strong>Established</strong>       1</pre>
</p></li><li><span>Configure tunnel policies on PE1 and PE2.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>tunnel-policy policya</strong>
[<span class="keyword">*</span>PE1-tunnel-policy-policya] <strong>tunnel binding destination 3.3.3.9 te tunnel 10 tunnel 11 tunnel 12</strong>
[<span class="keyword">*</span>PE1-tunnel-policy-policya] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-tunnel-policy-policya] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>tunnel-policy policyb</strong>
[<span class="keyword">*</span>PE1-tunnel-policy-policyb] <strong>tunnel binding destination 3.3.3.9 te tunnel 20 tunnel 21 tunnel 22</strong>
[<span class="keyword">*</span>PE1-tunnel-policy-policyb] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-tunnel-policy-policyb] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>tunnel-policy policya</strong>
[<span class="keyword">*</span>PE2-tunnel-policy-policya] <strong>tunnel binding destination 1.1.1.9 te tunnel 10 tunnel 11 tunnel 12</strong>
[<span class="keyword">*</span>PE2-tunnel-policy-policya] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-tunnel-policy-policya] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>tunnel-policy policyb</strong>
[<span class="keyword">*</span>PE2-tunnel-policy-policyb] <strong>tunnel binding destination 1.1.1.9 te tunnel 2</strong><strong>0 tunnel 21 tunnel 22</strong>
[<span class="keyword">*</span>PE2-tunnel-policy-policyb] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-tunnel-policy-policyb] <strong>quit</strong></pre>
</p></li><li><span>Configure VPN instances on PE1 and PE2 to enable a CE to access the corresponding PE.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>ip vpn-instance vpna</strong>
<span>[<span class="keyword">*</span>PE1-vpn-instance-vpna] <strong>ipv4-family</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpna-af-ipv4] <strong>route-distinguisher 100:1</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpna-af-ipv4] <strong>vpn-target 111:1 both</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpna-af-ipv4] <strong>tnl-policy policya</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpna-af-ipv4] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-vpn-instance-vpna-af-ipv4] <strong>quit</strong></span>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-vpn-instance-vpna] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>ip vpn-instance vpnb</strong>
<span>[<span class="keyword">*</span>PE1-vpn-instance-vpna] <strong>ipv4-family</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpnb-af-ipv4] <strong>route-distinguisher 100:2</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpnb-af-ipv4] <strong>vpn-target 222:2 both</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpnb-af-ipv4] <strong>tnl-policy policyb</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpnb-af-ipv4] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-vpn-instance-vpnb-af-ipv4] <strong>quit</strong></span>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-vpn-instance-vpnb] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface gigabitethernet <span>0/1/1</span></strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>ip binding vpn-instance vpna</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>ip address 10.1.1.2 24</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/1/2</span></strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>ip binding vpn-instance vpnb</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>ip address 10.2.1.2 24</strong>
[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>ip vpn-instance vpna</strong>
<span>[<span class="keyword">*</span>PE2-vpn-instance-vpna] <strong>ipv4-family</strong>
[<span class="keyword">*</span>PE2-vpn-instance-vpna-af-ipv4] <strong>route-distinguisher 200:1</strong>
[<span class="keyword">*</span>PE2-vpn-instance-vpna-af-ipv4] <strong>vpn-target 111:1 both</strong>
[<span class="keyword">*</span>PE2-vpn-instance-vpna-af-ipv4] <strong>tnl-policy policya</strong>
[<span class="keyword">*</span>PE2-vpn-instance-vpna-af-ipv4] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-vpn-instance-vpna-af-ipv4] <strong>quit</strong></span>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-vpn-instance-vpna] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>ip vpn-instance vpnb</strong>
<span>[<span class="keyword">*</span>PE2-vpn-instance-vpnb] <strong>ipv4-family</strong>
[<span class="keyword">*</span>PE2-vpn-instance-vpnb-af-ipv4] <strong>route-distinguisher 200:2</strong>
[<span class="keyword">*</span>PE2-vpn-instance-vpnb-af-ipv4] <strong>vpn-target 222:2 both</strong>
[<span class="keyword">*</span>PE2-vpn-instance-vpnb-af-ipv4] <strong>tnl-policy policyb</strong>
[<span class="keyword">*</span>PE2-vpn-instance-vpnb-af-ipv4] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-vpn-instance-vpnb-af-ipv4] <strong>quit</strong></span>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-vpn-instance-vpnb] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface gigabitethernet <span>0/1/1</span></strong>
[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>ip binding vpn-instance vpna</strong>
[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>ip address 10.3.1.2 24</strong>
[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface gigabitethernet <span>0/1/2</span></strong>
[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong>ip binding vpn-instance vpnb</strong>
[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong>ip address 10.4.1.2 24</strong>
[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<p># Assign IP addresses to the interfaces on each CE. For configuration details, see <a href="#EN-US_TASK_0172368375__section_dc_vrp_cfg_00694305">Configuration Files</a> in this section.</p>
<p>After completing the configuration, run the <strong>display ip vpn-instance verbose</strong> command on a PE to check the configurations of VPN instances. Each PE can successfully ping its connected CEs.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172368375__section_dc_vrp_cfg_00694305"><a name="EN-US_TASK_0172368375__section_dc_vrp_cfg_00694305"></a><a name="section_dc_vrp_cfg_00694305"></a><a name="EN-US_TASK_0172368375__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#
 sysname PE1
#
ip vpn-instance vpna
 ipv4-family
  route-distinguisher 100:1
  tnl-policy policya
<span>  apply-label per-instance</span>
  vpn-target 111:1 export-extcommunity
  vpn-target 111:1 import-extcommunity
#
ip vpn-instance vpnb
 ipv4-family
  route-distinguisher 100:2
  tnl-policy policyb
<span>  apply-label per-instance</span>
  vpn-target 222:2 export-extcommunity
  vpn-target 222:2 import-extcommunity
#</pre>
<pre class="screen"> mpls lsr-id 1.1.1.9
#
mpls
 mpls te
 mpls te cspf
 mpls te ds-te bcm rdm
 mpls te ds-te mode ietf
 mpls rsvp-te
#
mpls ldp
#
mpls ldp remote-peer pe1tope2
 remote-ip 3.3.3.9
#
explicit-path path1
 next hop 10.10.1.2
 next hop 10.11.1.2
 next hop 3.3.3.9
#
te-class-mapping
 te-class0 class-type ct0 priority 0 description For-BE
 te-class1 class-type ct1 priority 0 description For-AF1
 te-class2 class-type ct2 priority 0 description For-AF2
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip binding vpn-instance vpna
 ip address 10.1.1.2 255.255.255.0
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip binding vpn-instance vpnb
 ip address 10.2.1.2 255.255.255.0
#
interface GigabitEthernet<span>0/1/3</span>
 undo shutdown
 ip address 10.10.1.1 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 400000
 mpls te bandwidth bc0 400000 bc1 300000 bc2 200000
 mpls rsvp-te
#
interface GigabitEthernet<span>0/1/4</span>
 undo shutdown
 ip address 10.5.1.1 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 1.1.1.9 255.255.255.255
 isis enable 1
#
interface Tunnel10
 description For VPN-A &amp; Non-VPN
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 3.3.3.9
 mpls te tunnel-id 10
 mpls te signal-protocol rsvp-te
 mpls te priority 0 0
 mpls te bandwidth ct0 50000
 mpls te reserved-for-binding
 mpls te path explicit-path path1
 mpls te igp advertise
 mpls te igp metric absolute 1
#
interface Tunnel11
 description For VPN-A &amp; Non-VPN
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 3.3.3.9
 mpls te tunnel-id 11
 mpls te signal-protocol rsvp-te
 mpls te priority 0 0
 mpls te bandwidth ct1 50000
 mpls te reserved-for-binding
 mpls te path explicit-path path1
 mpls te igp advertise
 mpls te igp metric absolute 1
#
interface Tunnel12
 description For VPN-A &amp; Non-VPN
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 3.3.3.9
 mpls te tunnel-id 12
 mpls te signal-protocol rsvp-te
 mpls te priority 0 0
 mpls te bandwidth ct2 100000
 mpls te reserved-for-binding
 mpls te path explicit-path path1
 mpls te igp advertise
 mpls te igp metric absolute 1
#
interface Tunnel20
 description For VPN-B
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 3.3.3.9
 mpls te tunnel-id 20
 mpls te signal-protocol rsvp-te
 mpls te priority 0 0
 mpls te bandwidth ct0 50000
 mpls te reserved-for-binding
 mpls te path explicit-path path1
#
interface Tunnel21
 description For VPN-B
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 3.3.3.9
 mpls te tunnel-id 21
 mpls te signal-protocol rsvp-te
 mpls te priority 0 0
 mpls te bandwidth ct1 50000
 mpls te reserved-for-binding
 mpls te path explicit-path path1
#
interface Tunnel22
 description For VPN-B
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 3.3.3.9
 mpls te signal-protocol rsvp-te
 mpls te tunnel-id 22
 mpls te priority 0 0
 mpls te bandwidth ct2 100000
 mpls te reserved-for-binding
 mpls te path explicit-path path1
#
bgp 100
 peer 3.3.3.9 as-number 100
 peer 3.3.3.9 connect-interface LoopBack1
 #
 ipv4-family unicast
  undo synchronization
  peer 3.3.3.9 enable
#
 ipv4-family vpnv4
  policy vpn-target
  peer 3.3.3.9 enable
 #
 ipv4-family vpn-instance vpna
  peer 10.1.1.1 as-number 65410
  import-route direct
#
 ipv4-family vpn-instance vpnb
  peer 10.2.1.1 as-number 65420
  import-route direct
#
isis 1
 is-level level-1
 cost-style wide
 traffic-eng level-1
#
ospf 1
 opaque-capability enable
 enable traffic-adjustment advertise
 area 0.0.0.0
  network 1.1.1.9 0.0.0.0
  network 10.1.5.0 0.0.0.255
  mpls-te enable
#
tunnel-policy policya
 tunnel binding destination 3.3.3.9 te Tunnel10 Tunnel11 Tunnel12
#
tunnel-policy policyb
 tunnel binding destination 3.3.3.9 te Tunnel20 Tunnel21 Tunnel22
#
return</pre>
</li><li><p>P configuration file</p>
<pre class="screen">#
 sysname P
#
 mpls lsr-id 2.2.2.9
#
 mpls
 mpls te
 mpls te ds-te bcm rdm
  mpls te ds-te mode ietf
  mpls rsvp-te
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.10.1.2 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 400000
 mpls te bandwidth bc0 400000 bc1 300000 bc2 200000
 mpls rsvp-te
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 10.11.1.1 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 400000
 mpls te bandwidth bc0 400000 bc1 300000 bc2 200000
 mpls rsvp-te
#
interface LoopBack1
 ip address 2.2.2.9 255.255.255.255
 isis enable 1
#
isis 1
 is-level level-1
 cost-style wide
 traffic-eng level-1
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
 sysname PE2
#
ip vpn-instance vpna
 ipv4-family
  route-distinguisher 200:1
  tnl-policy policya
<span>  apply-label per-instance</span>
  vpn-target 111:1 export-extcommunity
  vpn-target 111:1 import-extcommunity
#
ip vpn-instance vpnb
 ipv4-family
  route-distinguisher 200:2
  tnl-policy policyb
<span>  apply-label per-instance</span>
  vpn-target 222:2 export-extcommunity
  vpn-target 222:2 import-extcommunity
#</pre>
<pre class="screen">mpls lsr-id 3.3.3.9
#
 mpls
  mpls te
 mpls te cspf
 mpls te ds-te bcm rdm
  mpls te ds-te mode ietf
 mpls rsvp-te
#
 mpls ldp
#
mpls ldp remote-peer pe2tope1
 remote-ip 1.1.1.9
#
 explicit-path path1
 next hop 10.10.1.1
 next hop 10.11.1.1
 next hop 1.1.1.9
#
 te-class-mapping
  te-class0 class-type ct0 priority 0 description For-BE
 te-class1 class-type ct1 priority 0 description For-AF1
 te-class2 class-type ct2 priority 0 description For-AF2
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip binding vpn-instance vpna
 ip address 10.3.1.2 255.255.255.0
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip binding vpn-instance vpnb
 ip address 10.4.1.2 255.255.255.0
#
interface GigabitEthernet<span>0/1/3</span>
 undo shutdown
 ip address 10.11.1.2 255.255.255.0
 isis enable 1
 mpls
  mpls te
 mpls te bandwidth max-reservable-bandwidth 400000
 mpls te bandwidth bc0 400000 bc1 300000 bc2 200000
 mpls rsvp-te
#
interface GigabitEthernet<span>0/1/4</span>
 undo shutdown
 ip address 10.5.1.1 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 3.3.3.9 255.255.255.255
 isis enable 1
#
interface Tunnel10
 description For VPN-A &amp; Non-VPN
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 1.1.1.9
 mpls te tunnel-id 10
 mpls te signal-protocol rsvp-te
 mpls te priority 0 0
 mpls te bandwidth ct0 50000
 mpls te reserved-for-binding
 mpls te path explicit-path path1
 mpls te igp advertise
 mpls te igp metric absolute 1
#
interface Tunnel11
 description For VPN-A &amp; Non-VPN
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 1.1.1.9
 mpls te tunnel-id 11
 mpls te signal-protocol rsvp-te
 mpls te priority 0 0
 mpls te bandwidth ct1 50000
 mpls te reserved-for-binding
 mpls te path explicit-path path1
 mpls te igp advertise
 mpls te igp metric absolute 1
#
interface Tunnel12
 description For VPN-A &amp; Non-VPN
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 1.1.1.9
 mpls te tunnel-id 12
 mpls te signal-protocol rsvp-te
 mpls te priority 0 0
 mpls te bandwidth ct2 100000
 mpls te reserved-for-binding
 mpls te path explicit-path path1
 mpls te igp advertise
 mpls te igp metric absolute 1
#
interface Tunnel20
 description For VPN-B
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 1.1.1.9
 mpls te tunnel-id 20
 mpls te signal-protocol rsvp-te
 mpls te priority 0 0
 mpls te bandwidth ct0 50000
 mpls te reserved-for-binding
 mpls te path explicit-path path1
#
interface Tunnel21
 description For VPN-B
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 1.1.1.9
 mpls te tunnel-id 21
 mpls te signal-protocol rsvp-te
 mpls te priority 0 0
 mpls te bandwidth ct1 50000
 mpls te reserved-for-binding
 mpls te path explicit-path path1
#
interface Tunnel22
 description For VPN-B
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 1.1.1.9
 mpls te tunnel-id 22
 mpls te signal-protocol rsvp-te
 mpls te priority 0 0
 mpls te bandwidth ct2 100000
 mpls te reserved-for-binding
 mpls te path explicit-path path1
#
bgp 100
 peer 1.1.1.9 as-number 100
 peer 1.1.1.9 connect-interface LoopBack1
#
 ipv4-family unicast
  undo synchronization
  peer 1.1.1.9 enable
#
 ipv4-family vpnv4
  policy vpn-target
  peer 1.1.1.9 enable
#
 ipv4-family vpn-instance vpna
  peer 10.3.1.1 as-number 65430
  import-route direct
#
 ipv4-family vpn-instance vpnb
  peer 10.4.1.1 as-number 65440
  import-route direct
#
isis 1
 is-level level-1
 cost-style wide
 traffic-eng level-1
#
ospf 1
 opaque-capability enable
 enable traffic-adjustment advertise
 area 0.0.0.0
  network 3.3.3.9 0.0.0.0
  network 10.1.6.0 0.0.0.255
  mpls-te enable
#
tunnel-policy policya
 tunnel binding destination 1.1.1.9 te Tunnel10 Tunnel11 Tunnel12
#
tunnel-policy policyb
 tunnel binding destination 1.1.1.9 te Tunnel20 Tunnel21 Tunnel22
#
return</pre>
</li><li>PE3 configuration file<pre class="screen">#
 sysname PE3
#
 mpls lsr-id 4.4.4.9
#
mpls
#
 mpls ldp
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.5.1.2 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 4.4.4.9 255.255.255.255
 mpls
 mpls ldp
#
ospf 1
 area 0.0.0.0
  network 4.4.4.9 0.0.0.0
  network 10.1.5.0 0.0.0.255
#
return</pre>
</li><li><p>PE4 configuration file</p>
<pre class="screen">#
 sysname PE4
#
 mpls lsr-id 5.5.5.9
#
mpls
#
 mpls ldp
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.6.1.2 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 5.5.5.9 255.255.255.255
 mpls
 mpls ldp
#
ospf 1
 area 0.0.0.0
  network 5.5.5.9 0.0.0.0
  network 10.1.6.0 0.0.0.255
#
return</pre>
</li><li><p>CE1 configuration file</p>
<pre class="screen">#
 sysname CE1
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.1.1.1 255.255.255.0
#
bgp 65410
 peer 10.1.1.2 as-number 100
 #
 ipv4-family unicast
  undo synchronization
  import-route direct
  peer 10.1.1.2 enable
#
return</pre>
</li><li><p>CE2 configuration file</p>
<pre class="screen">#
 sysname CE2
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.2.1.1 255.255.255.0
#
bgp 65420
 peer 10.2.1.2 as-number 100
 #
 ipv4-family unicast
  undo synchronization
  import-route direct
  peer 10.2.1.2 enable
#
return</pre>
</li><li><p>CE3 configuration file</p>
<pre class="screen">#
 sysname CE3
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.3.1.1 255.255.255.0
#
bgp 65430
 peer 10.3.1.2 as-number 100
 #
 ipv4-family unicast
  undo synchronization
  import-route direct
  peer 10.3.1.2 enable
#
return</pre>
</li><li><p>CE4 configuration file</p>
<pre class="screen">#
 sysname CE4
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.4.1.1 255.255.255.0
#
bgp 65440
 peer 10.4.1.2 as-number 100
 #
 ipv4-family unicast
  undo synchronization
  import-route direct
  peer 10.4.1.2 enable
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0093.html">Configuration Examples for MPLS TE
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0139.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_te-p2p_cfg_6002.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>