
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Specifying the TTL Mode for MPLS">
<meta name="abstract" content="MPLS nodes process TTLs in either uniform or pipe mode.">
<meta name="description" content="MPLS nodes process TTLs in either uniform or pipe mode.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mplsm_cfg_0004.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mplsm_cfg_0006.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="l00468467,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MPLS Common">
<meta name="featuretype" content="MPLS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MPLS Common">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS Common">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS Common">
<meta name="featuretype" content="MPLS">
<meta name="OWNER" content="l00425560,l00468467">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="b00896120">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368024">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Specifying the TTL Mode for MPLS</title>
</head>
<body><a name="EN-US_TASK_0172368024"></a><a name="EN-US_TASK_0172368024"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Specifying the TTL Mode for MPLS</h1>
<div class="taskbody"><p>MPLS nodes process TTLs in either uniform or pipe mode.</p>
<div class="context"><a name="EN-US_TASK_0172368024__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>You can configure an MPLS TTL processing mode on the ingress PE<span> or egress PE</span>.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>After the TTL mode of an MPLS public network or VPN is changed, the new mode takes effect only for new MPLS LDP sessions. To make the change take effect for previously established MPLS LDP sessions, run the <strong>reset mpls ldp</strong> command to reestablish the sessions.</p>
</div></div>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172368024__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Set a TTL processing mode for MPLS LDP packets.</span><p><p>Perform the following steps on the ingress:</p>
</p><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=mpls"><b><span class="cmdname">mpls</span></b></a></span></span><p><p>The MPLS view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=mpls+ldp+ttl-mode+pipe+uniform"><b><span class="cmdname">mpls ldp ttl-mode</span></b></a> { <strong><span>pipe</span></strong> | <strong><span>uniform</span></strong> }</span></span><p><p>An MPLS TTL processing mode is set.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Set a TTL processing mode for MPLS TE packets.</span><p><p>Perform the following steps on the ingress:</p>
</p><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=mpls"><b><span class="cmdname">mpls</span></b></a></span></span><p><p>The MPLS view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=mpls+te+ttl-mode+pipe+uniform"><b><span class="cmdname">mpls te ttl-mode</span></b></a> { <strong><span>pipe</span></strong> | <strong><span>uniform</span></strong> }</span></span><p><p>An MPLS TTL processing mode is set.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Set a TTL processing mode for an MPLS SR.</span><p><p>Perform the following steps on the ingress PE:</p>
</p><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=mpls"><b><span class="cmdname">mpls</span></b></a></span></span><p><p>The MPLS view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=mpls+sr+ttl-mode+pipe+uniform"><b><span class="cmdname">mpls sr ttl-mode</span></b></a> { <strong><span>pipe</span></strong> | <strong><span>uniform</span></strong> }</span></span><p><p>An MPLS TTL processing mode is set.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Set a TTL processing mode for a BGP LSP egress.</span><p><p>Perform the following steps on the egress PE:</p>
</p><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=mpls"><b><span class="cmdname">mpls</span></b></a></span></span><p><p>The MPLS view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=mpls+bgp+ttl-mode+pipe+uniform+egress"><b><span class="cmdname">mpls bgp ttl-mode</span></b></a> { <strong><span>pipe</span></strong> | <strong><span>uniform</span></strong> } <strong><span>egress</span></strong></span></span><p><p>A TTL processing mode is set for a BGP LSP egress.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
<p><p>When IP packets in a VPN instance enter an MPLS tunnel, to configure the mode of processing the MPLS TTL carried in a private network label, run the <a href="cmdqueryname=ttl-mode"><b><span class="cmdname">ttl-mode</span></b></a> command. In addition, the <a href="cmdqueryname=mpls+te+ttl-mode"><b><span class="cmdname">mpls te ttl-mode</span></b></a> or <a href="cmdqueryname=mpls+ldp+ttl-mode"><b><span class="cmdname">mpls ldp ttl-mode</span></b></a> command configures the mode of processing the MPLS TTL in public network labels. The combinations of TTL processing modes are as follows:</p>
<ul><li>The MPLS TTL processing modes for both the private network label and public network label are uniform.<p>When an IP packet passes through an MPLS network, the IP TTL decreases by one on the ingress and is mapped to the MPLS TTL of the private network label. The MPLS TTL of the private network label is mapped to the MPLS TTL of the public network label. Then, the packet is processed in the standard TTL mode on the MPLS network. The egress removes the public network label, copies and pastes the MPLS TTL in the public network label to the MPLS TTL in the private network label, and removes the private network label. The egress then reduces the MPLS TTL by one and changes the IP TTL to a smaller value of the MPLS TTL and IP TTL. <a href="#EN-US_TASK_0172368024__fig19685125215162">Figure 1</a> illustrates such an MPLS TTL processing mode.</p>
<div class="fignone" id="EN-US_TASK_0172368024__fig19685125215162"><a name="EN-US_TASK_0172368024__fig19685125215162"></a><a name="fig19685125215162"></a><span class="figcap"><b>Figure 1 </b>MPLS TTL processing mode 1</span><br><span><img class="vsd" src="figure/en-us_image_0178301723.png" width="NaN" height="NaN"></span></div>
</li><li>The MPLS TTL processing mode for the private network label is pipe, and that for the public network label is uniform.<p>When an IP packet passes through an MPLS network, the ingress reduces the IP TTL and copies and pastes the MPLS TTL that is fixed at 255 in the private network label to the MPLS TTL in the public network label. Then, the packet is processed in the standard TTL mode on the MPLS network. The egress removes the public network label, copies and pastes the MPLS TTL to the MPLS TTL in the private network label, and removes the private network label. The IP TTL is reduced by one only by the egress. <a href="#EN-US_TASK_0172368024__fig17428105982615">Figure 2</a> illustrates such an MPLS TTL processing mode.</p>
<div class="fignone" id="EN-US_TASK_0172368024__fig17428105982615"><a name="EN-US_TASK_0172368024__fig17428105982615"></a><a name="fig17428105982615"></a><span class="figcap"><b>Figure 2 </b>MPLS TTL processing mode 2</span><br><span><img class="vsd" src="figure/en-us_image_0178303162.png" width="NaN" height="NaN"></span></div>
</li><li>The MPLS TTL processing mode for the private network label is uniform, and that for the public network label is pipe.<p>When an IP packet passes through an MPLS network, the ingress reduces the IP TTL by one and copies and pastes the IP TTL to the MPLS TTL of the private network label. The MPLS TTL of the public network label is fixed at 255. Then, the packet is processed in the standard TTL mode on the MPLS network. The egress removes the public network label and private network label in sequence, reduces the MPLS TTL by one, and changes the IP TTL to a smaller value of the MPLS TTL and the IP TTL. <a href="#EN-US_TASK_0172368024__fig151291418183119">Figure 3</a> illustrates such an MPLS TTL processing mode.</p>
<div class="fignone" id="EN-US_TASK_0172368024__fig151291418183119"><a name="EN-US_TASK_0172368024__fig151291418183119"></a><a name="fig151291418183119"></a><span class="figcap"><b>Figure 3 </b>MPLS TTL processing mode 3</span><br><span><img class="vsd" src="figure/en-us_image_0178303287.png" width="NaN" height="NaN"></span></div>
</li><li>The MPLS TTL processing modes for both the private network label and public network label are pipe.<p>When an IP packet passes through an MPLS network, the IP TTL decreases by one on the ingress. The MPLS TTLs in the private network label and public network label are fixed at 255. Then, the packet is processed in the standard TTL mode on the MPLS network. The egress removes the public network label and private network label in sequence. The IP TTL is reduced by one only by the egress. <a href="#EN-US_TASK_0172368024__fig1124394953420">Figure 4</a> illustrates such an MPLS TTL processing mode.</p>
<div class="fignone" id="EN-US_TASK_0172368024__fig1124394953420"><a name="EN-US_TASK_0172368024__fig1124394953420"></a><a name="fig1124394953420"></a><span class="figcap"><b>Figure 4 </b>MPLS TTL processing mode 4</span><br><span><img class="vsd" src="figure/en-us_image_0178303571.png" width="NaN" height="NaN"></span></div>
</li></ul>
</p></li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mplsm_cfg_0004.html">Specifying an MPLS TTL Handling Mode
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mplsm_cfg_0006.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>