
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a P2MP TE Tunnel">
<meta name="abstract" content="This section provides an example for configuring a P2MP TE tunnel on an IP/MPLS backbone network.">
<meta name="description" content="This section provides an example for configuring a P2MP TE tunnel on an IP/MPLS backbone network.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0093.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0072.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0322.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00845984">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368372">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring a P2MP TE Tunnel</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172368372"></a><a name="EN-US_TASK_0172368372"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a P2MP TE Tunnel</h1>
<div class="taskbody"><p>This section provides an example for configuring a P2MP TE tunnel on an IP/MPLS backbone network.</p>
<div class="context"><a name="EN-US_TASK_0172368372__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>The IP multicast service bearer technology used on the current IP/MPLS backbone network relies on the IP unicast technology. Like IP unicast, IP multicast fails to provide sufficient bandwidth, QoS capabilities, reliability and high real-time performance for multicast services such as IPTV and massively multiplayer online role-playing games (MMORPGs). A P2MP TE tunnel can solve this problem. A P2MP TE tunnel can be configured on a live IP/MPLS backbone network, and supports the P2MP TE FRR function, meeting multicast service requirements.</p>
<p>A P2MP TE tunnel is established on the network shown in <a href="#EN-US_TASK_0172368372__fig_dc_vrp_te-p2p_cfg_013901">Figure 1</a>. LSRA is the tunnel ingress. LSRC, LSRE, and LSRF are leaf nodes, and the tunnel bandwidth is 1000 kbit/s.</p>
<div class="fignone" id="EN-US_TASK_0172368372__fig_dc_vrp_te-p2p_cfg_013901"><a name="EN-US_TASK_0172368372__fig_dc_vrp_te-p2p_cfg_013901"></a><a name="fig_dc_vrp_te-p2p_cfg_013901"></a><span class="figcap"><b>Figure 1 </b>P2MP TE tunnel networking</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 3 in this example represent GE <span>0/1/0</span>, GE <span>0/1/1</span>, and GE <span>0/1/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_te-p2p_cfg_013901.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368372__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>None.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368372__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Assign an IP address to each interface and configure a loopback interface address as an LSR ID on each node.</p>
</li><li><p>Configure Intermediate System to Intermediate System (IS-IS) to advertise the route to each network segment to which each interface is connected and the host route to each loopback interface address that is an LSR ID.</p>
</li><li><p>Enable MPLS, MPLS TE<span>, P2MP TE</span>, and MPLS RSVP-TE globally on each node and constraint shortest path first (CSPF) on the ingress to enable all nodes to have MPLS forwarding capabilities.</p>
</li><li><p>Enable the IGP TE capability to ensure that MPLS TE can advertise information about link status.</p>
</li><li><p>Enable the MPLS TE capability on the interfaces of each node and configure link attributes for the interfaces so that the interfaces can send RSVP signaling packets.</p>
</li><li><p>Configure explicit paths and a leaf list on the ingress LSRA to specify the leaf nodes on the P2MP TE tunnel.</p>
</li><li><p>Configure a P2MP TE tunnel interface on LSRA to ensure that the ingress establishes a P2MP TE tunnel based on all configuration information on the interface.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368372__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IP addresses of all interfaces shown in <a href="#EN-US_TASK_0172368372__fig_dc_vrp_te-p2p_cfg_013901">Figure 1</a></p>
</li><li><p>IS-IS (used as an IGP protocol), IS-IS process ID (1), IS-IS system ID of each node (obtained by translating the IP address of loopback1 of each node), and IS-IS level (Level-2)</p>
</li><li><p>MPLS LSR ID of each node using the corresponding loopback interface address</p>
</li><li><p>Maximum reservable bandwidth (10000 kbit/s) of the outbound interface along the path and BC0 bandwidth (10000 kbit/s)</p>
</li><li><p>Name of an explicit path used by each leaf node (toLSRB, toLSRE, and toLSRF), name of the leaf list (iptv1), and addresses of each leaf node (MPLS LSR ID of each leaf node)</p>
</li><li><p>Tunnel interface number (Tunnel 10), tunnel ID (100), loopback interface address used as the IP address of the tunnel interface, and tunnel bandwidth (1000 kbit/s)</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172368372__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface.</span><p><p>Assign an IP address to each interface according to <a href="#EN-US_TASK_0172368372__fig_dc_vrp_te-p2p_cfg_013901">Figure 1</a> and create a loopback interface on each node. For configuration details, see <a href="#EN-US_TASK_0172368372__section_dc_vrp_te-p2p_cfg_013105">Configuration Files</a> in this section.</p>
</p></li><li><span>Configure IS-IS to advertise the route to each network segment to which each interface is connected and to advertise the host route to each LSR ID.</span><p><p>Configure IS-IS on each node to implement network layer connectivity. For configuration details, see <a href="#EN-US_TASK_0172368372__section_dc_vrp_te-p2p_cfg_013105">Configuration Files</a> in this section.</p>
</p></li><li><span>Enable MPLS, MPLS TE, <span>P2MP TE, </span>and MPLS RSVP-TE globally on each node and CSPF on the ingress.</span><p><p># Configure LSRA.</p>
<pre class="screen">&lt;LSRA&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> mpls lsr-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls] <strong>mpls te p2mp-te </strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls] <strong>mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-mpls] <strong>quit</strong></pre>
<p># Configure LSRB.</p>
<pre class="screen">&lt;LSRB&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB]<strong> mpls lsr-id 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-mpls]<strong> mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-mpls] <strong>mpls te p2mp-te </strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-mpls]<strong> mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-mpls] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB-mpls] <strong>quit</strong></pre>
<p># Configure LSRC.</p>
<pre class="screen">&lt;LSRC&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC]<strong> mpls lsr-id 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-mpls]<strong> mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-mpls] <strong>mpls te p2mp-te </strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-mpls]<strong> mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-mpls]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC-mpls]<strong> quit</strong></pre>
<p># Configure LSRD.</p>
<pre class="screen">&lt;LSRD&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD]<strong> mpls lsr-id 4.4.4.4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-mpls]<strong> mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-mpls] <strong>mpls te p2mp-te </strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-mpls]<strong> mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-mpls]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD-mpls]<strong> quit</strong></pre>
<p># Configure LSRE.</p>
<pre class="screen">&lt;LSRE&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRE]<strong> mpls lsr-id 5.5.5.5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE-mpls]<strong> mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE-mpls] <strong>mpls te p2mp-te </strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE-mpls]<strong> mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE-mpls]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRE-mpls]<strong> quit</strong></pre>
<p># Configure LSRF.</p>
<pre class="screen">&lt;LSRF&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRF]<strong> mpls lsr-id 6.6.6.6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRF] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRF-mpls]<strong> mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRF-mpls] <strong>mpls te p2mp-te </strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRF-mpls]<strong> mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRF-mpls]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRF-mpls]<strong> quit</strong></pre>
</p></li><li><span>Enable IGP TE on each node.</span><p><p># Configure LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> isis 1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-isis-1]<strong> cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-isis-1]<strong> traffic-eng level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-isis-1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-isis-1]<strong> quit</strong></pre>
<p># Configure LSRB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB]<strong> isis 1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB-isis-1]<strong> cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-isis-1]<strong> traffic-eng level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-isis-1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB-isis-1]<strong> quit</strong></pre>
<p># Configure LSRC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC]<strong> isis 1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC-isis-1]<strong> cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-isis-1]<strong> traffic-eng level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-isis-1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC-isis-1]<strong> quit</strong></pre>
<p># Configure LSRD.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD]<strong> isis 1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD-isis-1]<strong> cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-isis-1]<strong> traffic-eng level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-isis-1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD-isis-1]<strong> quit</strong></pre>
<p># Configure LSRE.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRE]<strong> isis 1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRE-isis-1]<strong> cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE-isis-1]<strong> traffic-eng level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE-isis-1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRE-isis-1]<strong> quit</strong></pre>
<p># Configure LSRF.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRF]<strong> isis 1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRF-isis-1]<strong> cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRF-isis-1]<strong> traffic-eng level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRF-isis-1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRF-isis-1]<strong> quit</strong></pre>
</p></li><li><span>Enable the MPLS TE capability on the interface of each node, and configure link attributes for the interfaces.</span><p><p># Configure LSRA.</p>
<pre class="screen">&lt;LSRA&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-GigabitEthernet<span>0/1/1</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/1</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/1</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/1</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/1</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<p># Configure LSRB.</p>
<pre class="screen">&lt;LSRB&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB-GigabitEthernet<span>0/1/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/0</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB-GigabitEthernet<span>0/1/0</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB]<strong> interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/2</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/2</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/2</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/2</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/2</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB]<strong> interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/1</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/1</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/1</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/1</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/1</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<p># Configure LSRC.</p>
<pre class="screen">&lt;LSRC&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC]<strong> interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC-GigabitEthernet<span>0/1/2</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/1/2</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/1/2</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/1/2</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/1/2</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/1/2</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<p># Configure LSRD.</p>
<pre class="screen">&lt;LSRD&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD-GigabitEthernet<span>0/1/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/0</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/0</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD]<strong> interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/2</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/2</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/2</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/2</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/2</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD]<strong> interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/1</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/1</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/1</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/1</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/1</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<p># Configure LSRE.</p>
<pre class="screen">&lt;LSRE&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRE]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRE-GigabitEthernet<span>0/1/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE-GigabitEthernet<span>0/1/0</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE-GigabitEthernet<span>0/1/0</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRE-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRE-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<p># Configure LSRF.</p>
<pre class="screen">&lt;LSRF&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRF]<strong> interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRF-GigabitEthernet<span>0/1/1</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRF-GigabitEthernet<span>0/1/1</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRF-GigabitEthernet<span>0/1/1</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRF-GigabitEthernet<span>0/1/1</span>] <strong>mpls te bandwidth max-reservable-bandwidth 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRF-GigabitEthernet<span>0/1/1</span>] <strong>mpls te bandwidth bc0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRF-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRF-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
</p></li><li><span>Configure explicit paths and a leaf list on the ingress LSRA.</span><p><p># Configure explicit paths on LSRA to LSRC, LSRE, and LSRF.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> explicit-path tolsrc</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-explicit-path-tolsrc]<strong> next hop 10.1.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-explicit-path-tolsrc]<strong> next hop 10.3.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-explicit-path-tolsrc]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA]<strong> explicit-path tolsrf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-explicit-path-tolsrf]<strong> next hop 10.1.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-explicit-path-tolsrf]<strong> next hop 10.2.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-explicit-path-tolsrf]<strong> next hop 10.5.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-explicit-path-tolsrf]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA]<strong> explicit-path tolsre</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-explicit-path-tolsre]<strong> next hop 10.1.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-explicit-path-tolsre]<strong> next hop 10.2.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-explicit-path-tolsre]<strong> next hop 10.4.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-explicit-path-tolsre]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-explicit-path-tolsre]<strong> quit</strong></pre>
<p># Configure a leaf list <strong>iptv1</strong> on LSRA and add leaf node addresses to the leaf list.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> mpls te leaf-list iptv1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls-te-leaf-list-iptv1]<strong> destination 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls-te-leaf-list-iptv1-destination-3.3.3.3]<strong> path explicit-path tolsrc</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls-te-leaf-list-iptv1-destination-3.3.3.3]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls-te-leaf-list-iptv1]<strong> destination 5.5.5.5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls-te-leaf-list-iptv1-destination-5.5.5.5]<strong> path explicit-path tolsre</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls-te-leaf-list-iptv1-destination-5.5.5.5]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls-te-leaf-list-iptv1]<strong> destination 6.6.6.6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls-te-leaf-list-iptv1-destination-6.6.6.6]<strong> path explicit-path tolsrf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls-te-leaf-list-iptv1-destination-6.6.6.6]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-mpls-te-leaf-list-iptv1-destination-6.6.6.6]<strong> quit</strong></pre>
</p></li><li><span>Configure the P2MP TE tunnel interface on the ingress LSRA.</span><p><p># Configure LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> interface Tunnel 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel10]<strong> ip address unnumbered interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel10]<strong> tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel10]<strong> mpls te p2mp-mode</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel10]<strong> mpls te tunnel-id 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel10]<strong> mpls te leaf-list iptv1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel10]<strong> mpls te bandwidth ct0 1000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel10]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-Tunnel10]<strong> quit</strong></pre>
<p>The P2MP TE tunnel configuration is complete after this step is performed.</p>
</p></li><li><span>Verify the configuration.</span><p><div class="p">After completing the configurations, run the <strong>display mpls te p2mp tunnel-interface Tunnel10</strong> command on LSRA. The status of Tunnel 10 on LSRA is <strong>UP</strong>, and the status of all sub-LSPs is <strong>UP</strong>.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> display mpls te p2mp tunnel-interface Tunnel10</strong></pre>
<pre class="screen">------------------------------------------------------------------------------
                      Tunnel10
------------------------------------------------------------------------------
Tunnel State        : UP
Session ID          : 100
Ingress LSR ID      : 1.1.1.1           P2MP ID      : 0x1010101
Admin State         : UP                Oper State   : UP                                            
Primary LSP State   : UP
------------------------------------------------------------------------------
Main LSP State      : UP                LSP ID        : 8
------------------------------------------------------------------------------
S2L Dest Addr       : 3.3.3.3           State         : <strong>UP</strong>
S2L Dest Addr       : 5.5.5.5           State         : <strong>UP</strong>
S2L Dest Addr       : 6.6.6.6           State         : <strong>UP</strong></pre>
</div>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172368372__section_dc_vrp_te-p2p_cfg_013105"><a name="EN-US_TASK_0172368372__section_dc_vrp_te-p2p_cfg_013105"></a><a name="section_dc_vrp_te-p2p_cfg_013105"></a><a name="EN-US_TASK_0172368372__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>LSRA configuration file</p>
<pre class="screen">#
sysname LSRA
#
mpls lsr-id 1.1.1.1
#
mpls
 mpls te
 mpls te p2mp-te
 mpls rsvp-te
 mpls te cspf
#
explicit-path tolsrc
 next hop 10.1.1.2
 next hop 10.3.1.2
#
explicit-path tolsrf
 next hop 10.1.1.2
 next hop 10.2.1.2
 next hop 10.5.1.2
#
explicit-path tolsre
 next hop 10.1.1.2
 next hop 10.2.1.2
 next hop 10.4.1.2
#
mpls te leaf-list iptv1
 #
 destination 3.3.3.3
  path explicit-path tolsrc
 #
 destination 5.5.5.5
  path explicit-path tolsre
 #
 destination 6.6.6.6
  path explicit-path tolsrf
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 00.0005.0000.0000.0001.00
 traffic-eng level-2
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown  
 ip address 10.1.1.1 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface LoopBack1
 ip address 1.1.1.1 255.255.255.255
 isis enable 1
#
interface Tunnel10
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 mpls te p2mp-mode
 mpls te bandwidth ct0 1000
 mpls te leaf-list iptv1
 mpls te tunnel-id 100
#
return</pre>
</li><li><p>LSRB configuration file</p>
<pre class="screen">#
sysname LSRB
#
mpls lsr-id 2.2.2.2
#
mpls
 mpls te
 mpls te p2mp-te
 mpls rsvp-te
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 00.0005.0000.0000.0002.00
 traffic-eng level-2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.2.1.1 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 10.3.1.1 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.1.1.2 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface LoopBack1
 ip address 2.2.2.2 255.255.255.255
 isis enable 1
#
return</pre>
</li><li><p>LSRC configuration file</p>
<pre class="screen">#
sysname LSRC
#
mpls lsr-id 3.3.3.3
#
mpls
 mpls te
 mpls te p2mp-te
 mpls rsvp-te
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 00.0005.0000.0000.0003.00
 traffic-eng level-2
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 10.3.1.2 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface LoopBack1
 ip address 3.3.3.3 255.255.255.255
 isis enable 1
#
return</pre>
</li><li><p>LSRD configuration file</p>
<pre class="screen">#
sysname LSRD
#
mpls lsr-id 4.4.4.4
#
mpls
 mpls te
 mpls te p2mp-te
 mpls rsvp-te
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 00.0005.0000.0000.0004.00
 traffic-eng level-2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.2.1.2 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 10.4.1.1 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.5.1.1 255.255.255.0
 isis enable 1  
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface LoopBack1
 ip address 4.4.4.4 255.255.255.255
 isis enable 1
#
return</pre>
</li><li><p>LSRE configuration file</p>
<pre class="screen">#
sysname LSRE
#
mpls lsr-id 5.5.5.5
#
mpls
 mpls te
 mpls te p2mp-te
 mpls rsvp-te
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 00.0005.0000.0000.0005.00
 traffic-eng level-2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.4.1.2 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#               
interface LoopBack1
 ip address 5.5.5.5 255.255.255.255
 isis enable 1
#
return</pre>
</li><li><p>LSRF configuration file</p>
<pre class="screen">#
sysname LSRF
#
mpls lsr-id 6.6.6.6
#
mpls
 mpls te
 mpls te p2mp-te
 mpls rsvp-te
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 00.0005.0000.0000.0006.00
 traffic-eng level-2
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.5.1.2 255.255.255.0
 isis enable 1
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 10000
 mpls te bandwidth bc0 10000
 mpls rsvp-te
#
interface LoopBack1
 ip address 6.6.6.6 255.255.255.255
 isis enable 1
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0093.html">Configuration Examples for MPLS TE
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0072.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0322.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>