
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a Remote LDP Session">
<meta name="abstract" content="This section provides an example for configuring a remote LDP session. A remote LDP session is mainly used to transmit VPN services.">
<meta name="description" content="This section provides an example for configuring a remote LDP session. A remote LDP session is mainly used to transmit VPN services.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0038.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0039.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0041.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="ldp-p2pvrp,w00800033,z00545680,w00556928,w00606909,z00809835,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MPLS LDP">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MPLS LDP">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS LDP">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS LDP">
<meta name="featuretype" content="MPLS">
<meta name="OWNER" content="z00809835">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="b00896120">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368564">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring a Remote LDP Session</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172368564"></a><a name="EN-US_TASK_0172368564"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a Remote LDP Session</h1>
<div class="taskbody"><p>This section provides an example for configuring a remote LDP session. A remote LDP session is mainly used to transmit VPN services.</p>
<div class="context"><a name="EN-US_TASK_0172368564__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0172368564__fig_dc_vrp_ldp-p2p_cfg_004001">Figure 1</a>, LSRA and LSRC are on the edge of a backbone network. To deploy VPN services over the backbone network, establish a remote LDP session between LSRA and LSRC to establish an LSP.</p>
<div class="fignone" id="EN-US_TASK_0172368564__fig_dc_vrp_ldp-p2p_cfg_004001"><a name="EN-US_TASK_0172368564__fig_dc_vrp_ldp-p2p_cfg_004001"></a><a name="fig_dc_vrp_ldp-p2p_cfg_004001"></a><span class="figcap"><b>Figure 1 </b>Networking diagram of configuring a remote LDP session</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent GE<span>0/1/0</span> and GE<span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0278890666.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368564__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Notes</h4><p>During the configuration, note the following:</p>
<ul><li><p>An LSR ID must be configured before you run other MPLS commands.</p>
</li><li><p>LSR IDs can only be manually configured, and do not have default values.</p>
</li><li><p>Using the IP address of a reachable loopback interface on an LSR as the LSR ID is recommended.</p>
</li><li><p>The IP address of a remote LDP peer must be the LSR ID of the remote LDP peer. When an LDP LSR ID is different from an MPLS LSR ID, the LDP LSR ID must be used.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368564__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Assign an IP address to each interface and configure OSPF to advertise the route to the network segment to which each interface is connected and the host route to each LSR ID.</p>
</li><li><p>Enable MPLS and MPLS LDP globally on each LSR.</p>
</li><li><p>Specify the name and IP address of the remote peer on the LSRs of both ends of a remote LDP session.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368564__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IP address of each interface (as shown in <a href="#EN-US_TASK_0172368564__fig_dc_vrp_ldp-p2p_cfg_004001">Figure 1</a>), OSPF process ID, and OSPF area ID</p>
</li><li><p>LSR ID of each node</p>
</li><li><p>Name and IP address of each remote peer of a remote LDP session</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172368564__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface.</span><p><p>According to <a href="#EN-US_TASK_0172368564__fig_dc_vrp_ldp-p2p_cfg_004001">Figure 1</a>, assign an IP address to each interface, configure the loopback interface addresses as LSR IDs, and configure OSPF to advertise the route to the network segment to which each interface is connected and the host route to each LSR ID. For configuration details, see the configuration files in this section.</p>
</p></li><li><span>Enable MPLS and MPLS LDP globally on each LSR.</span><p><p># Configure LSRA.</p>
<pre class="screen">&lt;LSRA&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> mpls lsr-id 1.1.1.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls-ldp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-mpls-ldp] <strong>quit</strong></pre>
<p># Configure LSRC.</p>
<pre class="screen">&lt;LSRC&gt; <strong>system-view </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC] <strong>mpls lsr-id 3.3.3.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-mpls-ldp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC-mpls-ldp] <strong>quit</strong></pre>
</p></li><li><span>Specify the name and IP address of the remote peer on LSRs of both ends of a remote LDP session.</span><p><p># Configure LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>mpls ldp remote-peer LSRC</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls-ldp-remote-LSRC] <strong>remote-ip 3.3.3.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls-ldp-remote-LSRC] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-mpls-ldp-remote-LSRC] <strong>quit</strong></pre>
<p># Configure LSRC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC] <strong>mpls ldp remote-peer LSRA</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-mpls-ldp-remote-LSRA] <strong>remote-ip 1.1.1.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-mpls-ldp-remote-LSRA] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC-mpls-ldp-remote-LSRA] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># After completing the configuration, run the <strong>display mpls ldp session</strong> command on each node. The status of the remote LDP session between LSRA and LSRC is <strong>Operational</strong>.</p>
<p>The following example uses the command output on LSRA.</p>
<pre class="screen">&lt;LSRA&gt; <strong>display mpls ldp session</strong></pre>
<pre class="screen"> LDP Session(s) in Public Network
 Codes: LAM(Label Advertisement Mode), SsnAge Unit(DDDD:HH:MM)
<span> An asterisk (*) before a session means the session is being deleted.</span>
--------------------------------------------------------------------------
 PeerID             Status      LAM  SsnRole  SsnAge       KASent/Rcv
--------------------------------------------------------------------------
3.3.3.9:0          <strong>Operational</strong> DU   Passive  0000:00:01  6/6
--------------------------------------------------------------------------
TOTAL: 1 Session(s) Found.
</pre>
<p># Run the <strong>display mpls ldp remote-peer</strong> command on either of the LSR of the remote LDP session. You can view information about the remote peer of the LSR.</p>
<p>The following example uses the command output on LSRA.</p>
<pre class="screen">&lt;LSRA&gt; <strong>display mpls ldp remote-peer</strong></pre>
<pre class="screen">                         LDP Remote Entity Information
 ------------------------------------------------------------------------------
 Remote Peer Name   : LSRC
 Description        : ----
 Remote Peer IP     : 3.3.3.9              LDP ID        : 1.1.1.9:0
 Transport Address  : 1.1.1.9              Entity Status : Active

 Configured Keepalive Hold Timer : 45 Sec
 Configured Keepalive Send Timer : ----
 Configured Hello Hold Timer     : 45 Sec
 Negotiated Hello Hold Timer     : 45 Sec
 Configured Hello Send Timer     : ----
 Configured Delay Timer          : <span>10 Sec</span>
 Hello Packet sent/received      : 6347/6307
 Label Advertisement Mode        : Downstream Unsolicited
 Auto-config                     : ----
 Manual-config                   : effective
 Session-Protect effect          : NO
 Session-Protect Duration        : ----
 Session-Protect Remain          : ----
 ------------------------------------------------------------------------------
 TOTAL: 1 Remote-Peer(s) Found.
</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172368564__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>LSRA configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname LSRA</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls lsr-id 1.1.1.9</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls ldp</pre>
<pre class="screen"> #
 ipv4-family</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls ldp remote-peer LSRC</pre>
<pre class="screen"> remote-ip 3.3.3.9</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.1.1.1 255.255.255.252</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack1</pre>
<pre class="screen"> ip address 1.1.1.9 255.255.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 1.1.1.9 0.0.0.0</pre>
<pre class="screen">  network 10.1.1.0 0.0.0.3</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p>LSRB configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname LSRB</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.1.1.2 255.255.255.252</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.2.1.1 255.255.255.252</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack1</pre>
<pre class="screen"> ip address 2.2.2.9 255.255.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 2.2.2.9 0.0.0.0</pre>
<pre class="screen">  network 10.1.1.0 0.0.0.3</pre>
<pre class="screen">  network 10.2.1.0 0.0.0.3</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p>LSRC configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname LSRC</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls lsr-id 3.3.3.9</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls ldp</pre>
<pre class="screen"> #
 ipv4-family</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls ldp remote-peer LSRA</pre>
<pre class="screen"> remote-ip 1.1.1.9</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.2.1.2 255.255.255.252</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack1</pre>
<pre class="screen"> ip address 3.3.3.9 255.255.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 3.3.3.9 0.0.0.0</pre>
<pre class="screen">  network 10.2.1.0 0.0.0.3</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0038.html">Configuration Examples for MPLS LDP
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0039.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0041.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>