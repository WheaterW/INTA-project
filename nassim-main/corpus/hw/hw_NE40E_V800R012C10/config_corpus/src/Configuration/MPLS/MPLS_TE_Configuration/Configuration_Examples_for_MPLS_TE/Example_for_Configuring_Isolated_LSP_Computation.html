
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Isolated LSP Computation">
<meta name="abstract" content="This section provides an example for configuring isolated label switched path (LSP) computation.">
<meta name="description" content="This section provides an example for configuring isolated label switched path (LSP) computation.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0093.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0169.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0130.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,te-p2pvrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="OWNER" content="l00468467">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00845984">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368354">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/thickbox.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/imageResize.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery-migrate-1.2.1.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery-ui.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery.mousewheel.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/thickbox.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring Isolated LSP Computation</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172368354"></a><a name="EN-US_TASK_0172368354"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Isolated LSP Computation</h1>
<div class="taskbody"><p>This section provides an example for configuring isolated label switched path (LSP) computation.</p>
<div class="context"><a name="EN-US_TASK_0172368354__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>Isolated primary and hot-standby LSPs are necessary to improve the LSP reliability on IP radio access networks (IP RANs) that use Multiprotocol Label Switching (MPLS) Traffic Engineering (TE). The constrained shortest path first (CSPF) algorithm does not meet this reliability requirement because CSPF may compute two LSPs that intersect at aggregation nodes. Specifying explicit paths for LSPs can improve reliability but this method does not adapt to topology changes. Each time a node is added to or deleted from the IP RAN, operators must configure new explicit paths, which is time-consuming and laborious. Isolated LSP computation is another method to improve reliability. After this function is configured, the device uses both the disjoint and CSPF algorithms to compute isolated primary and hot-standby LSPs.</p>
<p><a href="#EN-US_TASK_0172368354__fig_dc_vrp_te-p2p_cfg_017201">Figure 1</a> illustrates an IP RAN that uses a Resource Reservation Protocol - Traffic Engineering (RSVP-TE) tunnel. Devices on this network use the Open Shortest Path First (OSPF) protocol for communication. The numeral on each link represents the link TE metric. An RSVP-TE tunnel needs to be established between LSRA and LSRF. The constraint-based routed label switched path (CR-LSP) hot standby function needs to be enabled.</p>
<p>Two isolated LSPs exist on this topology: LSRA -&gt; LSRC -&gt; LSRE -&gt; LSRF and LSRA -&gt; LSRB -&gt; LSRD -&gt; LSRF. However, if the disjoint algorithm is not enabled, CSPF computes LSRA -&gt; LSRC-&gt; LSRD-&gt; LSRF as the primary LSP and cannot compute an isolated hot-standby LSP. To improve LSP reliability, configure isolated LSP computation.</p>
<div class="fignone" id="EN-US_TASK_0172368354__fig_dc_vrp_te-p2p_cfg_017201"><a name="EN-US_TASK_0172368354__fig_dc_vrp_te-p2p_cfg_017201"></a><a name="fig_dc_vrp_te-p2p_cfg_017201"></a><span class="figcap"><b>Figure 1 </b>RSVP-TE tunnel networking</span><br><span><img class="imgResize" src="images/fig_dc_vrp_te-p2p_cfg_017201.png" width="525.3633000000001" title="Click to enlarge"></span></div>

<div class="tableBorder"><a name="EN-US_TASK_0172368354__tab_01"></a><a name="tab_01"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172368354__tab_01" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Interfaces and IP addresses</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="16.666666666666664%" id="mcps1.4.1.6.2.7.1.1" liSelected="liSelected"><p>Device Name</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="16.666666666666664%" id="mcps1.4.1.6.2.7.1.2" liSelected="liSelected"><p>Interface Name</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="16.666666666666664%" id="mcps1.4.1.6.2.7.1.3" liSelected="liSelected"><p>IP Address and Mask</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="16.666666666666664%" id="mcps1.4.1.6.2.7.1.4" liSelected="liSelected"><p>Device Name</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="16.666666666666664%" id="mcps1.4.1.6.2.7.1.5" liSelected="liSelected"><p>Interface Name</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="16.666666666666664%" id="mcps1.4.1.6.2.7.1.6" liSelected="liSelected"><p>IP Address and Mask</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="3" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.1 "><p>LSRA</p>
</td>
<td class="cellrowborder" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.2 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.3 "><p>1.1.1.1/32</p>
</td>
<td class="cellrowborder" rowspan="3" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.4 "><p>LSRB</p>
</td>
<td class="cellrowborder" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.5 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.6 "><p>2.2.2.2/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.3 "><p>10.1.1.1/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.5 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.6 "><p>10.1.2.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.2 "><p>GE <span>0/1/1</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.3 "><p>10.1.2.1/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.5 "><p>GE <span>0/1/1</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.6 "><p>10.1.6.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="4" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.1 "><p>LSRC</p>
</td>
<td class="cellrowborder" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.2 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.3 "><p>3.3.3.3/32</p>
</td>
<td class="cellrowborder" rowspan="4" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.4 "><p>LSRD</p>
</td>
<td class="cellrowborder" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.5 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.6 "><p>4.4.4.4/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.3 "><p>10.1.1.2/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.5 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.6 "><p>10.1.6.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.2 "><p>GE <span>0/1/1</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.3 "><p>10.1.3.1/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.5 "><p>GE <span>0/1/1</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.6 "><p>10.1.3.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.2 "><p>GE <span>0/1/2</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.3 "><p>10.1.4.1/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.5 "><p>GE <span>0/1/2</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.6 "><p>10.1.7.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.1 "><p>LSRE</p>
</td>
<td class="cellrowborder" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.2 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.3 "><p>5.5.5.5/32</p>
</td>
<td class="cellrowborder" rowspan="3" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.4 "><p>LSRF</p>
</td>
<td class="cellrowborder" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.5 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" width="16.666666666666664%" headers="mcps1.4.1.6.2.7.1.6 "><p>6.6.6.6/32</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.3 "><p>10.1.4.2/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.5 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.6 "><p>10.1.7.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.2 "><p>GE <span>0/1/1</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.3 "><p>10.1.5.1/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.5 "><p>GE <span>0/1/1</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.7.1.6 "><p>10.1.5.2/24</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368354__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Assign addresses to all physical and loopback interfaces listed in <a href="#EN-US_TASK_0172368354__tab_01">Table 1</a>.</p>
</li><li><p>Globally enable OSPF on each device so that OSPF advertises segment routes of each physical and loopback interface. Enable OSPF TE in the area where the devices reside.</p>
</li><li><p>Set MPLS label switching router (LSR) IDs for all devices and globally enable MPLS, TE, RSVP-TE, and CSPF.</p>
</li><li><p>Enable MPLS, TE, and RSVP-TE on the outbound interfaces of all links along the TE tunnel. Set a TE metric for each link according to <a href="#EN-US_TASK_0172368354__fig_dc_vrp_te-p2p_cfg_017201">Figure 1</a>.</p>
</li><li><p>Create a tunnel interface on LSRA and specify the IP address, tunnel protocol, destination address, tunnel ID, and signaling protocol RSVP-TE for the tunnel interface.</p>
</li><li><p>Enable the CR-LSP hot standby function and the disjoint algorithm on the tunnel interface.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368354__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IP address for each interface (see <a href="#EN-US_TASK_0172368354__tab_01">Table 1</a>.)</p>
</li><li><p>OSPF process ID (1) and area ID (0.0.0.0)</p>
</li><li><p>TE metric for each link (see <a href="#EN-US_TASK_0172368354__fig_dc_vrp_te-p2p_cfg_017201">Figure 1</a>.)</p>
</li><li><p>Loopback interface address for each MPLS LSR ID</p>
</li><li><p>Tunnel interface number (Tunnel1), tunnel ID (1), loopback interface address to be borrowed, destination address (6.6.6.6), and signaling protocol (RSVP-TE)</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172368354__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface.</span><p><p>Assign an IP address to each interface and create a loopback interface on each device, according to <a href="#EN-US_TASK_0172368354__tab_01">Table 1</a>. For configuration details, see <a href="#EN-US_TASK_0172368354__section_05">Configuration Files</a> in this section.</p>
</p></li><li><span>Enable OSPF on each device.</span><p><p>Enable basic OSPF functions and MPLS TE on each device.</p>
<p># Configure LSRA.</p>
<pre class="screen">&lt;LSRA&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-ospf-1] <strong>opaque-capability enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-ospf-1] <strong>area 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-ospf-1-area-0.0.0.0] <strong>network 1.1.1.1 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-ospf-1-area-0.0.0.0] <strong>network 10.1.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-ospf-1-area-0.0.0.0] <strong>network 10.1.2.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-ospf-1-area-0.0.0.0] <strong>mpls-te enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-ospf-1-area-0.0.0.0] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-ospf-1] <strong>quit</strong></pre>
<p>Repeat this step for LSRB, LSRC, LSRD, LSRE, and LSRF. For configuration details, see <a href="#EN-US_TASK_0172368354__section_05">Configuration Files</a> in this section.</p>
</p></li><li><span>Configure basic MPLS functions and enable MPLS TE, RSVP-TE, and CSPF.</span><p><p>Enable MPLS, MPLS TE, RSVP-TE, and CSPF on each device. Enable MPLS, TE, and RSVP-TE on the outbound interface of each link. Set a TE metric for each link.</p>
<p># Configure LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>mpls lsr-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls] <strong>mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/0</span>] <strong>mpls te metric 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/1</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/1</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/1</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/1</span>] <strong>mpls te metric 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA] <strong>commit</strong></pre>
<p>Repeat this step for LSRB, LSRC, LSRD, LSRE, and LSRF. For configuration details, see <a href="#EN-US_TASK_0172368354__section_05">Configuration Files</a> in this section.</p>
</p></li><li><span>Configure an MPLS TE tunnel interface.</span><p><p># Configure LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>interface tunnel1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel1] <strong>ip address unnumbered interface LoopBack1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel1] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel1] <strong>destination 6.6.6.6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel1] <strong>mpls te tunnel-id 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel1] <strong>mpls te signal-protocol rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel1] <strong>commit</strong></pre>
</p></li><li><span>Configure isolated LSP computation.</span><p><p>Enable the CR-LSP hot standby function and then the disjoint algorithm on the tunnel interface.</p>
<p># Configure LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-Tunnel1] <strong>mpls te backup hot-standby</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel1] <strong>mpls te cspf disjoint</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-Tunnel1] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Run the <strong>display mpls te cspf destination 6.6.6.6 computation-mode disjoint</strong> command on LSRA. The command output shows that the primary LSP is LSRA -&gt; LSRC -&gt; LSRE -&gt; LSRF and the hot-standby LSP is LSRA-&gt; LSRB-&gt; LSRD-&gt; LSRF. The two LSPs do not intersect.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>display mpls te cspf destination 6.6.6.6 computation-mode disjoint</strong></pre>
<pre class="screen">Main path for the given constraints is:
1.1.1.1                          Include          LSR-ID
10.1.1.1                         Include 
10.1.1.2                         Include 
3.3.3.3                          Include          LSR-ID
10.1.4.1                         Include 
10.1.4.2                         Include 
5.5.5.5                          Include          LSR-ID
10.1.5.1                         Include 
10.1.5.2                         Include 
6.6.6.6                          Include          LSR-ID
The total metrics of the calculated path is :   16
  
Hot-standby path for the given constraints is:
1.1.1.1                          Include          LSR-ID
10.1.2.1                         Include 
10.1.2.2                         Include 
2.2.2.2                          Include          LSR-ID
10.1.6.1                         Include 
10.1.6.2                         Include 
4.4.4.4                          Include          LSR-ID
10.1.7.1                         Include 
10.1.7.2                         Include 
6.6.6.6                          Include          LSR-ID
Complete disjoint path computed and the total metrics of the calculated path is :   21</pre>
<p># Run the <strong>display mpls te tunnel-interface Tunnel1</strong> and <strong>display mpls te tunnel path Tunnel1</strong> commands on LSRA to view information about the primary and hot-standby LSPs.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>display mpls te tunnel-interface Tunnel1</strong></pre>
<pre class="screen">    Tunnel Name       : Tunnel1
    Signalled Tunnel Name: -
    Tunnel State Desc : CR-LSP is Up
    Tunnel Attributes   :     
    Active LSP          : Primary LSP                                       
    Traffic Switch      : - 
    Session ID          : 1
    Ingress LSR ID      : 1.1.1.1               Egress LSR ID: 6.6.6.6
    Admin State         : UP                    Oper State   : UP
    Signaling Protocol  : RSVP
    FTid                : 1
    Tie-Breaking Policy : None                  Metric Type  : None
    Bfd Cap             : None                  
    Reopt               : Disabled              Reopt Freq   : -              
<span>    Inter-area Reopt    : Disabled </span>
    Auto BW             : Disabled              Threshold    : 0 percent
    Current Collected BW: 0 kbps                Auto BW Freq : 0
    Min BW              : 0 kbps                Max BW       : 0 kbps
    Offload             : Disabled              Offload Freq : - 
    Low Value           : -                     High Value   : - 
    Readjust Value      : - 
    Offload Explicit Path Name: 
    Tunnel Group        : -                                              
    Interfaces Protected: -
    Excluded IP Address : -
    Referred LSP Count  : 0  
    Primary Tunnel      : -                     Pri Tunn Sum : -              
    Backup Tunnel       : -                                                    
    Group Status        : Up                    Oam Status   : -             
    IPTN InLabel        : -                     Tunnel BFD Status : -                               
    BackUp LSP Type     : Hot-Standby           BestEffort   : Enabled
    Secondary HopLimit  : -
    BestEffort HopLimit  : -
    Secondary Explicit Path Name: -
    Secondary Affinity Prop/Mask: 0x0/0x0
    BestEffort Affinity Prop/Mask: 0x0/0x0  
    IsConfigLspConstraint: -
    Hot-Standby Revertive Mode:  Revertive
    Hot-Standby Overlap-path:  Disabled
    Hot-Standby Switch State:  CLEAR
    Bit Error Detection:  Disabled
    Bit Error Detection Switch Threshold:  -
    Bit Error Detection Resume Threshold:  -
    Ip-Prefix Name    : -
    P2p-Template Name : -
    PCE Delegate      : No            LSP Control Status : Local control
    Path Verification : --
    Entropy Label     : None 
    Auto BW Remain Time : 200 s               Reopt Remain Time  : 100 s
<span>    Metric Inherit IGP : None</span>
<span>    Binding Sid       : -                     Reverse Binding Sid : - </span>
    Self-Ping         : Disable               Self-Ping Duration : 1800 sec
    FRR Attr Source   : -                     Is FRR degrade down : No
    
    Primary LSP ID      : 1.1.1.1:19
    LSP State           : UP                    LSP Type     : Primary
    Setup Priority      : 7                     Hold Priority: 7
    IncludeAll          : 0x0
    IncludeAny          : 0x0
    ExcludeAny          : 0x0
    Affinity Prop/Mask  : 0x0/0x0               Resv Style   :  SE
    Configured Bandwidth Information:
    CT0 Bandwidth(Kbit/sec): 10000           CT1 Bandwidth(Kbit/sec): 0
    CT2 Bandwidth(Kbit/sec): 0               CT3 Bandwidth(Kbit/sec): 0
    CT4 Bandwidth(Kbit/sec): 0               CT5 Bandwidth(Kbit/sec): 0
    CT6 Bandwidth(Kbit/sec): 0               CT7 Bandwidth(Kbit/sec): 0
    Actual Bandwidth Information:
    CT0 Bandwidth(Kbit/sec): 10000           CT1 Bandwidth(Kbit/sec): 0
    CT2 Bandwidth(Kbit/sec): 0               CT3 Bandwidth(Kbit/sec): 0
    CT4 Bandwidth(Kbit/sec): 0               CT5 Bandwidth(Kbit/sec): 0
    CT6 Bandwidth(Kbit/sec): 0               CT7 Bandwidth(Kbit/sec): 0
    Explicit Path Name  : -                                Hop Limit: -
    Record Route        : Disabled              Record Label : Disabled
    Route Pinning       : Disabled
    FRR Flag            : Disabled
    IdleTime Remain     : -
    BFD Status          : -
    Soft Preemption     : Enabled 
    Reroute Flag        : Disabled
    Pce Flag            : Normal<span>
    Path Setup Type     : CSPF</span>
    Create Modify LSP Reason: -
    Self-Ping Status    : -
    
    Backup LSP ID       : 1.1.1.9:46945
    IsBestEffortPath    : No
    LSP State           : UP                    LSP Type     : Hot-Standby
    Setup Priority      : 7                     Hold Priority: 7
    IncludeAll          : 0x0
    IncludeAny          : 0x0
    ExcludeAny          : 0x0
    Affinity Prop/Mask  : 0x0/0x0               Resv Style   :  SE
    Configured Bandwidth Information:
    CT0 Bandwidth(Kbit/sec): 0               CT1 Bandwidth(Kbit/sec): 0
    CT2 Bandwidth(Kbit/sec): 0               CT3 Bandwidth(Kbit/sec): 0
    CT4 Bandwidth(Kbit/sec): 0               CT5 Bandwidth(Kbit/sec): 0
    CT6 Bandwidth(Kbit/sec): 0               CT7 Bandwidth(Kbit/sec): 0
    Actual Bandwidth Information:
    CT0 Bandwidth(Kbit/sec): 0               CT1 Bandwidth(Kbit/sec): 0
    CT2 Bandwidth(Kbit/sec): 0               CT3 Bandwidth(Kbit/sec): 0
    CT4 Bandwidth(Kbit/sec): 0               CT5 Bandwidth(Kbit/sec): 0
    CT6 Bandwidth(Kbit/sec): 0               CT7 Bandwidth(Kbit/sec): 0
    Explicit Path Name  : -                                Hop Limit: -
    Record Route        : Enabled               Record Label : Disabled
    Route Pinning       : Disabled
    FRR Flag            : Disabled
    IdleTime Remain     : -
    BFD Status          : -
    Soft Preemption     : Enabled
    Reroute Flag        : Enabled
    Pce Flag            : Normal
    Path Setup Type     : CSPF
    Create Modify LSP Reason: -
    Self-Ping Status    : -</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>display mpls te tunnel path Tunnel1</strong></pre>
<pre class="screen"> Tunnel Interface Name : Tunnel1
 <strong>Lsp ID : 1.1.1.1 :1 :2</strong>
 Hop Information
  Hop 0   10.1.1.1
  Hop 1   10.1.1.2
  Hop 2   3.3.3.3
  Hop 3   10.1.4.1
  Hop 4   10.1.4.2
  Hop 5   5.5.5.5
  Hop 6   10.1.5.1
  Hop 7   10.1.5.2
  Hop 8   6.6.6.6
  
 Tunnel Interface Name : Tunnel1
 <strong>Lsp ID : 1.1.1.1 :1 :3</strong>
 Hop Information
  Hop 0   10.1.2.1
  Hop 1   10.1.2.2
  Hop 2   2.2.2.2
  Hop 3   10.1.6.1
  Hop 4   10.1.6.2
  Hop 5   4.4.4.4
  Hop 6   10.1.7.1
  Hop 7   10.1.7.2
  Hop 8   6.6.6.6</pre>
<p>The command outputs show that the computed primary and hot-standby LSPs are the same as the actual primary and hot-standby LSPs, indicating that the device has computed two isolated LSPs.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172368354__section_05"><a name="EN-US_TASK_0172368354__section_05"></a><a name="section_05"></a><a name="EN-US_TASK_0172368354__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>LSRA configuration file</p>
<pre class="screen">#
sysname LSRA
#
mpls lsr-id 1.1.1.1
#
mpls
 mpls te
 mpls rsvp-te
 mpls te cspf
#                                         
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.1.1.1 255.255.255.0
 mpls           
 mpls te        
 mpls te metric 1
 mpls rsvp-te
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown  
 ip address 10.1.2.1 255.255.255.0
 mpls           
 mpls te        
 mpls te metric 10
 mpls rsvp-te
#
interface LoopBack1
 ip address 1.1.1.1 255.255.255.255
#                                                                               
interface Tunnel1                                                           
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 6.6.6.6
 mpls te signal-protocol rsvp-te
 mpls te backup hot-standby 
 mpls te tunnel-id 1
 mpls te cspf disjoint
#                                                                               
ospf 1          
 opaque-capability enable
 area 0.0.0.0   
  network 1.1.1.1 0.0.0.0
  network 10.1.1.0 0.0.0.255
  network 10.1.2.0 0.0.0.255
  mpls-te enable
#
return</pre>
</li><li><p>LSRB configuration file</p>
<pre class="screen">#
sysname LSRB
#
mpls lsr-id 2.2.2.2
#
mpls
 mpls te
 mpls rsvp-te
 mpls te cspf
#                                         
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.1.2.2 255.255.255.0
 mpls           
 mpls te
 mpls rsvp-te
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown  
 ip address 10.1.6.1 255.255.255.0
 mpls           
 mpls te        
 mpls te metric 10
 mpls rsvp-te
#
interface LoopBack1
 ip address 2.2.2.2 255.255.255.255
#
ospf 1          
 opaque-capability enable
 area 0.0.0.0   
  network 2.2.2.2 0.0.0.0
  network 10.1.2.0 0.0.0.255
  network 10.1.6.0 0.0.0.255
  mpls-te enable
#
return</pre>
</li><li><p>LSRC configuration file</p>
<pre class="screen">#
sysname LSRC
#
mpls lsr-id 3.3.3.3
#
mpls
 mpls te
 mpls rsvp-te
 mpls te cspf
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.1.1.2 255.255.255.0
 mpls           
 mpls te
 mpls rsvp-te
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown  
 ip address 10.1.3.1 255.255.255.0
 mpls           
 mpls te        
 mpls te metric 1
 mpls rsvp-te 
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown  
 ip address 10.1.4.1 255.255.255.0
 mpls           
 mpls te        
 mpls te metric 5
 mpls rsvp-te 
#
interface LoopBack1
 ip address 3.3.3.3 255.255.255.255
#
ospf 1          
 opaque-capability enable
 area 0.0.0.0   
  network 3.3.3.3 0.0.0.0
  network 10.1.1.0 0.0.0.255
  network 10.1.3.0 0.0.0.255
  network 10.1.4.0 0.0.0.255
  mpls-te enable
#                                         
return</pre>
</li><li><p>LSRD configuration file</p>
<pre class="screen">#
sysname LSRD
#
mpls lsr-id 4.4.4.4
#
mpls
 mpls te
 mpls rsvp-te
 mpls te cspf
#                                         
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.1.6.2 255.255.255.0
 mpls           
 mpls te
 mpls rsvp-te 
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown  
 ip address 10.1.3.2 255.255.255.0
 mpls           
 mpls te
 mpls rsvp-te 
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown  
 ip address 10.1.7.1 255.255.255.0
 mpls           
 mpls te        
 mpls te metric 1
 mpls rsvp-te
#
interface LoopBack1
 ip address 4.4.4.4 255.255.255.255
#
ospf 1          
 opaque-capability enable
 area 0.0.0.0   
  network 4.4.4.4 0.0.0.0
  network 10.1.3.0 0.0.0.255
  network 10.1.6.0 0.0.0.255
  network 10.1.7.0 0.0.0.255
  mpls-te enable
#                                         
return</pre>
</li><li><p>LSRE configuration file</p>
<pre class="screen">#
sysname LSRE
#
mpls lsr-id 5.5.5.5
#
mpls
 mpls te
 mpls rsvp-te
 mpls te cspf
#                                         
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.1.4.2 255.255.255.0
 mpls           
 mpls te
 mpls rsvp-te
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown  
 ip address 10.1.5.1 255.255.255.0
 mpls           
 mpls te        
 mpls te metric 10
 mpls rsvp-te 
#
interface LoopBack1
 ip address 5.5.5.5 255.255.255.255
#
ospf 1          
 opaque-capability enable
 area 0.0.0.0   
  network 5.5.5.5 0.0.0.0
  network 10.1.4.0 0.0.0.255
  network 10.1.5.0 0.0.0.255
  mpls-te enable
#                                         
return</pre>
</li><li><p>LSRF configuration file</p>
<pre class="screen">#
sysname LSRF
#
mpls lsr-id 6.6.6.6
#
mpls
 mpls te
 mpls rsvp-te
 mpls te cspf
#                                         
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.1.7.2 255.255.255.0
 mpls           
 mpls te
 mpls rsvp-te 
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown  
 ip address 10.1.5.2 255.255.255.0
 mpls           
 mpls te
 mpls rsvp-te 
#
interface LoopBack1
 ip address 6.6.6.6 255.255.255.255
#
ospf 1          
 opaque-capability enable
 area 0.0.0.0   
  network 6.6.6.6 0.0.0.0
  network 10.1.5.0 0.0.0.255
  network 10.1.7.0 0.0.0.255
  mpls-te enable
#                                         
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0093.html">Configuration Examples for MPLS TE
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0169.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0130.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>

<script language="JavaScript">
<!--
image_size('.imgResize');
var msg_imageMax = "view original image";
var msg_imageClose = "close";
//--></script></body>
</html>