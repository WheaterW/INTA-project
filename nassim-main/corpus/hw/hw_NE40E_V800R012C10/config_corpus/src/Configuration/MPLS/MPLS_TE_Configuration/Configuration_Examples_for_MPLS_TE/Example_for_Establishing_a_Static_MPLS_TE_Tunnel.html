
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Establishing a Static MPLS TE Tunnel">
<meta name="abstract" content="This section provides an example for configuring a static MPLS TE tunnel, which involves enabling MPLS TE, configuring the MPLS TE bandwidth, and setting up a static CR-LSP.">
<meta name="description" content="This section provides an example for configuring a static MPLS TE tunnel, which involves enabling MPLS TE, configuring the MPLS TE bandwidth, and setting up a static CR-LSP.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0093.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0168.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,te-p2pvrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="OWNER" content="l00468467">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00845984">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368303">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Establishing a Static MPLS TE Tunnel</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172368303"></a><a name="EN-US_TASK_0172368303"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Establishing a Static MPLS TE Tunnel</h1>
<div class="taskbody"><p>This section provides an example for configuring a static MPLS TE tunnel, which involves enabling MPLS TE, configuring the MPLS TE bandwidth, and setting up a static CR-LSP.</p>
<div class="context"><a name="EN-US_TASK_0172368303__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the carrier network shown in <a href="#EN-US_TASK_0172368303__fig_dc_vrp_te-p2p_cfg_018301">Figure 1</a>, some devices have low routing and processing performance. The carrier wants to use an MPLS TE tunnel to transmit services. To meet this requirement, a static TE tunnel from LSRA to LSRC and a static TE tunnel from LSRC to LSRA can be established. A static TE tunnel is manually established, without using a dynamic signaling protocol or IGP routes, which consumes a few device resources and has low requirement on device performance.</p>
<div class="fignone" id="EN-US_TASK_0172368303__fig_dc_vrp_te-p2p_cfg_018301"><a name="EN-US_TASK_0172368303__fig_dc_vrp_te-p2p_cfg_018301"></a><a name="fig_dc_vrp_te-p2p_cfg_018301"></a><span class="figcap"><b>Figure 1 </b>Networking diagram for static CR-LSP configuration</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent GE <span>0/1/0</span> and GE <span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_te-p2p_cfg_018301.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368303__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure an IP address for each interface and a loopback address to be used as an MPLS LSR ID on each node.</p>
</li><li><p>Configure the LSR ID and globally enable MPLS and MPLS TE on each node and interface.</p>
</li><li><p>Create a tunnel interface on the ingress and specify the IP address of the tunnel, tunnel protocol, destination address, tunnel ID, and the signaling protocol used to establish the tunnel.</p>
</li><li><div class="p">Configure a static CR-LSP associated with the tunnel and specify the following parameters on each type of node:<ul><li>Ingress: outgoing label and next-hop address</li><li>Transit node: inbound interface name, next-hop address, and outgoing label</li><li>Egress: incoming label and inbound interface name</li></ul>
</div>
</li></ol>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>The outgoing label of each node is the incoming label of the next node.</p>
</li><li><p>When running the <a href="cmdqueryname=static-cr-lsp+ingress"><b><span class="cmdname">static-cr-lsp ingress</span></b></a> { <i><span class="varname">tunnel-name</span></i> | <strong><span>tunnel-interface</span></strong> <strong><span>tunnel</span></strong> <i><span class="varname">port-num</span></i> } <strong><span>destination</span></strong> <i><span class="varname">destination-address</span></i> { <strong><span>nexthop</span></strong> <i><span class="varname">next-hop-address</span></i> | <strong><span>outgoing-interface</span></strong> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> } <sup>*</sup> <strong><span>out-label</span></strong> <i><span class="varname">out-label</span></i> command to configure the ingress of a CR-LSP, note that <em>tunnel-name</em> must be the same as the tunnel interface name specified in the <strong>interface tunnel</strong> <em>interface-number</em> command. The value of <em>tunnel-name</em> is a string of case-sensitive character with no spaces. For example, the name of the tunnel created by using the <strong>interface Tunnel 20</strong> command is Tunnel20. In this case, the parameter of the static CR-LSP on the ingress is Tunnel20. This restriction does not apply to transit nodes or egresses.</p>
</li></ul>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368303__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IP address of each interface</p>
</li><li><p>Tunnel interface names, tunnel interface IP addresses, destination addresses, tunnel IDs, and tunnel signaling protocol (CR-Static) on LSRA and LSRC</p>
</li><li><p>Next-hop address and outgoing label of the ingress on the static CR-LSP</p>
</li><li><p>Inbound interface name, next-hop address, and outgoing label of the transit node on the static CR-LSP</p>
</li><li><p>Inbound interface name of the egress on the static CR-LSP</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172368303__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface.</span><p><p>Assign an IP address and a mask to each interface.</p>
<p>For configuration details, see <a href="#EN-US_TASK_0172368303__section_dc_vrp_cfg_00383505">Configuration Files</a> in this section.</p>
</p></li><li><span>Configure basic MPLS functions and enable MPLS TE.</span><p><p># Configure LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> mpls lsr-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<p>Repeat this step for LSRB and LSRC. For configuration details, see <a href="#EN-US_TASK_0172368303__section_dc_vrp_cfg_00383505">Configuration Files</a> in this section.</p>
</p></li><li><span>Configure an MPLS TE tunnel.</span><p><p># Create an MPLS TE tunnel from LSRA to LSRC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> interface Tunnel 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel10] <strong>ip address unnumbered interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel10] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel10]<strong> destination 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel10] <strong>mpls te tunnel-id 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel10] <strong>mpls te signal-protocol cr-static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-Tunnel10] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-Tunnel10]<strong> quit</strong></pre>
<p># Create an MPLS TE tunnel from LSRC to LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC]<strong> interface Tunnel 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-Tunnel20] <strong>ip address unnumbered interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-Tunnel20] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-Tunnel20]<strong> destination 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-Tunnel20] <strong>mpls te tunnel-id 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-Tunnel20] <strong>mpls te signal-protocol cr-static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-Tunnel20] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC-Tunnel20] <strong>quit</strong></pre>
</p></li><li><span>Create a static CR-LSP from LSRA to LSRC.</span><p><p># Configure LSRA as the ingress of the static CR-LSP.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> static-cr-lsp ingress tunnel-interface Tunnel 10 destination 3.3.3.3 nexthop 10.21.1.2 out-label 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA]<strong> commit</strong></pre>
<p># Configure LSRB as the transit node of the static CR-LSP.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB]<strong> static-cr-lsp transit Tunnel10 incoming-interface gigabitethernet <span>0/1/0</span> in-label 20 nexthop 10.32.1.2 out-label 30</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB]<strong> commit</strong></pre>
<p># Configure LSRC as the egress of the static CR-LSP.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC]<strong> static-cr-lsp egress Tunnel10 incoming-interface gigabitethernet <span>0/2/0</span> in-label 30</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC]<strong> commit</strong></pre>
</p></li><li><span>Create a static CR-LSP from LSRC to LSRA.</span><p><p># Configure LSRC as the ingress of the static CR-LSP.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC]<strong> static-cr-lsp ingress tunnel-interface Tunnel 20 destination 1.1.1.1 nexthop 10.32.1.1 out-label 120</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC]<strong> commit</strong></pre>
<p># Configure LSRB as the transit node of the static CR-LSP.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB]<strong> static-cr-lsp transit Tunnel20 incoming-interface gigabitethernet <span>0/2/0</span> in-label 120 nexthop 10.21.1.1 out-label 130</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB]<strong> commit</strong></pre>
<p># Configure LSRA as the egress of the static CR-LSP.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>static-cr-lsp egress Tunnel20 incoming-interface gigabitethernet <span>0/1/0</span> in-label 130</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA]<strong> commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>After completing the configuration, run the <strong>display interface tunnel</strong> command on LSRA. The command output shows that the status of the tunnel interface is Up.</p>
<p>Run the <strong>display mpls te tunnel</strong> command on each LSR to view the establishment status of the MPLS TE tunnel.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> display mpls te tunnel</strong></pre>
<pre class="screen">* means the LSP is detour LSP
------------------------------------------------------------------------------
Ingress LsrId    Destination      LSPID   In/Out Label     R  Tunnel-name
------------------------------------------------------------------------------
1.1.1.1          3.3.3.3          1       --/20          I  Tunnel10
-                -                -       130/--         E  Tunnel20
------------------------------------------------------------------------------
R: Role, I: Ingress, T: Transit, E: Egress</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB] <strong>display mpls te tunnel</strong></pre>
<pre class="screen">* means the LSP is detour LSP
------------------------------------------------------------------------------
Ingress LsrId    Destination      LSPID   In/Out Label     R  Tunnel-name
------------------------------------------------------------------------------
-                -                -       20/30            T  Tunnel10
-                -                -       120/130          T  Tunnel20
------------------------------------------------------------------------------
R: Role, I: Ingress, T: Transit, E: Egress</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC] <strong>display mpls te tunnel</strong></pre>
<pre class="screen">* means the LSP is detour LSP
------------------------------------------------------------------------------
Ingress LsrId    Destination      LSPID   In/Out Label     R  Tunnel-name
------------------------------------------------------------------------------
-                -                -       30/--            E  Tunnel10       
3.3.3.3          1.1.1.1          1       --/120           I  Tunnel20 
------------------------------------------------------------------------------
R: Role, I: Ingress, T: Transit, E: Egress</pre>
<p>Run the <strong>display mpls lsp</strong> or <strong>display mpls static-cr-lsp</strong> command on each LSR to view the establishment status of the static CR-LSP.</p>
<p># Check the configuration on LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>display mpls static-cr-lsp</strong></pre>
<pre class="screen">TOTAL          : 2     STATIC CRLSP(S)</pre>
<pre class="screen">UP             : 2     STATIC CRLSP(S)</pre>
<pre class="screen">DOWN           : 0     STATIC CRLSP(S)</pre>
<pre class="screen">Name            FEC              I/O Label  I/O If                    <span>Status</span></pre>
<pre class="screen">Tunnel10    3.3.3.3/32        NULL/20    -/GE<span>0/1/0</span>                 Up</pre>
<pre class="screen">Tunnel20    -/-               130/NULL   GE<span>0/1/0</span>/-                 Up</pre>
<p># Check the configuration on LSRB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB] <strong>display mpls static-cr-lsp</strong></pre>
<pre class="screen">TOTAL          : 2     STATIC CRLSP(S)</pre>
<pre class="screen">UP             : 2     STATIC CRLSP(S)</pre>
<pre class="screen">DOWN           : 0     STATIC CRLSP(S)</pre>
<pre class="screen">Name            FEC              I/O Label  I/O If                     <span>Status</span></pre>
<pre class="screen">Tunnel10    -/-               20/30      GE<span>0/1/0</span>/GE<span>0/2/0</span>            Up</pre>
<pre class="screen">Tunnel20    -/-               120/130    GE<span>0/2/0</span>/GE<span>0/1/0</span>            Up</pre>
<p># Check the configuration on LSRC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC] <strong>display mpls static-cr-lsp</strong></pre>
<pre class="screen">TOTAL          : 2     STATIC CRLSP(S)</pre>
<pre class="screen">UP             : 2     STATIC CRLSP(S)</pre>
<pre class="screen">DOWN           : 0     STATIC CRLSP(S)</pre>
<pre class="screen">Name            FEC                I/O Label  I/O If                    <span>Status</span></pre>
<pre class="screen">Tunnel20    1.1.1.1/32          NULL/120   -/GE<span>0/2/0</span>                 Up</pre>
<pre class="screen">Tunnel10    -/-                 30/NULL    GE<span>0/2/0</span>/-                 Up</pre>
<p>When the static CR-LSP is used to establish the MPLS TE tunnel, the packets on the transit node and the egress are forwarded directly based on the specified incoming and outgoing labels. Therefore, no FEC information is displayed on LSRB or LSRC.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172368303__section_dc_vrp_cfg_00383505"><a name="EN-US_TASK_0172368303__section_dc_vrp_cfg_00383505"></a><a name="section_dc_vrp_cfg_00383505"></a><a name="EN-US_TASK_0172368303__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>LSRA configuration file</p>
<pre class="screen">#
sysname LSRA
#
mpls lsr-id 1.1.1.1
#
mpls
 mpls te
#
static-cr-lsp ingress tunnel-interface Tunnel10 destination 3.3.3.3 nexthop 10.21.1.2 out-label 20
#
static-cr-lsp egress Tunnel20 incoming-interface GigabitEthernet<span>0/1/0</span> in-label 130
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.21.1.1 255.255.255.0
 mpls
 mpls te  
#
interface LoopBack1
 ip address 1.1.1.1 255.255.255.255
#               
interface Tunnel10
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 3.3.3.3
 mpls te signal-protocol cr-static
 mpls te tunnel-id 100
#               
return</pre>
</li><li><p>LSRB configuration file</p>
<pre class="screen">#
sysname LSRB
#
mpls lsr-id 2.2.2.2
#
mpls
 mpls te
#
static-cr-lsp transit Tunnel10 incoming-interface GigabitEthernet<span>0/1/0</span> in-label 20 nexthop 10.32.1.2 out-label 30
#
static-cr-lsp transit Tunnel20 incoming-interface GigabitEthernet<span>0/2/0</span> in-label 120 nexthop 10.21.1.1 out-label 130
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.32.1.1 255.255.255.0
 mpls
 mpls te
#               
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.21.1.2 255.255.255.0
 mpls
 mpls te
#
interface LoopBack1
 ip address 2.2.2.2 255.255.255.255
#               
return</pre>
</li><li><p>LSRC configuration file</p>
<pre class="screen">#
sysname LSRC
#
mpls lsr-id 3.3.3.3
#
mpls
 mpls te
#
static-cr-lsp ingress tunnel-interface Tunnel20 destination 1.1.1.1 nexthop 10.32.1.1 out-label 120
#
static-cr-lsp egress Tunnel10 incoming-interface GigabitEthernet<span>0/2/0</span> in-label 30
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.32.1.2 255.255.255.0
 mpls
 mpls te
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
#
interface LoopBack1
 ip address 3.3.3.3 255.255.255.255
#
interface Tunnel20
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 1.1.1.1
 mpls te signal-protocol cr-static
 mpls te tunnel-id 200
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0093.html">Configuration Examples for MPLS TE
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0168.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>