
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a Static LSP">
<meta name="abstract" content="This section provides an example for configuring a static LSP.">
<meta name="description" content="This section provides an example for configuring a static LSP.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0038.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0039.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="ldp-p2pvrp,w00800033,z00545680,w00556928,w00606909,z00809835,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MPLS LDP">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MPLS LDP">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS LDP">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS LDP">
<meta name="featuretype" content="MPLS">
<meta name="OWNER" content="z00809835">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="b00896120">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368558">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring a Static LSP</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172368558"></a><a name="EN-US_TASK_0172368558"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a Static LSP</h1>
<div class="taskbody"><p>This section provides an example for configuring a static LSP.</p>
<div class="context"><a name="EN-US_TASK_0172368558__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>All nodes support MPLS and run OSPF on the MPLS backbone network shown in <a href="#EN-US_TASK_0172368558__fig_dc_vrp_ldp-p2p_cfg_019901">Figure 1</a>. A static LSP needs to be established between LSRA and LSRC so that the LSP functions as a public network tunnel to carry L2VPN and L3VPN services.</p>
<div class="fignone" id="EN-US_TASK_0172368558__fig_dc_vrp_ldp-p2p_cfg_019901"><a name="EN-US_TASK_0172368558__fig_dc_vrp_ldp-p2p_cfg_019901"></a><a name="fig_dc_vrp_ldp-p2p_cfg_019901"></a><span class="figcap"><b>Figure 1 </b>Static LSP networking</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent GE<span>0/1/0</span> and GE<span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_ldp-p2p_cfg_019901.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368558__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure an IP address for each interface, specify a loopback interface address as an LSR ID, and configure OSPF to advertise the route to the network segment to which each interface is connected and the host route to each LSR ID.</p>
</li><li><p>Enable MPLS globally on each node.</p>
</li><li><p>Enable MPLS on each interface.</p>
</li><li><p>On the ingress, configure a destination IP address, next-hop IP address, and outgoing label for the LSP.</p>
</li><li><p>On each transit node, configure an incoming label the same as the outgoing label of the previous node, outbound interface name, next-hop IP address, and outgoing label for the LSP.</p>
</li><li><p>On the egress, configure an inbound interface name and incoming label the same as the outgoing label of the previous node for the LSP.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368558__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IP address of each interface (as shown in <a href="#EN-US_TASK_0172368558__fig_dc_vrp_ldp-p2p_cfg_019901">Figure 1</a>), OSPF process ID, and OSPF area ID</p>
</li><li><p>Name of the static LSP</p>
</li><li><p>Outgoing label value on each interface</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172368558__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface.</span><p><p>Assign an IP address and its mask to each physical interface and configure a loopback interface address as an LSR ID on each node shown in <a href="#EN-US_TASK_0172368558__section_05">Configuration Files</a>. For details, see the configuration files in this section.</p>
</p></li><li><span>Configure OSPF to advertise the route to the network segment to which each interface is connected and the host route to each LSR ID.</span><p><p># Configure LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-ospf-1]<strong> area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-ospf-1-area-0.0.0.0] <strong>network 192.168.1.9 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-ospf-1-area-0.0.0.0]<strong> network 10.1.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA] <strong>commit</strong></pre>
<p># Configure LSRB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-ospf-1]<strong> area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-ospf-1-area-0.0.0.0] <strong>network 192.168.2.9 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-ospf-1-area-0.0.0.0] <strong>network 10.1.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-ospf-1-area-0.0.0.0] <strong>network 10.2.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB] <strong>commit</strong></pre>
<p># Configure LSRC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-ospf-1]<strong> area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-ospf-1-area-0.0.0.0] <strong>network 192.168.3.9 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-ospf-1-area-0.0.0.0] <strong>network 10.2.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC] <strong>commit</strong></pre>
<p>After completing the configuration, run the <strong>display ip routing-table</strong> command on each node. The command output shows that the nodes have learned routes from each other.</p>
<p>The following example uses the command output on LSRA:</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> display ip routing-table</strong></pre>
<pre class="screen">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route
------------------------------------------------------------------------------
Routing Table : _public_
         Destinations : 11       Routes : 11        

Destination/Mask    Proto   Pre  Cost        Flags NextHop         Interface

       10.1.1.0/24  Direct  0    0             D   10.1.1.1        GigabitEthernet<span>0/1/0</span>
       10.1.1.1/32  Direct  0    0             D   127.0.0.1       GigabitEthernet<span>0/1/0</span>
    192.168.1.9/32  Direct  0    0             D   127.0.0.1       LoopBack1
     10.1.1.255/32  Direct  0    0             D   127.0.0.1       GigabitEthernet<span>0/1/0</span>
       10.2.1.0/24  OSPF    10   2             D   10.1.1.2        GigabitEthernet<span>0/1/0</span>
    192.168.2.9/32  OSPF    10   1             D   10.1.1.2        GigabitEthernet<span>0/1/0</span>
    192.168.3.9/32  OSPF    10   2             D   10.1.1.2        GigabitEthernet<span>0/1/0</span></pre>
<p>The next-hop IP address and outbound interface name of the LSRA-to-LSRC static LSP destined for 192.168.3.9/32 are determined by a routing table. In this example, the next-hop IP address is 10.1.1.2/24.</p>
</p></li><li><span>Enable MPLS globally on each node.</span><p><p># Configure LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> mpls lsr-id 192.168.1.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA]<strong> commit</strong></pre>
<p># Configure LSRB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB]<strong> mpls lsr-id 192.168.2.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB]<strong> commit</strong></pre>
<p># Configure LSRC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC]<strong> mpls lsr-id 192.168.3.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC]<strong> commit</strong></pre>
</p></li><li><span>Configure MPLS functions on each interface.</span><p><p># Configure LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA] <strong>commit</strong></pre>
<p># Configure LSRB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/2/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB] <strong>commit</strong></pre>
<p># Configure LSRC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC] <strong>commit</strong></pre>
</p></li><li><span>Create a static LSP from LSRA to LSRC.</span><p><p># Configure LSRA as the ingress.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> static-lsp ingress AtoC destination 192.168.3.9 32 nexthop 10.1.1.2 out-label 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA]<strong> commit</strong></pre>
<p># Configure LSRB as a transit node.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB]<strong> static-lsp transit AtoC in-label 20 outgoing-interface GigabitEthernet<span>0/2/0</span> nexthop 10.2.1.2 out-label 40</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB] <strong>commit</strong></pre>
<p># Configure LSRC as the egress.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC] <strong>static-lsp egress AtoC incoming-interface GigabitEthernet<span>0/1/0</span> in-label 40</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>After completing the configuration, run the <strong>display mpls static-lsp</strong> or <strong>display mpls static-lsp verbose</strong> command on each node to verify the static LSP status. The following example uses the command output on LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> display mpls static-lsp</strong></pre>
<pre class="screen">TOTAL          : 1     STATIC LSP(S)
UP             : 1     STATIC LSP(S)
DOWN           : 0     STATIC LSP(S)
Name                FEC                I/O Label        I/O If                                            Status
AtoC                192.168.3.9/32     NULL/20          -/GigabitEthernet<span>0/1/0</span>                            Up</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> display mpls static-lsp verbose</strong></pre>
<pre class="screen"> No              : 1
 LSP-Name        : AtoC
 LSR-Type        : Ingress
 FEC             : 192.168.3.9/32
 In-Label        : NULL
 Out-Label       : 20
 In-Interface    : -
 Out-Interface   : GigabitEthernet<span>0/1/0</span>
 NextHop         : 10.1.1.2
 Static-Lsp Type : Normal
 Lsp Status      : Up</pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172368558__section_05"><a name="EN-US_TASK_0172368558__section_05"></a><a name="section_05"></a><a name="EN-US_TASK_0172368558__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>LSRA configuration file</p>
<pre class="screen">#
sysname LSRA
#
mpls lsr-id 192.168.1.9
#
mpls
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.1.1.1 255.255.255.0
 mpls           
#               
interface LoopBack1
 ip address 192.168.1.9 255.255.255.255
#               
ospf 1          
 area 0.0.0.0   
  network 10.1.1.0 0.0.0.255
  network 192.168.1.9 0.0.0.0
#               
 static-lsp ingress AtoC destination 192.168.3.9 32 nexthop 10.1.1.2 out-label 20
#
return</pre>
</li><li><p>LSRB configuration file</p>
<pre class="screen">#
sysname LSRB
#
mpls lsr-id 192.168.2.9
#
mpls
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.1.1.2 255.255.255.0
 mpls           
#               
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown  
 ip address 10.2.1.1 255.255.255.0
 mpls           
#               
interface LoopBack1
 ip address 192.168.2.9 255.255.255.255
#               
ospf 1          
 area 0.0.0.0   
  network 10.1.1.0 0.0.0.255
  network 10.2.1.0 0.0.0.255
  network 192.168.2.9 0.0.0.0
# 
 static-lsp transit AtoC in-label 20 outgoing-interface GigabitEthernet<span>0/2/0</span> nexthop 10.2.1.2 out-label 40
#
return</pre>
</li><li><p>LSRC configuration file</p>
<pre class="screen">#
sysname LSRC
#
mpls lsr-id 192.168.3.9
#
mpls
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.2.1.2 255.255.255.0
 mpls           
#               
interface LoopBack1
 ip address 192.168.3.9 255.255.255.255
#               
ospf 1          
 area 0.0.0.0   
  network 10.2.1.0 0.0.0.255
  network 192.168.3.9 0.0.0.0
#
 static-lsp egress AtoC incoming-interface GigabitEthernet<span>0/1/0</span> in-label 40
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0038.html">Configuration Examples for MPLS LDP
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ldp-p2p_cfg_0039.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>