
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring the Reliability Enhancement Function for a P2MP Tunnel">
<meta name="abstract" content="Configure a function to improve service reliability as needed.">
<meta name="description" content="Configure a function to improve service reliability as needed.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0133.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0251.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0137.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="OWNER" content="l00468467">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00845984">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0270922765">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring the Reliability Enhancement Function for a P2MP Tunnel</title>
</head>
<body><a name="EN-US_TASK_0270922765"></a><a name="EN-US_TASK_0270922765"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring the Reliability Enhancement Function for a P2MP Tunnel</h1>
<div class="taskbody" id="taskbody1597807849458"><p id="shortdesc682991615214045">Configure a function to improve service reliability as needed.</p>
<div class="context"><a name="EN-US_TASK_0270922765__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p" id="EN-US_TASK_0270922765__context1078174159214045"><p id="EN-US_TASK_0270922765__p406076927214045">To improve reliability of traffic transmitted along a P2MP tunnel, configure the following reliability enhancement functions as needed:</p>
<ul id="EN-US_TASK_0270922765__ul1704144203214045"><li id="EN-US_TASK_0270922765__li299829274214045"><p id="EN-US_TASK_0270922765__p1233972256214045"><a name="EN-US_TASK_0270922765__li299829274214045"></a><a name="li299829274214045"></a>Rapid MPLS P2MP switching</p>
<p id="EN-US_TASK_0270922765__p395723037214045">With this function, if a device detects a fault in the active link, the device rapidly switches services to the standby link over which an MPLS P2MP tunnel is established, which improves service reliability.</p>
</li><li id="EN-US_TASK_0270922765__li1873426197214045"><p id="EN-US_TASK_0270922765__p268860665214045"><a name="EN-US_TASK_0270922765__li1873426197214045"></a><a name="li1873426197214045"></a>Multicast load balancing on a trunk interface</p>
<p id="EN-US_TASK_0270922765__p414036546214045">Without this function, a device randomly selects a trunk member interface to forward multicast traffic. If this member interface fails, multicast traffic is interrupted. With this function, multicast traffic along a P2MP tunnel is balanced among all trunk member interfaces. This function helps improve service reliability and increase available bandwidth for multicast traffic.</p>
</li><li id="EN-US_TASK_0270922765__li1590960459214045"><p id="EN-US_TASK_0270922765__p953545616214045"><a name="EN-US_TASK_0270922765__li1590960459214045"></a><a name="li1590960459214045"></a>MPLS P2MP load balancing</p>
<p id="EN-US_TASK_0270922765__p477284577214045">To enable P2MP load balancing globally, run the <b><span class="cmdname" id="EN-US_TASK_0270922765__en-us_cliref_0172381319_cmdname284062914214518">mpls p2mp force-loadbalance enable</span></b> command. In a multicast scenario where load balancing is configured in the Eth-Trunk interface view,
if a leaf node connected to the Eth-Trunk interface joins or quits the multicast model, packet loss occurs on the other leave nodes connected to the non-Eth-Trunk interfaces due to the model change. After the <strong id="EN-US_TASK_0270922765__en-us_cliref_0172381319_b1410102219214518">mpls p2mp force-loadbalance enable</strong> command is run, load balancing is forcibly enabled in the system view, therefore preventing packet loss.</p>
</li><li id="EN-US_TASK_0270922765__li1231424494214045"><p id="EN-US_TASK_0270922765__p1251564519214045"><a name="EN-US_TASK_0270922765__li1231424494214045"></a><a name="li1231424494214045"></a>WTR time for traffic to be switched from the <span>MPLS P2MP</span> FRR path to the primary path.</p>
<p id="EN-US_TASK_0270922765__p594514335715">If the primary <span>MPLS P2MP</span> path fails, traffic on the forwarding plane is rapidly switched to the backup path. If the primary path recovers before <span>MPLS P2MP</span> convergence is complete on the downstream node, traffic is switched back to the primary path within the default WTR time. If only some entries are generated for the primary path within the period, some packets are dropped when traffic switches back to the primary path. To ensure that all entries are generated for the primary path during the switchback and prevent packet loss, you can flexibly set the WTR time for traffic to be switched from the <span>MPLS P2MP</span> FRR path to the primary path.</p>
</li></ul>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0270922765__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul id="EN-US_TASK_0270922765__steps-unordered495468233214045"><li id="EN-US_TASK_0270922765__step996481652214045"><span id="EN-US_TASK_0270922765__cmd921975524214045">Configure rapid MPLS P2MP switching.</span><p><ol id="EN-US_TASK_0270922765__ol1530707627214045"><li id="EN-US_TASK_0270922765__li1179945058214045">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname13152131114241">system-view</span></b></a><p id="EN-US_TASK_0270922765__p086615118246">The system view is displayed.</p>
</li><li id="EN-US_TASK_0270922765__li1742750353214045">Run <a href="cmdqueryname=mpls+p2mp+fast-switch+enable"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname718314223246">mpls p2mp fast-switch enable</span></b></a><p id="EN-US_TASK_0270922765__p922482313242">Rapid MPLS P2MP switching is enabled.</p>
</li><li id="EN-US_TASK_0270922765__li570956263214045">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname933053082414">commit</span></b></a><p id="EN-US_TASK_0270922765__p238913318247">The configuration is committed.</p>
</li></ol>
</p></li><li id="EN-US_TASK_0270922765__step1909548150214045"><span id="EN-US_TASK_0270922765__cmd1780136282214045">Configure multicast load balancing on a trunk interface.</span><p><ol id="EN-US_TASK_0270922765__ol1247727776214045"><li id="EN-US_TASK_0270922765__li1846475127214045">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname993417225270">system-view</span></b></a><p id="EN-US_TASK_0270922765__p2060042310277">The system view is displayed.</p>
</li><li id="EN-US_TASK_0270922765__li822437467214045">Run <a href="cmdqueryname=interface+eth-trunk"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname1631513290271">interface eth-trunk</span></b></a> <i><span class="varname" id="EN-US_TASK_0270922765__varname1531512290275">trunk-id</span></i><span id="EN-US_TASK_0270922765__ph1331592915274"> or <a href="cmdqueryname=interface+ip-trunk"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname1631516292270">interface ip-trunk</span></b></a> <i><span class="varname" id="EN-US_TASK_0270922765__varname18315829202713">trunk-id</span></i></span><p id="EN-US_TASK_0270922765__p14460163016270">The Eth-Trunk interface view is displayed.</p>
</li><li id="EN-US_TASK_0270922765__li592665506214045">Run <a href="cmdqueryname=multicast+p2mp+load-balance+enable"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname1649246871214045">multicast p2mp load-balance enable</span></b></a><p id="EN-US_TASK_0270922765__p1666915507210">Multicast traffic load balancing among trunk member interfaces is enabled on the trunk interface that functions as an outbound interface of a P2MP tunnel.</p>
</li><li id="EN-US_TASK_0270922765__li2058332900214045"><p id="EN-US_TASK_0270922765__p155821513544"><a name="EN-US_TASK_0270922765__li2058332900214045"></a><a name="li2058332900214045"></a>Run <a href="cmdqueryname=multicast+p2mp+root+load-balance+enable"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname1258219135411">multicast p2mp root load-balance enable</span></b></a></p>
<p id="EN-US_TASK_0270922765__p1034916365419">Multicast traffic load balancing among trunk member interfaces is enabled on the trunk interface that resides on the P2MP tunnel's root node<span> or ABR (ASBR) in the segmented NG MVPN scenario</span>.</p>
</li><li id="EN-US_TASK_0270922765__li2115810120214045"><p id="EN-US_TASK_0270922765__p1030251715415"><a name="EN-US_TASK_0270922765__li2115810120214045"></a><a name="li2115810120214045"></a>(Optional) Run <a href="cmdqueryname=multicast+p2mp+root+load-balance+spmsi+disable"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname93021717165420">multicast p2mp root load-balance spmsi disable</span></b></a></p>
<p id="EN-US_TASK_0270922765__p6758025135417">Multicast traffic load balancing among trunk member interfaces is disabled on the root node of an S-PMSI tunnel.</p>
</li><li id="EN-US_TASK_0270922765__li644114526214045">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname52512050132713">commit</span></b></a><p id="EN-US_TASK_0270922765__p083745014272">The configuration is committed.</p>
</li></ol>
</p></li><li id="EN-US_TASK_0270922765__step695272453214045"><span id="EN-US_TASK_0270922765__cmd985594244214045">Configure MPLS P2MP load balancing.</span><p><ol id="EN-US_TASK_0270922765__ol72138842214045"><li id="EN-US_TASK_0270922765__li1537360657214045">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname42477550276">system-view</span></b></a><p id="EN-US_TASK_0270922765__p681725522715">The system view is displayed.</p>
</li><li id="EN-US_TASK_0270922765__li1180124718214045">Run <a href="cmdqueryname=mpls+p2mp+force-loadbalance+enable"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname151326022813">mpls p2mp force-loadbalance enable</span></b></a><p id="EN-US_TASK_0270922765__p967617042817">MPLS P2MP load balancing is enabled globally.</p>
</li><li id="EN-US_TASK_0270922765__li40688540214045">(Optional) Run <a href="cmdqueryname=multicast+p2mp+load-balance+number"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname1496111662819">multicast p2mp load-balance number</span></b></a> <i><span class="varname" id="EN-US_TASK_0270922765__varname199611768286">load-balance_number</span></i><p id="EN-US_TASK_0270922765__p66096719285">The number of trunk member interfaces that balance multicast traffic on a P2MP tunnel is set.</p>
</li><li id="EN-US_TASK_0270922765__li1881141055214045">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname176681514102813">commit</span></b></a><p id="EN-US_TASK_0270922765__p1722211154285">The configuration is committed.</p>
</li></ol>
</p></li><li id="EN-US_TASK_0270922765__step1485942307214045"><span id="EN-US_TASK_0270922765__cmd1145022786214045">Set the WTR time for traffic to be switched from the <span>MPLS P2MP</span> FRR path to the primary path.</span><p><ol id="EN-US_TASK_0270922765__ol1834499591214045"><li id="EN-US_TASK_0270922765__li1180435513214045">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname37441519162814">system-view</span></b></a><p id="EN-US_TASK_0270922765__p202499207288">The system view is displayed.</p>
</li><li id="EN-US_TASK_0270922765__li943307783214045">Run <a href="cmdqueryname=mpls+p2mp+frr-wtr"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname18662525162812">mpls p2mp frr-wtr</span></b></a> <i><span class="varname" id="EN-US_TASK_0270922765__varname156621325112820">time-value</span></i><p id="EN-US_TASK_0270922765__p310917263284">The WTR time is set for traffic to be switched from the <span>MPLS P2MP</span> FRR path to the primary path.</p>
</li><li id="EN-US_TASK_0270922765__li1266162567214045">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0270922765__cmdname33993022811">commit</span></b></a><p id="EN-US_TASK_0270922765__p137920303287">The configuration is committed.</p>
</li></ol>
</p></li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0133.html">Configuring P2MP TE Tunnels
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0251.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0137.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>