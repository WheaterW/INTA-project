
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring CBTS in an L3VPN over LDP over TE Scenario">
<meta name="abstract" content="This section provides an example for configuring a CBTS in an L3VPN over LDP over TE scenario.">
<meta name="description" content="This section provides an example for configuring a CBTS in an L3VPN over LDP over TE scenario.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0093.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_te-p2p_cfg_6002.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_te-p2p_cfg_6005.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,te-p2pvrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS TE">
<meta name="featuretype" content="MPLS">
<meta name="OWNER" content="l00468467">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00845984">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368381">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring CBTS in an L3VPN over LDP over TE Scenario</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172368381"></a><a name="EN-US_TASK_0172368381"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring CBTS in an L3VPN over LDP over TE Scenario</h1>
<div class="taskbody"><p>This section provides an example for configuring a CBTS in an L3VPN over LDP over TE scenario.</p>
<div class="context"><a name="EN-US_TASK_0172368381__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0172368381__fig_dc_ne_te-p2p_cfg_600301">Figure 1</a>, CE1 and CE2 belong to the same L3VPN. They access the public network through PE1 and PE2 respectively. Various types of services are transmitted between CE1 and CE2. Transmitting a large number of common services deteriorates the efficiency of transmitting important services. To prevent this problem, the CBTS function can be configured. A CBTS allows traffic of a specific service class to be transmitted along a specified tunnel.</p>
<p>In this example, tunnel 1 transmits important services, and tunnel 2 transmits other packets.</p>
<div class="fignone" id="EN-US_TASK_0172368381__fig_dc_ne_te-p2p_cfg_600301"><a name="EN-US_TASK_0172368381__fig_dc_ne_te-p2p_cfg_600301"></a><a name="fig_dc_ne_te-p2p_cfg_600301"></a><span class="figcap"><b>Figure 1 </b>CBTS in an L3VPN over LDP over TE scenario</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent GE <span>0/1/0</span> and GE <span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_ne_te-p2p_cfg_600301.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368381__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>When configuring a TE tunnel group in an L3VPN over LDP over TE scenario, note that the destination IP address of a tunnel must be equal to the LSR ID of the egress.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Before configuring IGP shortcut in an LDP over TE scenario, you need to set up a remote LDP session. If no remote LDP session is established, traffic is steered to a TE tunnel, and traffic forwarding is interrupted.</p>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368381__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure the IP address of a loopback interface as the LSR ID on each LSR and configure an IGP to advertise routes.</p>
</li><li><p>Configure OSPF TE on each TE-aware area, create an MPLS TE tunnel, and specify the service class for packets that can be transmitted on the tunnel.</p>
</li><li><p>Enable MPLS LDP in each non-TE-aware area and configure a remote LDP peer at the edge of the TE-aware area.</p>
</li><li><p>Configure the forwarding adjacency.</p>
</li><li><p>Configure multi-field traffic classification on nodes that connected to the L3VPN and configure behavior aggregate classification on LDP over TE links.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368381__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>OSPF process ID and OSPF area ID</p>
</li><li><p>Policy for triggering the LSP establishment</p>
</li><li><p>Name and IP address of each remote LDP peer of P1 and P2</p>
</li><li><p>Link bandwidth attributes of the tunnel</p>
</li><li><p>Tunnel interface number, IP address, destination address, tunnel ID, tunnel signaling protocol (RSVP-TE is used by default and in this example), tunnel bandwidth, TE metric value, and link cost on P1 and P2</p>
</li><li><p>Multi-field classifier name and traffic policy name</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172368381__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface.</span><p><p>Assign an IP address to each interface, including the loopback interface according to <a href="#EN-US_TASK_0172368381__fig_dc_ne_te-p2p_cfg_600301">Figure 1</a>. For configuration details, see <a href="#EN-US_TASK_0172368381__example806207475214046">Configuration Files</a> in this section.</p>
</p></li><li><span>Enable OSPF to advertise the route of the segment connected to each interface and the host route destined for each LSR ID. For configuration details, see <a href="#EN-US_TASK_0172368381__example806207475214046">Configuration Files</a> in this section.</span></li><li><span>Configure an EBGP peer relationship between each pair of a PE and a CE and an MP-IBGP peer relationship between two PEs.</span><p><p>For configuration details, see <a href="#EN-US_TASK_0172368381__example806207475214046">Configuration Files</a> in this section.</p>
</p></li><li><span>Enable MPLS on each LSR. Enable LDP to establish an LDP session between PE1 and P1, and between P2 and PE2. Enable RSVP-TE to establish an RSVP neighbor relationship between P1 and P2, and between P1 and P3.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> mpls lsr-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls]<strong> lsp-trigger all</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<p># Configure P1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1] <strong>mpls lsr-id 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-mpls] <strong>lsp-trigger all</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-mpls] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-mpls]<strong> mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-mpls-ldp]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/1/0</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/2/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/2/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/2/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<p># Configure P3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P3] <strong>mpls lsr-id 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3-mpls] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3]<strong> interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3-GigabitEthernet<span>0/2/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3-GigabitEthernet<span>0/2/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3-GigabitEthernet<span>0/2/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P3-GigabitEthernet<span>0/2/0</span>]<strong> quit</strong></pre>
<p># Configure P2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P2]<strong> mpls lsr-id 4.4.4.4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-mpls] <strong>lsp-trigger all</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-mpls] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-mpls]<strong> mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-mpls-ldp]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/2/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/2/0</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P2-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>mpls lsr-id 5.5.5.5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls] <strong>lsp-trigger all</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<p>After completing the preceding configurations, the local LDP sessions have been successfully established between PE1 and P1 and between P2 and PE2.</p>
<p># Run the <strong>display mpls ldp session</strong> command on PE1, P1, P2, or PE2 to view information about the established LDP session.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display mpls ldp session</strong></pre>
<pre class="screen"> LDP Session(s) in Public Network
 Codes: LAM(Label Advertisement Mode), SsnAge Unit(DDDD:HH:MM)
 An asterisk (*) before a session means the session is being deleted.
--------------------------------------------------------------------------
 PeerID             Status      LAM  SsnRole  SsnAge       KASent/Rcv
--------------------------------------------------------------------------
 2.2.2.2:0          Operational DU   Passive  0000:00:05   23/23
--------------------------------------------------------------------------
TOTAL: 1 Session(s) Found.</pre>
<p># Run the <strong>display mpls ldp peer</strong> command to view information about the established LDP peer.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display mpls ldp peer</strong></pre>
<pre class="screen"> LDP Peer Information in Public network
 An asterisk (*) before a peer means the peer is being deleted.
 -------------------------------------------------------------------------
 PeerID                 TransportAddress   DiscoverySource
 -------------------------------------------------------------------------
 2.2.2.2:0              2.2.2.2            GigabitEthernet<span>0/1/0</span>       
 -------------------------------------------------------------------------
TOTAL: 1 Peer(s) Found.</pre>
<p># Run the <strong>display mpls lsp</strong> command to view information about LDP LSP information. The command output shows that no LSP is established by RSVP. The following example uses the command output on PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display mpls lsp</strong></pre>
<pre class="screen">----------------------------------------------------------------------</pre>
<pre class="screen">                 LSP Information: LDP LSP</pre>
<pre class="screen">----------------------------------------------------------------------</pre>
<pre class="screen">FEC                In/Out Label  In/Out IF                      Vrf Name</pre>
<pre class="screen">1.1.1.1/32         3/NULL        GE<span>0/1/0</span>/-</pre>
<pre class="screen">2.2.2.2/32         NULL/3        -/GE<span>0/1/0</span></pre>
<pre class="screen">2.2.2.2/32         1024/3        -/GE<span>0/1/0</span></pre>
<pre class="screen">10.1.1.0/24        3/NUL         GE<span>0/1/0</span>/-</pre>
<pre class="screen">10.2.1.0/24        NULL/3        -/GE<span>0/1/0</span></pre>
<pre class="screen">10.2.1.0/24        1025/3        -/GE<span>0/1/0</span></pre>
</p></li><li><span>Configure a remote LDP session between P1 and P2.</span><p><p># Configure P1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1] <strong>mpls ldp remote-peer lsrd</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-mpls-ldp-remote-lsrd] <strong>remote-ip 4.4.4.4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-mpls-ldp-remote-lsrd] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1-mpls-ldp-remote-lsrd] <strong>quit</strong></pre>
<p># Configure P2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P2] <strong>mpls ldp remote-peer lsrb</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-mpls-ldp-remote-lsrb] <strong>remote-ip 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-mpls-ldp-remote-lsrb] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P2-mpls-ldp-remote-lsrb] <strong>quit</strong></pre>
<p>After completing the preceding configurations, a remote LDP session is set up between P1 and P2. Run the <strong>display mpls ldp remote-peer</strong> command on P1 or P2 to view information about the remote session entity. The following example uses the command output on P1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1] <strong>display mpls ldp remote-peer lsrd</strong></pre>
<pre class="screen">                         LDP Remote Entity Information
 ------------------------------------------------------------------------------
 Remote Peer Name  : P2
 Description       : ----
 Remote Peer IP    : 4.4.4.4              LDP ID        : 2.2.2.2:0
 Transport Address : 2.2.2.2              Entity Status : Active

 Configured Keepalive Hold Timer : 45 Sec
 Configured Keepalive Send Timer : ----
 Configured Hello Hold Timer     : 45 Sec
 Negotiated Hello Hold Timer     : 45 Sec
 Configured Hello Send Timer     : ----
 Configured Delay Timer          : ----
 Hello Packet sent/received      : 425/382
 Label Advertisement Mode        : Downstream Unsolicited
 Auto-config                     : Auto Accept
 Manual-config                   : effective
 Session-Protect effect          : NO
 Session-Protect Duration        : ----
 Session-Protect Remain          : ----
 ------------------------------------------------------------------------------
 TOTAL: 1 Remote-Peer(s) Found.</pre>
</p></li><li><span>Configure bandwidth attributes on each outbound interface along the link of the TE tunnel.</span><p><p># Configure P1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1]<strong> interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1-GigabitEthernet<span>0/2/0</span>] <strong>mpls te bandwidth max-reservable-bandwidth 20000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/2/0</span>] <strong>mpls te bandwidth bc0 20000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<p># Configure P3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P3]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P3-GigabitEthernet<span>0/1/0</span>]<strong> mpls te bandwidth max-reservable-bandwidth 20000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3-GigabitEthernet<span>0/1/0</span>]<strong> mpls te bandwidth bc0 20000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3]<strong> interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3-GigabitEthernet<span>0/2/0</span>]<strong> mpls te bandwidth max-reservable-bandwidth 20000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3-GigabitEthernet<span>0/2/0</span>]<strong> mpls te bandwidth bc0 20000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P3-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P3-GigabitEthernet<span>0/2/0</span>]<strong> quit</strong></pre>
<p># Configure P2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P2]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P2-GigabitEthernet<span>0/1/0</span>]<strong> mpls te bandwidth max-reservable-bandwidth 20000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/1/0</span>]<strong> mpls te bandwidth bc0 20000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P2-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
</p></li><li><span>Configure L3VPN access on PE1 and PE2 and configure multi-field classification on the inbound interface of PE1.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> ip vpn-instance VPNA</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA]<strong> ipv4-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv4] <strong>route-distinguisher 100:1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vpn-instance-VPNA-af-ipv4] <strong>vpn-target 111:1 both</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/0</span>]<strong> ip binding vpn-instance VPNA</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>acl 2001</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-acl4-basic-2001] <strong>rule 10 permit source 10.40.0.0 0.255.255.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-acl4-basic-2001] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>acl 2002</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-acl4-basic-2002] <strong>rule 20 permit source 10.50.0.0 0.255.255.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-acl4-basic-2002] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>traffic classifier service1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-classifier-service1] <strong>if-match acl 2001</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-classifier-service1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>traffic behavior behavior1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-behavior-behavior1] <strong>service-class af1 color green</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-behavior-behavior1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>traffic classifier service2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-classifier-service2] <strong>if-match acl 2002</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-classifier-service2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>traffic behavior behavior2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-behavior-behavior2] <strong>service-class af2 color green</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-behavior-behavior2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>traffic policy test</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-trafficpolicy-test] <strong>classifier service1 behavior behavior1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-trafficpolicy-test] <strong>classifier service2 behavior behavior2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-trafficpolicy-test] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong>traffic-policy test inbound</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> ip vpn-instance VPNB</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-VPNB]<strong> ipv4-family</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-VPNB-af-ipv4] <strong>route-distinguisher 200:1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vpn-instance-VPNB-af-ipv4] <strong>vpn-target 111:1 both</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>]<strong> ip binding vpn-instance VPNB</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/0</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
</p></li><li><span>Configure behavior aggregate classification on interfaces connecting PE1 to P1.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/0</span>]<strong> trust upstream default</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<p># Configure P1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1]<strong> interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1-GigabitEthernet<span>0/1/0</span>]<strong> trust upstream default</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
</p></li><li><span>Configure a TE tunnel that originates from P1 and is destined for P2 and set the service class for each type of packets that can pass through the tunnel.</span><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Run the <a href="cmdqueryname=mpls+te+service-class"><b><span class="cmdname">mpls te service-class</span></b></a> { <i><span class="varname">service-class</span></i> &amp; &lt;1-8&gt; | <strong><span>default</span></strong> } command to configure the service class for packets transmitted along each tunnel.</p>
</div></div>
<p># On P1, enable the IGP shortcut function on the tunnel interface and adjust the metric value to ensure that traffic destined for P2 or PE2 passes through the tunnel.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1]<strong> interface tunnel1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel1] <strong>ip address unnumbered interface LoopBack1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel1] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel1] <strong>destination 4.4.4.4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel1] <strong>mpls te tunnel-id 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel1] <strong>mpls te bandwidth ct0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel1] <strong>mpls te igp shortcut</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel1] <strong>mpls te igp metric absolute 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel1] <strong>mpls te service-class af1 af2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1]<strong> interface tunnel2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel2] <strong>ip address unnumbered interface LoopBack1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel2] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel2] <strong>destination 4.4.4.4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel2] <strong>mpls te tunnel-id 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel2] <strong>mpls te bandwidth ct0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel2] <strong>mpls te igp shortcut</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel2] <strong>mpls te igp metric absolute 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel2] <strong>mpls te service-class default</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-Tunnel2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-ospf-1-area-0.0.0.0] <strong>network 2.2.2.2 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-ospf-1] <strong>enable traffic-adjustment advertise</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P1-ospf-1] <strong>commit</strong></pre>
</p></li><li><span>Configure a tunnel that originates from P2 and is destined for P1.</span><p><p># On P2, enable the forwarding adjacency on the tunnel interface and adjust the metric value of the forwarding adjacency to ensure that traffic destined for PE1 or P1 passes through the tunnel.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P2] <strong>interface tunnel1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-Tunnel1] <strong>ip address unnumbered interface LoopBack1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-Tunnel1] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-Tunnel1] <strong>destination 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-Tunnel1] <strong>mpls te tunnel-id 101</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-Tunnel1] <strong>mpls te bandwidth ct0 10000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-Tunnel1] <strong>mpls te igp shortcut</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-Tunnel1] <strong>mpls te igp metric absolute 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-Tunnel1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-ospf-1] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-ospf-1-area-0.0.0.0] <strong>network 4.4.4.4 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-ospf-1] <strong>enable traffic-adjustment advertise</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P2] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172368381__example806207475214046"><a name="EN-US_TASK_0172368381__example806207475214046"></a><a name="example806207475214046"></a><a name="EN-US_TASK_0172368381__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#
sysname PE1
#
ip vpn-instance VPNA
 ipv4-family 
  route-distinguisher 100:1
  apply-label per-instance
  vpn-target 111:1 export-extcommunity
  vpn-target 111:1 import-extcommunity
#
mpls lsr-id 1.1.1.1
#
mpls
 lsp-trigger all
#
mpls ldp
#
acl number 2001
 rule 10 permit source 10.40.0.0 0.255.255.255
#
acl number 2002
 rule 20 permit source 10.50.0.0 0.255.255.255
#
traffic classifier service1 
 if-match acl 2001
#
traffic classifier service2 
 if-match acl 2002
#
traffic behavior behavior1
 service-class af1 color green
#
traffic behavior behavior2
 service-class af2 color green
#
traffic policy test
 share-mode
 classifier service1 behavior behavior1 
 classifier service2 behavior behavior2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown 
 ip address 10.1.1.1 255.255.255.0
 mpls
 mpls ldp
 trust upstream default
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown 
 ip binding vpn-instance VPNA
 ip address 10.10.1.1 255.255.255.0
 traffic-policy test inbound
#
interface LoopBack1
 ip address 1.1.1.1 255.255.255.255
#
bgp 100
 peer 5.5.5.5 as-number 100
 peer 5.5.5.5 connect-interface LoopBack1
 #
 ipv4-family unicast
  undo synchronization 
  peer 5.5.5.5 enable
 #
 ipv4-family vpnv4 
  policy vpn-target 
  peer 5.5.5.5 enable
 #
 ipv4-family vpn-instance VPNA
  peer 10.10.1.2 as-number 65410
#
ospf 1
 area 0.0.0.0
  network 1.1.1.1 0.0.0.0
  network 10.1.1.0 0.0.0.255
#
return</pre>
</li><li><p>P1 configuration file</p>
<pre class="screen">#
sysname P1
#
mpls lsr-id 2.2.2.2
#
mpls
 mpls te
 mpls rsvp-te
 mpls te cspf
 lsp-trigger all
#
mpls ldp
 #
 ipv4-family
#
mpls ldp remote-peer lsrd
 remote-ip 4.4.4.4
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown 
 ip address 10.1.1.2 255.255.255.0
 mpls
 mpls ldp
 trust upstream default
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown 
 ip address 10.2.1.1 255.255.255.0
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 20000
 mpls te bandwidth bc0 20000
 mpls rsvp-te
#
interface LoopBack1
 ip address 2.2.2.2 255.255.255.255
#
interface Tunnel1
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 4.4.4.4
 mpls te tunnel-id 100
 mpls te bandwidth ct0 10000
 mpls te igp shortcut
 mpls te igp metric absolute 1
 mpls te service-class af1 af2
#
interface Tunnel2
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 4.4.4.4
 mpls te tunnel-id 200
 mpls te bandwidth ct0 10000
 mpls te igp shortcut
 mpls te igp metric absolute 1
 mpls te service-class default
#
ospf 1
 opaque-capability enable
 enable traffic-adjustment advertise
 area 0.0.0.0
  network 2.2.2.2 0.0.0.0
  network 10.1.1.0 0.0.0.255
  network 10.2.1.0 0.0.0.255
  mpls-te enable
#
return</pre>
</li><li><p>P3 configuration file</p>
<pre class="screen">#
sysname P3
#
mpls lsr-id 3.3.3.3
#
mpls
 mpls te
 mpls rsvp-te
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown 
 ip address 10.2.1.2 255.255.255.0
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 20000
 mpls te bandwidth bc0 20000
 mpls rsvp-te
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown 
 ip address 10.3.1.1 255.255.255.0
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 20000
 mpls te bandwidth bc0 20000
 mpls rsvp-te
#
interface LoopBack1
 ip address 3.3.3.3 255.255.255.255
#
ospf 1
 opaque-capability enable
 area 0.0.0.0
  network 3.3.3.3 0.0.0.0
  network 10.2.1.0 0.0.0.255
  network 10.3.1.0 0.0.0.255
  mpls-te enable
#
return</pre>
</li><li><p>P2 configuration file</p>
<pre class="screen">#
sysname P2
#
mpls lsr-id 4.4.4.4
#
mpls
 mpls te
 mpls rsvp-te
 mpls te cspf
 lsp-trigger all
#
mpls ldp
 #
 ipv4-family
#
mpls ldp remote-peer lsrb
 remote-ip 2.2.2.2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown 
 ip address 10.3.1.2 255.255.255.0
 mpls
 mpls te
 mpls te bandwidth max-reservable-bandwidth 20000
 mpls te bandwidth bc0 20000
 mpls rsvp-te
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown 
 ip address 10.4.1.2 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 4.4.4.4 255.255.255.255
#
interface Tunnel1
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 2.2.2.2
 mpls te tunnel-id 101
 mpls te bandwidth ct0 10000
 mpls te igp shortcut
 mpls te igp metric absolute 1
#
ospf 1
 opaque-capability enable
 enable traffic-adjustment advertise
 area 0.0.0.0
  network 4.4.4.4 0.0.0.0
  network 10.3.1.0 0.0.0.255
  network 10.4.1.0 0.0.0.255
  mpls-te enable
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2
#
ip vpn-instance VPNB
 ipv4-family 
  route-distinguisher 200:1
  apply-label per-instance
  vpn-target 111:1 export-extcommunity
  vpn-target 111:1 import-extcommunity
#
mpls lsr-id 5.5.5.5
#
mpls
 lsp-trigger all
#
mpls ldp
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown 
 ip address 10.4.1.1 255.255.255.0
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown 
 ip binding vpn-instance VPNB
 ip address 10.11.1.1 255.255.255.0
#
interface LoopBack1
 ip address 5.5.5.5 255.255.255.255
#
bgp 100
 peer 1.1.1.1 as-number 100
 peer 1.1.1.1 connect-interface LoopBack1
 #
 ipv4-family unicast 
  undo synchronization
  peer 1.1.1.1 enable
 #
 ipv4-family vpnv4
  policy vpn-target
  peer 1.1.1.1 enable
 #
 ipv4-family vpn-instance VPNB
  peer 10.11.1.2 as-number 65420
#
ospf 1
 area 0.0.0.0
  network 5.5.5.5 0.0.0.0
  network 10.4.1.0 0.0.0.255
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_te-p2p_cfg_0093.html">Configuration Examples for MPLS TE
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_te-p2p_cfg_6002.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_te-p2p_cfg_6005.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>