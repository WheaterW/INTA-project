
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a Traffic Classifier">
<meta name="abstract" content="You need to configure a traffic classifier before configuring class-based QoS. The traffic classifier can be configured based on the ACL rule, IP precedence, MAC address, protocol address, and so on.">
<meta name="description" content="You need to configure a traffic classifier before configuring class-based QoS. The traffic classifier can be configured based on the ACL rule, IP precedence, MAC address, protocol address, and so on.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0040.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0043.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909,m00390128">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Class-based QoS">
<meta name="featuretype" content="QOS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Class-based QoS">
<meta name="featuretype" content="QOS">
<meta name="featurename" content="Class-based QoS">
<meta name="featuretype" content="QOS">
<meta name="featurename" content="Class-based QoS">
<meta name="featuretype" content="QOS">
<meta name="OWNER" content="m00390128">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="m00915594">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172371247">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring a Traffic Classifier</title>
</head>
<body><a name="EN-US_TASK_0172371247"></a><a name="EN-US_TASK_0172371247"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a Traffic Classifier</h1>
<div class="taskbody" id="taskbody1624839433214057"><p id="shortdesc2010313843214057">You need to configure a traffic classifier before configuring class-based QoS. The traffic classifier can be configured based on the ACL rule, IP precedence, MAC address, protocol address, and so on.</p>
<div class="steps-unordered"><a name="EN-US_TASK_0172371247__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ul id="EN-US_TASK_0172371247__steps-unordered224661922214057"><li id="EN-US_TASK_0172371247__step643971374214057"><span id="EN-US_TASK_0172371247__cmd2056785585214057">Define a traffic classifier based on Layer 3 or Layer 4 information</span><ol id="EN-US_TASK_0172371247__substeps1374443007214057"><li class="substepexpand" id="EN-US_TASK_0172371247__substep149512872214057"><span id="EN-US_TASK_0172371247__cmd462366047214352">Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname1965975916214352">system-view</span></b></a></span></span><p><p id="EN-US_TASK_0172371247__p497623617214352">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172371247__substep1465368943214057"><span id="EN-US_TASK_0172371247__cmd1113361205214057">Run <span><a href="cmdqueryname=traffic+classifier"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname1850473321214352">traffic classifier</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371247__varname1991830050214352">classifier-name</span></i> [ <strong><span id="EN-US_TASK_0172371247__cmdparmname1477466908214352">operator</span></strong> { <strong><span id="EN-US_TASK_0172371247__cmdparmname111324511214352">and</span></strong> | <strong><span id="EN-US_TASK_0172371247__cmdparmname5067032214352">or</span></strong> } ]</span></span><p><p id="EN-US_TASK_0172371247__p17931191413513">A traffic classifier is defined and its view is displayed.</p>
</p><p><p id="EN-US_TASK_0172371247__p161301965214057">If you define multiple matching rules in a traffic classifier, you can set the logical relationship between the matching rules by specifying the <strong id="EN-US_TASK_0172371247__b481905417017">operator</strong> parameter.</p>
<ul id="EN-US_TASK_0172371247__ul1501620244214057"><li id="EN-US_TASK_0172371247__li1131211921214057"><strong><span id="EN-US_TASK_0172371247__cmdparmname580314255915">and</span></strong>: A packet belongs to the classifier only when it matches all the rules.</li><li id="EN-US_TASK_0172371247__li169399980214057"><strong><span id="EN-US_TASK_0172371247__cmdparmname1953491214593">or</span></strong>: A packet belongs to the classifier if it matches any one of the rules.</li></ul>
</p></li><li class="substepexpand" id="EN-US_TASK_0172371247__substep1881963378214057"><span id="EN-US_TASK_0172371247__cmd2019341030214057">Define matching rules for the traffic classifier as required.</span><p><div class="note" id="EN-US_TASK_0172371247__note893017308214057"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172371247__p178686673214057">For IPv6 packets, you need to specify the keyword <strong><span id="EN-US_TASK_0172371247__cmdparmname1259057166214352">ipv6</span></strong> when defining a matching rule in Step 3. A matching rule defined to match packets based on the source or destination addresses applies to IPv6 packets, but not IPv4 packets.</p>
<p id="EN-US_TASK_0172371247__p293306855214057">You can define different ACL rules as required, including the protocol type, source address, destination address, and ToS in packets. The <a href="cmdqueryname=if-match+acl"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname357703237214352">if-match acl</span></b></a> command filters packets according to the ACL rules defined in the <strong><span id="EN-US_TASK_0172371247__cmdparmname1382101858214352">rule</span></strong> command. The system then performs the corresponding traffic behavior for the matching packets.</p>
</div></div>
<ul id="EN-US_TASK_0172371247__ul1735024977214057"><li id="EN-US_TASK_0172371247__li1820481764214057"><p id="EN-US_TASK_0172371247__p1637488739214057"><a name="EN-US_TASK_0172371247__li1820481764214057"></a><a name="li1820481764214057"></a>To define a matching rule based on an ACL, run the <a href="cmdqueryname=if-match"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname1798308049214057">if-match</span></b></a><span> [ <strong><span id="EN-US_TASK_0172371247__cmdparmname1960331961214057">ipv6</span></strong> ]</span> <strong><span id="EN-US_TASK_0172371247__cmdparmname1130444074214057">acl</span></strong> { <i><span class="varname" id="EN-US_TASK_0172371247__varname1628299376214057">acl-number</span></i> | <strong><span id="EN-US_TASK_0172371247__cmdparmname1358179370214057">name</span></strong> <i><span class="varname" id="EN-US_TASK_0172371247__varname1003942690214057">acl-name</span></i> } <span>[ <span><strong><span id="EN-US_TASK_0172371247__cmdparmname1095611490548">precedence</span></strong> <i><span class="varname" id="EN-US_TASK_0172371247__varname1547878185510">precedence-value</span></i></span> ]</span> command.</p>
</li><li id="EN-US_TASK_0172371247__li1605302417214057"><p id="EN-US_TASK_0172371247__p1480665258214057"><a name="EN-US_TASK_0172371247__li1605302417214057"></a><a name="li1605302417214057"></a>To define a matching rule to classify traffic based on the DSCP value, run the <a href="cmdqueryname=if-match"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname941258487214352">if-match</span></b></a><span> [ <strong><span id="EN-US_TASK_0172371247__cmdparmname508129583214352">ipv6</span></strong> ]</span> <strong><span id="EN-US_TASK_0172371247__cmdparmname595190714214352">dscp</span></strong> <i><span class="varname" id="EN-US_TASK_0172371247__varname471290785214352">dscp-value</span></i> command.</p>
</li><li id="EN-US_TASK_0172371247__li1387926751214057"><p id="EN-US_TASK_0172371247__p917530343214057"><a name="EN-US_TASK_0172371247__li1387926751214057"></a><a name="li1387926751214057"></a>To define a matching rule to classify traffic based on the IPv4 TCP flag value, run the <a href="cmdqueryname=if-match+tcp+syn-flag"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname227094022214352">if-match tcp syn-flag</span></b></a> { <i><span class="varname" id="EN-US_TASK_0172371247__varname1421367809214352">tcpflag-value</span></i> [ <strong><span id="EN-US_TASK_0172371247__cmdparmname595053650214352">mask</span></strong> <i><span class="varname" id="EN-US_TASK_0172371247__varname2000553962214352">tcpflag-mask</span></i> ] | <strong><span id="EN-US_TASK_0172371247__cmdparmname54890239214352">bit-match</span></strong> { <strong><span id="EN-US_TASK_0172371247__cmdparmname1556834115214352">established</span></strong> | <strong><span id="EN-US_TASK_0172371247__cmdparmname147734874214352">fin</span></strong> | <strong><span id="EN-US_TASK_0172371247__cmdparmname146485523214352">syn</span></strong> | <strong><span id="EN-US_TASK_0172371247__cmdparmname1725122899214352">rst</span></strong> | <strong><span id="EN-US_TASK_0172371247__cmdparmname1986260806214352">psh</span></strong> | <strong><span id="EN-US_TASK_0172371247__cmdparmname603435146214352">ack</span></strong> | <strong><span id="EN-US_TASK_0172371247__cmdparmname1969536529214352">urg</span></strong> | <strong><span id="EN-US_TASK_0172371247__cmdparmname1223920516214352">ece</span></strong> | <strong><span id="EN-US_TASK_0172371247__cmdparmname1789479483214352">cwr</span></strong> | <strong><span id="EN-US_TASK_0172371247__cmdparmname673486272214352">ns</span></strong> } } command.</p>
</li><li id="EN-US_TASK_0172371247__li356142671014">To define a matching rule to classify traffic based on the IPv6 TCP flag value, run the <a href="cmdqueryname=if-match+ipv6+tcp+syn-flag"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname12821227141011">if-match ipv6 tcp syn-flag</span></b></a> { <i><span class="varname" id="EN-US_TASK_0172371247__varname1482142718107">tcpflag-value-ipv6</span></i> [ <strong><span id="EN-US_TASK_0172371247__cmdparmname6823272100">mask</span></strong> <i><span class="varname" id="EN-US_TASK_0172371247__varname182327151013">tcpflag-mask-ipv6</span></i> ] | <strong><span id="EN-US_TASK_0172371247__cmdparmname16823273102">bit-match</span></strong> { <strong><span id="EN-US_TASK_0172371247__cmdparmname17824279100">established</span></strong> | <strong><span id="EN-US_TASK_0172371247__cmdparmname1082132781018">fin</span></strong> | <strong><span id="EN-US_TASK_0172371247__cmdparmname1582162781016">syn</span></strong> | <strong><span id="EN-US_TASK_0172371247__cmdparmname108292719108">rst</span></strong> | <strong><span id="EN-US_TASK_0172371247__cmdparmname1828272105">psh</span></strong> | <strong><span id="EN-US_TASK_0172371247__cmdparmname1282527121010">ack</span></strong> | <strong><span id="EN-US_TASK_0172371247__cmdparmname1182182781017">urg</span></strong> } } command.</li><li id="EN-US_TASK_0172371247__li1537935669214057"><p id="EN-US_TASK_0172371247__p971613591214057"><a name="EN-US_TASK_0172371247__li1537935669214057"></a><a name="li1537935669214057"></a>To define a matching rule to classify traffic based on the precedence of an IP packet, run the <a href="cmdqueryname=if-match"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname412241727214352">if-match</span></b></a><span> [ <strong><span id="EN-US_TASK_0172371247__cmdparmname1015546232214352">ipv6</span></strong> ] </span><strong><span id="EN-US_TASK_0172371247__cmdparmname603790445214352">ip-precedence</span></strong> <i><span class="varname" id="EN-US_TASK_0172371247__varname1573047854214352">ip-precedence</span></i> command.</p>
</li><li id="EN-US_TASK_0172371247__li345159896214057"><p id="EN-US_TASK_0172371247__p749041525214057"><a name="EN-US_TASK_0172371247__li345159896214057"></a><a name="li345159896214057"></a>To define a matching rule to classify traffic based on the MPLS EXP value, run the <a href="cmdqueryname=if-match+mpls-exp"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname1242214072214352">if-match mpls-exp</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371247__varname233569348214352">exp-value</span></i> command.</p>
</li><li id="EN-US_TASK_0172371247__li1621081470214057"><p id="EN-US_TASK_0172371247__p391236801214057"><a name="EN-US_TASK_0172371247__li1621081470214057"></a><a name="li1621081470214057"></a>To define a matching rule to match all packets, run the <a href="cmdqueryname=if-match"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname721828852214352">if-match</span></b></a><span> [ <strong><span id="EN-US_TASK_0172371247__cmdparmname420803610214352">ipv6</span></strong> ]</span> <strong><span id="EN-US_TASK_0172371247__cmdparmname516177123214352">any</span></strong> command.</p>
</li><li id="EN-US_TASK_0172371247__li1989820635214057"><p id="EN-US_TASK_0172371247__p152577714214057"><a name="EN-US_TASK_0172371247__li1989820635214057"></a><a name="li1989820635214057"></a>To define a matching rule to classify traffic based on the value of the next IPv6 header, run the <a href="cmdqueryname=if-match+ipv6+next-header"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname41877241214057">if-match ipv6 next-header</span></b></a> <em id="EN-US_TASK_0172371247__i95231727102616">header-number</em><strong id="EN-US_TASK_0172371247__b115231527112615"> first-next-header</strong> command.</p>
</li><li id="EN-US_TASK_0172371247__li234591284214057"><p id="EN-US_TASK_0172371247__p2143217943214057"><a name="EN-US_TASK_0172371247__li234591284214057"></a><a name="li234591284214057"></a>To define a matching rule to classify traffic based on the source IPv6 address, run the <a href="cmdqueryname=if-match+ipv6+source-address"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname1177042362214352">if-match ipv6 source-address</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371247__varname378414395214352">ipv6-address</span></i> <i><span class="varname" id="EN-US_TASK_0172371247__varname1840852125214352">prefix-length</span></i> command.</p>
</li><li id="EN-US_TASK_0172371247__li1082340859214057"><p id="EN-US_TASK_0172371247__p1716327123214057"><a name="EN-US_TASK_0172371247__li1082340859214057"></a><a name="li1082340859214057"></a>To define a matching rule to classify traffic based on a destination IPv6 address, run the <a href="cmdqueryname=if-match+ipv6+destination-address"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname1563896893214352">if-match ipv6 destination-address</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371247__varname1535614884214352">ipv6-address</span></i> <i><span class="varname" id="EN-US_TASK_0172371247__varname412979519214352">prefix-length</span></i> command.</p>
</li><li id="EN-US_TASK_0172371247__li280048687214057">To define a matching rule to classify IPv4 packets based on the QoS policy ID, run the <a href="cmdqueryname=if-match+qos-local-id"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname1847647415214057">if-match qos-local-id</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371247__varname1036016112277">qos-local-id</span></i> command.</li><li id="EN-US_TASK_0172371247__li1156124399214057">To define a matching rule to classify IPv4 packets based on the source and destination QoS policy IDs, run the <a href="cmdqueryname=if-match+qos-local-id"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname564374589214057">if-match qos-local-id</span></b></a> <strong><span id="EN-US_TASK_0172371247__cmdparmname15557133522815">source</span></strong> <i><span class="varname" id="EN-US_TASK_0172371247__varname055773510282">source-qos-local-id</span></i> <strong><span id="EN-US_TASK_0172371247__cmdparmname8557435172817">destination</span></strong> <i><span class="varname" id="EN-US_TASK_0172371247__varname185570354282">destination-qos-local-id</span></i> command.</li><li id="EN-US_TASK_0172371247__li1947237051214057">To define a matching rule to classify traffic based on the IPv6 QoS policy ID, run the <a href="cmdqueryname=if-match+ipv6+qos-local-id"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname1334204646214352">if-match ipv6 qos-local-id</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371247__varname891077401214352">qos-local-id</span></i> command.</li></ul>
</p></li><li class="substepexpand" id="EN-US_TASK_0172371247__substep1948433107214057"><span id="EN-US_TASK_0172371247__cmd65597980214352">Run <span><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname1746426786214352">commit</span></b></a></span></span><p><p id="EN-US_TASK_0172371247__p1704126063214352">The configuration is committed.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0172371247__step1284545679214057"><span id="EN-US_TASK_0172371247__cmd706123662214057">Define a traffic classifier based on Layer 2 information</span><ol id="EN-US_TASK_0172371247__substeps290010667214057"><li class="substepexpand" id="EN-US_TASK_0172371247__substep1449775516214057"><span id="EN-US_TASK_0172371247__en-us_task_0172371247_cmd462366047214352">Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172371247__en-us_task_0172371247_cmdname1965975916214352">system-view</span></b></a></span></span><p><p id="EN-US_TASK_0172371247__en-us_task_0172371247_p497623617214352">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172371247__substep1604983300214057"><span id="EN-US_TASK_0172371247__en-us_task_0172371247_cmd1113361205214057">Run <span><a href="cmdqueryname=traffic+classifier"><b><span class="cmdname" id="EN-US_TASK_0172371247__en-us_task_0172371247_cmdname1850473321214352">traffic classifier</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371247__en-us_task_0172371247_varname1991830050214352">classifier-name</span></i> [ <strong><span id="EN-US_TASK_0172371247__en-us_task_0172371247_cmdparmname1477466908214352">operator</span></strong> { <strong><span id="EN-US_TASK_0172371247__en-us_task_0172371247_cmdparmname111324511214352">and</span></strong> | <strong><span id="EN-US_TASK_0172371247__en-us_task_0172371247_cmdparmname5067032214352">or</span></strong> } ]</span></span><p><p id="EN-US_TASK_0172371247__en-us_task_0172371247_p17931191413513">A traffic classifier is defined and its view is displayed.</p>
</p><p><p id="EN-US_TASK_0172371247__en-us_task_0172371247_p161301965214057">If you define multiple matching rules in a traffic classifier, you can set the logical relationship between the matching rules by specifying the <strong id="EN-US_TASK_0172371247__en-us_task_0172371247_b481905417017">operator</strong> parameter.</p>
<ul id="EN-US_TASK_0172371247__en-us_task_0172371247_ul1501620244214057"><li id="EN-US_TASK_0172371247__en-us_task_0172371247_li1131211921214057"><strong><span id="EN-US_TASK_0172371247__en-us_task_0172371247_cmdparmname580314255915">and</span></strong>: A packet belongs to the classifier only when it matches all the rules.</li><li id="EN-US_TASK_0172371247__en-us_task_0172371247_li169399980214057"><strong><span id="EN-US_TASK_0172371247__en-us_task_0172371247_cmdparmname1953491214593">or</span></strong>: A packet belongs to the classifier if it matches any one of the rules.</li></ul>
</p></li><li class="substepexpand" id="EN-US_TASK_0172371247__substep902455748214057"><span id="EN-US_TASK_0172371247__cmd2044241522214057">Define matching rules on the <span class="keyword" id="EN-US_TASK_0172371247__keyword1862874942214352">Router</span> as required.</span><p><ul id="EN-US_TASK_0172371247__ul676923364214057"><li id="EN-US_TASK_0172371247__li92323342214057"><p id="EN-US_TASK_0172371247__p1195215860214057"><a name="EN-US_TASK_0172371247__li92323342214057"></a><a name="li92323342214057"></a>To define a matching rule based on an ACL, run the <a href="cmdqueryname=if-match"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname1241314790214057">if-match</span></b></a><span> </span><strong><span id="EN-US_TASK_0172371247__cmdparmname983132609214057">acl</span></strong> { <i><span class="varname" id="EN-US_TASK_0172371247__varname1683388000214057">acl-number</span></i> | <strong><span id="EN-US_TASK_0172371247__cmdparmname256092996214057">name</span></strong> <i><span class="varname" id="EN-US_TASK_0172371247__varname1620214898214057">acl-name</span></i> } <span>[ <span><strong><span id="EN-US_TASK_0172371247__cmdparmname10683134125819">precedence</span></strong> <i><span class="varname" id="EN-US_TASK_0172371247__varname1468312348581">precedence-value</span></i></span> ]</span> command.</p>
</li><li id="EN-US_TASK_0172371247__li1529089812214057"><p id="EN-US_TASK_0172371247__p475666635214057"><a name="EN-US_TASK_0172371247__li1529089812214057"></a><a name="li1529089812214057"></a>To define a matching rule to classify traffic based on the 802.1p priority of VLAN packets, run the <a href="cmdqueryname=if-match+8021p"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname643845366214352">if-match 8021p</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371247__varname472895423214352">8021p-value</span></i> command.</p>
</li><li id="EN-US_TASK_0172371247__li1142237260214057"><p id="EN-US_TASK_0172371247__p1225308287214057"><a name="EN-US_TASK_0172371247__li1142237260214057"></a><a name="li1142237260214057"></a>To define a matching rule to classify traffic based on the CoS, run the <a href="cmdqueryname=if-match+service-class"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname1470214711214352">if-match service-class</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371247__varname861211083214352">service-class-value</span></i> command.</p>
</li><li id="EN-US_TASK_0172371247__li860960696214057"><p id="EN-US_TASK_0172371247__p421604186214057"><a name="EN-US_TASK_0172371247__li860960696214057"></a><a name="li860960696214057"></a>To define a matching rule to classify traffic based on the source MAC address, run the <a href="cmdqueryname=if-match+source-mac"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname211183660214057">if-match source-mac</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371247__varname980597621214057">mac-address</span></i>  command.</p>
</li><li id="EN-US_TASK_0172371247__li268813679214057"><p id="EN-US_TASK_0172371247__p1793393312214057"><a name="EN-US_TASK_0172371247__li268813679214057"></a><a name="li268813679214057"></a>To define a matching rule to classify traffic based on the destination MAC address, run the <a href="cmdqueryname=if-match+destination-mac"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname1140801805214057">if-match destination-mac</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371247__varname918479760214057">mac-address</span></i>  command.</p>
</li><li id="EN-US_TASK_0172371247__li10588183712495">To define a matching rule to classify traffic based on the VLAN, run the <a href="cmdqueryname=if-match+vlan"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname122031319112611">if-match vlan</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371247__varname8588537144911">vlan-id</span></i> [ <strong><span id="EN-US_TASK_0172371247__cmdparmname4588193744911">cvlan</span></strong> <i><span class="varname" id="EN-US_TASK_0172371247__varname195881437184912">ce-vlan-id</span></i> ] command.</li><li id="EN-US_TASK_0172371247__li172241936125010">To define a matching rule to classify traffic based on the packet offset, run the <a href="cmdqueryname=if-match"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname1767341195117">if-match</span></b></a> { <strong><span id="EN-US_TASK_0172371247__span16281161612457">offset </span></strong><i><span class="varname" id="EN-US_TASK_0172371247__varname12281016134512">offset-value</span></i> <strong><span id="EN-US_TASK_0172371247__span1281191620454">match-value</span></strong> <i><span class="varname" id="EN-US_TASK_0172371247__varname228112164456">match-value</span></i> <strong><span id="EN-US_TASK_0172371247__span18281111613454">match-mask</span></strong> <i><span class="varname" id="EN-US_TASK_0172371247__varname3281516124515">match-mask</span></i> } &lt;1-4&gt; command.<div class="caution" id="EN-US_TASK_0172371247__note1397711215529"><span class="cautiontitle"><img src="../../../../public_sys-resources/caution_3.0-en-us.png"> </span><div class="cautionbody"><p id="EN-US_TASK_0172371247__p1297719127524">A matching rule based on the packet offset affects forwarding performance. Therefore, understand related precautions before using the <a href="cmdqueryname=if-match"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname6978712135211">if-match</span></b></a> <strong><span id="EN-US_TASK_0172371247__span12460823154512">offset</span></strong> command.</p>
</div></div>
</li></ul>
<div class="p" id="EN-US_TASK_0172371247__p1625743072214057">If multiple traffic classifiers are configured in one traffic policy, the traffic behaviors corresponding to these traffic classifiers are implemented in different orders.<ul id="EN-US_TASK_0172371247__ul1674943319214057"><li id="EN-US_TASK_0172371247__li958709098214057">When multiple traffic classifiers match different fields of an IP packet and the priorities of the traffic classifiers are not specified, the traffic classifier configured first in the traffic policy takes effect preferentially.<p id="EN-US_TASK_0172371247__p480284724214057"><a name="EN-US_TASK_0172371247__li958709098214057"></a><a name="li958709098214057"></a>For example, as shown in <a href="#EN-US_TASK_0172371247__tab_dc_ne_qos_cfg_004201">Table 1</a>, Policy 1 defines two traffic classifiers and their corresponding traffic behaviors in sequence. If a packet matches both traffic classifiers, behavior1 is performed on the packet. That is, the 802.1p value is re-marked as 1.</p>

<div class="tableBorder"><a name="EN-US_TASK_0172371247__tab_dc_ne_qos_cfg_004201"></a><a name="tab_dc_ne_qos_cfg_004201"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172371247__tab_dc_ne_qos_cfg_004201" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Traffic classifiers and behaviors defined in Policy 1</caption><thead align="left"><tr id="EN-US_TASK_0172371247__row514798109214057"><th align="left" class="cellrowborder" valign="bottom" width="22%" id="mcps1.4.1.2.2.3.2.2.1.1.2.2.5.1.1" liSelected="liSelected"><p id="EN-US_TASK_0172371247__p35087380214057">Traffic Classifier</p>
</th>
<th align="left" class="cellrowborder" valign="bottom" width="30%" id="mcps1.4.1.2.2.3.2.2.1.1.2.2.5.1.2" liSelected="liSelected"><p id="EN-US_TASK_0172371247__p1000401383214057">Matching Rule</p>
</th>
<th align="left" class="cellrowborder" valign="bottom" width="21%" id="mcps1.4.1.2.2.3.2.2.1.1.2.2.5.1.3" liSelected="liSelected"><p id="EN-US_TASK_0172371247__p621376792214057">Traffic Behavior</p>
</th>
<th align="left" class="cellrowborder" valign="bottom" width="27%" id="mcps1.4.1.2.2.3.2.2.1.1.2.2.5.1.4" liSelected="liSelected"><p id="EN-US_TASK_0172371247__p1342112227214057">Traffic Action</p>
</th>
</tr>
</thead>
<tbody><tr id="EN-US_TASK_0172371247__row1365765850214057"><td class="cellrowborder" valign="top" width="22%" headers="mcps1.4.1.2.2.3.2.2.1.1.2.2.5.1.1 "><p id="EN-US_TASK_0172371247__p283947635214057">classifier1</p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="mcps1.4.1.2.2.3.2.2.1.1.2.2.5.1.2 "><p id="EN-US_TASK_0172371247__p541383690214057">Matching the destination MAC address</p>
</td>
<td class="cellrowborder" valign="top" width="21%" headers="mcps1.4.1.2.2.3.2.2.1.1.2.2.5.1.3 "><p id="EN-US_TASK_0172371247__p1803250120214057">behavior1</p>
</td>
<td class="cellrowborder" valign="top" width="27%" headers="mcps1.4.1.2.2.3.2.2.1.1.2.2.5.1.4 "><p id="EN-US_TASK_0172371247__p921218425214057">Re-marking the 802.1p value as 1</p>
</td>
</tr>
<tr id="EN-US_TASK_0172371247__row336214706214057"><td class="cellrowborder" valign="top" width="22%" headers="mcps1.4.1.2.2.3.2.2.1.1.2.2.5.1.1 "><p id="EN-US_TASK_0172371247__p545113751214057">classifier3</p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="mcps1.4.1.2.2.3.2.2.1.1.2.2.5.1.2 "><p id="EN-US_TASK_0172371247__p1738251187214057">Matching the source MAC address</p>
</td>
<td class="cellrowborder" valign="top" width="21%" headers="mcps1.4.1.2.2.3.2.2.1.1.2.2.5.1.3 "><p id="EN-US_TASK_0172371247__p501743054214057">behavior3</p>
</td>
<td class="cellrowborder" valign="top" width="27%" headers="mcps1.4.1.2.2.3.2.2.1.1.2.2.5.1.4 "><p id="EN-US_TASK_0172371247__p1951578033214057">Re-marking the 802.1p value as 3</p>
</td>
</tr>
</tbody>
</table>
</div>
</li><li id="EN-US_TASK_0172371247__li1235032319214057">When multiple traffic classifiers match the same field of an IP packet, the traffic behavior corresponding to the specific traffic classifier is implemented for the packet.<p id="EN-US_TASK_0172371247__p1130833338214057"><a name="EN-US_TASK_0172371247__li1235032319214057"></a><a name="li1235032319214057"></a>For example, as shown in <a href="#EN-US_TASK_0172371247__tab_dc_ne_qos_cfg_004202">Table 2</a>, Policy 2 defines three traffic classifiers and their corresponding traffic behaviors in sequence. If the destination MAC address of a packet is 2-2-2, behavior 2 is performed on the packet, and the 802.1p value of the packet is re-marked as 2.</p>

<div class="tableBorder"><a name="EN-US_TASK_0172371247__tab_dc_ne_qos_cfg_004202"></a><a name="tab_dc_ne_qos_cfg_004202"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172371247__tab_dc_ne_qos_cfg_004202" frame="border" border="1" rules="all"><caption><b>Table 2 </b>Traffic classifiers and behaviors defined in Policy 2</caption><thead align="left"><tr id="EN-US_TASK_0172371247__row1309315247214057"><th align="left" class="cellrowborder" valign="bottom" width="22%" id="mcps1.4.1.2.2.3.2.2.1.2.2.2.5.1.1" liSelected="liSelected"><p id="EN-US_TASK_0172371247__p138092888214057">Traffic Classifier</p>
</th>
<th align="left" class="cellrowborder" valign="bottom" width="30%" id="mcps1.4.1.2.2.3.2.2.1.2.2.2.5.1.2" liSelected="liSelected"><p id="EN-US_TASK_0172371247__p641861617214057">Matching Rule</p>
</th>
<th align="left" class="cellrowborder" valign="bottom" width="21%" id="mcps1.4.1.2.2.3.2.2.1.2.2.2.5.1.3" liSelected="liSelected"><p id="EN-US_TASK_0172371247__p673554981214057">Traffic Behavior</p>
</th>
<th align="left" class="cellrowborder" valign="bottom" width="27%" id="mcps1.4.1.2.2.3.2.2.1.2.2.2.5.1.4" liSelected="liSelected"><p id="EN-US_TASK_0172371247__p1918446738214057">Traffic Action</p>
</th>
</tr>
</thead>
<tbody><tr id="EN-US_TASK_0172371247__row1110555742214057"><td class="cellrowborder" valign="top" width="22%" headers="mcps1.4.1.2.2.3.2.2.1.2.2.2.5.1.1 "><p id="EN-US_TASK_0172371247__p535698803214057">classifier1</p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="mcps1.4.1.2.2.3.2.2.1.2.2.2.5.1.2 "><p id="EN-US_TASK_0172371247__p1432766452214057">Matching the destination MAC address 1-1-1</p>
</td>
<td class="cellrowborder" valign="top" width="21%" headers="mcps1.4.1.2.2.3.2.2.1.2.2.2.5.1.3 "><p id="EN-US_TASK_0172371247__p483811682214057">behavior1</p>
</td>
<td class="cellrowborder" valign="top" width="27%" headers="mcps1.4.1.2.2.3.2.2.1.2.2.2.5.1.4 "><p id="EN-US_TASK_0172371247__p1665171479214057">Re-marking the 802.1p value as 1</p>
</td>
</tr>
<tr id="EN-US_TASK_0172371247__row1113502836214057"><td class="cellrowborder" valign="top" width="22%" headers="mcps1.4.1.2.2.3.2.2.1.2.2.2.5.1.1 "><p id="EN-US_TASK_0172371247__p345451185214057">classifier2</p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="mcps1.4.1.2.2.3.2.2.1.2.2.2.5.1.2 "><p id="EN-US_TASK_0172371247__p1231285273214057">Matching the destination MAC address 2-2-2</p>
</td>
<td class="cellrowborder" valign="top" width="21%" headers="mcps1.4.1.2.2.3.2.2.1.2.2.2.5.1.3 "><p id="EN-US_TASK_0172371247__p1925971290214057">behavior2</p>
</td>
<td class="cellrowborder" valign="top" width="27%" headers="mcps1.4.1.2.2.3.2.2.1.2.2.2.5.1.4 "><p id="EN-US_TASK_0172371247__p513840878214057">Re-marking the 802.1p value as 2</p>
</td>
</tr>
<tr id="EN-US_TASK_0172371247__row1035862382214057"><td class="cellrowborder" valign="top" width="22%" headers="mcps1.4.1.2.2.3.2.2.1.2.2.2.5.1.1 "><p id="EN-US_TASK_0172371247__p1934506070214057">classifier3</p>
</td>
<td class="cellrowborder" valign="top" width="30%" headers="mcps1.4.1.2.2.3.2.2.1.2.2.2.5.1.2 "><p id="EN-US_TASK_0172371247__p455724852214057">Matching the destination MAC address 3-3-3</p>
</td>
<td class="cellrowborder" valign="top" width="21%" headers="mcps1.4.1.2.2.3.2.2.1.2.2.2.5.1.3 "><p id="EN-US_TASK_0172371247__p1053543455214057">behavior3</p>
</td>
<td class="cellrowborder" valign="top" width="27%" headers="mcps1.4.1.2.2.3.2.2.1.2.2.2.5.1.4 "><p id="EN-US_TASK_0172371247__p1337531322214057">Re-marking the 802.1p value as 3</p>
</td>
</tr>
</tbody>
</table>
</div>
</li></ul>
</div>
</p></li><li class="substepexpand" id="EN-US_TASK_0172371247__substep1564425513214057"><span id="EN-US_TASK_0172371247__cmd1863937911214352">Run <span><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172371247__cmdname1702293468214352">commit</span></b></a></span></span><p><p id="EN-US_TASK_0172371247__p1440158363214352">The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0040.html">Configuring MF Classification-based Traffic Policies for IP Packets
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0043.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>