
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Defining a Traffic Behavior and Configuring Actions">
<meta name="abstract" content="This section describes the traffic behaviors supported by a device and how to configure actions for a traffic behavior.">
<meta name="description" content="This section describes the traffic behaviors supported by a device and how to configure actions for a traffic behavior.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_012783.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_012787.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_012789.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909,m00390128">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="User Access QoS">
<meta name="featuretype" content="QOS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="User Access QoS">
<meta name="featuretype" content="QOS">
<meta name="featurename" content="User Access QoS">
<meta name="featuretype" content="QOS">
<meta name="featurename" content="Last-Mile QoS">
<meta name="featuretype" content="QOS">
<meta name="OWNER" content="m00390128">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="m00390128">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001259777205">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Defining a Traffic Behavior and Configuring Actions</title>
</head>
<body><a name="EN-US_TASK_0000001259777205"></a><a name="EN-US_TASK_0000001259777205"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Defining a Traffic Behavior and Configuring Actions</h1>
<div class="taskbody"><p>This section describes the traffic behaviors supported by a device and how to configure actions for a traffic behavior.</p>
<div class="context"><a name="EN-US_TASK_0000001259777205__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>A device supports various types of actions for a traffic behavior. You can configure one or more types of actions as required.</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0000001259777205__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure packet filtering actions.</span><p><p>Perform the following configurations on the <span class="keyword">Router</span>.</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=traffic+behavior"><b><span class="cmdname">traffic behavior</span></b></a> <i><span class="varname">behavior-name</span></i></span><p><p>A traffic behavior is configured and its view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=permit+%7C+deny"><b><span class="cmdname">permit | deny</span></b></a></span><p><p>The device is enabled to permit or deny packets.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If both the <strong>if-match any</strong> and <strong>deny</strong> commands are configured on a device, the device denies all packets, including protocol packets, that flow through an interface. Therefore, exercise caution when configuring both the commands.</p>
<p>If the permit or deny action is configured in both the <strong>rule</strong> command and the traffic behavior view, only packets that are permitted by the <strong>rule</strong> command are processed according to the configured traffic behavior. If the deny action is configured in either the <strong>rule</strong> command or the traffic behavior view, all matched packets are discarded.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure a traffic policing action.</span><p><p>Perform the following configurations on the <span class="keyword">Router</span>.</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=traffic+behavior"><b><span class="cmdname">traffic behavior</span></b></a> <i><span class="varname">behavior-name</span></i></span><p><p>A traffic behavior is configured and its view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=car"><b><span class="cmdname">car</span></b></a> { <strong><span>cir</span></strong> <i><span class="varname">cir-value</span></i> [ <strong><span>pir</span></strong> <i><span class="varname">pir-value</span></i> ] } [ <strong><span>cbs</span></strong> <i><span class="varname">cbs-value</span></i> <span>[ </span><strong><span>pbs</span></strong> <i><span class="varname">pbs-value</span></i> ]<span> ]</span><span> [ <strong><span>adjust</span></strong> <i><span class="varname">adjust-value</span></i> ]</span> [ <strong><span>green</span></strong> { <strong><span>discard</span></strong> | <strong><span>pass</span></strong> [ <span><strong><span>remark dscp</span></strong> <i><span class="varname">dscp-value</span></i> | </span><strong><span>service-class</span></strong> <i><span class="varname">class</span></i> <strong><span>color</span></strong> <i><span class="varname">color</span></i> ] } | <strong><span>yellow</span></strong> { <strong><span>discard</span></strong> | <strong><span>pass</span></strong> [ <span><strong><span>remark dscp</span></strong> <i><span class="varname">dscp-value</span></i> | </span><strong><span>service-class</span></strong> <i><span class="varname">class</span></i> <strong><span>color</span></strong> <i><span class="varname">color</span></i> ] } | <strong><span>red</span></strong> { <strong><span>discard</span></strong> | <strong><span>pass</span></strong> [ <span><strong><span>remark dscp</span></strong> <i><span class="varname">dscp-value</span></i> | </span><strong><span>service-class</span></strong> <i><span class="varname">class</span></i> <strong><span>color</span></strong> <i><span class="varname">color</span></i> ] } ] <sup>*</sup> <span>[ <strong><span>summary</span></strong> ]</span> [ <strong><span>color-aware</span></strong> ] <span>[ <strong><span>limit-type pps</span></strong> ]</span></span><p><p>A traffic policing action is configured.</p>
</p><p><p>After you configure a traffic policing action for a traffic policy, the traffic policy can be applied to incoming or outgoing traffic on an interface.</p>
<p>Applying a traffic policy configured with traffic policing to an interface affects the original <a href="cmdqueryname=qos+car"><b><span class="cmdname">qos car</span></b></a> command.</p>
<p>If this command is run more than once, the last configuration overrides the previous one.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the service class of a packet is re-marked as EF, BE, CS6, or CS7, the packet can be re-marked only green.</p>
<p>If there are a large number of access users and CAR resource specifications need to be increased, run the <strong>car resource-pool enhanced mode</strong> command to change the CAR resource allocation mode to enhanced.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=user-queue"><b><span class="cmdname">user-queue</span></b></a> <strong><span>cir</span></strong> <i><span class="varname">cir-value</span></i> [ [ <strong><span>pir</span></strong> <i><span class="varname">pir-value</span></i> ] | [ <strong><span>flow-queue</span></strong> <i><span class="varname">flow-queue-name</span></i> ] | <span>[ <strong><span>flow-mapping</span></strong> <i><span class="varname">mapping-name</span></i> ] | </span>[ <strong><span>user-group-queue</span></strong> <i><span class="varname">group-name</span></i> ] | [ <strong><span>service-template</span></strong> <i><span class="varname">service-template-name</span></i> ] ]*</span><p><p>Class-based HQoS scheduling is configured for the traffic behavior.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The <a href="cmdqueryname=user-queue"><b><span class="cmdname">user-queue</span></b></a> and <a href="cmdqueryname=car"><b><span class="cmdname">car</span></b></a> commands cannot both be configured in the same traffic behavior.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Set a packet priority.</span><p><p>Perform the following configurations on the <span class="keyword">Router</span>.</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=traffic+behavior"><b><span class="cmdname">traffic behavior</span></b></a> <i><span class="varname">behavior-name</span></i></span><p><p>A traffic behavior is configured and its view is displayed.</p>
</p></li><li class="substepexpand"><span>Perform the following configurations as required.</span><p><ul><li><p>To re-mark the precedence of IP packets, run the <a href="cmdqueryname=remark+ip-precedence"><b><span class="cmdname">remark ip-precedence</span></b></a> <i><span class="varname">ip-precedence</span></i> command.</p>
</li><li><p>To re-mark the DSCP value of IP packets, run the <a href="cmdqueryname=remark"><b><span class="cmdname">remark</span></b></a> [ <strong><span>ipv6</span></strong> ] <strong><span>dscp</span></strong> <i><span class="varname">dscp-value</span></i> command.</p>
</li><li><p>To re-mark the priority of VLAN packets, run the <a href="cmdqueryname=remark+8021p"><b><span class="cmdname">remark 8021p</span></b></a> <i><span class="varname">8021p-value</span></i> command.</p>
</li><li><p>To re-mark the ToS value of IP packets, run the <a href="cmdqueryname=remark+tos"><b><span class="cmdname">remark tos</span></b></a> <i><span class="varname">tos</span></i> command.</p>
</li><li>To re-mark the DF value of IP packets, run the <a href="cmdqueryname=remark+ip-df"><b><span class="cmdname">remark ip-df</span></b></a> command.</li><li>To re-mark the TTL value of IP packets, run the <a href="cmdqueryname=remark+ttl"><b><span class="cmdname">remark ttl</span></b></a> <i><span class="varname">ttl-value</span></i> command.</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>To re-mark the DSCP value of IPv6 packets, run the <a href="cmdqueryname=remark+ipv6+dscp"><b><span class="cmdname">remark ipv6 dscp</span></b></a> <i><span class="varname">dscp-value</span></i> command.</p>
<p>The <a href="cmdqueryname=remark+ip-df"><b><span class="cmdname">remark ip-df</span></b></a> command is supported only on the <span class="keyword">Router</span>.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure forcible traffic classification.</span><ol id="EN-US_TASK_0000001259777205__en-us_task_0172371248_substeps465199205214057"><li class="substepexpand" id="EN-US_TASK_0000001259777205__en-us_task_0172371248_substep1966525415214057"><span id="EN-US_TASK_0000001259777205__en-us_task_0172371248_cmd1619322575214057">Run <a href="cmdqueryname=service-class"><b><span class="cmdname" id="EN-US_TASK_0000001259777205__en-us_task_0172371248_cmdname1730434652214057">service-class</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001259777205__en-us_task_0172371248_varname1636189692214057">service-class</span></i> <strong><span id="EN-US_TASK_0000001259777205__en-us_task_0172371248_cmdparmname850086083214057">color</span></strong> <i><span class="varname" id="EN-US_TASK_0000001259777205__en-us_task_0172371248_varname1371659563214057">color</span></i></span><p><p id="EN-US_TASK_0000001259777205__en-us_task_0172371248_p3529810151218">Packets with a certain CoS are colored.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001259777205__en-us_task_0172371248_substep106286018214057"><span id="EN-US_TASK_0000001259777205__en-us_task_0172371248_cmd15302816425">(Optional) Run <a href="cmdqueryname=service-class"><b><span class="cmdname" id="EN-US_TASK_0000001259777205__en-us_task_0172371248_cmdname1880588154214057">service-class</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001259777205__en-us_task_0172371248_varname41516796214057">service-class</span></i> <strong><span id="EN-US_TASK_0000001259777205__en-us_task_0172371248_cmdparmname38838244214057">color</span></strong> <i><span class="varname" id="EN-US_TASK_0000001259777205__en-us_task_0172371248_varname1870693011214057">color</span></i> <strong><span id="EN-US_TASK_0000001259777205__en-us_task_0172371248_cmdparmname654234838214057">track</span></strong> { <strong><span id="EN-US_TASK_0000001259777205__en-us_task_0172371248_cmdparmname1198736899214057">master</span></strong> | <strong><span id="EN-US_TASK_0000001259777205__en-us_task_0172371248_cmdparmname1709332567214057">slave</span></strong> } <strong><span id="EN-US_TASK_0000001259777205__en-us_task_0172371248_cmdparmname56904496214057">bfd-session</span></strong> <strong><span id="EN-US_TASK_0000001259777205__en-us_task_0172371248_cmdparmname73929228214057">session-name</span></strong> <i><span class="varname" id="EN-US_TASK_0000001259777205__en-us_task_0172371248_varname306166898214057">bfd-session-name</span></i></span><p><p id="EN-US_TASK_0000001259777205__en-us_task_0172371248_p23232124216">The CoS and color of packets matching the traffic policy are marked based on the status of a specified BFD session.</p>
</p><p></p></li><li class="substepexpand" id="EN-US_TASK_0000001259777205__en-us_task_0172371248_substep933110416214057"><span id="EN-US_TASK_0000001259777205__en-us_task_0172371248_cmd1861171318214057">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001259777205__en-us_task_0172371248_cmdname1184819451758">commit</span></b></a></span><p><p id="EN-US_TASK_0000001259777205__en-us_task_0172371248_p554164481211">The configuration is committed.</p>
</p></li></ol>
</li><li><span>Set packet forwarding actions.</span><p><div class="notice"><span class="noticetitle"><img src="../../../../public_sys-resources/notice_3.0-en-us.png"> </span><div class="noticebody"><ul><li>Redirecting packets to a public network LSP can be configured only on the ingress node of the MPLS network, and cannot be configured on other nodes such as transit or egress.</li><li>Redirecting packets to a public network LSP can be configured only when a single MPLS label is applied.</li></ul>
</div></div>
<p>Perform the following configurations on the <span class="keyword">Router</span>.</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=traffic+behavior"><b><span class="cmdname">traffic behavior</span></b></a> <i><span class="varname">behavior-name</span></i></span><p><p>A traffic behavior is configured and its view is displayed.</p>
</p></li><li class="substepexpand"><span>Perform the following configurations as required.</span><p><ul><li><p>To directly forward packets without redirecting them, run the <strong><span>permit</span></strong> command in the traffic behavior view.</p>
</li><li><p>To directly drop packets without redirecting them, run the <strong><span>deny</span></strong> command in the traffic behavior view.</p>
<p>The deny action is mutually exclusive with other traffic actions. Traffic that is configured with the deny action cannot be further processed unless the traffic is configured with the permit action.</p>
</li><li><div class="p">To configure the IPv4 address and outbound interface<span>, VPN instance, and NQA test instance</span> on a single next hop for redirecting IPv4 packets, run the following commands:<ul><li><a href="cmdqueryname=redirect+ip-nexthop"><b><span class="cmdname">redirect ip-nexthop</span></b></a> <i><span class="varname">ip-address</span></i> <strong><span>interface</span></strong> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i><span> [ <strong><span>route-forward</span></strong> ]</span></li><li><a href="cmdqueryname=redirect+ip-nexthop"><b><span class="cmdname">redirect ip-nexthop</span></b></a> <i><span class="varname">ip-address</span></i> <strong><span>nqa</span></strong> <i><span class="varname">nqa-test-administer-name</span></i> <i><span class="varname">name-of-nqa-test-instance</span></i> [ <strong><span>routing-filter</span></strong> { <strong><span>default-routing</span></strong> | <strong><span>blackhole-routing</span></strong> } * ]</li><li><a href="cmdqueryname=redirect+ip-nexthop"><b><span class="cmdname">redirect ip-nexthop</span></b></a> <i><span class="varname">ip-address</span></i> <strong><span>vpn</span></strong> <i><span class="varname">vpn-instance-name</span></i> <span>[ <strong><span>nqa</span></strong> <i><span class="varname">nqa-test-administer-name</span></i> <i><span class="varname">name-of-nqa-test-instance</span></i> ] </span>[ <strong><span>routing-filter</span></strong> { <strong><span>default-routing</span></strong> | <strong><span>blackhole-routing</span></strong> } * ]</li></ul>
</div>
</li><li><div class="p">To configure the IPv4 addresses and outbound interfaces<span>, VPN instances, and NQA test instances</span> on multiple next hops for redirecting IPv4 packets, run the following commands:<ul><li><a href="cmdqueryname=redirect+ipv4-multinhp"><b><span class="cmdname">redirect ipv4-multinhp</span></b></a> { <strong><span>nhp</span></strong> <i><span class="varname">ip-address</span></i> <strong><span>interface</span></strong> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> } &amp;&lt;2-<span>42</span>&gt; [ <strong><span>loadbalance</span></strong> ] <span>[ <strong><span>route-forward</span></strong> ]</span> <span>[ <strong><span>unequal-cost </span></strong>]</span></li><li><a href="cmdqueryname=redirect+ipv4-multinhp"><b><span class="cmdname">redirect ipv4-multinhp</span></b></a> { <strong><span>nhp</span></strong> <i><span class="varname">ip-address</span></i> <strong><span>nqa</span></strong> <i><span class="varname">nqa-test-administer-name</span></i> <i><span class="varname">name-of-nqa-test-instance</span></i> } &amp;&lt;2-<span>42</span>&gt; [ <strong><span>routing-filter</span></strong> { <strong><span>default-routing</span></strong> | <strong><span>blackhole-routing</span></strong> } * ]</li><li><a href="cmdqueryname=redirect+ipv4-multinhp"><b><span class="cmdname">redirect ipv4-multinhp</span></b></a> { <strong><span>nhp</span></strong> <i><span class="varname">ip-address</span></i> <strong><span>vpn</span></strong> <i><span class="varname">vpn-instance-name</span></i> <span>[ <strong><span>nqa</span></strong> <i><span class="varname">nqa-test-administer-name</span></i> <i><span class="varname">name-of-nqa-test-instance</span></i> ] </span>} &amp;&lt;2-<span>42</span>&gt; [ <strong><span>routing-filter</span></strong> { <strong><span>default-routing</span></strong> | <strong><span>blackhole-routing</span></strong> } * ] [ <strong><span>pri-type common</span></strong> ]<span> [ <strong><span>non-revertive</span></strong> ]</span></li></ul>
</div>
</li><li><div class="p">To configure the IPv6 address and outbound interface<span>, VPN instance, and NQA test instance</span> on a single next hop for redirecting IPv6 packets, run the following commands:<ul><li><a href="cmdqueryname=redirect+ipv6-nexthop"><b><span class="cmdname">redirect ipv6-nexthop</span></b></a> <i><span class="varname">ip-address</span></i> <strong><span>interface</span></strong> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i><span> [ <strong><span>route-forward</span></strong> ]</span></li><li><a href="cmdqueryname=redirect+ipv6-nexthop"><b><span class="cmdname">redirect ipv6-nexthop</span></b></a> <i><span class="varname">ip-address</span></i> <strong><span>nqa</span></strong> <i><span class="varname">nqa-test-administer-name</span></i> <i><span class="varname">name-of-nqa-test-instance</span></i> [ <strong><span>routing-filter</span></strong> { <strong><span>default-routing</span></strong> | <strong><span>blackhole-routing</span></strong> } * ]</li><li><a href="cmdqueryname=redirect+ipv6-nexthop"><b><span class="cmdname">redirect ipv6-nexthop</span></b></a> <i><span class="varname">ip-address</span></i> <strong><span>vpn</span></strong> <i><span class="varname">vpn-instance-name</span></i> <span>[ <strong><span>nqa</span></strong> <i><span class="varname">nqa-test-administer-name</span></i> <i><span class="varname">name-of-nqa-test-instance</span></i> ] </span>[ <strong><span>routing-filter</span></strong> { <strong><span>default-routing</span></strong> | <strong><span>blackhole-routing</span></strong> } * ]</li></ul>
</div>
</li><li><div class="p">To configure the IPv6 addresses and outbound interfaces<span>, VPN instances, and NQA test instances</span> on multiple next hops for redirecting IPv6 packets, run the following commands:<ul><li><a href="cmdqueryname=redirect+ipv6-multinhp"><b><span class="cmdname">redirect ipv6-multinhp</span></b></a> { <strong><span>nhp</span></strong> <i><span class="varname">ip-address</span></i> <strong><span>interface</span></strong> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> } &amp;&lt;2-16&gt; [ <strong><span>loadbalance</span></strong> <span>[ <strong><span>sip-hash</span></strong> ] </span>] [ <strong><span>route-forward</span></strong> ] [ <strong><span>pri-type common</span></strong> ] <span>[ <strong><span>unequal-cost </span></strong>]</span></li><li><a href="cmdqueryname=redirect+ipv6-multinhp"><b><span class="cmdname">redirect ipv6-multinhp</span></b></a> { <strong><span>nhp</span></strong> <i><span class="varname">ip-address</span></i> <strong><span>nqa</span></strong> <i><span class="varname">nqa-test-administer-name</span></i> <i><span class="varname">name-of-nqa-test-instance</span></i> } &amp;&lt;2-16&gt; [ <strong><span>routing-filter</span></strong> { <strong><span>default-routing</span></strong> | <strong><span>blackhole-routing</span></strong> } * ]</li><li><a href="cmdqueryname=redirect+ipv6-multinhp"><b><span class="cmdname">redirect ipv6-multinhp</span></b></a> { <strong><span>nhp</span></strong> <i><span class="varname">ip-address</span></i> <strong><span>vpn</span></strong> <i><span class="varname">vpn-instance-name</span></i> <span>[ <strong><span>nqa</span></strong> <i><span class="varname">nqa-test-administer-name</span></i> <i><span class="varname">name-of-nqa-test-instance</span></i> ] </span>} &amp;&lt;2-16&gt; [ <strong><span>routing-filter</span></strong> { <strong><span>default-routing</span></strong> | <strong><span>blackhole-routing</span></strong> } * ]</li></ul>
</div>
</li><li>In a scenario in which packets are redirected to a single next hop whose IP address matches a default route or a black-hole route, if you want packets to be forwarded based on the destination IP address, run either of the following commands:<ul><li><a href="cmdqueryname=redirect+ip-nexthop"><b><span class="cmdname">redirect ip-nexthop</span></b></a> <i><span class="varname">ip-address</span></i> [ <strong><span>routing-filter</span></strong> { <strong><span>default-routing</span></strong> | <strong><span>blackhole-routing</span></strong> } * ]<span> [ <strong><span>deny</span></strong> ]</span></li><li><a href="cmdqueryname=redirect+ip-nexthop"><b><span class="cmdname">redirect ip-nexthop</span></b></a> <i><span class="varname">ip-address</span></i> [ <strong><span>routing-filter</span></strong> { <strong><span>default-routing</span></strong> | <strong><span>blackhole-routing</span></strong> } * ]</li></ul>
</li><li>In a scenario in which packets are redirected to multiple next hops whose IP addresses match default or black-hole routes, if you want packets to be forwarded based on the destination IP address, run either of the following commands:<ul><li><a href="cmdqueryname=redirect+ipv4-multinhp"><b><span class="cmdname">redirect ipv4-multinhp</span></b></a> { <strong><span>nhp</span></strong> <i><span class="varname">ip-address</span></i> } &amp;&lt;2-<span>42</span>&gt; [ <strong><span>routing-filter</span></strong> { <strong><span>default-routing</span></strong> | <strong><span>blackhole-routing</span></strong> } * ] <span>[ <strong><span>deny</span></strong> ]</span></li><li><a href="cmdqueryname=redirect+ipv6-multinhp"><b><span class="cmdname">redirect ipv6-multinhp</span></b></a> { <strong><span>nhp</span></strong> <i><span class="varname">ip-address</span></i> } &amp;&lt;2-16&gt; [ <strong><span>routing-filter</span></strong> { <strong><span>default-routing</span></strong> | <strong><span>blackhole-routing</span></strong> } * ]</li></ul>
</li><li>To redirect IPv4 or IPv6 packets to be forwarded using private network routes to public network routes' outbound interfaces, run the <a href="cmdqueryname=redirect"><b><span class="cmdname">redirect</span></b></a> { <strong><span>ip</span></strong> | <strong><span>ipv6</span></strong> } <strong><span>public-network</span></strong> command.</li><li><p>To redirect IP packets to the public network LSP, run the <a href="cmdqueryname=redirect+lsp+public"><b><span class="cmdname">redirect lsp public</span></b></a> <i><span class="varname">dest-ipv4-address</span></i> [ <i><span class="varname">nexthop-address</span></i> | <strong><span>interface</span></strong> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> | <strong><span>secondary</span></strong> ] command.</p>
</li><li><p>To redirect packets to a specified VPN group, run the <a href="cmdqueryname=redirect+vpn-group"><b><span class="cmdname">redirect vpn-group</span></b></a> <i><span class="varname">vpn-group-name</span></i> command.</p>
</li><li>To redirect packets to a specified VSI, run the <a href="cmdqueryname=redirect+vsi"><b><span class="cmdname">redirect vsi</span></b></a> <i><span class="varname">vsi-name</span></i> command.</li><li>To redirect IPv4 packets to a specified outbound interface, run the <a href="cmdqueryname=redirect+to+interface"><b><span class="cmdname">redirect to interface</span></b></a> { <i><span class="varname">interface-name</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> } [ <strong><span>route-forward</span></strong> ] command.</li><li>To redirect IPv6 packets to a specified outbound interface, run the <a href="cmdqueryname=redirect+ipv6+to+interface"><b><span class="cmdname">redirect ipv6 to interface</span></b></a> { <i><span class="varname">interface-name</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> } [ <strong><span>route-forward</span></strong> ] command.</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In IPv6 application, the IP address of the next hop specified for a Discard policy must be an IPv6 link-local address or an IPv6 unicast address; the IP address of the next hop specified for a Forward policy can be only an IPv6 unicast address.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure the load balancing mode of packets.</span><p><p>Perform the following configurations on the <span class="keyword">Router</span>.</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=traffic+behavior"><b><span class="cmdname">traffic behavior</span></b></a> <i><span class="varname">behavior-name</span></i></span><p><p>A traffic behavior is configured and its view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=load-balance"><b><span class="cmdname">load-balance</span></b></a> { <strong><span>flow</span></strong> [ <strong><span>l2</span></strong> | <strong><span>l3</span></strong> ] | <strong><span>packet</span></strong> }</span><p><p>The load balancing mode of packets is configured.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_012783.html">Configuring UCL-based Traffic Policies
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_012787.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_012789.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>