
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Applying a Traffic Policy">
<meta name="abstract" content="A class-based policy does not take effect unless it is applied to an interface.">
<meta name="description" content="A class-based policy does not take effect unless it is applied to an interface.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0091.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0095.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0097.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909,m00390128">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Class-based QoS">
<meta name="featuretype" content="QOS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Class-based QoS">
<meta name="featuretype" content="QOS">
<meta name="featurename" content="Class-based QoS">
<meta name="featuretype" content="QOS">
<meta name="featurename" content="Class-based QoS">
<meta name="featuretype" content="QOS">
<meta name="OWNER" content="m00390128">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="m00915594">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172371264">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Applying a Traffic Policy</title>
</head>
<body><a name="EN-US_TASK_0172371264"></a><a name="EN-US_TASK_0172371264"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Applying a Traffic Policy</h1>
<div class="taskbody"><p>A class-based policy does not take effect unless it is applied to an interface.</p>
<div class="steps"><a name="EN-US_TASK_0172371264__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Perform the following operations based on the interfaces on which a traffic policy is used:</span><p><ul id="EN-US_TASK_0172371264__ul750449646214058"><li id="EN-US_TASK_0172371264__li1176095412214058">Apply an MF classification-based traffic policy to a Layer 3 interface.<ol type="a" id="EN-US_TASK_0172371264__ol300230705214058"><li id="EN-US_TASK_0172371264__li1864796291214058">To enter the Layer 3 interface view, run the <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0172371264__cmdname978651646214058">interface</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371264__varname628202534214058">interface-type</span></i> <i><span class="varname" id="EN-US_TASK_0172371264__varname229364816214058">interface-number</span></i> command.</li><li id="EN-US_TASK_0172371264__li251250587214058">To apply a traffic policy to the Layer 3 interface, run the <a href="cmdqueryname=traffic-policy"><b><span class="cmdname" id="EN-US_TASK_0172371264__cmdname1038635101214058">traffic-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371264__varname288140503214058">policy-name</span></i> { <strong><span id="EN-US_TASK_0172371264__cmdparmname1302994160214058">inbound</span></strong> | <strong><span id="EN-US_TASK_0172371264__cmdparmname182636346214058">outbound</span></strong> } [ <span id="EN-US_TASK_0172371264__ph137124493214058"><strong><span id="EN-US_TASK_0172371264__cmdparmname401400620214058">all-layer</span></strong> | </span><strong><span id="EN-US_TASK_0172371264__cmdparmname1727405992214058">link-layer</span></strong> | <strong><span id="EN-US_TASK_0172371264__cmdparmname315231249214058">mpls-layer</span></strong> ] command.<div class="note" id="EN-US_TASK_0172371264__note1001989554214058"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172371264__p2019157951214058">If <strong id="EN-US_TASK_0172371264__b4907114918266">link-layer</strong> is configured, the device performs MF classification based on Layer 2 information of packets.</p>
<p id="EN-US_TASK_0172371264__p972995089214058">If <strong id="EN-US_TASK_0172371264__b6883642162610">mpls-layer</strong> is configured, the device performs MF classification based on MPLS packet header information.</p>
<p id="EN-US_TASK_0172371264__p1626640925214058">If <strong><span id="EN-US_TASK_0172371264__cmdparmname17481125102717">all-layer</span></strong> is configured, the device first performs MF classification based on Layer 2 information of packets. If packets do not match any rule based on Layer 2 information, the device performs MF classification based on Layer 3 information of packets.</p>
</div></div>
</li></ol>
</li><li id="EN-US_TASK_0172371264__li2017007324214058">Apply an MF classification-based traffic policy to a Layer 2 interface, with a VLAN ID range specified.<ol type="a" id="EN-US_TASK_0172371264__ol145012422214058"><li id="EN-US_TASK_0172371264__li522189467214058">To enter the Layer 3 interface view, run the <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0172371264__cmdname1032593674214058">interface</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371264__varname1587684277214058">interface-type</span></i> <i><span class="varname" id="EN-US_TASK_0172371264__varname1431455438214058">interface-number</span></i> command.</li><li id="EN-US_TASK_0172371264__li1033452629214058">To change the interface mode from Layer 3 to Layer 2, run the <a href="cmdqueryname=portswitch"><b><span class="cmdname" id="EN-US_TASK_0172371264__cmdname2081771037214058">portswitch</span></b></a> command.</li><li id="EN-US_TASK_0172371264__li1620203026214058">To add the Layer 2 interface to a specific VLAN in tagged mode, run the <a href="cmdqueryname=port+trunk+allow-pass+vlan"><b><span class="cmdname" id="EN-US_TASK_0172371264__cmdname822281940214058">port trunk allow-pass vlan</span></b></a> { { <i><span class="varname" id="EN-US_TASK_0172371264__varname861910113464">vlan-id1</span></i> [ <strong><span id="EN-US_TASK_0172371264__cmdparmname1562519116466">to</span></strong> <i><span class="varname" id="EN-US_TASK_0172371264__varname762514119465">vlan-id2</span></i> ] } &amp;&lt;1-10&gt; | <strong><span id="EN-US_TASK_0172371264__cmdparmname14626111134619">all</span></strong> } command.</li><li id="EN-US_TASK_0172371264__li555877554214058">To apply a traffic policy to the Layer 2 interface, run the <a href="cmdqueryname=traffic-policy"><b><span class="cmdname" id="EN-US_TASK_0172371264__cmdname2000581705214058">traffic-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371264__varname1683657064214058">policy-name</span></i> { <strong><span id="EN-US_TASK_0172371264__cmdparmname664997686214058">inbound</span></strong> | <strong><span id="EN-US_TASK_0172371264__cmdparmname1694324948214058">outbound</span></strong> } <strong><span id="EN-US_TASK_0172371264__cmdparmname508143848214058">vlan</span></strong> { <i><span class="varname" id="EN-US_TASK_0172371264__varname458374700214147">vlan-id1</span></i> [ <strong><span id="EN-US_TASK_0172371264__cmdparmname1888822886214147">to</span></strong> <i><span class="varname" id="EN-US_TASK_0172371264__varname741703303214147">vlan-id2</span></i> ] | <strong><span id="EN-US_TASK_0172371264__cmdparmname507741058214147">all</span></strong> } [ <span id="EN-US_TASK_0172371264__ph36099522214058"><strong><span id="EN-US_TASK_0172371264__cmdparmname1134277800214058">all-layer</span></strong> | </span><strong><span id="EN-US_TASK_0172371264__cmdparmname1133170126214058">link-layer</span></strong> | <strong><span id="EN-US_TASK_0172371264__cmdparmname339337632214058">mpls-layer</span></strong> ] command.</li></ol>
</li><li id="EN-US_TASK_0172371264__li1611959876214058">Apply an MF classification-based traffic policy to an EVC Layer 2 sub-interface, with the bandwidth allocation mode specified.<ol type="a" id="EN-US_TASK_0172371264__ol1427158632214058"><li id="EN-US_TASK_0172371264__li1680850385214058">To enter the EVC Layer 2 sub-interface view, run the <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0172371264__cmdname1809232238214058">interface</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371264__varname88711454124818">interface-type interface-number.subnum</span></i> <strong><span id="EN-US_TASK_0172371264__cmdparmname19877205424811">mode l2</span></strong> command.</li><li id="EN-US_TASK_0172371264__li2073877949214058">To apply a traffic policy to the EVC Layer 2 sub-interface, run the <a href="cmdqueryname=traffic-policy"><b><span class="cmdname" id="EN-US_TASK_0172371264__cmdname623513555214058">traffic-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371264__varname1328745995214058">policy-name</span></i> { <strong><span id="EN-US_TASK_0172371264__cmdparmname1433091020214058">inbound</span></strong> | <strong><span id="EN-US_TASK_0172371264__cmdparmname1936834413214058">outbound</span></strong> }<span id="EN-US_TASK_0172371264__ph1445885819214058"> <strong><span id="EN-US_TASK_0172371264__cmdparmname1157129497214058">identifier</span></strong> { <strong><span id="EN-US_TASK_0172371264__cmdparmname863420999214058">none</span></strong> | <strong><span id="EN-US_TASK_0172371264__cmdparmname299257133214058">vid</span></strong> | <strong><span id="EN-US_TASK_0172371264__cmdparmname858192255214058">ce-vid</span></strong> | <strong><span id="EN-US_TASK_0172371264__cmdparmname739930770214058">vid-ce-vid</span></strong> }</span> [ <span id="EN-US_TASK_0172371264__ph589955445214058"><strong><span id="EN-US_TASK_0172371264__cmdparmname449165916214058">all-layer</span></strong> | </span><strong><span id="EN-US_TASK_0172371264__cmdparmname1456438936214058">link-layer</span></strong> | <strong><span id="EN-US_TASK_0172371264__cmdparmname1060151211214058">mpls-layer</span></strong> ] command.<div class="note" id="EN-US_TASK_0172371264__note779772044214058"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172371264__p1683529514214058">The bandwidth allocation mode specified using the <strong><span id="EN-US_TASK_0172371264__cmdparmname843220362496">identifier</span></strong> parameter must be the same as the one configured on the EVC Layer 2 sub-interface.</p>
</div></div>
</li></ol>
</li><li id="EN-US_TASK_0172371264__li1169874764214058">Apply an MF classification-based traffic policy to a QinQ VLAN tag termination sub-interface, with the PVLAN ID and CVLAN ID ranges specified.<ol type="a" id="EN-US_TASK_0172371264__ol1849130750214058"><li id="EN-US_TASK_0172371264__li1809285254214058">To enter the sub-interface view, run the <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0172371264__cmdname926009386214058">interface</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371264__varname4941191618507">interface-type</span></i> <i><span class="varname" id="EN-US_TASK_0172371264__varname5947121695011">interface-number.subinterface-number</span></i> command.</li><li id="EN-US_TASK_0172371264__li1436081756214058">To set a VLAN ID range for the sub-interface and configure the sub-interface to remove the tags from double-tagged packets, run the <a href="cmdqueryname=encapsulation"><b><span class="cmdname" id="EN-US_TASK_0172371264__cmdname1668582245214058">encapsulation</span></b></a> <strong><span id="EN-US_TASK_0172371264__cmdparmname12792197204811">qinq-termination</span></strong> [ <span id="EN-US_TASK_0172371264__ph157931774817"><strong><span id="EN-US_TASK_0172371264__cmdparmname97922717484">local-switch</span></strong> | </span><strong><span id="EN-US_TASK_0172371264__cmdparmname279311764815">rt-protocol</span></strong> ] command.</li><li id="EN-US_TASK_0172371264__li1714335667214058">To configure the sub-interface as a QinQ VLAN tag termination sub-interface, run the <a href="cmdqueryname=qinq+termination+pe-vid"><b><span class="cmdname" id="EN-US_TASK_0172371264__cmdname569153611214124">qinq termination pe-vid</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371264__varname2368193695014">pe-vid</span></i> [ <strong><span id="EN-US_TASK_0172371264__cmdparmname17374836145012">to</span></strong> <i><span class="varname" id="EN-US_TASK_0172371264__varname1737473695017">high-pe-vid</span></i> ] <strong><span id="EN-US_TASK_0172371264__cmdparmname1737483615507">ce-vid</span></strong> <i><span class="varname" id="EN-US_TASK_0172371264__varname43743363508">ce-vid</span></i> [ <strong><span id="EN-US_TASK_0172371264__cmdparmname037553675012">to</span></strong> <i><span class="varname" id="EN-US_TASK_0172371264__varname12375173695018">high-ce-vid</span></i> ] [ <strong><span id="EN-US_TASK_0172371264__cmdparmname437583695016">vlan-group</span></strong> <i><span class="varname" id="EN-US_TASK_0172371264__varname63751136115014">group-id</span></i> ] command.</li><li id="EN-US_TASK_0172371264__li1239653354214058">To apply a traffic policy to the QinQ VLAN tag termination sub-interface, run the <a href="cmdqueryname=traffic-policy"><b><span class="cmdname" id="EN-US_TASK_0172371264__cmdname535619926214058">traffic-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371264__varname1630605496214058">policy-name</span></i> { <strong><span id="EN-US_TASK_0172371264__cmdparmname382406631214058">inbound</span></strong> | <strong><span id="EN-US_TASK_0172371264__cmdparmname1344909268214058">outbound</span></strong> } <strong><span id="EN-US_TASK_0172371264__cmdparmname1654048364214058">pe-vid</span></strong> <i><span class="varname" id="EN-US_TASK_0172371264__varname13717263214058">pe-vid</span></i> <strong><span id="EN-US_TASK_0172371264__cmdparmname1994473307214058">ce-vid</span></strong> <i><span class="varname" id="EN-US_TASK_0172371264__varname1600151096214058">ce-vid1</span></i> [ <strong><span id="EN-US_TASK_0172371264__cmdparmname974561460214058">to</span></strong> <i><span class="varname" id="EN-US_TASK_0172371264__varname2109176805214058">ce-vid2</span></i> ] [ <span id="EN-US_TASK_0172371264__ph662103072214058"><strong><span id="EN-US_TASK_0172371264__cmdparmname1853555997214058">all-layer</span></strong> | </span><strong><span id="EN-US_TASK_0172371264__cmdparmname686595709214058">link-layer</span></strong> | <strong><span id="EN-US_TASK_0172371264__cmdparmname1968538720214058">mpls-layer</span></strong> ] command.<div class="note" id="EN-US_TASK_0172371264__note197423176556"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172371264__p1574231712551">You can directly run the <a href="cmdqueryname=traffic-policy"><b><span class="cmdname" id="EN-US_TASK_0172371264__cmdname87143495554">traffic-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0172371264__varname1571454945516">policy-name</span></i> { <strong><span id="EN-US_TASK_0172371264__cmdparmname87141349155519">inbound</span></strong> | <strong><span id="EN-US_TASK_0172371264__cmdparmname7714114935512">outbound</span></strong> } [ <span><strong><span id="EN-US_TASK_0172371264__cmdparmname77158493557">all-layer</span></strong> | </span><strong><span id="EN-US_TASK_0172371264__cmdparmname97154494558">link-layer</span></strong> | <strong><span id="EN-US_TASK_0172371264__cmdparmname167153491553">mpls-layer</span></strong> ] command to apply an MF classification-based traffic policy to a QinQ VLAN tag termination sub-interface without specifying PVLAN and CVLAN IDs.</p>
</div></div>
</li></ol>
</li></ul>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0091.html">Configuring MF Classification-based Traffic Policies for VLAN Packets
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0095.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_qos_cfg_0097.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>