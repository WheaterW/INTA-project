
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring an Inter-AS E2E SR-MPLS TE Policy">
<meta name="abstract" content="This section provides an example for configuring an inter-AS E2E SR-MPLS TE Policy to provide secure data channels for services such as inter-AS VPN.">
<meta name="description" content="This section provides an example for configuring an inter-AS E2E SR-MPLS TE Policy to provide secure data channels for services such as inter-AS VPN.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0099.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0403.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="l00587852">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00468467">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00468467">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001844948629">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/thickbox.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/imageResize.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery-migrate-1.2.1.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery-ui.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery.mousewheel.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/thickbox.js"></script>
<title>Example for Configuring an Inter-AS E2E SR-MPLS TE Policy</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001844948629"></a><a name="EN-US_TASK_0000001844948629"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring an Inter-AS E2E SR-MPLS TE Policy</h1>
<div class="taskbody"><p>This section provides an example for configuring an inter-AS E2E SR-MPLS TE Policy to provide secure data channels for services such as inter-AS VPN.</p>
<div class="context"><a name="EN-US_TASK_0000001844948629__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0000001844948629__fig-dc_vrp_sr_all_cfg_004001">Figure 1</a>, PE1 and ASBR1 reside in AS 100, PE2 and ASBR2 reside in AS 200, and ASBR1 and ASBR2 are directly connected through a physical link. A bidirectional E2E SR-MPLS TE Policy needs to be established between PE1 and PE2, with SR being used for path generation and data forwarding. In the PE1-to-PE2 direction, PE1 and PE2 are the ingress and egress of the path, respectively. In the PE2-to-PE1 direction, PE2 and PE1 are the ingress and egress of the path, respectively.</p>
<div class="fignone" id="EN-US_TASK_0000001844948629__fig-dc_vrp_sr_all_cfg_004001"><a name="EN-US_TASK_0000001844948629__fig-dc_vrp_sr_all_cfg_004001"></a><a name="fig-dc_vrp_sr_all_cfg_004001"></a><span class="figcap"><b>Figure 1 </b>E2E SR-MPLS TE Policy networking</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 and interface2 represent GE<span>0/1/0</span> and GE<span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="imgResize" src="figure/en-us_image_0000001844868557.png" width="494.9360419589579" title="Click to enlarge"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001844948629__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure intra-AS Adjacency SIDs in AS 100 and AS 200.</p>
</li><li><p>Establish an EBGP peer relationship between ASBR1 and ASBR2, enable BGP EPE and BGP-LS, and configure the devices to generate BGP Peer Adjacency SIDs. Note that you only need to enable the address family for BGP-LS, without having to enable the BGP peer relationship in the address family.</p>
</li><li><p>Deploy an E2E SR-MPLS TE Policy between PE1 and PE2, specifying elements such as the endpoint and color and adopting explicit paths for path computation.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001844948629__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Interface IP addresses shown in <a href="#EN-US_TASK_0000001844948629__fig-dc_vrp_sr_all_cfg_004001">Figure 1</a></p>
</li><li><p>IS-IS process ID: 1; IS-IS level: Level-2; IS-IS system IDs of nodes: 10.0000.0000.0001.00, 10.0000.0000.0002.00, 10.0000.0000.0003.00, and 10.0000.0000.0004.00</p>
</li><li><p>AS number for PE1 and ASBR1: 100; AS number for PE2 and ASBR2: 200</p>
</li><li><p>Name of the E2E SR-MPLS TE Policy from PE1 to PE2: Policy1 (with the segment list pe1); name of the E2E SR-MPLS TE Policy from PE2 to PE1: Policy1 (with the segment list pe2)</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001844948629__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure IP addresses for interfaces.</span><p><p># Configure PE1.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-LoopBack1] <strong>ip address 1.1.1.1 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-LoopBack1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>ip address 10.0.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure ASBR1.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname ASBR1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR1] <strong>interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-LoopBack1] <strong>ip address 2.2.2.2 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-LoopBack1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1]<strong> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-GigabitEthernet<span>0/1/0</span>] <strong>ip address 10.1.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1]<strong> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-GigabitEthernet<span>0/2/0</span>] <strong>ip address 10.0.1.2 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1] <strong>commit</strong></pre>
<p># Configure ASBR2.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname ASBR2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR2] <strong>interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-LoopBack1] <strong>ip address 3.3.3.3 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-LoopBack1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2]<strong> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-GigabitEthernet<span>0/1/0</span>] <strong>ip address 10.1.1.2 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2]<strong> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-GigabitEthernet<span>0/2/0</span>] <strong>ip address 10.9.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-LoopBack1] <strong>ip address 4.4.4.4 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-LoopBack1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> interface gigabitethernet</strong><strong><span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>]<strong> ip address 10.9.1.2 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
</p></li><li><span>Configure IGP route interworking in AS 100 and AS 200. This example uses IS-IS.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>is-level level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>network-entity 10.0000.0000.0001.00</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>traffic-eng level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-LoopBack1] <strong>isis enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-LoopBack1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>isis enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure ASBR1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR1] <strong>isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-isis-1] <strong>is-level level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-isis-1] <strong>network-entity 10.0000.0000.0002.00</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-isis-1] <strong>cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-isis-1] <strong>traffic-eng level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-isis-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1] <strong>interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-LoopBack1] <strong>isis enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-LoopBack1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1]<strong> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-GigabitEthernet<span>0/2/0</span>] <strong>isis enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1] <strong>commit</strong></pre>
</p><p><p># Configure ASBR2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR2] <strong>isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-isis-1] <strong>is-level level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-isis-1] <strong>network-entity 10.0000.0000.0003.00</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-isis-1] <strong>cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-isis-1] <strong>traffic-eng level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-isis-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2] <strong>interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-LoopBack1] <strong>isis enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-LoopBack1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2]<strong> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-GigabitEthernet<span>0/2/0</span>] <strong>isis enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>is-level level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>network-entity 10.0000.0000.0004.00</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>cost-style wide</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>traffic-eng level-2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-LoopBack1] <strong>isis enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-LoopBack1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>isis enable 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</p></li><li><span>Enable basic MPLS functions in AS 100 and AS 200.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> mpls lsr-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure ASBR1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR1]<strong> mpls lsr-id 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1]<strong> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-GigabitEthernet<span>0/2/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-GigabitEthernet<span>0/2/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1] <strong>commit</strong></pre>
</p><p><p># Configure ASBR2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR2]<strong> mpls lsr-id 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2]<strong> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-GigabitEthernet<span>0/2/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-GigabitEthernet<span>0/2/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> mpls lsr-id 4.4.4.4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</p></li><li><span>Enable Segment Routing and configure Adjacency SIDs in AS 100 and AS 200.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> segment-routing</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-segment-routing] <strong>ipv4 adjacency local-ip-addr 10.0.1.1 remote-ip-addr 10.0.1.2 sid 330122</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-segment-routing]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>segment-routing mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-isis-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure ASBR1.</p>
<pre class="screen">[<span class="keyword">*</span>ASBR1]<strong> segment-routing</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-segment-routing] <strong>ipv4 adjacency local-ip-addr 10.0.1.2 remote-ip-addr 10.0.1.1 sid 330222</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-segment-routing]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1] <strong>isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-isis-1] <strong>segment-routing mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-isis-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1] <strong>commit</strong></pre>
<p># Configure ASBR2.</p>
<pre class="screen">[<span class="keyword">*</span>ASBR2]<strong> segment-routing</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-segment-routing] <strong>ipv4 adjacency local-ip-addr 10.9.1.1 remote-ip-addr 10.9.1.2 sid 330120</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-segment-routing]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2] <strong>isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-isis-1] <strong>segment-routing mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-isis-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> segment-routing</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-segment-routing] <strong>ipv4 adjacency local-ip-addr 10.9.1.2 remote-ip-addr 10.9.1.1 sid 330220</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-segment-routing]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>segment-routing mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-isis-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</p></li><li><span>Configure MPLS TE on the ASBRs.</span><p><p># Configure ASBR1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR1]<strong> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR1-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1] <strong>commit</strong></pre>
</p><p><p># Configure ASBR2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR2]<strong> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR2-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2] <strong>commit</strong></pre>
</p></li><li><span>Establish an EBGP peer relationship between the ASBRs and enable BGP EPE and BGP-LS.</span><p><p>In this example, a loopback interface is used to establish a multi-hop EBGP peer relationship. Before the configuration, ensure that the loopback interfaces of ASBR1 and ASBR2 are routable to each other.</p>
<p>Currently, BGP EPE supports only EBGP peers. For multi-hop EBGP peers, they must be directly connected through physical links. If intermediate nodes exist, the nodes do not have BGP Peer SID information, causing a forwarding failure.</p>
<p># Configure ASBR1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR1] <strong>ip route-static 3.3.3.3 32 gigabitethernet<span>0/1/0</span> 10.1.1.2 description asbr1toasbr2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-bgp] <strong>peer 3.3.3.3 as-number 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-bgp] <strong>peer 3.3.3.3 connect-interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-bgp] <strong>peer 3.3.3.3 ebgp-max-hop 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-bgp] <strong>peer 3.3.3.3 egress-engineering</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-bgp] <strong>link-state-family unicast</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-bgp-af-ls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-bgp] <strong>ipv4-family unicast</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-bgp-af-ipv4] <strong>network 2.2.2.2 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-bgp-af-ipv4] <strong>network 10.1.1.0 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-bgp-af-ipv4] <strong>import-route isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR1-bgp-af-ipv4] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR1-bgp-af-ipv4] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR1-bgp] <strong>quit</strong></pre>
<p># Configure ASBR2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR2] <strong>ip route-static 2.2.2.2 32 gigabitethernet<span>0/1/0</span> 10.1.1.1 description asbr2toasbr1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2] <strong>bgp 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-bgp] <strong>peer 2.2.2.2 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-bgp] <strong>peer 2.2.2.2 connect-interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-bgp] <strong>peer 2.2.2.2 ebgp-max-hop 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-bgp] <strong>peer 2.2.2.2 egress-engineering</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-bgp] <strong>link-state-family unicast</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-bgp-af-ls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-bgp] <strong>ipv4-family unicast</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-bgp-af-ipv4] <strong>network 3.3.3.3 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-bgp-af-ipv4] <strong>network 10.1.1.0 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-bgp-af-ipv4] <strong>import-route isis 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR2-bgp-af-ipv4] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR2-bgp-af-ipv4] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR2-bgp] <strong>quit</strong></pre>
<p>After completing the configuration, run the <a href="cmdqueryname=display+bgp+egress-engineering"><b><span class="cmdname">display bgp egress-engineering</span></b></a> command to check BGP EPE information. For example:</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR1] <strong>display bgp egress-engineering</strong>
 Peer Node                : 3.3.3.3
 Peer Adj Num             : 1
 Local ASN                : 100
 Remote ASN               : 200
 Local Router Id          : 2.2.2.2
 Remote Router Id         : 3.3.3.3
 Local Interface Address  : 2.2.2.2
 Remote Interface Address : 3.3.3.3
 SID Label                : <strong>31768</strong>
<span> Peer Set SID Label       : --</span>
 Nexthop                  : 10.1.1.2
 Out Interface            : GigabitEthernet<span>0/1/0</span>

 Peer Adj                 : 10.1.1.2
 Local ASN                : 100
 Remote ASN               : 200
 Local Router Id          : 2.2.2.2
 Remote Router Id         : 3.3.3.3
 Interface Identifier     : 6
 Local Interface Address  : 10.1.1.1
 Remote Interface Address : 10.1.1.2
 SID Label                : <strong>31770</strong>
 Nexthop                  : 10.1.1.2
 Out Interface            : GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR2] <strong>display bgp egress-engineering</strong>
 Peer Node                : 2.2.2.2
 Peer Adj Num             : 1
 Local ASN                : 200
 Remote ASN               : 100
 Local Router Id          : 3.3.3.3
 Remote Router Id         : 2.2.2.2
 Local Interface Address  : 3.3.3.3
 Remote Interface Address : 2.2.2.2
 SID Label                : <strong>32768</strong>
<span> Peer Set SID Label       : --</span>
 Nexthop                  : 10.1.1.1
 Out Interface            : GigabitEthernet<span>0/1/0</span>

 Peer Adj                 : 10.1.1.1
 Local ASN                : 200
 Remote ASN               : 100
 Local Router Id          : 3.3.3.3
 Remote Router Id         : 2.2.2.2
 Interface Identifier     : 6
 Local Interface Address  : 10.1.1.2
 Remote Interface Address : 10.1.1.1
 SID Label                : <strong>32770</strong>
 Nexthop                  : 10.1.1.1
 Out Interface            : GigabitEthernet<span>0/1/0</span></pre>
</p></li><li><span>Deploy an SR-MPLS TE Policy between PE1 and PE2.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>segment-routing</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-segment-routing] <strong>segment-list pe1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-segment-routing-segment-list-pe1] <strong>index 10 sid label 330122</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-segment-routing-segment-list-pe1] <strong>index 20 sid label 31770</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-segment-routing-segment-list-pe1] <strong>index 30 sid label 330120</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-segment-routing-segment-list-pe1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-segment-routing] <strong>sr-te policy policy1 endpoint 4.4.4.4 color 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-segment-routing-te-policy-policy1] <strong>candidate-path preference 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-segment-routing-te-policy-policy1-path] <strong>segment-list pe1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-segment-routing-te-policy-policy1-path] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-segment-routing-te-policy-policy1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-segment-routing] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>segment-routing</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-segment-routing] <strong>segment-list pe2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-segment-routing-segment-list-pe2] <strong>index 10 sid label 330220</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-segment-routing-segment-list-pe2] <strong>index 20 sid label 32770</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-segment-routing-segment-list-pe2] <strong>index 30 sid label 330222</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-segment-routing-segment-list-pe2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-segment-routing] <strong>sr-te policy policy1 endpoint 1.1.1.1 color 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-segment-routing-te-policy-policy1] <strong>candidate-path preference 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-segment-routing-te-policy-policy1-path] <strong>segment-list pe2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-segment-routing-te-policy-policy1-path] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-segment-routing-te-policy-policy1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-segment-routing] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p>After completing the configuration, run the <strong>display sr-te policy</strong> command to check SR-MPLS TE Policy information.</p>
<p>The following example uses the command output on PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display sr-te policy</strong>
PolicyName : policy1
Endpoint             : 4.4.4.4                        Color                : 100
TunnelId             : 1                              TunnelType           : SR-TE Policy
Binding SID          : -                              MTU                  : -
Policy State         : Up                             State Change Time    : 2024-01-24 09:29:47
Admin State          : Up                             Traffic Statistics   : Disable
BFD                  : Disable                        Backup Hot-Standby   : Disable
DiffServ-Mode        : -
Active IGP Metric    : -
Candidate-path Count : 1
 
Candidate-path Preference: 100
Policy Name          : policy1
Candidate-path Name  :
Path State           : Active                         Path Type            : Primary
Protocol-Origin      : Configuration(30)              Originator           : 0, 0.0.0.0
Discriminator        : 100                            Binding SID          : -
GroupId              : 1                              Compute Source       : -
Template ID          : -                              CT0 Bandwidth        : -
Active IGP Metric    : -                              ODN Color            : -
Metric               :
 IGP Metric          : -                              TE Metric            : -
 Delay Metric        : -                              Hop Counts           : -
Segment-List Count   : 1
 Segment-List        : pe1
  Segment-List ID    : 2                              XcIndex              : 2000002
  List State         : Up                             BFD State            : -
  EXP                : 0                              TTL                  : 255
  DeleteTimerRemain  : -                              Weight               : 1
  Metric             :
   IGP Metric        : -                              TE Metric            : -
   Delay Metric      : -                              Hop Counts           : -
  Label : 330122, 31770, 330120</pre>
</p></li><li><span>Verify the configuration.</span><p><p>After completing the configuration, perform a ping operation on the SR-MPLS TE Policy to check its connectivity.</p>
<p>The following example uses the command output on PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>ping lsp sr-te policy policy-name policy1</strong>  
 LSP PING FEC:  Nil FEC  : 100 data bytes, press CTRL_C to break  
 sr-te policy's segment list:  
 Preference : 100; Path Type: main; Protocol-Origin : local; Originator: 0, 0.0.0.0; Discriminator: 100; Segment-List ID : 1;  Xcindex : 1  
   Reply from 4.4.4.4: bytes=100 Sequence=1 time=13 ms  
   Reply from 4.4.4.4: bytes=100 Sequence=2 time=9 ms   
   Reply from 4.4.4.4: bytes=100 Sequence=3 time=2 ms     
   Reply from 4.4.4.4: bytes=100 Sequence=4 time=3 ms    
   Reply from 4.4.4.4: bytes=100 Sequence=5 time=6 ms 

 --- FEC: Nil FEC ping statistics ---   
   5 packet(s) transmitted         
   5 packet(s) received        
   0.00% packet loss        
   round-trip min/avg/max = 2/6/13 ms</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001844948629__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#
sysname PE1
#
mpls lsr-id 1.1.1.1
#
mpls
 mpls te
#               
segment-routing 
 ipv4 adjacency local-ip-addr 10.0.1.1 remote-ip-addr 10.0.1.2 sid 330122
 segment-list pe1
  index 10 sid label 330122
  index 20 sid label 31770
  index 30 sid label 330120
 sr-te policy policy1 endpoint 4.4.4.4 color 100
  candidate-path preference 100
   segment-list pe1
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 10.0000.0000.0001.00
 traffic-eng level-2
 segment-routing mpls
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.0.1.1 255.255.255.0
 isis enable 1  
 mpls
 mpls te
#
interface LoopBack1
 ip address 1.1.1.1 255.255.255.255
 isis enable 1
#
return</pre>
</li><li><p>ASBR1 configuration file</p>
<pre class="screen">#
sysname ASBR1
#
mpls lsr-id 2.2.2.2
#
mpls
 mpls te
#               
segment-routing 
 ipv4 adjacency local-ip-addr 10.0.1.2 remote-ip-addr 10.0.1.1 sid 330222
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 10.0000.0000.0002.00
 traffic-eng level-2
 segment-routing mpls
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.1.1.1 255.255.255.0
 mpls
 mpls te
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown  
 ip address 10.0.1.2 255.255.255.0
 isis enable 1  
 mpls
 mpls te
#
interface LoopBack1
 ip address 2.2.2.2 255.255.255.255
 isis enable 1
#
bgp 100
 private-4-byte-as enable 
 peer 3.3.3.3 as-number 200
 peer 3.3.3.3 ebgp-max-hop 2
 peer 3.3.3.3 connect-interface LoopBack1
 peer 3.3.3.3 egress-engineering
 #
 ipv4-family unicast
  network 2.2.2.2 255.255.255.255
  network 10.1.1.0 255.255.255.0
  import-route isis 1
  peer 3.3.3.3 enable
 #
 link-state-family unicast
#
ip route-static 3.3.3.3 255.255.255.255 gigabitethernet<span>0/1/0</span> 10.1.1.2 description asbr1toasbr2
#
return</pre>
</li><li><p>ASBR2 configuration file</p>
<pre class="screen">#
sysname ASBR2
#
mpls lsr-id 3.3.3.3
#
mpls
 mpls te
#               
segment-routing 
 ipv4 adjacency local-ip-addr 10.9.1.1 remote-ip-addr 10.9.1.2 sid 330120
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 10.0000.0000.0003.00
 traffic-eng level-2
 segment-routing mpls
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.1.1.2 255.255.255.0
 mpls
 mpls te
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown  
 ip address 10.9.1.1 255.255.255.0
 isis enable 1  
 mpls
 mpls te
#
interface LoopBack1
 ip address 3.3.3.3 255.255.255.255
 isis enable 1
#
bgp 200
 private-4-byte-as enable 
 peer 2.2.2.2 as-number 100
 peer 2.2.2.2 ebgp-max-hop 2
 peer 2.2.2.2 connect-interface LoopBack 1
 peer 2.2.2.2 egress-engineering
 #
 ipv4-family unicast
  network 3.3.3.3 255.255.255.255
  network 10.1.1.0 255.255.255.0
  import-route isis 1
  peer 2.2.2.2 enable
 #
 link-state-family unicast
#
ip route-static 2.2.2.2 255.255.255.255 gigabitethernet<span>0/1/0</span> 10.1.1.1 description asbr2toasbr1
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2
#
mpls lsr-id 4.4.4.4
#
mpls
 mpls te
#               
segment-routing 
 ipv4 adjacency local-ip-addr 10.9.1.2 remote-ip-addr 10.9.1.1 sid 330220
 segment-list pe2
  index 10 sid label 330220
  index 20 sid label 32770
  index 30 sid label 330222
 sr-te policy policy1 endpoint 1.1.1.1 color 100
  candidate-path preference 100
   segment-list pe2
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 10.0000.0000.0004.00
 traffic-eng level-2
 segment-routing mpls
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.9.1.2 255.255.255.0
 isis enable 1  
 mpls
 mpls te
#
interface LoopBack1
 ip address 4.4.4.4 255.255.255.255
 isis enable 1
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0099.html">Configuration Examples for SR-MPLS TE Policy
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0403.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>

<script language="JavaScript">
<!--
image_size('.imgResize');
var msg_imageMax = "view original image";
var msg_imageClose = "close";
//--></script></body>
</html>