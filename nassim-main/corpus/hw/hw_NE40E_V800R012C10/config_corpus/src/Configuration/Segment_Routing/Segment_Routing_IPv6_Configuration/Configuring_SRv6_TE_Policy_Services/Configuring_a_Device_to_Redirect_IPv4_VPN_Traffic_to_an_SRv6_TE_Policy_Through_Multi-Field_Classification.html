
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a Device to Redirect IPv4 VPN Traffic to an SRv6 TE Policy Through Multi-Field Classification">
<meta name="abstract" content="The redirection function can be used to steer IPv4 VPN traffic to an SRv6 TE Policy.">
<meta name="description" content="The redirection function can be used to steer IPv4 VPN traffic to an SRv6 TE Policy.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0131.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0232.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0235.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00587852">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00587852">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0258390233">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a Device to Redirect IPv4 VPN Traffic to an SRv6 TE Policy Through Multi-Field Classification</title>
</head>
<body><a name="EN-US_TASK_0258390233"></a><a name="EN-US_TASK_0258390233"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a Device to Redirect IPv4 VPN Traffic to an SRv6 TE Policy Through Multi-Field Classification</h1>
<div class="taskbody"><p>The redirection function can be used to steer IPv4 VPN traffic to an SRv6 TE Policy.</p>
<div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0258390233__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before configuring a device to redirect IPv4 VPN traffic to an SRv6 TE Policy through multi-field classification, complete either of the following tasks:</p>
<ul><li><a href="dc_vrp_srv6_cfg_all_0116.html">Configure an SRv6 TE Policy in controller-based dynamic delivery mode.</a></li><li><a href="dc_vrp_srv6_cfg_all_0110.html">Configure an SRv6 TE Policy in manual configuration mode.</a></li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0258390233__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>If some IPv4 VPN traffic experiences congestion, QoS multi-field classification can be used to identify and redirect the traffic to an SRv6 TE Policy, resolving the congestion issue. The factors involved in the redirection are an endpoint, color, and SID. If a redirection rule match fails, multi-field classification does not take effect. In this case, the traffic is forwarded over common IP. If the SRv6 TE Policy fails, multi-field classification also fails. In this case, the traffic is also forwarded over common IP.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0258390233__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=traffic+classifier"><b><span class="cmdname">traffic classifier</span></b></a> <i><span class="varname">classifier-name</span></i> [ <strong><span>operator</span></strong> { <strong><span>and</span></strong> | <strong><span>or</span></strong> } ]</span><p><p>A traffic classifier is defined and its view is displayed.</p>
</p></li><li><span>Configure <strong>if-match</strong> clauses to define matching conditions for IPv4 VPN traffic.</span><p><p>For details, see <a href="../ne/dc_ne_qos_cfg_0042.html">Configuring a Traffic Classifier</a>.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the traffic classifier view.</p>
</p></li><li><span>Run <a href="cmdqueryname=traffic+behavior"><b><span class="cmdname">traffic behavior</span></b></a> <i><span class="varname">behavior-name</span></i></span><p><p>A traffic behavior is defined and its view is displayed.</p>
</p></li><li><span>Perform either of the following operations to redirect IPv4 VPN traffic to an SRv6 TE Policy:</span><ul><li>Run the <a href="cmdqueryname=redirect+srv6-te+policy"><b><span class="cmdname">redirect srv6-te policy</span></b></a> <i><span class="varname">endpoint</span></i> <i><span class="varname">color </span></i><strong><span>vpnsid</span></strong> <i><span class="varname">sid-ip</span></i> command to redirect IPv4 VPN traffic to a single SRv6 TE Policy.</li></ul>
<p><ul><li>Run the <a href="cmdqueryname=redirect-template+srv6-te"><b><span class="cmdname">redirect-template srv6-te</span></b></a><strong> </strong><em>template-name</em> command to redirect IPv4 VPN traffic to a group of SRv6 TE Policies.<div class="p">Before performing this operation, you need to run the following commands in the system view to create an SRv6 TE Policy redirection template and specify an SRv6 TE Policy:<ol type="a"><li>Run the <a href="cmdqueryname=redirect+template"><b><span class="cmdname">redirect template</span></b></a><strong> </strong><em>template-name </em><strong>srv6-te</strong> command to create an SRv6 TE Policy redirection template and enter the template view.</li><li>Run the <strong>endpoint</strong><em> endpoint</em> <strong>color</strong> <em>color</em> <strong>vpnsid</strong> <em>sid-ip</em> command to redirect IPv4 VPN traffic to an SRv6 TE Policy.<p>This step can be performed multiple times.</p>
</li></ol>
</div>
</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>You can specify the <strong><span>vpnsid</span></strong> parameter to redirect IPv4 VPN traffic to an IPv4 VPN.</p>
<p>The value of <i><span class="varname">sid-ip</span></i> must be an End.DT4 SID, which is configured using the <a href="cmdqueryname=opcode"><b><span class="cmdname">opcode</span></b></a> <i><span class="varname">func-opcode</span></i> <strong><span>end-dt4</span></strong> <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> or <a href="cmdqueryname=opcode"><b><span class="cmdname">opcode</span></b></a> <i><span class="varname">func-opcode</span></i> <strong><span>end-dt46</span></strong> <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> command.</p>
<p>In scenarios where IPv4 VPN traffic is redirected to an SRv6 TE Policy, to set a hop limit for IPv6 packets for which a node performs IPv6 encapsulation, run the <a href="cmdqueryname=ttl-mode"><b><span class="cmdname">ttl-mode</span></b></a> { <strong><span>pipe</span></strong> | <strong><span>uniform</span></strong> } command in the VPN instance IPv4 address family view or the VPN instance view. By default, the <strong><span>pipe</span></strong> mode is used.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the traffic behavior view.</p>
</p></li><li><span>Run <a href="cmdqueryname=traffic+policy"><b><span class="cmdname">traffic policy</span></b></a> <i><span class="varname">policy-name</span></i></span><p><p>A traffic policy is defined and its view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=classifier"><b><span class="cmdname">classifier</span></b></a> <i><span class="varname">classifier-name</span></i> <strong><span>behavior</span></strong> <i><span class="varname">behavior-name</span></i></span><p><p>The traffic behavior is specified for the traffic classifier in the traffic policy.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the traffic policy view.</p>
</p></li><li><span>Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></span><p><p>A VPN instance is created, and the VPN instance view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a></span><p><p>The VPN instance IPv4 address family is enabled, and the view of this address family is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=route-distinguisher"><b><span class="cmdname">route-distinguisher</span></b></a> <i><span class="varname">route-distinguisher</span></i></span><p><p>An RD is configured for the VPN instance IPv4 address family.</p>
<p>A VPN instance IPv4 address family takes effect only after being configured with an RD.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the VPN instance IPv4 address family view.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the VPN instance view.</p>
</p></li><li><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> [ <i><span class="varname">.subinterface-number</span></i> ]</span><p><p>The interface view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=ip+binding+vpn-instance"><b><span class="cmdname">ip binding vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></span><p><p>The VPN instance is bound to the interface.</p>
<p>The value of <i><span class="varname">vpn-instance-name</span></i> must be the same as the name of the VPN instance created using the <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i> command.</p>
</p></li><li><span>Run <a href="cmdqueryname=traffic-policy"><b><span class="cmdname">traffic-policy</span></b></a> <i><span class="varname">policy-name</span></i> <strong><span>inbound</span></strong></span><p><p>The traffic policy is applied to the interface.</p>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0258390233__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After configuring the device to redirect IPv4 VPN traffic to an SRv6 TE Policy through multi-field classification, perform the following operations to verify the configuration:</p>
<ul><li>Run the <a href="cmdqueryname=display+traffic+classifier"><b><span class="cmdname">display traffic classifier</span></b></a> { <strong><span>system-defined</span></strong> | <strong><span>user-defined</span></strong> } [ <i><span class="varname">classifier-name</span></i> ] command to check the traffic classifier configuration.</li><li>Run the <a href="cmdqueryname=display+traffic+behavior"><b><span class="cmdname">display traffic behavior</span></b></a> <strong><span>user-defined</span></strong> [ <i><span class="varname">behavior-name</span></i> ] command to check the traffic behavior configuration.</li><li>Run the <a href="cmdqueryname=display+traffic+policy"><b><span class="cmdname">display traffic policy</span></b></a> <strong><span>user-defined</span></strong> [ <i><span class="varname">policy-name</span></i> [ <strong><span>classifier</span></strong> <i><span class="varname">classifier-name</span></i> ] ] command to check the associations between all traffic classifiers and traffic behaviors or between specified ones in the traffic policy.</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0131.html">Configuring SRv6 TE Policy Services
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0232.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0235.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>