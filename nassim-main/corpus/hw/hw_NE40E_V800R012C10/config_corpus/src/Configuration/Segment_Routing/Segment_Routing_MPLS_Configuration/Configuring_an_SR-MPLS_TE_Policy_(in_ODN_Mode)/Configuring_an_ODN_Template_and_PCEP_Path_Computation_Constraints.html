
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring an ODN Template and PCEP Path Computation Constraints">
<meta name="abstract" content="The on-demand next hop (ODN) function does not require a large number of SR-MPLS TE Policies to be configured in advance. Instead, it enables SR-MPLS TE Policy creation to be dynamically triggered on demand based on service routes, simplifying network operations.">
<meta name="description" content="The on-demand next hop (ODN) function does not require a large number of SR-MPLS TE Policies to be configured in advance. Instead, it enables SR-MPLS TE Policy creation to be dynamically triggered on demand based on service routes, simplifying network operations.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0400.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0063c.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0402.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909,l00587852">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00468467">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00468467">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001478326564">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring an ODN Template and PCEP Path Computation Constraints</title>
</head>
<body><a name="EN-US_TASK_0000001478326564"></a><a name="EN-US_TASK_0000001478326564"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring an ODN Template and PCEP Path Computation Constraints</h1>
<div class="taskbody"><p>The on-demand next hop (ODN) function does not require a large number of SR-MPLS TE Policies to be configured in advance. Instead, it enables SR-MPLS TE Policy creation to be dynamically triggered on demand based on service routes, simplifying network operations.</p>
<div class="context"><a name="EN-US_TASK_0000001478326564__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>During SR-MPLS TE Policy creation, you can select a pre-configured attribute template and constraint template to ensure that the to-be-created SR-MPLS TE Policy meets service requirements. During SR-MPLS TE Policy constraint configuration, you can apply a global constraint template or apply a specific constraint template to a candidate path of the SR-MPLS TE Policy. If both templates are applied, the template applied to the candidate path of the SR-MPLS TE Policy takes precedence.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001478326564__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure an SR-MPLS TE Policy attribute template.</span><ol type="a"><li><span>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</span></li><li><span>Run the <a href="cmdqueryname=segment-routing+policy-template"><b><span class="cmdname">segment-routing policy-template</span></b></a> <i><span class="varname">template-value</span></i> command to create an SR Policy attribute template and enter the SR Policy template view.</span></li><li><span>(Optional) Run the <a href="cmdqueryname=description"><b><span class="cmdname">description</span></b></a><strong> </strong><em>description-value</em> command to configure a description for the attribute template.</span></li><li><span>Run the <a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a><strong> </strong><strong>seamless</strong> <strong>enable</strong> command to enable the BFD function in the attribute template.</span></li><li><span>Run the <a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a><strong> </strong><strong>bypass</strong> command to enable the BFD bypass function in the attribute template.</span></li><li><span>Run the <a href="cmdqueryname=backup+hot-standby"><b><span class="cmdname">backup hot-standby</span></b></a><strong> </strong>{ <strong>enable</strong> | <strong>disable</strong> } command to enable or disable the hot-standby function in the attribute template.</span></li><li><span>Run the <a href="cmdqueryname=traffic-statistics"><b><span class="cmdname">traffic-statistics</span></b></a><strong> </strong>{ <strong>enable</strong> | <strong>disable</strong> } command to enable or disable the traffic statistics collection function in the attribute template.</span></li><li><span>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</span></li><li><span>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</span></li></ol>
</li><li><span>Configure an SR-MPLS TE Policy constraint template.</span><p><ol type="a"><li>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</li><li>Run the <a href="cmdqueryname=segment-routing+policy+constraint-template"><b><span class="cmdname">segment-routing policy constraint-template</span></b></a><strong> </strong><em>constraintName</em> command to create an SR-MPLS TE Policy constraint template and enter the constraint template view.</li><li>Run the <a href="cmdqueryname=priority"><b><span class="cmdname">priority</span></b></a><strong> </strong><em>setup-priority </em><em>hold-priority</em> command to configure the path setup priority and hold priority in the constraint template.</li><li>Run the <a href="cmdqueryname=affinity%EF%BC%88SR+Policy%E7%BA%A6%E6%9D%9F%E6%A8%A1%E6%9D%BF%E8%A7%86%E5%9B%BE%EF%BC%89"><b><span class="cmdname">affinity</span></b></a><strong> </strong>{ <strong>include-all</strong> | <strong>include-any</strong> | <strong>exclude</strong> } { <em>affinity-name</em> } &amp;&lt;1-32&gt; command to configure affinity constraints in the constraint template.</li><li>Run the <a href="cmdqueryname=bandwidth+ct0"><b><span class="cmdname">bandwidth ct0</span></b></a><strong> </strong><em>bandwidth-value</em> command to configure a bandwidth constraint in the constraint template.</li><li>Run the <a href="cmdqueryname=constraint-path"><b><span class="cmdname">constraint-path</span></b></a><strong> </strong><em>constraint-path-name</em> command to configure a path constraint in the constraint template.<div class="p">The path constraint specified using the <em>constraint-path-name</em> parameter is the one configured using the <a href="cmdqueryname=segment-routing+policy+constraint-path"><b><span class="cmdname">segment-routing policy constraint-path </span></b></a><em>path-name</em> command. As such, the value of this parameter is the same as that of the <em>path-name</em> parameter. To configure the <em>constraint-path-name</em> parameter, perform the following steps:<ol class="substepthirdol"><li>Run the <strong><a href="cmdqueryname=segment-routing+policy+constraint-path"><b><span class="cmdname">segment-routing policy constraint-path</span></b></a> </strong><em>path-name</em> command to create an SR-MPLS TE Policy path constraint and enter the path constraint view.</li><li>Run the <a href="cmdqueryname=index+address+ipv4"><b><span class="cmdname">index</span></b></a><strong> </strong><em>index-value</em><strong> </strong><strong><span>address</span></strong> <strong><span>ipv4</span></strong><em> ipv4-address</em> [ <strong>include</strong> [ <strong>strict</strong> | <strong>loose</strong> ] | <strong>exclude</strong> ] command to specify the next-hop IP address in the path constraint.</li></ol>
</div>
</li><li>Run the <a href="cmdqueryname=link-bandwidth+utilization"><b><span class="cmdname">link-bandwidth utilization</span></b></a><strong> </strong><em>utilization-value</em> command to configure bandwidth usage in the constraint template.</li><li>Run the <a href="cmdqueryname=metric-type"><b><span class="cmdname">metric-type</span></b></a><strong> </strong>{ <strong>igp</strong> | <strong>te</strong> | <strong>delay</strong> | <strong>hop-count</strong> } command to configure a metric type in the constraint template.<p>After completing the configuration, run the following commands to configure the corresponding constraint values:</p>
<ul><li>Run the <a href="cmdqueryname=max-cumulation"><b><span class="cmdname">max-cumulation</span></b></a> <strong><span>igp</span></strong><strong> </strong><em>max-igp-cost</em> command to configure the maximum IGP cost in the constraint template.</li><li>Run the <a href="cmdqueryname=max-cumulation+te"><b><span class="cmdname">max-cumulation te</span></b></a><strong> </strong><em>max-te-cost</em> command to configure the maximum TE cost in the constraint template.</li><li>Run the <a href="cmdqueryname=max-cumulation+delay"><b><span class="cmdname">max-cumulation delay</span></b></a><strong> </strong><em>max-delay</em> command to configure the maximum delay in the constraint template.</li><li>Run the <a href="cmdqueryname=max-cumulation+hop-count"><b><span class="cmdname">max-cumulation hop-count</span></b></a><strong> </strong><em>max-hop-count</em> command to configure the maximum number of hops in the constraint template.</li></ul>
</li><li>(Optional) Run the <a href="cmdqueryname=sid+selection"><b><span class="cmdname">sid selection</span></b></a><strong> </strong>{ <strong><span>unprotected-preferred</span></strong> | <strong><span>protected-preferred</span></strong> | <strong><span>unprotected-only</span></strong> | <strong><span>protected-only</span></strong> } command to configure a SID selection rule in the constraint template.<p>The default SID selection rule in the constraint template is unprotected-SID-preferred (<strong><span>unprotected-preferred</span></strong>).</p>
</li><li>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</li><li>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</li></ol>
</p></li><li><span>Configure an ODN template.</span><ol type="a"><li class="substepexpand"><span>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</span></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=segment-routing"><b><span class="cmdname">segment-routing</span></b></a> command to enable SR globally and enter the Segment Routing view.</span></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=on-demand+color"><b><span class="cmdname">on-demand color</span></b></a><strong> </strong><em>colorValue</em> command to create an SR-MPLS TE Policy ODN template and enter the SR-MPLS TE Policy ODN view.</span></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=dynamic-computation-seq"><b><span class="cmdname">dynamic-computation-seq</span></b></a><strong> </strong>{ <strong>pcep</strong> } <sup>*</sup> command to set the dynamic path computation mode to PCEP.</span></li><li class="substepexpand"><span>(Optional) Run the <strong>restrict ip-prefix </strong><em>prefixName</em> command to specify the IP address prefix list to be referenced by the ODN template.</span><p><p>When SR-MPLS TE Policies are generated based on an SR-MPLS TE Policy ODN template, an IP address prefix list can be used to filter BGP routes.</p>
</p></li><li class="substepexpand"><span>(Optional) Run the <a href="cmdqueryname=attribute-template"><b><span class="cmdname">attribute-template</span></b></a><strong> </strong><em>attributeId</em> command to configure the ODN template to reference the SR-MPLS TE Policy attribute template.</span><p><p>The template specified using the <em>attributeId</em> parameter is the one created using the <a href="cmdqueryname=segment-routing+policy-template"><b><span class="cmdname">segment-routing policy-template</span></b></a> <i><span class="varname">template-value</span></i> command. As such, the value of this parameter is the same as that of the <i><span class="varname">template-value</span></i> parameter.</p>
</p></li><li class="substepexpand"><span>(Optional) Run the <a href="cmdqueryname=constraint-template"><b><span class="cmdname">constraint-template</span></b></a><strong> </strong><em>constraintName</em> command to configure the ODN template to reference the SR-MPLS TE Policy constraint template.</span><p><p>The template specified using the <em>constraintName</em> parameter is the one created using the <a href="cmdqueryname=segment-routing+policy+constraint-template"><b><span class="cmdname">segment-routing policy constraint-template</span></b></a><strong> </strong><em>constraintName</em> command.</p>
</p></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=candidate-path+preference"><b><span class="cmdname">candidate-path preference</span></b></a> <em>pref-value</em> command to configure a candidate path for the SR-MPLS TE Policy and specify a preference value for the path.</span><p><p>Each SR-MPLS TE Policy supports multiple candidate paths. A larger <em>pref-value</em> indicates a higher candidate path preference. If multiple candidate paths are configured, the one with the highest preference takes effect.</p>
</p></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=affinity"><b><span class="cmdname">affinity</span></b></a><strong> </strong>{ <strong>include-all</strong> | <strong>include-any</strong> | <strong>exclude</strong> } { <em>affinity-name</em> } &amp;&lt;1-32&gt; command to configure an affinity constraint for the candidate path.</span></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=constraint-path"><b><span class="cmdname">constraint-path</span></b></a><strong> </strong><em>constraint-path-name</em> command to configure a path constraint for the candidate path.</span><p><div class="p">The path constraint specified using the <em>constraint-path-name</em> parameter is the one configured using the <a href="cmdqueryname=segment-routing+policy+constraint-path"><b><span class="cmdname">segment-routing policy constraint-path </span></b></a><em>path-name</em> command. As such, the value of this parameter is the same as that of the <em>path-name</em> parameter. To configure the <em>constraint-path-name</em> parameter, perform the following steps:<ol class="substepthirdol"><li>Run the <a href="cmdqueryname=return"><b><span class="cmdname">return</span></b></a> command to return to the system view.</li><li>Run the <a href="cmdqueryname=segment-routing+policy+constraint-path"><b><span class="cmdname">segment-routing policy constraint-path </span></b></a><em>path-name</em> command to create an SR-MPLS TE Policy path constraint and enter the path constraint view.</li><li>Run the <a href="cmdqueryname=index+address+ipv4"><b><span class="cmdname">index</span></b></a><strong> </strong><em>index-value</em><strong> </strong><strong><span>address</span></strong> <strong><span>ipv4</span></strong><em> ipv4-address</em> [ <strong>include</strong> [ <strong>strict</strong> | <strong>loose</strong> ] | <strong>exclude</strong> ] command to specify the next-hop IP address in the path constraint.</li><li>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</li><li>Run the <a href="cmdqueryname=segment-routing"><b><span class="cmdname">segment-routing</span></b></a> command to enable SR globally and enter the Segment Routing view.</li><li>Run the <a href="cmdqueryname=on-demand+color"><b><span class="cmdname">on-demand color</span></b></a><strong> </strong><em>colorValue</em> command to create an SR-MPLS TE Policy ODN template and enter the SR-MPLS TE Policy ODN view.</li></ol>
</div>
</p></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=link-bandwidth+utilization"><b><span class="cmdname">link-bandwidth utilization</span></b></a><strong> </strong><em>utilization-value</em> command to configure bandwidth usage for the candidate path.</span></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=metric-type"><b><span class="cmdname">metric-type</span></b></a><strong> </strong>{ <strong>igp</strong> | <strong>te</strong> | <strong>delay</strong> | <strong>hop-count</strong> } command to configure a metric type for the candidate path.</span><p><p>After completing the configuration, run the following commands to configure the corresponding constraint values:</p>
<ul><li>Run the <a href="cmdqueryname=max-cumulation"><b><span class="cmdname">max-cumulation</span></b></a> <strong><span>igp</span></strong><strong> </strong><em>max-igp-cost</em> command to configure the maximum IGP cost for the candidate path.</li><li>Run the <a href="cmdqueryname=max-cumulation+te"><b><span class="cmdname">max-cumulation te</span></b></a><strong> </strong><em>max-te-cost</em> command to configure the maximum TE cost for the candidate path.</li><li>Run the <a href="cmdqueryname=max-cumulation+delay"><b><span class="cmdname">max-cumulation delay</span></b></a><strong> </strong><em>max-delay</em> command to configure the maximum delay for the candidate path.</li><li>Run the <a href="cmdqueryname=max-cumulation+hop-count"><b><span class="cmdname">max-cumulation hop-count</span></b></a><strong> </strong><em>max-hop-count</em> command to configure the maximum number of hops for the candidate path.</li></ul>
</p></li><li class="substepexpand"><span>(Optional) Run the <a href="cmdqueryname=sid+selection"><b><span class="cmdname">sid selection</span></b></a><strong> </strong>{ <strong><span>unprotected-preferred</span></strong> | <strong><span>protected-preferred</span></strong> | <strong><span>unprotected-only</span></strong> | <strong><span>protected-only</span></strong> } command to configure a SID selection rule for the candidate path.</span><p><p>The default SID selection rule in the constraint template is unprotected-SID-preferred (<strong><span>unprotected-preferred</span></strong>).</p>
</p></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</span></li></ol>
</li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0400.html">Configuring an SR-MPLS TE Policy (in ODN Mode)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0063c.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0402.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>