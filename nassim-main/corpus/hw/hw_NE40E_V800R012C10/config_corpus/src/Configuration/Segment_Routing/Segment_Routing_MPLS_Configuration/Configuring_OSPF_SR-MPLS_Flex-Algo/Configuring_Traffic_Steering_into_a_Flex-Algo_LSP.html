
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Traffic Steering into a Flex-Algo LSP">
<meta name="abstract" content="The traffic steering configuration allows you to recurse routes to Flex-Algo-based SR-MPLS BE tunnels (also called Flex-Algo LSPs) for traffic forwarding.">
<meta name="description" content="The traffic steering configuration allows you to recurse routes to Flex-Algo-based SR-MPLS BE tunnels (also called Flex-Algo LSPs) for traffic forwarding.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0201.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0206.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0208.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909,l00587852">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="featurename" content="Segment Routing MPLS">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00468467">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001342324345">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Traffic Steering into a Flex-Algo LSP</title>
</head>
<body><a name="EN-US_TASK_0000001342324345"></a><a name="EN-US_TASK_0000001342324345"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Traffic Steering into a Flex-Algo LSP</h1>
<div class="taskbody"><p>The traffic steering configuration allows you to recurse routes to Flex-Algo-based SR-MPLS BE tunnels (also called Flex-Algo LSPs) for traffic forwarding.</p>
<div class="context"><a name="EN-US_TASK_0000001342324345__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_context608024676214048"><h4 class="sectiontitle">Context</h4><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p454215741214048">After a Flex-Algo LSP is configured, traffic needs to be steered into the LSP for forwarding. Currently, Flex-Algo LSPs can be used for various routes, such as BGP and static routes, as well as various services, such as BGP L3VPN<span>, BGP4+ 6PE,</span> and EVPN services. This section describes how to use tunnel policies to recurse a service to a Flex-Algo LSP.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001342324345__1.4.2"></a><a name="1.4.2"></a>
<div class="p" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_context1141081055214048"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p459397069214048">Before configuring traffic steering, complete the following tasks:</p>
<ul id="EN-US_TASK_0000001342324345__en-us_task_0278997093_ul720939303214048"><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li648746080214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p700890741214048"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li648746080214048"></a><a name="en-us_task_0278997093_li648746080214048"></a>Configure BGP routes, static routes, <span>BGP4+ 6PE services, </span>BGP L3VPN services, <span>BGP L3VPNv6 services, </span>or EVPN services correctly.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li379719315214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1768611968214048"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li379719315214048"></a><a name="en-us_task_0278997093_li379719315214048"></a>Configure an IP prefix list and a tunnel policy to limit the number of routes that can recurse to a Flex-Algo LSP.</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001342324345__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001342324345__en-us_task_0278997093_steps954752480214048"><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_step952199757214048"><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmd573178455214048">Configure a tunnel policy.</span><ol type="a" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_substeps158371401668"><li class="substepexpand" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_substep5837501063"><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmd1083720011620">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname118981511567">system-view</span></b></a></span><p><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p217072963813">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_substep147321771568"><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmd5732167167">Run <a href="cmdqueryname=tunnel-policy"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname103844817617">tunnel-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname16384184617">policy-name</span></i></span><p><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p665723711389">A tunnel policy is created, and the tunnel policy view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_substep331511145610"><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmd103156141862">(Optional) Run <a href="cmdqueryname=description"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname79251414364">description</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname10925514965">description-information</span></i></span><p><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p684194533815">A description is configured for the tunnel policy.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_substep1369114221967"><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmd0691162214615">Run <a href="cmdqueryname=tunnel+select-seq"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname729515239612">tunnel select-seq</span></b></a> <strong><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdparmname2053925887">flex-algo-lsp</span></strong> <strong><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdparmname172951223562">load-balance-number</span></strong> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname122953231267">load-balance-number</span></i> [ <strong><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdparmname829522319614">unmix</span></strong> ]</span><p><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p102491753173818">The tunnel selection sequence and the number of tunnels used for load balancing are configured.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_substep1992322812618"><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmd1092312283610">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname1463218297614">commit</span></b></a></span><p><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1389063103918">The configuration is committed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_substep19300115417153"><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmd6300195420154">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname163001549153">quit</span></b></a></span><p><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p949019124398">Exit the tunnel policy view.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_step918095986214048"><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmd769233007214048">Configure services to recurse to Flex-Algo LSPs.</span><ul id="EN-US_TASK_0000001342324345__en-us_task_0278997093_choices208927073214048"><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_choice140973342214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p664496353214048"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_choice140973342214048"></a><a name="en-us_task_0278997093_choice140973342214048"></a>Configure non-labeled public BGP routes to recurse to Flex-Algo LSPs.</p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1079799037214048">For detailed BGP configurations, see <a href="dc_vrp_bgp_cfg_3004.html">Configuring Basic BGP Functions</a>.</p>
<ol type="a" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_ol1938771207214048"><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1405765197214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p445645418395"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1405765197214048"></a><a name="en-us_task_0278997093_li1405765197214048"></a>Run <a href="cmdqueryname=route+recursive-lookup+tunnel"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname12456145416398">route recursive-lookup tunnel</span></b></a> [ <strong><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdparmname11456185493912">ip-prefix</span></strong> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname1945675493911">ip-prefix-name</span></i> ] <strong><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdparmname545615413395">tunnel-policy</span></strong> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname134561054143917">policy-name</span></i></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p329145516398">Non-labeled public BGP routes are configured to recurse to Flex-Algo LSPs.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li414895887214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p06517114409"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li414895887214048"></a><a name="en-us_task_0278997093_li414895887214048"></a>Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname16651112403">commit</span></b></a></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p171857128403">The configuration is committed.</p>
</li></ol>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_choice1842723620214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1794207953214048"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_choice1842723620214048"></a><a name="en-us_task_0278997093_choice1842723620214048"></a>Configure static routes to recurse to Flex-Algo LSPs.</p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1302444482214048">For detailed static route configurations, see <a href="dc_vrp_static-route_disjoin_cfg_0003.html">Configuring IPv4 Static Routes</a>.</p>
<ol type="a" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_ol1198003304214048"><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1261831906214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p13412102734015"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1261831906214048"></a><a name="en-us_task_0278997093_li1261831906214048"></a>Run <a href="cmdqueryname=ip+route-static+recursive-lookup+tunnel"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname16412162716403">ip route-static recursive-lookup tunnel</span></b></a> [ <strong><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdparmname17412227164017">ip-prefix</span></strong> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname1541222794016">ip-prefix-name</span></i> ] <strong><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdparmname44121127174011">tunnel-policy</span></strong> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname141217273401">policy-name</span></i></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1273182810405">Static routes are configured to recurse to Flex-Algo LSPs for MPLS forwarding.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li820938693214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p188031023104012"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li820938693214048"></a><a name="en-us_task_0278997093_li820938693214048"></a>Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname080302324016">commit</span></b></a></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p15231324124018">The configuration is committed.</p>
</li></ol>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_choice836858943214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1217850798214048"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_choice836858943214048"></a><a name="en-us_task_0278997093_choice836858943214048"></a>Configure a BGP L3VPN service to recurse to a Flex-Algo LSP.</p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p552568902214048">For detailed BGP L3VPN configurations, see <a href="dc_vrp_mpls-l3vpn-v4_cfg_0154.html">Configuring a Basic BGP/MPLS IP VPN</a>.</p>
<ol type="a" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_ol855591131214048"><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li330673853214048">Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname966125319400">ip vpn-instance</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname166175314017">vpn-instance-name</span></i><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p53816549406">The VPN instance view is displayed.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1819013646214048">Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname889113576406">ipv4-family</span></b></a><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p10114175919408">The VPN instance IPv4 address family view is displayed.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1820750403214048">Run <a href="cmdqueryname=tnl-policy"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname269031164113">tnl-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname3690191134115">policy-name</span></i><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p27121210414">A tunnel policy is applied to the VPN instance IPv4 address family.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li375519531948"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li375519531948p0"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li375519531948"></a><a name="en-us_task_0278997093_li375519531948"></a>(Optional) Run <a href="cmdqueryname=default-color"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname869719572217">default-color</span></b></a> <em id="EN-US_TASK_0000001342324345__en-us_task_0278997093_i7183647523">color-value</em></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p4431131915266">The default color value is specified for the L3VPN service to recurse to a Flex-Algo LSP. If a remote VPN route without the color extended community attribute is leaked to a local VPN instance, the default color value is used for the recursion to a Flex-Algo LSP.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1467725981214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p9921181584115"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1467725981214048"></a><a name="en-us_task_0278997093_li1467725981214048"></a>Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname10921161512412">commit</span></b></a></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1629631720413">The configuration is committed.</p>
</li></ol>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_choice1142119164214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1387952462214048"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_choice1142119164214048"></a><a name="en-us_task_0278997093_choice1142119164214048"></a>Configure a BGP L3VPNv6 service to recurse to a Flex-Algo LSP.</p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1931322226214048">For detailed BGP L3VPNv6 configurations, see <a href="dc_vrp_mpls-l3vpn-v6_cfg_2057.html">Configuring a Basic BGP/MPLS IPv6 VPN</a>.</p>
<ol type="a" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_ol1930031898214048"><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li990880897214048">Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname698143814113">ip vpn-instance</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname139873884110">vpn-instance-name</span></i><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1635373913419">The VPN instance view is displayed.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li2027779274214048">Run <a href="cmdqueryname=ipv6-family"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname8297144114115">ipv6-family</span></b></a><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1022884212415">The VPN instance IPv6 address family view is displayed.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1906977875214048">Run <a href="cmdqueryname=tnl-policy"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname16185144511411">tnl-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname1518544524113">policy-name</span></i><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p9201346194115">A tunnel policy is applied to the VPN instance IPv6 address family.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li67541750141118"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li67541750141118p0"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li67541750141118"></a><a name="en-us_task_0278997093_li67541750141118"></a>(Optional) Run <a href="cmdqueryname=default-color"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname375415041112">default-color</span></b></a> <em id="EN-US_TASK_0000001342324345__en-us_task_0278997093_i375495021115">color-value</em></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p3552101420311">The default color value is specified for the L3VPNv6 service to recurse to a Flex-Algo LSP. If a remote VPN route without the color extended community attribute is leaked to a local VPN instance, the default color value is used for the recursion to a Flex-Algo LSP.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1068244873214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p41195884110"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1068244873214048"></a><a name="en-us_task_0278997093_li1068244873214048"></a>Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname14115815411">commit</span></b></a></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p189575911417">The configuration is committed.</p>
</li></ol>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_choice547991303214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1679951185214048"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_choice547991303214048"></a><a name="en-us_task_0278997093_choice547991303214048"></a>Configure a BGP4+ 6PE service to recurse to a Flex-Algo LSP.</p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p136131304214048">For detailed BGP4+ 6PE configurations, see <a href="dc_vrp_bgp6_cfg_0056.html">Configuring BGP4+ 6PE</a>.</p>
<ol type="a" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_ol1626495914214048"><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1048262906214048">Run <a href="cmdqueryname=bgp"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname73386554219">bgp</span></b></a> { <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname1233817511429">as-number-plain</span></i> | <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname10338754429">as-number-dot</span></i> }<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p54091361426">The BGP view is displayed.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1305522485214048">Run <a href="cmdqueryname=ipv6-family"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname1425001518424">ipv6-family</span></b></a> <strong><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdparmname4250615134213">unicast</span></strong><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p4511016134216">The BGP IPv6 unicast address family view is displayed.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1716660698214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p648110563134"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1716660698214048"></a><a name="en-us_task_0278997093_li1716660698214048"></a>Run <a href="cmdqueryname=peer+enable"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname18481156101314">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname17481256171314">ipv4-address</span></i> <strong><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdparmname9481105631319">enable</span></strong></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p2016411576134">The local device is enabled to exchange routes with a specified 6PE peer.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1775545033214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p114119151420"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1775545033214048"></a><a name="en-us_task_0278997093_li1775545033214048"></a>Run <a href="cmdqueryname=peer+tnl-policy"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname741116181415">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname1141117101410">ipv4-address</span></i> <strong><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdparmname3411718147">tnl-policy</span></strong> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname2411131141410">tnl-policy-name</span></i></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p14831181121410">A tunnel policy is applied to the 6PE peer.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1201228191214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p23304318424"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1201228191214048"></a><a name="en-us_task_0278997093_li1201228191214048"></a>Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname7330153112425">commit</span></b></a></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p31477335427">The configuration is committed.</p>
</li></ol>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_choice1669578253214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1580366469214048"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_choice1669578253214048"></a><a name="en-us_task_0278997093_choice1669578253214048"></a>Configure an EVPN service to recurse to a Flex-Algo LSP.</p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1691971658214048">For detailed EVPN configurations, see <a href="dc_vrp_evpn_cfg_0065.html">Configuring EVPN VPLS over MPLS (BD EVPN Instance)</a>.</p>
<div class="p" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p26516238214048">To apply a tunnel policy to an EVPN L3VPN instance, perform the following steps:<ol type="a" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_ol636509373214048"><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li773557016214048">Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname10706174811422">ip vpn-instance</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname970619481427">vpn-instance-name</span></i><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p85614498423">The VPN instance view is displayed.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1457056268214048">Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname17908113223713">ipv4-family</span></b></a><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_ph119083328373"> or <a href="cmdqueryname=ipv6-family"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname09081832123717">ipv6-family</span></b></a></span><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p73967334375">The VPN instance IPv4<span>/IPv6</span> address family view is displayed.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li2048930369214048">Run <a href="cmdqueryname=tnl-policy"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname85881959184214">tnl-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname1588145964215">policy-name</span></i> <strong><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdparmname2058845984218">evpn</span></strong><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p36891200438">A tunnel policy is applied to the EVPN L3VPN instance.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1465052681318"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p10883212153512"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1465052681318"></a><a name="en-us_task_0278997093_li1465052681318"></a>(Optional) Run <a href="cmdqueryname=default-color"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname203302472719">default-color</span></b></a> <em id="EN-US_TASK_0000001342324345__en-us_task_0278997093_i17330041274">color-value</em> <strong><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdparmname1962619335145">evpn</span></strong></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p136305370348">The default color value is specified for the EVPN L3VPN service to recurse to a Flex-Algo LSP.</p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p2415929172713">If a remote EVPN route without the color extended community attribute is leaked to a local VPN instance, the default color value is used for the recursion to a Flex-Algo LSP.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1902317119214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1958771111431"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1902317119214048"></a><a name="en-us_task_0278997093_li1902317119214048"></a>Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname1058716118431">commit</span></b></a></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p76091812194313">The configuration is committed.</p>
</li></ol>
</div>
<div class="p" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1678477370214048">To apply a tunnel policy to a BD EVPN instance, perform the following steps:<ol type="a" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_ol1499284730214048"><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li890594774214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p14820103414319"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li890594774214048"></a><a name="en-us_task_0278997093_li890594774214048"></a>Run <a href="cmdqueryname=evpn+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname1582015342435">evpn vpn-instance</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname4820113412432">vpn-instance-name</span></i> <strong><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdparmname17820334194319">bd-mode</span></strong></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p01141736174312">The BD EVPN instance view is displayed.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1337396890214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p12108423435"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1337396890214048"></a><a name="en-us_task_0278997093_li1337396890214048"></a>Run <a href="cmdqueryname=tnl-policy"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname81017423433">tnl-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname710144217431">policy-name</span></i></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p15340104354318">A tunnel policy is applied to the BD EVPN instance.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li15744939112912"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li15744939112912p0"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li15744939112912"></a><a name="en-us_task_0278997093_li15744939112912"></a>(Optional) Run <a href="cmdqueryname=default-color"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname11540527152918">default-color</span></b></a> <em id="EN-US_TASK_0000001342324345__en-us_task_0278997093_i165400279298">color-value</em></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p3775182793715">The default color value is specified for the EVPN service to recurse to a Flex-Algo LSP. If a remote EVPN route without the color extended community attribute is leaked to a local EVPN instance, the default color value is used for the recursion to a Flex-Algo LSP.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li292823326214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p590613571436"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li292823326214048"></a><a name="en-us_task_0278997093_li292823326214048"></a>Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname15906105794314">commit</span></b></a></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p87451587434">The configuration is committed.</p>
</li></ol>
</div>
<div class="p" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p2126694624214048">To apply a tunnel policy to an EVPN instance that works in EVPN VPWS mode, perform the following steps:<ol type="a" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_ol1926126594214048"><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1053374078214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p64286974417"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li1053374078214048"></a><a name="en-us_task_0278997093_li1053374078214048"></a>Run <a href="cmdqueryname=evpn+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname1642829184419">evpn vpn-instance</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname10428109134419">vpn-instance-name</span></i> <strong><span id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdparmname0428209174410">vpws</span></strong></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p10365151015444">The view of the EVPN instance in EVPN VPWS mode is displayed.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li668004691214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1546671364419"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li668004691214048"></a><a name="en-us_task_0278997093_li668004691214048"></a>Run <a href="cmdqueryname=tnl-policy"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname646631394414">tnl-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname194662138445">policy-name</span></i></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1024981454414">A tunnel policy is applied to the EVPN instance in EVPN VPWS mode.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li4182133016319"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li4182133016319p0"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li4182133016319"></a><a name="en-us_task_0278997093_li4182133016319"></a>(Optional) Run <a href="cmdqueryname=default-color"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname134821431113116">default-color</span></b></a> <em id="EN-US_TASK_0000001342324345__en-us_task_0278997093_i19482153193110">color-value</em></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p14352153114013">The default color value is specified for the EVPN service to recurse to a Flex-Algo LSP. If a remote EVPN route without the color extended community attribute is leaked to a local EVPN instance, the default color value is used for the recursion to a Flex-Algo LSP.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li285288286214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1041718268443"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li285288286214048"></a><a name="en-us_task_0278997093_li285288286214048"></a>Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname2417132610448">commit</span></b></a></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p3242112715445">The configuration is committed.</p>
</li></ol>
</div>
<div class="p" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1987192365214048">To apply a tunnel policy to a basic EVPN instance, perform the following steps:<ol type="a" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_ol659465349214048"><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li750517800214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1850863719446"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li750517800214048"></a><a name="en-us_task_0278997093_li750517800214048"></a>Run <a href="cmdqueryname=evpn+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname9508153717441">evpn vpn-instance</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname20508153774413">vpn-instance-name</span></i></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1629123874414">The EVPN instance view is displayed.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li2012490415214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p1029704116449"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li2012490415214048"></a><a name="en-us_task_0278997093_li2012490415214048"></a>Run <a href="cmdqueryname=tnl-policy"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname3297641114416">tnl-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_varname1229714194416">policy-name</span></i></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p965104212441">A tunnel policy is applied to the basic EVPN instance.</p>
</li><li id="EN-US_TASK_0000001342324345__en-us_task_0278997093_li106317617214048"><p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p32170459443"><a name="EN-US_TASK_0000001342324345__en-us_task_0278997093_li106317617214048"></a><a name="en-us_task_0278997093_li106317617214048"></a>Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001342324345__en-us_task_0278997093_cmdname16217845144415">commit</span></b></a></p>
<p id="EN-US_TASK_0000001342324345__en-us_task_0278997093_p18105114610444">The configuration is committed.</p>
</li></ol>
</div>
</li></ul>
</li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0201.html">Configuring OSPF SR-MPLS Flex-Algo
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0206.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_sr_all_cfg_0208.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>