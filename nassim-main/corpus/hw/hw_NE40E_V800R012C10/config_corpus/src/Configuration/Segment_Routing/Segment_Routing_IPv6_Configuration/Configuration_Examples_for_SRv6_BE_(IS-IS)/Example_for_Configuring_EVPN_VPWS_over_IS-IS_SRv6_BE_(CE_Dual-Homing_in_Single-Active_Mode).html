
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring EVPN VPWS over IS-IS SRv6 BE (CE Dual-Homing in Single-Active Mode)">
<meta name="abstract" content="This section provides an example for configuring SRv6 BE to carry EVPN VPWSs. In the example, a redundancy mode needs to be configured on a per Ethernet segment identifier (ESI) basis.">
<meta name="description" content="This section provides an example for configuring SRv6 BE to carry EVPN VPWSs. In the example, a redundancy mode needs to be configured on a per Ethernet segment identifier (ESI) basis.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0010.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0233.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0024.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00587852">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0227779374">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring EVPN VPWS over IS-IS SRv6 BE (CE Dual-Homing in Single-Active Mode)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0227779374"></a><a name="EN-US_TASK_0227779374"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring EVPN VPWS over IS-IS SRv6 BE (CE Dual-Homing in Single-Active Mode)</h1>
<div class="taskbody"><p id="shortdesc1809086753214049">This section provides an example for configuring SRv6 BE to carry EVPN VPWSs. In the example, a redundancy mode needs to be configured on a per Ethernet segment identifier (ESI) basis.</p>
<div class="context"><a name="EN-US_TASK_0227779374__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0227779374__section_dc_vrp_srv6_cfg_all_002201"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0227779374__p175124308115">On the network shown in <a href="#EN-US_TASK_0227779374__fig_dc_vrp_srv6_cfg_all_002201">Figure 1</a>, CE2 is dual-homed to PE2 and PE3. It is required that PE2 and PE3 operate in master/backup mode to transmit traffic from CE1 to CE2.</p>
<p id="EN-US_TASK_0227779374__p1037411481074">To meet this requirement, configure the single-active redundancy mode on a per ESI basis for PE2 and PE3.</p>
<div class="fignone" id="EN-US_TASK_0227779374__fig_dc_vrp_srv6_cfg_all_002201"><a name="EN-US_TASK_0227779374__fig_dc_vrp_srv6_cfg_all_002201"></a><a name="fig_dc_vrp_srv6_cfg_all_002201"></a><span class="figcap"><b>Figure 1 </b>EVPN VPWS over SRv6 BE networking (CE dual-homing in single-active mode)</span><div class="note" id="EN-US_TASK_0227779374__note1130967988214049"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0227779374__p354513793214055">Interfaces 1 through 3 in this example represent GE <span>0/1/0</span>, GE <span>0/2/0</span>, and GE <span>0/3/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0227779374__image1056125120145" src="figure/en-us_image_0227779375.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0227779374__1.4.2"></a><a name="1.4.2"></a>
<div class="p" id="EN-US_TASK_0227779374__section_dc_vrp_srv6_cfg_all_002202"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0227779374__p610221846214049">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0227779374__ol1931618197214049"><li id="EN-US_TASK_0227779374__li47553592589"><p id="EN-US_TASK_0227779374__p1975616594584"><a name="EN-US_TASK_0227779374__li47553592589"></a><a name="li47553592589"></a>Enable IPv6 forwarding and configure an IPv6 address for each PE interface.</p>
</li><li id="EN-US_TASK_0227779374__li61538244164"><p id="EN-US_TASK_0227779374__p17152102411616"><a name="EN-US_TASK_0227779374__li61538244164"></a><a name="li61538244164"></a>Enable IS-IS, configure an IS-IS level, and specify a network entity on each PE.</p>
</li><li id="EN-US_TASK_0227779374__li142510513593"><p id="EN-US_TASK_0227779374__p526115115919"><a name="EN-US_TASK_0227779374__li142510513593"></a><a name="li142510513593"></a>Configure EVPN VPWS and EVPL instances on each PE.</p>
</li><li id="EN-US_TASK_0227779374__li5572181211595"><p id="EN-US_TASK_0227779374__p2572101211593"><a name="EN-US_TASK_0227779374__li5572181211595"></a><a name="li5572181211595"></a>Establish BGP EVPN peer relationships among the PEs.</p>
</li><li id="EN-US_TASK_0227779374__li366083158214049"><p id="EN-US_TASK_0227779374__p1793543265813"><a name="EN-US_TASK_0227779374__li366083158214049"></a><a name="li366083158214049"></a>Configure SRv6 BE on the PEs.</p>
</li><li id="EN-US_TASK_0227779374__li1857247103120">Bind the EVPL instance on each PE to an access-side sub-interface.</li><li id="EN-US_TASK_0227779374__li13664115411712">Configure a redundancy mode on a per ESI basis on PE2 and PE3.</li><li id="EN-US_TASK_0227779374__li13602641124617">Configure CE access to the PEs.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0227779374__1.4.3"></a><a name="1.4.3"></a>
<div class="p" id="EN-US_TASK_0227779374__section_dc_vrp_srv6_cfg_all_002203"><h4 class="sectiontitle">Data Preparation</h4><p id="EN-US_TASK_0227779374__p605539302214049">To complete the configuration, you need the following data:</p>
<ul id="EN-US_TASK_0227779374__ul899445098214049"><li id="EN-US_TASK_0227779374__li17101193417591"><p id="EN-US_TASK_0227779374__p41010342598"><a name="EN-US_TASK_0227779374__li17101193417591"></a><a name="li17101193417591"></a>EVPN instance name: evrf1</p>
</li><li id="EN-US_TASK_0227779374__li12101834125911"><p id="EN-US_TASK_0227779374__p310133411591"><a name="EN-US_TASK_0227779374__li12101834125911"></a><a name="li12101834125911"></a>RD and RT of the EVPN instance</p>
</li><li id="EN-US_TASK_0227779374__li161011341597"><p id="EN-US_TASK_0227779374__p14101193425915"><a name="EN-US_TASK_0227779374__li161011341597"></a><a name="li161011341597"></a>Locator names for PE1, PE2, and PE3: PE1, PE2, and PE3, respectively; dynamically generated operation code (opcode)</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0227779374__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0227779374__section_dc_vrp_srv6_cfg_all_002204"><li id="EN-US_TASK_0227779374__step362152787214049"><span id="EN-US_TASK_0227779374__cmd733235511214049">Enable IPv6 forwarding and configure an IPv6 address for each interface.</span><p><pre class="screen" id="EN-US_TASK_0227779374__screen1230104759214049">&lt;<span class="keyword" id="EN-US_TASK_0227779374__keyword393510418214049">HUAWEI</span>&gt; <strong id="EN-US_TASK_0227779374__b386530312214049">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword2011991856214049"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0227779374__keyword1269618130214049">HUAWEI</span>] <strong id="EN-US_TASK_0227779374__b1302798650214049">sysname PE1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1478551779214049">*</span><span class="keyword" id="EN-US_TASK_0227779374__keyword1486470216214049">HUAWEI</span>] <strong id="EN-US_TASK_0227779374__b758780196214049">commit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1017457270214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0227779374__b1773787764214049">interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword2067597535214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b413065376214049">ipv6 enable</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1116890236214049">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b183421750214049">ipv6 address 2001:DB8:10::1 64</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1087328600214049">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b1791300765214049">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword632919254521">*</span>PE1] <strong id="EN-US_TASK_0227779374__b465516291197">interface gigabitethernet <span>0/2/0</span></strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword15433112655215">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0227779374__b765542911912">ipv6 enable</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword2655329111913">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0227779374__b2655132981914">ipv6 address 2001:DB8:20::1 64</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword19655229181914">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0227779374__b265620298195">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1473247868214049">*</span>PE1] <strong id="EN-US_TASK_0227779374__b2025840177214049">interface LoopBack 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword24831052013">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0227779374__b8591125212">ip address 1.1.1.1 32</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1412460428214049">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0227779374__b1157214332214049">ipv6 enable</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword385623960214049">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0227779374__b1617933106214049">ipv6 address 2001:DB8:1::1 128</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1823516083214049">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0227779374__b432310683214049">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1968318815214049">*</span>PE1] <strong id="EN-US_TASK_0227779374__b613488894214049">commit</strong></pre>
<p id="EN-US_TASK_0227779374__p1833817407215">Configure an IPv4 address for the loopback interface because the EVPN source address needs to be an IPv4 address. The preceding example uses the configuration of PE1. The configurations of other devices are similar to the configuration of PE1. For configuration details, see <a href="#EN-US_TASK_0227779374__section_dc_vrp_srv6_cfg_all_002205">Configuration Files</a> in this section.</p>
</p></li><li id="EN-US_TASK_0227779374__step357923238214049"><span id="EN-US_TASK_0227779374__cmd514165819214049">Configure IS-IS.</span><p><p id="EN-US_TASK_0227779374__p1535189562214049"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen1141111132014">[<span class="keyword" id="EN-US_TASK_0227779374__keyword107441132010"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0227779374__b137441118205">isis 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword19741111162019">*</span>PE1-isis-1] <strong id="EN-US_TASK_0227779374__b1474211102010">is-level level-1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword16751112208">*</span>PE1-isis-1] <strong id="EN-US_TASK_0227779374__b675141142018">cost-style wide</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword47561114202">*</span>PE1-isis-1] <strong id="EN-US_TASK_0227779374__b7751111102015">network-entity 10.0000.0000.0001.00</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1775131113208">*</span>PE1-isis-1] <strong id="EN-US_TASK_0227779374__b107571118204">ipv6 enable topology ipv6</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword137531117204">*</span>PE1-isis-1] <strong id="EN-US_TASK_0227779374__b67512119202">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword2751211142014">*</span>PE1] <strong id="EN-US_TASK_0227779374__b197531114201">interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword157591117208">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b17756117209">isis ipv6 enable 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1549125082110">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b14761211122010">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword0832141714205">*</span>PE1] <strong id="EN-US_TASK_0227779374__b68321117102012">interface gigabitethernet <span>0/2/0</span></strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword083211179202">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0227779374__b178321517102012">isis ipv6 enable 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword11781947132115">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0227779374__b1583211782018">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword17766119209">*</span>PE1] <strong id="EN-US_TASK_0227779374__b12762113205">interface loopback1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword976211102014">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0227779374__b3761511122020">isis ipv6 enable 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword5763114202">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0227779374__b1176711152014">commit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword187615115202"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-LoopBack1] <strong id="EN-US_TASK_0227779374__b1976171113200">quit</strong></pre>
</p><p><p id="EN-US_TASK_0227779374__p16499122019223"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen13499182012224">[<span class="keyword" id="EN-US_TASK_0227779374__keyword749962014222"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0227779374__b1949942011227">isis 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword34991920172215">*</span>PE2-isis-1] <strong id="EN-US_TASK_0227779374__b54992020182210">is-level level-1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword8499172015228">*</span>PE2-isis-1] <strong id="EN-US_TASK_0227779374__b9499220142215">cost-style wide</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword2049962014220">*</span>PE2-isis-1] <strong id="EN-US_TASK_0227779374__b4499420132217">network-entity 10.0000.0000.0002.00</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword2499112002213">*</span>PE2-isis-1] <strong id="EN-US_TASK_0227779374__b1949962015226">ipv6 enable topology ipv6</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1949982011226">*</span>PE2-isis-1] <strong id="EN-US_TASK_0227779374__b450042018228">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword4500142002214">*</span>PE2] <strong id="EN-US_TASK_0227779374__b17500162017228">interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword350014200228">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b95001920112210">isis ipv6 enable 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword450082032213">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b1150012092213">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword3500122042217">*</span>PE2] <strong id="EN-US_TASK_0227779374__b1950092011225">interface gigabitethernet <span>0/2/0</span></strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword18500920172214">*</span>PE2-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0227779374__b15500820172211">isis ipv6 enable 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword95001320112219">*</span>PE2-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0227779374__b12500122019223">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword16500172032215">*</span>PE2] <strong id="EN-US_TASK_0227779374__b1150016204222">interface loopback1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword4500120162213">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0227779374__b1150072013223">isis ipv6 enable 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1250022042217">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0227779374__b7500182012225">commit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword185001620192211"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-LoopBack1] <strong id="EN-US_TASK_0227779374__b1650052018227">quit</strong></pre>
<p id="EN-US_TASK_0227779374__p773812226229"># Configure PE3.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen117386228223">[<span class="keyword" id="EN-US_TASK_0227779374__keyword373818224222"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0227779374__b107381822112218">isis 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword573814222225">*</span>PE3-isis-1] <strong id="EN-US_TASK_0227779374__b187381622182216">is-level level-1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword67389221225">*</span>PE3-isis-1] <strong id="EN-US_TASK_0227779374__b6738142210227">cost-style wide</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword12738152213229">*</span>PE3-isis-1] <strong id="EN-US_TASK_0227779374__b573882210220">network-entity 10.0000.0000.0003.00</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1873832242210">*</span>PE3-isis-1] <strong id="EN-US_TASK_0227779374__b7738922102211">ipv6 enable topology ipv6</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1473862212218">*</span>PE3-isis-1] <strong id="EN-US_TASK_0227779374__b5738172252213">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword16738182215226">*</span>PE3] <strong id="EN-US_TASK_0227779374__b97384227229">interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword177381022192215">*</span>PE3-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b67391122202216">isis ipv6 enable 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword137391422162213">*</span>PE3-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b1173992272214">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword373962242211">*</span>PE3] <strong id="EN-US_TASK_0227779374__b18739152214225">interface gigabitethernet <span>0/2/0</span></strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1973917226224">*</span>PE3-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0227779374__b10739142211221">isis ipv6 enable 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1273914226224">*</span>PE3-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0227779374__b87395224228">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword107395223227">*</span>PE3] <strong id="EN-US_TASK_0227779374__b07391022172211">interface loopback1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword16739122217226">*</span>PE3-LoopBack1] <strong id="EN-US_TASK_0227779374__b8739162216222">isis ipv6 enable 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword177391223229">*</span>PE3-LoopBack1] <strong id="EN-US_TASK_0227779374__b1739112262217">commit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword127391922132217"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-LoopBack1] <strong id="EN-US_TASK_0227779374__b137399224222">quit</strong></pre>
<p id="EN-US_TASK_0227779374__p1791612592811">After the configuration is complete, run the <strong id="EN-US_TASK_0227779374__b148191949192315">display isis peer</strong> and <strong id="EN-US_TASK_0227779374__b78241649132311">display isis route</strong> commands to check whether IS-IS has been configured successfully. The following example uses the command output on PE1.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen128761520141413">[<font style="font-size:8pt" Face="Courier New" >~</font>PE1] <strong id="EN-US_TASK_0227779374__b341784415143">display isis peer</strong>
                          Peer information for ISIS(1)  

  System Id     Interface          Circuit Id        State HoldTime Type     PRI
--------------------------------------------------------------------------------
0000.0000.0003* GE<span>0/2/0</span>            0000.0000.0003.02  Up   8s       L1       64 
0000.0000.0002* GE<span>0/1/0</span>            0000.0000.0002.02  Up   6s       L1       64 

Total Peer(s): 2 </pre>
</p></li><li id="EN-US_TASK_0227779374__step5449152915466"><span id="EN-US_TASK_0227779374__cmd3449102916461">Configure EVPN VPWS and EVPL instances on each PE.</span><p><p id="EN-US_TASK_0227779374__p53501242181816"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen53810319196">[<font style="font-size:8pt" Face="Courier New" >~</font>PE1] <strong id="EN-US_TASK_0227779374__b2357183774217">evpn source-address 1.1.1.1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword21254715526">*</span>PE1] <strong id="EN-US_TASK_0227779374__b8767301916">evpn vpn-instance evrf1 vpws</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword187683161911">*</span>PE1-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b1771437197">route-distinguisher 100:1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword17771939199">*</span>PE1-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b12775310194">vpn-target 1:1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword177836193">*</span>PE1-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b37712351915">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1177133111915">*</span>PE1] <strong id="EN-US_TASK_0227779374__b1377137193">evpl instance 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword19771939198">*</span>PE1-evpl1] <strong id="EN-US_TASK_0227779374__b13771139195">evpn binding vpn-instance evrf1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword10772313192">*</span>PE1-evpl1] <strong id="EN-US_TASK_0227779374__b18775391918">local-service-id 100 remote-service-id 200</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword5777310193">*</span>PE1-evpl1] <strong id="EN-US_TASK_0227779374__b277136191">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword16785361910">*</span>PE1] <strong id="EN-US_TASK_0227779374__b117811313194">commit</strong></pre>
<p id="EN-US_TASK_0227779374__p13803105984510"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen15803125917455">[<font style="font-size:8pt" Face="Courier New" >~</font>PE2] <strong id="EN-US_TASK_0227779374__b58031459104516">evpn source-address 2.2.2.2</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword2078564817526">*</span>PE2] <strong id="EN-US_TASK_0227779374__b580365974511">evpn vpn-instance evrf1 vpws</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword4803159114517">*</span>PE2-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b11803959174517">route-distinguisher 200:1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword7803155914516">*</span>PE2-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b20803459104514">vpn-target 1:1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1580305974516">*</span>PE2-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b280395984510">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword480325919455">*</span>PE2] <strong id="EN-US_TASK_0227779374__b480317598455">evpl instance 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword280395954520">*</span>PE2-evpl1] <strong id="EN-US_TASK_0227779374__b7804105974517">evpn binding vpn-instance evrf1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword680455913452">*</span>PE2-evpl1] <strong id="EN-US_TASK_0227779374__b7804145913459">local-service-id 200 remote-service-id 100</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword15804125904511">*</span>PE2-evpl1] <strong id="EN-US_TASK_0227779374__b12804359174515">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword4804155910459">*</span>PE2] <strong id="EN-US_TASK_0227779374__b5804959174516">commit</strong></pre>
<p id="EN-US_TASK_0227779374__p12285164184616"># Configure PE3.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen02853418468">[<font style="font-size:8pt" Face="Courier New" >~</font>PE3] <strong id="EN-US_TASK_0227779374__b152858454613">evpn source-address 3.3.3.3</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword8231052105210">*</span>PE3] <strong id="EN-US_TASK_0227779374__b1128512414468">evpn vpn-instance evrf1 vpws</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword162854404618">*</span>PE3-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b128514114618">route-distinguisher 300:1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword122851943462">*</span>PE3-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b328517434612">vpn-target 1:1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword15285124174613">*</span>PE3-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b12858414463">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1128512415469">*</span>PE3] <strong id="EN-US_TASK_0227779374__b1128584174613">evpl instance 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword528513410465">*</span>PE3-evpl1] <strong id="EN-US_TASK_0227779374__b1028511434619">evpn binding vpn-instance evrf1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword142855416460">*</span>PE3-evpl1] <strong id="EN-US_TASK_0227779374__b92868417462">local-service-id 200 remote-service-id 100</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword192861843461">*</span>PE3-evpl1] <strong id="EN-US_TASK_0227779374__b14286546460">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword192862434617">*</span>PE3] <strong id="EN-US_TASK_0227779374__b428694114617">commit</strong></pre>
</p></li><li id="EN-US_TASK_0227779374__step970588754214049"><span id="EN-US_TASK_0227779374__cmd399405866214049">Establish BGP EVPN peer relationships among the PEs.</span><p><p id="EN-US_TASK_0227779374__p283252037214049"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen82033168316">[<span class="keyword" id="EN-US_TASK_0227779374__keyword921211623115"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0227779374__b22120165312">bgp 100</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword021201611314">*</span>PE1-bgp] <strong id="EN-US_TASK_0227779374__b13213111623112">router-id 1.1.1.1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword621317162312">*</span>PE1-bgp] <strong id="EN-US_TASK_0227779374__b5213151614314">peer 2001:DB8:3::3 as-number 100</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword18213216163120">*</span>PE1-bgp] <strong id="EN-US_TASK_0227779374__b1021316166317">peer 2001:DB8:3::3 connect-interface loopback 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword16285430103115">*</span>PE1-bgp] <strong id="EN-US_TASK_0227779374__b928513013118">peer 2001:DB8:2::2 as-number 100</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword52851730143117">*</span>PE1-bgp] <strong id="EN-US_TASK_0227779374__b22851830193111">peer 2001:DB8:2::2 connect-interface loopback 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword3213101618316">*</span>PE1-bgp] <strong id="EN-US_TASK_0227779374__b12213181673119">l2vpn-family evpn</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword14213181616311">*</span>PE1-bgp-af-evpn] <strong id="EN-US_TASK_0227779374__b1621312165319">peer 2001:DB8:3::3 enable</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword132131116143113">*</span>PE1-bgp-af-evpn] <strong id="EN-US_TASK_0227779374__b82131516193111">peer 2001:DB8:3::3 </strong><strong id="EN-US_TASK_0227779374__b82131716163110">advertise encap-type srv6</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword8551123623115">*</span>PE1-bgp-af-evpn] <strong id="EN-US_TASK_0227779374__b1055123633114">peer 2001:DB8:2::2 enable</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword13551936173113">*</span>PE1-bgp-af-evpn] <strong id="EN-US_TASK_0227779374__b17551336133110">peer 2001:DB8:2::2 </strong><strong id="EN-US_TASK_0227779374__b455193613315">advertise encap-type srv6</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword16213516193113">*</span>PE1-bgp-af-evpn] <strong id="EN-US_TASK_0227779374__b32135161311">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword521315163311">*</span>PE1-bgp] <strong id="EN-US_TASK_0227779374__b1321318164313">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword4213516193112">*</span>PE1] <strong id="EN-US_TASK_0227779374__b1521391611317">commit</strong></pre>
<p id="EN-US_TASK_0227779374__p1487889689214049"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen3445115013396">[<span class="keyword" id="EN-US_TASK_0227779374__keyword16491145016399"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0227779374__b1491175017397">bgp 100</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword3491125010391">*</span>PE2-bgp] <strong id="EN-US_TASK_0227779374__b20491550133914">router-id 2.2.2.2</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1349112504394">*</span>PE2-bgp] <strong id="EN-US_TASK_0227779374__b13491450193910">peer 2001:DB8:1::1 as-number 100</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword15491115011398">*</span>PE2-bgp] <strong id="EN-US_TASK_0227779374__b1949117506398">peer 2001:DB8:1::1 connect-interface loopback 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1749255063913">*</span>PE2-bgp] <strong id="EN-US_TASK_0227779374__b144921650103913">peer 2001:DB8:3::3 as-number 100</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1149219504392">*</span>PE2-bgp] <strong id="EN-US_TASK_0227779374__b17492150113913">peer 2001:DB8:3::3 connect-interface loopback 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword16492175013919">*</span>PE2-bgp] <strong id="EN-US_TASK_0227779374__b349265023916">l2vpn-family evpn</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1749212503394">*</span>PE2-bgp-af-evpn] <strong id="EN-US_TASK_0227779374__b19492150143915">peer 2001:DB8:1::1 enable</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword17492450123920">*</span>PE2-bgp-af-evpn] <strong id="EN-US_TASK_0227779374__b15492250193910">peer 2001:DB8:1::1 </strong><strong id="EN-US_TASK_0227779374__b749295014395">advertise encap-type srv6</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword84925500396">*</span>PE2-bgp-af-evpn] <strong id="EN-US_TASK_0227779374__b64921650183916">peer 2001:DB8:3::3 enable</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1849235003920">*</span>PE2-bgp-af-evpn] <strong id="EN-US_TASK_0227779374__b14492150163917">peer 2001:DB8:3::3 </strong><strong id="EN-US_TASK_0227779374__b8492250133911">advertise encap-type srv6</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword749205003914">*</span>PE2-bgp-af-evpn] <strong id="EN-US_TASK_0227779374__b549245013920">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword8493750143911">*</span>PE2-bgp] <strong id="EN-US_TASK_0227779374__b5493250123911">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword144933501394">*</span>PE2] <strong id="EN-US_TASK_0227779374__b649365033912">commit</strong></pre>
<p id="EN-US_TASK_0227779374__p73103113310"># Configure PE3.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen11669174417399">[<span class="keyword" id="EN-US_TASK_0227779374__keyword5715844113911"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0227779374__b207151244123918">bgp 100</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1171511441397">*</span>PE3-bgp] <strong id="EN-US_TASK_0227779374__b67151244193916">router-id 3.3.3.3</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword0715174413399">*</span>PE3-bgp] <strong id="EN-US_TASK_0227779374__b187151244153918">peer 2001:DB8:1::1 as-number 100</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword4715164453919">*</span>PE3-bgp] <strong id="EN-US_TASK_0227779374__b3715444163913">peer 2001:DB8:1::1 connect-interface loopback 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1371518442392">*</span>PE3-bgp] <strong id="EN-US_TASK_0227779374__b3717204433912">peer 2001:DB8:2::2 as-number 100</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword4717244193913">*</span>PE3-bgp] <strong id="EN-US_TASK_0227779374__b207171644173910">peer 2001:DB8:2::2 connect-interface loopback 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1771710442392">*</span>PE3-bgp] <strong id="EN-US_TASK_0227779374__b13717174414390">l2vpn-family evpn</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword177171144153914">*</span>PE3-bgp-af-evpn] <strong id="EN-US_TASK_0227779374__b3717104453914">peer 2001:DB8:1::1 enable</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword157174442392">*</span>PE3-bgp-af-evpn] <strong id="EN-US_TASK_0227779374__b12717114483911">peer 2001:DB8:1::1 </strong><strong id="EN-US_TASK_0227779374__b971774414396">advertise encap-type srv6</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1371824413912">*</span>PE3-bgp-af-evpn] <strong id="EN-US_TASK_0227779374__b171818445395">peer 2001:DB8:2::2 enable</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword2718174433911">*</span>PE3-bgp-af-evpn] <strong id="EN-US_TASK_0227779374__b1271894420397">peer 2001:DB8:2::2 </strong><strong id="EN-US_TASK_0227779374__b17718144411392">advertise encap-type srv6</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword20718154443917">*</span>PE3-bgp-af-evpn] <strong id="EN-US_TASK_0227779374__b19718184418393">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1718044123915">*</span>PE3-bgp] <strong id="EN-US_TASK_0227779374__b171834417394">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword15718184413910">*</span>PE3] <strong id="EN-US_TASK_0227779374__b1671810445392">commit</strong></pre>
<p id="EN-US_TASK_0227779374__p1379656748214049">After the configuration is complete, run the <strong id="EN-US_TASK_0227779374__b33881154102416">display bgp evpn peer</strong> command on the PEs to check whether the BGP EVPN peer relationships have been established. If the <strong id="EN-US_TASK_0227779374__b19394954142415">Established</strong> state is displayed in the command output, the BGP EVPN peer relationships have been established successfully.</p>
<p id="EN-US_TASK_0227779374__p105361353143917">The following example uses the command output on PE1.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen129711817437">[<span class="keyword" id="EN-US_TASK_0227779374__keyword5341191116501"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0227779374__b7489814154317">display bgp evpn peer</strong>  

 BGP local router ID : 1.1.1.1                          
 Local AS number : 100                                  
 Total number of peers : 2                 Peers in established state : 2       

  Peer                             V          AS  MsgRcvd  MsgSent  OutQ  Up/Down       State  PrefRcv                              
  2001:DB8:2::2                    4         100      113      111     0 01:32:39 Established        2                              
  2001:DB8:3::3                    4         100      125      122     0 01:43:29 Established        2 </pre>
</p></li><li id="EN-US_TASK_0227779374__step1587265619297"><span id="EN-US_TASK_0227779374__cmd1987275642912">Configure SRv6 BE on the PEs.</span><p><p id="EN-US_TASK_0227779374__p1190171842314"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen19611194892414">[<span class="keyword" id="EN-US_TASK_0227779374__keyword2635148202418"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0227779374__b20635104842418">segment-routing ipv6</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword9635124812410">*</span>PE1-segment-routing-ipv6] <strong id="EN-US_TASK_0227779374__b8635174813245">encapsulation source-address 2001:DB8:1::1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword663513480244">*</span>PE1-segment-routing-ipv6] <strong id="EN-US_TASK_0227779374__b3635184882417">locator PE1 ipv6-prefix 2001:DB8:11:: 64 static 32</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword26351548112418">*</span>PE1-segment-routing-ipv6-locator] <strong id="EN-US_TASK_0227779374__b563519487248">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword12635848142410">*</span>PE1-segment-routing-ipv6] <strong id="EN-US_TASK_0227779374__b3635114820240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword17451154131619">*</span>PE1] <strong id="EN-US_TASK_0227779374__b1645154141617">isis 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword20187232214049">*</span>PE1-isis-1] <strong id="EN-US_TASK_0227779374__b1816798967214049">segment-routing ipv6 locator PE1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword127271939101613">*</span>PE1-isis-1] <strong id="EN-US_TASK_0227779374__b072763981610">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword163644842411">*</span>PE1] <strong id="EN-US_TASK_0227779374__b11636648122414">evpl instance 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1863618481249">*</span>PE1-evpl1] <strong id="EN-US_TASK_0227779374__b17636748162410">segment-routing ipv6 locator PE1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword56361648162418">*</span>PE1-evpl1] <strong id="EN-US_TASK_0227779374__b136369487247">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword96361548132415">*</span>PE1] <strong id="EN-US_TASK_0227779374__b7636134815241">evpn vpn-instance evrf1 vpws</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword66365481244">*</span>PE1-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b1563734882413">segment-routing ipv6 best-effort</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword06376489245">*</span>PE1-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b1637114810240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword763714852418">*</span>PE1] <strong id="EN-US_TASK_0227779374__b1163734812416">commit</strong></pre>
<p id="EN-US_TASK_0227779374__p1490311185230"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen10938141612518">[<span class="keyword" id="EN-US_TASK_0227779374__keyword09491116182510"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0227779374__b8949171611258">segment-routing ipv6</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword149497163258">*</span>PE2-segment-routing-ipv6] <strong id="EN-US_TASK_0227779374__b149498167254">encapsulation source-address 2001:DB8:2::2</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword17949716162512">*</span>PE2-segment-routing-ipv6] <strong id="EN-US_TASK_0227779374__b12949916132511">locator PE2 ipv6-prefix 2001:DB8:21:: 64 static 32</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword79501416142514">*</span>PE2-segment-routing-ipv6-locator] <strong id="EN-US_TASK_0227779374__b13950111662512">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1895071618259">*</span>PE2-segment-routing-ipv6] <strong id="EN-US_TASK_0227779374__b495061612513">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword164111215258">*</span>PE2] <strong id="EN-US_TASK_0227779374__b14117252518">isis 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword541111272511">*</span>PE2-isis-1] <strong id="EN-US_TASK_0227779374__b174117232517">segment-routing ipv6 locator PE2</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword54112272515">*</span>PE2-isis-1] <strong id="EN-US_TASK_0227779374__b174111020250">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1595111632514">*</span>PE2] <strong id="EN-US_TASK_0227779374__b59514161250">evpl instance 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword179511916202519">*</span>PE2-evpl1] <strong id="EN-US_TASK_0227779374__b295111682510">segment-routing ipv6 locator PE2</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword139512016152518">*</span>PE2-evpl1] <strong id="EN-US_TASK_0227779374__b095131611257">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword18951216112516">*</span>PE2] <strong id="EN-US_TASK_0227779374__b18951716142520">evpn vpn-instance evrf1 vpws</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1995151617253">*</span>PE2-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b15951316202510">segment-routing ipv6 best-effort</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1495151613256">*</span>PE2-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b1951516132511">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword12951191642516">*</span>PE2] <strong id="EN-US_TASK_0227779374__b1995141632512">commit</strong></pre>
<p id="EN-US_TASK_0227779374__p181729434275"># Configure PE3.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen1517264362718">[<span class="keyword" id="EN-US_TASK_0227779374__keyword1172243102718"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0227779374__b717294322713">segment-routing ipv6</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1617212431272">*</span>PE3-segment-routing-ipv6] <strong id="EN-US_TASK_0227779374__b1117234372716">encapsulation source-address 2001:DB8:3::3</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword2017204319275">*</span>PE3-segment-routing-ipv6] <strong id="EN-US_TASK_0227779374__b1217204319275">locator PE3 ipv6-prefix 2001:DB8:31:: 64 static 32</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1317215437277">*</span>PE3-segment-routing-ipv6-locator] <strong id="EN-US_TASK_0227779374__b6172194332715">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword91731243152717">*</span>PE3-segment-routing-ipv6] <strong id="EN-US_TASK_0227779374__b1317313430277">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword16251513112513">*</span>PE3] <strong id="EN-US_TASK_0227779374__b1325161312514">isis 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword122561342511">*</span>PE3-isis-1] <strong id="EN-US_TASK_0227779374__b925151316253">segment-routing ipv6 locator PE3</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1125111315258">*</span>PE3-isis-1] <strong id="EN-US_TASK_0227779374__b82514130259">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword181731343112714">*</span>PE3] <strong id="EN-US_TASK_0227779374__b10173204317271">evpl instance 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1117364322714">*</span>PE3-evpl1] <strong id="EN-US_TASK_0227779374__b16173144322714">segment-routing ipv6 locator PE3</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1717364319271">*</span>PE3-evpl1] <strong id="EN-US_TASK_0227779374__b14173843122714">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword11734433270">*</span>PE3] <strong id="EN-US_TASK_0227779374__b10173144315276">evpn vpn-instance evrf1 vpws</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword2173114317275">*</span>PE3-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b11173343142715">segment-routing ipv6 best-effort</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword191736434279">*</span>PE3-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b151731743122710">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword21731443102719">*</span>PE3] <strong id="EN-US_TASK_0227779374__b12173174312276">commit</strong></pre>
<p id="EN-US_TASK_0227779374__p1117143819363">After the configuration is complete, run the <strong id="EN-US_TASK_0227779374__b1751275182512">display segment-routing ipv6 local-sid</strong> <strong id="EN-US_TASK_0227779374__b13517651132520">end-dx2</strong> <strong id="EN-US_TASK_0227779374__b651735113253">forwarding</strong> command on the PEs to check SRv6 BE local SID tables. The following example uses the command output on PE1.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen1791570157214049">[<span class="keyword" id="EN-US_TASK_0227779374__keyword1621532868214049"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0227779374__b136191114375">display segment-routing ipv6 local-sid end-dx2 forwarding</strong>
                   My Local-SID End.DX2 Forwarding Table
                    -------------------------------------                       

SID        : 2001:DB8:11::1:0:20/128                      FuncType : End.DX2    
EVPL ID    : 1                                          
LocatorName: PE1                                          LocatorID: 1          
Flavor     : NO-FLAVOR                                    SidCompress : NO
UpdateTime : 2023-05-10 01:46:05.713

Total SID(s): 1  </pre>
</p></li><li id="EN-US_TASK_0227779374__step936486943214055"><span id="EN-US_TASK_0227779374__cmd628402138214055">Bind the EVPL instance on each PE to an access-side sub-interface.</span><p><p id="EN-US_TASK_0227779374__p5247115214300"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen162471152153014">[<font style="font-size:8pt" Face="Courier New" >~</font>PE1] <strong id="EN-US_TASK_0227779374__b724813529307">interface gigabitethernet <span>0/3/0</span>.1 mode l2</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1524818526301">*</span>PE1-GigabitEthernet<span>0/3/0</span>.1] <strong id="EN-US_TASK_0227779374__b1224825211302">encapsulation dot1q vid 10</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1248155203012">*</span>PE1-GigabitEthernet<span>0/3/0</span>.1] <strong id="EN-US_TASK_0227779374__b12481852123015">evpl instance 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword924885211305">*</span>PE1-GigabitEthernet<span>0/3/0</span>.1] <strong id="EN-US_TASK_0227779374__b924815217305">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword152482521302">*</span>PE1] <strong id="EN-US_TASK_0227779374__b16248145283019">commit</strong></pre>
<p id="EN-US_TASK_0227779374__p2078991624316"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen16789101684319">[<font style="font-size:8pt" Face="Courier New" >~</font>PE2] <strong id="EN-US_TASK_0227779374__b83809390243">lacp e-trunk system-id 00e0-fc00-0000</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword95521231918">*</span>PE2] <strong id="EN-US_TASK_0227779374__b83534610197">lacp e-trunk priority 10</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1293717455248">*</span>PE2] <strong id="EN-US_TASK_0227779374__b117898164434">e-trunk 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1278916162437">*</span>PE2-e-trunk-1] <strong id="EN-US_TASK_0227779374__b378971618433">priority 10</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword478951624319">*</span>PE2-e-trunk-1] <strong id="EN-US_TASK_0227779374__b207892164432">peer-ipv6 2001:DB8:3::3 source-ipv6 2001:DB8:2::2</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword13789716124318">*</span>PE2-e-trunk-1] <strong id="EN-US_TASK_0227779374__b14789141619436">security-key cipher YsHsjx_202206</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword19789716144318">*</span>PE2-e-trunk-1] <strong id="EN-US_TASK_0227779374__b278911616432">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword97901616104319">*</span>PE2] <strong id="EN-US_TASK_0227779374__b37903162431">interface eth-trunk 10</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword516093419599">*</span>PE2-Eth-Trunk10] <strong id="EN-US_TASK_0227779374__b17189121124118">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword15790181664319">*</span>PE2-Eth-Trunk10] <strong id="EN-US_TASK_0227779374__b157901316114310">e-trunk 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword4790516164310">*</span>PE2-Eth-Trunk10] <strong id="EN-US_TASK_0227779374__b137900166435">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword117901616184315">*</span>PE2] <strong id="EN-US_TASK_0227779374__b16790916144313">interface eth-trunk 10.1 mode l2</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword67905169436">*</span>PE2-Eth-Trunk10.1] <strong id="EN-US_TASK_0227779374__b20790216174318">encapsulation dot1q vid 10</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1679020167433">*</span>PE2-Eth-Trunk10.1] <strong id="EN-US_TASK_0227779374__b135812363323">evpl instance 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword6791111684313">*</span>PE2-Eth-Trunk10.1] <strong id="EN-US_TASK_0227779374__b1079131674314">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1079191664318">*</span>PE2] <strong id="EN-US_TASK_0227779374__b1979101612431">interface gigabitethernet <span>0/3/0</span></strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword187911616114317">*</span>PE2-GigabitEthernet<span>0/3/0</span>] <strong id="EN-US_TASK_0227779374__b17792716144310">eth-trunk 10</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword147928162431">*</span>PE2-GigabitEthernet<span>0/3/0</span>] <strong id="EN-US_TASK_0227779374__b179221634310">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1579271654318">*</span>PE2] <strong id="EN-US_TASK_0227779374__b57928169438">commit</strong></pre>
<p id="EN-US_TASK_0227779374__p1062312023214055"># Configure PE3.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen140044515165">[<font style="font-size:8pt" Face="Courier New" >~</font>PE3] <strong id="EN-US_TASK_0227779374__b18852552102411">lacp e-trunk system-id 00e0-fc00-0000</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword5985212121918">*</span>PE3] <strong id="EN-US_TASK_0227779374__b698520129198">lacp e-trunk priority 10</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword11253267255">*</span>PE3] <strong id="EN-US_TASK_0227779374__b444894512166">e-trunk 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword44481845141615">*</span>PE3-e-trunk-1] <strong id="EN-US_TASK_0227779374__b19448134519161">priority 20</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword7448174519168">*</span>PE3-e-trunk-1] <strong id="EN-US_TASK_0227779374__b4523103512420">peer-ipv6 2001:DB8:2::2 source-ipv6 2001:DB8:3::3</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword228210441245">*</span>PE3-e-trunk-1] <strong id="EN-US_TASK_0227779374__b11394941256">security-key cipher YsHsjx_202206</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword154499452161">*</span>PE3-e-trunk-1] <strong id="EN-US_TASK_0227779374__b14449145121613">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword144491645181610">*</span>PE3] <strong id="EN-US_TASK_0227779374__b544914511166">interface eth-trunk 10</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword29871749165910">*</span>PE3-Eth-Trunk10] <strong id="EN-US_TASK_0227779374__b16641241175916">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword444994511169">*</span>PE3-Eth-Trunk10] <strong id="EN-US_TASK_0227779374__b944994518169">e-trunk 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword64491145101614">*</span>PE3-Eth-Trunk10] <strong id="EN-US_TASK_0227779374__b15449445111617">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1145012450163">*</span>PE3] <strong id="EN-US_TASK_0227779374__b1145074519166">interface eth-trunk 10.1 mode l2</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1745012452168">*</span>PE3-Eth-Trunk10.1] <strong id="EN-US_TASK_0227779374__b245094515160">encapsulation dot1q vid 10</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword2450194519162">*</span>PE3-Eth-Trunk10.1] <strong id="EN-US_TASK_0227779374__b41413168336">evpl instance 1</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword19450144541617">*</span>PE3-Eth-Trunk10.1] <strong id="EN-US_TASK_0227779374__b4450645111613">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword14451114516163">*</span>PE3] <strong id="EN-US_TASK_0227779374__b94511445161619">interface gigabitethernet <span>0/3/0</span></strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword154511945181611">*</span>PE3-GigabitEthernet<span>0/3/0</span>] <strong id="EN-US_TASK_0227779374__b1451124561618">eth-trunk 10</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword54518453165">*</span>PE3-GigabitEthernet<span>0/3/0</span>] <strong id="EN-US_TASK_0227779374__b2452745101610">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword19452144591612">*</span>PE3] <strong id="EN-US_TASK_0227779374__b1545274518168">commit</strong></pre>
</p></li><li id="EN-US_TASK_0227779374__step186946247209"><span id="EN-US_TASK_0227779374__cmd6694182412207">Configure a redundancy mode on a per ESI basis on PE2 and PE3.</span><p><p id="EN-US_TASK_0227779374__p2099952033214055"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen99275320212">[<span class="keyword" id="EN-US_TASK_0227779374__keyword16944123152112"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0227779374__b2944163142116">evpn</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1094563202116">*</span>PE2-evpn] <strong id="EN-US_TASK_0227779374__b994533152118">esi 0001.0002.0003.0004.0005</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword109453372119">*</span>PE2-evpn-esi-0001.0002.0003.0004.0005] <strong id="EN-US_TASK_0227779374__b1794583102117">evpn redundancy-mode single-active</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword99454362118">*</span>PE2-evpn-esi-0001.0002.0003.0004.0005] <strong id="EN-US_TASK_0227779374__b179458382119">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword63427134111">*</span>PE2-evpn] <strong id="EN-US_TASK_0227779374__b834251341119">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword14945831211">*</span>PE2] <strong id="EN-US_TASK_0227779374__b149459319218">interface Eth-Trunk 10</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword2094510322118">*</span>PE2-Eth-Trunk10] <strong id="EN-US_TASK_0227779374__b89271250182115">esi 0001.0002.0003.0004.0005</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword59463311213">*</span>PE2-Eth-Trunk10] <strong id="EN-US_TASK_0227779374__b179466315217">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword994618315219">*</span>PE2] <strong id="EN-US_TASK_0227779374__b1794693172114">commit</strong></pre>
<p id="EN-US_TASK_0227779374__p4297191615243"># Configure PE3.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen829741614246">[<span class="keyword" id="EN-US_TASK_0227779374__keyword1029720163243"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0227779374__b192971716142417">evpn</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword6297816122419">*</span>PE3-evpn] <strong id="EN-US_TASK_0227779374__b1629751662414">esi 0001.0002.0003.0004.0005</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword629751618244">*</span>PE3-evpn-esi-0001.0002.0003.0004.0005] <strong id="EN-US_TASK_0227779374__b129751672418">evpn redundancy-mode single-active</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword2029714166244">*</span>PE3-evpn-esi-0001.0002.0003.0004.0005] <strong id="EN-US_TASK_0227779374__b129741617245">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword57997248112">*</span>PE3-evpn] <strong id="EN-US_TASK_0227779374__b1979992481119">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1298121662418">*</span>PE3] <strong id="EN-US_TASK_0227779374__b13298516152417">interface Eth-Trunk 10</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword029831622415">*</span>PE3-Eth-Trunk10] <strong id="EN-US_TASK_0227779374__b152981616192411">esi 0001.0002.0003.0004.0005</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword20298131620241">*</span>PE3-Eth-Trunk10] <strong id="EN-US_TASK_0227779374__b8298111612244">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword629816165243">*</span>PE3] <strong id="EN-US_TASK_0227779374__b102981716122414">commit</strong></pre>
</p></li><li id="EN-US_TASK_0227779374__step1327624377214055"><span id="EN-US_TASK_0227779374__cmd1027811909214055">Configure FRR on the PEs.</span><p><p id="EN-US_TASK_0227779374__p1407336773214055"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen629129475214055">[<span class="keyword" id="EN-US_TASK_0227779374__keyword1282415822214055"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0227779374__b1515437098214055">evpn vpn-instance evrf1 vpws</strong></pre>
<pre class="screen" id="EN-US_TASK_0227779374__screen2020822181214055">[<span class="keyword" id="EN-US_TASK_0227779374__keyword1974373156214055">*</span>PE1-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b1953098825214055">remote frr enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0227779374__screen999689972214055">[<span class="keyword" id="EN-US_TASK_0227779374__keyword1601558499214055">*</span>PE1-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b1160391337214055">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0227779374__screen1824225990214055">[<span class="keyword" id="EN-US_TASK_0227779374__keyword1713429313214055">*</span>PE1] <strong id="EN-US_TASK_0227779374__b2086677390214055">commit</strong></pre>
<p id="EN-US_TASK_0227779374__p413915197334"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen151393196334">[<span class="keyword" id="EN-US_TASK_0227779374__keyword14139819163319"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0227779374__b1214041910335">evpn vpn-instance evrf1 vpws</strong></pre>
<pre class="screen" id="EN-US_TASK_0227779374__screen1314014191338">[<span class="keyword" id="EN-US_TASK_0227779374__keyword714021933319">*</span>PE2-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b141401019133314">local-remote frr enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0227779374__screen101409199338">[<span class="keyword" id="EN-US_TASK_0227779374__keyword1314011913331">*</span>PE2-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b16140111910335">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0227779374__screen4140419183310">[<span class="keyword" id="EN-US_TASK_0227779374__keyword14140131963313">*</span>PE2] <strong id="EN-US_TASK_0227779374__b41401219103317">commit</strong></pre>
<p id="EN-US_TASK_0227779374__p964123694214055"># Configure PE3.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen440618200214055">[<span class="keyword" id="EN-US_TASK_0227779374__keyword952673679214055"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0227779374__b1198022635214055">evpn vpn-instance evrf1 vpws</strong></pre>
<pre class="screen" id="EN-US_TASK_0227779374__screen1188305306214055">[<span class="keyword" id="EN-US_TASK_0227779374__keyword1267076197214055">*</span>PE3-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b777893253214055">local-remote frr enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0227779374__screen1956599018214055">[<span class="keyword" id="EN-US_TASK_0227779374__keyword237965053214055">*</span>PE3-vpws-evpn-instance-evrf1] <strong id="EN-US_TASK_0227779374__b1561201985214055">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0227779374__screen2043589680214055">[<span class="keyword" id="EN-US_TASK_0227779374__keyword814757218214055">*</span>PE3] <strong id="EN-US_TASK_0227779374__b707380068214055">commit</strong></pre>
</p></li><li id="EN-US_TASK_0227779374__step481610319479"><span id="EN-US_TASK_0227779374__cmd1481616318471">Configure CE access to the PEs.</span><p><p id="EN-US_TASK_0227779374__p14459544141820"># Configure CE1.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen74595447182">&lt;CE1&gt; <strong id="EN-US_TASK_0227779374__b846441013245">system-view</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>CE1] <strong id="EN-US_TASK_0227779374__b1489312419242">vlan 10</strong> 
[*CE1-vlan10] <strong id="EN-US_TASK_0227779374__b821832112410">quit</strong>           
[*CE1] <strong id="EN-US_TASK_0227779374__b13443162518394">interface </strong><strong id="EN-US_TASK_0227779374__b107085575218">gigabitethernet <span>0/1/0</span></strong>
[*CE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b5466102342213">portswitch</strong>
[*CE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b184742615220">undo shutdown</strong>
[*CE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b14490133002217">port link-type trunk</strong>
[*CE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b17857163114221">port trunk allow-pass vlan 1</strong><strong id="EN-US_TASK_0227779374__b8847161264912">0</strong>
[*CE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b19391185615238">commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>CE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b10845125892311">quit</strong></pre>
<p id="EN-US_TASK_0227779374__p1166371942416"># Configure CE2.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen101943469218">&lt;CE2&gt; <strong id="EN-US_TASK_0227779374__b128718146432">system-view</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>CE2] <strong id="EN-US_TASK_0227779374__b3871714194319">vlan 10</strong>
[*CE2-vlan10] <strong id="EN-US_TASK_0227779374__b7872101412431">quit</strong> 
[<span class="keyword" id="EN-US_TASK_0227779374__keyword332819208437">*</span>CE2] <strong id="EN-US_TASK_0227779374__b919411460211">interface Eth-Trunk10</strong>
[*CE2-Eth-Trunk10] <strong id="EN-US_TASK_0227779374__b1468620344439">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword6618797545">*</span>CE2-Eth-Trunk10] <strong id="EN-US_TASK_0227779374__b761810955412">mode lacp-static</strong>
[*CE2-Eth-Trunk10] <strong id="EN-US_TASK_0227779374__b2068773434315">undo shutdown</strong>
[*CE2-Eth-Trunk10] <strong id="EN-US_TASK_0227779374__b76871234164314">port link-type trunk</strong>
[*CE2-Eth-Trunk10] <strong id="EN-US_TASK_0227779374__b17687183474318">port trunk allow-pass vlan 10</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1802175717568">*</span>CE2-Eth-Trunk10] <strong id="EN-US_TASK_0227779374__b4194146925">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword8195646526">*</span>CE2] <strong id="EN-US_TASK_0227779374__b619512465219">interface gigabitethernet <span>0/1/0</span></strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword1235114719574">*</span>CE2-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b176895130412">undo shutdown</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword947911895717">*</span>CE2-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b735311278412">eth-trunk 10</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword181957463219">*</span>CE2-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0227779374__b161955462027">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword39155342041">*</span>CE2] <strong id="EN-US_TASK_0227779374__b391515341649">interface gigabitethernet </strong><strong id="EN-US_TASK_0227779374__b2586153516715"><span>0/2/0</span></strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword394216917573">*</span>CE2-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0227779374__b991533412410">undo shutdown</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword16722111116574">*</span>CE2-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0227779374__b591513341347">eth-trunk 10</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword2091518341412">*</span>CE2-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0227779374__b191515341248">quit</strong>
[<span class="keyword" id="EN-US_TASK_0227779374__keyword61959461926">*</span>CE2] <strong id="EN-US_TASK_0227779374__b919510461220">commit</strong></pre>
</p><p><p id="EN-US_TASK_0227779374__p138822194549">After the configuration is complete, the corresponding Eth-Trunk should be up. Run the <a href="cmdqueryname=display+eth-trunk"><b><span class="cmdname" id="EN-US_TASK_0227779374__cmdname6161123545512">display eth-trunk</span></b></a> command on PE2 and PE3 to check the Eth-Trunk status.</p>
<p id="EN-US_TASK_0227779374__p1917319486572">Command output on PE2:</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen176194395715">[<font style="font-size:8pt" Face="Courier New" >~</font>PE2]<strong id="EN-US_TASK_0227779374__b371112645812"> display eth-trunk 10</strong>                              
Eth-Trunk10's state information is:                     
WorkingMode: NORMAL          Hash arithmetic: According to flow                 
Least Active-linknumber: 1   Max Bandwidth-affected-linknumber: 32              
Operate status: up           Number Of Up Ports In Trunk: 1                     
--------------------------------------------------------------------------------
PortName                      Status      Weight        
GigabitEthernet<span>0/3/0</span>          <strong id="EN-US_TASK_0227779374__b065515585910">Up</strong>          1               </pre>
<p id="EN-US_TASK_0227779374__p17260144205818">Command output on PE3:</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen958145813588">[<font style="font-size:8pt" Face="Courier New" >~</font>PE3] <strong id="EN-US_TASK_0227779374__b17566153715599">display eth-trunk 10</strong>   
Eth-Trunk10's state information is:                     
WorkingMode: NORMAL          Hash arithmetic: According to flow                 
Least Active-linknumber: 1   Max Bandwidth-affected-linknumber: 32              
Operate status: down         Number Of Up Ports In Trunk: 0                     
--------------------------------------------------------------------------------
PortName                      Status      Weight        
GigabitEthernet<span>0/3/0</span>          <strong id="EN-US_TASK_0227779374__b1580683616173">Down</strong>        1               </pre>
<p id="EN-US_TASK_0227779374__p1183123214185">According to the status of Eth-Trunk 10 shown in the preceding command output, PE2 and PE3 are in master and backup states, respectively. That is, only PE2 is active.</p>
</p></li><li id="EN-US_TASK_0227779374__step1789365703214049"><span id="EN-US_TASK_0227779374__cmd508377733214049">Verify the configuration.</span><p><p id="EN-US_TASK_0227779374__p378915480596">Run the <strong id="EN-US_TASK_0227779374__b144722172819">display bgp evpn all routing-table</strong> command on each PE. The command output shows the EVPN routes sent from the peer end. The following example uses the command output on PE1.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen87896487591">[<span class="keyword" id="EN-US_TASK_0227779374__keyword177891948165914"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0227779374__b778911489594">display bgp evpn all routing-table</strong>

 Local AS number : 100                                  

 BGP Local router ID is 1.1.1.1                         
 Status codes: * - valid, &gt; - best, d - damped, x - best external, a - add path,
               h - history,  i - internal, s - suppressed, S - Stale
               Origin : i - IGP, e - EGP, ? - incomplete


 EVPN address family:                                   
 Number of A-D Routes: 5                                
 Route Distinguisher: 100:1                             
       Network(ESI/EthTagId)                                  NextHop           
 *&gt;    0000.0000.0000.0000.0000:100                           127.0.0.1         
 Route Distinguisher: 200:1                             
       Network(ESI/EthTagId)                                  NextHop           
 *&gt;i   0001.0002.0003.0004.0005:200                           2001:DB8:2::2     
 Route Distinguisher: 300:1                             
       Network(ESI/EthTagId)                                  NextHop           
 *&gt;i   0001.0002.0003.0004.0005:200                           2001:DB8:3::3     
 Route Distinguisher: 2.2.2.2:0                         
       Network(ESI/EthTagId)                                  NextHop           
 *&gt;i   0001.0002.0003.0004.0005:4294967295                    2001:DB8:2::2     
 Route Distinguisher: 3.3.3.3:0                         
       Network(ESI/EthTagId)                                  NextHop           
 *&gt;i   0001.0002.0003.0004.0005:4294967295                    2001:DB8:3::3     


 EVPN-Instance evrf1:                                   
 Number of A-D Routes: 5                                
       Network(ESI/EthTagId)                                  NextHop           
 *&gt;    0000.0000.0000.0000.0000:100                           127.0.0.1         
 *&gt;i   0001.0002.0003.0004.0005:200                           2001:DB8:2::2     
 * i                                                          2001:DB8:3::3                                       
 *&gt;i   0001.0002.0003.0004.0005:4294967295                    2001:DB8:2::2     
 * i                                                          2001:DB8:3::3 </pre>
<p id="EN-US_TASK_0227779374__p6790184815591">Run the <strong id="EN-US_TASK_0227779374__b1936595082816">display bgp evpn all routing-table ad-route</strong> command on PE1. The command output shows the A-D EVPN routes sent from the peer end.</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen27909488598">[<font style="font-size:8pt" Face="Courier New" >~</font>PE1] <strong id="EN-US_TASK_0227779374__b20790184811595">display bgp evpn all routing-table ad-route 0001.0002.0003.0004.0005:200</strong> 

 BGP local router ID : 1.1.1.1                          
 Local AS number : 100                                  
 Total routes of Route Distinguisher(200:1): 1          
 BGP routing table entry information of 0001.0002.0003.0004.0005:200:           
 Label information (Received/Applied): 3/NULL           
 From: 2001:DB8:2::2 (2.2.2.2)                          
 Route Duration: 0d00h18m33s                            
 Relay IP Nexthop: FE80::3AC2:67FF:FE31:307             
 Relay IP Out-Interface:GigabitEthernet<span>0/1/0</span>                   
 Relay Tunnel Out-Interface:                            
 Original nexthop: 2001:DB8:2::2                        
 Qos information : 0x0                                  
 Ext-Community: RT &lt;1 : 1&gt;, SoO &lt;2.2.2.2 : 0&gt;, EVPN L2 Attributes &lt;MTU:1500 C:0 P:1 B:0&gt;           
 Prefix-sid: 2001:DB8:21::1:0:3E, Endpoint Behavior: DX2(21)                        
 AS-path Nil, origin incomplete, localpref 100, pref-val 0, valid, internal, best, select, pre 255, IGP cost 10                     
 Route Type: 1 (Ethernet Auto-Discovery (A-D) route)    
 ESI: 0001.0002.0003.0004.0005, Ethernet Tag ID: 200    
 Not advertised to any peer yet                         

 Total routes of Route Distinguisher(300:1): 1          
 BGP routing table entry information of 0001.0002.0003.0004.0005:200: 
 Label information (Received/Applied): 3/NULL           
 From: 2001:DB8:3::3 (3.3.3.3)                          
 Route Duration: 0d00h01m06s                            
 Relay IP Nexthop: FE80::3AC2:67FF:FE41:305             
 Relay IP Out-Interface:GigabitEthernet<span>0/2/0</span>                   
 Relay Tunnel Out-Interface:                            
 Original nexthop: 2001:DB8:3::3                        
 Qos information : 0x0                                  
 Ext-Community: RT &lt;1 : 1&gt;, SoO &lt;3.3.3.3 : 0&gt;, EVPN L2 Attributes &lt;MTU:1500 C:0 P:0 B:1&gt;           
 Prefix-sid: 2001:DB8:31::1:0:3E, Endpoint Behavior: DX2(21)                        
 AS-path Nil, origin incomplete, localpref 100, pref-val 0, valid, internal, best, select, pre 255, IGP cost 10                     
 Route Type: 1 (Ethernet Auto-Discovery (A-D) route)    
 ESI: 0001.0002.0003.0004.0005, Ethernet Tag ID: 200    
 Not advertised to any peer yet                         



 EVPN-Instance evrf1:                                   
 Number of A-D Routes: 2                                
 BGP routing table entry information of 0001.0002.0003.0004.0005:200:           
 Route Distinguisher: 200:1                             
 Remote-Cross route 
 Label information (Received/Applied): 3/NULL           
 From: 2001:DB8:2::2 (2.2.2.2)                          
 Route Duration: 0d00h18m45s                            
 Relay IP Nexthop: FE80::3AC2:67FF:FE31:307             
 Relay IP Out-Interface:GigabitEthernet<span>0/1/0</span>                   
 Relay Tunnel Out-Interface:                            
 Original nexthop: 2001:DB8:2::2                        
 Qos information : 0x0                                  
 Ext-Community: RT &lt;1 : 1&gt;, SoO &lt;2.2.2.2 : 0&gt;, EVPN L2 Attributes &lt;MTU:1500 C:0 P:1 B:0&gt;           
 Prefix-sid: 2001:DB8:21::1:0:3E, Endpoint Behavior: DX2(21)                        
 AS-path Nil, origin incomplete, localpref 100, pref-val 0, valid, internal, best, <strong id="EN-US_TASK_0227779374__b9409192882018">select</strong>, pre 255, IGP cost 10                     
 Route Type: 1 (Ethernet Auto-Discovery (A-D) route)    
 ESI: 0001.0002.0003.0004.0005, Ethernet Tag ID: 200    
 Not advertised to any peer yet                         

 BGP routing table entry information of 0001.0002.0003.0004.0005:200:           
 Route Distinguisher: 300:1                             
 Remote-Cross route                                     
 Label information (Received/Applied): 3/NULL           
 From: 2001:DB8:3::3 (3.3.3.3)                          
 Route Duration: 0d00h01m19s                            
 Relay IP Nexthop: FE80::3AC2:67FF:FE41:305
 Relay IP Out-Interface:GigabitEthernet<span>0/2/0</span>                   
 Relay Tunnel Out-Interface:                            
 Original nexthop: 2001:DB8:3::3                        
 Qos information : 0x0                                  
 Ext-Community: RT &lt;1 : 1&gt;, SoO &lt;3.3.3.3 : 0&gt;, EVPN L2 Attributes &lt;MTU:1500 C:0 P:0 B:1&gt;           
 Prefix-sid: 2001:DB8:31::1:0:3E, Endpoint Behavior: DX2(21)                        
 AS-path Nil, origin incomplete, localpref 100, pref-val 0, valid, internal, pre 255, IGP cost 10, not preferred for L2 ext-community   
 Route Type: 1 (Ethernet Auto-Discovery (A-D) route)    
 ESI: 0001.0002.0003.0004.0005, Ethernet Tag ID: 200    
 Not advertised to any peer yet   </pre>
<p id="EN-US_TASK_0227779374__p5460532191420">According to the preceding command output, the EVPN instance evrf1 has one preferred route 0001.0002.0003.0004.0005:200 with the next hop being PE2. Although an active route with the next hop being PE3 exists, it is not the preferred route. This indicates that dual-homing single-active networking has been configured properly.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0227779374__section_dc_vrp_srv6_cfg_all_002205"><a name="EN-US_TASK_0227779374__section_dc_vrp_srv6_cfg_all_002205"></a><a name="section_dc_vrp_srv6_cfg_all_002205"></a><a name="EN-US_TASK_0227779374__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul id="EN-US_TASK_0227779374__ul499006314214049"><li id="EN-US_TASK_0227779374__li1745977844214049"><p id="EN-US_TASK_0227779374__p1433071500214049"><a name="EN-US_TASK_0227779374__li1745977844214049"></a><a name="li1745977844214049"></a>PE1 configuration file</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen231310178436">#
sysname PE1
#
evpn vpn-instance evrf1 vpws
 route-distinguisher 100:1
 segment-routing ipv6 best-effort
<strong id="EN-US_TASK_0227779374__b6860125063415"> </strong>remote frr enable
 vpn-target 1:1 export-extcommunity
 vpn-target 1:1 import-extcommunity
#
evpl instance 1
 evpn binding vpn-instance evrf1
 local-service-id 100 remote-service-id 200
 segment-routing ipv6 locator PE1
#               
segment-routing ipv6
 encapsulation source-address 2001:db8:1::1
 locator PE1 ipv6-prefix 2001:DB8:11:: 64 static 32
#               
isis 1          
 is-level level-1
 cost-style wide
 network-entity 10.0000.0000.0001.00
 #              
 ipv6 enable topology ipv6
 segment-routing ipv6 locator PE1
 #              
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable    
 ipv6 address 2001:DB8:10::1/64
 isis ipv6 enable 1
# 
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown  
 ipv6 enable    
 ipv6 address 2001:DB8:20::1/64
 isis ipv6 enable 1
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
#
interface GigabitEthernet<span>0/3/0</span>.1 mode l2
 encapsulation dot1q vid 10
 evpl instance 1
#
interface LoopBack1
 ipv6 enable    
 ip address 1.1.1.1 255.255.255.255
 ipv6 address 2001:DB8:1::1/128
 isis ipv6 enable 1
#               
bgp 100         
 router-id 1.1.1.1
 peer 2001:DB8:2::2 as-number 100
 peer 2001:DB8:2::2 connect-interface LoopBack1
 peer 2001:DB8:3::3 as-number 100
 peer 2001:DB8:3::3 connect-interface LoopBack1
 #              
 ipv4-family unicast
  undo synchronization
 #              
 l2vpn-family evpn
  policy vpn-target
  peer 2001:DB8:2::2 enable
  peer 2001:DB8:2::2 advertise encap-type srv6
  peer 2001:DB8:3::3 enable
  peer 2001:DB8:3::3 advertise encap-type srv6
#
evpn source-address 1.1.1.1
#
return</pre>
</li><li id="EN-US_TASK_0227779374__li10802458155018">PE2 configuration file<pre class="screen" id="EN-US_TASK_0227779374__screen8255758204910">#
sysname PE2
#
lacp e-trunk system-id 00e0-fc00-0000
lacp e-trunk priority 10
#
evpn
 #  
 mac-duplication 
 #
 esi 0001.0002.0003.0004.0005
  evpn redundancy-mode single-active
#
evpn vpn-instance evrf1 vpws
 route-distinguisher 200:1
 segment-routing ipv6 best-effort
 local-remote frr enable
 vpn-target 1:1 export-extcommunity
 vpn-target 1:1 import-extcommunity
#
evpl instance 1
 evpn binding vpn-instance evrf1
 local-service-id 200 remote-service-id 100
 segment-routing ipv6 locator PE2
#
e-trunk 1
 priority 10
 peer-ipv6 2001:DB8:3::3 source-ipv6 2001:DB8:2::2
 security-key cipher %^%#VQE;E!Dl&amp;Rr]if$F&gt;}w9uk5C&gt;y-4|MS$unQ!#Mb#%^%#
#               
segment-routing ipv6
 encapsulation source-address 2001:db8:2::2
 locator PE2 ipv6-prefix 2001:DB8:21:: 64 static 32
#               
isis 1          
 is-level level-1
 cost-style wide
 network-entity 10.0000.0000.0002.00
 #              
 ipv6 enable topology ipv6
 segment-routing ipv6 locator PE2 
 # 
#
interface Eth-Trunk10
 mode lacp-static
 e-trunk 1
 esi 0001.0002.0003.0004.0005
#
interface Eth-Trunk10.1 mode l2
 encapsulation dot1q vid 10
 evpl instance 1
# 
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ipv6 enable    
 ipv6 address 2001:DB8:10::2/64
 isis ipv6 enable 1
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ipv6 enable    
 ipv6 address 2001:DB8:30::1/64
 isis ipv6 enable 1
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 eth-trunk 10
#
interface LoopBack1
 ipv6 enable    
 ip address 2.2.2.2 255.255.255.255
 ipv6 address 2001:DB8:2::2/128
 isis ipv6 enable 1
#               
bgp 100         
 router-id 2.2.2.2
 peer 2001:DB8:1::1 as-number 100
 peer 2001:DB8:1::1 connect-interface LoopBack1
 peer 2001:DB8:3::3 as-number 100
 peer 2001:DB8:3::3 connect-interface LoopBack1
 #              
 ipv4-family unicast
  undo synchronization
 #              
 l2vpn-family evpn
  policy vpn-target
  peer 2001:DB8:1::1 enable
  peer 2001:DB8:1::1 advertise encap-type srv6
  peer 2001:DB8:3::3 enable
  peer 2001:DB8:3::3 advertise encap-type srv6
#
evpn source-address 2.2.2.2
#
return</pre>
</li><li id="EN-US_TASK_0227779374__li1824096835214049"><p id="EN-US_TASK_0227779374__p118961273214049"><a name="EN-US_TASK_0227779374__li1824096835214049"></a><a name="li1824096835214049"></a>PE3 configuration file</p>
<pre class="screen" id="EN-US_TASK_0227779374__screen1681814272504">#
sysname PE3
#
lacp e-trunk system-id 00e0-fc00-0000
lacp e-trunk priority 10
#
evpn
 #  
 mac-duplication 
 #
 esi 0001.0002.0003.0004.0005
  evpn redundancy-mode single-active
#
evpn vpn-instance evrf1 vpws
 route-distinguisher 300:1
 segment-routing ipv6 best-effort
<strong id="EN-US_TASK_0227779374__b107361717183512"> </strong>local-remote frr enable
 vpn-target 1:1 export-extcommunity
 vpn-target 1:1 import-extcommunity
#
evpl instance 1
 evpn binding vpn-instance evrf1
 local-service-id 200 remote-service-id 100
 segment-routing ipv6 locator PE3
#
e-trunk 1
 priority 20
 peer-ipv6 2001:DB8:2::2 source-ipv6 2001:DB8:3::3
 security-key cipher %^%#!8C!"bAoc<font style="font-size:8pt" Face="Courier New" >~</font>O}UW2)%$HP4%.G9179.;&amp;Yr[GmV.PN%^%#
#               
segment-routing ipv6
 encapsulation source-address 2001:db8:3::3
 locator PE3 ipv6-prefix 2001:DB8:31:: 64 static 32
#               
isis 1          
 is-level level-1
 cost-style wide
 network-entity 10.0000.0000.0003.00
 #              
 ipv6 enable topology ipv6
 segment-routing ipv6 locator PE3
 #              
#
interface Eth-Trunk10
 mode lacp-static
 e-trunk 1
 esi 0001.0002.0003.0004.0005
#
interface Eth-Trunk10.1 mode l2
 encapsulation dot1q vid 10
 evpl instance 1
# 
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ipv6 enable    
 ipv6 address 2001:DB8:20::2/64
 isis ipv6 enable 1
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ipv6 enable    
 ipv6 address 2001:DB8:30::2/64
 isis ipv6 enable 1
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 eth-trunk 10
#
interface LoopBack1
 ipv6 enable    
 ip address 3.3.3.3 255.255.255.255
 ipv6 address 2001:DB8:3::3/128
 isis ipv6 enable 1
#               
bgp 100         
 router-id 3.3.3.3
 peer 2001:DB8:1::1 as-number 100
 peer 2001:DB8:1::1 connect-interface LoopBack1
 peer 2001:DB8:2::2 as-number 100
 peer 2001:DB8:2::2 connect-interface LoopBack1
 #              
 ipv4-family unicast
  undo synchronization
 #              
 l2vpn-family evpn
  policy vpn-target
  peer 2001:DB8:1::1 enable
  peer 2001:DB8:1::1 advertise encap-type srv6
  peer 2001:DB8:2::2 enable
  peer 2001:DB8:2::2 advertise encap-type srv6
#
evpn source-address 3.3.3.3
#
return</pre>
</li><li id="EN-US_TASK_0227779374__li421510185119">CE1 configuration file<pre class="screen" id="EN-US_TASK_0227779374__screen15215120105111">#
sysname CE1
#
vlan batch 10
#
interface GigabitEthernet<span>0/1/0</span>
 portswitch
 undo shutdown
 port link-type trunk
 port trunk allow-pass vlan 10
#
return</pre>
</li><li id="EN-US_TASK_0227779374__li12503356125019">CE2 configuration file<pre class="screen" id="EN-US_TASK_0227779374__screen7337152162211">#
sysname CE2
#
vlan batch 10
#
interface Eth-Trunk10
 mode lacp-static
 portswitch
 port link-type trunk
 port trunk allow-pass vlan 10
#   
interface GigabitEthernet<span>0/1/0</span> 
 undo shutdown
 eth-trunk 10
#                    
interface GigabitEthernet<span>0/2/0</span> 
 undo shutdown
 eth-trunk 10
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0010.html">Configuration Examples for SRv6 BE (IS-IS)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0233.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0024.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>