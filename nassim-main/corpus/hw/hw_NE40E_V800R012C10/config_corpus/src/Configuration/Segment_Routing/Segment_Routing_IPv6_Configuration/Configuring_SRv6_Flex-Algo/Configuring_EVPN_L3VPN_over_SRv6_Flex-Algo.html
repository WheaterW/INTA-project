
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring EVPN L3VPN over SRv6 Flex-Algo">
<meta name="abstract" content="This section describes how to configure EVPN L3VPN over SRv6 Flex-Algo.">
<meta name="description" content="This section describes how to configure EVPN L3VPN over SRv6 Flex-Algo.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0003.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0004.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0006.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00587852">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00587852">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0279862419">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring EVPN L3VPN over SRv6 Flex-Algo</title>
</head>
<body><a name="EN-US_TASK_0279862419"></a><a name="EN-US_TASK_0279862419"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring EVPN L3VPN over SRv6 Flex-Algo</h1>
<div class="taskbody"><p>This section describes how to configure EVPN L3VPN over SRv6 Flex-Algo.</p>
<div class="context"><a name="EN-US_TASK_0279862419__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Context</h4><p>When SRv6 uses an IGP to calculate paths, it can associate locators with Flex-Algos to ensure that calculated SRv6 BE paths meet specific requirements.</p>
<p>EVPN L3VPN over SRv6 Flex-Algo uses forwarding paths calculated based on Flex-Algos to carry L3VPNv4/L3VPNv6 services on the public network.</p>
<p>On the network shown in <a href="#EN-US_TASK_0279862419__fig_dc_vrp_srv6_cfg_all_001201">Figure 1</a>, multiple links exist between PEs. You can configure the PEs to forward L3VPNv4/L3VPNv6 services over a path calculated using a specified Flex-Algo.</p>
<div class="fignone" id="EN-US_TASK_0279862419__fig_dc_vrp_srv6_cfg_all_001201"><a name="EN-US_TASK_0279862419__fig_dc_vrp_srv6_cfg_all_001201"></a><a name="fig_dc_vrp_srv6_cfg_all_001201"></a><span class="figcap"><b>Figure 1 </b>EVPN L3VPN over SRv6 Flex-Algo networking</span><br><span><img class="vsd" src="figure/en-us_image_0279951879.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0279862419__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p id="EN-US_TASK_0279862419__en-us_task_0279788926_p1931381649214047">Before performing the configuration, complete the following tasks:</p>
<ul id="EN-US_TASK_0279862419__en-us_task_0279788926_ul364559111214047"><li id="EN-US_TASK_0279862419__en-us_task_0279788926_li232742186214047"><p id="EN-US_TASK_0279862419__en-us_task_0279788926_p1130198915214047"><a name="EN-US_TASK_0279862419__en-us_task_0279788926_li232742186214047"></a><a name="en-us_task_0279788926_li232742186214047"></a>Configure IS-IS to enable devices to communicate at the network layer.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0279788926_li8287434286"><a href="dc_vrp_isis_cfg_0094.html">Enable the advertisement of IPv6 delay information</a> if the Flex-Algo metric type is <strong id="EN-US_TASK_0279862419__en-us_task_0279788926_b1485718212910">delay</strong>.</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0279862419__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure Flex-Algo link attributes.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=te+attribute+enable"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname148421956578">te attribute enable</span></b></a></span><p><p id="EN-US_TASK_0279862419__en-us_task_0278918435_p612815528372">TE is enabled.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=path-constraint+affinity-mapping"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname1619796488214045">path-constraint affinity-mapping</span></b></a></span><p><p id="EN-US_TASK_0279862419__en-us_task_0278918435_p15810201203318">An affinity name template is configured, and the affinity mapping view is displayed.</p>
</p><p><p id="EN-US_TASK_0279862419__en-us_task_0278918435_p562453713516">This template must be configured on each node that is involved in path computation, and the same mappings between affinity bit values and names must be configured on each node.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=attribute"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname555721974214045">attribute</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0278918435_varname461987895214045">bit-name</span></i> <strong><span id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdparmname540479071214045">bit-sequence</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0278918435_varname1251182469214045">bit-number</span></i> Mappings between affinity bit values and names are configured.</span><p><p id="EN-US_TASK_0279862419__en-us_task_0278918435_p166261437185112">This step configures only one bit of an affinity attribute, which has a total of 128 bits. Repeat this step as needed to configure some or all of the bits.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Use either of the following methods to configure Flex-Algo link attributes.</span><p><ul><li>Inherit interface TE attributes.<ol class="substepthirdol"><li id="EN-US_TASK_0279862419__en-us_task_0278918435_li174231416142314">Run <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname2436102811599">interface</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0278918435_varname19436828165914">interface-type</span></i> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0278918435_varname13436228195918">interface-number</span></i><p id="EN-US_TASK_0279862419__en-us_task_0278918435_p043993755910">The interface view is displayed.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0278918435_li123981182235">Run <a href="cmdqueryname=te+link+administrative+group+name"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname86881832183016">te link administrative group name</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0278918435_varname9688232123012">bit-name</span></i> &amp;&lt;1-32&gt;<p id="EN-US_TASK_0279862419__en-us_task_0278918435_p14418333163018">The link administrative group attribute is configured. The <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0278918435_varname837924148214045">bit-name</span></i> value must be in the range specified in the affinity name template.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0278918435_li496793911236">Run <a href="cmdqueryname=te+metric"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname18151501017">te metric</span></b></a><strong id="EN-US_TASK_0279862419__en-us_task_0278918435_b11156012015"> </strong><i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0278918435_varname615406019">metric-value</span></i><p id="EN-US_TASK_0279862419__en-us_task_0278918435_p47301817013">The TE metric of the link is configured.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0278918435_li12135911122418">Run <a href="cmdqueryname=te+link-attribute-application+flex-algo"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname943510229019">te link-attribute-application flex-algo</span></b></a><p id="EN-US_TASK_0279862419__en-us_task_0278918435_p1095442312019">The Flex-Algo link attribute application view is created and displayed.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0278918435_li555111129241">Run <a href="cmdqueryname=te+inherit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname1487514351408">te inherit</span></b></a><p id="EN-US_TASK_0279862419__en-us_task_0278918435_p528379016">The interface TE attributes are inherited.</p>
<p id="EN-US_TASK_0279862419__en-us_task_0278918435_p1957413511819">After the <a href="cmdqueryname=te+inherit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname135751910525">te inherit</span></b></a> command is run, the Flex-Algo link inherits the <a href="cmdqueryname=te+metric"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname266019263215">te metric</span></b></a> and <a href="cmdqueryname=te+link+administrative+group+name"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname181301411620">te link administrative group name</span></b></a> command configurations on the interface.</p>
<p id="EN-US_TASK_0279862419__en-us_task_0278918435_p4925165682614">In the Flex-Algo link attribute application view, the <a href="cmdqueryname=te+inherit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname69091848729">te inherit</span></b></a> command is mutually exclusive from the <a href="cmdqueryname=metric"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname13397556129">metric</span></b></a> and <a href="cmdqueryname=link+administrative+group+name"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname57185414315">link administrative group name</span></b></a> commands.</p>
</li></ol>
</li><li>Configure Flex-Algo link attributes separately.<ol class="substepthirdol"><li id="EN-US_TASK_0279862419__en-us_task_0278918435_li1571518262315">Run <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname17572161812118">interface</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0278918435_varname145721518714">interface-type</span></i> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0278918435_varname1257231810115">interface-number</span></i><p id="EN-US_TASK_0279862419__en-us_task_0278918435_p17799192110">The interface view is displayed.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0278918435_li69111442245">Run <a href="cmdqueryname=te+link-attribute-application+flex-algo"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname283143011115">te link-attribute-application flex-algo</span></b></a><p id="EN-US_TASK_0279862419__en-us_task_0278918435_p13148123118114">The Flex-Algo link attribute application view is created and displayed.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0278918435_li18822185552415">Run <a href="cmdqueryname=link+administrative+group+name"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname156111248125819">link administrative group name</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0278918435_varname1061215484588">name-string</span></i> &amp;&lt;1-128&gt;<p id="EN-US_TASK_0279862419__en-us_task_0278918435_p7579149175817">The link administrative group attribute of the Flex-Algo link is configured. The <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0278918435_varname927452111256">name-string</span></i> value must be in the range specified in the affinity name template.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0278918435_li125821511253">(Optional) Run <a href="cmdqueryname=delay"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname1885310481913">delay</span></b></a><strong id="EN-US_TASK_0279862419__en-us_task_0278918435_b10853148515"> </strong><i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0278918435_varname28534483118">delay-value</span></i><p id="EN-US_TASK_0279862419__en-us_task_0278918435_p17666164915110">The Flex-Algo link delay is configured.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0278918435_li157181613152514">(Optional) Run <a href="cmdqueryname=metric"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0278918435_cmdname1629818552013">metric</span></b></a><strong id="EN-US_TASK_0279862419__en-us_task_0278918435_b729835514110"> </strong><i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0278918435_varname629825516120">metric-value</span></i><p id="EN-US_TASK_0279862419__en-us_task_0278918435_p441814564110">The Flex-Algo link metric is configured.</p>
</li></ol>
</li></ul>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the interface view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li></ol>
</li><li><span>Configure a FAD.</span><ol type="a" id="EN-US_TASK_0279862419__en-us_task_0279788926_substeps1935311167717"><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0279788926_substep647315251719"><span id="EN-US_TASK_0279862419__en-us_task_0279788926_cmd74731525479">Run <a href="cmdqueryname=flex-algo+identifier"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdname138921432112611">flex-algo identifier</span></b></a><strong id="EN-US_TASK_0279862419__en-us_task_0279788926_b1696033082613"> </strong><i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0279788926_varname73555396262">flexAlgoId</span></i></span><p><p id="EN-US_TASK_0279862419__en-us_task_0279788926_p48554392512">A Flex-Algo is created, and the Flex-Algo view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0279788926_substep453719268713"><span id="EN-US_TASK_0279862419__en-us_task_0279788926_cmd1853782610715">Run <a href="cmdqueryname=priority"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdname3464121416312">priority</span></b></a><strong id="EN-US_TASK_0279862419__en-us_task_0279788926_b94271312103111"> </strong><i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0279788926_varname1196214191316">priority-value</span></i></span><p><p id="EN-US_TASK_0279862419__en-us_task_0279788926_p70154714519">The priority of the Flex-Algo is configured.</p>
</p><p><p id="EN-US_TASK_0279862419__en-us_task_0279788926_p75202581173">A larger value indicates a higher priority.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0279788926_substep117524262711"><span id="EN-US_TASK_0279862419__en-us_task_0279788926_cmd075211268712">Run <a href="cmdqueryname=metric-type"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdname17300121151715">metric-type</span></b></a> { <strong><span id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdparmname195025956825953">igp</span></strong> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdparmname185990906725953">delay</span></strong> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdparmname190494133425953">te</span></strong> }</span><p><p id="EN-US_TASK_0279862419__en-us_task_0279788926_p11121185510514">The Metric-Type of the Flex-Algo is configured.</p>
</p><p><p id="EN-US_TASK_0279862419__en-us_task_0279788926_p10791145184615">After this command is run, links must have the corresponding metric type. Otherwise, these links will be pruned and cannot participate in IGP path calculation.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0279788926_substep1494652612720"><span id="EN-US_TASK_0279862419__en-us_task_0279788926_cmd59461267717">Run <a href="cmdqueryname=affinity"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdname206941846161618">affinity</span></b></a> { <strong><span id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdparmname96941246191619">include-all</span></strong> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdparmname2694184621614">include-any</span></strong> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdparmname269434671610">exclude</span></strong> } { <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0279788926_varname66941046151614">name-string</span></i> } &amp;&lt;1-32&gt;</span><p><p id="EN-US_TASK_0279862419__en-us_task_0279788926_p085643811201">The affinity attribute of the Flex-Algo is configured.</p>
<p id="EN-US_TASK_0279862419__en-us_task_0279788926_p59122053349">A FAD can constrain a path to include or exclude a link with a specific affinity attribute. The following three types of affinity attributes are defined for FADs:</p>
<ul id="EN-US_TASK_0279862419__en-us_task_0279788926_ul19912750342"><li id="EN-US_TASK_0279862419__en-us_task_0279788926_li79128515348"><p id="EN-US_TASK_0279862419__en-us_task_0279788926_p159120553416"><a name="EN-US_TASK_0279862419__en-us_task_0279788926_li79128515348"></a><a name="en-us_task_0279788926_li79128515348"></a>Include-All Admin Group (<strong><span id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdparmname511719172010">include-all</span></strong>): A link is included in path calculation only if each link administrative group bit has the same name as each affinity bit.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0279788926_li19294046352">Include-Any Admin Group (<strong><span id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdparmname1093216129201">include-any</span></strong>): A link is included in path calculation if at least one link administrative group bit has the same name as an affinity bit.</li><li id="EN-US_TASK_0279862419__en-us_task_0279788926_li170415817343">Exclude Admin Group (<strong><span id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdparmname1195771517204">exclude</span></strong>): A link is excluded from path calculation if any link administrative group bit has the same name as an affinity bit.</li></ul>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0279788926_substep1210305151220"><span id="EN-US_TASK_0279862419__en-us_task_0279788926_cmd17103105191213">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdname1616132191214">quit</span></b></a></span><p><p id="EN-US_TASK_0279862419__en-us_task_0279788926_p108744186711">Exit the Flex-Algo view.</p>
</p></li></ol>
</li><li><span>Configure IPv6 IS-IS on each PE and P. For configuration details, see <a href="dc_vrp_isis_cfg_1023.html">Configuring Basic IS-IS Functions (IPv6)</a>.</span></li><li><span>Configure an L3VPN instance.</span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p798651920214049">For IPv4 services, configure an IPv4 L3VPN instance.</p>
<ol type="a" id="EN-US_TASK_0279862419__en-us_task_0172368962_ol114016251214049"><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li1006989584214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p155316281214049"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li1006989584214049"></a><a name="en-us_task_0172368962_li1006989584214049"></a>Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname140364849214049">ip vpn-instance</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname2047630355214049">vpn-instance-name</span></i></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p63119490445">A VPN instance is created, and the VPN instance view is displayed.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li968964586214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1019301701214049"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li968964586214049"></a><a name="en-us_task_0172368962_li968964586214049"></a>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname429726472214049">ipv4-family</span></b></a></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p293114313454">The VPN instance IPv4 address family is enabled, and the view of this address family is displayed.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li158480935214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p709352265214049"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li158480935214049"></a><a name="en-us_task_0172368962_li158480935214049"></a>Run <a href="cmdqueryname=route-distinguisher"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname2045360316214049">route-distinguisher</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1237197488214049">route-distinguisher</span></i></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p12511818469">An RD is configured for the VPN instance IPv4 address family.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li185886327214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1750275151214049"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li185886327214049"></a><a name="en-us_task_0172368962_li185886327214049"></a>Run <a href="cmdqueryname=vpn-target"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname9634265214049">vpn-target</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1953001798214049">vpn-target</span></i> &amp;&lt;1-8&gt; [ <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1379946880214049">both</span></strong> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1877825958214049">export-extcommunity</span></strong> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname44639598214049">import-extcommunity</span></strong> ] <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1781223355214049">evpn</span></strong></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p939921811463">VPN targets are added to the VPN target list of the VPN instance IPv4 address family, so that routes of the VPN instance can be added to the routing table of the EVPN instance configured with a matching VPN target.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li1623237668214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p123234588214049"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li1623237668214049"></a><a name="en-us_task_0172368962_li1623237668214049"></a>(Optional) Run <a href="cmdqueryname=tnl-policy"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname275424177214049">tnl-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname5125743214049">policy-name</span></i> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1483919653214049">evpn</span></strong></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1990619589464">The specified tunnel policy is associated with EVPN routes leaked to the VPN instance IPv4 address family.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li1314794906214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p151257512214049"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li1314794906214049"></a><a name="en-us_task_0172368962_li1314794906214049"></a>(Optional) Run <a href="cmdqueryname=import+route-policy"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1220884022214049">import route-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1731039398214049">policy-name</span></i> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname124739500214049">evpn</span></strong></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p17904194875112">An import route-policy is applied to the VPN instance IPv4 address family to filter the routes to be imported from an EVPN instance to the address family. To precisely control the routes to be imported from the EVPN instance to the VPN instance IPv4 address family, perform this step and set attributes for eligible routes.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li281460164214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p15133718174514"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li281460164214049"></a><a name="en-us_task_0172368962_li281460164214049"></a>(Optional) Run <a href="cmdqueryname=export+route-policy"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname6133718124519">export route-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname71335181457">policy-name</span></i> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname21330189455">evpn</span></strong></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p982315244459">An export route-policy is applied to the VPN instance IPv4 address family to filter the routes to be advertised by the address family to an EVPN instance. To precisely control the routes to be advertised from the VPN instance IPv4 address family to the EVPN instance, perform this step and set attributes for eligible routes.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li1277974314214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1930341751214049"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li1277974314214049"></a><a name="en-us_task_0172368962_li1277974314214049"></a>Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname616213051214049">quit</span></b></a></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p16869964819">Exit the VPN instance IPv4 address family view.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li287980099214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1800867202214049"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li287980099214049"></a><a name="en-us_task_0172368962_li287980099214049"></a>Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1053668362214049">quit</span></b></a></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1811916279489">Exit the VPN instance view.</p>
</li></ol>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p504368145214049">For IPv6 services, configure an IPv6 L3VPN instance.</p>
<ol type="a" id="EN-US_TASK_0279862419__en-us_task_0172368962_ol436308015214049"><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li520196558214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p537623369214049"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li520196558214049"></a><a name="en-us_task_0172368962_li520196558214049"></a>Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1744481045214049">ip vpn-instance</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname151082471214049">vpn-instance-name</span></i></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p18980194734810">A VPN instance is created, and the VPN instance view is displayed.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li548619153214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1494807900214049"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li548619153214049"></a><a name="en-us_task_0172368962_li548619153214049"></a>Run <a href="cmdqueryname=ipv6-family"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1857425672214049">ipv6-family</span></b></a></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1095519804913">The VPN instance IPv6 address family is enabled, and the view of this address family is displayed.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li1075462913214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p2082805639214049"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li1075462913214049"></a><a name="en-us_task_0172368962_li1075462913214049"></a>Run <a href="cmdqueryname=route-distinguisher"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1903044149214049">route-distinguisher</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname765616188214049">route-distinguisher</span></i></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1735152844916">An RD is configured for the VPN instance IPv6 address family.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li1350613349214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p856407853214049"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li1350613349214049"></a><a name="en-us_task_0172368962_li1350613349214049"></a>Run <a href="cmdqueryname=vpn-target"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1572082279214049">vpn-target</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname2020561175214049">vpn-target</span></i> &amp;&lt;1-8&gt; [ <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname2107739867214049">both</span></strong> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname661106024214049">export-extcommunity</span></strong> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname578955942214049">import-extcommunity</span></strong> ] <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname196793189214049">evpn</span></strong></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p119285644911">VPN targets are added to the VPN target list of the VPN instance IPv6 address family, so that routes of the VPN instance can be added to the routing table of the EVPN instance configured with a matching VPN target.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li207202728214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1385257709214049"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li207202728214049"></a><a name="en-us_task_0172368962_li207202728214049"></a>(Optional) Run <a href="cmdqueryname=tnl-policy"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname107652996214049">tnl-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1563025836214049">policy-name</span></i> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname880341948214049">evpn</span></strong></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p18437161313503">The EVPN routes imported to the VPN instance IPv6 address family are enabled to be associated with a tunnel policy.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li1262605134214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1318571131214049"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li1262605134214049"></a><a name="en-us_task_0172368962_li1262605134214049"></a>(Optional) Run <a href="cmdqueryname=import+route-policy"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname174317909214049">import route-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1705766624214049">policy-name</span></i> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1110365219214049">evpn</span></strong></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p204538176521">An import route-policy is applied to the VPN instance IPv6 address family to filter the routes to be imported from an EVPN instance to the address family. To precisely control the routes to be imported from the EVPN instance to the VPN instance IPv6 address family, perform this step and set attributes for eligible routes.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li381306464214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p17153574540"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li381306464214049"></a><a name="en-us_task_0172368962_li381306464214049"></a>(Optional) Run <a href="cmdqueryname=export+route-policy"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname915215725414">export route-policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1015297115410">policy-name</span></i> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1215315711546">evpn</span></strong></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p11481798544">An export route-policy is applied to the VPN instance IPv6 address family to filter the routes to be advertised by the address family to an EVPN instance. To precisely control the routes to be advertised from the VPN instance IPv6 address family to the EVPN instance, perform this step and set attributes for eligible routes.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li1788085609214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p468674345214049"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li1788085609214049"></a><a name="en-us_task_0172368962_li1788085609214049"></a>Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1504843163214049">quit</span></b></a></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p4823037135120">Exit the VPN instance IPv6 address family view.</p>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li502620049214049"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1481979892214049"><a name="EN-US_TASK_0279862419__en-us_task_0172368962_li502620049214049"></a><a name="en-us_task_0172368962_li502620049214049"></a>Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname142439129214049">quit</span></b></a></p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1088752155114">Exit the VPN instance view.</p>
</li></ol>
</p></li><li><span>Bind the L3VPN instance to an access-side interface.</span><ol type="a" id="EN-US_TASK_0279862419__en-us_task_0172368962_substeps2105176334214049"><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep1343679180214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd387573853214337">Run <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1569076207214049">interface</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname2016048307214049">interface-type</span></i> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1227257401214049">interface-number</span></i></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1360771757214337">The interface view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep1874064962214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd1557770987214337">Run <a href="cmdqueryname=ip+binding+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname915757253214049">ip binding vpn-instance</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname441315531214049">vpn-instance-name</span></i></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1257677897214337">The L3VPN instance is bound to the interface.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep1101695776214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd1587069244214337">(Optional) Run <a href="cmdqueryname=ipv6+enable"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1686606071214049">ipv6 enable</span></b></a></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p671255038214337">IPv6 is enabled on the interface.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep2076703606214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd417171616214337">Run <a href="cmdqueryname=ip+address"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname676924079214049">ip address</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1748848675214049">ip-address</span></i> { <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1167655473214049">mask</span></i> | <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1909024746214049">mask-length</span></i> } or <a href="cmdqueryname=ipv6+address"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname600482532214049">ipv6 address</span></b></a> { <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname138189177214049">ipv6-address</span></i> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1312008302214049">prefix-length</span></i> | <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1621926661214049">ipv6-address</span></i>/<i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname561823454214049">prefix-length</span></i> }</span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p2005390635214337">An IPv4/IPv6 address is configured for the interface.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep1075766757214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd1162187634214337">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname63760972214049">quit</span></b></a></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1505833722214337">Exit the interface view.</p>
</p></li></ol>
</li><li><span>Configure BGP EVPN peer relationships.</span><p><div class="note" id="EN-US_TASK_0279862419__en-us_task_0172368962_note482695825214049"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1622996056214049">If a BGP RR needs to be deployed on the network, establish BGP EVPN peer relationships between all the PEs and the RR.</p>
</div></div>
</p><ol type="a" id="EN-US_TASK_0279862419__en-us_task_0172368962_substeps1750517409214049"><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep184611205214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd964854728214337">Run <a href="cmdqueryname=bgp"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname74814742214049">bgp</span></b></a> { <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname502185367214049">as-number-plain</span></i> | <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname72297199214049">as-number-dot</span></i> }</span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1443755214337">BGP is enabled, and the BGP view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep1844786949214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd779214455214337">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname2105258385214049">peer</span></b></a> { <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname647939425214049">ipv6-address</span></i> | <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname2125986406214049">group-name</span></i> } <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname618240617214049">as-number</span></strong> { <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1293517741214049">as-number-plain</span></i> | <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname973446910214049">as-number-dot</span></i> }</span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1655399967214337">The remote PE is configured as a peer.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep17421513214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd745592999214049">(Optional) Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname2026129260214049">peer</span></b></a> { <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname668048336214049">ipv6-address</span></i> | <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname354626462214049">group-name</span></i> } <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname168351352214049">connect-interface</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1223914177214049">interface-type</span></i> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname109852219214049">interface-number</span></i></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p147362010104713">A source interface and a source address are specified to set up a TCP connection with the BGP peer.</p>
</p><p><div class="note" id="EN-US_TASK_0279862419__en-us_task_0172368962_note1178520917214049"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1159375738214049">If loopback interfaces are used to establish a BGP connection, you are advised to run the <a href="cmdqueryname=peer+connect-interface"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname436735922214049">peer connect-interface</span></b></a> command on both ends to ensure connectivity. If this command is run on one end only, the BGP connection may fail to be established.</p>
</div></div>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep1379965730214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd804663807214337">Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname74634140214049">ipv4-family</span></b></a> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname862105629214049">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1216972070214049">vpn-instance-name</span></i> or <a href="cmdqueryname=ipv6-family"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname117481379214049">ipv6-family</span></b></a> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname496523582214049">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname331876419214049">vpn-instance-name</span></i></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1237645630214337">The BGP-VPN instance IPv4/IPv6 address family view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep1960381016214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd1429623638214049">Run <a href="cmdqueryname=import-route"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname471816305214049">import-route</span></b></a> { <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname335855848214049">direct</span></strong> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname513519402214049">isis</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname432955875214049">process-id</span></i> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname913985214214049">ospf</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname227561098214049">process-id</span></i><span> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1327885715214049">rip</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1118317284214049">process-id</span></i></span> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1488409055214049">static</span></strong> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1205339474214049">ospfv3</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1301722715214049">process-id</span></i> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1022563878214049">ripng</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1076303018214049">process-id</span></i> } [ <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1493309978214049">med</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname136897745214049">med</span></i> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1542963777214049">route-policy</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1836850994214049">route-policy-name</span></i> ] <sup id="EN-US_TASK_0279862419__en-us_task_0172368962_sup312753173214049">*</sup></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p174648781515">Other protocol routes are imported to the BGP-VPN instance IPv4/IPv6 address family. To advertise host IP routes, you only need to configure import of direct routes. To advertise the subnet route of the host, use a dynamic routing protocol (such as OSPF) to advertise the route and then perform this step to import the routes of the dynamic routing protocol.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep2085421869214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd604749596214049">Run <a href="cmdqueryname=advertise+l2vpn+evpn"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname511774076214049">advertise l2vpn evpn</span></b></a> [ <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname2785193916178">import-route-multipath</span></strong> ]</span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p996102015539">The device is enabled to advertise IP prefix routes. This type of route can be used to advertise host IP routes as well as the routes on the subnet where the device resides.</p>
</p><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p8399175019179">To implement SID-based load balancing, specify the <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname935118559192">import-route-multipath</span></strong> parameter for the device to advertise all IP prefix routes with the same destination address.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep1395189060214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd298729893214337">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname810599314214337">quit</span></b></a></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p651025758214337">Exit the BGP-VPN instance IPv4/IPv6 address family view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep1877651589214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd1232276422214337">Run <a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1881971146214049">l2vpn-family evpn</span></b></a></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1486940210214337">The BGP EVPN address family view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep738378284214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd1887145831214337">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname394354765214049">peer</span></b></a> { <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname573317172214049">ipv6-address</span></i> | <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1007181174214049">group-name</span></i> } <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1050209317214049">enable</span></strong></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1487603250214337">The device is enabled to exchange EVPN routes with a specified peer or peer group.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep1122298758214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd1126354105214049">(Optional) Run <a href="cmdqueryname=nexthop+recursive-lookup+default-route"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1369397976214049">nexthop recursive-lookup default-route</span></b></a></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1936218461185">The device is enabled to send packets over a default route when the recursive next-hop address is unavailable.</p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1269884408214049">In an EVPN over SRv6 BE scenario, problems such as configuration errors or faults may cause the PE at one end to fail to recurse services to SRv6 BE due to route unreachability, resulting in a service forwarding failure. To prevent this, run the <a href="cmdqueryname=nexthop+recursive-lookup+default-route"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname484932050214049">nexthop recursive-lookup default-route</span></b></a> command on the local PE and configure the remote PE to send a default route to the local PE. In this way, if the next hop of a specific route on the local PE is unreachable, services can be steered to an SRv6 BE path through recursion to the default route, ensuring service continuity.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep637321713446"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd93734178448">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname289046521214049">quit</span></b></a></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p6912934173218">Exit the BGP EVPN address family view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep1312370024214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd1021592859214337">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname119643836214337">quit</span></b></a></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p354823421214337">Exit the BGP view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep237245288214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd1664954959214337">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1427767467214337">commit</span></b></a></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p205211447214337">The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure basic SRv6 functions.</span><ol type="a"><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=evpn+srv6+next-header-field"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname4480156165418">evpn srv6 next-header-field</span></b></a> { <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1793514311558">59</span></strong> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1818817508616">143</span></strong> }</span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p71313716252">A value is set for the Next Header field in an SRv6 extension header.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=segment-routing+ipv6"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname869175326214049">segment-routing ipv6</span></b></a></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1060553320214337">SRv6 is enabled, and the SRv6 view is displayed.</p>
</p></li><li class="substepexpand"><span>Configure a source address for SRv6 encapsulation. Note that you only need to perform one of the following operations. If both of the operations are performed, the latest configuration overrides the previous one.</span><p><ul id="EN-US_TASK_0279862419__en-us_task_0172368959_ul261475310544"><li id="EN-US_TASK_0279862419__en-us_task_0172368959_li761411538546">Run the <a href="cmdqueryname=encapsulation+source-address"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368959_cmdname23368553547">encapsulation source-address</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368959_varname6336145515412">ipv6-address</span></i> [ <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368959_cmdparmname1633612551542">ip-ttl</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368959_varname2033635519549">ttl-value</span></i> ] command to directly configure a source address for SRv6 encapsulation.</li><li id="EN-US_TASK_0279862419__en-us_task_0172368959_li1554119145516">Run the <a href="cmdqueryname=encapsulation+source-interface"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368959_cmdname10488513573">encapsulation source-interface</span></b></a> { <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368959_varname0729113313571">intfname</span></i> | <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368959_varname17377153912578">interfaceType</span></i> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368959_varname1951134465716">interfaceNum</span></i> } [ <strong id="EN-US_TASK_0279862419__en-us_task_0172368959_b7945154716571">ip-ttl</strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368959_varname2091014584572">ttl-value</span></i> ] command to specify the interface to which the source address used for SRv6 encapsulation belongs.<p id="EN-US_TASK_0279862419__en-us_task_0172368959_p2488153115910">If no IPv6 global address is configured for the interface specified using the <a href="cmdqueryname=encapsulation+source-interface"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368959_cmdname2054948195915">encapsulation source-interface</span></b></a> command, the source address for SRv6 encapsulation is not configured.</p>
</li></ul>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=locator"><b><span class="cmdname">locator</span></b></a> <i><span class="varname">locator-name</span></i> <strong><span>ipv6-prefix</span></strong> <i><span class="varname">ipv6-address</span></i> <i><span class="varname">prefix-length</span></i> [ <strong><span>static</span></strong> <i><span class="varname">static-length</span></i> | <strong><span>args</span></strong> <i><span class="varname">args-length</span></i> | <strong><span>flex-algo</span></strong> <em>flexAlgoId</em> ] <sup>*</sup></span></span><p><p>An SRv6 locator is configured.</p>
</p><p><p>If <span><strong><span>flex-algo</span></strong> <em>flexAlgoId</em></span> is specified, the IGP uses the specified Flex-Algo to calculate locator routes.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0279862419__en-us_task_0279788926_p17251152541716">In SRv6 Flex-Algo scenarios, locators must be configured on both PEs and Ps, and IS-IS SRv6 must be enabled using the <a href="cmdqueryname=segment-routing+ipv6"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdname204081209207">segment-routing ipv6</span></b></a> <strong id="EN-US_TASK_0279862419__en-us_task_0279788926_b10408142012200">locator</strong> <em id="EN-US_TASK_0279862419__en-us_task_0279788926_i64081920122020">locator-name</em> command in the IS-IS view. Otherwise, SRv6 locator routes cannot be advertised, and PEs at both ends cannot learn locator routes from each other.</p>
</div></div>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=opcode"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname58380111454">opcode</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1083915112517">func-opcode</span></i> { <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname138391511155">end-dt4</span></strong> | <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname18398118516">end-dt6</span></strong> } <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1383918114518">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname168391911658">vpn-instance-name</span></i> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1883912111853">evpn</span></strong></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p257904722914">An opcode for static SIDs is configured. If the device carries IPv4 services, specify the <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname209675312292">end-dt4</span></strong> parameter. If the device carries IPv6 services, specify the <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname696165319291">end-dt6</span></strong> parameter.</p>
</p><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p78001745202310">Alternatively, run the <a href="cmdqueryname=opcode"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname95542061814">opcode</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname855820101812">func-opcode</span></i> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname955132010187">end-dt46</span></strong> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname185502013182">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname25513202183">vpn-instance-name</span></i> command to configure an opcode for static SIDs. This command applies to both IPv4 and IPv6 services.</p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1432012421220">In EVPN scenarios, <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname225455223">end-dx4</span></strong> and <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname16354572212">end-dx6</span></strong> are used to allocate SIDs based on the interfaces to which VPN instances are bound, and <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname141245122214">end-dt4</span></strong> and <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1741445202214">end-dt6</span></strong> are used to allocate SIDs based on VPN instances.</p>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p12418100174819">A SID can be either dynamically allocated by BGP or manually configured. If you want to run the <span><a href="cmdqueryname=segment-routing+ipv6+locator"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname175640204576">segment-routing ipv6 locator</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname165646206572">locator-name</span></i></span> command to enable dynamic SID allocation through BGP or the <span><a href="cmdqueryname=segment-routing+ipv6+locator"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname19854157121913">segment-routing ipv6 locator</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname13854478194">locator-name</span></i></span> <a href="cmdqueryname=end-dt46"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname485497121913">end-dt46</span></b></a> command to enable dynamic End.DT46 SID allocation through BGP in the future, skip this step.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the SRv6 locator view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the SRv6 view.</p>
</p></li></ol>
</li><li><span>Enable IS-IS SRv6 on the PEs and Ps, and configure IS-IS Flex-Algo.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=isis"><b><span class="cmdname">isis</span></b></a> [ <em>process-id</em> ]</span><p><p>The IS-IS view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=cost-style"><b><span class="cmdname">cost-style</span></b></a> { <strong><span>wide</span></strong> | <strong><span>compatible</span></strong> | <strong><span>wide-compatible</span></strong> }</span><p><p>The IS-IS wide cost type is configured.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=flex-algo"><b><span class="cmdname">flex-algo</span></b></a><strong> </strong><i><span class="varname">flexAlgoIdentifier</span></i> [ <strong><span>level-1</span></strong> | <strong><span>level-2</span></strong> | <strong><span>level-1-2</span></strong> ]</span><p><p>IS-IS is enabled to advertise Flex-Algos.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=flex-algo+prefix-sid+incr-prefix-cost"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdname17717106103316">flex-algo prefix-sid incr-prefix-cost</span></b></a> The device is enabled to count in the IS-IS cost of the loopback interface when calculating the cost of an IS-IS Flex-Algo SRv6 prefix SID route.</span><p><p id="EN-US_TASK_0279862419__en-us_task_0279788926_p694584843110">By default, the device does not count in the IS-IS cost of the loopback interface when calculating the cost of an IS-IS Flex-Algo SRv6 prefix SID route in the same IS-IS level. After you run the <a href="cmdqueryname=flex-algo+prefix-sid+incr-prefix-cost"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0279788926_cmdname2998251163219">flex-algo prefix-sid incr-prefix-cost</span></b></a> command, the cost of the prefix SID route covers the IS-IS cost of the loopback interface, regardless of the metric type used in Flex-Algo calculation.</p>
<p id="EN-US_TASK_0279862419__en-us_task_0279788926_p7945048203117">When a Huawei device interworks with a non-Huawei device, you can run this command to prevent loops caused by the difference in default route calculation behaviors.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv6+enable+topology+ipv6"><b><span class="cmdname">ipv6 enable topology ipv6</span></b></a></span><p><p>IPv6 is enabled for the IS-IS process in the IPv6 topology.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv6+traffic-eng"><b><span class="cmdname">ipv6 traffic-eng</span></b></a> [ <strong><span>level-1</span></strong> | <strong><span>level-2</span></strong> | <strong><span>level-1-2</span></strong> ]</span><p><p>IS-IS TE is enabled.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv6+advertise+link+attributes"><b><span class="cmdname">ipv6 advertise link attributes</span></b></a></span><p><p>The IS-IS process is enabled to advertise link attribute-related TLVs through LSPs. Link attributes include the IPv6 address and interface index.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=ipv6+metric-delay+advertisement+enable"><b><span class="cmdname">ipv6 metric-delay advertisement enable</span></b></a> { <strong><span>level-1</span></strong> | <strong><span>level-2</span></strong> | <strong><span>level-1-2</span></strong> }</span><p><p>The advertisement of IPv6 delay information is enabled.</p>
<p>In a scenario where IS-IS Flex-Algos calculate paths based on delay information, you need to run this command to enable link delay advertisement through IS-IS.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=segment-routing+ipv6+%28IS-IS+view%29"><b><span class="cmdname">segment-routing ipv6</span></b></a> <strong>locator</strong> <em>locator-name</em> [ <strong>auto-sid-disable</strong> ]</span><p><p>IS-IS SRv6 is enabled.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the IS-IS view.</p>
</p></li></ol>
</li><li><span>Configure EVPN routes on the PEs to carry SIDs and recurse to SRv6 BE paths based on the SIDs.</span><ol type="a" id="EN-US_TASK_0279862419__en-us_task_0172368962_substeps1059013475616"><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep413674345214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd1469712342214337">Run <a href="cmdqueryname=bgp"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1446099788214337">bgp</span></b></a> { <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname510906212214337">as-number-plain</span></i> | <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1996524032214337">as-number-dot</span></i> }</span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p2052232736214337">The BGP view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep581390625214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd613187325214337">Run <a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname961911237214337">l2vpn-family evpn</span></b></a></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1607817341214337">The BGP EVPN address family view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep1769151194214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd15235161165417">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname2048909283214049">peer</span></b></a> { <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1996321233214049">ipv6-address</span></i> | <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1000192653214049">group-name</span></i> } <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1776334192214049">advertise encap-type</span></strong> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname1014071873214049">srv6</span></strong><span> [ <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname629743683918">advertise-srv6-locator</span></strong> ]</span></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p7940253105314">The device is enabled to send EVPN routes carrying SRv6-encapsulated attributes to the specified peer or peer group.</p>
</p><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p746143719434">In a scenario where BFD is used to check locator reachability, if locator routes are summarized by a P device between local and remote PEs, the remote PE can learn only the summary locator route, not the locator on the local PE. This leads to a BFD failure. To address this issue, specify the <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname133588371762">advertise-srv6-locator</span></strong> parameter in the command to allow the local PE to carry locator length information in the EVPN route to be advertised to the remote PE. In this way, after receiving the EVPN route, the remote PE can calculate the locator on the local PE, enabling BFD to take effect.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep677733200214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd414085989214337">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname202154376214337">quit</span></b></a></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p475243651214337">Exit the BGP EVPN address family view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep14980133210333"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd4239140203310">Enable the device to add SIDs to VPN routes to be sent to EVPN. Note that you need to perform configurations only in one of the following two views. If you perform configurations in both views, the configurations in these views are mutually exclusive.</span><p><ul id="EN-US_TASK_0279862419__en-us_task_0172368962_ul152411240193320"><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li8685185120348">Configurations in the BGP-VPN instance IPv4/IPv6 address family view<ul id="EN-US_TASK_0279862419__en-us_task_0172368962_ul56011143515"><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li42442011163518">Run the <a href="cmdqueryname=ipv4-family"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname195814633514">ipv4-family</span></b></a> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname165816663510">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1158116653517">vpn-instance-name</span></i> or <a href="cmdqueryname=ipv6-family"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname2581176133515">ipv6-family</span></b></a> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname958116103517">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname17581867359">vpn-instance-name</span></i> command to enter the BGP-VPN instance IPv4/IPv6 address family view.</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li824134016331">Run the <a href="cmdqueryname=segment-routing+ipv6+locator"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname3948181713352">segment-routing ipv6 locator</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname394861703511">locator-name</span></i> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname7948917133516">evpn</span></strong> command to enable the device to add SIDs to VPN routes to be sent to EVPN.</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li8926251142410">Run the <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname13137546259">quit</span></b></a> command to return to the BGP view.</li></ul>
</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li62656718365">Configurations in the BGP-VPN instance view<ul id="EN-US_TASK_0279862419__en-us_task_0172368962_ul12716161116361"><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li328513011444">Run the <a href="cmdqueryname=vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname199128478084516">vpn-instance</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname94627199584516">vpn-instance-name</span></i> command to create a BGP-VPN instance and enter its view.</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li1724114012333">Run the <a href="cmdqueryname=segment-routing+ipv6+locator"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname137109216447">segment-routing ipv6 locator</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname171281516173719">locator-name</span></i> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname9128121618377">end-dt46</span></strong> command to enable the device to add SIDs to VPN routes to be sent to EVPN.</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li1585431102515">Run the <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname17858317258">quit</span></b></a> command to return to the BGP view.</li></ul>
</li></ul>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep622374194214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd1997717668214049">Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname823010471214049">ipv4-family</span></b></a> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname235881859214049">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname149590271214049">vpn-instance-name</span></i> or <a href="cmdqueryname=ipv6-family"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1967518795214049">ipv6-family</span></b></a> <strong><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdparmname44578604214049">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname941510082214049">vpn-instance-name</span></i></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p7475195820491">The BGP-VPN instance IPv4/IPv6 address family view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep1680028980214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd1825146326214337">Run <a href="cmdqueryname=segment-routing+ipv6+best-effort+evpn"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1567433354214049">segment-routing ipv6 best-effort evpn</span></b></a></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1010742234214337">The device is enabled to perform route recursion based on the SIDs carried by EVPN routes.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep1023851315542"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd1923871375415">(Optional) Configure the device to allocate SIDs to BGP VPN routes based on next hops, thereby implementing SID-based load balancing.</span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1898810409191">To configure the device to allocate SIDs to BGP VPN routes based on all next hops:</p>
</p><p><ul id="EN-US_TASK_0279862419__en-us_task_0172368962_ul1046992210418"><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li113951233184">For EVPN L3VPNv4 services, run the <a href="cmdqueryname=segment-routing+ipv6+apply-sid+all-nexthop+evpn"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname03957311184">segment-routing ipv6 apply-sid all-nexthop evpn</span></b></a> command in the BGP-VPN instance IPv4 address family view.</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li34701622847">For EVPN L3VPNv6 services, run the <a href="cmdqueryname=segment-routing+ipv6+apply-sid+all-nexthop+evpn"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname14228731713">segment-routing ipv6 apply-sid all-nexthop evpn</span></b></a> command in the BGP-VPN instance IPv6 address family view.</li></ul>
<p id="EN-US_TASK_0279862419__en-us_task_0172368962_p0712111017714">To configure the device to allocate a SID to a BGP VPN route with a specified next hop:</p>
<ul id="EN-US_TASK_0279862419__en-us_task_0172368962_ul126521441172518"><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li206521841132517">For EVPN L3VPNv4 services, run the <a href="cmdqueryname=segment-routing+ipv6+apply-sid+specify-nexthop+evpn"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname6424115619254">segment-routing ipv6 apply-sid specify-nexthop evpn</span></b></a> command in the BGP-VPN instance IPv4 address family view, and then run the <a href="cmdqueryname=nexthop"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname19107135014339">nexthop</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname565245913332">nexthop-address</span></i> <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1720715411332">interface</span></b></a> { <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname132891554345">interface-name</span></i> | <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname8913169143417">interfaceType</span></i> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname15148415113418">interfaceNum</span></i> } command to specify a next hop and an outbound interface.</li><li id="EN-US_TASK_0279862419__en-us_task_0172368962_li19219213459">For EVPN L3VPNv6 services, run the <a href="cmdqueryname=segment-routing+ipv6+apply-sid+specify-nexthop+evpn"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname881852934518">segment-routing ipv6 apply-sid specify-nexthop evpn</span></b></a> command in the BGP-VPN instance IPv6 address family view, and then run the <a href="cmdqueryname=nexthop"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname6878555114615">nexthop</span></b></a> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname12878115513468">nexthop-address</span></i> <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname287825544620">interface</span></b></a> { <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname28782558461">interface-name</span></i> | <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname1887817559462">interfaceType</span></i> <i><span class="varname" id="EN-US_TASK_0279862419__en-us_task_0172368962_varname48781055194613">interfaceNum</span></i> } command to specify a next hop and an outbound interface.</li></ul>
</p></li><li class="substepexpand" id="EN-US_TASK_0279862419__en-us_task_0172368962_substep1800172581214049"><span id="EN-US_TASK_0279862419__en-us_task_0172368962_cmd1597694111214337">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0279862419__en-us_task_0172368962_cmdname1052916236214337">commit</span></b></a></span><p><p id="EN-US_TASK_0279862419__en-us_task_0172368962_p1171971298214337">The configuration is committed.</p>
</p></li></ol>
</li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0279862419__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After configuring EVPN L3VPN over SRv6 Flex-Algo, verify the configuration.</p>
<ul><li><p>Run the <a href="cmdqueryname=display+bgp+vpnv4"><b><span class="cmdname">display bgp vpnv4</span></b></a> { <strong>all</strong> | <strong>route-distinguisher</strong><em> route-distinguisher</em> | <strong>vpn-instance</strong><em> vpn-instance-name</em> } <strong>routing-table</strong> [ <em>network</em> [ <em>prefix-length</em> ] ] command to check BGP VPNv4 route information.</p>
</li><li><p>Run the <a href="cmdqueryname=display+bgp+vpnv6"><b><span class="cmdname">display bgp vpnv6</span></b></a> { <strong>all</strong> | <strong>route-distinguisher</strong><em> route-distinguisher</em> | <strong>vpn-instance</strong><em> vpn-instance-name</em> } <strong>routing-table</strong> [ <em>network</em> [ <em>prefix-length</em> ] ] command to check BGP VPNv6 route information.</p>
</li><li>Run the <a href="cmdqueryname=display+bgp+evpn"><b><span class="cmdname">display bgp evpn</span></b></a> <strong><span>all</span></strong> <strong><span>routing-table</span></strong> <strong><span>prefix-route</span></strong> <i><span class="varname">prefix</span></i> command to check EVPN IP prefix route information.</li><li><p>Run the <a href="cmdqueryname=display+ip+routing-table+vpn-instance"><b><span class="cmdname">display ip routing-table vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i> or <a href="cmdqueryname=display+ipv6+routing-table+vpn-instance"><b><span class="cmdname">display ipv6 routing-table vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i> command to check information about the VPN routes received from the remote device.</p>
</li><li>Run the <a href="cmdqueryname=display+isis+flex-algo"><b><span class="cmdname">display isis</span></b></a> <i><span class="varname">process-id</span></i> <strong><span>flex-algo</span></strong> [ <i><span class="varname">flex-algo-id</span></i> ] [ <strong><span>level-1</span></strong> | <strong><span>level-2</span></strong> ] command to check the preferred FAD in the LSDB.</li><li>Run the <a href="cmdqueryname=display+isis+lsdb"><b><span class="cmdname">display isis lsdb</span></b></a> [ { <strong><span>level-1</span></strong> | <strong><span>level-2</span></strong> } | <strong><span>verbose</span></strong> | { <strong><span>local</span></strong> | <i><span class="varname">lsp-id</span></i> | <strong><span>is-name</span></strong> <i><span class="varname">symbolic-name</span></i> } ] <sup>*</sup> [ <i><span class="varname">process-id</span></i><span> | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i></span> ] command to check IS-IS LSDB information.</li><li>Run the <a href="cmdqueryname=display+isis"><b><span class="cmdname">display isis</span></b></a><strong> </strong><em>process-id</em> <strong><span>route</span></strong><strong> </strong><strong><span>ipv6</span></strong> <strong><span>flex-algo</span></strong> [ <em>flex-algo-id</em> ] [ <strong><span>verbose</span></strong> | [ <strong><span>level-1</span></strong> | <strong><span>level-2</span></strong> ] | <em>ipv6-address</em> [ <em>prefix-length</em> ] ] <sup>*</sup> or <a href="cmdqueryname=display+isis+route"><b><span class="cmdname">display isis route</span></b></a><strong> </strong>[ <em>process-id</em> ] <strong><span>ipv6</span></strong> <strong><span>flex-algo</span></strong> [ <em>flex-algo-id</em> ] [ <strong><span>verbose</span></strong> | [ <strong><span>level-1</span></strong> | <strong><span>level-2</span></strong> ] | <em>ipv6-address</em> [ <em>prefix-length</em> ] ] <sup>*</sup> command to check Flex-Algo-related IS-IS route information.</li><li>Run the <a href="cmdqueryname=display+isis"><b><span class="cmdname">display isis</span></b></a><strong> </strong>[ <em>process-id</em> ] <strong><span>spf-tree</span></strong> [ <strong><span>systemid</span></strong><em> systemid</em> ] <strong><span>ipv6 flex-algo</span></strong> [ <em>flex-algo-id</em> ] [ [ <strong><span>level-1</span></strong> | <strong><span>level-2</span></strong> ] | <strong><span>verbose</span></strong> ] <sup>*</sup> command to check the SPF tree topology information of a specified Flex-Algo.</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0003.html">Configuring SRv6 Flex-Algo
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0004.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0006.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>