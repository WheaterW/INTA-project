
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring L3VPNv4 over IS-IS SRv6 BE">
<meta name="abstract" content="This section describes how to configure L3VPNv4 over SRv6 BE.">
<meta name="description" content="This section describes how to configure L3VPNv4 over SRv6 BE.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0002.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0251.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00556928,w00606909,segment_routing_vrp,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00587852">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00587852">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172368959">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring L3VPNv4 over IS-IS SRv6 BE</title>
</head>
<body><a name="EN-US_TASK_0172368959"></a><a name="EN-US_TASK_0172368959"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring L3VPNv4 over IS-IS SRv6 BE</h1>
<div class="taskbody"><p>This section describes how to configure L3VPNv4 over SRv6 BE.</p>
<div class="context"><a name="EN-US_TASK_0172368959__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>L3VPNv4 over SRv6 BE allows SRv6 BE paths on a public network to carry L3VPNv4 data. The key implementation of L3VPNv4 over SRv6 BE involves establishing SRv6 BE paths, advertising VPN routes, and forwarding data.</p>
<p><a href="#EN-US_TASK_0172368959__fig_dc_vrp_srv6_cfg_all_001201">Figure 1</a> shows an example where an IPv6 public network is established between PE1 and PE2 and the involved VPNs are traditional IPv4 networks. SRv6 BE paths can be deployed on the IPv6 public network to carry L3VPNv4 services on the VPNs.</p>
<div class="fignone" id="EN-US_TASK_0172368959__fig_dc_vrp_srv6_cfg_all_001201"><a name="EN-US_TASK_0172368959__fig_dc_vrp_srv6_cfg_all_001201"></a><a name="fig_dc_vrp_srv6_cfg_all_001201"></a><span class="figcap"><b>Figure 1 </b>L3VPNv4 over SRv6 BE networking</span><br><span><img class="vsd" src="images/fig_dc_vrp_srv6_cfg_all_001201.png" width="NaN" height="NaN"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172368959__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring L3VPNv4 over SRv6 BE, complete the following tasks:</p>
<ul><li><p>Configure a link layer protocol.</p>
</li><li><p>Configure network-layer addresses for interfaces to ensure that neighboring devices are reachable at the network layer.</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172368959__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li id="EN-US_TASK_0172368959__step1205042001214048"><span id="EN-US_TASK_0172368959__cmd222635950214048">Configure IPv6 IS-IS on each PE and P. For configuration details, see <a href="dc_vrp_isis_cfg_1023.html">Configuring Basic IS-IS Functions (IPv6)</a>.</span></li><li id="EN-US_TASK_0172368959__step986514058214048"><span id="EN-US_TASK_0172368959__cmd1768017966214048">Configure a VPN instance on each PE and enable the IPv4 address family for the instance.</span><ol type="a" id="EN-US_TASK_0172368959__substeps1816851270214048"><li class="substepexpand" id="EN-US_TASK_0172368959__substep946830971214048"><span id="EN-US_TASK_0172368959__cmd205205445214337">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1947104443214048">system-view</span></b></a></span><p><p id="EN-US_TASK_0172368959__p870048363214337">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep1397333771214048"><span id="EN-US_TASK_0172368959__cmd1654615076214337">Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname537849685214048">ip vpn-instance</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname1131556657214048">vpn-instance-name</span></i></span><p><p id="EN-US_TASK_0172368959__p115518705214337">A VPN instance is created, and the VPN instance view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep25570636214048"><span id="EN-US_TASK_0172368959__cmd713568743214337">Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname2067639906214337">ipv4-family</span></b></a></span><p><p id="EN-US_TASK_0172368959__p1411086343214337">The VPN instance IPv4 address family is enabled, and the view of this address family is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep1625602864214048"><span id="EN-US_TASK_0172368959__cmd1525036906214337">Run <a href="cmdqueryname=route-distinguisher"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1747812847214048">route-distinguisher</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname846223048214048">route-distinguisher</span></i></span><p><p id="EN-US_TASK_0172368959__p184210540214337">An RD is configured for the VPN instance IPv4 address family.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep1111248635214048"><span id="EN-US_TASK_0172368959__cmd1069455220214337">Run <a href="cmdqueryname=vpn-target"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1906892201214048">vpn-target</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname1992437608214048">vpn-target</span></i> &amp;&lt;1-8&gt; [ <strong><span id="EN-US_TASK_0172368959__cmdparmname1358735800214048">both</span></strong> | <strong><span id="EN-US_TASK_0172368959__cmdparmname2012033753214048">export-extcommunity</span></strong> | <strong><span id="EN-US_TASK_0172368959__cmdparmname435610405214048">import-extcommunity</span></strong> ]</span><p><p id="EN-US_TASK_0172368959__p97843294214337">VPN targets are configured for the VPN instance IPv4 address family.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep128518706214048"><span id="EN-US_TASK_0172368959__cmd952809873214337">Run <span><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname169165212214337">commit</span></b></a></span></span><p><p id="EN-US_TASK_0172368959__p1719400534214337">The configuration is committed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep429823953214048"><span id="EN-US_TASK_0172368959__cmd1082736636214337">Run <span><a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1497110520214337">quit</span></b></a></span></span><p><p id="EN-US_TASK_0172368959__p1078001921214337">Exit the VPN instance IPv4 address family view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep1951371838214048"><span id="EN-US_TASK_0172368959__cmd807843595214337">Run <span><a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1896590842214337">quit</span></b></a></span></span><p><p id="EN-US_TASK_0172368959__p1907192603214337">Exit the VPN instance view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep451973139214048"><span id="EN-US_TASK_0172368959__cmd672664892214337">Run <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1833102321415">interface</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname63311236148">interface-type</span></i> <i><span class="varname" id="EN-US_TASK_0172368959__varname2331723151414">interface-number</span></i></span><p><p id="EN-US_TASK_0172368959__p1714587406214337">The view of the interface to be bound to the VPN instance is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep1895427683214048"><span id="EN-US_TASK_0172368959__cmd680648583214048">Run <a href="cmdqueryname=ip+binding+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname237512344214048">ip binding vpn-instance</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname458310735214048">vpn-instance-name</span></i></span><p><p id="EN-US_TASK_0172368959__p1878919332517">The interface is bound to the VPN instance.</p>
</p><p><div class="note" id="EN-US_TASK_0172368959__note348516782214048"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172368959__p1333649705214048">The <a href="cmdqueryname=ip+binding+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname759105741214048">ip binding vpn-instance</span></b></a> command deletes IPv4<span> and IPv6</span> Layer 3 configurations on the interface, such as the configured IP addresses and routing protocols. You have to reconfigure them if they are required.</p>
</div></div>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep2012364957214048"><span id="EN-US_TASK_0172368959__cmd1296186613214337">Run <a href="cmdqueryname=ip+address"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1520373724214048">ip address</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname1245288233214048">ip-address</span></i> { <i><span class="varname" id="EN-US_TASK_0172368959__varname1120231857214048">mask</span></i> | <i><span class="varname" id="EN-US_TASK_0172368959__varname518886570214048">mask-length</span></i> }</span><p><p id="EN-US_TASK_0172368959__p2070425089214337">An IP address is configured for the interface.</p>
</p><p><p id="EN-US_TASK_0172368959__p445536782214337">Layer 3 features such as PE-CE route exchange can be configured for PE-CE communication only after an IP address is configured for the involved VPN interface.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep81363156214048"><span id="EN-US_TASK_0172368959__cmd571135667214337">Run <span><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1461599288214337">commit</span></b></a></span></span><p><p id="EN-US_TASK_0172368959__p559246722214337">The configuration is committed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep962114258214048"><span id="EN-US_TASK_0172368959__cmd239984303214337">Run <span><a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1267155967214337">quit</span></b></a></span></span><p><p id="EN-US_TASK_0172368959__p928004889214337">Exit the interface view.</p>
</p></li></ol>
</li><li><span>Configure PE-CE IPv4 route exchange. For configuration details, see <a href="dc_vrp_mpls-l3vpn-v4_cfg_0158.html">Configuring Route Exchange Between PEs and CEs</a>.</span></li><li id="EN-US_TASK_0172368959__step1435878389214048"><span id="EN-US_TASK_0172368959__cmd1534342584214048">Establish an MP-IBGP peer relationship between the PEs.</span><ol type="a" id="EN-US_TASK_0172368959__substeps1161530598214048"><li class="substepexpand" id="EN-US_TASK_0172368959__substep1549472147214048"><span id="EN-US_TASK_0172368959__cmd448660887214337">Run <span><a href="cmdqueryname=bgp"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname167384313214337">bgp</span></b></a> { <i><span class="varname" id="EN-US_TASK_0172368959__varname1620833230214337">as-number-plain</span></i> | <i><span class="varname" id="EN-US_TASK_0172368959__varname2101455332214337">as-number-dot</span></i> }</span></span><p><p id="EN-US_TASK_0172368959__p1663683263214337">The BGP view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep1982825598214048"><span id="EN-US_TASK_0172368959__cmd2055943645214337">Run <a href="cmdqueryname=router-id"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1789604276214048">router-id</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname1221035943214048">ipv4-address</span></i></span><p><p id="EN-US_TASK_0172368959__p936712712214337">A router ID is configured.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep730623982214048"><span id="EN-US_TASK_0172368959__cmd1763300739214337">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname692623943214048">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname1311058800214048">ipv6-address</span></i> <strong><span id="EN-US_TASK_0172368959__cmdparmname2127369518214048">as-number</span></strong> { <i><span class="varname" id="EN-US_TASK_0172368959__varname163815504214048">as-number-plain</span></i> | <i><span class="varname" id="EN-US_TASK_0172368959__varname1461280490214048">as-number-dot</span></i> }</span><p><p id="EN-US_TASK_0172368959__p1745673266214337">The remote PE is configured as a peer.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep1107377037214048"><span id="EN-US_TASK_0172368959__cmd753978999214337">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1790499347214048">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname2104387086214048">ipv6-address</span></i> <a href="cmdqueryname=connect-interface"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname300856224214048">connect-interface</span></b></a> <strong><span id="EN-US_TASK_0172368959__cmdparmname150111444214048">loopback</span></strong> <i><span class="varname" id="EN-US_TASK_0172368959__varname18858530214048">interface-number</span></i></span><p><p id="EN-US_TASK_0172368959__p1196383004214337">The interface on which a TCP connection to the specified BGP peer is established is specified.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep584936591214048"><span id="EN-US_TASK_0172368959__cmd1992762171214337">Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname657601096214048">ipv4-family</span></b></a> <strong><span id="EN-US_TASK_0172368959__cmdparmname40559472214048">vpnv4</span></strong></span><p><p id="EN-US_TASK_0172368959__p1145297571214337">The BGP VPNv4 address family view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep1821788181214048"><span id="EN-US_TASK_0172368959__cmd2119602788214048">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1021361498214048">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname1661919953214048">peerIpv6Addr</span></i> <strong><span id="EN-US_TASK_0172368959__cmdparmname1178795602214048">enable</span></strong></span><p><p id="EN-US_TASK_0172368959__p1525113916216">The device is enabled to exchange VPN-IPv4 routes with the specified peer.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep790449690214048"><span id="EN-US_TASK_0172368959__cmd944164693214337">Run <span><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname127645640214337">commit</span></b></a></span></span><p><p id="EN-US_TASK_0172368959__p1343150337214337">The configuration is committed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep650493266214048"><span id="EN-US_TASK_0172368959__cmd1015145792214337">Run <span><a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname513446555214337">quit</span></b></a></span></span><p><p id="EN-US_TASK_0172368959__p400270680214337">Exit the BGP VPNv4 address family view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep105393422214048"><span id="EN-US_TASK_0172368959__cmd860476112214337">Run <span><a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1822976313214337">quit</span></b></a></span></span><p><p id="EN-US_TASK_0172368959__p968028032214337">Exit the BGP view.</p>
</p></li></ol>
</li><li><span>Configure basic SRv6 functions.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=segment-routing+ipv6"><b><span class="cmdname">segment-routing ipv6</span></b></a></span><p><p>SRv6 is enabled, and the SRv6 view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep626838396214048"><span id="EN-US_TASK_0172368959__cmd1865633037214048">Configure a source address for SRv6 encapsulation. Note that you only need to perform one of the following operations. If both of the operations are performed, the latest configuration overrides the previous one.</span><p><ul id="EN-US_TASK_0172368959__ul261475310544"><li id="EN-US_TASK_0172368959__li761411538546">Run the <a href="cmdqueryname=encapsulation+source-address"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname23368553547">encapsulation source-address</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname6336145515412">ipv6-address</span></i> [ <strong><span id="EN-US_TASK_0172368959__cmdparmname1633612551542">ip-ttl</span></strong> <i><span class="varname" id="EN-US_TASK_0172368959__varname2033635519549">ttl-value</span></i> ] command to directly configure a source address for SRv6 encapsulation.</li><li id="EN-US_TASK_0172368959__li1554119145516">Run the <a href="cmdqueryname=encapsulation+source-interface"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname10488513573">encapsulation source-interface</span></b></a> { <i><span class="varname" id="EN-US_TASK_0172368959__varname0729113313571">intfname</span></i> | <i><span class="varname" id="EN-US_TASK_0172368959__varname17377153912578">interfaceType</span></i> <i><span class="varname" id="EN-US_TASK_0172368959__varname1951134465716">interfaceNum</span></i> } [ <strong id="EN-US_TASK_0172368959__b7945154716571">ip-ttl</strong> <i><span class="varname" id="EN-US_TASK_0172368959__varname2091014584572">ttl-value</span></i> ] command to specify the interface to which the source address used for SRv6 encapsulation belongs.<p id="EN-US_TASK_0172368959__p2488153115910">If no IPv6 global address is configured for the interface specified using the <a href="cmdqueryname=encapsulation+source-interface"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname2054948195915">encapsulation source-interface</span></b></a> command, the source address for SRv6 encapsulation is not configured.</p>
</li></ul>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=locator"><b><span class="cmdname">locator</span></b></a> <i><span class="varname">locator-name</span></i> [ <strong><span>ipv6-prefix</span></strong> <i><span class="varname">ipv6-address</span></i> <i><span class="varname">prefix-length</span></i> [ <strong><span>static</span></strong> <i><span class="varname">static-length</span></i> | <strong><span>args</span></strong> <i><span class="varname">args-length</span></i> ] <sup>*</sup> </span><span>]</span></span><p><p>An SRv6 locator is configured, and the SRv6 locator view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep788798827214048"><span id="EN-US_TASK_0172368959__cmd925332458214048">(Optional) Run <a href="cmdqueryname=opcode"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1766088994214048">opcode</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname227013489123">func-opcode</span></i> <strong><span id="EN-US_TASK_0172368959__cmdparmname827354818128">end-dt4</span></strong> <strong><span id="EN-US_TASK_0172368959__cmdparmname15273948111220">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0172368959__varname10273154831216">vpn-instance-name</span></i> or <a href="cmdqueryname=opcode"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1864624914713">opcode</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname152731448101214">func-opcode</span></i> <strong><span id="EN-US_TASK_0172368959__cmdparmname62747482125">end-dt46</span></strong> <strong><span id="EN-US_TASK_0172368959__cmdparmname102741848121218">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0172368959__varname1427418482123">vpn-instance-name</span></i></span><p><p id="EN-US_TASK_0172368959__p51892591320">An opcode for static SIDs is configured.</p>
</p><p><p id="EN-US_TASK_0172368959__p16765656135513">A SID can be either dynamically allocated by BGP or manually configured. If you want to run the <span><a href="cmdqueryname=segment-routing+ipv6+locator"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname175640204576">segment-routing ipv6 locator</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname112008017135">locator-name</span></i></span> command to enable dynamic End.DT4 SID allocation through BGP or the <span><a href="cmdqueryname=segment-routing+ipv6+locator"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname5915391314">segment-routing ipv6 locator</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname6200170181310">locator-name</span></i></span> <a href="cmdqueryname=end-dt46"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname15469174113155">end-dt46</span></b></a> command to enable dynamic End.DT46 SID allocation through BGP in the future, skip this step.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the SRv6 locator view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the SRv6 view.</p>
</p></li></ol>
</li><li><span>Enable IS-IS SRv6 on PEs.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=isis"><b><span class="cmdname">isis</span></b></a> [ <em>process-id</em> ]</span><p><p>The IS-IS view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv6+enable+topology+ipv6"><b><span class="cmdname">ipv6 enable topology ipv6</span></b></a></span><p><p>The IPv6 capability is enabled for the IS-IS process in the IPv6 topology.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=segment-routing+ipv6"><b><span class="cmdname">segment-routing ipv6</span></b></a> <strong>locator</strong> <em>locator-name</em> [ <strong>auto-sid-disable</strong> ]</span><p><p>IS-IS SRv6 is enabled.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=segment-routing+ipv6+auto-sid+advertise"><b><span class="cmdname">segment-routing ipv6 auto-sid advertise</span></b></a> { <strong><span>no-flavor</span></strong> | <strong><span>psp</span></strong> | <strong><span>psp-usp-usd</span></strong> | <strong><span>psp-usp-usd-coc</span></strong> | <strong><span>coc</span></strong> | <strong><span>psp-coc</span></strong> | <strong><span>psp-usp-usd-coc-next</span></strong> | <strong><span>psp-usd-next</span></strong> } <sup>*</sup></span><p><p>The function to adjust the flavors to be carried in dynamically allocated End and End.X SIDs is enabled.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the IS-IS view.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0172368959__step101549353012"><span id="EN-US_TASK_0172368959__cmd151541932303">Configure each PE to carry SIDs in VPN routes and recurse the routes to SRv6 BE paths based on the SIDs.</span><ol type="a" id="EN-US_TASK_0172368959__substeps5484138183012"><li class="substepexpand" id="EN-US_TASK_0172368959__substep1170240813214048"><span id="EN-US_TASK_0172368959__cmd1822715730214337">Run <a href="cmdqueryname=bgp"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1186791007214048">bgp</span></b></a> { <i><span class="varname" id="EN-US_TASK_0172368959__varname477606664214048">as-number-plain</span></i> | <i><span class="varname" id="EN-US_TASK_0172368959__varname502972833214048">as-number-dot</span></i> }</span><p><p id="EN-US_TASK_0172368959__p1455355197214337">The BGP view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep449599382214048"><span id="EN-US_TASK_0172368959__cmd1630226361214337">Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1921563691214048">ipv4-family</span></b></a> <strong><span id="EN-US_TASK_0172368959__cmdparmname1838959546214048">vpnv4</span></strong></span><p><p id="EN-US_TASK_0172368959__p863647243214337">The BGP VPNv4 address family view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep75498921214048"><span id="EN-US_TASK_0172368959__cmd1588745116366">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1132974491214048">peer</span></b></a> { <i><span class="varname" id="EN-US_TASK_0172368959__varname667456758214048">ipv6-address</span></i> | <i><span class="varname" id="EN-US_TASK_0172368959__varname10653114225511">peerGroupName</span></i> } <strong><span id="EN-US_TASK_0172368959__cmdparmname1459950268214048">prefix-sid</span></strong> [ <strong><span id="EN-US_TASK_0172368959__cmdparmname192318115443">sid-type5</span></strong><strong id="EN-US_TASK_0172368959__b530725744311"> </strong>[<strong id="EN-US_TASK_0172368959__b666747144318"> </strong><strong><span id="EN-US_TASK_0172368959__cmdparmname129501954154310">advertise-srv6-locator</span></strong> ] ]</span><p><p id="EN-US_TASK_0172368959__p19129124593614">The device is enabled to exchange IPv4 prefix SIDs with the specified IPv6 peer.</p>
</p><p><p id="EN-US_TASK_0172368959__p99719195386">In a scenario where BFD is used to check locator reachability and the P nodes between local and remote PEs summarize locator routes, you can specify the <strong><span id="EN-US_TASK_0172368959__cmdparmname967116221577">advertise-srv6-locator</span></strong> parameter to enable PE-advertised BGP routes to carry locator length information. In this way, when the peer IPv6 address bound to the BFD session matches the locator's IPv6 address, locator reachability can be checked using BFD to complete VPN FRR or auto FRR path switching.</p>
<p id="EN-US_TASK_0172368959__p77661711116">If <i><span class="varname" id="EN-US_TASK_0172368959__varname1460783617489">peerGroupName</span></i> is specified, the command configuration takes effect on all peers in the specified peer group.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep42681543214048"><span id="EN-US_TASK_0172368959__cmd1706596996214337">Run <span><a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname42210577214337">quit</span></b></a></span></span><p><p id="EN-US_TASK_0172368959__p1523886424214337">Exit the BGP VPNv4 address family view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep14980133210333"><span id="EN-US_TASK_0172368959__cmd4239140203310">Configure the device to add SIDs to VPN routes. Note that you need to perform configurations only in one of the following two views. If you perform configurations in both views, the configurations in these views are mutually exclusive.</span><p><ul id="EN-US_TASK_0172368959__ul152411240193320"><li id="EN-US_TASK_0172368959__li8685185120348">Configurations in the BGP-VPN instance IPv4 address family view<ol class="substepthirdol" id="EN-US_TASK_0172368959__ol697213138182"><li id="EN-US_TASK_0172368959__li19731613141814">Run the <a href="cmdqueryname=ipv4-family"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname195814633514">ipv4-family</span></b></a> <strong><span id="EN-US_TASK_0172368959__cmdparmname165816663510">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0172368959__varname1158116653517">vpn-instance-name</span></i> command to enter the BGP-VPN instance IPv4 address family view.</li><li id="EN-US_TASK_0172368959__li92161123171819">Run the <span id="EN-US_TASK_0172368959__ph158560437245"><a href="cmdqueryname=segment-routing+ipv6+locator"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1085610434249">segment-routing ipv6 locator</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname4856124362411">locator-name</span></i> [ <strong><span id="EN-US_TASK_0172368959__cmdparmname1585684319243">auto-sid-disable</span></strong> ]</span> command to enable the device to add SIDs to VPN routes.<p id="EN-US_TASK_0172368959__p12661554161810">If <strong><span id="EN-US_TASK_0172368959__cmdparmname128561436249">auto-sid-disable</span></strong> is not specified, the device supports dynamic SID allocation. If there are static SIDs in the range of the locator specified using <i><span class="varname" id="EN-US_TASK_0172368959__varname585624317243">locator-name</span></i>, the static SIDs are used. Otherwise, dynamically allocated SIDs are used.</p>
<p id="EN-US_TASK_0172368959__p826725419187">If <strong><span id="EN-US_TASK_0172368959__cmdparmname5856114319243">auto-sid-disable</span></strong> is specified, BGP does not dynamically allocate SIDs.</p>
</li></ol>
</li><li id="EN-US_TASK_0172368959__li62656718365">Configurations in the BGP-VPN instance view<ol class="substepthirdol" id="EN-US_TASK_0172368959__ol85026147199"><li id="EN-US_TASK_0172368959__li11502714161913">Run the <a href="cmdqueryname=vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname87223213288">vpn-instance</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname46654893611">vpn-instance-name</span></i> command to create a BGP-VPN instance and enter its view.</li><li id="EN-US_TASK_0172368959__li03341721181911">Run the <a href="cmdqueryname=segment-routing+ipv6+locator"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname137109216447">segment-routing ipv6 locator</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname67104219449">locator-name</span></i> <strong><span id="EN-US_TASK_0172368959__cmdparmname1656920319446">end-dt46</span></strong> command to enable the device to add SIDs to VPN routes.</li><li id="EN-US_TASK_0172368959__li323322611911">Run the <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname215812542514">quit</span></b></a> command to exit the BGP-VPN instance view.</li><li id="EN-US_TASK_0172368959__li580053519304">Run the <a href="cmdqueryname=ipv4-family+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname1853071483115">ipv4-family vpn-instance</span></b></a> <i><span class="varname" id="EN-US_TASK_0172368959__varname8891125515301">vpn-instance-name</span></i> command to enter the BGP-VPN instance IPv4 address family view.</li></ol>
</li></ul>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep71331355252"><span id="EN-US_TASK_0172368959__cmd41331135202517">Run <a href="cmdqueryname=segment-routing+ipv6+best-effort"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname2133103518257">segment-routing ipv6 best-effort</span></b></a></span><p><p id="EN-US_TASK_0172368959__p11259164714199">The device is enabled to recurse VPN routes based on the SIDs carried in the routes.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172368959__substep269302736214048"><span id="EN-US_TASK_0172368959__cmd462263618214337">Run <span><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172368959__cmdname38508164214337">commit</span></b></a></span></span><p><p id="EN-US_TASK_0172368959__p1071014134214337">The configuration is committed.</p>
</p></li></ol>
</li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0172368959__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After configuring L3VPNv4 over SRv6 BE, verify the configuration.</p>
<ul><li><p>Run the <a href="cmdqueryname=display+segment-routing+ipv6+locator"><b><span class="cmdname">display segment-routing ipv6 locator</span></b></a> [ <i><span class="varname">locator-name</span></i> ] <strong><span>verbose</span></strong> command to check SRv6 locator information.</p>
</li><li><p>Run the <a href="cmdqueryname=display+segment-routing+ipv6+local-sid"><b><span class="cmdname">display segment-routing ipv6 local-sid</span></b></a> { <strong><span>end</span></strong> | <strong><span>end-x</span></strong> | <strong><span>end-dt4</span></strong> | <strong><span>end-dt46</span></strong> } [ <i><span class="varname">sid</span></i> ] <strong><span>forwarding</span></strong> command to check information about the SRv6 local SID table.</p>
</li><li><p>Run the <a href="cmdqueryname=display+bgp+vpnv4"><b><span class="cmdname">display bgp vpnv4</span></b></a> { <strong>all</strong> | <strong>route-distinguisher </strong><em>route-distinguisher</em> | <strong>vpn-instance</strong><em> vpn-instance-name</em> } <strong>routing-table</strong> [ <em>network</em> [ <em>prefix-length</em> ] ] command to check BGP VPNv4 route information.</p>
</li><li><p>Run the <a href="cmdqueryname=ping"><b><span class="cmdname">ping</span></b></a> command to check the connectivity between CEs.</p>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0002.html">Configuring SRv6 BE (IS-IS)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0251.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>