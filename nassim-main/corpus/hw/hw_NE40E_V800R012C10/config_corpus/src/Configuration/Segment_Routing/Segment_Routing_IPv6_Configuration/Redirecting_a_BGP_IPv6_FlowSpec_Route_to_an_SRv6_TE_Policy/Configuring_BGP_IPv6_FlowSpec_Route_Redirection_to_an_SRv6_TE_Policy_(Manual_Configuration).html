
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring BGP IPv6 FlowSpec Route Redirection to an SRv6 TE Policy (Manual Configuration)">
<meta name="abstract" content="Manually configure a BGP IPv6 FlowSpec route and define a redirection rule to redirect the route to an SRv6 TE Policy.">
<meta name="description" content="Manually configure a BGP IPv6 FlowSpec route and define a redirection rule to redirect the route to an SRv6 TE Policy.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0126.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0128.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00587852">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0317208085">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring BGP IPv6 FlowSpec Route Redirection to an SRv6 TE Policy (Manual Configuration)</title>
</head>
<body><a name="EN-US_TASK_0317208085"></a><a name="EN-US_TASK_0317208085"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring BGP IPv6 FlowSpec Route Redirection to an SRv6 TE Policy (Manual Configuration)</h1>
<div class="taskbody"><p>Manually configure a BGP IPv6 FlowSpec route and define a redirection rule to redirect the route to an SRv6 TE Policy.</p>
<div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0317208085__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before configuring BGP IPv6 FlowSpec route redirection to an SRv6 TE Policy, complete the following tasks:</p>
<ul><li><a href="dc_vrp_bgp_cfg_3006.html">Configure a BGP peer relationship.</a></li><li><a href="dc_vrp_srv6_cfg_all_0110.html">Configure an SRv6 TE Policy in manual configuration mode.</a></li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0317208085__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>In a scenario where no controller is deployed, you can manually configure BGP IPv6 FlowSpec route redirection to an SRv6 TE Policy. The configuration process mainly includes the following steps:</p>
<ol><li>Manually configure an SRv6 TE Policy.</li><li>Manually configure a BGP IPv6 FlowSpec route and define a redirection rule. BGP IPv6 FlowSpec route redirection is implemented based on &lt;Redirection IPv6 address, Color, Public network End.DT6 SID&gt;. If the redirection IPv6 address, color, and public network End.DT6 SID attributes of a BGP IPv6 FlowSpec route match the endpoint, color, and public network End.DT6 SID attributes of an SRv6 TE Policy, the route can be successfully redirected to the SRv6 TE Policy.</li><li>To enable the device to advertise the BGP IPv6 FlowSpec route to another device, establish a BGP peer relationship in the BGP-Flow-IPv6 address family.</li></ol>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0317208085__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure a public network End.DT6 SID.</span><p><ol><li>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a><p>The system view is displayed.</p>
</li><li>Run <a href="cmdqueryname=segment-routing+ipv6"><b><span class="cmdname">segment-routing ipv6</span></b></a><p>SRv6 is enabled, and the SRv6 view is displayed.</p>
</li><li>Configure a source address for SRv6 VPN encapsulation. Note that you only need to perform one of the following operations. If both of the operations are performed, the latest configuration overrides the previous one.<ul id="EN-US_TASK_0317208085__en-us_task_0200607314_ul148941944201215"><li id="EN-US_TASK_0317208085__en-us_task_0200607314_en-us_task_0172368959_li761411538546">Run the <a href="cmdqueryname=encapsulation+source-address"><b><span class="cmdname" id="EN-US_TASK_0317208085__en-us_task_0200607314_en-us_task_0172368959_cmdname23368553547">encapsulation source-address</span></b></a> <i><span class="varname" id="EN-US_TASK_0317208085__en-us_task_0200607314_en-us_task_0172368959_varname6336145515412">ipv6-address</span></i> [ <strong><span id="EN-US_TASK_0317208085__en-us_task_0200607314_en-us_task_0172368959_cmdparmname1633612551542">ip-ttl</span></strong> <i><span class="varname" id="EN-US_TASK_0317208085__en-us_task_0200607314_en-us_task_0172368959_varname2033635519549">ttl-value</span></i> ] command to specify a source address for SRv6 encapsulation.</li><li id="EN-US_TASK_0317208085__en-us_task_0200607314_en-us_task_0172368959_li1554119145516">Run the <a href="cmdqueryname=encapsulation+source-interface"><b><span class="cmdname" id="EN-US_TASK_0317208085__en-us_task_0200607314_en-us_task_0172368959_cmdname10488513573">encapsulation source-interface</span></b></a> { <i><span class="varname" id="EN-US_TASK_0317208085__en-us_task_0200607314_en-us_task_0172368959_varname0729113313571">intfname</span></i> | <i><span class="varname" id="EN-US_TASK_0317208085__en-us_task_0200607314_en-us_task_0172368959_varname17377153912578">interfaceType</span></i> <i><span class="varname" id="EN-US_TASK_0317208085__en-us_task_0200607314_en-us_task_0172368959_varname1951134465716">interfaceNum</span></i> } [ <strong id="EN-US_TASK_0317208085__en-us_task_0200607314_en-us_task_0172368959_b7945154716571">ip-ttl</strong> <i><span class="varname" id="EN-US_TASK_0317208085__en-us_task_0200607314_en-us_task_0172368959_varname2091014584572">ttl-value</span></i> ] command to specify the interface to which the source address used for SRv6 encapsulation belongs.<p id="EN-US_TASK_0317208085__en-us_task_0200607314_en-us_task_0172368959_p2488153115910">If no IPv6 global address is configured for the interface specified using the <a href="cmdqueryname=encapsulation+source-interface"><b><span class="cmdname" id="EN-US_TASK_0317208085__en-us_task_0200607314_en-us_task_0172368959_cmdname2054948195915">encapsulation source-interface</span></b></a> command, the source address for SRv6 encapsulation is not configured.</p>
</li></ul>
</li><li><p>Run <span><a href="cmdqueryname=locator"><b><span class="cmdname">locator</span></b></a> <i><span class="varname">locator-name</span></i> [ <strong><span>ipv6-prefix</span></strong> <i><span class="varname">ipv6-address</span></i> <i><span class="varname">prefix-length</span></i> [ <strong><span>static</span></strong> <i><span class="varname">static-length</span></i> | <strong><span>args</span></strong> <i><span class="varname">args-length</span></i> ] <sup>*</sup> ]</span></p>
<p>An SRv6 locator is configured, and the SRv6 locator view is displayed.</p>
</li><li>Run <a href="cmdqueryname=opcode"><b><span class="cmdname">opcode</span></b></a> <i><span class="varname">func-opcode</span></i> <strong><span>end-dt6</span></strong><p>A public network End.DT6 SID is configured.</p>
</li><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>Exit the SRv6 locator view.</p>
</li><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>Exit the SRv6 view.</p>
</li><li>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a><p>The configuration is committed.</p>
</li></ol>
</p></li><li><span>Configure a BGP IPv6 FlowSpec route.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=flow-route"><b><span class="cmdname">flow-route</span></b></a> <i><span class="varname">flowroute-name</span></i> <strong><span>ipv6</span></strong></span><p><p>A static BGP IPv6 FlowSpec route is created, and the Flow-Route-IPv6 view is displayed.</p>
</p></li><li class="substepexpand"><span>Configure <a href="cmdqueryname=if-match"><b><span class="cmdname">if-match</span></b></a> clauses. For details, see "BGP Flow Specification Configuration" in <em>Configuration</em> - <em>Security</em>.</span></li><li class="substepexpand"><span>Run <a href="cmdqueryname=apply+redirect"><b><span class="cmdname">apply redirect</span></b></a> <strong><span>ipv6</span></strong> <i><span class="varname">redirectIPv6RT</span></i> <strong><span>color</span></strong> <i><span class="varname">colorValue</span></i> [ <strong><span>prefix-sid</span></strong> <i><span class="varname">prefix-sid-value</span></i> ]</span><p><p>The traffic that matches the <strong>if-match</strong> clauses is precisely redirected to the specified SRv6 TE Policy.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the Flow-Route-IPv6 view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure a BGP peer relationship in the BGP-IPv6-Flow address family.</span><p><p>Establish a BGP IPv6 FlowSpec peer relationship between the headend of the SRv6 TE Policy and the device on which the BGP IPv6 FlowSpec route is manually configured.</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv6-family+flow"><b><span class="cmdname">ipv6-family flow</span></b></a></span><p><p>The BGP-IPv6-Flow address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">ipv6-address</span></i> } <strong><span>enable</span></strong></span><p><p>A BGP IPv6 FlowSpec peer relationship is established.</p>
</p><p><p>After the BGP IPv6 FlowSpec peer relationship is established in the BGP-IPv6-Flow address family view, the manually configured BGP IPv6 FlowSpec route is imported automatically to the BGP routing table and then advertised to the specified BGP IPv6 FlowSpec peer.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the BGP-IPv6-Flow address family view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the BGP view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Allow the device to recurse static BGP IPv6 FlowSpec routes to corresponding tunnels.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=tunnel-selector"><b><span class="cmdname">tunnel-selector</span></b></a><strong> </strong><em>name</em><em> matchMode </em><strong>node </strong><em>node</em></span><p><p>A tunnel selector is created, and its view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the tunnel selector view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv6-family+flow"><b><span class="cmdname">ipv6-family flow</span></b></a></span><p><p>The BGP-IPv6-Flow address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=local-route+redirect+ipv6+recursive-lookup+tunnel"><b><span class="cmdname">local-route redirect ipv6 recursive-lookup tunnel</span></b></a> <strong><span>tunnel-selector</span></strong> <i><span class="varname">tunnel-selector-name</span></i></span><p><p>The device is allowed to recurse static BGP IPv6 FlowSpec routes to corresponding tunnels.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
<div class="example"><a name="EN-US_TASK_0317208085__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After the configuration is complete, verify the configuration.</p>
<ul><li><p>Run the <a href="cmdqueryname=display+bgp+flow+ipv6+peer"><b><span class="cmdname">display bgp flow ipv6 peer</span></b></a> command to check BGP IPv6 FlowSpec peer information.</p>
</li><li><p>Run the <a href="cmdqueryname=display+bgp+flow+ipv6+routing-table"><b><span class="cmdname">display bgp flow ipv6 routing-table</span></b></a> command to check BGP IPv6 FlowSpec routing information.</p>
</li><li><p>Run the <a href="cmdqueryname=display+bgp+flow+ipv6+routing-table+statistics"><b><span class="cmdname">display bgp flow ipv6 routing-table statistics</span></b></a> command to check BGP IPv6 FlowSpec route statistics.</p>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0126.html">Redirecting a BGP IPv6 FlowSpec Route to an SRv6 TE Policy
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0128.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>