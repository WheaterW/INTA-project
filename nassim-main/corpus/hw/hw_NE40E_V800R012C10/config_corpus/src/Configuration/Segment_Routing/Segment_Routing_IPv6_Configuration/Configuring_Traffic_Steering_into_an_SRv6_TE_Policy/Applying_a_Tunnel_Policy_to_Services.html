
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Applying a Tunnel Policy to Services">
<meta name="abstract" content="After configuring a traffic steering policy, you can apply a tunnel policy to specified services for them to recurse to an SRv6 TE Policy.">
<meta name="description" content="After configuring a traffic steering policy, you can apply a tunnel policy to specified services for them to recurse to an SRv6 TE Policy.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0290.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0294.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00556928,j00915314,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00587852">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00587852">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0173667624">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Applying a Tunnel Policy to Services</title>
</head>
<body><a name="EN-US_TASK_0173667624"></a><a name="EN-US_TASK_0173667624"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Applying a Tunnel Policy to Services</h1>
<div class="taskbody"><p>After configuring a traffic steering policy, you can apply a tunnel policy to specified services for them to recurse to an SRv6 TE Policy.</p>
<div class="context"><a name="EN-US_TASK_0173667624__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>After an SRv6 TE Policy is configured, traffic needs to be steered into the SRv6 TE Policy for forwarding. This process is called traffic steering. Currently, SRv6 TE Policies can be used for various services, such as BGP L3VPN and EVPN services. This section describes how to apply a tunnel policy to allow services to recurse to an SRv6 TE Policy.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>EVPN VPWS and EVPN VPLS services do not support DSCP-based traffic steering.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0173667624__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure BGP L3VPNv4 service recursion to an SRv6 TE Policy.</span><p><p>For details about how to configure BGP L3VPNv4, see <a href="dc_vrp_mpls-l3vpn-v4_cfg_0154.html">Configuring a Basic BGP/MPLS IP VPN</a>.</p>
<ol type="a"><li><p>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></p>
<p>The system view is displayed.</p>
</li><li>Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i><p>The VPN instance view is displayed.</p>
</li><li>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a><p>The VPN instance IPv4 address family view is displayed.</p>
</li><li>Run <a href="cmdqueryname=tnl-policy"><b><span class="cmdname">tnl-policy</span></b></a> <i><span class="varname">policy-name</span></i><p>A tunnel policy is applied to the VPN instance IPv4 address family.</p>
</li><li><p>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></p>
<p>The configuration is committed.</p>
</li></ol>
</p></li><li><span>Configure BGP L3VPNv6 service recursion to an SRv6 TE Policy.</span><p><p>For details about how to configure BGP L3VPNv6, see <a href="dc_vrp_mpls-l3vpn-v6_cfg_2057.html">Configuring a Basic BGP/MPLS IPv6 VPN</a>.</p>
<ol type="a"><li><p>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></p>
<p>The system view is displayed.</p>
</li><li>Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i><p>The VPN instance view is displayed.</p>
</li><li>Run <a href="cmdqueryname=ipv6-family"><b><span class="cmdname">ipv6-family</span></b></a><p>The VPN instance IPv6 address family view is displayed.</p>
</li><li>Run <a href="cmdqueryname=tnl-policy"><b><span class="cmdname">tnl-policy</span></b></a> <i><span class="varname">policy-name</span></i><p>The specified tunnel policy is applied to the VPN instance IPv6 address family.</p>
</li><li><p>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></p>
<p>The configuration is committed.</p>
</li></ol>
</p></li><li><span>Configure EVPN service recursion to an SRv6 TE Policy.</span><p><div class="p">To apply a tunnel policy to an EVPN L3VPN instance, perform the following steps:<ol type="a"><li><p>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></p>
<p>The system view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></p>
<p>The VPN instance view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a> or <a href="cmdqueryname=ipv6-family"><b><span class="cmdname">ipv6-family</span></b></a></p>
<p>The VPN instance IPv4 or IPv6 address family view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=tnl-policy"><b><span class="cmdname">tnl-policy</span></b></a> <i><span class="varname">policy-name</span></i> <strong><span>evpn</span></strong></p>
<p>A tunnel policy is applied to the EVPN L3VPN instance.</p>
</li><li><p>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></p>
<p>The configuration is committed.</p>
</li></ol>
</div>
<div class="p">To apply a tunnel policy to a BD EVPN instance, perform the following steps:<ol type="a"><li><p>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></p>
<p>The system view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=evpn+vpn-instance"><b><span class="cmdname">evpn vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i> <strong><span>bd-mode</span></strong></p>
<p>The BD EVPN instance view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=tnl-policy"><b><span class="cmdname">tnl-policy</span></b></a> <i><span class="varname">policy-name</span></i></p>
<p>A tunnel policy is applied to the BD EVPN instance.</p>
</li><li><p>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></p>
<p>The configuration is committed.</p>
</li></ol>
</div>
<div class="p">To apply a tunnel policy to an EVPN instance that works in EVPN VPWS mode, perform the following steps:<ol type="a"><li><p>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></p>
<p>The system view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=evpn+vpn-instance"><b><span class="cmdname">evpn vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i> <strong><span>vpws</span></strong></p>
<p>The view of the EVPN instance that works in EVPN VPWS mode is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=tnl-policy"><b><span class="cmdname">tnl-policy</span></b></a> <i><span class="varname">policy-name</span></i></p>
<p>A tunnel policy is applied to the EVPN instance that works in EVPN VPWS mode.</p>
</li><li><p>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></p>
<p>The configuration is committed.</p>
</li></ol>
</div>
<p>To apply a tunnel policy to a basic EVPN instance, perform the following steps:</p>
<ol type="a"><li><p>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></p>
<p>The system view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=evpn+vpn-instance"><b><span class="cmdname">evpn vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></p>
<p>The basic EVPN instance view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=tnl-policy"><b><span class="cmdname">tnl-policy</span></b></a> <i><span class="varname">policy-name</span></i></p>
<p>A tunnel policy is applied to the basic EVPN instance.</p>
</li><li><p>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></p>
<p>The configuration is committed.</p>
</li></ol>
</p></li><li><span>Configure public network IPv4 service recursion to an SRv6 TE Policy.</span><p><ol type="a"><li>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a><p>The system view is displayed.</p>
</li><li>Run <a href="cmdqueryname=tunnel-selector"><b><span class="cmdname">tunnel-selector</span></b></a><strong> </strong><em>name</em><em> matchMode </em><strong>node </strong><em>node</em><p>A tunnel selector is created, and its view is displayed.</p>
</li><li>Run <a href="cmdqueryname=apply+tunnel-policy"><b><span class="cmdname">apply tunnel-policy</span></b></a><strong> </strong><em>tunnel-policy-name</em><p>A tunnel policy is applied to the tunnel selector.</p>
</li><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>Return to the system view.</p>
</li><li>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i><p>The BGP view is displayed.</p>
</li><li>Run <a href="cmdqueryname=ipv6-family+unicast"><b><span class="cmdname">ipv4-family</span></b></a> <strong><span>unicast</span></strong><p>The IPv4 unicast address family view is displayed.</p>
</li><li>Run <a href="cmdqueryname=unicast-route+recursive-lookup+tunnel-v6+tunnel-selector"><b><span class="cmdname">unicast-route recursive-lookup tunnel-v6 tunnel-selector</span></b></a><strong> </strong><em>tunnel-selector-name</em><p>The device is enabled to recurse IPv4 unicast routes received from a BGP IPv6 peer to tunnels.</p>
</li><li>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a><p>The configuration is committed.</p>
</li></ol>
</p></li><li><span>Configure public network IPv6 service recursion to an SRv6 TE Policy.</span><p><ol type="a"><li>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a><p>The system view is displayed.</p>
</li><li>Run <a href="cmdqueryname=tunnel-selector"><b><span class="cmdname">tunnel-selector</span></b></a><strong> </strong><em>name</em><em> matchMode </em><strong>node </strong><em>node</em><p>A tunnel selector is created, and its view is displayed.</p>
</li><li>Run <a href="cmdqueryname=apply+tunnel-policy"><b><span class="cmdname">apply tunnel-policy</span></b></a><strong> </strong><em>tunnel-policy-name</em><p>A tunnel policy is applied to the tunnel selector.</p>
</li><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>Return to the system view.</p>
</li><li>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i><p>The BGP view is displayed.</p>
</li><li>Run <a href="cmdqueryname=ipv6-family+unicast"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>unicast</span></strong><p>The IPv6 unicast address family view is displayed.</p>
</li><li>Run <a href="cmdqueryname=unicast-route+recursive-lookup+tunnel-v6+tunnel-selector"><b><span class="cmdname">unicast-route recursive-lookup tunnel-v6 tunnel-selector</span></b></a><strong> </strong><em>tunnel-selector-name</em><p>The device is enabled to recurse IPv6 unicast routes received from a BGP IPv6 peer to tunnels.</p>
</li><li>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a><p>The configuration is committed.</p>
</li></ol>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0290.html">Configuring Traffic Steering into an SRv6 TE Policy
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0294.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>