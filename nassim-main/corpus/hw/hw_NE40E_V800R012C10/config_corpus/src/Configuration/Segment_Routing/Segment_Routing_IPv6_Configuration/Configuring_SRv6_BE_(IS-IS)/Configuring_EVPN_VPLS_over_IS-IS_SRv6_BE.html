
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring EVPN VPLS over IS-IS SRv6 BE">
<meta name="abstract" content="When the EVPN E-LAN model is used to carry multipoint-to-multipoint (MP2MP) VPLSs, EVPN VPLS over SRv6 BE can be configured to transmit EVPN E-LAN data over SRv6 BE paths on a public network.">
<meta name="description" content="When the EVPN E-LAN model is used to carry multipoint-to-multipoint (MP2MP) VPLSs, EVPN VPLS over SRv6 BE can be configured to transmit EVPN E-LAN data over SRv6 BE paths on a public network.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0002.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0021.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0034.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featurename" content="EVPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featurename" content="Segment Routing IPv6 Policy">
<meta name="featurename" content="Segment Routing Policy">
<meta name="featuretype" content="Segment Routing">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="Segment Routing IPv6">
<meta name="featuretype" content="Segment Routing">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00587852">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0176593776">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring EVPN VPLS over IS-IS SRv6 BE</title>
</head>
<body><a name="EN-US_TASK_0176593776"></a><a name="EN-US_TASK_0176593776"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring EVPN VPLS over IS-IS SRv6 BE</h1>
<div class="taskbody" id="taskbody1561602455733"><p id="shortdesc938385501214049">When the EVPN E-LAN model is used to carry multipoint-to-multipoint (MP2MP) VPLSs, EVPN VPLS over SRv6 BE can be configured to transmit EVPN E-LAN data over SRv6 BE paths on a public network.</p>
<div class="context"><a name="EN-US_TASK_0176593776__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0176593776__context181470335214049"><h4 class="sectiontitle">Usage Scenario</h4><p id="EN-US_TASK_0176593776__p16729812122810">EVPN VPLS uses the EVPN E-LAN model to carry MP2MP VPLSs. EVPN VPLS over SRv6 BE uses SRv6 BE paths on a public network to carry EVPN E-LAN services. The key implementation of EVPN VPLS over SRv6 BE involves establishing SRv6 BE paths, advertising EVPN routes, and forwarding data.</p>
<p id="EN-US_TASK_0176593776__p57298125287"><a href="#EN-US_TASK_0176593776__fig_dc_vrp_srv6_cfg_all_002101">Figure 1</a> shows an example where an IPv6 public network is established between PE1 and PE2. SRv6 BE can be deployed on the IPv6 public network to carry EVPN E-LAN services.</p>
<div class="fignone" id="EN-US_TASK_0176593776__fig_dc_vrp_srv6_cfg_all_002101"><a name="EN-US_TASK_0176593776__fig_dc_vrp_srv6_cfg_all_002101"></a><a name="fig_dc_vrp_srv6_cfg_all_002101"></a><span class="figcap"><b>Figure 1 </b>EVPN VPLS over SRv6 BE networking</span><br><span><img class="vsd" id="EN-US_TASK_0176593776__image135317175615" src="figure/en-us_image_0210220978.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0176593776__1.4.2"></a><a name="1.4.2"></a>
<div class="p" id="EN-US_TASK_0176593776__context1210194704214049"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p id="EN-US_TASK_0176593776__p503891719214049">Before configuring EVPN VPLS over SRv6 BE, complete the following tasks:</p>
<ul id="EN-US_TASK_0176593776__ul1644218572344"><li id="EN-US_TASK_0176593776__li18442145713343"><p id="EN-US_TASK_0176593776__p19442135783419"><a name="EN-US_TASK_0176593776__li18442145713343"></a><a name="li18442145713343"></a><a href="dc_vrp_isis_cfg_1023.html">Configure basic IPv6 IS-IS functions</a> on the PEs and P.</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0176593776__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0176593776__steps1464562016214049"><li id="EN-US_TASK_0176593776__step4104134616213"><span id="EN-US_TASK_0176593776__cmd410494652118"><a href="dc_vrp_evpn_cfg_0061.html">Configure a BD EVPN instance</a> on each PE.</span></li><li id="EN-US_TASK_0176593776__step14769152719231"><span id="EN-US_TASK_0176593776__cmd117691827122314">Configure an EVPN source address on each PE.</span><ol type="a" id="EN-US_TASK_0176593776__substeps107035011252"><li class="substepexpand" id="EN-US_TASK_0176593776__substep825716532255"><span id="EN-US_TASK_0176593776__cmd142576532258">Run the <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname4257105315254">system-view</span></b></a> command to enter the system view.</span></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep1125819539253"><span id="EN-US_TASK_0176593776__cmd172581953162518">Run the <a href="cmdqueryname=evpn+source-address"><b><span class="cmdname" id="EN-US_TASK_0176593776__en-us_task_0172370452_en-us_task_0172370436_cmdname1775838462214055">evpn source-address</span></b></a> <i><span class="varname" id="EN-US_TASK_0176593776__en-us_task_0172370452_en-us_task_0172370436_varname527942255214055">ip-address</span></i> command to configure an EVPN source address.</span><p><p id="EN-US_TASK_0176593776__p122151555122612">In scenarios where a CE is dual-homed or multi-homed to PEs, you need to configure an EVPN source address on each PE to generate route distinguishers (RDs) for Ethernet segment routes and Ethernet auto-discovery per ES routes.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep11637113622611"><span id="EN-US_TASK_0176593776__cmd156371936142620">Run the <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname263773682612">commit</span></b></a> command to commit the configuration.</span></li></ol>
</li><li id="EN-US_TASK_0176593776__step4915112215275"><span id="EN-US_TASK_0176593776__cmd1891512221278"><a href="dc_vrp_evpn_cfg_0064.html">Configure an ESI</a> on each PE.</span></li><li id="EN-US_TASK_0176593776__step10256191782810"><span id="EN-US_TASK_0176593776__cmd192569177284"><a href="dc_vrp_evpn_cfg_0062.html">Configure a BD and bind it to the EVPN instance</a> on each PE.</span><p><p id="EN-US_TASK_0176593776__p12399712183614">For details about more optional functions, see <a href="dc_vrp_evpn_cfg_0065.html">Configuring the BD EVPN Function</a>.</p>
</p></li><li id="EN-US_TASK_0176593776__step1274795457214049"><span id="EN-US_TASK_0176593776__cmd42899680214049">Establish a BGP EVPN peer relationship between the PEs.</span><ol type="a" id="EN-US_TASK_0176593776__substeps1134867418214049"><li class="substepexpand" id="EN-US_TASK_0176593776__substep2146337079214049"><span id="EN-US_TASK_0176593776__cmd56984447214049">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname251129927214049">system-view</span></b></a></span><p><p id="EN-US_TASK_0176593776__p9886135255210">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep18492171619389"><span id="EN-US_TASK_0176593776__cmd11492516193811">Run <a href="cmdqueryname=bgp"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname116698463382">bgp</span></b></a> { <i><span class="varname" id="EN-US_TASK_0176593776__varname15418145843810">as-number-plain</span></i> | <i><span class="varname" id="EN-US_TASK_0176593776__varname1145172473910">as-number-dot</span></i> }</span><p><p id="EN-US_TASK_0176593776__p20970265319">The BGP view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep1310520433382"><span id="EN-US_TASK_0176593776__cmd9104114311384">(Optional) Run <a href="cmdqueryname=router-id"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname105642136433">router-id</span></b></a> <i><span class="varname" id="EN-US_TASK_0176593776__varname203396274431">ipv4-address</span></i></span><p><p id="EN-US_TASK_0176593776__p27521127539">A BGP router ID is configured.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep318850188214049"><span id="EN-US_TASK_0176593776__cmd943410451214049">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname184901730124416">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0176593776__varname77169408446">ipv6-address</span></i> <strong><span id="EN-US_TASK_0176593776__cmdparmname260474711448">as-number</span></strong> { <i><span class="varname" id="EN-US_TASK_0176593776__varname672522094711">as-number-plain</span></i> | <i><span class="varname" id="EN-US_TASK_0176593776__varname126872694717">as-number-dot</span></i> }</span><p><p id="EN-US_TASK_0176593776__p189082318535">The remote PE is configured as a peer.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep1355958814214049"><span id="EN-US_TASK_0176593776__cmd503324934214049">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname070521184911">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0176593776__varname7764193064919">ipv6-address</span></i> <strong><span id="EN-US_TASK_0176593776__cmdparmname9202238154913">connect-interface</span></strong> <strong><span id="EN-US_TASK_0176593776__cmdparmname9577257204910">loopback</span></strong> <i><span class="varname" id="EN-US_TASK_0176593776__varname1347513145011">interface-number</span></i></span><p><p id="EN-US_TASK_0176593776__p311253511539">The interface on which a TCP connection to the specified BGP peer is established is specified.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep950151211506"><span id="EN-US_TASK_0176593776__cmd85021213503">Run <a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname12575204917506">l2vpn-family evpn</span></b></a></span><p><p id="EN-US_TASK_0176593776__p15841045205317">The BGP EVPN address family view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep1949053210506"><span id="EN-US_TASK_0176593776__cmd11490143216508">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname34477232114">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0176593776__varname47694518712">ipv6-address</span></i> <strong><span id="EN-US_TASK_0176593776__cmdparmname1577112511711">enable</span></strong></span><p><p id="EN-US_TASK_0176593776__p18622355155310">The device is enabled to exchange EVPN routes with the specified peer.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep18230869535"><span id="EN-US_TASK_0176593776__en-us_task_0172368962_cmd15235161165417">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0176593776__en-us_task_0172368962_cmdname2048909283214049">peer</span></b></a> { <i><span class="varname" id="EN-US_TASK_0176593776__en-us_task_0172368962_varname1996321233214049">ipv6-address</span></i> | <i><span class="varname" id="EN-US_TASK_0176593776__en-us_task_0172368962_varname1000192653214049">group-name</span></i> } <strong><span id="EN-US_TASK_0176593776__en-us_task_0172368962_cmdparmname1776334192214049">advertise encap-type</span></strong> <strong><span id="EN-US_TASK_0176593776__en-us_task_0172368962_cmdparmname1014071873214049">srv6</span></strong><span> [ <strong><span id="EN-US_TASK_0176593776__en-us_task_0172368962_cmdparmname629743683918">advertise-srv6-locator</span></strong> ]</span></span><p><p id="EN-US_TASK_0176593776__en-us_task_0172368962_p7940253105314">The device is enabled to send EVPN routes carrying SRv6-encapsulated attributes to the specified peer or peer group.</p>
</p><p><p id="EN-US_TASK_0176593776__en-us_task_0172368962_p746143719434">In a scenario where BFD is used to check locator reachability, if locator routes are summarized by a P device between local and remote PEs, the remote PE can learn only the summary locator route, not the locator on the local PE. This leads to a BFD failure. To address this issue, specify the <strong><span id="EN-US_TASK_0176593776__en-us_task_0172368962_cmdparmname133588371762">advertise-srv6-locator</span></strong> parameter in the command to allow the local PE to carry locator length information in the EVPN route to be advertised to the remote PE. In this way, after receiving the EVPN route, the remote PE can calculate the locator on the local PE, enabling BFD to take effect.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep81481844823"><span id="EN-US_TASK_0176593776__cmd392762818519">(Optional) Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname1439632714419">peer</span></b></a> { <i><span class="varname" id="EN-US_TASK_0176593776__varname160111443225">ipv6-address</span></i> | <i><span class="varname" id="EN-US_TASK_0176593776__varname1060194442213">group-name</span></i> } <strong><span id="EN-US_TASK_0176593776__cmdparmname1939652713414">srv6-label-compatible</span></strong></span><p><p id="EN-US_TASK_0176593776__p18744102015112">SRv6 label compatibility is enabled.</p>
</p><p><p id="EN-US_TASK_0176593776__p131484441213">According to relevant standards, the MPLS Label2 field of IRB routes and the ESI Label field of ES-AD routes sent to SRv6 peers should both be set to 3 in non-transposition scenarios. By default, however, the value of the MPLS Label2 field in IRB routes is a specific MPLS label, and that of the ESI Label field in ES-AD routes is a specific ESI. After the <strong id="EN-US_TASK_0176593776__en-us_task_0172368965_b1333261581113">peer srv6-label-compatible</strong> command is run, the value of the MPLS Label2 field in IRB routes and that of the ESI Label field in ES-AD routes are both changed to 3. To ensure proper interworking between Huawei and non-Huawei devices, you can run this command.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep161315011717"><span id="EN-US_TASK_0176593776__cmd1592715281516">(Optional) Run <a href="cmdqueryname=peer+srv6-label-compatible+inclusive-route"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname6153144141714">peer</span></b></a> { <i><span class="varname" id="EN-US_TASK_0176593776__varname9153114141715">ipv6-address</span></i> | <i><span class="varname" id="EN-US_TASK_0176593776__varname1415311419173">group-name</span></i> } <strong><span id="EN-US_TASK_0176593776__cmdparmname115317441719">srv6-label-compatible inclusive-route</span></strong></span><p><p id="EN-US_TASK_0176593776__p2420192265017">SRv6 label compatibility for inclusive routes is enabled.</p>
</p><p><p id="EN-US_TASK_0176593776__p176421514143618">According to relevant standards, the MPLS Label field in the PMSI attribute of an inclusive route sent to an SRv6 peer should be set to 0 in non-transposition scenarios. By default, however, this field is set to 3 for such a route. After the <strong id="EN-US_TASK_0176593776__b1460395674613">peer srv6-label-compatible inclusive-route</strong> command is run, the value of this field is changed to 0. To ensure proper interworking between Huawei and non-Huawei devices, you can run this command.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep1912615011164"><span id="EN-US_TASK_0176593776__cmd1412619015161">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname116073407265">quit</span></b></a></span><p><p id="EN-US_TASK_0176593776__p148363174542">Exit the BGP EVPN address family view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep1641315556257"><span id="EN-US_TASK_0176593776__cmd154131355142519">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname390112717333">quit</span></b></a></span><p><p id="EN-US_TASK_0176593776__p193562918544">Exit the BGP view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep43011548203312"><span id="EN-US_TASK_0176593776__cmd8301448133314">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname89961164343">commit</span></b></a></span><p><p id="EN-US_TASK_0176593776__p116371839175412">The configuration is committed.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0176593776__step452251000214049"><span id="EN-US_TASK_0176593776__cmd1037930267214049">Configure basic SRv6 functions.</span><ol type="a" id="EN-US_TASK_0176593776__substeps1744855940214049"><li class="substepexpand" id="EN-US_TASK_0176593776__substep843753015441"><span id="EN-US_TASK_0176593776__cmd1043712309441">(Optional) Run <a href="cmdqueryname=evpn+srv6+next-header-field"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname4480156165418">evpn srv6 next-header-field</span></b></a> { <strong><span id="EN-US_TASK_0176593776__cmdparmname1793514311558">59</span></strong> | <strong><span id="EN-US_TASK_0176593776__cmdparmname1818817508616">143</span></strong> }</span><p><p id="EN-US_TASK_0176593776__p1576145019336">A value is set for the Next Header field in an SRv6 extension header.</p>
</p><p><p id="EN-US_TASK_0176593776__p245712013573">If the value is 59 in earlier versions, you can perform this step to change the value to 59 to ensure compatibility with the earlier versions.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep2096084030214049"><span id="EN-US_TASK_0176593776__cmd1562546822214049">Run <a href="cmdqueryname=segment-routing+ipv6"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname1795325734214049">segment-routing ipv6</span></b></a></span><p><p id="EN-US_TASK_0176593776__p237165214543">SRv6 is enabled, and the SRv6 view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep643844915593"><span id="EN-US_TASK_0176593776__en-us_task_0172368959_cmd1865633037214048">Configure a source address for SRv6 encapsulation. Note that you only need to perform one of the following operations. If both of the operations are performed, the latest configuration overrides the previous one.</span><p><ul id="EN-US_TASK_0176593776__en-us_task_0172368959_ul261475310544"><li id="EN-US_TASK_0176593776__en-us_task_0172368959_li761411538546">Run the <a href="cmdqueryname=encapsulation+source-address"><b><span class="cmdname" id="EN-US_TASK_0176593776__en-us_task_0172368959_cmdname23368553547">encapsulation source-address</span></b></a> <i><span class="varname" id="EN-US_TASK_0176593776__en-us_task_0172368959_varname6336145515412">ipv6-address</span></i> [ <strong><span id="EN-US_TASK_0176593776__en-us_task_0172368959_cmdparmname1633612551542">ip-ttl</span></strong> <i><span class="varname" id="EN-US_TASK_0176593776__en-us_task_0172368959_varname2033635519549">ttl-value</span></i> ] command to directly configure a source address for SRv6 encapsulation.</li><li id="EN-US_TASK_0176593776__en-us_task_0172368959_li1554119145516">Run the <a href="cmdqueryname=encapsulation+source-interface"><b><span class="cmdname" id="EN-US_TASK_0176593776__en-us_task_0172368959_cmdname10488513573">encapsulation source-interface</span></b></a> { <i><span class="varname" id="EN-US_TASK_0176593776__en-us_task_0172368959_varname0729113313571">intfname</span></i> | <i><span class="varname" id="EN-US_TASK_0176593776__en-us_task_0172368959_varname17377153912578">interfaceType</span></i> <i><span class="varname" id="EN-US_TASK_0176593776__en-us_task_0172368959_varname1951134465716">interfaceNum</span></i> } [ <strong id="EN-US_TASK_0176593776__en-us_task_0172368959_b7945154716571">ip-ttl</strong> <i><span class="varname" id="EN-US_TASK_0176593776__en-us_task_0172368959_varname2091014584572">ttl-value</span></i> ] command to specify the interface to which the source address used for SRv6 encapsulation belongs.<p id="EN-US_TASK_0176593776__en-us_task_0172368959_p2488153115910">If no IPv6 global address is configured for the interface specified using the <a href="cmdqueryname=encapsulation+source-interface"><b><span class="cmdname" id="EN-US_TASK_0176593776__en-us_task_0172368959_cmdname2054948195915">encapsulation source-interface</span></b></a> command, the source address for SRv6 encapsulation is not configured.</p>
</li></ul>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep290368125214049"><span id="EN-US_TASK_0176593776__cmd1134230891214049">Run <a href="cmdqueryname=locator"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname232104912362">locator</span></b></a> <i><span class="varname" id="EN-US_TASK_0176593776__varname193217498361">locator-name</span></i> [ <strong><span id="EN-US_TASK_0176593776__cmdparmname1321164933618">ipv6-prefix</span></strong> <i><span class="varname" id="EN-US_TASK_0176593776__varname1732214915361">ipv6-address</span></i> <i><span class="varname" id="EN-US_TASK_0176593776__varname53221149103614">prefix-length</span></i> [ <strong><span id="EN-US_TASK_0176593776__cmdparmname232224913611">static</span></strong> <i><span class="varname" id="EN-US_TASK_0176593776__varname3322449103613">static-length</span></i> | <strong><span id="EN-US_TASK_0176593776__cmdparmname1632213497369">args</span></strong> <i><span class="varname" id="EN-US_TASK_0176593776__varname1322154916365">args-length</span></i> ] <sup id="EN-US_TASK_0176593776__sup0322184943618">*</sup> ]</span><p><p id="EN-US_TASK_0176593776__p19387311365">An SRv6 locator is configured.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep950096826214049"><span id="EN-US_TASK_0176593776__cmd1736439137214049">(Optional) Run <a href="cmdqueryname=opcode"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname9315141173714">opcode</span></b></a> <em id="EN-US_TASK_0176593776__i77469933611"><i><span class="varname" id="EN-US_TASK_0176593776__varname224552117372">func-opcode</span></i></em> <strong><span id="EN-US_TASK_0176593776__cmdparmname11451162312387">end-dt2m</span></strong> <strong><span id="EN-US_TASK_0176593776__cmdparmname186971429113815">bridge-domain</span></strong> <em id="EN-US_TASK_0176593776__i374610943612"><i><span class="varname" id="EN-US_TASK_0176593776__varname1449492963720">bd-id</span></i></em></span><p><p id="EN-US_TASK_0176593776__p1811746115516">A static End.DT2M SID operation code (opcode) is configured.</p>
<p id="EN-US_TASK_0176593776__p169947394362">Perform this step if a static locator is configured using the <strong id="EN-US_TASK_0176593776__b594663410368">static</strong><em id="EN-US_TASK_0176593776__i2946734183615"> static-length</em> parameter. End.DT2M SIDs are used for BUM traffic forwarding through VPLS.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep1762977016214049"><span id="EN-US_TASK_0176593776__cmd12167242192220">(Optional) Run <a href="cmdqueryname=opcode"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname10442516111018">opcode</span></b></a> <em id="EN-US_TASK_0176593776__i1389082133718">func-opcode</em> { <strong id="EN-US_TASK_0176593776__b17890128375">end-dt2u</strong> | <strong id="EN-US_TASK_0176593776__b17890162173712">end-dt2ul</strong> } <strong id="EN-US_TASK_0176593776__b168909273712">bridge-domain</strong> <em id="EN-US_TASK_0176593776__i88901420374">bd-id</em></span><p><p id="EN-US_TASK_0176593776__p197815345220">An opcode for static End.DT2U and End.DT2UL SIDs is configured.</p>
</p><p><p id="EN-US_TASK_0176593776__p46561552163818">Perform this step if a static locator is configured through the <strong id="EN-US_TASK_0176593776__b2257916121619">static</strong><em id="EN-US_TASK_0176593776__i0257316141615"> static-length</em> parameter. End.DT2U SIDs are used for the forwarding of known unicast traffic over VPLS. In a dual-homing scenario, you need to specify an End.DT2UL opcode for the bypass path to prevent traffic loops between PEs.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep951842576214049"><span id="EN-US_TASK_0176593776__cmd1012488329214049">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname681676596214049">quit</span></b></a></span><p><p id="EN-US_TASK_0176593776__p172451617145616">Exit the SRv6 locator view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep1470012348214049"><span id="EN-US_TASK_0176593776__cmd1845657748214049">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname1806500413214049">quit</span></b></a></span><p><p id="EN-US_TASK_0176593776__p4954192595615">Exit the SRv6 view.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0176593776__step18471250132515"><span id="EN-US_TASK_0176593776__cmd144735042512">Enable IS-IS SRv6.</span><ol type="a" id="EN-US_TASK_0176593776__substeps1137212182614"><li class="substepexpand" id="EN-US_TASK_0176593776__substep1593895910214049"><span id="EN-US_TASK_0176593776__cmd897546692214049">Run <a href="cmdqueryname=isis"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname19904193314101">isis</span></b></a> [ <em id="EN-US_TASK_0176593776__i072645871712">process-id</em> ]</span><p><p id="EN-US_TASK_0176593776__p1967935185610">The IS-IS view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep197611132119"><span id="EN-US_TASK_0176593776__cmd1497617131516">Run <a href="cmdqueryname=ipv6+enable+topology+ipv6"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname823120323588">ipv6 enable topology ipv6</span></b></a></span><p><p id="EN-US_TASK_0176593776__p164163137394">The IPv6 capability is enabled for the IS-IS process in the IPv6 topology.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep1661161624315"><span id="EN-US_TASK_0176593776__cmd14661416134316">Run <a href="cmdqueryname=segment-routing+ipv6"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname3624441201010">segment-routing ipv6</span></b></a> <strong id="EN-US_TASK_0176593776__b624017194438">locator</strong> <em id="EN-US_TASK_0176593776__i624051918439">locator-name</em> [ <strong id="EN-US_TASK_0176593776__b2240111994314">auto-sid-disable</strong> ]</span><p><p id="EN-US_TASK_0176593776__p1827942411447">IS-IS SRv6 is enabled.</p>
</p><p><p id="EN-US_TASK_0176593776__p132601555174311">In this command, the value of <em id="EN-US_TASK_0176593776__i7384053104315">locator-name</em> must be the same as that specified using the <a href="cmdqueryname=locator"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname14535923131617">locator</span></b></a> <i><span class="varname" id="EN-US_TASK_0176593776__varname453517239163">locator-name</span></i> [ <strong><span id="EN-US_TASK_0176593776__cmdparmname14535112316164">ipv6-prefix</span></strong> <i><span class="varname" id="EN-US_TASK_0176593776__varname12535122317164">ipv6-address</span></i> <i><span class="varname" id="EN-US_TASK_0176593776__varname1153582321613">prefix-length</span></i> [ <strong><span id="EN-US_TASK_0176593776__cmdparmname14536172318169">static</span></strong> <i><span class="varname" id="EN-US_TASK_0176593776__varname1053672319162">static-length</span></i> | <strong><span id="EN-US_TASK_0176593776__cmdparmname19536223191619">args</span></strong> <i><span class="varname" id="EN-US_TASK_0176593776__varname1053642310168">args-length</span></i> ] <sup id="EN-US_TASK_0176593776__sup2536122318163">*</sup> ] command. If a separate locator is configured for each of BUM traffic and known unicast traffic of EVPN VPLS services, you need to run this command once for each locator for IS-IS to advertise them both.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep4914940175811"><span id="EN-US_TASK_0176593776__cmd13914144016586">(Optional) Run <a href="cmdqueryname=segment-routing+ipv6+auto-sid+advertise"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname93181037181813">segment-routing ipv6 auto-sid advertise</span></b></a> { <strong><span id="EN-US_TASK_0176593776__cmdparmname6696185351910">no-flavor</span></strong> | <strong><span id="EN-US_TASK_0176593776__cmdparmname1692811842117">psp</span></strong> | <strong><span id="EN-US_TASK_0176593776__cmdparmname0550722112915">psp-usp-usd</span></strong> | <strong><span id="EN-US_TASK_0176593776__cmdparmname550983082911">psp-usp-usd-coc</span></strong> | <strong><span id="EN-US_TASK_0176593776__cmdparmname17737164014295">coc</span></strong> | <strong><span id="EN-US_TASK_0176593776__cmdparmname166019562293">psp-coc</span></strong> | <strong><span id="EN-US_TASK_0176593776__cmdparmname129171163378">psp-usp-usd-coc-next</span></strong> | <strong><span id="EN-US_TASK_0176593776__cmdparmname691761673714">psp-usd-next</span></strong> } <sup id="EN-US_TASK_0176593776__sup1453280924">*</sup></span><p><p id="EN-US_TASK_0176593776__p313613734415">The function to adjust the flavors to be carried in dynamically allocated End and End.X SIDs is enabled.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep15937171722615"><span id="EN-US_TASK_0176593776__cmd693717172265">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname1426545110">quit</span></b></a></span><p><p id="EN-US_TASK_0176593776__p13617165910389">Exit the IS-IS view.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0176593776__step161201735192615"><span id="EN-US_TASK_0176593776__cmd191201635112614">Configure EVPN routes to carry SIDs and recurse to SRv6 BE paths based on the SIDs.</span><ol type="a" id="EN-US_TASK_0176593776__substeps66441853275"><li class="substepexpand" id="EN-US_TASK_0176593776__substep10665205124419"><span id="EN-US_TASK_0176593776__cmd066512517442">Run <a href="cmdqueryname=evpn+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname859217961117">evpn vpn-instance</span></b></a> <em id="EN-US_TASK_0176593776__i1419518364518">vpn-instance-name</em> <strong id="EN-US_TASK_0176593776__b02214171462">bd-mode</strong></span><p><p id="EN-US_TASK_0176593776__p1533367135714">The view of the EVPN instance that works in BD mode is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep3444155114412"><span id="EN-US_TASK_0176593776__cmd2444165594415">Run <a href="cmdqueryname=segment-routing+ipv6+locator"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname1787241891118">segment-routing ipv6 locator</span></b></a> <em id="EN-US_TASK_0176593776__i65091417124510">locator-name</em> [ <strong><span id="EN-US_TASK_0176593776__cmdparmname131915587163">unicast-locator</span></strong><em id="EN-US_TASK_0176593776__i1558216156171"> </em><i><span class="varname" id="EN-US_TASK_0176593776__varname1525071991715">unicast-locator-name</span></i> ]</span><p><p id="EN-US_TASK_0176593776__p82201715451">The device is enabled to add SIDs to EVPN routes to be advertised.</p>
<div class="p" id="EN-US_TASK_0176593776__p25214513455">In this command:<ul id="EN-US_TASK_0176593776__ul921813428456"><li id="EN-US_TASK_0176593776__li14218142184516"><p id="EN-US_TASK_0176593776__p1821818423457"><a name="EN-US_TASK_0176593776__li14218142184516"></a><a name="li14218142184516"></a><em id="EN-US_TASK_0176593776__i136021531144011">locator-name</em> must be set to an End.DT2M SID, with the <strong id="EN-US_TASK_0176593776__b96021431124018">args</strong> parameter specified. <i><span class="varname" id="EN-US_TASK_0176593776__varname206819153148">unicast-locator-name</span></i> must be set to an End.DT2U or End.DT2UL SID, without having the <strong id="EN-US_TASK_0176593776__b17255114014400">args</strong> parameter specified. If the <em id="EN-US_TASK_0176593776__i821944284519">locator-name</em> and <i><span class="varname" id="EN-US_TASK_0176593776__varname1859615204150">unicast-locator-name</span></i> parameters are both required, you need to run the <a href="cmdqueryname=locator"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname16987145751711">locator</span></b></a> <i><span class="varname" id="EN-US_TASK_0176593776__varname5987857111713">locator-name</span></i> [ <strong><span id="EN-US_TASK_0176593776__cmdparmname16987357111710">ipv6-prefix</span></strong> <i><span class="varname" id="EN-US_TASK_0176593776__varname1898710573178">ipv6-address</span></i> <i><span class="varname" id="EN-US_TASK_0176593776__varname13987857131716">prefix-length</span></i> [ <strong><span id="EN-US_TASK_0176593776__cmdparmname798775714173">static</span></strong> <i><span class="varname" id="EN-US_TASK_0176593776__varname20987195711720">static-length</span></i> | <strong><span id="EN-US_TASK_0176593776__cmdparmname8987115712175">args</span></strong> <i><span class="varname" id="EN-US_TASK_0176593776__varname1198755731713">args-length</span></i> ] <sup id="EN-US_TASK_0176593776__sup79873578179">*</sup> ] command to create two corresponding locators before setting the two parameters.</p>
</li><li id="EN-US_TASK_0176593776__li19219642204518"><p id="EN-US_TASK_0176593776__p162195429458"><a name="EN-US_TASK_0176593776__li19219642204518"></a><a name="li19219642204518"></a>In EVPN VPLS dual-homing scenarios, the <strong id="EN-US_TASK_0176593776__b102529220437">args</strong> parameter is used to stitch ESI labels for End.DT2M SIDs only, which causes a waste of End.DT2U SIDs. In this case, you can separately configure a locator for End.DT2U SIDs and another locator for End.DT2M SIDs. The former locator does not require the <strong id="EN-US_TASK_0176593776__b72553213436">args</strong> parameter to be specified. The two locators can then be bound to the same EVPN instance to conserve SIDs.</p>
</li><li id="EN-US_TASK_0176593776__li42191642124517"><p id="EN-US_TASK_0176593776__p021944274516"><a name="EN-US_TASK_0176593776__li42191642124517"></a><a name="li42191642124517"></a>If static SIDs are configured for the locator specified using <em id="EN-US_TASK_0176593776__i1629441416439">locator-name</em> or <i><span class="varname" id="EN-US_TASK_0176593776__varname1297714164312">unicast-locator-name</span></i>, use the static SIDs. Otherwise, use dynamically allocated SIDs.</p>
</li></ul>
</div>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep260111213274"><span id="EN-US_TASK_0176593776__cmd96014129271">Run <a href="cmdqueryname=segment-routing+ipv6+best-effort"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname211993671119">segment-routing ipv6 best-effort</span></b></a></span><p><p id="EN-US_TASK_0176593776__p19314639133811">The device is enabled to perform route recursion to SRv6 BE paths based on the SIDs carried by routes.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep784687662214049"><span id="EN-US_TASK_0176593776__cmd548459007214049">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname1434470395214049">quit</span></b></a></span><p><p id="EN-US_TASK_0176593776__p59527323321">Return to the system view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0176593776__substep192881723718"><span id="EN-US_TASK_0176593776__cmd02885231112">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname437694357214049">commit</span></b></a></span><p><p id="EN-US_TASK_0176593776__p581311267385">The configuration is committed.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0176593776__step1798875554917"><span id="EN-US_TASK_0176593776__cmd10988155534916">(Optional) Configure the tunnel ID carried in the inclusive multicast route to be sent to an IPv6 neighbor.</span><p><ol type="a" id="EN-US_TASK_0176593776__ol1430575672"><li id="EN-US_TASK_0176593776__li167198521449">Run <a href="cmdqueryname=evpn"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname85791552113218">evpn</span></b></a><p id="EN-US_TASK_0176593776__p136091253143216">The global EVPN configuration view is displayed.</p>
</li><li id="EN-US_TASK_0176593776__li530511513719">Run <a href="cmdqueryname=evpn+tunnel-id"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname123006264332">evpn tunnel-id</span></b></a> <i><span class="varname" id="EN-US_TASK_0176593776__varname12300112643312">tunnel-id-value</span></i><p id="EN-US_TASK_0176593776__p298432613318">The tunnel ID carried in the inclusive multicast route to be sent to an IPv6 neighbor is specified.</p>
</li><li id="EN-US_TASK_0176593776__li4511157134410">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname014423710339">quit</span></b></a><p id="EN-US_TASK_0176593776__p19392113818336">Return to the system view.</p>
</li><li id="EN-US_TASK_0176593776__li22639184504">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname2073113475333">commit</span></b></a><p id="EN-US_TASK_0176593776__p825614803314">The configuration is committed.</p>
</li></ol>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0176593776__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0176593776__p174565631214049">After configuring EVPN VPLS over SRv6 BE, verify the configuration.</p>
<ul id="EN-US_TASK_0176593776__ul922162644711"><li id="EN-US_TASK_0176593776__li522102624714"><p id="EN-US_TASK_0176593776__p11221152644714"><a name="EN-US_TASK_0176593776__li522102624714"></a><a name="li522102624714"></a>Run the <a href="cmdqueryname=display+segment-routing+ipv6+local-sid"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname17127125191117">display segment-routing ipv6 local-sid</span></b></a> { <strong id="EN-US_TASK_0176593776__b722122684718">end-dt2u</strong> | <strong id="EN-US_TASK_0176593776__b1722152634719">end-dt2ul</strong> | <strong id="EN-US_TASK_0176593776__b3221826184714">end-dt2m</strong> } [ <em id="EN-US_TASK_0176593776__i822217266479">sid</em> ] [ <strong id="EN-US_TASK_0176593776__b522232618479">bridge-domain</strong> <em id="EN-US_TASK_0176593776__i72222026194710">bd-id</em> ] <strong id="EN-US_TASK_0176593776__b1222132610473">forwarding</strong> command to check information about the SRv6 BE local SID table.</p>
</li></ul>
<ul id="EN-US_TASK_0176593776__ul69985715499"><li id="EN-US_TASK_0176593776__li599165774914"><p id="EN-US_TASK_0176593776__p899105724918"><a name="EN-US_TASK_0176593776__li599165774914"></a><a name="li599165774914"></a>Run the <a href="cmdqueryname=display+bgp+evpn"><b><span class="cmdname" id="EN-US_TASK_0176593776__cmdname1831146131215">display bgp evpn</span></b></a> { <strong id="EN-US_TASK_0176593776__b69905764914">all</strong> | <strong id="EN-US_TASK_0176593776__b29915717496">route-distinguisher</strong> <em id="EN-US_TASK_0176593776__i699135711491">route-distinguisher</em> | <strong id="EN-US_TASK_0176593776__b810055714499">vpn-instance </strong><em id="EN-US_TASK_0176593776__i10100357184911">vpn-instance-name</em> } <strong id="EN-US_TASK_0176593776__b171003576498">routing-table</strong> [ { <strong id="EN-US_TASK_0176593776__b1310018572495">ad-route</strong> | <strong id="EN-US_TASK_0176593776__b1510014572494">es-route</strong> | <strong id="EN-US_TASK_0176593776__b0100205724912">inclusive-route</strong> | <strong id="EN-US_TASK_0176593776__b151007576494">mac-route</strong> } <em id="EN-US_TASK_0176593776__i21001957194919">prefix</em> ] command to check BGP EVPN route information.</p>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0002.html">Configuring SRv6 BE (IS-IS)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0021.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_srv6_cfg_all_0034.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>