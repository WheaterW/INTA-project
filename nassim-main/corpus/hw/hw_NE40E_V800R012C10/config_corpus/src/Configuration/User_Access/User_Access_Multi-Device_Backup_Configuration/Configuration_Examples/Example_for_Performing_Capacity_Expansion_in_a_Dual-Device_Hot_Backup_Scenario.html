
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Performing Capacity Expansion in a Dual-Device Hot Backup Scenario">
<meta name="abstract" content="This section describes how to expand the interface capacity and change a user access interface in a dual-device hot backup scenario.">
<meta name="description" content="This section describes how to expand the interface capacity and change a user access interface in a dual-device hot backup scenario.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0050.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0057.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0063.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,z00603461,w00800033,z00588052,rui_ne,c00549182,w00556928,l00593348,w00606909,w00447999,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="UP Multi-Device Backup">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="UP Multi-Device Backup">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="UP Multi-Device Backup">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="l00593348">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172374422">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Performing Capacity Expansion in a Dual-Device Hot Backup Scenario</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172374422"></a><a name="EN-US_TASK_0172374422"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Performing Capacity Expansion in a Dual-Device Hot Backup Scenario</h1>
<div class="taskbody"><p>This section describes how to expand the interface capacity and change a user access interface in a dual-device hot backup scenario.</p>
<div class="context"><a name="EN-US_TASK_0172374422__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In a dual-device hot backup scenario, a pair of RBP instances in master/backup mode must be configured on the master and backup devices to back up services between the two devices.</p>
<p>On the example network, users access BRAS 1 and BRAS 2 through the LAN switch (LSW). The user access interfaces on the two devices are GE or Eth-Trunk interfaces.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The dual-device hot backup mechanism determines the corresponding RBP instance based on the backup ID and RBS values in the backup table, and then determines the user access interface based on the RBP instance and user VLAN ID. The values of the backup ID, RBS, and VLAN ID cannot be changed.</p>
</div></div>
<div class="fignone"><span class="figcap"><b>Figure 1 </b>Performing capacity expansion in an IPv6 dual-device hot backup scenario</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1 and interface 2 represent GE <span>0/1/0</span> and GE <span>0/3/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_ne_cfg_rui_003101.png" width="NaN" height="NaN"></span><br><div class="tableBorder"><table cellpadding="4" cellspacing="0" summary=""><tr><td valign="top"><p><strong>Device</strong></p>
</td>
<td valign="top"><p><strong>Interface</strong></p>
</td>
<td valign="top"><p><strong>IP Address</strong></p>
</td>
</tr>
<tr><td valign="top"><p>BRAS1</p>
</td>
<td valign="top"><p>GE<span>0/1/0</span>.1</p>
</td>
<td valign="top"><p>Interface through which users go online</p>
</td>
</tr>
<tr><td valign="top"><p>BRAS1</p>
</td>
<td valign="top"><p>GE<span>0/3/0</span></p>
</td>
<td valign="top"><p>10.1.1.1/24</p>
</td>
</tr>
<tr><td valign="top"><p>BRAS2</p>
</td>
<td valign="top"><p>GE<span>0/1/0</span>.1</p>
</td>
<td valign="top"><p>Interface through which users go online</p>
</td>
</tr>
<tr><td valign="top"><p>BRAS2</p>
</td>
<td valign="top"><p>GE<span>0/3/0</span></p>
</td>
<td valign="top"><p>10.1.1.2/24</p>
</td>
</tr>
</table></div>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172374422__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>You can use either of the following methods for capacity expansion in dual-device hot backup scenarios.</p>
<ul><li>Add an Eth-Trunk member interface for capacity expansion.<ol><li>Expand the capacity of BRAS 1. Shut down the original Eth-Trunk member interface on BRAS 1. Then, a master/backup device switchover is performed. BRAS 1 functions as the backup device, and users on BRAS 1 are switched to BRAS 2.</li><li>Add a new member interface to the Eth-Trunk interface on BRAS 1.<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Ensure that the new member interface is of the same type as the existing member interface. Otherwise, the new member interface fails to be added. For example, if the existing member interface is a 10GE interface but the new member interface is a 100GE interface, the new member interface fails to be added to the Eth-Trunk interface. You must remove the existing member interface and then add the new member interface.</p>
</div></div>
</li><li>Enable the existing Eth-Trunk member interface on BRAS 1 to restore user services.</li></ol>
</li><li>Create a BAS interface to replace the original one for capacity expansion.<ol><li>Expand the capacity of BRAS 1. Disconnect the RBS channel between the master and backup devices, and shut down the user access interface on BRAS 1. Then, a master/backup device switchover is performed. BRAS 1 functions as the backup device, and users on BRAS 1 are switched to BRAS 2.</li><li>Log out online users.<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Online users can be logged out only after the RBS channel between the master and backup devices is disconnected. Otherwise, users on the peer device are logged out.</p>
</div></div>
</li><li>Delete the binding configurations of the original BAS interface on BRAS 1, create a BAS interface on BRAS 1, and synchronize the configurations of the original BAS interface to the new BAS interface.</li><li>Restore the RBS channel between the master and backup devices.</li></ol>
</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The configuration on BRAS2 is similar to the configuration on BRAS1. The configuration on BRAS1 is used in this example. For details about the configuration on BRAS2, see the BRAS2 configuration file.</p>
<p>The BAS interface can be a GE or an Eth-Trunk interface. When an Eth-Trunk interface is used for capacity expansion, adding an Eth-Trunk member interface is recommended.</p>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172374422__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>VRRP parameters (VRRP ID and preemption delay)</p>
</li><li><p>RBS channel parameters</p>
</li><li><p>IP address of each interface on BRAS 1 and BRAS 2</p>
</li><li><p>Backup ID, which works together with an RBS to identify an RBP to which users belong</p>
</li></ul>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172374422__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Add an Eth-Trunk member interface for capacity expansion.</span><ol><li class="substepexpand"><span>Expand the capacity of BRAS 1. Shut down the existing Eth-Trunk member interface on BRAS 1. Then, users on BRAS 1 are switched to BRAS 2, and BRAS 1 functions as the backup device.</span><p><p># In this example, the <strong>interface GigabitEthernet <span>0/1/0</span></strong> command has been configured before capacity expansion is performed.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>interface GigabitEthernet <span>0/1/0</span></strong>               
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>shutdown</strong>                           
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong>            
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>                             </pre>
</p></li><li class="substepexpand"><span>Add a new member interface to the Eth-Trunk interface on BRAS 1.</span><p><p># In this example, <strong>interface GigabitEthernet <span>0/1/1</span></strong> is used as the new Eth-Trunk member interface.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>interface GigabitEthernet <span>0/1/1</span></strong>               
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>] <strong><strong>eth-trunk 1</strong></strong>                           
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong>            
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong>                             </pre>
</p></li><li class="substepexpand"><span>Enable the existing Eth-Trunk member interface on BRAS 1 to restore user services.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>interface GigabitEthernet <span>0/1/0</span></strong>               
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong><strong>undo shutdown</strong></strong>                           
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong>            
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>                             </pre>
</p></li><li class="substepexpand"><span>Verify the configuration.</span><p><pre class="screen">[BRAS1] <strong>display interface eth-trunk 1</strong></pre>
<pre class="screen"> -----------------------------------------------
 Eth-Trunk1 current state : UP (ifindex: 33)
 Line protocol current state : DOWN 
 Link quality grade : GOOD
 Description: 
 Route Port,Hash arithmetic : According to flow, Maximal BW: 100Mbps, Current BW: 100Mbps, The Maximum Transmit Unit is 1500
 Internet protocol processing : disabled
 IP Sending Frames' Format is PKTFMT_ETHNT_2, Hardware address is 00e0-fc12-3456
 Current system time: 2019-01-03 03:13:49
 Physical is ETH_TRUNK
    Last 300 seconds input rate 0 bits/sec, 0 packets/sec
    Last 300 seconds output rate 1054 bits/sec, 0 packets/sec
    Input: 0 packets,0 bytes
           0 unicast,0 broadcast,0 multicast
           0 errors,0 drops
    Output:5 packets,0 bytes
           0 unicast,3 broadcast,2 multicast
           0 errors,0 drops
    Last 300 seconds input utility rate:  0.00%
    Last 300 seconds output utility rate: 0.01%
 ----------------------------------------------------------
 PortName                      Status              Weight   
 ----------------------------------------------------------
 GigabitEthernet<span>0/1/0</span>          UP                  1        
 GigabitEthernet<span>0/1/1</span>          UP                  1        
----------------------------------------------------------
 The Number of Ports in Trunk : 1
 The Number of UP Ports in Trunk : 1
</pre>
</p></li></ol>
</li><li><span>Create a BAS interface to replace the original one for capacity expansion.</span><ol><li class="substepexpand"><span>Expand the capacity of BRAS 1. Disconnect the RBS channel between the master and backup devices, and shut down the user access interface on BRAS 1. Then, users on BRAS 1 are switched to BRAS 2, and BRAS 1 functions as the backup device.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>interface GigabitEthernet <span>0/1/0</span></strong>               
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>shutdown</strong>                           
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong>            
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>                             </pre>
</p></li><li class="substepexpand"><span>Log out online users.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>remote-backup-service s1</strong>               
[<span class="keyword">*</span>BRAS1-rm-backup-srv-s1] <strong>shutdown</strong>                           
Warning: This operation will cause the TCP connection to be interrupted. Continue? [Y/N]:Y
[<span class="keyword">*</span>BRAS1-rm-backup-srv-s1] <strong>commit</strong>            
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-rm-backup-srv-s1] <strong>quit</strong>                             
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>aaa</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-aaa] <strong>cut access-user interface GigabitEthernet <span>0/1/0</span></strong>
[<span class="keyword">*</span>BRAS1-aaa] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-aaa] <strong>quit</strong> </pre>
</p></li><li class="substepexpand"><span>Delete the binding configurations of the original BAS interface on BRAS 1, create a BAS interface on BRAS 1, and synchronize the configurations of the original BAS interface to the new BAS interface.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>interface GigabitEthernet <span>0/1/0</span>.1</strong>               
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>.1] <strong>shutdown</strong>                           
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>.1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-GigabitEthernet<span>0/1/0</span>.1] <strong>undo user-vlan 2</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-GigabitEthernet<span>0/1/0</span>.1] <strong>undo remote-backup-profile p1</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>.1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-GigabitEthernet<span>0/1/0</span>.1] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>interface GigabitEthernet <span>0/1/1</span>.1</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-GigabitEthernet<span>0/1/1</span>.1] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>.1] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>.1] <strong>ipv6 nd autoconfig managed-address-flag</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>.1] <strong>ipv6 nd autoconfig other-flag</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>.1] <strong>user-vlan 2</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>.1] <strong>remote-backup-profile p1</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>.1] <strong>bas</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>.1-bas] <strong>access-type layer2-subscriber default-domain authentication huawei</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>.1-bas] <strong>authentication-method-ipv6 bind</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>.1-bas] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-GigabitEthernet<span>0/1/1</span>.1-bas] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-GigabitEthernet<span>0/1/1</span>.1] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Restore the RBS channel between the master and backup devices.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>remote-backup-service s1</strong>               
[<span class="keyword">*</span>BRAS1-rm-backup-srv-s1] <strong>undo shutdown</strong>                           
[<span class="keyword">*</span>BRAS1-rm-backup-srv-s1] <strong>commit</strong>            
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-rm-backup-srv-s1] <strong>quit</strong>                             </pre>
</p></li></ol>
</li></ul></div>
<div class="example"><a name="EN-US_TASK_0172374422__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li>Add an Eth-Trunk member interface for capacity expansion.<ul><li><p>BRAS 1 configuration file</p>
<pre class="screen">#
sysname BRAS1
#
bfd
#
mpls
#
mpls ldp
#
ipv6 prefix prefix1 local
 prefix 2001:db8:1::2013/64
#
ipv6 pool pool1 bas local
 prefix prefix1
#
aaa
 domain huawei   
  authentication-scheme default0                    
  accounting-scheme default0                  
  ipv6-pool pool1
#
remote-backup-service s1                      
 peer 10.1.2.2 source 10.1.2.1 port 6001       
 protect lsp-tunnel for-all-instance peer-ip 10.1.2.2   
 track interface GigabitEthernet<span>0/2/1</span>          
 ipv6-pool pool1
#
remote-backup-profile p1                       
 service-type bras         
 backup-id 1 remote-backup-service s1                   
 peer-backup hot                    
 vrrp-id 1 interface Eth-Trunk1.2
#
#
interface GigabitEthernet <span>0/1/0</span>
 shutdown
 eth-trunk 1
#
interface GigabitEthernet <span>0/1/1</span>
 undo shutdown
 eth-trunk 1
#
#
interface Eth-Trunk1.2              
 vlan-type dot1q 1                             
 ip address 10.1.1.1 255.255.255.0            
 vrrp vrid 1 virtual-ip 10.1.1.100            
 admin-vrrp vrid 1                             
 vrrp vrid 1 priority 180                      
 vrrp vrid 1 preempt-mode timer delay 60       
 vrrp vrid 1 track interface GigabitEthernet<span>0/2/0</span> reduced 50                    
 vrrp vrid 1 track bfd-session session-name bfd1 peer
#
interface Eth-Trunk1.1            
 ipv6 enable  
 ipv6 address auto link-local                  
 ipv6 nd autoconfig managed-address-flag       
 ipv6 nd autoconfig other-flag                           
 user-vlan 2   
 remote-backup-profile p1                       
 bas          
  access-type layer2-subscriber default-domain authentication huawei   
  authentication-method-ipv6 bind
#
interface LoopBack1
 ip address 10.1.2.1 255.255.255.255
#
bfd bfd1 bind peer-ip 10.1.1.2
 discriminator local 8
 discriminator remote 6
#
ospf 1        
 import-route direct                           
 area 0.0.0.0 
 network 10.1.2.1 0.0.0.0
#
return
#
</pre>
</li><li><p>BRAS 2 configuration file</p>
<pre class="screen">#
sysname BRAS2
#
bfd
#
mpls
#
mpls ldp
#
ipv6 prefix prefix1 local
 prefix 2001:db8:1::2013/64
#
ipv6 pool pool1 bas local
 prefix prefix1
#
aaa
 domain huawei   
  authentication-scheme default0                    
  accounting-scheme default0                  
  ipv6-pool pool1
#
remote-backup-service s1
 peer 10.1.2.1 source 10.1.2.2 port 6001
 protect lsp-tunnel for-all-instance peer-ip 10.1.2.1
 track interface GigabitEthernet<span>0/2/1</span>
 ipv6-pool pool1
#
remote-backup-profile p1
 service-type bras
 backup-id 1 remote-backup-service s1
 peer-backup hot
 vrrp-id 1 interface Eth-Trunk1.2
#
#
interface GigabitEthernet <span>0/1/0</span>
 shutdown
 eth-trunk 1
#
interface GigabitEthernet <span>0/1/1</span>
 undo shutdown
 eth-trunk 1
#
interface Eth-Trunk1.2              
 vlan-type dot1q 1                             
 ip address 10.1.1.2 255.255.255.0           
 vrrp vrid 1 virtual-ip 10.1.1.100            
 admin-vrrp vrid 1                             
 vrrp vrid 1 priority 150                      
 vrrp vrid 1 track interface GigabitEthernet<span>0/2/0</span> reduced 50                    
 vrrp vrid 1 track bfd-session session-name bfd1 peer
#
interface Eth-Trunk1.1          
 ipv6 enable  
 ipv6 address auto link-local                  
 ipv6 nd autoconfig managed-address-flag       
 ipv6 nd autoconfig other-flag                            
 user-vlan 2   
 remote-backup-profile p1                 
 bas          
  access-type layer2-subscriber default-domain authentication huawei
  authentication-method-ipv6 bind
#
interface LoopBack1
 ip address 10.1.2.2 255.255.255.255
#
bfd bfd2 bind peer-ip 10.1.2.1                
 discriminator local 6                         
 discriminator remote 8                        
#
ospf 1
 import-route direct
 area 0.0.0.0
 network 10.1.2.2 0.0.0.0
#
return
#</pre>
</li></ul>
</li><li>Create a BAS interface to replace the original one for capacity expansion.<ul><li><p>BRAS 1 configuration file</p>
<pre class="screen">#
sysname BRAS1
#
bfd
#
mpls
#
mpls ldp
#
ipv6 prefix prefix1 local
 prefix 2001:db8:1::2013/64
#
ipv6 pool pool1 bas local
 prefix prefix1
#
aaa
 domain huawei   
  authentication-scheme default0                    
  accounting-scheme default0                  
  ipv6-pool pool1
#
remote-backup-service s1                      
 peer 10.1.2.2 source 10.1.2.1 port 6001       
 protect lsp-tunnel for-all-instance peer-ip 10.1.2.2   
 track interface GigabitEthernet<span>0/2/0</span>          
 ipv6-pool pool1
#
remote-backup-profile p1                       
 service-type bras         
 backup-id 1 remote-backup-service s1                   
 peer-backup hot                    
 vrrp-id 1 interface GigabitEthernet<span>0/1/0</span>.2
 nas logic-port GigabitEthernet <span>0/1/0</span>
 nas logic-sysname huawei
 nas logic-ip 1.1.1.1
#
interface GigabitEthernet<span>0/1/0</span>.2              
 vlan-type dot1q 1                             
 ip address 10.1.1.1 255.255.255.0            
 vrrp vrid 1 virtual-ip 10.1.1.100            
 admin-vrrp vrid 1                             
 vrrp vrid 1 priority 180                      
 vrrp vrid 1 preempt-mode timer delay 60       
 vrrp vrid 1 track interface GigabitEthernet<span>0/2/0</span> reduced 50                    
 vrrp vrid 1 track bfd-session session-name bfd1 peer
#
interface GigabitEthernet<span>0/1/0</span>.1    
 shutdown        
 ipv6 enable 
 ipv6 address auto link-local 
 ipv6 nd autoconfig managed-address-flag 
 ipv6 nd autoconfig other-flag 
 bas
  access-type layer2-subscriber default-domain authentication huawei
  authentication-method-ipv6 bind
#
interface GigabitEthernet<span>0/1/1</span>.1            
 ipv6 enable  
 ipv6 address auto link-local                  
 ipv6 nd autoconfig managed-address-flag       
 ipv6 nd autoconfig other-flag                           
 user-vlan 2   
 remote-backup-profile p1                       
 bas          
  access-type layer2-subscriber default-domain authentication huawei   
  authentication-method-ipv6 bind
#
interface LoopBack1
 ip address 10.1.2.1 255.255.255.255
#
bfd bfd1 bind peer-ip 10.1.1.2
 discriminator local 8
 discriminator remote 6
#
ospf 1        
 import-route direct                           
 area 0.0.0.0 
 network 10.1.2.1 0.0.0.0
#
return
#
</pre>
</li><li><p>BRAS 2 configuration file</p>
<pre class="screen">#
sysname BRAS2
#
bfd
#
mpls
#
mpls ldp
#
ipv6 prefix prefix1 local
 prefix 2001:db8:1::2013/64
#
ipv6 pool pool1 bas local
 prefix prefix1
#
aaa
 domain huawei   
  authentication-scheme default0                    
  accounting-scheme default0                  
  ipv6-pool pool1
#
remote-backup-service s1
 peer 10.1.2.1 source 10.1.2.2 port 6001
 protect lsp-tunnel for-all-instance peer-ip 10.1.2.1
 track interface GigabitEthernet<span>0/2/0</span>
#
remote-backup-profile p1
 service-type bras
 backup-id 1 remote-backup-service s1
 peer-backup hot
 vrrp-id 1 interface GigabitEthernet<span>0/1/0</span>.2
 nas logic-port GigabitEthernet <span>0/1/0</span>
 nas logic-sysname huawei
 nas logic-ip 1.1.1.1
#
interface GigabitEthernet<span>0/1/0</span>.2              
 vlan-type dot1q 1                             
 ip address 10.1.1.2 255.255.255.0           
 vrrp vrid 1 virtual-ip 10.1.1.100            
 admin-vrrp vrid 1                             
 vrrp vrid 1 priority 150                      
 vrrp vrid 1 track interface GigabitEthernet<span>0/2/0</span> reduced 50                    
 vrrp vrid 1 track bfd-session session-name bfd1 peer
#
interface GigabitEthernet<span>0/1/0</span>.1        
 shutdown  
 ipv6 enable 
 ipv6 address auto link-local 
 ipv6 nd autoconfig managed-address-flag 
 ipv6 nd autoconfig other-flag 
 bas
  access-type layer2-subscriber default-domain authentication huawei
  authentication-method-ipv6 bind
#
interface GigabitEthernet<span>0/1/1</span>.1          
 ipv6 enable  
 ipv6 address auto link-local                  
 ipv6 nd autoconfig managed-address-flag       
 ipv6 nd autoconfig other-flag                            
 user-vlan 2   
 remote-backup-profile p1                 
 bas          
  access-type layer2-subscriber default-domain authentication huawei
  authentication-method-ipv6 bind
#
interface LoopBack1
 ip address 10.1.2.2 255.255.255.255
#
bfd bfd2 bind peer-ip 10.1.2.1                
 discriminator local 6                         
 discriminator remote 8                        
#
ospf 1
 import-route direct
 area 0.0.0.0
 network 10.1.2.2 0.0.0.0
#
return
#</pre>
</li></ul>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0050.html">Configuration Examples
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0057.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0063.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>