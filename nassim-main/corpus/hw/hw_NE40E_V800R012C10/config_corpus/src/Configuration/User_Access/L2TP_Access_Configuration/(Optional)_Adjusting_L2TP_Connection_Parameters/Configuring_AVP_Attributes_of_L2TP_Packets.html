
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring AVP Attributes of L2TP Packets">
<meta name="abstract" content="The control messages used to connect tunnels contain multiple AVP attributes. You can configure the AVP attributes of packets to adjust L2TP connections.">
<meta name="description" content="The control messages used to connect tunnels contain multiple AVP attributes. You can configure the AVP attributes of packets to adjust L2TP connections.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_013495.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_013498.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,z00603461,w00800033,z00588052,c00549182,l2tp_ne,w00556928,l00593348,w00606909,w00447999,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="L2TP">
<meta name="featuretype" content="User Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="L2TP">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="L2TP">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="L2TP">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="l00593348">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172374265">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring AVP Attributes of L2TP Packets</title>
</head>
<body><a name="EN-US_TASK_0172374265"></a><a name="EN-US_TASK_0172374265"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring AVP Attributes of L2TP Packets</h1>
<div class="taskbody"><p>The control messages used to connect tunnels contain multiple AVP attributes. You can configure the AVP attributes of packets to adjust L2TP connections.</p>
<div class="context"><a name="EN-US_TASK_0172374265__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Different AVP attributes contain different information. You can configure the AVP attributes of L2TP packets to store the AVP information, thereby controlling the transmission of packets. Perform the following operations on the <span class="keyword">NE40E</span>:</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172374265__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure a VE interface to encapsulate attributes strictly based on the interface name.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=access+attribute+virtual-ethernet+format+interface-name"><b><span class="cmdname">access attribute virtual-ethernet format interface-name</span></b></a></span><p><p>A VE interface is configured to encapsulate attributes strictly based on the interface name.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Encapsulate the AVP 22 attribute into L2TP packets.</span><p><p>In a scenario where the <span class="keyword">NE40E</span> functions as a LAC and an L2TP user attempts to go online, you can run the <a href="cmdqueryname=l2tp+calling-number-avp+enable"><b><span class="cmdname">l2tp calling-number-avp enable</span></b></a> command to determine whether to encapsulate the AVP 22 attribute into ICRQ packets to be sent by the LAC.</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=l2tp+calling-number-avp+enable"><b><span class="cmdname">l2tp calling-number-avp enable</span></b></a></span><p><p>The AVP 22 attribute is added to L2TP packets.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=l2tp-group"><b><span class="cmdname">l2tp-group</span></b></a> <i><span class="varname">group-name</span></i></span><p><p>The L2TP group view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run any of the following commands to configure the LAC to encapsulate the AVP 22 attribute into ICRQ packets to be sent in a specified format:</span><p><ul><li>To configure the LAC to encapsulate the AVP 22 attribute in version 1 format into ICRQ packets to be sent, run the <span><a href="cmdqueryname=calling-number-avp+format"><b><span class="cmdname">calling-number-avp format</span></b></a> <strong><span>version1</span></strong><strong><span> [ include</span></strong> <strong><span>option82 ]</span></strong></span> command.</li><li>To configure the LAC to encapsulate the AVP 22 attribute into ICRQ packets to be sent using a user-defined format, run the <a href="cmdqueryname=calling-number-avp+format"><b><span class="cmdname">calling-number-avp format</span></b></a> <strong><span>{ include</span></strong> [ <strong><span>delimiter</span></strong> <i><span class="varname">delimiter</span></i> ] { <strong><span>option82</span></strong> [ <strong><span>delimiter</span></strong> <i><span class="varname">delimiter</span></i> ] | <strong><span>mac</span></strong> [ <strong><span>delimiter</span></strong> <i><span class="varname">delimiter</span></i> ] | <strong><span>interface</span></strong> [ <strong><span>delimiter</span></strong> <i><span class="varname">delimiter</span></i> ] | <strong><span>domain</span></strong> [ <strong><span>delimiter</span></strong> <i><span class="varname">delimiter</span></i> ] | <strong><span>sysname</span></strong> [ <strong><span>delimiter</span></strong> <i><span class="varname">delimiter</span></i> ] | <strong><span>vlan</span></strong> [ <strong><span>delimiter</span></strong> <i><span class="varname">delimiter</span></i> ] <span>| <strong><span>pevlan</span></strong> [ <strong><span>delimiter</span></strong> <i><span class="varname">delimiter</span></i> ] | <strong><span>cevlan</span></strong> [ <strong><span>delimiter</span></strong> <i><span class="varname">delimiter</span></i> ]</span> | <strong><span>agent-circuit-id</span></strong> [ <strong><span>delimiter</span></strong> <i><span class="varname">delimiter</span></i> ] | <strong><span>agent-remote-id</span></strong> [ <strong><span>delimiter</span></strong> <i><span class="varname">delimiter</span></i> ] }<sup>*</sup> } command.</li><li>(Optional) To configure the LAC to encapsulate the AVP 22 attribute into ICRQ packets to be sent in the version3 format, run the <a href="cmdqueryname=calling-number-avp+format+version3"><b><span class="cmdname">calling-number-avp format version3</span></b></a> command.</li></ul>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=calling-number-avp+format+llid"><b><span class="cmdname">calling-number-avp format llid</span></b></a></span><p><p>The device is configured to encapsulate LLID information into the AVP 22 attribute of packets to be sent to the LNS.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=calling-number-avp+format+radius-force"><b><span class="cmdname">calling-number-avp format radius-force</span></b></a></span><p><p>The Calling-Station-Id is added to the AVP 22 attribute of the packets delivered by the RADIUS server on the LAC to the LNS.</p>
</p></li><li class="substepexpand"><span>(Optional) Set the offset of the inner VLAN ID encapsulated into ICRQ packets.</span><p><ol type="a"><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>Return to the system view.</p>
</li><li><p>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type interface-number</span></i></p>
<p>The interface view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=bas"><b><span class="cmdname">bas</span></b></a></p>
<p>The BAS interface view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=calling-number-avp+cevlan-offset"><b><span class="cmdname">calling-number-avp cevlan-offset</span></b></a> <i><span class="varname">offset-value</span></i></p>
<p>The offset of the inner VLAN ID encapsulated into ICRQ packets is set.</p>
<p>If packets sent from different DSLAMs have the same CE-VLAN ID and the CE-VLAN ID must be identified in the ICRQ packets to be sent by the LAC, configure an offset for the CE-VLAN ID.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This configuration takes effect only after the device is configured to encapsulate the CV-VLAN ID into the AVP 22 attribute of ICRQ packets using the <a href="cmdqueryname=calling-number-avp+format"><b><span class="cmdname">calling-number-avp format</span></b></a> <strong><span>include</span></strong> <strong><span>cevlan</span></strong> [ <strong><span>delimiter</span></strong> <i><span class="varname">delimiter</span></i> ] command.</p>
</div></div>
</li><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>Return to the system view.</p>
</li></ol>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=avp+calling-number+interface-format+exclude+sub-slot"><b><span class="cmdname">avp calling-number interface-format exclude sub-slot</span></b></a></span><p><p>The device is configured not to encapsulate the subslot ID into interface description of the AVP 22 attribute of L2TP packets.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Hide AVPs in transmission.</span><p><p>The L2TP protocol uses AVPs to send and negotiate L2TP attributes. For security purposes, you can hide AVPs in transmission.</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=l2tp-group"><b><span class="cmdname">l2tp-group</span></b></a> <i><span class="varname">group-name</span></i></span><p><p>The L2TP group view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=tunnel+avp-hidden"><b><span class="cmdname">tunnel avp-hidden</span></b></a></span><p><p>AVPs are hidden in transmission.</p>
</p><p><p>The function to hide AVPs in transmission takes effect only when tunnel authentication is enabled on both ends of a tunnel.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>After AVPs are hidden in transmission, if AAA authentication is used for a tunnel, the two ends must use the same password.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Enable AVP 46 for a tunnel.</span><p><p>After AVP 46 is enabled for a tunnel, the cause of tunnel teardown is added to the STOPCCN packets sent from the LAC to the LNS.</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=l2tp-group"><b><span class="cmdname">l2tp-group</span></b></a> <i><span class="varname">group-name</span></i></span><p><p>The L2TP group view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=tunnel+avp46"><b><span class="cmdname">tunnel avp46</span></b></a></span><p><p>AVP 46 is enabled for the tunnel.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure the AVP 47 attribute into L2TP packets.</span><p><p>After the AVP 47 attribute is configured, the LAC marks the outer DSCP value of the L2TP packets so that the packets with different DSCP values have different priorities.</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=l2tp-group"><b><span class="cmdname">l2tp-group</span></b></a> <i><span class="varname">group-name</span></i></span><p><p>The L2TP group view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=set-dscp-outer"><b><span class="cmdname">set-dscp-outer</span></b></a> [ <strong><span>lns</span></strong> ]<i><span class="varname"> dscp-value</span></i></span><p><p>The outer DSCP value of L2TP packets is configured so that the LAC can negotiate with the peer device (LNS) for the AVP 47 attribute.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure the access line AVP attribute of ICRQ packets.</span><p><p>If you need a device to carry the access line AVP in an ICRQ packet or parse the access line AVP in an ICRQ packet, configure the following functions as required.</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <strong><a href="cmdqueryname=l2tp-group"><b><span class="cmdname">l2tp-group</span></b></a> </strong><em><i><span class="varname">group-name</span></i></em></span><p><p>An L2TP group is created.</p>
</p></li><li class="substepexpand"><span>On the LAC, run <a href="cmdqueryname=lac+avp+access-line-info+include"><b><span class="cmdname">lac avp access-line-info include</span></b></a> { <i><span class="varname">agent-circuit-id</span></i> | <i><span class="varname">agent-remote-id</span></i> | <i><span class="varname">actual-data-rate-upstream</span></i> | <i><span class="varname">actual-data-rate-downstrea</span></i>m }</span><p><p>The access line AVP is specified to be carried in ICRQ packets.</p>
</p></li><li class="substepexpand"><span>On the LNS, run <a href="cmdqueryname=lns+avp+access-line-info+allow"><b><span class="cmdname">lns avp access-line-info allow</span></b></a> { <i><span class="varname">agent-circuit-id</span></i> | <i><span class="varname">agent-remote-id</span></i> | <i><span class="varname">actual-data-rate-upstream</span></i> | <i><span class="varname">actual-data-rate-downstream</span></i> }</span><p><p>The LNS is configured to parse the access line AVP in ICRQ packets and encapsulate the parsing result into RADIUS attributes of packets to be sent to the RADIUS server.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_013495.html">(Optional) Adjusting L2TP Connection Parameters
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_013498.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>