
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring an L2TP Connection on the LAC Side">
<meta name="abstract" content="Configuring an L2TP connection on the LAC side is the prerequisite for establishing an L2TP tunnel.">
<meta name="description" content="Configuring an L2TP connection on the LAC side is the prerequisite for establishing an L2TP tunnel.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_013689.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_013687.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_013693.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,z00603461,w00800033,z00588052,c00549182,l2tp_ne,w00556928,l00593348,w00606909,w00447999,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="L2TP">
<meta name="featuretype" content="User Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="L2TP">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="L2TP">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="L2TP">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="l00593348">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172374239">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring an L2TP Connection on the LAC Side</title>
</head>
<body><a name="EN-US_TASK_0172374239"></a><a name="EN-US_TASK_0172374239"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring an L2TP Connection on the LAC Side</h1>
<div class="taskbody"><p>Configuring an L2TP connection on the LAC side is the prerequisite for establishing an L2TP tunnel.</p>
<div class="context"><a name="EN-US_TASK_0172374239__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>When the LAC is interconnected with the LNS, the LAC must have a reachable route to the LNS. After a loopback interface is specified on the LNS, a route destined for the loopback interface must be configured on the LAC.</p>
<p>Perform the following steps on the <span class="keyword">NE40E</span>:</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172374239__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=l2tp-group"><b><span class="cmdname">l2tp-group</span></b></a> <i><span class="varname">group-name</span></i></span><p><p>An L2TP group is created and the L2TP group view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=tunnel+name"><b><span class="cmdname">tunnel name</span></b></a> <i><span class="varname">tunnel-name</span></i> [ <strong>lns-ip </strong><em>lns-ip</em> ]</span><p><p>The local tunnel name is configured.</p>
</p><p><p>The tunnel name is used for tunnel negotiation between the LAC and LNS. The requirements for the tunnel name vary according to the tunnel authentication mode.</p>
<ul><li><p>In local authentication mode, only the tunnel password, not the tunnel name, is needed for tunnel authentication on the LAC/LNS. The tunnel name is used by the LNS to select an L2TP group to respond to connection requests from the LAC. There are no specific requirements on the format of the tunnel name. You only need to ensure that the LAC tunnel name and LNS tunnel name configured on the LAC are the same. No tunnel name needs to be configured on the LNS. In local strict authentication mode, the LAC checks the validity of both the remote LNS tunnel name and password. If the remote LNS tunnel name and password are inconsistent with the LNS tunnel name and password delivered by the RADIUS server or the locally configured LNS tunnel name and password, the check fails and the tunnel fails to be established.</p>
</li><li><p>In remote authentication mode, the LAC/LNS takes the L2TP tunnel as a user; therefore, the format of the tunnel name is <strong>username@domain</strong>. During tunnel establishment, the LAC/LNS sends the username and password received from the peer to the AAA server for authentication. The corresponding username and password must be configured on the AAA server.</p>
</li></ul>
</p></li><li><span>Run <a href="cmdqueryname=start+l2tp"><b><span class="cmdname">start l2tp</span></b></a> { <strong><span>ip</span></strong> <i><span class="varname">ip-address</span></i> [ [ <strong><span>weight</span></strong> <i><span class="varname">lns-weight</span></i> ] <span>| [ <strong><span>preference</span></strong> <i><span class="varname">preference</span></i>-value ] | [ <strong><span>remote</span></strong> <i><span class="varname">lns-name</span></i> ] | [ <strong><span>identifier-name</span></strong> <i><span class="varname">identifiername</span></i> ] ] <sup>*</sup></span> } &amp;&lt;1-8&gt;</span><p><p>An L2TP connection is configured on the LAC.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>When configuring an L2TP connection on the LAC, you need to specify the IP address and weight of the LNS. Each L2TP group can be configured with a maximum of eight LNSs.</p>
</li><li><p>After this configuration is performed, the L2TP group type is LAC.</p>
</li><li><p>The LNS IP address in this command is optional. If the LNS IP address is delivered by the RADIUS server, you do not need to specify the LNS IP address in this command. Otherwise, you must specify the LNS IP address.</p>
</li><li><p>The LNS weight is valid only in LNS load balancing mode. The LAC assigns user sessions to each LNS based on weights.</p>
</li><li><p>In non-load balancing mode, after multiple LNSs are configured, the LAC attempts to establish a connection with each LNS in the order in which the LNSs are configured, until an LNS responds to the connection request and a tunnel is established. The other LNSs then function as the backup LNSs.</p>
</li><li><p>The <strong><span>preference</span></strong> <i><span class="varname">preference</span></i> parameter specified in the <a href="cmdqueryname=start+l2tp"><b><span class="cmdname">start l2tp</span></b></a> command is valid only when the priority-based load balancing mode is configured for the LNSs. The LAC preferentially establishes a tunnel with the highest-priority LNS. If the LNS with the highest priority is unavailable, the LAC selects an LNS based on the LNS priorities in descending order. For the LNSs with the same priority, the <span class="keyword">NE40E</span> establishes tunnels with them in equal cost load balancing mode.</p>
</li><li><p>If the LAC needs to check the validity of the LNS tunnel name, you need to specify the <strong><span>remote</span></strong> <i><span class="varname">lns-name</span></i> parameter in the <a href="cmdqueryname=start+l2tp"><b><span class="cmdname">start l2tp</span></b></a> command. In this case, strict L2TP tunnel authentication needs to be enabled using the <a href="cmdqueryname=tunnel+authentication+strict"><b><span class="cmdname">tunnel authentication strict</span></b></a> command in the L2TP group view.</p>
</li></ul>
</div></div>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=tunnel-per-user"><b><span class="cmdname">tunnel-per-user</span></b></a></span><p><p>An L2TP user is allowed to exclusively use an L2TP tunnel.</p>
</p><p><p>Tunnels in an L2TP group can work in active/standby, weight-based load balancing, or priority-based load balancing mode. The three load balancing modes are mutually exclusive. If a tunnel has been established in an L2TP group, the configuration cannot be changed.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=lac+mtu+enable"><b><span class="cmdname">lac mtu enable</span></b></a></span><p><p>The MTU of the VT is allowed to take effect on the LAC.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=lac+mss+enable"><b><span class="cmdname">lac mss enable</span></b></a></span><p><p>The MSS of the VT is allowed to take effect on the LAC.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=tunnel+load-sharing"><b><span class="cmdname">tunnel load-sharing</span></b></a></span><p><p>LNS load balancing is enabled.</p>
</p><p><p>Tunnels in an L2TP group can work in active/standby, weight-based load balancing, or priority-based load balancing mode. The three load balancing modes are mutually exclusive. If a tunnel has been established in an L2TP group, the configuration cannot be changed.</p>
</p></li><li><span>(Optional) Configure the LNS locking period.</span><ol type="a"><li class="substepexpand"><span>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</span></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=l2tp+aging"><b><span class="cmdname">l2tp aging</span></b></a> <i><span class="varname">time</span></i> command to configure the LNS locking period.</span><p><p>If the <span class="keyword">NE40E</span> attempts to establish a tunnel with an LNS but the LNS does not work properly, the <span class="keyword">NE40E</span> marks the LNS as unavailable and does not establish a tunnel with the LNS within a specified period of time (LNS locking period). The <span class="keyword">NE40E</span> attempts to re-establish a tunnel with the LNS only after the LNS locking period elapses.</p>
</p></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=l2tp+chasten+lns-stopccn+disable"><b><span class="cmdname">l2tp chasten lns-stopccn disable</span></b></a> command to disable the device from locking the LNS IP address when receiving a STOPCCN message.</span></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=l2tp-group"><b><span class="cmdname">l2tp-group</span></b></a> <i><span class="varname">group-name</span></i> command to enter the L2TP group view.</span></li></ol>
</li><li><span>(Optional) Run <a href="cmdqueryname=avp+nas-port+enable"><b><span class="cmdname">avp nas-port enable</span></b></a></span><p><p>The function to encapsulate NAS-PORT into the AVP100 attribute of the ICRQ messages to be sent to the LNS when a user goes online from the LAC is enabled.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=tunnel+source"><b><span class="cmdname">tunnel source</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span><p><p>The tunnel source interface is configured.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>When initiating a tunnel establishment request, the LAC needs to send the source address of the local tunnel to the LNS for communication with the LNS. To improve the reliability of the communication between the LAC and LNS, you can configure the tunnel source interface so that the LAC uses the IP address of the specified interface as the source address of the tunnel during tunnel establishment.</p>
<p>The IP address of the tunnel source interface and the IP address of the source interface bound to the LNS cannot be the same as the tunnel source IP address of the RBS tunnel in dual-device hot backup scenarios.</p>
</div></div>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=allow-address-change"><b><span class="cmdname">allow-address-change</span></b></a> { <strong><span>setup-only</span></strong> | <strong><span>always</span></strong> }</span><p><p>The <span class="keyword">NE40E</span> is configured to respond to the changes of the LNS's source IP address during tunnel establishment or hello detection for tunnels.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=tunnel+window+receive"><b><span class="cmdname">tunnel window receive</span></b></a> <i><span class="varname">window-size</span></i></span><p><p>The size of the L2TP receive window which is used to save out-of-order packets is configured.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=tunnel+priority"><b><span class="cmdname">tunnel priority</span></b></a></span><p><p>Priority-based load balancing for tunnels is configured.</p>
</p><p><p>After the <a href="cmdqueryname=tunnel+priority"><b><span class="cmdname">tunnel priority</span></b></a> command is run, the <span class="keyword">NE40E</span> preferentially establishes a tunnel with the highest-priority LNS. If the LNS with the highest priority is unavailable, the LAC selects an LNS based on the LNS priorities in descending order.</p>
<p>For the LNSs with the same priority, the <span class="keyword">NE40E</span> establishes tunnels with them in equal cost load balancing mode.</p>
<p>Tunnels in an L2TP group can work in active/standby, weight-based load balancing, or priority-based load balancing mode. The three load balancing modes are mutually exclusive. If a tunnel has been established in an L2TP group, the configuration cannot be changed.</p>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>(Optional) Run the <a href="cmdqueryname=qos+link-adjustment+vendor+redback"><b><span class="cmdname">qos link-adjustment vendor redback</span></b></a> { <strong><span>lns</span></strong> | <strong><span>lac</span></strong> } <sup>*</sup> [ <strong><span>slot</span></strong> <i><span class="varname">slot-id</span></i> ] command to configure user traffic compensation on the LAC so that the compensated user traffic statistics are collected in redback mode.</span><p><p><span>In VS mode, this command is supported only by the admin VS.</span></p>
<div class="p">The compensation in redback mode is implemented as follows:
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="20%" id="mcps1.4.2.17.2.2.1.1.6.1.1" liSelected="liSelected"><p>Layer 2</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="20%" id="mcps1.4.2.17.2.2.1.1.6.1.2" liSelected="liSelected"><p>LAC (UP) (Unit: Byte)</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="20%" id="mcps1.4.2.17.2.2.1.1.6.1.3" liSelected="liSelected"><p>LAC (DOWN) (Unit: Byte)</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="20%" id="mcps1.4.2.17.2.2.1.1.6.1.4" liSelected="liSelected"><p>LNS (UP)</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="20%" id="mcps1.4.2.17.2.2.1.1.6.1.5" liSelected="liSelected"><p>LNS (DOWN)</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="20%" headers="mcps1.4.2.17.2.2.1.1.6.1.1 "><p>Compensation value (default)</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.4.2.17.2.2.1.1.6.1.2 "><ul><li>Double-tagged: 12</li><li>Single-tagged: 16</li><li>Without a VLAN: 20</li></ul>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.4.2.17.2.2.1.1.6.1.3 "><p>4</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.4.2.17.2.2.1.1.6.1.4 "><p>6</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.4.2.17.2.2.1.1.6.1.5 "><p>4</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="mcps1.4.2.17.2.2.1.1.6.1.1 "><p>Compensation value (CAR)</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.4.2.17.2.2.1.1.6.1.2 "><ul><li>Double-tagged: 12</li><li>Single-tagged: -16</li><li>Without a VLAN: -20</li></ul>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.4.2.17.2.2.1.1.6.1.3 "><p>-4</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.4.2.17.2.2.1.1.6.1.4 "><p>6</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.4.2.17.2.2.1.1.6.1.5 "><p>-4</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="mcps1.4.2.17.2.2.1.1.6.1.1 "><p>Compensation value (SQ)</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.4.2.17.2.2.1.1.6.1.2 "><ul><li>Double-tagged: -8</li><li>Single-tagged: -12</li><li>Without a VLAN: -16</li></ul>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.4.2.17.2.2.1.1.6.1.3 "><ul><li>Double-tagged: 24</li><li>Single-tagged: 20</li><li>Without a VLAN: 16</li></ul>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.4.2.17.2.2.1.1.6.1.4 "><p>10</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.4.2.17.2.2.1.1.6.1.5 "><p>38</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_013689.html">Configuring a LAC
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_013687.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_l2tp_cfg_013693.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>