
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring IPoE Dual-Stack User Access (IA_NA) to Layer 3 Multicast Devices Working in Hot Backup Mode in IPTV Scenarios">
<meta name="abstract" content="This section provides an example for configuring IPoE dual-stack user access (IA_NA) to Layer 3 multicast devices working in hot backup mode in IPTV scenarios. This example covers networking requirements, configuration roadmap, configuration procedure, and configuration files.">
<meta name="description" content="This section provides an example for configuring IPoE dual-stack user access (IA_NA) to Layer 3 multicast devices working in hot backup mode in IPTV scenarios. This example covers networking requirements, configuration roadmap, configuration procedure, and configuration files.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0050.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0053.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_00531.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00588052,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="UP Multi-Device Backup">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="UP Multi-Device Backup">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="UP Multi-Device Backup">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="z00603461">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001205614756">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring IPoE Dual-Stack User Access (IA_NA) to Layer 3 Multicast Devices Working in Hot Backup Mode in IPTV Scenarios</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001205614756"></a><a name="EN-US_TASK_0000001205614756"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring IPoE Dual-Stack User Access (IA_NA) to Layer 3 Multicast Devices Working in Hot Backup Mode in IPTV Scenarios</h1>
<div class="taskbody"><p>This section provides an example for configuring IPoE dual-stack user access (IA_NA) to Layer 3 multicast devices working in hot backup mode in IPTV scenarios. This example covers networking requirements, configuration roadmap, configuration procedure, and configuration files.</p>
<div class="context"><a name="EN-US_TASK_0000001205614756__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In an IPTV scenario shown in <a href="#EN-US_TASK_0000001205614756__fig_dc_ne_bras-multicast_cac_cfg_000201">Figure 1</a>, a user (STB) accesses BRAS1 and BRAS2 using IPoE. The devices (BRASs) use RADIUS for authentication and accounting. To allow the user to access IPv4 and IPv6 networks, configure the devices to assign an IPv4 address to the user from a local address pool and assign an IPv6 address to the user using the DHCPv6 IA_NA option (carrying an IA address). The devices use the binding authentication mode. Specifically, the Option field is filled in the password during user authentication, and a character string in the format of <em>MAC address@IPTV domain name</em> is generated as the username. The username and password are then sent to the RADIUS server for authentication.</p>
<p>The user wants to access IPTV services. As such, Layer 3 multicast needs to be deployed on the devices. To improve network reliability, dual-device hot backup also needs to be deployed. When a fault occurs, an active/standby device switchover is triggered to ensure that IPTV services are not interrupted.</p>
<div class="fignone" id="EN-US_TASK_0000001205614756__fig_dc_ne_bras-multicast_cac_cfg_000201"><a name="EN-US_TASK_0000001205614756__fig_dc_ne_bras-multicast_cac_cfg_000201"></a><a name="fig_dc_ne_bras-multicast_cac_cfg_000201"></a><span class="figcap"><b>Figure 1 </b>Configuring IPoE dual-stack user access (IA_NA) to Layer 3 multicast devices working in hot backup mode in IPTV scenarios</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 3 in this example represent Eth-Trunk2, GE<span>0/1/0</span>, and GE<span>0/1/1</span>, respectively.</p>
</div></div>
<div class="p"><span><img class="vsd" src="figure/en-us_image_0000001251113833.png"></span>
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Interfaces and IP addresses</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="22.587741225877412%" id="mcps1.4.1.4.3.2.2.5.1.1" liSelected="liSelected"><p><strong>Device</strong></p>
</th>
<th align="left" class="cellrowborder" valign="top" width="23.227677232276772%" id="mcps1.4.1.4.3.2.2.5.1.2" liSelected="liSelected"><p><strong>Interface Name</strong></p>
</th>
<th align="left" class="cellrowborder" valign="top" width="23.337666233376662%" id="mcps1.4.1.4.3.2.2.5.1.3" liSelected="liSelected"><p><strong>Interface Number</strong></p>
</th>
<th align="left" class="cellrowborder" valign="top" width="30.846915308469153%" id="mcps1.4.1.4.3.2.2.5.1.4" liSelected="liSelected"><p><strong>IP Address</strong></p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="6" valign="top" width="22.587741225877412%" headers="mcps1.4.1.4.3.2.2.5.1.1 "><p>BRAS1</p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="23.227677232276772%" headers="mcps1.4.1.4.3.2.2.5.1.2 "><p>interface1</p>
</td>
<td class="cellrowborder" valign="top" width="23.337666233376662%" headers="mcps1.4.1.4.3.2.2.5.1.3 "><p>Eth-trunk2</p>
</td>
<td class="cellrowborder" valign="top" width="30.846915308469153%" headers="mcps1.4.1.4.3.2.2.5.1.4 "><p>-</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.2 "><p>interface1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.3 "><p>Eth-trunk2.1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.4 "><p>192.168.4.129/29</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.2 "><p>interface2</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.3 "><p>GE<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.4 "><p>10.2.1.1/24, 2001:db8:8::7/128</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.2 "><p>interface3</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.3 "><p>GE<span>0/1/1</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.4 "><p>10.5.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.2 "><p>-</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.3 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.4 "><p>10.2.2.2/24, 2001:db8::2:2/64</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.2 "><p>-</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.3 "><p>Loopback2</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.4 "><p>10.3.3.3/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="6" valign="top" width="22.587741225877412%" headers="mcps1.4.1.4.3.2.2.5.1.1 "><p>BRAS2</p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="23.227677232276772%" headers="mcps1.4.1.4.3.2.2.5.1.2 "><p>interface1</p>
</td>
<td class="cellrowborder" valign="top" width="23.337666233376662%" headers="mcps1.4.1.4.3.2.2.5.1.3 "><p>Eth-trunk2</p>
</td>
<td class="cellrowborder" valign="top" width="30.846915308469153%" headers="mcps1.4.1.4.3.2.2.5.1.4 "><p>-</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.2 "><p>interface1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.3 "><p>Eth-trunk2.1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.4 "><p>192.168.4.130/29</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.2 "><p>interface2</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.3 "><p>GE<span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.4 "><p>10.12.1.1/24, 2001:db8:9::7/128</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.2 "><p>interface3</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.3 "><p>GE<span>0/1/1</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.4 "><p>10.15.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.2 "><p>-</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.3 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.4 "><p>10.4.4.4/24, 2001:db8::3:3/64</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.2 "><p>-</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.3 "><p>Loopback2</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.3.2.2.5.1.4 "><p>10.13.13.13/24</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001205614756__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure AAA schemes.</p>
</li><li>Configure RADIUS.</li><li>Configure address pools.</li><li><p>Configure a domain.</p>
</li><li>Configure the user password generation mode.</li><li>Configure interfaces.</li><li><p>Configure basic multicast functions.</p>
</li><li><p>Configure static multicast.</p>
</li><li>Configure an RP.</li><li>Configure a BFD session and VRRP on the access side of the master and backup BRASs.</li><li>Configure an RBS and an RBP.</li></ol>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The configuration of BRAS2 is similar to the configuration of BRAS1. The following uses the configuration on BRAS1 as an example. For configuration details on BRAS2, see the BRAS2 configuration file.</p>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001205614756__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><ul><li><p>Address pool names, address ranges, and gateway addresses</p>
</li><li><p>Authentication and accounting schemes</p>
</li><li><p>Name of the domain to which the user belongs</p>
</li><li><p>BAS interface parameters</p>
</li><li>Multicast-related parameters</li><li><p>VRRP parameters (such as the VRRP ID and preemption delay)</p>
</li><li><p>BFD parameters (such as the local and remote discriminators of a BFD session and the expected minimum intervals at which BFD Control packets are sent and received)</p>
</li><li>User authentication mode (RADIUS authentication)</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001205614756__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure AAA schemes.</span><p><p># Configure an authentication scheme that uses the RADIUS authentication mode.</p>
<pre class="screen">&lt;HUAWEI&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>HUAWEI] <strong>sysname</strong> <strong>BRAS1</strong>
[<span class="keyword">*</span>HUAWEI] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1]<strong> aaa</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-aaa]<strong> authentication-scheme auth1</strong>
[<span class="keyword">*</span>BRAS1-aaa-authen-auth1]<strong> authentication-mode radius</strong>
[<span class="keyword">*</span>BRAS1-aaa-authen-auth1]<strong> quit</strong>
[<span class="keyword">*</span>BRAS1-aaa] <strong>commit</strong></pre>
<p># Configure an accounting scheme that uses the RADIUS accounting mode.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-aaa]<strong> accounting-scheme acct1</strong>
[<span class="keyword">*</span>BRAS1-aaa-accounting-acct1]<strong> accounting-mode radius</strong>
[<span class="keyword">*</span>BRAS1-aaa-accounting-acct1]<strong> quit</strong>
[<span class="keyword">*</span>BRAS1-aaa] <strong>commit</strong>
[<span class="keyword">*</span>BRAS1-aaa] <strong>quit</strong></pre>
</p></li><li><span>Configure RADIUS.</span><p><p># Create UDP sockets with the local port numbers 1645, 1646, and 3799 and with any local IP address.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1]<strong> </strong><strong>radius local-ip all</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>commit</strong></pre>
<p># Configure a RADIUS server group.</p>
</p><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1]<strong> radius-server group rd1</strong>
[<span class="keyword">*</span>BRAS1-radius-rd1]<strong> radius-server authentication 192.168.7.249 1812 weight 0</strong>
[<span class="keyword">*</span>BRAS1-radius-rd1]<strong> radius-server accounting 192.168.7.249 1813 weight </strong><strong>0</strong>
[<span class="keyword">*</span>BRAS1-radius-rd1]<strong> radius-server shared-key-cipher YsHsjx_202206 </strong>
[<span class="keyword">*</span>BRAS1-radius-rd1]<strong> radius-server source interface loopback1</strong>
[<span class="keyword">*</span>BRAS1-radius-rd1]<strong> commit </strong>
[<span class="keyword">*</span>BRAS1-radius-rd1]<strong> </strong><strong>radius-attribute apply user-name match user-type ipoe</strong>
[<span class="keyword">*</span>BRAS1-radius-rd1]<strong> commit </strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-radius-rd1]<strong> </strong><strong>radius-server class-as-car</strong>
[<span class="keyword">*</span>BRAS1-radius-rd1]<strong> commit </strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-radius-rd1] <strong>quit</strong></pre>
</p></li><li><span>Configure address pools.</span><p><p># Configure a user-side local IPv4 address pool.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>ip pool </strong><strong>pool_v4</strong> <strong>bas local</strong>
[<span class="keyword">*</span>BRAS1-ip-pool-pool_v4] <strong>gateway 172.16.0.1 255.255.255.0</strong>
[<span class="keyword">*</span>BRAS1-ip-pool-pool_v4] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-ip-pool-pool_v4] <strong>section 0 172.16.0.2 172.16.0.200</strong> 
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-ip-pool-pool_v4] <strong>dns-server 10.179.155.161 10.179.155.177</strong>
[<span class="keyword">*</span>BRAS1-ip-pool-pool_v4] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1] <strong>commit</strong></pre>
<p># Configure an IPv6 address pool.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>ipv6 prefix </strong><strong>pre_na_1</strong> <strong>local</strong>
[<span class="keyword">*</span>BRAS1-ipv6-prefix-pre_na_1] <strong>prefix 2001:db8:1::/48</strong>
[<span class="keyword">*</span>BRAS1-ipv6-prefix-pre_na_1] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1] <strong>commi</strong><strong>t</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>ipv6 pool pool_na_1 bas local</strong>
[<span class="keyword">*</span>BRAS1-ipv6-pool-pool_na_1] <strong>prefix pre_na_1</strong>
[<span class="keyword">*</span>BRAS1-ipv6-pool-pool_na_1] <strong>dns-server 2001:db8::2:2 2001:db8::2:3</strong>
[<span class="keyword">*</span>BRAS1-ipv6-pool-pool_na_1] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1] <strong>commi</strong><strong>t</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>ipv6 prefix </strong><strong>pre_na_2</strong> <strong>local</strong>
[<span class="keyword">*</span>BRAS1-ipv6-prefix-pre_na_2] <strong>prefix 2001:db8:2::/48</strong>
[<span class="keyword">*</span>BRAS1-ipv6-prefix-pre_na_2] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1] <strong>commi</strong><strong>t</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>ipv6 pool pool_na_2 bas local</strong> <strong>rui-slave</strong>
[<span class="keyword">*</span>BRAS1-ipv6-pool-pool_na_2] <strong>prefix pre_na_2</strong>
[<span class="keyword">*</span>BRAS1-ipv6-pool-pool_na_2] <strong>dns-server 2001:db8::2:2 2001:db8::2:3</strong>
[<span class="keyword">*</span>BRAS1-ipv6-pool-pool_na_2] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1] <strong>commi</strong><strong>t</strong></pre>
</p></li><li><span>Configure a domain.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>aaa</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-aaa]<strong> domain isp1</strong>
[<span class="keyword">*</span>BRAS1-aaa-domain-isp1]<strong> authentication-scheme auth1</strong>
[<span class="keyword">*</span>BRAS1-aaa-domain-isp1]<strong> accounting-scheme acct1</strong>
[<span class="keyword">*</span>BRAS1-aaa-domain-isp1]<strong> radius-server group rd1</strong>
[<span class="keyword">*</span>BRAS1-aaa-domain-isp1]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-aaa-domain-isp1]<strong> ip-pool pool_v4</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-aaa-domain-isp1] <strong>ipv6-pool </strong><strong>pool_na_1</strong>
[<span class="keyword">*</span>BRAS1-aaa-domain-isp1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-aaa-domain-isp1]<strong> quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-aaa]<strong> quit</strong></pre>
</p></li><li><span>Configure the user password generation mode.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>aaa</strong>
[<span class="keyword">*</span>BRAS1-aaa] <strong>default-password template iptv option60 sub-option 31 md5-encrypt support hex</strong>
[<span class="keyword">*</span>BRAS1-aaa] <strong>default-user-name include mac-address -</strong>
[<span class="keyword">*</span>BRAS1-aaa] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-aaa] <strong>quit</strong></pre>
</p></li><li><span>Configure interfaces.</span><p><p># Configure the Eth-Trunk interface to work in static LACP mode and set a timeout period for the interface to receive LACPDUs.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>interface Eth-Trunk2</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2]<strong> mode lacp-static</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2]<strong> lacp timeout fast</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2]<strong> </strong><strong>commit</strong></pre>
<p># Enable IPv6 on the interface.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-Eth-Trunk2]<strong> </strong><strong>interface Eth-Trunk2.10</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10] <strong>ipv6 nd autoconfig managed-address-flag</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10] <strong>ipv6 nd autoconfig other-flag</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-Eth-Trunk2.10]<strong> user-vlan 1000 4000 qinq 2000 2001</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-Eth-Trunk2.10-user-vlan-1000-4000-qinq-2000-2001]<strong> </strong><strong>quit</strong></pre>
<p># Configure a BAS interface.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-Eth-Trunk2.10] <strong>bas</strong>
[<strong><span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span></strong>BRAS1-Eth-Trunk2.10-bas]<strong> access-type layer2-subscriber default-domain authentication isp1</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10-bas] <strong>authentication-method bind</strong> 
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10-bas]<strong> authentication-method-ipv6 bind</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10-bas] <strong>client-option82</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10-bas] <strong>client-option60</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10-bas] <strong>client-option18</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10-bas] <strong>client-option37</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10-bas] <strong>ip-trigger</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10-bas] <strong>arp-trigger</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10-bas] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-Eth-Trunk2.10-bas] <strong>ipv6-trigger</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-Eth-Trunk2.10-bas] <strong>nd-trigger</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-Eth-Trunk2.10-bas] <strong>default-password-template iptv</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10-bas]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-Eth-Trunk2.10-bas]<strong> </strong><strong>quit</strong></pre>
<p># Configure the network-side interfaces connected to the PIM-SM network.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>interface gigabitEthernet <span>0/1/0</span></strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>ipv6 enable</strong> 
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>ipv6 address 2001:db8:8::7 128</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>ip address 10.2.1.1 24</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>interface gigabitEthernet <span>0/1/1</span></strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>] <strong>ipv6 enable</strong> 
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>] <strong>ipv6 address 2001:db8:10::7 128</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>] <strong>ip address 10.5.1.1 24</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong>
[<span class="keyword">*</span>BRAS1] <strong>interface</strong> <strong>Loopback1</strong>
[<span class="keyword">*</span>BRAS1-LoopBack1] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>BRAS1-LoopBack1] <strong>ipv6 address 2001:db8::2:2 64</strong>
[<span class="keyword">*</span>BRAS1-LoopBack1] <strong>ipv6 address auto link-local</strong>
[<span class="keyword">*</span>BRAS1-LoopBack1] <strong>ip address 10.2.2.2 24</strong>
[<span class="keyword">*</span>BRAS1-LoopBack1] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1] <strong>commit</strong></pre>
</p></li><li><span>Configure basic multicast functions.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>multicast routing-enable</strong>
[<span class="keyword">*</span>BRAS1] <strong>multicast load-splitting source-group</strong>
[<span class="keyword">*</span>BRAS1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>interface gigabitEthernet <span>0/1/0</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>pim sm</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>interface gigabitEthernet <span>0/1/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>pim sm</strong>
[<span class="keyword">*</span>BRAS1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1] <strong>commit</strong></pre>
</p></li><li><span>Configure Layer 3 multicast.</span><p><p># Configure the range of multicast groups that an interface can join.</p>
</p><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>acl number 2999</strong>
[<span class="keyword">*</span>BRAS1-acl4-basic-2239] <strong>description For:Permit-Pim-RP-Policy&amp;Igmp-Group-Policy</strong>
[<span class="keyword">*</span>BRAS1-acl4-basic-2239] <strong>rule 10 permit source 227.1.0.0 0.0.255.255</strong>
[<span class="keyword">*</span>BRAS1-acl4-basic-2239] <strong>rule 20 permit source 228.1.0.0 0.0.255.255</strong>
[<span class="keyword">*</span>BRAS1-acl4-basic-2239] <strong>rule 1000 deny</strong>
[<span class="keyword">*</span>BRAS1-acl4-basic-2239] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1] <strong>commit</strong></pre>
<p># Configure Layer 3 multicast on the interface connected to user hosts.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-Eth-Trunk2]<strong> </strong><strong>interface Eth-Trunk2.11</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.11] <strong>vlan-type dot1q 1100</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.11] <strong>description to_IPTV_multicast</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.11] <strong>ip address 192.168.9.5 255.255.255.252</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.11] <strong>pim hello-option dr-priority 100</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.11] <strong>pim sm</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.11] <strong>igmp enable</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.11] <strong>igmp group-policy 2999</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.11] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1] <strong>commit</strong></pre>
</p></li><li><span>Configure an RP.</span><p><div class="p"># Configure the range of multicast groups that the static RP serves.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>acl number 2239</strong>
[<span class="keyword">*</span>BRAS1-acl4-basic-2239] <strong>description this acl is used pim rp group limit</strong>
[<span class="keyword">*</span>BRAS1-acl4-basic-2239] <strong>rule 10 permit source 227.1.0.0 0.0.255.255</strong>
[<span class="keyword">*</span>BRAS1-acl4-basic-2239] <strong>rule 20 permit source 228.1.0.0 0.0.255.255</strong>
[<span class="keyword">*</span>BRAS1-acl4-basic-2239] <strong>rule 100 deny</strong>
[<span class="keyword">*</span>BRAS1-acl4-basic-2239] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1] <strong>commit</strong></pre>
</div>
</p><p><div class="p"># Configure the source address of multicast data packets.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>acl number 2101</strong>
[<span class="keyword">*</span>BRAS1-acl4-basic-2101] <strong>description For:Permit-Pim-source-policy</strong>
[<span class="keyword">*</span>BRAS1-acl4-basic-2101] <strong>rule 10 permit source 10.10.0.0 0.0.255.255</strong>
[<span class="keyword">*</span>BRAS1-acl4-basic-2101] <strong>rule 20 permit source 10.20.0.0 0.0.255.255</strong>
[<span class="keyword">*</span>BRAS1-acl4-basic-2101] <strong>rule 30 permit source 10.30.0.0 </strong><strong>0.0.255.255</strong>
[<span class="keyword">*</span>BRAS1-acl4-basic-2101] <strong>rule 1000 deny</strong>
[<span class="keyword">*</span>BRAS1-acl4-basic-2101] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1] <strong>commit</strong></pre>
</div>
</p><p><div class="p"># Configure a static RP.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>pim</strong>
[<span class="keyword">*</span>BRAS1-pim] <strong>static-rp 192.168.0.6 2239 preferred</strong>
[<span class="keyword">*</span>BRAS1-pim] <strong>source-policy 2101</strong>
[<span class="keyword">*</span>BRAS1-pim] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1] <strong>commit</strong></pre>
</div>
</p></li><li><span>Configure a BFD session and VRRP on the access side of the master and backup BRASs. BRAS1 is the master, and BRAS2 is the backup.</span><p><p># Configure a BFD session on the access side to allow the device to rapidly detect interface or link faults and trigger a master/backup VRRP switchover upon such a fault.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>bfd</strong>
[<span class="keyword">*</span>BRAS1-bfd] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1]<strong> bfd bfd1 bind peer-ip 192.168.4.130</strong>
[<span class="keyword">*</span>BRAS1-bfd-session-bfd1] <strong>discriminator local 1</strong>
[<span class="keyword">*</span>BRAS1-bfd-session-bfd1] <strong>discriminator remote 1</strong>
[<span class="keyword">*</span>BRAS1-bfd-session-bfd1] <strong>quit</strong> 
[<span class="keyword">*</span>BRAS1] <strong>commit</strong></pre>
<p># Configure a VRRP group on an interface/sub-interface (sub-interface Eth-Trunk2.1 is used in this example), and configure VRRP to track the BFD session and network-side interface. Set the VRRP preemption delay to 1800s.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>interface </strong><strong>Eth-Trunk2.1 </strong>             
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.1] <strong>vlan-type dot1q 96</strong>                           
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.1] <strong>ip address 192.168.4.129 255.255.255.248</strong>            
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.1] <strong>vrrp vrid 5 virtual-ip 192.168.4.131</strong>   
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.1] <strong>admin-vrrp vrid 5</strong>           
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.1] <strong>vrrp vrid 5 priority 120</strong> 
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.1] <strong>vrrp vrid 5 preempt-mode timer delay 1800 </strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.1] <strong>vrrp vrid 5 track interface GigabitEthernet </strong><strong><span>0/1/0</span></strong><strong> reduced 50</strong> 
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.1] <strong>vrrp vrid 5 track bfd-session session-name bfd1 link</strong>                       
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1-Eth-Trunk2.1] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>vrrp recover-delay 300</strong>
[<span class="keyword">*</span>BRAS1] <strong>commit</strong></pre>
</p></li><li><span>Configure an RBS and an RBP.</span><p><p># Configure an RBS, and configure the device to use the NAS IP address as the source IP address in packets replied to the RADIUS server.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>peer-backup route-cost auto-advertising</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>remote-backup-service s1</strong>
[<span class="keyword">*</span>BRAS1-rm-backup-srv-s1] <strong>peer 10.13.13.13 source 10.3.3.3 port 6001</strong>
[<span class="keyword">*</span>BRAS1-rm-backup-srv-s1] <strong>track interface GigabitEthernet </strong><strong><span>0/1/0</span></strong>
[<span class="keyword">*</span>BRAS1-rm-backup-srv-s1] <strong>protect lsp-tunnel for-all-instance peer-ip 10.13.13.13</strong>
[<span class="keyword">*</span>BRAS1-rm-backup-srv-s1] <strong>ip-pool pool_v4 metric 10</strong>
[<span class="keyword">*</span>BRAS1-rm-backup-srv-s1] <strong>ipv6-pool pool_na_1 metric 10</strong>
[<span class="keyword">*</span>BRAS1-rm-backup-srv-s1] <strong>ipv6-pool pool_na_2 metric 20</strong>
[<span class="keyword">*</span>BRAS1-rm-backup-srv-s1] <strong>radius-authorization source same-as nas-logic-ip</strong>
[<span class="keyword">*</span>BRAS1-rm-backup-srv-s1] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1] <strong>commit</strong></pre>
<p># Configure an RBP, and configure a logical IP address, logical interface, and logical hostname, so that the active and standby devices use the same NAS-IP-Address, NAS-Port, NAS-Port-ID, and Option 82 information in the packets sent to the RADIUS and DHCP servers.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>remote-backup-profile p1</strong>
[<span class="keyword">*</span>BRAS1-rm-backup-prf-p1] <strong>service-type bras</strong>
[<span class="keyword">*</span>BRAS1-rm-backup-prf-p1] <strong>peer-backup hot</strong>
[<span class="keyword">*</span>BRAS1-rm-backup-prf-p1] <strong>backup-id 5 remote-backup-service s1</strong>
[<span class="keyword">*</span>BRAS1-rm-backup-prf-p1] <strong>vrrp-id 5 interface Eth-Trunk2.1</strong>
[<span class="keyword">*</span>BRAS1-rm-backup-prf-p1]<strong> nas logic-port</strong> <strong>Eth-Trunk2</strong> 
[<span class="keyword">*</span>BRAS1-rm-backup-prf-p1] <strong>nas logic-ip 10.10.1.1</strong>
[<span class="keyword">*</span>BRAS1-rm-backup-prf-p1] <strong>nas logic-sysname huawei</strong>
[<span class="keyword">*</span>BRAS1-rm-backup-prf-p1] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1] <strong>commit</strong></pre>
<p># Bind the RBP to the interface through which the user goes online.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS1] <strong>interface </strong><strong>Eth-Trunk2</strong>.<strong>10</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10] <strong>remote-backup-profile p1</strong>
[<span class="keyword">*</span>BRAS1-Eth-Trunk2.10] <strong>quit</strong>
[<span class="keyword">*</span>BRAS1] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001205614756__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li>BRAS1 configuration file</li></ul>
<pre class="screen">#
sysname BRAS1
#
multicast routing-enable
#
multicast load-splitting source-group
#
acl number 2999
 description For:Permit-Pim-RP-Policy&amp;Igmp-Group-Policy
 rule 10 permit source 227.1.0.0 0.0.255.255
 rule 20 permit source 228.1.0.0 0.0.255.255
 rule 1000 deny
#
acl number 2239
 description this acl is used pim rp group limit
 rule 10 permit source 227.1.0.0 0.0.255.255
 rule 20 permit source 228.1.0.0 0.0.255.255
 rule 100 deny
#
acl number 2101
 description For:Permit-Pim-source-policy
 rule 10 permit source  10.10.0.0 0.0.255.255
 rule 20 permit source  10.20.0.0 0.0.255.255
 rule 30 permit source  10.30.0.0 0.0.255.255
 rule 1000 deny
#
ip pool pool_v4 bas local                                                       
 gateway 172.16.0.1 255.255.255.0                                               
 section 0 172.16.0.2 172.16.0.200                                              
 dns-server 10.179.155.161 10.179.155.177                                       
#                                                                               
ipv6 prefix pre_na_1 local                                                   
 prefix 2001:DB8:1::/48                                                                                                                     
#                                                                               
ipv6 pool pool_na_1 bas local                                                
 dns-server 2001:DB8::2:2 2001:DB8::2:3                                         
 prefix pre_na_1                                                                  
#
ipv6 prefix pre_na_2 local                                                   
 prefix 2001:DB8:2::/48                                                                                                                     
#                                                                               
ipv6 pool pool_na_2 bas local rui-slave                                                
 dns-server 2001:DB8::2:2 2001:DB8::2:3                                         
 prefix pre_na_2                                                                  
#
radius local-ip all
#
bfd
#
bfd bfd1 bind peer-ip 192.168.4.130
 discriminator local 1 
 discriminator remote 1
#
radius-server group rd1                                                       
 radius-server shared-key-cipher %^%#e,yC%f9z4M2)b)2<font style="font-size:8pt" Face="Courier New" >~</font>r+lA{$g*Fzc+5/bu7VHAN&lt;%(%^% 
 radius-server authentication 192.168.7.249 1812 weight 0                       
 radius-server accounting 192.168.7.249 1813 weight 0                           
 radius-server source interface LoopBack1
 radius-server class-as-car
 radius-attribute apply user-name match user-type ipoe
#
aaa
 default-password template iptv option60 sub-option 31 md5-encrypt support hex
 default-user-name include mac-address -
 #
 authentication-scheme auth1
 #
 accounting-scheme acct1
<em> </em>#                                                                              
 domain isp1                                                                  
  authentication-scheme auth1                                                 
  accounting-scheme acct1                                                     
  radius-server group rd1
  ip-pool pool_v4                                                               
  ipv6-pool pool_na_1
#
interface Eth-Trunk2.1
 vlan-type dot1q 96
 ip address 192.168.4.129 255.255.255.248
 vrrp vrid 5 virtual-ip 192.168.4.131
 admin-vrrp vrid 5
 vrrp vrid 5 priority 120
 vrrp recover-delay 300
 vrrp vrid 5 preempt-mode timer delay 60
 vrrp vrid 5 preempt-mode timer delay 1800
 vrrp vrid 5 track interface GigabitEthernet<span>0/1/0</span> reduced 50
 vrrp vrid 5 track bfd-session session-name bfd1 link
#
peer-backup route-cost auto-advertising
#
remote-backup-service s1
 peer 10.13.13.13 source 10.3.3.3 port 6001
 track interface GigabitEthernet<span>0/1/0</span>
 protect lsp-tunnel for-all-instance peer-ip 10.13.13.13
 ip-pool pool_v4 metric 10
 ipv6-pool pool_na_1 metric 10
 ipv6-pool pool_pd_2 metric 20
 radius-authorization source same-as nas-logic-ip
#
remote-backup-profile p1
 service-type bras
 backup-id 5 remote-backup-service s1
 peer-backup hot
 vrrp-id 5 interface Eth-Trunk2.1
 nas logic-port Eth-Trunk2
 nas logic-ip 10.10.1.1
#
interface LoopBack1
 ipv6 enable
 ip address 10.2.2.2 255.255.255.0
 ipv6 address 2001:DB8::2:2/64
 ipv6 address auto link-local
#
interface Eth-Trunk2                                          
 mode lacp-static                                                               
 lacp timeout fast                                                              
#
interface  Eth-Trunk2.1
 vlan-type dot1q 96
 ip address 192.168.4.129 255.255.255.248
 vrrp vrid 5 virtual-ip 192.168.4.131
 admin-vrrp vrid 5
 vrrp vrid 5 priority 120
 vrrp vrid 5 preempt-mode timer delay 60
 vrrp vrid 5 track interface GigabitEthernet<span>0/1/0</span> reduced 50
 vrrp vrid 5 track bfd-session session-name bfd1 link
#
interface Eth-Trunk2.10                                                         
 ipv6 enable                                                                    
 ipv6 address auto link-local                                                               
 user-vlan 1000 4000 qinq 2000 2001
 ipv6 nd autoconfig managed-address-flag
 ipv6 nd autoconfig other-flag
 remote-backup-profile p1
 bas                                                                            
 #                                                                              
  access-type layer2-subscriber default-domain authentication isp1            
  client-option82
  client-option60
  client-option37
  client-option18
  authentication-method bind                                                    
  authentication-method-ipv6 bind
  ip-trigger
  arp-trigger
  ipv6-trigger 
  nd-trigger
  default-password-template iptv                                                     
 #
#
interface Eth-Trunk2.11
 vlan-type dot1q 1100
 description to_IPTV_multicast
 ip address 192.168.9.5 255.255.255.252
 pim hello-option dr-priority 100
 pim sm
 igmp enable
 igmp group-policy 2999
#                                                                               
interface GigabitEthernet<span>0/1/0</span>                                                  
 undo shutdown                                                                  
 ipv6 enable                                                                    
 ip address 10.2.1.1 255.255.255.0                                              
 ipv6 address 2001:DB8:8::7/128                                                 
 ipv6 address auto link-local
 pim sm
# 
interface GigabitEthernet<span>0/1/1</span>                                                  
 undo shutdown                                                                  
 ipv6 enable                                                                    
 ip address 10.5.1.1 255.255.255.0                                              
 ipv6 address 2001:DB8:10::7/128                                                 
 ipv6 address auto link-local
 pim sm
# 
pim 
 static-rp 192.168.0.6 2239 preferred
 source-policy 2101
#     
return</pre>
<ul><li>BRAS2 configuration file</li></ul>
<pre class="screen">#
sysname BRAS2
#
multicast routing-enable
#
multicast load-splitting source-group
#
acl number 2999
 description For:Permit-Pim-RP-Policy&amp;Igmp-Group-Policy
 rule 10 permit source 227.1.0.0 0.0.255.255
 rule 20 permit source 228.1.0.0 0.0.255.255
 rule 1000 deny
#
acl number 2239
 description this acl is used pim rp group limit
 rule 10 permit source 225.1.0.0 0.0.255.255
 rule 20 permit source 226.1.0.0 0.0.255.255
 rule 100 deny
#
acl number 2101
 description For:Permit-Pim-source-policy
 rule 10 permit source  10.10.0.0 0.0.255.255
 rule 20 permit source  10.20.0.0 0.0.255.255
 rule 30 permit source  10.30.0.0 0.0.255.255
 rule 1000 deny
#
ip pool pool_v4 bas local rui-slave                                                       
 gateway 172.16.0.1 255.255.255.0                                               
 section 0 172.16.0.2 172.16.0.200                                              
 dns-server 10.179.155.161 10.179.155.177                                       
#                                                                               
ipv6 prefix pre_na_1 local                                                   
 prefix 2001:DB8:1::/48                                                                                                                     
#                                                                               
ipv6 pool pool_na_1 bas local rui-slave                                               
 dns-server 2001:DB8::2:2 2001:DB8::2:3                                         
 prefix pre_na_1                                                                  
#
ipv6 prefix pre_na_2 local                                                   
 prefix 2001:DB8:2::/48                                                                                                                     
#                                                                               
ipv6 pool pool_na_2 bas local                                                
 dns-server 2001:DB8::2:2 2001:DB8::2:3                                         
 prefix pre_na_2                                                                  
#
radius local-ip all
#
bfd
#
bfd bfd1 bind peer-ip 192.168.5.129
 discriminator local 1 
 discriminator remote 1
#
radius-server group rd1                                                       
 radius-server shared-key-cipher %^%#e,yC%f9z4M2)b)2<font style="font-size:8pt" Face="Courier New" >~</font>r+lA{$g*Fzc+5/bu7VHAN&lt;%(%^% 
 radius-server authentication 192.168.7.249 1812 weight 0                       
 radius-server accounting 192.168.7.249 1813 weight 0                           
 radius-server source interface LoopBack1
 radius-server class-as-car
 radius-attribute apply user-name match user-type ipoe
#
aaa
 default-password template iptv option60 sub-option 31 md5-encrypt support hex
 default-user-name include mac-address -
 #
 authentication-scheme auth1
 #
 accounting-scheme acct1
<em> </em>#                                                                              
 domain isp1                                                                  
  authentication-scheme auth1                                                 
  accounting-scheme acct1                                                     
  radius-server group rd1
  ip-pool pool_v4                                                               
  ipv6-pool pool_na_2
#
interface  Eth-Trunk2.1
 vlan-type dot1q 96
 ip address 192.168.4.129 255.255.255.248
 vrrp vrid 5 virtual-ip 192.168.4.131
 admin-vrrp vrid 5
 vrrp vrid 5 priority 120
 vrrp vrid 5 track bfd-session session-name bfd1 peer
#
peer-backup route-cost auto-advertising
#
remote-backup-service s1
 peer 10.3.3.3 source 10.13.13.13 port 6001
 track interface GigabitEthernet<span>0/1/0</span>
 protect lsp-tunnel for-all-instance peer-ip 10.3.3.3
 ip-pool pool_v4 metric 20
 ipv6-pool pool_na_1 metric 20
 ipv6-pool pool_na_2 metric 10
 radius-authorization source same-as nas-logic-ip
#
remote-backup-profile p1
 service-type bras
 backup-id 5 remote-backup-service s1
 peer-backup hot
 vrrp-id 5 interface Eth-Trunk2.1
 nas logic-sysname huawei
 nas logic-port Eth-Trunk2
 nas logic-ip 10.10.1.1
#
interface LoopBack1
 ipv6 enable
 ip address 10.2.2.2 255.255.255.0
 ipv6 address 2001:DB8::2:2/64
 ipv6 address auto link-local
#
interface Eth-Trunk2                                          
 mode lacp-static                                                               
 lacp timeout fast                                                              
#
interface Eth-Trunk2.10                                                         
 ipv6 enable                                                                    
 ipv6 address auto link-local                                                               
 user-vlan 1000 4000 qinq 2000 2001
 ipv6 nd autoconfig managed-address-flag
 ipv6 nd autoconfig other-flag
 remote-backup-profile p1
 bas                                                                            
 #                                                                              
  access-type layer2-subscriber default-domain authentication isp1            
  client-option82
  client-option60
  client-option37
  client-option18
  authentication-method bind                                                    
  authentication-method-ipv6 bind
  ip-trigger
  arp-trigger
  ipv6-trigger 
  nd-trigger
  default-password-template iptv                                                     
 #                                                                              
#                                                                               
interface GigabitEthernet<span>0/1/0</span>                                                  
 undo shutdown                                                                  
 ipv6 enable                                                                    
 ip address 10.12.1.1 255.255.255.0                                              
 ipv6 address 2001:DB8:18::7/128                                                 
 ipv6 address auto link-local
 pim sm
# 
interface GigabitEthernet<span>0/1/1</span>                                                  
 undo shutdown                                                                  
 ipv6 enable                                                                    
 ip address 10.15.1.1 255.255.255.0                                              
 ipv6 address 2001:DB8:20::7/128                                                 
 ipv6 address auto link-local
 pim sm
# 
pim 
 static-rp 192.168.0.6 2239 preferred
 source-policy 2101
#     
return</pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0050.html">Configuration Examples
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0053.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_00531.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>