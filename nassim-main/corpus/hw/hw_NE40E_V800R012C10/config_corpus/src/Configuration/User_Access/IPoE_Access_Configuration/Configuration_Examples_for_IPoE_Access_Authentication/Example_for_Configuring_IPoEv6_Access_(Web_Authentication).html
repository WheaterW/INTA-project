
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring IPoEv6 Access (Web Authentication)">
<meta name="abstract" content="This section provides an example for configuring IPoEv6 access through web authentication. The example provides the networking requirements, configuration roadmap, configuration procedure, and configuration files.">
<meta name="description" content="This section provides an example for configuring IPoEv6 access through web authentication. The example provides the networking requirements, configuration roadmap, configuration procedure, and configuration files.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipox_cfg_0083.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_014460_nd.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipox_cfg_0072.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,z00603461,w00800033,z00588052,ipoxne,c00549182,w00556928,l00593348,w00606909,w00447999,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPoE">
<meta name="featuretype" content="User Access">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPoE">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="IPoE">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="IPoE">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172374028">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring IPoEv6 Access (Web Authentication)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172374028"></a><a name="EN-US_TASK_0172374028"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring IPoEv6 Access (Web Authentication)</h1>
<div class="taskbody"><p>This section provides an example for configuring IPoEv6 access through web authentication. The example provides the networking requirements, configuration roadmap, configuration procedure, and configuration files.</p>
<div class="context"><a name="EN-US_TASK_0172374028__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0172374028__fig_dc_ne_ipoxv6_cfg_006701">Figure 1</a>, the networking requirements are as follows:</p>
<ul><li><p>The user belongs to the domain <strong>isp2</strong> and accesses the Internet through GE <span>0/1/2</span>.1 on <span class="keyword">Device</span>A in IPoEv6 mode.</p>
</li><li><p>The user adopts web authentication, and the IP address of the web authentication server is 2001:db8:1::5.</p>
</li></ul>
<div class="fignone" id="EN-US_TASK_0172374028__fig_dc_ne_ipoxv6_cfg_006701"><a name="EN-US_TASK_0172374028__fig_dc_ne_ipoxv6_cfg_006701"></a><a name="fig_dc_ne_ipoxv6_cfg_006701"></a><span class="figcap"><b>Figure 1 </b>Configuring IPoEv6 access through web authentication</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 3 in this example represent GE <span>0/1/2</span>.1, GE <span>0/1/1</span>, and GE <span>0/1/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_ne_ipoxv6_cfg_006701.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172374028__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure a local IPv6 address pool.</p>
</li><li>Configure AAA schemes and adopt RADIUS authentication and RADIUS accounting.</li><li>Configure a user password.</li><li><p>Configure web pre-authentication and authentication domains.</p>
</li><li><p>Configure a web authentication server and an interface connecting <span class="keyword">Device</span>A to the web authentication server.</p>
</li><li><p>Configure UCL rules and a traffic policy.</p>
</li><li><p>Configure a BAS interface.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172374028__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IPv6 address pool name</p>
</li><li><p>Domain names</p>
</li><li><p>IP address of the web authentication server</p>
</li><li><p>UCL rules</p>
</li><li><p>Traffic policies</p>
</li><li><p>BAS interface parameters</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172374028__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure a local IPv6 address pool.</span><p><p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span></strong><strong>A</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>ipv6 prefix prefix1</strong> <strong>local</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ipv6-prefix-prefix1] <strong>prefix 2001:db8::/64</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ipv6-prefix-prefix1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-ipv6-prefix-prefix1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>ipv6 pool pool_local bas local</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ipv6-pool-pool_local] <strong>prefix prefix1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ipv6-pool-pool_local] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-ipv6-pool-pool_local] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>dhcpv6 duid llt</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</p></li><li><span>Configure AAA schemes.</span><p><p># Configure an authentication scheme.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>aaa</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa] <strong>a</strong><strong>uthentication-scheme none</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-authen-none] <strong>authentication-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-authen-none] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-authen-none] <strong>quit</strong></pre>
<p># Configure an accounting scheme.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa] <strong>accounting-scheme none</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-accounting-none] <strong>accounting-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-accounting-none] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-accounting-none] <strong>quit</strong></pre>
</p></li><li><span>Configure the IPoE user password.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa]<strong> </strong><strong>default-password cipher YsHsjx_202206</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa]<strong> quit</strong></pre>
</p></li><li><span>Configure domains.</span><p><p># Configure a web pre-authentication domain named <strong>huawei</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> user-group web-before</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> aaa</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa]<strong> domain huawei</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-huawei] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-domain-huawei]<strong> user-group web-before</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-domain-huawei]<strong> web-server url http://[2001:db8:1::]/portal/default.portal</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-domain-huawei]<strong> web-server identical-url</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-domain-huawei]<strong> ipv6-pool pool_local</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-domain-huawei]<strong> authentication-scheme none</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-huawei]<strong> accounting-scheme none</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-huawei]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-domain-huawei]<strong> quit</strong></pre>
<p># Configure a web authentication domain named <strong>isp2</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa]<strong> domain isp2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-isp2]<strong> authentication-scheme none</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-isp2]<strong> accounting-scheme none</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-isp2]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-domain-isp2]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa]<strong> quit</strong></pre>
</p></li><li><span>Configure a loopback interface.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> interface LoopBack 0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack0] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack0]<strong> ipv6 address 2001:db8:1::3 128 </strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-LoopBack0] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-LoopBack0]<strong> quit</strong></pre>
</p></li><li><span>Configure a web authentication server and an interface connecting <span class="keyword">Device</span>A to the web authentication server.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> </strong><strong>web-auth-server</strong> <strong>enable</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>web-auth-server source interface LoopBack0</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> web-auth-server 2001:db8:1::5 port 50100 key cipher </strong><strong>YsHsjx_202206</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>web-auth-server source-ipv6 2001:db8:1::3</strong></pre>
</p></li><li><span>Configure UCLs.</span><p><p># Configure UCL rules.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>acl ipv6 6200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-acl6-ucl-6200] <strong>rule 5 permit tcp source user-group any destination ipv6-address 2001:db8:1::/64</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-acl6-ucl-6200] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-acl6-ucl-6200] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>acl ipv6 6300</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-acl6-ucl-6300] <strong>rule 5 permit tcp source user-group web-before destination-port eq www</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-acl6-ucl-6300] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-acl6-ucl-6300] <strong>quit</strong></pre>
<p># Configure a traffic policy.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic classifier web_permit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-classifier-web_permit] <strong>if-match ipv6 acl 6200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-classifier-web_permit] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-classifier-web_permit] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic behavior web_permit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-behavior-web_permit] <strong>permit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-behavior-web_permit] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-behavior-web_permit] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic classifier web_http-redirect</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-classifier-web_http-redirect] <strong>if-match ipv6 acl 6300</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-classifier-web_http-redirect] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-classifier-web_http-redirect] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic behavior web_http-redirect</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-behavior-web_http-redirect] <strong>http-redirect</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-behavior-web_http-redirect] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-behavior-web_http-redirect] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic policy web</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-trafficpolicy-web] <strong>classifier web_permit behavior web_permit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-trafficpolicy-web] <strong>classifier web_http-redirect behavior web_http-redirect</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-trafficpolicy-web] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-trafficpolicy-web] <strong>quit</strong></pre>
<p># Apply the user-side traffic policy globally.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic-policy web inbound</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</p></li><li><span>Configure a BAS interface.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface GigabitEthernet <span>0/1/2</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>.1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>.1] <strong>user-vlan 1 </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>.1-vlan-1-1] <strong>quit </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>.1] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>.1] <strong>ipv6 address auto link-local</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>.1] <strong>ipv6 nd autoconfig managed-address-flag</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>.1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>.1]<strong> bas</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>.1-bas]<strong> access-type layer2-subscriber default-domain pre-authentication huawei authentication isp2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>.1-bas]<strong> authentication-method-ipv6 web</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>.1-bas]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>.1-bas]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>.1]<strong> quit</strong></pre>
<p># Configure an upstream interface.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface GigabitEthernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>] <strong>ipv6 address auto link-local</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>] <strong>ipv6 address </strong><strong>2001:db8:1::1</strong><strong>/64 eui-64</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Check information about the prefix pool named <strong>prefix1</strong>. The command output shows that the prefix pool is a local prefix pool and the prefix address is <strong>2001:db8::/64</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> display ipv6 prefix prefix1</strong>                                        
 ------------------------------------------------------------------------------                                                                   
 Prefix Name        : prefix1                                                      
 Prefix Index       : 1                                                         
 Prefix constant index: -                                                       
 Prefix Type        : LOCAL                                                     
 Prefix Address     : 2001:DB8::                                               
 Prefix Length      : 64                                                        
 Reserved Type      : NONE                                                      
 Valid Lifetime     : 3 Days 0 Hours 0 Minutes                                  
 Preferred Lifetime : 2 Days 0 Hours 0 Minutes                                  
 IfLocked           : Unlocked                                                  
 Vpn instance       : -                                                         
 Free Prefix Count  : 262143                                                    
 Used Prefix Count  : 0                                                         
 Reserved Prefix Count: 0                                                       
 Conflict Prefix Count: 0                                                       
 Excluded Prefix Count: 0                                                       
 Radius Used Total  : 0                                                         
 Radius Used Online : 0                                                         
 Auto-Blocked Times : 0                                                         
 IP Allocation Failures : 0                                                     
 -------------------------------------------------------------------------------</pre>
<p># Check information about the address pool named <strong>pool_local</strong>. The command output shows that the address pool is a user-side local address pool and is bound to the local prefix pool <strong>prefix1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display ipv6 pool pool_local </strong>                                   
 ----------------------------------------------------------------------         
 Pool name          : pool_local                                                
 Pool No            : 1                                                         
 Pool constant index: -                                                         
 Pool type          : BAS LOCAL                                                 
 RUI-Flag           : -                                                         
 Preference         : 255                                                       
 Renew time         : 50                                                        
 Rebind time        : 80                                                        
 Status             : UNLOCKED                                                  
 Refresh interval   : infinite                                                  
 Used by domain     : 1                                                         
 Dhcpv6 Unicast     : disable                                                   
 Dhcpv6 rapid-commit: disable                                                   
 Dns list           : -                                                         
 Dns server master  : -                                                         
 Dns server slave   : -                                                         
 AFTR name          : -                                                         
 Wait-Request-Time  : --                                                        
 Warning Threshold  : 80                                                        
 Warning Exhaust Switch: FALSE                                                  
 ----------------------------------------------------------------------         
 Prefix-Name                      Prefix-Type                                   
 ----------------------------------------------------------------------         
 <strong>prefix1</strong>                          LOCAL                                         
 ----------------------------------------------------------------------         </pre>
<p># Check information about the domain named <strong>isp2</strong>. </p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display domain isp</strong><strong>2</strong>                                             
  ------------------------------------------------------------------------------
  Domain-name                     : isp2                                        
  Domain-state                    : Active                                      
  Authentication-scheme-name      : none                                        
  Accounting-scheme-name          : none                                        
  Authorization-scheme-name       : -                                           
  Primary-DNS-IP-address          : -                                           
  Second-DNS-IP-address           : -                                           
  Primary-DNS-IPV6-address        : -                                           
  Second-DNS-IPV6-address         : -                                           
  Web-server-URL-parameter        : No                                          
  Portal-server-URL-parameter     : No                                          
  Primary-NBNS-IP-address         : -                                           
  Second-NBNS-IP-address          : -                                           
  Time-range                      : Disable                                     
  Idle-cut direction              : Both                                        
  Idle-data-attribute (time,flow) : 0, 60                                       
  User detect interval            : 0s                                          
  User detect retransmit times    : 0                                           
  Install-BOD-Count               : 0                                           
  Report-VSM-User-Count           : 0                                           
  Value-added-service             : default                                     
  User-access-limit               : 283648                                      
  Online-number                   : 0                                           
  Web-IP-address                  : -                                           
  Web-IPv6-address                : -                                           
  Dns-redirect-IP-address         : -                                           
  Web-URL                         : -                                           
  Web-auth-server                 : -                                           
  Web-auth-state                  : -                                           
  Web-server-mode                 : get                                         
  Slave Web-IP-address            : -                                           
  Slave Web-IPv6-address          : -                                           
  Slave Web-URL                   : -                                           
  Slave Web-auth-server           : -                                           
  Slave Web-auth-state            : -                                           
  Web-server identical-url        : Disable                                     
  Portal-server-IP                : -                                           
  Portal-URL                      : -                                           
  Portal-force-times              : 2                                           
  Portal-server identical-url     : Disable                                     
  Service-policy(Portal)          : -                                           
  Ds-lite IPv4 portal             : Disable                                     
  PPPoE-user-URL                  : Disable                                     
  AdminUser-priority              : 16                                          
  IPUser-ReAuth-Time              : 300s                                        
  mscg-name-portal-key            : -                                           
  Portal-user-first-url-key       : -                                           
  User-session-limit              : 4294967295                                  
  Ancp auto qos adapt             : Disable                                     
  L2TP-group-name                 : -                                           
  User-lease-time-no-response     : 0s                                          
  RADIUS-server-template          : -                                         
  Two-acct-template               : -                                           
  RADIUS-server-pre-template      : -                                           
  RADIUS-server-llid-first-template: -                                          
  HWTACACS-server-template        : -                                           
  Bill Flow                       : Disable                                     
  Tunnel-acct-2867                : Disable                                     
  Qos-profile-name inbound        : -                                           
  Qos-profile-name outbound       : -                                           

  Flow Statistic:                                                               
  Flow-Statistic-Up               : Yes                                         
  Flow-Statistic-Down             : Yes                                         
  Source-IP-route                 : Disable                                     
  IP-warning-threshold            : -                                           
  IP-warning-threshold(Low)       : -                                           
  IPv6-warning-threshold          : -                                           
  IPv6-warning-threshold(Low)     : -                                           
  Multicast Forwarding            : Yes                                         
  Multicast Virtual               : No                                          
  Max-multilist num               : 4                                           
  Multicast-profile               : -                                           
  Multicast-profile ipv6          : -                                           
  Multicast-policy                : -                                           
  Multicast-bandwidth             : -                                           
  Multicast-bandwidth-level-1     : -                                                                                                                         
  Quota-out                       : Offline                                     
  Service-type                    : -                                           
  User-basic-service-ip-type      : -/-/-                                       
  PPP-ipv6-address-protocol       : Ndra                                        
  IPv6-information-protocol       : Stateless dhcpv6                            
  IPv6-PPP-assign-interfaceid     : Disable                                     
  IPv6-PPP-NDRA-halt              : Disable                                     
  IPv6-PPP-NDRA-unicast           : Disable                                     
  Trigger-packet-wait-delay       : 60s                                         
  Peer-backup                     : Enable                                      
  Reallocate-ip-address           : Disable                                     
  Cui  enable                     : Disable                                     
  Igmp enable                     : Enable                                      
  CPE IP address                  : -                                           
  Pim snooping enable             : Enable                                      
  L2tp-user radius-force          : Disable                                     
  Accounting dual-stack           : Separate                                    
  Radius server domain-annex      : -                                           
  Dhcp-option64-service           : Disable                                     
  Parse-separator                 : -                                           
  Parse-segment-value             : -                                           
  Dhcp-receive-server-packet      : -                                           
  Http-hostcar                    : Disable                                     
  Public-address assign-first     : Disable                                     
  Public-address nat              : Enable                                      
  Dhcp-user auto-save             : Disable                                     
  IP-pool usage-status threshold  : 255 , 255                                   
  Select-Pool-Rule                : gateway + local priority                    
  AFTR name                       : -                                           
  Traffic-rate-mode               : Separate                                    
  Traffic-statistic-mode          : Separate                                    
  Rate-limit-mode-inbound         : Car                                         
  Rate-limit-mode-outbound        : Car                                         
  Service-change-mode             : Stop-start                                                                       
  DAA Direction                   : both                                        
  Session Volumequota apply direction: both                                                                                
  Nas logic-sysname               : -                                           
  Accounting exclude-type vlan    : -/-                                         
  Framed-ip urpf                  : Enable                                      
  RA link-prefix                  : Disable                                     
  Local backup                    : Enable                                      
  DAA start accounting merge      : disable                                     
  DAA stop accounting merge       : disable                                     
  DAA interim accounting merge    : disable                                     
  DAA merged interim accounting interval(minute) : --                           
  DAA merged interim accounting hash  : disable                                 
  EDSG stop accounting merge      : disable                                     
  EDSG interim accounting merge   : disable                                     
  EDSG merged interim accounting interval(minute): --                           
  EDSG merged interim accounting hash : disable                                 
  Stop dropped flow direction     : -                                           
  Interval dropped flow direction : -                                           
  Edsg family-schedule inbound    : Disable                                     
  Edsg family-schedule outbound   : Disable                                     
  Layer2 IPoE ip-pool select-mode : Local                                       
  Layer2 PPPoE ip-pool select-mode: Local                                       
  access-trigger loose time(minute)   : 0                                       
  access-trigger loose infinite-lease : Disable                                 
  IPv6 address assignment mode    : -                                           
  LNS Tcp-Ack Priority-Car        : Disable                                     
  EDSG Tcp-Ack Priority-Car       : Disable                                     
  Include LNS-IPv6                : Disable                                     
  Map priority                    : MAP-E                                       
  Coa-zero-lease Dual-cut         : Disable                                     
  COA lease zero policy           : -                                           
  Authentication fail online domain : -                                         
  ------------------------------------------------------------------------------</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172374028__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><div class="p"><span class="keyword">Device</span>A configuration file<pre class="screen">#
sysname <span class="keyword">Device</span>A
#
dhcpv6 duid 0001000125a7625df063f9761497 
#
ipv6 prefix prefix1 local
 prefix 2001:DB8::/64 
#
ipv6 pool pool_local bas local
 prefix prefix1
#
user-group web-before
#
acl ipv6 number 6200
 rule 5 permit tcp source user-group any destination ipv6-address 2001:DB8:1::/64
#
acl ipv6 number 6300
 rule 5 permit tcp source user-group web-before destination-port eq www
#
traffic classifier web_http-redirect operator or
 if-match ipv6 acl 6300 precedence 19
#
traffic classifier web_permit operator or
 if-match ipv6 acl 6200 precedence 18
#
traffic behavior web_http-redirect 
 http-redirect
#
traffic behavior web_permit
#
traffic policy web 
 share-mode
 classifier web_permit behavior web_permit precedence 4
 classifier web_http-redirect behavior web_http-redirect precedence 6
#
aaa  
 default-password cipher $$e:TY%^%glhJ;yPG#$=tC&amp;(Is%q!S_";(k.Ef$%^%#:978 
 #
 domain huawei
  authentication-scheme none
  accounting-scheme none
  ipv6-pool pool_local
  user-group web-before
  web-server url http://[2001:db8:1::]/portal/default.portal
  web-server identical-url
 #
 domain isp2
  authentication-scheme none
  accounting-scheme none
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:1::1/64 eui-64
 ipv6 address auto link-local
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
#
interface <span>GigabitEthernet</span><span>0/1/2</span>.1
 ipv6 enable
 ipv6 address auto link-local
 user-vlan 1
 ipv6 nd autoconfig managed-address-flag
 bas
 #
  access-type layer2-subscriber default-domain pre-authentication huawei authentication isp2
  authentication-method-ipv6 web
 #
#
interface LoopBack0
 ipv6 enable
 ipv6 address 2001:DB8:1::3 128
#
web-auth-server enable
web-auth-server source interface LoopBack 0
web-auth-server 192.168.8.251 port 50100 key cipher %^%#`E)v.Q@BHVzxxZ;ij{&gt;&amp;_M0!TGP7YRA@8a7mq&lt;\/%^%#
<span>#</span>
<span>undo web-auth-server source-ip all</span>
<span>#</span>
<span>undo web-auth-server source-ipv6 all</span>
web-auth-server source-ipv6 2001:DB8:1::3
#
traffic-policy web inbound
#
return</pre>
</div>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipox_cfg_0083.html">Configuration Examples for IPoE Access Authentication
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_014460_nd.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipox_cfg_0072.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>