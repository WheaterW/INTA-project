
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring RUI+EDSG in Shared Address Pool Mode">
<meta name="abstract" content="This section provides an example for configuring RUI+EDSG in shared address pool mode. A networking diagram is provided to help you understand the configuration procedure. This example covers networking requirements, configuration roadmap, configuration procedure, and configuration files.">
<meta name="description" content="This section provides an example for configuring RUI+EDSG in shared address pool mode. A networking diagram is provided to help you understand the configuration procedure. This example covers networking requirements, configuration roadmap, configuration procedure, and configuration files.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0050.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_rui_edsg_cfg_001.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0057.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00588052,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="UP Multi-Device Backup">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="UP Multi-Device Backup">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="UP Multi-Device Backup">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="User Access Multi-Device Backup">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172374416">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring RUI+EDSG in Shared Address Pool Mode</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172374416"></a><a name="EN-US_TASK_0172374416"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring RUI+EDSG in Shared Address Pool Mode</h1>
<div class="taskbody"><p>This section provides an example for configuring RUI+EDSG in shared address pool mode. A networking diagram is provided to help you understand the configuration procedure. This example covers networking requirements, configuration roadmap, configuration procedure, and configuration files.</p>
<div class="context"><a name="EN-US_TASK_0172374416__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>As IP technologies develop rapidly, various value-added services are widely used on the Internet. Carrier-grade services, such as emerging IPTV, NGN, 4G, VIP customers' private line, and VPN interconnection, place higher requirements for IP network reliability. IP network reliability for carrier-grade services covers device, link, and network reliability. On a transport network, the availability of network devices must reach 99.999%. In other words, the downtime for maintenance during the continuous running of a device in a year is less than 5 minutes. High reliability is a basic requirement for carrier-grade devices and is the foundation upon which telecom carriers must build their networks.</p>
<p>The <span class="keyword">NE40E</span> is an edge router used to carry multiple services. It plays a vital role on a network. It is uplinked to the core layer to implement the Layer 3 routing function and downlinked to the aggregation layer to terminate Layer 2 user packets for user access. Additionally, it carries multiple services including Triple Play services (HSI, VoIP, and IPTV), requiring high reliability. The <span class="keyword">NE40E</span> provides service-level high-reliability technologies. Non-stop data flow forwarding does not mean that user services are not interrupted. Instead, if user traffic is switched to a standby device after a network node or link fails and user information is not synchronized to the standby device, user services are still interrupted. High reliability has been considered when the <span class="keyword">NE40E</span> is designed to function as a network edge service aggregation and control device. This ensures that users' HSI, IPTV, and VoIP services are not interrupted if a network node or link fault occurs. Dual-device hot backup is designed based on this reliability scenario.</p>
<h4 class="sectiontitle">Requirements on Hardware</h4><p>User access boards are installed.</p>
<h4 class="sectiontitle">Requirements on Interconnected Devices</h4><div class="p"><ul><li>Upstream device: There are no special requirements. The upstream device is generally a core-layer CR that can exchange routes normally and supports MPLS and MPLS L3VPN. It is recommended that the upstream device be able to provide MPLS L2VPN capabilities. In multi-device hot backup scenarios, MPLS tunnels are best suited to function as protection tunnels. This is because an MPLS protection tunnel can be established from the IP core network if a direct link cannot be deployed between <span class="keyword">NE40E</span>s.</li><li>Downstream device: An aggregation switch is used as the downstream device to learn MAC addresses from Layer 2 VLAN packets.</li></ul>
</div>
<h4 class="sectiontitle">Solution Limitations</h4><div class="p"><ul><li>In shared address pool mode, an address pool (an IP network segment) is planned based on services. Each service (for example, Internet access or VoIP service) corresponds to a domain's configuration. If terminals that go online through different access links have the same service (for example, Internet access service), the terminals share address pool resources in a domain. This mode is called multi-link address pool sharing.</li><li>In actual deployment, planning address pools based on links is difficult. The reason is that the number of public addresses is limited, and dividing address pools causes address resources to be wasted. Therefore, address pools are divided based on authentication domains. This allows an address pool on an MSCG to be shared among multiple links or backup groups. In this case, forwarding control cannot be performed by advertising or withdrawing address pool routes. To implement forwarding control, using a shared address pool and tunnel protection is recommended.</li></ul>
</div>
<h4 class="sectiontitle">Networking Requirements</h4><p>Carriers can divide networks into different subnets based on traffic destination addresses. When different users access the subnets, different rate limiting and accounting are performed for the users. EDSG implements subnet division, rate limit, and accounting management on BRASs. As applications accessed by users become diversified, high reliability is required for EDSG services. To meet this requirement, deploy RUI so that EDSG service traffic is smoothly switched to the standby device if the master device fails. RUI ensures normal traffic accounting without the need of users' re-dialup.</p>
<p>On the network shown in <a href="#EN-US_TASK_0172374416__fig_ne_rui_edsg_cfg_002">Figure 1</a>, the user goes online from <span class="keyword">Device</span> A (master device) through PPPoE dialup. <span class="keyword">Device</span> A and <span class="keyword">Device</span> B implement RUI over VRRP and BFD. <span class="keyword">Device</span> A backs up EDSG services to <span class="keyword">Device</span> B (backup device). If <span class="keyword">Device</span> A fails, service traffic is switched to <span class="keyword">Device</span> B. Traffic statistics on <span class="keyword">Device</span> A and <span class="keyword">Device</span> B remain consistent.</p>
<div class="fignone" id="EN-US_TASK_0172374416__fig_ne_rui_edsg_cfg_002"><a name="EN-US_TASK_0172374416__fig_ne_rui_edsg_cfg_002"></a><a name="fig_ne_rui_edsg_cfg_002"></a><span class="figcap"><b>Figure 1 </b>Example for configuring RUI+EDSG in shared address pool mode</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interfaces 1 through 3 represent GE<span>0/1/0</span>, GE<span>0/2/0</span>, and GE<span>0/3/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_ne_rui_edsg_cfg_002.png" width="NaN" height="NaN"></span><br><div class="tableBorder"><table cellpadding="4" cellspacing="0" summary=""><tr><td valign="top"><p>Device</p>
</td>
<td valign="top"><p>Interface</p>
</td>
<td valign="top"><p>IP Address</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span>A</p>
</td>
<td valign="top"><p>GE<span>0/1/0</span></p>
</td>
<td valign="top"><p>10.0.1.1/24</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span>A</p>
</td>
<td valign="top"><p>GE<span>0/2/0</span></p>
</td>
<td valign="top"><p>10.0.0.1/24</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span>A</p>
</td>
<td valign="top"><p>GE<span>0/3/0</span></p>
</td>
<td valign="top"><p>10.1.1.6/24</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span>A</p>
</td>
<td valign="top"><p>Loopback0</p>
</td>
<td valign="top"><p>1.1.1.1/32</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span>A</p>
</td>
<td valign="top"><p>Loopback1</p>
</td>
<td valign="top"><p>22.22.22.22/32</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span>B</p>
</td>
<td valign="top"><p>GE<span>0/1/0</span></p>
</td>
<td valign="top"><p>10.0.1.2/24</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span>B</p>
</td>
<td valign="top"><p>GE<span>0/2/0</span></p>
</td>
<td valign="top"><p>10.0.2.1/24</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span>B</p>
</td>
<td valign="top"><p>GE<span>0/3/0</span></p>
</td>
<td valign="top"><p>10.1.1.7/24</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span>B</p>
</td>
<td valign="top"><p>Loopback0</p>
</td>
<td valign="top"><p>2.2.2.2/32</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span>B</p>
</td>
<td valign="top"><p>Loopback1</p>
</td>
<td valign="top"><p>88.88.88.88/32</p>
</td>
</tr>
</table></div>
</div>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172374416__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure basic user access functions and ensure that the two devices have the same configuration. For details, see "User Access" in <em><span class="keyword">HUAWEI NE40E-M2 series</span> <span class="keyword">Universal Service Router</span> Configuration Guide</em>.</p>
</li><li><p>Configure routes to ensure IP connectivity between devices. For details, see "IP Routing" in <em><span class="keyword">HUAWEI NE40E-M2 series</span> <span class="keyword">Universal Service Router</span> Configuration Guide</em>.</p>
</li><li><p>Establish a multi-device backup platform.</p>
</li><li><p>Configure an RBS, address pools, and an RBP.</p>
</li><li><p>Configure a protection path for returned network-side traffic.</p>
</li><li><p>Bind an RBP to an interface from which the user goes online.</p>
</li><li>Configure EDSG services on <span class="keyword">Device</span> A and <span class="keyword">Device</span> B. For details, see "Value-added Service" in <em><span class="keyword">HUAWEI NE40E-M2 series</span> <span class="keyword">Universal Service Router</span> Multiservice Control Gateway Configuration Guide</em>.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172374416__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>VRRP ID</p>
</li><li><p>Interface IP addresses of <span class="keyword">Router</span>s that back up each other</p>
</li><li><p>Backup ID, which is used together with an RBS to identify the RBP to which the user belongs</p>
</li><li><p>Address pool names</p>
</li><li><p>EDSG-related parameters</p>
</li><li>User authentication mode (RADIUS authentication)</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172374416__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Establish a multi-device backup platform. The configuration on <span class="keyword">Device</span> A is used as an example. The configuration of <span class="keyword">Device</span> B is similar to the configuration on <span class="keyword">Device</span> A.</span><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, only RUI-related configuration is described.</p>
</div></div>
<p># Configure a BFD session named <strong>bfd</strong> on the access side to rapidly detect interface or link faults and trigger a master/backup VRRP switchover. 10.0.1.2 is the IP address of GE <span>0/1/0</span>.2 on <span class="keyword">Device</span> B.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>A</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> bfd </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> commit </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-bfd]<strong> quit </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> bfd bfd bind peer-ip 10.0.1.2 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-bfd]<strong> discriminator local 1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-bfd]<strong> discriminator remote 2 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bfd-session-bfd]<strong> commit </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-bfd-session-bfd]<strong> quit </strong></pre>
<p># Configure a VRRP group on GE<span>0/1/0</span>.2, and configure the VRRP group to track the BFD session and network-side interface status.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> interface gigabitethernet <span>0/1/0</span>.2 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> vlan-type dot1q 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> ip address 10.0.1.1 255.255.255.0 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> vrrp vrid 1 virtual-ip 10.0.1.100 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> admin-vrrp vrid 1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> vrrp vrid 1 priority 120 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> vrrp vrid 1 preempt-mode timer delay 600</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> vrrp vrid 1 track bfd-session 1 peer</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> vrrp vrid 1 track interface gigabitethernet <span>0/2/0</span> reduced 50</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2] <strong>vrrp recover-delay</strong><strong> 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> commit </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.2]<strong> quit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Different priorities must be configured for devices in a VRRP group. The device with a higher priority is the master device.</p>
</div></div>
</p></li><li><span>Configure an RBS, address pools, and an RBP.</span><p><p># Configure an RBS.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> remote-backup-service service1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-srv-service1]<strong> peer 88.88.88.88 source 22.22.22.22 port 2046 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-srv-service1]<strong> track interface gigabitethernet <span>0/2/0</span> </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-srv-service1]<strong> commit </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-rm-backup-srv-service1] <strong>quit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>You can run the <strong>track bfd-session</strong> command in the RBS view to track the peer BFD sessions established on the network side of the active and standby devices, achieving rapid peer status detection. For configuration details, see the corresponding command reference.</p>
</div></div>
<div class="p"># Configure a primary address pool and a backup address pool on <span class="keyword">Device</span> A (master device).<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>ip pool hsi bas local</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ip-pool-hsi] <strong>gateway 1.1.1.1 24</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ip-pool-hsi] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-ip-pool-hsi] <strong>section 0 1.1.1.2 1.1.1.254</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ip-pool-hsi]<strong> commit </strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-ip-pool-hsi] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>ip pool hsi-main-bak bas local rui-slave</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ip-pool-hsi-main-bak] <strong>gateway 2.2.2.2 24</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ip-pool-hsi-main-bak]<strong> commit </strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-ip-pool-hsi-main-bak] <strong>section 0 2.2.2.3 2.2.2.254</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ip-pool-hsi-main-bak]<strong> commit </strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-ip-pool-hsi-main-bak] <strong>quit</strong></pre>
</div>
<p># Configure a primary address pool named <strong>hsi-main</strong> and a backup address pool named <strong>local</strong> on <span class="keyword">Device</span> B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ip pool hsi-main bas local</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ip-pool-hsi-main] <strong>gateway 2.2.2.2 24</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ip-pool-hsi-main]<strong> commit </strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ip-pool-hsi-main] <strong>section 0 2.2.2.3 2.2.2.254</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ip-pool-hsi-main]<strong> commit </strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ip-pool-hsi-main] <strong>quit</strong></pre>
<p># Configure a secondary address pool named <strong>hsi-bak</strong> and specify it as a hybrid address pool.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ip pool hsi-bak bas local rui-slave</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ip-pool-hsi-bak] <strong>gateway 1.1.1.1 24</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ip-pool-hsi-bak] <strong>commit</strong>
[<strong><span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span></strong><span class="keyword">Device</span>B-ip-pool-hsi-bak] <strong>section 0 1.1.1.2 1.1.1.254</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ip-pool-hsi-bak]<strong> commit </strong>
[<strong><span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span></strong><span class="keyword">Device</span>B-ip-pool-hsi-bak] <strong>quit</strong></pre>
<p># Configure an RBP on <span class="keyword">Device</span> A and <span class="keyword">Device</span> B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> remote-backup-profile profile1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> peer-backup hot </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> vrrp-id 1 interface gigabitethernet <span>0/1/0</span>.2 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> backup-id 10 remote-backup-service service1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> service-type bras </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> commit </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-rm-backup-prf-profile1]<strong> quit </strong></pre>
<p></p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> remote-backup-profile profile1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-rm-backup-prf-profile1]<strong> peer-backup hot </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-rm-backup-prf-profile1]<strong> vrrp-id 1 interface gigabitethernet <span>0/1/0</span>.2 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-rm-backup-prf-profile1]<strong> backup-id 10 remote-backup-service service1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-rm-backup-prf-profile1]<strong> service-type bras </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-rm-backup-prf-profile1] <strong>ip-pool hsi include hsi-bak node 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-rm-backup-prf-profile1] <strong>ip-pool hsi-main include hsi-main-bak node 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-rm-backup-prf-profile1]<strong> commit </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-rm-backup-prf-profile1]<strong> quit </strong></pre>
</p></li><li><span>Bind the configured address pools to the RBS and configure a protection path for returned network-side traffic.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> remote-backup-service service1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-srv-service1]<strong> ip-pool hsi</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-srv-service1]<strong> ip-pool hsi-bak</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-srv-service1]<strong> protect redirect ip-nexthop 10.1.1.7 interface gigabitethernet <span>0/3/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-srv-service1]<strong> commit </strong></pre>
<p></p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> remote-backup-service service1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-rm-backup-srv-service1]<strong> ip-pool hsi-main</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-rm-backup-srv-service1]<strong> ip-pool hsi-main-bak</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-rm-backup-srv-service1]<strong> protect redirect ip-nexthop 10.1.1.6 interface gigabitethernet <span>0/3/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-srv-service1]<strong> commit </strong></pre>
</p></li><li><span>Bind the RBP to GE <span>0/1/0</span>.1 from which users go online. The configuration on <span class="keyword">Device</span> A is used as an example. The configuration of <span class="keyword">Device</span> B is similar to the configuration of <span class="keyword">Device</span> A.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> interface gigabitethernet <span>0/1/0</span>.1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span>A-GigabitEthernet<span>0/1/0</span>.1]<strong> remote-backup-profile profile1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-rm-backup-srv-service1]<strong> commit </strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.1]<strong> quit </strong></pre>
</p></li><li><span>Configure EDSG services.</span><ol type="a"><li class="substepexpand"><span>Enable the value-added service function.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>value-added-service enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</p></li><li class="substepexpand"><span>Configure a policy server.</span><p><div class="p"># Set parameters as follows:<ul><li>RADIUS server group name: rad_group1</li><li>RADIUS authentication server's IP address: 10.10.10.2</li><li>RADIUS authentication server's interface number: 1812</li><li>RADIUS accounting server's IP address: 10.10.10.2</li><li>RADIUS accounting server's interface number: 1813</li><li>Shared key for the RADIUS authentication and accounting servers: YsHsjx_202206</li></ul>
</div>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>radius-server group rad_group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-radius-rad_group1] <strong>radius-server authentication 10.10.10.2 1812</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-radius-rad_group1] <strong>radius-server accounting 10.10.10.2 1813</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-radius-rad_group1] <strong>radius-server shared-key-cipher YsHsjx_202206</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-radius-rad_group1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-radius-rad_group1] <strong>quit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>For details about how to configure a RADIUS server group, see <a href="dc_ne_aaa_cfg_0600.html">Configuring a Device as a RADIUS Client</a> in <em><span class="keyword">HUAWEI NE40E-M2 series</span> Configuration Guide - User Access</em>.</p>
</div></div>
</p></li><li class="substepexpand"><span>Configure an EDSG traffic policy.</span><p><ol class="substepthirdol"><li><p>Create service groups.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>service-group s_1m</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>service-group s_2m</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>You must run the <a href="cmdqueryname=service-group"><b><span class="cmdname">service-group</span></b></a> command to create service groups regardless of whether the device obtains EDSG service policies from local configurations or a RADIUS server.</p>
</div></div>
</li><li><p>Configure an ACL and define ACL rules for each service group.</p>
<p># Configure ACL 6020 and define ACL rules for the service group named <strong>s_1m</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>acl number 6020</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-acl-ucl-6020] <strong>rule 10 permit ip source service-group s_1m destination ip-address 192.168.100.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-acl-ucl-6020] <strong>rule 20 permit ip source ip-address 192.168.100.0 0.0.0.255 destination service-group s_1m</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-acl-ucl-6020] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-acl-ucl-6020] <strong>quit</strong></pre>
<p># Configure ACL 6021 and define ACL rules for the service group named <strong>s_2m</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>acl number 6021</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-acl-ucl-6021] <strong>rule 15 permit ip source service-group s_2m destination ip-address 192.168.200.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-acl-ucl-6021] <strong>rule 25 permit ip source ip-address 192.168.200.0 0.0.0.255 destination service-group s_2m</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-acl-ucl-6021] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-acl-ucl-6021] <strong>quit</strong></pre>
</li><li><p>Define traffic classifiers.</p>
<p># Define a traffic classifier named <strong>c1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic classifier c1 operator or</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-classifier-c1] <strong>if-match acl 6020</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-classifier-c1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-classifier-c1] <strong>quit</strong></pre>
<p># Define a traffic classifier named <strong>c2</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic classifier c2 operator or</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-classifier-c2] <strong>if-match acl 6021</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-classifier-c2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-classifier-c2] <strong>quit</strong></pre>
</li><li><p>Define traffic behaviors.</p>
<p># Define a traffic behavior named <strong>b1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic behavior b1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-behavior-b1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-behavior-b1] <strong>quit</strong></pre>
<p># Define a traffic behavior <strong>b2</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic behavior b2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-behavior-b2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-behavior-b2] <strong>quit</strong></pre>
</li><li><p>Configure an EDSG traffic policy.</p>
<p># Configure an EDSG traffic policy named <strong>traffic_policy_edsg</strong>, and associate <strong>c1</strong> and <strong>c2</strong> with <strong>b1</strong> and <strong>b2</strong>, respectively.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic policy traffic_policy_edsg</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-policy-traffic_policy_edsg] <strong>share-mode</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-policy-traffic_policy_edsg] <strong>classifier c1 behavior b1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-policy-traffic_policy_edsg] <strong>classifier c2 behavior b2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-policy-traffic_policy_edsg] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-policy-traffic_policy_edsg] <strong>quit</strong></pre>
</li><li><p>Apply the EDSG traffic policy globally.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic-policy traffic_policy_edsg inbound</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic-policy traffic_policy_edsg outbound</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</li></ol>
</p></li><li class="substepexpand"><span>Configure an AAA authentication scheme and accounting scheme.</span><p><p># Configure an AAA authentication scheme named <strong>auth1</strong> and specify RADIUS authentication as the authentication mode.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>aaa</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa] <strong>authentication-scheme auth1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-authen-auth1] <strong>authentication-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-authen-auth1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa-authen-auth1] <strong>quit</strong></pre>
</p><p><p># Configure an AAA accounting scheme named <strong>acct1</strong> and specify RADIUS accounting as the accounting mode.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa] <strong>accounting-scheme acct1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-accounting-acct1] <strong>accounting-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-accounting-acct1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Configure a mode in which EDSG service policies are obtained.</span><p><p># Configure the device to obtain EDSG service policies from local configurations and then from a RADIUS server if no EDSG service policy is obtained from local configurations.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>service-policy download local radius rad_group1 password cipher YsHsjx_202206</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</p></li><li class="substepexpand"><span>Configure EDSG service policies.</span><p><ol class="substepthirdol"><li><p>Configure an EDSG service policy for the access to network 1.</p>
<p># Create an EDSG service policy named <strong>service_edsg1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>service-policy name service_edsg1 edsg</strong></pre>
<p># Bind <strong>s_1m</strong> to <strong>service_edsg1</strong>.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg1] <strong>service-group s_1m</strong></pre>
<p># Bind <strong>rad_group1</strong> to <strong>service_edsg1</strong>.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg1] <strong>radius-server group rad_group1</strong></pre>
<p># Bind <strong>auth1</strong> to <strong>service_edsg1</strong>.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg1] <strong>authentication-scheme auth1</strong></pre>
<p># Bind <strong>acct1</strong> to <strong>service_edsg1</strong>.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg1] <strong>accounting-scheme acct1</strong></pre>
<p># Set the uplink traffic rate limit for <strong>service_edsg1</strong> to 1 Mbit/s.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg1] <strong>rate-limit cir 1000 inbound</strong></pre>
<p># Set the downlink traffic rate limit for <strong>service_edsg1</strong> to 1 Mbit/s.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg1] <strong>rate-limit cir 1000 outbound</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-service-policy-service_edsg1] <strong>quit</strong></pre>
</li><li><p>Configure an EDSG service policy for the access to network 2.</p>
<p># Create an EDSG service policy named <strong>service_edsg2</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>service-policy name service_edsg2 edsg</strong></pre>
<p># Bind <strong>s_2m</strong> to <strong>service_edsg2</strong>.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg2] <strong>service-group s_2m</strong></pre>
<p># Bind <strong>rad_group1</strong> to <strong>service_edsg2</strong>.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg2] <strong>radius-server group rad_group1</strong></pre>
<p># Bind <strong>auth1</strong> to <strong>service_edsg2</strong>.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg2] <strong>authentication-scheme auth1</strong></pre>
<p># Bind <strong>acct1</strong> to <strong>service_edsg2</strong>.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg2] <strong>accounting-scheme acct1</strong></pre>
<p># Set the uplink traffic rate limit for <strong>service_edsg2</strong> to 2 Mbit/s.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg2] <strong>rate-limit cir 2000 inbound</strong></pre>
<p># Set the downlink traffic rate limit for <strong>service_edsg2</strong> to 2 Mbit/s.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg2] <strong>rate-limit cir 2000 outbound</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-service-policy-service_edsg2] <strong>quit</strong></pre>
</li></ol>
</p></li><li class="substepexpand"><span>Bind the local address pool and RADIUS server group to an AAA domain.</span><p><p># Bind <strong>edsg_pool</strong> and <strong>rad_group1</strong> to an AAA domain.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>aaa</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa] <strong>domain domain1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-domain1] <strong>ip-pool edsg_pool</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-domain1] <strong>radius-server group rad_group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa-domain-domain1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-aaa] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-aaa] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Configure the prepaid function.</span><p><ol class="substepthirdol"><li><p>Configure a prepaid profile for the access to network 1.</p>
<p># Create a prepaid profile named <strong>prepaid1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> prepaid-profile prepaid1</strong></pre>
<p># Bind <strong>rad_group1</strong> to <strong>prepaid1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-prepaid-profile-prepaid1]<strong> radius-server group rad_group1</strong></pre>
<p># Bind <strong>auth1</strong> to the prepaid profile.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-prepaid-profile-prepaid1]<strong> authentication-scheme auth1</strong></pre>
<p># Bind <strong>acct1</strong> to the prepaid profile.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-prepaid-profile-prepaid1]<strong> accounting-scheme acct1</strong></pre>
<p># Configure a password used for the device to apply for an EDSG service quota from the RADIUS server group.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-prepaid-profile-prepaid1] <strong>password cipher YsHsjx_202206</strong></pre>
<p># Set the time threshold for the device to reapply for a time quota for EDSG services from the RADIUS server to 60s.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-prepaid-profile-prepaid1] <strong>threshold time 60 seconds</strong></pre>
<p># Set the traffic volume threshold for the BRAS to reapply for a traffic volume quota for EDSG services from the RADIUS server to 10 Mbytes.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-prepaid-profile-prepaid1] <strong>threshold volume 10 mbytes</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-prepaid-profile-prepaid1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-prepaid-profile-prepaid1] <strong>quit</strong></pre>
</li><li><p>Configure a prepaid profile for the access to network 2.</p>
<p># Create a prepaid profile named <strong>prepaid2</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> prepaid-profile prepaid2</strong></pre>
<p># Bind <strong>rad_group1</strong> to <strong>prepaid2</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-prepaid-profile-prepaid2]<strong> radius-server group rad_group1</strong></pre>
<p># Bind auth1 to the prepaid profile.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-prepaid-profile-prepaid2]<strong> authentication-scheme auth1</strong></pre>
<p># Bind acct1 to the prepaid profile.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-prepaid-profile-prepaid2]<strong> accounting-scheme acct1</strong></pre>
<p># Configure a password used for the device to apply for an EDSG service quota from the RADIUS server group.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-prepaid-profile-prepaid2]<strong> password cipher YsHsjx_202206</strong></pre>
<p># Set the time threshold for the device to reapply for a time quota for EDSG services from the RADIUS server to 300s.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-prepaid-profile-prepaid2]<strong> threshold time 300 seconds</strong></pre>
<p># Set the traffic volume threshold for the device to reapply for a traffic volume quota for EDSG services from the RADIUS server to 20 Mbytes.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-prepaid-profile-prepaid2]<strong> threshold volume 20 mbytes</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-prepaid-profile-prepaid2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-prepaid-profile-prepaid2]<strong> quit</strong></pre>
</li><li><p>Apply the prepaid profiles in the EDSG service policy view.</p>
<p># Apply <strong>prepaid1</strong> to <strong>service_edsg1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> service-policy name service_edsg1 edsg</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg1]<strong> prepaid-profile prepaid1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-service-policy-service_edsg1] <strong>quit</strong></pre>
<p># Apply <strong>prepaid2</strong> to <strong>service_edsg2</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> service-policy name service_edsg2 edsg</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg2] <strong>prepaid-profile prepaid2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-service-policy-service_edsg2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-service-policy-service_edsg2] <strong>quit</strong></pre>
</li></ol>
</p></li><li class="substepexpand"><span>Configure interfaces.</span><p><ol class="substepthirdol"><li><p>Create a virtual template interface.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface Virtual-Template 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Virtual-Template1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-Virtual-Template1] <strong>quit</strong></pre>
</li><li><p>Configure a BAS interface.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface <span>GigabitEthernet</span><span>0/1/2</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>GigabitEthernet</span><span>0/1/2</span>.1] <strong>user-vlan 1000 2000</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>GigabitEthernet</span><span>0/1/2</span>.1] <strong>user-vlan 1 1000 qinq 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>GigabitEthernet</span><span>0/1/2</span>.1] <strong>pppoe-server bind virtual-template 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>GigabitEthernet</span><span>0/1/2</span>.1] <strong>bas</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>GigabitEthernet</span><span>0/1/2</span>.1-bas] <strong>access-type layer2-subscriber default-domain pre-authentication domain1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>GigabitEthernet</span><span>0/1/2</span>.1-bas] <strong>authentication-method ppp web </strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>GigabitEthernet</span><span>0/1/2</span>.1-bas] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>GigabitEthernet</span><span>0/1/2</span>.1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-<span>GigabitEthernet</span><span>0/1/2</span>.1] <strong>quit</strong></pre>
</li><li><p>Configure an uplink interface.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface GigabitEthernet<span>0/1/0</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.1] <strong>vlan-type dot1q 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.1] <strong>ip address 192.168.100.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>.1] <strong>quit</strong></pre>
</li><li><p>Configure the interface connected to the policy server, AAA server, and portal server.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface GigabitEthernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>] <strong>ip address 10.10.10.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
</li></ol>
</p></li><li class="substepexpand"><span>Configure users to go online.</span><p><p># Configure the AAA server to deliver the RADIUS attribute User-Password with a value of <strong>YsHsjx_202206</strong> for PPPoE users (users 1 and 2).</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The shared key configured for a RADIUS server group determines the content of the User-Password attribute.</p>
</div></div>
<p># Configure the AAA server to deliver the RADIUS attribute HW-Account-Info containing <strong>Aservice_edsg1</strong> for user 1.</p>
<p># Configure the AAA server to deliver the RADIUS attribute HW-Account-Info containing <strong>Aservice_edsg2</strong> for user 2.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The content of the HW-Account-Info attribute starts with "A" followed by a service name. This attribute is used in user authentication response packets to deliver EDSG services that automatically take effect (directly activated after delivery).</p>
</div></div>
</p></li></ol>
</li><li><span>Verify the configuration.</span><p><p>After successfully configuring the RBP, run the <strong>display remote-backup-profile</strong> command. According to the command output, the RBS type is <strong>bras</strong>, the RBP named <strong>profile1</strong> is bound to <strong>GigabitEthernet<span>0/1/0</span>.1</strong> from which users go online, and <span class="keyword">Device</span> A is in the <strong>Master</strong> state.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A&gt; <strong>display remote-backup-profile profile1 </strong></pre>
<pre class="screen">-----------------------------------------------
 Profile-Index        : 0x803
 Profile-Name         : profile1
 <strong>Service            : bras</strong>
 Remote-backup-service: service1
 Backup-ID            : 10
 track protocol       : VRRP
 VRRP-ID              : 1
 VRRP-Interface       : GigabitEthernet<span>0/1/0</span>.2
 Interface            :
                        GigabitEthernet<span>0/1/0</span>.1
 <strong>State           	 : Master</strong>
 <strong>Peer-state      	 : Slave</strong>
 Backup mode          : hot
 Slot-Number          : 1
 Card-Number          : 0
 Port-Number          : 0
 IP-Pool              : hsi
 Traffic threshold    : 50(MB)
 Traffic interval     : 10(minutes)     
</pre>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B&gt; <strong>display remote-backup-profile profile1 </strong></pre>
<pre class="screen">-----------------------------------------------
 Profile-Index        : 0x803
 Profile-Name         : profile1
 <strong>Service            : bras</strong>
 Remote-backup-service: service1
 Backup-ID            : 10
 track protocol       : VRRP
 VRRP-ID              : 1
 VRRP-Interface       : GigabitEthernet<span>0/1/0</span>.2
 Interface            :
                        GigabitEthernet<span>0/1/0</span>.1
 <strong>State              : Slave</strong>
 <strong>Peer-state      	 : Master</strong>
 Backup mode          : hot
 Slot-Number          : 1
 Card-Number          : 0
 Port-Number          : 0
 IP-Pool              : hsi
 Traffic threshold    : 50(MB)
 Traffic interval     : 10(minutes)     </pre>
<p>After successfully configuring the RBS, run the <strong>display remote-backup-service</strong> command. The command output shows that the TCP connection is in the <strong>Connected</strong> state.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A&gt; <strong>display remote-backup-service service1 </strong>
----------------------------------------------------------
 Service-Index    : 0
 Service-Name     : service1
 <strong>TCP-State        : Connected</strong>
 Peer-ip          : 88.88.88.88
 Source-ip        : 22.22.22.22
 TCP-Port         : 2046
 Track-BFD        : --
 Track-interface0 : GigabitEthernet<span>0/2/0</span>
 Track-interface1 : --
----------------------------------------------------------

<span>ip pool:
         hsi metric 10
         hsi-bak metric 10
ipv6 pool:  </span>
<span>NAT instance : nat1</span>
----------------------------------------------------------
 Rbs-ID         : 0
 Protect-type   : ip-redirect
 Next-hop       : 10.1.1.7
 Vlanid         : 0
 Peer-ip        : 10.1.1.7
 Vrfid          : 0
 Tunnel-index   : 0x0
 Tunnel-state   : UP
 Tunnel-OperFlag: NORMAL
 Spec-interface : GigabitEthernet<span>0/3/0</span>
 Out-interface  : GigabitEthernet<span>0/3/0</span>
 User-number    : 0
</pre>
<p>After users go online, run the <strong>display backup-user</strong> command to check information about backup users.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>&gt; <strong>display backup-user</strong></pre>
<pre class="screen">  Remote-backup-service: service1
  Total Users Numer: 10
------------------------------------------------------------------------
 100     101     102     103     104     105     106     107     108     109
------------------------------------------------------------------------
</pre>
<p>Run the <strong>display access-user interface</strong> command to view online user information on a specified interface.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>&gt; <strong>display access-user interface GigabitEthernet <span>0/1/0</span>.1</strong></pre>
<pre class="screen">  ------------------------------------------------------------------------------
  UserID  Username                Interface      IP address       MAC
          Vlan          IPv6 address             Access type
  ------------------------------------------------------------------------------
  120     user@lsh                GE<span>0/1/0</span>.1      2.2.2.10         00e0-fc12-0101
          50/-            -                       IPoE
  101      user@lsh                GE<span>0/1/0</span>.1      2.2.2.9         00e0-fc12-0102          -
          50/-            -                       IPoE
  102      user@lsh                GE<span>0/1/0</span>.1      2.2.2.8         00e0-fc12-0103          -
          50/-            -                       IPoE
  103      user@lsh                GE<span>0/1/0</span>.1      2.2.2.7         00e0-fc12-0104          -
          50/-            -                       IPoE
  104      user@lsh                GE<span>0/1/0</span>.1      2.2.2.6         00e0-fc12-0105          -
          50/-            -                       IPoE
  105      user@lsh                GE<span>0/1/0</span>.1      2.2.2.5         00e0-fc12-0106          -
          50/-            -                       IPoE
  106      user@lsh                GE<span>0/1/0</span>.1      2.2.2.4         00e0-fc12-0107          -
          50/-            -                       IPoE
  107      user@lsh                GE<span>0/1/0</span>.1      2.2.2.3         00e0-fc12-0108          -
          50/-            -                       IPoE
  108      user@lsh                GE<span>0/1/0</span>.1      2.2.2.2         00e0-fc12-0109          -
          50/-            -                       IPoE
  109      user@lsh                GE<span>0/1/0</span>.1      2.2.2.11        00e0-fc12-0110          -
          50/-            -                       IPoE
  --------------------------------------------------------------------------
  Normal users                       : 0
  RUI Local users                    : 10
  RUI Remote users                   : 0
  Total users                        : 10</pre>
<p>Check the EDSG service status on the active and standby devices.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>display service-policy configuration name service_edsg1</strong>
------------------------------------------------
Service-policy-index         : 0
  Service-policy-name          : service1
  Service-policy-type          : EDSG
  Policy-storage-type          : configuration
  Reference-count              : 0
<span>  Service-class-inbound        : ef
  Service-class-outbound       : ef</span>
  Authentication-scheme-name   : -
  Accounting-scheme-name       : default1
  Radius-server-template       : template1
  Service-group-name           : -
  Service-group-priority       : -
  Inbound-cir                  : 100(kbps)
  Inbound-pir                  : 100(kbps)
  Inbound-cbs                  : 100(bytes)
  Inbound-pbs                  : 3000(bytes)
  Outbound-cir                 : 10000(kbps)
  Outbound-pir                 : -
  Outbound-cbs                 : -
  Outbound-pbs                 : -
  Prepaid-profile-name         : -
  Diameter monitor key         : -
  Inbound-match-usergroup      : no
  Outbound-match-usergroup     : no
 ------------------------------------------------ 
</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172374416__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span> A configuration file</p>
<pre class="screen">#
 sysname <span class="keyword">Device</span>A
#
 bfd
#
ip pool hsi bas local 
 gateway 1.1.1.1 255.255.255.0 
 section 0 1.1.1.2 1.1.1.254 
#
ip pool hsi-main-bak bas local rui-slave 
 gateway 2.2.2.2 255.255.255.0
 section 0 2.2.2.3 2.2.2.254 
#
aaa
 domain userdomain1 
 authentication-scheme default0 
 accounting-scheme default0 
 ip-pool hsi 
 ip-pool hsi-main-bak
#
bfd bfd bind peer-ip 10.0.1.2 
 discriminator local 1 
 discriminator remote 2  
#
interface gigabitethernet <span>0/1/0</span>.2 
 vlan-type dot1q 200 
 ip address 10.0.1.1 255.255.255.0 
 vrrp vrid 1 virtual-ip 10.0.1.100 
 admin-vrrp vrid 1 
 vrrp vrid 1 priority 120 
 vrrp vrid 1 preempt-mode timer delay 600
 vrrp vrid 1 track bfd-session 1 peer 
 vrrp vrid 1 track interface gigabitethernet <span>0/2/0</span> reduced 50
 vrrp recover-delay 20
#
remote-backup-service service1 
 peer 88.88.88.88 source 22.22.22.22 port 2046 
 track interface gigabitethernet <span>0/2/0</span>  
 ip-pool hsi
 ip-pool hsi-bak
 protect redirect ip-nexthop 10.1.1.7 interface gigabitethernet <span>0/3/0</span>
#
remote-backup-profile profile1 
 service-type bras
 backup-id 10 remote-backup-service service1 
 peer-backup hot 
 vrrp-id 1 interface gigabitethernet <span>0/1/0</span>.2 
#
interface gigabitethernet <span>0/1/0</span>.1
 user-vlan 50 
 remote-backup-profile profile1 
 bas 
 access-type layer2-subscriber 
 authentication-method  web 
 vlan-type dot1q 1
 ip address 192.168.100.1 255.255.255.0
#
interface gigabitethernet <span>0/3/0</span>
 undo shutdown 
 ip address 10.1.1.6 255.255.255.0 
#
value-added-service enable
#
radius-server group rad_group1
 radius-server authentication 10.10.10.2 1812 weight 0
 radius-server accounting 10.10.10.2 1813 weight 0
 radius-server shared-key-cipher %^%#x*CgITP4C<font style="font-size:8pt" Face="Courier New" >~</font>;q,*+DEW'JBWe#)"Q&amp;|7bX]b:Y&lt;{w'%^%#    
#
ip pool edsg_pool bas local
 gateway 172.16.1.0 255.255.0.0
 section 0 172.16.1.0 172.16.1.255
#
aaa
 authentication-scheme auth1
  authentication-scheme radius
 accounting-scheme acct1
  accounting-mode radius
 domain domain1
  ip-pool edsg_pool
  radius-server group rad_group1
#
service-group s_1m
service-group s_2m
#
acl number 6020
 rule 10 permit ip source service-group s_1m destination ip-address 192.168.100.0 0.0.0.255
 rule 20 permit ip source ip-address 192.168.100.0 0.0.0.255 destination service-group s_1m
 #
acl number 6021
 rule 15 permit ip source service-group s_2m destination ip-address 192.168.200.0 0.0.0.255
 rule 25 permit ip source ip-address 192.168.200.0 0.0.0.255 destination service-group s_2m
#
traffic classifier c1 operator or
 if-match acl 6020
#
traffic classifier c2 operator or
 if-match acl 6021
#
traffic behavior b1
#
traffic behavior b2
#
traffic policy traffic_policy_edsg           
 share-mode
 classifier c1 behavior b1
 classifier c2 behavior b2
#
traffic-policy traffic_policy_edsg inbound
traffic-policy traffic_policy_edsg outbound
#
aaa
 authentication-scheme auth1                                                    
 #  
 accounting-scheme acct1                                                        
 #
# 
http-redirect-profile http_redirect_profile                                     
 web-server url http://www.sample.com                                              
 web-server mode post                                                           
#                                               
prepaid-profile prepaid1                                                        
 password cipher %@%##!!!!!!!!!"!!!!"!!!!(!!!!1];16qfZ81fv"uMoKKZ.1k"`AO!X2K2N.b<font style="font-size:8pt" Face="Courier New" >~</font>'NB^V!!!!!!!!!!1!!!!o/4J(q"J1F.!K9%M!6x8%@%#                               
 authentication-scheme auth1                                                    
 accounting-scheme acct1                                                        
 radius-server group rad_group1                                                     
 threshold time 60 seconds                                                      
 threshold volume 10 mbytes                                                     
#                                         
prepaid-profile prepaid2                                                        
 password cipher %@%##!!!!!!!!!"!!!!"!!!!(!!!!1];16qfZ81fv"uMoKKZ.1k"`AO!X2K2N.b<font style="font-size:8pt" Face="Courier New" >~</font>'NB^V!!!!!!!!!!1!!!!o/4J(q"J1F.!K9%M!6x8%@%#                               
 authentication-scheme auth1                                                    
 accounting-scheme acct1                                                        
 radius-server group rad_group1                                                     
 threshold time 300 seconds                                                     
 threshold volume 20 mbytes                                                     
 quota-out redirect http_redirect_profile                                       
#                              
service-policy download local radius rad_group1 password cipher %@%##!!!!!!!!!"!!!!"!!!!(!!!!1];16qfZ81fv"uMoKKZ.1k"`AO!X2K2N.b<font style="font-size:8pt" Face="Courier New" >~</font>'NB^V!!!!!!!!!!1!!!!o/4J(q"J1F.!K9%M!6x8%@%#
#
service-policy name service_edsg1 edsg
 radius-server group rad_group1
 service-group s_1m
 authentication-scheme auth1
 accounting-scheme acct1
 rate-limit cir 1000 inbound
 rate-limit cir 1000 outbound
 prepaid-profile prepaid1
#
service-policy name service_edsg2 edsg
 radius-server group rad_group1
 service-group s_2m
 authentication-scheme auth1
 accounting-scheme acct1
 rate-limit cir 2000 inbound
 rate-limit cir 2000 outbound
 prepaid-profile prepaid2
#
interface Virtual-Template 1
#
interface <span>GigabitEthernet</span><span>0/1/2</span>.1
 pppoe-server bind virtual-template 1
 user-vlan 1000 2000
 user-vlan 1 1000 qinq 100
 bas
 #
  access-type layer2-subscriber default-domain pre-authentication domain1
  authentication-method ppp web  
#
 return </pre>
</li><li><p><span class="keyword">Device</span> B configuration file</p>
<pre class="screen">#
 sysname <span class="keyword">Device</span>B
#
 bfd
#
ip pool hsi-main bas local 
 gateway 2.2.2.2 255.255.255.0 
 section 0 2.2.2.3 2.2.2.254 
#
ip pool hsi-bak bas <span>local </span>rui-slave 
 gateway 1.1.1.1 255.255.255.0
 # LOCAL
   section 0 1.1.1.2 1.1.1.254
 # REMOTE
   dhcp-server group gm1
#
aaa
 domain userdomain1 
 authentication-scheme default0 
 accounting-scheme default0 
#
bfd bfd bind peer-ip 10.0.1.1 
 discriminator local 2 
 discriminator remote 1 
 commit 
#
interface gigabitethernet <span>0/1/0</span>.2 
 vlan-type dot1q 200 
 ip address 10.0.1.2 255.255.255.0 
 vrrp vrid 1 virtual-ip 10.0.1.100 
 admin-vrrp vrid 1 
 vrrp vrid 1 track bfd-session 2 peer 
 vrrp vrid 1 track interface gigabitethernet <span>0/2/0</span> reduced 50
 vrrp recover-delay 20
#
remote-backup-service service1 
 peer 22.22.22.22 source 88.88.88.88 port 2046 
 track interface gigabitethernet <span>0/2/0</span>  
 ip-pool hsi-main 
 ip-pool hsi-main-bak
 protect redirect ip-nexthop 10.1.1.6 interface gigabitethernet <span>0/3/0</span>
#
remote-backup-profile profile1 
 peer-backup hot 
 service-type bras
 backup-id 10 remote-backup-service service1 
 peer-backup hot 
 vrrp-id 1 interface gigabitethernet <span>0/1/0</span>.2 
 ip-pool hsi include hsi-bak node 5
 ip-pool hsi-main include hsi-main-bak node 10
#
interface gigabitethernet <span>0/1/0</span>.1
 user-vlan 50 
 remote-backup-profile profile1 
 bas 
 access-type layer2-subscriber 
 authentication-method  web 
 vlan-type dot1q 1
 ip address 192.168.100.1 255.255.255.0
#
interface gigabitethernet <span>0/3/0</span>
 undo shutdown 
 ip address 10.1.1.7 255.255.255.0 #
value-added-service enable
#
radius-server group rad_group1
 radius-server authentication 10.10.10.2 1812 weight 0
 radius-server accounting 10.10.10.2 1813 weight 0
 radius-server shared-key-cipher %^%#x*CgITP4C<font style="font-size:8pt" Face="Courier New" >~</font>;q,*+DEW'JBWe#)"Q&amp;|7bX]b:Y&lt;{w'%^%#    
#
ip pool edsg_pool bas local
 gateway 172.16.1.0 255.255.0.0
 section 0 172.16.1.0 172.16.1.255
#
aaa
 authentication-scheme auth1
  authentication-scheme radius
 accounting-scheme acct1
  accounting-mode radius
 domain domain1
  ip-pool edsg_pool
  radius-server group rad_group1
#
service-group s_1m
service-group s_2m
#
acl number 6020
 rule 10 permit ip source service-group s_1m destination ip-address 192.168.100.0 0.0.0.255
 rule 20 permit ip source ip-address 192.168.100.0 0.0.0.255 destination service-group s_1m
 #
acl number 6021
 rule 15 permit ip source service-group s_2m destination ip-address 192.168.200.0 0.0.0.255
 rule 25 permit ip source ip-address 192.168.200.0 0.0.0.255 destination service-group s_2m
#
traffic classifier c1 operator or
 if-match acl 6020
#
traffic classifier c2 operator or
 if-match acl 6021
#
traffic behavior b1
#
traffic behavior b2
#
traffic policy traffic_policy_edsg           
 share-mode
 classifier c1 behavior b1
 classifier c2 behavior b2
#
traffic-policy traffic_policy_edsg inbound
traffic-policy traffic_policy_edsg outbound
#
aaa
 authentication-scheme auth1                                                    
 #  
 accounting-scheme acct1                                                        
 #
# 
http-redirect-profile http_redirect_profile                                     
 web-server url http://www.sample.com                                              
 web-server mode post                                                           
#                                               
prepaid-profile prepaid1                                                        
 password cipher %@%##!!!!!!!!!"!!!!"!!!!(!!!!1];16qfZ81fv"uMoKKZ.1k"`AO!X2K2N.b<font style="font-size:8pt" Face="Courier New" >~</font>'NB^V!!!!!!!!!!1!!!!o/4J(q"J1F.!K9%M!6x8%@%#   
 authentication-scheme auth1                                                    
 accounting-scheme acct1                                                        
 radius-server group rad_group1                                                     
 threshold time 60 seconds                                                      
 threshold volume 10 mbytes                                                     
#                                         
prepaid-profile prepaid2                                                        
 password cipher %@%##!!!!!!!!!"!!!!"!!!!(!!!!1];16qfZ81fv"uMoKKZ.1k"`AO!X2K2N.b<font style="font-size:8pt" Face="Courier New" >~</font>'NB^V!!!!!!!!!!1!!!!o/4J(q"J1F.!K9%M!6x8%@%#  
 authentication-scheme auth1                                                    
 accounting-scheme acct1                                                        
 radius-server group rad_group1                                                     
 threshold time 300 seconds                                                     
 threshold volume 20 mbytes                                                     
 quota-out redirect http_redirect_profile                                       
#                              
service-policy download local radius rad_group1 password cipher %@%##!!!!!!!!!"!!!!"!!!!(!!!!1];16qfZ81fv"uMoKKZ.1k"`AO!X2K2N.b<font style="font-size:8pt" Face="Courier New" >~</font>'NB^V!!!!!!!!!!1!!!!o/4J(q"J1F.!K9%M!6x8%@%#
#
service-policy name service_edsg1 edsg
 radius-server group rad_group1
 service-group s_1m
 authentication-scheme auth1
 accounting-scheme acct1
 rate-limit cir 1000 inbound
 rate-limit cir 1000 outbound
 prepaid-profile prepaid1
#
service-policy name service_edsg2 edsg
 radius-server group rad_group1
 service-group s_2m
 authentication-scheme auth1
 accounting-scheme acct1
 rate-limit cir 2000 inbound
 rate-limit cir 2000 outbound
 prepaid-profile prepaid2
#
interface Virtual-Template 1
#
interface <span>GigabitEthernet</span><span>0/1/2</span>.1
 pppoe-server bind virtual-template 1
 user-vlan 1000 2000
 user-vlan 1 1000 qinq 100
 bas
 #
  access-type layer2-subscriber default-domain pre-authentication domain1
  authentication-method ppp web  
#
 return </pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0050.html">Configuration Examples
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_rui_edsg_cfg_001.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_cfg_rui_0057.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>