
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring HTTPS Redirect for Web Authentication">
<meta name="abstract" content="This section describes how to configure a BRAS to redirect HTTPS access requests.">
<meta name="description" content="This section describes how to configure a BRAS to redirect HTTPS access requests.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipox_cfg_0003.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipox_cfg_0037.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipox_cfg_0005.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,z00603461,w00800033,z00588052,w00556928,l00593348,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPoE">
<meta name="featuretype" content="User Access">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPoE">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="IPoE">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="IPoE">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0231133478">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring HTTPS Redirect for Web Authentication</title>
</head>
<body><a name="EN-US_TASK_0231133478"></a><a name="EN-US_TASK_0231133478"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring HTTPS Redirect for Web Authentication</h1>
<div class="taskbody"><p>This section describes how to configure a BRAS to redirect HTTPS access requests.</p>
<div class="context"><a name="EN-US_TASK_0231133478__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>HTTPS redirection refers to the process of redirecting users' HTTPS access requests to a specified URL during web authentication. Upon receipt of an access request packet from a client, a BRAS takes the place of the website to establish a TCP connection with the client. The BRAS then completes SSL handshake negotiation using the specified encryption algorithm and key, and returns an HTTPS redirection packet carrying the redirect URL to the client. In this way, the client is redirected to the specified URL, and HTTPS redirection is complete. After the web authentication server is configured, you can perform the following operations on the BRAS to implement HTTPS redirection.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>When using HTTPS redirection, pay attention to the following points. Otherwise, the web authentication page may not be displayed on the client.</p>
<ul><li>When a user accesses an HTTPS website to trigger web authentication, the browser displays a security warning. The user needs to click <strong>Continue</strong> to complete web authentication. Otherwise, the web authentication page is not displayed.</li><li>The browser or website that runs the HTTP Strict Transport Security (HSTS) protocol cannot perform HTTPS redirection.</li><li>HTTPS redirection supports request packets whose destination port is the well-known port 443. If the destination port is not 443, HTTPS redirection cannot be performed.</li><li>HTTPS redirection supports TLS1.2 and TLS1.3, but does not support versions earlier than TLS1.2.</li></ul>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0231133478__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure HTTPS redirection so that online users can be redirected to a web authentication page.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <strong><a href="cmdqueryname=traffic+behavior"><b><span class="cmdname">traffic behavior</span></b></a></strong> <em><i><span class="varname">behavior-name</span></i></em></span><p><p>A traffic behavior is configured, and the traffic behavior view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=https-redirect"><b><span class="cmdname">https-redirect</span></b></a></span><p><p>HTTPS redirection is configured so that online users can be redirected to a web authentication page.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li></ol>
<p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Before the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command is run, you need to complete the basic configuration for user access. In addition, the configured traffic behavior must be added to the corresponding traffic policy, which must be applied globally.</p>
</div></div>
</p></li><li><span>Enable HTTPS redirection and configure a cipher suite.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=access+https-redirect"><b><span class="cmdname">access https-redirect</span></b></a></span><p><p>HTTPS redirection is enabled, and its view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <strong><a href="cmdqueryname=cipher-suite+support"><b><span class="cmdname">cipher-suite support</span></b></a> </strong><em><i><span class="varname">suite-code</span></i></em> &amp;&lt;1-6&gt;</span><p><p>A cipher suite supported by HTTPS redirection is configured.</p>
</p><p><p>For security purposes, you are advised not to use weak security algorithms. If you have to use a weak security algorithm, run the <a href="cmdqueryname=undo+crypto+weak-algorithm+disable"><b><span class="cmdname">undo crypto weak-algorithm disable</span></b></a> command to enable it first.</p>
<p>If a self-signed ECDSA certificate is used, set the IANA code of the cipher suite to c02b.</p>
</p></li></ol>
</li><li><span>Configure a self-signed certificate or import a certificate.</span><p><p>You can either configure a self-signed certificate or import a certificate. If neither of them exists, the HTTPS redirection function is unavailable.</p>
</p><p><ul><li>Configure a self-signed certificate.<ol type="a"><li>Run <a href="cmdqueryname=self-signed+rsa+modulus"><b><span class="cmdname">self-signed rsa modulus</span></b></a> <em><i><span class="varname">number</span></i></em> or <a href="cmdqueryname=self-signed+ecdsa+modulus"><b><span class="cmdname">self-signed ecdsa modulus</span></b></a> <em>number</em><p>A self-signed RSA or ECDSA certificate is generated for HTTPS interaction with the client.</p>
<p>The self-signed ECDSA certificate is more secure than the self-signed RSA certificate. As such, using the self-signed ECDSA certificate is recommended.</p>
</li><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>Return to the system view.</p>
</li></ol>
</li></ul>
</p><p><ul><li>Import a certificate.<ol type="a"><li>Run <strong>access https-redirect import certificate</strong><strong> </strong><em>certificate-file-name</em><strong> <strong><span>key</span></strong></strong> { <strong>der</strong> <em>der-file-name</em> | <strong>pem</strong><em> <i><span class="varname">pem-file-name</span></i></em><strong> <strong><span>password</span></strong></strong><em> <i><span class="varname">password</span></i></em> }<p>A certificate and the private key are imported for the HTTPS interaction with the client.</p>
</li><li>(Optional) Run <strong>access https-redirect delete certificate</strong><p>The imported certificate and private key are deleted. In this case, if the BRAS has been configured with a self-signed RSA certificate, this certificate is used instead. If the BRAS has not been configured with a self-signed RSA certificate, you must either configure such a self-signed RSA certificate or import another certificate and the private key.</p>
</li></ol>
</li><li>Obtain the certificate and private key in the PKI domain.<ol type="a"><li>Run <a href="cmdqueryname=pki+domain"><b><span class="cmdname">pki domain</span></b></a> <em><i><span class="varname">domain-name</span></i></em><p>A PKI domain is created.</p>
</li><li>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a><p>The configuration is committed.</p>
</li><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>Return to the system view.</p>
</li><li>Run <a href="cmdqueryname=access+https-redirect"><b><span class="cmdname">access https-redirect</span></b></a><p>The HTTPS redirection view is displayed.</p>
</li><li>Run <a href="cmdqueryname=pki-domain"><b><span class="cmdname">pki-domain</span></b></a> <i><span class="varname">pki-domain-name</span></i><p>The PKI domain is bound. The device then obtains the certificate and private key in the PKI domain and exchanges HTTPS packets with the client.</p>
</li></ol>
</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>Using an imported certificate is recommended. If a self-signed RSA certificate already exists when a certificate is being imported, the BRAS uses the imported certificate by default and will not delete the existing self-signed RSA certificate.</li><li>If a certificate and the private key have been imported, you can still configure a self-signed RSA certificate but this certificate will not take effect. For the self-signed RSA certificate to take effect, run the <strong>access https-redirect delete certificate</strong> command to delete the imported certificate and private key.</li><li>After obtaining the certificate and private key in a PKI domain, you need to unbind the PKI domain from the HTTPS redirection view before running the <a href="cmdqueryname=access+https-redirect+import+certificate"><b><span class="cmdname">access https-redirect import certificate</span></b></a> command to import the certificate and private key. You are advised to use the PKI domain to obtain the certificate and private key in the domain to enable HTTPS redirection.</li></ul>
</div></div>
</p></li><li><span>(Optional) Enable the function to insert a JavaScript during HTTPS redirection.</span><p><ol type="a"><li>Run <a href="cmdqueryname=access+https-redirect"><b><span class="cmdname">access https-redirect</span></b></a><p>The HTTPS redirection view is displayed.</p>
</li><li>Run <a href="cmdqueryname=js+enable"><b><span class="cmdname">js enable</span></b></a><p>The function to insert a JavaScript during HTTPS redirection is enabled.</p>
</li></ol>
</p></li><li><span>(Optional) Configure blacklist parameters for HTTPS redirection.</span><ol type="a"><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=blacklist+packet-rate"><b><span class="cmdname">blacklist packet-rate</span></b></a> <em><i><span class="varname">packet-rate</span></i></em></span><p><p>The maximum number of times a user can use HTTPS to visit a destination address is configured. If the number of times a user uses HTTPS to visit a destination address exceeds the upper limit, the destination address will be added to the HTTPS redirection blacklist.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=blacklist+retry-times"><b><span class="cmdname">blacklist retry-times</span></b></a> <em><i><span class="varname">retry-times</span></i></em> <strong><strong><span>interval</span></strong></strong> <em><i><span class="varname">interval</span></i></em></span><p><p>The maximum number of times a destination address can be added to the cache blacklist and the detection interval are configured.</p>
</p></li><li class="substepexpand"><span>(Optional) Delete IP addresses from the HTTPS redirection blacklist.</span><p><p>You can manually delete an IP address from the HTTPS redirection blacklist or configure the device to delete an IP address from the HTTPS redirection blacklist after the aging time expires.</p>
</p><p><ul><li>Run <strong><a href="cmdqueryname=delete+blacklist+ip"><b><span class="cmdname">delete blacklist ip</span></b></a> </strong>{ <em>ip-address</em> | <strong>all</strong> } or <strong><a href="cmdqueryname=delete+blacklist+ipv6"><b><span class="cmdname">delete blacklist ipv6</span></b></a> </strong>{ <em>ipv6-address</em> | <strong>all</strong> }<p>The IP address which incorrectly matches the HTTPS redirection blacklist is deleted.</p>
</li><li>Run <a href="cmdqueryname=blacklist+aging-time"><b><span class="cmdname">blacklist aging-time</span></b></a> <em>aging-time</em><p>The aging time of an IP address in the HTTPS redirection blacklist is configured. After the aging time expires, the IP address is deleted from the blacklist.</p>
</li></ul>
</p></li></ol>
<p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The blacklist function can be configured only after the function to insert a JavaScript during HTTPS redirection is enabled using the <strong>js enable</strong> command.</p>
</div></div>
</p></li><li><span>(Optional) Configure the HTTPS chasten function.</span><p><p>The HTTPS chasten function suppresses flow creation during HTTPS redirection, allowing the device to correctly identify the HTTPS flows that can be successfully redirected. In this way, the device can implement HTTPS redirection and prevent users from occupying too many resources. It is recommended that the HTTPS chasten function be used together with the blacklist function. If they are not used together, users may be incorrectly restricted by the HTTPS chasten function.</p>
</p><ol type="a"><li class="substepexpand"><span>Configure the HTTPS chasten function.</span><p><p>You can configure either or both of the HTTPS flow number limiting and packet number limiting functions.</p>
</p><p><ul><li>To configure the number of seconds during which an HTTPS redirection user is blocked because the number of TCP SYN packets received by the user for HTTPS flow creation exceeds a specified threshold within the specified time, run the <a href="cmdqueryname=chasten+flow"><b><span class="cmdname">chasten flow</span></b></a> <i><span class="varname">connection-sessions</span></i> <i><span class="varname">connection-period</span></i> <i><span class="varname">blocking-period</span></i> <i><span class="varname">blocking-rate</span></i> [ <strong><span>slot</span></strong> <i><span class="varname">slotid</span></i> ] command. During the blocking period, the device discards the excess HTTPS TCP SYN packets.</li><li>To configure the number of seconds during which an HTTPS redirection user is blocked because the number of HTTPS redirection packets replied by the device to the user exceeds a specified threshold within the specified time, run the <a href="cmdqueryname=chasten+redirect-packet"><b><span class="cmdname">chasten redirect-packet</span></b></a> <em><i><span class="varname">send-number</span></i></em><em> <i><span class="varname">send-period</span></i></em><em> <i><span class="varname">blocking-period</span></i></em> <em>blocking-rate</em> [ <strong><strong><span>slot</span></strong></strong><em><i><span class="varname"> slotid</span></i></em> ] command. During the blocking period, the device discards the excess HTTPS TCP SYN packets.</li></ul>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=delete+chasten-user+slot"><b><span class="cmdname">delete chasten-user slot</span></b></a> <em><i><span class="varname">slotid</span></i></em> [ { <strong><strong><span>ip-address</span></strong></strong> <i><span class="varname">ip-address</span></i> | <strong><strong><span>ipv6-address</span></strong></strong><em> i<i><span class="varname">pv6-address</span></i>/<i><span class="varname">length</span></i></em> } [ <strong><strong><span>vpn-instance</span></strong></strong><em> <i><span class="varname">instance-name</span></i></em> ] ]</span><p><p>Information about the user for whom the HTTPS chasten function is enabled and a slot ID is specified is deleted, and the user is unblocked from HTTPS flow creation.</p>
</p></li></ol>
</li><li><span>(Optional) Configure the CPU usage threshold for HTTPS redirection avalanche prevention.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=aaa"><b><span class="cmdname">aaa</span></b></a></span><p><p>The AAA view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=access-speed+adjustment+system-state+threshold+https-redirect+cpu-usage+alarm"><b><span class="cmdname">access-speed adjustment system-state threshold https-redirect cpu-usage alarm</span></b></a> <em><i><span class="varname">threshold-value</span></i></em><strong><strong><span> resume</span></strong></strong><em> <i><span class="varname">threshold-value</span></i></em></span><p><p>The CPU usage threshold for decreasing the rate at which flows are created for HTTPS redirection and the CPU usage threshold for restoring the rate at which flows are created for HTTPS redirection are configured.</p>
<p>If the CPU usage is greater than the alarm threshold, the device decreases the rate at which flows are created for HTTPS redirection. If the CPU usage falls below the alarm clearance threshold, the device restores the rate at which flows are created for HTTPS redirection.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipox_cfg_0003.html">Configuring an Authentication Mode for IPoE Access
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipox_cfg_0037.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipox_cfg_0005.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>