
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Automatic User Login">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_aaa_cfg_0270.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_aaa_cfg_0015.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_aaa_cfg_0551.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00588052,w00437000,w00606909,w00447999">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="AAA (Access User)">
<meta name="featurename" content="PPPoE">
<meta name="featuretype" content="User Access">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="AAA (Access User)">
<meta name="featurename" content="PPPoE">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="AAA (Access User)">
<meta name="featurename" content="PPPoE">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="AAA (Access User)">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="z00588052,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172373736">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Automatic User Login</title>
</head>
<body><a name="EN-US_TASK_0172373736"></a><a name="EN-US_TASK_0172373736"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">Configuring Automatic User Login</h1>




<div class="taskbody"><p></p>

<div class="context"><a name="EN-US_TASK_0172373736__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>In a Dynamic Host Configuration
Protocol version 4 (DHCPv4) user access scenario, when the <span class="keyword">Router</span> is restarted or its board, subcard, or interface is faulty, DHCPv4
users are logged out and their information is lost. If a DHCPv4 client
does not detect the fault, the DHCPv4 client does not resend a DHCP
request packet to the <span class="keyword">Router</span> or redial up after the fault is rectified. As a result, the DHCPv4
user cannot go online again. To prevent this issue, configure automatic
user login. After this configuration, user information is saved automatically
to the memory before any fault occurs, and the users can go online
automatically after the fault is rectified.</p>
<p>If the <span class="keyword">Router</span> is powered off and restarted, user information saved in the high-end
memory will be lost. Before the <span class="keyword">Router</span> is powered off, write the user information saved in the high-end
memory to the CF card. After the <span class="keyword">Router</span> is restarted, restore the user information saved in the CF card
to the high-end memory.</p>
<div class="p"><div class="note" id="EN-US_TASK_0172373736__en-us_cliref_0172385162_note222289776214553"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172373736__en-us_cliref_0172385162_p1550203099214553">The following DHCPv4 user information is saved: MAC address, IP address, VLAN/PVC, access interface, VPN instance name, domain name, lease, Option 82, Option 60, Option 61, and IP address of the DHCPv4 server. The DHCPv4 user information is used only when the DHCPv4 users go online automatically. To ensure security, do not save DHCPv4 user information in the CF card for a long time and clear it in time.</p>
</div></div>
</div>
</div></div>

<div class="steps"><a name="EN-US_TASK_0172373736__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol>
<li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span>
<p><p>The system view is displayed.</p>
</p>
</li>
<li><span>Run <span><a href="cmdqueryname=access-user+dhcp+auto-save+enable"><b><span class="cmdname">access-user dhcp auto-save enable</span></b></a> <strong><span>max-user-number</span></strong> <i><span class="varname">max-user-number</span></i></span></span>
<p><p>Automatic backup of DHCPv4 user information is enabled globally,
and the maximum number of DHCPv4 users whose information can be backed
up in all domains is specified.</p>
</p>
<p><div class="p"><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The device backs up only information about the configured maximum number of DHCPv4 users in all domains. The excessive part of DHCPv4 user information is not backed up. Specify <i><span class="varname" id="EN-US_TASK_0172373736__en-us_cliref_0172385157_varname1900106274214553">max-user-number</span></i> as the total number of DHCPv4 users whose information needs to be backed up in all domains.</p>
<p>The <b><span class="cmdname" id="EN-US_TASK_0172373736__en-us_cliref_0172385157_cmdname2042787607214553">access-user dhcp auto-save</span></b> command applies for a memory space based on the maximum number of DHCPv4 users. If the command cannot apply for the size of contiguous memory space, the command fails to be executed, and automatic backup of DHCPv4 user information is disabled.</p>
</div></div>
</div>
</p>
</li>
<li><span>Run <span><a href="cmdqueryname=aaa"><b><span class="cmdname">aaa</span></b></a></span></span>
<p><p>The AAA view is displayed.</p>
</p>
</li>
<li><span>Run <span><a href="cmdqueryname=domain"><b><span class="cmdname">domain</span></b></a> <em>domain-name</em></span></span>
<p><p>The AAA domain view is displayed.</p>
</p>
</li>
<li><span>Run <span><a href="cmdqueryname=access-user+dhcp+auto-save+enable"><b><span class="cmdname">access-user dhcp auto-save enable</span></b></a></span></span>
<p><p>Automatic backup of DHCPv4 user information is enabled in
the domain.</p>
</p>
<p><p>Information
about online DHCPv4 users in the domain is saved in the high-end memory,
which is a storage medium. The larger the configured maximum number
of the DHCPv4 users, the more memory space the user information takes
up. For example, information about 64000 DHCPv4 users takes up 50
MB of memory.</p>
<p>In a dual-system hot
backup scenario, DHCPv4 user information is backed up using the dual-system
hot backup mechanism, so the device does not save information about
these DHCPv4 users in the high-end memory.</p>
</p>
</li>
<li><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span>
<p><p>Return to the AAA view.</p>
</p>
</li>
<li><span>Run <span><a href="cmdqueryname=access-trigger+lease-end-time+original"><b><span class="cmdname">access-trigger lease-end-time original</span></b></a></span></span>
<p><p>The <span class="keyword">Router</span> is configured to apply the original lease time to users
that go online again after going offline abnormally.</p>
</p>
</li>
<li><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span>
<p><p>Return to the system view.</p>
</p>
</li>
<li><span>Run <span><a href="cmdqueryname=access-user+dhcp+auto-recover+enable"><b><span class="cmdname">access-user dhcp auto-recover enable</span></b></a></span></span>
<p><p>Automatic DHCPv4 user login is enabled.</p>
</p>

</li>
<li><span>(Optional) Run <a href="cmdqueryname=access-user+dhcp+auto-recover+nosend-packet"><b><span class="cmdname">access-user
dhcp auto-recover nosend-packet</span></b></a></span>
<p><p>The device is disabled from sending DHCPv4 messages to a
remote DHCPv4 server when users automatically re-log in to the device
after the device recovers from a fault. This prevents user login failures
caused by IP address conflicts.</p>
</p>
</li>
<li><span>(Optional) Run <span><a href="cmdqueryname=access-user+dhcp+auto-recover+speed"><b><span class="cmdname">access-user dhcp auto-recover speed</span></b></a> { <strong><span>slow</span></strong> | <strong><span>normal</span></strong> | <strong><span>fast</span></strong> }</span></span>
<p><p>The rate at which DHCPv4 users automatically go online after
the <span class="keyword">Router</span> recovers from a fault is configured.</p>
<ul><li><p>If <strong><span>slow</span></strong> is configured, the maximum
rate at which DHCPv4 users automatically go online after the <span class="keyword">Router</span> recovers from a fault is 100/s.</p>
</li><li><p>If <strong><span>normal</span></strong> is configured, the maximum
rate at which DHCPv4 users automatically go online after the <span class="keyword">Router</span> recovers from a fault is 300/s.</p>
</li><li><p>If <strong><span>fast</span></strong> is configured, the maximum
rate at which DHCPv4 users automatically go online after the <span class="keyword">Router</span> recovers from a fault is 500/s.</p>
</li></ul>
</p>
</li>
<li><span>To allow users to go online automatically after the <span class="keyword">Router</span> is powered off and restarted, perform the following operations additionally:</span>
<p><ol type="a"><li><p>Before the device is powered off, run <span><a href="cmdqueryname=access-user+dhcp+save-file"><b><span class="cmdname">access-user dhcp save-file</span></b></a> <i><span class="varname">file-path-name</span></i></span></p>
<p>DHCPv4 user
information saved in the high-end memory is written to the CF card,
and the directory and file name are specified.</p>
<div class="p"><div class="notice" id="EN-US_TASK_0172373736__en-us_cliref_0172385162_note748071244214553"><span class="noticetitle"><img src="../../../../public_sys-resources/notice_3.0-en-us.png"> </span><div class="noticebody"><p id="EN-US_TASK_0172373736__en-us_cliref_0172385162_p1464128370214553">If there is a large amount of DHCPv4 user information saved in the high-end memory, it takes a long time for the <b><span class="cmdname" id="EN-US_TASK_0172373736__en-us_cliref_0172385162_cmdname746163201214553">access-user dhcp save-file</span></b> command to write the information to the CF card, which may affect services. Exercise caution when you run this command.</p>
</div></div>
</div>
</li><li><p>After the device is restarted, run <span><a href="cmdqueryname=access-user+dhcp+recover-file"><b><span class="cmdname">access-user dhcp
recover-file</span></b></a> <i><span class="varname">file-path-name</span></i></span></p>
<p>DHCPv4 user information saved in the CF card is restored to
the high-end memory.</p>
<p>The device reads DHCPv4 user information in the CF card and saves the information in the high-end memory. The new information does not override the original DHCPv4 user information saved in the high-end memory.</p>
</li></ol>
</p>
</li>
<li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span>
<p><p>The configuration is committed.</p>
</p>
</li>
</ol></div>

<div class="postreq"><a name="EN-US_TASK_0172373736__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+access-user+auto-save+user-info"><b><span class="cmdname">display access-user auto-save user-info</span></b></a> { <strong><span>online</span></strong> | <strong><span>wait-recover</span></strong> | <strong><span>mac-address</span></strong> <i><span class="varname">mac-address</span></i><span> [ <strong><span>interface</span></strong> { <i><span class="varname">interface-name</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> } [ <strong><span>pevlan</span></strong> <i><span class="varname">pevlan</span></i> <strong><span>cevlan</span></strong> <i><span class="varname">cevlan</span></i> ] ]</span> } command to check DHCPv4 user
information saved in the high-end memory.</p>
<p>Run the <a href="cmdqueryname=display+access-user+auto-save+statistics"><b><span class="cmdname">display
access-user auto-save statistics</span></b></a> command to check
statistics about DHCPv4 user information saved in the high-end memory
after automatic backup is enabled.</p>
</div>
</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_aaa_cfg_0270.html">Configuring and Managing Users
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_aaa_cfg_0015.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_aaa_cfg_0551.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>