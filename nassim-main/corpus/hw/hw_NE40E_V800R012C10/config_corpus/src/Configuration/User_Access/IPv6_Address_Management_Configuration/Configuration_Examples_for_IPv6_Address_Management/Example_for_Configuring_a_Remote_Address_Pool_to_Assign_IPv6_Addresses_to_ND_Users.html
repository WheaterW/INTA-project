
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a Remote Address Pool to Assign IPv6 Addresses to ND Users">
<meta name="abstract" content="This section provides an example for configuring a remote address pool to assign IPv6 addresses to ND users. A networking diagram is provided to help you understand the configuration procedure. The example covers the networking requirements, configuration roadmap, configuration procedure, and configuration files.">
<meta name="description" content="This section provides an example for configuring a remote address pool to assign IPv6 addresses to ND users. A networking diagram is provided to help you understand the configuration procedure. The example covers the networking requirements, configuration roadmap, configuration procedure, and configuration files.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipv6_address_cfg_0065.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipv6_address_cfg_0087.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,z00603461,w00800033,z00588052,c00549182,ipv6-address_ne,w00556928,l00593348,w00606909,w00447999,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPv6 Address Management">
<meta name="featuretype" content="User Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv6 Address Management">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="IPv6 Address Management">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="IPv6 Address Management">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="l00593348">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172373947">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring a Remote Address Pool to Assign IPv6 Addresses to ND Users</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172373947"></a><a name="EN-US_TASK_0172373947"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a Remote Address Pool to Assign IPv6 Addresses to ND Users</h1>
<div class="taskbody"><p>This section provides an example for configuring a remote address pool to assign IPv6 addresses to ND users. A networking diagram is provided to help you understand the configuration procedure. The example covers the networking requirements, configuration roadmap, configuration procedure, and configuration files.</p>
<div class="context"><a name="EN-US_TASK_0172373947__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>The <span class="keyword">Device</span> functions as a relay agent, and the remote DHCPv6 server assigns ND prefixes to users.</p>
<p>On the network shown in <a href="#EN-US_TASK_0172373947__fig_dc_ne_ipv6_address_cfg_008901">Figure 1</a>:</p>
<ul><li>The user accesses the <span class="keyword">Device</span> in IPoE mode through GE <span>0/1/1</span>.1, and the user belongs to the domain <strong>isp1</strong> and uses binding authentication.</li><li>The user is assigned an address on the network segment 2001:db81::/64.</li><li>RADIUS authentication and accounting are used.</li><li>The IP address of the RADIUS server is 10.6.55.55, the authentication port number is 1550, the accounting port number is 1551, the standard RADIUS protocol is used, and the key is <strong>YsHsjx_202206</strong>.</li><li>The DHCPv6 server address is 2001:db82::2:2.</li></ul>
<div class="fignone" id="EN-US_TASK_0172373947__fig_dc_ne_ipv6_address_cfg_008901"><a name="EN-US_TASK_0172373947__fig_dc_ne_ipv6_address_cfg_008901"></a><a name="fig_dc_ne_ipv6_address_cfg_008901"></a><span class="figcap"><b>Figure 1 </b>Configuring a remote address pool to assign IPv6 addresses to ND users</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interfaces 1 through 3 represent GE <span>0/1/1</span>.1, GE <span>0/1/2</span>, and GE <span>0/1/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_ne_ipv6_address_cfg_008901.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172373947__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Enable IPv6 packet forwarding on Device.</li><li>Configure AAA schemes.</li><li>Configure a RADIUS server group.</li><li>Configure a DHCPv6 server group.</li><li>Configure a remote prefix pool.</li><li>Configure a user-side remote address pool and bind the DHCPv6 server group and prefix pool to the address pool.</li><li>Configure an AAA domain to be used as the default authentication domain.</li><li>Configure interfaces.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172373947__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li>Remote IPv6 prefix pool name</li><li>Remote address pool name</li><li>IPv6 address of the next-hop relay agent</li><li>Link-address in the prefix pool</li><li>User authentication mode on <span class="keyword">Device</span>B (RADIUS authentication)</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The remote DHCPv6 server selects an address pool based on the link-address option in packets sent by the relay agent.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172373947__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure a DHCPv6 server group.</span><p><pre class="screen">&lt;<span class="keyword">Device</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>dhcpv6-server group group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-dhcpv6-server-group-group1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-dhcpv6-server-group-group1] <strong>dhcpv6-server destination 2001:db82::2:2</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-dhcpv6-server-group-group1] <strong>quit</strong></pre>
</p></li><li><span>Configure a remote prefix pool and a remote address pool.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>ipv6 prefix pre1 remote</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-ipv6-prefix-pre1] <strong>link-address 2001:db81::1/64</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-ipv6-prefix-pre1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>ipv6 pool pool1 bas remote</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-ipv6-pool-pool1] <strong>prefix pre1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-ipv6-pool-pool1] <strong>dhcpv6-server group group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-ipv6-pool-pool1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-ipv6-pool-pool1] <strong>quit</strong></pre>
</p></li><li><span>Configure a RADIUS server group on the <span class="keyword">Device</span>.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>radius-server group rd1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-radius-rd1] <strong>radius-server authentication 10.6.55.55 1550</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-radius-rd1] <strong>radius-server accounting 10.6.55.55 1551</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-radius-rd1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-radius-rd1] <strong>radius-server type standard</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-radius-rd1] <strong>radius-server shared-key-cipher YsHsjx_202206</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-radius-rd1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-radius-rd1] <strong>quit</strong></pre>
</p></li><li><span>Configure AAA schemes.</span><p><p># Configure an authentication scheme.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>aaa</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa] <strong>authentication-scheme auth1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-authen-auth1] <strong>authentication-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-authen-auth1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-authen-auth1] <strong>quit</strong></pre>
<p># Configure an accounting scheme.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa] <strong>accounting-scheme acct1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-accounting-acct1] <strong>accounting-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-accounting-acct1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-accounting-acct1] <strong>quit</strong></pre>
</p></li><li><span>Configure a domain named <strong>isp1</strong>.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa] <strong>domain isp1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-isp1] <strong>authentication-scheme auth1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-isp1] <strong>accounting-scheme acct1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-isp1] <strong>radius-server group rd1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-aaa-domain-isp1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-isp1] <strong>ipv6-pool pool1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-isp1] <strong>prefix-assign-mode unshared</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa-domain-isp1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-aaa] <strong>quit</strong></pre>
</p></li><li><span>Configure interfaces.</span><p><p># Configure a BAS interface on the <span class="keyword">Device</span>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>interface <span>GigabitEthernet</span> <span>0/1/1</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-<span>GigabitEthernet</span> <span>0/1/1</span>.1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-<span>GigabitEthernet</span> <span>0/1/1</span>.1] <strong>user-vlan 1 20</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-<span>GigabitEthernet</span> <span>0/1/1</span>.1-vlan-1-20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-<span>GigabitEthernet</span> <span>0/1/1</span>.1] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-<span>GigabitEthernet</span> <span>0/1/1</span>.1] <strong>ipv6 address auto link-local</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-<span>GigabitEthernet</span> <span>0/1/1</span>.1] <strong>bas</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-<span>GigabitEthernet</span> <span>0/1/1</span>.1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-<span>GigabitEthernet</span> <span>0/1/1</span>.1-bas] <strong>access-type layer2-subscriber default-domain authentication isp1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-<span>GigabitEthernet</span> <span>0/1/1</span>.1-bas] <strong>authentication-method-ipv6 bind</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-<span>GigabitEthernet</span> <span>0/1/1</span>.1-bas] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-<span>GigabitEthernet</span> <span>0/1/1</span>.1-bas] <strong>quit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>In binding authentication, the username is automatically generated based on the location of the <span class="keyword">NE40E</span> to which a user logs in and domain name. Therefore, configure a username based on the generation rule and configure the password <strong>vlan</strong> on the RADIUS server.</p>
</li><li><p>For details about the username format used in binding authentication, see the description of the <strong>vlanpvc-to-username</strong> command in <em><span class="keyword">HUAWEI NE40E-M2 series</span> <span class="keyword">Universal Service Router</span> Command Reference</em>.</p>
</li><li><p>The interface configurations determine whether IPoE access users use the stateless address autoconfiguration (M=0) or stateful address autoconfiguration (M=1) mode. If the M flag is 0 and the O flag is 1, clients obtain IPv6 addresses in stateless mode and other configuration information in stateful mode. </p>
</li></ul>
</div></div>
</p><p><p># Configure the interface connecting Device to the server.</p>
</p><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>interface <span>GigabitEthernet</span> <span>0/1/3</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-<span>GigabitEthernet</span><span>0/1/3</span>] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-<span>GigabitEthernet</span><span>0/1/3</span>] <strong>ipv6 address 2001:db82::2:1</strong> <strong>64</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>-<span>GigabitEthernet</span><span>0/1/3</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-<span>GigabitEthernet</span><span>0/1/3</span>] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Check information about the prefix pool named <strong>pre1</strong>. The command output shows that the prefix pool is a remote prefix pool.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>display ipv6 prefix pre1</strong></pre>
<pre class="screen">-------------------------------------------------------------
 Prefix Name        : pre1
 Prefix Index       : 5
 Prefix constant index: -
 Prefix Type        : REMOTE
 Link-Address       : 2001:db81::1
 Prefix Length      : 64
 Reserved Type      : NONE
 IfLocked           : Unlocked
 Vpn instance       : -
 Lease manage       : false
 Reserved Prefix Count: 0
 Excluded Prefix Count: 0     
------------------------------------------------------------- </pre>
<p># Check information about the address pool named <strong>pool1</strong>. The command output shows that the address pool is a user-side remote address pool and the address pool is bound to the remote prefix pool named <strong>pre1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>] <strong>display ipv6 pool pool1</strong></pre>
<pre class="screen">---------------------------------------------------------------
 Pool name          : pool1
 Pool No            : 3
 Pool constant index: -
 Pool type          : BAS REMOTE
 RUI-Flag           : -
 Preference         : 255
 Renew time         : 50
 Rebind time        : 80
 Status             : UNLOCKED
 Refresh interval   : infinite
 Used by domain     : 1
 Dhcpv6 Unicast     : disable
 Dhcpv6 rapid-commit: disable
 Dns list           : -
 Dns server master  : -
 Dns server slave   : -
 AFTR name          : -
 State              : UP
 Server down times  : 0
 ----------------------------------------------------------------------
 Prefix-Name                      Prefix-Type
 ----------------------------------------------------------------------
 pre1                             REMOTE
 --------------------------------------------------------------- </pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172373947__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><pre class="screen">#  
sysname Device                                                          
# 
radius-server group rd1
 radius-server authentication 10.6.55.55 1550 weight 0
 radius-server accounting 10.6.55.55 1551 weight 0
 radius-server shared-key-cipher %^%#vS%796FO7%C<font style="font-size:8pt" Face="Courier New" >~</font>pB%CR=q;j}gSCqR-X6+P!.DYI@)%^%#
#
dhcpv6-server group group1
 dhcpv6-server destination 2001:DB82::2:2
#
ipv6 prefix pre1 remote
link-address 2001:DB81::1/64
#
ipv6 pool pool1 bas remote
prefix pre1
dhcpv6-server group group1
#
aaa
 authentication-scheme auth1
 authentication-mode radius
#
domain isp1
  authentication-scheme auth1
  accounting-scheme acct1
  radius-server group rd1
  prefix-assign-mode unshared
  ipv6-pool pool1
#
interface <span>GigabitEthernet</span><span>0/1/1</span>.1
 statistic enable
 ipv6 enable
 ipv6 address auto link-local
 user-vlan 1 20
 bas
 #
  access-type layer2-subscriber default-domain authentication isp1
  authentication-method-ipv6 bind
 #
#
interface <span>GigabitEthernet</span><span>0/1/3</span>
 ipv6 enable
 ipv6 address 2001:DB82::2:1/64
#
return</pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipv6_address_cfg_0065.html">Configuration Examples for IPv6 Address Management
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ipv6_address_cfg_0087.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>