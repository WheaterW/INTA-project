
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Example for Connecting a BRAS User to the Internet Through a VLL">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_pppox_cfg_0183.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_pppox_cfg_0059.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_pppoe_cfg_0016.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z50024784,z00603461,w00800033,z00588052,c00549182,w00556928,l00593348,w00606909,pppoxne,w00447999,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="dcAudienceJob" content="Configuration">
<meta name="featurename" content="PPPoE Access">
<meta name="featuretype" content="User Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="PPPoE Access">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="PPPoE Access">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="PPPoE Access">
<meta name="featuretype" content="User Access">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00588052">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0172374147">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Connecting a BRAS User to the Internet Through a VLL</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CONCEPT_0172374147"></a><a name="EN-US_CONCEPT_0172374147"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Connecting a BRAS User to the Internet Through a VLL</h1>
<div><div class="section"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_CONCEPT_0172374147__fig_dc_ne_pppox_cfg_028601">Figure 1</a>, PE1, P, and PE2 form an LDP VLL backbone network. The <span class="keyword">Router</span> is PE2, which is a BRAS. The BRAS user connects to the Internet through the VLL. Two virtual interfaces VE <span>0/2/9</span> and VE <span>0/2/10</span> are created on the <span class="keyword">Router</span>. VE <span>0/2/9</span> terminates the VLL service, and VE <span>0/2/10</span>.1 functions as a BAS interface to authenticate the user. The requirements are as follows:</p>
<ul><li><p>The user belongs to the domain <strong>isp1</strong> and connects to the Internet through VE <span>0/2/10</span>.1 in PPPoEoVoQ mode.</p>
</li><li><p>The user obtains an IP address from the address pool <strong>pool1</strong>. The address segment in the address pool is 172.30.1.2-172.30.1.200.</p>
</li><li><p>RADIUS authentication and RADIUS accounting are used. The RADIUS server address is 192.168.7.249, and the authentication and accounting port numbers are 1812 and 1813, respectively. RADIUS+1.1 is used, with the key being <strong>Huawei</strong>.</p>
</li><li><p>The DNS server address is 192.168.7.252.</p>
</li><li><p>The accounting and authentication schemes are <strong>acct1</strong> and <strong>auth1</strong>, respectively.</p>
</li></ul>
<div class="fignone" id="EN-US_CONCEPT_0172374147__fig_dc_ne_pppox_cfg_028601"><a name="EN-US_CONCEPT_0172374147__fig_dc_ne_pppox_cfg_028601"></a><a name="fig_dc_ne_pppox_cfg_028601"></a><span class="figcap"><b>Figure 1 </b>Networking for connecting a BRAS user to the Internet through a VLL</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 5 in this example represent GE<span>0/2/9</span>, GE<span>0/1/0</span>, GE<span>0/2/0</span>, VE<span>0/2/9</span>, and VE<span>0/2/10</span>.1, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/dc_ne_pppox_cfg_028601.png" width="NaN" height="NaN"></span></div>
</div>
<div class="section"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure the VE interface for terminating the VLL service and the VE interface for accessing the Internet on the <span class="keyword">Router</span>. Bind the two VE interfaces to a VE-group.</p>
</li><li><p>Configure the VLL.</p>
</li><li><p>Enable VLL access.</p>
</li><li><p>Configure BRAS access on PE2, with VE <span>0/2/10</span>.1 functioning as a BAS interface.</p>
</li></ol>
</div>
<div class="section"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>VE-group number</p>
</li><li><p>MPLS LSR IDs on the PE and P routers: IP addresses of the corresponding loopback 1 interfaces</p>
</li></ul>
</div>
<div class="section"><h4 class="sectiontitle">Configuration Procedure</h4><ol><li><p>Create two VE interfaces on PE2 and bind them to a VE-group.</p>
<p># Create VE <span>0/2/9</span> for terminating the VLL service.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface virtual-ethernet<span>0/2/9</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/9</span>]<strong> ve-group 1 l2-terminate</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/9</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Create VE <span>0/2/10</span> for accessing the Internet.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface virtual-ethernet<span>0/2/10</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/10</span>]<strong> ve-group 1 l3-access</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/10</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</li><li><p>Configure the VLL.</p>
<p># Configure an IGP (for example, OSPF) on the VLL backbone.</p>
<p>When configuring OSPF, advertise the 32-bit IP addresses of the loopback interfaces on the PEs and the P.</p>
<p>For configuration details, see <a href="#EN-US_CONCEPT_0172374147__section_dc_ne_pppox_cfg_028605">Configuration Files</a> in this section.</p>
<p># Configure basic MPLS functions and LDP on the MPLS backbone.</p>
<ul><li><p>Configure PE1.</p>
</li></ul>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> mpls lsr-id 1.1.1.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-ldp]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> quit</strong></pre>
<ul><li><p>Configure the P.</p>
</li></ul>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname P</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P]<strong> mpls lsr-id 2.2.2.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-mpls]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-mpls-ldp]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P]<strong> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P]<strong> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/2/0</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/2/0</span>]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/2/0</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P-GigabitEthernet<span>0/2/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>P]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>P]<strong> quit</strong></pre>
<ul><li><p>Configure PE2.</p>
</li></ul>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> mpls lsr-id 3.3.3.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls-ldp]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> interface gigabitethernet<span>0/2/9</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/9</span>]<strong> mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/9</span>]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/9</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/9</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> quit</strong></pre>
<p># Set up a remote LDP session between the PEs.</p>
<ul><li><p>Configure PE1.</p>
</li></ul>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> mpls ldp remote-peer PE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-ldp-remote-1]<strong> remote-ip 3.3.3.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-ldp-remote-1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> quit</strong></pre>
<ul><li><p>Configure PE2.</p>
</li></ul>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> mpls ldp remote-peer PE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls-ldp-remote-1]<strong> remote-ip 1.1.1.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls-ldp-remote-1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> quit</strong></pre>
<p># Enable VLL on the PEs and create static VCs.</p>
<ul><li><p>Create an L2VC on PE1's GE <span>0/2/9</span>.1 that connects to the CE.</p>
</li></ul>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-l2vpn]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> interface gigabitethernet <span>0/2/9</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/9</span>.1]<strong> vlan-type dot1q 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/9</span>.1]<strong> mpls l2vc 3.3.3.9 101</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/9</span>.1]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/9</span>.1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> quit</strong></pre>
<ul><li><p>Create an L2VC on PE2's VE <span>0/2/9</span>.1.</p>
</li></ul>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-l2vpn]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface virtual-ethernet<span>0/2/9</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/9</span>.1]<strong> vlan-type dot1q 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/9</span>.1]<strong> mpls l2vc 1.1.1.9 101</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/9</span>.1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> quit</strong></pre>
<p># Verify the configuration.</p>
<p>Check the L2VPN connection information on the PEs. The command output on each PE shows that an L2VC has been set up and its status is up.</p>
<p>The following example uses the command output on PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> display mpls l2vc</strong></pre>
<pre class="screen">  Total ldp vc : 1     1 up       0 down</pre>
<pre class="screen"> *Client Interface     : Virtual-Ethernet<span>0/2/9</span></pre>
<pre class="screen">  Session State        : up</pre>
<pre class="screen">  AC Status            : up</pre>
<pre class="screen">  VC State             : up</pre>
<pre class="screen">  VC ID                : 101</pre>
<pre class="screen">  VC Type              : ethernet</pre>
<pre class="screen">  Destination          : 1.1.1.9</pre>
<pre class="screen">  Local VC Label       : 1025</pre>
<pre class="screen">  Remote VC Label      : 1024</pre>
<pre class="screen">  Control Word         : Disable</pre>
<pre class="screen">  Local VC MTU         : 1500</pre>
<pre class="screen">  Remote VC MTU        : 1500</pre>
<pre class="screen">  Tunnel Policy Name   : --</pre>
<pre class="screen">  Traffic Behavior Name: --</pre>
<pre class="screen">  PW Template Name     : --</pre>
<pre class="screen">  Create time          : 0 days, 0 hours, 3 minutes, 14 seconds</pre>
<pre class="screen">  UP time              : 0 days, 0 hours, 1 minutes, 48 seconds</pre>
<pre class="screen">  Last change time     : 0 days, 0 hours, 1 minutes, 48 seconds</pre>
</li><li><p>Configure BRAS access on PE2, with VE <span>0/2/10</span>.1 functioning as a BAS interface to provide Internet access services for users.</p>
<p># Configure a virtual template.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> interface virtual-template 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Template1]<strong> ppp authentication-mode chap</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Template1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
<p># Configure an authentication scheme.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> aaa</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa]<strong> authentication-scheme auth1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa-authen-auth1]<strong> authentication-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa-authen-auth1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
<p># Configure an accounting scheme.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-aaa]<strong> accounting-scheme acct1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa-accounting-acct1]<strong> accounting-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa-accounting-acct1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
<p># Configure a RADIUS server group.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> radius-server group rd1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-radius-rd1]<strong> radius-server authentication 192.168.7.249 1812</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-radius-rd1]<strong> radius-server accounting 192.168.7.249 1813</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-radius-rd1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-radius-rd1]<strong> radius-server type plus11</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-radius-rd1]<strong> radius-server shared-key-cipher Huawei</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-radius-rd1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-radius-rd1]<strong> quit</strong></pre>
<p># Configure a local address pool.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> ip pool pool1 bas local</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-ip-pool-pool1]<strong> gateway 172.30.1.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ip-pool-pool1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-ip-pool-pool1]<strong> section 0 172.30.1.2 172.30.1.200</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-ip-pool-pool1]<strong> dns-server 192.168.7.252</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ip-pool-pool1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-ip-pool-pool1]<strong> </strong><strong>quit</strong></pre>
<p># Configure a domain named <strong>isp1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>aaa</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa]<strong> domain isp1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa-domain-isp1]<strong> authentication-scheme auth1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa-domain-isp1]<strong> accounting-scheme acct1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa-domain-isp1]<strong> radius-server group rd1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa-domain-isp1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-aaa-domain-isp1] <strong>ip-pool pool1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-aaa-domain-isp1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-aaa]<strong> quit</strong></pre>
<p># Bind the virtual template to VE 5/0/1.1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface virtual-ethernet<span>0/2/10</span></strong><strong>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/10</span>.1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Virtual-Ethernet<span>0/2/10</span>.1]<strong> pppoe-server bind virtual-template 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/10</span>.1]<strong> commit</strong></pre>
<p># Configure a BAS interface.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> interface virtual-ethernet<span>0/2/10</span>.1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Virtual-Ethernet<span>0/2/10</span>.1]<strong> user-vlan 1 2 qinq 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/10</span>.1.1-vlan-1-2-QinQ-100] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Virtual-Ethernet<span>0/2/10</span>.1] <strong>bas</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Virtual-Ethernet<span>0/2/10</span>.1-bas]<strong> access-type layer2-subscriber</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/10</span>.1-bas]<strong> authentication-method ppp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/10</span>.1-bas]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Virtual-Ethernet<span>0/2/10</span>.1-bas]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Virtual-Ethernet<span>0/2/10</span>.1]<strong> quit</strong></pre>
<p># Configure an upstream interface.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>]<strong> ip address 10.1.1.2 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> commit</strong></pre>
</li></ol>
</div>
<div class="section" id="EN-US_CONCEPT_0172374147__section_dc_ne_pppox_cfg_028605"><a name="EN-US_CONCEPT_0172374147__section_dc_ne_pppox_cfg_028605"></a><a name="section_dc_ne_pppox_cfg_028605"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#</pre>
<pre class="screen"> sysname PE1</pre>
<pre class="screen">#</pre>
<pre class="screen"> mpls lsr-id 1.1.1.9</pre>
<pre class="screen"> mpls</pre>
<pre class="screen">#</pre>
<pre class="screen"> mpls l2vpn</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.1.1.1 255.255.255.0</pre>
<pre class="screen"> mpls</pre>
<pre class="screen"> mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen"> mpls ldp remote-peer PE2</pre>
<pre class="screen"> remote-ip 3.3.3.9</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/9</span>.1</pre>
<pre class="screen"> vlan-type dot1q 1</pre>
<pre class="screen"> mpls l2vc 3.3.3.9 101</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack1</pre>
<pre class="screen"> ip address 1.1.1.9 255.255.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 10.1.1.0 0.0.0.255</pre>
<pre class="screen">  network 1.1.1.9 0.0.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li></ul>
<ul><li><p>P configuration file</p>
<pre class="screen">#</pre>
<pre class="screen"> sysname P</pre>
<pre class="screen">#</pre>
<pre class="screen"> mpls lsr-id 2.2.2.9</pre>
<pre class="screen"> mpls</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.1.1.2 255.255.255.0</pre>
<pre class="screen"> mpls</pre>
<pre class="screen"> mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.2.1.1 255.255.255.0</pre>
<pre class="screen"> mpls</pre>
<pre class="screen"> mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack1</pre>
<pre class="screen"> ip address 2.2.2.9 255.255.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 10.1.1.0 0.0.0.255</pre>
<pre class="screen">  network 10.2.1.0 0.0.0.255</pre>
<pre class="screen">  network 2.2.2.9 0.0.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li></ul>
<ul><li><p>PE2 configuration file</p>
<pre class="screen">#</pre>
<pre class="screen"> sysname PE2</pre>
<pre class="screen">#</pre>
<pre class="screen">radius-server group rd1</pre>
<pre class="screen"> radius-server authentication 192.168.7.249 1645 weight 0</pre>
<pre class="screen"> radius-server accounting 192.168.7.249 1646 weight 0</pre>
<pre class="screen"> radius-server shared-key-cipher %^%#`E)v.Q@BHVzxxZ;ij{&gt;&amp;_M0!TGP7YRA@8a7mq&lt;\/%^%#</pre>
<pre class="screen"> radius-server type plus11</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls lsr-id 3.3.3.9</pre>
<pre class="screen"> mpls</pre>
<pre class="screen">#</pre>
<pre class="screen"> mpls l2vpn</pre>
<pre class="screen">#</pre>
<pre class="screen">mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen"> mpls ldp remote-peer PE1</pre>
<pre class="screen">  remote-ip 1.1.1.9</pre>
<pre class="screen">#
interface Virtual-Template1
 ppp authentication-mode chap
#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.1.1.2 255.255.255.0</pre>
<pre class="screen">#  </pre>
<pre class="screen">interface GigabitEthernet<span>0/2/9</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.2.1.2 255.255.255.0</pre>
<pre class="screen"> mpls</pre>
<pre class="screen"> mpls ldp</pre>
<pre class="screen">#</pre>
<pre class="screen">interface Virtual-Ethernet<span>0/2/9</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ve-group 1 l2-terminate</pre>
<pre class="screen">#  </pre>
<pre class="screen">interface Virtual-Ethernet<span>0/2/9</span>.1</pre>
<pre class="screen"> vlan-type dot1q 1</pre>
<pre class="screen"> mpls l2vc 1.1.1.9 101</pre>
<pre class="screen">#</pre>
<pre class="screen">interface Virtual-Ethernet<span>0/2/10</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ve-group 1 l3-access</pre>
<pre class="screen">#</pre>
<pre class="screen">interface Virtual-Ethernet<span>0/2/10</span>.1</pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"><strong> </strong>pppoe-server bind virtual-template 1</pre>
<pre class="screen"> user-vlan 1 2 qinq 1</pre>
<pre class="screen"> bas</pre>
<pre class="screen">  access-type layer2-subscriber</pre>
<pre class="screen">#</pre>
<pre class="screen">interface LoopBack1</pre>
<pre class="screen"> ip address 3.3.3.9 255.255.255.255</pre>
<pre class="screen">#  </pre>
<pre class="screen">ip pool pool1 bas local</pre>
<pre class="screen"> gateway 172.30.1.1 255.255.255.0</pre>
<pre class="screen"> section 0 172.30.1.2 172.30.1.200</pre>
<pre class="screen"> dns-server 192.168.7.252</pre>
<pre class="screen">#</pre>
<pre class="screen">aaa</pre>
<pre class="screen">authentication-scheme auth1</pre>
<pre class="screen"> authentication-mode radius</pre>
<pre class="screen">accounting-scheme acct1</pre>
<pre class="screen"> accounting-mode radius</pre>
<pre class="screen"> domain isp1</pre>
<pre class="screen">  authentication-scheme auth1</pre>
<pre class="screen">  accounting-scheme acct1</pre>
<pre class="screen">  radius-server group rd1</pre>
<pre class="screen">  ip-pool pool1</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 10.2.1.0 0.0.0.255</pre>
<pre class="screen">  network 3.3.3.9 0.0.0.0  </pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_pppox_cfg_0183.html">PPPoE Access Configuration Examples
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_pppox_cfg_0059.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_pppoe_cfg_0016.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>