
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring EVPN Route Flapping Suppression">
<meta name="abstract" content="Configuring EVPN route flapping suppression helps mitigate the impact of EVPN route instability on running services.">
<meta name="description" content="Configuring EVPN route flapping suppression helps mitigate the impact of EVPN route instability on running services.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_labelfree.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_nexthop_recursive-lookup.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00878323">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0317867994">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring EVPN Route Flapping Suppression</title>
</head>
<body><a name="EN-US_TASK_0317867994"></a><a name="EN-US_TASK_0317867994"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring EVPN Route Flapping Suppression</h1>
<div class="taskbody"><p>Configuring EVPN route flapping suppression helps mitigate the impact of EVPN route instability on running services.</p>
<div class="context"><a name="EN-US_TASK_0317867994__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>Route flapping is a major symptom of EVPN route instability. When an EVPN route flaps, it repeatedly disappears from the routing table and then reappears. EVPN route flapping consumes lots of bandwidth and CPU resources and even affects the normal network operation in extreme cases.</p>
<p>EVPN supports EVPN route flapping suppression through route dampening, which uses a penalty value to reflect the stability of an EVPN route. When an EVPN route flaps, it is assigned a penalty value. A greater number of flapping times indicates a larger penalty value. If the penalty value exceeds the preset threshold, the EVPN route is not advertised. When the penalty value decreases to the reuse threshold after a period of time, the EVPN route is re-advertised.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0317867994__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring EVPN route flapping suppression, complete one of the following tasks:</p>
<ul><li><a href="dc_vrp_evpn_cfg_0003.html">Configure EVPN VPLS over MPLS (common EVPN instance)</a>.</li><li><a href="dc_vrp_evpn_cfg_0065.html">Configure EVPN VPLS over MPLS (BD EVPN instance)</a>.</li><li><a href="dc_vrp_evpn_cfg_0020.html">Configure EVPN VPWS over MPLS</a>.</li><li><a href="dc_vrp_srv6_cfg_all_0021_copy.html">Configure EVPN VPWS over IS-IS SRv6 BE</a>.</li><li><a href="dc_vrp_srv6_cfg_all_0023_copy.html">Configure EVPN VPLS over IS-IS SRv6 BE</a>.</li><li><a href="dc_vrp_evpn_cfg_0150.html">Configure an EVPN route-policy</a></li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0317867994__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</span></li><li><span>Run the <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i> command to enter the BGP view.</span></li><li><span>Run the <a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname">l2vpn-family evpn</span></b></a> command to enter the BGP EVPN address family view.</span></li><li><span>Enable EVPN route dampening and set route dampening parameters.</span><ul><li>Run the <a href="cmdqueryname=dampening"><b><span class="cmdname">dampening</span></b></a> [ <i><span class="varname">half-life-reach</span></i> <i><span class="varname">reuse suppress</span></i> <i><span class="varname">ceiling</span></i> | [ <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> ]  ] <sup>*</sup> [ <strong><span>update-standard</span></strong> ] command to enable EBGP EVPN route dampening and set route dampening parameters.</li><li>Run the <a href="cmdqueryname=dampening"><b><span class="cmdname">dampening</span></b></a> <strong><span>ibgp</span></strong> [ <i><span class="varname">half-life-reach</span></i> <i><span class="varname">reuse suppress</span></i> <i><span class="varname">ceiling</span></i> | [ <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> ] ] <sup>*</sup> [ <strong><span>update-standard</span></strong> ] command to enable IBGP EVPN route dampening and set route dampening parameters.</li></ul>
<p><p>The <em>reuse</em>, <em>suppress</em>, and <em>ceiling</em> values must meet the following requirement: <em>reuse</em> value &lt; <em>suppress</em> value &lt; <em>ceiling</em> value.</p>
<p>After a route-policy is specified, EVPN can use different route dampening parameters to suppress different routes.</p>
</p></li><li><span>Run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configuration.</span></li></ol></div>
<div class="example"><a name="EN-US_TASK_0317867994__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After the configuration is complete, perform the following operations to verify it:</p>
<ul><li>Run the <a href="cmdqueryname=display+bgp+evpn+all+routing-table+dampening+parameter"><b><span class="cmdname">display bgp evpn all routing-table dampening parameter</span></b></a> command to check the set EVPN route dampening parameters.</li><li>Run the <a href="cmdqueryname=display+bgp+evpn"><b><span class="cmdname">display bgp evpn</span></b></a> { <strong><span>all</span></strong> | <strong><span>route-distinguisher</span></strong> <i><span class="varname">route-distinguisher</span></i> } <strong><span>routing-table</span></strong> <strong><span>flap-info</span></strong> [ <strong><span>mac-route</span></strong> | <strong><span>prefix-route</span></strong> ] command to check statistics about BGP EVPN route flapping.</li><li>Run the <a href="cmdqueryname=display+bgp+evpn"><b><span class="cmdname">display bgp evpn</span></b></a> { <strong><span>all</span></strong> | <strong><span>route-distinguisher</span></strong> <i><span class="varname">route-distinguisher</span></i> } <strong><span>routing-table</span></strong> [ <strong><span>mac-route</span></strong> | <strong><span>prefix-route</span></strong> ] <strong><span>dampened</span></strong> command to check dampened routes.</li><li>Run the <a href="cmdqueryname=display+bgp+evpn"><b><span class="cmdname">display bgp evpn</span></b></a> { <strong><span>all</span></strong> | <strong><span>route-distinguisher</span></strong> <i><span class="varname">route-distinguisher</span></i> } <strong><span>routing-table</span></strong> <strong><span>statistics</span></strong> <strong><span>dampened</span></strong> command to check statistics about dampened EVPN routes.</li></ul>
</div>
<div class="postreq"><a name="EN-US_TASK_0317867994__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Follow-up Procedure</h4>
<div class="p"><p>To clear the dampening information about EVPN routes and release suppressed EVPN routes, run either of the following commands as needed:</p>
<ul><li><a href="cmdqueryname=reset+bgp+evpn+dampening"><b><span class="cmdname">reset bgp evpn dampening</span></b></a></li><li><a href="cmdqueryname=reset+bgp+evpn+dampening"><b><span class="cmdname">reset bgp evpn dampening</span></b></a> { <strong><span>mac-route</span></strong> | <strong><span>prefix-route</span></strong> } <i><span class="varname">prefix</span></i></li></ul>
<p>To clear statistics about EVPN route flapping, run any of the following commands as needed:</p>
<ul><li><a href="cmdqueryname=reset+bgp+evpn+flap-info"><b><span class="cmdname">reset bgp evpn flap-info</span></b></a></li><li><a href="cmdqueryname=reset+bgp+evpn+flap-info"><b><span class="cmdname">reset bgp evpn flap-info</span></b></a> { <strong><span>mac-route</span></strong> | <strong><span>prefix-route</span></strong> } <i><span class="varname">prefix</span></i></li><li><a href="cmdqueryname=reset+bgp+evpn"><b><span class="cmdname">reset bgp evpn</span></b></a> { <em>ip-address</em> | <em>peerIpv6Addr</em> } <strong><span>flap-info</span></strong></li></ul>
</div></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0000.html">EVPN Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_labelfree.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_nexthop_recursive-lookup.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>