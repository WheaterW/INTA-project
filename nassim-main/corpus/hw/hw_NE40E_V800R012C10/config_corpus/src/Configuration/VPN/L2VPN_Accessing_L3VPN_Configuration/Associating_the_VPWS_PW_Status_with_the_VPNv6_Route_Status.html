
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Associating the VPWS PW Status with the VPNv6 Route Status">
<meta name="abstract" content="Associating the VPWS PW status with the VPNv6 route status prevents traffic loss caused by a failure to detect link failures.">
<meta name="description" content="Associating the VPWS PW status with the VPNv6 route status prevents traffic loss caused by a failure to detect link failures.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2-l3_cfg_5000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2-l3_cfg_5026.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2-l3_cfg_5013.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="L2VPN Accessing L3VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="L2VPN Accessing L3VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="L2VPN Accessing L3VPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00415692">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00545680">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0272267219">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Associating the VPWS PW Status with the VPNv6 Route Status</title>
</head>
<body><a name="EN-US_TASK_0272267219"></a><a name="EN-US_TASK_0272267219"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Associating the VPWS PW Status with the VPNv6 Route Status</h1>
<div class="taskbody"><p>Associating the VPWS PW status with the VPNv6 route status prevents traffic loss caused by a failure to detect link failures.</p>
<div class="context"><a name="EN-US_TASK_0272267219__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>On the network shown in <a href="#EN-US_TASK_0272267219__fig_dc_vrp_l2-l3_cfg_502601">Figure 1</a>, a PW is established between the CSG and each AGG. PW1 is the primary PW, and PW2 is the secondary PW. A BGP VPNv6 peer relationship is established between AGG1 and RSG1, between AGG2 and RSG2, and between AGG1 and AGG2. A VE-Group consisting of one L2VE interface and one L3VE interface is configured on each AGG. The L3VE interface on an AGG is bound to the VPN instance on that AGG.</p>
<div class="fignone" id="EN-US_TASK_0272267219__fig_dc_vrp_l2-l3_cfg_502601"><a name="EN-US_TASK_0272267219__fig_dc_vrp_l2-l3_cfg_502601"></a><a name="fig_dc_vrp_l2-l3_cfg_502601"></a><span class="figcap"><b>Figure 1 </b>Associating the VPWS PW status with the VPNv6 route status</span><br><span><img class="vsd" src="figure/en-us_image_0272271851.png" width="NaN" height="NaN"></span></div>
<p>When no fault occurs, the CSG sends traffic to RSG1 through AGG1 along PW1. If both links between AGG1 and RSG1 and between AGG1 and AGG2 fail and the CSG cannot detect the link failures, the CSG still sends traffic to AGG1, and as a result, traffic loss occurs.</p>
<p>To resolve this problem, configure AGG1 to associate the PW status with the VPNv6 route status. If the link between AGG1 and RSG1 and the link between AGG1 and AGG2 fail, the VPNv6 route status becomes down. AGG1 sets the corresponding VPWS PW status to down and instructs the CSG to perform a primary/secondary PW switchover. Then, the CSG switches upstream traffic to the path CSG -&gt; AGG2 -&gt; RSG2 -&gt; RSG1, preventing traffic loss caused by the link failures.</p>
<h4 class="sectiontitle">Pre-configuration Tasks</h4><div class="p">Before associating the VPWS PW status with the VPNv6 route status, complete the following tasks:<ul><li>Configure data link layer protocol parameters and IP addresses for interfaces to ensure that the link layer protocol of each interface is up.</li><li>Configure basic MPLS functions and public network tunnels.</li><li>Configure PWE3. For configuration details, see <a href="dc_vrp_vpws_cfg_3004.html">Configuring LDP VPWS</a>.</li><li>Configure an L2VPN to access an L3VPN. For configuration details, see <a href="dc_vrp_l2-l3_cfg_5003.html">VPWS Accessing a Public Network or L3VPN</a>.</li><li>Configure BFD to detect public network link faults. For configuration details, see <a href="dc_vrp_vpws_cfg_6021.html">Configuring BFD to Detect Public Network Link Faults</a>.</li></ul>
</div>
</div>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0272267219__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure each RSG to advertise VPNv6 routes to its BGP VPNv6 peer.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=interface+loopback"><b><span class="cmdname">interface loopback</span></b></a> <i><span class="varname">loopback-number</span></i></span><p><p>The loopback interface view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ip+binding+vpn-instance"><b><span class="cmdname">ip binding vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></span><p><p>The interface is bound to a VPN instance.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv6+address"><b><span class="cmdname">ipv6 address</span></b></a> { <i><span class="varname">ipv6-address</span></i> <i><span class="varname">prefix-length</span></i> | <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">prefix-length</span></i> }</span><p><p>An IPv6 address is configured for the interface.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <em>as-number</em></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv6-family"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i></span><p><p>The BGP-VPN instance IPv6 address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=network"><b><span class="cmdname">network</span></b></a> <i><span class="varname">ipv6-address</span></i> <i><span class="varname">mask-length</span></i></span><p><p>The RSG is enabled to advertise VPNv6 routes to a corresponding AGG.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure AGG1 to associate the PW status with the VPNv6 route status.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type interface-number</span></i></span><p><p>The interface view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mpls+l2vpn+track+route"><b><span class="cmdname">mpls l2vpn track route</span></b></a> <i><span class="varname">ipv6-address</span></i> { <i><span class="varname">ipv6-mask</span></i> | <i><span class="varname">ipv6-mask-length</span></i> } <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i></span><p><p>The PW status is associated with the VPNv6 route status.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
<div class="postreq"><a name="EN-US_TASK_0272267219__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+mpls+l2vpn+track+route"><b><span class="cmdname">display mpls l2vpn track route</span></b></a> command to check information about the association between the PW status and VPNv6 route status on an AGG.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2-l3_cfg_5000.html">L2VPN Accessing L3VPN Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2-l3_cfg_5026.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l2-l3_cfg_5013.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>