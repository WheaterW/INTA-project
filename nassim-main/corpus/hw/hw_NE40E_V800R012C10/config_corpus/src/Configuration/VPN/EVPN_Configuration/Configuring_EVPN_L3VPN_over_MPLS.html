
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring EVPN L3VPN over MPLS">
<meta name="abstract" content="On DCI and IP RAN networks, you can configure EVPN L3VPN over MPLS to carry Layer 3 services.">
<meta name="description" content="On DCI and IP RAN networks, you can configure EVPN L3VPN over MPLS to carry Layer 3 services.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0090.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0152_copy.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0039.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0074.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0073.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0071.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0072.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="p00915595,w00800033,w00556928,l00468467,w00606909,evpnvrp,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="p00915595">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00878323">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172370478">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/thickbox.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/imageResize.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery-migrate-1.2.1.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery-ui.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery.mousewheel.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/thickbox.js"></script>
<title>Configuring EVPN L3VPN over MPLS</title>
</head>
<body><a name="EN-US_TASK_0172370478"></a><a name="EN-US_TASK_0172370478"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring EVPN L3VPN over MPLS</h1>
<div class="taskbody"><p>On DCI and IP RAN networks, you can configure EVPN L3VPN over MPLS to carry Layer 3 services.</p>
<div class="context"><a name="EN-US_TASK_0172370478__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>On a traditional network, BGP/MPLS IP VPN is often used to carry Layer 3 services. To additionally carry Layer 2 services, users have to deploy an L2VPN over the existing network, driving up deployment and O&amp;M costs. To address this problem, deploy EVPN L3VPN over MPLS to carry Layer 3 services. To additionally carry Layer 2 services, you only need to add some EVPN configurations, achieving unified transport of both Layer 2 and Layer 3 services.</p>
<div class="p">EVPN L3VPN over MPLS can replace BGP/MPLS IP VPN in the following scenarios to carry Layer 3 services:<ul><li><p>Intra-AS mutual VPN communication</p>
<div class="p">On the network shown in <a href="#EN-US_TASK_0172370478__fig1794292110710">Figure 1</a>, the VPNs at Site1 and Site2 need to communicate through the public MPLS network. To implement this communication, perform the following configurations:<ol><li><p>Configure an L3VPN instance on each PE to manage VPN routes.</p>
</li><li><p>Establish a BGP EVPN peer relationship between the PEs to transmit EVPN routes carrying VPN routes.</p>
</li><li><p>Establish an IGP neighbor relationship or BGP peer relationship between each PE and CE at the access side to exchange VPN routes.</p>
</li></ol>
</div>
<div class="fignone" id="EN-US_TASK_0172370478__fig1794292110710"><a name="EN-US_TASK_0172370478__fig1794292110710"></a><a name="fig1794292110710"></a><span class="figcap"><b>Figure 1 </b>Intra-AS mutual VPN communication</span><br><span><img class="vsd" src="figure/en-us_image_0000001227794701.png" width="NaN" height="NaN"></span></div>
</li><li><p>Inter-AS mutual VPN communication</p>
<div class="p">On the network shown in <a href="#EN-US_TASK_0172370478__fig163891638173">Figure 2</a>, the VPNs at Site1 and Site2 need to communicate through two public MPLS networks in different ASs. To implement this communication, perform the following configurations:<ol><li><p>Configure an L3VPN instance on each PE to manage VPN routes.</p>
</li><li><p>Establish IBGP EVPN peer relationships between PEs and ASBRs and an EBGP EVPN peer relationship between the ASBRs to transmit EVPN routes carrying VPN routes between the PEs.</p>
</li><li><p>Establish an IGP neighbor relationship or BGP peer relationship between each PE and CE at the access side to exchange VPN routes.</p>
</li></ol>
</div>
<div class="fignone" id="EN-US_TASK_0172370478__fig163891638173"><a name="EN-US_TASK_0172370478__fig163891638173"></a><a name="fig163891638173"></a><span class="figcap"><b>Figure 2 </b>Inter-AS mutual VPN communication</span><br><span><img class="vsd" src="figure/en-us_image_0000001228194751.png" width="NaN" height="NaN"></span></div>
</li><li><p>DCI network</p>
<div class="p">The EVPN function applies to traditional DCs that interconnect through a DCI network. On the network shown in <a href="#EN-US_TASK_0172370478__fig340018541475">Figure 3</a>, DC GWs and DCI-PEs are separately deployed. The DCI-PEs consider the connected DC GWs as CEs, receive VM IP routes from the DCs through a routing protocol, and save and maintain the received routes. Deploying an EVPN over the DCI backbone network allows VM IP routes to be transmitted between DCs, implementing inter-DC VM communication. To implement this communication, perform the following configurations:<ol><li><p>Configure an L3VPN instance on each PE to manage VM IP routes.</p>
</li><li><p>Establish an IBGP EVPN peer relationship between the PEs to transmit EVPN routes carrying VM IP routes.</p>
</li><li><p>Establish an IGP neighbor relationship or BGP peer relationship between each PE and DC GW to exchange VM IP routes.</p>
</li></ol>
</div>
<div class="fignone" id="EN-US_TASK_0172370478__fig340018541475"><a name="EN-US_TASK_0172370478__fig340018541475"></a><a name="fig340018541475"></a><span class="figcap"><b>Figure 3 </b>DCI network</span><br><span><img class="imgResize" src="figure/en-us_image_0000001182875002.png" width="497.42" height="347.711077" title="Click to enlarge"></span></div>
</li><li><p>L2VPN accessing L3VPN</p>
<p>In L2VPN accessing L3VPN scenarios, EVPN can be used as a substitute for BGP VPNv4 to function as the control plane of an L3VPN. For details about the method of configuring the L2VPN and stitching devices, see <a href="dc_vrp_l2-l3_cfg_5000.html">Configuring L2VPN Accessing L3VPN</a>. For details about the method of configuring the L3VPN, see the corresponding information in this section.</p>
</li></ul>
</div>
<h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring EVPN L3VPN over MPLS, complete the following tasks:</p>
<ul><li><p>Configure Layer 3 route reachability on the IPv4 network.</p>
</li></ul>
</div>
</div></div>
</div>

<ul class="ullinks">
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0039.html">Configuring an L3VPN Instance</a>
</dt>
<dd>
You can configure an L3VPN instance to store and manage received VPN routes or VM routes.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0074.html">Configuring BGP EVPN Peer Relationships</a>
</dt>
<dd>
You can configure BGP EVPN peer relationships between PEs or between PEs and ASBRs as required to exchange EVPN routes between the PEs. Additionally, you can configure BGP RRs to minimize the number of peer relationships, saving network resources.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0073.html">Configuring Route Exchange Between PEs and Access-Side Devices</a>
</dt>
<dd>
PEs and access-side devices can communicate through BGP, static routes (including default routes), or IGP. Configure route exchange between PEs and access-side devices according to the network plan.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0071.html">(Optional) Re-Encapsulating IRB (v6) Routes into the desired Routes</a>
</dt>
<dd>
If you want to convert the IRB routes carrying the network segment address of a tenant host that are received by a device into host IP prefix routes or ARP routes, <span>or convert the IRBv6 routes carrying the IPv6 network segment address of a tenant host that are received by a device into host IPv6 prefix routes or ND routes, </span>you must enable the device to re-encapsulate IRB <span>or IRBv6 </span>routes into the desired routes.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0072.html">Verifying the Configuration</a>
</dt>
<dd>
After configuring EVPN L3VPN over MPLS, verify the EVPN and VPN routes received by devices.</dd>
</dl>
</ul>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0000.html">EVPN Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0090.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0152_copy.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>

<script language="JavaScript">
<!--
image_size('.imgResize');
var msg_imageMax = "view original image";
var msg_imageClose = "close";
//--></script></body>
</html>