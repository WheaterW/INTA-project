
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Routes">
<meta name="abstract" content="DSVPN routes need to be configured appropriately to ensure the correct forwarding of mGRE-encapsulated packets.">
<meta name="description" content="DSVPN routes need to be configured appropriately to ensure the correct forwarding of mGRE-encapsulated packets.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_cfg_dsvpn_0021.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_cfg_dsvpn_0006.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_cfg_dsvpn_0008.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="dsvpn,w00800033,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="DSVPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="DSVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="DSVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="DSVPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00415692">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00830487">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369149">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring Routes</title>
</head>
<body><a name="EN-US_TASK_0172369149"></a><a name="EN-US_TASK_0172369149"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Routes</h1>
<div class="taskbody"><p>DSVPN routes need to be configured appropriately to ensure the correct forwarding of mGRE-encapsulated packets.</p>
<div class="context"><a name="EN-US_TASK_0172369149__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>The routes forwarded by a tunnel must be available on Spokes and the Hub so that mGRE-encapsulated packets can be forwarded correctly. These routes can be static routes or dynamic routes.</p>
<p>DSVPN supports the following route learning modes:</p>
<ul><li><p>Route learning between Spokes (non-shortcut)</p>
<p></p>
<p>The next-hop address of the route from the source Spoke to the destination Spoke is the tunnel address of the destination Spoke, and each Spoke needs to learn the route to the remote end. This consumes many CPU and memory resources and requires large routing tables and high performance on Spokes. In practice, the Spokes have low performance and store a limited number of routes. The route learning solution applies to small- and medium-sized networks where there are fewer network nodes and a small number of routes.</p>
<p>mGRE tunnels between Spokes are set up in non-shortcut mode.</p>
</li><li><p>Spoke routes summarized to the Hub (shortcut mode)</p>
<p>The next-hop address of the route from the source Spoke to the destination Spoke is the tunnel address of the Hub, and Spokes only need to store routes to the Hub. The number of routes of Spokes is reduced, so the route learning solution applies to large-sized networks with many Spokes.</p>
<p>mGRE tunnels between Spokes are set up in shortcut mode.</p>
</li></ul>
<p>Static routes and dynamic routing protocols can be deployed in the preceding two route learning modes. DSVPN supports OSPF and BGP.</p>
<p>Perform the following configurations on the Hub and Spokes.</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172369149__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span><strong>Configure a static route.</strong></span><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=ip+route-static"><b><span class="cmdname">ip route-static</span></b></a> <i><span class="varname">ip-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } <i><span class="varname">nexthop-address</span></i> [ <strong><span>description</span></strong> <i><span class="varname">text</span></i> ]</span></span><p><p>A static route is configured.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>When Spokes learn routes from each other, the next-hop address of the static route from a Spoke to the Hub or another Spoke is the tunnel address of the remote device.</p>
</li><li><p>When routes of Spokes are summarized to the Hub, the next-hop address of the static route from a Spoke to the Hub or another Spoke is the tunnel address of the Hub.</p>
</li></ul>
</div></div>
</p></li></ol>
</li><li><span><strong>Configuring a dynamic route</strong></span><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Configure a dynamic route.</span><p><p>Dynamic routes can be implemented using OSPF<span>, or BGP</span>. For the configuration of a dynamic routing protocol, see <i><cite>Configuration Guide - IP Routing</cite></i>.</p>
</p><p><p>When configuring dynamic routing protocols, pay attention to the following points:</p>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.2.2.2.2.3.2.1.4.1.1" liSelected="liSelected"><p>Scenario and Routing Protocol</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.2.2.2.2.3.2.1.4.1.2" liSelected="liSelected"><p>OSPF</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.2.2.2.2.3.2.1.4.1.3" liSelected="liSelected"><p>BGP</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.2.2.2.2.3.2.1.4.1.1 "><p>Non-Shortcut Scenario of DSVPN</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.2.2.2.2.3.2.1.4.1.2 "><p>Configure the OSPF network type to multicast using the <a href="cmdqueryname=ospf+network-type"><b><span class="cmdname">ospf network-type</span></b></a> <strong><span>broadcast</span></strong> command on the Hub and Spokes.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.2.2.2.2.3.2.1.4.1.3 "><p>Route aggregation cannot be configured on the Hub.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.2.2.2.2.3.2.1.4.1.1 "><p>Shortcut Scenario of DSVPN</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.2.2.2.2.3.2.1.4.1.2 "><p>Configure the OSPF network type to Point-to-Multipoint (P2MP) using the <a href="cmdqueryname=ospf+network-type"><b><span class="cmdname">ospf network-type</span></b></a> <strong><span>p2mp</span></strong> command on the Hub and Spokes.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.2.2.2.2.3.2.1.4.1.3 "><p>Configure route aggregation on the Hub.</p>
</td>
</tr>
</tbody>
</table>
</div>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_cfg_dsvpn_0021.html">Configuring DSVPN
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_cfg_dsvpn_0006.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_cfg_dsvpn_0008.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>