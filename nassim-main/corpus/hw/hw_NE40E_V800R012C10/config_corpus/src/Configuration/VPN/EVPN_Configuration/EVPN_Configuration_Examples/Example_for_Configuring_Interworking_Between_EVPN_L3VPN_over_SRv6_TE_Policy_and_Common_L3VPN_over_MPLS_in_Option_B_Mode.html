
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Interworking Between EVPN L3VPN over SRv6 TE Policy and Common L3VPN over MPLS in Option B Mode">
<meta name="abstract" content="This section describes how to configure interworking between EVPN L3VPN over SRv6 TE Policy and common L3VPN over MPLS in Option B mode.">
<meta name="description" content="This section describes how to configure interworking between EVPN L3VPN over SRv6 TE Policy and common L3VPN over MPLS in Option B mode.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0010.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dci_cfg_0036.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0221.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,f00454608,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="p00915595">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00878323">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001206731903">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Interworking Between EVPN L3VPN over SRv6 TE Policy and Common L3VPN over MPLS in Option B Mode</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001206731903"></a><a name="EN-US_TASK_0000001206731903"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Interworking Between EVPN L3VPN over SRv6 TE Policy and Common L3VPN over MPLS in Option B Mode</h1>
<div class="taskbody"><p>This section describes how to configure interworking between EVPN L3VPN over SRv6 TE Policy and common L3VPN over MPLS in Option B mode.</p>
<div class="context"><a name="EN-US_TASK_0000001206731903__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>Many metro networks deployed with L3VPN are evolving towards EVPN. If a metro network involves a large number of devices, E2E evolution may not be completed at one time. If this is the case, co-existence of L3VPN and EVPN arises. On the network shown in <a href="#EN-US_TASK_0000001206731903__fig3691666259">Figure 1</a>, EVPN is deployed between PE1 and the ASBR, and L3VPN is deployed between the ASBR and PE2. To allow communication between the L3VPN and EVPN, configure the boundary device ASBR for the two networks. The configuration of L3VPNv4 is similar to that of L3VPNv6. For details about the differences, see <a href="dc_vrp_evpn_cfg_0176.html">Configuring Interworking Between EVPN L3VPN over SRv6 TE Policy and Common L3VPN over MPLS in Option B Mode</a>. This section uses L3VPNv4 as an example.</p>
<div class="fignone" id="EN-US_TASK_0000001206731903__fig3691666259"><a name="EN-US_TASK_0000001206731903__fig3691666259"></a><a name="fig3691666259"></a><span class="figcap"><b>Figure 1 </b>Configuring interworking between EVPN L3VPN over SRv6 TE Policy and L3VPN over MPLS</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent GE<span>0/1/0</span> and GE<span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001161493404.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001206731903__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Deploy an IGP between PE1 and the ASBR and between the ASBR and PE2. IS-IS is used in this example.</li><li>Configure an IPv4 L3VPN instance on each PE and bind the local access-side interface to the IPv4 L3VPN instance.</li><li>Configure EVPN L3VPN over SRv6 TE Policy on PE1 and the ASBR.</li><li>Configure MPLS LDP on the ASBR and PE2.</li><li>Configure L3VPN instances and BGP VPNv4 on the ASBR and PE2.</li><li><p>Establish an EBGP peer relationship between each PE and its connected CE.</p>
</li><li>Configure route import between address families and a tunnel selector on the ASBR.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001206731903__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IP addresses of interfaces on PE1, the ASBR, and PE2.</p>
</li><li><p>IS-IS process ID on PE1, the ASBR, and PE2</p>
</li><li><p>IS-IS level of PE1, the ASBR, and PE2</p>
</li><li><p>VPN instance names, RDs, and RTs on PE1 and PE2</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001206731903__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure interface IP addresses, including loopback interface addresses, on PE1, the ASBR, PE2, CE1, and CE2.</span><p><p>Configure interface IP addresses and masks. For detailed configurations, see <a href="#EN-US_TASK_0000001206731903__example121226172748">Configuration Files</a>.</p>
</p></li><li><span>Deploy an IGP between PE1 and the ASBR and between the ASBR and PE2. IS-IS is used in this example.</span><p><p>Configure IS-ISv6 between PE1 and the ASBR (EVPN) to ensure IPv6 route reachability, and configure IS-IS between the ASBR and PE2 (L3VPN) to ensure IPv4 route reachability. For detailed configurations, see <a href="#EN-US_TASK_0000001206731903__example121226172748">Configuration Files</a>.</p>
</p></li><li><span>Configure IPv4 L3VPN instances on PE1 and PE2 and bind physical interfaces to these instances for the access of Layer 3 services.</span><p><p>For detailed configurations, see <a href="#EN-US_TASK_0000001206731903__example121226172748">Configuration Files</a>.</p>
</p></li><li><span>Perform the following steps on PE1 and the ASBR to configure EVPN L3VPN over SRv6 TE Policy.</span><p><ol type="a"><li>Configure BGP EVPN and establish a BGP EVPN peer relationship between PE1 and the ASBR.</li><li>Configure SRv6 SIDs and IS-IS SRv6 capabilities, and configure VPN routes to carry SIDs.</li><li>Configure an SRv6 TE Policy and then a tunnel policy to import VPN traffic.</li></ol>
<p>For detailed configurations, see <a href="#EN-US_TASK_0000001206731903__example121226172748">Configuration Files</a>.</p>
</p></li><li><span>Configure MPLS LDP on the ASBR and PE2.</span><p><p>For detailed configurations, see <a href="#EN-US_TASK_0000001206731903__example121226172748">Configuration Files</a>.</p>
</p></li><li><span>Configure L3VPN instances and BGP VPNv4 on the ASBR and PE2.</span><p><p>For detailed configurations, see <a href="#EN-US_TASK_0000001206731903__example121226172748">Configuration Files</a>.</p>
</p></li><li><span>Establish an EBGP peer relationship between each PE and its connected CE.</span><p><p># Configure CE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong>interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-LoopBack1] <strong>ip address 10.1.1.1 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-LoopBack1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>bgp 65410</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-bgp] <strong>peer 10.11.1.1 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-bgp] <strong>import-route direct</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>commit</strong></pre>
<p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp] <strong>ipv4-family vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-vpna] <strong>peer 10.11.1.2 as-number 65410</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-vpna] <strong>import-route direct</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-vpna] <strong>advertise l2vpn evpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bgp-vpna] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp-vpna] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp] <strong>quit</strong></pre>
<p># Configure CE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2] <strong>interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-LoopBack1] <strong>ip address 10.1.4.1 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-LoopBack1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>bgp 65420</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-bgp] <strong>peer 10.22.1.1 as-number 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-bgp] <strong>import-route direct</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>bgp 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp] <strong>ipv4-family vpn-instance vpna</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-vpna] <strong>peer 10.22.1.2 as-number 65420</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-vpna] <strong>import-route direct</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bgp-vpna] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-bgp-vpna] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-bgp] <strong>quit</strong></pre>
<p>After the configuration is complete, run the <strong>display bgp vpnv4 vpn-instance peer</strong> command on each PE to check whether a BGP peer relationship has been established between the PE and its connected CE. If the <strong>Established</strong> state is displayed in the command output, the BGP peer relationship has been established successfully.</p>
<p>The following example uses the peer relationship between PE1 and CE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>display bgp vpnv4 vpn-instance vpna peer</strong>
 BGP local router ID : 1.1.1.1                                                  
 Local AS number : 100      

 VPN-Instance vpna, Router ID 1.1.1.1:                                          
 Total number of peers : 1                 Peers in established state : 1       

  Peer            V          AS  MsgRcvd  MsgSent  OutQ  Up/Down       State  PrefRcv          
  10.11.1.2       4       65410       48       51     0 00:39:40 <strong>Established</strong>        2 </pre>
</p></li><li><span>Configure route import between address families and a tunnel selector on the ASBR.</span><p><p># Configuring route import between address families.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-bgp] <strong>ipv4-family vpnv4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-bgp-af-vpnv4] <strong>import-rib evpn srv6 ip-prefix</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-bgp-af-vpnv4]<strong> undo policy vpn-target</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-bgp-af-vpnv4] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-bgp] <strong>l2vpn-family evpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-bgp-af-evpn] <strong>import-rib vpnv4 mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-bgp-af-evpn] <strong>undo policy vpn-target</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-bgp-af-evpn] <strong>segment-routing ipv6 locator ASBR</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-bgp-af-evpn] <strong>segment-routing ipv6 apply-sid</strong> <strong>per-route </strong><strong>import-rib</strong><strong> vpnv4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-bgp-af-evpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR] <strong>commit</strong></pre>
<p># Configure and apply a tunnel selector.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>ASBR] <strong>tunnel-policy tp1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-tunnel-policy-tp1] <strong>tunnel select-seq ipv6 srv6-te-policy load-balance-number 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-tunnel-policy-tp1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR] <strong>tunnel-selector ts1 permit node 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-tunnel-selector] <strong>apply tunnel-policy tp1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-tunnel-selector] <strong>apply segment-routing ipv6 traffic-engineer</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-tunnel-selector] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR] <strong>bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-bgp] <strong>l2vpn-family evpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-bgp-af-evpn] <strong>tunnel-selector ts1</strong> </pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-bgp-af-evpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR-bgp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>ASBR] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>Check that CEs belonging to the same VPN instance can ping each other. For example:</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>CE1] <strong>ping -a 10.1.1.1 10.1.4.1</strong>                                                 
  PING 10.1.4.1: 56  data bytes, press CTRL_C to break                          
    Reply from 10.1.4.1: bytes=56 Sequence=1 ttl=253 time=32 ms                 
    Reply from 10.1.4.1: bytes=56 Sequence=2 ttl=253 time=24 ms                 
    Reply from 10.1.4.1: bytes=56 Sequence=3 ttl=253 time=27 ms                 
    Reply from 10.1.4.1: bytes=56 Sequence=4 ttl=253 time=35 ms                 
    Reply from 10.1.4.1: bytes=56 Sequence=5 ttl=253 time=28 ms                 

  --- 10.1.4.1 ping statistics ---                                              
    5 packet(s) transmitted 
    5 packet(s) received    
    0.00% packet loss       
    round-trip min/avg/max = 24/29/35 ms </pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001206731903__example121226172748"><a name="EN-US_TASK_0000001206731903__example121226172748"></a><a name="example121226172748"></a><a name="EN-US_TASK_0000001206731903__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#
sysname PE1
#
ip vpn-instance vpna
 ipv4-family
  route-distinguisher 100:1
  apply-label per-instance
  vpn-target 1:1 export-extcommunity evpn
  vpn-target 1:1 import-extcommunity evpn
  tnl-policy tp1 evpn
#               
segment-routing ipv6
 encapsulation source-address 2001:DB8:1::1
 locator PE1 ipv6-prefix 2001:DB8:100:: 64 static 32
  opcode ::10 end psp
 srv6-te-policy locator PE1
 segment-list list1
  index 10 sid ipv6 2001:DB8:130::30
 srv6-te policy policy1 endpoint 2001:DB8:3::3 color 101
  binding-sid 2001:DB8:100::450
  candidate-path preference 100
   segment-list list1
#               
isis 1          
 is-level level-1
 cost-style wide
 network-entity 10.0000.0000.0001.00
 # 
 ipv6 enable topology ipv6
 segment-routing ipv6 locator PE1 auto-sid-disable
 #              
#               
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown  
 ip binding vpn-instance vpna
 ip address 10.11.1.1 255.255.255.0
#               
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ipv6 enable    
 ipv6 address 2001:DB8:10::1/64
 isis ipv6 enable 1 
#               
interface LoopBack1
 ipv6 enable    
 ipv6 address 2001:DB8:1::1/128
 isis ipv6 enable 1
#               
bgp 100         
 router-id 1.1.1.1
 private-4-byte-as enable
 peer 2001:DB8:3::3 as-number 100
 peer 2001:DB8:3::3 connect-interface LoopBack1
 #              
 ipv4-family unicast
  undo synchronization
 #              
 ipv4-family vpn-instance vpna
  import-route direct
  advertise l2vpn evpn
  segment-routing ipv6 locator PE1 evpn
  segment-routing ipv6 traffic-engineer best-effort evpn
  peer 10.11.1.2 as-number 65410
 #              
 l2vpn-family evpn
  policy vpn-target
  peer 2001:DB8:3::3 enable
  peer 2001:DB8:3::3 route-policy p1 export
  peer 2001:DB8:3::3 advertise encap-type srv6
#               
route-policy p1 permit node 10
 apply extcommunity color 0:101
#               
tunnel-policy tp1
 tunnel select-seq ipv6 srv6-te-policy load-balance-number 1
#               
return </pre>
</li><li><p>ASBR configuration file</p>
<pre class="screen">#
sysname ASBR
#
tunnel-selector ts1 permit node 1
 apply tunnel-policy tp1
 apply segment-routing ipv6 traffic-engineer
#
mpls lsr-id 10.1.3.1
#
mpls
#
mpls ldp
 #
 ipv4-family
#
segment-routing ipv6
 encapsulation source-address 2001:DB8:3::3
 locator ASBR ipv6-prefix 2001:DB8:130:: 64 static 32
  opcode ::30 end psp
 srv6-te-policy locator ASBR
 segment-list list1
  index 10 sid ipv6 2001:DB8:100::10
 srv6-te policy policy1 endpoint 2001:DB8:1::1 color 101
  binding-sid 2001:DB8:130::350
  candidate-path preference 100
   segment-list list1
#
isis 1
 is-level level-1
 cost-style wide
 network-entity 10.0000.0000.0003.00
 #
 ipv6 enable topology ipv6
 segment-routing ipv6 locator ASBR auto-sid-disable
 #
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable    
 ipv6 address 2001:DB8:10::2/64
 isis ipv6 enable 1
#               
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 172.16.1.1 255.255.255.0
 isis enable 1
 mpls
 mpls ldp
#               
interface LoopBack1
 ipv6 enable    
 ipv6 address 2001:DB8:3::3/128
 isis ipv6 enable 1
#
interface LoopBack2
 ip address 10.1.3.1 255.255.255.255
 isis enable 1
#
bgp 100
 private-4-byte-as enable
 peer 10.1.5.1 as-number 200
 peer 10.1.5.1 ebgp-max-hop 255
 peer 10.1.5.1 connect-interface LoopBack2
 peer 2001:DB8:1::1 as-number 100
 peer 2001:DB8:1::1 connect-interface LoopBack1
 #
 ipv4-family unicast
  undo synchronization
  undo peer 10.1.5.1 enable
 #
 ipv4-family vpnv4
  undo policy vpn-target
  bestroute nexthop-resolved tunnel
  import-rib evpn srv6 ip-prefix
  peer 10.1.5.1 enable
 #
 l2vpn-family evpn
  undo policy vpn-target
  tunnel-selector ts1
  segment-routing ipv6 locator ASBR
  segment-routing ipv6 apply-sid per-route import-rib vpnv4
  import-rib vpnv4 mpls
  peer 2001:DB8:1::1 enable
  peer 2001:DB8:1::1 route-policy rp1 export
  peer 2001:DB8:1::1 advertise encap-type srv6
#
route-policy rp1 permit node 1
 apply extcommunity color 0:101
#
tunnel-policy tp1
 tunnel select-seq ipv6 srv6-te-policy load-balance-number 1
#
return </pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2
#
ip vpn-instance vpna
 ipv4-family
  route-distinguisher 100:1
  apply-label per-instance
  vpn-target 1:1 export-extcommunity
  vpn-target 1:1 import-extcommunity
#
mpls lsr-id 10.1.5.1
#
mpls
#
mpls ldp
 #
 ipv4-family
#
isis 1          
 is-level level-1
 cost-style wide
 network-entity 10.0000.0000.0005.00
 #              
 ipv6 enable topology ipv6
 #              
#               
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 172.16.1.2 255.255.255.0
 isis enable 1
 mpls
 mpls ldp
#               
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip binding vpn-instance vpna
 ip address 10.22.1.1 255.255.255.0 
#               
interface LoopBack1
 ip address 10.1.5.1 255.255.255.255
 isis enable 1
#
bgp 200
 private-4-byte-as enable
 peer 10.1.3.1 as-number 100
 peer 10.1.3.1 ebgp-max-hop 255
 peer 10.1.3.1 connect-interface LoopBack1
 #              
 ipv4-family unicast
  undo synchronization
  peer 10.1.3.1 enable
 #
 ipv4-family vpnv4
  policy vpn-target
  peer 10.1.3.1 enable
 #
 ipv4-family vpn-instance vpna
  import-route direct
  peer 10.22.1.2 as-number 65420
#
return</pre>
</li><li><p>CE1 configuration file</p>
<pre class="screen">#
sysname CE1
#               
interface  GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.11.1.2 255.255.255.0
#               
interface LoopBack1
 ip address 10.1.1.1 255.255.255.255
#               
bgp 65410
 private-4-byte-as enable
 peer 10.11.1.1 as-number 100
 #              
 ipv4-family unicast
  undo synchronization
  import-route direct
  peer 10.11.1.1 enable
#  
return </pre>
</li><li><p>CE2 configuration file</p>
<pre class="screen">#
sysname CE2
#               
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 10.22.1.2 255.255.255.0
#               
interface LoopBack1
 ip address 10.1.4.1 32
#               
bgp 65420
 private-4-byte-as enable
 peer 10.22.1.1 as-number 200
 #              
 ipv4-family unicast
  undo synchronization
  import-route direct
  peer 10.22.1.1 enable
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0010.html">EVPN Configuration Examples
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dci_cfg_0036.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0221.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>