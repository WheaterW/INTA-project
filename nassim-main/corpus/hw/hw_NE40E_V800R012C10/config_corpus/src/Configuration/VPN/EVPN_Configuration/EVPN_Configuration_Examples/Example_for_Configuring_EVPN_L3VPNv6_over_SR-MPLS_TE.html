
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring EVPN L3VPNv6 over SR-MPLS TE">
<meta name="abstract" content="This section provides an example for configuring EVPN L3VPNv6 to recurse traffic over an SR-MPLS TE tunnel.">
<meta name="description" content="This section provides an example for configuring EVPN L3VPNv6 to recurse traffic over an SR-MPLS TE tunnel.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0010.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_srv6_cfg_0010.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0185.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="p00915595,w00800033,w00556928,l00468467,w00606909,evpnvrp,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="p00915595">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00878323">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172370681">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring EVPN L3VPNv6 over SR-MPLS TE</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172370681"></a><a name="EN-US_TASK_0172370681"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring EVPN L3VPNv6 over SR-MPLS TE</h1>
<div class="taskbody" id="taskbody1342523900214056"><p id="shortdesc1330655142214056">This section provides an example for configuring EVPN L3VPNv6 to recurse traffic over an SR-MPLS TE tunnel.</p>
<div class="context"><a name="EN-US_TASK_0172370681__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0172370681__context720131372214056"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0172370681__p779131397214056">On the network shown in <a href="#EN-US_TASK_0172370681__fig16348123515020">Figure 1</a>, EVPN L3VPNv6 needs to be configured to transmit IPv6 Layer 3 services between CEs over the backbone network. In this example, PEs transmit service traffic over SR-MPLS TE tunnels.</p>
<div class="fignone" id="EN-US_TASK_0172370681__fig16348123515020"><a name="EN-US_TASK_0172370681__fig16348123515020"></a><a name="fig16348123515020"></a><span class="figcap"><b>Figure 1 </b>Configuring EVPN L3VPNv6 over SR-MPLS TE</span><div class="note" id="EN-US_TASK_0172370681__note1153124118017"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172370681__p18153241808">Interfaces 1 and 2 in this example represent GigabitEthernet<span>0/1/0</span> and GigabitEthernet<span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0172370681__image105484287010" src="figure/en-us_image_0000001232399815.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172370681__1.4.2"></a><a name="1.4.2"></a>
<div class="p" id="EN-US_TASK_0172370681__context358952032214056"><h4 class="sectiontitle">Configuration Notes</h4><p id="EN-US_TASK_0172370681__p1700639281214056">During the configuration process, note the following:</p>
<ul id="EN-US_TASK_0172370681__ul970930106214056"><li id="EN-US_TASK_0172370681__li1255955688214056"><p id="EN-US_TASK_0172370681__p1230481853214056"><a name="EN-US_TASK_0172370681__li1255955688214056"></a><a name="li1255955688214056"></a>For the same VPN instance, the export VPN target list of a site shares VPN targets with the import VPN target lists of the other sites. Conversely, the import VPN target list of a site shares VPN targets with the export VPN target lists of the other sites.</p>
</li><li id="EN-US_TASK_0172370681__li2128599777214056"><p id="EN-US_TASK_0172370681__p446376666214056"><a name="EN-US_TASK_0172370681__li2128599777214056"></a><a name="li2128599777214056"></a>Using the local loopback interface address of each PE as the source address of the PE is recommended.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172370681__1.4.3"></a><a name="1.4.3"></a>
<div class="p" id="EN-US_TASK_0172370681__context1607282976214056"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0172370681__p2016641458214056">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0172370681__ol1853557310214056"><li id="EN-US_TASK_0172370681__li1619196474214056"><p id="EN-US_TASK_0172370681__p922363734214056"><a name="EN-US_TASK_0172370681__li1619196474214056"></a><a name="li1619196474214056"></a>Configure an IGP for PE1, PE2, and the P to communicate with each other.</p>
</li><li id="EN-US_TASK_0172370681__li880648520214056"><p id="EN-US_TASK_0172370681__p602380516214056"><a name="EN-US_TASK_0172370681__li880648520214056"></a><a name="li880648520214056"></a>Configure an SR-MPLS TE tunnel on the backbone network.</p>
</li><li id="EN-US_TASK_0172370681__li1881604487214056"><p id="EN-US_TASK_0172370681__p282427287214056"><a name="EN-US_TASK_0172370681__li1881604487214056"></a><a name="li1881604487214056"></a>Configure an EVPN L3VPN instance on each PE and bind an interface to the EVPN L3VPN instance.</p>
</li><li id="EN-US_TASK_0172370681__li408674984214056"><p id="EN-US_TASK_0172370681__p947752982214056"><a name="EN-US_TASK_0172370681__li408674984214056"></a><a name="li408674984214056"></a>Establish BGP EVPN peer relationships between PEs.</p>
</li><li id="EN-US_TASK_0172370681__li698820227214056"><p id="EN-US_TASK_0172370681__p483489746214056"><a name="EN-US_TASK_0172370681__li698820227214056"></a><a name="li698820227214056"></a>Configure and apply a tunnel policy so that EVPN routes can recurse to SR-MPLS TE tunnels.</p>
</li><li id="EN-US_TASK_0172370681__li653532483214056"><p id="EN-US_TASK_0172370681__p1689071023214056"><a name="EN-US_TASK_0172370681__li653532483214056"></a><a name="li653532483214056"></a>Establish VPN BGP peer relationships between PEs and CEs.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172370681__1.4.4"></a><a name="1.4.4"></a>
<div class="p" id="EN-US_TASK_0172370681__context1131778525214056"><h4 class="sectiontitle">Data Preparation</h4><p id="EN-US_TASK_0172370681__p77404906214056">To complete the configuration, you need the following data:</p>
<ul id="EN-US_TASK_0172370681__ul272021104214056"><li id="EN-US_TASK_0172370681__li748230958214056"><p id="EN-US_TASK_0172370681__p2000957921214056"><a name="EN-US_TASK_0172370681__li748230958214056"></a><a name="li748230958214056"></a>Name of the IPv6 VPN instance: vpn1</p>
</li><li id="EN-US_TASK_0172370681__li1279704495214056"><p id="EN-US_TASK_0172370681__p944722760214056"><a name="EN-US_TASK_0172370681__li1279704495214056"></a><a name="li1279704495214056"></a>RD (100:1) and RT (1:1) of the IPv6 VPN instance</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172370681__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0172370681__steps1084662034214056"><li id="EN-US_TASK_0172370681__step1793637998214056"><span id="EN-US_TASK_0172370681__cmd1445879447214056">Configure interface addresses of each device.</span><p><p id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_p1188131509214048"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172369488_screen1539879811214048">&lt;<span class="keyword" id="EN-US_TASK_0172370681__keyword1796874616214050"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172370681__keyword9143351214050">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172370681__b1456632315214050">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172369488_screen1556776246214048">[<span class="keyword" id="EN-US_TASK_0172370681__keyword14127381919"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172370681__keyword4412838114">HUAWEI</span>] <strong id="EN-US_TASK_0172370681__en-us_task_0172369488_b1826021567214048">sysname PE1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172369488_screen53468997214048">[<span class="keyword" id="EN-US_TASK_0172370681__keyword371252619111"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172370681__keyword1871232616110">HUAWEI</span>] <strong id="EN-US_TASK_0172370681__en-us_task_0172369488_b1758551947214048">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen951847452214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword1043223072214048"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b925133943214048">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen1285024223214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword8183659214048">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b867106471214048">ip address 1.1.1.1 32</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen601223530214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword678232359214048">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b751580343214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen1725882633214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword299625369214048">*</span>PE1]<strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b665376355214048"> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen216319910214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword1058127016214048">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b1031148063214048">ip address 10.1.1.1 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen977384742214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword273931289214048">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b1799184375214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen320501124214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword2036584700214048">*</span>PE1] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b1727035938214048">commit</strong></pre>
<p id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_p704972473214048"># Configure the P.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen17435186673">&lt;<span class="keyword" id="EN-US_TASK_0172370681__keyword3436116272"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172370681__keyword7436461717">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172370681__b04362618713">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen14361761870">[<span class="keyword" id="EN-US_TASK_0172370681__keyword17436269714"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172370681__keyword174361861711">HUAWEI</span>] <strong id="EN-US_TASK_0172370681__b104365610714">sysname P</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1243613612713">[<span class="keyword" id="EN-US_TASK_0172370681__keyword9436156671"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172370681__keyword1843610613717">HUAWEI</span>] <strong id="EN-US_TASK_0172370681__b943611617710">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen974993317214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword800042725214048"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b1001868575214048">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen785218503214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword201236712214048">*</span>P-LoopBack1] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b2125328831214048">ip address 2.2.2.2 32</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen1088003628214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword1543740642214048">*</span>P-LoopBack1] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b1106794695214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen233840133214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword1876737106214048">*</span>P]<strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b1824173385214048"> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen671151759214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword1905366392214048">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b114475027214048">ip address 10.1.1.2 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen1823662946214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword505711824214048">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b1702628474214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen1072742025214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword465405114214048">*</span>P]<strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b614348113214048"> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen1853870408214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword2088189828214048">*</span>P-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b200585444214048">ip address 10.2.1.1 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen1368967001214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword757038772214048">*</span>P-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b1393643972214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen1150915313214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword1314517399214048">*</span>P] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b301008334214048">commit</strong></pre>
<p id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_p1002916576214048"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1989112318718">&lt;<span class="keyword" id="EN-US_TASK_0172370681__keyword5989923074"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172370681__keyword1598911234718">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172370681__b1989523771">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen39894230715">[<span class="keyword" id="EN-US_TASK_0172370681__keyword798922313711"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172370681__keyword998922315716">HUAWEI</span>] <strong id="EN-US_TASK_0172370681__b19989523978">sysname PE2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1598922320710">[<span class="keyword" id="EN-US_TASK_0172370681__keyword79894231174"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172370681__keyword498916239716">HUAWEI</span>] <strong id="EN-US_TASK_0172370681__b12989623776">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen2143072645214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword1188470960214048"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b753305913214048">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen1269567466214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword807806922214048">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b1646302233214048">ip address 3.3.3.3 32</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen738681779214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword754452122214048">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b832790317214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen2107838496214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword1131419293214048">*</span>PE2]<strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b566344980214048"> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen185627733214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword895179050214048">*</span>PE2-GigabitEthernet<span>0/2/0</span>]<strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b810907017214048"> ip address 10.2.1.2 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen871777228214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword697289516214048">*</span>PE2-GigabitEthernet<span>0/2/0</span>]<strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b1078548112214048"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_screen125558937214048">[<span class="keyword" id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_keyword1835211945214048">*</span>PE2]<strong id="EN-US_TASK_0172370681__en-us_task_0172370670_en-us_task_0172369488_b41270465214048"> commit</strong></pre>
</p></li><li id="EN-US_TASK_0172370681__step240419173214056"><span id="EN-US_TASK_0172370681__cmd1308300604214056">Configure an IGP for PE1, PE2, and the P to communicate with each other. IS-IS is used as the IGP in this example.</span><p><p id="EN-US_TASK_0172370681__p1331715564214056"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1555613843214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword242903319214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370681__b674082076214056">isis 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen652821469214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword181747057214056">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172370681__b1888303758214056">is-level level-2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1438274289214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1542419515214056">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172370681__b841717438214056">network-entity 00.1111.1111.1111.00</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen77422512214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword2106612193214056">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172370681__b735824181214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen496061874214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1477713619214056">*</span>PE1] <strong id="EN-US_TASK_0172370681__b2045034671214056">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen643016040214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1379066131214056">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172370681__b1234575343214056">isis enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1963467484214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword2010877173214056">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172370681__b1211187332214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1456644074214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1300968293214056">*</span>PE1] <strong id="EN-US_TASK_0172370681__b1515287280214056">interface GigabitEthernet <span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen907173389214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword110380954214056">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370681__b244676099214056">isis enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1876811307214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword182246067214056">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370681__b1443280332214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1163538074214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1448090498214056">*</span>PE1] <strong id="EN-US_TASK_0172370681__b296473215214056">commit</strong></pre>
<p id="EN-US_TASK_0172370681__p2028928325214056"># Configure the P.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen368334557214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1985290629214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong id="EN-US_TASK_0172370681__b343630135214056">isis 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1926803106214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1611949948214056">*</span>P-isis-1] <strong id="EN-US_TASK_0172370681__b1626529542214056">is-level level-2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen653258552214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword33688753214056">*</span>P-isis-1] <strong id="EN-US_TASK_0172370681__b117942929214056">network-entity 00.1111.1111.2222.00</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen16721377214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword2029990549214056">*</span>P-isis-1] <strong id="EN-US_TASK_0172370681__b1647102199214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen219484091214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1852748862214056">*</span>P] <strong id="EN-US_TASK_0172370681__b627598549214056">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen2098779873214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword630963663214056">*</span>P-LoopBack1] <strong id="EN-US_TASK_0172370681__b1352335179214056">isis enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen588094405214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword543466706214056">*</span>P-LoopBack1] <strong id="EN-US_TASK_0172370681__b937789818214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen865226376214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1593792563214056">*</span>P] <strong id="EN-US_TASK_0172370681__b1065254831214056">interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1712769970214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword970312999214056">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370681__b2144021294214056">isis enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1599035960214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword729681549214056">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370681__b1526768156214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen531847062214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword356313496214056">*</span>P] <strong id="EN-US_TASK_0172370681__b320831721214056">interface GigabitEthernet <span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1968366348214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1441738567214056">*</span>P-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370681__b2048000885214056">isis enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1134186983214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword181657558214056">*</span>P-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370681__b2022052650214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen193333399214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1457411742214056">*</span>P] <strong id="EN-US_TASK_0172370681__b2054194506214056">commit</strong></pre>
<p id="EN-US_TASK_0172370681__p1578580947214056"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen372212041214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1274302853214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370681__b1520732631214056">isis 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1371979637214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1779070211214056">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172370681__b1087348419214056">is-level level-2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen2096435296214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1763307437214056">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172370681__b170457493214056">network-entity 00.1111.1111.3333.00</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1292031910214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1399709297214056">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172370681__b2084790345214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1553765535214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1647084208214056">*</span>PE2] <strong id="EN-US_TASK_0172370681__b1301071781214056">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen618969181214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword2142173177214056">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172370681__b1121414586214056">isis enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen502348996214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1738989879214056">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172370681__b616354217214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen895271143214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword2015680312214056">*</span>PE2] <strong id="EN-US_TASK_0172370681__b1812921225214056">interface GigabitEthernet <span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen709398303214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1479907546214056">*</span>PE2-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370681__b445405491214056">isis enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen242581768214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword443624389214056">*</span>PE2-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370681__b1158158514214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen538451963214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword503297127214056">*</span>PE2] <strong id="EN-US_TASK_0172370681__b1856263893214056">commit</strong></pre>
<p id="EN-US_TASK_0172370681__p1493022995214056">After completing the configurations, run the <strong id="EN-US_TASK_0172370681__b1437591727214349">display isis peer</strong> command to check that the status of the IS-IS neighbor relationship between PE1, PE2, and the P is Up. Run the <strong id="EN-US_TASK_0172370681__b516704521214349">display ip routing-table</strong> command. The command output shows that the PEs have learned the routes to Loopback1 of each other.</p>
<p id="EN-US_TASK_0172370681__p1671954706214056">The following example uses the command output on PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1938743513214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1024203386214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370681__b6832258214056">display isis peer</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen226223342214056">                          Peer information for ISIS(1)
                         
  System Id     Interface         Circuit Id         State HoldTime Type     PRI
--------------------------------------------------------------------------------
1111.1111.2222  GE<span>0/2/0</span>           1111.1111.2222.02  Up    7s       L2       64

Total Peer(s): 1</pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1917147358214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword34005161214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370681__b1424624028214056">display ip routing-table</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1242809201214056"><span class="keyword" id="EN-US_TASK_0172370681__keyword1468290485214056">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route</span>
------------------------------------------------------------------------------
Routing Table : _public_
         Destinations : 11       Routes : 11        

Destination/Mask    Proto   Pre  Cost        Flags NextHop         Interface

        1.1.1.1/32  Direct  0    0             D   127.0.0.1       LoopBack1
        2.2.2.2/32  ISIS-L2 15   10            D   10.1.1.2        GigabitEthernet<span>0/2/0</span>
        3.3.3.3/32  ISIS-L2 15   20            D   10.1.1.2        GigabitEthernet<span>0/2/0</span>
       10.1.1.0/24  Direct  0    0             D   10.1.1.1        GigabitEthernet<span>0/2/0</span>
       10.1.1.1/32  Direct  0    0             D   127.0.0.1       GigabitEthernet<span>0/2/0</span>
     10.1.1.255/32  Direct  0    0             D   127.0.0.1       GigabitEthernet<span>0/2/0</span>
       10.2.1.0/24  ISIS-L2 15   20            D   10.1.1.2        GigabitEthernet<span>0/2/0</span>
      127.0.0.0/8   Direct  0    0             D   127.0.0.1       InLoopBack0
      127.0.0.1/32  Direct  0    0             D   127.0.0.1       InLoopBack0
127.255.255.255/32  Direct  0    0             D   127.0.0.1       InLoopBack0
255.255.255.255/32  Direct  0    0             D   127.0.0.1       InLoopBack0</pre>
</p></li><li id="EN-US_TASK_0172370681__step1725492903214056"><span id="EN-US_TASK_0172370681__cmd740051633214056">Configure an SR-MPLS TE tunnel on the backbone network.</span><p><p id="EN-US_TASK_0172370681__p226804501214056"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen864264535214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword653870300214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370681__b2135690856214056">mpls lsr-id 1.1.1.1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen764129147214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1829880124214056">*</span>PE1] <strong id="EN-US_TASK_0172370681__b167724428214056">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen594203872214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword62244967214056">*</span>PE1-mpls] <strong id="EN-US_TASK_0172370681__b606072228214056">mpls te</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen700338972214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword702954795214056">*</span>PE1-mpls] <strong id="EN-US_TASK_0172370681__b1930443609214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen994223187214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword2015691617214056">*</span>PE1] <strong id="EN-US_TASK_0172370681__b1887428081214056">segment-routing</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen116051764214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword744474012214056">*</span>PE1-segment-routing] <strong id="EN-US_TASK_0172370681__b1865194780214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1755309255214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1954057583214056">*</span>PE1] <strong id="EN-US_TASK_0172370681__b799296603214056">isis 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen491701718214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword884580450214056">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172370681__b1777443565214056">cost-style wide</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen191993920214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1232088695214056">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172370681__b1581622068214056">traffic-eng level-2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1080485936214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword303307754214056">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172370681__b188616889214056">segment-routing mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen827865905214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword49049795214056">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172370681__b1166461008214056">segment-routing global-block 153616 153800</strong></pre>
<div class="note" id="EN-US_TASK_0172370681__note5675122403810"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172370681__en-us_task_0172368860_p969181111187">The SRGB range varies according to the device. The range specified in this example is for reference only.</p>
</div></div>
<pre class="screen" id="EN-US_TASK_0172370681__screen2034887092214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword435422999214056">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172370681__b419025785214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen2005436037214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1223157073214056">*</span>PE1] <strong id="EN-US_TASK_0172370681__b2005941552214056">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1921031690214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword978240237214056">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172370681__b102277634214056">isis prefix-sid absolute 153700</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1616789535214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword702051622214056">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172370681__b1117125779214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen101729633214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1961588987214056">*</span>PE1] <strong id="EN-US_TASK_0172370681__b1279844591214056">explicit-path pe1tope2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1432662037214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1081608048214056">*</span>PE1-explicit-path-pe1tope2] <strong id="EN-US_TASK_0172370681__b583616442214056">next sid label 48140 type adjacency</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1942752153214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword249095410214056">*</span>PE1-explicit-path-pe1tope2] <strong id="EN-US_TASK_0172370681__b575558117214056">next sid label 48141 type adjacency</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1413099406214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword626339504214056">*</span>PE1-explicit-path-pe1tope2] <strong id="EN-US_TASK_0172370681__b2110649632214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen297357320214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword345701252214056">*</span>PE1] <strong id="EN-US_TASK_0172370681__b99650382214056">interface tunnel1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1795084988214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1826482336214056">*</span>PE1-Tunnel1] <strong id="EN-US_TASK_0172370681__b1202598102214056">ip address unnumbered interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen777925580214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword286022750214056">*</span>PE1-Tunnel1] <strong id="EN-US_TASK_0172370681__b1919046797214056">tunnel-protocol mpls te</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen44254816214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1312805724214056">*</span>PE1-Tunnel1] <strong id="EN-US_TASK_0172370681__b422298309214056">destination 3.3.3.3</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1079023246214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword287547097214056">*</span>PE1-Tunnel1] <strong id="EN-US_TASK_0172370681__b271374230214056">mpls te tunnel-id 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen2090048915214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword837785918214056">*</span>PE1-Tunnel1] <strong id="EN-US_TASK_0172370681__b1269618200214056">mpls te signal-protocol segment-routing</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1748713257214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1980865162214056">*</span>PE1-Tunnel1] <strong id="EN-US_TASK_0172370681__b41520904214056">mpls te path explicit-path pe1tope2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1876610247214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword208694336214056">*</span>PE1-Tunnel1] <strong id="EN-US_TASK_0172370681__b763316087214056">mpls te reserved-for-binding</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1585007540214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword3953718214056">*</span>PE1-Tunnel1] <strong id="EN-US_TASK_0172370681__b688616021214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen606209113214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1881734102214056">*</span>PE1] <strong id="EN-US_TASK_0172370681__b1397254171214056">commit</strong></pre>
<div class="note" id="EN-US_TASK_0172370681__note273059798214056"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172370681__p143471347214056">The <a href="cmdqueryname=next+sid+label"><b><span class="cmdname" id="EN-US_TASK_0172370681__cmdname1235271577214349">next sid label</span></b></a> command uses the adjacency label from PE1 to P which is dynamically generated using IS-IS. This adjacency label can be obtained using the <a href="cmdqueryname=display+segment-routing+adjacency+mpls+forwarding"><b><span class="cmdname" id="EN-US_TASK_0172370681__cmdname1615631929214349">display segment-routing adjacency mpls forwarding</span></b></a> command.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1743673767214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1190656453214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370681__b571247345214056">display segment-routing adjacency mpls forwarding</strong>
            Segment Routing Adjacency MPLS Forwarding Information

Label     Interface         NextHop          Type        MPLSMtu   Mtu       VPN-Name       
-------------------------------------------------------------------------------------
48140     GE<span>0/2/0</span>           10.1.1.2         ISIS-V4     ---       1500      _public_</pre>
</div></div>
<p id="EN-US_TASK_0172370681__p1832408949214056"># Configure the P.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen268873361214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword422107360214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong id="EN-US_TASK_0172370681__b1059463644214056">mpls lsr-id 2.2.2.2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen751316268214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword190478172214056">*</span>P] <strong id="EN-US_TASK_0172370681__b932939009214056">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1538322990214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1190526369214056">*</span>P-mpls] <strong id="EN-US_TASK_0172370681__b653640246214056"> mpls te</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen429915630214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword125361173214056">*</span>P-mpls] <strong id="EN-US_TASK_0172370681__b892178120214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1147890888214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword938911996214056">*</span>P] <strong id="EN-US_TASK_0172370681__b461548675214056">segment-routing</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1782216198214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1455657230214056">*</span>P-segment-routing] <strong id="EN-US_TASK_0172370681__b706110266214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1234422480214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1403169826214056">*</span>P] <strong id="EN-US_TASK_0172370681__b646975489214056">isis 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1730664333214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword818380491214056">*</span>P-isis-1] <strong id="EN-US_TASK_0172370681__b1386540786214056">cost-style wide</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen345159038214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword893660430214056">*</span>P-isis-1] <strong id="EN-US_TASK_0172370681__b672744018214056">traffic-eng level-2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen245385262214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1302258440214056">*</span>P-isis-1] <strong id="EN-US_TASK_0172370681__b1693012042214056">segment-routing mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen653748285214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword883234824214056">*</span>P-isis-1] <strong id="EN-US_TASK_0172370681__b343551691214056">segment-routing global-block 153616 153800</strong></pre>
<div class="note" id="EN-US_TASK_0172370681__note161195720111"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172370681__en-us_task_0172368860_p969181111187_1">The SRGB range varies according to the device. The range specified in this example is for reference only.</p>
</div></div>
<pre class="screen" id="EN-US_TASK_0172370681__screen1174640296214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword858293562214056">*</span>P-isis-1] <strong id="EN-US_TASK_0172370681__b1552629646214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen945638411214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword2074809291214056">*</span>P] <strong id="EN-US_TASK_0172370681__b2055208331214056">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen71185393214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword307781714214056">*</span>P-LoopBack1] <strong id="EN-US_TASK_0172370681__b1912275311214056">isis prefix-sid absolute 153710</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1567073231214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1426154657214056">*</span>P-LoopBack1] <strong id="EN-US_TASK_0172370681__b283158430214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1237576719214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword589992743214056">*</span>P] <strong id="EN-US_TASK_0172370681__b933596027214056">commit</strong></pre>
<div class="note" id="EN-US_TASK_0172370681__note952118324117"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172370681__p1521113114116">After the configuration is complete, yan can view the adjacency labels by using the <a href="cmdqueryname=display+segment-routing+adjacency+mpls+forwarding"><b><span class="cmdname" id="EN-US_TASK_0172370681__cmdname6447112745114">display segment-routing adjacency mpls forwarding</span></b></a> command.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1052163204117">[<span class="keyword" id="EN-US_TASK_0172370681__keyword115211832418"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong id="EN-US_TASK_0172370681__b3521103104112">display segment-routing adjacency mpls forwarding</strong>
            Segment Routing Adjacency MPLS Forwarding Information

Label     Interface         NextHop          Type        MPLSMtu   Mtu       VPN-Name       
-------------------------------------------------------------------------------------------
48241     GE<span>0/1/0</span>           10.1.1.1         ISIS-V4     ---       1500      _public_ 
48141     GE<span>0/2/0</span>           10.2.1.2         ISIS-V4     ---       1500      _public_      </pre>
</div></div>
<p id="EN-US_TASK_0172370681__p882245791214056"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen2033147586214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword925689722214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370681__b1156940612214056">mpls lsr-id 3.3.3.3</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen247993765214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword690192988214056">*</span>PE2] <strong id="EN-US_TASK_0172370681__b71818039214056">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen2144991816214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword132786271214056">*</span>PE2-mpls] <strong id="EN-US_TASK_0172370681__b822741915214056">mpls te</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1528520638214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1833309581214056">*</span>PE2-mpls] <strong id="EN-US_TASK_0172370681__b572121580214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen391214691214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword307631854214056">*</span>PE2] <strong id="EN-US_TASK_0172370681__b1369109835214056">segment-routing</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen903994602214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword945841748214056">*</span>PE2-segment-routing] <strong id="EN-US_TASK_0172370681__b999408895214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1071392210214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1153668323214056">*</span>PE2] <strong id="EN-US_TASK_0172370681__b984097014214056">isis 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1159328718214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword636884637214056">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172370681__b973547401214056">cost-style wide</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1675183512214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1937848837214056">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172370681__b1663842610214056">traffic-eng level-2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1584312018214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1237715476214056">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172370681__b136593192214056">segment-routing mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen753970406214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1139551541214056">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172370681__b382846126214056">segment-routing global-block 153616 153800</strong></pre>
<div class="note" id="EN-US_TASK_0172370681__note03099318214"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172370681__en-us_task_0172368860_p969181111187_2">The SRGB range varies according to the device. The range specified in this example is for reference only.</p>
</div></div>
<pre class="screen" id="EN-US_TASK_0172370681__screen1316879770214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword421511286214056">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172370681__b510717900214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1999570906214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword452403896214056">*</span>PE2] <strong id="EN-US_TASK_0172370681__b1776379175214056">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1252159986214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword2061193476214056">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172370681__b1649620514214056">isis prefix-sid absolute 153720</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1475649835214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword793985310214056">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172370681__b1064220253214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen379633831214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword932129401214056">*</span>PE2] <strong id="EN-US_TASK_0172370681__b1440434216214056">explicit-path pe2tope1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1585649874214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword419726207214056">*</span>PE2-explicit-path-pe2tope1] <strong id="EN-US_TASK_0172370681__b1920925711214056">next sid label 48240 type adjacency</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen455865646214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1643459828214056">*</span>PE2-explicit-path-pe2tope1] <strong id="EN-US_TASK_0172370681__b1454422882214056">next sid label 48241 type adjacency</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1982319122214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1507068194214056">*</span>PE2-explicit-path-pe2tope1] <strong id="EN-US_TASK_0172370681__b1760241154214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen2138323477214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1071990793214056">*</span>PE2] <strong id="EN-US_TASK_0172370681__b1763210298214056">interface tunnel1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1353286248214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1688962239214056">*</span>PE2-Tunnel1] <strong id="EN-US_TASK_0172370681__b376646532214056">ip address unnumbered interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1569970071214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1267680349214056">*</span>PE2-Tunnel1] <strong id="EN-US_TASK_0172370681__b386583658214056">tunnel-protocol mpls te</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen656301569214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1591606649214056">*</span>PE2-Tunnel1] <strong id="EN-US_TASK_0172370681__b436834155214056">destination 1.1.1.1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1146947489214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1759687816214056">*</span>PE2-Tunnel1] <strong id="EN-US_TASK_0172370681__b298755563214056">mpls te tunnel-id 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen2045448872214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword822087588214056">*</span>PE2-Tunnel1] <strong id="EN-US_TASK_0172370681__b2116281858214056">mpls te signal-protocol segment-routing</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1479251644214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword770736973214056">*</span>PE2-Tunnel1] <strong id="EN-US_TASK_0172370681__b1435762985214056">mpls te path explicit-path pe2tope1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen740301976214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1033058476214056">*</span>PE2-Tunnel1] <strong id="EN-US_TASK_0172370681__b2052114302214056">mpls te reserved-for-binding</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen648620526214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword717897451214056">*</span>PE2-Tunnel1] <strong id="EN-US_TASK_0172370681__b1756978925214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1307083038214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1584778745214056">*</span>PE2] <strong id="EN-US_TASK_0172370681__b1747198875214056">commit</strong></pre>
<div class="note" id="EN-US_TASK_0172370681__note169916591426"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172370681__p12699175912423">The <a href="cmdqueryname=next+sid+label"><b><span class="cmdname" id="EN-US_TASK_0172370681__cmdname831922215509">next sid label</span></b></a> command uses the adjacency labels from PE2 to the P and from the P to PE1, which are dynamically generated using IS-IS. This adjacency label can be obtained using the <a href="cmdqueryname=display+segment-routing+adjacency+mpls+forwarding"><b><span class="cmdname" id="EN-US_TASK_0172370681__cmdname1331919229500">display segment-routing adjacency mpls forwarding</span></b></a> command.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen206992596428">[<span class="keyword" id="EN-US_TASK_0172370681__keyword3699195915424"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370681__b186991859114214">display segment-routing adjacency mpls forwarding</strong>
            Segment Routing Adjacency MPLS Forwarding Information

Label     Interface         NextHop          Type        MPLSMtu   Mtu       VPN-Name       
-------------------------------------------------------------------------------------------
48240     GE<span>0/2/0</span>           10.2.1.1         ISIS-V4     ---       1500      _public_      </pre>
</div></div>
<p id="EN-US_TASK_0172370681__p995849150214056">After completing the configurations, run the <strong id="EN-US_TASK_0172370681__b1452409169214349">display mpls te tunnel-interface</strong> command to check that the tunnel interface is Up.</p>
<p id="EN-US_TASK_0172370681__p1126906900214056">The following example uses the command output on PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen148760973214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword752575494214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong id="EN-US_TASK_0172370681__b1914504601214056"> display mpls te tunnel-interface</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1300204749214056">    Tunnel Name       : Tunnel1
    Signalled Tunnel Name: -
    Tunnel State Desc : <strong id="EN-US_TASK_0172370681__b617739361214056">CR-LSP is Up</strong>
    Tunnel Attributes   :     
    Active LSP          : Primary LSP
    Traffic Switch      : - 
    Session ID          : 1
    Ingress LSR ID      : 1.1.1.1               Egress LSR ID: 3.3.3.3
    Admin State         : <strong id="EN-US_TASK_0172370681__b1719551806214056">UP</strong>                    Oper State   : <strong id="EN-US_TASK_0172370681__b866898926214056">UP</strong>
    Signaling Protocol  : Segment-Routing
    FTid                : 1
    Tie-Breaking Policy : None                  Metric Type  : TE
    Bfd Cap             : None                  
    Reopt               : Disabled              Reopt Freq   : -              
    Auto BW             : Disabled              Threshold    : - 
    Current Collected BW: -                     Auto BW Freq : -
    Min BW              : -                     Max BW       : -
    Offload             : Disabled              Offload Freq : - 
    Low Value           : -                     High Value   : - 
    Readjust Value      : - 
    Offload Explicit Path Name: -
    Tunnel Group        : Primary
    Interfaces Protected: -
    Excluded IP Address : -
    Referred LSP Count  : 0
    Primary Tunnel      : -                     Pri Tunn Sum : -
    Backup Tunnel       : -
    Group Status        : Up                    Oam Status   : None
    IPTN InLabel        : -                     Tunnel BFD Status : -
    BackUp LSP Type     : None                  BestEffort   : -
    Secondary HopLimit  : -
    BestEffort HopLimit  : -
    Secondary Explicit Path Name: -
    Secondary Affinity Prop/Mask: 0x0/0x0
    BestEffort Affinity Prop/Mask: -  
    IsConfigLspConstraint: -
    Hot-Standby Revertive Mode:  Revertive
    Hot-Standby Overlap-path:  Disabled
    Hot-Standby Switch State:  CLEAR
    Bit Error Detection:  Disabled
    Bit Error Detection Switch Threshold:  -
    Bit Error Detection Resume Threshold:  -
    Ip-Prefix Name    : -
    P2p-Template Name : -
    PCE Delegate      : No                    LSP Control Status : Local control
    Path Verification : No
    Entropy Label     : -
    Associated Tunnel Group ID: -             Associated Tunnel Group Type: -
    Auto BW Remain Time   : -                 Reopt Remain Time     : - 
    Segment-Routing Remote Label   : -
    Binding Sid       : -                     Reverse Binding Sid : - 
    FRR Attr Source   : -                     Is FRR degrade down : No
    Color             : - 

    Primary LSP ID      : 1.1.1.1:7
    LSP State           : UP                    LSP Type     : Primary
    Setup Priority      : 7                     Hold Priority: 7
    IncludeAll          : 0x0
    IncludeAny          : 0x0
    ExcludeAny          : 0x0
    Affinity Prop/Mask  : 0x0/0x0               Resv Style   :  SE
    SidProtectType      : - 
    Configured Bandwidth Information:
    CT0 Bandwidth(Kbit/sec): 0               CT1 Bandwidth(Kbit/sec): 0
    CT2 Bandwidth(Kbit/sec): 0               CT3 Bandwidth(Kbit/sec): 0
    CT4 Bandwidth(Kbit/sec): 0               CT5 Bandwidth(Kbit/sec): 0
    CT6 Bandwidth(Kbit/sec): 0               CT7 Bandwidth(Kbit/sec): 0
    Actual Bandwidth Information:
    CT0 Bandwidth(Kbit/sec): 0               CT1 Bandwidth(Kbit/sec): 0
    CT2 Bandwidth(Kbit/sec): 0               CT3 Bandwidth(Kbit/sec): 0
    CT4 Bandwidth(Kbit/sec): 0               CT5 Bandwidth(Kbit/sec): 0
    CT6 Bandwidth(Kbit/sec): 0               CT7 Bandwidth(Kbit/sec): 0
    Explicit Path Name  : pe1tope2                         Hop Limit: -
    Record Route        : -                            Record Label : -
    Route Pinning       : -
    FRR Flag            : -
    IdleTime Remain     : -
    BFD Status          : -
    Soft Preemption     : -
    Reroute Flag        : -
    Pce Flag            : Normal
    Path Setup Type     : EXPLICIT
    Create Modify LSP Reason: -</pre>
</p></li><li id="EN-US_TASK_0172370681__step312057639214056"><span id="EN-US_TASK_0172370681__cmd597672699214056">Configure an EVPN L3VPN instance on each PE and bind an interface to the EVPN L3VPN instance.</span><p><p id="EN-US_TASK_0172370681__p522684628214056"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1854467359214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1259625893214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370681__b1831976616214056">ip vpn-instance vpn1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen2144568687214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1307976876214056">*</span>PE1-vpn-instance-vpn1] <strong id="EN-US_TASK_0172370681__b454082029214056">ipv6-family</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1568137806214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1084302128214056">*</span>PE1-vpn-instance-vpn1-af-ipv6] <strong id="EN-US_TASK_0172370681__b1280004031214056">route-distinguisher 100:1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen111834066214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1461785399214056">*</span>PE1-vpn-instance-vpn1-af-ipv6] <strong id="EN-US_TASK_0172370681__b267223705214056">vpn-target 1:1 evpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen204272840214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1183956901214056">*</span>PE1-vpn-instance-vpn1-af-ipv6] <strong id="EN-US_TASK_0172370681__b30875765214056">evpn mpls routing-enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1793853622214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1482810439214056">*</span>PE1-vpn-instance-vpn1-af-ipv6] <strong id="EN-US_TASK_0172370681__b819602876214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen998188521214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword434303759214056">*</span>PE1-vpn-instance-vpn1] <strong id="EN-US_TASK_0172370681__b1806297306214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen773523450214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1481486789214056">*</span>PE1] <strong id="EN-US_TASK_0172370681__b834043196214056">interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1799924689214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword891928097214056">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370681__b762960293214056">ip binding vpn-instance vpn1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen820944434214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword79034961214056">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370681__b621083773214056">ipv6 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1614977182214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword906159996214056">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370681__b1522892921214056">ipv6 address 2001:DB8:1::1 64</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen874510327214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword261857785214056">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370681__b1364580301214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1153791471214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword158463113214056">*</span>PE1] <strong id="EN-US_TASK_0172370681__b829574248214056">commit</strong></pre>
<p id="EN-US_TASK_0172370681__p1465551185214056"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen613098498214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword731899862214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370681__b2125511902214056">ip vpn-instance vpn1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen560609900214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword552250358214056">*</span>PE2-vpn-instance-vpn1] <strong id="EN-US_TASK_0172370681__b1272581012214056">ipv6-family</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1184277311214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword79621393214056">*</span>PE2-vpn-instance-vpn1-af-ipv6] <strong id="EN-US_TASK_0172370681__b1984484870214056">route-distinguisher 100:1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen866249380214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword913945651214056">*</span>PE2-vpn-instance-vpn1-af-ipv6] <strong id="EN-US_TASK_0172370681__b892507416214056">vpn-target 1:1 evpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen863315787214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword195543060214056">*</span>PE2-vpn-instance-vpn1-af-ipv6] <strong id="EN-US_TASK_0172370681__b1286657193214056">evpn mpls routing-enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen570618530214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword665086317214056">*</span>PE2-vpn-instance-vpn1-af-ipv6] <strong id="EN-US_TASK_0172370681__b134141932214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen69859817214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1735738798214056">*</span>PE2-vpn-instance-vpn1] <strong id="EN-US_TASK_0172370681__b608163128214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1476071368214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1907346818214056">*</span>PE2] <strong id="EN-US_TASK_0172370681__b1420831575214056">interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen27383675214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword87469839214056">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370681__b422351771214056">ip binding vpn-instance vpn1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1665779580214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1046366653214056">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370681__b942204333214056">ipv6 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen2022343886214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1351401887214056">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370681__b1619521155214056">ipv6 address 2001:DB8:2::1 64</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1245037785214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword845178613214056">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370681__b754470900214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen868407949214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1755360681214056">*</span>PE2] <strong id="EN-US_TASK_0172370681__b799340702214056">commit</strong></pre>
</p></li><li id="EN-US_TASK_0172370681__step910710370214056"><span id="EN-US_TASK_0172370681__cmd1193236421214056">Configure and apply a tunnel policy so that EVPN routes can recurse to SR-MPLS TE tunnels.</span><p><p id="EN-US_TASK_0172370681__p1948872491214056"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1802173987214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword212882703214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370681__b1903870054214056">tunnel-policy srte</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1750565261214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword928152135214056">*</span>PE1-tunnel-policy-srte] <strong id="EN-US_TASK_0172370681__b1928993149214056">tunnel binding destination 3.3.3.3 te Tunnel1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen349569777214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword576126628214056">*</span>PE1-tunnel-policy-srte] <strong id="EN-US_TASK_0172370681__b724777338214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen2011788433214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1479243417214056">*</span>PE1] <strong id="EN-US_TASK_0172370681__b424169504214056">ip vpn-instance vpn1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen760088750214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword2077699126214056">*</span>PE1-vpn-instance-vpn1] <strong id="EN-US_TASK_0172370681__b990053665214056">ipv6-family</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen509244142214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword136460702214056">*</span>PE1-vpn-instance-vpn1-af-ipv6] <strong id="EN-US_TASK_0172370681__b1953230312214056">tnl-policy srte evpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen2093080370214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword592018316214056">*</span>PE1-vpn-instance-vpn1-af-ipv6] <strong id="EN-US_TASK_0172370681__b1775715671214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1577323062214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1637856296214056">*</span>PE1-vpn-instance-vpn1] <strong id="EN-US_TASK_0172370681__b1014039586214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen498327886214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1920923905214056">*</span>PE1] <strong id="EN-US_TASK_0172370681__b1406673938214056">commit</strong></pre>
<p id="EN-US_TASK_0172370681__p951673196214056"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen508906215214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1918584676214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370681__b1388161876214056">tunnel-policy srte</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1618576050214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1199375739214056">*</span>PE2-tunnel-policy-srte] <strong id="EN-US_TASK_0172370681__b1848200554214056">tunnel binding destination 1.1.1.1 te Tunnel1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1971678782214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1960850263214056">*</span>PE2-tunnel-policy-srte] <strong id="EN-US_TASK_0172370681__b1019981305214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1733191597214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword209813370214056">*</span>PE2] <strong id="EN-US_TASK_0172370681__b1315685388214056">ip vpn-instance vpn1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1781989397214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1666349732214056">*</span>PE2-vpn-instance-vpn1] <strong id="EN-US_TASK_0172370681__b43460442214056">ipv6-family</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen885631628214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword980866197214056">*</span>PE2-vpn-instance-vpn1-af-ipv6] <strong id="EN-US_TASK_0172370681__b38180463214056">tnl-policy srte evpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1402955356214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword841487976214056">*</span>PE2-vpn-instance-vpn1-af-ipv6] <strong id="EN-US_TASK_0172370681__b240753875214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen438937771214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1137804738214056">*</span>PE2-vpn-instance-vpn1] <strong id="EN-US_TASK_0172370681__b1235522016214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen401205033214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1358768783214056">*</span>PE2] <strong id="EN-US_TASK_0172370681__b673884287214056">commit</strong></pre>
</p></li><li id="EN-US_TASK_0172370681__step287096147214056"><span id="EN-US_TASK_0172370681__cmd1976671467214056">Establish BGP EVPN peer relationships between PEs.</span><p><p id="EN-US_TASK_0172370681__p233792323214056"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen112254752214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1689295821214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370681__b1747695384214056">bgp 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen342269321214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword931156126214056">*</span>PE1-bgp] <strong id="EN-US_TASK_0172370681__b493919975214056">peer 3.3.3.3 as-number 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen67061548214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1489015283214056">*</span>PE1-bgp] <strong id="EN-US_TASK_0172370681__b1797853395214056">peer 3.3.3.3 connect-interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen2113085629214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1708905598214056">*</span>PE1-bgp] <strong id="EN-US_TASK_0172370681__b1087474588214056">l2vpn-family evpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen2077520765214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword536009043214056">*</span>PE1-bgp-af-evpn] <strong id="EN-US_TASK_0172370681__b2020686086214056">peer 3.3.3.3 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen610125448214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1975209055214056">*</span>PE1-bgp-af-evpn] <strong id="EN-US_TASK_0172370681__b461824085214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1400463419214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1096668911214056">*</span>PE1-bgp] <strong id="EN-US_TASK_0172370681__b1886166745214056">ipv6-family vpn-instance vpn1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1517187458214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword910260188214056">*</span>PE1-bgp-6-vpn1] <strong id="EN-US_TASK_0172370681__b1641327495214056">import-route direct</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen667574819214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword239089126214056">*</span>PE1-bgp-6-vpn1] <strong id="EN-US_TASK_0172370681__b1724693036214056">advertise l2vpn evpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen389472335214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1049806552214056">*</span>PE1-bgp-6-vpn1] <strong id="EN-US_TASK_0172370681__b1778725991214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1221706505214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword918732308214056">*</span>PE1-bgp] <strong id="EN-US_TASK_0172370681__b1481733987214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen572379646214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1316425710214056">*</span>PE1] <strong id="EN-US_TASK_0172370681__b318251068214056">commit</strong></pre>
<p id="EN-US_TASK_0172370681__p1200272405214056"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen693591326214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1926992378214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370681__b366919317214056">bgp 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen827170448214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword316349915214056">*</span>PE2-bgp] <strong id="EN-US_TASK_0172370681__b211266539214056">peer 1.1.1.1 as-number 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen534126360214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword2111750687214056">*</span>PE2-bgp] <strong id="EN-US_TASK_0172370681__b1026050005214056">peer 1.1.1.1 connect-interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen390809089214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword329221700214056">*</span>PE2-bgp] <strong id="EN-US_TASK_0172370681__b486905482214056">l2vpn-family evpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen294338928214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1188740995214056">*</span>PE2-bgp-af-evpn] <strong id="EN-US_TASK_0172370681__b338028188214056">peer 1.1.1.1 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen385607252214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword43045273214056">*</span>PE2-bgp-af-evpn] <strong id="EN-US_TASK_0172370681__b942217214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen300928794214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword2043009677214056">*</span>PE2-bgp] <strong id="EN-US_TASK_0172370681__b145308395214056">ipv6-family vpn-instance vpn1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1883200387214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1151769952214056">*</span>PE2-bgp-6-vpn1] <strong id="EN-US_TASK_0172370681__b2009702711214056">import-route direct</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen923986736214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1131860627214056">*</span>PE2-bgp-6-vpn1] <strong id="EN-US_TASK_0172370681__b777211502214056">advertise l2vpn evpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1916646391214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1985825737214056">*</span>PE2-bgp-6-vpn1] <strong id="EN-US_TASK_0172370681__b177710638214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen541232254214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1208819275214056">*</span>PE2-bgp] <strong id="EN-US_TASK_0172370681__b1499643264214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen2040878957214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1871987452214056">*</span>PE2] <strong id="EN-US_TASK_0172370681__b1863675612214056">commit</strong></pre>
<p id="EN-US_TASK_0172370681__p1758449139214056">After completing the configurations, run the <strong id="EN-US_TASK_0172370681__b166019541214349">display bgp evpn peer</strong> command. The command output shows that BGP peer relationships have been established between PEs and are in the Established state. The following example uses the command output on PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1964598687214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1883232708214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370681__b2081309484214056">display bgp evpn peer</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen2076089801214056"> 
 BGP local router ID : 1.1.1.1
 Local AS number : 100
 Total number of peers : 1                 Peers in established state : 1

  Peer            V          AS  MsgRcvd  MsgSent  OutQ  Up/Down       State  PrefRcv
  3.3.3.3         4         100        9        9     0 00:00:02 Established        5</pre>
</p></li><li id="EN-US_TASK_0172370681__step1226228221214056"><span id="EN-US_TASK_0172370681__cmd1964633735214056">Establish VPN BGP peer relationships between PEs and CEs.</span><p><p id="EN-US_TASK_0172370681__p1587009543214056"># Configure EBGP on PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen103760132214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword559898302214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370681__b494338950214056">bgp 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen163241506214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1358067372214056">*</span>PE1-bgp]<strong id="EN-US_TASK_0172370681__b563247462214056"> ipv6-family vpn-instance vpn1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen705946763214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1614581262214056">*</span>PE1-bgp-6-vpn1] <strong id="EN-US_TASK_0172370681__b2106428029214056">peer 2001:DB8:1::2 as-number 65410</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1755415920214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword833441111214056">*</span>PE1-bgp-6-vpn1] <strong id="EN-US_TASK_0172370681__b619598639214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1096453913214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1110119403214056">*</span>PE1-bgp] <strong id="EN-US_TASK_0172370681__b1815551797214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1367368904214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword446473489214056">*</span>PE1] <strong id="EN-US_TASK_0172370681__b445865416214056">commit</strong></pre>
<p id="EN-US_TASK_0172370681__p1353285534214056"># Configure EBGP on CE1.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1680644211514">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1185113019175"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong id="EN-US_TASK_0172370681__b3806642151516">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1380624261519">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1484419214183">*</span>CE1-LoopBack1] <strong id="EN-US_TASK_0172370681__b1880610429153">ipv6 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen4806144218155">[<span class="keyword" id="EN-US_TASK_0172370681__keyword191612012180">*</span>CE1-LoopBack1] <strong id="EN-US_TASK_0172370681__b10806442101519">ipv6 address 2001:DB8:4::4 128</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1806164211151">[<span class="keyword" id="EN-US_TASK_0172370681__keyword542845751716">*</span>CE1-LoopBack1] <strong id="EN-US_TASK_0172370681__b9806114217155">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen15482524191419">[<span class="keyword" id="EN-US_TASK_0172370681__keyword129101254101718">*</span>CE1] <strong id="EN-US_TASK_0172370681__b24821524161417">interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen548232491416">[<span class="keyword" id="EN-US_TASK_0172370681__keyword144511552161719">*</span>CE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370681__b134821824161414">ipv6 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1648252419148">[<span class="keyword" id="EN-US_TASK_0172370681__keyword2082344901713">*</span>CE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370681__b12483024201413">ipv6 address 2001:DB8:1::2 64</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen748342481414">[<span class="keyword" id="EN-US_TASK_0172370681__keyword99231646141716">*</span>CE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370681__b14831524151416">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1865097271214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1216764201711">*</span>CE1]<strong id="EN-US_TASK_0172370681__b846570795214056"> bgp 65410</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen1891722252214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1737935628214056">*</span>CE1-bgp] <strong id="EN-US_TASK_0172370681__b949884796214056">router-id 4.4.4.4</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen121682189214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword2142069226214056">*</span>CE1-bgp] <strong id="EN-US_TASK_0172370681__b80711218214056">peer 2001:db8:1::1 as-number 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen201994257214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1682343574214056">*</span>CE1-bgp] <strong id="EN-US_TASK_0172370681__b1333220382214056">ipv6-family unicast</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen334292698214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword187542868214056">*</span>CE1-bgp-af-ipv6] <strong id="EN-US_TASK_0172370681__b887718203910">peer 2001:db8:1::1 enable</strong>
[<span class="keyword" id="EN-US_TASK_0172370681__keyword16138983919">*</span>CE1-bgp-af-ipv6] <strong id="EN-US_TASK_0172370681__b5138181993">import-route direct</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen321053177214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1672710345214056">*</span>CE1-bgp-af-ipv6] <strong id="EN-US_TASK_0172370681__b2116329059214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen867515470214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword222864328214056">*</span>CE1-bgp] <strong id="EN-US_TASK_0172370681__b1634520912214056">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen941093633214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword1976622639214056">*</span>CE1] <strong id="EN-US_TASK_0172370681__b1992366968214056">commit</strong></pre>
<p id="EN-US_TASK_0172370681__p301134064214056">The configurations of PE2 and CE2 are similar to those of PE1 and CE1, respectively. For configuration details, see Configuration Files in this section.</p>
</p></li><li id="EN-US_TASK_0172370681__step1351005765214056"><span id="EN-US_TASK_0172370681__cmd1009292624214056">Verify the configuration.</span><p><p id="EN-US_TASK_0172370681__p315603427214056">Run the <strong id="EN-US_TASK_0172370681__b802851530214349">display bgp evpn all routing-table</strong> command on a PE. The command output shows EVPN routes received from the peer PE. The following example uses the command output on PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1970142737214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword213012314214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370681__b1354670490214056">display bgp evpn all routing-table</strong>

 Local AS number : 100

 BGP Local router ID is 1.1.1.1
 Status codes: * - valid, &gt; - best, d - damped, x - best external, a - add path,
               h - history,  i - internal, s - suppressed, S - Stale
               Origin : i - IGP, e - EGP, ? - incomplete

 
 EVPN address family:
 Number of Ip Prefix Routes: 5
 Route Distinguisher: 100:1
       Network(EthTagId/IpPrefix/IpPrefixLen)                 NextHop
 *&gt;    0:[2001:DB8:1::]:64                                    ::
 *                                                            ::2001:DB8:1::2
 *&gt;i   0:[2001:DB8:2::]:64                                    ::FFFF:3.3.3.3
 *&gt;    0:[2001:DB8:4::4]:128                                  ::2001:DB8:1::2
 *&gt;i   0:[2001:DB8:5::5]:128                                  ::FFFF:3.3.3.3  </pre>
<pre class="screen" id="EN-US_TASK_0172370681__screen810494191214056">[<span class="keyword" id="EN-US_TASK_0172370681__keyword401632948214056"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370681__b1342905929214056">display bgp evpn all routing-table prefix-route 0:[2001:DB8:5::5]:128</strong>

 BGP local router ID : 1.1.1.1                                                                                                     
 Local AS number : 100                                                                                                              
 Total routes of Route Distinguisher(100:1): 1                                                                                      
 BGP routing table entry information of 0:[2001:DB8:5::5]:128:                                                                      
 Label information (Received/Applied): 48120/NULL                                                                                   
 From: 3.3.3.3 (3.3.3.3)                                                                                                           
 Route Duration: 0d00h06m08s                                                                                                        
 Relay IP Nexthop: 10.1.1.2                                                                                                         
 Relay IP Out-Interface: GigabitEthernet<span>0/2/0</span>                                                                                               
 Relay Tunnel Out-Interface: GigabitEthernet<span>0/2/0</span>                                                                                          
 Original nexthop: ::FFFF:3.3.3.3                                                                                                   
 Qos information : 0x0                                                                                                              
 Ext-Community: RT &lt;1 : 1&gt;                                                                                                          
 AS-path 65420, origin incomplete, MED 0, localpref 100, pref-val 0, valid, internal, best, select, pre 255, IGP cost 20            
 Route Type: 5 (Ip Prefix Route)                                                                                                    
 Ethernet Tag ID: 0, IPv6 Prefix/Len: 2001:DB8:5::5/128, ESI: 0000.0000.0000.0000.0000, GW IPv6 Address: ::                         
 Not advertised to any peer yet </pre>
<p id="EN-US_TASK_0172370681__p8878144318387">Run the <strong id="EN-US_TASK_0172370681__b1751102764612">display ipv6 routing-table vpn-instance vpn1</strong> command on the PEs to view the VPN instance routing table information. The following example uses the command output on PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1585013716397">[<font style="font-size:8pt" Face="Courier New" >~</font>PE1] <strong id="EN-US_TASK_0172370681__b178671430397">display ipv6 routing-table vpn-instance vpn1</strong>   
Routing Table : vpn1                                                                                                                
         Destinations : 6        Routes : 6                                                                                         

Destination  : 2001:DB8:1::                            PrefixLength : 64                                                            
NextHop      : 2001:DB8:1::1                           Preference   : 0                                                             
Cost         : 0                                       Protocol     : Direct                                                        
RelayNextHop : ::                                      TunnelID     : 0x0                                                           
Interface    : GigabitEthernet<span>0/1/0</span>                    Flags        : D                                                             

Destination  : 2001:DB8:1::1                           PrefixLength : 128                                                           
NextHop      : ::1                                     Preference   : 0                                                             
Cost         : 0                                       Protocol     : Direct                                                        
RelayNextHop : ::                                      TunnelID     : 0x0                                                           
Interface    : GigabitEthernet<span>0/1/0</span>                    Flags        : D                                                             

Destination  : 2001:DB8:2::                            PrefixLength : 64                                                            
NextHop      : ::FFFF:3.3.3.3                          Preference   : 255                                                           
Cost         : 0                                       Protocol     : IBGP                                                          
RelayNextHop : ::FFFF:0.0.0.0                          TunnelID     : 0x000000000300000001                                          
Interface    : Tunnel1                                 Flags        : RD                                                            

Destination  : 2001:DB8:4::4                           PrefixLength : 128                                                           
NextHop      : 2001:DB8:1::2                           Preference   : 255 
Cost         : 0                                       Protocol     : EBGP                                                          
RelayNextHop : 2001:DB8:1::2                           TunnelID     : 0x0                                                           
Interface    : GigabitEthernet<span>0/1/0</span>                    Flags        : RD                                                            

Destination  : 2001:DB8:5::5                           PrefixLength : 128                                                           
NextHop      : ::FFFF:3.3.3.3                          Preference   : 255                                                           
Cost         : 0                                       Protocol     : IBGP                                                          
RelayNextHop : ::FFFF:0.0.0.0                          TunnelID     : 0x000000000300000001                                          
Interface    : Tunnel1                                 Flags        : RD                                                            

Destination  : FE80::                                  PrefixLength : 10                                                            
NextHop      : ::                                      Preference   : 0                                                             
Cost         : 0                                       Protocol     : Direct                                                        
RelayNextHop : ::                                      TunnelID     : 0x0                                                           
Interface    : NULL0                                   Flags        : DB </pre>
<p id="EN-US_TASK_0172370681__p125011620174017">Run the <strong id="EN-US_TASK_0172370681__b52271523124718">display ipv6 routing-table brief</strong> command on the CEs to view the IPv6 routing table information. The following example uses the command output on CE1.</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1928971934215">[<font style="font-size:8pt" Face="Courier New" >~</font>CE1] <strong id="EN-US_TASK_0172370681__b19158112712429">display ipv6 routing-table brief</strong>   
Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route                                              
------------------------------------------------------------------------------                                                      
Routing Table : _public_                                                                                                            
         Destinations : 9        Routes : 9                                                                                         
Format :                                                                                                                            
Destination/Mask                             Protocol                                                                               
Nexthop                                      Interface                                                                              
------------------------------------------------------------------------------                                                      
 ::1/128                                     Direct                                                                                 
  ::1                                        InLoopBack0                                                                            
 ::FFFF:127.0.0.0/104                        Direct                                                                                 
  ::FFFF:127.0.0.1                           InLoopBack0                                                                            
 ::FFFF:127.0.0.1/128                        Direct                                                                                 
  ::1                                        InLoopBack0                                                                            
 2001:DB8:1::/64                             Direct                                                                                 
  2001:DB8:1::2                              GigabitEthernet<span>0/1/0</span>                                                                          
 2001:DB8:1::2/128                           Direct                                                                                 
  ::1                                        GigabitEthernet<span>0/1/0</span>                                                                          
 2001:DB8:2::/64                             EBGP                                                                                   
  2001:DB8:1::1                              GigabitEthernet<span>0/1/0</span>                                                                          
 2001:DB8:4::4/128                           Direct                                                                                 
  ::1                                        LoopBack1                                                                              
 2001:DB8:5::5/128                           EBGP 
  2001:DB8:1::1                              GigabitEthernet<span>0/1/0</span>                                                                          
 FE80::/10                                   Direct                                                                                 
  ::                                         NULL0 </pre>
<p id="EN-US_TASK_0172370681__p525673315415">The CEs can ping each other. For example, CE1 can ping CE2 (2001:DB8:5::5).</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen2721256124114">[<font style="font-size:8pt" Face="Courier New" >~</font>CE1] <strong id="EN-US_TASK_0172370681__b184386264220">ping ipv6 2001:DB8:5::5</strong>                                                                                                       
  PING 2001:DB8:5::5 : 56  data bytes, press CTRL_C to break                                                                        
    Reply from 2001:DB8:5::5                                                                                                        
    bytes=56 Sequence=1 hop limit=61 time=385 ms                                                                                    
    Reply from 2001:DB8:5::5                                                                                                        
    bytes=56 Sequence=2 hop limit=61 time=24 ms                                                                                     
    Reply from 2001:DB8:5::5                                                                                                        
    bytes=56 Sequence=3 hop limit=61 time=25 ms                                                                                     
    Reply from 2001:DB8:5::5                                                                                                        
    bytes=56 Sequence=4 hop limit=61 time=24 ms                                                                                     
    Reply from 2001:DB8:5::5                                                                                                        
    bytes=56 Sequence=5 hop limit=61 time=18 ms                                                                                     

  --- 2001:DB8:5::5 ping statistics---                                                                                              
    5 packet(s) transmitted                                                                                                         
    5 packet(s) received                                                                                                            
    0.00% packet loss                                                                                                               
    round-trip min/avg/max=18/95/385 ms</pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172370681__file1"><a name="EN-US_TASK_0172370681__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul id="EN-US_TASK_0172370681__ul1578296086214056"><li id="EN-US_TASK_0172370681__li402559742214056"><p id="EN-US_TASK_0172370681__p1248095744214056"><a name="EN-US_TASK_0172370681__li402559742214056"></a><a name="li402559742214056"></a>PE1 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1195417065214056">#
sysname PE1
#
ip vpn-instance vpn1
 ipv6-family
  route-distinguisher 100:1
<span>  apply-label per-instance</span>
  vpn-target 1:1 export-extcommunity evpn
  vpn-target 1:1 import-extcommunity evpn
  tnl-policy srte evpn
  evpn mpls routing-enable
#
mpls lsr-id 1.1.1.1
#               
mpls
 mpls te
#
explicit-path pe1tope2
 next sid label 48140 type adjacency index 1
 next sid label 48141 type adjacency index 2
#
segment-routing
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 00.1111.1111.1111.00
 traffic-eng level-2
 segment-routing mpls
 segment-routing global-block 153616 153800
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip binding vpn-instance vpn1
 ipv6 enable
 ipv6 address 2001:DB8:1::1/64
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.1.1.1 255.255.255.0
 isis enable 1
#
interface LoopBack1
 ip address 1.1.1.1 255.255.255.255
 isis enable 1
 isis prefix-sid absolute 153700 
#
interface Tunnel1
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 3.3.3.3
 mpls te signal-protocol segment-routing
 mpls te reserved-for-binding
 mpls te tunnel-id 1
 mpls te path explicit-path pe1tope2  
#
bgp 100
 peer 3.3.3.3 as-number 100
 peer 3.3.3.3 connect-interface LoopBack1
 #
 ipv4-family unicast
  undo synchronization
  peer 3.3.3.3 enable
 #
 ipv6-family vpn-instance vpn1
  import-route direct
  advertise l2vpn evpn
  peer 2001:DB8:1::2 as-number 65410
 #
 l2vpn-family evpn
  policy vpn-target
  peer 3.3.3.3 enable
#
tunnel-policy srte
 tunnel binding destination 3.3.3.3 te Tunnel1
#
return</pre>
</li><li id="EN-US_TASK_0172370681__li616014520214056"><p id="EN-US_TASK_0172370681__p337375453214056"><a name="EN-US_TASK_0172370681__li616014520214056"></a><a name="li616014520214056"></a>P configuration file</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1849882657214056">#
sysname P
#
mpls lsr-id 2.2.2.2
#
mpls
 mpls te
#
segment-routing
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 00.1111.1111.2222.00
 traffic-eng level-2
 segment-routing mpls
 segment-routing global-block 153616 153800
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.1.2 255.255.255.0
 isis enable 1
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.2.1.1 255.255.255.0
 isis enable 1
#
interface LoopBack1
 ip address 2.2.2.2 255.255.255.255
 isis enable 1
 isis prefix-sid absolute 153710 
#
return</pre>
</li><li id="EN-US_TASK_0172370681__li1925285970214056"><p id="EN-US_TASK_0172370681__p2145188441214056"><a name="EN-US_TASK_0172370681__li1925285970214056"></a><a name="li1925285970214056"></a>PE2 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1459058535214056">#
sysname PE2
#
ip vpn-instance vpn1
 ipv6-family
  route-distinguisher 100:1
<span>  apply-label per-instance</span>
  vpn-target 1:1 export-extcommunity evpn
  vpn-target 1:1 import-extcommunity evpn
  tnl-policy srte evpn
  evpn mpls routing-enable
#
mpls lsr-id 3.3.3.3
#               
mpls
 mpls te
#
explicit-path pe2tope1
 next sid label 48240 type adjacency index 1
 next sid label 48241 type adjacency index 2
#
segment-routing
#
isis 1
 is-level level-2
 cost-style wide
 network-entity 00.1111.1111.3333.00
 traffic-eng level-2
 segment-routing mpls
 segment-routing global-block 153616 153800
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip binding vpn-instance vpn1
 ipv6 enable
 ipv6 address 2001:DB8:2::1/64
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.2.1.2 255.255.255.0
 isis enable 1
#
interface LoopBack1
 ip address 3.3.3.3 255.255.255.255
 isis enable 1
 isis prefix-sid absolute 153720 
#
interface Tunnel1
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 1.1.1.1
 mpls te signal-protocol segment-routing
 mpls te reserved-for-binding
 mpls te tunnel-id 1
 mpls te path explicit-path pe2tope1  
#
bgp 100
 peer 1.1.1.1 as-number 100
 peer 1.1.1.1 connect-interface LoopBack1
 #
 ipv4-family unicast
  undo synchronization
  peer 1.1.1.1 enable
 #
 ipv6-family vpn-instance vpn1
  import-route direct
  advertise l2vpn evpn
  peer 2001:DB8:2::2 as-number 65420
 #
 l2vpn-family evpn
  policy vpn-target
  peer 1.1.1.1 enable
#
tunnel-policy srte
 tunnel binding destination 1.1.1.1 te Tunnel1
#
return</pre>
</li><li id="EN-US_TASK_0172370681__li1413289480214056"><p id="EN-US_TASK_0172370681__p1987154540214056"><a name="EN-US_TASK_0172370681__li1413289480214056"></a><a name="li1413289480214056"></a>CE1 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1911799396214056">#
sysname CE1
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:1::2/64
#
interface LoopBack1
 ipv6 enable    
 ipv6 address 2001:DB8:4::4/128
#
bgp 65410
 router-id 4.4.4.4
 peer 2001:DB8:1::1 as-number 100
 #
 ipv4-family unicast
  undo synchronization
 #
 ipv6-family unicast
  undo synchronization
  import-route direct
  peer 2001:DB8:1::1 enable
#
return</pre>
</li><li id="EN-US_TASK_0172370681__li1458671865214056"><p id="EN-US_TASK_0172370681__p224720903214056"><a name="EN-US_TASK_0172370681__li1458671865214056"></a><a name="li1458671865214056"></a>CE2 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172370681__screen1138499217214056">#
sysname CE2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:DB8:2::2/64
#               
interface LoopBack1
 ipv6 enable
 ipv6 address 2001:DB8:5::5/128
#
bgp 65420
 router-id 5.5.5.5
 peer 2001:DB8:2::1 as-number 100
 #
 ipv4-family unicast
  undo synchronization
 #
 ipv6-family unicast
  undo synchronization
  import-route direct
  peer 2001:DB8:2::1 enable
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0010.html">EVPN Configuration Examples
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_srv6_cfg_0010.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0185.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>