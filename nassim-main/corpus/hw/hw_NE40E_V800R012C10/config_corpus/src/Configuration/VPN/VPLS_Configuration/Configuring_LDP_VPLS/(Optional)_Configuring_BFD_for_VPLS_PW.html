
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring BFD for VPLS PW">
<meta name="abstract" content="After a PW is configured for a VPLS using LDP as signaling, BFD can be configured to monitor the primary PW so that traffic can be immediately switched to the secondary PW in case of a primary PW fault.">
<meta name="description" content="After a PW is configured for a VPLS using LDP as signaling, BFD can be configured to monitor the primary PW so that traffic can be immediately switched to the secondary PW in case of a primary PW fault.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_5003.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_vpls_cfg_5012_1.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_5008.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,vpls,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00415692">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00415692">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172370107">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring BFD for VPLS PW</title>
</head>
<body><a name="EN-US_TASK_0172370107"></a><a name="EN-US_TASK_0172370107"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring BFD for VPLS PW</h1>
<div class="taskbody"><p>After a PW is configured for a VPLS using LDP as signaling, BFD can be configured to monitor the primary PW so that traffic can be immediately switched to the secondary PW in case of a primary PW fault.</p>
<div class="context"><a name="EN-US_TASK_0172370107__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>On a VPLS LDP network, you can configure BFD to detect PW faults, which quickens link fault detection and enhances application-layer service protection.</p>
<p>Currently, static BFD and dynamic BFD are supported. Determine which one to use as needed.</p>
<h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before you configure BFD to detect the connectivity of a VPLS PW, complete the following tasks:</p>
<ul><li><p>Configure network-layer parameters for devices to communicate.</p>
</li><li><p>Configure PWs.</p>
</li><li>If a remote peer cannot identify the BFD CV Type field value 0x08 used for VCCV, run the <a href="cmdqueryname=mpls+l2vpn+vccv+bfd-cv-negotiation"><b><span class="cmdname">mpls l2vpn vccv bfd-cv-negotiation</span></b></a> command to change the BFD CV Type field value carried in a Label Mapping message to be consistent with the remote peer's.</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>The control word mode of static BFD for VPLS PW does not support the 0x10 or 0x20 BFD CV type. If the PW-negotiated CV values on both ends are 0x10 or 0x20, the BFD session cannot go up after negotiation.</p>
</li><li><div class="p">If dynamic BFD for VPLS is configured and the BFD CV Type field is negotiated to be 0x10 or 0x20 for the peers, the MTU value of the interface through which BFD control packets are transmitted cannot be less than the BFD control packet length. A BFD control packet's payload is in one of the following lengths:<ul><li>Non-authentication: 24 bytes</li><li>MD5 authentication: 48 bytes (For the sake of security, using the HMAC-SHA256 algorithm rather than the MD5 algorithm is recommended.)</li><li>SHA1 authentication: 52 bytes</li></ul>
</div>
</li><li>For security purposes, you are advised not to use weak security algorithms in this feature. If you need to use such an algorithm, run the <a href="cmdqueryname=undo+crypto+weak-algorithm+disable"><b><span class="cmdname">undo crypto weak-algorithm disable</span></b></a> command to enable the weak security algorithm function.</li></ul>
</div></div>
</div>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172370107__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure a static BFD session.</span><p></p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a></span><p><p>BFD is enabled globally, and the global BFD view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a> <i><span class="varname">session-name</span></i> <strong><span>bind pw</span></strong> <strong><span>vsi</span></strong> <i><span class="varname">vsi-name</span></i> <strong><span>peer</span></strong> <i><span class="varname">peer-address</span></i> [ <strong><span>vc-id</span></strong> <i><span class="varname">vc-id</span></i> ] [ <strong><span>remote-peer</span></strong> <i><span class="varname">remote-peer-address</span></i> <strong><span>pw-ttl</span></strong> { <strong><span>auto-calculate</span></strong> | <i><span class="varname">ttl-number</span></i> } ]</span><p><p>BFD configuration items are created.</p>
</p></li><li class="substepexpand"><span>Configure BFD session discriminators:</span><p><ul><li><p>To configure the local discriminator, run the <a href="cmdqueryname=discriminator"><b><span class="cmdname">discriminator</span></b></a> <strong><span>local</span></strong> <i><span class="varname">discr-value</span></i> command.</p>
</li><li><p>To configure the remote discriminator, run the <a href="cmdqueryname=discriminator"><b><span class="cmdname">discriminator</span></b></a> <strong><span>remote</span></strong> <i><span class="varname">discr-value</span></i> command.</p>
</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The local BFD session discriminator on one end must be the same as the remote BFD session discriminator on the other end.</p>
</div></div>
</p></li><li class="substepexpand"><span>(Optional) Configure BFD for VPLS LDP PW.</span><p><ol type="a"><li>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</li><li>Run the <a href="cmdqueryname=vsi"><b><span class="cmdname">vsi</span></b></a> <i><span class="varname">vsi-name</span></i> command to enter the view of the created VSI.</li><li>Run the <a href="cmdqueryname=pwsignal"><b><span class="cmdname">pwsignal</span></b></a> <strong><span>ldp</span></strong> command to enter the VSI-LDP view.</li><li>Run the <strong><a href="cmdqueryname=vsi-id"><b><span class="cmdname">vsi-id</span></b></a></strong> <i><span class="varname">vsi-id</span></i> command to configure an ID for the VSI.</li><li>Run the <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a><i><span class="varname"> peer-address</span></i> [ <strong><span>negotiation-vc-id</span></strong> <i><span class="varname">vc-id</span></i> ] <strong><span>pw</span></strong> <i><span class="varname">pw-name</span></i> command to enter the VSI-LDP-PW view.</li><li>Run the <a href="cmdqueryname=track+bfd"><b><span class="cmdname">track bfd</span></b></a> <i><span class="varname">bfd-session</span></i> command to configure BFD for VPLS LDP PW.<p>In a VPLS PW redundancy protection scenario, a BD is used for interworking between a VPLS network and a VXLAN network. If a fault occurs on the VXLAN side, the VPLS PW cannot detect the VXLAN fault. As a result, PW switching fails. After this command is run, a PW can detect VXLAN faults. If BFD detects a down event, it triggers PW status switching to implement protection switching.</p>
</li></ol>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p><p><p>If the status of a service PW is down, the BFD session can be established but cannot go up.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>BFD for PW must be configured or cancelled on both endpoint PEs of a PW. Otherwise, the PW status on the endpoint PEs may be inconsistent.</li><li><p>If you want to modify the parameters of an existing BFD session, run corresponding commands, such as <a href="cmdqueryname=min-tx-interval"><b><span class="cmdname">min-tx-interval</span></b></a>, <a href="cmdqueryname=min-rx-interval"><b><span class="cmdname">min-rx-interval</span></b></a>, and <a href="cmdqueryname=detect-multiplier"><b><span class="cmdname">detect-multiplier</span></b></a>.</p>
</li></ul>
</div></div>
</p></li></ol>
</li><li><span>Configure a dynamic BFD session.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a></span><p><p>BFD is enabled globally, and the global BFD view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Trigger the establishment of a dynamic BFD session.</span><p><div class="p"><ol type="a"><li>Run the <a href="cmdqueryname=vsi"><b><span class="cmdname">vsi</span></b></a> <i><span class="varname">vsi-name</span></i> command to enter the VSI view.</li><li>Run the <a href="cmdqueryname=pwsignal"><b><span class="cmdname">pwsignal</span></b></a> <strong><span>ldp</span></strong> command to enter the VSI-LDP view.</li><li>Run the <a href="cmdqueryname=vsi-id"><b><span class="cmdname">vsi-id</span></b></a> <i><span class="varname">vsi-id</span></i> command to configure an ID for the VSI.</li><li>Run the <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">peer-address</span></i> command to configure a peer for the VSI.</li><li>Run the <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">peer-address</span></i> <strong><span>pw</span></strong> <i><span class="varname">pw-name</span></i> command to configure a VSI-LDP-PW template.</li><li>Run the <a href="cmdqueryname=control-word+enable"><b><span class="cmdname">control-word enable</span></b></a> command to configure the control word function for the VSI.</li><li>Run the <a href="cmdqueryname=bfd-detect"><b><span class="cmdname">bfd-detect</span></b></a> [ <strong><span>detect-multiplier</span></strong> <i><span class="varname">multiplier</span></i> | <strong><span>min-rx-interval</span></strong> <i><span class="varname">rx-interval</span></i> | <strong><span>min-tx-interval</span></strong> <i><span class="varname">tx-interval</span></i> | <strong><span>option-tlv</span></strong> ] * [ <strong><span>track</span></strong> <strong><span>group</span></strong> <i><span class="varname">group-name</span></i> ] command to configure dynamic BFD for VPLS PW.<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p">The parameters are described as follows:<ul><li><p><strong><span>detect-multiplier</span></strong> <i><span class="varname">multiplier</span></i> indicates the BFD detection multiplier.</p>
</li><li><p><strong><span>min-rx-interval</span></strong> <i><span class="varname">rx-interval</span></i> indicates the Required Min Rx Interval (RMRI), which is the supported minimum interval at which the local device receives BFD control packets.</p>
</li><li><p><strong><span>min-tx-interval</span></strong> <i><span class="varname">tx-interval</span></i> indicates the Desired Min Tx Interval (DMTI), which is the desired minimum interval at which the local device sends BFD control packets.</p>
</li></ul>
</div>
<div class="p">The BFD detection parameters actually used may be different from the ones configured:<ul><li><p>Actual local detection interval = Actual interval at which the local device receives BFD control packets x Configured remote BFD detection multiplier</p>
</li><li><p>Actual interval at which the local device receives BFD control packets = Max { Configured remote DMTI, Configured local RMRI }</p>
</li><li><p>Actual interval at which the local device transmits BFD control packets = Max { Configured local DMTI, Configured remote RMRI }</p>
</li></ul>
</div>
</div></div>
</li><li>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the VSI view.</li><li>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</li></ol>
</div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
<div class="postreq"><a name="EN-US_TASK_0172370107__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><div class="p">After configuring BFD for VPLS PW, verify the configuration.<ul><li>Run the <a href="cmdqueryname=display+bfd+session"><b><span class="cmdname">display bfd session</span></b></a> command to check BFD session configurations.</li></ul>
</div>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_5003.html">Configuring LDP VPLS
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_vpls_cfg_5012_1.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_5008.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>