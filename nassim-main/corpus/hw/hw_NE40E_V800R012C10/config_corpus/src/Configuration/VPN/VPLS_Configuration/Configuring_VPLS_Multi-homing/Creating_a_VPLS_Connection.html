
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Creating a VPLS Connection">
<meta name="abstract" content="When configuring VPLS multi-homing, you need to create VSIs, configure BGP signaling, RDs, and VPN targets, and create VPLS connections.">
<meta name="description" content="When configuring VPLS multi-homing, you need to create VSIs, configure BGP signaling, RDs, and VPN targets, and create VPLS connections.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_6036.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_6037.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_6039.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,vpls,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00415692">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00545680">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172370206">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Creating a VPLS Connection</title>
</head>
<body><a name="EN-US_TASK_0172370206"></a><a name="EN-US_TASK_0172370206"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Creating a VPLS Connection</h1>
<div class="taskbody"><p>When configuring VPLS multi-homing, you need to create VSIs, configure BGP signaling, RDs, and VPN targets, and create VPLS connections.</p>
<div class="steps"><a name="EN-US_TASK_0172370206__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=mpls+l2vpn"><b><span class="cmdname">mpls l2vpn</span></b></a></span><p><p>MPLS L2VPN is enabled, and its view is displayed.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=bgp-vpn+label-block-size"><b><span class="cmdname">bgp-vpn label-block-size</span></b></a> <i><span class="varname">size-value</span></i></span><p><p>The L2VPN label block size is configured.</p>
</p></li><li><span>Run <a href="cmdqueryname=vsi"><b><span class="cmdname">vsi</span></b></a> <i><span class="varname">vsi-name</span></i></span><p><p>A VSI is created.</p>
</p></li><li><span>Run <a href="cmdqueryname=pwsignal+bgp+multi-homing"><b><span class="cmdname">pwsignal bgp multi-homing</span></b></a></span><p><p>VPLS multi-homing is enabled.</p>
</p></li><li><span>Run <a href="cmdqueryname=route-distinguisher"><b><span class="cmdname">route-distinguisher</span></b></a> <i><span class="varname">route-distinguisher</span></i></span><p><p>An RD is configured for the VSI.</p>
</p><p><p>After configuring multi-homing as the PW signaling protocol for a VSI, you must configure an RD before performing other configurations.</p>
<p>Configuring different RDs for different PEs is recommended.</p>
</p></li><li><span>Run <a href="cmdqueryname=vpn-target"><b><span class="cmdname">vpn-target</span></b></a> <i><span class="varname">vpn-target</span></i> &amp;&lt;1-16&gt; [ <strong><span>both</span></strong> | <strong><span>export-extcommunity</span></strong> | <strong><span>import-extcommunity</span></strong> ]</span><p><p>VPN targets are configured for the VSI.</p>
</p><p><p>When using this command, note the mapping between the VPN target attribute on the local end and that on the remote end. Specifically:</p>
<ul><li><p><strong><span>export-extcommunity</span></strong> on the local end is the same as <strong><span>import-extcommunity</span></strong> on the peer end.</p>
</li><li><p><strong><span>import-extcommunity</span></strong> on the local end is the same as <strong><span>export-extcommunity</span></strong> on the peer end.</p>
</li></ul>
</p></li><li><span>Run <a href="cmdqueryname=site-range"><b><span class="cmdname">site-range</span></b></a> <i><span class="varname">site-range</span></i> [ <strong><span>default-offset</span></strong> { <strong><span>0</span></strong> | <strong><span>1</span></strong> } ]</span><p><p>The multi-homing site range is configured.</p>
</p></li><li><span>Perform operations in either of the following scenario as needed:</span><p><ul><li>In a VPLS multi-homing scenario where a CE is single-homed to a PE:<ol type="a"><li>Run the <a href="cmdqueryname=site+default"><b><span class="cmdname">site default</span></b></a> command to enter the default VSI-BGP-SITE view.<p>After the <a href="cmdqueryname=pwsignal+bgp+multi-homing"><b><span class="cmdname">pwsignal bgp multi-homing</span></b></a> command is run, the system automatically generates a default multi-homing site for the single-homing PE. After the default multi-homing site is generated, run the <a href="cmdqueryname=site+default"><b><span class="cmdname">site default</span></b></a> command to enter the default VSI-BGP-SITE view.</p>
</li><li>Run the <a href="cmdqueryname=site-id"><b><span class="cmdname">site-id</span></b></a> <i><span class="varname">site-id</span></i> command to configure the multi-homing site ID.</li><li>(Optional) Run the <a href="cmdqueryname=preference"><b><span class="cmdname">preference</span></b></a> <i><span class="varname">preference</span></i> command to configure the multi-homing site preference.</li></ol>
</li><li>In a VPLS multi-homing scenario where a CE is multi-homed to PEs:<ol type="a"><li>Run the <a href="cmdqueryname=site+name"><b><span class="cmdname">site name</span></b></a> <i><span class="varname">site-name</span></i> command to create a multi-homing site and enter the VSI-BGP-SITE view.</li><li>Run the <a href="cmdqueryname=site-id"><b><span class="cmdname">site-id</span></b></a> <i><span class="varname">site-id</span></i> command to configure the multi-homing site ID.</li><li id="EN-US_TASK_0172370206__li_c"><a name="EN-US_TASK_0172370206__li_c"></a><a name="li_c"></a>Run the <a href="cmdqueryname=best-site"><b><span class="cmdname">best-site</span></b></a> command to configure the multi-homing site as the optimal one.<p>In a VPLS multi-homing scenario, the system selects a site for PW establishment based on the AC state (ACS), multi-homing site preference (PREF), and PE's router ID (PE-ID). However, the site selected may differ if the ACS, PREF, or PE-ID value changes, causing frequent PW changes. To prevent frequent PW changes, run the <a href="cmdqueryname=best-site"><b><span class="cmdname">best-site</span></b></a> command to specify an optimal multi-homing site so that the endpoint PEs will use the optimal site for PW establishment.</p>
<p>This step is mutually exclusive with <a href="#EN-US_TASK_0172370206__li_e">9.e</a> and <a href="#EN-US_TASK_0172370206__li_f">9.f</a>.</p>
</li><li>(Optional) Run the <a href="cmdqueryname=preference"><b><span class="cmdname">preference</span></b></a> <i><span class="varname">preference</span></i> command to configure the multi-homing site preference.</li><li id="EN-US_TASK_0172370206__li_e"><a name="EN-US_TASK_0172370206__li_e"></a><a name="li_e"></a>(Optional) Run the <a href="cmdqueryname=active+delay-time"><b><span class="cmdname">active delay-time</span></b></a> <i><span class="varname">delay-time</span></i> command to configure a time period during which an AC interface remains in the blocked state.<p>This step is mutually exclusive with <a href="#EN-US_TASK_0172370206__li_c">9.c</a>.</p>
</li><li id="EN-US_TASK_0172370206__li_f"><a name="EN-US_TASK_0172370206__li_f"></a><a name="li_f"></a>(Optional) Run the <a href="cmdqueryname=recover+delay-time"><b><span class="cmdname">recover delay-time</span></b></a> <i><span class="varname">delay-time</span></i> command to configure the delay time after which an AC interface becomes active upon device restart.<p>This step is mutually exclusive with <a href="#EN-US_TASK_0172370206__li_c">9.c</a>.</p>
</li></ol>
</li></ul>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">peer-address</span></i> <strong><span>pw</span></strong> <i><span class="varname">pw-name</span></i></span><p><p>A PW is created, and the VSI-BGP-PW view is displayed.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=pw"><b><span class="cmdname">pw</span></b></a> <i><span class="varname">pw-name</span></i></span><p><p>The VSI-BGP-PW view is displayed.</p>
</p><p><p>After you create the PW in Step 10, you can run this command in the VSI-BGP-MH view to enter the VSI-BGP-PW view.</p>
</p></li><li><span>(Optional) Run one of the following commands to configure BUM traffic suppression for the BGP VPLS VSI:</span><p><ul><li>To set the maximum rate of broadcast traffic that is allowed to pass, run the <a href="cmdqueryname=broadcast-suppression"><b><span class="cmdname">broadcast-suppression</span></b></a> <strong><span>cir</span></strong> <i><span class="varname">cir-value</span></i> [ <strong><span>cbs</span></strong> <i><span class="varname">cbs-value</span></i> ] command.</li><li>To set the maximum rate of multicast traffic that is allowed to pass, run the <a href="cmdqueryname=multicast-suppression"><b><span class="cmdname">multicast-suppression</span></b></a> <strong><span>cir</span></strong> <i><span class="varname">cir-value</span></i> [ <strong><span>cbs</span></strong> <i><span class="varname">cbs-value</span></i> ] command.</li><li>To set the maximum rate of unknown unicast traffic that is allowed to pass, run the <a href="cmdqueryname=unknown-unicast-suppression"><b><span class="cmdname">unknown-unicast-suppression</span></b></a> <strong><span>cir</span></strong> <i><span class="varname">cir-value</span></i> [ <strong><span>cbs</span></strong> <i><span class="varname">cbs-value</span></i> ] command.</li></ul>
<p>If the actual traffic rate reaches the configured maximum limit, excess packets are discarded.</p>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_6036.html">Configuring VPLS Multi-homing
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_6037.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_6039.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>