
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring One-Label-per-Next-Hop Label Distribution">
<meta name="abstract" content="To save label resources on a PE, configure one-label-per-next-hop label distribution on the PE. Only one label is allocated to the VPNv4 routes that have the same next-hop address and outgoing label.">
<meta name="description" content="To save label resources on a PE, configure one-label-per-next-hop label distribution on the PE. Only one label is allocated to the VPNv4 routes that have the same next-hop address and outgoing label.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0154.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0158.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0159.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,l3vpnvrp,w00556928,l00468467,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="h00847023">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00847023">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369258">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring One-Label-per-Next-Hop Label Distribution</title>
</head>
<body><a name="EN-US_TASK_0172369258"></a><a name="EN-US_TASK_0172369258"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring One-Label-per-Next-Hop Label Distribution</h1>
<div class="taskbody"><p>To save label resources on a PE, configure one-label-per-next-hop label distribution on the PE. Only one label is allocated to the VPNv4 routes that have the same next-hop address and outgoing label.</p>
<div class="context"><a name="EN-US_TASK_0172369258__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>In the scenario where multiple CEs access a PE, if the PE needs to send large numbers of VPNv4 routes to its peer but the MPLS labels are inadequate, configure one-label-per-next-hop label distribution on the PE. Then the PE allocates only one label to the VPNv4 routes that have the same next-hop address and outgoing label, which greatly saves label resources.</p>
<p>Perform the following steps on a PE.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172369258__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></span><p><p>The VPN instance view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a></span><p><p>The VPN instance IPv4 address family view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=apply-label+per-nexthop"><b><span class="cmdname">apply-label per-nexthop</span></b></a></span><p><p>One-label-per-next-hop label distribution for VPNv4 routes is enabled on the PE.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>After one-label-per-next-hop label distribution is enabled or disabled, the label allocated by the PE to a route changes, which leads to a transient loss of VPN packets.</p>
</div></div>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=apply-label+per-nexthop+pop-go"><b><span class="cmdname">apply-label per-nexthop pop-go</span></b></a></span><p><p>The device is configured to assign a unique label to each next hop used by routes sent from its VPN instance IPv4 address family to its BGP VPNv4 peer and forward the data packets received from its BGP VPNv4 peer through outbound interfaces found in the local ILM.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In VPN instance IPv4 address family view, the <a href="cmdqueryname=apply-label+per-nexthop+pop-go"><b><span class="cmdname">apply-label per-nexthop pop-go</span></b></a> and <a href="cmdqueryname=apply-label+per-nexthop"><b><span class="cmdname">apply-label per-nexthop</span></b></a> commands are overwritten. The latest configuration overrides the previous one.</p>
</div></div>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0172369258__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After completing the configurations, you can run the <a href="cmdqueryname=display+ip+vpn-instance"><b><span class="cmdname">display ip vpn-instance</span></b></a> <strong><span>verbose</span></strong> to view details on VPN instances.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0154.html">Configuring a Basic BGP/MPLS IP VPN
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0158.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0159.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>