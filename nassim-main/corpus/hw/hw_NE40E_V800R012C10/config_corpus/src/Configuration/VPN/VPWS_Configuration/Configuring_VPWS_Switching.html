
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring VPWS Switching">
<meta name="abstract" content="After VPWS switching is configured, PW labels are switched during traffic forwarding over an MS-PW.">
<meta name="description" content="After VPWS switching is configured, PW labels are switched during traffic forwarding over an MS-PW.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_3000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6042.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_5007.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00415692">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00415692">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369833">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring VPWS Switching</title>
</head>
<body><a name="EN-US_TASK_0172369833"></a><a name="EN-US_TASK_0172369833"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring VPWS Switching</h1>
<div class="taskbody"><p>After VPWS switching is configured, PW labels are switched during traffic forwarding over an MS-PW.</p>
<div class="context"><a name="EN-US_TASK_0172369833__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>An MS-PW requires PW label switching when forwarding traffic, necessitating the configuration of VPWS switching. VPWS switching needs to be configured on a high-performance SPE that is capable of establishing a large number of MPLS LDP sessions.</p>
<p>VPWS switching is required in the following scenarios:</p>
<ul><li>Two PEs are in different ASs, and no signaling connection or tunnel can be set up between the two PEs.</li><li>The signaling of one PE differs from that of the other PE.</li><li>If access devices support MPLS but cannot set up large numbers of LDP sessions, you can use the user facing provider edge (UFPE) as the UPE and the SPE as the LDP session switching node (similar to the signaling reflector).</li></ul>
<p>VPWS switching can be <span>static, </span>dynamic<span>, or hybrid</span>. Determine which type to use according to the actual situation.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369833__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring dynamic VPWS switching, complete the following tasks:</p>
<ul><li><p>Enable MPLS L2VPN on each PE.</p>
</li><li><p><a href="dc_vrp_vpws_cfg_6000.html">Configure SVC VPWS</a> on UPEs if static VPWS switching is required.</p>
</li><li><p><a href="dc_vrp_vpws_cfg_3004.html">Configure LDP VPWS</a> on UPEs if dynamic VPWS switching is required.</p>
</li></ul>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172369833__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure static VPWS switching.</span><p><p>Perform the following configurations on the SPE.</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view of the SPE is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mpls+switch-l2vc"><b><span class="cmdname">mpls switch-l2vc</span></b></a> <i><span class="varname">ip-address vc-id</span></i> <strong><span>trans</span></strong> <i><span class="varname">trans-label</span></i> <strong><span>recv</span></strong> <i><span class="varname">received-label</span></i><span> [ <strong><span>oam-packet pop flow-label</span></strong> ]</span> [ <strong><span>tunnel-policy</span></strong> <i><span class="varname">policy-name</span></i><span> [ { <strong><span>endpoint</span></strong> <i><span class="varname">endpoint-address</span></i> | [ <strong><span>endpoint</span></strong> <i><span class="varname">endpoint4-address</span></i> ] } <strong><span>color</span></strong> <i><span class="varname">color-value</span></i> ]</span> ] <strong><span>between</span></strong> <i><span class="varname">ip-address vc-id</span></i> <strong><span>trans</span></strong> <i><span class="varname">trans-label</span></i> <strong><span>recv</span></strong> <i><span class="varname">received-label</span></i><span> [ <strong><span>oam-packet pop flow-label</span></strong> ]</span> [ <strong><span>tunnel-policy</span></strong> <i><span class="varname">policy-name</span></i><span> [ { <strong><span>endpoint</span></strong> <i><span class="varname">endpoint-address</span></i> | [ <strong><span>endpoint</span></strong> <i><span class="varname">endpoint4-address</span></i> ] } <strong><span>color</span></strong> <i><span class="varname">color-value</span></i> ]</span> ] <strong><span>encapsulation</span></strong> <i><span class="varname">encapsulation-type</span></i> [ <strong><span>control-word</span></strong> | <strong><span>no-control-word</span></strong> ]</span><p><p>A static MS-PW is created.</p>
</p><p></p><p><p>A PW label must be manually configured on each SPE for static VPWS switching.</p>
<p>The prerequisites for setting up a static MS-PW are as follows:</p>
<ul><li><p>On the ingress UPE of the MS-PW, the PW state is up so long as the AC state is up and the corresponding PSN tunnels exist.</p>
</li><li><p>On the SPE, if the status of PSN tunnels on both sides of a PW is up, the PW can be successfully established regardless of whether the PW encapsulation type on the SPE is consistent with that on the UPE.</p>
</li></ul>
<p>To facilitate management, it is recommended that you use the same PW encapsulation type (specified using the <strong><span>encapsulation</span></strong> parameter) on the SPE and UPE.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure dynamic VPWS switching.</span><p><p>Perform the following configurations on the SPE.</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view of the SPE is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mpls+switch-l2vc"><b><span class="cmdname">mpls switch-l2vc</span></b></a> [ <strong><span>instance-name</span></strong> <i><span class="varname">instance-name</span></i> ] <i><span class="varname">ip-address</span></i> <i><span class="varname">vc-id</span></i> [ <strong><span>tunnel-policy</span></strong> <i><span class="varname">policy-name</span></i><span> [ { <strong><span>endpoint</span></strong> <i><span class="varname">endpoint-address</span></i> | [ <strong><span>endpoint</span></strong> <i><span class="varname">endpoint4-address</span></i> ] } <strong><span>color</span></strong> <i><span class="varname">color-value</span></i> ]</span> ]<span> [ <strong><span>oam-packet pop flow-label</span></strong> ]</span> <strong><span>between</span></strong> <i><span class="varname">ip-address vc-id</span></i> [ <strong><span>tunnel-policy</span></strong> <i><span class="varname">policy-name</span></i><span> [ { <strong><span>endpoint</span></strong> <i><span class="varname">endpoint-address</span></i> | [ <strong><span>endpoint</span></strong> <i><span class="varname">endpoint4-address</span></i> ] } <strong><span>color</span></strong> <i><span class="varname">color-value</span></i> ]</span> ]<span> [ <strong><span>oam-packet pop flow-label</span></strong> ]</span> <strong><span>encapsulation</span></strong> <i><span class="varname">encapsulation-type</span></i> [ <strong><span>control-word-transparent</span></strong> ]</span><p><p>Dynamic VPWS switching is configured.</p>
</p><p></p><p><p>After dynamic VPWS switching is configured on an SPE, the SPE receives remote labels from two neighboring nodes (UPEs or SPEs) through signaling and receives the control word and VCCV capability information from the two endpoint UPEs through signaling.</p>
<p>When configuring dynamic VPWS switching, ensure that the PW encapsulation type (specified using the <strong><span>encapsulation</span></strong> parameter) on the SPE is the same as that on the UPE. Otherwise, the PW cannot go up.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>When configuring dynamic VPWS switching, select <strong><span>ip-layer2</span></strong> if IP interworking is required between Huawei and non-Huawei devices and <strong><span>ip-interworking</span></strong> if IP interworking is required between Huawei devices.</p>
<p></p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure hybrid VPWS switching.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view of the SPE is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mpls+switch-l2vc"><b><span class="cmdname">mpls switch-l2vc</span></b></a> [ <strong><span>instance-name</span></strong> <i><span class="varname">instance-name</span></i> ] <i><span class="varname">ip-address</span></i> <i><span class="varname">vc-id</span></i> [ <strong><span>tunnel-policy</span></strong> <i><span class="varname">policy-name</span></i><span> [ { <strong><span>endpoint</span></strong> <i><span class="varname">endpoint-address</span></i> | [ <strong><span>endpoint</span></strong> <i><span class="varname">endpoint4-address</span></i> ] } <strong><span>color</span></strong> <i><span class="varname">color-value</span></i> ]</span> ]<span> [ <strong><span>oam-packet pop flow-label</span></strong> ]</span> <strong><span>between</span></strong> <i><span class="varname">ip-address vc-id </span></i><strong><span>trans</span></strong> <i><span class="varname">trans-label</span></i> <strong><span>recv</span></strong> <i><span class="varname">recv-label</span></i><span> [ <strong><span>oam-packet pop flow-label</span></strong> ]</span> [ <strong><span>tunnel-policy</span></strong> <i><span class="varname">policy-name</span></i><span> [ { <strong><span>endpoint</span></strong> <i><span class="varname">endpoint-address</span></i> | [ <strong><span>endpoint</span></strong> <i><span class="varname">endpoint4-address</span></i> ] } <strong><span>color</span></strong> <i><span class="varname">color-value</span></i> ]</span> ] <strong><span>encapsulation</span></strong> <i><span class="varname">encapsulation-type</span></i> [ <strong><span>control-word-transparent</span></strong> ]</span><p><p>A static-dynamic hybrid MS-PW is configured.</p>
</p><p></p></li></ol>
</li></ul></div>
<div class="postreq"><a name="EN-US_TASK_0172369833__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After the configurations are complete, check the configurations.</p>
<ul><li><p>Run the <a href="cmdqueryname=display+mpls+switch-l2vc"><b><span class="cmdname">display mpls switch-l2vc</span></b></a> [ <i><span class="varname">ip-address</span></i> <i><span class="varname">vc-id</span></i> <strong><span>encapsulation</span></strong> <i><span class="varname">encapsulation-type</span></i> | <strong><span>state</span></strong> { <strong><span>down</span></strong> | <strong><span>up</span></strong> } | <strong><span>brief</span></strong> ] command on the SPE to check VPWS switching information.</p>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_3000.html">VPWS Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6042.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_5007.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>