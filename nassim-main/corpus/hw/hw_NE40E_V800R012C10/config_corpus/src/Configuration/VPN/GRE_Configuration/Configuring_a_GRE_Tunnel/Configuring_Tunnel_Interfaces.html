
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Tunnel Interfaces">
<meta name="abstract" content="After creating a tunnel interface, you need to specify GRE as the encapsulation type and configure a source address or source interface and a destination address for the tunnel interface. To enable the tunnel to support dynamic routing protocols, you aso need to configure an IP address for the tunnel interface.">
<meta name="description" content="After creating a tunnel interface, you need to specify GRE as the encapsulation type and configure a source address or source interface and a destination address for the tunnel interface. To enable the tunnel to support dynamic routing protocols, you aso need to configure an IP address for the tunnel interface.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gre_cfg_2003.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_gre_cfg_1002.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gre_cfg_2005.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00415692">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369080">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Tunnel Interfaces</title>
</head>
<body><a name="EN-US_TASK_0172369080"></a><a name="EN-US_TASK_0172369080"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Tunnel Interfaces</h1>
<div class="taskbody"><p>After creating a tunnel interface, you need to specify GRE as the encapsulation type and configure a source address or source interface and a destination address for the tunnel interface. To enable the tunnel to support dynamic routing protocols, you aso need to configure an IP address for the tunnel interface.</p>
<div class="context"><a name="EN-US_TASK_0172369080__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>A GRE tunnel is established between tunnel interfaces on the two ends of the tunnel. Therefore, you need to configure tunnel interfaces on devices at the two ends of the tunnel. For a GRE tunnel interface, you need to specify the protocol type as GRE and configure a source address or source interface and a destination address for the tunnel interface. You also need to specify an IP address if a dynamic routing protocol is used.</p>
<p>Note that you must not specify the involved tunnel interface as the source interface for a GRE tunnel. Instead, specify another interface that can be either a common interface or the tunnel interface of another tunnel on the same device.</p>
<p>The MTU value is valid only when a local device sends locally originated packets over a GRE tunnel and is invalid when a local device forwards received packets over a GRE tunnel.</p>
<div class="p">A tunnel interface, which is a logical interface, goes down in any of the following situations:<ul><li><p>The destination address configured for the tunnel interface is unreachable or is set to the IP address of the tunnel interface.</p>
</li><li><p>The source interface configured for the tunnel interface is down.</p>
</li><li><p>The IP address configured on the tunnel interface is invalid.</p>
</li><li><p>The keepalive function is configured on the tunnel interface and detects that the tunnel remote end is unreachable.</p>
</li></ul>
</div>
<p>If the tunnel interface is deleted, all configurations on the tunnel interface are also deleted.</p>
<p>Perform the following steps on the endpoint <span class="keyword">Router</span>s of a tunnel.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172369080__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <strong><span>tunnel</span></strong> <i><span class="varname">interface-number</span></i></span><p><p>A tunnel interface is created, and its view is displayed.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=description"><b><span class="cmdname">description</span></b></a> <i><span class="varname">text</span></i></span><p><p>A tunnel description is configured.</p>
</p></li><li><span>Run <a href="cmdqueryname=tunnel-protocol"><b><span class="cmdname">tunnel-protocol</span></b></a> <strong><span>gre</span></strong></span><p><p>GRE is configured as the tunneling protocol.</p>
</p><p><div class="note" id="EN-US_TASK_0172369080__note292920406266"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172369080__p59301840152610">Changing, deleting, or initially configuring the tunnel mode of a tunnel interface will delete all tunnel-related configurations on the interface, such as the MTU. Exercise caution when performing this operation.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=source"><b><span class="cmdname">source</span></b></a> { <i><span class="varname">ip-address</span></i> | <i><span class="varname">ifName</span></i> | <i><span class="varname">ifType ifNum</span></i> }</span><p><p>A source address or source interface of the tunnel is configured.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The <a href="cmdqueryname=binding+tunnel+gre"><b><span class="cmdname">binding tunnel gre</span></b></a> command must be run to bind the source interface or the interface where the source address resides to GRE. After the binding is configured, a GRE tunnel can use such an interface to forward GRE-encapsulated packets.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=destination"><b><span class="cmdname">destination</span></b></a> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <i><span class="varname">ip-address</span></i> The destination address of the tunnel interface is set.</span></li><li><span>(Optional) Run <a href="cmdqueryname=mtu"><b><span class="cmdname">mtu</span></b></a> <i><span class="varname">mtu</span></i></span><p><p>The MTU of the tunnel interface is set.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=tunnel+pathmtu+enable"><b><span class="cmdname">tunnel pathmtu enable</span></b></a></span><p><p>Path MTU learning is enabled.</p>
</p><p><p>If two BGP nodes on which the <a href="cmdqueryname=peer+path-mtu+auto-discovery"><b><span class="cmdname">peer path-mtu auto-discovery</span></b></a> command is run communicate over a GRE tunnel, you can run the <a href="cmdqueryname=tunnel+pathmtu+enable"><b><span class="cmdname">tunnel pathmtu enable</span></b></a> command on tunnel interfaces of both nodes to prevent repetitive fragmentation for TCP packets carrying BGP messages when such packets are transmitted along the GRE tunnel, improving BGP message transmission efficiency.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=tcp+adjust-mss"><b><span class="cmdname">tcp adjust-mss</span></b></a> <i><span class="varname">mss-value</span></i> <strong><span>inbound</span></strong></span><p><p>An MSS is set for inbound TCP SYN/SYN+ACK packets of the GRE tunnel.</p>
</p><p><p>You can set the MSS to be less than the sum of the configured interface MTU and GRE header length, so that the packets accepted by the tunnel interface will not be fragmented when being transmitted over the GRE tunnel.</p>
</p></li><li><span>Configure an IP address for the tunnel interface. Perform either of the following operations:</span><p><ul><li><p>To configure an IPv4 address for the tunnel interface, run the <a href="cmdqueryname=ip+address"><b><span class="cmdname">ip address</span></b></a> <i><span class="varname">ip-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } [ <strong><span>sub</span></strong> ] command.</p>
</li><li><p>To configure the tunnel interface to borrow an IPv4 address, run the <a href="cmdqueryname=ip+address+unnumbered"><b><span class="cmdname">ip address unnumbered</span></b></a> <strong><span>interface</span></strong> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> command.</p>
</li></ul>
<p>To enable the tunnel to support dynamic routing protocols, you aso need to configure an IP address for the tunnel interface. The IP addresses of the tunnel interfaces on both ends of the GRE tunnel can be either public or private addresses and must be on the same network segment.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=target+reassemble+board"><b><span class="cmdname">target reassemble board</span></b></a> <i><span class="varname">slot-id</span></i> [ <strong><span>backup</span></strong> <i><span class="varname">slave-slot-id</span></i> ]</span><p><p>A tunnel interface is mapped to a tunnel service board so that GRE fragments can be assembled on the tunnel service board.</p>
</p><p><p>If GRE packets are fragmented during transmission over a tunnel (for example, when packets are forwarded over multiple transit links in load-balancing mode), configure a packet reassembly board on the egress of the tunnel so that all fragmented packets are reassembled on the same board.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172369080__en-us_cliref_0172381719_p1066524526214521">The <b><span class="cmdname" id="EN-US_TASK_0172369080__en-us_cliref_0172381719_cmdname323150755214521">target reassemble board</span></b> command takes effect for distributed
GRE tunnels only.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the tunnel interface view.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=global-gre+forward-mode"><b><span class="cmdname">global-gre forward-mode</span></b></a> { <strong><span>through</span></strong> | <strong><span>loopback</span></strong> }</span><p><p>A forwarding mode is specified, which takes effect for all distributed GRE tunnels.</p>
</p><p><p> Configure an appropriate forwarding mode based on service requirements.</p>
<ul><li><strong><span>through</span></strong>: enables the software loopback mode. This mode supports high forwarding performance, but does not support HQoS functions for outgoing packets.</li><li><strong><span>loopback</span></strong>: enables the hardware loopback mode. This mode provides only half of the forwarding performance compared with the software loopback mode, but supports HQoS functions for outgoing packets.</li></ul>
<p>This command takes effect only for distributed GRE tunnels.</p>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gre_cfg_2003.html">Configuring a GRE Tunnel
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_gre_cfg_1002.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gre_cfg_2005.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>