
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Establishing MP-IBGP Peer Relationships Between PEs">
<meta name="abstract" content="By introducing extended community attributes into BGP, MP-IBGP can advertise VPNv4 routes between PEs.">
<meta name="description" content="By introducing extended community attributes into BGP, MP-IBGP can advertise VPNv4 routes between PEs.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0154.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_2005.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0158.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,l3vpnvrp,w00556928,l00468467,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="h00847023">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00847023">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369256">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Establishing MP-IBGP Peer Relationships Between PEs</title>
</head>
<body><a name="EN-US_TASK_0172369256"></a><a name="EN-US_TASK_0172369256"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Establishing MP-IBGP Peer Relationships Between PEs</h1>
<div class="taskbody"><p>By introducing extended community attributes into BGP, MP-IBGP can advertise VPNv4 routes between PEs.</p>
<div class="context"><a name="EN-US_TASK_0172369256__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>If VPN sites in a basic BGP/MPLS IP VPN need to communicate, PEs must use MP-IBGP to advertise VPNv4 routes with the RD information to each other. Since all the PEs reside in the same AS, MP-IBGP peer relationships can be set up between them.</p>
<p>Perform the following steps on each PE.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172369256__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>as-number</span></strong> <i><span class="varname">as-number</span></i></span><p><p>The remote PE is configured as a peer.</p>
</p></li><li><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <a href="cmdqueryname=connect-interface"><b><span class="cmdname">connect-interface</span></b></a> <strong><span>loopback</span></strong> <i><span class="varname">interface-number</span></i></span><p><p>An interface is specified for setting up a TCP connection with the BGP peer.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>A PE must use a loopback interface address with a 32-bit mask to set up an MP-IBGP peer relationship with the peer PE so that VPN routes can recurse to tunnels. The route to the local loopback interface is advertised to the peer PE using IGP on the MPLS backbone network.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a> <strong><span>vpnv4</span></strong></span><p><p>The BGP-VPNv4 address family view is displayed.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=activate-route-tag+compatible"><b><span class="cmdname">activate-route-tag compatible</span></b></a></span><p><p>The function to match VPNv4 routes (with a non-zero tag value) against the rule configured using the <a href="cmdqueryname=if-match+tag"><b><span class="cmdname">if-match tag</span></b></a> command is enabled.</p>
</p><p><p>The default tag value of VPNv4 routes is 0, and the VPNv4 routes that carry tag 0 are matched against the rule configured using the <a href="cmdqueryname=if-match+tag"><b><span class="cmdname">if-match tag</span></b></a> command by default. If the tag value of a VPNv4 route is not 0, you need to run the <a href="cmdqueryname=activate-route-tag+compatible"><b><span class="cmdname">activate-route-tag compatible</span></b></a> command to enable the <a href="cmdqueryname=if-match+tag"><b><span class="cmdname">if-match tag</span></b></a> command, so that the VPNv4 route can be matched against the rule configured using the <a href="cmdqueryname=if-match+tag"><b><span class="cmdname">if-match tag</span></b></a> command.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=vpn-orf+disable"><b><span class="cmdname">vpn-orf disable</span></b></a></span><p><p>VPN ORF is disabled.</p>
</p><p><p>By default, VPN ORF is enabled for VPNv4 and VPNv6 routes. After the <a href="cmdqueryname=vpn-orf+disable"><b><span class="cmdname">vpn-orf disable</span></b></a> command is run, the device that has established a BGP-VPNv4/BGP-VPNv6 peer relationship does not filter VPN routes based on the import VPN target (IRT) of the remote peer when advertising VPN routes.</p>
</p></li><li><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>enable</span></strong></span><p><p>The function to exchange VPN-IPv4 routing information with the specified peer is enabled.</p>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0154.html">Configuring a Basic BGP/MPLS IP VPN
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_2005.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0158.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>