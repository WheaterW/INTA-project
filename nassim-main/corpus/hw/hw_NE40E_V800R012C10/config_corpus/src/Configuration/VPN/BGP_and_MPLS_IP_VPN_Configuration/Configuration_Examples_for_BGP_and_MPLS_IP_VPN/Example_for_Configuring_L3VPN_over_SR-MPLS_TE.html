
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring L3VPN over SR-MPLS TE">
<meta name="abstract" content="This section provides an example for configuring L3VPN over an SR-MPLS TE tunnel to ensure secure communication between users of the same VPN.">
<meta name="description" content="This section provides an example for configuring L3VPN over an SR-MPLS TE tunnel to ensure secure communication between users of the same VPN.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0101.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l3vpn_cfg_0125.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_2011.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,l3vpnvrp,w00556928,l00468467,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="h00847023">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00415692">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369488">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring L3VPN over SR-MPLS TE</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172369488"></a><a name="EN-US_TASK_0172369488"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring L3VPN over SR-MPLS TE</h1>
<div class="taskbody" id="taskbody194553700214050"><p id="shortdesc527202571214050">This section provides an example for configuring L3VPN over an SR-MPLS TE tunnel to ensure secure communication between users of the same VPN.</p>
<div class="context"><a name="EN-US_TASK_0172369488__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0172369488__context801159839214050"><h4 class="sectiontitle">Networking Requirements</h4><div class="p" id="EN-US_TASK_0172369488__p595531461214050">On the network shown in <a href="#EN-US_TASK_0172369488__fig_dc_vrp_sr-te_cfg_000505">Figure 1</a>: <ul id="EN-US_TASK_0172369488__ul326878137214050"><li id="EN-US_TASK_0172369488__li286343044214050"><p id="EN-US_TASK_0172369488__p56687581214050"><a name="EN-US_TASK_0172369488__li286343044214050"></a><a name="li286343044214050"></a>CE1 and CE2 belong to vpna.</p>
</li><li id="EN-US_TASK_0172369488__li1945538674214050"><p id="EN-US_TASK_0172369488__p1082484696214050"><a name="EN-US_TASK_0172369488__li1945538674214050"></a><a name="li1945538674214050"></a>The VPN target used by vpna is 111:1.</p>
</li></ul>
</div>
<p id="EN-US_TASK_0172369488__p1057147349214050">To ensure secure communication between VPN users, configure L3VPN over an SR-MPLS TE tunnel.</p>
<div class="fignone" id="EN-US_TASK_0172369488__fig_dc_vrp_sr-te_cfg_000505"><a name="EN-US_TASK_0172369488__fig_dc_vrp_sr-te_cfg_000505"></a><a name="fig_dc_vrp_sr-te_cfg_000505"></a><span class="figcap"><b>Figure 1 </b>Configuring L3VPN over an SR-MPLS TE tunnel</span><div class="note" id="EN-US_TASK_0172369488__note678317979214050"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172369488__p1647074777214050">Interfaces 1 and 2 in this example represent GE<span>0/1/0</span> and GE<span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0172369488__image1633215688214050" src="images/fig_dc_vrp_sr-te_cfg_000505.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369488__1.4.2"></a><a name="1.4.2"></a>
<div class="p" id="EN-US_TASK_0172369488__context311863722214050"><h4 class="sectiontitle">Precautions</h4><p id="EN-US_TASK_0172369488__p306558170214050">When you configure L3VPN over an SR-MPLS TE tunnel, note the following:</p>
<p id="EN-US_TASK_0172369488__p1329328329214050">After a PE interface connected to a CE is bound to a VPN instance, Layer 3 features, such as the IP address and routing protocol, on this interface are automatically deleted. These features can be reconfigured if required.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369488__1.4.3"></a><a name="1.4.3"></a>
<div class="p" id="EN-US_TASK_0172369488__context723766697214050"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0172369488__p602841585214050">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0172369488__ol1485243809214050"><li id="EN-US_TASK_0172369488__li1050530246214050"><p id="EN-US_TASK_0172369488__p1798782535214050"><a name="EN-US_TASK_0172369488__li1050530246214050"></a><a name="li1050530246214050"></a>Configure IS-IS on the backbone network to ensure PE communication.</p>
</li><li id="EN-US_TASK_0172369488__li1970259623214050"><p id="EN-US_TASK_0172369488__p2103130668214050"><a name="EN-US_TASK_0172369488__li1970259623214050"></a><a name="li1970259623214050"></a>On the backbone network, enable MPLS, configure segment routing (SR), establish an SR-MPLS TE tunnel, specify the tunnel IP address, tunnel protocol, and destination IP address, and use explicit paths for path computation.</p>
</li><li id="EN-US_TASK_0172369488__li26619042214050"><p id="EN-US_TASK_0172369488__p709640318214050"><a name="EN-US_TASK_0172369488__li26619042214050"></a><a name="li26619042214050"></a>On each PE, configure a VPN instance, enable the IPv4 address family, and bind each PE interface that connects to a CE to the corresponding VPN instance.</p>
</li><li id="EN-US_TASK_0172369488__li268383567214050"><p id="EN-US_TASK_0172369488__p1006951869214050"><a name="EN-US_TASK_0172369488__li268383567214050"></a><a name="li268383567214050"></a>Configure MP-IBGP between PEs to exchange VPN routing information.</p>
</li><li id="EN-US_TASK_0172369488__li881833860214050"><p id="EN-US_TASK_0172369488__p1197037073214050"><a name="EN-US_TASK_0172369488__li881833860214050"></a><a name="li881833860214050"></a>Configure EBGP between CEs and PEs to exchange VPN routing information.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369488__1.4.4"></a><a name="1.4.4"></a>
<div class="p" id="EN-US_TASK_0172369488__context963596517214050"><h4 class="sectiontitle">Data Preparation</h4><p id="EN-US_TASK_0172369488__p1489917309214050">To complete the configuration, you need the following data:</p>
<ul id="EN-US_TASK_0172369488__ul734607672214050"><li id="EN-US_TASK_0172369488__li704118132214050"><p id="EN-US_TASK_0172369488__p1478549554214050"><a name="EN-US_TASK_0172369488__li704118132214050"></a><a name="li704118132214050"></a>MPLS LSR IDs of the PEs and P</p>
</li><li id="EN-US_TASK_0172369488__li282378378214050"><p id="EN-US_TASK_0172369488__p2142022823214050"><a name="EN-US_TASK_0172369488__li282378378214050"></a><a name="li282378378214050"></a>VPN target and RD of vpna</p>
</li><li id="EN-US_TASK_0172369488__li691553364214050"><p id="EN-US_TASK_0172369488__p755891184214050"><a name="EN-US_TASK_0172369488__li691553364214050"></a><a name="li691553364214050"></a>SRGB range on the PEs and P</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172369488__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0172369488__steps561292695214050"><li id="EN-US_TASK_0172369488__step632727953214048"><span id="EN-US_TASK_0172369488__cmd2067169774214048">Configure interface IP addresses.</span><p><p id="EN-US_TASK_0172369488__p1188131509214048"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1539879811214048">&lt;<span class="keyword" id="EN-US_TASK_0172369488__keyword741433491214048">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172369488__b1832325966214048">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1556776246214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword70140366214048"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172369488__keyword2028092806214048">HUAWEI</span>] <strong id="EN-US_TASK_0172369488__b1826021567214048">sysname PE1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen53468997214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1287660382214048">*</span><span class="keyword" id="EN-US_TASK_0172369488__keyword1515329455214048">HUAWEI</span>] <strong id="EN-US_TASK_0172369488__b1758551947214048">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen951847452214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1043223072214048"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172369488__b925133943214048">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1285024223214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword8183659214048">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172369488__b867106471214048">ip address 1.1.1.9 32</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen601223530214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword678232359214048">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172369488__b751580343214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1725882633214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword299625369214048">*</span>PE1]<strong id="EN-US_TASK_0172369488__b665376355214048"> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen216319910214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1058127016214048">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172369488__b1031148063214048">ip address 172.16.1.1 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen977384742214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword273931289214048">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172369488__b1799184375214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen320501124214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword2036584700214048">*</span>PE1] <strong id="EN-US_TASK_0172369488__b1727035938214048">commit</strong></pre>
<p id="EN-US_TASK_0172369488__p704972473214048"># Configure P1.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1718497984214048">&lt;<span class="keyword" id="EN-US_TASK_0172369488__keyword1597406335214048">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172369488__b932141439214048">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen263384830214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword2080189791214048"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172369488__keyword716044177214048">HUAWEI</span>] <strong id="EN-US_TASK_0172369488__b548411124214048">sysname P1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen524131334214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword796473994214048">*</span><span class="keyword" id="EN-US_TASK_0172369488__keyword1072845407214048">HUAWEI</span>] <strong id="EN-US_TASK_0172369488__b1838965326214048">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen974993317214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword800042725214048"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1] <strong id="EN-US_TASK_0172369488__b1001868575214048">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen785218503214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword201236712214048">*</span>P1-LoopBack1] <strong id="EN-US_TASK_0172369488__b2125328831214048">ip address 2.2.2.9 32</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1088003628214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1543740642214048">*</span>P1-LoopBack1] <strong id="EN-US_TASK_0172369488__b1106794695214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen233840133214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1876737106214048">*</span>P1]<strong id="EN-US_TASK_0172369488__b1824173385214048"> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen671151759214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1905366392214048">*</span>P1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172369488__b114475027214048">ip address 172.16.1.2 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1823662946214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword505711824214048">*</span>P1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172369488__b1702628474214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1072742025214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword465405114214048">*</span>P1]<strong id="EN-US_TASK_0172369488__b614348113214048"> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1853870408214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword2088189828214048">*</span>P1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172369488__b200585444214048">ip address 172.17.1.1 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1368967001214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword757038772214048">*</span>P1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172369488__b1393643972214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1150915313214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1314517399214048">*</span>P1] <strong id="EN-US_TASK_0172369488__b301008334214048">commit</strong></pre>
<p id="EN-US_TASK_0172369488__p1002916576214048"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen212939508214048">&lt;<span class="keyword" id="EN-US_TASK_0172369488__keyword1912579115214048">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172369488__b887053569214048">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen925053273214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword955665710214048"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172369488__keyword843392057214048">HUAWEI</span>] <strong id="EN-US_TASK_0172369488__b1536084718214048">sysname PE2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen442895440214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1194633118214048">*</span><span class="keyword" id="EN-US_TASK_0172369488__keyword1374198423214048">HUAWEI</span>] <strong id="EN-US_TASK_0172369488__b67102740214048">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen2143072645214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1188470960214048"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172369488__b753305913214048">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1269567466214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword807806922214048">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172369488__b1646302233214048">ip address 3.3.3.9 32</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen738681779214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword754452122214048">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172369488__b832790317214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen2107838496214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1131419293214048">*</span>PE2]<strong id="EN-US_TASK_0172369488__b566344980214048"> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen185627733214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword895179050214048">*</span>PE2-GigabitEthernet<span>0/2/0</span>]<strong id="EN-US_TASK_0172369488__b810907017214048"> ip address 172.17.1.2 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen871777228214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword697289516214048">*</span>PE2-GigabitEthernet<span>0/2/0</span>]<strong id="EN-US_TASK_0172369488__b1078548112214048"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen125558937214048">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1835211945214048">*</span>PE2]<strong id="EN-US_TASK_0172369488__b41270465214048"> commit</strong></pre>
</p></li><li id="EN-US_TASK_0172369488__step1315080442214050"><span id="EN-US_TASK_0172369488__cmd655293770214050">Configure IGP on the MPLS backbone network for the PEs and P to communicate. IS-IS is used in this example.</span><p><p id="EN-US_TASK_0172369488__p126947282214050"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1471169710214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1367138167214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172369488__b1231115073214050">isis 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1400444186214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1383831804214050">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172369488__b1418042618214050">is-level level-2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen997430599214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1758302493214050">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172369488__b1751992417214050">network-entity 10.0000.0000.0001.00</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen806980904214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword399287595214050">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172369488__b170304826214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1038948989214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword14256617214050">*</span>PE1] <strong id="EN-US_TASK_0172369488__b1860975532214050">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen575165033214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword554289625214050">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172369488__b565228568214050">isis enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1353020427214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword601515165214050">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172369488__b727291907214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1677625747214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword198442543214050">*</span>PE1]<strong id="EN-US_TASK_0172369488__b385956836214050"> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen900129795214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword592837901214050">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172369488__b1079906751214050">isis enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen917862384214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1741981827214050">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172369488__b1635955648214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen941113763214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1666687753214050">*</span>PE1] <strong id="EN-US_TASK_0172369488__b1191689757214050">commit</strong></pre>
<p id="EN-US_TASK_0172369488__p1693607095214050"># Configure P1.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen558073498214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1177335811214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1] <strong id="EN-US_TASK_0172369488__b1032254183214050">isis 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen71621063214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword454154915214050">*</span>P1-isis-1] <strong id="EN-US_TASK_0172369488__b2133412631214050">is-level level-2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1456923553214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1407252550214050">*</span>P1-isis-1] <strong id="EN-US_TASK_0172369488__b1687558061214050">network-entity 10.0000.0000.0002.00</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1518508051214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword657409769214050">*</span>P1-isis-1] <strong id="EN-US_TASK_0172369488__b1971325259214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1731731941214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword34131933201117">*</span>P1] <strong id="EN-US_TASK_0172369488__b420264477214050">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1588546400214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1758336887214050">*</span>P1-LoopBack1] <strong id="EN-US_TASK_0172369488__b1989687495214050">isis enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen404622731214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword146431206214050">*</span>P1-LoopBack1] <strong id="EN-US_TASK_0172369488__b2045212602214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen2039271471214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1543613353214050">*</span>P1]<strong id="EN-US_TASK_0172369488__b433526455214050"> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1525455503214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1665247073214050">*</span>P1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172369488__b1538860551214050">isis enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen299174688214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1563243240214050">*</span>P1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172369488__b546406374214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1853896131214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1114358407214050">*</span>P1]<strong id="EN-US_TASK_0172369488__b119233063214050"> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen2114016607214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1251341147214050">*</span>P1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172369488__b328114772214050">isis enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen785934551214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword996072675214050">*</span>P1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172369488__b1705301789214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen948424086214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1061166332214050">*</span>P1] <strong id="EN-US_TASK_0172369488__b350634284214050">commit</strong></pre>
<p id="EN-US_TASK_0172369488__p353309990214050"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1317447252214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1123933989214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172369488__b2001424131214050">isis 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen704586378214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1541731871214050">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172369488__b474948879214050">is-level level-2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen53120796214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword21999580214050">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172369488__b200314348214050">network-entity 10.0000.0000.0003.00</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen578232470214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword292830290214050">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172369488__b1391401754214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1673517633214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword224149692214050">*</span>PE2] <strong id="EN-US_TASK_0172369488__b325705813214050">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen488320003214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword216217896214050">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172369488__b1711134623214050">isis enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1126592766214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1240669294214050">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172369488__b1610405788214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen786994107214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword250152435214050">*</span>PE2]<strong id="EN-US_TASK_0172369488__b2144320756214050"> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1560956963214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword643588365214050">*</span>PE2-GigabitEthernet<span>0/2/0</span>]<strong id="EN-US_TASK_0172369488__b1098753634214050"> isis enable 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1569007432214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword398292319214050">*</span>PE2-GigabitEthernet<span>0/2/0</span>]<strong id="EN-US_TASK_0172369488__b1403265774214050"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen191057754214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword791908588214050">*</span>PE2]<strong id="EN-US_TASK_0172369488__b165566524214050"> commit</strong></pre>
</p></li><li id="EN-US_TASK_0172369488__step160431916214050"><span id="EN-US_TASK_0172369488__cmd1287235227214050">Configure basic MPLS functions and enable MPLS TE on the backbone network.</span><p><p id="EN-US_TASK_0172369488__p1460420284214050"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1968758625214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1976288987214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172369488__b175403509214050">mpls lsr-id 1.1.1.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1302255458214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1165409148214050">*</span>PE1] <strong id="EN-US_TASK_0172369488__b1309389225214050">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1020043211214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1686618670214050">*</span>PE1-mpls] <strong id="EN-US_TASK_0172369488__b628716247214050">mpls te</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1073854735214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1350694043214050">*</span>PE1-mpls] <strong id="EN-US_TASK_0172369488__b1877696725214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen21833647214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1360385100214050">*</span>PE1] <strong id="EN-US_TASK_0172369488__b165184491214050">commit</strong></pre>
<p id="EN-US_TASK_0172369488__p1249179965214050"># Configure P1.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1264562542214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1596395885214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1] <strong id="EN-US_TASK_0172369488__b1532771564214050">mpls lsr-id 2.2.2.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen552550929214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword79696752214050">*</span>P1] <strong id="EN-US_TASK_0172369488__b1031381550214050">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1758081341214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword2085016799214050">*</span>P1-mpls] <strong id="EN-US_TASK_0172369488__b2108409392214050">mpls te</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1984184579214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1695308421214050">*</span>P1-mpls] <strong id="EN-US_TASK_0172369488__b1973158836214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen2024184808214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword939136768214050">*</span>P1] <strong id="EN-US_TASK_0172369488__b486709701214050">commit</strong></pre>
<p id="EN-US_TASK_0172369488__p1153975650214050"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1228516462214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword233964352214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172369488__b786900657214050">mpls lsr-id 3.3.3.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1954605956214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword308591076214050">*</span>PE2] <strong id="EN-US_TASK_0172369488__b1240729535214050">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1541461969214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1952212722214050">*</span>PE2-mpls] <strong id="EN-US_TASK_0172369488__b938085057214050">mpls te</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1047834642214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword318829261214050">*</span>PE2-mpls]<strong id="EN-US_TASK_0172369488__b1690628524214050"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1328660684214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1215790027214050">*</span>PE2] <strong id="EN-US_TASK_0172369488__b2143404213214050">commit</strong></pre>
</p></li><li id="EN-US_TASK_0172369488__step123967779214050"><span id="EN-US_TASK_0172369488__cmd467324063214050">On the backbone network, configure SR, establish an SR-MPLS TE tunnel, specify the tunnel IP address, tunnel protocol, and destination IP address, and use explicit paths for path computation.</span><p><p id="EN-US_TASK_0172369488__p313430233214050"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1258462424214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1533834715214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172369488__b1692869460214050">segment-routing</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen823594852214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword339685433214050">*</span>PE1-segment-routing] <strong id="EN-US_TASK_0172369488__b1119426727214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen171120030214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword181122123">*</span>PE1] <strong id="EN-US_TASK_0172369488__b717784812214050">isis 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1145120766214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1538560890214050">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172369488__b846497898214050">cost-style wide</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen366703335214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1268352200214050">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172369488__b2092763226214050">traffic-eng level-2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1836951359214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1480568245214050">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172369488__b305607221214050">segment-routing mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1913235670214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword490503994214050">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172369488__b958097436214050">segment-routing global-block 16000 20000</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1196317565214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword895325683214050">*</span>PE1-isis-1] <strong id="EN-US_TASK_0172369488__b20593547214050">quit</strong></pre>
<div class="note" id="EN-US_TASK_0172369488__note1336598840214050"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172369488__p1172510321283">The SRGB range varies according to the device. The range specified in this example is for reference only.</p>
</div></div>
<pre class="screen" id="EN-US_TASK_0172369488__screen103770175214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword632926322214050">*</span>PE1] <strong id="EN-US_TASK_0172369488__b973818162214050">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen178506449214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1010929880214050">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172369488__b822564560214050">isis prefix-sid absolute 16100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1776735106214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword2060626559214050">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172369488__b1631923618214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen279845801214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1470366290214050">*</span>PE1] <strong id="EN-US_TASK_0172369488__b1174401547214050">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1899004096214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword993539598214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172369488__b329790255214050">explicit-path pe2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1490076135214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword2067635869214050">*</span>PE1-explicit-path-pe2] <strong id="EN-US_TASK_0172369488__b1919277925214050">next sid label 16200 type prefix</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen185769594214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1071624419214050">*</span>PE1-explicit-path-pe2] <strong id="EN-US_TASK_0172369488__b1708249396214050">next sid label 16300 type prefix</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen315121095214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1790040498214050">*</span>PE1-explicit-path-pe2] <strong id="EN-US_TASK_0172369488__b1704268353214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1194037114214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword2010924386214050">*</span>PE1] <strong id="EN-US_TASK_0172369488__b1841670499214050">interface tunnel1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1990677090214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword699810543214050">*</span>PE1-Tunnel1] <strong id="EN-US_TASK_0172369488__b2030420297214050">ip address unnumbered interface LoopBack1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1864811835214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword169863987214050">*</span>PE1-Tunnel1] <strong id="EN-US_TASK_0172369488__b290252912214050">tunnel-protocol mpls te</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen100057866214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword815969304214050">*</span>PE1-Tunnel1] <strong id="EN-US_TASK_0172369488__b946780037214050">destination 3.3.3.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1986605116214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1873761510214050">*</span>PE1-Tunnel1] <strong id="EN-US_TASK_0172369488__b1145036722214050">mpls te tunnel-id 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1620451519214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1293845855214050">*</span>PE1-Tunnel1] <strong id="EN-US_TASK_0172369488__b2072115108214050">mpls te signal-protocol segment-routing</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen181157506214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1384638115214050">*</span>PE1-Tunnel1] <strong id="EN-US_TASK_0172369488__b55454590214050">mpls te path explicit-path pe2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen238340932214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword41362235214050">*</span>PE1-Tunnel1] <strong id="EN-US_TASK_0172369488__b1942523203214050">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1158349912214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword687863193214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Tunnel1] <strong id="EN-US_TASK_0172369488__b2045082763214050">quit</strong></pre>
<p id="EN-US_TASK_0172369488__p461140026214050"># Configure P1.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen95181141214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1632265457214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>P1] <strong id="EN-US_TASK_0172369488__b1881785004214050">segment-routing</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen401878457214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword721916452214050">*</span>P1-segment-routing] <strong id="EN-US_TASK_0172369488__b687714977214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen316125655214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword36904614214050">*</span>P1] <strong id="EN-US_TASK_0172369488__b794862759214050">isis 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen421410608214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword593536299214050">*</span>P1-isis-1] <strong id="EN-US_TASK_0172369488__b2046854654214050">cost-style wide</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1798959595214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword183021753214050">*</span>P1-isis-1] <strong id="EN-US_TASK_0172369488__b1227726925214050">traffic-eng level-2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen339970177214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword251729598214050">*</span>P1-isis-1] <strong id="EN-US_TASK_0172369488__b1140503664214050">segment-routing mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen712399473214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword2046073627214050">*</span>P1-isis-1] <strong id="EN-US_TASK_0172369488__b587649770214050">segment-routing global-block 16000 20000</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen2037189680214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1149514992214050">*</span>P1-isis-1] <strong id="EN-US_TASK_0172369488__b1041721635214050">quit</strong></pre>
<div class="note" id="EN-US_TASK_0172369488__note1565049042214050"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172369488__p1476515322083">The SRGB range varies according to the device. The range specified in this example is for reference only.</p>
</div></div>
<pre class="screen" id="EN-US_TASK_0172369488__screen687755875214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1245471633214050">*</span>P1] <strong id="EN-US_TASK_0172369488__b1717723416214050">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1680113498214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword765358791214050">*</span>P1-LoopBack1] <strong id="EN-US_TASK_0172369488__b1082477465214050">isis prefix-sid absolute 16200</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen989821708214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword271465466214050">*</span>P1-LoopBack1] <strong id="EN-US_TASK_0172369488__b2050619032214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1704158491214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1184414273214050">*</span>P1] <strong id="EN-US_TASK_0172369488__b1536774226214050">commit</strong></pre>
<p id="EN-US_TASK_0172369488__p1210034620214050"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1055395161214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword203883874214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172369488__b1769569475214050">segment-routing</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1518622937214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword335992919214050">*</span>PE2-segment-routing] <strong id="EN-US_TASK_0172369488__b852606876214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1021605053214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword14345171801217">*</span>PE2] <strong id="EN-US_TASK_0172369488__b713205950214050">isis 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen329736699214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword120450159214050">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172369488__b1065909282214050">cost-style wide</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen677639415214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1734585052214050">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172369488__b185282741214050">traffic-eng level-2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen2001976902214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1294477987214050">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172369488__b450967926214050">segment-routing mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1094252593214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1617365102214050">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172369488__b294262082214050">segment-routing global-block 16000 20000</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen860460217214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1566307682214050">*</span>PE2-isis-1] <strong id="EN-US_TASK_0172369488__b90043562214050">quit</strong></pre>
<div class="note" id="EN-US_TASK_0172369488__note2108854828214050"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172369488__p11785163216816">The SRGB range varies according to the device. The range specified in this example is for reference only.</p>
</div></div>
<pre class="screen" id="EN-US_TASK_0172369488__screen1267353119214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword149471209214050">*</span>PE2] <strong id="EN-US_TASK_0172369488__b478770577214050">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1560377639214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword648789030214050">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172369488__b2099702839214050">isis prefix-sid absolute 16300</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen429468162214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword230620414214050">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172369488__b339777633214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen655713711214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword429684282214050">*</span>PE2] <strong id="EN-US_TASK_0172369488__b116317378214050">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1341603012214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1642158664214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172369488__b950684390214050">explicit-path pe1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1895874223214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1913545180214050">*</span>PE2-explicit-path-pe1] <strong id="EN-US_TASK_0172369488__b1050585320214050">next sid label 16200 type prefix</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen533607837214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1320357095214050">*</span>PE2-explicit-path-pe1] <strong id="EN-US_TASK_0172369488__b1794086058214050">next sid label 16100 type prefix</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1734763625214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword394538035214050">*</span>PE2-explicit-path-pe1] <strong id="EN-US_TASK_0172369488__b992676695214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1721355143214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword255730151214050">*</span>PE2] <strong id="EN-US_TASK_0172369488__b910657433214050">interface tunnel1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1058609809214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1680448217214050">*</span>PE2-Tunnel1] <strong id="EN-US_TASK_0172369488__b1188218706214050">ip address unnumbered interface LoopBack1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen896735774214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword560085646214050">*</span>PE2-Tunnel1] <strong id="EN-US_TASK_0172369488__b97874585214050">tunnel-protocol mpls te</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen915537383214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword691925353214050">*</span>PE2-Tunnel1] <strong id="EN-US_TASK_0172369488__b1060426387214050">destination 1.1.1.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen933359136214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword628475452214050">*</span>PE2-Tunnel1] <strong id="EN-US_TASK_0172369488__b1843306858214050">mpls te tunnel-id 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen2084024260214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1282259913214050">*</span>PE2-Tunnel1] <strong id="EN-US_TASK_0172369488__b1676473433214050">mpls te signal-protocol segment-routing</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen553193088214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword454424547214050">*</span>PE2-Tunnel1] <strong id="EN-US_TASK_0172369488__b1697242850214050">mpls te path explicit-path pe1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen925143860214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword125909221214050">*</span>PE2-Tunnel1] <strong id="EN-US_TASK_0172369488__b938813489214050">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1765293258214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1248469052214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Tunnel1] <strong id="EN-US_TASK_0172369488__b1428668469214050">quit</strong></pre>
<p id="EN-US_TASK_0172369488__p1544814971214340"># After completing the configurations, run the <strong id="EN-US_TASK_0172369488__b807001811214340">display tunnel-info all</strong> command on each PE. The command output shows that the SR-MPLS TE tunnel has been established. The command output on PE1 is used as an example.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1764893263214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword265848555214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172369488__b1945098085214050">display tunnel-info all</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1766108512214050">Tunnel ID            Type                Destination                             Status
----------------------------------------------------------------------------------------
0x000000000300004001 sr-te               3.3.3.9                                 UP  </pre>
<p id="EN-US_TASK_0172369488__p517867199214050"># Run the <strong id="EN-US_TASK_0172369488__b22257195362">ping</strong> command on PE1 to check the SR LSP connectivity. For example:</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1950681616214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword301028169214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172369488__b13643112420480">ping lsp segment-routing te Tunnel 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1114645468214050">  LSP PING FEC: SEGMENT ROUTING TE TUNNEL IPV4 SESSION QUERY Tunnel1 : 100  data bytes, press CTRL_C to break
    Reply from 3.3.3.9: bytes=100 Sequence=1 time=7 ms
    Reply from 3.3.3.9: bytes=100 Sequence=2 time=11 ms
    Reply from 3.3.3.9: bytes=100 Sequence=3 time=11 ms
    Reply from 3.3.3.9: bytes=100 Sequence=4 time=9 ms
    Reply from 3.3.3.9: bytes=100 Sequence=5 time=10 ms

  --- FEC: SEGMENT ROUTING TE TUNNEL IPV4 SESSION QUERY Tunnel1 ping statistics ---
    5 packet(s) transmitted
    5 packet(s) received
    0.00% packet loss
    round-trip min/avg/max = 5/8/11 ms</pre>
</p></li><li id="EN-US_TASK_0172369488__step90999344214050"><span id="EN-US_TASK_0172369488__cmd417617944214050">Establish an MP-IBGP peer relationship between PEs.</span><p><p id="EN-US_TASK_0172369488__p234504477214050"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen460098373214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword671495543214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172369488__b1018367621214050">bgp 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen822396501214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1542363997214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp] <strong id="EN-US_TASK_0172369488__b1453917497214050">peer 3.3.3.9 as-number 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1499004876214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1728426229214050">*</span>PE1-bgp] <strong id="EN-US_TASK_0172369488__b281951160214050">peer 3.3.3.9 connect-interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen2041827383214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1567597688214050">*</span>PE1-bgp] <strong id="EN-US_TASK_0172369488__b1240947508214050">ipv4-family vpnv4</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen867785462214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword546052778214050">*</span>PE1-bgp-af-vpnv4] <strong id="EN-US_TASK_0172369488__b1347656344214050">peer 3.3.3.9 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1432083758214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword2068184279214050">*</span>PE1-bgp-af-vpnv4] <strong id="EN-US_TASK_0172369488__b1142738376214050">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen870490758214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1946453826214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp-af-vpnv4] <strong id="EN-US_TASK_0172369488__b2136409864214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen167079820214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword2074809257214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp] <strong id="EN-US_TASK_0172369488__b1040984453214050">quit</strong></pre>
<p id="EN-US_TASK_0172369488__p942839373214050"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1500467642214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1737469340214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172369488__b2040467829214050">bgp 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen8479046214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword2053862296214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-bgp] <strong id="EN-US_TASK_0172369488__b1216517263214050">peer 1.1.1.9 as-number 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen27913957214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword348114513214050">*</span>PE2-bgp] <strong id="EN-US_TASK_0172369488__b130041926214050">peer 1.1.1.9 connect-interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen669837305214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1106983646214050">*</span>PE2-bgp] <strong id="EN-US_TASK_0172369488__b656051394214050">ipv4-family vpnv4</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen590559903214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword873301726214050">*</span>PE2-bgp-af-vpnv4] <strong id="EN-US_TASK_0172369488__b901190255214050">peer 1.1.1.9 enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1801472411214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword738470027214050">*</span>PE2-bgp-af-vpnv4] <strong id="EN-US_TASK_0172369488__b2065029412214050">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen655118141214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword514543332214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-bgp-af-vpnv4] <strong id="EN-US_TASK_0172369488__b1707453191214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen219325007214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword655550421214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-bgp] <strong id="EN-US_TASK_0172369488__b847528985214050">quit</strong></pre>
<p id="EN-US_TASK_0172369488__p710345247214340">After completing the configurations, run the <strong id="EN-US_TASK_0172369488__b1306509929214340">display bgp peer</strong> or <strong id="EN-US_TASK_0172369488__b1831921632214340">display bgp vpnv4 all peer</strong> command on each PE. The command output shows that the MP-IBGP peer relationship has been set up and is in the Established state. The command output on PE1 is used as an example.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen454523706214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1312404315214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172369488__b1599117715214050">display bgp peer</strong>

 BGP local router ID : 1.1.1.9
 Local AS number : 100
 Total number of peers : 1          Peers in established state : 1

  Peer            V    AS  MsgRcvd  MsgSent     OutQ  Up/Down    State        PrefRcv
  3.3.3.9         4   100        2        6     0     00:00:12   <strong id="EN-US_TASK_0172369488__b1544545569214050">Established</strong>   0</pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1444322496214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1832527245214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172369488__b1115381745214050">display bgp vpnv4 all peer</strong>

 BGP local router ID : 1.1.1.9
 Local AS number : 100
 Total number of peers : 1                 Peers in established state : 1

  Peer            V    AS  MsgRcvd  MsgSent    OutQ  Up/Down    State        PrefRcv
  3.3.3.9         4   100   12      18         0     00:09:38   <strong id="EN-US_TASK_0172369488__b709540527214050">Established</strong>   0</pre>
</p></li><li id="EN-US_TASK_0172369488__step862783048214050"><span id="EN-US_TASK_0172369488__cmd985103192214050">On each PE, create a VPN instance, enable the IPv4 address family in the VPN instance, and bind the PE interface connected to a CE to the VPN instance.</span><p><p id="EN-US_TASK_0172369488__p2080935260214050"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen793547953214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1123471623214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172369488__b710888243214050">ip vpn-instance vpna</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen217328958214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword933680952214050">*</span>PE1-vpn-instance-vpna] <strong id="EN-US_TASK_0172369488__b552946479214050">ipv4-family</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1737768939214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1159548357214050">*</span>PE1-vpn-instance-vpna-af-ipv4] <strong id="EN-US_TASK_0172369488__b268054271214050">route-distinguisher 100:1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1953499024214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1625202796214050">*</span>PE1-vpn-instance-vpna-af-ipv4] <strong id="EN-US_TASK_0172369488__b150172297214050">vpn-target 111:1 both</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1691698796214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1783050105214050">*</span>PE1-vpn-instance-vpna-af-ipv4] <strong id="EN-US_TASK_0172369488__b2061885643214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1899170335214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword371549160214050">*</span>PE1-vpn-instance-vpna] <strong id="EN-US_TASK_0172369488__b1487887002214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen536971343214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1620245173214050">*</span>PE1] <strong id="EN-US_TASK_0172369488__b657262575214050">interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1609779922214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword724042748214050">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172369488__b1907860437214050">ip binding vpn-instance vpna</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1187517307216">[<span class="keyword" id="EN-US_TASK_0172369488__keyword179719311120">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172369488__b4797113113219">ip address 10.1.1.2 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen2080556386214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword261090219214050">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172369488__b833808341214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1955204221214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1285317043214050">*</span>PE1] <strong id="EN-US_TASK_0172369488__b1930447987214050">commit</strong></pre>
<p id="EN-US_TASK_0172369488__p720282637214050"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1951863165214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1035559424214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172369488__b265796764214050">ip vpn-instance vpna</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen928080490214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1875667872214050">*</span>PE2-vpn-instance-vpna] <strong id="EN-US_TASK_0172369488__b373832787214050">ipv4-family</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen2012998324214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword160762167214050">*</span>PE2-vpn-instance-vpna-af-ipv4] <strong id="EN-US_TASK_0172369488__b1856032130214050">route-distinguisher 200:1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen220867803214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword598419033214050">*</span>PE2-vpn-instance-vpna-af-ipv4] <strong id="EN-US_TASK_0172369488__b2112248612214050">vpn-target 111:1 both</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen925464418214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1178802408214050">*</span>PE2-vpn-instance-vpna-af-ipv4] <strong id="EN-US_TASK_0172369488__b872218125214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen2020523751214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword208893424214050">*</span>PE2-vpn-instance-vpna] <strong id="EN-US_TASK_0172369488__b2041425010214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1021216580214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword318533630214050">*</span>PE2] <strong id="EN-US_TASK_0172369488__b299388647214050">interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen167439446214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword804784796214050">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172369488__b1836927924214050">ip binding vpn-instance vpna</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen198881157722">[<span class="keyword" id="EN-US_TASK_0172369488__keyword14311559922">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172369488__b12432959127">ip address 10.2.1.2 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen217707984214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1452703594214050">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172369488__b72518187214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1971674556214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword73872074214050">*</span>PE2] <strong id="EN-US_TASK_0172369488__b471390483214050">commit</strong></pre>
<p id="EN-US_TASK_0172369488__p1042729600214050"># Assign IP addresses to interfaces on the CEs, as shown in <a href="#EN-US_TASK_0172369488__fig_dc_vrp_sr-te_cfg_000505">Figure 1</a>. For configuration details, see the configuration files.</p>
<p id="EN-US_TASK_0172369488__p2104628990214340">After completing the configurations, run the <strong id="EN-US_TASK_0172369488__b443639936214340">display ip vpn-instance verbose</strong> command on each PE. The command output shows the configurations of VPN instances. Each PE can successfully ping its connected CE.</p>
<div class="note" id="EN-US_TASK_0172369488__note1158456357214050"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172369488__p1089248397214050">If a PE has multiple interfaces bound to the same VPN instance, specify a source IP address using the <strong id="EN-US_TASK_0172369488__b878763359214340">-a</strong> <em id="EN-US_TASK_0172369488__i22300870214340">source-ip-address</em> parameter in the <strong id="EN-US_TASK_0172369488__b132241078214340">ping -vpn-instance</strong> <em id="EN-US_TASK_0172369488__i750778580214340">vpn-instance-name</em> <strong id="EN-US_TASK_0172369488__b1799654710214340">-a</strong> <em id="EN-US_TASK_0172369488__i2124632458214340">source-ip-address dest-ip-address</em> command to ping the CE that is connected to the remote PE. If the source IP address is not specified, the ping operation fails.</p>
</div></div>
</p></li><li id="EN-US_TASK_0172369488__step173812257214050"><span id="EN-US_TASK_0172369488__cmd684843479214050">Configure a tunnel policy on each PE, and specify SR-MPLS TE as the preferred tunnel.</span><p><p id="EN-US_TASK_0172369488__p2126575685214050"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1984143098214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1010282684214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172369488__b1401665513214050">tunnel-policy p1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen636893030214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword966365970214050">*</span>PE1-tunnel-policy-p1] <strong id="EN-US_TASK_0172369488__b495264156214050">tunnel select-seq sr-te load-balance-number 1</strong> <strong id="EN-US_TASK_0172369488__b1415915283214">unmix</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1346111547214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1044441058214050">*</span>PE1-tunnel-policy-p1] <strong id="EN-US_TASK_0172369488__b1321192940214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen81533401214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword488187068214050">*</span>PE1] <strong id="EN-US_TASK_0172369488__b268043523214050">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen303915983214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword397662675214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172369488__b1495925879214050">ip vpn-instance vpna</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen751150564214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1612871535214050">*</span>PE1-vpn-instance-vpna] <strong id="EN-US_TASK_0172369488__b586205777214050">ipv4-family</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen651387956214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword2051572934214050">*</span>PE1-vpn-instance-vpna-af-ipv4] <strong id="EN-US_TASK_0172369488__b2046006411214050">tnl-policy p1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1781719760214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword690143268214050">*</span>PE1-vpn-instance-vpna-af-ipv4] <strong id="EN-US_TASK_0172369488__b2092972786214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1963402244214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword882807320214050">*</span>PE1-vpn-instance-vpna] <strong id="EN-US_TASK_0172369488__b492624946214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1677156189214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1012929556214050">*</span>PE1] <strong id="EN-US_TASK_0172369488__b732462533214050">commit</strong></pre>
<p id="EN-US_TASK_0172369488__p1049176570214050"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen836302775214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword518600176214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172369488__b175442384214050">tunnel-policy p1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen296189575214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1216687888214050">*</span>PE2-tunnel-policy-p1] <strong id="EN-US_TASK_0172369488__b1391784961214050">tunnel select-seq sr-te load-balance-number 1</strong> <strong id="EN-US_TASK_0172369488__b16522153211215">unmix</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen731997484214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword2086758653214050">*</span>PE2-tunnel-policy-p1] <strong id="EN-US_TASK_0172369488__b1297580398214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1054090917214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1554739144214050">*</span>PE2] <strong id="EN-US_TASK_0172369488__b303567500214050">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1078360241214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1981422369214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172369488__b1708650876214050">ip vpn-instance vpna</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen2014175192214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1478579405214050">*</span>PE2-vpn-instance-vpna] <strong id="EN-US_TASK_0172369488__b1133310437214050">ipv4-family</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen349063057214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword945476839214050">*</span>PE2-vpn-instance-vpna-af-ipv4] <strong id="EN-US_TASK_0172369488__b306343907214050">tnl-policy p1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen2014158890214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword772009375214050">*</span>PE2-vpn-instance-vpna-af-ipv4] <strong id="EN-US_TASK_0172369488__b1317026340214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1481526703214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1261985032214050">*</span>PE2-vpn-instance-vpna] <strong id="EN-US_TASK_0172369488__b1673024775214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen885232209214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1642715599214050">*</span>PE2] <strong id="EN-US_TASK_0172369488__b946474279214050">commit</strong></pre>
</p></li><li id="EN-US_TASK_0172369488__step1987499438214050"><span id="EN-US_TASK_0172369488__cmd1942409028214050">Set up EBGP peer relationships between the PEs and CEs.</span><p><p id="EN-US_TASK_0172369488__p2021853492214050"># Configure CE1.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen616793516214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1794623346214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong id="EN-US_TASK_0172369488__b1037080259214050">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen849978270214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1300419363214050">*</span>CE1-LoopBack1] <strong id="EN-US_TASK_0172369488__b1433585345214050">ip address 10.11.1.1 32</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen849883590214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1305183781214050">*</span>CE1-LoopBack1] <strong id="EN-US_TASK_0172369488__b1445416880214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen730136587214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1495465666214050">*</span>CE1]<strong id="EN-US_TASK_0172369488__b2039437319214050"> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1115767563214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword684855928214050">*</span>CE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172369488__b1558549757214050">ip address 10.1.1.1 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1603846504214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1411562109214050">*</span>CE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172369488__b1097347613214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1800027618214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1005735685214050">*</span>CE1] <strong id="EN-US_TASK_0172369488__b991175756214050">bgp 65410</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1300023542214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword534131971214050">*</span>CE1-bgp] <strong id="EN-US_TASK_0172369488__b89957693214050">peer 10.1.1.2 as-number 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen2069491312214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1636337765214050">*</span>CE1-bgp] <strong id="EN-US_TASK_0172369488__b565286735214050">network 10.11.1.1 32</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1693445813214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1250535385214050">*</span>CE1-bgp] <strong id="EN-US_TASK_0172369488__b1154622139214050">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen655393637214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword803341850214050">*</span>CE1] <strong id="EN-US_TASK_0172369488__b154273580214050">commit</strong></pre>
<div class="note" id="EN-US_TASK_0172369488__note1035361585214050"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172369488__p262167454214050">The configuration of CE2 is similar to the configuration of CE1. For configuration details, see the configuration file.</p>
</div></div>
<p id="EN-US_TASK_0172369488__p47857277214050"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen779826093214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword879495604214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172369488__b927279214214050">bgp 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1719476654214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1784499561214050">*</span>PE1-bgp] <strong id="EN-US_TASK_0172369488__b421746814214050">ipv4-family vpn-instance vpna</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen150296665214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1888485155214050">*</span>PE1-bgp-vpna] <strong id="EN-US_TASK_0172369488__b493716075214050">peer 10.1.1.1 as-number 65410</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1022686635214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword2000332876214050">*</span>PE1-bgp-vpna] <strong id="EN-US_TASK_0172369488__b126912910214050">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1005479169214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword9450921105313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-bgp-vpna] <strong id="EN-US_TASK_0172369488__b1091201211214050">quit</strong></pre>
<div class="note" id="EN-US_TASK_0172369488__note1533484668214050"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172369488__p1325567429214050">The configuration of PE2 is similar to the configuration of PE1. For configuration details, see the configuration file.</p>
</div></div>
<p id="EN-US_TASK_0172369488__p1385735892214050">After completing the configurations, run the <strong id="EN-US_TASK_0172369488__b894834687214340">display bgp vpnv4 vpn-instance peer</strong> command on each PE. The command output shows that the BGP peer relationships have been established between the PEs and CEs and are in the <strong id="EN-US_TASK_0172369488__b660585813372">Established</strong> state.</p>
<p id="EN-US_TASK_0172369488__p2069590306214050">The BGP peer relationship between PE1 and CE1 is used as an example.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen249339129214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword1877742046214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172369488__b7573121113112">display bgp vpnv4 vpn-instance vpna peer</strong>
 
 BGP local router ID : 1.1.1.9
 Local AS number : 100

 VPN-Instance vpna, Router ID 1.1.1.9:
 Total number of peers : 1            Peers in established state : 1

  Peer            V    AS  MsgRcvd  MsgSent    OutQ  Up/Down    State        PrefRcv
  10.1.1.1        4   65410  11     9          0     00:06:37   <strong id="EN-US_TASK_0172369488__b879454554214050">Established</strong>  1</pre>
</p></li><li id="EN-US_TASK_0172369488__step352469489214050"><span id="EN-US_TASK_0172369488__cmd1194803197214050">Verify the configuration.</span><p><p id="EN-US_TASK_0172369488__p1989877605214050">Run the <strong id="EN-US_TASK_0172369488__b903646854214340">display ip routing-table vpn-instance</strong> command on each PE. The command output shows the routes to CE loopback interfaces.</p>
<p id="EN-US_TASK_0172369488__p867999332214050">The command output on PE1 is used as an example.</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen517599004214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword281891280214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172369488__b1005121035214050">display ip routing-table vpn-instance vpna</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen1632237856214050"><span class="keyword" id="EN-US_TASK_0172369488__keyword1065539014214050">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route</span>
------------------------------------------------------------------------------
Routing Table: vpna
         Destinations : 7        Routes : 7
Destination/Mask    Proto  Pre  Cost     Flags NextHop         Interface
     10.1.1.0/24    Direct 0    0        D     10.1.1.2        GigabitEthernet<span>0/1/0</span>
     10.1.1.2/32    Direct 0    0        D     127.0.0.1       GigabitEthernet<span>0/1/0</span>
   10.1.1.255/32    Direct 0    0        D     127.0.0.1       GigabitEthernet<span>0/1/0</span>
   <strong id="EN-US_TASK_0172369488__b1575381264214050">10.11.1.1/32</strong>    EBGP   255  0        RD    10.1.1.1        GigabitEthernet<span>0/1/0</span>
   <strong id="EN-US_TASK_0172369488__b1915923139214050">10.22.2.2/32</strong>    IBGP   255  0        RD    3.3.3.9         Tunnel1
    127.0.0.0/8     Direct 0    0        D     127.0.0.1       InLoopBack0
255.255.255.255/32  Direct 0    0        D     127.0.0.1       InLoopBack0</pre>
<p id="EN-US_TASK_0172369488__p982557662214050">The CEs can ping each other. For example, CE1 can ping CE2 (10.22.2.2).</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1251125571214050">[<span class="keyword" id="EN-US_TASK_0172369488__keyword641444549214050"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong id="EN-US_TASK_0172369488__b412211242214050">ping -a 10.11.1.1 10.22.2.2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172369488__screen43867573214050">  PING 10.22.2.2: 56  data bytes, press CTRL_C to break
    Reply from 10.22.2.2: bytes=56 Sequence=1 ttl=251 time=72 ms
    Reply from 10.22.2.2: bytes=56 Sequence=2 ttl=251 time=34 ms
    Reply from 10.22.2.2: bytes=56 Sequence=3 ttl=251 time=50 ms
    Reply from 10.22.2.2: bytes=56 Sequence=4 ttl=251 time=50 ms
    Reply from 10.22.2.2: bytes=56 Sequence=5 ttl=251 time=34 ms
  --- 10.22.2.2 ping statistics ---
    5 packet(s) transmitted
    5 packet(s) received
    0.00% packet loss
    round-trip min/avg/max = 34/48/72 ms  </pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172369488__example1815194181214050"><a name="EN-US_TASK_0172369488__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul id="EN-US_TASK_0172369488__ul2106798412214050"><li id="EN-US_TASK_0172369488__li382284447214050"><p id="EN-US_TASK_0172369488__p1931112552214050"><a name="EN-US_TASK_0172369488__li382284447214050"></a><a name="li382284447214050"></a>PE1 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1601131817214050">#
sysname PE1
#
ip vpn-instance vpna
 ipv4-family
  route-distinguisher 100:1
  tnl-policy p1
  apply-label per-instance
  vpn-target 111:1 export-extcommunity
  vpn-target 111:1 import-extcommunity
#
mpls lsr-id 1.1.1.9
#               
mpls            
 mpls te        
#               
explicit-path pe2
 next sid label 16200 type prefix index 1
 next sid label 16300 type prefix index 2
#               
segment-routing 
#               
isis 1
 is-level level-2
 cost-style wide
 network-entity 10.0000.0000.0001.00
 traffic-eng level-2
 segment-routing mpls
 segment-routing global-block 16000 20000
#               
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip binding vpn-instance vpna
 ip address 10.1.1.2 255.255.255.0
#               
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 172.16.1.1 255.255.255.0
 isis enable 1
#               
interface LoopBack1
 ip address 1.1.1.9 255.255.255.255
 isis enable 1
 isis prefix-sid absolute 16100 
#
interface Tunnel1
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 3.3.3.9
 mpls te signal-protocol segment-routing
 mpls te tunnel-id 1
 mpls te path explicit-path pe2
#               
bgp 100         
 peer 3.3.3.9 as-number 100
 peer 3.3.3.9 connect-interface LoopBack1
 #              
 ipv4-family unicast
  undo synchronization
  peer 3.3.3.9 enable
 #              
 ipv4-family vpnv4
  policy vpn-target
  peer 3.3.3.9 enable
 #              
 ipv4-family vpn-instance vpna
  peer 10.1.1.1 as-number 65410
#
tunnel-policy p1
 tunnel select-seq sr-te load-balance-number 1 unmix
#
return</pre>
</li><li id="EN-US_TASK_0172369488__li1655820146214050"><p id="EN-US_TASK_0172369488__p128612349214050"><a name="EN-US_TASK_0172369488__li1655820146214050"></a><a name="li1655820146214050"></a>P1 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1965714100214050">#
sysname P1
#
mpls lsr-id 2.2.2.9
#               
mpls            
 mpls te        
#               
segment-routing 
#               
isis 1
 is-level level-2
 cost-style wide
 network-entity 10.0000.0000.0002.00
 traffic-eng level-2
 segment-routing mpls
 segment-routing global-block 16000 20000
#               
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip address 172.16.1.2 255.255.255.0
 isis enable 1  
#               
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown  
 ip address 172.17.1.1 255.255.255.0
 isis enable 1  
#               
interface LoopBack1
 ip address 2.2.2.9 255.255.255.255
 isis enable 1
 isis prefix-sid absolute 16200 
#
return</pre>
</li><li id="EN-US_TASK_0172369488__li391424712214050"><p id="EN-US_TASK_0172369488__p932723823214050"><a name="EN-US_TASK_0172369488__li391424712214050"></a><a name="li391424712214050"></a>PE2 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1344020011214050">#
sysname PE2
#
ip vpn-instance vpna
 ipv4-family
  route-distinguisher 200:1
  tnl-policy p1
  apply-label per-instance
  vpn-target 111:1 export-extcommunity
  vpn-target 111:1 import-extcommunity
#
mpls lsr-id 3.3.3.9
#               
mpls            
 mpls te        
#
explicit-path pe1
 next sid label 16200 type prefix index 1
 next sid label 16100 type prefix index 2
#               
segment-routing 
#               
isis 1
 is-level level-2
 cost-style wide
 network-entity 10.0000.0000.0003.00
 traffic-eng level-2
 segment-routing mpls
 segment-routing global-block 16000 20000
#               
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown  
 ip binding vpn-instance vpna
 ip address 10.2.1.2 255.255.255.0
#               
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown  
 ip address 172.17.1.2 255.255.255.0
 isis enable 1  
#               
interface LoopBack1
 ip address 3.3.3.9 255.255.255.255
 isis enable 1
 isis prefix-sid absolute 16300
#
interface Tunnel1
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 1.1.1.9
 mpls te signal-protocol segment-routing
 mpls te tunnel-id 1
 mpls te path explicit-path pe1 
#               
bgp 100         
 peer 1.1.1.9 as-number 100
 peer 1.1.1.9 connect-interface LoopBack1
 #              
 ipv4-family unicast
  undo synchronization
  peer 1.1.1.9 enable
 #              
 ipv4-family vpnv4
  policy vpn-target
  peer 1.1.1.9 enable
 #              
 ipv4-family vpn-instance vpna
  peer 10.2.1.1 as-number 65420
#
tunnel-policy p1
 tunnel select-seq sr-te load-balance-number 1 unmix
#
return</pre>
</li><li id="EN-US_TASK_0172369488__li531247883214050"><p id="EN-US_TASK_0172369488__p1593649002214050"><a name="EN-US_TASK_0172369488__li531247883214050"></a><a name="li531247883214050"></a>CE1 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen1717223090214050">#
sysname CE1
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.1.1 255.255.255.0
#
interface LoopBack1
 ip address 10.11.1.1 255.255.255.255
#
bgp 65410
 peer 10.1.1.2 as-number 100
 #
 ipv4-family unicast
  undo synchronization
  network 10.11.1.1 255.255.255.255
  peer 10.1.1.2 enable
#
return</pre>
</li><li id="EN-US_TASK_0172369488__li943008661214050"><p id="EN-US_TASK_0172369488__p717250567214050"><a name="EN-US_TASK_0172369488__li943008661214050"></a><a name="li943008661214050"></a>CE2 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172369488__screen274044392214050">#
sysname CE2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.2.1.1 255.255.255.0
#
interface LoopBack1
 ip address 10.22.2.2 255.255.255.255
#
bgp 65420
 peer 10.2.1.2 as-number 100
 #
 ipv4-family unicast
  undo synchronization
  network 10.22.2.2 255.255.255.255
  peer 10.2.1.2 enable
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0101.html">Configuration Examples for BGP/MPLS IP VPN
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_l3vpn_cfg_0125.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_2011.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>