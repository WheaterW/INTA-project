
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring ERPS over VPLS in Scenarios Where a CE Is Dual-Homed to PEs Through VLANIF Interfaces">
<meta name="abstract" content="To configure ERPS over VPLS in scenarios where a CE is dual-homed to PEs through VLANIF interfaces, enable ERPS on PE1, PE2, and the CE and configure ERPS to access the VPLS network in non-virtual channel (NVC) mode.">
<meta name="description" content="To configure ERPS over VPLS in scenarios where a CE is dual-homed to PEs through VLANIF interfaces, enable ERPS on PE1, PE2, and the CE and configure ERPS to access the VPLS network in non-virtual channel (NVC) mode.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_5029.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_6054.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_erps_cfg_0022_1.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wwx1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172370299">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring ERPS over VPLS in Scenarios Where a CE Is Dual-Homed to PEs Through VLANIF Interfaces</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172370299"></a><a name="EN-US_TASK_0172370299"></a>

<div class="articleBoxWithoutHead">





<h1 class="topicTitle-h1">Example for Configuring ERPS over VPLS in Scenarios Where a CE Is Dual-Homed to PEs Through VLANIF Interfaces</h1>
<div class="taskbody"><p>To configure ERPS over VPLS in scenarios where a CE is dual-homed to PEs through VLANIF interfaces, enable ERPS on PE1, PE2, and the CE and configure ERPS to access the VPLS network in non-virtual channel (NVC) mode.</p>
<div class="context"><a name="EN-US_TASK_0172370299__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0172370299__en-us_task_0172363487_context1922185527214029"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p960923213214029">On the VPLS network shown in <a href="#EN-US_TASK_0172370299__en-us_task_0172363487_fig_dc_vrp_erps_cfg_002101">Figure 1</a>, a CE is dual-homed to PE1 and PE2. In this networking scenario, PE3 receives two copies of CE traffic from PE1 and PE2. To prevent this problem, enable ERPS on PE1, PE2, and the CE and configure the CE's GE <span>0/2/0</span> as an RPL owner port to block traffic sending from this port. In this way, the CE's traffic is directly sent to PE3 through PE2, thereby preventing any duplicate traffic or loop.</p>
<p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1192359055214029">The ERPS ring shown in <a href="#EN-US_TASK_0172370299__en-us_task_0172363487_fig_dc_vrp_erps_cfg_002101">Figure 1</a> is connected to a VPLS ring through VLANIF interfaces.</p>
<div class="fignone" id="EN-US_TASK_0172370299__en-us_task_0172363487_fig_dc_vrp_erps_cfg_002101"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_fig_dc_vrp_erps_cfg_002101"></a><a name="en-us_task_0172363487_fig_dc_vrp_erps_cfg_002101"></a><span class="figcap"><b>Figure 1 </b>Configuring ERPS over VPLS in scenarios where the CE is dual-homed to PE1 and PE2 through VLANIF interfaces</span><div class="note" id="EN-US_TASK_0172370299__en-us_task_0172363487_note596895966214029"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1134385425214029">Interfaces 1 through 3 in this example represent GE <span>0/1/0</span>, GE <span>0/2/0</span>, and GE <span>0/3/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0172370299__en-us_task_0172363487_image77175801214029" src="images/fig_dc_vrp_erps_cfg_002101.png"></span></div>
<div class="note" id="EN-US_TASK_0172370299__en-us_task_0172363487_note347284951214029"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul id="EN-US_TASK_0172370299__en-us_task_0172363487_ul2105102558214029"><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li631019444214029"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1269546422214029"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_li631019444214029"></a><a name="en-us_task_0172363487_li631019444214029"></a>The configurations of ERPS over VPLS in CE single-homing scenarios are similar to those in CE dual-homing scenarios. This section uses CE dual-homing scenarios as an example.</p>
</li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li508656455214029"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p2004124125214029"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_li508656455214029"></a><a name="en-us_task_0172363487_li508656455214029"></a>If an ERPS ring has revertive switching enabled and an AC interface recovers, it is not recommended that you use the <a href="cmdqueryname=clear"><b><span class="cmdname" id="EN-US_TASK_0172370299__en-us_task_0172363487_cmdname1217319187214029">clear</span></b></a> command to trigger revertive switching before the wait to restore (WTR) or wait to block (WTB) timer expires. If you do so and the VSI bound to the AC interface recovers later than the AC interface, traffic will be interrupted for a long time.</p>
</li></ul>
</div></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172370299__en-us_task_0172363487_tab_dc_vrp_erps_cfg_002101" frame="border" border="1" rules="all"><thead align="left"><tr id="EN-US_TASK_0172370299__en-us_task_0172363487_row1031143283214029"><th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.1.6.1.4.1.1" liSelected="liSelected"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1246526915214029">Device</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.1.6.1.4.1.2" liSelected="liSelected"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p23365172214029">Interface</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.1.6.1.4.1.3" liSelected="liSelected"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p472906143214029">IP Address</p>
</th>
</tr>
</thead>
<tbody><tr id="EN-US_TASK_0172370299__en-us_task_0172363487_row6244656214029"><td class="cellrowborder" rowspan="4" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.1 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p663308623214029">PE1</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.2 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p955440145214029">GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.3 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1211894568214029">--</p>
</td>
</tr>
<tr id="EN-US_TASK_0172370299__en-us_task_0172363487_row1053365603214029"><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.2 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1812434234214029">GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.3 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1802643007214029">10.1.1.1/24</p>
</td>
</tr>
<tr id="EN-US_TASK_0172370299__en-us_task_0172363487_row2086137162214029"><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.2 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p936393552214029">GE <span>0/3/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.3 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1781570525214029">10.3.1.1/24</p>
</td>
</tr>
<tr id="EN-US_TASK_0172370299__en-us_task_0172363487_row691873718214029"><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.2 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1304951853214029">Loopback 1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.3 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1142889941214029">1.1.1.1/32</p>
</td>
</tr>
<tr id="EN-US_TASK_0172370299__en-us_task_0172363487_row458773744214029"><td class="cellrowborder" rowspan="4" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.1 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1395309658214029">PE2</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.2 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1537089138214029">GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.3 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1521519089214029">--</p>
</td>
</tr>
<tr id="EN-US_TASK_0172370299__en-us_task_0172363487_row1919627852214029"><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.2 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1299269609214029">GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.3 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p516511210214029">10.2.1.1/24</p>
</td>
</tr>
<tr id="EN-US_TASK_0172370299__en-us_task_0172363487_row1302320882214029"><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.2 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1384976303214029">GE <span>0/3/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.3 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1783763084214029">10.3.1.2/24</p>
</td>
</tr>
<tr id="EN-US_TASK_0172370299__en-us_task_0172363487_row1711069341214029"><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.2 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1512576193214029">Loopback 1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.3 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p995828304214029">2.2.2.2/32</p>
</td>
</tr>
<tr id="EN-US_TASK_0172370299__en-us_task_0172363487_row5808431214029"><td class="cellrowborder" rowspan="3" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.1 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p810036456214029">PE3</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.2 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p874462479214029">GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.1.6.1.4.1.3 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p338071997214029">10.1.1.2/24</p>
</td>
</tr>
<tr id="EN-US_TASK_0172370299__en-us_task_0172363487_row50839424214029"><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.2 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p755334219214029">GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.3 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p385491395214029">10.2.1.2/24</p>
</td>
</tr>
<tr id="EN-US_TASK_0172370299__en-us_task_0172363487_row369591597214029"><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.2 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1571446662214029">Loopback 1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.1.4.1.3 "><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1797366550214029">3.3.3.3/32</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172370299__1.4.2"></a><a name="1.4.2"></a>
<div class="p" id="EN-US_TASK_0172370299__en-us_task_0172363487_context1162873107214029"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1474621935214029">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0172370299__en-us_task_0172363487_ol1454481786214029"><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li53605615214029"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1153923212214029"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_li53605615214029"></a><a name="en-us_task_0172363487_li53605615214029"></a>Configure an IGP on the VPLS backbone network to allow the PEs to communicate.</p>
</li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li840928036214029"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p887620145214029"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_li840928036214029"></a><a name="en-us_task_0172363487_li840928036214029"></a>Configure basic MPLS functions and establish LDP LSPs on the VPLS backbone network.</p>
</li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li1394848850214029"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1293131298214029"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_li1394848850214029"></a><a name="en-us_task_0172363487_li1394848850214029"></a>Establish a VPLS connection between every two PEs and bind each VLANIF interface to a VSI.</p>
</li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li141243277214029"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p906326604214029"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_li141243277214029"></a><a name="en-us_task_0172363487_li141243277214029"></a>Configure ERPS.</p>
<ul id="EN-US_TASK_0172370299__en-us_task_0172363487_ul1772677584214029"><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li1052979480214029">Enable ERPS on PE1, PE2, and the CE.</li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li537211387214029">Configure an RPL owner port.</li></ul>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172370299__1.4.3"></a><a name="1.4.3"></a>
<div class="p" id="EN-US_TASK_0172370299__en-us_task_0172363487_context1199046888214029"><h4 class="sectiontitle">Data Preparation</h4><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p288174954214029">To complete the configuration, you need the following data:</p>
<ul id="EN-US_TASK_0172370299__en-us_task_0172363487_ul101830834214029"><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li1436954172214029"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p287674642214029"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_li1436954172214029"></a><a name="en-us_task_0172363487_li1436954172214029"></a>Data needed for configuring OSPF: IP address of each interface, OSPF process ID, and OSPF domain ID</p>
</li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li1193465836214029"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1083042672214029"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_li1193465836214029"></a><a name="en-us_task_0172363487_li1193465836214029"></a>MPLS LSR IDs (used as peer addresses)</p>
</li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li273867927214029"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p840793568214029"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_li273867927214029"></a><a name="en-us_task_0172363487_li273867927214029"></a>VSI names and VSI IDs</p>
</li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li1821391646214029"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1897489984214029"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_li1821391646214029"></a><a name="en-us_task_0172363487_li1821391646214029"></a>VLANIF interfaces bound to VSIs</p>
</li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li1550844922214029"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1041580415214029"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_li1550844922214029"></a><a name="en-us_task_0172363487_li1550844922214029"></a>ERPS ring ID, control VLAN ID, and RPL owner port number</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172370299__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0172370299__en-us_task_0172363487_steps1607672952214029"><li id="EN-US_TASK_0172370299__en-us_task_0172363487_step351488680214029"><span id="EN-US_TASK_0172370299__en-us_task_0172363487_cmd1890215510214029">Configure interface IP addresses and an IGP on the VPLS backbone network to allow PEs to communicate. This example uses OSPF as the IGP.</span><p><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p54223909214029">When configuring OSPF, configure PE1, PE2, and PE3 to advertise their 32-bit IP addresses (used as LSR IDs) of loopback interfaces.</p>
<p id="EN-US_TASK_0172370299__en-us_task_0172363487_p116686370214029">For configuration details, see <a href="#EN-US_TASK_0172370299__en-us_task_0172363487_example_01">Configuration Files</a> in this section.</p>
</p></li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_step1061096425214029"><span id="EN-US_TASK_0172370299__en-us_task_0172363487_cmd1143410287214029">Configure basic MPLS functions and establish dynamic LDP LSPs between every two PEs.</span><p><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p2094180980214029"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen173276722214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword13413122214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b858938574214313">mpls lsr-id 1.1.1.1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen126097474214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword599662062214313">*</span>PE1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b577351451214313">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen655127528214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword359370365214313">*</span>PE1-mpls] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b2010693931214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1013640686214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1526493306214313">*</span>PE1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b185949403214313">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1794453059214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword466082628214313">*</span>PE1-mpls-ldp] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b2102545753214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1508806341214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword2122869232214313">*</span>PE1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b632352387214313">interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen546165399214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword629171712214313">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1527510360214313">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen2051721876214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword275813164214313">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b117733544214313">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen951928398214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1046716217214313">*</span>PE1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b28913229214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen831467950214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword633900450214313">*</span>PE1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b206067689214313">interface gigabitethernet <span>0/3/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1293634570214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword834168659214313">*</span>PE1-GigabitEthernet<span>0/3/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1066777067214313">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen202120158214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1100500112214313">*</span>PE1-GigabitEthernet<span>0/3/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1182341609214313">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1791108503214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword2032450024214313">*</span>PE1-GigabitEthernet<span>0/3/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1364549055214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1652560832214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword197070402214313">*</span>PE1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1691282110214313">commit</strong></pre>
<p id="EN-US_TASK_0172370299__en-us_task_0172363487_p284309679214029"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen694396569214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1410587082214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1609760330214313">mpls lsr-id 2.2.2.2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1583248739214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1545404951214313">*</span>PE2] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b85981396214313">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1388165823214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1327923002214313">*</span>PE2-mpls] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1089876560214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen198736483214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword52130364214313">*</span>PE2] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1665713172214313">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1312942210214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword181305974214313">*</span>PE2-mpls-ldp] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1711764384214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen2141910341214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1167075552214313">*</span>PE2] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1516219656214313">interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen2057684701214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword938771501214313">*</span>PE2-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1674230874214313">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen2037181451214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword494805575214313">*</span>PE2-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b537317976214313">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen2024016602214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1239615088214313">*</span>PE2-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1386196823214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen973898877214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1590890849214313">*</span>PE2] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b976383240214313">interface gigabitethernet <span>0/3/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1933130482214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword924154553214313">*</span>PE2-GigabitEthernet<span>0/3/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1398240145214313">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen713924377214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword2072134588214313">*</span>PE2-GigabitEthernet<span>0/3/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b320710010214313">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen123471716214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword849696444214313">*</span>PE2-GigabitEthernet<span>0/3/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b290953410214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1124391271214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1889951887214313">*</span>PE2] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1960616633214313">commit</strong></pre>
<p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1744975053214029"># Configure PE3.</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1796636971214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1423781942214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b963923389214313">mpls lsr-id 3.3.3.3</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen638070769214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1135907879214313">*</span>PE3] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b2014458448214313">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen858948136214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1996100880214313">*</span>PE3-mpls] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1429854102214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen2054261144214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1102915632214313">*</span>PE3] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1593008314214313">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1279153012214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword797256581214313">*</span>PE3-mpls-ldp] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b531122220214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1496035870214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword580841188214313">*</span>PE3] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b283401257214313">interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen745724129214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1655766122214313">*</span>PE3-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b622078826214313">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1493486309214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1313582363214313">*</span>PE3-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b176665426214313">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen657120782214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword2021238168214313">*</span>PE3-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b863097200214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1332982485214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1380315932214313">*</span>PE3] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1361618580214313">interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen917956937214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword592019857214313">*</span>PE3-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1104561611214313">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen287364014214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1294347822214313">*</span>PE3-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b676734923214313">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen4839662214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1527194367214313">*</span>PE3-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1926934127214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1660795911214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1194745189214313">*</span>PE3] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1193462128214313">commit</strong></pre>
</p></li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_step366021482214029"><span id="EN-US_TASK_0172370299__en-us_task_0172363487_cmd1329882966214029">Enable MPLS L2VPN on each PE.</span><p><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1715083569214029"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen315567228214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1287535288214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b2018193391214313">mpls l2vpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1019391095214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword62671023214313">*</span>PE1-l2vpn] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1602214998214313">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1527507372214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword434713044214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-l2vpn] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b611480732214313">quit</strong></pre>
<p id="EN-US_TASK_0172370299__en-us_task_0172363487_p608338347214029"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1303629843214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1146810123214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b2146651325214313">mpls l2vpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1495284633214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword869510139214313">*</span>PE2-l2vpn] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b970913931214313">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1225305194214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1158491704214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-l2vpn] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b700869204214313">quit</strong></pre>
<p id="EN-US_TASK_0172370299__en-us_task_0172363487_p605210052214029"># Configure PE3.</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1292979771214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1353465238214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1578795781214313">mpls l2vpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1281705406214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword506452127214313">*</span>PE3-l2vpn] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1258386599214313">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1739622148214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1378793329214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3-l2vpn] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1724886593214313">quit</strong></pre>
</p></li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_step2061319832214029"><span id="EN-US_TASK_0172370299__en-us_task_0172363487_cmd1396223020214029">Configure VPLS.</span><p><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p681947976214029"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen841274608214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1625267108214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1134216012214313">vsi s1 static</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1387624835214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1145657915214313">*</span>PE1-vsi-s1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b231523559214313">pwsignal ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1718525132214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1887072252214313">*</span>PE1-vsi-s1-ldp] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b202773178214313">vsi-id 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1260774896214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1804395356214313">*</span>PE1-vsi-s1-ldp] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b137527066214313">peer 2.2.2.2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen796808197214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword2070055946214313">*</span>PE1-vsi-s1-ldp] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1008135294214313">peer 3.3.3.3</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1019351906214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1266554357214313">*</span>PE1-vsi-s1-ldp] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1466452467214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1975143871214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword964258087214313">*</span>PE1-vsi-s1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b2068329038214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1879208494214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword300220262214313">*</span>PE1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b470818315214313">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1690232954214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword615739616214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b345234915214313">vlan 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen671656784214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword664282837214313">*</span>PE1-vlan10] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b172759548214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1967915214214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1033445301214313">*</span>PE1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b129898426214313">interface vlanif10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen43185450214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword475771598214313">*</span>PE1-Vlanif10] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1422191781214313">l2 binding vsi s1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen2132907450214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword2096148689214313">*</span>PE1-Vlanif10] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b365625547214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1643087087214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword786265291214313">*</span>PE1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b583864200214313">commit</strong></pre>
<p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1365181547214029"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen228161436214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword339520190214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1766407412214313">vsi s1 static</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen811767418214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1169001272214313">*</span>PE2-vsi-s1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1407520601214313">pwsignal ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen714972045214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword716449135214313">*</span>PE2-vsi-s1-ldp] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1148870917214313">vsi-id 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen473586281214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1385264727214313">*</span>PE2-vsi-s1-ldp] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b391544297214313">peer 1.1.1.1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1597526730214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1015597005214313">*</span>PE2-vsi-s1-ldp] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1465709444214313">peer 3.3.3.3</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen2014715216214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1829753789214313">*</span>PE2-vsi-s1-ldp] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b540387859214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen812141364214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1761323808214313">*</span>PE2-vsi-s1]<strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1950385053214313"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen525758644214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1846779307214313">*</span>PE2] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b496818988214313">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1922427620214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword833813286214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b783456329214313">vlan 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen966039651214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1400398326214313">*</span>PE2-vlan10] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b690271368214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen2026435087214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword2139279853214313">*</span>PE2] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b177935817214313">interface vlanif10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1709854345214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword2020689191214313">*</span>PE2-Vlanif10] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1522445617214313">l2 binding vsi s1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen259308388214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword178943685214313">*</span>PE2-Vlanif10] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1131911733214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1384114945214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1430546459214313">*</span>PE2] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b113598992214313">commit</strong></pre>
<p id="EN-US_TASK_0172370299__en-us_task_0172363487_p304404786214029"># Configure PE3.</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen538232110214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1838270150214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1160943467214313">vsi s1 static</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1849522912214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword633972808214313">*</span>PE3-vsi-s1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1948266332214313">pwsignal ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1947081007214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword416213786214313">*</span>PE3-vsi-s1-ldp] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1729010234214313">vsi-id 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen16318273214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1978034135214313">*</span>PE3-vsi-s1-ldp] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b2125109217214313">peer 1.1.1.1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1671514611214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1565060352214313">*</span>PE3-vsi-s1-ldp] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b27155329214313">peer 2.2.2.2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen343757279214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword490216117214313">*</span>PE3-vsi-s1-ldp] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1594102012214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen223764230214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword221697490214313">*</span>PE3-vsi-s1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1012520751214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1567945809214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword45913086214313">*</span>PE3] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1673463079214313">commit</strong></pre>
</p></li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_step1485312013214029"><span id="EN-US_TASK_0172370299__en-us_task_0172363487_cmd1289089763214029">Configure ERPS on PE1, PE2, and the CE.</span><p><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1849236771214029"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1310718421214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword16144010511"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b12301632165514">stp region-configuration</strong>
[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword10248748185515">*</span>PE1-mst-region] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b2510714185818">instance 0 vlan 10 100</strong>
[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1256192625812">*</span>PE1-mst-region] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b2099063465815">commit</strong>
[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1993820582589"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-mst-region] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b679018845911">quit</strong>
[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1390495446214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b837487389214313">erps ring 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen2077474326214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword964381415214313">*</span>PE1-erps-ring1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b548632429214313">control-vlan 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen82587736214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword260257288214029">*</span>PE1-erps-ring1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b25037516214029">protected-instance 0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1020568271214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1866293210214313">*</span>PE1-erps-ring1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1868331530214313">version v2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen451886406214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1527375946214313">*</span>PE1-erps-ring1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1288310063214313">sub-ring</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1654604119214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword758614194214313">*</span>PE1-erps-ring1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b285123155214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1269907531214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1406988506214313">*</span>PE1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b47455062214313">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1502538839214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword959357106214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1637819377214313">interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen60375555214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1856306522214313">*</span>PE1-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b441650019214313">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen109183692214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1027235669214313">*</span>PE1-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b221883777214313">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen335475044214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1272863385214313">*</span>PE1-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b968038857214313">port link-type trunk</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1635194642214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1009478503214313">*</span>PE1-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1234451118214313">port trunk allow-pass vlan 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1430056967214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword265749948214313">*</span>PE1-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1522243328214313">stp disable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen17226980214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword444079183214313">*</span>PE1-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1862743589214313">erps ring 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1933156604214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1791880538214313">*</span>PE1-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b310872489214313">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1367047242214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword195895686214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b487767834214313">quit</strong></pre>
<p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1902555190214029"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1101447363214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword543914552112"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b13439115520116">stp region-configuration</strong>
[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword194399551110">*</span>PE2-mst-region] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b13439185516116">instance 0 vlan 10 100</strong>
[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1643914551216">*</span>PE2-mst-region] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b164390551114">commit</strong>
[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword154391955111"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-mst-region] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b5439155514">quit</strong>
[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword106633392214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1129325568214313">erps ring 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen828286090214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1605725704214313">*</span>PE2-erps-ring1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1006715567214313">control-vlan 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen672753824214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword2091255973214029">*</span>PE2-erps-ring1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b278324582214029">protected-instance 0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1937355165214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1520294467214313">*</span>PE2-erps-ring1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1106971646214313">version v2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1195983510214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1016656991214313">*</span>PE2-erps-ring1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1925062042214313">sub-ring</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen454007048214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1125549163214313">*</span>PE2-erps-ring1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b746061778214313">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1755134645214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1938626120214313">*</span>PE2] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1849774503214313">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1643773549214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1781515581214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b144585176214313">interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1623988991214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1692801812214313">*</span>PE2-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b846224518214313">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1229395676214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1755690902214313">*</span>PE2-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1759003155214313">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1088507019214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword202966227214313">*</span>PE2-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1695555924214313">port link-type trunk</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen563956859214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword485730636214313">*</span>PE2-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b602714748214313">port trunk allow-pass vlan 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen882575991214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1465461078214313">*</span>PE2-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1617871672214313">stp disable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen526114198214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1713716591214313">*</span>PE2-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1162977898214313">erps ring 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen141031042214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword733914882214313">*</span>PE2-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b966115777214313">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen852495170214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1233462450214313"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b891465495214313">quit</strong></pre>
<p id="EN-US_TASK_0172370299__en-us_task_0172363487_p2121651901214029"># Configure the CE.</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen573987843214029">&lt;<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword592240568214313">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b430805589214313">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1687311653214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1597319023214029"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword447748414214029">HUAWEI</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b47611194214029">sysname CE</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen321296169214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword806900974214313">*</span><span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword225439213214313">HUAWEI</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b942221612214313">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen2065427598214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword2198172812418"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b61986281245">stp region-configuration</strong>
[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword18199428843">*</span>CE-mst-region] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1119912813417">instance 0 vlan 10 100</strong>
[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1519992813416">*</span>CE-mst-region] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b619914281543">commit</strong>
[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword131991828349"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE-mst-region] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b2019916287412">quit</strong>
[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1741121183214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b646463404214029">erps ring 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen596274794214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1134477157214029">*</span>CE-erps-ring1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1998722188214029">control-vlan 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1550890547214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword439214539214029">*</span>CE-erps-ring1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b2105350935214029">protected-instance 0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen547709180214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword178042082214029">*</span>CE-erps-ring1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1423103551214029">version v2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen853035428214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword873766301214029">*</span>CE-erps-ring1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1261809907214029">sub-ring</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen480852295214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword661135646214029">*</span>CE-erps-ring1] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1154150814214029">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen552321771214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword216157931214029">*</span>CE] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b286352227214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1222884237214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1482028924214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1346808594214029">interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1297959935214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword2036561449214029">*</span>CE-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b545591923214029">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1675459589214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword988526205214029">*</span>CE-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b715190812214029">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1096923989214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword588923376214029">*</span>CE-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b204447160214029">port link-type trunk</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen469336871214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1944277028214029">*</span>CE-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b833077419214029">port trunk allow-pass vlan 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen101528164214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword272293706214029">*</span>CE-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b384023580214029">stp disable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen661468456214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1350155785214029">*</span>CE-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1948751714214029">erps ring 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen214241756214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1529326002214029">*</span>CE-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1226774232214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen60798425214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword745366195214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE-gigabitethernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1434582269214029">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1231935615214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword2001221140214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b732175166214029">interface gigabitethernet <span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen531465081214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword494068742214029">*</span>CE-gigabitethernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1497982865214029">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1585837641214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1398691584214029">*</span>CE-gigabitethernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1120596159214029">port link-type trunk</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen336269811214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword339861950214029">*</span>CE-gigabitethernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b436499084214029">port trunk allow-pass vlan 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen7853075214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword248297203214029">*</span>CE-gigabitethernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1958877606214029">stp disable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1151954625214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword888608364214029">*</span>CE-gigabitethernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b809344591214029">erps ring 1 rpl owner</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen742547300214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword931320937214029">*</span>CE-gigabitethernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1327403456214029">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1236595586214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword451062858214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE-gigabitethernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b703232331214029">quit</strong></pre>
</p></li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_step828895951214029"><span id="EN-US_TASK_0172370299__en-us_task_0172363487_cmd527830368214029">Verify the configuration.</span><p><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1967959995214029">After the configurations are complete, run the <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1191575585214313">display vsi name s1 verbose</strong> command on PE3. The command output shows that PE3 has established two PWs: one with PE1 (1.1.1.1), one with PE2 (2.2.2.2.).</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1876506327214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1482272746214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b931443688214029">display vsi name s1 verbose</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1072525138214029"> ***VSI Name               : s1
    Work Mode              : normal
    Administrator VSI      : no
    Isolate Spoken         : disable
    VSI Index              : 2
    PW Signaling           : ldp
    Member Discovery Style : static
    Bridge-domain Mode     : disable
    PW MAC Learn Style     : unqualify
    Encapsulation Type     : vlan
    MTU                    : 1500
    Diffserv Mode          : uniform
 
    Color                  : --
    DomainId               : 255
    Domain Name            :
    Ignore AcState         : disable
    P2P VSI                : disable
    Multicast Fast Switch  : disable
    Create Time            : 0 days, 1 hours, 19 minutes, 38 seconds
    VSI State              : <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1252193874214029">up</strong>
    Resource Status        : Valid

    VSI ID                 : 10
   *Peer Router ID         : 1.1.1.1
    primary or secondary   : primary
    ignore-standby-state   : no
    VC Label               : 32891
    Peer Type              : dynamic
    Session                : <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1666574631214029">up</strong>
    Tunnel ID              : 0x0000000001004c4b41 
    Broadcast Tunnel ID    : --
    Broad BackupTunnel ID  : -- 
    CKey                   : 2
    NKey                   : 1862271177
    Stp Enable             : 0
    PwIndex                : 1
    Control Word           : disable
   *Peer Router ID         : 2.2.2.2
    primary or secondary   : primary
    ignore-standby-state   : no
    VC Label               : 32892
    Peer Type              : dynamic
    Session                : <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1925816481214029">up</strong>
    Tunnel ID              : 0x0000000001004c4b42 
    Broadcast Tunnel ID    : --
    Broad BackupTunnel ID  : -- 
    CKey                   : 2
    NKey                   : 1862271178
    Stp Enable             : 0
    PwIndex                : 2
    Control Word           : disable
 
  **PW Information:

   *Peer Ip Address        : 1.1.1.1
    PW State               : <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b245687898214029">up</strong>
    Local VC Label         : 32891
    Remote VC Label        : 32890
    Remote Control Word    : disable
    PW Type                : label
    Tunnel ID              : 0x0000000001004c4b41 
    Broadcast Tunnel ID    : --
    Broad BackupTunnel ID  : --
    Ckey                   : 2
    Nkey                   : 1862271177
    Main PW Token          : 0x0
    Slave PW Token         : 0x0
    Tnl Type               : ldp
    OutInterface           : LDP LSP
    Backup OutInterface    : --
    Stp Enable             : 0
    Mac Flapping           : 0
    PW Last Up Time        : 2013/12/26 17:35:12
    PW Total Up Time       : 0 days, 1 hours, 19 minutes, 38 seconds  
   *Peer Ip Address        : 2.2.2.2
    PW State               : <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1374736718214029">up</strong>
    Local VC Label         : 32892
    Remote VC Label        : 32893
    Remote Control Word    : disable
    PW Type                : label
    Tunnel ID              : 0x0000000001004c4b42 
    Broadcast Tunnel ID    : --
    Broad BackupTunnel ID  : --
    Ckey                   : 2
    Nkey                   : 1862271178
    Main PW Token          : 0x0
    Slave PW Token         : 0x0
    Tnl Type               : ldp
    OutInterface           : LDP LSP
    Backup OutInterface    : --
    Stp Enable             : 0
    Mac Flapping           : 0
    PW Last Up Time        : 2013/12/28 10:35:45
    PW Total Up Time       : 0 days, 1 hours, 19 minutes, 45 seconds</pre>
<p id="EN-US_TASK_0172370299__en-us_task_0172363487_p761478531214029">Run the <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1262710600214313">display erps</strong> command on the CE. The command output shows that the link between the CE and PE1 is blocked.</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1473705172214029">[<span class="keyword" id="EN-US_TASK_0172370299__en-us_task_0172363487_keyword1503290882214029"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE] <strong id="EN-US_TASK_0172370299__en-us_task_0172363487_b1189855239214029">display erps</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen748652389214029">D  : Discarding
F  : Forwarding
R  : RPL Owner
N  : RPL Neighbour
FS : Forced Switch
MS : Manual Switch
Total number of rings configured = 1
Ring  Control  WTR Timer  Guard Timer  Port 1              Port 2
ID    VLAN     (min)      (csec)
--------------------------------------------------------------------------------
   1       100         5          200  (F)GE<span>0/1/0</span>          (D,R)GE<span>0/2/0</span>
--------------------------------------------------------------------------------
</pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172370299__en-us_task_0172363487_example_01"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_example_01"></a><a name="en-us_task_0172363487_example_01"></a><a name="EN-US_TASK_0172370299__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul id="EN-US_TASK_0172370299__en-us_task_0172363487_ul1643482120214029"><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li1970620586214029"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1727384868214029"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_li1970620586214029"></a><a name="en-us_task_0172363487_li1970620586214029"></a>PE1 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen1736659684214029">#
sysname PE1
#
vlan batch 10 100
#
stp region-configuration
 instance 0 vlan 10 100
#
erps ring 1
 control-vlan 100
 protected-instance 0
 version v2
 sub-ring
#
mpls lsr-id 1.1.1.1
#
mpls
#
mpls l2vpn
#
vsi s1 static
 pwsignal ldp
  vsi-id 10
  peer 2.2.2.2
  peer 3.3.3.3
#
mpls ldp
#
interface Vlanif10
 l2 binding vsi s1
#
interface GigabitEthernet<span>0/1/0</span>
 portswitch
 undo shutdown
 port link-type trunk
 port trunk allow-pass vlan 10 100
 stp disable
 erps ring 1
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.1.1.1 255.255.255.0
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 ip address 10.3.1.1 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 1.1.1.1 255.255.255.255
#
ospf 1
 area 0.0.0.0
  network 1.1.1.1 0.0.0.0
  network 10.1.1.0 0.0.0.255
  network 10.3.1.0 0.0.0.255
#
return
</pre>
</li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li1088089951214029"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1704552252214029"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_li1088089951214029"></a><a name="en-us_task_0172363487_li1088089951214029"></a>PE2 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen5439397214029">#
sysname PE2
#
vlan batch 10 100
#
stp region-configuration
 instance 0 vlan 10 100
#
erps ring 1
 control-vlan 100
 protected-instance 0
 version v2
 sub-ring
#
mpls lsr-id 2.2.2.2
#
mpls
#
mpls l2vpn
#
vsi s1 static
 pwsignal ldp
  vsi-id 10
  peer 1.1.1.1
  peer 3.3.3.3
#
mpls ldp
#
interface Vlanif10
 l2 binding vsi s1
#
interface GigabitEthernet<span>0/1/0</span>
 portswitch
 undo shutdown
 port link-type trunk
 port trunk allow-pass vlan 10 100
 stp disable
 erps ring 1
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.2.1.1 255.255.255.0
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 ip address 10.3.1.2 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 2.2.2.2 255.255.255.255
#
ospf 1
 area 0.0.0.0
  network 2.2.2.2 0.0.0.0
  network 10.2.1.0 0.0.0.255
  network 10.3.1.0 0.0.0.255
#
return
</pre>
</li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li704915379214029"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p1992978001214029"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_li704915379214029"></a><a name="en-us_task_0172363487_li704915379214029"></a>PE3 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen149312303214029">#
sysname PE3
#
mpls lsr-id 3.3.3.3
#
mpls
#
mpls l2vpn
#
vsi s1 static
 pwsignal ldp
  vsi-id 10
  peer 1.1.1.1
  peer 2.2.2.2
#
mpls ldp
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.1.1.2 255.255.255.0
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/2/0</span>
 ip address 10.2.1.2 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 3.3.3.3 255.255.255.255
#
ospf 1
 area 0.0.0.0
  network 3.3.3.3 0.0.0.0
  network 10.1.1.0 0.0.0.255
  network 10.2.1.0 0.0.0.255
#
return
</pre>
</li><li id="EN-US_TASK_0172370299__en-us_task_0172363487_li1242647023214029"><p id="EN-US_TASK_0172370299__en-us_task_0172363487_p890048486214029"><a name="EN-US_TASK_0172370299__en-us_task_0172363487_li1242647023214029"></a><a name="en-us_task_0172363487_li1242647023214029"></a>CE configuration file</p>
<pre class="screen" id="EN-US_TASK_0172370299__en-us_task_0172363487_screen405045191214029">#
sysname CE
#
vlan batch 10 100
#
stp region-configuration
 instance 0 vlan 10 100
#
erps ring 1
 control-vlan 100
 protected-instance 0
 version v2
 sub-ring
#
interface GigabitEthernet<span>0/1/0</span>
 portswitch
 undo shutdown
 port link-type trunk
 port trunk allow-pass vlan 10 100
 stp disable
 erps ring 1
#
interface GigabitEthernet<span>0/2/0</span>
 portswitch
 port link-type trunk
 port trunk allow-pass vlan 10 100
 stp disable
 erps ring 1 rpl owner
#
return
</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_5029.html">Configuration Examples for VPLS
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_6054.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_erps_cfg_0022_1.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>