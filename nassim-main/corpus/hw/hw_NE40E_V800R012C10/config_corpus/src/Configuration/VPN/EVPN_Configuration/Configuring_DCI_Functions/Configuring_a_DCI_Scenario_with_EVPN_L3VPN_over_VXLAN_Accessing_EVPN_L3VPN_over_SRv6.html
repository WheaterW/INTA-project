
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a DCI Scenario with EVPN L3VPN over VXLAN Accessing EVPN L3VPN over SRv6">
<meta name="abstract" content="In a DCI scenario with EVPN L3VPN over VXLAN accessing EVPN L3VPN over SRv6, different cloud platforms are used for management. VXLAN tunnels are established to access the DCI backbone network, over which EVPN L3VPN over SRv6 is used to carry Layer 3 services.">
<meta name="description" content="In a DCI scenario with EVPN L3VPN over VXLAN accessing EVPN L3VPN over SRv6, different cloud platforms are used for management. VXLAN tunnels are established to access the DCI backbone network, over which EVPN L3VPN over SRv6 is used to carry Layer 3 services.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dci_cfg_0002.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dci_cfg_0027.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dci_cfg_0046.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,f00454608,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="p00915595">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="p00915595">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001171403020">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a DCI Scenario with EVPN L3VPN over VXLAN Accessing EVPN L3VPN over SRv6</title>
</head>
<body><a name="EN-US_TASK_0000001171403020"></a><a name="EN-US_TASK_0000001171403020"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a DCI Scenario with EVPN L3VPN over VXLAN Accessing EVPN L3VPN over SRv6</h1>
<div class="taskbody"><p>In a DCI scenario with EVPN L3VPN over VXLAN accessing EVPN L3VPN over SRv6, different cloud platforms are used for management. VXLAN tunnels are established to access the DCI backbone network, over which EVPN L3VPN over SRv6 is used to carry Layer 3 services.</p>
<div class="context"><a name="EN-US_TASK_0000001171403020__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>DC GWs and DCI-PEs are separately deployed, and EVPN is used as the control plane protocol to establish VXLAN tunnels. A DCI-PE runs EVPN to learn a VM's host IP route information from a DC and uses EVPN L3VPN over SRv6 to send received host IP routes to the peer DCI-PE, allowing VM host packets to be forwarded at Layer 3.</p>
<p>On the network shown in <a href="#EN-US_TASK_0000001171403020__fig_dc_vrp_dci_cfg_000501">Figure 1</a>, the DC GWs GW1 and GW2 are connected to the DCI backbone network with EVPN L3VPN over SRv6 configured. After EVPN and VXLAN tunnels are deployed between the DC GWs and DCI-PEs, host IP routes can be exchanged between different DCs, implementing communication between VMs in different DCs.</p>
<div class="fignone" id="EN-US_TASK_0000001171403020__fig_dc_vrp_dci_cfg_000501"><a name="EN-US_TASK_0000001171403020__fig_dc_vrp_dci_cfg_000501"></a><a name="fig_dc_vrp_dci_cfg_000501"></a><span class="figcap"><b>Figure 1 </b>Configuring a DCI scenario with EVPN L3VPN over VXLAN accessing EVPN L3VPN over SRv6</span><br><span><img class="vsd" src="figure/en-us_image_0000001216884345.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001171403020__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure a VXLAN tunnel between each DCI-PE and the corresponding gateway. For configuration details, see <a href="dc_vrp_vxlan_cfg_1216.html">Configuring VXLAN</a>.</span></li><li><span>Configure basic EVPN L3VPN over SRv6 functions on the DCI backbone network. For configuration details, see <a href="dc_vrp_evpn_cfg_0152_copy.html">Configuring EVPN L3VPN over IS-IS SRv6 BE</a>.</span></li><li><span>Configure each DCI-PE to advertise re-originated routes to its BGP EVPN peer.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname">l2vpn-family evpn</span></b></a></span><p><p>The BGP-EVPN address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>import</span></strong> <strong><span>reoriginate</span></strong></span><p><p>The device is enabled to add a re-origination flag to EVPN routes received from the DC.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>advertise</span></strong> <strong><span>route-reoriginated</span></strong> <strong><span>evpn</span></strong> { <strong><span>ip</span></strong><span> | <strong><span>ipv6</span></strong></span> }</span><p><p>The device is configured to advertise re-originated routes to its BGP EVPN peer (remote PE).</p>
</p><p><p>After this step is performed, the DCI-PE re-originates the VXLAN-encapsulated EVPN routes received from the DC and then advertises them as SRv6-encapsulated EVPN routes to its BGP EVPN peers on the DCI backbone network.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the BGP-EVPN address family view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the BGP view.</p>
</p></li></ol>
</li><li><span>Configure each DCI-PE to advertise re-originated routes to its DC-side BGP EVPN peers.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname">l2vpn-family evpn</span></b></a></span><p><p>The BGP-EVPN address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>import</span></strong> <strong><span>reoriginate</span></strong></span><p><p>The device is enabled to add a re-origination flag to EVPN routes received from the peer DCI-PE.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>advertise</span></strong> <strong><span>route-reoriginated</span></strong> <strong><span>evpn</span></strong> { <strong><span>mac-ip</span></strong> | <strong><span>ip</span></strong><span> | <strong><span>mac-ipv6</span></strong> | <strong><span>ipv6</span></strong></span> }</span><p><p>The device is configured to advertise re-originated routes to its DC-side BGP EVPN peers.</p>
</p><p><p>After this step is performed, if a DCI-PE receives SRv6-encapsulated EVPN routes from a BGP EVPN peer on the DCI backbone network, the DCI-PE re-originates the EVPN routes and advertises them as VXLAN-encapsulated EVPN routes to its DC-side BGP EVPN peers.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>advertise encap-type vxlan</span></strong></span><p><p>The device is configured to advertise VXLAN-encapsulated EVPN routes to DC-side EVPN peers.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the BGP-EVPN address family view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the BGP view.</p>
</p></li></ol>
</li><li><span>Enable EVPN route advertisement in the BGP-VPN instance address family view.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family+vpn-instance"><b><span class="cmdname">ipv4-family vpn-instance</span></b></a> <em>vpn-instance-name</em> or <a href="cmdqueryname=ipv6-family+vpn-instance"><b><span class="cmdname">ipv6-family vpn-instance</span></b></a> <em>vpn-instance-name</em></span><p><p>The BGP VPN instance IPv4/IPv6 address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=advertise+l2vpn+evpn"><b><span class="cmdname">advertise l2vpn evpn</span></b></a></span><p><p>The device is configured to advertise the host IPv4/IPv6 routes in the VPN instance as EVPN IPv4/IPv6 prefix routes.</p>
</p></li></ol>
</li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dci_cfg_0002.html">Configuring DCI Functions
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dci_cfg_0027.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dci_cfg_0046.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>