
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a VPN Instance">
<meta name="abstract" content="A VPN instance can be configured on a PE to manage VPN routes.">
<meta name="description" content="A VPN instance can be configured on a PE to manage VPN routes.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2063.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2065.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,l3vpnvrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IPv6 VPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="h00847023">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00847023">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369618">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a VPN Instance</title>
</head>
<body><a name="EN-US_TASK_0172369618"></a><a name="EN-US_TASK_0172369618"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a VPN Instance</h1>
<div class="taskbody"><p>A VPN instance can be configured on a PE to manage VPN routes.</p>
<div class="context"><a name="EN-US_TASK_0172369618__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>In the hub-spoke networking, the PE connected to a central site (Hub site) is called a Hub-PE and the PE connected to a non-central site (Spoke site) is called a Spoke-PE.</p>
<div class="p">You need to configure a VPN instance on each Spoke-PE and two VPN instances (VPN-in and VPN-out) on each Hub-PE.<ul><li><p>VPN-in is used to receive and maintain the VPNv6 routes advertised by all the Spoke-PEs.</p>
</li><li><p>VPN-out is used to maintain the routes of the Hub site and all the Spoke sites and advertise the routes to all Spoke-PEs.</p>
</li></ul>
</div>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Steps 1 to 8 are performed to configure one VPN instance. Configurations of different VPN instances are similar. Note that the different VPN instances on the same device must have different names, RDs, and description.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172369618__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></span></span><p><p>A VPN instance is created and the VPN instance view is displayed.</p>
<p>The name of a VPN instance is case sensitive. For example, <strong>vpn1</strong> and <strong>VPN1</strong> are considered different VPN instances.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=description"><b><span class="cmdname">description</span></b></a> <i><span class="varname">description-information</span></i></span></span><p><p>The description of the VPN instance is configured.</p>
<p>The description is used to record the purpose of creating the VPN instance and the CEs connected to the VPN instance.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=ipv6-family"><b><span class="cmdname">ipv6-family</span></b></a></span></span><p><p>The IPv6 address family is enabled for the VPN instance and the VPN instance IPv6 address family view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=route-distinguisher"><b><span class="cmdname">route-distinguisher</span></b></a> <i><span class="varname">route-distinguisher</span></i></span></span><p><p>An RD is set for the VPN instance IPv6 address family.</p>
<p>A VPN instance <span>IPv6 address family</span> takes effect only after being assigned an RD. Before setting the RD, you can configure only the description about the VPN instance. No other parameters can be configured.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=apply-label+per-route+pop-go"><b><span class="cmdname">apply-label per-route pop-go</span></b></a></span></span><p><p>The device is configured to assign a unique label to each VPNv6 route sent to its BGP VPNv6 peer and forward the data packets received from its BGP VPNv6 peer through outbound interfaces found in the local ILM table.</p>
</p><p><p>After the <a href="cmdqueryname=apply-label+per-route+pop-go"><b><span class="cmdname">apply-label per-route pop-go</span></b></a> command is configured, the local device records in the ILM the mapping between the label assigned to each VPNv6 route and the outbound interface of the route. Then, after the local device receives a labeled data packet from its BGP VPNv6 peer, the local device directly searches the ILM for an outbound interface based on label information carried in the packet and forwards the packet through the found outbound interface after removing its label. This implementation significantly accelerates packet forwarding.</p>
<p>The <a href="cmdqueryname=apply-label+per-route+pop-go"><b><span class="cmdname">apply-label per-route pop-go</span></b></a> command is mutually exclusive with the <a href="cmdqueryname=apply-label+per-instance"><b><span class="cmdname">apply-label per-instance</span></b></a> command. If the two commands are both configured, the later configuration overrides the previous one.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=apply-label+per-instance"><b><span class="cmdname">apply-label per-instance</span></b></a></span></span><p><p>MPLS label allocation based on VPN instances IPv6 address family is configured. Then, all the routes of the VPN instance IPv6 address family use one label.</p>
</p><p></p></li><li><span>(Optional) Run <span><a href="cmdqueryname=prefix+limit"><b><span class="cmdname">prefix limit</span></b></a> <i><span class="varname">number</span></i> { <i><span class="varname">alert-percent</span></i> [ <strong><span>route-unchanged</span></strong> ] | <strong><span>simply-alert</span></strong> }</span></span><p><p>The maximum number of prefixes of the VPN instance IPv6 address family is set.</p>
<p>To prevent a PE from importing excessive prefixes, you can set the maximum number of prefixes supported by the VPN instance IPv6 address family.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2063.html">Configuring IPv6 Hub and Spoke (IPv6)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v6_cfg_2065.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>