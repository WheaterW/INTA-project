
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring VPWS Heterogeneous Interworking">
<meta name="abstract" content="If AC types at the two ends of a VPWS PW are different, configure VPWS heterogeneous interworking for the two CEs to communicate.">
<meta name="description" content="If AC types at the two ends of a VPWS PW are different, configure VPWS heterogeneous interworking for the two CEs to communicate.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_3004.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_3006.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_5002.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00415692">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="q00824768">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369802">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring VPWS Heterogeneous Interworking</title>
</head>
<body><a name="EN-US_TASK_0172369802"></a><a name="EN-US_TASK_0172369802"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring VPWS Heterogeneous Interworking</h1>
<div class="taskbody"><p>If AC types at the two ends of a VPWS PW are different, configure VPWS heterogeneous interworking for the two CEs to communicate.</p>
<div class="context"><a name="EN-US_TASK_0172369802__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Determine which configuration procedure to use based on the following guidelines:</p>
<ul><li><p>If the two CEs use non-Ethernet link types, perform Steps 1 to 8 and Step 11.</p>
</li><li><p>If one of the two CEs uses the Ethernet or VLAN link type, performing Steps 9 to 11 is also required on the local PE.</p>
<p>If the PE has not learned the MAC address of the local CE (neither dynamically learned nor statically configured) and the broadcast mode is not enabled, the PE will discard all the IP packets received from the remote PE. To prevent this situation, configure the IP or MAC address of the local CE on the local PE, and configure an interface IP address of the remote CE on the remote PE.</p>
</li></ul>
<p>Perform the following configurations on the endpoint PEs of a PW.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172369802__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=mpls+l2vpn"><b><span class="cmdname">mpls l2vpn</span></b></a></span><p><p>MPLS L2VPN is configured.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> [ .<i><span class="varname">subinterface-number</span></i> ]</span><p><p>The AC interface view is displayed.</p>
</p></li><li><span>Run the following command to create a VPWS connection according to the interface type:</span><p><ul><li><p>Ethernet<span>/PPP</span><span>/HDLC</span> interface:</p>
<p><span><span><a href="cmdqueryname=mpls+l2vc"><b><span class="cmdname" id="EN-US_TASK_0172369802__en-us_task_0172369871_cmdname739843091214052">mpls l2vc</span></b></a></span> <span> [ <strong><span id="EN-US_TASK_0172369802__en-us_task_0172369871_cmdparmname1823474935915">instance-name</span></strong> <i><span class="varname" id="EN-US_TASK_0172369802__en-us_task_0172369871_varname142344493599">instance-name</span></i> ]</span> { <i><span class="varname" id="EN-US_TASK_0172369802__en-us_task_0172369871_varname463468425214052">ip-address</span></i> | <strong><span id="EN-US_TASK_0172369802__en-us_task_0172369871_cmdparmname1287093449214052">pw-template</span></strong> <i><span class="varname" id="EN-US_TASK_0172369802__en-us_task_0172369871_varname486966757214052">template-name</span></i> } <sup id="EN-US_TASK_0172369802__en-us_task_0172369871_sup689890830214052">*</sup> <i><span class="varname" id="EN-US_TASK_0172369802__en-us_task_0172369871_varname1893111836214052">vc-id</span></i> [ <strong><span id="EN-US_TASK_0172369802__en-us_task_0172369871_cmdparmname1700830462214052">tunnel-policy</span></strong> <i><span class="varname" id="EN-US_TASK_0172369802__en-us_task_0172369871_varname512469523214052">policy-name</span></i><span> [ { <strong><span id="EN-US_TASK_0172369802__en-us_task_0172369871_cmdparmname979518521963">endpoint</span></strong> <i><span class="varname" id="EN-US_TASK_0172369802__en-us_task_0172369871_varname1795105212618">endpoint-address</span></i><span> | [ <strong><span id="EN-US_TASK_0172369802__en-us_task_0172369871_cmdparmname13795173991512">endpoint</span></strong> <i><span class="varname" id="EN-US_TASK_0172369802__en-us_task_0172369871_varname87951639171510">endpoint4-address</span></i> ] }</span> <strong><span id="EN-US_TASK_0172369802__en-us_task_0172369871_cmdparmname1879513523613">color</span></strong> <i><span class="varname" id="EN-US_TASK_0172369802__en-us_task_0172369871_varname18795152866">color-value</span></i> ]</span> | [ <strong><span id="EN-US_TASK_0172369802__en-us_task_0172369871_cmdparmname89227926214052">control-word</span></strong> | <strong><span id="EN-US_TASK_0172369802__en-us_task_0172369871_cmdparmname1662205133214052">no-control-word</span></strong> ] | [ <strong><span id="EN-US_TASK_0172369802__en-us_task_0172369871_cmdparmname160423594214052">raw</span></strong> | <strong><span id="EN-US_TASK_0172369802__en-us_task_0172369871_cmdparmname927831475214052">tagged</span></strong> | <strong><span id="EN-US_TASK_0172369802__en-us_task_0172369871_cmdparmname8529156216">ip-layer2</span></strong> | <strong id="EN-US_TASK_0172369802__en-us_task_0172369871_b9162587151"><span>ip-interworking</span></strong><strong id="EN-US_TASK_0172369802__en-us_task_0172369871_b5465143317556"><span> </span></strong>] | <strong><span id="EN-US_TASK_0172369802__en-us_task_0172369871_cmdparmname1310110875214052">access-port</span></strong> | <strong><span id="EN-US_TASK_0172369802__en-us_task_0172369871_cmdparmname1751470272214052">ignore-standby-state</span></strong> ] <sup id="EN-US_TASK_0172369802__en-us_task_0172369871_sup407125283214052">*</sup></span></p>
</li><li>Set the <strong><span>ip-interworking</span></strong> parameter for heterogeneous interworking between Huawei devices.</li><li>Set the <strong><span>ip-layer2</span></strong> parameter for heterogeneous interworking between Huawei and non-Huawei devices.</li></ul>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=undo+interface-parameter-type+vccv"><b><span class="cmdname">undo interface-parameter-type vccv</span></b></a></span><p><p>The function to delete the VCCV byte from the Label Mapping message is enabled.</p>
</p><p><p>Run this command if LDP VPWS is configured for a device running VRP V800R005 or later and this device communicates with another device running VRP V300R001 or any branch version of VRP V300R001.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=mpls+l2vpn+service-name"><b><span class="cmdname">mpls l2vpn service-name</span></b></a> <i><span class="varname">service-name</span></i></span><p><p>An L2VPN service name is specified. The L2VPN service can then be maintained through an NMS based on the specified name.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=local-ce+mac"><b><span class="cmdname">local-ce mac</span></b></a> <i><span class="varname">mac-address</span></i> or <a href="cmdqueryname=local-ce+ip"><b><span class="cmdname">local-ce ip</span></b></a> <i><span class="varname">ip-address</span></i></span><p><p>An Ethernet interface MAC address or IP address is configured for each local CE.</p>
</p><p><ul><li><p>If the Ethernet interface MAC addresses of local CEs are configured, the PE uses the configured MAC addresses as the destination MAC addresses when sending IP packets to local CEs.</p>
</li><li><p>If the Ethernet interface IP addresses of local CEs are configured, if the PE can find neither statically configured nor dynamically learned MAC addresses of local CEs, the PE uses the configured IP addresses as the destination IP addresses to send ARP Request packets to local CEs.</p>
</li></ul>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=local-ce+mac+broadcast"><b><span class="cmdname">local-ce mac broadcast</span></b></a></span><p><p>The PE is configured to use a broadcast address as the destination MAC address to send packets to local CEs.</p>
</p><p><p>If neither command in the preceding step is run, perform this step for the PE to use a broadcast address as the destination MAC address to send packets to local CEs.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=remote-ce+ip"><b><span class="cmdname">remote-ce ip</span></b></a> <i><span class="varname">ip-address</span></i></span><p><p>The IP address of the remote CE relayed by the specified interface is configured.</p>
</p><p><p>In VPWS heterogeneous interworking, if multiple PWs are established on sub-interfaces of the PE, configure this command on each sub-interface to specify the IP address of the remote CE relayed by each sub-interface. This configuration is necessary for P2MP communication between CEs.</p>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0172369802__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Follow-up Procedure</h4>
<div class="p"><p>If the VLAN ID of a CE interface connected to the PE changes or a CE uses another interface to connect to the PE, run the <a href="cmdqueryname=reset+local-ce+mac"><b><span class="cmdname">reset local-ce mac</span></b></a> [ <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> ] command in the user view to clear MAC address and VLAN ID information, so that the PE can re-learn interface information about the CE.</p>
</div></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_3004.html">Configuring LDP VPWS
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_3006.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_5002.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>