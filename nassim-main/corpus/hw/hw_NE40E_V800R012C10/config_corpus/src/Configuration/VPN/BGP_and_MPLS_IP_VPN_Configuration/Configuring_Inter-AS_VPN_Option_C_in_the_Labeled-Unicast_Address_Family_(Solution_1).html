
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Configuring Inter-AS VPN Option C in the Labeled-Unicast Address Family (Solution 1)">
<meta name="abstract" content="To allow PEs in different ASs to exchange VPNv4 routes, configure inter-AS VPN Option C. This enables multi-hop EBGP connections to be established between PEs. The labeled-unicast address family (also known as the BGP-labeled or BGP-LU address family) can be used to negotiate the capability to distribute independent labels.">
<meta name="description" content="To allow PEs in different ASs to exchange VPNv4 routes, configure inter-AS VPN Option C. This enables multi-hop EBGP connections to be established between PEs. The labeled-unicast address family (also known as the BGP-labeled or BGP-LU address family) can be used to negotiate the capability to distribute independent labels.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0143.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0193.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0192.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0187.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0189.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0190.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0191.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,l3vpnvrp,w00556928,l00468467,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="h00847023">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00847023">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0172369349">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Inter-AS VPN Option C in the Labeled-Unicast Address Family (Solution 1)</title>
</head>
<body><a name="EN-US_CONCEPT_0172369349"></a><a name="EN-US_CONCEPT_0172369349"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Inter-AS VPN Option C in the Labeled-Unicast Address Family (Solution 1)</h1>
<div><p>To allow PEs in different ASs to exchange VPNv4 routes, configure inter-AS VPN Option C. This enables multi-hop EBGP connections to be established between PEs. The labeled-unicast address family (also known as the BGP-labeled or BGP-LU address family) can be used to negotiate the capability to distribute independent labels.</p>
<div class="section"><h4 class="sectiontitle">Usage Scenario</h4><p>If the MPLS backbone network carrying VPN routes spans multiple ASs, the inter-AS VPN is required.</p>
<p>If each AS needs to exchange a large number of VPN routes, inter-AS VPN Option C is a good choice to prevent the ASBR from becoming a bottleneck that impedes network expansion. The following solutions can be used to implement inter-AS VPN Option C:</p>
<ul><li>Solution 1: A local ASBR learns a labeled BGP public network route from the peer ASBR, automatically assigns a label to this route, and advertises it to an IBGP peer that supports the label capability, a PE in the same AS. Then, a complete public network LSP is established.</li><li>Solution 2: The IBGP peer relationship between the PE and ASBR is not needed. In this solution, an ASBR learns the labeled public BGP routes of the remote AS from the peer ASBR. These labeled public BGP routes are then imported into the IGP to trigger the establishment of an LDP LSP. In this manner, a complete LDP LSP is established between the two PEs.</li></ul>
<p>Solution 1 is described here, and solution 2 is described in <a href="dc_vrp_mpls-l3vpn-v4_cfg_0193.html">Configuring Inter-AS VPN Option C in the Labeled-Unicast Address Family (Solution 2)</a>.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In inter-AS VPN Option C, do not enable LDP between ASBRs. If LDP is enabled on the interfaces between ASBRs, LDP sessions are then established between the ASBRs. As a result, the ASBRs establish an egress LSP and send Mapping messages to upstream ASBRs. After receiving Mapping messages, the upstream ASBRs establish a transit LSP. If a large number of BGP routes exist, enabling LDP on the interfaces between ASBRs leads to the occupation of a large number of LDP labels.</p>
</div></div>
</div>
<div class="section"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring inter-AS VPN Option C (solution 1), complete the following tasks:</p>
<ul><li><p>Configure IGP on the MPLS backbone network in each AS to ensure IP connectivity within each AS.</p>
</li><li><p>Configure MPLS and MPLS LDP both globally and per interface on each node of the MPLS backbone network.</p>
</li><li><p>Configure an IBGP peer relationship between the PE and ASBR in the same AS.</p>
</li><li><p><a href="dc_vrp_mpls-l3vpn-v4_cfg_0155.html">Configure a VPN instance on each PE</a> and <a href="dc_vrp_mpls-l3vpn-v4_cfg_0156.html">bind the interface that connects a PE to a CE to the VPN instance on that PE</a>.</p>
</li><li><p>Configure an IP address for the interface connecting a CE to a PE.</p>
</li></ul>
</div>
</div>

<ul class="ullinks">
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0192.html">(Optional) Configuring Per-Path Label Distribution for BGP Add-Path Labeled Routes</a>
</dt>
<dd>
After per-path label distribution is configured for BGP Add-Path labeled routes, a device can apply for a unique label for each route when advertising multiple routes to a BGP Add-Path peer. After the peer receives multiple routes with different labels, it can implement BGP LSP load balancing.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0187.html">Enabling BGP Peers to Exchange Labeled IPv4 Routes</a>
</dt>
<dd>
In inter-AS VPN Option C networking, a BGP LSP needs to be established between ASs, and labeled IPv4 routes need to be exchanged between BGP peers.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0189.html">Establishing an MP-EBGP Peer Relationship Between PEs</a>
</dt>
<dd>
By introducing extended community attributes into BGP, MP-EBGP can advertise VPNv4 routes between PEs. PEs of different ASs are generally not directly connected. Therefore, to set up the EBGP connection between the PEs of different ASs, you need to configure the permitted maximum hops between PEs.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0190.html">Configuring Route Exchange Between a CE and a PE</a>
</dt>
<dd>
A PE and a CE can communicate using BGP, an IGP, or a static route.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0191.html">Verifying the Configuration of Inter-AS VPN Option C in an Independent Labeled Address Family (Solution 1)</a>
</dt>
<dd>
After configuring inter-AS VPN Option C (solution 1), check information about all BGP peer relationships, VPNv4 routes on PEs or ASBRs, and labels of IPv4 routes on ASBRs.</dd>
</dl>
</ul>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0000.html">BGP/MPLS IP VPN Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0143.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0193.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>