
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring LDP VPLS over SR-MPLS TE">
<meta name="abstract" content="The public network tunnel to which LDP VPLS recurses can be an SR-MPLS TE tunnel.">
<meta name="description" content="The public network tunnel to which LDP VPLS recurses can be an SR-MPLS TE tunnel.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_5029.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_5031.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_5032.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,vpls,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPLS">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00415692">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00415692">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172370251">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring LDP VPLS over SR-MPLS TE</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172370251"></a><a name="EN-US_TASK_0172370251"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring LDP VPLS over SR-MPLS TE</h1>
<div class="taskbody" id="taskbody2120533526214054"><p id="shortdesc1286927614214054">The public network tunnel to which LDP VPLS recurses can be an SR-MPLS TE tunnel.</p>
<div class="context"><a name="EN-US_TASK_0172370251__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0172370251__context1489213991214054"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0172370251__p2140920662214054">On the network shown in <a href="#EN-US_TASK_0172370251__fig_dc_vrp_vpls_cfg_508001">Figure 1</a>, CE1 and CE2 belong to the same VPLS network and access the MPLS backbone network through PE1 and PE2, respectively. OSPF is used as the IGP on the MPLS backbone network.</p>
<p id="EN-US_TASK_0172370251__p137306628214054">LDP VPLS needs to be configured, and an SR-MPLS TE tunnel needs to be established between PE1 and PE2 to carry the VPLS service.</p>
<div class="fignone" id="EN-US_TASK_0172370251__fig_dc_vrp_vpls_cfg_508001"><a name="EN-US_TASK_0172370251__fig_dc_vrp_vpls_cfg_508001"></a><a name="fig_dc_vrp_vpls_cfg_508001"></a><span class="figcap"><b>Figure 1 </b>Configuring LDP VPLS to recurse to an SR-MPLS TE tunnel</span><div class="note" id="EN-US_TASK_0172370251__note765694500214054"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172370251__p1305448676214054">In this example, interface1, interface2, subinterface1.1, and subinterface2.1 represent GE<span>0/1/0</span>, GE<span>0/2/0</span>, GE<span>0/1/0</span>.1, and GE<span>0/2/0</span>.1, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0172370251__image142446876214054" src="images/fig_dc_vrp_vpls_cfg_508001.png" width="NaN" height="NaN"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172370251__1.4.2"></a><a name="1.4.2"></a>
<div class="p" id="EN-US_TASK_0172370251__context1910086998214054"><h4 class="sectiontitle">Configuration Precautions</h4><p id="EN-US_TASK_0172370251__p1168947907214054">During the configuration, note the following:</p>
<ul id="EN-US_TASK_0172370251__ul303576009214054"><li id="EN-US_TASK_0172370251__li1626052989214054">PEs belonging to the same VPLS network must have the same VSI ID.</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172370251__1.4.3"></a><a name="1.4.3"></a>
<div class="p" id="EN-US_TASK_0172370251__context1974329963214054"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0172370251__p1743591430214054">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0172370251__ol273976550214054"><li id="EN-US_TASK_0172370251__li837723907214054"><p id="EN-US_TASK_0172370251__p722915217214054"><a name="EN-US_TASK_0172370251__li837723907214054"></a><a name="li837723907214054"></a>Configure a routing protocol on the PEs and P of the backbone network for connectivity between these devices and enable MPLS on them.</p>
</li><li id="EN-US_TASK_0172370251__li989941346214054"><p id="EN-US_TASK_0172370251__p1388388913214054"><a name="EN-US_TASK_0172370251__li989941346214054"></a><a name="li989941346214054"></a>Set up an SR-MPLS TE tunnel and configure the related tunnel policy. For details about how to establish an SR-MPLS TE tunnel, see the <em id="EN-US_TASK_0172370251__i98618129420"><span class="keyword" id="EN-US_TASK_0172370251__keyword1500049255214054">NE40E</span> Configuration Guide - Segment Routing</em>.</p>
</li><li id="EN-US_TASK_0172370251__li1358701215214054"><p id="EN-US_TASK_0172370251__p1497701954214054"><a name="EN-US_TASK_0172370251__li1358701215214054"></a><a name="li1358701215214054"></a>Enable MPLS L2VPN on PEs.</p>
</li><li id="EN-US_TASK_0172370251__li1082977793214054"><p id="EN-US_TASK_0172370251__p1683858626214054"><a name="EN-US_TASK_0172370251__li1082977793214054"></a><a name="li1082977793214054"></a>Create VSIs, set the signaling protocol to LDP, and bind AC interfaces to VSIs on PEs.</p>
</li><li id="EN-US_TASK_0172370251__li1352089965214054"><p id="EN-US_TASK_0172370251__p2051572848214054"><a name="EN-US_TASK_0172370251__li1352089965214054"></a><a name="li1352089965214054"></a>Configure the VSI to use an SR-MPLS TE tunnel.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172370251__1.4.4"></a><a name="1.4.4"></a>
<div class="p" id="EN-US_TASK_0172370251__context828427405214054"><h4 class="sectiontitle">Data Preparation</h4><p id="EN-US_TASK_0172370251__p580293633214054">To complete the configuration, you need the following data:</p>
<ul id="EN-US_TASK_0172370251__ul2058110237214054"><li id="EN-US_TASK_0172370251__li708213617214054"><p id="EN-US_TASK_0172370251__p1591889245214054"><a name="EN-US_TASK_0172370251__li708213617214054"></a><a name="li708213617214054"></a>OSPF area where SR-MPLS TE is enabled</p>
</li><li id="EN-US_TASK_0172370251__li1861939590214054"><p id="EN-US_TASK_0172370251__p486985046214054"><a name="EN-US_TASK_0172370251__li1861939590214054"></a><a name="li1861939590214054"></a>VSI names and IDs</p>
</li><li id="EN-US_TASK_0172370251__li1260558034214054"><p id="EN-US_TASK_0172370251__p1272699783214054"><a name="EN-US_TASK_0172370251__li1260558034214054"></a><a name="li1260558034214054"></a>Peer IP addresses and tunnel policies</p>
</li><li id="EN-US_TASK_0172370251__li1269729496214054"><p id="EN-US_TASK_0172370251__p798639033214054"><a name="EN-US_TASK_0172370251__li1269729496214054"></a><a name="li1269729496214054"></a>Interfaces bound to VSIs</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172370251__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0172370251__steps1813906355214054"><li id="EN-US_TASK_0172370251__step1794293232214054"><span id="EN-US_TASK_0172370251__cmd1720979050214054">Configure IP addresses for involved interfaces on the backbone network.</span><p><p id="EN-US_TASK_0172370251__en-us_task_0172369488_p1188131509214048"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen1539879811214048">&lt;<span class="keyword" id="EN-US_TASK_0172370251__keyword433506030214049">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b1832325966214048">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen1556776246214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1741820347214"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172370251__keyword187901754214049">HUAWEI</span>] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b1826021567214048">sysname PE1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen53468997214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1875312509589">*</span><span class="keyword" id="EN-US_TASK_0172370251__keyword17709134694214">HUAWEI</span>] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b1758551947214048">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen951847452214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword85226361627"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b925133943214048">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen1285024223214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword2574629712">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b867106471214048">ip address 1.1.1.9 32</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen601223530214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword73250317113">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b751580343214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen1725882633214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword92943338110">*</span>PE1]<strong id="EN-US_TASK_0172370251__b51957195217"> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen216319910214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword7310353112">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b1031148063214048">ip address 10.10.1.1 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen977384742214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword869517361712">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b1799184375214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen320501124214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1970112387118">*</span>PE1] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b1727035938214048">commit</strong></pre>
<p id="EN-US_TASK_0172370251__en-us_task_0172369488_p704972473214048"># Configure the P.</p>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen1718497984214048">&lt;<span class="keyword" id="EN-US_TASK_0172370251__keyword18160154913423">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b932141439214048">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen263384830214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword170514392212"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172370251__keyword197041052154212">HUAWEI</span>] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b548411124214048">sysname P</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen524131334214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword294818411211">*</span><span class="keyword" id="EN-US_TASK_0172370251__keyword759365454219">HUAWEI</span>] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b1838965326214048">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen974993317214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword147471244928"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b1001868575214048">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen785218503214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1958134414115">*</span>P-LoopBack1] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b2125328831214048">ip address 2.2.2.9 32</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen1088003628214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1239615462115">*</span>P-LoopBack1] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b1106794695214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen233840133214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword23217481812">*</span>P]<strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b1824173385214048"> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen671151759214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword19960655012">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b114475027214048">ip address 10.10.1.2 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen1823662946214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword17522257014">*</span>P-GigabitEthernet<span>0/1/0</span>] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b1702628474214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen1072742025214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword8199102218">*</span>P]<strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b614348113214048"> interface gigabitethernet<span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen1853870408214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword9828191225">*</span>P-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b200585444214048">ip address 10.20.1.1 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen1368967001214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1736614311214">*</span>P-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b1393643972214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen1150915313214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword59351148220">*</span>P] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b301008334214048">commit</strong></pre>
<p id="EN-US_TASK_0172370251__en-us_task_0172369488_p1002916576214048"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen212939508214048">&lt;<span class="keyword" id="EN-US_TASK_0172370251__keyword1923915994218">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b887053569214048">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen925053273214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword109049026"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172370251__keyword14787170134317">HUAWEI</span>] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b1536084718214048">sysname PE2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen442895440214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword355789213">*</span><span class="keyword" id="EN-US_TASK_0172370251__keyword101217315437">HUAWEI</span>] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b67102740214048">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen2143072645214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword251805115213"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b753305913214048">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen1269567466214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword214116109218">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b1646302233214048">ip address 3.3.3.9 32</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen738681779214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword27051111326">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b832790317214048">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen2107838496214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword146196134212">*</span>PE2]<strong id="EN-US_TASK_0172370251__b16867627132111"> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen185627733214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword4683161516210">*</span>PE2-GigabitEthernet<span>0/1/0</span>]<strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b810907017214048"> ip address 10.20.1.2 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen871777228214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword57616174216">*</span>PE2-GigabitEthernet<span>0/1/0</span>]<strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b1078548112214048"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__en-us_task_0172369488_screen125558937214048">[<span class="keyword" id="EN-US_TASK_0172370251__keyword36426221829">*</span>PE2]<strong id="EN-US_TASK_0172370251__en-us_task_0172369488_b41270465214048"> commit</strong></pre>
</p></li><li id="EN-US_TASK_0172370251__step1105006015214054"><span id="EN-US_TASK_0172370251__cmd397514849214054">Enable MPLS and MPLS TE.</span><p><p id="EN-US_TASK_0172370251__p2008713303214054">Enable MPLS and MPLS TE in the system view of each node along the tunnel.</p>
<p id="EN-US_TASK_0172370251__p1912062959214054"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen896225587214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword840290606214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370251__b1526261245214054">mpls lsr-id 1.1.1.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen635515889214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword792202323214054">*</span>PE1] <strong id="EN-US_TASK_0172370251__b707162400214054">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen2048727281214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword110172384214054">*</span>PE1-mpls]<strong id="EN-US_TASK_0172370251__b1515735959214054"> mpls te</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen979082706214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1195001463214054">*</span>PE1-mpls]<strong id="EN-US_TASK_0172370251__b581683984214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1403734688214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword2146104027214054">*</span>PE1] <strong id="EN-US_TASK_0172370251__b1796846651214054">commit</strong></pre>
<p id="EN-US_TASK_0172370251__p225476701214054"># Configure the P.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1132492767214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1415866312214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>P] <strong id="EN-US_TASK_0172370251__b2119356154214054">mpls lsr-id 2.2.2.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1685275606214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1341906919214054">*</span>P] <strong id="EN-US_TASK_0172370251__b41384035214054">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen919851807214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword241107959214054">*</span>P-mpls]<strong id="EN-US_TASK_0172370251__b1354145662214054"> mpls te</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen436247563214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1116404954214054">*</span>P-mpls]<strong id="EN-US_TASK_0172370251__b689843160214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen927911219214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword731194848214054">*</span>P] <strong id="EN-US_TASK_0172370251__b16317961214054">commit</strong></pre>
<p id="EN-US_TASK_0172370251__p1067184373214054"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen2073119940214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword994485743214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370251__b2091935269214054">mpls lsr-id 3.3.3.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen478758895214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword219400613214054">*</span>PE2] <strong id="EN-US_TASK_0172370251__b754356900214054">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen207308714214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1508315723214054">*</span>PE2-mpls]<strong id="EN-US_TASK_0172370251__b53645469214054"> mpls te</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen721904099214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword931890455214054">*</span>PE2-mpls]<strong id="EN-US_TASK_0172370251__b520611872214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen266187430214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1661537935214054">*</span>PE2] <strong id="EN-US_TASK_0172370251__b1902378287214054">commit</strong></pre>
</p></li><li id="EN-US_TASK_0172370251__step646082202214054"><span id="EN-US_TASK_0172370251__cmd1026249782214054">Configure OSPF TE on the backbone network.</span><p><p id="EN-US_TASK_0172370251__p1934262297214054"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen507021105214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1489503347214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370251__b1495127578214054">ospf 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1292719144214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1915742704214054">*</span>PE1-ospf-1] <strong id="EN-US_TASK_0172370251__b2009117917214054">opaque-capability enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1977801211214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1464187927214054">*</span>PE1-ospf-1]<strong id="EN-US_TASK_0172370251__b737677296214054"> area 0.0.0.0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1888221671214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword273446285214054">*</span>PE1-ospf-1-area-0.0.0.0]<strong id="EN-US_TASK_0172370251__b1084191172214054"> network 1.1.1.9 0.0.0.0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1480103952214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword146112848214054">*</span>PE1-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172370251__b1815093232214054">network 10.10.1.0 0.0.0.255</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen23430965214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword666063406214054">*</span>PE1-ospf-1-area-0.0.0.0]<strong id="EN-US_TASK_0172370251__b404465065214054"> mpls-te enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen67177505214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword903395885214054">*</span>PE1-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172370251__b1139322053214054">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1791755603214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1957957651214054">*</span>PE1-ospf-1]<strong id="EN-US_TASK_0172370251__b1482900653214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen2000760860214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword274489414214054">*</span>PE1] <strong id="EN-US_TASK_0172370251__b829516776214054">commit</strong></pre>
<p id="EN-US_TASK_0172370251__p2024411977214054"># Configure the P.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1600120842214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword683889326214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>P]<strong id="EN-US_TASK_0172370251__b594339191214054"> ospf 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1269031445214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword771861722214054">*</span>P-ospf-1] <strong id="EN-US_TASK_0172370251__b1426477777214054">opaque-capability enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1335650516214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1303347926214054">*</span>P-ospf-1]<strong id="EN-US_TASK_0172370251__b788176133214054"> area 0.0.0.0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen433907702214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword814678225214054">*</span>P-ospf-1-area-0.0.0.0]<strong id="EN-US_TASK_0172370251__b1642611788214054"> network 2.2.2.9 0.0.0.0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen797600125214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword569540393214054">*</span>P-ospf-1-area-0.0.0.0]<strong id="EN-US_TASK_0172370251__b1188438156214054"> network 10.10.1.0 0.0.0.255</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen827174522214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword69279549214054">*</span>P-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172370251__b1372276635214054">network 10.20.1.0 0.0.0.255</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen619435364214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1456460057214054">*</span>P-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172370251__b894748695214054">mpls-te enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen610496247214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword180581214054">*</span>P-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172370251__b483872478214054">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1072609817214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1865790299214054">*</span>P-ospf-1]<strong id="EN-US_TASK_0172370251__b149114388214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1670402740214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1563119853214054">*</span>P]<strong id="EN-US_TASK_0172370251__b142359181214054"> commit</strong></pre>
<p id="EN-US_TASK_0172370251__p1697827752214054"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen313885219214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword940798282214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong id="EN-US_TASK_0172370251__b221557543214054"> ospf 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen327822924214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword699189082214054">*</span>PE2-ospf-1] <strong id="EN-US_TASK_0172370251__b730425523214054">opaque-capability enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1500522848214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1039821120214054">*</span>PE2-ospf-1] <strong id="EN-US_TASK_0172370251__b406625690214054">area 0.0.0.0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1857119789214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword777310898214054">*</span>PE2-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172370251__b477811470214054">network 3.3.3.9 0.0.0.0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1961156869214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1610692689214054">*</span>PE2-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172370251__b1480536970214054">network 10.20.1.0 0.0.0.255</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen639918504214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1305764288214054">*</span>PE2-ospf-1-area-0.0.0.0]<strong id="EN-US_TASK_0172370251__b600986850214054"> mpls-te enable</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen2044681090214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword78937694214054">*</span>PE2-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172370251__b1438560823214054">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1646761051214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword534413717214054">*</span>PE2-ospf-1]<strong id="EN-US_TASK_0172370251__b617504627214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1726041899214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1367711600214054">*</span>PE2]<strong id="EN-US_TASK_0172370251__b1464048974214054"> commit</strong></pre>
</p></li><li id="EN-US_TASK_0172370251__step144934907214054"><span id="EN-US_TASK_0172370251__cmd674526251214054">Configure SR on the backbone network.</span><p><p id="EN-US_TASK_0172370251__p14988720214054"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen162988079214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword870511794214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong id="EN-US_TASK_0172370251__b2008540541214054"> segment-routing</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen341489649214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword221719530214054">*</span>PE1-segment-routing]<strong id="EN-US_TASK_0172370251__b1211916058214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1469963663214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1893751191214054">*</span>PE1] <strong id="EN-US_TASK_0172370251__b2056487785214054">ospf 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1250563927214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1909568259214054">*</span>PE1-ospf-1] <strong id="EN-US_TASK_0172370251__b208857396214054">segment-routing mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1948157171214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword490889184214054">*</span>PE1-ospf-1] <strong id="EN-US_TASK_0172370251__b1045317197214054">segment-routing global-block 16000 47999</strong></pre>
<div class="note" id="EN-US_TASK_0172370251__note5675122403810"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172370251__en-us_task_0172368860_p969181111187">The SRGB range varies according to the device. The range specified in this example is for reference only.</p>
</div></div>
<pre class="screen" id="EN-US_TASK_0172370251__screen2994389214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword656915736214054">*</span>PE1-ospf-1] <strong id="EN-US_TASK_0172370251__b1953952690214054">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1218142101117">[<span class="keyword" id="EN-US_TASK_0172370251__keyword18311747191916">*</span>PE1] <strong id="EN-US_TASK_0172370251__b218174214113">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen15181942141114">[<span class="keyword" id="EN-US_TASK_0172370251__keyword111844241120">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172370251__b4622154181119">ospf prefix-sid absolute 16100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen218942121114">[<span class="keyword" id="EN-US_TASK_0172370251__keyword4181342121114">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172370251__b1318194215110">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen22060791214">[<span class="keyword" id="EN-US_TASK_0172370251__keyword202076731217">*</span>PE1] <strong id="EN-US_TASK_0172370251__b620711715125">commit</strong></pre>
<p id="EN-US_TASK_0172370251__p2102364552214054"># Configure the P.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen87356647214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword270547203214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>P]<strong id="EN-US_TASK_0172370251__b1440833087214054"> segment-routing</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen746186604214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword928186851214054">*</span>P-segment-routing]<strong id="EN-US_TASK_0172370251__b781921584214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1418973371214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1407444533214054">*</span>P] <strong id="EN-US_TASK_0172370251__b1728749137214054">ospf 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1579232574214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1605456853214054">*</span>P-ospf-1] <strong id="EN-US_TASK_0172370251__b865239176214054">segment-routing mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen914518215214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword467585694214054">*</span>P-ospf-1] <strong id="EN-US_TASK_0172370251__b2053310817214054">segment-routing global-block 16000 47999</strong></pre>
<div class="note" id="EN-US_TASK_0172370251__note776234015518"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172370251__en-us_task_0172368860_p969181111187_1">The SRGB range varies according to the device. The range specified in this example is for reference only.</p>
</div></div>
<pre class="screen" id="EN-US_TASK_0172370251__screen512427372214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword208081367214054">*</span>P-ospf-1] <strong id="EN-US_TASK_0172370251__b1651385769214054">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen19773105351214">[<span class="keyword" id="EN-US_TASK_0172370251__keyword181516537197">*</span>P] <strong id="EN-US_TASK_0172370251__b207738530125">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen9773185310125">[<span class="keyword" id="EN-US_TASK_0172370251__keyword13773753121214">*</span>P-LoopBack1] <strong id="EN-US_TASK_0172370251__b77736534125">ospf prefix-sid absolute 16300</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen12773053191210">[<span class="keyword" id="EN-US_TASK_0172370251__keyword137732532128">*</span>P-LoopBack1] <strong id="EN-US_TASK_0172370251__b12773115331212">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen2077385311215">[<span class="keyword" id="EN-US_TASK_0172370251__keyword7773155319127">*</span>P] <strong id="EN-US_TASK_0172370251__b9773105310129">commit</strong></pre>
<p id="EN-US_TASK_0172370251__p913457224214054"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1735932902214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword631419820214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong id="EN-US_TASK_0172370251__b1100705978214054"> segment-routing</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1593605959214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword40006050214054">*</span>PE2-segment-routing]<strong id="EN-US_TASK_0172370251__b707262821214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen236730240214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword335438876214054">*</span>PE2] <strong id="EN-US_TASK_0172370251__b1731451235214054">ospf 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1566919060214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword755418591214054">*</span>PE2-ospf-1] <strong id="EN-US_TASK_0172370251__b1250623929214054">segment-routing mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen901032986214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword48259272214054">*</span>PE2-ospf-1] <strong id="EN-US_TASK_0172370251__b1924745429214054">segment-routing global-block 16000 47999</strong></pre>
<div class="note" id="EN-US_TASK_0172370251__note19891445175110"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172370251__en-us_task_0172368860_p969181111187_2">The SRGB range varies according to the device. The range specified in this example is for reference only.</p>
</div></div>
<pre class="screen" id="EN-US_TASK_0172370251__screen1007877689214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1996957914214054">*</span>PE2-ospf-1] <strong id="EN-US_TASK_0172370251__b48428317214054">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen833963671210">[<span class="keyword" id="EN-US_TASK_0172370251__keyword9382110132015">*</span>PE2] <strong id="EN-US_TASK_0172370251__b533943691219">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen633919362121">[<span class="keyword" id="EN-US_TASK_0172370251__keyword53390363123">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172370251__b9339436191210">ospf prefix-sid absolute 16200</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen193391336161212">[<span class="keyword" id="EN-US_TASK_0172370251__keyword33399369129">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172370251__b1339133616127">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1233910369128">[<span class="keyword" id="EN-US_TASK_0172370251__keyword3339036141214">*</span>PE2] <strong id="EN-US_TASK_0172370251__b19339173611214">commit</strong></pre>
</p></li><li id="EN-US_TASK_0172370251__step2106425095214054"><span id="EN-US_TASK_0172370251__cmd1418650870214054">Configure an explicit path.</span><p><p id="EN-US_TASK_0172370251__p1457746484214054"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen384050560214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword424223273214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong id="EN-US_TASK_0172370251__b19917000214054"> explicit-path path2pe2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen271543814214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1454961702214054">*</span>PE1-explicit-path-path2pe2]<strong id="EN-US_TASK_0172370251__b245020530214054"> next sid label 16300 type prefix</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1215188644214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword877147134214054">*</span>PE1-explicit-path-path2pe2]<strong id="EN-US_TASK_0172370251__b1895105895214054"> next sid label 16200 type prefix</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1557731916214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1612022414214054">*</span>PE1-explicit-path-path2pe2] <strong id="EN-US_TASK_0172370251__b1663800372214054">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen611555712245">[<span class="keyword" id="EN-US_TASK_0172370251__keyword7754175713249">*</span>PE1] <strong id="EN-US_TASK_0172370251__b87548579246">commit</strong></pre>
<p id="EN-US_TASK_0172370251__p1813887488214054"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen240698556214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1429137559214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong id="EN-US_TASK_0172370251__b994679520214054"> explicit-path path2pe1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen2087582359214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword149364389214054">*</span>PE2-explicit-path-path2pe1]<strong id="EN-US_TASK_0172370251__b765396394214054"> next sid label 16300 type prefix</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1545147550214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword175733673214054">*</span>PE2-explicit-path-path2pe1]<strong id="EN-US_TASK_0172370251__b1393060731214054"> next sid label 16100 type prefix</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen654643850214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword108505262214054">*</span>PE2-explicit-path-path2pe1]<strong id="EN-US_TASK_0172370251__b355139564214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen11802114542413">[<span class="keyword" id="EN-US_TASK_0172370251__keyword14461546152411">*</span>PE2] <strong id="EN-US_TASK_0172370251__b19446194611244">commit</strong></pre>
</p></li><li id="EN-US_TASK_0172370251__step1889433983214054"><span id="EN-US_TASK_0172370251__cmd876264092214054">Configure a tunnel interface on each device.</span><p><p id="EN-US_TASK_0172370251__p849504809214054"># Create tunnel interfaces on PEs and specify MPLS TE as the tunnel protocol and SR as the signaling protocol.</p>
<p id="EN-US_TASK_0172370251__p1273120440214054"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1540721998214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1633032041214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong id="EN-US_TASK_0172370251__b1374519175214054"> interface Tunnel 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen85619411214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword2029502350214054">*</span>PE1-Tunnel10]<strong id="EN-US_TASK_0172370251__b322891400214054"> ip address unnumbered interface loopback1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1216442860214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword444415799214054">*</span>PE1-Tunnel10]<strong id="EN-US_TASK_0172370251__b464582214214054"> tunnel-protocol mpls te</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1804348234214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1589971441214054">*</span>PE1-Tunnel10]<strong id="EN-US_TASK_0172370251__b1202467887214054"> destination 3.3.3.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen363282861214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword13446061214054">*</span>PE1-Tunnel10]<strong id="EN-US_TASK_0172370251__b264522934214054"> mpls te signal-protocol segment-routing</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1399087199214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1236688306214054">*</span>PE1-Tunnel10]<strong id="EN-US_TASK_0172370251__b845591326214054"> mpls te tunnel-id 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1492688010214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword479370777214054">*</span>PE1-Tunnel10]<strong id="EN-US_TASK_0172370251__b1518380436214054"> mpls te path explicit-path path2pe2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen3431521163818">[<span class="keyword" id="EN-US_TASK_0172370251__keyword112344273388">*</span>PE1-Tunnel10]<strong id="EN-US_TASK_0172370251__b7234112710388"> </strong><strong id="EN-US_TASK_0172370251__b142812554382">mpls te reserved-for-binding</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen239007176214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword604268499214054">*</span>PE1-Tunnel10]<strong id="EN-US_TASK_0172370251__b1724539024214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1682627920214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1857007442214054">*</span>PE1]<strong id="EN-US_TASK_0172370251__b1043846861214054"> commit</strong></pre>
<p id="EN-US_TASK_0172370251__p550028760214054"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1085614038214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword720891419214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370251__b1603415417214054">interface Tunnel 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen916615934214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1149209662214054">*</span>PE2-Tunnel10]<strong id="EN-US_TASK_0172370251__b112175279214054"> ip address unnumbered interface loopback1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen180394135214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1099296300214054">*</span>PE2-Tunnel10]<strong id="EN-US_TASK_0172370251__b1752274759214054"> tunnel-protocol mpls te</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen38568129214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword819222719214054">*</span>PE2-Tunnel10]<strong id="EN-US_TASK_0172370251__b974722663214054"> destination 1.1.1.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen309316726214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword2091060235214054">*</span>PE2-Tunnel10]<strong id="EN-US_TASK_0172370251__b399495129214054"> mpls te signal-protocol segment-routing</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1380034986214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1328487911214054">*</span>PE2-Tunnel10]<strong id="EN-US_TASK_0172370251__b832956272214054"> mpls te tunnel-id 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1371936153214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword84319888214054">*</span>PE2-Tunnel10]<strong id="EN-US_TASK_0172370251__b1211179715214054"> mpls te path explicit-path path2pe1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen11577114903916">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1151845543913">*</span>PE2-Tunnel10]<strong id="EN-US_TASK_0172370251__b95181555173919"> </strong><strong id="EN-US_TASK_0172370251__b551845513394">mpls te reserved-for-binding</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1621286735214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword145504278214054">*</span>PE2-Tunnel10]<strong id="EN-US_TASK_0172370251__b1918751652214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen644516192214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword683192410214054">*</span>PE2] <strong id="EN-US_TASK_0172370251__b1047111244214054">commit</strong></pre>
<p id="EN-US_TASK_0172370251__p2095083444214054">Run the <strong id="EN-US_TASK_0172370251__b427622182214054">display tunnel-info all</strong> command in the system view. The command output shows that the TE tunnel whose destination address is the MPLS LSR ID of the peer PE exists. The following example uses the command output on PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1095308479214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1421882533214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370251__b837996616214054">display tunnel-info all</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen730355397214054">Tunnel ID                     Type                Destination         Status
-----------------------------------------------------------------------------
0x000000000300000001          sr-te               3.3.3.9             UP</pre>
</p></li><li id="EN-US_TASK_0172370251__step405354941214054"><span id="EN-US_TASK_0172370251__cmd982365103214054">Configure remote LDP sessions.</span><p><p id="EN-US_TASK_0172370251__p188855826214054">Set up a remote peer session between PE1 and PE2.</p>
<p id="EN-US_TASK_0172370251__p1352894655214054"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1093953905214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword2135198773214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370251__b1817678496214054">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1974046528214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword2114878161214054">*</span>PE1-mpls-ldp]<strong id="EN-US_TASK_0172370251__b1052754524214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1169673829214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword677763145214054">*</span>PE1]<strong id="EN-US_TASK_0172370251__b2100788897214054"> mpls ldp remote-peer 3.3.3.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1862087125214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1615696938214054">*</span>PE1-mpls-ldp-remote-3.3.3.9]<strong id="EN-US_TASK_0172370251__b1147199515214054"> remote-ip 3.3.3.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1636410593214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1926866294214054">*</span>PE1-mpls-ldp-remote-3.3.3.9]<strong id="EN-US_TASK_0172370251__b773909896214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen2022817539214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1926857443214054">*</span>PE1]<strong id="EN-US_TASK_0172370251__b256446105214054"> commit</strong></pre>
<p id="EN-US_TASK_0172370251__p922623754214054"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1910196857214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1047559750214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370251__b993873026214054">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1149323701214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1052390990214054">*</span>PE2-mpls-ldp]<strong id="EN-US_TASK_0172370251__b185536109214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen855878318214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1867051202214054">*</span>PE2]<strong id="EN-US_TASK_0172370251__b990247403214054"> mpls ldp remote-peer 1.1.1.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen225774756214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword48969180214054">*</span>PE2-mpls-ldp-remote-1.1.1.9]<strong id="EN-US_TASK_0172370251__b1340855661214054"> remote-ip 1.1.1.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1862261600214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1735067563214054">*</span>PE2-mpls-ldp-remote-1.1.1.9]<strong id="EN-US_TASK_0172370251__b1108045184214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1430326452214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1758236429214054">*</span>PE2]<strong id="EN-US_TASK_0172370251__b1940034911214054"> commit</strong></pre>
</p></li><li id="EN-US_TASK_0172370251__step1860251689214054"><span id="EN-US_TASK_0172370251__cmd35720350214054">Configure a tunnel policy.</span><p><p id="EN-US_TASK_0172370251__p515077779214054"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1656471394214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword621024905214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370251__b827897771214054">tunnel-policy policy1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1301369852214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1907565931214054">*</span>PE1-tunnel-policy-policy1]<strong id="EN-US_TASK_0172370251__b646391878214054"> tunnel binding destination 3.3.3.9 te Tunnel10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1945249443214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword255434884214054">*</span>PE1-tunnel-policy-policy1]<strong id="EN-US_TASK_0172370251__b1408676783214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen524954451214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword774060790214054">*</span>PE1]<strong id="EN-US_TASK_0172370251__b440130842214054"> commit</strong></pre>
<p id="EN-US_TASK_0172370251__p966946119214054"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1603910040214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword90660947214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172370251__b943485823214054">tunnel-policy policy1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen648228341214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword401266175214054">*</span>PE2-tunnel-policy-policy1]<strong id="EN-US_TASK_0172370251__b249470320214054"> tunnel binding destination 1.1.1.9 te Tunnel10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen215108902214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword384367595214054">*</span>PE2-tunnel-policy-policy1]<strong id="EN-US_TASK_0172370251__b601742794214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen330388054214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1829838535214054">*</span>PE2]<strong id="EN-US_TASK_0172370251__b1187626504214054"> commit</strong></pre>
</p></li><li id="EN-US_TASK_0172370251__step1579226988214054"><span id="EN-US_TASK_0172370251__cmd1317594043214054">Enable MPLS L2VPN on PEs.</span><p><p id="EN-US_TASK_0172370251__p1381907687214054"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1215516303214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword2037057172214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong id="EN-US_TASK_0172370251__b1559187710214054"> mpls l2vpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen34861530132515">[<span class="keyword" id="EN-US_TASK_0172370251__keyword01253313252">*</span>PE1-l2vpn]<strong id="EN-US_TASK_0172370251__b16126531162512"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1446133796214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1900352924214054">*</span>PE1]<strong id="EN-US_TASK_0172370251__b675079736214054"> commit</strong></pre>
<p id="EN-US_TASK_0172370251__p630742999214054"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen2094327665214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1505691069214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong id="EN-US_TASK_0172370251__b1810714197214054"> mpls l2vpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen19499105632514">[<span class="keyword" id="EN-US_TASK_0172370251__keyword93715579252">*</span>PE2-l2vpn]<strong id="EN-US_TASK_0172370251__b1937105716251"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen929451073214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword708052291214054">*</span>PE2]<strong id="EN-US_TASK_0172370251__b532235555214054"> commit</strong></pre>
</p></li><li id="EN-US_TASK_0172370251__step1106169361214054"><span id="EN-US_TASK_0172370251__cmd622518248214054">Create a VSI on each PE and configure a tunnel policy for the VSI.</span><p><p id="EN-US_TASK_0172370251__p1223968012214054"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen121264873214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword373408666214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong id="EN-US_TASK_0172370251__b2145616031214054"> vsi a2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1980536577214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1450018873214054">*</span>PE1-vsi-a2]<strong id="EN-US_TASK_0172370251__b687767452214054"> pwsignal ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen843834925214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1272286512214054">*</span>PE1-vsi-a2-ldp]<strong id="EN-US_TASK_0172370251__b1444964297214054"> vsi-id 2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1230991624214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword952890371214054">*</span>PE1-vsi-a2-ldp]<strong id="EN-US_TASK_0172370251__b1598288502214054"> peer 3.3.3.9 tnl-policy policy1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen789703900214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword631429212214054">*</span>PE1-vsi-a2-ldp]<strong id="EN-US_TASK_0172370251__b1965940541214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen880415157245">[<span class="keyword" id="EN-US_TASK_0172370251__keyword635713167244">*</span>PE1-vsi-a2]<strong id="EN-US_TASK_0172370251__b18357216102412"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen824890619214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1037894442214054">*</span>PE1]<strong id="EN-US_TASK_0172370251__b486975725214054"> commit</strong></pre>
<p id="EN-US_TASK_0172370251__p1601839802214054"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1105454490214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1089916424214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong id="EN-US_TASK_0172370251__b1447123411214054"> vsi a2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1402594775214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword783105517214054">*</span>PE2-vsi-a2]<strong id="EN-US_TASK_0172370251__b1264633084214054"> pwsignal ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1464650330214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1742379162214054">*</span>PE2-vsi-a2-ldp]<strong id="EN-US_TASK_0172370251__b163688791214054"> vsi-id 2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1099445092214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1259584883214054">*</span>PE2-vsi-a2-ldp]<strong id="EN-US_TASK_0172370251__b1048807044214054"> peer 1.1.1.9 tnl-policy policy1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1625070530214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword199378569214054">*</span>PE2-vsi-a2-ldp]<strong id="EN-US_TASK_0172370251__b2081791376214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1352023142418">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1269515234245">*</span>PE2-vsi-a2]<strong id="EN-US_TASK_0172370251__b769552315249"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen2092848520214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword514320225214054">*</span>PE2]<strong id="EN-US_TASK_0172370251__b1704663057214054"> commit</strong></pre>
</p></li><li id="EN-US_TASK_0172370251__step2100411561214054"><span id="EN-US_TASK_0172370251__cmd1280916341214054">Bind interfaces to VSIs on PEs.</span><p><p id="EN-US_TASK_0172370251__p1680517522214054"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1674424599214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword354266275214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong id="EN-US_TASK_0172370251__b487948381214054"> interface gigabitethernet<span>0/2/0</span>.1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen681790615214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1017625972214054">*</span>PE1-GigabitEthernet<span>0/2/0</span>.1]<strong id="EN-US_TASK_0172370251__b658264534214054"> vlan-type dot1q 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1751169946214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword772294967214054">*</span>PE1-GigabitEthernet<span>0/2/0</span>.1]<strong id="EN-US_TASK_0172370251__b1070232650214054"> l2 binding vsi a2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1244680205214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword238977838214054">*</span>PE1-GigabitEthernet<span>0/2/0</span>.1]<strong id="EN-US_TASK_0172370251__b1987454652214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen2059278312214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword712262330214054">*</span>PE1]<strong id="EN-US_TASK_0172370251__b1000508253214054"> commit</strong></pre>
<p id="EN-US_TASK_0172370251__p1328440623214054"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen491665900214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword2129056432214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong id="EN-US_TASK_0172370251__b1926854237214054"> interface gigabitethernet<span>0/2/0</span>.1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen2141700943214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1946379019214054">*</span>PE2-GigabitEthernet<span>0/2/0</span>.1]<strong id="EN-US_TASK_0172370251__b1798268031214054"> vlan-type dot1q 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen614838966214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1399883155214054">*</span>PE2-GigabitEthernet<span>0/2/0</span>.1]<strong id="EN-US_TASK_0172370251__b1542246319214054"> l2 binding vsi a2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1230937588214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1434098283214054">*</span>PE2-GigabitEthernet<span>0/2/0</span>.1]<strong id="EN-US_TASK_0172370251__b1479921412214054"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen344008505214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1825656046214054">*</span>PE2]<strong id="EN-US_TASK_0172370251__b431727028214054"> commit</strong></pre>
<p id="EN-US_TASK_0172370251__p740329526214054"># Configure CE1.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen745431698214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1646528710214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1]<strong id="EN-US_TASK_0172370251__b1347805422214054"> interface gigabitethernet<span>0/1/0</span>.1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1304467978214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1137540218214054">*</span>CE1-GigabitEthernet<span>0/1/0</span>.1] <strong id="EN-US_TASK_0172370251__b115812207214054">vlan-type dot1q 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1178449936214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword40578458214054">*</span>CE1-GigabitEthernet<span>0/1/0</span>.1]<strong id="EN-US_TASK_0172370251__b246853559214054"> ip address 10.1.1.1 255.255.255.0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen313808754214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword861405023214054">*</span>CE1-GigabitEthernet<span>0/1/0</span>.1] <strong id="EN-US_TASK_0172370251__b941611165214054">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen2007918582214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword102741575214054">*</span>CE1]<strong id="EN-US_TASK_0172370251__b1129244022214054"> commit</strong></pre>
<p id="EN-US_TASK_0172370251__p1992377258214054"># Configure CE2.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1426071883214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword478846240214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2]<strong id="EN-US_TASK_0172370251__b580404135214054"> interface gigabitethernet<span>0/1/0</span>.1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen186112679214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword302922121214054">*</span>CE2-GigabitEthernet<span>0/1/0</span>.1] <strong id="EN-US_TASK_0172370251__b1630328928214054">vlan-type dot1q 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen289780005214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1945224305214054">*</span>CE2-GigabitEthernet<span>0/1/0</span>.1]<strong id="EN-US_TASK_0172370251__b233968242214054"> ip address 10.1.1.2 255.255.255.0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen103992003214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword127125681214054">*</span>CE2-GigabitEthernet<span>0/1/0</span>.1] <strong id="EN-US_TASK_0172370251__b776333228214054">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1445609487214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword942223985214054">*</span>CE2]<strong id="EN-US_TASK_0172370251__b1980709739214054"> commit</strong></pre>
</p></li><li id="EN-US_TASK_0172370251__step202745661214054"><span id="EN-US_TASK_0172370251__cmd1637260285214054">Verify the configuration.</span><p><p id="EN-US_TASK_0172370251__p1521007215214054">After the configuration is complete, run the <strong id="EN-US_TASK_0172370251__b501509728115354">display vsi name a2 verbose</strong> command on PE1. The command output shows that a VSI named <strong id="EN-US_TASK_0172370251__b1793250705115354">a2</strong> has established a PW to PE2 and <strong id="EN-US_TASK_0172370251__b1596314816207">VSI State</strong> is <strong id="EN-US_TASK_0172370251__b492622563115354">up</strong>.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen419950686214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword785217366214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370251__b1149425649214054">display vsi name a2 verbose</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen5197121254614"> ***VSI Name               : a2
    Work Mode              : normal
    Administrator VSI      : no
    Isolate Spoken         : disable
    VSI Index              : 1
    PW Signaling           : ldp
    Member Discovery Style : --
<span>    Bridge-domain Mode     : disable</span>
    PW MAC Learn Style     : unqualify
    Encapsulation Type     : vlan
    MTU                    : 1500
    Diffserv Mode          : uniform
    Service Class          : --
    Color                  : --
    DomainId               : 255
    Domain Name            :
    Ignore AcState         : disable
    P2P VSI                : disable
    Multicast Fast Switch  : disable
    Create Time            : 1 days, 8 hours, 46 minutes, 34 seconds
    <strong id="EN-US_TASK_0172370251__b727557212214346">VSI State              : up</strong>
<span>    Resource Status        : --</span>

    VSI ID                 : 2
   *Peer Router ID         : 3.3.3.9
    Negotiation-vc-id      : 2
    Encapsulation Type     : vlan
    primary or secondary   : primary
    ignore-standby-state   : no
    VC Label               : 18
    Peer Type              : dynamic
    Session                : up
    Tunnel ID              : 0x000000000300000001
    Broadcast Tunnel ID    : --
    Broad BackupTunnel ID  : --
    Tunnel Policy Name     : policy1
    CKey                   : 33
    NKey                   : 1610612843
<span>    Stp Enable             : 0</span>
    PwIndex                : 0
<span>    Control Word           : disable</span>
    BFD for PW             : unavailable

    Interface Name         : GigabitEthernet<span>0/2/0</span>.1
    State                  : up
    Ac Block State         : unblocked
    Access Port            : false
    Last Up Time           : 2012/09/10 10:14:46
    Total Up Time          : 1 days, 8 hours, 41 minutes, 37 seconds

  **PW Information:

   *Peer Ip Address        : 3.3.3.9
    PW State               : up
    Local VC Label         : 18
    Remote VC Label        : 18
<span>    Remote Control Word    : disable</span>
    PW Type                : label
    Local  VCCV            : alert lsp-ping bfd
    Remote VCCV            : alert lsp-ping bfd
    Tunnel ID              : 0x000000000300000001
    Broadcast Tunnel ID    : --
    Broad BackupTunnel ID  : --
    Ckey                   : 33
    Nkey                   : 1610612843
    Main PW Token          : 0x0
    Slave PW Token         : 0x0
    Tnl Type               : te
    OutInterface           : Tunnel10
    Backup OutInterface    : --
<span>    Stp Enable             : 0</span>
    Mac Flapping           : 0
    Monitor Group Name     : --
    PW Last Up Time        : 2012/09/11 09:19:12
    PW Total Up Time       : 1 days, 6 hours, 52 minutes, 3 seconds </pre>
<p id="EN-US_TASK_0172370251__p1934322048214054">Run the <a href="cmdqueryname=display+vsi+pw+out-interface+vsi+a2"><b><span class="cmdname" id="EN-US_TASK_0172370251__cmdname1185564731513">display vsi pw out-interface vsi a2</span></b></a> command on PE1. The command output shows that the outbound interface of the MPLS TE tunnel between 1.1.1.9 and 3.3.3.9 is Tunnel10.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1560287149214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword961357261214054"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172370251__b3302183121613">display vsi pw out-interface vsi a2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen234289886214054">Total: 1
--------------------------------------------------------------------------------
Vsi Name                        peer            vcid       interface
--------------------------------------------------------------------------------
a2                              3.3.3.9         2          Tunnel10</pre>
<p id="EN-US_TASK_0172370251__p262486699214054">CE1 and CE2 can ping each other.</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1725419458214054">[<span class="keyword" id="EN-US_TASK_0172370251__keyword1647611832112"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong id="EN-US_TASK_0172370251__b34064114214054">ping 10.1.1.2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen452295840214054">  PING 10.1.1.2: 56  data bytes, press CTRL_C to break</pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen815948042214054">    Reply from 10.1.1.2: bytes=56 Sequence=1 ttl=255 time=125 ms</pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1469796458214054">    Reply from 10.1.1.2: bytes=56 Sequence=2 ttl=255 time=125 ms</pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen227590617214054">    Reply from 10.1.1.2: bytes=56 Sequence=3 ttl=255 time=94 ms</pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen778073031214054">    Reply from 10.1.1.2: bytes=56 Sequence=4 ttl=255 time=125 ms</pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1098629484214054">    Reply from 10.1.1.2: bytes=56 Sequence=5 ttl=255 time=125 ms</pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen674799592214054">  --- 10.1.1.2 ping statistics ---</pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1656979093214054">    5 packet(s) transmitted</pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1917036649214054">    5 packet(s) received</pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen1286014881214054">    0.00% packet loss</pre>
<pre class="screen" id="EN-US_TASK_0172370251__screen2074334225214054">    round-trip min/avg/max = 94/118/125 ms</pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172370251__example1122625092214054"><a name="EN-US_TASK_0172370251__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul id="EN-US_TASK_0172370251__ul740643098214054"><li id="EN-US_TASK_0172370251__li1963706964214054"><p id="EN-US_TASK_0172370251__p1494256852214054"><a name="EN-US_TASK_0172370251__li1963706964214054"></a><a name="li1963706964214054"></a>CE1 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen493600221214054">#
sysname CE1
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/0</span>.1
 vlan-type dot1q 10
 ip address 10.1.1.1 255.255.255.0
#
return</pre>
</li><li id="EN-US_TASK_0172370251__li435839870214054"><p id="EN-US_TASK_0172370251__p93975173214054"><a name="EN-US_TASK_0172370251__li435839870214054"></a><a name="li435839870214054"></a>PE1 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen852103035214054">#
sysname PE1
#
mpls lsr-id 1.1.1.9
#
mpls
 mpls te
#
mpls l2vpn
#
vsi a2
 pwsignal ldp
  vsi-id 2
  peer 3.3.3.9 tnl-policy policy1
#
explicit-path path2pe2
 next sid label 16300 type prefix index 1
 next sid label 16200 type prefix index 2
#
mpls ldp
 #
 ipv4-family
#
mpls ldp remote-peer 3.3.3.9
 remote-ip 3.3.3.9
#
segment-routing
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.10.1.1 255.255.255.0
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
#
interface GigabitEthernet<span>0/2/0</span>.1
 vlan-type dot1q 10
 l2 binding vsi a2
#
interface LoopBack1
 ip address 1.1.1.9 255.255.255.255
 ospf prefix-sid absolute 16100
#
interface Tunnel10
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 3.3.3.9
 mpls te signal-protocol segment-routing
 mpls te reserved-for-binding
 mpls te tunnel-id 100
 mpls te path explicit-path path2pe2
#
ospf 1
 opaque-capability enable
 segment-routing mpls
 segment-routing global-block 16000 47999
 area 0.0.0.0
  network 1.1.1.9 0.0.0.0
  network 10.10.1.0 0.0.0.255
  mpls-te enable
#
tunnel-policy policy1
 tunnel binding destination 3.3.3.9 te Tunnel10
#
return</pre>
</li><li id="EN-US_TASK_0172370251__li741385222214054"><p id="EN-US_TASK_0172370251__p761306260214054"><a name="EN-US_TASK_0172370251__li741385222214054"></a><a name="li741385222214054"></a>P configuration file</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1159525713214054">#
sysname P
#
mpls lsr-id 2.2.2.9
#
mpls
 mpls te
#
segment-routing
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.10.1.2 255.255.255.0
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.20.1.1 255.255.255.0
#
interface LoopBack1
 ip address 2.2.2.9 255.255.255.255
 ospf prefix-sid absolute 16300
#
ospf 1
 opaque-capability enable
 segment-routing mpls
 segment-routing global-block 16000 47999
 area 0.0.0.0
  network 2.2.2.9 0.0.0.0
  network 10.10.1.0 0.0.0.255
  network 10.20.1.0 0.0.0.255
  mpls-te enable
#
return</pre>
</li><li id="EN-US_TASK_0172370251__li1608274550214054"><p id="EN-US_TASK_0172370251__p2041180708214054"><a name="EN-US_TASK_0172370251__li1608274550214054"></a><a name="li1608274550214054"></a>PE2 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen1139931727214054">#
sysname PE2
#
mpls lsr-id 3.3.3.9
#
mpls
 mpls te
#
mpls l2vpn
#
vsi a2
 pwsignal ldp
  vsi-id 2      
  peer 1.1.1.9 tnl-policy policy1 
#
explicit-path path2pe1
 next sid label 16300 type prefix index 1
 next sid label 16100 type prefix index 2
#
mpls ldp
 #
 ipv4-family
#
mpls ldp remote-peer 1.1.1.9
 remote-ip 1.1.1.9
#
segment-routing
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.20.1.2 255.255.255.0
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
#
interface GigabitEthernet<span>0/2/0</span>.1
 vlan-type dot1q 10
 l2 binding vsi a2
#
interface LoopBack1
 ip address 3.3.3.9 255.255.255.255
 ospf prefix-sid absolute 16200
#
interface Tunnel10
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 1.1.1.9
 mpls te signal-protocol segment-routing
 mpls te reserved-for-binding
 mpls te tunnel-id 100
 mpls te path explicit-path path2pe1
#
ospf 1
 opaque-capability enable
 segment-routing mpls
 segment-routing global-block 16000 47999
 area 0.0.0.0
  network 3.3.3.9 0.0.0.0
  network 10.20.1.0 0.0.0.255
  mpls-te enable
#
tunnel-policy policy1
 tunnel binding destination 1.1.1.9 te Tunnel10
#
return</pre>
</li><li id="EN-US_TASK_0172370251__li196269577214054"><p id="EN-US_TASK_0172370251__p167898847214054"><a name="EN-US_TASK_0172370251__li196269577214054"></a><a name="li196269577214054"></a>CE2 configuration file</p>
<pre class="screen" id="EN-US_TASK_0172370251__screen2074829729214054">#
sysname CE2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/0</span>.1
 vlan-type dot1q 10
 ip address 10.1.1.2 255.255.255.0
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_5029.html">Configuration Examples for VPLS
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_5031.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpls_cfg_5032.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>