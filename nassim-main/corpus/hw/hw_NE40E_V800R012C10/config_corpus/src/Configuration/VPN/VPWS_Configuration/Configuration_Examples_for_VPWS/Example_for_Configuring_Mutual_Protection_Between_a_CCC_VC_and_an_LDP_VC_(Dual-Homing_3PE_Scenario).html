
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Mutual Protection Between a CCC VC and an LDP VC (Dual-Homing 3PE Scenario)">
<meta name="abstract" content="This section provides an example for configuring mutual protection between a CCC VC and an LDP VC. Specifying the master/backup status of PEs allows for mutual protection between a CCC VC and an LDP VC.">
<meta name="description" content="This section provides an example for configuring mutual protection between a CCC VC and an LDP VC. Specifying the master/backup status of PEs allows for mutual protection between a CCC VC and an LDP VC.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_3012.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6074.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_3014.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00415692">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00415692">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369917">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Mutual Protection Between a CCC VC and an LDP VC (Dual-Homing 3PE Scenario)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172369917"></a><a name="EN-US_TASK_0172369917"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Mutual Protection Between a CCC VC and an LDP VC (Dual-Homing 3PE Scenario)</h1>
<div class="taskbody"><p>This section provides an example for configuring mutual protection between a CCC VC and an LDP VC. Specifying the master/backup status of PEs allows for mutual protection between a CCC VC and an LDP VC.</p>
<div class="context"><a name="EN-US_TASK_0172369917__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0172369917__fig_dc_vrp_vpws_cfg_607501">Figure 1</a>, CE1 and CE2 use Eth-Trunks to determine their active/standby AC status. CE1 accesses CE2 through PE2. If the active AC of CE1 or CE2 fails, CE1 cannot be authenticated. To resolve this issue, you can deploy a PW between PE1 and PE3 to protect the active AC. Under normal circumstances, CE1 accesses CE2 for authentication through PE2. If the active AC of CE1 or CE2 fails, CE1 accesses CE2 through the PW between PE1 and PE3 to ensure service continuity.</p>
<div class="fignone" id="EN-US_TASK_0172369917__fig_dc_vrp_vpws_cfg_607501"><a name="EN-US_TASK_0172369917__fig_dc_vrp_vpws_cfg_607501"></a><a name="fig_dc_vrp_vpws_cfg_607501"></a><span class="figcap"><b>Figure 1 </b>Mutual protection between a CCC VC and an LDP VC</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>In this example, interface1 and interface2 represent GE<span>0/1/0</span> and GE<span>0/1/1</span>, respectively.</li></ul>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_vpws_cfg_607501.png"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369917__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure a routing protocol on the backbone network to achieve connectivity between devices.</p>
</li><li><p>Configure basic MPLS functions on PEs.</p>
</li><li><p>Configure a CCC that allows CE1 and CE2 to communicate and a protection PW for the CCC on PE1.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369917__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><div class="p">To complete the configuration, you need the following data:<ul><li>Peer IP addresses and VLAN IDs</li><li>Basic MPLS capabilities of peers</li><li>CCC VC and LDP VC services on the peers</li></ul>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172369917__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure CEs.</span><p><p># Configure CE1.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname CE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong>interface Eth-Trunk 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-Eth-Trunk10] <strong>mode lacp-static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-Eth-Trunk10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1]<strong> interface Eth-Trunk10.100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-Eth-Trunk10.100]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-Eth-Trunk10.100]<strong> vlan-type dot1q 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-Eth-Trunk10.100]<strong> ip address 10.1.1.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-Eth-Trunk10.100]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1]<strong> interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-Gigabitethernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-Gigabitethernet<span>0/1/1</span>]<strong> eth-trunk 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-Gigabitethernet<span>0/1/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1]<strong> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-Gigabitethernet<span>0/1/0</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-Gigabitethernet<span>0/1/0</span>]<strong> eth-trunk 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-Gigabitethernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>commit</strong></pre>
<p># Configure CE2.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname CE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2]<strong> interface Eth-Trunk 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-Eth-Trunk20] <strong>mode lacp-static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-Eth-Trunk20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2]<strong> interface Eth-Trunk20.100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-Eth-Trunk20.100]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-Eth-Trunk20.100]<strong> vlan-type dot1q 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-Eth-Trunk20.100]<strong> ip address 10.1.1.2 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-Eth-Trunk20.100]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2]<strong> interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-Gigabitethernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-Gigabitethernet<span>0/1/1</span>]<strong> eth-trunk 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-Gigabitethernet<span>0/1/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2]<strong> interface gigabitethernet<span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-Gigabitethernet<span>0/1/0</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-Gigabitethernet<span>0/1/0</span>]<strong> eth-trunk 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-Gigabitethernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>commit</strong></pre>
</p></li><li><span>Configure IP addresses for the interfaces on the backbone network. </span><p><p># Configure PE1.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-LoopBack1] <strong>ip address 1.1.1.1 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-LoopBack1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Gigabitethernet<span>0/1/1</span>] <strong>ip address 192.168.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Gigabitethernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Gigabitethernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> interface gigabitethernet<span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Gigabitethernet<span>0/1/2</span>] <strong>ip address 192.168.10.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Gigabitethernet<span>0/1/2</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Gigabitethernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-LoopBack1] <strong>ip address 2.2.2.2 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-LoopBack1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Gigabitethernet<span>0/1/1</span>] <strong>ip address 192.168.1.2 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Gigabitethernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Gigabitethernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> interface gigabitethernet<span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Gigabitethernet<span>0/1/2</span>] <strong>ip address 192.168.20.2 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Gigabitethernet<span>0/1/2</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Gigabitethernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure PE3.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3]<strong> interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-LoopBack1] <strong>ip address 3.3.3.3 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-LoopBack1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3]<strong> interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Gigabitethernet<span>0/1/1</span>] <strong>ip address 192.168.20.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Gigabitethernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Gigabitethernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3]<strong> interface gigabitethernet<span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Gigabitethernet<span>0/1/2</span>] <strong>ip address 192.168.10.2 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Gigabitethernet<span>0/1/2</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Gigabitethernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>commit</strong></pre>
</p></li><li><span>Enable MPLS and establish LSPs.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>mpls lsr-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Gigabitethernet<span>0/1/1</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Gigabitethernet<span>0/1/1</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Gigabitethernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> interface gigabitethernet<span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Gigabitethernet<span>0/1/2</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Gigabitethernet<span>0/1/2</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Gigabitethernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>mpls lsr-id 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Gigabitethernet<span>0/1/1</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Gigabitethernet<span>0/1/1</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Gigabitethernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> interface gigabitethernet<span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Gigabitethernet<span>0/1/2</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Gigabitethernet<span>0/1/2</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Gigabitethernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure PE3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong>mpls lsr-id 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3]<strong> interface gigabitethernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Gigabitethernet<span>0/1/1</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Gigabitethernet<span>0/1/1</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Gigabitethernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3]<strong> interface gigabitethernet<span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Gigabitethernet<span>0/1/2</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Gigabitethernet<span>0/1/2</span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Gigabitethernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
</p></li><li><span>Configure an IGP (OSPF in this example).</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1] <strong>area 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>network 1.1.1.1 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>network 192.168.1.1 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>network 192.168.10.1 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1] <strong>area 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1-area-0.0.0.0] <strong>network 2.2.2.2 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1-area-0.0.0.0] <strong>network 192.168.1.2 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-ospf-1-area-0.0.0.0] <strong>network 192.168.20.2 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure PE3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-ospf-1] <strong>area 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-ospf-1-area-0.0.0.0] <strong>network 3.3.3.3 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-ospf-1-area-0.0.0.0] <strong>network 192.168.10.2 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-ospf-1-area-0.0.0.0] <strong>network 192.168.20.1 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-ospf-1-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>commit</strong></pre>
</p></li><li><span>Enable MPLS L2VPN on each PE.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-l2vpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-l2vpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure PE3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong>mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-l2vpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>commit</strong></pre>
</p></li><li><span>Configure an E-Trunk to determine the primary/secondary status of PWs.</span><ol type="a"><li class="substepexpand"><span>Configure an E-Trunk.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>lacp e-trunk system-id 00e0-fc00-0000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>lacp e-trunk priority 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>e-trunk 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-e-trunk-10] <strong>priority 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-e-trunk-10] <strong>peer-address 2.2.2.2 source-address 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-e-trunk-10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface Eth-trunk 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Eth-Trunk10] <strong>mode lacp-static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Eth-Trunk10] <strong>e-trunk 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Eth-Trunk10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>] <strong>eth-trunk 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>lacp e-trunk system-id 00e0-fc00-0000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>lacp e-trunk priority 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>e-trunk 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-e-trunk-10] <strong>priority 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-e-trunk-10] <strong>peer-address 1.1.1.1 source-address 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-e-trunk-10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface Eth-trunk 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk10] <strong>mode lacp-static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk10] <strong>e-trunk 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>e-trunk 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-e-trunk-20] <strong>priority 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-e-trunk-20] <strong>peer-address 3.3.3.3 source-address 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-e-trunk-20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface Eth-trunk 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk20] <strong>mode lacp-static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk20] <strong>e-trunk 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>] <strong>eth-trunk 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong>eth-trunk 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/3</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure PE3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong>lacp e-trunk system-id 00e0-fc00-0000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>lacp e-trunk priority 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>e-trunk 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-e-trunk-20] <strong>priority 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-e-trunk-20] <strong>peer-address 2.2.2.2 source-address 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-e-trunk-20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>interface eth-trunk 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Eth-Trunk20] <strong>mode lacp-static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Eth-Trunk20] <strong>e-trunk 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Eth-Trunk20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/0</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/0</span>] <strong>eth-trunk 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>commit</strong></pre>
</p></li><li class="substepexpand"><span>Bind BFD to the E-Trunk.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>bfd</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bfd] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>bfd hello bind peer-ip 2.2.2.2 source-ip 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bfd-session-hello] <strong>discriminator local 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bfd-session-hello] <strong>discriminator remote 101</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-bfd-session-hello] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>e-trunk 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-e-trunk-10] <strong>e-trunk track bfd-session session-name hello</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-e-trunk-10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>bfd</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bfd] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>bfd hello bind peer-ip 1.1.1.1 source-ip 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bfd-session-hello] <strong>discriminator local 101</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bfd-session-hello] <strong>discriminator remote 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bfd-session-hello] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>bfd hi bind peer-ip 3.3.3.3 source-ip 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bfd-session-hi] <strong>discriminator local 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bfd-session-hi] <strong>discriminator remote 201</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-bfd-session-hi] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>e-trunk 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-e-trunk-10] <strong>e-trunk track bfd-session session-name hello</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-e-trunk-10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>e-trunk 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-e-trunk-20] <strong>e-trunk track bfd-session session-name hi</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-e-trunk-20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure PE3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong>bfd</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-bfd] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>bfd hi bind peer-ip 2.2.2.2 source-ip 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-bfd-session-hi] <strong>discriminator local 201</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-bfd-session-hi] <strong>discriminator remote 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-bfd-session-hi] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>e-trunk 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-e-trunk-20] <strong>e-trunk track bfd-session session-name hi</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-e-trunk-20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>commit</strong></pre>
</p></li></ol>
</li><li><span>Create a CCC VC and LDP VCs on the PEs.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>interface Eth-Trunk10.100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Eth-Trunk10.100] <strong>vlan-type dot1q 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Eth-Trunk10.100] <strong>mpls l2vc 2.2.2.2 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Eth-Trunk10.100] <strong>mpls l2vc 3.3.3.3 200 secondary</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Eth-Trunk10.100] <strong>mpls l2vpn redundancy independent</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Eth-Trunk10.100]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface Eth-Trunk20.100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk20.100] <strong>vlan-type dot1q 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk20.100]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>interface Eth-Trunk10.100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk10.100] <strong>vlan-type dot1q 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk10.100] <strong>mpls ccc out-interface Eth-Trunk20.100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk10.100] <strong>mpls l2vc 3.3.3.3 300 secondary</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk10.100] <strong>mpls l2vpn redundancy independent</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk10.100]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface Eth-Trunk20.100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk20.100] <strong>mpls ccc out-interface Eth-Trunk10.100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk20.100] <strong>mpls l2vc 1.1.1.1 100 secondary</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk20.100] <strong>mpls l2vpn redundancy independent</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk20.100]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure PE3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong>interface Eth-Trunk20.100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Eth-Trunk20.100] <strong>vlan-type dot1q 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Eth-Trunk20.100] <strong>mpls l2vc 1.1.1.1 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Eth-Trunk20.100] <strong>mpls l2vc 2.2.2.2 300 secondary</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Eth-Trunk20.100] <strong>mpls l2vpn redundancy independent</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-Eth-Trunk20.100]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>After the configurations are complete, check the VPWS status on PE2. The command output shows that the CCC and LDP VCs have been established and are in the up state. The role of the CCC VC is primary, and that of the LDP VC is secondary.</p>
<pre class="screen">&lt;PE2&gt; <strong>display mpls l2vpn vpws</strong></pre>
<pre class="screen">Pri : Primary            Sec : Secondary            Byp : Bypass
PWb : PW-bypass          ACb : AC-bypass

Access Circuit                Virtual Circuit               States Active   Role
Eth-Trunk10.100               Eth-Trunk20.100               Up     Active   Pri
                              3.3.3.3:300                   Up     Inactive Sec
Eth-Trunk20.100               Eth-Trunk10.100               Up     Active   Pri
                              1.1.1.1:100                   Up     Inactive Sec</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172369917__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>CE1 configuration file</p>
<pre class="screen">#
sysname CE1
#
interface Eth-Trunk10                                                           
  mode lacp-static                                                               
#                                                                               
interface Eth-Trunk10.100                                                       
 vlan-type dot1q 100                                                            
 ip address 10.1.1.1 255.255.255.0                                             
#                                                                               
interface Gigabitethernet<span>0/1/0</span>                                                         
 undo shutdown                                                                  
 eth-trunk 10  
#                                                                 
interface Gigabitethernet<span>0/1/1</span>                                                        
 undo shutdown                                                                  
 eth-trunk 10                                                                              
#                                                                 
#return</pre>
</li><li><p>CE2 configuration file</p>
<pre class="screen">#
sysname CE2
#
interface Eth-Trunk20                                                           
 mode lacp-static                                                               
#                                                                               
interface Eth-Trunk20.100                                                       
 vlan-type dot1q 100                                                            
 ip address 10.1.1.2 255.255.255.0                                             
#                                                                               
interface Gigabitethernet<span>0/1/0</span>                                                         
 undo shutdown                                                                  
 eth-trunk 20  
#                                                                 
interface Gigabitethernet<span>0/1/1</span>                                                        
 undo shutdown                                                                  
 eth-trunk 20
#
return</pre>
</li><li><p>PE1 configuration file</p>
<pre class="screen">#
sysname PE1
#
lacp e-trunk system-id 00e0-fc00-0000
lacp e-trunk priority 100
#
e-trunk 10
#
bfd
#
mpls lsr-id 1.1.1.1
#
mpls
#
mpls ldp
#
mpls l2vpn
#
interface Eth-Trunk10
 mode lacp-static  
 e-trunk 10
#
interface Eth-Trunk10.100
 vlan-type dot1q 100                                                            
 mpls l2vc 2.2.2.2 100
 mpls l2vc 3.3.3.3 200 secondary                                                
 mpls l2vpn redundancy independent                                                   
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 eth-trunk 10
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 192.168.1.1 255.255.255.0
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 192.168.10.1 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 1.1.1.1 255.255.255.255
#
ospf 1                                                                                                            
 area 0.0.0.0                                                                   
  network 1.1.1.1 0.0.0.0                                                       
  network 192.168.1.1 0.0.0.255
  network 192.168.10.1 0.0.0.255
#
bfd hello bind peer-ip 2.2.2.2 source-ip 1.1.1.1
 discriminator local 100
 discriminator remote 101
#
e-trunk 10
 priority 10
 peer-address 2.2.2.2 source-address 1.1.1.1
 e-trunk track bfd-session session-name hello
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2
#
lacp e-trunk system-id 00e0-fc00-0000
lacp e-trunk priority 100
#
e-trunk 10
#
e-trunk 20
#
bfd
#
mpls lsr-id 2.2.2.2
#
mpls
#
mpls ldp
#
mpls l2vpn
#
interface Eth-Trunk10
 mode lacp-static  
 e-trunk 10
#
interface Eth-Trunk10.100
 vlan-type dot1q 100                                                            
 mpls ccc out-interface Eth-Trunk20.100
 mpls l2vc 3.3.3.3 300 secondary                                                
 mpls l2vpn redundancy independent                                                   
# 
interface Eth-Trunk20
 mode lacp-static  
 e-trunk 20
#                                                                              
interface Eth-Trunk20.100
 vlan-type dot1q 100                                                            
 mpls ccc out-interface Eth-Trunk10.100
 mpls l2vc 1.1.1.1 100 secondary                                                
 mpls l2vpn redundancy independent                                                   
# 
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 eth-trunk 10  
#
interface GigabitEthernet<span>0/1/3</span>
 undo shutdown
 eth-trunk 20                                                            
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 192.168.20.2 255.255.255.0
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 192.168.1.2 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 2.2.2.2 255.255.255.255
#
ospf 1                                                                                                            
 area 0.0.0.0                                                                   
  network 2.2.2.2 0.0.0.0                                                       
  network 192.168.1.2 0.0.0.255
  network 192.168.20.2 0.0.0.255
#
bfd hello bind peer-ip 1.1.1.1 source-ip 2.2.2.2
 discriminator local 101
 discriminator remote 100
#
bfd hi bind peer-ip 3.3.3.3 source-ip 2.2.2.2
 discriminator local 200
 discriminator remote 201
#
e-trunk 10
 priority 10
 peer-address 1.1.1.1 source-address 2.2.2.2
 e-trunk track bfd-session session-name hello
#
e-trunk 20
 priority 20
 peer-address 3.3.3.3 source-address 2.2.2.2
 e-trunk track bfd-session session-name hi
#

return</pre>
</li><li><p>PE3 configuration file</p>
<pre class="screen">#
sysname PE3
#
lacp e-trunk system-id 00e0-fc00-0000
lacp e-trunk priority 100
#
e-trunk 20
#
bfd
#
mpls lsr-id 3.3.3.3
#
mpls
#
mpls ldp
#
mpls l2vpn
#
interface Eth-Trunk20
 mode lacp-static  
 e-trunk 20
#
interface Eth-Trunk20.100
 vlan-type dot1q 100                                                            
 mpls l2vc 1.1.1.1 200
 mpls l2vc 2.2.2.2 300 secondary                                                
 mpls l2vpn redundancy independent                                                   
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 eth-trunk 20
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 192.168.20.1 255.255.255.0
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 192.168.10.2 255.255.255.0
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 3.3.3.3 255.255.255.255
#
ospf 1                                                                                                            
 area 0.0.0.0 
  network 3.3.3.3 0.0.0.0                                                                 
  network 192.168.10.2 0.0.0.255                                                       
  network 192.168.20.1 0.0.0.255
#
bfd hi bind peer-ip 2.2.2.2 source-ip 3.3.3.3
 discriminator local 201
 discriminator remote 200
#
e-trunk 20
 priority 20
 peer-address 2.2.2.2 source-address 3.3.3.3
 e-trunk track bfd-session session-name hi
#

return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_3012.html">Configuration Examples for VPWS
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6074.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_3014.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>