
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring ATM Bundle Interfaces to Forward Traffic from Multiple NodeBs to an RNC">
<meta name="abstract" content="An ATM bundle interface transmits a single type of service from multiple TDM/ATM NodeBs along one PW to an RNC. This relieves the burden on a CSG and allows greater service scalability.">
<meta name="description" content="An ATM bundle interface transmits a single type of service from multiple TDM/ATM NodeBs along one PW to an RNC. This relieves the burden on a CSG and allows greater service scalability.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_3012.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6009.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6038.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00415692">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00415692">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369978">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring ATM Bundle Interfaces to Forward Traffic from Multiple NodeBs to an RNC</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172369978"></a><a name="EN-US_TASK_0172369978"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring ATM Bundle Interfaces to Forward Traffic from Multiple NodeBs to an RNC</h1>
<div class="taskbody"><p>An ATM bundle interface transmits a single type of service from multiple TDM/ATM NodeBs along one PW to an RNC. This relieves the burden on a CSG and allows greater service scalability.</p>
<div class="context"><a name="EN-US_TASK_0172369978__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This section does not apply to the M2K or M2K-B models.</p>
</div></div>
<p>ATM bundling is an extended PWE3 application for transparently transmitting ATM cells. An ATM bundle interface allows various NodeBs to share one PW to transmit a single type of service to an RNC.</p>
<p>On an IP RAN, multiple NodeBs are connected to a CSG through serial interfaces channelized from E1, CE1, or CPOS links. Every NodeB can transmit voice, video, and data services. Therefore, the CSG must create three PVCs for every NodeB before transmitting voice, video, and data services. An increase in the number of NodeBs and service types increases the load on the CSG. An ATM bundle interface forwards a single type of service from multiple NodeBs to an RNC along one PW. This reduces the number of PWs, relieves the load on the CSG, and improves service scalability.</p>
<p>On the network shown in <a href="#EN-US_TASK_0172369978__fig_dc_vrp_vpws_cfg_601101">Figure 1</a>, NodeB1 and NodeB2 connect to a CSG through serial links. Each NodeB transmits both voice and data services. It is required that two PWs, PW1 and PW2, be set up between the CSG and RSG to transmit the services separately. ATM bundle 1 and ATM bundle 2 are created on the CSG, and PW1 and PW2 are configured on each of the ATM bundle interfaces. The PVC configured to transmit voice services joins ATM bundle 1, and the other PVC configured to transmit data services joins ATM bundle 2. This allows multiple NodeBs to share the same PW to transmit the same type of service to an RNC. <a href="#EN-US_TASK_0172369978__fig_dc_vrp_vpws_cfg_601101">Figure 1</a> describes the mapping relationships between interfaces and services.</p>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Mapping relationships between interfaces and services</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="8.649999999999999%" id="mcps1.4.1.6.2.6.1.1" liSelected="liSelected"><p>NodeB</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="14.95%" id="mcps1.4.1.6.2.6.1.2" liSelected="liSelected"><p>CSG Sub-interface</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="18.02%" id="mcps1.4.1.6.2.6.1.3" liSelected="liSelected"><p>Service Type</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="29.189999999999998%" id="mcps1.4.1.6.2.6.1.4" liSelected="liSelected"><p>PVC Configuration (VPI/VCI Values)</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="29.189999999999998%" id="mcps1.4.1.6.2.6.1.5" liSelected="liSelected"><p>ATM Bundle ID</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="2" valign="top" width="8.649999999999999%" headers="mcps1.4.1.6.2.6.1.1 "><p>NodeB1</p>
</td>
<td class="cellrowborder" valign="top" width="14.95%" headers="mcps1.4.1.6.2.6.1.2 "><p>Serial<span>0/2/0</span>:0.1</p>
</td>
<td class="cellrowborder" valign="top" width="18.02%" headers="mcps1.4.1.6.2.6.1.3 "><p>Voice</p>
</td>
<td class="cellrowborder" valign="top" width="29.189999999999998%" headers="mcps1.4.1.6.2.6.1.4 "><p>1/33</p>
</td>
<td class="cellrowborder" valign="top" width="29.189999999999998%" headers="mcps1.4.1.6.2.6.1.5 "><p>ATM Bundle 1</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.6.1.2 "><p>Serial<span>0/2/0</span>:0.2</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.6.1.3 "><p>Data</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.6.1.4 "><p>2/33</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.6.1.5 "><p>ATM Bundle 2</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" valign="top" width="8.649999999999999%" headers="mcps1.4.1.6.2.6.1.1 "><p>NodeB2</p>
</td>
<td class="cellrowborder" valign="top" width="14.95%" headers="mcps1.4.1.6.2.6.1.2 "><p>Serial<span>0/2/1</span>:0.1</p>
</td>
<td class="cellrowborder" valign="top" width="18.02%" headers="mcps1.4.1.6.2.6.1.3 "><p>Voice</p>
</td>
<td class="cellrowborder" valign="top" width="29.189999999999998%" headers="mcps1.4.1.6.2.6.1.4 "><p>3/33</p>
</td>
<td class="cellrowborder" valign="top" width="29.189999999999998%" headers="mcps1.4.1.6.2.6.1.5 "><p>ATM Bundle 1</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.6.1.2 "><p>Serial<span>0/2/1</span>:0.2</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.6.1.3 "><p>Data</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.6.1.4 "><p>4/33</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.6.2.6.1.5 "><p>ATM Bundle 2</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="fignone" id="EN-US_TASK_0172369978__fig_dc_vrp_vpws_cfg_601101"><a name="EN-US_TASK_0172369978__fig_dc_vrp_vpws_cfg_601101"></a><a name="fig_dc_vrp_vpws_cfg_601101"></a><span class="figcap"><b>Figure 1 </b>Networking diagram for configuring ATM bundle interfaces to forward traffic from multiple NodeBs to an RNC</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>In this example, interface1 represents GE<span>0/1/0</span>.</li></ul>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_vpws_cfg_601101.png" width="NaN" height="NaN"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369978__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Assign an IP address to and configure a routing protocol on each interface.</p>
</li><li><p>Configure basic MPLS functions and TE tunnels:</p>
<ul><li>Enable MPLS TE, RSVP-TE, OSPF TE, and CSPF.</li><li>Configure MPLS TE tunnel interfaces.</li><li>Configure a tunnel policy.</li></ul>
</li><li><p>Configure ATM bundle interfaces:</p>
<ul><li>Configure ATM bundle interfaces.</li><li>Add AC sub-interfaces connecting the CSG to NodeBs to ATM bundle interfaces.</li></ul>
</li><li><p>Configure PWE3:</p>
<ul><li>Configure a remote LDP session between the CSG and RSG.</li><li>Enable L2VPN and configure PWE3.</li></ul>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369978__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Interface number, interface IP address, and OSPF process ID</p>
</li><li><p>LSR ID, VC ID, and VC type</p>
</li><li><p>ATM bundle interface number and PVC VPI/VCI values</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172369978__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to and configure a routing protocol on each interface.</span><ol type="a"><li><span>Assign an IP address to each interface.</span></li><li><span>Configure a routing protocol on the CSG and RSG to establish connectivity. OSPF is used in this example.</span></li></ol>
<p><p>After completing the preceding configurations, run the <a href="cmdqueryname=display+ip+routing-table"><b><span class="cmdname">display ip routing-table</span></b></a> command on CSG and RSG. Both have learned routes from each other. Note that when configuring OSPF, advertise 32-bit loopback interface addresses (LSR IDs) of the CSG and RSG.</p>
<p>The configuration procedure is not provided.</p>
</p></li><li><span>Configure basic MPLS functions and TE tunnels.</span><ol type="a"><li class="substepexpand"><span>Enable MPLS TE, RSVP-TE, OSPF TE, and CSPF.</span><p><p># Configure the CSG.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CSG] <strong>mpls lsr-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-mpls] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-mpls] <strong>mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>ospf 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-ospf-100] <strong>opaque-capability enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-ospf-100] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-ospf-100-area-0.0.0.0] <strong>mpls-te enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-ospf-100-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-ospf-100] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>commit</strong></pre>
<p># Configure the RSG.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>RSG] <strong>mpls lsr-id 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-mpls] <strong>label advertise non-null</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-mpls] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-mpls] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-mpls] <strong>mpls te cspf</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-GigabitEthernet<span>0/1/0</span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-GigabitEthernet<span>0/1/0</span>] <strong>mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-GigabitEthernet<span>0/1/0</span>] <strong>mpls rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG] <strong>ospf 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-ospf-100] <strong>opaque-capability enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-ospf-100] <strong>area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-ospf-100-area-0.0.0.0] <strong>mpls-te enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-ospf-100-area-0.0.0.0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-ospf-100] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG] <strong>commit</strong></pre>
</p></li><li class="substepexpand"><span>Configure an MPLS TE tunnel interface.</span><p><p># Configure the CSG.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CSG] <strong>interface Tunnel11</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Tunnel11] <strong>ip address unnumbered interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Tunnel11] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Tunnel11] <strong>destination 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Tunnel11] <strong>mpls te tunnel-id 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Tunnel11] <strong>mpls te signal-protocol rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Tunnel11] <strong>mpls te reserved-for-binding</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Tunnel11] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>commit</strong></pre>
<p># Configure the RSG.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>RSG] <strong>interface Tunnel11</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-Tunnel11] <strong>ip address unnumbered interface loopback 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-Tunnel11] <strong>tunnel-protocol mpls te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-Tunnel11] <strong>destination 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-Tunnel11] <strong>mpls te tunnel-id 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-Tunnel11] <strong>mpls te signal-protocol rsvp-te</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-Tunnel11] <strong>mpls te reserved-for-binding</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-Tunnel11] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG] <strong>commit</strong></pre>
</p></li><li class="substepexpand"><span>Configure a tunnel policy.</span><p><p># Configure the CSG.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CSG] <strong>tunnel-policy policy1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-tunnel-policy-policy1] <strong>tunnel binding destination 2.2.2.2 te Tunnel11</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-tunnel-policy-policy1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>commit</strong></pre>
<p># Configure the RSG.</p>
<pre class="screen">[<span class="keyword">*</span>RSG] <strong>tunnel-policy policy1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-tunnel-policy-policy1] <strong>tunnel binding destination 1.1.1.1 te Tunnel11</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-tunnel-policy-policy1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG] <strong>commit</strong></pre>
</p></li></ol>
</li><li><span>Configure ATM bundling.</span><ol type="a"><li class="substepexpand"><span>Create ATM bundle interfaces.</span><p><p># Create two ATM bundle interfaces on the CSG.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CSG] <strong>interface atm-bundle 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Atm-Bundle1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>interface atm-bundle 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Atm-Bundle2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>commit</strong></pre>
</p></li><li class="substepexpand"><span>Add AC sub-interfaces connecting the CSG to NodeBs to the ATM bundle interfaces.</span><p><p># Add AC sub-interfaces connecting the CSG to NodeB1 to both ATM bundle interfaces.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CSG] <strong>interface serial<span>0/2/0</span>:0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/0</span>:0] <strong>link-protocol atm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/0</span>:0] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/0</span>:0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>interface serial<span>0/2/0</span>:0.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/0</span>:0.1] <strong>pvc 1/33</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial-pvc-Serial<span>0/2/0</span>:0.1-1/33] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/0</span>:0.1] <strong>atm-bundle 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/0</span>:0.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>interface serial<span>0/2/0</span>:0.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/0</span>:0.2] <strong>pvc 2/33</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial-pvc-Serial<span>0/2/0</span>:0.2-2/33] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/0</span>:0.2] <strong>atm-bundle 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/0</span>:0.2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>commit</strong></pre>
<p># Add AC sub-interfaces connecting the CSG to NodeB2 to both ATM bundle interfaces.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CSG] <strong>interface serial<span>0/2/1</span>:0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/1</span>:0] <strong>link-protocol atm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/1</span>:0] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/1</span>:0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>interface serial<span>0/2/1</span>:0.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/1</span>:0.1] <strong>pvc 3/33</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial-pvc-Serial<span>0/2/1</span>:0.1-3/33] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/1</span>:0.1] <strong>atm-bundle 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/1</span>:0.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>interface serial<span>0/2/1</span>:0.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/1</span>:0.2] <strong>pvc 4/33</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial-pvc-Serial<span>0/2/1</span>:0.2-4/33] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/1</span>:0.2] <strong>atm-bundle 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/1</span>:0.2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>commit</strong></pre>
</p></li></ol>
</li><li><span>Configure PWE3.</span><ol type="a"><li class="substepexpand"><span>Configure a remote MPLS LDP session between the CSG and RSG.</span><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, TE tunnels are configured between the CSG and RSG, and MPLS LDP is not required. PWE3 uses extended LDP signaling to distribute VPN labels. Therefore, a remote MPLS LDP session has to be configured between the CSG and RSG.</p>
</div></div>
<p># Configure the CSG.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CSG] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>mpls ldp remote-peer 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-mpls-ldp-remote-2.2.2.2] <strong>remote-ip 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-mpls-ldp-remote-2.2.2.2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>commit</strong></pre>
<p># Configure the RSG.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>RSG] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG] <strong>mpls ldp remote-peer 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-mpls-ldp-remote-1.1.1.1] <strong>remote-ip 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-mpls-ldp-remote-1.1.1.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG] <strong>commit</strong></pre>
<p># Verify the configuration. # Run the <strong>display mpls ldp session all</strong> command on the CSG and RSG to check whether the LDP session is in the <strong>Operational</strong> state. The following example uses the command output on the CSG.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CSG] <strong>display mpls ldp session all</strong></pre>
<pre class="screen"> LDP Session(s) in Public Network
 Codes: LAM(Label Advertisement Mode), SsnAge Unit(DDDD:HH:MM)
<span> An asterisk (*) before a session means the session is being deleted.</span>
 ------------------------------------------------------------------------------
 PeerID             Status      LAM  SsnRole  SsnAge      KASent/Rcv
 ------------------------------------------------------------------------------
 2.2.2.2:0          <strong>Operational</strong> DU   Passive  0000:00:47  190/190
 3.3.3.3:0          <strong>Operational</strong> DU   Passive  0000:00:47  190/190
 ------------------------------------------------------------------------------
 TOTAL: 2 session(s) Found.    </pre>
</p></li><li class="substepexpand"><span>Enable L2VPN and configure PWE3.</span><p><p># Configure PWE3 on the ATM bundle interfaces of the CSG.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CSG] <strong>mpls l2vpn</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-l2vpn] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>interface atm-bundle 1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Atm-Bundle1] <strong>mpls l2vc 2.2.2.2 100 tunnel-policy policy1 control-word</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Atm-Bundle1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>interface atm-bundle 2 </strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Atm-Bundle2] <strong>mpls l2vc 2.2.2.2 200 tunnel-policy policy1 control-word</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Atm-Bundle2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>commit</strong></pre>
<p># Configure PWE3 on the AC sub-interfaces of the RSG.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CSG] <strong>interface serial<span>0/2/0</span>:0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/0</span>:0] <strong>link-protocol atm</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/0</span>:0] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/0</span>:0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>interface serial<span>0/2/0</span>:0.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/0</span>:0.1] <strong>pvc 1/33</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial-pvc-Serial<span>0/2/0</span>:0.1-1/33] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-Serial-pvc-Serial<span>0/2/0</span>:0.1] <strong>mpls l2vc 1.1.1.1 100 tunnel-policy policy1 control-word</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-Serial-pvc-Serial<span>0/2/0</span>:0.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-Serial<span>0/2/0</span>:0.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG] <strong>interface serial<span>0/2/0</span>:0.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial<span>0/2/0</span>:0.2] <strong>pvc 2/33</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CSG-Serial-pvc-Serial<span>0/2/0</span>:0.2-2/33] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-Serial-pvc-Serial<span>0/2/0</span>:0.2] <strong>mpls l2vc 1.1.1.1 200 tunnel-policy policy1 control-word</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-Serial-pvc-Serial<span>0/2/0</span>:0.2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG-Serial<span>0/2/0</span>:0.2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>RSG] <strong>commit</strong></pre>
</p></li></ol>
</li><li><span>Verify the configuration.</span><p><p>Run the <a href="cmdqueryname=display+mpls+l2vc"><b><span class="cmdname">display mpls l2vc</span></b></a> command on the CSG and RSG. Both PWs are <strong>Up</strong>.</p>
<p># Display PW information on ATM bundle 1.</p>
<pre class="screen">&lt;CSG&gt; <strong>display mpls l2vc interface atm-bundle 1</strong></pre>
<pre class="screen"> *client interface       : Atm-Bundle1 is up
  Administrator PW       : no
  session state          : up
  AC status               : up
  VC state               : <strong>up</strong>
  Label state            : 0
  Token state            : 0
  VC ID                  : 100
  VC type                : ATM Nto1 VCC
  destination            : 2.2.2.2
  local group ID         : 0            remote group ID      : 0
  local VC label         : 1025         remote VC label      : 1028
  max ATM cells          : 28
  ATM pack overtime      : 1000
  seq-number             : disable
  local AC OAM State     : up
  local PSN State        : up
  local forwarding state : forwarding
  local status code      : 0x0
  remote AC OAM state    : up
  remote PSN state       : up
  remote forwarding state: forwarding
  remote status code     : 0x0
  ignore standby state   : no
  BFD for PW             : unavailable
  VCCV State             : up
  manual fault           : not set
  active state           : active
  forwarding entry       : exist
  link state             : up
  local VC MTU           : 1500         remote VC MTU        : 1500
  local VCCV             : cw alert ttl lsp-ping bfd
  remote VCCV            : cw alert ttl lsp-ping bfd
  local control word     : enable       remote control word  : enable
  tunnel policy name     : policy1
  traffic behavior name  : --
  PW template name       : --
  primary or secondary   : primary
  Switchover Flag        : false
  VC tunnel/token info   : 1 tunnels/tokens
    NO.0  TNL type       : cr lsp, TNL ID : 0x800001
    Backup TNL type      : lsp   , TNL ID : 0x0
  create time            : 0 days, 1 hours, 0 minutes, 5 seconds
  up time                : 0 days, 1 hours, 0 minutes, 5 seconds
  last change time       : 0 days, 1 hours, 0 minutes, 5 seconds
  VC last up time        : 2010/11/10 11:16:04
  VC total up time       : 0 days, 1 hours, 0 minutes, 5 seconds
  CKey                   : 4
  NKey                   : 3
  PW redundancy mode     : frr
  AdminPw interface      : --
  AdminPw link state     : --   
<span>  Forward state          : send inactive, receive inactive </span>
</pre>
<p># Display PW information on ATM bundle 2.</p>
<pre class="screen">&lt;CSG&gt; <strong>display mpls l2vc interface atm-bundle 2</strong></pre>
<pre class="screen"> *client interface       : Atm-Bundle2 is up
  Administrator PW       : no
  session state          : up
  AC status               : up
  VC state               : <strong>up</strong>
  Label state            : 0
  Token state            : 0
  VC ID                  : 100
  VC type                : ATM Nto1 VCC
  destination            : 2.2.2.2
  local group ID         : 0            remote group ID      : 0
  local VC label         : 1027         remote VC label      : 1032
  max ATM cells          : 28
  ATM pack overtime      : 1000
  seq-number             : disable
  local AC OAM State     : up
  local PSN State        : up
  local forwarding state : forwarding
  local status code      : 0x0
  remote AC OAM state    : up
  remote PSN state       : up
  remote forwarding state: forwarding
  remote status code     : 0x0
  ignore standby state   : no
  BFD for PW             : unavailable
  VCCV State             : up
  manual fault           : not set
  active state           : active
  forwarding entry       : exist
  link state             : up
  local VC MTU           : 1500         remote VC MTU        : 1500
  local VCCV             : cw alert ttl lsp-ping bfd
  remote VCCV            : cw alert ttl lsp-ping bfd
  local control word     : enable       remote control word  : enable
  tunnel policy name     : policy1
  traffic behavior name  : --
  PW template name       : --
  primary or secondary   : primary
  Switchover Flag        : false
  VC tunnel/token info   : 1 tunnels/tokens
    NO.0  TNL type       : cr lsp, TNL ID : 0x800001
    Backup TNL type      : lsp   , TNL ID : 0x0
  create time            : 0 days, 1 hours, 0 minutes, 5 seconds
  up time                : 0 days, 1 hours, 0 minutes, 5 seconds
  last change time       : 0 days, 1 hours, 0 minutes, 5 seconds
  VC last up time        : 2010/11/10 11:16:04
  VC total up time       : 0 days, 1 hours, 0 minutes, 5 seconds
  CKey                   : 4
  NKey                   : 3
  PW redundancy mode     : frr
  AdminPw interface      : --
  AdminPw link state     : --   
<span>  Forward state          : send inactive, receive inactive </span>
</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172369978__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>Configuration file of the CSG</p>
<pre class="screen">#
sysname CSG
#
mpls lsr-id 1.1.1.1
#
mpls
 mpls te
 mpls rsvp-te
 mpls te cspf
#
mpls l2vpn
#
mpls ldp
#
#
mpls ldp remote-peer 2.2.2.2
 remote-ip 2.2.2.2
#
interface Atm-Bundle1
 mpls l2vc 2.2.2.2 100 tunnel-policy policy1 control-word
#
interface Atm-Bundle2
 mpls l2vc 2.2.2.2 200 tunnel-policy policy1 control-word
#
interface Serial<span>0/2/0</span>:0
 link-protocol atm
 undo shutdown
#
interface Serial<span>0/2/0</span>:0.1
 pvc 1/33
 atm-bundle 1
#
interface Serial<span>0/2/0</span>:0.2
 pvc 2/33
 atm-bundle 2
#
interface Serial<span>0/2/1</span>:0
 link-protocol atm
 undo shutdown
#
interface Serial<span>0/2/1</span>:0.1
 pvc 3/33
 atm-bundle 1
#
interface Serial<span>0/2/1</span>:0.2
 pvc 4/33
 atm-bundle 2
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.0.1.1 255.255.255.0
 mpls
 mpls te
 mpls rsvp-te
#
interface LoopBack1
 ip address 1.1.1.1 255.255.255.255
#
interface Tunnel11
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 2.2.2.2
 mpls te tunnel-id 100
 mpls te signal-protocol rsvp-te
 mpls te reserved-for-binding
#
ospf 100
 opaque-capability enable
 area 0.0.0.0
  network 1.1.1.1 0.0.0.0
  network 10.0.1.0 0.0.0.255
  mpls-te enable
#
tunnel-policy policy1
 tunnel binding destination 2.2.2.2 te Tunnel11
#
return </pre>
</li><li><p>Configuration file of the RSG</p>
<pre class="screen">#
sysname RSG
#
mpls lsr-id 2.2.2.2
#
mpls
 mpls te
 label advertise non-null
 mpls rsvp-te
 mpls te cspf
#
mpls l2vpn
#
mpls ldp
#
mpls ldp remote-peer 1.1.1.1
 remote-ip 1.1.1.1
#
interface Serial<span>0/2/0</span>:0
 link-protocol atm
 undo shutdown
#
interface Serial<span>0/2/0</span>:0.1
 pvc 1/33
 mpls l2vc 1.1.1.1 100 tunnel-policy policy1 control-word
#
interface Serial<span>0/2/0</span>:0.2
 pvc 2/33
 mpls l2vc 1.1.1.1 200 tunnel-policy policy1 control-word
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.0.1.2 255.255.255.0
 mpls
 mpls te
 mpls rsvp-te
#
interface LoopBack1
 ip address 2.2.2.2 255.255.255.255
#
interface Tunnel11
 ip address unnumbered interface LoopBack1
 tunnel-protocol mpls te
 destination 1.1.1.1
 mpls te tunnel-id 100
 mpls te signal-protocol rsvp-te
 mpls te reserved-for-binding
#
ospf 100
 opaque-capability enable
 area 0.0.0.0
  network 2.2.2.2 0.0.0.0
  network 10.0.1.0 0.0.0.255
  mpls-te enable
#
tunnel-policy policy1
 tunnel binding destination 1.1.1.1 te Tunnel11
#
return </pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_3012.html">Configuration Examples for VPWS
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6009.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6038.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>