
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a VPN Instance on an ASBR">
<meta name="abstract" content="If an ASBR also functions as a PE, you need to configure a VPN instance enabled with the IPv4 address family on the ASBR to manage VPN routes.">
<meta name="description" content="If an ASBR also functions as a PE, you need to configure a VPN instance enabled with the IPv4 address family on the ASBR to manage VPN routes.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0035.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0171.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0039.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,l3vpnvrp,w00556928,l00468467,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="h00847023">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00425560">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369307">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a VPN Instance on an ASBR</title>
</head>
<body><a name="EN-US_TASK_0172369307"></a><a name="EN-US_TASK_0172369307"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a VPN Instance on an ASBR</h1>
<div class="taskbody"><p>If an ASBR also functions as a PE, you need to configure a VPN instance<span> enabled with the IPv4 address family</span> on the ASBR to manage VPN routes.</p>
<div class="steps"><a name="EN-US_TASK_0172369307__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></span></span><p><p>A VPN instance is created, and the VPN instance view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a></span></span><p><p>The IPv4 address family is enabled for the VPN instance, and the VPN instance IPv4 address family view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=route-distinguisher"><b><span class="cmdname">route-distinguisher</span></b></a> <i><span class="varname">route-distinguisher</span></i></span></span><p><p>An RD is configured for the VPN instance<span> IPv4 address family</span>.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=vpn-target"><b><span class="cmdname">vpn-target</span></b></a> <i><span class="varname">vpn-target</span></i> &amp;&lt;1-8&gt; <strong><span>import-extcommunity</span></strong></span></span><p><p>A VPN target is configured for the VPN instance<span> IPv4 address family</span>.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=prefix+limit"><b><span class="cmdname">prefix limit</span></b></a> <i><span class="varname">number</span></i> { <i><span class="varname">alert-percent</span></i> [ <strong><span>route-unchanged</span></strong> ] | <strong><span>simply-alert</span></strong> }</span></span><p><p>The maximum number of route prefixes allowed by <span>the VPN instance IPv4 address family</span> is set.</p>
<p>To prevent a large number of route prefixes from being imported to a VPN instance, configure the maximum number of route prefixes allowed by this VPN instance.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=import+route-policy"><b><span class="cmdname">import route-policy</span></b></a> <i><span class="varname">policy-name</span></i></span></span><p><p>A routing policy for importing VPN routes is configured.</p>
<p>In addition to using VPN targets to control VPN route sending and receiving, an import routing policy can be used to filter routes imported to the VPN instance IPv4 address family or modify route attributes so that VPN route receiving can be better controlled.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=export+route-policy"><b><span class="cmdname">export route-policy</span></b></a> <i><span class="varname">policy-name</span></i><span> [ <strong><span>add-ert-first</span></strong> ]</span></span></span><p><p>A routing policy for exporting VPN routes is configured.</p>
<p>In addition to using VPN targets to control VPN route sending and receiving, an export routing policy can be used to filter routes to be advertised to other PEs or modify route attributes so that VPN route sending can be better controlled.</p>
<p>By default, ERTs are added to VPN routes before these routes are matched against an export routing policy. If the export routing policy contains RT-related filtering rules, these rules cannot apply to these routes. If you want to apply the RT-related filtering rules defined in an export routing policy to VPN routes, run the <strong><span>add-ert-first</span></strong> command to configure the system to add ERTs to VPN routes before matching these routes against the export routing policy.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0035.html">Configuring Inter-AS VPN Option B (ASBR Also Functioning as a PE)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0171.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0039.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>