
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a Remote BGP VPWS Connection">
<meta name="abstract" content="If two CEs connect to different PEs, you can configure a remote BGP VPWS connection for the two CEs to communicate.">
<meta name="description" content="If two CEs connect to different PEs, you can configure a remote BGP VPWS connection for the two CEs to communicate.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6054.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6055.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6057.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="VPWS">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00415692">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00415692">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369812">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a Remote BGP VPWS Connection</title>
</head>
<body><a name="EN-US_TASK_0172369812"></a><a name="EN-US_TASK_0172369812"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a Remote BGP VPWS Connection</h1>
<div class="taskbody"><p>If two CEs connect to different PEs, you can configure a remote BGP VPWS connection for the two CEs to communicate.</p>
<div class="context"><a name="EN-US_TASK_0172369812__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>On the network shown in <a href="#EN-US_TASK_0172369812__fig_dc_vrp_vpws_cfg_605601">Figure 1</a>, CEs connect to different PEs. A remote BGP VPWS connection needs to be established between PEs for the two CEs to communicate.</p>
<div class="fignone" id="EN-US_TASK_0172369812__fig_dc_vrp_vpws_cfg_605601"><a name="EN-US_TASK_0172369812__fig_dc_vrp_vpws_cfg_605601"></a><a name="fig_dc_vrp_vpws_cfg_605601"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring a remote BGP VPWS connection</span><br><span><img class="vsd" src="images/fig_dc_vrp_vpws_cfg_605601.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172369812__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure MPLS L2VPN.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mpls+l2vpn"><b><span class="cmdname">mpls l2vpn</span></b></a></span><p><p>MPLS L2VPN is configured.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0172369812__dc_vrp_vpws_cfg_6056_step02"><span id="EN-US_TASK_0172369812__cmd163330964214052">Enable BGP peers to exchange VPWS information.</span><ol type="a" id="EN-US_TASK_0172369812__substeps1455232357214052"><li class="substepexpand" id="EN-US_TASK_0172369812__substep1018221778214052"><span id="EN-US_TASK_0172369812__cmd1807873153214342">Run <a href="cmdqueryname=bgp"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname559023497214342">bgp</span></b></a> <i><span class="varname" id="EN-US_TASK_0172369812__varname18517195725713">as-number</span></i></span><p><p id="EN-US_TASK_0172369812__p998893896214342">The BGP view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172369812__substep375634012214052"><span id="EN-US_TASK_0172369812__cmd944460453214342">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname1427374350214052">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0172369812__varname31137107556">ipv4-address</span></i> <strong><span id="EN-US_TASK_0172369812__cmdparmname561753478214052">as-number</span></strong> <span><em id="EN-US_TASK_0172369812__i1292820443484">peer-as</em></span></span><p><p id="EN-US_TASK_0172369812__p1184369911214342">A BGP peer and its AS number are specified.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172369812__substep1674313060214052"><span id="EN-US_TASK_0172369812__cmd1197365435214342">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname640747090214342">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0172369812__varname826738153214342">ipv4-address</span></i> <strong><span id="EN-US_TASK_0172369812__cmdparmname1006078213214342">connect-interface</span></strong> <i><span class="varname" id="EN-US_TASK_0172369812__varname616903905214342">interface-type</span></i> <i><span class="varname" id="EN-US_TASK_0172369812__varname1934666234214342">interface-number</span></i></span><p><p id="EN-US_TASK_0172369812__p970539791214342">The source interface for sending BGP packets is specified.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172369812__substep1003560743214052"><span id="EN-US_TASK_0172369812__cmd536128089214342">Run <a href="cmdqueryname=l2vpn-ad-family"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname916229158214342">l2vpn-ad-family</span></b></a></span><p><p id="EN-US_TASK_0172369812__p405468236214342">The L2VPN-AD address family view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172369812__substep5067082214052"><span id="EN-US_TASK_0172369812__cmd2044630903214342">(Optional) Run <a href="cmdqueryname=vpn-orf+enable"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname496577095214342">vpn-orf enable</span></b></a></span><p><p id="EN-US_TASK_0172369812__p283281460214342">ORF is enabled.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172369812__substep1992902042214052"><span id="EN-US_TASK_0172369812__cmd1834565040214342">Run <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname294085044214342">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0172369812__varname911307284214342">ipv4-address</span></i> <strong><span id="EN-US_TASK_0172369812__cmdparmname2030447181214342">enable</span></strong></span><p><p id="EN-US_TASK_0172369812__p921798149214342">The route exchange capability is enabled.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172369812__substep211677519214052"><span id="EN-US_TASK_0172369812__cmd632178679214342">Run <a href="cmdqueryname=signaling+vpws"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname924761189214342">signaling vpws</span></b></a> or <a href="cmdqueryname=peer"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname360362825214342">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0172369812__varname1054924229214342">ip-address</span></i> <strong><span id="EN-US_TASK_0172369812__cmdparmname2029140150214342">signaling</span></strong> <strong><span id="EN-US_TASK_0172369812__cmdparmname1760137838214342">vpws</span></strong></span><p><p id="EN-US_TASK_0172369812__p1293117607214342">BGP VPWS is enabled.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172369812__substep5020275214052"><span id="EN-US_TASK_0172369812__cmd280085845214342">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname329624000214342">quit</span></b></a></span><p><p id="EN-US_TASK_0172369812__p182826123214342">Return to the BGP view.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172369812__substep1955640728214052"><span id="EN-US_TASK_0172369812__cmd1025396494214342">Run <a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname486464006214342">quit</span></b></a></span><p><p id="EN-US_TASK_0172369812__p1133677288214342">Return to the system view.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0172369812__dc_vrp_vpws_cfg_6056_step03"><span id="EN-US_TASK_0172369812__cmd1018225887214052">Configure a remote VPWS connection.</span><ol type="a" id="EN-US_TASK_0172369812__substeps888969098214052"><li class="substepexpand" id="EN-US_TASK_0172369812__substep1886662286214052"><span id="EN-US_TASK_0172369812__cmd469012218305">Run <a href="cmdqueryname=mpls+l2vpn"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname1044209470214052">mpls l2vpn</span></b></a> <i><span class="varname" id="EN-US_TASK_0172369812__varname39631559214052">l2vpn-name</span></i> [ <strong><span id="EN-US_TASK_0172369812__cmdparmname1948382855214052">encapsulation</span></strong> <i><span class="varname" id="EN-US_TASK_0172369812__varname1485196743214052">encapsulation-type</span></i> [ <strong><span id="EN-US_TASK_0172369812__cmdparmname1259287932214052">control-word</span></strong> | <strong><span id="EN-US_TASK_0172369812__cmdparmname1278133075214052">no-control-word</span></strong> ] ]</span><p><p id="EN-US_TASK_0172369812__p18582655172910">A BGP VPWS VPN instance is created, and the MPLS L2VPN instance view is displayed.</p>
</p><p><p id="EN-US_TASK_0172369812__p259888634214052">If heterogeneous interworking is required, specify <i><span class="varname" id="EN-US_TASK_0172369812__varname127708446409">encapsulation-type</span></i> as <strong><span id="EN-US_TASK_0172369812__cmdparmname1877004415409">ip-interworking</span></strong> for successful PW establishment.</p>
</p><p></p></li><li class="substepexpand" id="EN-US_TASK_0172369812__substep96716329214052"><span id="EN-US_TASK_0172369812__cmd424402642214342">Run <span><a href="cmdqueryname=route-distinguisher"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname104868801214342">route-distinguisher</span></b></a> <i><span class="varname" id="EN-US_TASK_0172369812__varname360373145214342">route-distinguisher</span></i></span></span><p><p id="EN-US_TASK_0172369812__p1064976480214342">An RD is configured for the MPLS L2VPN instance.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172369812__substep1369613206214052"><span id="EN-US_TASK_0172369812__cmd211941049214052">(Optional) Run <a href="cmdqueryname=mtu"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname1216804908214342">mtu</span></b></a> <i><span class="varname" id="EN-US_TASK_0172369812__varname1197947476214342">mtu-value</span></i></span><p><p id="EN-US_TASK_0172369812__p580119172213">An MTU is configured for the MPLS L2VPN instance.</p>
</p><p><p id="EN-US_TASK_0172369812__p81821213132115">The MTU size determines the maximum packet size allowed by a VPWS network. If the MTU exceeds the maximum packet size allowed by a VPWS network or an intermediate node (P), packet fragmentation or even drop will occur, affecting network transmission. The MTU is one of the VPWS negotiation parameters. If the MTUs of the same MPLS L2VPN instance on the endpoint PEs are different, the two PEs cannot exchange reachability information or establish a PW. An appropriate MTU must be set for an MPLS L2VPN instance based on the MTU of the interface bound to the instance. Specifically, the MTU of an MPLS L2VPN instance must be smaller than or equal to the MTU of the interface bound to the instance.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172369812__substep27040758214052"><span id="EN-US_TASK_0172369812__cmd173353123214342">(Optional) Run <a href="cmdqueryname=ignore-mtu-match"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname768649305214342">ignore-mtu-match</span></b></a></span><p><p id="EN-US_TASK_0172369812__p303047755214342">The current device is configured not to perform the MTU match check for the MPLS L2VPN instance.</p>
</p><p><p id="EN-US_TASK_0172369812__p866413234214052">If the MTUs of the same MPLS L2VPN instance on the two endpoint PEs do not match, the VC cannot go up. If devices provided by other vendors do not support the MTU match check function provided by the MPLS L2VPN instance, run the <strong id="EN-US_TASK_0172369812__b630211326576">ignore-mtu-match</strong> command to disable this function.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172369812__substep159606004214052"><span id="EN-US_TASK_0172369812__cmd1028371269214342">Run <a href="cmdqueryname=vpn-target"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname164672830214052">vpn-target</span></b></a> { <i><span class="varname" id="EN-US_TASK_0172369812__varname1651238688214052">vpn-target</span></i> } &amp; &lt;1-16&gt; [ <strong><span id="EN-US_TASK_0172369812__cmdparmname2011683289214052">both</span></strong> | <strong><span id="EN-US_TASK_0172369812__cmdparmname1587439544214052">export-extcommunity</span></strong> | <strong><span id="EN-US_TASK_0172369812__cmdparmname234626816214052">import-extcommunity</span></strong> ]</span><p><p id="EN-US_TASK_0172369812__p1457944472214342">VPN targets are configured.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172369812__substep1252269320214052"><span id="EN-US_TASK_0172369812__cmd1391104904214342">Run <a href="cmdqueryname=ce"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname29109499214052">ce</span></b></a> <span><em id="EN-US_TASK_0172369812__i11884120545">ce-Name</em></span> [ <strong><span id="EN-US_TASK_0172369812__cmdparmname462693304214052">id</span></strong> <i><span class="varname" id="EN-US_TASK_0172369812__varname99652811214052">ce-id</span></i> [ <strong><span id="EN-US_TASK_0172369812__cmdparmname780171685214052">range</span></strong> <i><span class="varname" id="EN-US_TASK_0172369812__varname884477586214052">ce-range</span></i> ] [ <strong><span id="EN-US_TASK_0172369812__cmdparmname738337541214052">default-offset</span></strong> <i><span class="varname" id="EN-US_TASK_0172369812__varname1193987068214052">ce-offset</span></i> ] ]</span><p><p id="EN-US_TASK_0172369812__p807982649214342">A CE is created in the MPLS L2VPN instance.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172369812__substep1555241663214052"><span id="EN-US_TASK_0172369812__cmd1685122669214342">Run <a href="cmdqueryname=connection"><b><span class="cmdname" id="EN-US_TASK_0172369812__cmdname532359758214342">connection</span></b></a> [ <strong><span id="EN-US_TASK_0172369812__cmdparmname1003433032214342">ce-offset</span></strong> <i><span class="varname" id="EN-US_TASK_0172369812__varname956702003214342">ce-offset-id</span></i> ] <strong><span id="EN-US_TASK_0172369812__cmdparmname475557344214342">interface</span></strong> <strong><span id="EN-US_TASK_0172369812__cmdparmname290628092214342">interface-type</span></strong> <i><span class="varname" id="EN-US_TASK_0172369812__varname203125665214342">interface-number</span></i> [ <strong><span id="EN-US_TASK_0172369812__cmdparmname1177691594214342">tunnel-policy</span></strong> <i><span class="varname" id="EN-US_TASK_0172369812__varname710285070214342">tunnel-policy-name</span></i> ] [ <strong><span id="EN-US_TASK_0172369812__cmdparmname360072297214342">raw</span></strong> | <strong><span id="EN-US_TASK_0172369812__cmdparmname2122123360214342">tagged</span></strong> ] [ <strong><span id="EN-US_TASK_0172369812__cmdparmname365945145214342">secondary</span></strong> ]</span><p><p id="EN-US_TASK_0172369812__p2031617649214342">A remote BGP VPWS connection is configured.</p>
</p></li></ol>
</li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6054.html">Configuring BGP VPWS
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6055.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vpws_cfg_6057.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>