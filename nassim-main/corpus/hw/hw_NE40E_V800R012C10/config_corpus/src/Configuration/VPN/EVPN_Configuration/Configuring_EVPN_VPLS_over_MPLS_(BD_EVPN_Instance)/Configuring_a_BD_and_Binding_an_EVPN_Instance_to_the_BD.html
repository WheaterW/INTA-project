
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a BD and Binding an EVPN Instance to the BD">
<meta name="abstract" content="An EVPN instance in BD mode is only bound to a BD instead of an interface.">
<meta name="description" content="An EVPN instance in BD mode is only bound to a BD instead of an interface.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0065.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0064.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0006bd.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00878323">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172370454">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a BD and Binding an EVPN Instance to the BD</title>
</head>
<body><a name="EN-US_TASK_0172370454"></a><a name="EN-US_TASK_0172370454"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a BD and Binding an EVPN Instance to the BD</h1>
<div class="taskbody"><p>An EVPN instance in BD mode is only bound to a BD instead of an interface.</p>
<div class="context"><a name="EN-US_TASK_0172370454__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>An EVPN instance can be bound to a BD in two ways: using a VXLAN Network Identifier (VNI) and using MPLS. In VNI mode, an EVPN instance is bound to a BD after a VNI is configured. In MPLS mode, an EVPN instance is bound to a BD directly in the BD view. If an EVPN instance needs to access a VPLS network, the EVPN instance must be bound to a BD in VNI mode.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172370454__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=bridge-domain"><b><span class="cmdname">bridge-domain</span></b></a> <i><span class="varname">bd-id</span></i></span><p><p>The view of the BD to be bound to an EVPN instance is displayed.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=vxlan+vni"><b><span class="cmdname">vxlan vni</span></b></a> <i><span class="varname">vni-id</span></i> <strong><span>split-horizon-mode</span></strong></span><p><p>A VNI is created and associated with the BD, and split horizon is specified for packet forwarding.</p>
</p></li><li><span>Run <a href="cmdqueryname=evpn+binding+vpn-instance"><b><span class="cmdname">evpn binding vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i><span> [ <strong><span>bd-tag</span></strong> <i><span class="varname">bd-tag</span></i> ]</span></span><p><p>The BD is bound to the EVPN instance. <span>By specifying different <i><span class="varname">bd-tag</span></i> values, you can bind multiple BDs to the same EVPN instance. In this way, VLAN services of different BDs can access the same EVPN instance while being isolated.</span></p>
</p></li><li><span>(Optional) Configure the EVPN route learning mode as <strong>qualify</strong>.</span><ol type="a"><li class="substepexpand"><span>Run the <a href="cmdqueryname=mac-learn-style+qualify"><b><span class="cmdname">mac-learn-style qualify</span></b></a> command to configure the MAC address learning mode as <strong>qualify</strong>.</span><p><p>If no MAC address learning mode is configured, each MAC address is unique in the BD, and the device learns MAC addresses based on BDs. VLAN-based differentiation is not needed in this case. If users need to be differentiated based on VLANs, perform this step to set the MAC address learning mode to <strong>qualify</strong>, so that each VLAN has its own MAC address space. The device learns MAC addresses based on both MAC addresses and VLAN tags carried in user Ethernet packets.</p>
</p></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=evpn+qualify-compatible"><b><span class="cmdname">evpn qualify-compatible</span></b></a> command to configure EVPN qualify enhancement.</span><p><p>After this function is configured, EVPN Ethernet A-D per-EVI, EVPN inclusive, and EVPN UMR routes are generated based on VLANs.</p>
</p></li></ol>
<p><p>This step is recommended when the VLAN-aware service model is used on the user side for EVPN access.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=reserve-interface+fast-switch+enable"><b><span class="cmdname">reserve-interface fast-switch enable</span></b></a></span><p><p>The reserve-interface fast switching function is enabled.</p>
<p>When the active interface board fails, you can perform this step to enable reserve-interface fast switching, so that broadcast traffic can be quickly switched to the standby interface board.</p>
</p></li><li><span>(Optional) Enable the function to apply the DF election result of a BD to all AC interfaces in the BD.</span><p><ol type="a"><li>Run the <a href="cmdqueryname=evpn+df-result+spread+enable"><b><span class="cmdname">evpn df-result spread enable</span></b></a> command to enable the function to apply the DF election result of a BD to all AC interfaces in the BD.</li><li>Run the <a href="cmdqueryname=esi"><b><span class="cmdname">esi</span></b></a> <em>esi</em> command to configure an ESI for the BD.</li><li>Run the <a href="cmdqueryname=timer+es-recovery"><b><span class="cmdname">timer es-recovery</span></b></a> <em>seconds</em> command to configure a delay after which Ethernet segment routes are advertised to prevent traffic loss during traffic switchback.</li></ol>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type interface-number.subnum</span></i> <strong><span>mode l2</span></strong></span><p><p>A Layer 2 sub-interface is created, and the Layer 2 sub-interface view is displayed.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Before running this command, ensure that the involved Layer 2 main interface does not have the <a href="cmdqueryname=port+link-type"><b><span class="cmdname">port link-type</span></b></a> <strong><span>dot1q-tunnel</span></strong> command configuration. If the configuration exists, run the <a href="cmdqueryname=undo+port+link-type"><b><span class="cmdname">undo port link-type</span></b></a> command to delete it.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=encapsulation"><b><span class="cmdname">encapsulation</span></b></a> { <strong><span>dot1q</span></strong> [ <strong><span>vid</span></strong> <i><span class="varname">low-pe-vid</span></i> [ <strong><span>to</span></strong> <i><span class="varname">high-pe-vid</span></i> ] ] | <strong><span>untag</span></strong> | <strong><span>qinq</span></strong> [ <strong><span>vid</span></strong> <i><span class="varname">pe-vid</span></i> <strong><span>ce-vid</span></strong> { <i><span class="varname">low-ce-vid</span></i> [ <strong><span>to</span></strong> <i><span class="varname">high-ce-vid</span></i> ] | <strong><span>default</span></strong> } ] }, </span><p><p>A traffic encapsulation type is specified for the Layer 2 sub-interface.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the MAC address learning mode is <strong>qualify</strong>, <strong>ce-vid</strong> used in QinQ encapsulation cannot be <strong>default</strong>.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=rewrite+pop"><b><span class="cmdname">rewrite pop</span></b></a> { <strong><span>single</span></strong> | <strong><span>double</span></strong> }</span><p><p>The function to remove VLAN tags from received packets is enabled.For single-tagged packets that a Layer 2 sub-interface receives, specify <strong><span>single</span></strong> to enable the sub-interface to remove single VLAN tags from these packets.</p>
<p>If the encapsulation type of packets has been set to QinQ in the previous step, specify <strong><span>double</span></strong> to enable the sub-interface to remove double VLAN tags from the received packets.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the current MAC address learning mode is <strong>qualify</strong>, this step cannot be performed.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=bridge-domain"><b><span class="cmdname">bridge-domain</span></b></a> <i><span class="varname">bd-id</span></i></span><p><p>The Layer 2 sub-interface is added to the BD to transmit data packets through this BD.</p>
</p><p></p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0065.html">Configuring EVPN VPLS over MPLS (BD EVPN Instance)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0064.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0006bd.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>