
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring an ESI">
<meta name="abstract" content="An ESI must be configured for a PE interface connecting to a CE or the BD to which such an interface is bound. The PE interfaces connecting to the same CE or the BDs to which such interfaces are bound must have the same ESI configured.">
<meta name="description" content="An ESI must be configured for a PE interface connecting to a CE or the BD to which such an interface is bound. The PE interfaces connecting to the same CE or the BDs to which such interfaces are bound must have the same ESI configured.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0065.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0012bd.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0062.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="EVPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00878323">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172370453">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring an ESI</title>
</head>
<body><a name="EN-US_TASK_0172370453"></a><a name="EN-US_TASK_0172370453"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring an ESI</h1>
<div class="taskbody"><p>An ESI must be configured for a PE interface connecting to a CE or the BD to which such an interface is bound. The PE interfaces connecting to the same CE or the BDs to which such interfaces are bound must have the same ESI configured.</p>
<div class="context"><a name="EN-US_TASK_0172370453__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>After PEs exchange routes that carry ESIs, a PE learns about other PEs connecting to the same CE as itself, helping implement load balancing or FRR.</p>
<p>The interface with an ESI configured is in the up state. Otherwise, Ethernet segment routes cannot be generated. </p>
<div class="p">An ESI can be obtained for an interface in the following ways:<ul><li><p>Static ESI configuration</p>
</li><li><p>Dynamic ESI generation</p>
</li></ul>
</div>
<p>Static ESI configuration is recommended. Compared with dynamic ESI generation, static configuration allows EVPN to implement faster traffic switching during a DF election in a dual-homing scenario with active-active PEs.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The features required in an EVPN dual-homing scenario, such as fast convergence, split horizon, and DF election, all become invalid in a single-homing scenario. In such a scenario, configuring an ESI is optional on the single-homing PE.</p>
</div></div>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172370453__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure an interface to dynamically generate an ESI.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <strong><span>eth-trunk</span></strong> <i><span class="varname">trunk-id</span></i></span><p><p>The Eth-Trunk interface view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=mode"><b><span class="cmdname">mode</span></b></a> <strong><span>lacp-static</span></strong></span><p><p>The working mode of the Eth-Trunk interface is set to static LACP.</p>
</p><p><p>After this command is run in the Eth-Trunk interface view, a dynamic ESI is automatically generated.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=ignore+dynamic-esi"><b><span class="cmdname">ignore dynamic-esi</span></b></a></span><p><p>The device is configured to ignore dynamically generated ESIs.</p>
</p><p><p>After the <a href="cmdqueryname=mode"><b><span class="cmdname">mode</span></b></a> <strong><span>lacp-static</span></strong> command is run on an interface, an ESI is dynamically generated by default. In a single-homing scenario, ESIs are not required. To enable an interface to ignore dynamically generated ESIs, run this command. In an EVPN VPLS scenario, no ESIs are generated for Ethernet A-D and Ethernet segment routes, and MAC routes carry all-0 ESIs.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Statically configure an ESI for an interface.</span><p><p>Perform this configuration if a VLAN is used to access an EVPN.</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span><p><p>The interface view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=esi"><b><span class="cmdname">esi</span></b></a> <i><span class="varname">esi</span></i></span><p><p>An ESI is configured.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Manually configure an ESI in a BD.</span><p><p>Perform this configuration if VXLAN is used to access an EVPN and the EVPN transmits ARP or MAC routes.</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bridge-domain"><b><span class="cmdname">bridge-domain</span></b></a> <i><span class="varname">bd-id</span></i></span><p><p>The BD view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=esi"><b><span class="cmdname">esi</span></b></a> <i><span class="varname">esi</span></i></span><p><p>An ESI is configured.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0065.html">Configuring EVPN VPLS over MPLS (BD EVPN Instance)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0012bd.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evpn_cfg_0062.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>