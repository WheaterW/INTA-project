
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring VPN FRR">
<meta name="abstract" content="If a CE is multi-homed to two PEs, you can configure VPN FRR to ensure that VPN services are switched to a standby link if the active link between PEs fails.">
<meta name="description" content="If a CE is multi-homed to two PEs, you can configure VPN FRR to ensure that VPN services are switched to a standby link if the active link between PEs fails.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_2061.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_2012.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,l3vpnvrp,w00556928,l00468467,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="BGP/MPLS IP VPN">
<meta name="featuretype" content="VPN">
<meta name="OWNER" content="h00847023">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00847023">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172369417">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring VPN FRR</title>
</head>
<body><a name="EN-US_TASK_0172369417"></a><a name="EN-US_TASK_0172369417"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring VPN FRR</h1>
<div class="taskbody"><p>If a CE is multi-homed to two PEs, you can configure VPN FRR to ensure that VPN services are switched to a standby link if the active link between PEs fails.</p>
<div class="context"><a name="EN-US_TASK_0172369417__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>VPN FRR applies to services that are sensitive to packet loss and delay on VPN networks. As shown in <a href="dc_vrp_mpls-l3vpn-v4_cfg_2017.html#EN-US_TASK_0172369417__fig_dc_vrp_mpls-l3vpn-v4_cfg_201701">Figure 1</a>, CE1 is dual-homed to PE2 and PE3. VPN FRR is configured on PE1. If the link between PE1 and PE2 fails, VPN traffic needs to be rapidly switched to the link between PE1 and PE3.</p>
<div class="fignone" id="EN-US_TASK_0172369417__fig_dc_vrp_mpls-l3vpn-v4_cfg_201701"><a name="EN-US_TASK_0172369417__fig_dc_vrp_mpls-l3vpn-v4_cfg_201701"></a><a name="fig_dc_vrp_mpls-l3vpn-v4_cfg_201701"></a><span class="figcap"><b>Figure 1 </b>VPN FRR</span><br><span><img class="vsd" src="figure/en-us_image_0258271906.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369417__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Prerequisites</h4><p>Before configuring VPN FRR, complete the following tasks:</p>
<ul><li><p>Configure a routing protocol on the <span class="keyword">Router</span>s to implement network connectivity.</p>
</li><li><p>Configure PE1 to ensure that two unequal-cost routes destined for the CE are available.</p>
</li><li><p>Set up a VPN network.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172369417__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Background</h4><p>You can enable VPN FRR in either the VPN instance IPv4 address family view or the BGP-VPN instance IPv4 address family view as needed. For example, if only BGP VPNv4 peers are configured on a device but no BGP-VPN instance is configured, you need to enable VPN FRR in the VPN instance IPv4 address family view.</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172369417__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Enable VPN FRR in the VPN instance IPv4 address family view.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></span><p><p>The VPN instance view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a></span><p><p>The VPN instance IPv4 address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=vpn+frr"><b><span class="cmdname">vpn frr</span></b></a></span><p><p>VPN FRR is enabled.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the VPN instance view.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a> <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i></span><p><p>The BGP-VPN instance IPv4 address family view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=route-select+delay"><b><span class="cmdname">route-select delay</span></b></a> <i><span class="varname">delay-value</span></i></span><p><p>A route selection delay is set. After the active path recovers, an appropriate delay ensures that traffic switches back to the active path after the intermediate devices refresh forwarding entries and the entries become stable, preventing packet loss during a traffic switchback.</p>
<p>The <i><span class="varname">delay-value</span></i> value is an integer ranging from 0 to 3600, in seconds. </p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Enable VPN FRR in the BGP-VPN instance IPv4 address family view.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a> <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i></span><p><p>The BGP-VPN instance IPv4 address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=auto-frr"><b><span class="cmdname">auto-frr</span></b></a></span><p><p>VPN FRR is enabled.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=route-select+delay"><b><span class="cmdname">route-select delay</span></b></a> <i><span class="varname">delay-value</span></i></span><p><p>A route selection delay is set. After the active path recovers, an appropriate delay ensures that traffic switches back to the active path after the intermediate devices refresh forwarding entries and the entries become stable, preventing packet loss during a traffic switchback.</p>
</p><p><p>The <i><span class="varname">delay-value</span></i> value is an integer ranging from 0 to 3600, in seconds. </p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
<div class="example"><a name="EN-US_TASK_0172369417__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After configuring VPN FRR, you can run the <a href="cmdqueryname=display+ip+routing-table+vpn-instance"><b><span class="cmdname">display ip routing-table vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i> [ <i><span class="varname">ip-address</span></i> ] <strong><span>verbose</span></strong> command to check the backup next hop (PE), backup tunnel, and backup label in the routing table of the VPN instance<span> IPv4 address family</span>.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_0000.html">BGP/MPLS IP VPN Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_2061.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mpls-l3vpn-v4_cfg_2012.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>