
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring OSPF Virtual Links">
<meta name="abstract" content="This section describes how to configure virtual links to connect a non-backbone area to the backbone area.">
<meta name="description" content="This section describes how to configure virtual links to connect a non-backbone area to the backbone area.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0093.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0094.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0095.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="ospf,w00800033,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00875216">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="ccms">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172365649">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring OSPF Virtual Links</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172365649"></a><a name="EN-US_TASK_0172365649"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring OSPF Virtual Links</h1>
<div class="taskbody"><p>This section describes how to configure virtual links to connect a non-backbone area to the backbone area.</p>
<div class="context"><a name="EN-US_TASK_0172365649__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0172365649__fig_dc_vrp_ospf_cfg_205401">Figure 1</a>, Area 2 is not directly connected to the backbone area Area 0. Area 1 serves as a transit area to connect Area 2 and Area 0. A virtual link is configured between <span class="keyword">Device</span>A and <span class="keyword">Device</span>B.</p>
<div class="fignone" id="EN-US_TASK_0172365649__fig_dc_vrp_ospf_cfg_205401"><a name="EN-US_TASK_0172365649__fig_dc_vrp_ospf_cfg_205401"></a><a name="fig_dc_vrp_ospf_cfg_205401"></a><span class="figcap"><b>Figure 1 </b>Networking for configuring an OSPF virtual links</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent GE <span>0/1/0</span> and GE <span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_ospf_cfg_205401.png" width="NaN" height="NaN"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365649__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>The default value is recommended when a virtual link is created. You can modify the value in actual scenarios.</p>
<p>Suggestions for configuring parameters are as follows:</p>
<ul><li>The smaller the <a href="cmdqueryname=hello"><b><span class="cmdname">hello</span></b></a> parameter, the more rapidly a <span class="keyword">Router</span> detects network topology change, the more network resources are consumed.</li><li>If the <a href="cmdqueryname=retransmit"><b><span class="cmdname">retransmit</span></b></a> parameter is set too small, LSAs may be retransmitted. Setting the parameter to a large value is recommended in a low-speed network.</li><li>The authentication modes of a virtual link and the backbone area must be the same.</li><li>To improve security, OSPF area authentication or interface authentication is recommended. For details, see "Improving OSPF Network Security". OSPF area authentication is used as an example. For details, see Example for Configuring Basic OSPF Functions.</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365649__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure basic OSPF functions on each <span class="keyword">Router</span>.</p>
</li><li><p>Configure a virtual link between <span class="keyword">Device</span>A and <span class="keyword">Device</span>B to connect a non-backbone area to the backbone area.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365649__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary=""><tr><td valign="top"><p>Device Name</p>
</td>
<td valign="top"><p>Router ID</p>
</td>
<td valign="top"><p>Process ID</p>
</td>
<td valign="top"><p>IP Address</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span>A</p>
</td>
<td valign="top"><p>1.1.1.1</p>
</td>
<td valign="top"><p>1</p>
</td>
<td valign="top"><p>Area 0: 10.0.0.0/8</p>
<p>Area 1: 192.168.1.0/24</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span>B</p>
</td>
<td valign="top"><p>2.2.2.2</p>
</td>
<td valign="top"><p>1</p>
</td>
<td valign="top"><p>Area 1: 192.168.1.0/24</p>
<p>Area 2: 172.16.0.0/16</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span>C</p>
</td>
<td valign="top"><p>3.3.3.3</p>
</td>
<td valign="top"><p>1</p>
</td>
<td valign="top"><p>Area 0: 10.0.0.0/8</p>
</td>
</tr>
<tr><td valign="top"><p><span class="keyword">Device</span>D</p>
</td>
<td valign="top"><p>4.4.4.4</p>
</td>
<td valign="top"><p>1</p>
</td>
<td valign="top"><p>Area 2: 172.16.0.0/16</p>
</td>
</tr>
</table></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172365649__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface according to <a href="#EN-US_TASK_0172365649__section_dc_vrp_ospf_cfg_205406">Configuration Files</a>. For configuration details, see Configuration Files in this section.</span></li><li><span>Configure basic OSPF functions.</span><p><p><a href="dc_vrp_ospf_cfg_0003.html">Configuring Basic OSPF Functions</a> shows how to configure basic OSPF functions. For configuration details, see Configuration Files in this section.</p>
</p></li><li><span>Check the OSPF routes on <span class="keyword">Device</span>A</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> display ospf routing</strong></pre>
<pre class="screen">          OSPF Process 1 with Router ID 1.1.1.1
                   Routing Tables

 Routing for Network
 Destination        Cost       Type       NextHop         AdvRouter       Area
 10.0.0.0/8         1          Transit    10.1.1.1        3.3.3.3         0.0.0.0
 192.168.1.0/24     1          Transit    192.168.1.1     1.1.1.1         0.0.0.1

 Total Nets: 2
 Intra Area: 2  Inter Area: 0  ASE: 0  NSSA: 0    </pre>
<p>The routing table on <span class="keyword">Device</span> A contains no route in Area 2 because Area 2 is not directly connected to Area 0.</p>
</p></li><li><span>Configure an OSPF virtual link.</span><p><p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> router id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1]<strong> area 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1-area-0.0.0.1]<strong> vlink-peer 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1-area-0.0.0.1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> commit</strong></pre>
<p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> router id 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1]<strong> area 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.1]<strong> vlink-peer 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Display the OSPF vlink on <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> display ospf vlink</strong></pre>
<pre class="screen">          OSPF Process 1 with Router ID 1.1.1.1
                  Virtual Links
 Virtual-link Neighbor-id  -&gt; 2.2.2.2, Neighbor-State: <strong>Full</strong>
 Interface: 192.168.1.1 (GigabitEthernet<span>0/1/0</span>)
 Cost: 1  State: P-2-P  Type: Virtual
 Transit Area: 0.0.0.1
 Timers: Hello 10 , Dead 40 , Retransmit 5 , Transmit Delay 1
 GR State: Normal</pre>
<p>The preceding command output shows that the OSPF vlink neighbor status is "Full".</p>
<p># Display the OSPF routes on <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> display ospf routing</strong></pre>
<pre class="screen">          OSPF Process 1 with Router ID 1.1.1.1
                   Routing Tables

 Routing for Network
 Destination        Cost       Type       NextHop         AdvRouter       Area
<strong> 172.16.0.0/16      2          Inter-area 192.168.1.2     2.2.2.2         0.0.0.2</strong>
 10.0.0.0/8         1          Transit    10.1.1.1        1.1.1.1         0.0.0.0
 192.168.1.0/24     1          Transit    192.168.1.1     1.1.1.1         0.0.0.1

 Total Nets: 3
 Intra Area: 2  Inter Area: 1  ASE: 0  NSSA: 0    </pre>
<p>After the virtual link is configured, the routing table on <span class="keyword">Device</span>A contains routes in Area 2.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172365649__section_dc_vrp_ospf_cfg_205406"><a name="EN-US_TASK_0172365649__section_dc_vrp_ospf_cfg_205406"></a><a name="section_dc_vrp_ospf_cfg_205406"></a><a name="EN-US_TASK_0172365649__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span>A configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>A</pre>
<pre class="screen">#</pre>
<pre class="screen">router id 1.1.1.1</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 192.168.1.1 255.255.255.0</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.1.1.1 255.0.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 10.0.0.0 0.255.255.255</pre>
<pre class="screen"> area 0.0.0.1</pre>
<pre class="screen">  network 192.168.1.0 0.0.0.255</pre>
<pre class="screen">  vlink-peer 2.2.2.2</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p><span class="keyword">Device</span>B configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>B</pre>
<pre class="screen">#</pre>
<pre class="screen">router id 2.2.2.2</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 192.168.1.2 255.255.255.0</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 172.16.1.1 255.255.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.1</pre>
<pre class="screen">  network 192.168.1.0 0.0.0.255</pre>
<pre class="screen">  vlink-peer 1.1.1.1</pre>
<pre class="screen"> area 0.0.0.2</pre>
<pre class="screen">  network 172.16.0.0 0.0.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p><span class="keyword">Device</span>C configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>C</pre>
<pre class="screen">#</pre>
<pre class="screen">router id 3.3.3.3</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 10.1.1.2 255.0.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.0</pre>
<pre class="screen">  network 10.0.0.0 0.255.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li><li><p><span class="keyword">Device</span>D configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>D</pre>
<pre class="screen">#</pre>
<pre class="screen">router id 4.4.4.4</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/2/0</span></pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> ip address 172.16.1.2 255.255.0.0</pre>
<pre class="screen">#</pre>
<pre class="screen">ospf 1</pre>
<pre class="screen"> area 0.0.0.2</pre>
<pre class="screen">  network 172.16.0.0 0.0.255.255</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0093.html">Configuration Examples for OSPF
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0094.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0095.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>