
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring OSPFv3 Delay Reporting to BGP-LS">
<meta name="abstract" content="OSPFv3 delay is reported to BGP-LS, which summarizes the topology information collected by IGPs and sends the information to the upper-layer controller for delay-based path computation.">
<meta name="description" content="OSPFv3 delay is reported to BGP-LS, which summarizes the topology information collected by IGPs and sends the information to the upper-layer controller for delay-based path computation.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_2062.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_2093.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_2195.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00875216">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00875216">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001579446269">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring OSPFv3 Delay Reporting to BGP-LS</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001579446269"></a><a name="EN-US_TASK_0000001579446269"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring OSPFv3 Delay Reporting to BGP-LS</h1>
<div class="taskbody"><p>OSPFv3 delay is reported to BGP-LS, which summarizes the topology information collected by IGPs and sends the information to the upper-layer controller for delay-based path computation.</p>
<div class="context"><a name="EN-US_TASK_0000001579446269__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><div class="p">BGP-LS is a new method of collecting network topology information. The topology information discovered by IGPs is summarized and reported to an upper-layer controller through BGP. With powerful routing capabilities of BGP, BGP-LS has the following advantages:<ul><li>Lowers the requirements on the controller's computing capabilities and no longer requires IGP capabilities on the controller.</li><li>Facilitates route selection and computation on the controller by using BGP to summarize process or AS topology information and report the complete information to the controller.</li><li>Requires only one routing protocol (BGP) to report topology information to the controller.</li></ul>
</div>
<p>In <a href="#EN-US_TASK_0000001579446269__fig_dc_vrp_bgp_cfg_409701">Figure 1</a>, <span class="keyword">Device</span>C is connected to the controller and reports topology information to the controller. <span class="keyword">Device</span>A, <span class="keyword">Device</span>B, <span class="keyword">Device</span>C, and <span class="keyword">Device</span>D use OSPFv3 to implement IP network interworking. The two interfaces connecting <span class="keyword">Device</span>C and <span class="keyword">Device</span>D belong to area 20, and the interfaces connecting <span class="keyword">Device</span>A, <span class="keyword">Device</span>B, and <span class="keyword">Device</span>C belong to area 10.</p>
<div class="fignone" id="EN-US_TASK_0000001579446269__fig_dc_vrp_bgp_cfg_409701"><a name="EN-US_TASK_0000001579446269__fig_dc_vrp_bgp_cfg_409701"></a><a name="fig_dc_vrp_bgp_cfg_409701"></a><span class="figcap"><b>Figure 1 </b>Configuring BGP-LS</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>interface1, interface2, interface3, and interface4 in this example represent GigabitEthernet<span>0/1/1</span>, GigabitEthernet<span>0/1/2</span>, GigabitEthernet<span>0/1/3</span>, and GigabitEthernet<span>0/1/4</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001528846254.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001579446269__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>To improve security, you are advised to deploy BGP security measures. For details, see "Configuring BGP Security." Keychain authentication is used as an example. For details, see "Example for Configuring BGP Keychain."</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001579446269__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure IPv6 addresses for interfaces on each device.</p>
</li><li><p>Configure basic OSPFv3 functions.</p>
</li><li><p>Deploy BGP-LS on <span class="keyword">Device</span>C and the controller.</p>
</li><li>Configure the TWAMP Light Controller and TWAMP Light Responder on <span class="keyword">Device</span>A and <span class="keyword">Device</span>C, respectively.</li><li>Configure the TE function.</li><li>Configure delay advertisement on <span class="keyword">Device</span>A.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001579446269__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IPv6 addresses and areas of interfaces on <span class="keyword">Device</span>A, <span class="keyword">Device</span>B, <span class="keyword">Device</span>C, and <span class="keyword">Device</span>D</p>
</li><li><p>BGP-LS ID in OSPFv3 on <span class="keyword">Device</span>C</p>
</li><li><p>BGP AS numbers, BGP-LS domain AS numbers, and BGP-LS domain IDs of <span class="keyword">Device</span> C and the controller</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001579446269__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IPv6 address to each interface on each device. For configuration details, see <a href="#EN-US_TASK_0000001579446269__section_dc_vrp_bgp_cfg_409705">Configuration Files</a> in this section.</span></li><li><span>Configure basic OSPFv3 functions.</span><p><p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>ospfv3 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospfv3-1] <strong>router-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospfv3-1] <strong>area 0.0.0.10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospfv3-1-area-0.0.0.10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospfv3-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>] <strong>ospfv3 1 area 0.0.0.10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>] <strong>ospfv3 network-type p2p</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ospfv3 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospfv3-1]<strong> router-id 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospfv3-1] <strong>area 0.0.0.10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospfv3-1-area-0.0.0.10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospfv3-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface gigabitethernet <span>0/1/4</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/4</span>] <strong>ospfv3 1 area 0.0.0.10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/4</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/4</span>] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span>C.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>ospfv3 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1]<strong> router-id 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1] <strong>area 0.0.0.10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1-area-0.0.0.10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1] <strong>area 0.0.0.20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1-area-0.0.0.20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/2</span>] <strong>ospfv3 1 area 0.0.0.10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/2</span>] <strong>ospfv3 network-type p2p</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/3</span>] <strong>ospfv3 1 area 0.0.0.20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/3</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>interface gigabitethernet <span>0/1/4</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/4</span>] <strong>ospfv3 1 area 0.0.0.10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/4</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/4</span>] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span>D.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D] <strong>ospfv3 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-ospfv3-1] <strong>router-id 4.4.4.4</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-ospfv3-1] <strong>area 0.0.0.20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-ospfv3-1-area-0.0.0.20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-ospfv3-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-GigabitEthernet<span>0/1/3</span>] <strong>ospfv3 1 area 0.0.0.20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-GigabitEthernet<span>0/1/3</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>interface LoopBack0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack0] <strong>ospfv3 1 area 0.0.0.20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack0] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D-LoopBack0] <strong>quit</strong></pre>
</p></li><li><span>Deploy BGP-LS on <span class="keyword">Device</span>C and the controller.</span><p><p># Enable OSPFv3 topology advertisement on <span class="keyword">Device</span>C.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>ospfv3 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1] <strong>bgp-ls enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1] <strong>bgp-ls identifier 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-ospfv3-1] <strong>quit</strong></pre>
<p># Enable BGP-LS on <span class="keyword">Device</span>C and establish a BGP-LS peer relationship with the controller.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C]<strong> bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp]<strong> peer 10.0.0.2 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp]<strong> link-state-family unicast</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp-af-ls]<strong> peer 10.0.0.2 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp-af-ls]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-bgp-af-ls]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-bgp]<strong> quit</strong></pre>
<p># Enable BGP-LS on the controller and establish a BGP-LS peer relationship with <span class="keyword">Device</span>C.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Controller]<strong> bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Controller-bgp]<strong> peer 10.0.0.1 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Controller-bgp]<strong> link-state-family unicast</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Controller-bgp-af-ls]<strong> peer 10.0.0.1 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Controller-bgp-af-ls]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Controller-bgp-af-ls]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Controller-bgp]<strong> quit</strong></pre>
</p></li><li><span>Configure the TWAMP Light Controller and TWAMP Light Responder on <span class="keyword">Device</span>A and <span class="keyword">Device</span>C, respectively.</span><p><p># Configure the TWAMP Light Controller on <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>nqa twamp-light</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-twamp-light] <strong>client</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-twamp-light-client] <strong>test-session 1 sender-ipv6 2001:db8:13::1 reflector-ipv6 2001:db8:13::3 sender-port 862 reflector-port 862</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-twamp-light-client] <strong>test-session 1 bind interface GigabitEthernet </strong><strong><span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-twamp-light-client] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-twamp-light] <strong>sender</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-twamp-light-sender] <strong>test start-continual test-session 1 period 1000</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-twamp-light-sender] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-twamp-light-sender]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-twamp-light]<strong> quit</strong></pre>
<p># Configure the TWAMP Light Responder on DeviceC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>nqa twamp-light</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-twamp-light] <strong>responder</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-twamp-light-responder] <strong>test-session 1 local-ipv6 2001:db8:13::3 remote-ipv6 2001:db8:13::1 local-port 862 remote-port 862</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-twamp-light-responder] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-twamp-light-responder]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-twamp-light]<strong> quit</strong></pre>
</p></li><li><span>Configure TE on <span class="keyword">Device</span>A.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>te attribute enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</p></li><li><span>Enable TE for the OSPFv3 area on <span class="keyword">Device</span>A.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> ospfv3 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospfv3-1] <strong>area 0.0.0.10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospfv3-1-area-0.0.0.10]<strong> traffic-eng enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospfv3-1-area-0.0.0.10]<strong> commit</strong></pre>
</p></li><li><span>Configure delay advertisement on <span class="keyword">Device</span>A.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>ospfv3 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1] <strong>metric-delay advertisement enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-ospf-1] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Display information about BGP-LS peers and their status on <span class="keyword">Device</span>C.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C]<strong> display bgp link-state unicast peer</strong></pre>
<pre class="screen"> BGP local router ID : 10.0.0.1
 Local AS number : 100
 Total number of peers : 1                 Peers in established state : 1
 
  Peer                             V          AS  MsgRcvd  MsgSent  OutQ  Up/Down       State  PrefRcv
  10.0.0.2                         4         100        5        9     0 00:00:55 Established        0</pre>
<p># Check the delay information advertised by OSPFv3 on <span class="keyword">Device</span>C.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C]<strong> </strong><strong>display ospfv3 traffic-eng</strong></pre>
<pre class="screen">          OSPFv3 Process 1 with Router ID 3.3.3.3  

 Area ID                   : 0.0.0.10

 Traffic Engineering LSAs of the database

 ------------------------------------------------

 LSA  [1]
 Last Receive TimeStamp   : 0000-00-00 00:00:00
 Last Update TimeStamp    : 2023-04-21 01:27:50
 ------------------------------------------------
 Lsa  Type                : Intra-Area-TE                                          
 Link State Id            : 0.0.0.0                                                
 Advertising Router Id    : 1.1.1.1
 Length                   : 40

 Router IPv6 Address      : 2001:DB8:1::1  

 ------------------------------------------------

 LSA  [2]
 Last Receive TimeStamp   : 0000-00-00 00:00:00
 Last Update TimeStamp    : 2023-04-21 01:28:22
 ------------------------------------------------
 Lsa  Type                : Intra-Area-TE                                          
 Link State Id            : 0.0.0.1                                                
 Advertising Router Id    : 1.1.1.1
 Length                   : 160
 Link Type                : P2P                                    
 Neighbor Interface Id    : 14
 Neighbor Router Id       : 3.3.3.3
 Local Interface IPv6 Address  : 2001:db8:13::1
 TE Metric                : 1                                      
 Maximum Bandwidth        : 12500000 bytes/sec                                       
 Maximum Reservable BW    : 0 bytes/sec                                       
 Admin Group              : 0x0
 Global Pool              :
    Unreserved BW [ 0] =                        0  bytes/sec                                          
    Unreserved BW [ 1] =                        0  bytes/sec                                          
    Unreserved BW [ 2] =                        0  bytes/sec                                          
    Unreserved BW [ 3] =                        0  bytes/sec                                          
    Unreserved BW [ 4] =                        0  bytes/sec                                          
    Unreserved BW [ 5] =                        0  bytes/sec                                          
    Unreserved BW [ 6] =                        0  bytes/sec                                          
    Unreserved BW [ 7] =                        0  bytes/sec  
<strong> Min/Max Unidirectional Link Delay:</strong>
<strong>    Anomalous (A) Bit: 0</strong>
<strong>    Min Delay: 2220 (us)</strong>
<strong>    Max Delay: 4240 (us)</strong></pre>
<p># Check BGP-LS routes on <span class="keyword">Device</span>C.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C]<strong> display bgp link-state unicast routing-table [LINK][OSPFv3][IDENTIFIER20][LOCAL[as100][bgp-ls-identifier10.0.0.1][ospf-area-id0.0.0.10][igp-router-id1.1.1.1]][REMOTE[as100][bgp-ls-identifier10.0.0.1][ospf-area-id0.0.0.10][igp-router-id3.3.3.3]][LINK[if-address0.0.0.0][peer-address0.0.0.0][if-address2001:db8:13::1][peer-address2001:db8:13::3]]</strong></pre>
<pre class="screen"> BGP Local router ID is 10.1.1.1 
 Status codes: * - valid, &gt; - best, d - damped, x - best external, a - add path, 
               h - history,  i - internal, s - suppressed, S - Stale 
               Origin : i - IGP, e - EGP, ? - incomplete 

 BGP local router ID : 3.3.3.3 
 Local AS number : 100 
 Paths:   1 available, 1 best, 1 select 
 BGP routing table entry information of [LINK][OSPFv3][IDENTIFIER20][LOCAL[as100][bgp-ls-identifier10.0.0.1][ospf-area-id0.0.0.10][igp-router-id1.1.1.1]][REMOTE[as100][bgp-ls-identifier10.0.0.1][ospf-area-id0.0.0.10][igp-router-id3.3.3.3]][LINK[if-address0.0.0.0][peer-address0.0.0.0][if-address2001:db8:13::1][peer-address2001:db8:13::3]]: 
 Imported route. 
 From: 0.0.0.0 (0.0.0.0) 
 Route Duration: 0d00h09m59s 
 Direct Out-interface: 
 Original nexthop: 0.0.0.0 
 AS-path Nil, origin incomplete, MED 0, pref-val 0, valid, local, best, select, pre 255 
 Link-state Route Type: LINK 
 Protocol: OSPFv3 
 Identifier: 20 
 Local Node Descriptor: 
  AS Number: 100 
  BGP Identifier: 10.0.0.1 
  OSPF Area ID: 0.0.0.10 
  IGP Router ID: 1.1.1.1 
 Remote Node Descriptor: 
  AS Number: 100 
  BGP Identifier: 10.0.0.1 
  OSPF Area ID: 0.0.0.10 
  IGP Router ID: 3.3.3.3 
 Link Descriptor: 
  IPv4 interface address: 0.0.0.0 
  IPv4 neighbor address: 0.0.0.0 
  IPv6 interface address: 2001:db8:13::1 
  IPv6 neighbor address: 2001:db8:13::3 
 Link-state attribute: 
  IPv4 Router ID of Local Node: 
  IPv6 Router ID of Local Node: 
  IPv4 Router ID of Remote Node: 
  IPv6 Router ID of Remote Node: 
  Administrative group: 0x0 
  Maximum link bandwidth(kbits/sec): 0 
  Maximum reservable link bandwidth(kbits/sec): 0 
  Maximum Unreserved bandwidth(kbits/sec): 0 0 0 0 0 0 0 0 
  TE Default Metric: 0 
  Link Protection Type: Null 
  MPLS Protocol Mask: 0x0 
  IGP Metric: 1 
  Shared Risk Link Group: 
<strong>  Min/Max Unidirectional Link Delay(microseconds): 912/5503 </strong>
  Opaque link Properties: 
  Link Name: 
  Adjacency Segment Identifier(Flags/Weight/SID): 
  LAN Adjacency Segment Identifier(Flags/Weight/System-ID/SID): 
  SRv6 End.X SID(EndPoint Behavior/Flags/Algorithm/Weight/SID)(SID Structure): 
  SRv6 LAN End.X SID(EndPoint Behavior/Flags/Algorithm/Weight/Neighbor ID/SID)(SID Structure): 
  MSD([MSD Type, MSD Value]): 
 Advertised to such 1 peers: 
    10.0.0.2 </pre>
<p>The preceding command output shows that <span class="keyword">Device</span>C obtains the topology information on the whole OSPFv3 network. <span class="keyword">Device</span>C can use BGP-LS routes to report the topology information to its BGP-LS peer (the controller).</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001579446269__section_dc_vrp_bgp_cfg_409705"><a name="EN-US_TASK_0000001579446269__section_dc_vrp_bgp_cfg_409705"></a><a name="section_dc_vrp_bgp_cfg_409705"></a><a name="EN-US_TASK_0000001579446269__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span>A configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>A
#
te attribute enable
#
ospfv3 1
 router-id 1.1.1.1
 metric-delay advertisement enable 
 area 0.0.0.10 
  traffic-eng enable
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:13::1/64
 ospfv3 network-type p2p 
 ospfv3 1 area 0.0.0.10 
#
nqa twamp-light 
 client 
  test-session 1 sender-ipv6 2001:db8:13::1 reflector-ipv6 2001:db8:13::3 sender-port 862 reflector-port 862 
  test-session 1 bind interface GigabitEthernet <span>0/1/2</span>
 sender
  test start-continual test-session 1 period 1000 
#
return</pre>
</li><li><p><span class="keyword">Device</span>B configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>B
#
ospfv3 1 
 router-id 2.2.2.2 
 area 0.0.0.10 
#
interface GigabitEthernet<span>0/1/4</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:23::2/64
 ospfv3 1 area 0.0.0.10
#
return</pre>
</li><li><p><span class="keyword">Device</span>C configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>C
#
ospfv3 1 
 router-id 3.3.3.3
 bgp-ls enable
 bgp-ls identifier 20 
 area 0.0.0.10
 area 0.0.0.20
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.0.0.1 255.255.255.0
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:13::3/64
 ospfv3 network-type p2p
 ospfv3 1 area 0.0.0.10
#
interface GigabitEthernet<span>0/1/3</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:34::3/64
 ospfv3 1 area 0.0.0.20
#
interface GigabitEthernet<span>0/1/4</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2001:db8:23::3/64
 ospfv3 1 area 0.0.0.10
#
bgp 100
 peer 10.0.0.2 as-number 100
 #
 ipv4-family unicast
  undo synchronization 
  peer 10.0.0.2 enable
 #
 link-state-family unicast
  peer 10.0.0.2 enable
#
nqa twamp-light 
 responder 
  test-session 1 local-ipv6 2001:db8:13::3 remote-ipv6 2001:db8:13::1 local-port 862 remote-port 862 
#
return</pre>
</li><li><p><span class="keyword">Device</span>D configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>D
#
ospfv3 1
 router-id 4.4.4.4 
 area 0.0.0.20 
#
interface GigabitEthernet<span>0/1/3</span>
 undo shutdown
 ipv6 enable 
 ipv6 address 2001:db8:34::4/64 
 ospfv3 1 area 0.0.0.20 
#
interface LoopBack0
 ipv6 enable 
 ipv6 address 2001:db8:4::4/128 
 ospfv3 1 area 0.0.0.20 
#
return</pre>
</li><li><p>Controller configuration file</p>
<pre class="screen">#
sysname Controller
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ip address 10.0.0.2 255.255.255.0
#
bgp 100
 peer 10.0.0.1 as-number 100
 #
 ipv4-family unicast
  undo synchronization 
  peer 10.0.0.1 enable
 #
 link-state-family unicast
  peer 10.0.0.1 enable
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_2062.html">Configuration Examples for OSPFv3
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_2093.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospfv3_cfg_2195.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>