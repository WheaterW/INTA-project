
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring IS-IS Neighbor Relationship Flapping Suppression">
<meta name="abstract" content="IS-IS neighbor relationship flapping suppression works by delaying IS-IS neighbor relationship reestablishment or setting the link cost to the maximum value.">
<meta name="description" content="IS-IS neighbor relationship flapping suppression works by delaying IS-IS neighbor relationship reestablishment or setting the link cost to the maximum value.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_isis_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_isis_cfg_1068.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_isis_cfg_1052.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00556928,w00606909,l00455378,isis">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IS-IS">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IS-IS">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="IS-IS">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00875216">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00875216">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172366044">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring IS-IS Neighbor Relationship Flapping Suppression</title>
</head>
<body><a name="EN-US_TASK_0172366044"></a><a name="EN-US_TASK_0172366044"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring IS-IS Neighbor Relationship Flapping Suppression</h1>
<div class="taskbody"><p>IS-IS neighbor relationship flapping suppression works by delaying IS-IS neighbor relationship reestablishment or setting the link cost to the maximum value.</p>
<div class="context"><a name="EN-US_TASK_0172366044__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>If the status of an interface carrying IS-IS services alternates between up and down, the neighbor relationship frequently flaps. During the flapping, IS-IS reestablishes the neighbor relationship and recalculates routes. In this process, a large number of packets are exchanged, adversely affecting neighbor relationship stability, IS-IS services, and other IS-IS-dependent services, such as LDP and BGP. IS-IS neighbor relationship flapping suppression can address this problem by either delaying IS-IS neighbor relationship reestablishment, or setting the link cost to the maximum value to prevent service traffic from passing through flapping links.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The following steps are optional, choose them as required.</p>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172366044__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring IS-IS neighbor relationship flapping suppression, complete the following tasks:</p>
<ul><li>Configure an IP address for each interface to ensure that neighboring routers are reachable at the network layer.</li><li><a href="dc_vrp_isis_cfg_1000.html">Configuring Basic IPv4 IS-IS Functions</a>.</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172366044__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p><p><p>To disable the function globally, run the <a href="cmdqueryname=suppress-flapping+peer+disable"><b><span class="cmdname">suppress-flapping peer disable</span></b></a> command.</p>
</p></li><li><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span><p><p>The interface view is displayed.</p>
</p><p><p>To disable IS-IS neighbor relationship flapping suppression from one of the interfaces, run the <a href="cmdqueryname=isis+suppress-flapping+peer+disable"><b><span class="cmdname">isis suppress-flapping peer disable</span></b></a> command.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=isis+suppress-flapping+peer+hold-down"><b><span class="cmdname">isis suppress-flapping peer hold-down</span></b></a> <i><span class="varname">interval</span></i></span></span><p><p>The Hold-down mode is configured, and its duration is set.</p>
</p><p><p>IS-IS neighbor relationship flapping suppression works in either Hold-down or Hold-max-cost mode.</p>
<ul><li>Hold-down mode: In the case of frequent flooding and topology changes during neighbor relationship establishment, interfaces prevent neighbor relationship reestablishment during Hold-down suppression, which minimizes synchronization attempts and packet exchanges.</li><li>Hold-max-cost mode: If the traffic forwarding path changes frequently, interfaces use the maximum value (16777214 for the wide mode and 63 for the narrow mode) as the cost of the flapping link during Hold-max-cost suppression, which prevents traffic from passing through the flapping link.</li></ul>
<p>Flapping suppression can also work first in Hold-down mode and then in Hold-max-cost mode.</p>
<p>To disable this mode, run the <a href="cmdqueryname=isis+suppress-flapping+peer+hold-max-cost"><b><span class="cmdname">isis suppress-flapping peer hold-max-cost</span></b></a> <strong><span>disable</span></strong> command.</p>
</p></li><li><span>Run <a href="cmdqueryname=isis+suppress-flapping+peer"><b><span class="cmdname">isis suppress-flapping peer</span></b></a> { <strong><span>detecting-interval</span></strong> <i><span class="varname">detecting-interval</span></i> | <strong><span>threshold</span></strong> <i><span class="varname">threshold</span></i> | <strong><span>resume-interval</span></strong> <i><span class="varname">resume-interval</span></i> } <sup>*</sup></span><p><p>Detection parameters are configured for IS-IS neighbor relationship flapping suppression.</p>
</p><p><p>Each IS-IS interface on which IS-IS neighbor relationship flapping suppression is enabled starts a flapping counter. If the interval between two successive times when the neighbor state is ExStart or Down is shorter than or equal to <i><span class="varname">detecting-interval</span></i>, a valid flapping_event is recorded, and the flapping_count increases by 1. When the flapping_count reaches or exceeds <i><span class="varname">threshold</span></i>, flapping suppression takes effect. If the interval between two successive times when the neighbor state is ExStart or Down is longer than or equal to <i><span class="varname">resume-interval</span></i>, the flapping_count is reset.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The value of <i><span class="varname">resume-interval</span></i> must be greater than that of <i><span class="varname">detecting-interval</span></i>.</p>
</div></div>
<p></p>
</p></li><li><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the user view.</p>
</p></li><li><span>Run <a href="cmdqueryname=reset+isis"><b><span class="cmdname">reset isis</span></b></a> <i><span class="varname">process-id</span></i> <strong><span>suppress-flapping peer</span></strong> [ <strong><span>interface</span></strong> { <i><span class="varname">interface-name</span></i> | <i><span class="varname">interfaceType</span></i> <i><span class="varname">interfaceNum</span></i> } ] [ <strong><span>notify-peer</span></strong> ]</span><p><p>The interface exits the neighbor flapping suppression.</p>
</p><p><div class="p">Interfaces exit from flapping suppression in the following scenarios:<ul><li>The suppression timer expires.</li><li>The corresponding IS-IS process is reset.</li><li>An IS-IS neighbor is reset using the <a href="cmdqueryname=reset+isis+peer"><b><span class="cmdname">reset isis peer</span></b></a> command.</li><li>IS-IS neighbor relationship flapping suppression is disabled globally using the <a href="cmdqueryname=suppress-flapping+peer+disable"><b><span class="cmdname">suppress-flapping peer disable</span></b></a> command.</li><li>The <a href="cmdqueryname=reset+isis+suppress-flapping+peer"><b><span class="cmdname">reset isis suppress-flapping peer</span></b></a> command is run to forcibly exit flapping suppression.</li><li>The <a href="cmdqueryname=reset+isis"><b><span class="cmdname">reset isis</span></b></a> <i><span class="varname">process-id</span></i> <strong><span>suppress-flapping peer</span></strong> [ <span class="parmname"><b>interface</b></span> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> ] <strong><span>notify-peer</span></strong> command is run on the peer device to forcibly exit flapping suppression.</li></ul>
</div>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0172366044__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+isis"><b><span class="cmdname">display isis</span></b></a> [ <i><span class="varname">process-id</span></i> ] <strong><span>interface</span></strong> <i><span class="varname">interfaceType</span></i> <em>interfaceNum</em> <strong><span>verbose</span></strong> command to check the status of IS-IS neighbor relationship flapping suppression.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_isis_cfg_0000.html">IS-IS Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_isis_cfg_1068.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_isis_cfg_1052.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>