
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring the POPGO Function">
<meta name="abstract" content="After the POPGO function is configured on the egress of a BGP LSP, the egress forwards each data packet received from the LSP through the outbound interface found in the ILM based on the label information carried in the packet.">
<meta name="description" content="After the POPGO function is configured on the egress of a BGP LSP, the egress forwards each data packet received from the LSP through the outbound interface found in the ILM based on the label information carried in the packet.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3096.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3103.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00615954">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172366244">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring the POPGO Function</title>
</head>
<body><a name="EN-US_TASK_0172366244"></a><a name="EN-US_TASK_0172366244"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring the POPGO Function</h1>
<div class="taskbody"><p>After the POPGO function is configured on the egress of a BGP LSP, the egress forwards each data packet received from the LSP through the outbound interface found in the ILM based on the label information carried in the packet.</p>
<div class="context"><a name="EN-US_TASK_0172366244__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>On the network shown in <a href="#EN-US_TASK_0172366244__fig_dc_vrp_bgp_cfg_409301">Figure 1</a>, DeviceC has two static routes, 10.1.1.0/24 and 10.1.1.0/30, and the next hops of the two routes are DeviceA and DeviceB, respectively. DeviceC only imports route 10.1.1.0/24 to BGP and then sends this route to DeviceD. A BGP LSP is established between DeviceC and DeviceD. By default, after DeviceC receives a data packet destined for 10.1.1.0 from DeviceD, DeviceC removes the BGP LSP label from the packet, searches the IP forwarding table for the outbound interface, and forwards the packet along the route 10.1.1.0/30 based on the longest match rule. That is, the packet is incorrectly forwarded to DeviceB.</p>
<p>To solve the preceding problem, run the <a href="cmdqueryname=apply-label+per-route+pop-go"><b><span class="cmdname">apply-label per-route pop-go</span></b></a> command in the BGP view on DeviceC. After the <a href="cmdqueryname=apply-label+per-route+pop-go"><b><span class="cmdname">apply-label per-route pop-go</span></b></a> command is configured, when DeviceC sends route 10.1.1.0/24 to DeviceD, DeviceC records in the ILM the mapping between the label assigned to the route and the outbound interface of the route. After the local device receives a labeled data packet through a BGP LSP, the local device no longer searches the IP forwarding table based on the longest match rule. Instead, the local device searches the ILM for an outbound interface based on the label value and forwards the packet through this outbound interface after removing its label. This ensures correct packet forwarding.</p>
<div class="fignone" id="EN-US_TASK_0172366244__fig_dc_vrp_bgp_cfg_409301"><a name="EN-US_TASK_0172366244__fig_dc_vrp_bgp_cfg_409301"></a><a name="fig_dc_vrp_bgp_cfg_409301"></a><span class="figcap"><b>Figure 1 </b>POPGO networking</span><br><span><img class="vsd" src="images/fig_dc_vrp_bgp_cfg_409301.png" width="NaN" height="NaN"></span><br></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172366244__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span></span><p><p>The BGP view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=apply-label+per-route+pop-go"><b><span class="cmdname">apply-label per-route pop-go</span></b></a></span></span><p><p>The BGP POPGO function is configured.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0172366244__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After the configuration is complete, verify it.</p>
<p>Run the <a href="cmdqueryname=display+mpls+lsp+protocol+bgp"><b><span class="cmdname">display mpls lsp protocol bgp</span></b></a> command on the device to view detailed information about BGP LSP establishment. If <strong>POPGO</strong> is displayed in the <strong>Label Operation</strong> field, the POPGO function is successfully configured.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3000.html">BGP Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3096.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3103.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>