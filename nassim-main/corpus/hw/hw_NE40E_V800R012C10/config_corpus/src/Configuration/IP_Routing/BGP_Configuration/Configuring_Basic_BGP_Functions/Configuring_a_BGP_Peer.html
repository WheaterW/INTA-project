
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a BGP Peer">
<meta name="abstract" content="Devices can exchange BGP routing information only after the BGP peer relationship is established.">
<meta name="description" content="Devices can exchange BGP routing information only after the BGP peer relationship is established.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3004.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3005.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3007.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00615954">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172366161">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a BGP Peer</title>
</head>
<body><a name="EN-US_TASK_0172366161"></a><a name="EN-US_TASK_0172366161"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a BGP Peer</h1>
<div class="taskbody"><p>Devices can exchange BGP routing information only after the BGP peer relationship is established.</p>
<div class="context"><a name="EN-US_TASK_0172366161__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>BGP peers use TCP to establish connections. Therefore, you need to specify the IP addresses of the peers when configuring BGP. A BGP peer may not be a neighboring node, and the BGP peer relationship can be created through logical links. To enhance the stability of BGP connections, using loopback interface addresses to establish connections is recommended.</p>
<p>The devices in the same AS establish IBGP peer relationships, and the devices of different ASs establish EBGP peer relationships.</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172366161__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure an IBGP peer.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer+as-number"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">peerGroupName</span></i> } <a href="cmdqueryname=peer+as-number"><b><span class="cmdname">as-number</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The IP address of the peer and the number of the AS where the peer resides are specified.</p>
</p><p><p>The number of the AS where the specified peer resides must be the same as that of the local AS.</p>
<p>The IP address of the peer can be one of the following types:</p>
<ul><li><p>IP address of the peer's interface that is directly connected to the local device</p>
</li><li><p>IP address of a sub-interface on a directly connected peer</p>
</li><li><p>IP address of a reachable loopback interface on the peer</p>
</li></ul>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=peer+connect-interface"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">peerGroupName</span></i> } <a href="cmdqueryname=peer+connect-interface"><b><span class="cmdname">connect-interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> [ <i><span class="varname">ipv4-source-address</span></i> ]</span><p><p>The source interface and source address are specified for establishing a TCP connection with the specified BGP peer.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the IP address of a loopback interface<span> or a sub-interface</span> is used to establish a BGP connection, you are advised to run the <a href="cmdqueryname=peer+connect-interface"><b><span class="cmdname">peer connect-interface</span></b></a> command at both ends of the connection to ensure that the connection is correctly established. If this command is run on only one end, the BGP connection may fail to be established.</p>
<p>If the source interface used by the local end to establish a BGP session is configured with multiple IP addresses, the <a href="cmdqueryname=peer+connect-interface"><b><span class="cmdname">peer connect-interface</span></b></a> command must be run to specify the source address. This ensures the correct connection between the two ends.</p>
</div></div>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=peer+description"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">peerGroupName</span></i> } <a href="cmdqueryname=peer+description"><b><span class="cmdname">description</span></b></a> <i><span class="varname">description-text</span></i></span><p><p>A description is configured for the peer.</p>
</p><p><p>To simplify network management, you can configure a description for a specified peer.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=peer+tcp-mss"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">peerGroupName</span></i> } <a href="cmdqueryname=peer+tcp-mss"><b><span class="cmdname">tcp-mss</span></b></a> <i><span class="varname">tcp-mss-number</span></i></span><p><p>A TCP MSS value used during TCP connection establishment with a peer or peer group is configured.</p>
</p><p><p>This configuration ensures that TCP packets can still be segmented properly based on the specified TCP MSS in cases where the path MTU is unavailable, thereby improving network performance.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure an EBGP peer.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=router-id+allow-same+enable"><b><span class="cmdname">router-id allow-same enable</span></b></a></span><p><p>The peers with the same router ID are allowed to establish EBGP connections.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">peerGroupName</span></i> } <a href="cmdqueryname=as-number"><b><span class="cmdname">as-number</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>A peer IP address and the number of the AS where the peer resides are specified.</p>
</p><p><p>The number of the AS where the specified peer resides must be different from that of the local AS.</p>
<p>The IP address of the peer can be one of the following types:</p>
<ul><li><p>IP address of the peer's interface that is directly connected to the local device</p>
</li><li><p>IP address of a sub-interface on a directly connected peer</p>
</li><li><p>IP address of a reachable loopback interface on the peer</p>
</li></ul>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=peer+connect-interface"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">peerGroupName</span></i> } <a href="cmdqueryname=peer+connect-interface"><b><span class="cmdname">connect-interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> [ <i><span class="varname">ipv4-source-address</span></i> ]</span><p><p>The source interface and source address are specified for establishing a TCP connection with the specified BGP peer.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the IP address of a loopback interface<span> or a sub-interface</span> is used to establish a BGP connection, you are advised to run the <a href="cmdqueryname=peer+connect-interface"><b><span class="cmdname">peer connect-interface</span></b></a> command at both ends of the connection to ensure that the connection is correctly established. If this command is run on only one end, the BGP connection may not be established.</p>
</div></div>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=peer+ebgp-max-hop"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">peerGroupName</span></i> } <a href="cmdqueryname=peer+ebgp-max-hop"><b><span class="cmdname">ebgp-max-hop</span></b></a> [ <i><span class="varname">hop-count</span></i> ]</span><p><p>The maximum number of hops allowed over an EBGP connection is set.</p>
</p><p><p>In most cases, EBGP peers are directly connected through a physical link. If you want to establish an EBGP peer relationship between indirectly connected peers, run the <a href="cmdqueryname=peer+ebgp-max-hop"><b><span class="cmdname">peer ebgp-max-hop</span></b></a> command to set the maximum number of hops allowed over the TCP connection.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If loopback interfaces are used to establish an EBGP connection, run the <a href="cmdqueryname=peer+ebgp-max-hop"><b><span class="cmdname">peer ebgp-max-hop</span></b></a> command, where the value of <i><span class="varname">hop-count</span></i> must be greater than or equal to 2. Otherwise, the EBGP peer relationship cannot be established.</p>
</div></div>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=peer+description"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">peerGroupName</span></i> } <a href="cmdqueryname=peer+description"><b><span class="cmdname">description</span></b></a> <i><span class="varname">description-text</span></i></span><p><p>A description is configured for the peer.</p>
</p><p><p>To simplify network management, you can configure a description for a specified peer.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=peer+peer-as-check"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">peerGroupName</span></i> } <a href="cmdqueryname=peer+peer-as-check"><b><span class="cmdname">peer-as-check</span></b></a></span><p><p>The device is configured not to advertise the routes learned from an EBGP peer to the peers in the same AS with the EBGP peer.</p>
</p><p><p>By default, after receiving a route from an EBGP peer (for example, in AS 200), the local device (for example, in AS 100) advertises the route to other EBGP peers in AS 200. After the <a href="cmdqueryname=peer+peer-as-check"><b><span class="cmdname">peer peer-as-check</span></b></a> command is run on the device, the device does not advertise the routes received from an EBGP peer to other EBGP peers in the same AS with this EBGP peer. This reduces BGP memory and CPU consumption and speeds up route convergence in case of route flapping.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=peer+tcp-mss"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">peerGroupName</span></i> } <a href="cmdqueryname=peer+tcp-mss"><b><span class="cmdname">tcp-mss</span></b></a> <i><span class="varname">tcp-mss-number</span></i></span><p><p>A TCP MSS value used during TCP connection establishment with a peer or peer group is configured.</p>
</p><p><p>This configuration ensures that TCP packets can still be segmented properly based on the specified TCP MSS in cases where the path MTU is unavailable, thereby improving network performance.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3004.html">Configuring Basic BGP Functions
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3005.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3007.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>