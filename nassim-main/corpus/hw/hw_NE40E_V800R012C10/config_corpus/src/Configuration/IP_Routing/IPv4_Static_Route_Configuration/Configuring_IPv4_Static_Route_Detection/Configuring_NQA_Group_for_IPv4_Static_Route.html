
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring NQA Group for IPv4 Static Route">
<meta name="abstract" content="After an IPv4 static route is associated with an NQA group, if the NQA group detects a link fault, it withdraws the IPv4 static route, triggering traffic switching and ensuring network stability.">
<meta name="description" content="After an IPv4 static route is associated with an NQA group, if the NQA group detects a link fault, it withdraws the IPv4 static route, triggering traffic switching and ensuring network stability.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_static-route_disjoin_cfg_0033.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_static-route_disjoin_cfg_0035.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_static-route_disjoin_cfg_0048.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Static Route">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Static Route">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="Static Route">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="Static Route">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00809835">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00414125">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001411244737">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring NQA Group for IPv4 Static Route</title>
</head>
<body><a name="EN-US_TASK_0000001411244737"></a><a name="EN-US_TASK_0000001411244737"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring NQA Group for IPv4 Static Route</h1>
<div class="taskbody"><p>After an IPv4 static route is associated with an NQA group, if the NQA group detects a link fault, it withdraws the IPv4 static route, triggering traffic switching and ensuring network stability.</p>
<div class="context"><a name="EN-US_TASK_0000001411244737__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>On live networks, the status of IPv4 static routes needs to be monitored in real time to ensure network stability. If the link status changes, a primary/backup link switchover is performed. NQA for IPv4 static route can monitor only a single link. To enable a static route to use NQA test instances to monitor multiple links, you can bind these NQA test instances to the same NQA group and associate the static route with the NQA group.</p>
<p>If a link fault occurs, the NQA group can collect statistics on the status changes of all NQA test instances bound to the NQA group and determine whether to change its status according to the configured operation. When the status of the NQA group changes, the NQA group instructs the RM module to delete the IPv4 static route associated with the NQA group from the IP routing table. Traffic is then forwarded along another path, implementing a link switchover.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001411244737__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring NQA group for IPv4 static route, complete the following task:</p>
<ul><li>Configure link-layer protocol parameters and IP addresses for interfaces to ensure that the link layer protocol of each interface is up.</li></ul>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0000001411244737__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure multiple NQA test instances of the ICMP or TCP type.</span><p><ol><li>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a><p>The system view is displayed.</p>
</li><li>Run <a href="cmdqueryname=nqa"><b><span class="cmdname">nqa</span></b></a> <strong><span>test-instance</span></strong> <i><span class="varname">admin-name</span></i> <i><span class="varname">test-name</span></i><p>An NQA test instance is created, and the test instance view is displayed.</p>
</li><li>Run <a href="cmdqueryname=test-type"><b><span class="cmdname">test-type</span></b></a> { <strong><span>icmp</span></strong> | <strong><span>tcp</span></strong> }<p>The test instance type is set to ICMP or TCP.</p>
</li><li><p>Run <a href="cmdqueryname=destination-address"><b><span class="cmdname">destination-address</span></b></a> <strong><span>ipv4</span></strong> <em>destAddress</em></p>
<p>A destination address is configured.</p>
<p>In an NQA test instance, you can specify the destination end by running the <a href="cmdqueryname=destination-address"><b><span class="cmdname">destination-address</span></b></a> command to configure a destination address for the NQA test instance.</p>
</li><li><div class="p">Run any of the following commands to start an NQA test instance:<ul><li><a href="cmdqueryname=start"><b><span class="cmdname">start</span></b></a> <strong><span>at</span></strong> [ <i><span class="varname">yyyy/mm/dd</span></i> ] <i><span class="varname">hh:mm:ss</span></i> [ <strong><span>end</span></strong> { <strong><span>at</span></strong> [ <i><span class="varname">yyyy/mm/dd</span></i> ] <i><span class="varname">hh:mm:ss</span></i> | <strong><span>delay</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh:mm:ss</span></i> } | <strong><span>lifetime</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh:mm:ss</span></i> } } ]</li><li><a href="cmdqueryname=start"><b><span class="cmdname">start</span></b></a> <strong><span>delay</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh:mm:ss</span></i> } [ <strong><span>end</span></strong> { <strong><span>at</span></strong> [ <i><span class="varname">yyyy/mm/dd</span></i> ] <i><span class="varname">hh:mm:ss</span></i> | <strong><span>delay</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh:mm:ss</span></i> } | <strong><span>lifetime</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh:mm:ss</span></i> } } ]</li><li><a href="cmdqueryname=start"><b><span class="cmdname">start</span></b></a> <strong><span>now</span></strong><span> [ <strong><span>end</span></strong> { <strong><span>at</span></strong> [ <i><span class="varname">yyyy/mm/dd</span></i> ] <i><span class="varname">hh:mm:ss</span></i> | <strong><span>delay</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh:mm:ss</span></i> } | <strong><span>lifetime</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh:mm:ss</span></i> } } ]</span></li><li><a href="cmdqueryname=start"><b><span class="cmdname">start</span></b></a> <strong><span>daily</span></strong> <i><span class="varname">hh:mm:ss</span></i> <strong><span>to</span></strong> <i><span class="varname">hh:mm:ss</span></i> [ <strong><span>begin</span></strong> <span>{ </span><i><span class="varname">yyyy/mm/dd</span></i> <span>| <i><span class="varname">yyyy-mm-dd</span></i> } </span>] [ <strong><span>end</span></strong> <span>{ </span><i><span class="varname">yyyy/mm/dd</span></i> <span>| <i><span class="varname">yyyy-mm-dd</span></i> } </span>]</li></ul>
</div>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>For more optional configurations of NQA test instances, see the <em><span class="keyword">HUAWEI NE40E-M2 series</span><span class="keyword">Universal Service Router</span> Configuration Guide - System Monitor</em>.</p>
</div></div>
</li><li><p>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></p>
<p>The configuration is committed.</p>
</li><li>Repeat the preceding steps to configure multiple NQA test instances of the ICMP or TCP type.</li></ol>
</p></li><li><span>Bind the preceding NQA test instances to an NQA group.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=nqa+group"><b><span class="cmdname">nqa group</span></b></a> <i><span class="varname">group-name</span></i></span><p><p>An NQA group is created, and the NQA group view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=nqa+test-instance"><b><span class="cmdname">nqa test-instance</span></b></a> <i><span class="varname">admin-name</span></i> <i><span class="varname">test-name</span></i></span><p><p>An NQA test instance is bound to the NQA group.</p>
</p><p><p>Run this command multiple times to bind multiple NQA test instances to the NQA group.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The NQA test instances bound to the same NQA group must be of the same type: ICMP or TCP.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=operator"><b><span class="cmdname">operator</span></b></a> { <strong><span>and</span></strong> | <strong><span>or</span></strong> }</span><p><p>The operation type between test instances in the NQA group is set to AND or OR.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=description"><b><span class="cmdname">description</span></b></a> <i><span class="varname">string</span></i></span><p><p>A description is configured for the NQA group.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Bind an IPv4 static route to the NQA group.</span><p><ol><li>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a><p>The system view is displayed.</p>
</li><li><p>Bind an IPv4 static route to the NQA group.</p>
<ul><li>To configure an IPv4 static route on the public network and associate the route with the NQA group, run the <a href="cmdqueryname=ip+route-static"><b><span class="cmdname">ip route-static</span></b></a> <i><span class="varname">ip-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } { <i><span class="varname">nexthop-address</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> [ <i><span class="varname">nexthop-address</span></i> ] | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> <i><span class="varname">nexthop-address</span></i> } [ <strong><span>preference</span></strong> <i><span class="varname">preference</span></i> | <strong><span>tag</span></strong> <i><span class="varname">tag</span></i> ] <sup>*</sup> <strong><span>track nqa-group</span></strong> <i><span class="varname">group-name</span></i> [ <strong><span>description</span></strong> <i><span class="varname">text</span></i> ] command.</li><li>To configure an IPv4 static route on a VPN and associate the route with the NQA group, run the <a href="cmdqueryname=ip+route-static+vpn-instance"><b><span class="cmdname">ip route-static vpn-instance</span></b></a> <i><span class="varname">vpn-source-name</span></i> <i><span class="varname">destination-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } { <i><span class="varname">nexthop-address</span></i> [ <strong><span>public</span></strong> ] | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> [ <i><span class="varname">nexthop-address</span></i> ] | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> <i><span class="varname">nexthop-address</span></i> } [ <strong><span>preference</span></strong> <i><span class="varname">preference</span></i> | <strong><span>tag</span></strong> <i><span class="varname">tag</span></i> ] <sup>*</sup> <strong><span>track nqa-group</span></strong> <i><span class="varname">group-name</span></i> [ <strong><span>description</span></strong> <i><span class="varname">text</span></i> ] command.</li></ul>
</li><li>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a><p>The configuration is committed.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p">When configuring NQA group for IPv4 static route, pay attention to the following points:<ul><li>The destination address of an NQA group cannot be the destination address of an associated static route.</li><li>If a static route is associated with another NQA group, the association between the static route and the current NQA group is removed.</li><li>A static route cannot be associated with an NQA group that has not been created.</li></ul>
</div>
</div></div>
</li></ol>
</p></li></ul></div>
<div class="postreq"><a name="EN-US_TASK_0000001411244737__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After the configuration is complete, verify it.</p>
<ul><li>Run the <a href="cmdqueryname=display+static-route+routing-table"><b><span class="cmdname">display static-route routing-table</span></b></a> command to check information about static routes.</li><li><p>Run the <a href="cmdqueryname=display+current-configuration"><b><span class="cmdname">display current-configuration</span></b></a> <strong><span>|</span></strong> <strong><span>include</span></strong> <strong><span>nqa-group</span></strong> command to check the configurations of NQA group for IPv4 static route.</p>
</li><li><p>Run the <a href="cmdqueryname=display+nqa+group"><b><span class="cmdname">display nqa group</span></b></a> [ <i><span class="varname">group-name</span></i> ] command to check the test result of the NQA group.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The test result of the NQA group cannot be displayed automatically. You need to run the <a href="cmdqueryname=display+nqa+group"><b><span class="cmdname">display nqa group</span></b></a> command to view the result.</p>
</div></div>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_static-route_disjoin_cfg_0033.html">Configuring IPv4 Static Route Detection
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_static-route_disjoin_cfg_0035.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_static-route_disjoin_cfg_0048.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>