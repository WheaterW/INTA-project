
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Neighbor Relationship Flapping Suppression on an OSPF Multi-Area Adjacency Interface">
<meta name="abstract" content="Neighbor relationship flapping suppression can be configured on an OSPF multi-area adjacency interface to delay OSPF neighbor relationship reestablishment or set the link cost to the maximum value in case of neighbor relationship flapping.">
<meta name="description" content="Neighbor relationship flapping suppression can be configured on an OSPF multi-area adjacency interface to delay OSPF neighbor relationship reestablishment or set the link cost to the maximum value in case of neighbor relationship flapping.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_2058.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_2062.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_2066.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00875216">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00875216">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172365639">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Neighbor Relationship Flapping Suppression on an OSPF Multi-Area Adjacency Interface</title>
</head>
<body><a name="EN-US_TASK_0172365639"></a><a name="EN-US_TASK_0172365639"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Neighbor Relationship Flapping Suppression on an OSPF Multi-Area Adjacency Interface</h1>
<div class="taskbody"><p>Neighbor relationship flapping suppression can be configured on an OSPF multi-area adjacency interface to delay OSPF neighbor relationship reestablishment or set the link cost to the maximum value in case of neighbor relationship flapping.</p>
<div class="context"><a name="EN-US_TASK_0172365639__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>If an interface carrying OSPF services frequently alternates between up and down, frequent neighbor relationship flapping will occur. During the flapping, OSPF frequently sends Hello packets to reestablish the neighbor relationship, synchronizes LSDBs, and recalculates routes. In this process, a large number of packets are exchanged, adversely affecting neighbor relationship stability, OSPF services, and other OSPF-dependent services, such as LDP and BGP. OSPF neighbor relationship flapping suppression can address this problem by delaying OSPF neighbor relationship reestablishment or preventing service traffic from passing through flapping links.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The following steps are optional, and choose them as required.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172365639__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p><p><p> To disable the function globally, run the <a href="cmdqueryname=suppress-flapping+peer+disable"><b><span class="cmdname">suppress-flapping peer disable</span></b></a> command.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a><i><span class="varname"> interface-type</span></i><i><span class="varname"> interface-number</span></i></span></span><p><p>The interface view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=ospf+enable"><b><span class="cmdname">ospf enable</span></b></a> [ <i><span class="varname">process-id</span></i> ] <strong><span>area</span></strong> <i><span class="varname">area-id</span></i></span></span><p><p>OSPF is enabled on the interface.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=ospf+enable+multi-area"><b><span class="cmdname">ospf enable multi-area</span></b></a> <i><span class="varname">area-id</span></i></span></span><p><p>OSPF is enabled on the multi-area adjacency interface.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=ospf+suppress-flapping+peer+disable+multi-area"><b><span class="cmdname">ospf suppress-flapping peer disable multi-area</span></b></a> <i><span class="varname">area-id</span></i></span></span><p><p>OSPF neighbor relationship flapping suppression on a multi-area adjacency interface is disabled.</p>
</p><p><p>To disable OSPF neighbor relationship flapping suppression from one of the interfaces, run this command.</p>
</p></li><li><span>Run <a href="cmdqueryname=ospf+suppress-flapping+peer+hold-down"><b><span class="cmdname">ospf suppress-flapping peer hold-down</span></b></a> <i><span class="varname">interval</span></i> <strong><span>multi-area</span></strong> <i><span class="varname">area-id</span></i></span><p><p>The Hold-down mode and its duration are configured for the multi-area adjacency interface.</p>
</p><p><p>OSPF neighbor relationship flapping suppression operates in Hold-down or Hold-max-cost mode.</p>
<ul><li><p>Hold-down mode: In the case of frequent flooding and topology changes during neighbor relationship establishment, interfaces prevent neighbor relationship reestablishment during the suppression period, which reduces LSDB synchronization attempts and packet exchanges.</p>
</li><li><p>Hold-max-cost mode: If the traffic forwarding path changes frequently, interfaces use 65535 (maximum value) as the cost of the flapping link during the suppression period. This prevents traffic from passing through the flapping link.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>To change the value of Max-cost for OSPF links, run the <a href="cmdqueryname=maximum-link-cost"><b><span class="cmdname">maximum-link-cost</span></b></a> <i><span class="varname">cost</span></i> command.</p>
</div></div>
</li></ul>
<p>The Hold-down mode and Hold-max-cost mode can be both used. When both modes are configured, the device first enters the Hold-down mode. After exiting the Hold-down mode, the device enters the Hold-max-cost mode.</p>
<p>To disable the Hold-max-cost mode, run the <a href="cmdqueryname=ospf+suppress-flapping+peer+hold-max-cost+disable+multi-area"><b><span class="cmdname">ospf suppress-flapping peer hold-max-cost disable multi-area</span></b></a> command.</p>
</p></li><li><span>Run <a href="cmdqueryname=ospf+suppress-flapping+peer"><b><span class="cmdname">ospf suppress-flapping peer</span></b></a> { <strong><span>detecting-interval</span></strong> <i><span class="varname">detecting-interval</span></i> | <strong><span>threshold</span></strong> <i><span class="varname">threshold</span></i> | <strong><span>resume-interval</span></strong> <i><span class="varname">resume-interval</span></i> } <sup>*</sup> <strong><span>multi-area</span></strong> <i><span class="varname">area-id</span></i></span><p><p>Detection parameters are configured for OSPF neighbor relationship flapping suppression on the multi-area adjacency interface.</p>
</p><p><div class="p"><ul><li><p>Configure a threshold for exiting OSPF neighbor relationship flapping suppression.</p>
<p>If the interval between two successive neighbor relationship state changes from Full to a non-Full state is longer than the <i><span class="varname">resume-interval</span></i>, the flapping_count is reset.</p>
</li><li>If OSPF neighbor relationship flapping suppression works in Hold-max-cost mode, the value of <i><span class="varname">resume-interval</span></i> indicates the duration of this mode.</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The value of <i><span class="varname">resume-interval</span></i> must be greater than that of <i><span class="varname">detecting-interval</span></i>.</p>
</div></div>
</div>
<p>You can configure detection parameters for OSPF neighbor relationship flapping suppression on specific interfaces according to network conditions. However, using the default values of these parameters is recommended. </p>
</p></li><li><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>The user view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=reset+ospf"><b><span class="cmdname">reset ospf</span></b></a> <i><span class="varname">process-id</span></i> <strong><span>suppress-flapping peer</span></strong> [ <i><span class="varname">interface-name</span></i> [ <strong><span>all-areas</span></strong> | <strong><span>area</span></strong> <i><span class="varname">area-id</span></i> ] | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> [ <strong><span>all-areas</span></strong> | <strong><span>area</span></strong> <i><span class="varname">area-id</span></i> ] ] [ <strong><span>notify-peer</span></strong> ]</span><p><p>The OSPF multi-area adjacency interface is configured to exit neighbor relationship flapping suppression.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The interface exits flapping suppression in the following scenarios:</p>
<ul><li>The suppression timer expires.</li><li>The corresponding OSPF process is reset.</li><li>An OSPF neighbor is reset using the <a href="cmdqueryname=reset+ospf+peer"><b><span class="cmdname">reset ospf peer</span></b></a> command.</li><li>OSPF neighbor relationship flapping suppression is disabled globally using the <a href="cmdqueryname=suppress-flapping+peer+disable+%28OSPF%29"><b><span class="cmdname">suppress-flapping peer disable (OSPF)</span></b></a> command.</li><li>The <a href="cmdqueryname=reset+ospf+suppress-flapping+peer"><b><span class="cmdname">reset ospf suppress-flapping peer</span></b></a> command is run.</li></ul>
</div></div>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_2058.html">Configuring OSPF Multi-Area Adjacency
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_2062.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_2066.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>