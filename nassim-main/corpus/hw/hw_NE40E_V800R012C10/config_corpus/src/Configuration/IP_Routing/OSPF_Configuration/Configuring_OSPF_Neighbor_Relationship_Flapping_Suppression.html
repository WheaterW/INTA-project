
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring OSPF Neighbor Relationship Flapping Suppression">
<meta name="abstract" content="OSPF neighbor relationship flapping suppression works by delaying OSPF neighbor relationship reestablishment or setting the link cost to the maximum value.">
<meta name="description" content="OSPF neighbor relationship flapping suppression works by delaying OSPF neighbor relationship reestablishment or setting the link cost to the maximum value.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_1053.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0120.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="ospf,w00800033,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00875216">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00875216">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172365599">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring OSPF Neighbor Relationship Flapping Suppression</title>
</head>
<body><a name="EN-US_TASK_0172365599"></a><a name="EN-US_TASK_0172365599"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring OSPF Neighbor Relationship Flapping Suppression</h1>
<div class="taskbody"><p>OSPF neighbor relationship flapping suppression works by delaying OSPF neighbor relationship reestablishment or setting the link cost to the maximum value.</p>
<div class="context"><a name="EN-US_TASK_0172365599__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>If an interface carrying OSPF services frequently alternates between up and down, frequent neighbor relationship flapping will occur. During the flapping, OSPF frequently sends Hello packets to reestablish the neighbor relationship, synchronizes LSDBs, and recalculates routes. In this process, a large number of packets are exchanged, adversely affecting neighbor relationship stability, OSPF services, and other OSPF-dependent services, such as LDP and BGP. OSPF neighbor relationship flapping suppression can address this problem by delaying OSPF neighbor relationship reestablishment or preventing service traffic from passing through flapping links.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The following steps are optional, and choose them as required.</p>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365599__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring OSPF neighbor relationship flapping suppression, complete the following tasks:</p>
<ul><li>Configure an IP address for each interface to ensure that neighboring routers are reachable at the network layer.</li><li><a href="dc_vrp_ospf_cfg_0003.html">Configure basic OSPF functions.</a></li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172365599__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>(Optional) Disable OSPF neighbor relationship flapping suppression globally.</span><p><ol type="a"><li>Run the <a href="cmdqueryname=ospf"><b><span class="cmdname">ospf</span></b></a> [ <i><span class="varname">process-id</span></i> | <strong><span>router-id</span></strong> <i><span class="varname">router-id</span></i> ]<sup>*</sup> command to enter the OSPF view.</li><li>Run the <a href="cmdqueryname=suppress-flapping+peer+disable"><b><span class="cmdname">suppress-flapping peer disable</span></b></a> command to disable OSPF neighbor relationship flapping suppression.</li><li>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</li></ol>
</p><p><p>To disable the function globally, perform this step.</p>
</p></li><li><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span><p><p>The interface view is displayed.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=suppress-flapping+peer+disable"><b><span class="cmdname">suppress-flapping peer disable</span></b></a></span><p><p>OSPF neighbor relationship flapping suppression is disabled on the interface.</p>
</p><p><p>To disable the function on one of the interfaces, perform this step.</p>
</p></li><li><span>Configure an OSPF neighbor relationship flapping suppression mode, which can be Hold-down or Hold-max-cost mode.</span><p><ul><li>Hold-down mode:<p>To configure the Hold-down mode and set its duration, run the <a href="cmdqueryname=ospf+suppress-flapping+peer+hold-down"><b><span class="cmdname">ospf suppress-flapping peer hold-down</span></b></a> <i><span class="varname">interval</span></i> command.</p>
<p>If flooding and topology changes frequently occur during OSPF neighbor relationship establishment, you can configure the Hold-down mode to prevent OSPF neighbor relationship reestablishment within a period of time. This prevents frequent LSDB synchronization and a large number of packets from being exchanged.</p>
</li><li>Hold-max-cost mode:<p>If user service traffic is frequently switched, you can configure OSPF neighbor relationship flapping suppression to work in Hold-max-cost mode. In this mode, the link cost is set to the maximum value (Max-cost) within a period of time, preventing user service traffic from passing through flapping links.</p>
<ol type="a"><li>(Optional) Set the maximum cost for OSPF links.<p>If OSPF neighbor relationship flapping suppression works in Hold-max-cost mode, the device sets the link cost to the maximum value (Max-cost) within a period of time, preventing service traffic from passing through flapping links.</p>
<div class="p">If the value needs to be modified, perform this step.<ol class="substepthirdol"><li><p>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></p>
<p>Return to the system view.</p>
</li><li><p>Run <a href="cmdqueryname=ospf"><b><span class="cmdname">ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ]</p>
<p>The OSPF view is displayed.</p>
</li><li><p>Run <a href="cmdqueryname=maximum-link-cost"><b><span class="cmdname">maximum-link-cost</span></b></a> <i><span class="varname">cost</span></i></p>
<p>The maximum cost of OSPF is changed.</p>
</li><li><p>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></p>
<p>Return to the system view.</p>
</li><li><p>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></p>
<p>The interface view is displayed.</p>
</li></ol>
</div>
</li><li><p>(Optional) Run <a href="cmdqueryname=ospf+suppress-flapping+peer+hold-max-cost+disable"><b><span class="cmdname">ospf suppress-flapping peer hold-max-cost disable</span></b></a></p>
<p>The Hold-max-cost neighbor relationship flapping suppression mode is disabled.</p>
<p>To disable the Hold-max-cost neighbor relationship flapping suppression mode, perform this step.</p>
</li></ol>
</li></ul>
</p><p><p>Flapping suppression can also work first in Hold-down mode and then in Hold-max-cost mode.</p>
</p></li><li><span>Run <a href="cmdqueryname=ospf+suppress-flapping+peer"><b><span class="cmdname">ospf suppress-flapping peer</span></b></a> { <strong><span>detecting-interval</span></strong> <i><span class="varname">detecting-interval</span></i> | <strong><span>threshold</span></strong> <i><span class="varname">threshold</span></i> | <strong><span>resume-interval</span></strong> <i><span class="varname">resume-interval</span></i> }<sup>*</sup></span><p><p>Detection parameters are configured for OSPF neighbor relationship flapping suppression.</p>
</p><p><ul><li><p>Specify an interval for exiting OSPF neighbor relationship flapping suppression.</p>
<p>If the interval between two successive neighbor relationship states (changing from Full to a non-Full state) is longer than the <i><span class="varname">resume-interval</span></i>, the flapping_count is reset.</p>
</li><li>If OSPF neighbor relationship flapping suppression works in Hold-max-cost mode, the value of <i><span class="varname">resume-interval</span></i> indicates the duration of this mode.</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The value of <i><span class="varname">resume-interval</span></i> must be greater than that of <i><span class="varname">detecting-interval</span></i>.</p>
</div></div>
</p><p><p>You can configure detection parameters for OSPF neighbor relationship flapping suppression on specific interfaces according to network conditions. However, using the default values of these parameters is recommended. </p>
</p></li><li><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>The user view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=reset+ospf"><b><span class="cmdname">reset ospf</span></b></a> <i><span class="varname">process-id</span></i> <strong><span>suppress-flapping</span></strong> <strong><span>peer</span></strong> [ <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> ] [ <strong><span>notify-peer</span></strong> ]</span><p><p>Interfaces are forced to exit OSPF neighbor relationship flapping suppression.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces exit flapping suppression in the following scenarios:</p>
<ul><li>The suppression timer expires.</li><li>The corresponding OSPF process is reset.</li><li>An OSPF neighbor is reset using the <a href="cmdqueryname=reset+ospf+peer"><b><span class="cmdname">reset ospf peer</span></b></a> command.</li><li>OSPF neighbor relationship flapping suppression is disabled globally using the <a href="cmdqueryname=suppress-flapping+peer+disable"><b><span class="cmdname">suppress-flapping peer disable</span></b></a> command in the OSPF view.</li><li>The <a href="cmdqueryname=reset+ospf+suppress-flapping+peer"><b><span class="cmdname">reset ospf suppress-flapping peer</span></b></a> command is run.</li></ul>
</div></div>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0172365599__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+ospf"><b><span class="cmdname">display ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ] <strong><span>interface</span></strong> <i><span class="varname">interfaceType</span></i> <em>interfaceNum</em> <strong><span>verbose</span></strong> command to check the status of OSPF neighbor relationship flapping suppression.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0000.html">OSPF Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_1053.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0120.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>