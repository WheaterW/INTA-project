
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a Route Monitoring Group">
<meta name="abstract" content="You can add network-side routes to a route monitoring group and associate access-side service modules with it so that the service modules can perform primary/backup link switchovers upon route changes in the group in a dual-device hot backup scenario. This mechanism can prevent traffic congestion or loss.">
<meta name="description" content="You can add network-side routes to a route monitoring group and associate access-side service modules with it so that the service modules can perform primary/backup link switchovers upon route changes in the group in a dual-device hot backup scenario. This mechanism can prevent traffic congestion or loss.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_route_rmg_0001.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/spec/Route_Monitoring_Group_limitation.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00556928,route-monitor-groupvrp,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Route Monitoring Group">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Route Monitoring Group">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="Route Monitoring Group">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00809835">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00414125">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172366647">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a Route Monitoring Group</title>
</head>
<body><a name="EN-US_TASK_0172366647"></a><a name="EN-US_TASK_0172366647"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a Route Monitoring Group</h1>
<div class="taskbody"><p>You can add network-side routes to a route monitoring group and associate access-side service modules with it so that the service modules can perform primary/backup link switchovers upon route changes in the group in a dual-device hot backup scenario. This mechanism can prevent traffic congestion or loss.</p>
<div class="steps-unordered"><a name="EN-US_TASK_0172366647__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure a route monitoring group.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ip+route-monitor-group"><b><span class="cmdname">ip route-monitor-group</span></b></a> <i><span class="varname">group-name</span></i></span><p><p>A route monitoring group is created, and the route monitoring group view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=track+ip+route"><b><span class="cmdname">track ip route</span></b></a> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <i><span class="varname">destination</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } [ <strong><span>down-weight</span></strong> <i><span class="varname">down-weight-value</span></i> ]</span><p><p>A route is added to the route monitoring group.</p>
</p><p><p>To add more routes to the route monitoring group, repeat this step.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=trigger-up-delay"><b><span class="cmdname">trigger-up-delay</span></b></a> <i><span class="varname">delay-value</span></i></span><p><p>A delay is configured for the RM module to instruct the service module associated with the route monitoring group to perform a switchback.</p>
</p><p><p>When a route in a route monitoring group becomes active again, the RM module needs to re-deliver the route to the forwarding table and create forwarding entries, which takes some time. If the RM module immediately instructs the service module to perform a link switchover, packet loss may occur. To prevent this problem, run the <a href="cmdqueryname=trigger-up-delay"><b><span class="cmdname">trigger-up-delay</span></b></a> command to configure a delay for the RM module to instruct the service module to perform a link switchback so that the RM module instructs the service module to perform a link switchback after forwarding entries are created.</p>
<p>If the value of <i><span class="varname">delay-value</span></i> is set to 0, the RM module instructs the service module to perform a link switchback immediately when the down-weight sum of the route monitoring group falls below the switchback threshold.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=monitor+enable"><b><span class="cmdname">monitor enable</span></b></a></span><p><p>The route monitoring group is enabled.</p>
</p><p><p>When a large number of routes are added to or deleted from a route monitoring group, the down-weight sum of the route monitoring group may change frequently, which in turn leads to service flapping of the service modules associated with the route monitoring group. To prevent such service flapping, run the <a href="cmdqueryname=undo+monitor+enable"><b><span class="cmdname">undo monitor enable</span></b></a> command to disable the route monitoring group so that it is dissociated from all service modules. After the configuration is complete, run the <a href="cmdqueryname=monitor+enable"><b><span class="cmdname">monitor enable</span></b></a> command to re-associate the route monitoring group with the service modules.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the route monitoring group view.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span><p><p>The access-side interface view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=track+route-monitor-group"><b><span class="cmdname">track route-monitor-group</span></b></a> <i><span class="varname">groupName</span></i> [ <strong><span>trigger-down-weight</span></strong> <i><span class="varname">downWeight</span></i> ]</span><p><p>The interface is configured to track the route monitoring group.</p>
</p><p><p>An interface that tracks a route monitoring group is called a track interface. To allow multiple interfaces to track the same IPv4 route monitoring group, run this command on the interfaces one by one.</p>
<p>After an IPv4 route monitoring group is created and routes are added to the group, to use the IPv4 route monitoring group to trigger the status change of a user-side interface, run this command to associate the interface with the IPv4 route monitoring group. When the down-weight sum of the IPv4 route monitoring group reaches the set <em>downWeight</em> value, the status of the interface is set to Down, and services are switched to the backup link. When the down-weight sum of the IPv4 route monitoring group falls below the configured <em>downWeight</em> value, the status of the interface is set to Up again, and services are switched back to the primary link. In this manner, the user-side interface can detect network-side route faults in time, ensuring user-side service reliability.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure an IPv6 route monitoring group.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv6+route-monitor-group"><b><span class="cmdname">ipv6 route-monitor-group</span></b></a> <i><span class="varname">group-name</span></i></span><p><p>An IPv6 route monitoring group is created, and the route monitoring group view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=track+ipv6+route"><b><span class="cmdname">track ipv6 route</span></b></a> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <i><span class="varname">destination</span></i> <i><span class="varname">mask-length</span></i> [ <strong><span>down-weight</span></strong> <i><span class="varname">down-weight-value</span></i> ]</span><p><p>An IPv6 route is added to the IPv6 route monitoring group.</p>
</p><p><p>To add more IPv6 routes to the route monitoring group, repeat this step.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=trigger-up-delay"><b><span class="cmdname">trigger-up-delay</span></b></a> <i><span class="varname">delay-value</span></i></span><p><p>A delay is configured for the IPv6 RM module to instruct the service module associated with the IPv6 route monitoring group to perform a switchback.</p>
</p><p><p>When an IPv6 route in an IPv6 route monitoring group becomes active again, the IPv6 RM module needs to re-deliver the route to the forwarding table and create forwarding entries, which takes some time. If the IPv6 RM module immediately instructs the service module to perform a link switchover, packet loss may occur. To prevent this problem, run the <a href="cmdqueryname=trigger-up-delay"><b><span class="cmdname">trigger-up-delay</span></b></a> command to configure a delay for the IPv6 RM module to instruct the service module to perform a link switchback so that the RM module instructs the service module to perform a link switchback after forwarding entries are created.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the value of <i><span class="varname">delay-value</span></i> is set to 0, the IPv6 RM module instructs the service module to perform a link switchback immediately when the down-weight sum of the route monitoring group falls below the switchback threshold. In the case of immediate switchback, packet loss may occur. To prevent this problem, run the <strong>trigger-up-delay</strong> command to configure a delay for the RM module to instruct the service module to perform a link switchback so that the RM module instructs the service module to perform a link switchback after forwarding entries are created.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=monitor+enable"><b><span class="cmdname">monitor enable</span></b></a></span><p><p>The IPv6 route monitoring group is enabled.</p>
</p><p><p>When a large number of IPv6 routes are added to or deleted from an IPv6 route monitoring group, the down-weight sum of the route monitoring group may change frequently, which in turn leads to service flapping of the service modules associated with the route monitoring group. To prevent such service flapping, run the <a href="cmdqueryname=undo+monitor+enable"><b><span class="cmdname">undo monitor enable</span></b></a> command to disable the IPv6 route monitoring group so that it is dissociated from all service modules. After the configuration is complete, run the <a href="cmdqueryname=monitor+enable"><b><span class="cmdname">monitor enable</span></b></a> command to re-associate the route monitoring group with the service modules.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Exit the route monitoring group view.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span><p><p>The access-side interface view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=track+ipv6+route-monitor-group"><b><span class="cmdname">track ipv6 route-monitor-group</span></b></a> <i><span class="varname">groupName</span></i> [ <strong><span>trigger-down-weight</span></strong> <i><span class="varname">downWeight</span></i> ]</span><p><p>The interface is configured to track the IPv6 route monitoring group.</p>
</p><p><p>An interface that tracks a route monitoring group is called a track interface. To allow multiple interfaces to track the same IPv6 route monitoring group, run this command on the interfaces one by one.</p>
<p>After an IPv6 route monitoring group is created and routes are added to the group, to use the IPv6 route monitoring group to trigger the status change of a user-side interface, run this command to associate the interface with the IPv6 route monitoring group. When the down-weight sum of the IPv6 route monitoring group reaches the set <i><span class="varname">downWeight</span></i> value, the status of the interface is set to Down, and services are switched to the backup link. When the down-weight sum of the IPv6 route monitoring group falls below the configured <i><span class="varname">downWeight</span></i> value, the status of the interface is set to Up again, and services are switched back to the primary link. In this manner, the user-side interface can detect network-side route faults in time, ensuring user-side service reliability.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
<div class="example"><a name="EN-US_TASK_0172366647__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Example</h4><div class="p">After configuring the route monitoring group, check the configurations.<ul><li>Run the <a href="cmdqueryname=display+ip+route-monitor-group"><b><span class="cmdname">display ip route-monitor-group</span></b></a> [ <i><span class="varname">group-name</span></i> ] command to check route monitoring group information.</li><li>Run the <a href="cmdqueryname=display+ip+route-monitor-group+track-route"><b><span class="cmdname">display ip route-monitor-group track-route</span></b></a> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <i><span class="varname">dest-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } command to check information about all route monitoring groups to which a route has been added.</li><li>Run the <a href="cmdqueryname=display+ipv6+route-monitor-group"><b><span class="cmdname">display ipv6 route-monitor-group</span></b></a> [ <i><span class="varname">group-name</span></i> ] command to check IPv6 route monitoring group information.</li><li>Run the <a href="cmdqueryname=display+ipv6+route-monitor-group+track-route"><b><span class="cmdname">display ipv6 route-monitor-group track-route</span></b></a> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <i><span class="varname">destination</span></i> <i><span class="varname">mask-length</span></i> command to check information about all IPv6 route monitoring groups to which a route has been added.</li></ul>
</div>
</div>
<div class="postreq"><a name="EN-US_TASK_0172366647__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Follow-up Procedure</h4>
<div class="p"><p>Associate service modules with the status of a route monitoring group in a dual-device hot backup scenario. This prevents traffic overload and forwarding failures when the primary link on the network side fails and thus improves user experience.</p>
</div></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_route_rmg_0001.html">Route Monitoring Group Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/spec/Route_Monitoring_Group_limitation.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>