
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Association between LDP and Static Routes">
<meta name="abstract" content="On an MPLS network with primary and secondary LSPs established by LSRs using static routes, association between LDP and static routes prevents traffic from being interrupted during traffic switchover or switchback.">
<meta name="description" content="On an MPLS network with primary and secondary LSPs established by LSRs using static routes, association between LDP and static routes prevents traffic from being interrupted during traffic switchover or switchback.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_static-route_disjoin_cfg_0016.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_static-route_disjoin_cfg_0021.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,static-routevrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Static Route">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Static Route">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="Static Route">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="Static Route">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00809835">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="s00826690">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172365470">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring Association between LDP and Static Routes</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172365470"></a><a name="EN-US_TASK_0172365470"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Association between LDP and Static Routes</h1>
<div class="taskbody"><p>On an MPLS network with primary and secondary LSPs established by LSRs using static routes, association between LDP and static routes prevents traffic from being interrupted during traffic switchover or switchback.</p>
<div class="context"><a name="EN-US_TASK_0172365470__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On an MPLS network with primary and secondary LSPs established by LSRs using static routes, if association between LDP and static routes is not enabled, traffic is interrupted for a short period of time during traffic switchover from the primary LSP to the secondary LSP when the LDP session on the primary link fails (not because of a link fault) or during traffic switchback when the primary link recovers from a fault.</p>
<p>In <a href="#EN-US_TASK_0172365470__fig_dc_vrp_cfg_006201">Figure 1</a>, LSRA has two static routes to LSRD. One of the static routes passes through LSRB, whereas the other static route passes through LSRC. LDP LSPs are established based on the static routes. Link A is the primary link, whereas link B is the backup link. It is required that association between LDP and static routes be configured to prevent MPLS traffic from being interrupted if the LDP session on link A fails or link A recovers from a fault.</p>
<div class="fignone" id="EN-US_TASK_0172365470__fig_dc_vrp_cfg_006201"><a name="EN-US_TASK_0172365470__fig_dc_vrp_cfg_006201"></a><a name="fig_dc_vrp_cfg_006201"></a><span class="figcap"><b>Figure 1 </b>Configuring association between LDP and static routes</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent GE <span>0/1/0</span> and GE <span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_static-route_cfg_000601.png" width="NaN" height="NaN"></span><br></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" char="." valign="top" width="16.666666666666664%" id="mcps1.4.1.5.1.7.1.1" liSelected="liSelected"><p>Device Name</p>
</th>
<th align="left" class="cellrowborder" char="." valign="top" width="16.666666666666664%" id="mcps1.4.1.5.1.7.1.2" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" char="." valign="top" width="16.666666666666664%" id="mcps1.4.1.5.1.7.1.3" liSelected="liSelected"><p>IP Address</p>
</th>
<th align="left" class="cellrowborder" char="." valign="top" width="16.666666666666664%" id="mcps1.4.1.5.1.7.1.4" liSelected="liSelected"><p>Device Name</p>
</th>
<th align="left" class="cellrowborder" char="." valign="top" width="16.666666666666664%" id="mcps1.4.1.5.1.7.1.5" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" char="." valign="top" width="16.666666666666664%" id="mcps1.4.1.5.1.7.1.6" liSelected="liSelected"><p>IP Address</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="3" char="." valign="top" width="16.666666666666664%" headers="mcps1.4.1.5.1.7.1.1 "><p>LSRA</p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" char="." valign="top" width="16.666666666666664%" headers="mcps1.4.1.5.1.7.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="16.666666666666664%" headers="mcps1.4.1.5.1.7.1.3 "><p>10.1.1.1/30</p>
</td>
<td class="cellrowborder" rowspan="3" char="." valign="top" width="16.666666666666664%" headers="mcps1.4.1.5.1.7.1.4 "><p>LSRC</p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" char="." valign="top" width="16.666666666666664%" headers="mcps1.4.1.5.1.7.1.5 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="16.666666666666664%" headers="mcps1.4.1.5.1.7.1.6 "><p>10.2.1.2/30</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.5.1.7.1.2 "><p>GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.5.1.7.1.3 "><p>10.2.1.1/30</p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.5.1.7.1.5 "><p>GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.5.1.7.1.6 "><p>10.4.1.1/30</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.5.1.7.1.2 "><p>Loopback0</p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.5.1.7.1.3 "><p>1.1.1.1/32</p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.5.1.7.1.5 "><p>Loopback0</p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.5.1.7.1.6 "><p>3.3.3.3/32</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" char="." valign="top" width="16.666666666666664%" headers="mcps1.4.1.5.1.7.1.1 "><p>LSRB</p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" char="." valign="top" width="16.666666666666664%" headers="mcps1.4.1.5.1.7.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="16.666666666666664%" headers="mcps1.4.1.5.1.7.1.3 "><p>10.1.1.2/30</p>
</td>
<td class="cellrowborder" rowspan="3" char="." valign="top" width="16.666666666666664%" headers="mcps1.4.1.5.1.7.1.4 "><p>LSRD</p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" char="." valign="top" width="16.666666666666664%" headers="mcps1.4.1.5.1.7.1.5 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="16.666666666666664%" headers="mcps1.4.1.5.1.7.1.6 "><p>10.3.1.2/30</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.5.1.7.1.2 "><p>GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.5.1.7.1.3 "><p>10.3.1.1/30</p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.5.1.7.1.5 "><p>GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.5.1.7.1.6 "><p>10.4.1.2/30</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.5.1.7.1.2 "><p>Loopback0</p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.5.1.7.1.3 "><p>2.2.2.2/32</p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.5.1.7.1.5 "><p>Loopback0</p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.4.1.5.1.7.1.6 "><p>4.4.4.4/32</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365470__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure static routes for each LSP to reach other LSRs.</p>
</li><li><p>Enable MPLS and MPLS LDP globally and on interfaces of LSRs.</p>
</li><li><p>Configure association between LDP and static routes and check configurations.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365470__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IP addresses of interfaces on LSRs</p>
</li><li><p>MPLS LSR IDs of LSRs</p>
</li><li><p>Hold-down timer value</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172365470__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address and mask to each interface.</span><p><p>Configure an IP address for each interface based on <a href="#EN-US_TASK_0172365470__fig_dc_vrp_cfg_006201">Figure 1</a>. For detailed configurations, see Configuration Files.</p>
</p></li><li><span>Configure static routes on each node to ensure network connectivity.</span><p><p># Configure two static routes with different priorities from LSRA to LSRD, and two static routes with different priorities from LSRD to LSRA.</p>
<p># Configure LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>ip route-static 2.2.2.2 32 <span>GigabitEthernet<span>0/1/0</span></span> 10.1.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA] <strong>ip route-static 3.3.3.3 32 <span>GigabitEthernet<span>0/2/0</span></span> 10.2.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA] <strong>ip route-static 10.3.1.1 30 <span>GigabitEthernet<span>0/1/0</span></span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA] <strong>ip route-static 10.4.1.1 30 <span>GigabitEthernet<span>0/2/0</span></span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA] <strong>ip route-static 4.4.4.4 32 <span>GigabitEthernet<span>0/1/0</span></span> 10.1.1.2 preference 40</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA] <strong>ip route-static 4.4.4.4 32 <span>GigabitEthernet<span>0/2/0</span></span> 10.2.1.2 preference 60</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA] <strong>commit</strong></pre>
<p># Configure LSRB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB] <strong>ip route-static 1.1.1.1 32 <span>GigabitEthernet<span>0/1/0</span></span> 10.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB] <strong>ip route-static 4.4.4.4 32 <span>GigabitEthernet<span>0/2/0</span></span> 10.3.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB] <strong>commit</strong></pre>
<p># Configure LSRC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC] <strong>ip route-static 1.1.1.1 32 <span>GigabitEthernet<span>0/1/0</span></span> 10.2.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC] <strong>ip route-static 4.4.4.4 32 <span>GigabitEthernet<span>0/2/0</span></span> 10.4.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC] <strong>commit</strong></pre>
<p># Configure LSRD.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD] <strong>ip route-static 2.2.2.2 32 <span>GigabitEthernet<span>0/1/0</span></span> 10.3.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD] <strong>ip route-static 3.3.3.3 32 <span>GigabitEthernet<span>0/2/0</span></span> 10.4.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD] <strong>ip route-static 10.1.1.2 30 <span>GigabitEthernet<span>0/1/0</span></span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD] <strong>ip route-static 10.2.1.2 30 <span>GigabitEthernet<span>0/2/0</span></span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD] <strong>ip route-static 1.1.1.1 32 <span>GigabitEthernet<span>0/1/0</span></span> 10.3.1.1 preference 40</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD] <strong>ip route-static 1.1.1.1 32 <span>GigabitEthernet<span>0/2/0</span></span> 10.4.1.1 preference 60</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD] <strong>commit</strong></pre>
<p># After completing the configurations, run the <strong>display ip routing-table protocol static</strong> command on each node to check the static route configurations. The following example uses the command output on LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>display ip routing-table protocol static</strong></pre>
<pre class="screen">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route
------------------------------------------------------------------------------
_public_ Routing Table : Static
         Destinations : 5        Routes : 5        Configured Routes : 5         

Static routing table status : 
         Destinations : 5        Routes : 5         

Destination/Mask    Proto   Pre  Cost      Flags NextHop         Interface

        2.2.2.2/32  Static  60   0           D   10.1.1.1        <span>GigabitEthernet<span>0/1/0</span></span>
        3.3.3.3/32  Static  60   0           D   10.2.1.1        <span>GigabitEthernet<span>0/2/0</span></span>
       <strong>4.4.4.4/32</strong>  Static  <strong>40</strong>   0           D   10.1.1.1        <strong><span>GigabitEthernet<span>0/1/0</span></span></strong>
       10.3.1.0/30  Static  60   0           D   10.1.1.1        <span>GigabitEthernet<span>0/1/0</span></span>
       10.4.1.0/30  Static  60   0           D   10.2.1.1        <span>GigabitEthernet<span>0/2/0</span></span>

Static routing table status : &lt;Inactive&gt;
         Destinations : 0        Routes : 0</pre>
</p></li><li><span>Enable MPLS LDP on each LSR to set up LDP LSPs.</span><p><p># Configure LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>mpls lsr-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls-ldp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-mpls-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>interface <span>GigabitEthernet<span>0/1/0</span></span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-<span>GigabitEthernet<span>0/1/0</span></span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-<span>GigabitEthernet<span>0/1/0</span></span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-<span>GigabitEthernet<span>0/1/0</span></span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-<span>GigabitEthernet<span>0/1/0</span></span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>interface <span>GigabitEthernet<span>0/2/0</span></span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-<span>GigabitEthernet<span>0/2/0</span></span>] <strong>mpls</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-<span>GigabitEthernet<span>0/2/0</span></span>] <strong>mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-<span>GigabitEthernet<span>0/2/0</span></span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-<span>GigabitEthernet<span>0/2/0</span></span>] <strong>quit</strong></pre>
<p>Repeat this step for LSRB, LSRC, and LSRD. For detailed configurations, see Configuration Files.</p>
<p># Run the <strong>display mpls ldp session</strong> command on each node. The command output shows that an LDP session has been established (in the <strong>Operational</strong> state). The following example uses the command output on LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>display mpls ldp session</strong>
 LDP Session(s) in Public Network
 Codes: LAM(Label Advertisement Mode), SsnAge Unit(DDDD:HH:MM)
 An asterisk (*) before a session means the session is being deleted.
 ------------------------------------------------------------------------------
 PeerID             Status      LAM  SsnRole  SsnAge      KASent/Rcv
 ------------------------------------------------------------------------------
 2.2.2.2:0          <strong>Operational</strong> DU   Passive  0000:15:34  3738/3738
 3.3.3.3:0          <strong>Operational</strong> DU   Passive  0000:00:45  182/182
 ------------------------------------------------------------------------------
 TOTAL: 2 Session(s) Found.</pre>
</p></li><li><span>Configure association between LDP and static routes on LSRA and LSRD.</span><p><p># Configure LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>ip route-static 4.4.4.4 32 <span>GigabitEthernet<span>0/1/0</span></span> 10.1.1.2 preference 40 ldp-sync</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA] <strong>interface <span>GigabitEthernet<span>0/1/0</span></span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-<span>GigabitEthernet<span>0/1/0</span></span>] <strong>static-route timer ldp-sync hold-down 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-<span>GigabitEthernet<span>0/1/0</span></span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA-<span>GigabitEthernet<span>0/1/0</span></span>] <strong>quit</strong></pre>
<p># Configure LSRD.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD] <strong>ip route-static 1.1.1.1 32 <span>GigabitEthernet<span>0/1/0</span></span> 10.3.1.1 preference 40 ldp-sync</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD] <strong>interface <span>GigabitEthernet<span>0/1/0</span></span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-<span>GigabitEthernet<span>0/1/0</span></span>] <strong>static-route timer ldp-sync hold-down 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRD-<span>GigabitEthernet<span>0/1/0</span></span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRD-<span>GigabitEthernet<span>0/1/0</span></span>] <strong>quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Check the status of the outbound interface of the static route associated with LDP on LSRA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA] <strong>display static-route ldp-sync</strong></pre>
<pre class="screen">Total number of routes enable Ldp-Sync: 1
-----------------------------------------------------
Interface <span>GigabitEthernet<span>0/1/0</span></span>
Enable ldp-sync static routes number: 1
<strong>Static-route ldp-sync holddown timer: 20s</strong>
<strong>Sync state: Normal</strong>
Dest = 4.4.4.4, Mask = 32, NextHop = 10.1.1.2.
-----------------------------------------------------</pre>
<p>The command output shows that association between LDP and static routes has been configured (in <strong>Normal</strong> state).</p>
<ul><li><p>When the LDP session on the primary link is interrupted, traffic is immediately switched to the backup link (link B) to ensure association between the static route and LSP.</p>
</li><li><p>If link A fails and then recovers, the static route with the next hop of 10.1.1.2 is not preferentially selected until the hold-down timer (20 seconds) expires (by then the LDP session on link A has been set up). Then traffic is switched back to link A. In this way, association between LDP and static routes is ensured, and MPLS traffic is not interrupted.</p>
</li></ul>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172365470__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li>LSRA configuration file<pre class="screen">#
sysname LSRA
#
mpls lsr-id 1.1.1.1
#
mpls
#
mpls ldp
#
interface <span>GigabitEthernet<span>0/1/0</span></span>
 undo shutdown
 ip address 10.1.1.1 255.255.255.252
 static-route timer ldp-sync hold-down 20
 mpls
 mpls ldp
#
interface <span>GigabitEthernet<span>0/2/0</span></span>
 undo shutdown
 ip address 10.2.1.1 255.255.255.252
 mpls
 mpls ldp
#
interface LoopBack0
 ip address 1.1.1.1 255.255.255.255
#
 ip route-static 2.2.2.2 255.255.255.255 <span>GigabitEthernet<span>0/1/0</span></span> 10.1.1.2
 ip route-static 3.3.3.3 255.255.255.255 <span>GigabitEthernet<span>0/2/0</span></span> 10.2.1.2
 ip route-static 4.4.4.4 255.255.255.255 <span>GigabitEthernet<span>0/1/0</span></span> 10.1.1.2 preference 40 ldp-sync
 ip route-static 4.4.4.4 255.255.255.255 <span>GigabitEthernet<span>0/2/0</span></span> 10.2.1.2
 ip route-static 10.3.1.0 255.255.255.252 <span>GigabitEthernet<span>0/1/0</span></span>
 ip route-static 10.4.1.0 255.255.255.252 <span>GigabitEthernet<span>0/2/0</span></span>
#
return</pre>
</li><li>LSRB configuration file<pre class="screen">#
sysname LSRB
#
mpls lsr-id 2.2.2.2
#
mpls
#
mpls ldp
#
interface <span>GigabitEthernet<span>0/1/0</span></span>
 undo shutdown
 ip address 10.1.1.2 255.255.255.252
 mpls
 mpls ldp
#
interface <span>GigabitEthernet<span>0/2/0</span></span>
 undo shutdown
 ip address 10.3.1.1 255.255.255.252
 mpls
 mpls ldp
#
interface LoopBack0
 ip address 2.2.2.2 255.255.255.255
#
 ip route-static 1.1.1.1 255.255.255.255 <span>GigabitEthernet<span>0/1/0</span></span> 10.1.1.1
 ip route-static 4.4.4.4 255.255.255.255 <span>GigabitEthernet<span>0/2/0</span></span> 10.3.1.2
#
return</pre>
</li><li>LSRC configuration file<pre class="screen">#
sysname LSRC
#
mpls lsr-id 3.3.3.3
#
mpls
#
mpls ldp
#
interface <span>GigabitEthernet<span>0/1/0</span></span>
 undo shutdown
 ip address 10.2.1.2 255.255.255.252
 mpls
 mpls ldp
#
interface <span>GigabitEthernet<span>0/2/0</span></span>
 undo shutdown
 ip address 10.4.1.1 255.255.255.252
 mpls
 mpls ldp
#
interface LoopBack0
 ip address 3.3.3.3 255.255.255.255
#
 ip route-static 1.1.1.1 255.255.255.255 <span>GigabitEthernet<span>0/1/0</span></span> 10.2.1.1
 ip route-static 4.4.4.4 255.255.255.255 <span>GigabitEthernet<span>0/2/0</span></span> 10.4.1.2
#
return</pre>
</li><li>LSRD configuration file<pre class="screen">#
sysname LSRD
#
mpls lsr-id 4.4.4.4
#
mpls
#
mpls ldp
#
interface <span>GigabitEthernet<span>0/1/0</span></span>
 undo shutdown
 ip address 10.3.1.2 255.255.255.252
 static-route timer ldp-sync hold-down 20
 mpls
 mpls ldp
#
interface <span>GigabitEthernet<span>0/2/0</span></span>
 undo shutdown
 ip address 10.4.1.2 255.255.255.252
 mpls
 mpls ldp
#
interface LoopBack0
 ip address 4.4.4.4 255.255.255.255
#
 ip route-static 1.1.1.1 255.255.255.255 <span>GigabitEthernet<span>0/1/0</span></span> 10.3.1.1 preference 40 ldp-sync
 ip route-static 1.1.1.1 255.255.255.255 <span>GigabitEthernet<span>0/2/0</span></span> 10.4.1.1
 ip route-static 2.2.2.2 255.255.255.255 <span>GigabitEthernet<span>0/1/0</span></span> 10.3.1.1
 ip route-static 3.3.3.3 255.255.255.255 <span>GigabitEthernet<span>0/2/0</span></span> 10.4.1.1
 ip route-static 10.1.1.0 255.255.255.252 <span>GigabitEthernet<span>0/1/0</span></span>
 ip route-static 10.2.1.0 255.255.255.252 <span>GigabitEthernet<span>0/2/0</span></span>
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_static-route_disjoin_cfg_0016.html">Configuration Examples for IPv4 Static Routes
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_static-route_disjoin_cfg_0021.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>