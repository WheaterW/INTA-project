
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a Route-Policy">
<meta name="abstract" content="A route-policy is used to match routes or route attributes, and to change route attributes when the matching rules are met.">
<meta name="description" content="A route-policy is used to match routes or route attributes, and to change route attributes when the matching rules are met.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0027.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0028.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0030.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,bgpvrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP IPv6">
<meta name="featuretype" content="IP Route">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP IPv6">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP IPv6">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="w00604599">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00615954">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172366452">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a Route-Policy</title>
</head>
<body><a name="EN-US_TASK_0172366452"></a><a name="EN-US_TASK_0172366452"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a Route-Policy</h1>
<div class="taskbody"><p>A route-policy is used to match routes or route attributes, and to change route attributes when the matching rules are met.</p>
<div class="context"><a name="EN-US_TASK_0172366452__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>A route-policy is used to match routes or route attributes, and to change route attributes when the matching rules are met.</p>
<p>A route-policy consists of multiple nodes, and each node can comprise the following clauses:</p>
<ul><li><p><a href="#EN-US_TASK_0172366452__step1883863273214039">if-match clause</a></p>
<p>The clauses define the matching rules of a route-policy. The matching objects are route attributes.</p>
</li><li><p><a href="#EN-US_TASK_0172366452__step1099439341214039">apply clause</a></p>
<p>The clauses specify actions. Configuration commands are run after a route meets the matching rules specified by the <strong>if-match</strong> clauses. The <strong>apply</strong> clauses can change certain route attributes.</p>
</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This section describes only the BGP4+ route-policy. For detailed information about route-policy configurations, see "Routing Policy Configuration."</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172366452__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Create a route-policy.</span><ol type="a"><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=route-policy"><b><span class="cmdname">route-policy</span></b></a> <i><span class="varname">route-policy-name</span></i> <i><span class="varname">matchMode</span></i> <strong><span>node</span></strong> <i><span class="varname">node</span></i></span><p><p>A route-policy is created, and the view of the route-policy is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0172366452__step1883863273214039"><span id="EN-US_TASK_0172366452__">Configure <strong>if-match</strong> clauses.</span><ol type="a"><li class="substepexpand"><span>Run the following command to configure the <strong>if-match</strong> clause for the current node in the route-policy as required:</span><p><ul><li><p>To match the AS_Path attribute of BGP4+ routes, run the <a href="cmdqueryname=if-match+as-path-filter"><b><span class="cmdname">if-match as-path-filter</span></b></a> <i><span class="varname">apfIndex</span></i> &amp;&lt;1-16&gt; command.</p>
</li><li><p>To match BGP4+ routes against the community attribute:</p>
<ul><li><p><a href="cmdqueryname=if-match+community-filter+whole-match"><b><span class="cmdname">if-match community-filter</span></b></a> { <i><span class="varname">basic-comm-filter-num</span></i> [ <strong><span>whole-match</span></strong> ] | <i><span class="varname">adv-comm-filter-num</span></i> [ <strong><span>sort-match</span></strong> ] }<sup>*</sup> &amp;&lt;1-16&gt;</p>
</li><li><p><a href="cmdqueryname=if-match+community-filter+whole-match"><b><span class="cmdname">if-match community-filter</span></b></a> <i><span class="varname">comm-filter-name</span></i> [ <strong><span>whole-match</span></strong> | <strong><span>sort-match</span></strong> ]</p>
</li></ul>
</li><li>To match BGP4+ routes against the Large-community attribute, run the <a href="cmdqueryname=if-match+large-community-filter+whole-match"><b><span class="cmdname">if-match large-community-filter</span></b></a> <i><span class="varname">large-comm-filter-name</span></i> [ <strong><span>whole-match</span></strong> ] command.</li><li>To match BGP4+ routes against the VPN target extended community attribute, run the <a href="cmdqueryname=if-match+extcommunity-filter"><b><span class="cmdname">if-match extcommunity-filter</span></b></a> { { <i><span class="varname">basic-extcomm-filter-num</span></i> [ <strong><span>matches-all</span></strong> | <strong><span>whole-match</span></strong> ] | <i><span class="varname">adv-extcomm-filter-num</span></i> } &amp;&lt;1-16&gt; | <i><span class="varname">extcomm-filter-name</span></i> [ <strong><span>matches-all</span></strong> | <strong><span>whole-match</span></strong> ] } command.</li><li><p>To match BGP4+ routes against the SoO extended community attribute, run the <a href="cmdqueryname=if-match+extcommunity-list+soo"><b><span class="cmdname">if-match extcommunity-list soo</span></b></a> <i><span class="varname">extcomm-filter-name</span></i> command.</p>
</li></ul>
<p>The commands can be executed in any sequence. A node may have multiple or no <strong>if-match</strong> clauses.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>The relationship between the <strong>if-match</strong> clauses for a node of a route-policy is "AND". A route must meet all the matching rules before the action defined by the <strong>apply</strong> clause is performed.</p>
</li><li><p>If no <strong>if-match</strong> clause is specified, all the routes are matched.</p>
</li></ul>
</div></div>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0172366452__step1099439341214039"><span id="EN-US_TASK_0172366452__">Configure the <strong>apply</strong> clause.</span><ol type="a"><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=route-policy"><b><span class="cmdname">route-policy</span></b></a> <i><span class="varname">route-policy-name</span></i> <em><i><span class="varname">matchMode</span></i></em> <strong><span>node</span></strong> <i><span class="varname">node</span></i></span><p><p>The route-policy view is displayed.</p>
</p></li><li class="substepexpand"><span>Run the following command as needed to configure the <strong>apply</strong> clause for the current node in the route-policy:</span><p><ul><li><p>To replace the AS numbers in the AS_Path attribute of BGP4+ routes or add the specified AS number to the AS_Path attribute, run the <a href="cmdqueryname=apply+as-path+additive+overwrite+delete+additive+overwrite"><b><span class="cmdname">apply as-path</span></b></a> { <i><span class="varname">as-path-value</span></i> } &amp;&lt;1-128&gt; { <strong><span>additive</span></strong> | <strong><span>overwrite</span></strong><span> | <strong><span>delete</span></strong></span> }<span> or <a href="cmdqueryname=apply+as-path+additive+overwrite+delete"><b><span class="cmdname">apply as-path</span></b></a> <i><span class="varname">asValues</span></i> { <strong><span>additive</span></strong> | <strong><span>overwrite</span></strong> | <strong><span>delete</span></strong> }</span> command.</p>
</li><li><p>To delete a specified BGP4+ community attribute, run the <a href="cmdqueryname=apply+comm-filter"><b><span class="cmdname">apply comm-filter</span></b></a> <a href="cmdqueryname=delete"><b><span class="cmdname">delete</span></b></a> command.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The <a href="cmdqueryname=apply+comm-filter+delete"><b><span class="cmdname">apply comm-filter delete</span></b></a> command deletes a specified community attribute from matched routes based on the referenced community filter. To delete multiple community attributes through one community filter, you need to run the <a href="cmdqueryname=ip+community-filter"><b><span class="cmdname">ip community-filter</span></b></a> command multiple times to configure multiple indexes for the filter, with each index corresponding to only one community attribute. If multiple community attributes are specified in the same index of the same community filter, none of them can be deleted in this case. For example, see the <em><span class="keyword">HUAWEI NE40E-M2 series</span> <span class="keyword">Universal Service Router</span> Command Reference</em>.</p>
</div></div>
</li><li>To delete community attributes of BGP4+ routes, run the <a href="cmdqueryname=apply+community+none"><b><span class="cmdname">apply community</span></b></a> <strong><span>none</span></strong> command.</li><li>To set the community attribute of matched BGP4+ routes, run the <a href="cmdqueryname=apply+community+internet+no-advertise+no-export"><b><span class="cmdname">apply community </span></b></a>{ <i><span class="varname">cmntyValue</span></i> | <i><span class="varname">cmntyNum</span></i> | <strong><span>internet</span></strong> | <strong><span>no-advertise</span></strong> | <strong><span>no-export</span></strong> | <strong><span>no-export-subconfed</span></strong> } &amp;&lt;1-32&gt; [ <strong><span>additive</span></strong> ]<span> or <a href="cmdqueryname=apply+community+community-list"><b><span class="cmdname">apply community</span></b></a> <strong><span>community-list</span></strong> <i><span class="varname">community-list-name</span></i></span> command.<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Before running the <a href="cmdqueryname=apply+community+community-list"><b><span class="cmdname">apply community</span></b></a> <strong><span>community-list</span></strong> <i><span class="varname">community-list-name</span></i> command, you need to run the <a href="cmdqueryname=ip+community-list"><b><span class="cmdname">ip community-list</span></b></a> command to configure a BGP community list and run the <a href="cmdqueryname=community"><b><span class="cmdname">community</span></b></a> command to configure community attributes for the list.</p>
</div></div>
</li><li>To delete the Large-Community attribute of BGP4+ routes, run the <a href="cmdqueryname=apply+large-community+none"><b><span class="cmdname">apply large-community</span></b></a> <strong><span>none</span></strong> command.</li><li>To set the Large-Community attribute of BGP4+ routes, run the <a href="cmdqueryname=apply+large-community+additive+overwrite+delete"><b><span class="cmdname">apply large-community</span></b></a> { <i><span class="varname">aa:bb:cc</span></i> } &amp;&lt;1-16&gt; { <strong><span>additive</span></strong> | <strong><span>overwrite</span></strong> | <strong><span>delete</span></strong> } or <a href="cmdqueryname=apply+large-community-list+additive+overwrite+delete"><b><span class="cmdname">apply large-community-list</span></b></a> <i><span class="varname">large-community-list-name</span></i> { <strong><span>additive</span></strong> | <strong><span>overwrite</span></strong> | <strong><span>delete</span></strong> } command.</li><li>To set the BGP4+ VPN target extended community attribute, run the <a href="cmdqueryname=apply+extcommunity+rt+additive"><b><span class="cmdname">apply extcommunity</span></b></a> { <strong><span>rt</span></strong> <i><span class="varname">extCmntyValue</span></i> } &amp;&lt;1-16&gt; [ <strong><span>additive</span></strong> ] command.</li><li>To set the SoO extended community attribute for BGP4+ routes, run the <a href="cmdqueryname=apply+extcommunity+soo+additive"><b><span class="cmdname">apply extcommunity soo</span></b></a> { <i><span class="varname">site-of-origin</span></i> } &amp;&lt;1-16&gt; <strong><span>additive</span></strong> command.</li><li>To set the bandwidth extended community attribute for BGP4+ routes, run the <a href="cmdqueryname=apply+extcommunity+bandwidth+none"><b><span class="cmdname">apply extcommunity bandwidth</span></b></a> {<i><span class="varname"> extCmntyString</span></i> | <strong><span>none</span></strong> } or <a href="cmdqueryname=apply+extcommunity+bandwidth+aggregate+limit"><b><span class="cmdname">apply extcommunity bandwidth</span></b></a> <strong><span>aggregate</span></strong> [ <strong><span>limit</span></strong> <i><span class="varname">bandwidth-value</span></i> ] command.</li><li>To set a MED value for BGP4+ routes, run the <a href="cmdqueryname=apply+cost+%2B+-+inherit+none"><b><span class="cmdname">apply cost</span></b></a> { <span>[ <strong><span>+</span></strong> | <strong><span>-</span></strong> ]</span> <i><span class="varname">cost</span></i> | <strong><span>inherit</span></strong> | <strong><span>none</span></strong> } command.</li><li>To set the MED value of BGP4+ routes as the IGP cost of the next hop, run the <a href="cmdqueryname=apply+cost-type+internal"><b><span class="cmdname">apply cost-type</span></b></a> <strong><span>internal</span></strong> command.<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If both the <a href="cmdqueryname=apply+cost"><b><span class="cmdname">apply cost</span></b></a> and <a href="cmdqueryname=apply+cost-type"><b><span class="cmdname">apply cost-type</span></b></a> commands are run, only the <a href="cmdqueryname=apply+cost"><b><span class="cmdname">apply cost</span></b></a> command takes effect.</p>
</div></div>
</li><li>To set the BGP4+ VPN target extended community attribute, run the <a href="cmdqueryname=apply+extcommunity+rt+additive"><b><span class="cmdname">apply extcommunity</span></b></a> { <strong><span>rt</span></strong> <i><span class="varname">extCmntyValue</span></i> } &amp;&lt;1-16&gt; [ <strong><span>additive</span></strong> ] command.</li><li>To set the local preference for BGP4+ routes, run the <a href="cmdqueryname=apply+local-preference+%2B+-"><b><span class="cmdname">apply local-preference</span></b></a> <span>[ <strong><span>+</span></strong> | <strong><span>-</span></strong> ] </span><i><span class="varname">preference</span></i> command.</li><li>To set the Origin attribute for matched BGP4+ routes, run the <a href="cmdqueryname=apply+origin+egp+igp+incomplete"><b><span class="cmdname">apply origin</span></b></a> { <strong><span>egp</span></strong> { <i><span class="varname">egpVal</span></i> } | <strong><span>igp</span></strong> | <strong><span>incomplete</span></strong> } command.</li><li>To set the preferred value for BGP4+ routes, run the <a href="cmdqueryname=apply+preferred-value"><b><span class="cmdname">apply preferred-value</span></b></a> <i><span class="varname">preferred-value</span></i> command.</li><li><p>To set dampening parameters for EBGP routes, run the <a href="cmdqueryname=apply+dampening"><b><span class="cmdname">apply dampening</span></b></a> <i><span class="varname">half-life-reach</span></i> <i><span class="varname">reuse</span></i> <i><span class="varname">suppress</span></i> <i><span class="varname">ceiling</span></i> command.</p>
</li></ul>
<p>The commands in Step 3 can be configured in random order.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0027.html">Configuring BGP4+ Routing Policies
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0028.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0030.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>