
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring an IPv6 Direct Route to Respond to L3VE Interface Status Changes After a Delay">
<meta name="abstract" content="This section describes how to configure an IPv6 direct route to respond to Layer 3 Virtual Ethernet (L3VE) interface status changes after a delay. During traffic switchback after an L3VE interface recovers, this configuration can reduce traffic loss and improve network reliability.">
<meta name="description" content="This section describes how to configure an IPv6 direct route to respond to Layer 3 Virtual Ethernet (L3VE) interface status changes after a delay. During traffic switchback after an L3VE interface recovers, this configuration can reduce traffic loss and improve network reliability.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ip-route_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ip-route_cfg_0035.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ip-route_cfg_0034.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00556928,ip-routevrp,s00526617,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IP Routing Basis">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IP Routing Basis">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="IP Routing Basis">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00809835">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00414125">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172365343">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring an IPv6 Direct Route to Respond to L3VE Interface Status Changes After a Delay</title>
</head>
<body><a name="EN-US_TASK_0172365343"></a><a name="EN-US_TASK_0172365343"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring an IPv6 Direct Route to Respond to L3VE Interface Status Changes After a Delay</h1>
<div class="taskbody"><p>This section describes how to configure an IPv6 direct route to respond to Layer 3 Virtual Ethernet (L3VE) interface status changes after a delay. During traffic switchback after an L3VE interface recovers, this configuration can reduce traffic loss and improve network reliability.</p>
<div class="context"><a name="EN-US_TASK_0172365343__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>On the network shown in <a href="#EN-US_TASK_0172365343__fig_dc_vrp_ip-route_cfg_006001">Figure 1</a>, L2VPN connections are set up between AGGs and the CSG, and BGP VPNv6 peer relationships are set up between AGGs and RSGs. L3VE interfaces are configured on AGGs and VPN instances are bound to the L3VE interfaces, so that the CSG can access the L3VPN. BGP is configured on AGGs to import direct routes between the CSG and AGGs. These direct routes are converted to BGP VPNv6 routes and advertised to RSGs.</p>
<div class="fignone" id="EN-US_TASK_0172365343__fig_dc_vrp_ip-route_cfg_006001"><a name="EN-US_TASK_0172365343__fig_dc_vrp_ip-route_cfg_006001"></a><a name="fig_dc_vrp_ip-route_cfg_006001"></a><span class="figcap"><b>Figure 1 </b>Networking of an IPv6 direct route responding to L3VE interface status changes after a delay</span><br><span><img class="vsd" src="images/fig_dc_vrp_ip-route_cfg_006001.png" width="NaN" height="NaN"></span><br></div>
<p>AGG1 is used as the master device in the preceding figure. In normal cases, RSGs select routes advertised by AGG1 and traffic travels along LinkA. If AGG1 or the CSG-AGG1 link fails, traffic is switched over to LinkB. After AGG1 or the CSG-AGG1 link recovers, the L3VE interface on AGG1 goes from Down to Up, and AGG1 immediately generates an IPv6 direct route destined for the CSG and advertises the route to RSGs. Downstream traffic is then switched over to LinkA. However, AGG1 has not learned the MAC addresses of the base stations yet, so downstream traffic will be lost.</p>
<p>After you configure a cost for an IPv6 direct route and allow the direct route to restore its default cost 0 after a delay, when the L3VE interface on AGG1 goes from Down to Up, the cost of the direct route between the CSG and AGG1 is modified to the configured cost. In this case, RSGs do not select routes advertised by AGG1 and downstream traffic still travels along LinkB. After the configured delay expires, the cost of the IPv6 direct route on AGG1 is restored to the default value 0. RSGs select the routes advertised by AGG1. At this time, AGG1 has learned the MAC address of the base station, and downstream traffic loss is reduced after a downstream traffic switchover.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365343__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before you configure an IPv6 direct route to respond to L3VE interface status changes after a delay, complete the following task:</p>
<ul><li><p>Set data link layer protocol parameters and IPv6 addresses for interfaces to ensure that the data link layer protocol status of each interface is up.</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172365343__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=interface+virtual-ethernet"><b><span class="cmdname">interface virtual-ethernet</span></b></a> <i><span class="varname">interface-number</span></i></span></span><p><p>A VE interface is created, and the VE interface view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=ve-group"><b><span class="cmdname">ve-group</span></b></a> <i><span class="varname">ve-group-id</span></i> <span><strong><span>l3-access</span></strong></span></span></span><p><p>The VE interface is configured as an L3VE interface for MPLS L3VPN access and bound to a VE-group.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The L2VPN can access the L3VPN only if the L2VE and L3VE interfaces are bound to the same VE-group and reside on the same board.</p>
</div></div>
</p></li><li><span>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></span><p><p>Return to the system view.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=interface+virtual-ethernet"><b><span class="cmdname">interface virtual-ethernet</span></b></a> <i><span class="varname">interface-number.subinterface-number</span></i></span></span><p><p>An L3VE sub-interface is created, and its view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=ipv6+enable"><b><span class="cmdname">ipv6 enable</span></b></a></span></span><p><p>The IPv6 capability is enabled.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=direct-route+ipv6+degrade-delay"><b><span class="cmdname">direct-route ipv6 degrade-delay</span></b></a> <i><span class="varname">delay-time</span></i> <strong><span>degrade-cost</span></strong> <i><span class="varname">cost</span></i></span></span><p><p>The direct route is configured to respond to L3VE interface status changes after a delay.</p>
<p>After you run the <a href="cmdqueryname=direct-route+ipv6+degrade-delay"><b><span class="cmdname">direct-route ipv6 degrade-delay</span></b></a> command on an L3VE interface, and the L3VE interface goes from Down to Up, the cost of the L3VE interface's direct route is modified to the configured cost. After the configured delay-time expires, the direct route cost is restored to the default value 0.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The <a href="cmdqueryname=direct-route+ipv6+degrade-delay"><b><span class="cmdname">direct-route ipv6 degrade-delay</span></b></a> command and the <a href="cmdqueryname=direct-route+ipv6+track+pw-state"><b><span class="cmdname">direct-route ipv6 track pw-state</span></b></a> command cannot be both configured on one L3VE interface.</p>
</div></div>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0172365343__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>If an AGG's L3VE interface goes from Down to Up, run the <a href="cmdqueryname=display+ipv6+routing-table+vpn-instance"><b><span class="cmdname">display ipv6 routing-table vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i> [ <i><span class="varname">ipv6-address</span></i> ] [ <strong><span>verbose</span></strong> ] command on the AGG. The command output shows that the cost of the L3VE interface's IPv6 direct route to the CSG is the configured cost. After the configured <i><span class="varname">delay-time</span></i> expires, run the <a href="cmdqueryname=display+ipv6+routing-table+vpn-instance"><b><span class="cmdname">display ipv6 routing-table vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i> [ <i><span class="varname">ipv6-address</span></i> ] [ <strong><span>verbose</span></strong> ] command on the AGG. The command output shows that the cost of the IPv6 direct route to the L3VE interface is the default value 0.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ip-route_cfg_0000.html">Basic IP Routing Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ip-route_cfg_0035.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ip-route_cfg_0034.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>