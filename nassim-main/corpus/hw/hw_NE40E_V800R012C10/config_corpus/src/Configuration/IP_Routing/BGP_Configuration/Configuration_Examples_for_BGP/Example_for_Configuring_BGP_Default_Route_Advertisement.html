
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring BGP Default Route Advertisement">
<meta name="abstract" content="By controlling the advertising of default routes, you can specify traffic from a specific path to enter ASs.">
<meta name="description" content="By controlling the advertising of default routes, you can specify traffic from a specific path to enter ASs.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3070.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3079.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3081.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,bgpvrp,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="w00604599">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00615954">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172366388">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring BGP Default Route Advertisement</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172366388"></a><a name="EN-US_TASK_0172366388"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring BGP Default Route Advertisement</h1>
<div class="taskbody"><p>By controlling the advertising of default routes, you can specify traffic from a specific path to enter ASs.</p>
<div class="context"><a name="EN-US_TASK_0172366388__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0172366388__fig_dc_vrp_bgp_cfg_308001">Figure 1</a>, all <span class="keyword">Router</span>s run BGP. To ensure that the traffic that leaves AS 200 is forwarded by <span class="keyword">Device</span> E and <span class="keyword">Device</span> F, EBGP connections are established between <span class="keyword">Device</span> A and <span class="keyword">Device</span> B, between <span class="keyword">Device</span> C and <span class="keyword">Device</span> E, and between <span class="keyword">Device</span> D and <span class="keyword">Device</span> F; IBGP connections are established between <span class="keyword">Device</span> B and <span class="keyword">Device</span> C, and between <span class="keyword">Device</span> B and <span class="keyword">Device</span> D.</p>
<div class="fignone" id="EN-US_TASK_0172366388__fig_dc_vrp_bgp_cfg_308001"><a name="EN-US_TASK_0172366388__fig_dc_vrp_bgp_cfg_308001"></a><a name="fig_dc_vrp_bgp_cfg_308001"></a><span class="figcap"><b>Figure 1 </b>Configuring BGP default route advertisement</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 3 in this example are GE <span>0/1/0</span>, GE <span>0/2/0</span>, GE <span>0/3/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_bgp_cfg_308001.png"></span><br><div class="p">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.223322332233224%" id="mcps1.4.1.3.4.1.1.4.1.1" liSelected="liSelected"><p>Device Name</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.223322332233224%" id="mcps1.4.1.3.4.1.1.4.1.2" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.55335533553355%" id="mcps1.4.1.3.4.1.1.4.1.3" liSelected="liSelected"><p>IP Address</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="2" valign="top" width="33.223322332233224%" headers="mcps1.4.1.3.4.1.1.4.1.1 "><p><span class="keyword">Device</span> A</p>
</td>
<td class="cellrowborder" valign="top" width="33.223322332233224%" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="33.55335533553355%" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>10.20.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>Loopback 0</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>1.1.1.1/32</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="4" valign="top" width="33.223322332233224%" headers="mcps1.4.1.3.4.1.1.4.1.1 "><p><span class="keyword">Device</span> B</p>
</td>
<td class="cellrowborder" valign="top" width="33.223322332233224%" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="33.55335533553355%" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>10.20.1.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>10.0.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>GE <span>0/3/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>10.0.3.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>Loopback 0</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>2.2.2.2/32</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="4" valign="top" width="33.223322332233224%" headers="mcps1.4.1.3.4.1.1.4.1.1 "><p><span class="keyword">Device</span> C</p>
</td>
<td class="cellrowborder" valign="top" width="33.223322332233224%" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="33.55335533553355%" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>10.20.2.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>10.0.1.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>GE <span>0/3/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>10.0.2.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>Loopback 0</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>3.3.3.3/32</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="4" valign="top" width="33.223322332233224%" headers="mcps1.4.1.3.4.1.1.4.1.1 "><p><span class="keyword">Device</span> D</p>
</td>
<td class="cellrowborder" valign="top" width="33.223322332233224%" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="33.55335533553355%" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>10.20.3.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>10.0.3.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>GE <span>0/3/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>10.0.2.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>Loopback 0</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>4.4.4.4/32</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" valign="top" width="33.223322332233224%" headers="mcps1.4.1.3.4.1.1.4.1.1 "><p><span class="keyword">Device</span> E</p>
</td>
<td class="cellrowborder" valign="top" width="33.223322332233224%" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="33.55335533553355%" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>10.20.2.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>10.1.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>Loopback 0</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>5.5.5.5/32</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" valign="top" width="33.223322332233224%" headers="mcps1.4.1.3.4.1.1.4.1.1 "><p><span class="keyword">Device</span> F</p>
</td>
<td class="cellrowborder" valign="top" width="33.223322332233224%" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>GE <span>0/1/0</span></p>
</td>
<td class="cellrowborder" valign="top" width="33.55335533553355%" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>10.20.3.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>GE <span>0/2/0</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>10.2.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.2 "><p>Loopback 0</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.3.4.1.1.4.1.3 "><p>6.6.6.6/32</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172366388__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>During the configuration, note the following:</p>
<ul><li><p>A default route can represent all routes on the entire network. For example, in a stub AS scenario, the local device can use a default route, instead of advertising network-wide routes, to forward traffic to an external network. A default route can also represent all routes except specific ones.</p>
</li><li><p>During the establishment of a peer relationship, if the IP address of the specified peer is a loopback interface address or a sub-interface address, the <strong>peer connect-interface</strong> command must be run on both ends to ensure correct connection.</p>
</li><li>To improve security, you are advised to deploy BGP security measures. For details, see "Configuring BGP Security." Keychain authentication is used as an example. For details, see "Example for Configuring BGP Keychain."</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172366388__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure OSPF on <span class="keyword">Device</span> B, <span class="keyword">Device</span> C, and <span class="keyword">Device</span> D.</p>
</li><li><p>Establish EBGP connections between <span class="keyword">Device</span> A and <span class="keyword">Device</span> B, between <span class="keyword">Device</span> C and <span class="keyword">Device</span> E, and between <span class="keyword">Device</span> D and <span class="keyword">Device</span> F.</p>
</li><li><p>Establish IBGP connections between <span class="keyword">Device</span> B and <span class="keyword">Device</span> C, and between <span class="keyword">Device</span> B and <span class="keyword">Device</span> D.</p>
</li><li><p>Configure an import routing policy on <span class="keyword">Device</span> C to accept only default routes.</p>
</li><li><p>Configure an import routing policy on <span class="keyword">Device</span> D to accept default routes and all specific routes, and then set Local_Pref values for the accepted default routes.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172366388__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Router IDs and AS numbers of <span class="keyword">Device</span> A, <span class="keyword">Device</span> B, <span class="keyword">Device</span> C, <span class="keyword">Device</span> D, <span class="keyword">Device</span> E, and <span class="keyword">Device</span> F</p>
</li><li><p>Names of the import routing policies to be configured on <span class="keyword">Device</span> C and <span class="keyword">Device</span> D</p>
</li><li><p>Local_Pref values to be set for the accepted default routes on <span class="keyword">Device</span> D</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172366388__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure an IP address for each interface. For configuration details, see Configuration Files in this section.</span></li><li><span>Configure OSPF.</span><p><p># Configure <span class="keyword">Device</span> B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1]<strong> area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0]<strong> network 10.0.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0]<strong> network 10.0.3.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0]<strong> network 2.2.2.2 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ospf-1-area-0.0.0.0]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-ospf-1]<strong> quit</strong></pre>
<p># Configure <span class="keyword">Device</span> C.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C]<strong> ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1]<strong> area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1-area-0.0.0.0]<strong> network 10.0.1.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1-area-0.0.0.0]<strong> network 10.0.2.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1-area-0.0.0.0]<strong> network 3.3.3.3 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-ospf-1-area-0.0.0.0]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-ospf-1-area-0.0.0.0]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-ospf-1]<strong> quit</strong></pre>
<p># Configure <span class="keyword">Device</span> D.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D]<strong> ospf 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-ospf-1]<strong> area 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-ospf-1-area-0.0.0.0]<strong> network 10.0.2.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-ospf-1-area-0.0.0.0]<strong> network 10.0.3.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-ospf-1-area-0.0.0.0]<strong> network 4.4.4.4 0.0.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-ospf-1-area-0.0.0.0]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D-ospf-1-area-0.0.0.0]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D-ospf-1]<strong> quit</strong></pre>
</p></li><li><span>Configure BGP connections.</span><p><p># Configure <span class="keyword">Device</span> A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> bgp 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bgp]<strong> router-id 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bgp] <strong>peer 10.20.1.2 as-number 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-bgp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-bgp]<strong> quit</strong></pre>
<p># Configure <span class="keyword">Device</span> B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> bgp 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bgp]<strong> router-id 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bgp] <strong>peer 10.20.1.1 as-number 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bgp] <strong>network 10.20.1.0 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bgp] <strong>peer 3.3.3.3 as-number 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bgp] <strong>peer 3.3.3.3 connect-interface LoopBack0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bgp] <strong>peer 4.4.4.4 as-number 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bgp] <strong>peer 4.4.4.4 connect-interface LoopBack0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-bgp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-bgp]<strong> quit</strong></pre>
<p># Configure <span class="keyword">Device</span> C.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C]<strong> bgp 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp]<strong> router-id 3.3.3.3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp] <strong>peer 10.20.2.1 as-number 300</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp] <strong>network 10.20.2.0 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp] <strong>peer 2.2.2.2 as-number 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp] <strong>peer 2.2.2.2 connect-interface LoopBack0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-bgp]<strong> quit</strong></pre>
<p># Configure <span class="keyword">Device</span> D.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D]<strong> bgp 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-bgp]<strong> router-id 4.4.4.4</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-bgp] <strong>peer 10.20.3.1 as-number 400</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-bgp] <strong>network 10.20.3.0 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-bgp] <strong>peer 2.2.2.2 as-number 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-bgp] <strong>peer 2.2.2.2 connect-interface LoopBack0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-bgp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D-bgp]<strong> quit</strong></pre>
<p># Configure <span class="keyword">Device</span> E.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>E]<strong> bgp 300</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-bgp]<strong> router-id 5.5.5.5</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-bgp] <strong>peer 10.20.2.2 as-number 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-bgp] <strong>network 10.1.1.0 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-bgp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>E-bgp]<strong> quit</strong></pre>
<p># Configure <span class="keyword">Device</span> F.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>F]<strong> bgp 400</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>F-bgp]<strong> router-id 6.6.6.6</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>F-bgp] <strong>peer 10.20.3.2 as-number 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>F-bgp] <strong>network 10.2.1.0 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>F-bgp] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>F-bgp]<strong> quit</strong></pre>
</p></li><li><span>Configure <span class="keyword">Device</span> E and <span class="keyword">Device</span> F to advertise default routes.</span><p><p># Configure <span class="keyword">Device</span> E to advertise default routes.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>E-bgp] <strong>ipv4-family unicast</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-bgp-af-ipv4] <strong>peer 10.20.2.2 default-route-advertise</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>E-bgp-af-ipv4] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span> F to advertise default routes.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>F-bgp] <strong>ipv4-family unicast</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>F-bgp-af-ipv4] <strong>peer 10.20.3.2 default-route-advertise</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>F-bgp-af-ipv4] <strong>commit</strong></pre>
<p># Check the routing table of <span class="keyword">Device</span> B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display bgp routing-table</strong>

 BGP Local router ID is 2.2.2.2
 Status codes: * - valid, &gt; - best, d - damped,<span> x - best external,</span><span> a - add path,</span>
               h - history,  i - internal, s - suppressed, S - Stale
               Origin : i - IGP, e - EGP, ? - incomplete
<span> RPKI validation codes: V - valid, I - invalid, N - not-found</span>


Total Number of Routes: 7
     Network            NextHop        MED        LocPrf    PrefVal Path/Ogn

 *&gt;i  <strong>0.0.0.0</strong>            10.20.2.1       0          <strong>100</strong>        0      <strong>300i</strong>
 * i  <strong>       </strong>            10.20.3.1       0          <strong>100</strong>        0      <strong>400i</strong>
 *&gt;i  <strong>10.1.1.0/24</strong>        10.20.2.1       0          100        0      <strong>300i</strong>
 *&gt;i  <strong>10.2.1.0/24</strong>        10.20.3.1       0          100        0      <strong>400i</strong>
 *&gt;   10.20.1.0          0.0.0.0         0                     0      i
 *&gt;i  10.20.2.0          3.3.3.3         0          100        0      i
 *&gt;i  10.20.3.0          4.4.4.4         0          100        0      i</pre>
<p>The command output shows that <span class="keyword">Device</span> B has received the default routes and all specific routes of AS 300 and AS 400.</p>
</p></li><li><span>Configure import routing policies.</span><p><p># Configure an IP prefix list named <strong>default</strong> on <span class="keyword">Device</span> C to accept only default routes.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C]<strong> ip ip-prefix default index 10 permit 0.0.0.0 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C]<strong> bgp 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp] <strong>peer 10.20.2.1 ip-prefix default import</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-bgp]<strong> commit</strong></pre>
<p># Configure a route-policy named <strong>set-default-low</strong> on <span class="keyword">Device</span> D to accept default routes and all specific routes, and set Local_Pref values for the accepted default routes.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D]<strong> ip ip-prefix default index 10 permit 0.0.0.0 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>route-policy set-default-low permit node 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-route-policy] <strong>if-match ip-prefix default</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-route-policy] <strong>apply local-preference 80</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-route-policy] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>route-policy set-default-low permit node 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-route-policy] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D]<strong> bgp 200</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-bgp] <strong>peer 10.20.3.1 route-policy set-default-low import</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-bgp] <strong>commit</strong></pre>
<p># Check the routing table of <span class="keyword">Device</span> B.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>display bgp routing-table</strong>

 BGP Local router ID is 2.2.2.2
 Status codes: * - valid, &gt; - best, d - damped,<span> x - best external,</span><span> a - add path,</span>
               h - history,  i - internal, s - suppressed, S - Stale
               Origin : i - IGP, e - EGP, ? - incomplete
<span> RPKI validation codes: V - valid, I - invalid, N - not-found</span>


 Total Number of Routes: 6
     Network            NextHop        MED        LocPrf    PrefVal Path/Ogn

 *&gt;i  <strong>0.0.0.0</strong>            10.20.2.1       0          <strong>100</strong>        0      300i
 * i  <strong>       </strong>            10.20.3.1       0          <strong>80</strong>         0      400i
 *&gt;i  <strong>10.2.1.0/24</strong>        10.20.3.1       0          100        0      <strong>400i</strong>
 *&gt;   10.20.1.0          0.0.0.0         0                     0      i
 *&gt;i  10.20.2.0          3.3.3.3         0          100        0      i
 *&gt;i  10.20.3.0          4.4.4.4         0          100        0      i    </pre>
<p>The command output shows that <span class="keyword">Device</span> B has received only the default routes of AS 300 and the default routes and all specific routes of AS 400 and that the Local_Pref of the accepted default routes destined of AS 400 has been set to 80.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172366388__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span> A configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>A
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.20.1.1 255.255.255.0
#
interface LoopBack0
 ip address 1.1.1.1 255.255.255.255
#
bgp 100
 router-id 1.1.1.1
 peer 10.20.1.2 as-number 200
 #
 ipv4-family unicast
  peer 10.20.1.2 enable
#
return</pre>
</li><li><p><span class="keyword">Device</span> B configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>B
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.20.1.2 255.255.255.0
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.0.1.1 255.255.255.0
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 ip address 10.0.3.2 255.255.255.0
#
interface LoopBack0
 ip address 2.2.2.2 255.255.255.255
#
bgp 200
 router-id 2.2.2.2
 peer 3.3.3.3 as-number 200
 peer 3.3.3.3 connect-interface LoopBack0
 peer 4.4.4.4 as-number 200
 peer 4.4.4.4 connect-interface LoopBack0
 peer 10.20.1.1 as-number 100
 #
 ipv4-family unicast
  network 10.20.1.0 255.255.255.0
  peer 3.3.3.3 enable
  peer 4.4.4.4 enable
  peer 10.20.1.1 enable
#
ospf 1
 area 0.0.0.0
  network 2.2.2.2 0.0.0.0
  network 10.0.1.0 0.0.0.255
  network 10.0.3.0 0.0.0.255
#
return</pre>
</li><li><p><span class="keyword">Device</span> C configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>C
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.20.2.2 255.255.255.0
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.0.1.2 255.255.255.0
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 ip address 10.0.2.1 255.255.255.0
#
interface LoopBack0
 ip address 3.3.3.3 255.255.255.255
#
bgp 200
 router-id 3.3.3.3
 peer 2.2.2.2 as-number 200
 peer 2.2.2.2 connect-interface LoopBack0
 peer 10.20.2.1 as-number 300
 #
 ipv4-family unicast
  network 10.20.2.0 255.255.255.0
  peer 2.2.2.2 enable
  peer 10.20.2.1 enable
  peer 10.20.2.1 ip-prefix default import
#
ospf 1
 area 0.0.0.0
  network 3.3.3.3 0.0.0.0
  network 10.0.1.0 0.0.0.255
  network 10.0.2.0 0.0.0.255
#
ip ip-prefix default index 10 permit 0.0.0.0 0
#
return</pre>
</li><li><p><span class="keyword">Device</span> D configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>D
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
  ip address 10.20.3.2 255.255.255.0
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.0.3.1 255.255.255.0
#
interface GigabitEthernet<span>0/3/0</span>
 undo shutdown
 ip address 10.0.2.2 255.255.255.0
#
interface LoopBack0
 ip address 4.4.4.4 255.255.255.255
#
bgp 200
 router-id 4.4.4.4
 peer 2.2.2.2 as-number 200
 peer 2.2.2.2 connect-interface LoopBack0
 peer 10.20.3.1 as-number 400
 #
 ipv4-family unicast
  network 10.20.3.0 255.255.255.0
  peer 2.2.2.2 enable
  peer 10.20.3.1 enable
  peer 10.20.3.1 route-policy set-default-low import
#
ospf 1
 area 0.0.0.0
  network 4.4.4.4 0.0.0.0
  network 10.0.2.0 0.0.0.255
  network 10.0.3.0 0.0.0.255
#
ip ip-prefix default index 10 permit 0.0.0.0 0
#
route-policy set-default-low permit node 10
 if-match ip-prefix default
 apply local-preference 80
#
route-policy set-default-low permit node 20
#
return</pre>
</li><li><p><span class="keyword">Device</span> E configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>E
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.20.2.1 255.255.255.0
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.1.1.1 255.255.255.0
#
interface LoopBack0
 ip address 5.5.5.5 255.255.255.255
#
bgp 300
 router-id 5.5.5.5
 peer 10.20.2.2 as-number 200
 #
 ipv4-family unicast
  network 10.1.1.0 255.255.255.0
  peer 10.20.2.2 enable
  peer 10.20.2.2 default-route-advertise
#
return</pre>
</li><li><p><span class="keyword">Device</span> F configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>F
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 10.20.3.1 255.255.255.0
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
 ip address 10.2.1.1 255.255.255.0
#
interface LoopBack0
 ip address 6.6.6.6 255.255.255.255
#
bgp 400
 router-id 6.6.6.6
 peer 10.20.3.2 as-number 200
 #
 ipv4-family unicast
  network 10.2.1.0 255.255.255.0
  peer 10.20.3.2 enable
  peer 10.20.3.2 default-route-advertise
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3070.html">Configuration Examples for BGP
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3079.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp_cfg_3081.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>