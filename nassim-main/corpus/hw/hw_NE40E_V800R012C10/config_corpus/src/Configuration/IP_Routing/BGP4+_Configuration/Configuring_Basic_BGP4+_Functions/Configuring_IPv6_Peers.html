
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring IPv6 Peers">
<meta name="abstract" content="Devices can exchange BGP4+ routing information only after the IPv6 peer relationship is established among them.">
<meta name="description" content="Devices can exchange BGP4+ routing information only after the IPv6 peer relationship is established among them.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0003.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0004.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0010.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP IPv6">
<meta name="featuretype" content="IP Route">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP IPv6">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP IPv6">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00615954">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172366426">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring IPv6 Peers</title>
</head>
<body><a name="EN-US_TASK_0172366426"></a><a name="EN-US_TASK_0172366426"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring IPv6 Peers</h1>
<div class="taskbody"><p>Devices can exchange BGP4+ routing information only after the IPv6 peer relationship is established among them.</p>
<div class="context"><a name="EN-US_TASK_0172366426__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Because BGP4+ uses TCP connections, the IPv6 addresses for peers must be specified when you configure BGP4+. A BGP4+ peer may not be a neighboring <span class="keyword">Router</span>, and a BGP4+ peer relationship can be created by using a logical link. Using the addresses of loopback interfaces to set up BGP4+ peer relationships can improve the stability of BGP4+ connections and is recommended.</p>
<p>The devices in the same AS establish IBGP peer relationships, and the devices of different ASs establish EBGP peer relationships.</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172366426__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure IBGP peers.</span><p><p>Perform the following steps on the <span class="keyword">Router</span>s between which an IBGP peer relationship needs to be set up:</p>
</p><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">peerGroupName</span></i> } <a href="cmdqueryname=as-number"><b><span class="cmdname">as-number</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The address of the remote peer and the AS to which the remote peer belongs are configured.</p>
<p>The number of the AS where the specified peer resides must be the same as that of the local AS.</p>
<p>The IP address of the specified peer can be one of the following types:</p>
<ul><li><p>IPv6 address of an interface on a directly connected peer</p>
</li><li><p>IP address of a routable loopback interface on the peer</p>
</li><li><p>IPv6 address of a sub-interface on a directly connected peer</p>
</li><li><p>Link-local address of an interface on a directly connected peer</p>
</li></ul>
<p>If the specified peer IPv6 address is the address of a loopback interface, you need to configure the local interface for the BGP4+ connection to ensure that the peer relationship is correctly established.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> } <a href="cmdqueryname=connect-interface"><b><span class="cmdname">connect-interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> [ <i><span class="varname">ipv6-source-address</span></i> ]</span><p><p>The source interface and source address for establishing a TCP connection are specified. To improve the reliability and stability of a BGP4+ connection to be established through loopback interfaces, you need to specify the local interface to be used to establish this BGP4+ connection.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>When establishing multiple peer relationships between two <span class="keyword">Router</span>s through multiple links, you are advised to run the <a href="cmdqueryname=peer+connect-interface"><b><span class="cmdname">peer connect-interface</span></b></a> command to specify the interface for establishing each BGP4+ connection.</p>
<p>If the source interface used by the local end to establish a BGP4+ session is configured with multiple IP addresses, the <a href="cmdqueryname=peer+connect-interface"><b><span class="cmdname">peer connect-interface</span></b></a> command must be run to specify the source address. This ensures the correct connection between the two ends.</p>
</div></div>
</p></li><li class="substepexpand"><span>(Optional) Run <span><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> } <a href="cmdqueryname=listen-only"><b><span class="cmdname">listen-only</span></b></a></span></span><p><p>The local peer (group) is configured to accept connection requests, but not to send connection requests.</p>
<p>After this command is run, the existing peer relationship is interrupted. The local peer will wait for a connection request from the remote peer to reestablish a peer relationship. This command enables only one peer to send connection requests, preventing a connection request conflict.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command can only be run on one of two peers. If this command is run on both peers, the connection between them cannot be reestablished.</p>
</div></div>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> }<a href="cmdqueryname=description"><b><span class="cmdname"> description</span></b></a> <i><span class="varname">description-text</span></i></span><p><p>The description of the peer is configured.</p>
<p>You can simplify network management by configuring the descriptions of peers.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=ipv6-family"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>unicast</span></strong></span></span><p><p>The IPv6 unicast address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> } <a href="cmdqueryname=enable"><b><span class="cmdname">enable</span></b></a></span><p><p>The IPv6 peer is enabled.</p>
<p>After configuring a BGP4+ peer in the BGP view, you also need to enable the peer in the IPv6 unicast address family view.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure EBGP peers.</span><p><p>Perform the following steps on the <span class="keyword">Router</span>s between which an EBGP peer relationship needs to be set up:</p>
</p><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=router-id+allow-same+enable"><b><span class="cmdname">router-id allow-same enable</span></b></a></span><p><p>The peers with the same router ID are allowed to establish EBGP connections.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> } <a href="cmdqueryname=as-number"><b><span class="cmdname">as-number</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The IPv6 address of the remote peer and the AS to which the remote peer belongs are configured.</p>
<p>The number of the AS where the specified peer resides must be different from that of the local AS.</p>
<p>The IP address of the specified peer can be one of the following types:</p>
<ul><li><p>IPv6 address of an interface on a directly connected peer</p>
</li><li><p>IP address of a routable loopback interface on the peer</p>
</li><li><p>IPv6 address of a sub-interface on a directly connected peer</p>
</li><li><p>Link-local address of an interface on a directly connected peer</p>
</li></ul>
<p>If the specified peer IP address is a loopback interface address or a local-link address, you need to configure the local interface for the BGP4+ connection to ensure that the peer relationship is correctly established.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> } <a href="cmdqueryname=connect-interface"><b><span class="cmdname">connect-interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> [ <i><span class="varname">ipv6-source-address</span></i> ]</span><p><p>The source interface and source address for establishing a TCP connection are specified.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>When establishing multiple peer relationships between two <span class="keyword">Router</span>s through multiple links, you are advised to run the <a href="cmdqueryname=peer+connect-interface"><b><span class="cmdname">peer connect-interface</span></b></a> command to specify the interface for establishing each BGP4+ connection.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> } <a href="cmdqueryname=ebgp-max-hop"><b><span class="cmdname">ebgp-max-hop</span></b></a> [ <i><span class="varname">hop-count</span></i> ]</span><p><p>The maximum number of hops is configured for establishing an EBGP connection.</p>
<p>Generally, a direct physical link must be available between EBGP peers. If such a link does not exist, the <a href="cmdqueryname=peer+ebgp-max-hop"><b><span class="cmdname">peer ebgp-max-hop</span></b></a> command must be used to allow EBGP peers to establish a TCP connection over multiple hops.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If loopback interfaces are used to establish an EBGP peer relationship, the <a href="cmdqueryname=peer+ebgp-max-hop"><b><span class="cmdname">peer ebgp-max-hop</span></b></a> command must be run with <i><span class="varname">hop-count</span></i> greater than or equal to 2; otherwise, the peer relationship cannot be established.</p>
</div></div>
</p></li><li class="substepexpand"><span>(Optional) Run <span><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> } <a href="cmdqueryname=listen-only"><b><span class="cmdname">listen-only</span></b></a></span></span><p><p>The local peer (group) is configured to accept connection requests, but not to send connection requests.</p>
<p>After this command is run, the existing peer relationship is interrupted. The local peer will wait for the connection request from the remote peer to reestablish a peer relationship. This command enables only one peer to send connection requests, preventing a connection request conflict.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command can only be run on one of two peers. If this command is run on both peers, the connection between them cannot be reestablished.</p>
</div></div>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> }<a href="cmdqueryname=description"><b><span class="cmdname"> description</span></b></a> <i><span class="varname">description-text</span></i></span><p><p>The description of the peer is configured.</p>
<p>You can simplify network management by configuring the descriptions of peers.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=ipv6-family"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>unicast</span></strong></span></span><p><p>The IPv6 unicast address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> } <a href="cmdqueryname=enable"><b><span class="cmdname">enable</span></b></a></span><p><p>The IPv6 peer is enabled.</p>
<p>After configuring a BGP4+ peer in the BGP view, you also need to enable the peer in the IPv6 unicast address family view.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">peerGroupName</span></i> } <strong><span>peer-as-check</span></strong></span><p><p>The device is configured not to advertise the routes learned from an EBGP peer to the peers in the same AS with the EBGP peer.</p>
</p><p><p>By default, after receiving a route from an EBGP peer (for example, in AS 200), the local device (for example, in AS 100) advertises the route to other EBGP peers in AS 200. After the <a href="cmdqueryname=peer+peer-as-check"><b><span class="cmdname">peer peer-as-check</span></b></a> command is run on the device, the device does not advertise the routes received from an EBGP peer to other EBGP peers in the same AS with this EBGP peer. This reduces BGP memory and CPU consumption and speeds up route convergence in case of route flapping.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0003.html">Configuring Basic BGP4+ Functions
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0004.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0010.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>