
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring OSPF to Filter the Routes to Be Advertised">
<meta name="abstract" content="After a filtering policy is configured for routes imported by OSPF, only the routes that match the policy can be advertised.">
<meta name="description" content="After a filtering policy is configured for routes imported by OSPF, only the routes that match the policy can be advertised.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_route-policy_cfg_0017.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_route-policy_cfg_0035.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_route-policy_cfg_0037.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00556928,w00606909,route-policyvrp,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Route Policy">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Route Policy">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="Route Policy">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="Route Policy">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00809835">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00414125">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172366579">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring OSPF to Filter the Routes to Be Advertised</title>
</head>
<body><a name="EN-US_TASK_0172366579"></a><a name="EN-US_TASK_0172366579"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring OSPF to Filter the Routes to Be Advertised</h1>
<div class="taskbody" id="taskbody1614002334214039"><p id="shortdesc1959222898214039">After a filtering policy is configured for routes imported by OSPF, only the routes that match the policy can be advertised.</p>
<div class="steps"><a name="EN-US_TASK_0172366579__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0172366579__steps155194007214039"><li id="EN-US_TASK_0172366579__step888746971214039"><span id="EN-US_TASK_0172366579__cmd449754665214324">Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172366579__cmdname1194095899214324">system-view</span></b></a></span></span><p><p id="EN-US_TASK_0172366579__p1300515615214324">The system view is displayed.</p>
</p></li><li id="EN-US_TASK_0172366579__step348927504214039"><span id="EN-US_TASK_0172366579__cmd1794203418214039">Run <a href="cmdqueryname=ospf"><b><span class="cmdname" id="EN-US_TASK_0172366579__cmdname177443879214039">ospf</span></b></a> [ <i><span class="varname" id="EN-US_TASK_0172366579__varname780248434214039">process-id</span></i> ]</span><p><p id="EN-US_TASK_0172366579__p1539532361415">An OSPF process is started, and the OSPF view is displayed.</p>
</p></li><li id="EN-US_TASK_0172366579__step401933163214039"><span id="EN-US_TASK_0172366579__cmd1454600726214039">Set the conditions to filter routes to be advertised.</span><p><p id="EN-US_TASK_0172366579__p1880863050214039">Run any of the following commands as required:</p>
<ul id="EN-US_TASK_0172366579__ul853000895214039"><li id="EN-US_TASK_0172366579__li26717258214039">Based on a basic ACL:<ol type="a" id="EN-US_TASK_0172366579__ol48469379214039"><li id="EN-US_TASK_0172366579__li1162239938214039"><p id="EN-US_TASK_0172366579__p1175804494214324"><a name="EN-US_TASK_0172366579__li1162239938214039"></a><a name="li1162239938214039"></a>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0172366579__cmdname1132235011214324">quit</span></b></a></span></p>
<p id="EN-US_TASK_0172366579__p11152956214324">Return to the system view.</p>
</li><li id="EN-US_TASK_0172366579__li305995319214039"><p id="EN-US_TASK_0172366579__p1590719360214324"><a name="EN-US_TASK_0172366579__li305995319214039"></a><a name="li305995319214039"></a>Run <span><span><a href="cmdqueryname=acl"><b><span class="cmdname" id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdname830329318214207">acl</span></b></a> { <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname1836897817214207">name</span></strong> <i><span class="varname" id="EN-US_TASK_0172366579__en-us_task_0172336153_varname1833174039214207">basic-acl-name</span></i> { <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname812104027214207">basic</span></strong> | [ <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname2098561743214207">basic</span></strong> ] <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname2073793852214207">number</span></strong> <i><span class="varname" id="EN-US_TASK_0172366579__en-us_task_0172336153_varname1517281059214207">basic-acl-number</span></i> } | [ <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname958027286214207">number</span></strong> ] <i><span class="varname" id="EN-US_TASK_0172366579__en-us_task_0172336153_varname235500026214207">basic-acl-number</span></i> } [ <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname48680667214207">match-order</span></strong> { <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname157204654214207">config</span></strong> | <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname507297311214207">auto</span></strong> } ]</span></span></p>
<p id="EN-US_TASK_0172366579__p681149212214324">The ACL view is displayed.</p>
</li><li id="EN-US_TASK_0172366579__li1642149510214039"><p id="EN-US_TASK_0172366579__p15757015163113"><a name="EN-US_TASK_0172366579__li1642149510214039"></a><a name="li1642149510214039"></a>Run <span><span><a href="cmdqueryname=rule"><b><span class="cmdname" id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdname1993062488214207">rule</span></b></a> [ <i><span class="varname" id="EN-US_TASK_0172366579__en-us_task_0172336153_varname859153543214207">rule-id</span></i> ] [ <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname1446371756214207">name</span></strong> <i><span class="varname" id="EN-US_TASK_0172366579__en-us_task_0172336153_varname1516501376214207">rule-name</span></i> ] { <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname1764568478214207">deny</span></strong> | <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname761045443214207">permit</span></strong> } [ <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname350204750214207">fragment-type</span></strong> { <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname2057248666214207">fragment</span></strong> | <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname232427091214207">non-fragment</span></strong> | <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname2108634181214207">non-subseq</span></strong> | <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname1558997990214207">fragment-subseq</span></strong> | <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname1149675104214207">fragment-spe-first</span></strong> } | <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname810735923214207">source</span></strong> { <i><span class="varname" id="EN-US_TASK_0172366579__en-us_task_0172336153_varname673241813214207">source-ip-address</span></i> { <i><span class="varname" id="EN-US_TASK_0172366579__en-us_task_0172336153_varname58053590214207">source-wildcard</span></i> | <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname1238085223214207">0</span></strong><span> | <i><span class="varname" id="EN-US_TASK_0172366579__en-us_task_0172336153_varname1849892084214207">src-netmask</span></i></span> } | <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname336857444214207">any</span></strong> } | <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname1089666193214207">time-range</span></strong> <i><span class="varname" id="EN-US_TASK_0172366579__en-us_task_0172336153_varname1818489711214207">time-name</span></i> | <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname2122804462214207">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0172366579__en-us_task_0172336153_varname1001938923214207">vpn-instance-name</span></i> ] <sup id="EN-US_TASK_0172366579__en-us_task_0172336153_sup1574448225214207">*</sup></span></span></p>
<p id="EN-US_TASK_0172366579__p293072717375">A rule is configured for the ACL.</p>
<p id="EN-US_TASK_0172366579__p1847796621214039">When the <a href="cmdqueryname=rule"><b><span class="cmdname" id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdname220955808214207">rule</span></b></a> command is run to configure rules for a named ACL, only the source address range specified by <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname1062368536214207">source</span></strong> and the time period specified by <strong><span id="EN-US_TASK_0172366579__en-us_task_0172336153_cmdparmname2006062735214207">time-range</span></strong> are valid as the rules.</p>
<div class="p" id="EN-US_TASK_0172366579__p1156789880214039">When a filtering policy of a routing protocol is used to filter routes:<ul id="EN-US_TASK_0172366579__en-us_task_0172336153_ul135725010214207"><li id="EN-US_TASK_0172366579__en-us_task_0172336153_li1312346841214207"><p id="EN-US_TASK_0172366579__en-us_task_0172336153_p1956301997214207"><a name="EN-US_TASK_0172366579__en-us_task_0172336153_li1312346841214207"></a><a name="en-us_task_0172336153_li1312346841214207"></a>If the action specified in an ACL rule is <strong id="EN-US_TASK_0172366579__en-us_task_0172336153_b1343120114214207">permit</strong>, a route that matches the rule will be received or advertised by the system.</p>
</li><li id="EN-US_TASK_0172366579__en-us_task_0172336153_li1392638396214207"><p id="EN-US_TASK_0172366579__en-us_task_0172336153_p649252919214207"><a name="EN-US_TASK_0172366579__en-us_task_0172336153_li1392638396214207"></a><a name="en-us_task_0172336153_li1392638396214207"></a>If the action specified in an ACL rule is <strong id="EN-US_TASK_0172366579__en-us_task_0172336153_b1955829907214207">deny</strong>, a route that matches the rule will not be received or advertised by the system.</p>
</li><li id="EN-US_TASK_0172366579__en-us_task_0172336153_li1858384138214207"><p id="EN-US_TASK_0172366579__en-us_task_0172336153_p860045398214207"><a name="EN-US_TASK_0172366579__en-us_task_0172336153_li1858384138214207"></a><a name="en-us_task_0172336153_li1858384138214207"></a>If a route has not matched any ACL rules, the route will not be received or advertised by the system.</p>
</li><li id="EN-US_TASK_0172366579__en-us_task_0172336153_li124866694214207"><p id="EN-US_TASK_0172366579__en-us_task_0172336153_p543002939214207"><a name="EN-US_TASK_0172366579__en-us_task_0172336153_li124866694214207"></a><a name="en-us_task_0172336153_li124866694214207"></a>If an ACL does not contain any rules, all routes matching the <strong id="EN-US_TASK_0172366579__en-us_task_0172336153_b1183904776214207">route-policy</strong> that references the ACL will not be received or advertised by the system.</p>
</li><li id="EN-US_TASK_0172366579__en-us_task_0172336153_li1497229201214207"><p id="EN-US_TASK_0172366579__en-us_task_0172336153_p1865289308214207"><a name="EN-US_TASK_0172366579__en-us_task_0172336153_li1497229201214207"></a><a name="en-us_task_0172336153_li1497229201214207"></a>In the configuration order, the system first matches a route with a rule that has a smaller number and then matches the route with a rule with a larger number. Routes can be filtered using a blacklist or a whitelist:</p>
<p id="EN-US_TASK_0172366579__en-us_task_0172336153_p1198919868214207">Route filtering using a blacklist: Configure a rule with a smaller number and specify the action <strong id="EN-US_TASK_0172366579__en-us_task_0172336153_b1283372383214207">deny</strong> in this rule to filter out the unwanted routes. Then, configure another rule with a larger number in the same ACL and specify the action <strong id="EN-US_TASK_0172366579__en-us_task_0172336153_b1653264950214207">permit</strong> in this rule to receive or advertise the other routes.</p>
<p id="EN-US_TASK_0172366579__en-us_task_0172336153_p469236985214207">Route filtering using a whitelist: Configure a rule with a smaller number and specify the action <strong id="EN-US_TASK_0172366579__en-us_task_0172336153_b261709700214207">permit</strong> in this rule to permit the routes to be received or advertised by the system. Then, configure another rule with a larger number in the same ACL and specify the action <strong id="EN-US_TASK_0172366579__en-us_task_0172336153_b924805964214207">deny</strong> in this rule to filter out unwanted routes.</p>
</li></ul>
</div>
</li><li id="EN-US_TASK_0172366579__li20655103011132"><p id="EN-US_TASK_0172366579__p6125124619148"><a name="EN-US_TASK_0172366579__li20655103011132"></a><a name="li20655103011132"></a>Run <a href="cmdqueryname=ospf"><b><span class="cmdname" id="EN-US_TASK_0172366579__cmdname12243165012141">ospf</span></b></a> [ <i><span class="varname" id="EN-US_TASK_0172366579__varname62432050151418">process-id</span></i> ]</p>
<p id="EN-US_TASK_0172366579__li20655103011132p0">An OSPF process is started, and the OSPF view is displayed.</p>
</li><li id="EN-US_TASK_0172366579__li1946334933214039"><p id="EN-US_TASK_0172366579__p505064578214324"><a name="EN-US_TASK_0172366579__li1946334933214039"></a><a name="li1946334933214039"></a>Run <a href="cmdqueryname=filter-policy"><b><span class="cmdname" id="EN-US_TASK_0172366579__cmdname155902293214039">filter-policy</span></b></a> { <i><span class="varname" id="EN-US_TASK_0172366579__varname715561895214039">acl-number</span></i> | <strong><span id="EN-US_TASK_0172366579__cmdparmname476663063214039">acl-name</span></strong> <i><span class="varname" id="EN-US_TASK_0172366579__varname636914490214039">acl-name</span></i> } <strong><span id="EN-US_TASK_0172366579__cmdparmname917266004214039">export</span></strong> [ <strong><span id="EN-US_TASK_0172366579__cmdparmname1054351414214039">direct</span></strong> | <strong><span id="EN-US_TASK_0172366579__cmdparmname1894636489214039">static</span></strong><span> | <strong><span id="EN-US_TASK_0172366579__cmdparmname1346108837214039">unr</span></strong></span> | <strong><span id="EN-US_TASK_0172366579__cmdparmname1054342454214039">bgp</span></strong> | { rip | <strong><span id="EN-US_TASK_0172366579__cmdparmname229929984214039">isis</span></strong> | <strong><span id="EN-US_TASK_0172366579__cmdparmname1380013439214039">ospf</span></strong> } [ <i><span class="varname" id="EN-US_TASK_0172366579__varname448976194214039">process-id</span></i> ] ]</p>
<p id="EN-US_TASK_0172366579__p1889767346214324">The device is configured to filter the imported routes to be advertised.</p>
</li></ol>
</li><li id="EN-US_TASK_0172366579__li2124621157214039"><p id="EN-US_TASK_0172366579__p149703383214039"><a name="EN-US_TASK_0172366579__li2124621157214039"></a><a name="li2124621157214039"></a>Based on an IP prefix list:</p>
<p id="EN-US_TASK_0172366579__p67571115163115">Run <a href="cmdqueryname=filter-policy"><b><span class="cmdname" id="EN-US_TASK_0172366579__cmdname778112042214039">filter-policy</span></b></a> <strong><span id="EN-US_TASK_0172366579__cmdparmname427875866214039">ip-prefix</span></strong> <i><span class="varname" id="EN-US_TASK_0172366579__varname1263598411214039">ip-prefix-name</span></i> <strong><span id="EN-US_TASK_0172366579__cmdparmname1006712455214039">export</span></strong> [ <strong><span id="EN-US_TASK_0172366579__cmdparmname1971449879214039">direct</span></strong> | <strong><span id="EN-US_TASK_0172366579__cmdparmname28248580214039">static</span></strong><span> | <strong><span id="EN-US_TASK_0172366579__cmdparmname2026473182214039">unr</span></strong></span> | <strong><span id="EN-US_TASK_0172366579__cmdparmname1298592399214039">bgp</span></strong> | { rip | <strong><span id="EN-US_TASK_0172366579__cmdparmname64432749214039">isis</span></strong> | <strong><span id="EN-US_TASK_0172366579__cmdparmname146150661214039">ospf</span></strong> } [ <i><span class="varname" id="EN-US_TASK_0172366579__varname631192854214039">process-id</span></i> ] ]</p>
<p id="EN-US_TASK_0172366579__p740114444549">The device is configured to filter the imported routes to be advertised.</p>
</li><li id="EN-US_TASK_0172366579__li214496389214039"><p id="EN-US_TASK_0172366579__p1563250257214039"><a name="EN-US_TASK_0172366579__li214496389214039"></a><a name="li214496389214039"></a>Based on a route-policy:</p>
<p id="EN-US_TASK_0172366579__p14757191510319">Run <a href="cmdqueryname=filter-policy"><b><span class="cmdname" id="EN-US_TASK_0172366579__cmdname1293678514214039">filter-policy</span></b></a> <strong><span id="EN-US_TASK_0172366579__cmdparmname832712132214039">route-policy</span></strong> <i><span class="varname" id="EN-US_TASK_0172366579__varname1708480090214039">route-policy-name</span></i> <strong><span id="EN-US_TASK_0172366579__cmdparmname1864551314214039">export</span></strong> [ <strong><span id="EN-US_TASK_0172366579__cmdparmname781990210214039">direct</span></strong> | <strong><span id="EN-US_TASK_0172366579__cmdparmname1246424622214039">static</span></strong><span> | <strong><span id="EN-US_TASK_0172366579__cmdparmname672023677214039">unr</span></strong></span> | <strong><span id="EN-US_TASK_0172366579__cmdparmname2109421519214039">bgp</span></strong> | { <span><strong><span id="EN-US_TASK_0172366579__cmdparmname2086307823214039">rip</span></strong> | </span><strong><span id="EN-US_TASK_0172366579__cmdparmname1709253861214039">isis</span></strong> | <strong><span id="EN-US_TASK_0172366579__cmdparmname760229695214039">ospf</span></strong> } [ <i><span class="varname" id="EN-US_TASK_0172366579__varname1358727594214039">process-id</span></i> ] ]</p>
<p id="EN-US_TASK_0172366579__p66941139163014">The device is configured to filter the imported routes to be advertised.</p>
</li></ul>
</p></li><li id="EN-US_TASK_0172366579__step863250251214039"><span id="EN-US_TASK_0172366579__cmd609838668214324">Run <span><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172366579__cmdname474872843214324">commit</span></b></a></span></span><p><p id="EN-US_TASK_0172366579__p190725370214324">The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_route-policy_cfg_0017.html">Applying Filters to Routes to Be Advertised
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_route-policy_cfg_0035.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_route-policy_cfg_0037.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>