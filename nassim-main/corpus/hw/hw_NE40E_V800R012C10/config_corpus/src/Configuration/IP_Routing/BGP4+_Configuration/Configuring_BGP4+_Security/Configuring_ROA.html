
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring ROA">
<meta name="abstract" content="Resource Public Key Infrastructure (RPKI) can be configured to validate the origin of BGP4+ routes to ensure BGP4+ security. Route Origin Authorization (ROA) uses RPKI to validate and filter routes.">
<meta name="description" content="Resource Public Key Infrastructure (RPKI) can be configured to validate the origin of BGP4+ routes to ensure BGP4+ security. Route Origin Authorization (ROA) uses RPKI to validate and filter routes.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0081.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0082.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_30993.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP IPv6">
<meta name="featuretype" content="IP Route">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP IPv6">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP IPv6">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="w00604599">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00615954">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001217021397">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring ROA</title>
</head>
<body><a name="EN-US_TASK_0000001217021397"></a><a name="EN-US_TASK_0000001217021397"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring ROA</h1>
<div class="taskbody"><p>Resource Public Key Infrastructure (RPKI) can be configured to validate the origin of BGP4+ routes to ensure BGP4+ security. Route Origin Authorization (ROA) uses RPKI to validate and filter routes.</p>
<div class="context"><a name="EN-US_TASK_0000001217021397__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>To solve the problem of BGP4+ route hijacking, the industry proposes the RPKI solution that validates the origin ASs of BGP4+ routes. Distributed RPKI servers are used to collect information such as the origin AS numbers, route prefixes, and masks of BGP4+ routes initiated by each ISP. After a device sets up a connection with an RPKI cache server, the device saves a copy of Route Origin Authorization (ROA) data locally. If no RPKI server is available, static ROA data can be configured on a device. Inbound ROA validation, which applies to the BGP4+ routes received from peers, can be configured to control route selection. In addition, outbound ROA validation, which applies to the BGP4+ routes to be advertised to peers, can be configured to control route advertisement. ROA validation ensures that hosts in an AS can securely access external services.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001217021397__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring ROA, complete the following tasks:</p>
<ul><li><a href="dc_vrp_bgp6_cfg_0003.html">Configure basic BGP4+ functions</a>.</li></ul>

</div></div>
<div class="steps"><a name="EN-US_TASK_0000001217021397__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Select one of the following configurations based on the usage scenario:</span><p><ul><li>If the local device needs to obtain data from the ROA database through a connection to be established with an RPKI server, perform the following operations:<ol type="a"><li>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a><p>The system view is displayed.</p>
</li><li>Run <a href="cmdqueryname=rpki"><b><span class="cmdname">rpki</span></b></a><p>RPKI is started, and the RPKI view is displayed.</p>
</li><li>Run <a href="cmdqueryname=session"><b><span class="cmdname">session</span></b></a> <i><span class="varname">ipv6-address</span></i><p>An IPv6 address is specified for a TCP connection to be set up between the device and the RPKI server.</p>
</li><li><p>Run <a href="cmdqueryname=tcp+port+password+md5+keychain"><b><span class="cmdname">tcp</span></b></a> <strong><span>port</span></strong> <i><span class="varname">port-number</span></i> [ <strong><span>password md5</span></strong> <i><span class="varname">cipher-password</span></i> | <strong><span>keychain</span></strong><em> </em><i><span class="varname">keychain-name</span></i> ]</p>
<p>Parameters are configured for the TCP connection between the local device and the RPKI server.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>For security purposes, you are advised not to use weak security algorithms in this feature. If you need to use such an algorithm, run the <a href="cmdqueryname=undo+crypto+weak-algorithm+disable"><b><span class="cmdname">undo crypto weak-algorithm disable</span></b></a> command to enable the weak security algorithm function first.</p>
<p>The MD5 algorithm is not recommended if high security is required.</p>
</div></div>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul id="EN-US_TASK_0000001217021397__en-us_task_0000001143239100_ul034385541017"><li id="EN-US_TASK_0000001217021397__en-us_task_0000001143239100_li83435558109"><p id="EN-US_TASK_0000001217021397__en-us_task_0000001143239100_password_tips_vrp_1"><a name="EN-US_TASK_0000001217021397__en-us_task_0000001143239100_li83435558109"></a><a name="en-us_task_0000001143239100_li83435558109"></a>It is recommended that the new password is at least eight characters long and contains at least two of the following types: upper-case letters, lower-case letters, digits, and special characters, except the question mark (?) and space.</p>
</li><li id="EN-US_TASK_0000001217021397__en-us_task_0000001143239100_li153432055181010"><p id="EN-US_TASK_0000001217021397__en-us_task_0000001143239100_password_tips_vrp_2"><a name="EN-US_TASK_0000001217021397__en-us_task_0000001143239100_li153432055181010"></a><a name="en-us_task_0000001143239100_li153432055181010"></a>For security purposes, you are advised to configure a password in ciphertext mode. To further improve device security, periodically change the password.</p>
</li></ul>
</div></div>
</li><li>(Optional) Run <a href="cmdqueryname=timer+aging+refresh"><b><span class="cmdname">timer</span></b></a> { <strong><span>aging</span></strong> <i><span class="varname">aging-time</span></i> | <strong><span>refresh</span></strong> <i><span class="varname">refresh-time</span></i> }<p>RPKI session timers are configured.</p>
<p>The <i><span class="varname">aging-time</span></i> parameter specifies a value of the validation data age timer, and the <i><span class="varname">refresh-time</span></i> parameter specifies a value of the session update timer. You can configure the timers based on actual requirements on BGP4+ security. Small values are recommended if high BGP4+ security is required. However, frequent data updates consume much network bandwidth.</p>
</li><li>(Optional) Run <a href="cmdqueryname=rpki-limit+alert-only+idle-forever+idle-timeout"><b><span class="cmdname">rpki-limit</span></b></a> <i><span class="varname">limit</span></i> [ <strong><span>alert-only</span></strong> | <strong><span>idle-forever</span></strong> | <strong><span>idle-timeout</span></strong> <i><span class="varname">times</span></i> ]<p>The maximum number of ROA entries that the device is allowed to accept in a session is configured.</p>
<p>In most cases, a large number of ROA entries exist on a server. If the device receives a large number of ROA entries from the server, excessive system resources will be consumed. To prevent this problem, run the <a href="cmdqueryname=rpki-limit"><b><span class="cmdname">rpki-limit</span></b></a> command to configure the maximum number of ROA entries that the BGP4+ device is allowed to accept in a session.</p>
</li><li>(Optional) Run <a href="cmdqueryname=connect-interface"><b><span class="cmdname">connect-interface</span></b></a> { <i><span class="varname">interface-name</span></i> | <i><span class="varname">ipv6-source-address</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">ipv6-source-address</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> <i><span class="varname">ipv6-source-address</span></i> }<p>The source interface for sending RPKI packets is specified.</p>
</li><li>(Optional) Run <a href="cmdqueryname=ssl-policy"><b><span class="cmdname">ssl-policy</span></b></a> <i><span class="varname">policy-name</span></i><p>An SSL policy to be bound to the TCP connection between the device and RPKI server is configured.</p>
</li><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>Exit the RPKI session view.</p>
</li><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>Exit the RPKI view.</p>
</li><li>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a><p>The configuration is committed.</p>
</li></ol>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If configurations of an RPKI session are changed and you want its new configurations to take effect immediately, run the <a href="cmdqueryname=reset+rpki+session"><b><span class="cmdname">reset rpki session</span></b></a> command to reset the RPKI session.</p>
</div></div>
</li></ul>
<ul><li>If a static ROA database needs to be configured on the local device, perform the following operations:<ol type="a"><li>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a><p>The system view is displayed.</p>
</li><li>Run <a href="cmdqueryname=rpki"><b><span class="cmdname">rpki</span></b></a><p>RPKI is started, and the RPKI view is displayed.</p>
</li><li>Run <a href="cmdqueryname=origin-validation"><b><span class="cmdname">origin-validation</span></b></a><p>A static ROA database is created, and the RPKI origin-validation view is displayed.</p>
</li><li>Run <a href="cmdqueryname=static+record+max-length+origin-as"><b><span class="cmdname">static record</span></b></a> <i><span class="varname">ipv6-address</span></i> <i><span class="varname">ipv6-mask-length</span></i> <strong><span>max-length</span></strong> <i><span class="varname">ipv6-max-mask-length</span></i> <strong><span>origin-as</span></strong> <i><span class="varname">as-number</span></i><p>A record is configured for the static ROA database.</p>
</li><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>The RPKI view is displayed.</p>
</li><li>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a><p>The system view is displayed.</p>
</li><li>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a><p>The configuration is committed.</p>
</li></ol>
</li></ul>
</p></li><li><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=ipv6-family+unicast"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>unicast</span></strong></span><p><p>The IPv6 unicast address family view is displayed.</p>
</p></li><li><span>Configure inbound or outbound ROA validation as required.</span><p><ul><li>To configure inbound ROA validation (validation results not affecting route acceptance) for the routes received from an EBGP peer, perform the following operations:<ol type="a"><li>Run <a href="cmdqueryname=prefix+origin-validation+enable"><b><span class="cmdname">prefix origin-validation enable</span></b></a><p>Origin AS validation of RPKI is enabled. After origin AS validation is enabled, the device matches the origin AS of each received route against the origin AS data in the database and provides the validation result, which can be Valid, Not Found, or Invalid.</p>
</li><li>(Optional) Run <a href="cmdqueryname=bestroute+origin-as-validation+allow-invalid"><b><span class="cmdname">bestroute origin-as-validation</span></b></a> [ <strong><span>allow-invalid</span></strong> ]<p>The device is configured to apply origin AS validation results of RPKI to BGP4+ route selection.</p>
<p>BGP4+ selects routes in descending order of Valid, Not Found, and Invalid after origin AS validation results are applied to route selection. If <strong>allow-invalid</strong> is not specified in the command, the BGP4+ routes with the validation result being Invalid do not participate in route selection.</p>
</li><li>(Optional) Run <a href="cmdqueryname=peer+advertise-ext-community"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>advertise-ext-community</span></strong><p>The device is configured to advertise extended community attributes to the specified peer.</p>
</li><li>(Optional) Run <a href="cmdqueryname=peer+advertise+origin-as-validation"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>advertise origin-as-validation</span></strong><p>The device is enabled to advertise BGP4+ origin AS validation results of RPKI to the specified peer or peer group.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>BGP4+ origin AS validation results of RPKI can be advertised only to IBGP peers.</p>
</div></div>
</li></ol>
</li></ul>
<ul><li>To configure outbound ROA validation for the routes to be advertised to an EBGP peer to control route advertisement, perform the following operations:<p>Run <a href="cmdqueryname=peer+origin-validation+export+include-not-found+external"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">peerIpv6Addr</span></i> | <i><span class="varname">peerGroupName</span></i> } <strong><span>origin-validation export</span></strong> [ <strong><span>include-not-found</span></strong> [ <strong><span>external</span></strong> ] ]</p>
<p>The local device is configured to perform outbound ROA validation on the routes to be advertised to the specified EBGP peer.</p>
<p>After the local device is configured to perform outbound ROA validation on the routes to be advertised to a specified EBGP peer, the device matches the origin ASs of the routes against those of the matched routes recorded in the database. The validation result can be Valid, Not Found, or Invalid. By default, only the routes whose validation result is Valid are advertised. To configure the device to advertise the routes with the validation result being Valid or Not Found, specify the <strong>include-not-found</strong> keyword in the preceding command. To configure the device to advertise the routes with the validation result being Valid or Not Found (if the routes with the result being Not Found were received from another AS), specify the <strong>include-not-found external</strong> keyword in the preceding command.</p>
</li></ul>
</p></li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001217021397__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After the configuration is complete, verify it.</p>
<ul><li>Run the <a href="cmdqueryname=display+rpki+session+verbose"><b><span class="cmdname">display rpki session</span></b></a> <i><span class="varname">ipv6-address</span></i> <strong><span>verbose</span></strong> command to check RPKI session configurations.</li><li>Run the <a href="cmdqueryname=display+rpki+table"><b><span class="cmdname">display rpki table</span></b></a> command to check ROA information.</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0081.html">Configuring BGP4+ Security
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_0082.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bgp6_cfg_30993.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>