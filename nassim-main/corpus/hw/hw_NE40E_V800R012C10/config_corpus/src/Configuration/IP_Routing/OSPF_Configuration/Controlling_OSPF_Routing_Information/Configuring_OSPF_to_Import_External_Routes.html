
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring OSPF to Import External Routes">
<meta name="abstract" content="Importing the routes discovered by other routing protocols can enrich OSPF routing information.">
<meta name="description" content="Importing the routes discovered by other routing protocols can enrich OSPF routing information.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0041.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_2041.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="ospf,w00800033,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Route">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Route">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing Basis">
<meta name="OWNER" content="z00875216">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00875216">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172365574">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring OSPF to Import External Routes</title>
</head>
<body><a name="EN-US_TASK_0172365574"></a><a name="EN-US_TASK_0172365574"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring OSPF to Import External Routes</h1>
<div class="taskbody"><p>Importing the routes discovered by other routing protocols can enrich OSPF routing information.</p>
<div class="context"><a name="EN-US_TASK_0172365574__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>When a device on an OSPF network needs to access a device running a non-OSPF routing protocol, the device needs to import the routes of the non-OSPF routing protocol into the OSPF network.</p>
<p>OSPF provides loop-free intra-area routes and inter-area routes; however, OSPF cannot prevent external routing loops. Therefore, exercise caution when configuring OSPF to import external routes.</p>
<p>Perform the following operations on the <span class="keyword">Router</span> that functions as the ASBR running OSPF:</p>
<div class="notice"><span class="noticetitle"><img src="../../../../public_sys-resources/notice_3.0-en-us.png"> </span><div class="noticebody"><p>OSPF and other dynamic routing protocols such as IS-IS and BGP often import routes from each other. If no routing policy is configured or a routing policy is incorrectly configured on a device where IS-IS, OSPF, and BGP import routes from each other, a Layer 3 routing loop may occur due to a route selection result change. As a result, services are compromised.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172365574__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=ospf"><b><span class="cmdname">ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ]</span></span><p><p>The OSPF view is displayed.</p>
</p></li><li id="EN-US_TASK_0172365574__substep_dc_vrp_cfg_01623001"><span id="EN-US_TASK_0172365574__">Run <a href="cmdqueryname=import-route"><b><span class="cmdname">import-route</span></b></a> { <strong><span>bgp</span></strong> [ <strong><span>permit-ibgp</span></strong> ] | <strong><span>direct</span></strong><span> | <strong><span>rip</span></strong> [ <i><span class="varname">process-id-rip</span></i> ]</span> | <strong><span>static</span></strong><span> | <strong><span>unr</span></strong></span> | <strong><span>isis</span></strong> [ <i><span class="varname">process-id-isis</span></i> ] | <strong><span>ospf</span></strong> [ <i><span class="varname">process-id-ospf</span></i> ] } [ { <strong><span>inherit-cost</span></strong> | <strong><span>cost</span></strong> <i><span class="varname">cost</span></i> } | <strong><span>tag</span></strong> <i><span class="varname">tag</span></i> | <strong><span>type</span></strong> <i><span class="varname">type</span></i> | <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i><span> | <strong><span>route-filter</span></strong> <i><span class="varname">route-filter-name</span></i></span> ] <sup>*</sup></span><p><p>The device is configured to import routes from another protocol.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=default"><b><span class="cmdname">default</span></b></a> { <strong><span>cost</span></strong> { <i><span class="varname">cost</span></i> | <strong><span>inherit-metric</span></strong> } | <strong><span>tag</span></strong> <i><span class="varname">tag</span></i> | <strong><span>type</span></strong> <i><span class="varname">type</span></i> } <sup>*</sup></span></span><p><p>The default values of parameters (the cost, number of routes, tag, and type) are set for imported routes.</p>
<p>When OSPF imports external routes, you can set default values for some additional parameters, such as the cost, number of routes to be imported, route tag, and route type. The route tag is used to identify the protocol-related information. For example, it can be used to differentiate AS numbers carried in BGP routes imported by OSPF.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p">You can run one of the following commands to set the cost of the imported route. The following commands are listed in descending order of priorities.<ul><li>Run the <a href="cmdqueryname=apply+cost"><b><span class="cmdname">apply cost</span></b></a> command to set the cost of a route.</li><li>Run the <a href="cmdqueryname=import-route"><b><span class="cmdname">import-route</span></b></a> command to set the cost of the imported route.</li><li>Run the <a href="cmdqueryname=default"><b><span class="cmdname">default</span></b></a> command to set the default cost of the imported route.</li></ul>
</div>
</div></div>
</p></li><li><span>(Optional) Run any of the following commands as required:</span><p><ul><li>Based on a basic ACL:<ol type="a"><li><p>Run <a href="cmdqueryname=filter-policy"><b><span class="cmdname">filter-policy</span></b></a> { <i><span class="varname">acl-number</span></i> | <strong><span>acl-name</span></strong> <i><span class="varname">acl-name</span></i> } <strong><span>export</span></strong> [ <strong><span>direct</span></strong> | <strong><span>static</span></strong><span> | <strong><span>unr</span></strong></span> | <strong><span>bgp</span></strong> | { rip | <strong><span>isis</span></strong> | <strong><span>ospf</span></strong> } [ <i><span class="varname">process-id</span></i> ] ]</p>
<p>The device is configured to filter the routes imported in step <a href="#EN-US_TASK_0172365574__substep_dc_vrp_cfg_01623001">3</a> so that only the matched routes are advertised.</p>
</li><li><p>Run <span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></p>
<p>Return to the system view.</p>
</li><li>Run <span><a href="cmdqueryname=acl"><b><span class="cmdname">acl</span></b></a> { <strong><span>name</span></strong> <i><span class="varname">basic-acl-name</span></i> { <strong><span>basic</span></strong> | [ <strong><span>basic</span></strong> ] <strong><span>number</span></strong> <i><span class="varname">basic-acl-number</span></i> } | [ <strong><span>number</span></strong> ] <i><span class="varname">basic-acl-number</span></i> } [ <strong><span>match-order</span></strong> { <strong><span>config</span></strong> | <strong><span>auto</span></strong> } ]</span><p>The ACL view is displayed.</p>
</li><li><p>Run <span><a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> [ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>deny</span></strong> | <strong><span>permit</span></strong> } [ <strong><span>fragment-type</span></strong> { <strong><span>fragment</span></strong> | <strong><span>non-fragment</span></strong> | <strong><span>non-subseq</span></strong> | <strong><span>fragment-subseq</span></strong> | <strong><span>fragment-spe-first</span></strong> } | <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong><span> | <i><span class="varname">src-netmask</span></i></span> } | <strong><span>any</span></strong> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <sup>*</sup></span></p>
<p>An ACL rule is configured.</p>
<p>When the <a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> command is used to configure a filtering rule for a named ACL, only the configurations specified by <strong><span>source</span></strong> and <strong><span>time-range</span></strong> take effect.</p>
<div class="p">When a filter-policy of a routing protocol is used to filter routes:<ul><li><p>If the action specified in an ACL rule is <strong>permit</strong>, a route matching the rule will be accepted or advertised by the system.</p>
</li><li><p>If the action specified in an ACL rule is <strong>deny</strong>, a route matching the rule will not be accepted or advertised by the system.</p>
</li><li><p>If the network segment of a route is not within the range specified in an ACL rule, the route will not be accepted or advertised by the system.</p>
</li><li><p>If an ACL does not contain any rules, none of the routes matched against the filter-policy that uses this ACL will be accepted or advertised by the system.</p>
</li><li><p>Routes can be filtered using a blacklist or whitelist:</p>
<p>If ACL rules are used for matching in configuration order, the system matches the rules in ascending order of their IDs.</p>
<p>Filtering using a blacklist: Configure a rule with a smaller ID and specify the action <strong>deny</strong> in this rule to filter out the unwanted routes. Then, configure another rule with a larger ID in the same ACL and specify the action <strong>permit</strong> in this rule to accept or advertise the other routes.</p>
<p>Filtering using a whitelist: Configure a rule with a smaller ID and specify the action <strong>permit</strong> in this rule to permit the routes to be accepted or advertised. Then, configure another rule with a larger ID in the same ACL and specify the action <strong>deny</strong> in this rule to filter out the unwanted routes.</p>
</li></ul>
</div>
</li><li>Run <a href="cmdqueryname=ospf"><b><span class="cmdname">ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ]<p>The OSPF view is displayed.</p>
</li></ol>
</li><li><p>Based on an IP prefix list:</p>
<p>Run <a href="cmdqueryname=filter-policy"><b><span class="cmdname">filter-policy</span></b></a> <strong><span>ip-prefix</span></strong> <i><span class="varname">ip-prefix-name</span></i> <strong><span>export</span></strong> [ <strong><span>direct</span></strong> | <strong><span>static</span></strong><span> | <strong><span>unr</span></strong></span> | <strong><span>bgp</span></strong> | { <span><strong><span>rip</span></strong> | </span><strong><span>isis</span></strong> | <strong><span>ospf</span></strong> } [ <i><span class="varname">process-id</span></i> ] ]</p>
<p>The device is configured to filter the routes imported in step <a href="#EN-US_TASK_0172365574__substep_dc_vrp_cfg_01623001">3</a> so that only the matched routes are advertised.</p>
</li></ul>
<p>OSPF filters the imported routes. OSPF uses Type 5 LSAs to carry routes that meet the filtering conditions and advertises these Type 5 LSAs. </p>
<p>You can specify the parameter <i><span class="varname">protocol</span></i> [ <i><span class="varname">process-id</span></i> ] to filter the routes of a certain routing protocol or a certain OSPF process. If <i><span class="varname">protocol</span></i> [ <i><span class="varname">process-id</span></i> ] is not specified, OSPF filters all imported routes.</p>
<p>The <a href="cmdqueryname=import-route"><b><span class="cmdname">import-route</span></b></a> command cannot be used to import external default routes.</p>
</p></li><li><span>Run <a href="cmdqueryname=import-route+limit"><b><span class="cmdname">import-route limit</span></b></a> <i><span class="varname">limit-number</span></i> [ <strong><span>threshold-alarm</span></strong> { <strong><span>upper-limit</span></strong> <i><span class="varname">upper-limit-value</span></i> | <strong><span>lower-limit</span></strong> <i><span class="varname">lower-limit-value</span></i> } <sup>*</sup> ]</span><p><p>The maximum number of LSAs generated when OSPF imports routes is set.</p>
</p><p><div class="p">If OSPF imports a large number of external routes and advertises them to a device with a small routing table capacity, the device may restart unexpectedly. To address this problem, set a limit on the number of LSAs generated when OSPF imports external routes. You can check the overload status based on the value of the <strong>Current status</strong> field in the <a href="cmdqueryname=display+ospf+brief"><b><span class="cmdname">display ospf brief</span></b></a> command output.<ul><li>Normal: The number is less than or equal to the lower alarm threshold.</li><li>Approach limit: The number is approaching (reaching or exceeding 90% of) the upper alarm threshold.</li><li>Exceed limit: The number has reached or exceeded the limit.</li></ul>
</div>
<p>Ensure that <i><span class="varname">upper-limit-value</span></i> is greater than or equal to <i><span class="varname">lower-limit-value</span></i>.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_0041.html">Controlling OSPF Routing Information
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ospf_cfg_2041.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>