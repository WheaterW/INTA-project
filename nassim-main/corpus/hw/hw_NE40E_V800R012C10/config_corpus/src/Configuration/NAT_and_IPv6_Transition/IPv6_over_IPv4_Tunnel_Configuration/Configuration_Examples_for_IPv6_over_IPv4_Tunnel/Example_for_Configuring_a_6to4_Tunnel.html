
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a 6to4 Tunnel">
<meta name="abstract" content="This section provides an example for configuring a 6to4 tunnel.">
<meta name="description" content="This section provides an example for configuring a 6to4 tunnel.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_6o4tnl_cfg_0008.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_6o4tnl_cfg_0009.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_6o4tnl_cfg_0011.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="c00549182">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPv6 over IPv4">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv6 over IPv4">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="IPv6 over IPv4">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="IPv6 over IPv4">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="c00549182">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172365299">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring a 6to4 Tunnel</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172365299"></a><a name="EN-US_TASK_0172365299"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a 6to4 Tunnel</h1>
<div class="taskbody"><p>This section provides an example for configuring a 6to4 tunnel.</p>
<div class="context"><a name="EN-US_TASK_0172365299__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0172365299__fig_dc_vrp_6o4tnl_cfg_001001">Figure 1</a>, two IPv6 networks are both 6to4 networks; both <span class="keyword">Device</span>A and <span class="keyword">Device</span>B connect to a 6to4 network and the IPv4 backbone network. To interconnect the two 6to4 networks, a 6to4 tunnel needs to be configured between <span class="keyword">Device</span>A and <span class="keyword">Device</span>B.</p>
<p>To allow interworking of 6to4 networks, a 6to4 address needs to be configured for the host, with the prefix of <strong>2002:IPv4 address:</strong> and prefix length of 48 bits. As shown in <a href="#EN-US_TASK_0172365299__fig_dc_vrp_6o4tnl_cfg_001001">Figure 1</a>, the IPv4 address of the interface connecting <span class="keyword">Device</span>A and the IPv4 network is 1.1.1.1. Then, the 6to4 address for the 6to4 network where <span class="keyword">Device</span>A resides should have a prefix of 2002:101:101:: and a prefix length of 64 bits.</p>
<div class="fignone" id="EN-US_TASK_0172365299__fig_dc_vrp_6o4tnl_cfg_001001"><a name="EN-US_TASK_0172365299__fig_dc_vrp_6o4tnl_cfg_001001"></a><a name="fig_dc_vrp_6o4tnl_cfg_001001"></a><span class="figcap"><b>Figure 1 </b>Networking diagram for configuring a 6to4 tunnel</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent GE <span>0/1/0</span> and GE <span>0/1/1</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_6o4tnl_cfg_001001.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365299__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>When configuring a 6to4 tunnel, note the following points:</p>
<ul><li><p>Create a tunnel interface and set parameters for the tunnel interface.</p>
</li><li><p>Configure only the source IPv4 address of the tunnel. The destination IP address of the tunnel is the same as the destination IP address contained in the original IPv6 packet. The source IP address of a 6to4 tunnel must be unique.</p>
</li><li><p>Assign a 6to4 address to the interface that connects a border <span class="keyword">Router</span> to a 6to4 network and an IPv4 address to the interface that connects a border <span class="keyword">Router</span> to an IPv4 network.</p>
</li><li><p>Configure an IP address for the tunnel interface to support routing protocols.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365299__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure the IPv4/IPv6 dual stack on the <span class="keyword">Router</span>s.</p>
</li><li><p>Configure a 6to4 tunnel on the <span class="keyword">Router</span>s.</p>
</li><li><p>Configure static routes on the <span class="keyword">Router</span>s.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172365299__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IPv4 and IPv6 addresses of the interfaces</p>
</li><li><p>Source IP address of the tunnel interface</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172365299__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure IP addresses for interfaces on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B.</span><p><p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>]<strong> sysname <span class="keyword">Device</span>A</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> ip address 1.1.1.1 8</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>]<strong> ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>]<strong> ipv6 address 2002:101:101:1::1 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>]<strong> sysname <span class="keyword">Device</span>B</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> interface GigabitEthernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>]<strong> ip address 1.1.1.2 8</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/1</span>]<strong> ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/1</span>]<strong> ipv6 address 2002:101:102:1::1 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
</p></li><li><span># Configure a 6to4 tunnel on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B.</span><p><p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> interface Tunnel 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel10]<strong> tunnel-protocol ipv6-ipv4 6to4</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel10]<strong> ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel10]<strong> ipv6 address 2002:101:101::1 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel10] <strong>source 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Tunnel10] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> interface Tunnel 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-Tunnel10]<strong> tunnel-protocol ipv6-ipv4 6to4</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-Tunnel10]<strong> ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-Tunnel10]<strong> ipv6 address 2002:101:102::1 64</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-Tunnel10] <strong>source 1.1.1.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-Tunnel10] <strong>quit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>A reachable route must exist between <span class="keyword">Device</span>A and <span class="keyword">Device</span>B. In this example, the two <span class="keyword">Router</span>s are directly connected. Therefore, no routing protocol is configured.</p>
</div></div>
</p></li><li><span># Configure a route to the 6to4 network on <span class="keyword">Device</span>A and <span class="keyword">Device</span>B.</span><p><p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> ipv6 route-static 2002:: 16 Tunnel 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> commit</strong></pre>
<p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> ipv6 route-static 2002:: 16 Tunnel 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Check the IPv6 status of Tunnel 10 on <span class="keyword">Device</span>A. The command output shows that the tunnel is <strong>UP</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> display ipv6 interface Tunnel 10</strong></pre>
<pre class="screen">Tunnel10 current state : UP</pre>
<pre class="screen">IPv6 protocol current state : UP</pre>
<pre class="screen">link-local address is FE80::101:101</pre>
<pre class="screen">  Global unicast address(es):</pre>
<pre class="screen">    2002:101:101::1, subnet is 2002:101:101::/64</pre>
<pre class="screen">  Joined group address(es):</pre>
<pre class="screen">    FF02::1:FF01:101</pre>
<pre class="screen">    FF02::1:FF00:1</pre>
<pre class="screen">    FF02::2</pre>
<pre class="screen">    FF02::1</pre>
<pre class="screen">  MTU is 1500 bytes</pre>
<pre class="screen">  ND DAD is enabled, number of DAD attempts: 1.</pre>
<pre class="screen">  ND reachable time is 1200000 milliseconds.</pre>
<pre class="screen">  ND retransmit interval is 1000 milliseconds.</pre>
<pre class="screen">  Hosts use stateless autoconfig for addresses.</pre>
<p># Ping the 6to4 address of GE <span>0/1/1</span> on <span class="keyword">Device</span>B from <span class="keyword">Device</span>A. The command output shows the ping is successful.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> ping ipv6 2002:101:102:1::1</strong></pre>
<pre class="screen">  PING 2002:101:102:1::1 : 56  data bytes, press CTRL_C to break </pre>
<pre class="screen">    Reply from 2002:101:102:1::1</pre>
<pre class="screen">    bytes=56 Sequence=1 hop limit=64 time=10 ms</pre>
<pre class="screen">    Reply from 2002:101:102:1::1</pre>
<pre class="screen">    bytes=56 Sequence=2 hop limit=64 time=2 ms</pre>
<pre class="screen">    Reply from 2002:101:102:1::1</pre>
<pre class="screen">    bytes=56 Sequence=3 hop limit=64 time=2 ms</pre>
<pre class="screen">    Reply from 2002:101:102:1::1</pre>
<pre class="screen">    bytes=56 Sequence=4 hop limit=64 time=2 ms</pre>
<pre class="screen">    Reply from 2002:101:102:1::1</pre>
<pre class="screen">    bytes=56 Sequence=5 hop limit=64 time=2 ms</pre>
<pre class="screen">  ---2002:101:102:1::1 ping statistics---</pre>
<pre class="screen">    5 packet(s) transmitted</pre>
<pre class="screen">    5 packet(s) received</pre>
<pre class="screen">    0.00% packet loss</pre>
<pre class="screen">    round-trip min/avg/max = 5/14/29 ms</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172365299__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span>A configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>A
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 1.1.1.1 255.0.0.0
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2002:101:101:1::1/64
#
interface Tunnel 10
 ipv6 enable
 ipv6 address 2002:101:101::1/64
 tunnel-protocol ipv6-ipv4 6to4
 source 1.1.1.1
#
ipv6 route-static :: 0 2002:101:102::1
#
ipv6 route-static 2002:: 16 Tunnel 10
#
return</pre>
</li><li><p><span class="keyword">Device</span>B configuration file</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>B
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
 ip address 1.1.1.2 255.0.0.0
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 ipv6 enable
 ipv6 address 2002:101:102:1::1/64
#
interface Tunnel 10
 ipv6 enable
 ipv6 address 2002:101:102::1/64
 tunnel-protocol ipv6-ipv4 6to4
 source 1.1.1.2
#
ipv6 route-static 2002:: 16 Tunnel 10
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_6o4tnl_cfg_0008.html">Configuration Examples for IPv6 over IPv4 Tunnel
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_6o4tnl_cfg_0009.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_6o4tnl_cfg_0011.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>