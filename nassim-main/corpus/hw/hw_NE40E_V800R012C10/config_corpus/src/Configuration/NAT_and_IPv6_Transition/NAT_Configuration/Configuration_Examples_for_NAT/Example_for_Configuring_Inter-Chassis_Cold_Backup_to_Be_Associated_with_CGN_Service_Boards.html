
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Inter-Chassis Cold Backup to Be Associated with CGN Service Boards">
<meta name="abstract" content="This section provides an example for configuring inter-chassis cold backup to be associated with CGN service boards for improved NAT device reliability.">
<meta name="description" content="This section provides an example for configuring inter-chassis cold backup to be associated with CGN service boards for improved NAT device reliability.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0056.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0096.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0161.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="c00549182">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="c00549182">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001092838008">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Example for Configuring Inter-Chassis Cold Backup to Be Associated with CGN Service Boards</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001092838008"></a><a name="EN-US_TASK_0000001092838008"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Inter-Chassis Cold Backup to Be Associated with CGN Service Boards</h1>
<div class="taskbody"><p>This section provides an example for configuring inter-chassis cold backup to be associated with CGN service boards for improved NAT device reliability.</p>
<div class="context"><a name="EN-US_TASK_0000001092838008__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_context605681245214110"><h4 class="sectiontitle">Networking Requirements</h4><div class="note" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_note98102031145210"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p18810531185214">Only the <span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1152414571330">NE40E</span><span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword3501321048">-M2K</span> and <span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword84407551658">NE40E</span><span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword18823101016414">-M2K-B</span> support this configuration.</p>
</div></div>
<p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p592091001214110">On the centralized NAT network shown in <a href="#EN-US_TASK_0000001092838008__en-us_task_0172374615_fig_dc_ne_cfg_nat_009801">Figure 1</a>, a NAT service board is equipped in slot <span>1</span> on CGN1 and slot <span>1</span> on CGN2. CGN1 and CGN2 are standalone CGN devices attached to CRs on the MAN.</p>
<p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1619513095214110">If a CGN service board fails, BGP does not withdraw the default route advertised to a downstream device. As a result, traffic attempts to reach the CGN device over the static route but is interrupted. To prevent the traffic interruption, inter-chassis cold backup can be associated with CGN service boards. A ServiceIf interface is associated with a HA service status monitoring group to monitor the CGN board status in real time. Once the ServiceIf interface detects the abnormal CGN service board status, a master/backup CGN device switchover is triggered so that traffic switches to the backup CGN device.</p>
<div class="fignone" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_fig_dc_ne_cfg_nat_009801"><a name="EN-US_TASK_0000001092838008__en-us_task_0172374615_fig_dc_ne_cfg_nat_009801"></a><a name="en-us_task_0172374615_fig_dc_ne_cfg_nat_009801"></a><span class="figcap"><b>Figure 1 </b>Network diagram of NAT inter-chassis cold backup</span><div class="note" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_note18488996214110"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1506910604214110">Interface 1 in this example represents GE <span>0/2/0</span>.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_image1117085167214110" src="images/fig_dc_ne_cfg_nat_009801.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001092838008__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_context1138869632214110"><div class="p" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p460159313214110">The configuration roadmap is as follows:<ol id="EN-US_TASK_0000001092838008__en-us_task_0172374615_ol484255251214110"><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_li1316952491214110">Configure basic NAT functions.</li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_li596155626214110">Create an HA service status monitoring group and associate it with a service-location group.</li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_li1851370837214110">Configure a ServiceIf interface and bind it to the HA service status monitoring group.</li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_li07353705010">Configure a NAT traffic diversion policy and NAT traffic conversion policy.</li></ol>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001092838008__1.4.3"></a><a name="1.4.3"></a>
<div class="p" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_context1351361480214110"><h4 class="sectiontitle">Data Preparation</h4><div class="p" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1068065918214110">To complete the configuration, you need the following data:
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_table955244466214110" frame="border" border="1" rules="all"><thead align="left"><tr id="EN-US_TASK_0000001092838008__en-us_task_0172374615_row2042511487214110"><th align="left" class="cellrowborder" valign="top" width="11.87%" id="mcps1.4.3.2.1.1.3.1.1" liSelected="liSelected"><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p476078701214110">No.</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="88.13%" id="mcps1.4.3.2.1.1.3.1.2" liSelected="liSelected"><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p42078585214110">Data</p>
</th>
</tr>
</thead>
<tbody><tr id="EN-US_TASK_0000001092838008__en-us_task_0172374615_row1894453450214110"><td class="cellrowborder" valign="top" width="11.87%" headers="mcps1.4.3.2.1.1.3.1.1 "><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1010911327214110">1</p>
</td>
<td class="cellrowborder" valign="top" width="88.13%" headers="mcps1.4.3.2.1.1.3.1.2 "><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1055400555214110">Service-location group index</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001092838008__en-us_task_0172374615_row1681118049214110"><td class="cellrowborder" valign="top" width="11.87%" headers="mcps1.4.3.2.1.1.3.1.1 "><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p134283562214110">2</p>
</td>
<td class="cellrowborder" valign="top" width="88.13%" headers="mcps1.4.3.2.1.1.3.1.2 "><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p915795865214110">Slot ID and CPU ID of the master CPU on CGN1's service board (CPU 0 in slot <span>1</span> is used in this scenario)</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001092838008__en-us_task_0172374615_row951398981214110"><td class="cellrowborder" valign="top" width="11.87%" headers="mcps1.4.3.2.1.1.3.1.1 "><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1233796562214110">3</p>
</td>
<td class="cellrowborder" valign="top" width="88.13%" headers="mcps1.4.3.2.1.1.3.1.2 "><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1992860911214110">Slot ID and CPU ID of the backup CPU on CGN2's service board (CPU 0 in slot <span>1</span> is used in this scenario)</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001092838008__en-us_task_0172374615_row1154523451214110"><td class="cellrowborder" valign="top" width="11.87%" headers="mcps1.4.3.2.1.1.3.1.1 "><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p374900515214110">4</p>
</td>
<td class="cellrowborder" valign="top" width="88.13%" headers="mcps1.4.3.2.1.1.3.1.2 "><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1423607880214110">Service-instance group name</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001092838008__en-us_task_0172374615_row2081474213214110"><td class="cellrowborder" valign="top" width="11.87%" headers="mcps1.4.3.2.1.1.3.1.1 "><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p761322078214110">5</p>
</td>
<td class="cellrowborder" valign="top" width="88.13%" headers="mcps1.4.3.2.1.1.3.1.2 "><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1097223587214110">Name and index of a NAT instance</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001092838008__en-us_task_0172374615_row1990868172214110"><td class="cellrowborder" valign="top" width="11.87%" headers="mcps1.4.3.2.1.1.3.1.1 "><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1185189414214110">6</p>
</td>
<td class="cellrowborder" valign="top" width="88.13%" headers="mcps1.4.3.2.1.1.3.1.2 "><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p183342605214110">Name of an HA service status monitoring group</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001092838008__en-us_task_0172374615_row2084001567214110"><td class="cellrowborder" valign="top" width="11.87%" headers="mcps1.4.3.2.1.1.3.1.1 "><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1047948666214110">7</p>
</td>
<td class="cellrowborder" valign="top" width="88.13%" headers="mcps1.4.3.2.1.1.3.1.2 "><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1954001157214110">ServiceIf interface number</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001092838008__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001092838008__en-us_task_0172374615_steps1103220010214110"><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_step2041573497214110"><span id="EN-US_TASK_0000001092838008__en-us_task_0172374615_cmd232052313214110">Set the maximum number of sessions that can be created on the NAT service board in slot <span>1</span> to 6M on master and backup devices.</span><p><div class="p" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1374456841214110"># Configure master CGN1.<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1639353645214110">&lt;<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword961508661214110">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1263192786214110">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen147841219214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword2026471749214110"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1967527670214110">HUAWEI</span>] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1765827491214110">sysname CGN1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen877326085214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1505822961214110">*</span><span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword271725632214110">HUAWEI</span>] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1320882732214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen10628105815120">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1479191185217"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1]<strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b92381517165214"> vsm on-board-mode disable</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen31591256185114">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1389551918537">*</span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b136981056527">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen2069707444214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword616770423214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b501534128214110">license</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1879975089214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword446543256214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-license] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1251227728214110">active nat session-table size 6 slot <span>1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen18829541131713">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword9761101381818"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-license]<strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b17761191316185"> active nat bandwidth-enhance 40 slot <span>1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1215007956214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword233194071214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-license] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b660223375214110">quit</strong></pre>
</div>
<div class="p" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p918943041214110"># Configure backup CGN2.<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen91686664214110">&lt;<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword2114811116214110">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1474929970214110">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1975398355214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword683649485214110"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1059382945214110">HUAWEI</span>] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b820110122214110">sysname CGN2</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1034447641214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1389542371214110">*</span><span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword153968272214110">HUAWEI</span>] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b2025303413214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen107784013530">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword20597205315"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2]<strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b125918218535"> vsm on-board-mode disable</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen148266965320">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword198567225539">*</span>CGN2] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b25962165310">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen568708480214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1197140735214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b811715147214110">license</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen83075498214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1234144819590"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2-license] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b251913248214110">active nat session-table size 6 slot <span>1</span> </strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen4198123481813">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1703235151815"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2-license]<strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b2703133571820"> active nat bandwidth-enhance 40 slot <span>1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen642054451214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword755946265214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2-license] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1402710132214110">quit</strong></pre>
</div>
</p></li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_step197909867214110"><span id="EN-US_TASK_0000001092838008__en-us_task_0172374615_cmd1966449113214110">Create a service-location group on each CGN device.</span><p><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p210882539214110"># On CGN1, create a service-location group <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b291316128214415">1</strong> and configure CPU with ID <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1627898992214415">0</strong> in slot <span>1</span> as a member in inter-chassis service-location backup.</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen714471974214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword322641765214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b280691637214110">service-location 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen174514234214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword729841514214110">*</span>CGN1-service-location-1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b959108500214110">location slot <span>1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen115752720214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1632850448214110">*</span>CGN1-service-location-1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b641019760214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen829923553214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1051274421214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-service-location-1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b149953965214110">quit</strong></pre>
<p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1888492321214110"># On CGN2, create a service-location group <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1789465843214415">1</strong> and configure CPU with ID <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1840440181214415">0</strong> in slot <span>1</span> as a member in HA inter-chassis service-location backup.</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen350192174214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword2132465885214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1725845650214110">service-location 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1025434257214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword111692955214110">*</span>CGN2-service-location-1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b540895727214110">location slot <span>1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1171194654214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword584675808214110">*</span>CGN2-service-location-1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1213625778214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1012859172214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword398140843214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2-service-location-1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1841844352214110">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_step58540331214110"><span id="EN-US_TASK_0000001092838008__en-us_task_0172374615_cmd339832791214110">Create a service-instance group and bind it to the service-location group on each CGN device.</span><p><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p910670440214110"># On CGN1, create a service-instance group named <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b705384750214415">group 1</strong> and bind it to service-location group <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b633965013214415">1</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen869653535214110">[<font style="font-size:8pt" Face="Courier New" >~</font>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b955169821214110">service-instance-group group1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1192806954214110">[*CGN1-service-instance-group-group1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1704342188214110">service-location 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1392867365214110">[*CGN1-service-instance-group-group1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b792207161214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1522817570214110">[<font style="font-size:8pt" Face="Courier New" >~</font>CGN1-service-instance-group-group1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1939931992214110">quit</strong></pre>
<p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p807124147214110"># On CGN2, create a service-instance group named <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b482026792214415">group 1</strong> and bind it to service-location group <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1021768993214415">1</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen114503328214110">[<font style="font-size:8pt" Face="Courier New" >~</font>CGN2] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1074067114214110">service-instance-group group1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1058438822214110">[*CGN2-service-instance-group-group1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1139752131214110">service-location 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen737016941214110">[*CGN2-service-instance-group-group1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b522230343214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen471301879214110">[<font style="font-size:8pt" Face="Courier New" >~</font>CGN2-service-instance-group-group1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1527672989214110">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_step2020223963214110"><span id="EN-US_TASK_0000001092838008__en-us_task_0172374615_cmd40203424214110">Create a service status monitoring group and bind it to the service-location group on each CGN device.</span><p><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1549139657214110"># On CGN1, create a service status monitoring group named <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b2014930067214415">group1</strong> and bind it to service-location group <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1022191237214415">1</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen14266205214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword109300430214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1729362078214110">monitor-location-group group1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1371790508214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword468388509214110">*</span>CGN1-monitor-location-group-group1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b999729905214110">service-location 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen954079125214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1752491446214110">*</span>CGN1-monitor-location-group-group1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1173941398214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1938353964214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword135502965214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-monitor-location-group-group1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b650560565214110">quit</strong></pre>
<p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1660581526214110"># On CGN2, create a service status monitoring group named <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b366595033214415">group1 </strong>and bind it to service-location group <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b53824183214415">1</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen2064684634214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword2082077163214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1641576459214110">monitor-location-group group1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1040994899214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1036759449214110">*</span>CGN2-monitor-location-group-group1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1627766333214110">service-location 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen121832316214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword796714893214110">*</span>CGN2-monitor-location-group-group1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1730741599214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1674665264214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1517737428214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2-monitor-location-group-group1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b560961444214110">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_step13781947163419"><span id="EN-US_TASK_0000001092838008__en-us_task_0172374615_cmd11785478340">Create a loopback interface on each CGN device and enable a BGP route between CGN1 and CGN2.</span><p><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p464332963513"># Create <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b2020227142310">loopBack0</strong> on CGN1 and establish a BGP route between CGN1 and CGN2.</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen136831314133514">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword189571953133516"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b8366124413510">interface LoopBack0</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen19317105783515">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1749215105368">*</span>CGN1-LoopBack0]<strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b73424310368"> ip address 1.1.1.1 255.255.255.255</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen125311214153617">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword29537154012">*</span>CGN1-LoopBack0]<strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b8953718406"> </strong><strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1828619101400">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen558201374010">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword311218249402"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-LoopBack0]<strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b37951420174013"> </strong><strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b13860727114011">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1661873074013">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1719934204018"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b8652358194014">bgp 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen7539133124116">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword6309810164213">*</span>CGN1-bgp]<strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1610617514218"> peer 3.3.3.3 as-number 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen167481424213">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword19751226114219">*</span>CGN1-bgp] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b540982012426">peer 3.3.3.3 connect-interface LoopBack0</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1434203434213">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword14694216426">*</span>CGN1-bgp] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b174751245194215">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen15978114814211">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword5674458124219"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-bgp] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b131531139435">quit</strong></pre>
</p><p><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p958815724316"># Create <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b19193958162616">loopBack0</strong> on CGN2 and establish a BGP route between CGN1 and CGN2.</p>
</p><p><pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen965793734413">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword2633657114416"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b963316572448">interface LoopBack0</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen153214664516">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword17328984513">*</span>CGN2-LoopBack0]<strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b773212994520"> ip address 2.2.2.2 255.255.255.255</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1556172610453">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword12747122964512">*</span>CGN2-LoopBack0]<strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b197471529194518"> </strong><strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b3747152918454">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1931313311458">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword18548133811453"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2-LoopBack0]<strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b14548103814518"> </strong><strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1854812385451">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen14443122172516">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword273119712514"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1842111710254">bgp 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen188011240164510">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword31211548144513">*</span>CGN2-bgp]<strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b91211481450"> peer 3.3.3.3 as-number 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1541457154519">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword552912314466">*</span>CGN2-bgp] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b65296314617">peer 3.3.3.3 connect-interface LoopBack0</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1272199114611">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword95411494610">*</span>CGN2-bgp] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b454814154616">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen121536189465">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword0631620174612"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2-bgp] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b963192044612">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_step632581272214110"><span id="EN-US_TASK_0000001092838008__en-us_task_0172374615_cmd1749385854214110">Create a ServiceIf interface and bind it to the HA service status monitoring group on each CGN device.</span><p><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1550732288214110"># On CGN1, create a ServiceIf interface named <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b116152306214415">serviceIf 1</strong> and bind it to the service status monitoring group named <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1285969238214415">group1</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen355862647214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1007497008214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b2132833223214110">interface serviceif 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1356523419214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword214030101214110">*</span>CGN1-ServiceIf1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b175231387214110">ip address unnumbered interface LoopBack0</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen127215160214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1642135640214110">*</span>CGN1-ServiceIf1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1968518177214110">track monitor-location-group group1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1980404751214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1234283179214110">*</span>CGN1-ServiceIf1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b661372858214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1888162908214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1228980608214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-ServiceIf1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1819270062214110">quit</strong></pre>
<p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p2127213365214110"># On CGN2, create a ServiceIf interface named <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b484983760214415">serviceIf 1</strong> and bind it to the service status monitoring group named <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b502851910214415">group1</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen2020098705214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1044910740214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1173898451214110">interface serviceif 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1608957064214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword893101445214110">*</span>CGN2-ServiceIf1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b48545934719">ip address unnumbered interface LoopBack0</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1224652345214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1515354085214110">*</span>CGN2-ServiceIf1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1276918537214110">track monitor-location-group group1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen2138867480214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword967544161214110">*</span>CGN2-ServiceIf1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1865681243214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen181275659214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword491891538214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2-ServiceIf1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1964647334214110">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_step1980308346214110"><span id="EN-US_TASK_0000001092838008__en-us_task_0172374615_cmd1340810016214110">Configure a static route with the outbound interface set to the ServiceIf interface on each CGN device. Use a routing protocol to advertise the static route on each CGN device to the downstream BRAS to form the primary and backup routes.</span><p><div class="note" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_note1551948098214110"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p7597456143316">Configure a default route with the outbound interface set to serviceIf 1 on the master CGN device, use BGP to advertise the route to downstream devices, and set route cost 1. Configure the same route on the backup CGN device and set route cost 2 that is greater than route cost 1. Traffic is preferentially sent over the route advertised by the master device based on cost values.</p>
</div></div>
</p><p><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1902769731214110"># On CGN1, configure a static route with the outbound interface set to <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1424655171214415">serviceIf 1</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1635324732214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword307296562214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b436412318477">ip route-static 0.0.0.0 0.0.0.0 serviceif 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1505219420214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword379974829214110">*</span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1195585365214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen963017747214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword822476075214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1516494774214110">quit</strong></pre>
<p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p649894630214110"># On CGN2, configure a static route with the outbound interface set to <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1812909746214415">serviceIf 1</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen335697676214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1687581261214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b51513315472">ip route-static 0.0.0.0 0.0.0.0 serviceif 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen2124271289214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1655908899214110">*</span>CGN2] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b2020880180214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen2103596944214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword340341673214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1888421447214110">quit</strong></pre>
</p><p><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p15936113716471"># Import the route to BGP on CGN1.</p>
</p><p><pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen15392157204719">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword12489181224813"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b57422195484">bgp 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen10241623174815">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword76634272489">*</span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1282973319485">ipv4-family unicast</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen20961135310489">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword19448121624914">*</span>CGN1-bgp-af-ipv4] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b291301104912">import-route static med 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen69041321174919">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword8831638174917">*</span>CGN1-bgp-af-ipv4] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b04604276497">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen19545144114915">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword14609675016"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-bgp-af-ipv4] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b87841255013">quit</strong></pre>
<div class="p" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p162928273507"># Import the route to BGP on CGN2.<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen69691252115014">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword33601023121516"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1236012312156">bgp 100</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen84148307157">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1646719359153">*</span>CGN2] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b9467735171517">ipv4-family unicast</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen177181039141514">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword225635691510">*</span>CGN2-bgp-af-ipv4] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1933914511158">import-route static med 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen13118615161614">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword5492112111611">*</span>CGN2-bgp-af-ipv4] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b16406162811167">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen87112367165">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword8246247131620"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2-bgp-af-ipv4] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b6896820151719">quit</strong></pre>
</div>
</p></li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_step1704288111214110"><span id="EN-US_TASK_0000001092838008__en-us_task_0172374615_cmd833397891214110">Create a NAT instance on each CGN device and bind it to the service-instance group.</span><p><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1399889634214110"># On CGN1, create a NAT instance named <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1013954396214415">nat</strong> and bind it to a service instance group named <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b173195222214415">group 1</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen216695124214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword670807617214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b450473783214110">nat instance nat id 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen69373692214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword2158794214110">*</span>CGN1-nat-instance-nat] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b2121320292214110">service-instance-group group1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen328340695214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1670076479214110">*</span>CGN1-nat-instance-nat] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b166616869214110">nat address-group address-group1 group-id 1 11.11.11.100 11.11.11.105</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen892493523214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword2034788146214110">*</span>CGN1-nat-instance-nat] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b139101150214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1286709471214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1714128980214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-nat-instance-nat] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1334235122214110">quit</strong></pre>
<p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1741195986214110"># On CGN2, create a NAT instance named<strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b882486165214415"> nat</strong> and bind it to a service instance group named <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b80496824214415">group 1</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1550911518214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1467762892214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b713602360214110">nat instance nat id 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen103387268214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1191605928214110">*</span>CGN2-nat-instance-nat] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b230650496214110">service-instance-group group1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen167426872214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword898956008214110">*</span>CGN2-nat-instance-nat] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1997869444214110">nat address-group address-group1 group-id 1 11.11.11.106 11.11.11.110</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1422873987214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword121178804214110">*</span>CGN2-nat-instance-nat] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1821053819214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen946880954214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword695894524214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2-nat-instance-nat] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1004810854214110">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_step1600334322214110"><span id="EN-US_TASK_0000001092838008__en-us_task_0172374615_cmd1733754826214110">Configure a NAT traffic diversion policy and a NAT conversion policy on the master and backup devices. For details, see <a href="dc_ne_nat_cfg_0057_1.html">Example for Configuring Centralized NAT</a> in IPv6 Transition Technology &gt; NAT Configuration.</span><p><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p857239334214110"># Configure a NAT traffic diversion policy and a NAT traffic conversion policy on CGN1.</p>
<ol type="a" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_ol1940640011214110"><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_li1350917121214110"><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1666936563214110"><a name="EN-US_TASK_0000001092838008__en-us_task_0172374615_li1350917121214110"></a><a name="en-us_task_0172374615_li1350917121214110"></a>Configure a NAT traffic diversion policy.</p>
<ol class="substepthirdol" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_ol1013594431214110"><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_li1133809376214110"><div class="p" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1311782601214110"><a name="EN-US_TASK_0000001092838008__en-us_task_0172374615_li1133809376214110"></a><a name="en-us_task_0172374615_li1133809376214110"></a>Configure an ACL numbered <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b870721720299">3001</strong> and an ACL rule numbered <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1473681912292">1</strong> to allow hosts only within the network segment 192.168.10.0/24 to access the Internet.<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1847328942214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword7592297214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b2049356522214110">acl 3001</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen44349850214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword372548043214110">*</span>CGN1-acl4-advance-3001] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1188170892214110">rule 1 permit ip source 192.168.10.0 0.0.0.255</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen149836071214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword780400744214110">*</span>CGN1-acl4-advance-3001] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1569899267214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen405354664214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1967258951214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-acl4-advance-3001] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b256378322214110">quit</strong></pre>
</div>
</li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_li1285552378214110"><div class="p" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p445844579214110"><a name="EN-US_TASK_0000001092838008__en-us_task_0172374615_li1285552378214110"></a><a name="en-us_task_0172374615_li1285552378214110"></a>Configure a traffic classifier.<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1669198548214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword2095309904214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b529633886214110">traffic classifier classifier1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1911496371214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1471088791214110">*</span>CGN1-classifier-classifier1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1568403004214110">if-match acl 3001</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen135844482214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1489782764214110">*</span>CGN1-classifier-classifier1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1267815573214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen528025245214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1741724021214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-classifier-classifier1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b597347554214110">quit</strong></pre>
</div>
</li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_li5551265214110"><div class="p" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p958314034214110"><a name="EN-US_TASK_0000001092838008__en-us_task_0172374615_li5551265214110"></a><a name="en-us_task_0172374615_li5551265214110"></a>Configure a traffic behavior named <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b927312439214415">behavior1</strong>, which binds traffic to the NAT instance named <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b528403589214415">nat</strong>.<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen813713790214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword253817246214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b282243581214110">traffic behavior behavior1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen778133357214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1417761713214110">*</span>CGN1-behavior-behavior1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1808366904214110">nat bind instance nat</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1510680542214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword183823639214110">*</span>CGN1-behavior-behavior1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1895128273214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen596997270214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword909048330214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-behavior-behavior1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1381774888214110">quit</strong></pre>
</div>
</li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_li962600851214110"><div class="p" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1438189906214110"><a name="EN-US_TASK_0000001092838008__en-us_task_0172374615_li962600851214110"></a><a name="en-us_task_0172374615_li962600851214110"></a>Configure a NAT traffic policy named <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b123704277141647">policy1</strong> to associate the ACL rule with the traffic behavior.<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen354481201214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword253130618214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1295002955214110">traffic policy policy1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen729208667214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword326431818214110">*</span>CGN1-policy-policy1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b685632689214110">classifier classifier1 behavior behavior1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen836898832214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword560233981214110">*</span>CGN1-policy-policy1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1510498383214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen630606815214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1359586560214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-policy-policy1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1914645264214110">quit</strong></pre>
</div>
</li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_li1275421575214110"><div class="p" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p1976130318214110"><a name="EN-US_TASK_0000001092838008__en-us_task_0172374615_li1275421575214110"></a><a name="en-us_task_0172374615_li1275421575214110"></a>Apply the NAT traffic diversion policy in the view of GE <span>0/2/0</span>.<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen104427387214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1089956254214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1769464448214110">interface gigabitEthernet <span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen738082866214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1417358445214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1679471671214110">ip address 192.168.10.1 255.255.255.0</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1830616843214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1000396277214110">*</span>CGN1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b905760318214110">traffic-policy policy1 inbound</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1755720106214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword733849661214110">*</span>CGN1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1781613717214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1416705564214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword727302984214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1202415449214110">quit</strong></pre>
</div>
</li></ol>
</li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_li667101854214110"><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p2116222838214110"><a name="EN-US_TASK_0000001092838008__en-us_task_0172374615_li667101854214110"></a><a name="en-us_task_0172374615_li667101854214110"></a>Configure a NAT conversion policy.</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen705607325214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1778366103214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1497659726214110">nat instance nat</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1608766765214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1946343698214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-nat-instance-nat] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b2814787214110">nat outbound 3001 address-group address-group1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1838405213214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword921026552214110">*</span>CGN1-nat-instance-nat] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b1011909083214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1245110213214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword885808216214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1-nat-instance-nat] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b969984093214110">quit</strong></pre>
</li></ol>
<div class="note" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_note247652268214110"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p468360390214110">The configuration of CGN2 is similar to that of CGN1. For configuration details, see <a href="#EN-US_TASK_0000001092838008__en-us_task_0172374615_config_02">CGN2 configuration file</a> in this section.</p>
</div></div>
<p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p200974763214110"># Run the <a href="cmdqueryname=display+nat+instance+nat"><b><span class="cmdname" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_cmdname1712869562214110">display nat instance nat</span></b></a> command on each CGN device to verify NAT configurations.</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen586425047214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1275889412214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN1] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b364567451214110">display nat instance nat</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen286758087214110">nat instance nat id 1      
 service-instance-group group1     
 nat address-group address-group1 group-id 1 11.11.11.100 11.11.11.105   
 nat outbound 3001 address-group address-group1</pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1545471759214110">[<span class="keyword" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_keyword1753610399214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGN2] <strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b320652000214110">display nat instance nat</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen1811794462214110">nat instance nat id 1         
 service-instance-group group1    
 nat address-group address-group1 group-id 1 11.11.11.106 11.11.11.110   
 nat outbound 3001 address-group address-group1</pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_section_05"><a name="EN-US_TASK_0000001092838008__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul id="EN-US_TASK_0000001092838008__en-us_task_0172374615_ul324867924214110"><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_li347081100214110"><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_p826462448214110"><a name="EN-US_TASK_0000001092838008__en-us_task_0172374615_li347081100214110"></a><a name="en-us_task_0172374615_li347081100214110"></a>CGN1 configuration file</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen844619378214110">#
sysname CGN1
#
vsm on-board-mode disable
#
license
 active nat session-table size 6 slot <span>1</span>
<strong id="EN-US_TASK_0000001092838008__en-us_task_0172374615_b347796131920"> </strong>active nat bandwidth-enhance 40 slot <span>1</span>
#
acl number 3001
 rule 1 permit ip source 192.168.10.0 0.0.0.255
#
traffic classifier classifier1 operator or
 if-match acl 3001 precedence 1
#
traffic behavior behavior1
 nat bind instance nat
#
traffic policy policy1
 classifier classifier1 behavior behavior1 precedence 1
#
service-location 1
 location slot <span>1</span> 
#
service-instance-group group1
 service-location 1
#
monitor-location-group group1
 service-location 1
#
bgp 100
 private-4-byte-as enable
 peer 3.3.3.3 as-number 100
 peer 3.3.3.3 connect-interface LoopBack0
 #
 ipv4-family unicast
  undo synchronization
  peer 3.3.3.3 enable 
  import-route static med 10
 #
 ipv4-family vpnv4
  policy vpn-target
  peer 3.3.3.3 enable 
 #
 ipv4-family vpn-instance vpn1
  default-route imported
  import-route direct
  import-route static med 10
#
nat instance nat id 1
 service-instance-group group1     
 nat address-group address-group1 group-id 1 11.11.11.100 11.11.11.105   
 nat outbound 3001 address-group address-group1
#
interface LoopBack0
 ip address 1.1.1.1 255.255.255.255
#
interface GigabitEthernet <span>0/2/0</span>
 undo shutdown
 ip address 192.168.10.1 255.255.255.0
 traffic-policy policy1 inbound
#
interface serviceif 1
 ip address unnumbered interface LoopBack0
 track monitor-location-group group1
#
ip route-static 0.0.0.0 0.0.0.0 serviceif 1
#
return</pre>
</li><li id="EN-US_TASK_0000001092838008__en-us_task_0172374615_li68453102214110"><p id="EN-US_TASK_0000001092838008__en-us_task_0172374615_config_02"><a name="EN-US_TASK_0000001092838008__en-us_task_0172374615_config_02"></a><a name="en-us_task_0172374615_config_02"></a><a name="EN-US_TASK_0000001092838008__en-us_task_0172374615_li68453102214110"></a><a name="en-us_task_0172374615_li68453102214110"></a>CGN2 configuration file</p>
<pre class="screen" id="EN-US_TASK_0000001092838008__en-us_task_0172374615_screen412229830214110">#
sysname CGN2
#
vsm on-board-mode disable
#
license
 active nat session-table size 6 slot <span>1</span>
 active nat bandwidth-enhance 40 slot <span>1</span>
#
acl number 3001
 rule 1 permit ip source 192.168.10.0 0.0.0.255
#
traffic classifier classifier1 operator or
 if-match acl 3001 precedence 1
#
traffic behavior behavior1
 nat bind instance nat
#
traffic policy policy1
 classifier classifier1 behavior behavior1 precedence 1
#
service-location 1
 location slot <span>1</span>
#
service-instance-group group1
 service-location 1
#
monitor-location-group group1
 service-location 1
#
bgp 100
 private-4-byte-as enable
 peer 3.3.3.3 as-number 100
 peer 3.3.3.3 connect-interface LoopBack0
 #
 ipv4-family unicast
  undo synchronization
  peer 3.3.3.3 enable 
  import-route static med 20
#
nat instance nat id 1
 service-instance-group group1      
 nat address-group address-group1 group-id 1 11.11.11.106 11.11.11.110  
 nat outbound 3001 address-group address-group1
#
interface LoopBack0
 ip address 2.2.2.2 255.255.255.255
#
interface GigabitEthernet <span>0/2/0</span>
 undo shutdown
 ip address 192.168.10.1 255.255.255.0
 traffic-policy policy1 inbound
#
interface serviceif 1
 ip address unnumbered interface LoopBack0
 track monitor-location-group group1
#
ip route-static 0.0.0.0 0.0.0.0 serviceif 1
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0056.html">Configuration Examples for NAT
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0096.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0161.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>