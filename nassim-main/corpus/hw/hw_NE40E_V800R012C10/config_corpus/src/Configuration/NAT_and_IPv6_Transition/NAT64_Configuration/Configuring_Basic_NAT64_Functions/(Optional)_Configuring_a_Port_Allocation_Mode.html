
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring a Port Allocation Mode">
<meta name="abstract" content="Configuring a port allocation mode helps manage port resources.">
<meta name="description" content="Configuring a port allocation mode helps manage port resources.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat64_cfg_0005.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat64_cfg_0006.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat64_cfg_0010.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="c00549182">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="NAT64">
<meta name="featuretype" content="NAT and IPv6 Transition">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NAT64">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="NAT64">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="NAT64">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="c00549182">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001439909113">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring a Port Allocation Mode</title>
</head>
<body><a name="EN-US_TASK_0000001439909113"></a><a name="EN-US_TASK_0000001439909113"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring a Port Allocation Mode</h1>
<div class="taskbody"><p>Configuring a port allocation mode helps manage port resources.</p>
<div class="context"><a name="EN-US_TASK_0000001439909113__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_context461534007214111"><div class="p" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_p291122685214111">NAT64 supports three port allocation modes:<ul id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_ul135720367214111"><li id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_li1892274051214111">Port pre-allocation: A NAT64 device pre-allocates an IPv4 address and a port range to an IPv6 address when mapping the IPv6 address to the IPv4 address. The IPv4 address and ports in the port range are used in the NAT64 mapping of the IPv6 address.</li><li id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_li2119900802214111">Semi-dynamic port pre-allocation: When a host with an IPv6 address accesses an IPv4 network, a NAT64 device allocates an initial port range and then allocates the ports within the port range to the IPv6 address. If the number of ports used by the terminal exceeds the initial port range, the device allocates an extended port range. The maximum number of times the port range is extended determines the number of times the extended port range can be allocated.</li><li id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_li1109646330214111">Dynamic port allocation: When mapping a private IP address to a public IP address, a NAT64 device pre-allocates a public IP address and a port range with a fixed size of 64 to the private IP address. If the number of used ports exceeds the initial port range, the NAT64 device assigns another port range with a fixed size of 64 to the user. The allocation process repeats without a limit on the maximum number of extended port ranges.</li></ul>
</div>
<p id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_p1507933306214111">Configure a port allocation mode based on the service scale during network deployment.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001439909113__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_steps1135485481214111"><li id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_step1373142313214111"><span id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmd1543583929214111">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmdname1790997416214111">system-view</span></b></a></span><p><p id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_p752511571634">The system view is displayed.</p>
</p></li><li id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_step264047681214111"><span id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmd1148159865214111">Run <a href="cmdqueryname=nat64+instance"><b><span class="cmdname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmdname165047762214111">nat64 instance</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_varname823729977214111">instance-name</span></i> <strong><span id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmdparmname1444810483214111">id</span></strong> <i><span class="varname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_varname1112346229214111">id</span></i></span><p><p id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_p159017161641">The NAT64 instance view is displayed.</p>
</p></li><li id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_step1450413314214111"><span id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmd1009691301214111">Run <a href="cmdqueryname=port-range"><b><span class="cmdname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmdname2030093852">port-range</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_varname19300123957">initial-port-range</span></i> [ <strong><span id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmdparmname23001033513">extended-port-range</span></strong> <i><span class="varname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_varname103001035516">extended-port-range</span></i> <strong><span id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmdparmname2300337520">extended-times</span></strong> <i><span class="varname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_varname13300113150">extended-times</span></i> ]</span><p><p id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_p555918515518">The port pre-allocation mode is configured.</p>
</p><p><div class="p" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_p933227718214111"> If this configuration is performed, the port pre-allocation mode is enabled.<ul id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_ul2094482739214111"><li id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_li1701022989214111">Pre-allocation mode: The <strong><span id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmdparmname18724107710">extended-port-range</span></strong> <i><span class="varname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_varname158729101971">extended-port-range</span></i> <strong><span id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmdparmname387214101676">extended-times</span></strong> <i><span class="varname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_varname17872910570">extended-times</span></i> parameter is not required when running this command.</li><li id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_li515966053214111">To configure the semi-dynamic port pre-allocation mode, run the command with <strong><span id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmdparmname201214201277">extended-port-range</span></strong> <i><span class="varname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_varname11212017716">extended-port-range</span></i> <strong><span id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmdparmname151218201275">extended-times</span></strong> <i><span class="varname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_varname1512620377">extended-times</span></i> configured.</li></ul>
</div>
<div class="note" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_note61161913214111"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_p111500945214111">If the port pre-allocation mode or incremental port allocation mode has been configured, you can change the <i><span class="varname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_varname1621213019719">port-range</span></i> parameter values in overriding mode. The change takes effect only for new users.</p>
</div></div>
</p></li><li id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_step1584563494016"><span id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmd14845934164015">(Optional) Run <a href="cmdqueryname=port-reuse+enable"><b><span class="cmdname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmdname18859135714405">port-reuse enable</span></b></a></span><p><p id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_p15938612583">The port reuse for TCP and other protocols is enabled.</p>
</p><p><div class="note" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_note15385155574113"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_ul1107132384610"><li id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_li736942619464">By default, sessions of different protocols using the same private IP address cannot share the same public port during port pre-allocation. After port reuse is enabled, for the same private IP address, TCP sessions can share a public port with sessions of other protocols.</li><li id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_li61076239469">The <a href="cmdqueryname=port-reuse+enable"><b><span class="cmdname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmdname574835812219">port-reuse enable</span></b></a> and <span id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_ph246845474213"><a href="cmdqueryname=port-single"><b><span class="cmdname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmdname124681554174218">port-single</span></b></a> <strong><span id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmdparmname846815549428">enable</span></strong></span> commands are mutually exclusive.</li></ul>
</div></div>
</p></li><li id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_step354501287214111"><span id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmd983493831214111">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_cmdname391247778214111">commit</span></b></a></span><p><p id="EN-US_TASK_0000001439909113__en-us_task_0000001389159266_p1746114912811">The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat64_cfg_0005.html">Configuring Basic NAT64 Functions
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat64_cfg_0006.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat64_cfg_0010.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>