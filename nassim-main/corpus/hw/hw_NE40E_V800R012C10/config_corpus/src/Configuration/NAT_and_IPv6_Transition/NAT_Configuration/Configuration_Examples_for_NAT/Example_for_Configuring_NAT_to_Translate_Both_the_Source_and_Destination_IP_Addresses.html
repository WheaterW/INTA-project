
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring NAT to Translate Both the Source and Destination IP Addresses">
<meta name="abstract" content="This section provides an example for configuring NAT to translate both the source and destination IP addresses when Internet users access an internal server.">
<meta name="description" content="This section provides an example for configuring NAT to translate both the source and destination IP addresses when Internet users access an internal server.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0056.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0161.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_atn_nat_cfg_0075.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="c00549182">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="c00549182">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001139936999">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring NAT to Translate Both the Source and Destination IP Addresses</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001139936999"></a><a name="EN-US_TASK_0000001139936999"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring NAT to Translate Both the Source and Destination IP Addresses</h1>
<div class="taskbody"><p>This section provides an example for configuring NAT to translate both the source and destination IP addresses when Internet users access an internal server.</p>
<div class="context"><a name="EN-US_TASK_0000001139936999__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_context929134636214110"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001139936999__en-us_task_0172374642_p2141781903214110">In <a href="#EN-US_TASK_0000001139936999__en-us_task_0172374642_w1">Figure 1</a>, NAT-Device functions as a gateway of an enterprise, and the FTP server is an internal server. Internet users need to access the FTP server on the intranet, and external IP addresses can be translated so that the intranet does not need to import external routes. The peer device connected to NAT-Device is assigned an IP address of 1.1.1.2.</p>
<div class="p" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_p777832030214110"><a href="#EN-US_TASK_0000001139936999__en-us_task_0172374642_w1">Figure 1</a> shows IP addresses of interfaces. The configuration requirements are as follows:<ul id="EN-US_TASK_0000001139936999__en-us_task_0172374642_ul373199079214110"><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li834784364214110">PCs on the Internet can access the FTP server inside the enterprise network.</li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li694916896214110">NAT-Device does not import public network routes.</li></ul>
</div>
<div class="fignone" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_w1"><a name="EN-US_TASK_0000001139936999__en-us_task_0172374642_w1"></a><a name="en-us_task_0172374642_w1"></a><span class="figcap"><b>Figure 1 </b>Networking for configuring NAT to translate both the source and destination IP addresses</span><div class="note" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_note1825470721214110"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001139936999__en-us_task_0172374642_p1735026805214110">Interfaces 1 and 2 in this example represent GE <span>0/2/0</span> and GE <span>0/2/1</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_image1752410131381" src="images/fig_dc_ne_nat_cfg_00710001.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001139936999__1.4.2"></a><a name="1.4.2"></a>
<div class="p" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_context468351752214110"><h4 class="sectiontitle">Configuration Roadmap</h4><ol id="EN-US_TASK_0000001139936999__en-us_task_0172374642_ol1010537724214110"><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li107780917214110">Configure basic NAT functions.</li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li1108662343214110">Configure the mapping between the public and private IP addresses of the internal NAT server.</li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li1906998637214110">Enable the NAT ALG function for FTP.</li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li1150781108214110">Configure a NAT traffic diversion policy.</li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li1903309021214110">Apply the NAT traffic diversion policy.</li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li13663249117">Configure a NAT traffic conversion policy. (Required in dedicated board mode)</li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li1222077594214110">Configure a static route.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001139936999__1.4.3"></a><a name="1.4.3"></a>
<div class="p" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_context1522118149214110"><h4 class="sectiontitle">Data Preparation</h4><ul id="EN-US_TASK_0000001139936999__en-us_task_0172374642_ul846221499214110"><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li553308963214110">NAT instance names (<strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b118831133132110">nat1</strong> and <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1488910332210">nat2</strong>) and indexes (1 and 2)</li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li560524840214110">Name (address-group1), number (1), and IP address range (11.11.11.10â11.11.11.15) of an address pool in the NAT instance named <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b0948115162214">nat1</strong> Name (address-group2), number (2), and IP address range (11.11.11.16â11.11.11.20) of an address pool in the NAT instance named <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b713242234">nat2</strong></li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li701195176214110">ACL names: 3001 and 3002.</li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li1896406366214110">Private network-side interface (GE<span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_ph23121929182716">0/2/0</span> with IP address 192.168.1.1/24) and public network-side interface (GE<span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_ph2032312065214110">0/2/1</span> with IP address 11.11.11.1) to which a NAT traffic diversion policy is applied</li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li1449934381214110">External IP address 11.11.11.10 advertised by the internal server and internal IP address 192.168.1.2</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001139936999__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001139936999__en-us_task_0172374642_steps270571733214110"><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_step628962188214110"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd1052983182214110">Configure basic NAT functions.</span><ol type="a" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_substeps1076020974214110"><li class="substepexpand" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_substep152981111419"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd329871171410">Create a service-location group and a service-instance group and bind the NAT service board to the service-location group.</span><p><p id="EN-US_TASK_0000001139936999__en-us_task_0172374642_p13117133212170"># The configuration is as follows in dedicated board mode.</p>
</p><p><pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen729819111415">&lt;<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword105347331448">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b82986116143">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword14298101101414"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword187033352040">HUAWEI</span>] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1029813111416">sysname NAT-Device</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword9298161131410">*</span><span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1972393714412">HUAWEI</span>] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b029801181416">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1729881141415"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device]<strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b129841141413"> vsm on-board-mode disable</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword929801141414">*</span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b92981191419">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1029812112144"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b229810131412">license</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword929831121417"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-license]<strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b4298418149"> active nat session-table size 6<span> slot <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b189381923124311"><span><span>1</span></span></strong></span></strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword8421178202614">*</span>NAT-Device-license] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b11298161151420">active nat bandwidth-enhance 40 slot <span><span><span>1</span></span></span></strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1521015112614">*</span>NAT-Device-license] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b958442012263">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1129819101411"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-license] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b14299813142">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword029910161416"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b129915114144">service-location 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword102991010142">*</span>NAT-Device-service-location-1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b11299191181411">location</strong><strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1029917161414"><span> slot <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b026642714314"><span><span>1</span></span></strong></span></strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword42997115146">*</span>NAT-Device-service-location-1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1429915101418">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword14299018146"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-service-location-1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b32995114145">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword72991913148"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b529917151416">service-instance-group group1</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword829912121411">*</span>NAT-Device-service-instance-group-group1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b14299121161411">service-location 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1729918121410">*</span>NAT-Device-service-instance-group-group1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b20299111111417">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword152998101418"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-service-instance-group-group1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b162991115141">quit</strong></pre>
<p id="EN-US_TASK_0000001139936999__en-us_task_0172374642_p85562171815"># The configuration is as follows in on-board mode.</p>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen1264185621712">&lt;<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword147251341544">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b17641329171811">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword126462971814"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword12221743647">HUAWEI</span>] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b764192941819">sysname NAT-Device</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword464129101811">*</span><span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword469120448413">HUAWEI</span>] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1264229111818">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword46412910185"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b36402911818">service-location 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1664142915188">*</span>NAT-Device-service-location-1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b66418294188">location<span> follow-forwarding-mode</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1564132917185">*</span>NAT-Device-service-location-1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b126472912188">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword764102961811"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-service-location-1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1565192913189">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword17651429151811"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b196511292185">service-instance-group group1</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword665029131817">*</span>NAT-Device-service-instance-group-group1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1865229201813">service-location 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword56502919180">*</span>NAT-Device-service-instance-group-group1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1365129181811">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword15651029111811"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-service-instance-group-group1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b106510299185">quit</strong></pre>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_substep255472821214110"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd1728799566214110">Create NAT instances named <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b478672654214416">nat1</strong> and <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b2043591954214416">nat2</strong> and bind the service-instance group to the NAT instances so that service traffic can be processed by the NAT service board.</span><p><pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen32431025214110">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword635044690214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1921273479214110">nat instance nat1 id 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1297884084214110">*</span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1450795669214110">service-instance-group group1</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword2106292474214110">*</span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b456463735214110">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword592749286214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b8334504214110">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword771196845214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b460180436214110">nat instance nat2 id 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1460268289214110">*</span>NAT-Device-nat-instance-nat2] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1783841341214110">service-instance-group group1</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword816371676214110">*</span>NAT-Device-nat-instance-nat2] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1210685896214110">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1971947053214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-nat-instance-nat2] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1475439406214110">quit</strong></pre>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_substep2123427081214110"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd1555704521214110">Configure a NAT address pool.</span><p><pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen1697707117214110">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword182732700214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b385320315214110">nat instance nat1 id 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword660426459214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1391748646214110">nat address-group address-group1 group-id 1 11.11.11.10 11.11.11.15</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword197959168214110">*</span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b217715015214110">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword754766930214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1150638886214110">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1847159616214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b506849754214110">nat instance nat2 id 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1154203350214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1560002465214110">nat address-group address-group2 group-id 2 11.11.11.16 11.11.11.20</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword801346578214110">*</span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b872340590214110">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1472485698214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1690856185214110">quit</strong></pre>
</p></li></ol>
</li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_step999479702214110"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd638264680214110">Configure the mapping between the public and private IP addresses of the NAT internal server.</span><p><pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen1469046627214110">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword2136228602214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b591091003214110">nat instance nat1</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1650127190214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1562290550214110">nat server-mode enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword15705182164210">*</span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b770170160214110">nat server global 11.11.11.10 inside 192.168.1.2</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1915126543214110">*</span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1031840884214110">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1307447971214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b467315121214110">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_step1925160391214110"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd34582188214110">Enable NAT ALG to translate the application-layer IP addresses and port numbers of traffic in the NAT instance named <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1426822914214416">nat1</strong>.</span><p><pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen189840829214110">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1601861847214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b569742395214110">nat instance nat1</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword2023240740214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1762531943214110">nat alg ftp</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1437853987214110">*</span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b263738712214110">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword979387998214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b2127906592214110">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_step304035103214110"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd1054379908214110">Configure a NAT traffic diversion policy.</span><p><ul id="EN-US_TASK_0000001139936999__en-us_task_0172374642_ul1936244963214110"><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li1581335574214110">Configure an ACL numbered <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1094213019367">3001</strong> and an ACL rule numbered <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b5168133133617">1</strong> to allow hosts only within the network segment 192.168.1.0/24 to access the Internet.</li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li1912844877214110">Configure an ACL numbered <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b668774073715">3002</strong> and an ACL rule numbered <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b7471845153718">2</strong> to permit any packets.</li></ul>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen1277116478214110">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1540412850214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b249775797214110">acl 3001</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1221287294214110">*</span>NAT-Device-acl4-advance-3001] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b730386643214110">rule 1 permit ip source 192.168.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1526782941214110">*</span>NAT-Device-acl4-advance-3001] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b72710112214110">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1298362067214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-acl4-advance-3001] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1078400605214110">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1280638473214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b320967033214110">acl 3002</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword824523903214110">*</span>NAT-Device-acl4-advance-3002] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1013162497214110">rule 2 permit ip source any</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword2107990103214110">*</span>NAT-Device-acl4-advance-3002] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1237605962214110">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1433454029214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-acl4-advance-3002] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b815120537214110">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_step11597412122613"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd19597111272611">Configure a traffic classifier named <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b752516526214">nat1</strong>.</span><p><pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen11901847182710">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword779111229214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1675389172214110">traffic classifier nat1 </strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen12790112610291">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword6861133202919">*</span>NATA-classifier-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1886114329292">if-match acl 3001  </strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen7149741192920">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword12786114617296">*</span>NATA-classifier-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b117861446162918">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen14987145082913">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword129229559297"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA-classifier-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b129221655142919">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_step57651826133913"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd1576542633919">Configure a traffic classifier named <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b917215642119">nat2</strong>.</span><p><pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen12765182633919">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword276552619396"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b167650262396">traffic classifier nat2 </strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen476592616398">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword67651626103918">*</span>NATA-classifier-nat2] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1276542673915">if-match acl 3002 </strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen127651526183916">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword5765726193918">*</span>NATA-classifier-nat2] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b976572633915">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen37655262391">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword876572615391"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA-classifier-nat2] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b167651126193920">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_step1222901415303"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd7229161473011">Configure a traffic behavior named <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b12661104362115">behavior1</strong>, which binds traffic to the NAT instance named <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1066118438219">nat1</strong>.</span><p><pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen1968461119332">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword822626580214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b19422182344016">traffic behavior nat1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen18124133020338">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1307086798214110">*</span>NATA-behavior-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b687309720214110">nat bind instance nat1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen2188194119334">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1611190389214110">*</span>NATA-behavior-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b100046121214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen2555151393511">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1277923216214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA-behavior-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b535671913214110">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_step0461628193516"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd246242810358">Configure a traffic behavior named <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b10317120172312">behavior2</strong>, which binds traffic to the NAT instance named <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b931760152310">nat2</strong>.</span><p><pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen12462328113517">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword9462428113512"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b19462112813351">traffic behavior nat2</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen6462162815353">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword246242823512">*</span>NATA-behavior-nat2] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b164621628123513">nat bind instance nat2</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen1746292873512">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword9462192833517">*</span>NATA-behavior-nat2] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1046218281358">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen746232883520">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword144621028133510"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA-behavior-nat2] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b24629282358">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_step4227216357"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd3221421203518">Configure a NAT traffic policy named <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1234112912414">policy1</strong> to associate the ACL rule with the traffic behavior.</span><p><pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen24644011406">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1187678247214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1366085360214110">traffic policy nat1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen839445454110">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword65221255194112">*</span>NATA-trafficpolicy-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1133315134320">classifier nat1 behavior nat1 </strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen158921411124111">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword517045433214110">*</span>NATA-trafficpolicy-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1345067053214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen209641424174112">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword653554767214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA-trafficpolicy-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1034233227214110">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_step4155456134011"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd141553563404">Configure a NAT traffic policy named <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b340111417175">policy2</strong> to associate the ACL rule with the traffic behavior.</span><p><pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen14155256164011">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1715513561404"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b9392132818437">traffic policy nat2</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen18155155664018">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword0155256154014">*</span>NATA-trafficpolicy-nat2] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b104674594418">classifier nat2 behavior nat2 </strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen2155205694011">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword17155756144014">*</span>NATA-trafficpolicy-nat2] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b201552565400">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen81551356154012">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword11551956114012"><font style="font-size:8pt" Face="Courier New" >~</font></span>NATA-trafficpolicy-nat2] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b815517563406">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_step1779325119214110"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd1407490558214110">Apply the NAT traffic diversion policy.</span><p><ul id="EN-US_TASK_0000001139936999__en-us_task_0172374642_ul231303854214110"><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li739056187214110">Configure an IP address for GE <span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_ph1456759470214110">0/2/0</span> on the private network side and apply the traffic classification policy with ACL 3001.</li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_li86675729214110">Configure an IP address for GE <span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_ph325348611214110">0/2/1</span> on the public network side and apply the traffic classification policy with ACL 3002.</li></ul>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen1481797734214110">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword871697554214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b392921250214110">interface gigabitEthernet <span>0/2/0</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword317884699214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b285177169214110">ip address 192.168.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1427888595214110">*</span>NAT-Device-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b192751427536">traffic-policy nat1 inbound</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword2037568590214110">*</span>NAT-Device-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1302613226214110">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword702746056214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b629392411214110">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1075382018214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b121664798214110">interface gigabitEthernet <span>0/2/1</span> </strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1402607059214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-GigabitEthernet<span>0/2/1</span>] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1389660758214110">ip address </strong><strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b83404137512">11.11.11.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1697336926214110">*</span>NAT-Device-GigabitEthernet<span>0/2/1</span>] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b124551955931">traffic-policy nat2 inbound</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword580562836214110">*</span>NAT-Device-GigabitEthernet<span>0/2/1</span>] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b689883101214110">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1735196099214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-GigabitEthernet<span>0/2/1</span>] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1544909549214110">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_step97541048151216"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd1875412486124">Configure a NAT traffic conversion policy. (This step is required only in dedicated board mode.)</span><p><pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen975404881214">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword15755114871219"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b37557484124">nat instance nat1 id 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword07554480123"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b5755194818129">nat outbound 3001 address-group address-group1</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword177551748191219">*</span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b9755174841218">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword17755174851211"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-nat-instance-nat1] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1675519487123">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword157559484120"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b975519483121">nat instance nat2 id 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword9755848181210"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-nat-instance-nat2] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1975516485128">nat outbound 3002 address-group address-group2</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword375544821211">*</span>NAT-Device-nat-instance-nat2] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1875594818122">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword5755114815122"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device-nat-instance-nat2] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b11755174810121">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_step1895358978214110"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd1673407295214110">Configure a default route as a static route and set the next hop address of the default route to 11.11.11.2.</span><p><pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen1317293138214110">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword1521901587214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1128619667214110">ip route-static 0.0.0.0 0.0.0.0 11.11.11.2</strong>
[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword255950222214110">*</span>NAT-Device] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b164566756214110">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001139936999__en-us_task_0172374642_step750790540214110"><span id="EN-US_TASK_0000001139936999__en-us_task_0172374642_cmd2070179655214110">Verify the configuration<span>.</span></span><p><p id="EN-US_TASK_0000001139936999__en-us_task_0172374642_p1591774085214110"># Check NAT server information.</p>
<pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen782784191214110">[<span class="keyword" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_keyword166597012214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>R06] <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b1008760094214110">display nat server-map</strong>
This operation will take a few minutes. Press 'Ctrl+C' to break ...              
<span></span><span>Slot: <span>3</span></span>
Total number:  2.
  NAT Instance: nat1         
  Protocol:ANY, VPN:---&gt;-    
  <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b13601751154718">Server reverse:ANY-&gt;11.11.11.10[192.168.1.2]</strong>                                                
  Tag:0x0, TTL:-, Left-Time:-        
  CPE IP:192.168.1.2
  outbound: false
  <span>extendable:false</span>

  NAT Instance: nat1      
  Protocol:ANY, VPN:---&gt;-      
  <strong id="EN-US_TASK_0000001139936999__en-us_task_0172374642_b188552058154817">Server:192.168.1.2[11.11.11.10]-&gt;ANY</strong>                                  
  Tag:0x0, TTL:-, Left-Time:-   
  CPE IP:192.168.1.2
<span>  outbound: false
  extendable:false</span>

</pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_example405529424214110"><a name="EN-US_TASK_0000001139936999__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><pre class="screen" id="EN-US_TASK_0000001139936999__en-us_task_0172374642_screen174131375214110"># 
sysname NAT-Device 
#
vsm on-board-mode disable //Dedicated board configuration
#
license //Dedicated board configuration
 active nat session-table size 6 slot <span>1</span> //Dedicated board configuration
 active nat bandwidth-enhance 40 slot <span><span>1</span></span>//Dedicated board configuration
# 
<span>service-location 1</span>
<span> location<span> slot <span>1</span></span></span> //Dedicated board configuration
<span> <span>location</span> follow-forwarding-mode</span> //On-board configuration
<span>#</span>
<span>service-instance-group group1</span>
<span> service-location 1 </span>
<span>#</span>
nat instance nat1 id 1
<span> service-instance-group group1</span>
 nat server-mode enable
 nat address-group address-group1 group-id 1 11.11.11.10 11.11.11.15
 nat server global 11.11.11.10 inside 192.168.1.2
<span> nat outbound 3001 address-group address-group1 </span>//Dedicated board configuration
 nat alg ftp
#
nat instance nat2 id 2
<span> service-instance-group group1</span>
 nat address-group address-group2 group-id 2 11.11.11.16 11.11.11.20
<span> nat outbound 3002 address-group address-group2 //Dedicated board configuration</span>
 nat alg ftp
#
acl number 3001 
 rule 1 permit ip source 192.168.1.0 0.0.0.255
#
acl number 3002 
 rule 2 permit ip 
#
traffic classifier nat1 operator or
 if-match acl 3001 precedence 1
#
traffic classifier nat2 operator or
 if-match acl 3002 precedence 1
#
traffic behavior nat1
 nat bind instance nat1
#
traffic behavior nat2
 nat bind instance nat2
#
traffic policy nat1
 share-mode
 classifier nat1 behavior nat1 precedence 1
#
traffic policy nat2
 share-mode
 classifier nat2 behavior nat2 precedence 1
#
interface GigabitEthernet <span>0/2/0</span> 
 undo shutdown 
 ip address 192.168.1.1 255.255.255.0 
 traffic-policy nat1 inbound
#
interface GigabitEthernet <span>0/2/1</span>  
 undo shutdown 
 ip address 11.11.11.1 255.255.255.0 
 traffic-policy nat2 inbound
#
ip route-static 0.0.0.0 0.0.0.0 11.11.11.2
#
return</pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0056.html">Configuration Examples for NAT
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0161.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_atn_nat_cfg_0075.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>