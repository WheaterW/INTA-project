
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a NAT Traffic Diversion Policy on an Inbound Interface">
<meta name="abstract" content="You can configure a NAT traffic policy on an inbound interface to perform NAT translation on user traffic.">
<meta name="description" content="You can configure a NAT traffic policy on an inbound interface to perform NAT translation on user traffic.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0018.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0027.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="c00549182">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="c00549182">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172374516">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a NAT Traffic Diversion Policy on an Inbound Interface</title>
</head>
<body><a name="EN-US_TASK_0172374516"></a><a name="EN-US_TASK_0172374516"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a NAT Traffic Diversion Policy on an Inbound Interface</h1>
<div class="taskbody"><p>You can configure a NAT traffic policy on an inbound interface to perform NAT translation on user traffic.</p>
<div class="context"><a name="EN-US_TASK_0172374516__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Before performing NAT translation on an inbound interface, configure a NAT traffic policy to match desired user traffic on the inbound interface.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172374516__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Configure a traffic classification rule.</span><ol type="a"><li class="substepexpand" id="EN-US_TASK_0172374516__substep1418692515214109"><span id="EN-US_TASK_0172374516__cmd454166964214109">Run either of the following commands to create an ACL and enter the ACL view:</span><p><ul id="EN-US_TASK_0172374516__ul2048425473214109"><li id="EN-US_TASK_0172374516__li1921008092214109"><p id="EN-US_TASK_0172374516__p1113853246214109"><a name="EN-US_TASK_0172374516__li1921008092214109"></a><a name="li1921008092214109"></a>For a basic ACL (numbered from 2000 to 2999), run the <span><a href="cmdqueryname=acl+name+basic+basic+number+number+match-order+config+auto"><b><span class="cmdname" id="EN-US_TASK_0172374516__cmdname547462670213919">acl</span></b></a> { <strong><span id="EN-US_TASK_0172374516__cmdparmname333081481213919">name</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname1649705180213919">basic-acl-name</span></i> { <strong><span id="EN-US_TASK_0172374516__cmdparmname130385082213919">basic</span></strong> | [ <strong><span id="EN-US_TASK_0172374516__cmdparmname1919927319213919">basic</span></strong> ] <strong><span id="EN-US_TASK_0172374516__cmdparmname996521187213919">number</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname1239767987213919">basic-acl-number</span></i> } | [ <strong><span id="EN-US_TASK_0172374516__cmdparmname567414068213919">number</span></strong> ] <i><span class="varname" id="EN-US_TASK_0172374516__varname1436955381213919">basic-acl-number</span></i> } [ <strong><span id="EN-US_TASK_0172374516__cmdparmname1375230762213919">match-order</span></strong> { <strong><span id="EN-US_TASK_0172374516__cmdparmname29057725213919">config</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname1419228288213919">auto</span></strong> } ]</span> command.</p>
</li><li id="EN-US_TASK_0172374516__li1619196928214109"><p id="EN-US_TASK_0172374516__p929994112214109"><a name="EN-US_TASK_0172374516__li1619196928214109"></a><a name="li1619196928214109"></a>For an advanced ACL (numbered from 3000 to 3999), run the <span><a href="cmdqueryname=acl+name+advance+advance+number+number+match-order+config+auto"><b><span class="cmdname" id="EN-US_TASK_0172374516__cmdname1430753456213919">acl</span></b></a> { <strong><span id="EN-US_TASK_0172374516__cmdparmname220197166213919">name</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname1206592068213919">advance-acl-name</span></i> [ <strong><span id="EN-US_TASK_0172374516__cmdparmname642336928213919">advance</span></strong> | [ <strong><span id="EN-US_TASK_0172374516__cmdparmname943191697213919">advance</span></strong> ] <strong><span id="EN-US_TASK_0172374516__cmdparmname221974979213919">number</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname1130716142213919">advance-acl-number</span></i> ] | [ <strong><span id="EN-US_TASK_0172374516__cmdparmname1690144668213919">number</span></strong> ] <i><span class="varname" id="EN-US_TASK_0172374516__varname902710782213919">advance-acl-number</span></i> } [ <strong><span id="EN-US_TASK_0172374516__cmdparmname605677149213919">match-order</span></strong> { <strong><span id="EN-US_TASK_0172374516__cmdparmname679279458213919">config</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname1551680503213919">auto</span></strong> } ]</span> command.</p>
</li></ul>
</p></li><li class="substepexpand" id="EN-US_TASK_0172374516__substep_02"><a name="EN-US_TASK_0172374516__substep_02"></a><a name="substep_02"></a><span id="EN-US_TASK_0172374516__">Run either of the following commands to create an ACL rule:</span><p><ul><li id="EN-US_TASK_0172374516__li948394494616"><p id="EN-US_TASK_0172374516__p94832444467"><a name="EN-US_TASK_0172374516__li948394494616"></a><a name="li948394494616"></a>For a basic ACL (numbered from 2000 to 2999), run the following command:</p>
<p id="EN-US_TASK_0172374516__p1279709564214207"><span><a href="cmdqueryname=rule+name+deny+permit+fragment-type+fragment+non-fragment"><b><span class="cmdname" id="EN-US_TASK_0172374516__cmdname1104269681214207">rule</span></b></a> [ <i><span class="varname" id="EN-US_TASK_0172374516__varname219497657214207">rule-id</span></i> ] [ <strong><span id="EN-US_TASK_0172374516__cmdparmname1800750702214207">name</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname810980588214207">rule-name</span></i> ] { <strong><span id="EN-US_TASK_0172374516__cmdparmname1051531468214207">deny</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname1452464033214207">permit</span></strong> } [ <strong><span id="EN-US_TASK_0172374516__cmdparmname1356484618214207">fragment-type</span></strong> { <strong><span id="EN-US_TASK_0172374516__cmdparmname1796362702214207">fragment</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname480715200214207">non-fragment</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname1245647539214207">non-subseq</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname102102577214207">fragment-subseq</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname1269223371214207">fragment-spe-first</span></strong> } | <strong><span id="EN-US_TASK_0172374516__cmdparmname390672785214207">source</span></strong> { <i><span class="varname" id="EN-US_TASK_0172374516__varname1251458860214207">source-ip-address</span></i> { <i><span class="varname" id="EN-US_TASK_0172374516__varname266564955214207">source-wildcard</span></i> | <strong><span id="EN-US_TASK_0172374516__cmdparmname1521877709214207">0</span></strong><span> | <i><span class="varname" id="EN-US_TASK_0172374516__varname9033958214207">src-netmask</span></i></span> } | <strong><span id="EN-US_TASK_0172374516__cmdparmname1600490352214207">any</span></strong> } | <strong><span id="EN-US_TASK_0172374516__cmdparmname199720580214207">time-range</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname429236689214207">time-name</span></i> | [ <strong><span id="EN-US_TASK_0172374516__cmdparmname1481278975214207">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname355630956214207">vpn-instance-name</span></i> | <strong><span id="EN-US_TASK_0172374516__cmdparmname195222767214207">vpn-instance-any</span></strong> ] | <strong id="EN-US_TASK_0172374516__b18353202594614">logging</strong> ] <sup id="EN-US_TASK_0172374516__sup1801761977214207">*</sup></span></p>
</li><li id="EN-US_TASK_0172374516__li698291655214109"><p id="EN-US_TASK_0172374516__p189714730214109"><a name="EN-US_TASK_0172374516__li698291655214109"></a><a name="li698291655214109"></a>For an advanced ACL (numbered from 3000 to 3999), run the following command as required by the protocol type:</p>
<p id="EN-US_TASK_0172374516__p8574730204911"><span><a href="cmdqueryname=rule+name+deny+permit+tcp+dscp+precedence+tos+destination+0+any"><b><span class="cmdname" id="EN-US_TASK_0172374516__cmdname205494465213919">rule</span></b></a> [ <i><span class="varname" id="EN-US_TASK_0172374516__varname935488928213919">rule-id</span></i> ] [ <strong><span id="EN-US_TASK_0172374516__cmdparmname1828209180213919">name</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname1060464998213919">rule-name</span></i> ] { <strong><span id="EN-US_TASK_0172374516__cmdparmname1053008442213919">deny</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname196494665213919">permit</span></strong> } { <i><span class="varname" id="EN-US_TASK_0172374516__varname1410746687213919">protocol</span></i> | <strong><span id="EN-US_TASK_0172374516__cmdparmname2074921663213919">tcp</span></strong> } [ [ <strong><span id="EN-US_TASK_0172374516__cmdparmname1504460802213919">dscp</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname53704463213919">dscp</span></i> | [ <strong><span id="EN-US_TASK_0172374516__cmdparmname146944233213919">precedence</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname1118123941213919">precedence</span></i> | <strong><span id="EN-US_TASK_0172374516__cmdparmname1488818893213919">tos</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname720089276213919">tos</span></i> ] <sup id="EN-US_TASK_0172374516__sup861502165213919">*</sup> ] | { <strong><span id="EN-US_TASK_0172374516__cmdparmname2054161905213919">destination</span></strong> { <i><span class="varname" id="EN-US_TASK_0172374516__varname146647869213919">destination-ip-address</span></i> { <i><span class="varname" id="EN-US_TASK_0172374516__varname654896667213919">destination-wildcard</span></i> | <strong><span id="EN-US_TASK_0172374516__cmdparmname156741362213919">0</span></strong> | <i><span class="varname" id="EN-US_TASK_0172374516__varname720047697213919">des-netmask</span></i> } | <strong><span id="EN-US_TASK_0172374516__cmdparmname187854697213919">any</span></strong> } | <strong><span id="EN-US_TASK_0172374516__cmdparmname1830805705213919">destination-pool</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname1294996967213919">destination-pool-name</span></i> } | { <strong><span id="EN-US_TASK_0172374516__cmdparmname1055758391213919">destination-port</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname411597170213919">operator</span></i> <i><span class="varname" id="EN-US_TASK_0172374516__varname542054646213919">port-number</span></i> | <strong><span id="EN-US_TASK_0172374516__cmdparmname940908533213919">destination-port-pool</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname501482644213919">destination-port-pool-name</span></i> } | <strong><span id="EN-US_TASK_0172374516__cmdparmname1706899774213919">fragment-type</span></strong> { <strong><span id="EN-US_TASK_0172374516__cmdparmname1477252711213919">fragment</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname1414421433213919">non-fragment</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname1291766395213919">non-subseq</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname203348574213919">fragment-subseq</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname1664666094213919">fragment-spe-first</span></strong> } | { <strong><span id="EN-US_TASK_0172374516__cmdparmname652872542213919">source</span></strong> { <i><span class="varname" id="EN-US_TASK_0172374516__varname966797917213919">source-ip-address</span></i> { <i><span class="varname" id="EN-US_TASK_0172374516__varname1228944744213919">source-wildcard</span></i> | <strong><span id="EN-US_TASK_0172374516__cmdparmname536898029213919">0</span></strong> | <i><span class="varname" id="EN-US_TASK_0172374516__varname404635941213919">src-netmask</span></i> } | <strong><span id="EN-US_TASK_0172374516__cmdparmname1226203403213919">any</span></strong> } | <strong><span id="EN-US_TASK_0172374516__cmdparmname859983820213919">source-pool</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname845282763213919">source-pool-name</span></i> } | { <strong><span id="EN-US_TASK_0172374516__cmdparmname1036210061213919">source-port</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname7816914213919">operator</span></i> <i><span class="varname" id="EN-US_TASK_0172374516__varname1764245575213919">port-number</span></i> | <strong><span id="EN-US_TASK_0172374516__cmdparmname277104113213919">source-port-pool</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname1256135975213919">source-port-pool-name</span></i> } | <span>{ </span><strong><span id="EN-US_TASK_0172374516__cmdparmname461261579213919">tcp-flag</span></strong><span> | <strong><span id="EN-US_TASK_0172374516__cmdparmname127922434213919">syn-flag</span></strong> }</span> { <i><span class="varname" id="EN-US_TASK_0172374516__varname494068845213919">tcp-flag</span></i> [ <strong><span id="EN-US_TASK_0172374516__cmdparmname1745373629213919">mask</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname625474776213919">mask-value</span></i> ] | <strong><span id="EN-US_TASK_0172374516__cmdparmname1383723005213919">established</span></strong> |{ <strong><span id="EN-US_TASK_0172374516__cmdparmname46610216213919">ack</span></strong> [ <strong><span id="EN-US_TASK_0172374516__cmdparmname597558999213919">fin</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname2082922854213919">psh</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname438233024213919">rst</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname635706117213919">syn </span></strong>| <strong><span id="EN-US_TASK_0172374516__cmdparmname766949066213919">urg</span></strong> ] <sup id="EN-US_TASK_0172374516__sup262228806213919">*</sup> } | { <strong><span id="EN-US_TASK_0172374516__cmdparmname958741631213919">fin</span></strong> [ <strong><span id="EN-US_TASK_0172374516__cmdparmname2133625197213919">ack</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname907582943213919">psh</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname137936045213919">rst</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname1555924062213919">syn </span></strong>| <strong><span id="EN-US_TASK_0172374516__cmdparmname383357732213919">urg</span></strong> ] <sup id="EN-US_TASK_0172374516__sup1296687562213919">*</sup> } | { <strong><span id="EN-US_TASK_0172374516__cmdparmname153120145213919">psh</span></strong> [ <strong><span id="EN-US_TASK_0172374516__cmdparmname1067890373213919">fin</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname772319326213919">ack</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname342912127213919">rst </span></strong>| <strong><span id="EN-US_TASK_0172374516__cmdparmname443281755213919">syn</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname665622824213919">urg</span></strong> ] <sup id="EN-US_TASK_0172374516__sup835130396213919">*</sup> } | { <strong><span id="EN-US_TASK_0172374516__cmdparmname2028181671213919">rst</span></strong> [ <strong><span id="EN-US_TASK_0172374516__cmdparmname2117452975213919">fin</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname875543336213919">psh</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname1060844540213919">ack</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname956793760213919">syn</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname642091801213919">urg</span></strong> ] <sup id="EN-US_TASK_0172374516__sup372361119213919">*</sup> } | { <strong><span id="EN-US_TASK_0172374516__cmdparmname633288866213919">syn</span></strong> [ <strong><span id="EN-US_TASK_0172374516__cmdparmname1366781479213919">fin</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname1739459694213919">psh</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname1138475368213919">rst</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname534184455213919">syn </span></strong>| <strong><span id="EN-US_TASK_0172374516__cmdparmname497901016213919">urg</span></strong> ] <sup id="EN-US_TASK_0172374516__sup1322666089213919">*</sup> } | { <strong><span id="EN-US_TASK_0172374516__cmdparmname720028705213919">urg</span></strong> [ <strong><span id="EN-US_TASK_0172374516__cmdparmname1355486378213919">fin</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname815332107213919">psh</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname871213298213919">rst</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname1580306366213919">syn</span></strong> | <strong><span id="EN-US_TASK_0172374516__cmdparmname1821693418213919">urg</span></strong> ] <sup id="EN-US_TASK_0172374516__sup104069940213919">*</sup> } } | <strong><span id="EN-US_TASK_0172374516__cmdparmname1169343020213919">time-range</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname823803037213919">time-name</span></i> <span>| <strong><span id="EN-US_TASK_0172374516__cmdparmname386836490213919">ttl</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname1424309400213919">ttl-operation</span></i> <i><span class="varname" id="EN-US_TASK_0172374516__varname198458539213919">ttl-value</span></i> </span><span>| <strong><span id="EN-US_TASK_0172374516__cmdparmname1210934341213919">packet-length</span></strong> <i><span class="varname" id="EN-US_TASK_0172374516__varname1907685389213919">length-operation</span></i> <i><span class="varname" id="EN-US_TASK_0172374516__varname4514646213919">length-value</span></i> </span>] <sup id="EN-US_TASK_0172374516__sup2112023694213919">*</sup></span></p>
<p id="EN-US_TASK_0172374516__p48367916289">The preceding configuration uses TCP as the example protocol. The configurations of the other protocols are similar. For details, see the <strong id="EN-US_TASK_0172374516__b2677357144015">rule (Advanced ACL view) (UDP)</strong>, <strong id="EN-US_TASK_0172374516__b15694717194110">rule (advanced ACL view) (ICMP)</strong>, and <strong id="EN-US_TASK_0172374516__b52811556194210">rule (Advanced ACL view) (gre-igmp-ip-ipinip-ospf)</strong> commands.</p>
</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>Generally, source IP addresses are matched against in ACL rules. To specify multiple ACL rules, repeat Step <a href="#EN-US_TASK_0172374516__substep_02">2.b</a>.</li><li>Rules in an ACL to which traffic is matched against are used based on the depth first principle (with <strong>auto</strong> configured) or the configuration order (with <strong>config</strong> configured). By default, rules are matched against in the configuration order (with <strong>config</strong> configured).</li><li>When an ACL rule is associated with an instance, the address wildcard of the ACL rule must be a subnet mask in consecutive mode (with 0s and 1s consecutively sequenced, such as 255.255.255.0), instead of a subnet mask in non-consecutive mode (with 0s and 1s non-consecutively sequenced, such as 255.0.255.0).</li></ul>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li></ol>
</li><li><span>Configure a traffic classifier.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=traffic+classifier+operator+and+or"><b><span class="cmdname">traffic classifier</span></b></a> <i><span class="varname">classifier-name</span></i> [ <strong><span>operator</span></strong> { <strong><span>and</span></strong> | <strong><span>or</span></strong> } ]</span><p><p>A traffic classifier is configured, and its view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=if-match+acl"><b><span class="cmdname">if-match acl</span></b></a> <i><span class="varname">acl-number</span></i></span><p><p>An ACL-based matching rule is defined for multi-field traffic classification.</p>
<p>To configure multiple ACL-based matching rules, repeat this step.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li></ol>
</li><li><span>Configure a traffic behavior.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=traffic+behavior"><b><span class="cmdname">traffic behavior</span></b></a> <i><span class="varname">behavior-name</span></i></span><p><p>A traffic behavior is configured, and its view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=nat+bind+instance"><b><span class="cmdname">nat bind instance</span></b></a> <i><span class="varname">instance-name</span></i></span><p><p>A traffic behavior is bound to a NAT instance.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The same post-NAT traffic cannot be redirected. That is, the <a href="cmdqueryname=nat+bind+instance"><b><span class="cmdname">nat bind instance</span></b></a> and <a href="cmdqueryname=redirect+ip-nexthop"><b><span class="cmdname">redirect ip-nexthop</span></b></a> commands are mutually exclusive.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li></ol>
</li><li><span>Configure a traffic policy.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=traffic+policy"><b><span class="cmdname">traffic policy</span></b></a> <i><span class="varname">policy-name</span></i></span><p><p>A traffic policy is configured, and its view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=classifier+behavior"><b><span class="cmdname">classifier</span></b></a> <i><span class="varname">classifier-name</span></i> <strong><span>behavior</span></strong> <i><span class="varname">behavior-name</span></i></span><p><p>The traffic behavior is bound to the traffic classifier in the traffic policy.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li></ol>
</li><li><span>Apply the traffic policy to an interface.</span><p><p>For NAT user traffic on an inbound interface, apply the traffic policy to a user-side Layer 3 interface.</p>
</p><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> <i><span class="varname">interface-name</span></i></span><p><p>The interface view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=traffic-policy+inbound+link-layer+all-layer+mpls-layer"><b><span class="cmdname">traffic-policy</span></b></a> <i><span class="varname">policy-name</span></i> <strong><span>inbound</span></strong> [ <strong><span>link-layer</span></strong> | <strong><span>all-layer</span></strong> | <strong><span>mpls-layer</span></strong> ]</span><p><p>The traffic policy is applied to the interface.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
<p><p>For NAT user traffic on an inbound interface, apply the traffic policy to a user-side Layer 2 Ethernet interface that is added to a VLAN.</p>
</p><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> <i><span class="varname">interface-name</span></i></span><p><p>The interface view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=portswitch"><b><span class="cmdname">portswitch</span></b></a></span><p><p>The interface is switched to the Layer 2 mode.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=port+link-type+access+dot1q-tunnel+hybrid+trunk"><b><span class="cmdname">port link-type</span></b></a> { <strong><span>access</span></strong> | <strong><span>dot1q-tunnel</span></strong> | <strong><span>hybrid</span></strong> | <strong><span>trunk</span></strong> }</span><p><p>A type is set for the Layer 2 Ethernet interface.</p>
</p></li><li class="substepexpand"><span>Run either of the following commands to add an interface to a VLAN:</span><p><ul><li><p>For an access or QinQ interface:</p>
<ol class="substepthirdol"><li><p>Run the <a href="cmdqueryname=port+default+vlan"><b><span class="cmdname">port default vlan</span></b></a> <i><span class="varname">vlan-id</span></i> command to add the interface to the VLAN.</p>
<p>To add one or more interfaces to a VLAN in a batch, run the <a href="cmdqueryname=port+to"><b><span class="cmdname">port </span></b></a><i><span class="varname">interface-type</span></i> { <i><span class="varname">interface-number1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">interface-number2</span></i> ] } &amp;&lt;1-10&gt; command in the VLAN view. </p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>The input interface format must be correct. <i><span class="varname">interface-number2</span></i> must be greater than <i><span class="varname">interface-number1</span></i>. <i><span class="varname">interface-number2</span></i> and <i><span class="varname">interface-number1</span></i> must specify the same type of interface. Interfaces in the range defined by <i><span class="varname">interface-number2</span></i> and <i><span class="varname">interface-number1</span></i> must exist.</li><li>In a <a href="cmdqueryname=port+to+to"><b><span class="cmdname">port </span></b></a><i><span class="varname">interface-type</span></i> { <i><span class="varname">interface-number1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">interface-number2</span></i> ] } &amp;&lt;1-10&gt; command, a maximum of 10 <strong><span>to</span></strong> parameters can be used to define 10 ranges of interfaces.</li></ul>
</div></div>
</li></ol>
</li><li><p>For a hybrid interface:</p>
<ol class="substepthirdol"><li><p><span>Run the <a href="cmdqueryname=port+trunk+allow-pass+vlan+to+all"><b><span class="cmdname">port trunk allow-pass vlan</span></b></a> { { <i><span class="varname">vlan-id1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id2</span></i> ] } &amp;&lt;1-10&gt; | <strong><span>all</span></strong> }</span> command to add the interface to a specified VLAN.</p>
</li><li><p>(Optional) Run the <a href="cmdqueryname=port+default+vlan"><b><span class="cmdname">port default vlan</span></b></a> <i><span class="varname">vlan-id</span></i> command to specify a default VLAN for the trunk interface.</p>
</li></ol>
</li></ul>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=traffic-policy+inbound+vlan+to+link-layer"><b><span class="cmdname">traffic-policy</span></b></a> <i><span class="varname">policy-name</span></i> <strong><span>inbound</span></strong> <strong><span>vlan</span></strong> {<span> <strong><span>all</span></strong> |</span> <i><span class="varname">vlan-id1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id2</span></i> ] } [ <strong><span>link-layer</span></strong><span> | <strong><span>all-layer</span></strong> | <strong><span>mpls-layer</span></strong></span> ]</span><p><p>The traffic policy is applied to the Layer 2 interface.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
<p><p>For NAT user traffic on an inbound interface, apply the traffic policy to a VPN instance.</p>
</p><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=ip+vpn-instance"><b><span class="cmdname">ip vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></span><p><p>The VPN instance view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=traffic-policy+network+inbound"><b><span class="cmdname">traffic-policy</span></b></a> <i><span class="varname">policy-name</span></i> <strong><span>network</span></strong> <strong><span>inbound</span></strong></span><p><p>The traffic policy is applied to the VPN instance.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0018.html">Configuring Centralized NAT
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0027.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>