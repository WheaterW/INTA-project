
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Centralized NAT Load Balancing">
<meta name="abstract" content="This section provides an example for configuring centralized NAT load balancing to implement many-to-many translation between private and public networks and allow PCs on a specified network segment to access the Internet.">
<meta name="description" content="This section provides an example for configuring centralized NAT load balancing to implement many-to-many translation between private and public networks and allow PCs on a specified network segment to access the Internet.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0056.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0086_1.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0094_m2k.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="c00549182">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="NAT">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="c00549182">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001093157612">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Centralized NAT Load Balancing</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001093157612"></a><a name="EN-US_TASK_0000001093157612"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Centralized NAT Load Balancing</h1>
<div class="taskbody"><p>This section provides an example for configuring centralized NAT load balancing to implement many-to-many translation between private and public networks and allow PCs on a specified network segment to access the Internet.</p>
<div class="context"><a name="EN-US_TASK_0000001093157612__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_context930646841214110"><h4 class="sectiontitle">Networking Requirements</h4><div class="note" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_note98102031145210"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p18810531185214">Only the <span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1152414571330">NE40E</span><span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword3501321048">-M2K</span> and <span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword84407551658">NE40E</span><span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword18823101016414">-M2K-B</span> support this configuration.</p>
</div></div>
<p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p308367611214110">On the network shown in <a href="#EN-US_TASK_0000001093157612__en-us_task_0172374594_fig_dc_ne_cfg_nat_005701">Figure 1</a>, in a centralized NAT scenario, the <span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1000875323214110">Router</span> performs the NAT function to help PCs within an enterprise network access the Internet. The <span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword521871057214415">Router</span> uses the Ethernet interface <span>0/2/0</span> to connect to the enterprise network.</p>
<div class="p" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p280421069214110"><a href="#EN-US_TASK_0000001093157612__en-us_task_0172374594_fig_dc_ne_cfg_nat_005701">Figure 1</a> shows IP addresses of interfaces. The configuration requirements are as follows:<ul id="EN-US_TASK_0000001093157612__en-us_task_0172374594_ul624841882214110"><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li209365225214110">Only PCs on the network segment of 192.168.10.0/24 can access the Internet.</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li628269159214110">Many-to-many NAT needs to be performed for IP addresses between the private and public networks.</li></ul>
</div>
<div class="fignone" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_fig_dc_ne_cfg_nat_005701"><a name="EN-US_TASK_0000001093157612__en-us_task_0172374594_fig_dc_ne_cfg_nat_005701"></a><a name="en-us_task_0172374594_fig_dc_ne_cfg_nat_005701"></a><span class="figcap"><b>Figure 1 </b>Network diagram of centralized NAT load balancing</span><div class="note" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_note1592642294214110"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p1302859050214110">Interface 1 in this example represents GE <span>0/2/0</span>.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_image2123474759214110" src="images/fig_dc_ne_cfg_nat_0009.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001093157612__1.4.2"></a><a name="1.4.2"></a>
<div class="p" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_context960388044214110"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p899533113214110">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0000001093157612__en-us_task_0172374594_ol97832525214110"><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li2033583294214110">Create a NAT load balancing instance.</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li157425542214110">Configure a CGN global static address pool.</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li826003247214110">Bind the NAT instance to the global address pool.</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li1253225528214110">Configure a NAT traffic diversion policy.</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li1862900478214110">Configure a NAT conversion policy.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001093157612__1.4.3"></a><a name="1.4.3"></a>
<div class="p" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_context71495646214110"><h4 class="sectiontitle">Data Preparation</h4><div class="p" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p1355861128214110">To complete the configuration, you need the following data: <ul id="EN-US_TASK_0000001093157612__en-us_task_0172374594_ul1731770341214110"><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li487643629214110">NAT load balancing instance</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li873811630214110">ID of the NAT address pool and the name of the global static address pool to be bound to the NAT instance</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li480858444214110">Information about the NAT traffic diversion policy<div class="note" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_note17509182063111"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p10416182510356">If the address pool usage is too high, perform the following operations. Otherwise, address pool resources will be unevenly allocated, causing users to fail to access the Internet.</p>
<ul id="EN-US_TASK_0000001093157612__en-us_task_0172374594_ul15974729203519"><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li159747292359">Before CPU capacity expansion, expand address pool resources so that new CPUs can be assigned normal initial address segments.</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li67801202100">After capacity expansion, you are advised to run the <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b943952695616">reset nat session table</strong> command to clear the sessions and perform load balancing again.</li></ul>
</div></div>
</li></ul>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001093157612__1.4.4"></a><a name="1.4.4"></a>
<div class="p" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_context1668819316214110"><h4 class="sectiontitle">Procedure</h4><ol id="EN-US_TASK_0000001093157612__en-us_task_0172374594_ol2043276936214110"><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li1557754248214110"><div class="p" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p1202505559214110"><a name="EN-US_TASK_0000001093157612__en-us_task_0172374594_li1557754248214110"></a><a name="en-us_task_0172374594_li1557754248214110"></a>Create a NAT load balancing instance.<ol type="a" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_ol989392304214110"><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li9904172267"><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p13904672262"><a name="EN-US_TASK_0000001093157612__en-us_task_0172374594_li9904172267"></a><a name="en-us_task_0172374594_li9904172267"></a>Set the maximum number of sessions that can be created on the CPU of the NAT service board to 6M.</p>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen09046714263">&lt;<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1090457142612">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b11904774268">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen69046714268">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword390467102619"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword79045712261">HUAWEI</span>] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b19904147142610">sysname CGNA</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen390537112614">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword89053720260">*</span><span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword790519713268">HUAWEI</span>] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b690514719263">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen2090512742618">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword15905176264"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA]<strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b159051575266"> vsm on-board-mode disable</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen790513718262">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1790577152613">*</span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1790519732613">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1290537102610">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword09051477263"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b179053719268">license</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen69054711268">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword189050702616"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-license] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b129056710264">active nat session-table size 6 slot <span>1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1990514710263">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword590518710261"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-license] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1290517792614">active nat session-table size 6 slot <span>2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen59053711263">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword290520702616"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-license] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1290511716269">active nat bandwidth-enhance 40 slot <span>1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1890514719262">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword99054719264"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-license] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b99057715269">active nat bandwidth-enhance 40 slot <span>2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1090510732610">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword199052076268"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-license] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b13905117182613">quit</strong></pre>
</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li745716359214110"><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p540281821214110"><a name="EN-US_TASK_0000001093157612__en-us_task_0172374594_li745716359214110"></a><a name="en-us_task_0172374594_li745716359214110"></a>Create a service-instance group named <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b573615555913">groupa</strong> and bind it to service-location groups <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1273613510592">1</strong> and <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b07378515910">2</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1521067104214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1025405002214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1962840763214110">service-location 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen949756383214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1921297476214110">*</span>CGNA-service-location-1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b768988184214110">location slot <span>1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen84124868214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword138632579214110">*</span>CGNA-service-location-1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1731393137214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1389933032214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1495517716214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-service-location-1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1055616760214110">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1583244269214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword503808478214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1812250778214110">service-location 2</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1930270396214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword876331398214110">*</span>CGNA-service-location-2] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1660710731214110">location slot <span>2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1846487833214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword829117942214110">*</span>CGNA-service-location-2] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b430557578214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1027353545214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword2040841341214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-service-location-2] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b2032106424214110">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen610914328214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword966558279214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b281589585214110">service-instance-group groupa</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen375921528214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword662540230214110">*</span>CGNA-service-instance-group-groupa] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b880607098214110">service-location 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1920048879214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1439728517214110">*</span>CGNA-service-instance-group-groupa] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1401922245214110">service-location 2</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen549760108214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1322137376214110">*</span>CGNA-service-instance-group-groupa] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b129814802214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1982821201214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword135112044214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-service-instance-group-groupa] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b900358623214110">quit</strong></pre>
</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li908367230214110"><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p466788087214110"><a name="EN-US_TASK_0000001093157612__en-us_task_0172374594_li908367230214110"></a><a name="en-us_task_0172374594_li908367230214110"></a>Bind a NAT instance named <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b300810708214415">cpe1</strong> to the service-instance group named <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b2014460047214415">groupa</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1064206679214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1466397447214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1540101931214110">nat instance cpe1 id 11</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1114026972214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1779639007214110">*</span>CGNA-nat-instance-cpe1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1447577377214110">service-instance-group groupa</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen722985351214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1998127628214110">*</span>CGNA-nat-instance-cpe1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1320426036214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen391032724214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1302571663214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-nat-instance-cpe1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b964189522214110">quit</strong></pre>
</li></ol>
</div>
</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li997522279214110"><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p2099594671214110"><a name="EN-US_TASK_0000001093157612__en-us_task_0172374594_li997522279214110"></a><a name="en-us_task_0172374594_li997522279214110"></a>Configure a CGN global static address pool.</p>
<p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p44063846214110"># Create an address segment 11.11.11.1/24 in the CGN global static address pool named <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1104575747214415">pool1</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1803716834214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1677087132214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1861108711214110">nat ip-pool pool1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen727823458214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1769592353214110">*</span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b61592089214110">section 0 11.11.11.1 mask 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen331092672214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1600499869214110">*</span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1485387217214110">nat-instance subnet length initial 25 extend 27</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen129521830214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword73991965214110">*</span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b894355152214110">nat-instance ip used-threshold upper-limit 60 lower-limit 40</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1092049642214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword968980140214110">*</span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b795117772214110">nat alarm ip threshold 60</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen90628877214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword48273439214110">*</span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b842080004214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen355942369214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1985775344214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1071583744214110">quit</strong></pre>
<div class="note" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_note15424165414477"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p204241054144710">When users are online, if you want to change the address segment of a global address pool or the length of an assigned address segment, run the <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1490064818557">section lock</strong> command first. For example:<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen698144205012">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword899118914502"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1499139165013">nat ip-pool pool1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1713941845019">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword156801187535">*</span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b2367102475017">section 0 11.11.11.1 mask 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen74919413506">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1356261185318">*</span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1744424118504">section 0 lock</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1745316501501">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword2046241365311">*</span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b32971458155017">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen199581879516">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword911171175116"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1946191355119">reset nat user nat-ip-pool pool1 section 0</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen48561289523">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword770093417528"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b16411193835218">undo section 0</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen8640150195218">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1829133235314">*</span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b25661755135216">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1468693555313">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1754616419532"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b259234835317">nat-instance subnet initial 24 extend 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen85302136546">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword01355352568">*</span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b199391013195412">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen81763305543">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword6159431115414"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b27901340195416">section 0 1.2.3.4 mask 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen2060635813544">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword38967712553">*</span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b616612235518">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen886714420569">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword88590544569"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-nat-ip-pool-pool1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b136653573564">quit</strong></pre>
</div>
</div></div>
</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li309409452214110"><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p1186750377214110"><a name="EN-US_TASK_0000001093157612__en-us_task_0172374594_li309409452214110"></a><a name="en-us_task_0172374594_li309409452214110"></a>Bind the NAT instance to the global address pool.</p>
<p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p1435912080214110"># Bind the address pool named <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1812870720214415">group1</strong> in the NAT instance named <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1038398252214415">cpe1</strong> to the global static address pool named <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1651885881214415">pool1</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen2085750314214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1980998832214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1450573180214110">nat instance cpe1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1367944831214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword798042180214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-nat-instance-cpe1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b434114979214110">nat address-group group1 group-id 1 bind-ip-pool pool1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen295229743214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword833858058214110">*</span>CGNA-nat-instance-cpe1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1234107374214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen659559288214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1917276769214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-nat-instance-cpe1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b971814266214110">quit</strong></pre>
</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li1234072361214110"><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p657108601214110"><a name="EN-US_TASK_0000001093157612__en-us_task_0172374594_li1234072361214110"></a><a name="en-us_task_0172374594_li1234072361214110"></a>Configure a NAT traffic diversion policy.</p>
<ol type="a" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_ol2030210332214110"><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li1152518396214110"><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p74185632214110"><a name="EN-US_TASK_0000001093157612__en-us_task_0172374594_li1152518396214110"></a><a name="en-us_task_0172374594_li1152518396214110"></a>Configure an ACL numbered <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b557819331407">3001</strong> and an ACL rule numbered <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b11579833144010">1</strong> to allow hosts only within the network segment 192.168.10.0/24 to access the Internet.</p>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen2029979557214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1940518753214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1331343529214110">acl 3001</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen136101720214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword453721487214110">*</span>CGNA-acl4-advance-3001] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1788871823214110">rule 1 permit ip source 192.168.10.0 0.0.0.255</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1866278353214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1316603375214110">*</span>CGNA-acl4-advance-3001] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1738017910214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1362811533214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1517879259214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-acl4-advance-3001] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b853083931214110">quit</strong></pre>
</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li1165354537214110"><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p1062842719214110"><a name="EN-US_TASK_0000001093157612__en-us_task_0172374594_li1165354537214110"></a><a name="en-us_task_0172374594_li1165354537214110"></a>Configure a traffic classifier.</p>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen861846971214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword608226511214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b2033613696214110">traffic classifier c1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1094119895214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword2043831685214110">*</span>CGNA-classifier-c1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b390456512214110">if-match acl 3001</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen2049935593214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1587355186214110">*</span>CGNA-classifier-c1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b352239384214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1005605133214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword2019138239214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-classifier-c1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1961399392214110">quit</strong></pre>
</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li1171027723214110"><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p1922799353214110"><a name="EN-US_TASK_0000001093157612__en-us_task_0172374594_li1171027723214110"></a><a name="en-us_task_0172374594_li1171027723214110"></a>Configure a traffic behavior named <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b357369354526">b1</strong>, which binds traffic to the NAT instance named <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b14532747064526">cpe1</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen2011614766214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1966607402214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1728850109214110">traffic behavior b1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen792275148214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1221316212214110">*</span>CGNA-behavior-b1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b321844037214110">nat bind instance cpe1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1619304369214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword61902276214110">*</span>CGNA-behavior-b1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1000872988214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen115452519214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword2114878135214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-behavior-b1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b150848991214110">quit</strong></pre>
</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li960678243214110"><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p1337171955214110"><a name="EN-US_TASK_0000001093157612__en-us_task_0172374594_li960678243214110"></a><a name="en-us_task_0172374594_li960678243214110"></a>Define a NAT policy to associate the ACL rule with the traffic behavior.</p>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen703888068214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1213514219214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b531592059214110">traffic policy p1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1364364070214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword2125596573214110">*</span>CGNA-trafficpolicy-p1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1497041340214110">classifier c1 behavior b1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1336769278214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword184377144214110">*</span>CGNA-trafficpolicy-p1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1515938889214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen900372905214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword918558525214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-trafficpolicy-p1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1414223793214110">quit</strong></pre>
</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li1644214361214110"><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p491195731214110"><a name="EN-US_TASK_0000001093157612__en-us_task_0172374594_li1644214361214110"></a><a name="en-us_task_0172374594_li1644214361214110"></a>Apply the NAT traffic diversion policy in the interface view.</p>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen2374419214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1768206056214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1261843233214110">interface gigabitEthernet <span>0/2/0</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen9910172522119">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1635102692112"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b179205309215">ip address 192.168.10.1 24</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1354176095214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword17989184702111">*</span>CGNA-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1945943975214110">traffic-policy p1 inbound</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen691534373214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1824053930214110">*</span>CGNA-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1352884915214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen711580452214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1593421002214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-GigabitEthernet<span>0/2/0</span>] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1668368772214110">quit</strong></pre>
</li></ol>
</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li804797597214110"><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p1381203973214110"><a name="EN-US_TASK_0000001093157612__en-us_task_0172374594_li804797597214110"></a><a name="en-us_task_0172374594_li804797597214110"></a>Configure a NAT conversion policy.</p>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1251926072214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword922649786214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b174387850214110">nat instance cpe1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen146119626214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword876917830214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-nat-instance-cpe1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1592370013214110">nat outbound 3001 address-group group1</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen892332874214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1145456302214110">*</span>CGNA-nat-instance-cpe1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b815465362214110">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen53357168214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword1847487331214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA-nat-instance-cpe1] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b305504560214110">quit</strong></pre>
</li><li id="EN-US_TASK_0000001093157612__en-us_task_0172374594_li1054096343214110"><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p1604632698214110"><a name="EN-US_TASK_0000001093157612__en-us_task_0172374594_li1054096343214110"></a><a name="en-us_task_0172374594_li1054096343214110"></a>Verify the configuration.</p>
<p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p1883603557214110"># Display detailed user information on CPU 0 of the service board in slot <span>1</span>.</p>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1953197213214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword441129110214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b891127281214110">display nat user-information slot <span>1</span> verbose</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen2128660230214110">This operation will take a few minutes. Press 'Ctrl+C' to break ...             
Slot: <span>1</span>                                                               
Total number:  1.                                                          
  --------------------------------------------------------------- 
  User Type                             :  NAT444                               
  CPE IP                                :  192.168.10.100                           
  User ID                               :  -                                    
  VPN Instance                          :  -                                    
  Address Group                         :  group1                                    
  NoPAT Address Group                   :  -
  NAT Instance                          :  cpe1                                 
  Public IP                             :  11.11.11.1                          
  Start Port                            :  1152                                 
  Port Range                            :  0                                   
  Port Total                            :  5                                   
  Extend Port Alloc Times               :  0                                    
  Extend Port Alloc Number              :  0                                    
  First/Second/Third Extend Port Start  :  0/0/0                                
  Total/TCP/UDP/ICMP Session Limit      :  8192/10240/10240/512                 
  Total/TCP/UDP/ICMP Session Current    :  5/5/0/0                              
  Total/TCP/UDP/ICMP Rev Session Limit  :  8192/10240/10240/512                 
  Total/TCP/UDP/ICMP Rev Session Current:  0/0/0/0                              
  Total/TCP/UDP/ICMP Port Limit         :  0/0/0/0                              
  Total/TCP/UDP/ICMP Port Current       :  5/5/0/0                              
  Nat ALG Enable                        :  NULL                                  
  Token/TB/TP                           :  0/0/0                                
  Port Forwarding Flag                  :  Non Port Forwarding                  
  Port Forwarding Ports                 :  0 0 0 0 0                            
  Aging Time(s)                         :  -                                    
  Left Time(s)                          :  -                                    
  Port Limit Discard Count              :  0                                    
  Session Limit Discard Count           :  0                                    
  Fib Miss Discard Count                :  0                                    
  --&gt;Transmit Packets                   :  15                                   
  --&gt;Transmit Bytes                     :  660                                  
  --&gt;Drop Packets                       :  0                                    
  &lt;--Transmit Packets                   :  40                                   
  &lt;--Transmit Bytes                     :  1740                                 
  &lt;--Drop Packets                       :  0                                    
---------------------------------------------------------------</pre>
<p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p993034842214110"># Display load balancing statistics of the NAT instance named <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b901747439214415">cpe1</strong> on the service board in slot <span>1</span>.</p>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen618221069214110">[<span class="keyword" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_keyword2146976324214110"><font style="font-size:8pt" Face="Courier New" >~</font></span>CGNA] <strong id="EN-US_TASK_0000001093157612__en-us_task_0172374594_b1835466824214110">display nat statistics global nat-instance cpe1 slot <span>1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen1990318652214110">Slot: <span>1</span>                                                          
---------------------------------------------------------------------------
 Session table number                           :20
 User table number                              :0
 Total setup sessions                           :10
 Total teardown sessions                        :10
---------------------------------------------------------------------------

Slot: <span>1</span>                                                          
---------------------------------------------------------------------------
 Session table number                           :30
 User table number                              :0
 Total setup sessions                           :15
 Total teardown sessions                        :15
---------------------------------------------------------------------------</pre>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001093157612__1.4.5"></a><a name="1.4.5"></a>
<div class="p" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_context905834532214110"><h4 class="sectiontitle">Configuration Files</h4><p id="EN-US_TASK_0000001093157612__en-us_task_0172374594_p874556565214110">CGNA configuration file</p>
<pre class="screen" id="EN-US_TASK_0000001093157612__en-us_task_0172374594_screen356879993214110">#
sysname CGNA
vsm on-board-mode disable
#
license
 active nat session-table size 6 slot <span>1</span> engine 0
 active nat session-table size 6 slot <span>2</span>  engine 1
 active nat bandwidth-enhance 40 slot <span>1</span>
 active nat bandwidth-enhance 40 slot <span>2</span> 
service-location 1      
 location slot <span>1</span> 
#
service-location 2      
 location slot <span>2</span> 
#
service-instance-group groupa      
 service-location 1      
 service-location 2
#
nat ip-pool pool1
 section 0 11.11.11.1 mask 24
 nat-instance subnet length initial 25 extend 27
 nat-instance ip used-threshold upper-limit 60 lower-limit 40
 nat alarm ip threshold 60
#
nat instance cpe1 id 11     
 service-instance-group groupa      
 nat address-group group1 group-id 1 bind-ip-pool pool1
 nat outbound 3001 address-group group1 
#
acl number 3001
 rule 1 permit ip source 192.168.10.0 0.0.0.255
#
traffic classifier c1 operator or
 if-match acl 3001 precedence 1
#
traffic behavior b1
 nat bind instance cpe1
#
traffic policy p1
 classifier c1 behavior b1 precedence 1
#
interface GigabitEthernet <span>0/2/0</span>
 undo shutdown
 ip address 192.168.10.1 255.255.255.0
 traffic-policy p1 inbound
#
return
</pre>
</div></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0056.html">Configuration Examples for NAT
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0086_1.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_nat_cfg_0094_m2k.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>