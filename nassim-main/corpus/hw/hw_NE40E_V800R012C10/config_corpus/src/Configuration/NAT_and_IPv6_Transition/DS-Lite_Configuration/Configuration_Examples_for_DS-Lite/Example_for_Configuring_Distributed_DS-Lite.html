
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Distributed DS-Lite">
<meta name="abstract" content="This section provides an example for configuring distributed DS-Lite. Distributed DS-Lite allows private IPv4 users to pass through an IPv6 network to access a public IPv4 network.">
<meta name="description" content="This section provides an example for configuring distributed DS-Lite. Distributed DS-Lite allows private IPv4 users to pass through an IPv6 network to access a public IPv4 network.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ds-lite_cfg_0058.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ds-lite_cfg_0060.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="c00549182">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="DS-Lite">
<meta name="featuretype" content="NAT and IPv6 Transition">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="DS-Lite">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="DS-Lite">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="featurename" content="DS-Lite">
<meta name="featuretype" content="NAT and IPv6 Transition">
<meta name="OWNER" content="c00549182">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="c00549182">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172374758">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Distributed DS-Lite</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172374758"></a><a name="EN-US_TASK_0172374758"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Distributed DS-Lite</h1>
<div class="taskbody"><p>This section provides an example for configuring distributed DS-Lite. Distributed DS-Lite allows private IPv4 users to pass through an IPv6 network to access a public IPv4 network.</p>
<div class="context"><a name="EN-US_TASK_0172374758__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0172374758__dc_ne_cfg_dslite_006301">Figure 1</a>, a home user's PC with a private IPv4 address accesses an IPv6 MAN through an IPv4 and IPv6 dual-stack-capable and DS-Lite-capable CPE. The CPE and DS-Lite device establish a DS-Lite tunnel. The CPE transmits traffic with the private IPv4 address along the DS-Lite tunnel to the DS-Lite device. The DS-Lite device decapsulates traffic, uses a Network Address Translation (NAT) technique to translate the private IPv4 address to a public IPv4 address, and forwards traffic to the IPv4 Internet. The DS-Lite device's GE <span>0/2/1</span> is connected to an IPv6 MAN, and GE <span>0/2/2</span> is connected to the Internet. IPv4 home users need to access the IPv4 Internet through the IPv6 MAN. The carrier provides 11 public IPv4 addresses 11.11.11.100 through 11.11.11.110.</p>
<div class="p">The configuration requirements are as follows:<ul><li>The private IPv4 home users' PCs can access the IPv4 Internet through the IPv6 MAN.</li><li>The private IPv4 addresses of home users can be mapped to multiple public IP addresses in many-to-many translation mode.</li></ul>
</div>
<div class="fignone" id="EN-US_TASK_0172374758__dc_ne_cfg_dslite_006301"><a name="EN-US_TASK_0172374758__dc_ne_cfg_dslite_006301"></a><a name="dc_ne_cfg_dslite_006301"></a><span class="figcap"><b>Figure 1 </b>Networking diagram for a DS-Lite application</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent GE <span>0/2/1</span> and GE <span>0/2/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_ne_ds-lite_cfg_0061.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172374758__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><div class="p">The configuration roadmap is as follows:<ol><li>Configure basic license functions.</li><li>Configure a DS-Lite instance and bind it to a DS-Lite board.</li><li>Configure a local IPv6 address and a remote IPv6 address for a DS-Lite tunnel.</li><li>Configure a DS-Lite address pool with addresses ranging from 11.11.11.100 to 11.11.11.110.</li><li>Configure DS-Lite user information and RADIUS authentication on the BRAS.</li><li>Configure a traffic diversion policy for the DS-Lite tunnel.</li><li>Bind the DS-Lite tunnel to the address pool.</li><li>Configure interfaces and a routing protocol.</li><li>Enable the device to advertise the local IP route to the IPv6 network and the address pool route to the IPv4 network.</li></ol>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172374758__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><ul><li><p>Name of a DS-Lite instance</p>
</li><li><p>Slot IDs of DS-Lite boards to which a DS-Lite instance is bound</p>
</li><li><p>Local IPv6 address and a remote IPv6 address for a DS-Lite tunnel</p>
</li><li><p>DS-Lite address pool number and start and end IP addresses</p>
</li><li><p>Name of a user group bound to a DS-Lite instance</p>
</li><li><p>IPv6 ACL rule number used in DS-Lite traffic classification</p>
</li><li><p>IPv6 ACL rule number used to be bound to a DS-Lite address pool</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172374758__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure basic license functions.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname BRAS</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS]<strong> vsm on-board-mode disable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS] <strong>license</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-license] <strong>active ds-lite vsuf slot <span>1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-license] <strong>active nat session-table size 16 slot <span>1</span> </strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-license]<strong> active nat bandwidth-enhance 40 slot <span>1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-license] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-license] <strong>quit</strong></pre>
</p></li><li><span>Configure a DS-Lite instance and bind it to a DS-Lite board.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS] <strong>service-location 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-service-location-1] <strong>location slot <span>1</span> </strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-service-location-1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-service-location-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS] <strong>service-instance-group 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-instance-group-1] <strong>service-location 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-instance-group-1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-instance-group-1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS] <strong>ds-lite instance ds-lite1 id 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-ds-lite-instance-ds-lite1] <strong>service-instance-group 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-ds-lite-instance-ds-lite1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-ds-lite-instance-ds-lite1] <strong>quit</strong></pre>
</p></li><li><span>Configure a local IPv6 address and a remote IPv6 address for a DS-Lite tunnel.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS] <strong>ds-lite instance ds-lite1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-ds-lite-instance-ds-lite1] <strong>local-ipv6 2001:DB8::1 prefix-length 128</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-ds-lite-instance-ds-lite1] <strong>remote-ipv6 2001:DB8:2::2 prefix-length 96</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-ds-lite-instance-ds-lite1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-ds-lite-instance-ds-lite1] <strong>quit</strong></pre>
</p></li><li><span>Configure a DS-Lite address pool with addresses ranging from 11.11.11.100 to 11.11.11.110.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS] <strong>ds-lite instance ds-lite1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-ds-lite-instance-ds-lite1] <strong>ds-lite address-group group1 group-id 1 11.11.11.100 11.11.11.110</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-ds-lite-instance-ds-lite1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-ds-lite-instance-ds-lite1] <strong>quit</strong></pre>
</p></li><li><span>Configure DS-Lite user information.</span><ol type="a"><li class="substepexpand"><span>Configure the BRAS service to enable users to go online. For detailed configurations, see <em><span class="keyword">HUAWEI NE40E-M2 series</span> <span class="keyword">Universal Service Router</span> Configuration Guide - User Access</em>.</span><p><div class="notice"><span class="noticetitle"><img src="../../../../public_sys-resources/notice_3.0-en-us.png"> </span><div class="noticebody"><div class="p">In the IPv6 address pool view of a BRAS, the DNS server address and AFTR name must be specified. The AFTR name identifies a DS-Lite server. The following conditions must be met so that the DS-Lite tunnel between the DS-Lite device and CPE can be established:<ul><li><p>When the BRAS uses the ND mode to assign an IP address to a WAN interface on the CPE, the AFTR name and DNS information must be configured in the PD address pool. Otherwise, the DS-Lite tunnel between the DS-Lite device and CPE cannot be established.</p>
</li><li><p>After the AFTR name is configured on the BRAS, the mapping between the AFTR name and the local IP address of the DS-Lite instance must be configured on the DNS server. The DS-Lite device advertises its local IP address to the CPE.</p>
</li></ul>
</div>
</div></div>
</p></li><li class="substepexpand"><span>Configure a user group.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS] <strong>user-group group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS] <strong>commit</strong></pre>
</p></li><li class="substepexpand"><span>Specify the domain of users.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS] <strong>aaa</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-aaa] <strong>domain isp1 </strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-aaa-domain-isp1] <strong>user-group group1 bind ds-lite instance ds-lite1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-aaa-domain-isp1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-aaa] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-aaa] <strong>quit</strong></pre>
</p></li></ol>
</li><li><span>Configure a traffic diversion policy for the DS-Lite tunnel.</span><ol type="a"><li class="substepexpand"><span>Configure IPv6 ACL-based traffic classification rules.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS] <strong>acl ipv6 6001</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-acl6-ucl-6001] <strong>rule 1 permit ipv6 source user-group group1 destination ipv6-address 2001:DB8::1 128</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-acl6-ucl-6001] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-acl6-ucl-6001] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Configure a traffic classifier.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS]<strong> traffic classifier c1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-classifier-c1] <strong>if-match ipv6 acl 6001</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-classifier-c1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-classifier-c1] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Configure a traffic behavior and bind the traffic behavior to the DS-Lite instance named <strong>ds-lite1</strong>.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS]<strong> traffic behavior b1</strong> </pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-behavior-b1] <strong>ds-lite bind instance ds-lite1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-behavior-b1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-behavior-b1] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Configure a DS-Lite traffic diversion policy and associate the IPv6 ACL-based traffic classification rule with the traffic behavior.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS] <strong>traffic policy p1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-trafficpolicy-p1] <strong>classifier c1 behavior b1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-trafficpolicy-p1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-trafficpolicy-p1]<strong> quit</strong></pre>
</p></li><li class="substepexpand"><span>Apply the DS-Lite traffic diversion policy in the system view.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS] <strong>traffic-policy p1 inbound</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS] <strong>commit</strong></pre>
</p></li></ol>
</li><li><span>Bind the DS-Lite tunnel to the address pool.</span><ol type="a"><li class="substepexpand"><span>Configure the IPv6 ACL-based traffic classification rule and use the address pool named <strong>group1</strong> to translate the source addresses in the range of 2001:DB8:2::2/96 in tunnel packets.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS]<strong> acl ipv6 3000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-acl6-adv-3000] <strong>rule permit ipv6 source 2001:DB8:2::2 96</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-acl6-adv-3000] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-acl6-adv-3000] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Associate the ACL rule with the DS-Lite address pool. In the DS-Lite instance named <strong>ds-lite1</strong>, bind the IPv6 ACL numbered 3000 to the address pool named <strong>group1</strong>.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS] <strong>ds-lite instance ds-lite1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-ds-lite-instance-ds-lite1] <strong>ds-lite outbound 3000 address-group group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-ds-lite-instance-ds-lite1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-ds-lite-instance-ds-lite1] <strong>quit</strong></pre>
</p></li></ol>
</li><li><span>Configure interfaces and a routing protocol.</span><ol type="a"><li class="substepexpand"><span>Configure IS-IS.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS]<strong> isis 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-isis-100] <strong>network-entity 10.1000.1000.1000.00</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-isis-100] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-isis-100] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS]<strong> isis 1000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-isis-1000] <strong>network-entity 10.1000.1000.1002.00</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-isis-1000] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-isis-1000] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-isis-1000] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Configure the DS-Lite device's interface connected to the IPv6 network.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS]<strong> interface GigabitEthernet<span>0/2/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-GigabitEthernet<span>0/2/1</span>] <strong>ipv6 enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-GigabitEthernet<span>0/2/1</span>] <strong>isis ipv6 enable 1000</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-GigabitEthernet<span>0/2/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-GigabitEthernet<span>0/2/1</span>] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Configure the DS-Lite device's interface connected to the IPv4 network.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS] <strong>interface GigabitEthernet<span>0/2/2</span></strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-GigabitEthernet<span>0/2/2</span>] <strong>ip address 1.1.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-GigabitEthernet<span>0/2/2</span>] <strong>isis enable 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-GigabitEthernet<span>0/2/2</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-GigabitEthernet<span>0/2/2</span>] <strong>quit</strong></pre>
</p></li></ol>
</li><li><span>Enable the device to advertise the local IP route to the IPv6 network and the address pool route to the IPv4 network. Import the local IP route and address pool route to the IS-IS routing table. In this example, UNRs are used as the local IP route and address pool route.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS] <strong>isis 1000</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-isis-1000] <strong>ipv6 import-route unr</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-isis-1000] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-isis-1000] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS] <strong>isis 100</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-isis-100] <strong>import-route unr</strong></pre>
<pre class="screen">[<span class="keyword">*</span>BRAS-isis-100] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS-isis-100] <strong>quit</strong></pre>
</p></li><li><span>After the configuration is complete, the DS-Lite device can establish connections with other devices. In addition, the CPE is routable to the local IP address and the addresses in the address pool.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>BRAS] <strong>display ipv6 routing-table 2001:DB8::1</strong></pre>
<pre class="screen">Routing Table : _Public_
Summary Count : 1

 Destination  : 2001:DB8::1                         PrefixLength : 128
 NextHop      : FE80::218:82FF:FE84:CCF             Preference   : 15
 Cost         : 10                                  Protocol     : Unr
 RelayNextHop : ::                                  TunnelID     : 0x0
 Interface    : InLoopBack0                         Flags        : D   
</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172374758__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><p>DS-Lite device configuration file</p>
<pre class="screen">#                                                                               
sysname BRAS   
#
vsm on-board-mode disable
#
license
 active ds-lite vsuf slot <span>1</span>
 active nat session-table size 16 slot <span>1</span> 
<strong> </strong>active nat bandwidth-enhance 40 slot <span>1</span>
#
radius-server group rd1
 radius-server authentication 192.168.7.249 1645 weight 0
 radius-server accounting 192.168.7.249 1646 weight 0
 radius-server shared-key %^%#x*CgITP4C<font style="font-size:8pt" Face="Courier New" >~</font>;q,*+DEW'JBWe#)"Q&amp;|7bX]b:Y&lt;{w'%^%#
 radius-server type plus11
 radius-server traffic-unit kbyte
#
interface Virtual-Template1
 ppp authentication-mode auto
#
interface GigabitEthernet<span>0/2/1</span>                                                  
 undo shutdown                                                                  
 ipv6 enable                                                                    
 isis ipv6 enable 1000 
# 
interface GigabitEthernet<span>0/2/2</span>                                                  
 undo shutdown 
 ip address 1.1.1.1 255.255.255.0 
 isis enable 100    
# 
ipv6 prefix pre1 local
 prefix 2001:DB8:2::/96
#
ipv6 pool pool1 bas local
prefix pre1
dns-server 2001:DB8::1:2      //An address is assigned to an IPv6 DNS server. In a DS-Lite scenario, configuring a DNS server address in the local address pool is recommended. When the BRAS uses the ND mode to assign an IP address to a WAN interface on the CPE, the AFTR name and DNS information must be configured in the PD address pool. Otherwise, the DS-Lite tunnel cannot be established. 
aftr-name www.huawei.com         //An AFTR name is set. The AFTR name identifies a DS-Lite server. After the AFTR name is configured on the DS-Lite device, the device must advertise the configuration to the CPE. Otherwise, the DS-Lite tunnel between the CPE and DS-Lite server cannot be established. The advertisement method is to configure a mapping between the AFTR name and the local IP address of the DS-Lite tunnel on the DNS server.
#
service-location 1
 location slot <span>1</span> 
#
service-instance-group 1
 service-location 1
#   
ds-lite instance ds-lite1 id 1
 service-instance-group 1
 ds-lite address-group group1 group-id 1 11.11.11.100 11.11.11.110
 ds-lite outbound 3000 address-group group1
 local-ipv6 2001:DB8::1 prefix-length 128
 remote-ipv6 2001:DB8:2::2 prefix-length 96
# 
acl ipv6 6001
 rule 1 permit ipv6 source user-group group1 destination ipv6-address 2001:DB8::1 128
#
acl ipv6 3000
 rule permit ipv6 source 2001:DB8:2::2 96
#
dhcpv6 duid 0001000125a7625df063f9761497
#  
traffic classifier c1 operator or                                                                                                           
 if-match ipv6 acl 6001 precedence 1   
#                                                                               
traffic behavior b1
 ds-lite bind instance ds-lite1                                                             
#  
traffic policy p1                                                               
 share-mode 
 classifier c1 behavior b1 precedence 1                                                            
#                                                                               
traffic-policy p1 inbound
#
isis 100  
 network-entity 10.1000.1000.1000.00                                                                     
 import-route unr      
#                                                                               
isis 1000                                                                       
 network-entity 10.1000.1000.1002.00                                            
 #                                                                              
 ipv6 enable topology ipv6                                                  
 ipv6 import-route unr                                                          
 #
#
user-group group1
#
aaa
 authentication-scheme auth1
  authentication-mode radius
#
 accounting-scheme acct1
  accounting-mode radius
#
 domain isp1
  authentication-scheme auth1
  accounting-scheme acct1
  radius-server group rd1
  ipv6-pool pool1
  user-group group1 bind ds-lite instance ds-lite1
#          
return</pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ds-lite_cfg_0058.html">Configuration Examples for DS-Lite
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ds-lite_cfg_0060.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>