
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring EDSG Service Bandwidth Limiting Locally">
<meta name="abstract" content="This section describes how to locally configure an EDSG service policy and apply it to an AAA domain. All users in the AAA domain use the EDSG service policy to implement differentiated accounting and rate limit for users who access different subnets.">
<meta name="description" content="This section describes how to locally configure an EDSG service policy and apply it to an AAA domain. All users in the AAA domain use the EDSG service policy to implement differentiated accounting and rate limit for users who access different subnets.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_edsg_cfg_0016.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_edsg_cfg_0017.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_edsg_cfg_0018.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="EDSG">
<meta name="featuretype" content="Value-Added-Service">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EDSG">
<meta name="featuretype" content="Value-Added-Service">
<meta name="featurename" content="EDSG">
<meta name="featuretype" content="Value-Added-Service">
<meta name="featurename" content="EDSG">
<meta name="featuretype" content="Value-Added-Service">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="m00390128">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001138599523">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring EDSG Service Bandwidth Limiting Locally</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001138599523"></a><a name="EN-US_TASK_0000001138599523"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring EDSG Service Bandwidth Limiting Locally</h1>
<div class="taskbody"><p>This section describes how to locally configure an EDSG service policy and apply it to an AAA domain. All users in the AAA domain use the EDSG service policy to implement differentiated accounting and rate limit for users who access different subnets.</p>
<div class="context"><a name="EN-US_TASK_0000001138599523__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0000001138599523__fig_dc_ne_cfg_edsg_000801">Figure 1</a>, PPPoE users go online from domain1. PPPoE users' traffic fees and bandwidth requirements for accessing network 1 (192.168.100.0/24) and network 2 (192.168.200.0/24) differ greatly. The upstream and downstream bandwidths for accessing network 1 are limited to 1 Mbit/s, and those for accessing network 2 are limited to 2 Mbit/s.</p>
<div class="fignone" id="EN-US_TASK_0000001138599523__fig_dc_ne_cfg_edsg_000801"><a name="EN-US_TASK_0000001138599523__fig_dc_ne_cfg_edsg_000801"></a><a name="fig_dc_ne_cfg_edsg_000801"></a><span class="figcap"><b>Figure 1 </b>EDSG service networking</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1, interface2, interface3, subinterface3.1, and subinterface3.2 represent GE<span>0/1/2</span>, GE<span>0/1/1</span>, GE<span>0/1/0</span>, GE<span>0/1/0</span>.1, and GE<span>0/1/0</span>.2, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001091577708.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001138599523__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><div class="p">The configuration roadmap is as follows:<ol><li>Enable the VAS function.</li><li>Configure a RADIUS server.</li><li>Configure an EDSG traffic policy.</li><li>Configure AAA authentication and accounting schemes.</li><li>Configure a mode in which EDSG service policies are downloaded.</li><li>Configure EDSG service policies.</li><li>Configure a service policy group.</li><li>Configure a local address pool.</li><li>Configure an AAA domain.</li><li>Configure interfaces.</li></ol>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001138599523__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><div class="p">To complete the configuration, you need the following data:<ul><li><p>Parameters related to the RADIUS server, including the IP address and port number.</p>
</li><li><p>EDSG traffic policy parameters, such as the service group name, ACL rule, traffic classifier, traffic behavior, and traffic policy</p>
</li><li><p>RADIUS server group name, IP address and port number of a RADIUS authentication server, and IP address and port number of a RADIUS accounting server used for an EDSG service policy</p>
</li><li><p>Authentication scheme name, authentication mode, accounting scheme name, and accounting mode used for an EDSG service policy</p>
</li><li><p>EDSG service policy parameters, such as the mode in which EDSG service policies are downloaded, EDSG service policy name, name of the bound RADIUS server group, authentication scheme, accounting scheme, and bandwidths for uplink and downlink traffic rate limiting for EDSG services</p>
</li><li>Name of the service policy group bound to the domain, name of the local address pool, gateway, and range of the user address pool.</li></ul>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001138599523__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enable the VAS function.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>value-added-service enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
</p></li><li><span>Configure policy servers.</span><p><p># Set the RADIUS server group name to <strong>rad_group1</strong>, the RADIUS authentication server's IP address and port number to 10.10.10.2 and 1812, the RADIUS accounting server's IP address and port number to 10.10.10.2 and 1813, and the shared key for the RADIUS authentication and accounting servers to <strong>YsHsjx_202206</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>radius-server group rad_group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-radius-rad_group1] <strong>radius-server shared-key-cipher YsHsjx_202206</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-radius-rad_group1] <strong>radius-server authentication 10.10.10.2 1812</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-radius-rad_group1] <strong>radius-server accounting 10.10.10.2 1813</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-radius-rad_group1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-radius-rad_group1] <strong>quit</strong></pre>
</p></li><li><span>Configure an EDSG traffic policy.</span><ol type="a"><li class="substepexpand"><span>Create service groups.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>service-group s_1m</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>service-group s_2m</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
</p></li><li class="substepexpand"><span>Configure ACL rules for service groups.</span><p><p># Configure ACL 6020 and define ACL rules for the service group <strong>s_1m</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>acl number 6020</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl-ucl-6020] <strong>rule 10 permit ip source service-group s_1m destination ip-address 192.168.100.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl-ucl-6020] <strong>rule 11 permit ip source ip-address 192.168.100.0 0.0.0.255 destination service-group s_1m</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl-ucl-6020] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-acl-ucl-6020] <strong>quit</strong></pre>
<p># Configure ACL 6021 and define ACL rules for the service group <strong>s_2m</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>acl number 6021</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl-ucl-6021] <strong>rule 15 permit ip source service-group s_2m destination ip-address 192.168.200.0 0.0.0.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl-ucl-6021] <strong>rule 16 permit ip source ip-address 192.168.200.0 0.0.0.255 destination service-group s_2m</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl-ucl-6021] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-acl-ucl-6021] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Configure traffic classifiers.</span><p><p># Configure a traffic classifier named <strong>c1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>traffic classifier c1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-classifier-c1] <strong>if-match acl 6020</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-classifier-c1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-classifier-c1] <strong>quit</strong></pre>
<p># Configure a traffic classifier named <strong>c2</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>traffic classifier c2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-classifier-c2] <strong>if-match acl 6021</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-classifier-c2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-classifier-c2] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Configure traffic behaviors.</span><p><p># Configure a traffic behavior named <strong>b1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>traffic behavior b1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-behavior-b1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-behavior-b1] <strong>quit</strong></pre>
<p># Configure a traffic behavior named <strong>b2</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>traffic behavior b2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-behavior-b2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-behavior-b2] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Configure an EDSG traffic policy.</span><p><p># Configure an EDSG traffic policy named <strong>traffic_policy_edsg</strong>, and associate traffic classifiers <strong>c1</strong> and <strong>c2</strong> with traffic behaviors <strong>b1</strong> and <strong>b2</strong>, respectively.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>traffic policy traffic_policy_edsg</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-policy-traffic_policy_edsg] <strong>share-mode</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-policy-traffic_policy_edsg] <strong>classifier c1 behavior b1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-policy-traffic_policy_edsg] <strong>classifier c2 behavior b2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-policy-traffic_policy_edsg] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-policy-traffic_policy_edsg] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Apply the EDSG traffic policy globally.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>traffic-policy traffic_policy_edsg inbound</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>traffic-policy traffic_policy_edsg outbound</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
</p></li></ol>
</li><li><span>Configure AAA authentication and accounting schemes.</span><p><p># Configure two AAA authentication schemes, one with the authentication mode set to RADIUS, and that of the other one set to none.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>aaa</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-aaa] <strong>authentication-scheme auth1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-aaa-authen-auth1] <strong>authentication-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-aaa-authen-auth1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-aaa-authen-auth1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-aaa] <strong>authentication-scheme none</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-aaa-authen-none] <strong>authentication-mode none</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-aaa-authen-none] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-aaa-authen-none] <strong>quit</strong></pre>
</p><p><p># Configure an AAA accounting scheme named <strong>acct1</strong> and specify RADIUS accounting as the accounting mode.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-aaa] <strong>accounting-scheme acct1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-aaa-accounting-acct1] <strong>accounting-mode radius</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-aaa-accounting-acct1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-aaa-accounting-acct1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-aaa] <strong>quit</strong></pre>
</p></li><li><span>Configure the mode in which EDSG service policies are downloaded as local download.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>service-policy download local</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
</p></li><li><span>Configure EDSG service policies.</span><ol type="a"><li class="substepexpand"><span>Configure an EDSG service policy for access to network 1.</span><p><p># Create an EDSG service policy named <strong>service_edsg1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>service-policy name service_edsg1 edsg</strong></pre>
<p># Bind the service group <strong>s_1m</strong> to the EDSG service policy <strong>service_edsg1</strong>.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-service-policy-service_edsg1] <strong>service-group s_1m</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-service-policy-service_edsg1] <strong>commit</strong></pre>
<p># Bind the RADIUS server group <strong>rad_group1</strong> to the EDSG service policy <strong>service_edsg1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-service-policy-service_edsg1] <strong>radius-server group rad_group1</strong></pre>
<p># Bind the authentication scheme <strong>none</strong> to the EDSG service policy <strong>service_edsg1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-service-policy-service_edsg1] <strong>authentication-scheme none</strong></pre>
<p># Bind the accounting scheme <strong>acct1</strong> to the EDSG service policy <strong>service_edsg1</strong>.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-service-policy-service_edsg1] <strong>accounting-scheme acct1</strong></pre>
<p># Set the bandwidth for uplink traffic rate limit to 1 Mbit/s for the EDSG service policy <strong>service_edsg1</strong>.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-service-policy-service_edsg1] <strong>rate-limit cir 1000 inbound</strong></pre>
<p># Set the bandwidth for downlink traffic rate limit to 1 Mbit/s for the EDSG service policy <strong>service_edsg1</strong>.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-service-policy-service_edsg1] <strong>rate-limit cir 1000 outbound</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-service-policy-service_edsg1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-service-policy-service_edsg1] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Configure an EDSG service policy for access to network 2.</span><p><p># Create an EDSG service policy named <strong>service_edsg2</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>service-policy name service_edsg2 edsg</strong></pre>
<p># Bind the service group <strong>s_2m</strong> to the EDSG service policy <strong>service_edsg2</strong>.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-service-policy-service_edsg2] <strong>service-group s_2m</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-service-policy-service_edsg2] <strong>commit</strong></pre>
<p># Bind the RADIUS server group <strong>rad_group1</strong> to the EDSG service policy <strong>service_edsg2</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-service-policy-service_edsg2] <strong>radius-server group rad_group1</strong></pre>
<p># Bind the authentication scheme <strong>auth1</strong> to the EDSG service policy <strong>service_edsg2</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-service-policy-service_edsg2] <strong>authentication-scheme auth1</strong></pre>
<p># Bind the accounting scheme <strong>acct1</strong> to the EDSG service policy <strong>service_edsg2</strong>.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-service-policy-service_edsg2] <strong>accounting-scheme acct1</strong></pre>
<p># Set the bandwidth for uplink traffic rate limit to 2 Mbit/s for the EDSG service policy <strong>service_edsg2</strong>.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-service-policy-service_edsg2] <strong>rate-limit cir 2000 inbound</strong></pre>
<p># Set the bandwidth for downlink traffic rate limit to 2 Mbit/s for the EDSG service policy <strong>service_edsg2</strong>.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-service-policy-service_edsg2] <strong>rate-limit cir 2000 outbound</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-service-policy-service_edsg2] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-service-policy-service_edsg2] <strong>quit</strong></pre>
</p></li></ol>
</li><li><span>Configure a service policy group.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>service-policy-group</strong><strong> group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-service-policy-group-group1] <strong>service-policy service_edsg1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-service-policy-group-group1] <strong>service-policy service_edsg2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-service-policy-group-group1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-service-policy-group-group1] <strong>quit</strong></pre>
</p></li><li><span>Configure a local address pool.</span><p><p># Configure a local address pool named <strong>edsg_pool</strong>, set the gateway address to 172.31.0.1/16, and specify the address range as 172.31.0.2 to 172.31.255.255.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ip pool edsg_pool bas local</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-ip-pool-edsg_pool] <strong>gateway 172.31.0.1 255.255.0.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-ip-pool-edsg_pool] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-ip-pool-edsg_pool] <strong>section 0 172.31.0.2 172.31.255.255</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-ip-pool-edsg_pool] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
</p></li><li><span>Bind the local address pool and RADIUS server group to an AAA domain.</span><p><p># Bind the local address pool <strong>edsg_pool</strong>, RADIUS server group <strong>rad_group1</strong>, and service policy group <strong>group1</strong> to the AAA domain.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>aaa</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-aaa] <strong>domain domain1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-aaa-domain-domain1] <strong>ip-pool edsg_pool</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-aaa-domain-domain1] <strong>radius-server group rad_group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-aaa-domain-domain1] <strong>service-policy-group group1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-aaa-domain-domain1] <strong>authentication-scheme auth1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-aaa-domain-domain1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-aaa] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-aaa] <strong>quit</strong></pre>
</p></li><li><span>Configure interfaces.</span><ol type="a"><li class="substepexpand"><span>Configure a BAS interface.</span><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>For details about how to configure a BAS interface, see <a href="dc_ne_pppoe_cfg_0013.html">Example for Configuring PPPoE Access for IPv4 Users</a> in <em><span class="keyword">HUAWEI NE40E-M2 series</span> Configuration Guide - User Access</em>.</p>
</div></div>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>interface GigabitEthernet<span>0/1/2</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/2</span>.1] <strong>user-vlan 1000 2000</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/2</span>.1] <strong>user-vlan 1 1000 qinq 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/2</span>.1] <strong>bas</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/2</span>.1-bas] <strong>access-type layer2-subscriber default-domain pre-authentication domain1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/2</span>.1-bas] <strong>authentication-method ppp web</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/2</span>.1-bas] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet1<span>0/1/2</span>.1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-GigabitEthernet1<span>0/1/2</span>.1] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Configure an uplink interface.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>interface GigabitEthernet<span>0/1/0</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/0</span>.1] <strong>vlan-type dot1q 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/0</span>.1] <strong>ip address 192.168.100.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/0</span>.1] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/0</span>.1] <strong>quit</strong></pre>
</p></li><li class="substepexpand"><span>Configure the interface connecting the BRAS to the policy server, AAA server, and portal server.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>interface GigabitEthernet<span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/1</span>] <strong>ip address 10.10.10.1 255.255.255.0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/1</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
</p></li></ol>
</li><li><span>Verify the configuration. </span><p><p># Check the ID of the online user.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>display value-added-service user edsg</strong></pre>
<pre class="screen">The used user id table are:
   128000
</pre>
<p># View the service group name and service status information of the user with an ID of 128000.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>display value-added-service user user-id 128000 edsg </strong></pre>
<pre class="screen">-------------------------------------------------------                        
  User access index                  : 128000                                    
  User name                          : user1                                  
 -------------------------------------------------------                        
  Traffic rate mode                  : Separate                                 
  Traffic statistic mode             : Separate                                 
  Inbound rate limit mode            : Car                                      
  Outbound rate limit mode           : Car                                      
  Service change mode                : Stop-start                               
 -------------------------------------------------------                        
  User edsg service table:                                                       
 -------------------------------------------------------                        
  Index          Service name        State                                      
 -------------------------------------------------------                        
  0                service_edsg1       Active                                     
  1                service_edsg2       Active                                     
 -------------------------------------------------------
</pre>
<p># View detailed information about the EDSG service with a service index of 0 and a user ID of 128000.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>display value-added-service user user-id 128000 edsg service-index 0</strong></pre>
<pre class="screen">-------------------------------------------------------
  Service index                      : 0
  Service name                       : service_edsg1
  Service type                       : EDSG
  Service state                      : Active
  Service group                      : s_1m
  Service group priority             : 0
  Authentication method              : None
  Account method                     : Radius
  Radius server template             : rad_group1
  Account session id                 : <span class="keyword">HUAWEI</span>05001SSG000100d39d7b128000
  Service online time(HH:MM:SS)      : 00:04:36
  Up committed information rate      : 1000(kbps)
  Up Peak information rate           : 1000(kbps)
  Up committed burst size            : 187000(bytes)
  Up Peak burst size                 : 187000(bytes)
  Down committed information rate    : 1000(kbps)
  Down Peak information rate         : 1000(kbps)
  Down committed burst size          : 187000(bytes)
  Down Peak burst size               : 187000(bytes)
  Up flow packets(high, low)         : (0, 0)
  Up flow bytes(high, low)           : (0, 0)
  Down flow packets(high, low)       : (0, 0)
  Down flow bytes(high, low)         : (0, 0)
 ----------------------------------------------
</pre>
<p># View traffic information of the online user.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>display access-user domain domain1 verbose</strong></pre>
<pre class="screen">-------------------------------------------------------------------
Active EDSG services by order:
 Service0 info : service_edsg1
 Service1 info : service_edsg2

Flow Statistic:
  If flow info contain l2-head : Yes
  Flow-Statistic-Up : Yes
  Flow-Statistic-Down : Yes
  Up packets number(high,low) : (0,0)
  Up bytes number(high,low) : (0,0)
  Down packets number(high,low) : (0,0)
  Down bytes number(high,low) : (0,0)
  IPV6 Up packets number(high,low) : (0,0)
  IPV6 Up bytes number(high,low) : (0,0)
  IPV6 Down packets number(high,low) : (0,0)
  IPV6 Down bytes number(high,low) : (0,0)

Value-added-service Flow Statistic:
  EDSG(service0) Up packets number(high,low) : (0,0)
  EDSG(service0) Up bytes number(high,low) : (0,0)
  EDSG(service0) Down packets number(high,low) : (0,0)
  EDSG(service0) Down bytes number(high,low) : (0,0)
  EDSG(service1) Up packets number(high,low) : (0,0)
  EDSG(service1) Up bytes number(high,low) : (0,0)
  EDSG(service1) Down packets number(high,low) : (0,0)
  EDSG(service1) Down bytes number(high,low) : (0,0)</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001138599523__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><p><span class="keyword">HUAWEI</span> configuration file</p>
<pre class="screen">#
sysname <span class="keyword">HUAWEI</span>
#
value-added-service enable
#
service-policy download local
#
radius-server group rad_group1
 radius-server authentication 10.10.10.2 1812 weight 0
 radius-server accounting 10.10.10.2 1813 weight 0
 radius-server shared-key-cipher %^%#x*CgITP4C<font style="font-size:8pt" Face="Courier New" >~</font>;q,*+DEW'JBWe#)"Q&amp;|7bX]b:Y&lt;{w'%^%#    
#
ip pool edsg_pool bas local
 gateway 172.31.0.1 255.255.0.0
 section 0 172.31.0.2 172.31.255.255
#
service-policy name service_edsg1 edsg
 radius-server group rad_group1
 service-group s_1m
 authentication-scheme none
 accounting-scheme acct1
 rate-limit cir 1000 inbound
 rate-limit cir 1000 outbound
#
service-policy name service_edsg2 edsg
 radius-server group rad_group1
 service-group s_2m
 authentication-scheme auth1
 accounting-scheme acct1
 rate-limit cir 2000 inbound
 rate-limit cir 2000 outbound
#
service-policy-group group1
 service-policy service_edsg1
 service-policy service_edsg2
#
aaa
 authentication-scheme auth1
  authentication-mode radius
 authentication-scheme none
  authentication-mode none
 accounting-scheme acct1
  accounting-mode radius
 domain domain1
  ip-pool edsg_pool
  radius-server group rad_group1
  service-policy-group group1
  authentication-scheme auth1
#
service-group s_1m
service-group s_2m
#
acl number 6020
 rule 10 permit ip source service-group s_1m destination ip-address 192.168.100.0 0.0.0.255
 rule 11 permit ip source ip-address 192.168.100.0 0.0.0.255 destination service-group s_1m
#
acl number 6021
 rule 15 permit ip source service-group s_2m destination ip-address 192.168.200.0 0.0.0.255
 rule 16 permit ip source ip-address 192.168.200.0 0.0.0.255 destination service-group s_2m
#
traffic classifier c1 operator or
 if-match acl 6020 precedence 1
#
traffic classifier c2 operator or
 if-match acl 6021 precedence 1
#
traffic behavior b1
#
traffic behavior b2
#
traffic policy traffic_policy_edsg           
 share-mode
 classifier c1 behavior b1 precedence 1
 classifier c2 behavior b2 precedence 2
#
traffic-policy traffic_policy_edsg inbound
traffic-policy traffic_policy_edsg outbound
#
interface GigabitEthernet<span>0/1/0</span>.1
 vlan-type dot1q 1
 ip address 192.168.100.1 255.255.255.0
#
interface GigabitEthernet<span>0/1/1</span>
 ip address 10.10.10.1 255.255.255.0
#
<span>interface GigabitEthernet<span>0/1/2</span>.1</span>
 user-vlan 1000 2000
 user-vlan 1 1000 qinq 100
 bas
  access-type layer2-subscriber default-domain pre-authentication domain1
  authentication-method ppp web
#
return
</pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_edsg_cfg_0016.html">EDSG Configuration Examples
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_edsg_cfg_0017.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_edsg_cfg_0018.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>