
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Static BGP Flow Specification">
<meta name="abstract" content="BGP Flow Specification routes are generated manually to control traffic in static BGP Flow Specification.">
<meta name="description" content="BGP Flow Specification routes are generated manually to control traffic in static BGP Flow Specification.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_flowspec_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_flowspec_cfg_0004.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_flowspec_cfg_0005.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BGP Flow Specfication">
<meta name="featuretype" content="Security">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP Flow Specfication">
<meta name="featuretype" content="Security">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00799643">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172372345">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring Static BGP Flow Specification</title>
</head>
<body><a name="EN-US_TASK_0172372345"></a><a name="EN-US_TASK_0172372345"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Static BGP Flow Specification</h1>
<div class="taskbody"><p>BGP Flow Specification routes are generated manually to control traffic in static BGP Flow Specification.</p>
<div class="context"><a name="EN-US_TASK_0172372345__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>When static BGP Flow Specification is configured, a BGP Flow Specification route needs to be generated manually, and a BGP Flow Specification peer relationship needs to be established between the device that generates the BGP Flow Specification route and each ingress on the network to advertise BGP Flow Specification routes.</p>
<p>In an AS with multiple ingresses, a BGP Flow route reflector (Flow RR) can be deployed to reduce the number of BGP Flow Specification peer relationships to be established and save network resources.</p>
<p>If you want to filter traffic matching a specified address prefix but BGP Flow Specification routes matching the specified address prefix cannot pass validation, disable the validation of the BGP Flow Specification routes received from a specified peer.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172372345__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring static BGP Flow Specification, <a href="dc_vrp_bgp_cfg_3006.html">configure a BGP peer</a>.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172372345__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Create a BGP Flow Specification route manually.</span><ol type="a"><li class="substepexpand"><span>Run the <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> command to enter the system view.</span></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=flow-route"><b><span class="cmdname">flow-route</span></b></a> <i><span class="varname">flowroute-name</span></i> command to create a static BGP Flow Specification route and enter the Flow-Route view.</span><p><div class="p">One BGP Flow Specification route can include multiple <strong>if-match</strong> and <strong>apply</strong> clauses. <strong>if-match</strong> clauses define traffic filtering rules, and <strong>apply</strong> clauses define traffic behaviors. The relationships among clauses are as follows:<ul><li><p>The relationship among <strong>if-match</strong> clauses of different types is "AND."</p>
</li><li><p>If <strong>if-match</strong> clauses of the same type are configured repeatedly, some rules override each other, and some other rules are in the OR relationship. For details, see the precautions for the <a href="cmdqueryname=if-match"><b><span class="cmdname">if-match</span></b></a> command.</p>
</li><li><p>The relationship among the traffic behaviors defined by <strong>apply</strong> clauses is "AND."</p>
</li></ul>
The traffic behaviors defined by<strong> apply</strong> clauses apply to all traffic matching the filtering rules of <strong>if-match</strong> clauses.</div>
</p></li><li class="substepexpand"><span>According to characteristics of the traffic to be controlled, you can configure one or more <strong>if-match</strong> clauses to define traffic filtering rules as needed:</span><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p><strong>if-match</strong> clauses take effect only when both the local and peer devices support the corresponding if-match rules.</p>
</div></div>
</p><p><ul><li><p>To set a destination address-based traffic filtering rule, run the <a href="cmdqueryname=if-match+destination"><b><span class="cmdname">if-match destination</span></b></a> <i><span class="varname">ipv4-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } command.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Traffic control is performed based on a specified destination IP address specified in a rule configured using the <a href="cmdqueryname=if-match+destination"><b><span class="cmdname">if-match destination</span></b></a> command, but BGP Flow Specification routes matching the rule cannot pass validation. In this situation, run the <a href="cmdqueryname=peer+validation-disable"><b><span class="cmdname">peer validation-disable</span></b></a> command to disable the validation.</p>
<p>By default, 0.0.0.0/0 is used as the prefix of each BGP Flow Specification route that matches the export or import policy configured for a peer. To enable a device to change the prefix of each BGP Flow Specification route that matches the export or import policy configured for a peer to the destination IP address specified in the <a href="cmdqueryname=if-match+destination"><b><span class="cmdname">if-match destination</span></b></a> command, run the <a href="cmdqueryname=route+match-destination"><b><span class="cmdname">route match-destination</span></b></a> command.</p>
</div></div>
</li><li>To set a destination community attribute-based traffic filtering rule:<ol class="substepthirdol"><li>To control the range of destination community attribute-based traffic filtering rules that can take effect, run the <a href="cmdqueryname=match-community+community-list"><b><span class="cmdname">match-community community-list</span></b></a> <em><i><span class="varname">community-list-name</span></i></em> command.<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Before you run the <a href="cmdqueryname=match-community+community-list"><b><span class="cmdname">match-community community-list</span></b></a> <em><i><span class="varname">community-list-name</span></i></em> command to control the range of destination community attribute-based traffic filtering rules that can take effect, run the <a href="cmdqueryname=ip+community-list"><b><span class="cmdname">ip community-list</span></b></a> command to create a BGP community list, and run the <a href="cmdqueryname=community"><b><span class="cmdname">community</span></b></a> command to configure community attributes for the BGP community list.</p>
</div></div>
</li><li>To set a destination community attribute-based traffic filtering rule, run the <a href="cmdqueryname=if-match+destination-community+community-list"><b><span class="cmdname">if-match destination-community</span></b></a> <i><span class="varname">community-value</span></i> command. The traffic filtering rule specified using <em>community-value</em> in this command takes effect only when it is in the range of destination community attribute-based traffic filtering rules configured using <strong><span>community-list</span></strong> <em>community-list-name</em>.</li></ol>
<p>If you want to control traffic based on an address prefix, run the <a href="cmdqueryname=if-match+destination"><b><span class="cmdname">if-match destination</span></b></a> command to configure a destination address-based traffic filtering rule. However, if there are a large number of routes of the same type, configuring destination address-based traffic filtering rules one by one for traffic control is complex and consumes many resources. To address this issue, you can configure traffic filtering through destination community attribute aggregation.</p>
<p>After the configuration is complete, run the <a href="cmdqueryname=display+bgp+flow+routing-table+destination-community"><b><span class="cmdname">display bgp flow routing-table</span></b></a> <i><span class="varname">reIndex</span></i> <strong><span>destination-community</span></strong> command to check details about the traffic filtering rule that is based on the community attribute of the destination IP address in a BGP Flow Specification route.</p>
</li><li><p>To set a source address-based traffic filtering rule, run the <a href="cmdqueryname=if-match+source"><b><span class="cmdname">if-match source</span></b></a> <i><span class="varname">ipv4-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } command.</p>
</li><li><p>To set a port number-based traffic filtering rule, run the <a href="cmdqueryname=if-match+port+greater-than+less-than+equal"><b><span class="cmdname">if-match port</span></b></a> { <strong><span>greater-than</span></strong> | <strong><span>less-than</span></strong> | <strong><span>equal</span></strong> } <i><span class="varname">port</span></i> or <a href="cmdqueryname=if-match+port+greater-than+less-than"><b><span class="cmdname">if-match port</span></b></a> <strong><span>greater-than</span></strong> <i><span class="varname">port</span></i> <strong><span>less-than</span></strong> <i><span class="varname">upper-port-value</span></i> command.</p>
</li><li><p>To set a source port number-based traffic filtering rule, run the <a href="cmdqueryname=if-match+source-port+greater-than+less-than+equal"><b><span class="cmdname">if-match source-port</span></b></a> { <strong><span>greater-than</span></strong> | <strong><span>less-than</span></strong> | <strong><span>equal</span></strong> } <i><span class="varname">port</span></i> or <a href="cmdqueryname=if-match+source-port+greater-than+less-than"><b><span class="cmdname">if-match source-port</span></b></a> <strong><span>greater-than</span></strong> <i><span class="varname">source-port</span></i> <strong><span>less-than</span></strong> <i><span class="varname">upper-source-port-value</span></i> command.</p>
</li><li><div class="p">To set a destination port number-based traffic filtering rule, run the <a href="cmdqueryname=if-match+destination-port+greater-than+less-than+equal"><b><span class="cmdname">if-match destination-port</span></b></a> { <strong><span>greater-than</span></strong> | <strong><span>less-than</span></strong> | <strong><span>equal</span></strong> } <i><span class="varname">port</span></i> or <a href="cmdqueryname=if-match+destination-port+greater-than+less-than"><b><span class="cmdname">if-match destination-port greater-than </span></b></a><i><span class="varname">port</span></i> <strong><span>less-than</span></strong> <i><span class="varname">upper-port-value</span></i> command.<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The <a href="cmdqueryname=if-match+port"><b><span class="cmdname">if-match port</span></b></a> command is mutually exclusive with the <a href="cmdqueryname=if-match+destination-port"><b><span class="cmdname">if-match destination-port</span></b></a> or <a href="cmdqueryname=if-match+source-port"><b><span class="cmdname">if-match source-port</span></b></a> command.</p>
</div></div>
</div>
</li><li><p>To set a traffic bearing protocol-based traffic filtering rule, run the <a href="cmdqueryname=if-match+protocol+greater-than+less-than+equal"><b><span class="cmdname">if-match protocol</span></b></a> { <strong><span>greater-than</span></strong> | <strong><span>less-than</span></strong> | <strong><span>equal</span></strong> } <i><span class="varname">protocol</span></i> or <a href="cmdqueryname=if-match+protocol+greater-than+less-than"><b><span class="cmdname">if-match protocol</span></b></a> <strong><span>greater-than</span></strong> <i><span class="varname">protocol</span></i> <strong><span>less-than</span></strong> <i><span class="varname">upper-protocol-value</span></i> command.</p>
</li><li><p>To set a DSCP-based traffic filtering rule, run the <a href="cmdqueryname=if-match+dscp+greater-than+less-than+equal"><b><span class="cmdname">if-match dscp</span></b></a> { <strong><span>greater-than</span></strong> | <strong><span>less-than</span></strong> | <strong><span>equal</span></strong> } <i><span class="varname">dscp</span></i> or <a href="cmdqueryname=if-match+dscp+greater-than+less-than"><b><span class="cmdname">if-match dscp</span></b></a> <strong><span>greater-than</span></strong> <i><span class="varname">dscp</span></i> <strong><span>less-than</span></strong> <i><span class="varname">upper-dscp-value</span></i> command.</p>
</li><li><p>To set a TCP-flag value-based traffic filtering rule, run the <a href="cmdqueryname=if-match+tcp-flags+match+not"><b><span class="cmdname">if-match tcp-flags</span></b></a> { <strong><span>match</span></strong> | <strong><span>not</span></strong> | <strong><span>any-match</span></strong> } <i><span class="varname">tcp-flags</span></i> command.</p>
<p>Network attackers may send a large number of invalid TCP packets to attack network devices. To control the unidirectional traffic of TCP packets to ensure communication security, configure a filtering rule based on the TCP flag for the BGP Flow Specification route using the <a href="cmdqueryname=if-match+tcp-flags"><b><span class="cmdname">if-match tcp-flags</span></b></a> command. The traffic behavior specified in the <strong>apply</strong> clause applies to the traffic that matches the TCP flag value.</p>
</li><li><p>To set a fragment type-based traffic filtering rule, run the <a href="cmdqueryname=if-match+fragment-type+match+not"><b><span class="cmdname">if-match fragment-type</span></b></a> { <strong><span>match</span></strong> | <strong><span>not</span></strong> } <i><span class="varname">fragment-type-name</span></i> command.</p>
</li><li><p>To set an ICMP message code-based traffic filtering rule, run the <a href="cmdqueryname=if-match+icmp-code+greater-than+less-than+equal"><b><span class="cmdname">if-match icmp-code</span></b></a> { <strong><span>greater-than</span></strong> | <strong><span>less-than</span></strong> | <strong><span>equal</span></strong> } <i><span class="varname">icmp-code</span></i> or <a href="cmdqueryname=if-match+icmp-code+greater-than+less-than"><b><span class="cmdname">if-match icmp-code</span></b></a> <strong><span>greater-than</span></strong> <i><span class="varname">icmp-code</span></i> <strong><span>less-than</span></strong> <i><span class="varname">upper-icmp-code-value</span></i> command.</p>
</li><li><p>To set an ICMP message type-based traffic filtering rule, run the <a href="cmdqueryname=if-match+icmp-type+greater-than+less-than+equal"><b><span class="cmdname">if-match icmp-type</span></b></a> { <strong><span>greater-than</span></strong> | <strong><span>less-than</span></strong> | <strong><span>equal</span></strong> } <i><span class="varname">icmp-type</span></i> or <a href="cmdqueryname=if-match+icmp-type+greater-than+less-than"><b><span class="cmdname">if-match icmp-type</span></b></a> <strong><span>greater-than</span></strong> <i><span class="varname">icmp-type</span></i> <strong><span>less-than</span></strong> <i><span class="varname">upper-icmp-type-value</span></i> command.</p>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><caption><b>Table 1 </b><i><span class="varname">icmp-type</span></i> and <i><span class="varname">icmp-code</span></i> values corresponding to ICMP message names</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1" liSelected="liSelected"><p><i><span class="varname">icmp-name</span></i></p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2" liSelected="liSelected"><p><i><span class="varname">icmp-type</span></i></p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3" liSelected="liSelected"><p><i><span class="varname">icmp-code</span></i></p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Echo</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>8</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>0</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Echo-reply</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>0</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>0</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Parameter-problem</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>12</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>0</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Port-unreachable</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>3</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>3</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Protocol-unreachable</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>3</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>2</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Reassembly-timeout</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>11</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>1</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Source-quench</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>4</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>0</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Source-route-failed</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>3</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>5</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Timestamp-reply</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>14</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>0</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Timestamp-request</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>13</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>0</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Ttl-exceeded</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>11</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>0</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Fragmentneed-DFset</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>3</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>4</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Host-redirect</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>5</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>1</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Host-tos-redirect</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>5</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>3</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Host-unreachable</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>3</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>1</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Information-reply</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>16</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>0</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Information-request</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>15</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>0</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Net-redirect</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>5</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>0</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Net-tos-redirect</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>5</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>2</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.1 "><p>Net-unreachable</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.2 "><p>3</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.4.3.1.2.3.3.1.12.2.2.4.1.3 "><p>0</p>
</td>
</tr>
</tbody>
</table>
</div>
</li><li><p>To set a filtering rule based on the packet length of a BGP Flow Specification route, run the <a href="cmdqueryname=if-match+packet-length+greater-than+less-than+equal"><b><span class="cmdname">if-match packet-length</span></b></a> { <strong><span>greater-than</span></strong> | <strong><span>less-than</span></strong> | <strong><span>equal</span></strong> } <i><span class="varname">packet-length-value</span></i> or <a href="cmdqueryname=if-match+packet-length+greater-than+less-than"><b><span class="cmdname">if-match packet-length</span></b></a> <strong><span>greater-than</span></strong> <i><span class="varname">packet-length-value</span></i> <strong><span>less-than</span></strong> <i><span class="varname">upper-packet-length-value</span></i> command.</p>
</li></ul>
</p></li><li class="substepexpand"><span>Run the following command as required to configure actions for <strong>apply</strong> clauses:</span><p><ul><li><p>To discard the matched traffic, run the <a href="cmdqueryname=apply+deny"><b><span class="cmdname">apply deny</span></b></a> command. The <a href="cmdqueryname=apply+deny"><b><span class="cmdname">apply deny</span></b></a> and <a href="cmdqueryname=apply+traffic-rate"><b><span class="cmdname">apply traffic-rate</span></b></a> commands cannot be used together.</p>
</li><li><p>To redirect the matched traffic to the traffic cleaning device or blackhole, run the <a href="cmdqueryname=apply+redirect+vpn-target+ip"><b><span class="cmdname">apply redirect</span></b></a> { <strong><span>vpn-target</span></strong> <i><span class="varname">vpn-target-import</span></i> | <strong><span>ip</span></strong> <i><span class="varname">redirect-ip-rt</span></i> } command.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The device can process the redirection next hop attribute configured using the <a href="cmdqueryname=apply+redirect+ip"><b><span class="cmdname">apply redirect</span></b></a> <strong><span>ip</span></strong> <i><span class="varname">redirect-ip-rt</span></i> command received from a peer only after the <a href="cmdqueryname=peer+redirect+ip"><b><span class="cmdname">peer redirect ip</span></b></a> command is run.</p>
<p>The device can process the redirection next hop attribute configured using the <a href="cmdqueryname=apply+redirect+ip+color"><b><span class="cmdname">apply redirect</span></b></a> <strong><span>ip</span></strong> <i><span class="varname">redirect-ip-rt</span></i> <strong><span>color</span></strong> <i><span class="varname">colorvalue</span></i> command received from a peer only after the <a href="cmdqueryname=peer+redirect+ip"><b><span class="cmdname">peer redirect ip</span></b></a> command is run.</p>
<p>The redirection load balancing function can be enabled on the device only after the <a href="cmdqueryname=redirect+load-balancing"><b><span class="cmdname">redirect load-balancing</span></b></a> command is run. A maximum of eight redirection routes can be used for load balancing.</p>
</div></div>
</li><li><p>To redirect the matched traffic to an SR-MPLS TE Policy, run the <a href="cmdqueryname=apply+redirect+ip+color"><b><span class="cmdname">apply redirect</span></b></a> <strong><span>ip</span></strong> <i><span class="varname">redirect-ip-rt</span></i> <strong><span>color</span></strong> <i><span class="varname">colorvalue</span></i> command.</p>
</li><li>To redirect the matched traffic to the IPv6 address of a specified next hop, run the <a href="cmdqueryname=apply+redirect+ipv6"><b><span class="cmdname">apply redirect ipv6</span></b></a> <i><span class="varname">redirect-ipv6-rt</span></i> command.<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>A device can process the redirection next-hop attribute configured using the <a href="cmdqueryname=apply+redirect+ipv6"><b><span class="cmdname">apply redirect</span></b></a> <strong><span>ipv6</span></strong> <i><span class="varname">redirect-ipv6-rt</span></i> command and carried in the routes that are received from peers only after the <strong><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> </strong><em>ipv4-address</em> <a href="cmdqueryname=redirect+ipv6"><b><span class="cmdname">redirect ipv6</span></b></a> command is run.</p>
<p>The <a href="cmdqueryname=apply+redirect+ipv6"><b><span class="cmdname">apply redirect ipv6</span></b></a> <i><span class="varname">redirect-ipv6-rt</span></i> command must be used together with the <a href="cmdqueryname=local-route+redirect+ipv6"><b><span class="cmdname">local-route redirect ipv6</span></b></a> command to trigger traffic redirection to a specified IPv6 next hop.</p>
</div></div>
</li><li>To redirect the matched traffic to an SRv6 TE Policy, run the <a href="cmdqueryname=apply+redirect+ipv6+color+prefix-sid"><b><span class="cmdname">apply redirect ipv6</span></b></a> <i><span class="varname">redirect-ipv6-rt</span></i> <strong><span>color</span></strong> <i><span class="varname">colorvalue</span></i> [ <strong><span>prefix-sid</span></strong> <i><span class="varname">prefix-sid-value</span></i> ] command.</li><li>To redirect the matched traffic to SR-MPLS TE Policies for load balancing (a maximum of eight redirection paths are supported for load balancing), run the <a href="cmdqueryname=apply+redirect+multi-ip+color"><b><span class="cmdname">apply redirect multi-ip</span></b></a> <em>redirectIP</em> [ <strong><strong><span>color</span></strong></strong><em> <i><span class="varname">color-value</span></i></em> ] [ <strong>weight</strong><em> <i><span class="varname">weight-value</span></i></em> ] command.</li><li>To redirect the matched traffic to SRv6 TE Policies for load balancing (a maximum of eight redirection paths are supported for load balancing), run the <a href="cmdqueryname=apply+redirect+multi-ipv6"><b><span class="cmdname">apply redirect multi-ipv6</span></b></a><strong> </strong><em>redirectIPv6</em> [ <strong>color</strong><em> <i><span class="varname">color-value </span></i></em>] [ <strong>weight</strong><em> <i><span class="varname">weight-value</span></i></em> ] command.</li><li><p>To re-mark the service class of the matched traffic, run the <a href="cmdqueryname=apply+remark-dscp"><b><span class="cmdname">apply remark-dscp</span></b></a> command.</p>
</li><li><p>To limit the rate of the matched traffic, run the <a href="cmdqueryname=apply+traffic-rate"><b><span class="cmdname">apply traffic-rate</span></b></a> command. The <a href="cmdqueryname=apply+deny"><b><span class="cmdname">apply deny</span></b></a> and <a href="cmdqueryname=apply+traffic-rate"><b><span class="cmdname">apply traffic-rate</span></b></a> commands cannot be used together.</p>
</li><li><p>To implement sampling for the matched traffic, run the <a href="cmdqueryname=apply+traffic-action+sample"><b><span class="cmdname">apply traffic-action sample</span></b></a> command.</p>
<p>You can run the <a href="cmdqueryname=apply+traffic-action+sample"><b><span class="cmdname">apply traffic-action sample</span></b></a> command for a BGP Flow Specification route to sample the traffic that matches the specified filtering rules. Through sampling, abnormal traffic can be identified and filtered out, which protects the attacked device and improves network security.</p>
</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the configured BGP Flow Specification route attribute does not need to take effect locally, run the <a href="cmdqueryname=routing-table+rib-only+route-policy"><b><span class="cmdname">routing-table rib-only</span></b></a> [ <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i><span> | <strong><span>route-filter</span></strong> <i><span class="varname">route-filter-name</span></i></span> ] command to disable the device from delivering the BGP Flow Specification route to the FES forwarding table.</p>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure BGP Flow Specification peer relationships.</span><p><p>BGP Flow Specification peer relationships must be established between the network ingress and device on which the BGP Flow Specification route is manually created.</p>
</p><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family+flow"><b><span class="cmdname">ipv4-family flow</span></b></a></span><p><p>The BGP-Flow address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <a href="cmdqueryname=enable"><b><span class="cmdname">enable</span></b></a></span><p><p>The BGP Flow Specification peer relationship is enabled.</p>
</p><p><p>After the BGP Flow Specification peer relationship is established in the BGP-Flow address family view, the manually generated BGP Flow Specification route is imported to the BGP routing table and then sent to each peer.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>(Optional) Configure a Flow RR.</span><p><p>Before configuring a Flow RR, establish a BGP Flow Specification peer relationship between the Flow RR and the device on which the BGP Flow Specification route is generated and between the Flow RR and every network ingress.</p>
</p><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family+flow"><b><span class="cmdname">ipv4-family flow</span></b></a></span><p><p>The BGP-Flow address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <a href="cmdqueryname=reflect-client"><b><span class="cmdname">reflect-client</span></b></a></span><p><p>A Flow RR is configured, and clients are specified for it.</p>
</p><p><p>The <span class="keyword">Router</span> on which the <a href="cmdqueryname=peer+reflect-client"><b><span class="cmdname">peer reflect-client</span></b></a> command is run functions as a Flow RR, and the specified peers function as clients.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=undo+reflect+between-clients"><b><span class="cmdname">undo reflect between-clients</span></b></a></span><p><p>Route reflection between clients through the RR is disabled.</p>
</p><p><p>If the clients of a Flow RR are fully meshed, you can run the <a href="cmdqueryname=undo+reflect+between-clients"><b><span class="cmdname">undo reflect between-clients</span></b></a> command on the Flow RR to disable route reflection between clients through the RR, which reduces costs.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=reflector+cluster-id"><b><span class="cmdname">reflector cluster-id</span></b></a> { <i><span class="varname">cluster-id-value</span></i> | <i><span class="varname">cluster-id-ipv4</span></i> }</span><p><p>A cluster ID is configured for the Flow RR.</p>
</p><p><p>If a cluster has multiple Flow RRs, run this command to set the same <i><span class="varname">cluster-id</span></i> for these RRs.</p>
<p>The <a href="cmdqueryname=reflector+cluster-id"><b><span class="cmdname">reflector cluster-id</span></b></a> command is applicable only to Flow RRs.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0172372345__step_1"><span id="EN-US_TASK_0172372345__cmd23488281214101">(Optional) Configure the device to check the AS_Path attribute during BGP Flow Specification route validation.</span><ol type="a" id="EN-US_TASK_0172372345__substeps285212623214101"><li class="substepexpand" id="EN-US_TASK_0172372345__substep1245391788214101"><span id="EN-US_TASK_0172372345__cmd1924157254214101">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname495614563214101">system-view</span></b></a></span><p><p id="EN-US_TASK_0172372345__p34866506517">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__substep1509965906214101"><span id="EN-US_TASK_0172372345__cmd1182725543214101">Run <a href="cmdqueryname=bgp"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname1947005860214101">bgp</span></b></a> <i><span class="varname" id="EN-US_TASK_0172372345__varname345568250214101">as-number</span></i></span><p><p id="EN-US_TASK_0172372345__p173017550519">The BGP view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__substep968634319214101"><span id="EN-US_TASK_0172372345__cmd1910955173214101">Run <a href="cmdqueryname=ipv4-family+flow"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname1497143125214101">ipv4-family flow</span></b></a></span><p><p id="EN-US_TASK_0172372345__p964135919511">The BGP-Flow address family view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__substep1539470768214101"><span id="EN-US_TASK_0172372345__cmd1002218720214101">Run <a href="cmdqueryname=route+validation-mode+include-as"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname1426949729214101">route validation-mode include-as</span></b></a></span><p><p id="EN-US_TASK_0172372345__p5877194314510">The device is configured to check the AS_Path attribute during BGP Flow Specification route validation.</p>
</p><p><div class="p" id="EN-US_TASK_0172372345__p97438915214101">BGP Flow Specification route validation is performed in either of the following modes: <ul id="EN-US_TASK_0172372345__en-us_cliref_0172383989_ul1988263785214154"><li id="EN-US_TASK_0172372345__en-us_cliref_0172383989_li1125409925214154">Validation mode 1: After receiving a BGP Flow Specification route with a destination address-based filtering rule, the device checks the validity of the route using the rules described in <a href="#EN-US_TASK_0172372345__en-us_cliref_0172383989_fig_route_validation-mode_include-as01">Figure 1</a>. The route is considered valid only if the validation succeeds.</li><li id="EN-US_TASK_0172372345__en-us_cliref_0172383989_li1499988458214154">Validation mode 2: After receiving a BGP Flow Specification route with a destination address-based filtering rule, the device checks the validity of the route by checking whether the AS_Path attribute of the route carries the AS_Set and AS_Sequence fields. The route is considered valid only if its AS_Path attribute does not carry the AS_Set or AS_Sequence field.</li></ul>
Validation mode 2 is configured using the <a href="cmdqueryname=route+validation-mode+include-as"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_cliref_0172383989_cmdname1973107158214154">route validation-mode include-as</span></b></a> command. If this command is configured, the device checks the validity of a BGP Flow Specification route using mode 2 first. <ul id="EN-US_TASK_0172372345__en-us_cliref_0172383989_ul1816591491214154"><li id="EN-US_TASK_0172372345__en-us_cliref_0172383989_li1472822637214154">If the validation succeeds, the BGP Flow Specification route is considered valid, and mode 1 is not used.</li><li id="EN-US_TASK_0172372345__en-us_cliref_0172383989_li357606420214154">If the validation fails, the device checks the validity of the BGP Flow Specification route using mode 1.</li></ul>
If this command is not run, the device uses mode 1 to check the validity of BGP Flow Specification routes.<div class="fignone" id="EN-US_TASK_0172372345__en-us_cliref_0172383989_fig_route_validation-mode_include-as01"><a name="EN-US_TASK_0172372345__en-us_cliref_0172383989_fig_route_validation-mode_include-as01"></a><a name="en-us_cliref_0172383989_fig_route_validation-mode_include-as01"></a><span class="figcap"><b>Figure 1 </b>BGP Flow Specification validation rules</span><br><span><img class="vsd" id="EN-US_TASK_0172372345__en-us_cliref_0172383989_image1739672175214154" src="figure/en-us_image_0000001183343598.png"></span><br></div>
</div>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__substep1638335581214101"><span id="EN-US_TASK_0172372345__cmd470788033214101">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname1170576065214101">commit</span></b></a></span><p><p id="EN-US_TASK_0172372345__p73022598438">The configuration is committed.</p>
</p></li></ol>
</li><li><span>(Optional) Disable BGP Flow Specification route validation.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family+flow"><b><span class="cmdname">ipv4-family flow</span></b></a></span><p><p>The BGP-Flow address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer+validation-disable"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>validation-disable</span></strong></span><p><p>The device is disabled from validating BGP Flow Specification routes received from a specified peer.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>(Optional) Disable the device from validating the next hop of each route that carries the redirection next-hop attribute and is received from a specified EBGP peer.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family+flow"><b><span class="cmdname">ipv4-family flow</span></b></a></span><p><p>The BGP-Flow address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=peer+redirect+ip+validation-disable"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <strong><span>redirect ip validation-disable</span></strong></span><p><p>The device is disabled from validating the routes that carry a redirection extended community attribute and are received from a specified EBGP peer.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>(Optional) Allow the device to recurse received routes with the next-hop IPv6 address, color attribute, and prefix SID attributes to tunnels.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family+flow"><b><span class="cmdname">ipv4-family flow</span></b></a></span><p><p>The BGP-Flow address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=redirect+tunnelv6+tunnel-selector"><b><span class="cmdname">redirect tunnelv6 tunnel-selector</span></b></a> <i><span class="varname">tunnel-selector-name</span></i></span><p><p>The device is configured to recurse received routes with the redirection next-hop IPv6 address, color, and prefix SID attributes to tunnels.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0172372345__step_2"><span id="EN-US_TASK_0172372345__cmd1458299547214101">(Optional) Configure the redirection next-hop attribute ID for BGP Flow Specification routes.</span><p><p id="EN-US_TASK_0172372345__p1321682413214101">The redirection next-hop attribute ID can be 0x010C (defined in a related RFC) or 0x0800 (defined in a related draft). If a Huawei device needs to communicate with a non-Huawei device that does not support the redirection next-hop attribute ID of 0x010C or 0x0800, set the redirection next-hop attribute ID of BGP Flow Specification routes as required. Perform one of the following configurations based on the ID supported by non-Huawei devices:</p>
<ul id="EN-US_TASK_0172372345__ul501958730214101"><li id="EN-US_TASK_0172372345__li178998743214101"><p id="EN-US_TASK_0172372345__p1954767801214101"><a name="EN-US_TASK_0172372345__li178998743214101"></a><a name="li178998743214101"></a>Set the redirection next-hop attribute ID to 0x010C (defined in a related RFC) for BGP Flow Specification routes.</p>
<ol type="a" id="EN-US_TASK_0172372345__ol1883388145214101"><li id="EN-US_TASK_0172372345__li1735941735214101">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname2333123016445">system-view</span></b></a><p id="EN-US_TASK_0172372345__p416793116441">The system view is displayed.</p>
</li><li id="EN-US_TASK_0172372345__li1736398237214101">Run <a href="cmdqueryname=bgp"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname17244123444418">bgp</span></b></a> <i><span class="varname" id="EN-US_TASK_0172372345__varname1244123413443">as-number</span></i><p id="EN-US_TASK_0172372345__p3938234204413">The BGP view is displayed.</p>
</li><li id="EN-US_TASK_0172372345__li1063283344214101">Run <a href="cmdqueryname=ipv4-family+flow"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname9424105984414">ipv4-family flow</span></b></a><p id="EN-US_TASK_0172372345__p123305054518">The BGP-Flow address family view is displayed.</p>
</li><li id="EN-US_TASK_0172372345__li1800559783214101">Run <a href="cmdqueryname=peer+redirect+ip+rfc-compatible"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname159611831457">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0172372345__varname109622334513">ipv4-address</span></i> <strong><span id="EN-US_TASK_0172372345__cmdparmname39621639457">redirect ip rfc-compatible</span></strong><p id="EN-US_TASK_0172372345__p1398620424511">The redirection next-hop attribute ID of the BGP Flow Specification route is set to 0x010C (defined in a related RFC).</p>
</li><li id="EN-US_TASK_0172372345__li380799385214101">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname1199288154520">commit</span></b></a><p id="EN-US_TASK_0172372345__p1569879144518">The configuration is committed.</p>
</li></ol>
</li><li id="EN-US_TASK_0172372345__li1980060120214101"><p id="EN-US_TASK_0172372345__p1463842928214101"><a name="EN-US_TASK_0172372345__li1980060120214101"></a><a name="li1980060120214101"></a>Change the redirection next-hop attribute ID of BGP Flow Specification routes to 0x0800 (defined in a related draft).</p>
<ol type="a" id="EN-US_TASK_0172372345__ol2014632052214101"><li id="EN-US_TASK_0172372345__li91071080214101">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname19868121614311">system-view</span></b></a><p id="EN-US_TASK_0172372345__p243451818435">The system view is displayed.</p>
</li><li id="EN-US_TASK_0172372345__li1234417457214101">Run <a href="cmdqueryname=bgp"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname6626109124311">bgp</span></b></a> <i><span class="varname" id="EN-US_TASK_0172372345__varname76277924310">as-number</span></i><p id="EN-US_TASK_0172372345__p132294115435">The BGP view is displayed.</p>
</li><li id="EN-US_TASK_0172372345__li1808333184214101">Run <a href="cmdqueryname=ipv4-family+flow"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname153522577426">ipv4-family flow</span></b></a><p id="EN-US_TASK_0172372345__p1145145810427">The BGP-Flow address family view is displayed.</p>
</li><li id="EN-US_TASK_0172372345__li1242802234214101">Run <a href="cmdqueryname=peer+redirect+ip+draft-compatible"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname1035811450427">peer</span></b></a> <i><span class="varname" id="EN-US_TASK_0172372345__varname1035874584219">ipv4-address</span></i> <strong><span id="EN-US_TASK_0172372345__cmdparmname1235864513427">redirect ip draft-compatible</span></strong><p id="EN-US_TASK_0172372345__p196112046114218">The redirection next-hop attribute ID of BGP Flow Specification routes is changed to 0x0800 (defined in a related draft).</p>
</li><li id="EN-US_TASK_0172372345__li1250327541214101">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname132031350144219">commit</span></b></a><p id="EN-US_TASK_0172372345__p43081351114217">The configuration is committed.</p>
</li></ol>
</li></ul>
</p></li><li id="EN-US_TASK_0172372345__flowspec_refluence"><span id="EN-US_TASK_0172372345__cmd1108718817214101">(Optional) Configure the interface in the BGP Flow Specification as the traffic-injection interface of the cleaned traffic to prevent the injected traffic from matching the Flow Specification rules and being switched back to the cleaning device.</span><ol type="a" id="EN-US_TASK_0172372345__substeps2025036455214101"><li class="substepexpand" id="EN-US_TASK_0172372345__substep429450343214101"><span id="EN-US_TASK_0172372345__cmd79377234214101">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname1694971331214101">system-view</span></b></a></span><p><p id="EN-US_TASK_0172372345__p9209203013422">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__substep1223237670214101"><span id="EN-US_TASK_0172372345__cmd1094566959214101">Run <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname1635205139214101">interface</span></b></a> <i><span class="varname" id="EN-US_TASK_0172372345__varname657612310402">interface-type</span></i> <i><span class="varname" id="EN-US_TASK_0172372345__varname1957642317402">interface-number</span></i></span><p><p id="EN-US_TASK_0172372345__p627211251420">The interface view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__substep1780765529214101"><span id="EN-US_TASK_0172372345__cmd1994141311214101">Run <a href="cmdqueryname=flowspec+refluence"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname631046200214101">flowspec refluence</span></b></a></span><p><p id="EN-US_TASK_0172372345__p1392211213298">The interface in BGP Flow Specification is configured as the traffic-injection interface for cleaning traffic.</p>
</p><p><div class="note" id="EN-US_TASK_0172372345__note1403267220214101"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172372345__p1046755186214101">This configuration conflicts with MF classification. Therefore, after this command is configured on an interface, do not configure MF classification on the interface.</p>
<p id="EN-US_TASK_0172372345__p1919482247214101">This command cannot be configured on Eth-Trunk member interfaces. The configuration on a main interface also takes effect on its sub-interfaces.</p>
</div></div>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__substep1486233384214101"><span id="EN-US_TASK_0172372345__cmd1742186631214101">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname2092367494214101">commit</span></b></a></span><p><p id="EN-US_TASK_0172372345__p3686105424">The configuration is committed.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0172372345__flowspec_disable"><span id="EN-US_TASK_0172372345__cmd856382230214101">(Optional) Disable BGP Flow Specification on the interface.</span><ol type="a" id="EN-US_TASK_0172372345__substeps1763623200214101"><li class="substepexpand" id="EN-US_TASK_0172372345__substep1816712982214101"><span id="EN-US_TASK_0172372345__cmd572595428214101">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname214768980214101">system-view</span></b></a></span><p><p id="EN-US_TASK_0172372345__p145112487413">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__substep21613653214101"><span id="EN-US_TASK_0172372345__cmd335929628214101">Run <a href="cmdqueryname=interface"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname512983692214101">interface</span></b></a> <i><span class="varname" id="EN-US_TASK_0172372345__varname20655823164018">interface-type</span></i> <i><span class="varname" id="EN-US_TASK_0172372345__varname17655132312405">interface-number</span></i></span><p><p id="EN-US_TASK_0172372345__p47444616411">The interface view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__substep1387054464214101"><span id="EN-US_TASK_0172372345__cmd1289388263214101">Run <a href="cmdqueryname=flowspec+disable+ipv4+ipv6"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname371040327214101">flowspec disable</span></b></a> [ <strong><span id="EN-US_TASK_0172372345__cmdparmname6175123111117">ipv4</span></strong> | <strong><span id="EN-US_TASK_0172372345__cmdparmname918112317118">ipv6</span></strong> ]</span><p><p id="EN-US_TASK_0172372345__p1516583017294">BGP Flow Specification is disabled on the interface.</p>
</p><p><div class="note" id="EN-US_TASK_0172372345__note508989688214101"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172372345__p1162320215214101">This command cannot be configured on Eth-Trunk member interfaces. The configuration on a main interface also takes effect on its sub-interfaces.</p>
<p id="EN-US_TASK_0172372345__p833412971216">If BGP Flow Specification does not need to be disabled on a sub-interface, run the <a href="cmdqueryname=flowspec+disable+ipv4+ipv6+sub-port-exclude"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname123591436201813">flowspec disable</span></b></a> [ <strong><span id="EN-US_TASK_0172372345__cmdparmname987442181810">ipv4</span></strong> | <strong><span id="EN-US_TASK_0172372345__cmdparmname1913210518186">ipv6</span></strong> ] <strong><span id="EN-US_TASK_0172372345__cmdparmname17662165691816">sub-port-exclude</span></strong> command on the main interface to which the sub-interface belongs.</p>
</div></div>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__substep1178700715214101"><span id="EN-US_TASK_0172372345__cmd2033757077214101">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172372345__cmdname1136214344214101">commit</span></b></a></span><p><p id="EN-US_TASK_0172372345__p7953191115413">The configuration is committed.</p>
</p></li></ol>
</li><li><span>(Optional) Configure BGP Flow Specification for the packets leaving the public network based on IP information.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=flowspec+match-ip-layer+mpls-pop"><b><span class="cmdname">flowspec match-ip-layer mpls-pop</span></b></a></span><p><p>BGP Flow Specification is configured for the packets leaving the public network based on IP information.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>(Optional) <span>Enable CAR statistics collection and packet loss statistics collection for BGP Flow Specification.</span></span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=flowspec+statistic+enable"><b><span class="cmdname">flowspec statistic enable</span></b></a></span><p><p>CAR statistics collection and packet loss statistics collection for BGP Flow Specification are enabled.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>(Optional) <span>Configure BGP Flow Specification for packets entering an IPv4 VXLAN tunnel.</span></span><ol type="a" id="EN-US_TASK_0172372345__en-us_task_0172372344_substeps1785720634214101"><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_en-us_task_0172372344_substep1683670792214101"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_en-us_task_0172372344_cmd62984625214101">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_en-us_task_0172372344_cmdname557329499214101">system-view</span></b></a></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p10600134215587">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_substep940538792214101"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmd8351577214101">Run <a href="cmdqueryname=flowspec+match+vxlan-packet+enable"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname2074656764214101">flowspec match vxlan-packet enable</span></b></a></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p1158421120402">BGP Flow Specification is configured for packets entering an IPv4 VXLAN tunnel.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_substep2051939876214101"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmd513608759214101">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname278778871214101">commit</span></b></a></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p1577144124120">The configuration is committed.</p>
</p></li></ol>
</li><li><span>(Optional) Enable BGP Flow Specification on a GRE tunnel interface.</span><ol type="a" id="EN-US_TASK_0172372345__en-us_task_0172372344_substeps562864929214101"><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_substep1683670792214101"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmd62984625214101">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname557329499214101">system-view</span></b></a></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p95143208417">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_substep517929886214101"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmd1096372711214101">Run <a href="cmdqueryname=interface+tunnel"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname827783712214101">interface tunnel</span></b></a> <i><span class="varname" id="EN-US_TASK_0172372345__en-us_task_0172372344_varname888114610214101">interface-number</span></i></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p120034913312">The tunnel interface view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_substep590742851214101"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmd798196676214101">Run <a href="cmdqueryname=tunnel-protocol+gre"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname567510149214101">tunnel-protocol</span></b></a> <strong><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdparmname2113330741214101">gre</span></strong></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p016914461132">The tunnel is encapsulated as a GRE tunnel.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_substep338294897214101"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmd1333120270214101">Run <a href="cmdqueryname=flowspec+match+tunnel-pop"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname1384312153214101">flowspec match tunnel-pop</span></b></a></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p1823218423316">BGP Flow Specification is enabled on the GRE tunnel interface.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_substep1281369377214101"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmd1009107123214101">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname2059295081214101">commit</span></b></a></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p19226636835">The configuration is committed.</p>
</p></li></ol>
</li><li><span>(Optional) Disable BGP Flow Specification protection.</span><ol type="a" id="EN-US_TASK_0172372345__en-us_task_0172372344_substeps178887814913"><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_substep118881485918"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmd138883817910">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname039174221019">system-view</span></b></a></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p13702181014128">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_substep8971201512920"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmd097114152918">Run <a href="cmdqueryname=flowspec+protocol-protect+ipv4+ipv6+disable"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname67791726161015">flowspec protocol-protect</span></b></a> { <strong><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdparmname1422011399114">ipv4</span></strong> | <strong><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdparmname115531043131114">ipv6</span></strong> } <strong><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdparmname78091349181114">disable</span></strong></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p12278122114127">BGP Flow Specification protection is disabled.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_substep139391326123"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmd1693913211215">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname4151640101214">commit</span></b></a></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p1855253571220">The configuration is committed.</p>
</p></li></ol>
</li><li><span>(Optional) Enable the device to follow RFC 5575 when dealing with BGP Flow Specification IPv4 fragmentation rules.</span><ol type="a" id="EN-US_TASK_0172372345__en-us_task_0172372344_substeps36132122442"><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_substep7613181218445"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmd261315126444">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname139552174414">system-view</span></b></a></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p194311932266">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_substep54471506447"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmd104479502441">Run <a href="cmdqueryname=flowspec+ipv4-fragment-rule+switch"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname191162010458">flowspec ipv4-fragment-rule switch</span></b></a></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p11474218182617">The device is enabled to follow RFC 5575 when dealing with BGP Flow Specification IPv4 fragmentation rules.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_substep10622154811452"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmd862217481459">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname19622124824510">commit</span></b></a></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p6999935132613">The configuration is committed.</p>
</p></li></ol>
</li><li><span>(Optional) Enable BGP Flow Specification to match inner packet information about the packets that leave an SRv6 TE Policy or SRv6 BE egress.</span><ol type="a" id="EN-US_TASK_0172372345__en-us_task_0172372344_substeps195639422140"><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_substep165631942191417"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmd756310429148">Run <a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname5413124714141">system-view</span></b></a></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p1188315171473">The system view is displayed.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_substep92941850101419"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmd12941050101412">Run <a href="cmdqueryname=flowspec+match+srv6-inner-ip+enable"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname655163675120">flowspec match srv6-inner-ip enable</span></b></a></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p17382527114711">BGP Flow Specification is enabled to match inner packet information about the packets that leave an SRv6 TE Policy or SRv6 BE egress.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0172372345__en-us_task_0172372344_substep12814439157"><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmd62811943191514">Run <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname9864512158">commit</span></b></a></span><p><p id="EN-US_TASK_0172372345__en-us_task_0172372344_p4321538134715">The configuration is committed.</p>
</p></li></ol>
</li><li><span>(Optional) Disable the device from sending routes that carry the destination community attribute rule to a specified peer.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family+flow"><b><span class="cmdname">ipv4-family flow</span></b></a></span><p><p>The BGP-Flow address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <strong><a href="cmdqueryname=peer+advertise+destination-community+disable"><b><span class="cmdname">peer</span></b></a> </strong><em>peerIPv4Addr </em><a href="cmdqueryname=peer+advertise+destination-community+disable"><b><span class="cmdname">advertise destination-community disable</span></b></a></span><p><p>The device is disabled from sending routes that carry the destination community attribute rule to a specified peer. Perform this step if you do not want the device to send routes that carry the destination community attribute rule to a specified BGP Flow Specification peer.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>(Optional) Enable the device to redirect traffic to a specified IPv6 next hop based on a static BGP Flow Specification route.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=ipv4-family+flow"><b><span class="cmdname">ipv4-family flow</span></b></a></span><p><p>The BGP-Flow address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <strong><a href="cmdqueryname=local-route+redirect+ipv6"><b><span class="cmdname">local-route redirect ipv6</span></b></a></strong></span><p><p>The device is enabled to redirect traffic to a specified IPv6 next hop based on a static BGP Flow Specification route.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>(Optional) Enable BGP Flow Specification to match an IPv4 destination community attribute-based traffic filtering rule.</span><ol type="a"><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=flowspec+match-rule+enhance+enable"><b><span class="cmdname">flowspec match-rule enhance enable</span></b></a></span><p><p>BGP Flow Specification is enabled to match an IPv4 destination community attribute-based traffic filtering rule.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0172372345__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After the configuration is complete, verify the configuration.</p>
<ul><li><p>Run the <a href="cmdqueryname=display+bgp+flow+peer+verbose"><b><span class="cmdname">display bgp flow peer</span></b></a> [ [ <i><span class="varname">ipv4-address</span></i> ] <strong><span>verbose</span></strong> ] command to check information about BGP Flow Specification peers.</p>
</li><li><p>Run the <a href="cmdqueryname=display+bgp+flow+routing-table"><b><span class="cmdname">display bgp flow routing-table</span></b></a> command to check BGP Flow Specification routing information.</p>
</li><li><p>Run the <a href="cmdqueryname=display+bgp+flow+routing-table+peer+advertised-routes"><b><span class="cmdname">display bgp flow routing-table</span></b></a> [ <strong><span>peer</span></strong> <i><span class="varname">ipv4-address</span></i> ] [ <strong><span>advertised-routes</span></strong> | <strong><span>received-routes</span></strong> [ <strong><span>active</span></strong> ] ] <a href="cmdqueryname=statistics"><b><span class="cmdname">statistics</span></b></a> command to check BGP Flow Specification route statistics.</p>
</li><li>Run the <a href="cmdqueryname=display+flowspec+statistics"><b><span class="cmdname">display flowspec statistics</span></b></a> <i><span class="varname">reindex</span></i> command to check statistics about the traffic matching a specified BGP Flow Specification route.</li><li>Run the <a href="cmdqueryname=display+flowspec+rule+slot"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname75021755191414">display flowspec</span></b></a> <strong><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdparmname322314521514">rule</span></strong> <i><span class="varname" id="EN-US_TASK_0172372345__en-us_task_0172372344_varname12472151218155">reindex-value</span></i> <strong><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdparmname143651917111514">slot</span></strong> <i><span class="varname" id="EN-US_TASK_0172372345__en-us_task_0172372344_varname033592413157">slot-id</span></i> command to check information about combined rules in the local BGP Flow Specification rule table.</li><li>Run the <a href="cmdqueryname=display+flowspec+rule+statistics+slot"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname5910711181816">display flowspec</span></b></a> <strong><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdparmname162965181181">rule statistics slot</span></strong> <i><span class="varname" id="EN-US_TASK_0172372345__en-us_task_0172372344_varname9665522191819">slot-id</span></i> command to check statistics about the rules for BGP Flow Specification routes to take effect.</li><li>Run the <a href="cmdqueryname=display+flowspec+resource+rule+ipv4+ipv6+slot"><b><span class="cmdname" id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdname1599317291274">display flowspec resource rule</span></b></a> { <strong><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdparmname1563703542718">ipv4</span></strong> | <strong><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdparmname5358140192714">ipv6</span></strong> } [ <strong><span id="EN-US_TASK_0172372345__en-us_task_0172372344_cmdparmname1515184619272">slot</span></strong> <i><span class="varname" id="EN-US_TASK_0172372345__en-us_task_0172372344_varname057105116271">slot-id</span></i> ] command to check the resource usage information about BGP Flow Specification route rules.</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_flowspec_cfg_0000.html">BGP Flow Specification Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_flowspec_cfg_0004.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_flowspec_cfg_0005.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>