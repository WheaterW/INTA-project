
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Example for Configuring DHCPv6 Snooping on a Layer 3 Device">
<meta name="abstract" content="Applications of DHCPv6 snooping on Layer 3 devices include IPv6/MAC spoofing attack defense.">
<meta name="description" content="Applications of DHCPv6 snooping on Layer 3 devices include IPv6/MAC spoofing attack defense.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcpv6-snooping_cfg_0034_1.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00800033,w00606909,z00805567">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="DHCPv6 Snooping">
<meta name="featuretype" content="Security">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="DHCPv6 Snooping">
<meta name="featuretype" content="Security">
<meta name="featurename" content="DHCPv6 Snooping">
<meta name="featuretype" content="Security">
<meta name="featurename" content="DHCPv6 Snooping">
<meta name="featuretype" content="Security">
<meta name="OWNER" content="y00852169">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="y00852169">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0314612912">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring DHCPv6 Snooping on a Layer 3 Device</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CONCEPT_0314612912"></a><a name="EN-US_CONCEPT_0314612912"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring DHCPv6 Snooping on a Layer 3 Device</h1>
<div><p>Applications of DHCPv6 snooping on Layer 3 devices include IPv6/MAC spoofing attack defense.</p>
<div class="section"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_CONCEPT_0314612912__fig8310216184110">Figure 1</a>, DHCPv6 snooping needs to be configured on the Layer 3 interface GE <span>0/1/0</span> of the DHCPv6 relay agent to allow DHCPv6 client access.</p>
<p>If a user goes offline unexpectedly after obtaining an IPv6 address, the system can automatically detect the logout, delete the corresponding DHCPv6 binding entry, and instruct the DHCPv6 server to release this IPv6 address. In addition, DHCPv6 snooping enabled on the DHCPv6 relay can prevent against IPv6/MAC spoofing attacks.</p>
<p>DHCPv6 client 1 uses a dynamically assigned IPv6 address, and DHCPv6 client 2 uses a statically assigned IPv6 address.</p>
<div class="fignone" id="EN-US_CONCEPT_0314612912__fig8310216184110"><a name="EN-US_CONCEPT_0314612912__fig8310216184110"></a><a name="fig8310216184110"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring DHCPv6 snooping on a Layer 3 device</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1 and interface 2 represent GE <span>0/1/0</span> and GE <span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0316480564.png" width="NaN" height="NaN"></span></div>
</div>
<div class="section"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Configure IPv6 addresses for interfaces.</li><li>Enable DHCPv6 snooping in the system view and interface view.</li><li>Configure a DHCPv6 snooping binding table to check IPv6 packets against the binding table in order to prevent against IPv6/MAC spoofing attacks.</li><li>Enable association between ND probe and DHCPv6 snooping.</li></ol>
</div>
<div class="section"><h4 class="sectiontitle">Procedure</h4><ol><li>Configure IPv6 addresses for interfaces.<p># Configure IPv6 addresses for GE <span>0/1/0</span> and GE <span>0/2/0</span>.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <strong>sysname DHCPv6-relay</strong>
[*<span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay] <strong>interface gigabitethernet <span>0/1/0</span></strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay-GigabitEthernet<span>0/1/0</span>] <strong>ipv6 enable</strong>
[*DHCPv6-relay-GigabitEthernet<span>0/1/0</span>] <strong>ipv6 address 2001:db8:2::1/64</strong>
[*DHCPv6-relay-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay] <strong>interface gigabitethernet <span>0/2/0</span></strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay-GigabitEthernet<span>0/2/0</span>] <strong>ipv6 enable</strong>
[*DHCPv6-relay-GigabitEthernet<span>0/2/0</span>] <strong>ipv6 address 2001:db8:3::1/64</strong>
[*DHCPv6-relay-GigabitEthernet<span>0/2/0</span>] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay-GigabitEthernet<span>0/2/0</span>] <strong>quit</strong></pre>
</li><li>Enable DHCPv6 snooping.<p># Enable DHCPv6 snooping both globally and on an interface.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay]<strong> dhcpv6 snooping enable</strong>
[*DHCPv6-relay] <strong>interface gigabitethernet <span>0/1/0</span></strong>
[*DHCPv6-relay-GigabitEthernet<span>0/1/0</span>] <strong>dhcpv6 snooping enable </strong>
[*DHCPv6-relay-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
</li><li>Configure the IPv6 packet check function and a DHCPv6 snooping binding entry.<p># Configure the IPv6 packet check function on the DHCPv6 client-side interface to prevent IPv6/MAC spoofing attacks.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay] <strong>interface gigabitethernet <span>0/1/0</span></strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay-GigabitEthernet<span>0/1/0</span>] <strong>dhcpv6 snooping check ipv6 enable</strong>
[*DHCPv6-relay-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<p># Configure a static binding entry.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>For users who use static IPv6 addresses, you need to configure static DHCPv6 snooping binding entries for them.</p>
</div></div>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay] <strong>interface gigabitethernet <span>0/1/0</span></strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay-GigabitEthernet<span>0/1/0</span>]<strong> dhcpv6 snooping bind-table static ipv6-address 2001:db8:1::1 mac-address 00e0-fc12-3456</strong>
[*DHCPv6-relay-GigabitEthernet<span>0/1/0</span>]<strong> commit</strong></pre>
<p># Configure a destination IPv6 address for the DHCPv6 packets on GE <span>0/1/0</span>.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay-GigabitEthernet<span>0/1/0</span>]<strong> </strong><strong>dhcpv6 relay destination 2001:db8:3::2</strong>
[*DHCPv6-relay-GigabitEthernet<span>0/1/0</span>]<strong> commit</strong></pre>
</li><li>Enable association between ND probe and DHCPv6 snooping.<p># Configure the system to perform ND probe for the IPv6 addresses that have reached the aging time in DHCPv6 snooping entries and do not exist in ND entries. If the system fails to detect a user within the specified number of probes, the system will delete the corresponding DHCPv6 snooping binding entry and instruct the DHCPv6 server to release the user's IPv6 address.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay] <strong>dhcpv6 snooping nd-detect enable</strong>
[*DHCPv6-relay] <strong>commit</strong></pre>
</li><li>Verify the configuration.<p># Run the <strong>display dhcpv6 snooping interface</strong> command to check whether the DHCPv6 snooping function is enabled.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay] <strong>display dhcpv6 snooping interface gigabitethernet <span>0/1/0</span></strong>
 dhcpv6 snooping enable
 dhcpv6 snooping check ipv6 enable
 ipv6 total                   0             </pre>
<p># Run the <strong>display dhcpv6 snooping bind-table static</strong> command to check information about the DHCPv6 snooping binding table.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DHCPv6-relay] <strong>display dhcpv6 snooping bind-table static</strong>
bind-table:
ifname         vrf            p/cvlan    mac-address    ipv6-address           tp lease    
---------------------------------------------------------------------------------------
GE<span>0/1/0</span>        --             0000/0000  00e0-fc12-3456 2001:DB8:1::1/128      S  0
---------------------------------------------------------------------------------------
binditem count:      1                   binditem total count: 1 </pre>
</li></ol>
</div>
<div class="section"><h4 class="sectiontitle">Configuration Files</h4><pre class="screen"># 
sysname DHCPv6-relay 
# 
dhcpv6 snooping enable
dhcpv6 snooping nd-detect enable                                     
#
interface GigabitEthernet<span>0/1/0</span> 
 undo shutdown  
 ipv6 enable
 ipv6 address 2001:DB8:2::1/64 
 dhcpv6 snooping enable
 dhcpv6 snooping check ipv6 enable
 dhcpv6 relay destination 2001:DB8:3::2 
 dhcpv6 snooping bind-table static ipv6-address 2001:DB8:1::1 mac-address 00e0-fc12-3456
#                                   
interface GigabitEthernet<span>0/2/0</span> 
 undo shutdown 
 ipv6 enable
 ipv6 address 2001:DB8:3::1/64 
# 
return </pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_dhcpv6-snooping_cfg_0034_1.html">Configuration Examples for DHCPv6 Snooping
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
</div>
</div>
</body>
</html>