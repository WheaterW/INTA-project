
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring CMPv2-based Certificate Application">
<meta name="abstract" content="CMPv2-based certificate application involves two types of CMP requests: initialization requests (IRs) and key update requests (KURs).">
<meta name="description" content="CMPv2-based certificate application involves two types of CMP requests: initialization requests (IRs) and key update requests (KURs).">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_cmp_0001.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_cmp_0003.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_cmp_0005.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="PKI">
<meta name="featuretype" content="Security">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="PKI">
<meta name="featuretype" content="Security">
<meta name="featurename" content="PKI">
<meta name="featuretype" content="Security">
<meta name="featurename" content="PKI">
<meta name="featuretype" content="Security">
<meta name="OWNER" content="z00485179">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00485179">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172372535">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring CMPv2-based Certificate Application</title>
</head>
<body><a name="EN-US_TASK_0172372535"></a><a name="EN-US_TASK_0172372535"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring CMPv2-based Certificate Application</h1>
<div class="taskbody"><p>CMPv2-based certificate application involves two types of CMP requests: initialization requests (IRs) and key update requests (KURs).</p>
<div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0172372535__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before configuring CMPv2-based certificate application, verify functions to ensure that the network and server are working properly.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172372535__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>The <span class="keyword">NE40E</span> supports IRs and KURs.</p>
<ul><li>IR: When the <span class="keyword">NE40E</span> does not obtain a certificate authorized by a carrier, it needs to send an IR to request an identity authentication certificate.</li><li>KUR: Each certificate has a validity period with definite start and end dates. The IKE negotiation fails if either device's certificate expires. The <span class="keyword">NE40E</span> needs to update its certificate before the certificate expires. Automatic certificate update can be configured on the <span class="keyword">NE40E</span>.</li></ul>
<p>Certificates obtained using IRs are stored on the CF card but do not take effect. These certificates take effect only after they are imported to the memory using a command. Certificates obtained using KURs can be automatically saved in the memory if the KUR function is enabled.</p>
<p>Perform the following steps on the <span class="keyword">NE40E</span> where you need to apply for a certificate.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172372535__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=pki+domain"><b><span class="cmdname">pki domain</span></b></a> <i><span class="varname">domain-name</span></i></span><p><p>The PKI domain name configuration view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=pki+cmp+initial-request"><b><span class="cmdname">pki cmp initial-request</span></b></a></span><p><p>The device is configured to send IRs to apply for certificates.</p>
</p></li><li><span>(Optional) Stop the process of polling a CMP request.</span><p><p>If the <span class="keyword">NE40E</span> does not receive any response from the connected CA server after sending a CMP request, it polls the CMP request. You can perform the following steps to stop the CMP request polling process.</p>
</p><ol type="a"><li><span>Run the <a href="cmdqueryname=pki+cmp+session"><b><span class="cmdname">pki cmp session</span></b></a> <i><span class="varname">session-name</span></i> command to enter the CMP session view.</span></li><li><span>Run the <a href="cmdqueryname=cmp+poll-request+stop"><b><span class="cmdname">cmp poll-request stop</span></b></a> command to manually stop the process of polling a CMP request.</span></li><li><span>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the PKI domain name configuration view.</span></li></ol>
</li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li><span>Run <a href="cmdqueryname=pki+import-certificate+local+domain+filename"><b><span class="cmdname">pki import-certificate</span></b></a> <strong><span>local</span></strong> [ <strong><span>domain</span></strong> <i><span class="varname">domainName</span></i> ] <strong><span>filename</span></strong> <i><span class="varname">file-name</span></i></span><p><p>The local certificate is imported.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>To ensure high security, you are advised not to import certificates that use the MD5 or SHA1 algorithm. The recommended key length of a certificate is 2048 bits or more.</p>
<p>The default domain of PKI is reserved. For the default domain, you can run the <a href="cmdqueryname=pki+import-certificate"><b><span class="cmdname">pki import-certificate</span></b></a> command to install the downloaded user certificate or run the <strong>pki load</strong> <strong>preset-local</strong> <strong>domain </strong><strong>default</strong> command to load the preset local certificate. By default, the preset local certificate has been loaded to the default domain.</p>
</div></div>
</p></li><li><span>Run <a href="cmdqueryname=pki+domain"><b><span class="cmdname">pki domain</span></b></a> <i><span class="varname">domain-name</span></i></span><p><p>The PKI domain name configuration view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=pki+cmp+session"><b><span class="cmdname">pki cmp session</span></b></a> <i><span class="varname">session-name</span></i></span><p><p>The CMP session view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=cmp+request+authentication-cert"><b><span class="cmdname">cmp request authentication-cert</span></b></a> <i><span class="varname">cert-name</span></i></span><p><p>A certificate to be carried in a CMP request for identity authentication is configured.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>The PKI domain name configuration view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span><p><p>Return to the system view.</p>
</p></li><li><span>Run <a href="cmdqueryname=pki+import-certificate+ca+domain+filename"><b><span class="cmdname">pki import-certificate</span></b></a> <strong><span>ca</span></strong> [ <strong><span>domain</span></strong> <i><span class="varname">domainName</span></i> ] <strong><span>filename</span></strong> <i><span class="varname">file-name</span></i></span><p><p>The CA certificate is imported.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>To ensure high security, you are advised not to import certificates that use the MD5 or SHA1 algorithm. The recommended key length of a certificate is 2048 bits or more.</p>
<p>The default domain of PKI is reserved. For the default domain, you can run the <a href="cmdqueryname=pki+import-certificate"><b><span class="cmdname">pki import-certificate</span></b></a> command to install the downloaded user certificate or run the <strong>pki load </strong><strong>preset-ca</strong> <strong>domain </strong><strong>default</strong> command to load the preset CA certificate.</p>
</div></div>
</p></li><li><span>(Optional) Enable the automatic certificate update function.</span><ol type="a"><li class="substepexpand"><span>Run the <a href="cmdqueryname=pki+domain"><b><span class="cmdname">pki domain</span></b></a> <i><span class="varname">domain-name</span></i> command to enter the PKI domain name configuration view.</span></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=pki+cmp+session"><b><span class="cmdname">pki cmp session</span></b></a> <i><span class="varname">session-name</span></i> command to enter the CMP session view.</span></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=certificate+auto-update+enable"><b><span class="cmdname">certificate auto-update enable</span></b></a> command to enable the automatic certificate update.</span></li><li class="substepexpand"><span>(Optional) Run the <a href="cmdqueryname=certificate+update+expire-time"><b><span class="cmdname">certificate update expire-time</span></b></a> <i><span class="varname">valid-percent</span></i> command to configure the percentage of the time for automatic certificate update.</span><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>When automatic update of local certificates is triggered, the system checks whether the file names of the CA certificates corresponding to the local certificates exist in the memory. If the file names do not exist in the memory, the CA certificates are not automatically imported. In addition, services may be interrupted because the local certificates and CA certificates are not updated synchronously. Therefore, if the corresponding CA certificates are not automatically imported, you need to run the <a href="cmdqueryname=pki+import-certificate+ca+domain+filename"><b><span class="cmdname">pki import-certificate</span></b></a> <strong><span>ca</span></strong> [ <strong><span>domain</span></strong> <i><span class="varname">domainName</span></i> ] <strong><span>filename</span></strong> <i><span class="varname">file-name</span></i> command to manually import the CA certificates. During the import, do not change the device-generated file names of the CA certificates. Otherwise, the certificates cannot be automatically imported even if automatic certificate update is enabled.</p>
</div></div>
</p></li></ol>
</li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li><li><span>Verify the configuration.</span><p><p>If IR-based certificate application succeeds, <strong>session-name_ir.cer</strong> and <strong>session-name_cax.cer</strong> files are generated on the CF card. There may be multiple <strong>session-name_cax.cer</strong> files, such as <strong>session-name_ca0.cer</strong>, <strong>session-name_ca1.cer</strong>, and <strong>session-name_ca2.cer</strong>.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_cmp_0001.html">Configuring CMPv2-based Certificate Application
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_cmp_0003.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_cfg_cmp_0005.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>