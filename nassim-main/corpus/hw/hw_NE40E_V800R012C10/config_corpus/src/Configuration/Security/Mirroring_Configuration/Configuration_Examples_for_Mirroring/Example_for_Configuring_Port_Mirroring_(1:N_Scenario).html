
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Port Mirroring (1:N Scenario)">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_portmirror_cfg_0018.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_portmirror_cfg_0100.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_portmirror_cfg_1027.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00800033,w00606909,z00805567">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPoE">
<meta name="featurename" content="Mirroring">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="User Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPoE">
<meta name="featurename" content="Mirroring">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="IPoE">
<meta name="featurename" content="Mirroring">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="User Access">
<meta name="featurename" content="Mirroring">
<meta name="featuretype" content="Security">
<meta name="OWNER" content="z00603461,w00800033,w00606909">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00606909">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0281831761">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Port Mirroring (1:N Scenario)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0281831761"></a><a name="EN-US_TASK_0281831761"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Port Mirroring (1:N Scenario)</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0281831761__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0281831761__fig_dc_ne_portmirror_cfg_002701">Figure 1</a>, the switch forwards user packets from VLAN 10 and VLAN 20 to the <span class="keyword">Device</span>. To monitor the packets forwarded by the switch to interface 1 on the <span class="keyword">Device</span>, specify interface 2 and interface 3 on the <span class="keyword">Device</span> as observing ports. In addition, specify interface 1 as a mirrored port and enable the port mirroring function for the traffic of VLAN 10. Then, map the mirrored port to the observing ports. In this way, all the packets of VLAN 10 received by interface 1 are copied to interface 2 and interface 3.</p>
<div class="fignone" id="EN-US_TASK_0281831761__fig_dc_ne_portmirror_cfg_002701"><a name="EN-US_TASK_0281831761__fig_dc_ne_portmirror_cfg_002701"></a><a name="fig_dc_ne_portmirror_cfg_002701"></a><span class="figcap"><b>Figure 1 </b>Networking diagram for configuring port mirroring in a 1:N scenario</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>The configurations in this example are performed on the <span class="keyword">Device</span>. The <span class="keyword">HUAWEI NE40E-M2 series</span> can function as a <span class="keyword">Device</span>.</li><li>Interfaces 1 through 3 in this example represent GE<span>0/1/0</span>, GE<span>0/2/0</span>, and GE<span>0/3/0</span>, respectively.</li></ul>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0281832655.png"></span><div class="tableBorder"><table cellpadding="4" cellspacing="0" summary=""><tr><th valign="bottom" align="left" id="mcps1.3.1.3.4.1.1"><p>Device Name</p>
</th>
<th valign="bottom" align="left" id="mcps1.3.1.3.4.1.2"><p>Interface Name</p>
</th>
<th valign="bottom" align="left" id="mcps1.3.1.3.4.1.3"><p>Interface IP Address</p>
</th>
</tr>
<tr><td valign="top" headers="mcps1.3.1.3.4.1.1"><p><span class="keyword">Device</span></p>
</td>
<td valign="top" headers="mcps1.3.1.3.4.1.2"><p>GE<span>0/1/0</span></p>
</td>
<td valign="top" headers="mcps1.3.1.3.4.1.3"><p>-</p>
</td>
</tr>
<tr><td valign="top" headers="mcps1.3.1.3.4.1.1"><p><span class="keyword">Device</span></p>
</td>
<td valign="top" headers="mcps1.3.1.3.4.1.2"><p>GE<span>0/2/0</span></p>
</td>
<td valign="top" headers="mcps1.3.1.3.4.1.3"><p>10.10.1.1/24</p>
</td>
</tr>
<tr><td valign="top" headers="mcps1.3.1.3.4.1.1"><p><span class="keyword">Device</span></p>
</td>
<td valign="top" headers="mcps1.3.1.3.4.1.2"><p>GE<span>0/3/0</span></p>
</td>
<td valign="top" headers="mcps1.3.1.3.4.1.3"><p>10.1.1.2/24</p>
</td>
</tr>
</table></div>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0281831761__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Notes</h4><p>Do not configure an interface as both an observing port and a mirrored port.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0281831761__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure GE<span>0/2/0</span> and GE<span>0/3/0</span> on the <span class="keyword">Device</span> as observing ports.</p>
</li><li><p>Configure GE<span>0/1/0</span> on the <span class="keyword">Device</span> as a mirrored port and enable the port mirroring function for the traffic of VLAN 10.</p>
</li><li>Map the mirrored port to the observing ports and enable mirroring analysis on GE<span>0/1/0</span>.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0281831761__1.3.4"></a><a name="1.3.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Types and numbers of the observing ports and mirrored port</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0281831761__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure IP addresses for interfaces and ensure that the corresponding routes are reachable. For configuration details, see <a href="#EN-US_TASK_0281831761__example1465079755213933">Configuration Files</a> in this section.</span></li><li><span>Configure GE<span>0/2/0</span> and GE<span>0/3/0</span> as observing ports.</span><p><pre class="screen">&lt;<span class="keyword">Device</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> interface gigabitethernet<span>0/2/0</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/2/0</span>]<strong> port-observing observe-index 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>-GigabitEthernet<span>0/2/0</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/2/0</span>]<strong> quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> interface gigabitethernet</strong><strong><span>0/3/0</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/3/0</span>]<strong> port-observing observe-index 2</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/3/0</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/3/0</span>]<strong> quit</strong></pre>
</p></li><li><span>Enable VLAN-based upstream port mirroring on GE<span>0/1/0</span>.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> vlan 10</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>-vlan10]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-vlan10]<strong> quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> interface gigabitethernet</strong><strong><span>0/1/0</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/0</span>] <strong>portswitch</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/0</span>] <strong>port default <span>vlan 10</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/0</span>] <strong>port-mirroring inbound</strong> <strong><span>vlan 10</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/0</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
</p></li><li><span>Map the mirrored port GE<span>0/1/0</span> to the observing ports GE<span>0/2/0</span> and GE<span>0/3/0</span>.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>]<strong> interface gigabitethernet<span>0/1/0</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/0</span>]<strong> port-mirroring to observe-index 1</strong> <strong>2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/0</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>-GigabitEthernet<span>0/1/0</span>]<strong> quit</strong></pre>
<p>After the preceding configuration is complete, the packets of VLAN 10 received by GE<span>0/1/0</span> are mirrored to GE<span>0/2/0</span> and GE<span>0/3/0</span>.</p>
</p></li><li><span>Verify the configuration.</span><p><p>For example, if the switch sends 10 packets with the VLAN ID being 10 to the mirrored port GE<span>0/1/0</span> of the <span class="keyword">Device</span>, check that the observing ports GE<span>0/2/0</span> and GE<span>0/3/0</span> can forward all the packets with the VLAN ID being 10 received by the mirrored port GE<span>0/1/0</span>. Run the <strong>display interface</strong> command to check packet statistics about GE<span>0/2/0</span>.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>&gt; <strong>display interface gigabitethernet<span>0/2/0</span></strong>
GigabitEthernet<span>0/2/0</span> current state : UP
Line protocol current state : UP
Description:<em>XXXXXX</em>, GigabitEthernet<span>0/2/0</span> Interface
Route Port,The Maximum Transmit Unit is 1500
Internet protocol processing : disabled
IP Sending Frames' Format is PKTFMT_ETHNT_2, Hardware address is 00e0-fc7d-a497
The Vendor PN is HFBR-5710L
Port BW: 1G, Transceiver max BW: 1G, Transceiver Mode: MultiMode
WaveLength: 850nm, Transmission Distance: 550m
 Loopback:none, full-duplex mode, negotiation: disable, Pause Flowcontrol:Send and Receive Enable
Statistics last cleared:never
    Last 300 seconds input rate: 0 bits/sec, 0 packets/sec
    Last 300 seconds output rate: 0 bits/sec, 0 packets/sec
    Input: 560 bytes, 10 packets
    <strong>Output: 560 bytes, 10 packets</strong>
    Input:
      Unicast: 0, Multicast: 0
      Broadcast: 0, JumboOctets: 0
      CRC: 0, Symbol: 0
      Overrun: 0 , InRangeLength: 0
      LongPacket: 0 , Jabber: 0, Alignment: 0
      Fragment: 0, Undersized Frame: 0
      RxPause: 0
    Output:
      Unicast: 10, Multicast: 0
      Broadcast: 0, Jumbo: 0
      Lost: 0, Overflow: 0, Underrun: 0
      TxPause: 0  </pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0281831761__example1465079755213933"><a name="EN-US_TASK_0281831761__example1465079755213933"></a><a name="example1465079755213933"></a><a name="EN-US_TASK_0281831761__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span> configuration file</p>
<pre class="screen">#
 sysname <span class="keyword">Device</span>
 vlan 10
#
 interface GigabitEthernet<span>0/1/0</span>
 portswitch
 port default vlan 10
 port-mirroring inbound vlan 10
 port-mirroring to observe-index 1 2
#
interface GigabitEthernet<span>0/2/0</span>
 ip address 10.10.1.1 255.255.255.0
 port-observing observe-index 1
#
interface GigabitEthernet<span>0/3/0</span>
 ip address 10.1.1.2 255.255.255.0
 port-observing observe-index 2
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_portmirror_cfg_0018.html">Configuration Examples for Mirroring
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_portmirror_cfg_0100.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_portmirror_cfg_1027.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>