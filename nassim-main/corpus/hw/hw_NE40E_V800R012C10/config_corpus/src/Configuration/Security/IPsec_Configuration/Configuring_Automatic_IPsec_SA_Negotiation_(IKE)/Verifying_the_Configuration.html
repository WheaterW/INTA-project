
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Verifying the Configuration">
<meta name="abstract" content="After completing the configuration, check the tunnel establishment.">
<meta name="description" content="After completing the configuration, check the tunnel establishment.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ipsec_cfg_all_0007.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ipsec_cfg_all_0015.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,z00603461,ipsec,w00556928,w00606909,h00522387,l00455378,z00805567">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="IPSec">
<meta name="featuretype" content="Security">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPSec">
<meta name="featuretype" content="Security">
<meta name="featurename" content="IPSec">
<meta name="featuretype" content="Security">
<meta name="featurename" content="IPSec">
<meta name="featuretype" content="Security">
<meta name="OWNER" content="z00485179">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="z00485179">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172372434">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Verifying the Configuration</title>
</head>
<body><a name="EN-US_TASK_0172372434"></a><a name="EN-US_TASK_0172372434"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Verifying the Configuration</h1>
<div class="taskbody"><p>After completing the configuration, check the tunnel establishment.</p>
<div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0172372434__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>The IPsec tunnel in IKE automatic negotiation mode has been configured.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172372434__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Check whether the IPsec VPN is available.</span><p><p>In this example, intranet DeviceA and DeviceB are on two ends of an IPsec tunnel. Configure DeviceA to ping DeviceB.</p>
<ul><li><p>If the ping succeeds, the IPsec VPN is established.</p>
</li><li><p>If the ping fails, the IPsec VPN is not established. This is because that intranet or Internet routes are unavailable, or the IPsec configuration is incorrect.</p>
</li></ul>
</p></li><li><span>Check whether the route between each intranet device and the IPsec gateway is available, and whether the route between the IPsec gateways is available. If a route is unavailable, configure the route again. If the routes are available, check the IPsec configurations.</span></li><li><span>Run the <a href="cmdqueryname=display+ipsec+statistics"><b><span class="cmdname">display ipsec statistics</span></b></a> command to check statistics about packets processed (encrypted and decrypted) by IPsec.</span></li><li><span>Run the <strong>display ike sa </strong>[ { <strong>remote</strong><em> <i><span class="varname">remoteaddress</span></i></em> } | <strong>verbose</strong> { { <strong>remote </strong><em><i><span class="varname">remoteaddress</span></i></em> } | { <strong>conn_id</strong><em> connid</em><strong> slot</strong><em> slot-id</em> } | { <strong>peer</strong><em> peername</em> [ <strong>identity</strong><em> peeridentity</em> ] } } | <strong>slot</strong><em> slot-id</em> | { <strong>peer</strong><em> peername</em> [ <strong>identity</strong><em> peeridentity</em> ] } ] command to check SA establishment.</span></li><li><span>If the SA is not established, run the following commands in the user view to check the IPsec configurations.</span><ol type="a"><li><span>Run the <a href="cmdqueryname=display+ike+proposal"><b><span class="cmdname">display ike proposal</span></b></a> command to check IKE proposal information. Ensure that the encryption algorithm, authentication method, authentication algorithm, and DH group ID used at one end of the IPsec tunnel are the same as those used at the other end.</span></li><li><span>Run the <a href="cmdqueryname=display+ike+peer+name+brief"><b><span class="cmdname">display ike peer</span></b></a> [ <strong><span>name</span></strong> <i><span class="varname">peer-name</span></i> | <strong><span>brief</span></strong> ] command to check IKE peer configurations. Ensure that the IKE version and authentication method used at one end of the IPsec tunnel are the same as those used at the other end.</span></li><li><span>Run the <a href="cmdqueryname=display+ipsec+proposal"><b><span class="cmdname">display ipsec proposal</span></b></a> command to check IPsec proposal information. Ensure that the encapsulation mode, security protocol, encryption algorithm, and authentication algorithm used at one end of the IPsec tunnel are the same as those used at the other end.</span></li><li><span>Run the <a href="cmdqueryname=display+ipsec+policy-template+brief+name"><b><span class="cmdname">display ipsec policy-template</span></b></a> [ <strong><span>brief</span></strong> | <strong><span>name</span></strong> <i><span class="varname">policy-template-name</span></i> [ <i><span class="varname">seq-number</span></i> ] ] command to check IPsec policy template information.</span></li><li><span>Run the <a href="cmdqueryname=display+ipsec+policy+brief+name"><b><span class="cmdname">display ipsec policy</span></b></a> [ <strong><span>brief</span></strong> | <strong><span>name</span></strong> <i><span class="varname">policy-name</span></i> [ <i><span class="varname">seq-number</span></i> ] ] command to check IPsec policy information.</span></li><li><span>Run the <a href="cmdqueryname=display+ipsec+sa"><b><span class="cmdname">display ipsec sa</span></b></a> command to check SA configurations. Ensure that the SA configurations at one end of the IPsec tunnel match those at the other end.</span></li></ol>
</li><li><span>Run the <a href="cmdqueryname=display+ike+statistics+all+msg+v2+slot"><b><span class="cmdname">display ike statistics</span></b></a> { <strong><span>all</span></strong> | <strong><span>msg</span></strong> | <strong><span>v2</span></strong> } [ <strong><span>slot</span></strong> <i><span class="varname">slot-id</span></i> ] command to check IKE packet statistics.</span></li><li><span>Run the <a href="cmdqueryname=display+ike+offline+history+peer-ip+vpn-instance-name+port+slot"><b><span class="cmdname">display ike offline history</span></b></a><span> [ <strong><span>peer-ip</span></strong> <i><span class="varname">peer-ip</span></i> [ <strong><span>vpn-instance-name</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] [ <strong><span>port</span></strong> <i><span class="varname">port</span></i> ] ] [ <strong><span>slot</span></strong> <i><span class="varname">slot-id</span></i> ]</span> command to check historical logout information about IKE SAs.</span></li><li><span>Run the <a href="cmdqueryname=display+ike+error+history+peer-ip+vpn-instance-name+port+slot"><b><span class="cmdname">display ike error history</span></b></a><span> [ <strong><span>peer-ip</span></strong> <i><span class="varname">peer-ip</span></i> [ <strong><span>vpn-instance-name</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] [ <strong><span>port</span></strong> <i><span class="varname">port</span></i> ] ] [ <strong><span>slot</span></strong> <i><span class="varname">slot-id</span></i> ]</span> command to check error information about IKE SA negotiation failures.</span><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the peer device is not a Huawei device and IKE negotiation authentication fails (Error REASON: Authentication Fail), the failure may be caused by the peer end's incompatibility with the payload of the certificate request type in IKE negotiation packets. In this case, run the <a href="cmdqueryname=ike+compatible+enable"><b><span class="cmdname">ike payload compatible enable</span></b></a> command to enable IKE payload compatibility. After this function is enabled, payload of the certificate request type is not encapsulated in the IKE negotiation packets sent in shared-key mode. This prevents negotiation failures caused by payload incompatibility.</p>
</div></div>
</p></li><li><span>Run the <a href="cmdqueryname=display+ipsec+sa-expire+statistics"><b><span class="cmdname">display ipsec sa-expire statistics</span></b></a> command to check statistics about expired SAs.</span></li><li><span>Run the <a href="cmdqueryname=display+ipsec+bandwidth+slot"><b><span class="cmdname">display ipsec bandwidth </span></b></a>[ <strong><span>slot</span></strong> <i><span class="varname">slot-id</span></i> ] command to check the bandwidth configured in the IPsec license.</span></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ipsec_cfg_all_0007.html">Configuring Automatic IPsec SA Negotiation (IKE)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ipsec_cfg_all_0015.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>