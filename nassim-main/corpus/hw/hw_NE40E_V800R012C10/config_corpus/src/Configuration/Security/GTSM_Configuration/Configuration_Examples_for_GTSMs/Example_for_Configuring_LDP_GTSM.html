
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring LDP GTSM">
<meta name="abstract" content="This section provides an example for configuring LDP GTSM, which consists of enabling MPLS and MPLS LDP on each router and each interface and configuring LDP GTSM on both LDP peers.">
<meta name="description" content="This section provides an example for configuring LDP GTSM, which consists of enabling MPLS and MPLS LDP on each router and each interface and configuring LDP GTSM on both LDP peers.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gtsm_cfg_0009.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gtsm_cfg_0011.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="z00603461,w00800033,w00556928,w00606909,gtsm,l00455378,z00805567">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="GTSM">
<meta name="featuretype" content="Security">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="GTSM">
<meta name="featuretype" content="Security">
<meta name="featurename" content="GTSM">
<meta name="featuretype" content="Security">
<meta name="featurename" content="GTSM">
<meta name="featuretype" content="Security">
<meta name="OWNER" content="y00852169">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00830490">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172372058">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring LDP GTSM</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172372058"></a><a name="EN-US_TASK_0172372058"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring LDP GTSM</h1>
<div class="taskbody"><p>This section provides an example for configuring LDP GTSM, which consists of enabling MPLS and MPLS LDP on each router and each interface and configuring LDP GTSM on both LDP peers.</p>
<div class="context"><a name="EN-US_TASK_0172372058__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0172372058__fig_dc_vrp_gtsm_cfg_001201">Figure 1</a>,<span> LSRs run MPLS and MPLS LDP. An attacker can send simulated unicast LDP packets to LSRB, causing LSRB to be busy processing packets and resulting in high CPU usage. To defend against the attack, LSRB can be configured with the GTSM to accept packets carrying the TTL values within a specified range, improving system security.</span></p>
<div class="fignone" id="EN-US_TASK_0172372058__fig_dc_vrp_gtsm_cfg_001201"><a name="EN-US_TASK_0172372058__fig_dc_vrp_gtsm_cfg_001201"></a><a name="fig_dc_vrp_gtsm_cfg_001201"></a><span class="figcap"><b>Figure 1 </b>Configuring LDP GTSM</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 and 2 in this example represent GE <span>0/1/0</span> and GE <span>0/2/0</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_gtsm_cfg_001201.png"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172372058__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Notes</h4><p>None.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172372058__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure basic MPLS and MPLS LDP functions.</p>
</li><li><p>Configure the GTSM at the two ends of the LDP peer.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172372058__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>LSR ID of the LDP peer</p>
</li><li><p>Maximum number of valid hops permitted by the GTSM</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172372058__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure IP addresses for interfaces. The configuration details are not mentioned here.</span></li><li><span>Configure OSPF to advertise the network segments connecting to interfaces on each node and to advertise the routes of the hosts with LSR IDs. The configuration details are not mentioned here.</span></li><li><span>Configure MPLS and MPLS LDP on each interface and node. The configuration details are not mentioned here.</span><p><p>After the preceding configurations, you can run the display mpls ldp session command on each node. The command output shows that the LDP session is set up. Take the command output on LSR A as an example.</p>
<pre class="screen">&lt;LSRA&gt;<strong> display mpls ldp session</strong></pre>
<pre class="screen"> LDP Session(s) in Public Network
 Codes: LAM(Label Advertisement Mode), SsnAge Unit(DDDD:HH:MM)
<span> An asterisk (*) before a session means the session is being deleted.
</span> ------------------------------------------------------------------------------
 PeerID             Status      LAM  SsnRole  SsnAge      KASent/Rcv
 ------------------------------------------------------------------------------
 2.2.2.9:0          Operational DU   Passive  0000:00:02  9/9
 ------------------------------------------------------------------------------
 TOTAL: 1 session(s) Found.
</pre>
</p></li><li><span>Configure LDP GTSM.</span><p><p># On LSR A, configure the range of valid TTL values carried in LDP packets received from LSR B to be from 253 to 255.</p>
<pre class="screen">&lt;LSRA&gt;<strong> system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRA]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls-ldp] <strong>gtsm peer 2.2.2.9 valid-ttl-hops 3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRA-mpls-ldp] <strong>commit</strong></pre>
<p># On LSR B, configure the range of valid TTL values carried in the LDP packets received from LSR A to be from 252 to 255, and the range of valid TTL values carried in LDP packets received from LSR C to be from 251 to 255.</p>
<pre class="screen">&lt;LSRB&gt;<strong> system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRB]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-mpls-ldp] <strong>gtsm peer 1.1.1.9 valid-ttl-hops 4</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-mpls-ldp] <strong>gtsm peer 3.3.3.9 valid-ttl-hops 5</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRB-mpls-ldp] <strong>commit</strong></pre>
<p># On LSR C, configure the range of valid TTL values carried in LDP packets received from LSR B to be from 250 to 255.</p>
<pre class="screen">&lt;LSRC&gt;<strong> system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>LSRC]<strong> mpls ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-mpls-ldp] <strong>gtsm peer 2.2.2.9 valid-ttl-hops 6</strong></pre>
<pre class="screen">[<span class="keyword">*</span>LSRC-mpls-ldp] <strong>commit</strong></pre>
<p>Then, if the host PC simulates the LDP packets of LSR A to attack LSR B, LSR B directly discards the packets because the TTL values carried in the LDP packets are not within the range of 252 to 255. In the GTSM statistics on LSR B, the number of discarded packets also increases.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172372058__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>LSR A configuration file</p>
<pre class="screen">#
 sysname LSRA
#
 mpls lsr-id 1.1.1.9
 mpls
#
mpls ldp
gtsm peer 2.2.2.9 valid-ttl-hops 3
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
ip address 10.1.1.1 255.255.255.252
mpls
 mpls ldp
#
interface LoopBack1
 ip address 1.1.1.9 255.255.255.255
#
ospf 1
area 0.0.0.0
  network 1.1.1.9 0.0.0.0
  network 10.1.1.0 0.0.0.3
#
return
</pre>
</li><li><p>LSR B configuration file</p>
<pre class="screen">#
 sysname LSRB
#
 mpls lsr-id 2.2.2.9
 mpls
#
mpls ldp
gtsm peer 1.1.1.9 valid-ttl-hops 4
gtsm peer 3.3.3.9 valid-ttl-hops 5
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
ip address 10.1.1.2 255.255.255.252
mpls
 mpls ldp
#
interface GigabitEthernet<span>0/2/0</span>
 undo shutdown
ip address 10.2.1.1 255.255.255.252
mpls
 mpls ldp
#
interface LoopBack1
 ip address 2.2.2.9 255.255.255.255
#
ospf 1
area 0.0.0.0
  network 2.2.2.9 0.0.0.0
  network 10.1.1.0 0.0.0.3
  network 10.2.1.0 0.0.0.3
#
return
</pre>
</li><li><p>LSR C configuration file</p>
<pre class="screen">#
 sysname LSRC
#
 mpls lsr-id 3.3.3.9
 mpls
#
mpls ldp
gtsm peer 2.2.2.9 valid-ttl-hops 6
#
interface GigabitEthernet<span>0/1/0</span>
 undo shutdown
ip address 10.2.1.2 255.255.255.252
mpls
 mpls ldp
#
interface LoopBack1
 ip address 3.3.3.9 255.255.255.255
#
ospf 1
area 0.0.0.0
  network 3.3.3.9 0.0.0.0
  network 10.2.1.0 0.0.0.3
#
return
</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gtsm_cfg_0009.html">Configuration Examples for GTSMs
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_gtsm_cfg_0011.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>