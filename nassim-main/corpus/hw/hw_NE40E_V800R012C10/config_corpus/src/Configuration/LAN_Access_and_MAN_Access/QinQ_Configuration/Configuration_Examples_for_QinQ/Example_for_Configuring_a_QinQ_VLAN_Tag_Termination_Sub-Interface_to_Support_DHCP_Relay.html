
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a QinQ VLAN Tag Termination Sub-Interface to Support DHCP Relay">
<meta name="abstract" content="This example shows how to configure the QinQ VLAN tag termination sub-interface to support Dynamic Host Configuration Protocol (DHCP) relay so that the DHCP relay agent transmits DHCP request packets from DHCP clients to a DHCP server. This configuration enables the clients to dynamically obtain IP addresses from the DHCP server.">
<meta name="description" content="This example shows how to configure the QinQ VLAN tag termination sub-interface to support Dynamic Host Configuration Protocol (DHCP) relay so that the DHCP relay agent transmits DHCP request packets from DHCP clients to a DHCP server. This configuration enables the clients to dynamically obtain IP addresses from the DHCP server.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0023_1.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0034.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0036.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wwx1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172363317">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring a QinQ VLAN Tag Termination Sub-Interface to Support DHCP Relay</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172363317"></a><a name="EN-US_TASK_0172363317"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a QinQ VLAN Tag Termination Sub-Interface to Support DHCP Relay</h1>
<div class="taskbody"><p>This example shows how to configure the QinQ VLAN tag termination sub-interface to support Dynamic Host Configuration Protocol (DHCP) relay so that the DHCP relay agent transmits DHCP request packets from DHCP clients to a DHCP server. This configuration enables the clients to dynamically obtain IP addresses from the DHCP server.</p>
<div class="context"><a name="EN-US_TASK_0172363317__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>If the DHCP client and DHCP server belong to different sub-nets, you need to deploy a DHCP relay agent to forward DHCP request packets from the client to the server so that the client can dynamically obtain IP addresses from the DHCP server.</p>
<p>If a DHCP client connects to a DHCP relay agent through a VLAN tag termination sub-interface, you need to configure the sub-interface to support DHCP relay on the DHCP relay agent. Without the configuration, the DHCP relay agent considers the received user packets with VLAN tags to be invalid. As a result, the DHCP client cannot dynamically obtain IP addresses from a DHCP server.</p>
<p>On the network shown in <a href="#EN-US_TASK_0172363317__fig_dc_vrp_qinq_cfg_003501">Figure 1</a>, DHCP clients and a DHCP server belong to different network segments. The DHCP clients are connected to a DHCP relay agent through CE and then connected to the DHCP server through the DHCP relay agent. The packets sent from CE1 to the DHCP relay agent carry two VLAN tags. On the DHCP relay agent, the QinQ VLAN tag termination sub-interface needs to be configured to support DHCP relay, ensuring that DHCP clients can dynamically obtain IP addresses from the DHCP server.</p>
<div class="fignone" id="EN-US_TASK_0172363317__fig_dc_vrp_qinq_cfg_003501"><a name="EN-US_TASK_0172363317__fig_dc_vrp_qinq_cfg_003501"></a><a name="fig_dc_vrp_qinq_cfg_003501"></a><span class="figcap"><b>Figure 1 </b>Typical networking for configuring the QinQ VLAN tag termination sub-interface to support DHCP relay</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interfaces 1 through 3 and sub-interface1.1 represent GE<span>0/1/1</span>, GE<span>0/1/2</span>, GE<span>0/1/3</span>, and GE<span>0/1/1</span>.1, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_qinq_cfg_003501.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363317__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p id="EN-US_TASK_0172363317__en-us_task_0172363315_p1231499520214028">If the DHCP client sends broadcast packets, the interface that has DHCP relay enabled must support broadcast.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363317__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Create VLANs and configure the Layer 2 forwarding function on CE2 and CE3 so that the packets sent from CE2 and CE3 to CE1 carry one VLAN tag.</p>
</li><li><p>Configure the QinQ and Layer 2 forwarding functions on CE1 so that the packets sent from CE1 to the DHCP relay agent carry two VLAN tags.</p>
</li><li><p>Configure DHCP relay on the DHCP relay agent and configure the QinQ VLAN tag termination sub-interface to support DHCP relay so that the DHCP clients and server can communicate using DHCP packets.</p>
</li><li><p>Enable basic DHCP functions and configure an address pool on the DHCP server so that the DHCP server can assign IP addresses correctly.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363317__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li>User VLAN IDs</li><li>Names of the interfaces connecting CEs to DHCP clients</li><li>Names of interfaces that connect CEs</li><li>Names and IP addresses of the interfaces that connect the DHCP relay agent and CE1</li><li>Names and IP addresses of the interfaces that connect the DHCP relay agent and the DHCP server</li><li>Outer VLAN tag in packets to be terminated by the QinQ VLAN tag termination sub-interfaces</li><li>IP address pool range of the DHCP server</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172363317__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Create VLANs and configure the Layer 2 forwarding function on CE2 and CE3.</span><p><p># Configure CE2.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname CE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-vlan10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/3</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/3</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/3</span>] <strong>port link-type access</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/3</span>] <strong>port default vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/3</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>port link-type trunk</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>port trunk allow-pass vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>commit</strong></pre>
<p># Configure CE3.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname CE3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE3] <strong>vlan 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-vlan20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3] <strong>interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-GigabitEthernet<span>0/1/3</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-GigabitEthernet<span>0/1/3</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-GigabitEthernet<span>0/1/3</span>] <strong>port link-type access</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-GigabitEthernet<span>0/1/3</span>] <strong>port default vlan 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-GigabitEthernet<span>0/1/3</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-GigabitEthernet<span>0/1/1</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-GigabitEthernet<span>0/1/1</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-GigabitEthernet<span>0/1/1</span>] <strong>port link-type trunk</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-GigabitEthernet<span>0/1/1</span>] <strong>port trunk allow-pass vlan 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3] <strong>commit</strong></pre>
</p></li><li><span>Configure the QinQ and Layer 2 forwarding functions on CE1.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname CE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong>vlan 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-vlan100] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/1</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/1</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/1</span>] <strong>port vlan-stacking vlan 10 stack-vlan 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/2</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/2</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/2</span>] <strong>port vlan-stacking vlan 20 stack-vlan 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/3</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/3</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/3</span>] <strong>port link-type trunk</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/3</span>] <strong>port trunk allow-pass vlan 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/3</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>commit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172363317__en-us_task_0172363299_p637825194214028">If the device does not support the <strong><span id="EN-US_TASK_0172363317__en-us_task_0172363299_cmdparmname516997901214028">port vlan-stacking</span></strong> command, you can run the <a href="cmdqueryname=port+link-type+dot1q-tunnel"><b><span class="cmdname" id="EN-US_TASK_0172363317__en-us_task_0172363299_cmdname1201003618214028">port link-type dot1q-tunnel</span></b></a> command and <a href="cmdqueryname=port+default+vlan"><b><span class="cmdname" id="EN-US_TASK_0172363317__en-us_task_0172363299_cmdname1581172039214028">port default vlan</span></b></a> command on the interface to configure the QinQ function.</p>
</div></div>
</p></li><li><span>Configure DHCP relay on the DHCP relay agent, and configure the QinQ VLAN tag termination sub-interface to support DHCP relay.</span><p><p># Enable DHCP.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DHCP-Relay</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DHCP-Relay] <strong>dhcp enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay] <strong>commit</strong></pre>
<p># Assign an IP address to the network-side GE <span>0/1/2</span> on the DHCP relay agent.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DHCP-Relay] <strong>interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay-GigabitEthernet<span>0/1/2</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay-GigabitEthernet<span>0/1/2</span>] <strong>ip address 192.168.2.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay] <strong>commit</strong></pre>
<p># Assign an IP address to the user-side GE <span>0/1/1</span>.1 on the DHCP relay agent. This IP address must be on the same network segment as the IP address of the DHCP client.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DHCP-Relay] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay-GigabitEthernet<span>0/1/1</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay] <strong>interface gigabitethernet <span>0/1/1</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay-GigabitEthernet<span>0/1/1</span>.1] <strong>ip address 192.168.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay-GigabitEthernet<span>0/1/1</span>.1] <strong>ip relay address 192.168.3.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay-GigabitEthernet<span>0/1/1</span>.1] <strong>dhcp select relay</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay-GigabitEthernet<span>0/1/1</span>.1] <strong>commit</strong></pre>
<p># Configure the QinQ VLAN tag termination sub-interface to support DHCP relay.</p>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay] <strong>interface gigabitethernet <span>0/1/1</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay-GigabitEthernet<span>0/1/1</span>.1] <strong>control-vid 1 qinq-termination</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay-GigabitEthernet<span>0/1/1</span>.1] <strong>qinq termination pe-vid 100 ce-vid 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay-GigabitEthernet<span>0/1/1</span>.1] <strong>qinq termination pe-vid 100 ce-vid 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay-GigabitEthernet<span>0/1/1</span>.1] <strong>dhcp option82 rebuild enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay-GigabitEthernet<span>0/1/1</span>.1] <strong>arp broadcast enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay-GigabitEthernet<span>0/1/1</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>DHCP-Relay] <strong>commit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>When you run the <a href="cmdqueryname=qinq+termination"><b><span class="cmdname">qinq termination</span></b></a> command on a main interface, the <strong><span>ce-vid</span></strong> values must be different if the <strong><span>pe-vid</span></strong> values of the two different sub-interfaces are the same.</p>
</li><li><p>You need to run the <strong><span>dhcp option82 insert enable</span></strong> command or <strong><span>dhcp option82 rebuild enable</span></strong> command on the DHCP relay agent to enable the QinQ VLAN tag termination sub-interface to insert Option82 fields into DHCP packets.</p>
<p>If Option82 insertion is not configured on the QinQ VLAN tag termination sub-interface on the DHCP relay agent, the sub-interface encapsulates only the smallest VLAN ID configured on it into DHCP packets without processing other VLANs, and forwards the packets to DHCP clients.</p>
</li><li><p>After the DHCP relay agent sends a packets containing Option82 information to the DHCP server, the Offer or ACK message returned from the DHCP server must contain the Option82 information.</p>
</li></ul>
</div></div>
</p></li><li><span>Configure a DHCP server.</span><p><p id="EN-US_TASK_0172363317__en-us_task_0172363315_p1602593954214028">The configuration details are not provided here.</p>
<ul id="EN-US_TASK_0172363317__en-us_task_0172363315_ul1655938214028"><li id="EN-US_TASK_0172363317__en-us_task_0172363315_li905856316214028">When configuring the DHCP server, ensure that an IP address pool is configured on the DHCP server so that the DHCP server can assign IP addresses to DHCP clients.</li><li id="EN-US_TASK_0172363317__en-us_task_0172363315_li1102917177214028">It is recommended that the address pool lease be configured to improve IP address utilization.</li></ul>
</p></li><li><span>Verify the configuration.</span><p><p>After the configurations are complete, run the <strong>display dhcp relay address</strong> command on the DHCP relay agent to view the DHCP configuration on the interface that has DHCP relay enabled.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DHCP-Relay] <strong>display dhcp relay address all</strong></pre>
<pre class="screen">** GigabitEthernet<span>0/1/1</span>.1 DHCP Relay Address  **
 Dhcp Option          Relay Agent IP       Server IP     
 *                    -                   <strong> 192.168.3.1</strong></pre>
<p>The DHCP client can obtain an IP address from the DHCP server through the DHCP relay agent.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172363317__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>Configuration file of the DHCP relay agent</p>
<pre class="screen">#
 sysname DHCP-Relay
#
dhcp enable
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/1</span>.1
 encapsulation qinq-termination
 qinq termination pe-vid 100 ce-vid 10
 qinq termination pe-vid 100 ce-vid 20
 ip address 192.168.1.1 255.255.255.0
 ip relay address 192.168.3.1
 dhcp select relay
 dhcp option82 rebuild enable
 arp broadcast enable
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 192.168.2.1 255.255.255.0
#
return</pre>
</li><li><p>Configuration file of CE1</p>
<pre class="screen">#
 sysname CE1
#
 vlan batch 100
#
interface GigabitEthernet<span>0/1/3</span>
 portswitch
 undo shutdown
 port link-type trunk
 port trunk allow-pass vlan 100
#
interface GigabitEthernet<span>0/1/1</span>
 portswitch
 undo shutdown
 port vlan-stacking vlan 10 stack-vlan 100
#
interface GigabitEthernet<span>0/1/2</span>
 portswitch
 undo shutdown
 port vlan-stacking vlan 20 stack-vlan 100
#
return</pre>
</li><li><p>Configuration file of CE2</p>
<pre class="screen">#
 sysname CE2
#
 vlan batch 10
#
interface GigabitEthernet<span>0/1/3</span>
 portswitch
 undo shutdown
 port link-type access
 port default vlan 10
#
interface GigabitEthernet<span>0/1/1</span>
 portswitch
 undo shutdown
 port link-type trunk
 port trunk allow-pass vlan 10
#
return</pre>
</li><li><p>Configuration file of CE3</p>
<pre class="screen">#
 sysname CE3
#
 vlan batch 20
#
interface GigabitEthernet<span>0/1/3</span>
 portswitch
 undo shutdown
 port link-type access
 port default vlan 20
#
interface GigabitEthernet<span>0/1/1</span>
 portswitch
 undo shutdown
 port link-type trunk
 port trunk allow-pass vlan 20
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0023_1.html">Configuration Examples for QinQ
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0034.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0036.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>