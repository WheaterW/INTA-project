
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring QinQ-based BPDU Tunneling">
<meta name="abstract" content="You can configure QinQ-based bridge protocol data unit (BPDU) tunneling based on the different roles of provider edges (PEs) and customer edges (CEs) or on the same role of PEs and CEs (QinQ is short for 802.1Q in 802.1Q). After QinQ-based BPDU tunneling is configured, the PEs do not send BPDUs to their CPUs for processing. Instead, they transparently transmit the BPDUs through BPDU tunnels over the Layer 2 network of the carrier network to user networks. This configuration also saves virtual local area network (VLAN) ID resources for the carrier network.">
<meta name="description" content="You can configure QinQ-based bridge protocol data unit (BPDU) tunneling based on the different roles of provider edges (PEs) and customer edges (CEs) or on the same role of PEs and CEs (QinQ is short for 802.1Q in 802.1Q). After QinQ-based BPDU tunneling is configured, the PEs do not send BPDUs to their CPUs for processing. Instead, they transparently transmit the BPDUs through BPDU tunnels over the Layer 2 network of the carrier network to user networks. This configuration also saves virtual local area network (VLAN) ID resources for the carrier network.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bpdu-tunnel_cfg_0016.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bpdu-tunnel_cfg_0018.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bpdu-tunnel_cfg_0020.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="BPDU Tunnel">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BPDU Tunnel">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="BPDU Tunnel">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="BPDU Tunnel">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wwx1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172363719">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring QinQ-based BPDU Tunneling</title>
</head>
<body><a name="EN-US_TASK_0172363719"></a><a name="EN-US_TASK_0172363719"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring QinQ-based BPDU Tunneling</h1>
<div class="taskbody"><p>You can configure QinQ-based bridge protocol data unit (BPDU) tunneling based on the different roles of provider edges (PEs) and customer edges (CEs) or on the same role of PEs and CEs (QinQ is short for 802.1Q in 802.1Q). After QinQ-based BPDU tunneling is configured, the PEs do not send BPDUs to their CPUs for processing. Instead, they transparently transmit the BPDUs through BPDU tunnels over the Layer 2 network of the carrier network to user networks. This configuration also saves virtual local area network (VLAN) ID resources for the carrier network.</p>
<div class="context"><a name="EN-US_TASK_0172363719__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>You can configure QinQ-based BPDU tunneling based on <a href="#EN-US_TASK_0172363719__step_dc_vrp_bpdu-tunnel_cfg_001901">the different roles of PEs and CEs</a> or on <a href="#EN-US_TASK_0172363719__step_dc_vrp_bpdu-tunnel_cfg_001902">the same role of PEs and CEs</a>.</p>
<p>Different roles of PEs and CEs: CEs are customers, and PEs are providers.</p>
<p>Same role of PEs and CEs: CEs and PEs are both customers.</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0172363719__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li id="EN-US_TASK_0172363719__step_dc_vrp_bpdu-tunnel_cfg_001901"><span id="EN-US_TASK_0172363719__">Different roles of PEs and CEs</span><p><p>Perform the following steps on each PE and P:</p>
</p><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=bpdu-tunnel+stp+bridge+role+provider"><b><span class="cmdname">bpdu-tunnel stp bridge role provider</span></b></a></span></span><p><p>The PE and P are configured as a provider.</p>
<p>This command is supported only by the Admin-VS but takes effect on all VSs.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span></span><p><p>The view of the PE interface connected to a CE is displayed.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <a href="cmdqueryname=port+link-type"><b><span class="cmdname">port link-type</span></b></a> { <strong><span>hybrid</span></strong> | <strong><span>trunk</span></strong> }</span><p><p>The interface type is configured.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=port+vlan-stacking"><b><span class="cmdname">port vlan-stacking</span></b></a> <strong><span>vlan</span></strong> <i><span class="varname">vlan-id1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id2</span></i> ] <strong><span>stack-vlan</span></strong> <i><span class="varname">vlan-id3</span></i></span></span><p><p>The interface is configured to add an outer VLAN tag to BPDUs that the interface receives.</p>
</p></li><li class="substepexpand"><span>(Optional) Run <span><a href="cmdqueryname=stp+disable"><b><span class="cmdname">stp disable</span></b></a></span></span><p><p>STP is disabled on the interface, which does not participate in spanning tree calculation.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li id="EN-US_TASK_0172363719__step_dc_vrp_bpdu-tunnel_cfg_001902"><span id="EN-US_TASK_0172363719__">Same role of PEs and CEs</span><p><p>Perform the following steps on each PE:</p>
</p><ol><li class="substepexpand"><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=bpdu-tunnel+stp+group-mac"><b><span class="cmdname">bpdu-tunnel stp group-mac</span></b></a> <i><span class="varname">group-mac</span></i></span></span><p><p>The well-known destination Media Access Control (MAC) address of BPDUs is changed to a specified MAC address.</p>
</p><p><p>This command is supported only on the Admin-VS but takes effect on all VSs.</p>
<p>The well-known MAC address of BPDUs can be changed only to a multicast MAC address, which cannot be a reserved multicast MAC address in the range of 0180-C200-0000 to 0180-C200-002F.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span></span><p><p>The view of the PE interface connected to a CE is displayed.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=port+vlan-stacking"><b><span class="cmdname">port vlan-stacking</span></b></a> <strong><span>vlan</span></strong> <i><span class="varname">vlan-id1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id2</span></i> ] <strong><span>stack-vlan</span></strong> <i><span class="varname">vlan-id3</span></i></span></span><p><p>The interface is configured to add an outer VLAN tag to BPDUs that the interface receives.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bpdu-tunnel+stp+vlan"><b><span class="cmdname">bpdu-tunnel stp vlan</span></b></a> <i><span class="varname">vlan-id1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id2</span></i> ]</span><p><p>BPDU tunneling is enabled on the interface to transparently transmit BPDUs with specified VLAN IDs.</p>
</p><p><p>The VLAN ID range specified in this step must include the inner VLAN IDs specified in Step 4.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=stp+disable"><b><span class="cmdname">stp disable</span></b></a></span></span><p><p>STP is disabled on the interface, which does not participate in spanning tree calculation.</p>
</p></li><li class="substepexpand"><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol>
<p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this scenario, no special configuration is required on Ps.</p>
</div></div>
</p></li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bpdu-tunnel_cfg_0016.html">Configuring QinQ-based BPDU Tunneling Function
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bpdu-tunnel_cfg_0018.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_bpdu-tunnel_cfg_0020.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>