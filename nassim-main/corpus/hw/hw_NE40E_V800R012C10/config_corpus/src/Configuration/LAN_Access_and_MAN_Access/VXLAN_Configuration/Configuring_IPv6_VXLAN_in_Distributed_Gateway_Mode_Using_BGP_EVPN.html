
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring IPv6 VXLAN in Distributed Gateway Mode Using BGP EVPN">
<meta name="abstract" content="Distributed IPv6 VXLAN gateways can be configured to address problems that occur in centralized gateway networking. Such problems include sub-optimal forwarding paths and bottlenecks on Layer 3 gateways in terms of ARP or ND entry specifications.">
<meta name="description" content="Distributed IPv6 VXLAN gateways can be configured to address problems that occur in centralized gateway networking. Such problems include sub-optimal forwarding paths and bottlenecks on Layer 3 gateways in terms of ARP or ND entry specifications.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1082.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1216.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1218.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0007.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0008.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0009.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0010.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0011.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0015.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0012.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="h00847023">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="p00915595">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="p00915595">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0229407971">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring IPv6 VXLAN in Distributed Gateway Mode Using BGP EVPN</title>
</head>
<body><a name="EN-US_TASK_0229407971"></a><a name="EN-US_TASK_0229407971"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring IPv6 VXLAN in Distributed Gateway Mode Using BGP EVPN</h1>
<div class="taskbody"><p>Distributed IPv6 VXLAN gateways can be configured to address problems that occur in centralized gateway networking. Such problems include sub-optimal forwarding paths and bottlenecks on Layer 3 gateways in terms of ARP or ND entry specifications.</p>
<div class="context"><a name="EN-US_TASK_0229407971__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>On the network shown in <a href="#EN-US_TASK_0229407971__fig_dc_vrp_vxlan_cfg_106602">Figure 1</a>, Server1 and Server2 on different subnets both connect to Leaf1. When Server1 and Server2 communicate, traffic is forwarded only through Leaf1, not through any spine node.</p>
<div class="p">Distributed IPv6 VXLAN gateways have the following characteristics:<ul><li><p>Flexible deployment. A leaf node can function as both Layer 2 and Layer 3 IPv6 VXLAN gateways.</p>
</li><li><p>Improved network expansion capabilities. Unlike a centralized Layer 3 gateway, which has to learn the ARP or ND entries of all servers on a network, a leaf node needs to learn the ARP or ND entries of only the servers attached to it. This addresses the problem of the ARP or ND entry specifications being a bottleneck for packet forwarding faced by centralized Layer 3 gateways.</p>
</li></ul>
</div>
<div class="fignone" id="EN-US_TASK_0229407971__fig_dc_vrp_vxlan_cfg_106602"><a name="EN-US_TASK_0229407971__fig_dc_vrp_vxlan_cfg_106602"></a><a name="fig_dc_vrp_vxlan_cfg_106602"></a><span class="figcap"><b>Figure 1 </b>Network diagram of IPv6 VXLAN distributed gateways</span><br><span><img src="figure/en-us_image_0000002126480897.png" width="NaN" height="NaN"></span></div>
<p></p>
<p>Either IPv4 or IPv6 addresses can be configured for the VMs and Layer 3 VXLAN gateway. This means that a VXLAN overlay network can be an IPv4 or IPv6 network. <a href="#EN-US_TASK_0229407971__fig_dc_vrp_vxlan_cfg_106602">Figure 1</a> shows an IPv4 overlay network.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If only VMs on the same subnet need to communicate with each other, Layer 3 IPv6 VXLAN gateways do not need to be deployed. If VMs on different subnets need to communicate with each other or VMs on the same subnet need to communicate with external networks, Layer 3 IPv6 VXLAN gateways must be deployed.</p>
</div></div>
<div class="p">The following table lists the differences in distributed gateway configuration between IPv4 and IPv6 overlay networks.
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.39%" id="mcps1.4.1.8.1.1.4.1.1" liSelected="liSelected"><p>Configuration Task</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.28%" id="mcps1.4.1.8.1.1.4.1.2" liSelected="liSelected"><p>IPv4 Overlay Network</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33%" id="mcps1.4.1.8.1.1.4.1.3" liSelected="liSelected"><p>IPv6 Overlay Network</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="33.39%" headers="mcps1.4.1.8.1.1.4.1.1 "><p>Configure a VPN instance for route leaking with an EVPN instance.</p>
</td>
<td class="cellrowborder" valign="top" width="33.28%" headers="mcps1.4.1.8.1.1.4.1.2 "><p>Enable the IPv4 address family of the involved VPN instance and then complete other configurations in the VPN instance IPv4 address family view.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33%" headers="mcps1.4.1.8.1.1.4.1.3 "><p>Enable the IPv6 address family of the involved VPN instance and then complete other configurations in the VPN instance IPv6 address family view.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.39%" headers="mcps1.4.1.8.1.1.4.1.1 "><p>Configure a Layer 3 gateway on an IPv6 VXLAN.</p>
</td>
<td class="cellrowborder" valign="top" width="33.28%" headers="mcps1.4.1.8.1.1.4.1.2 "><p>Configure an IPv4 address for the VBDIF interface of the Layer 3 gateway.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33%" headers="mcps1.4.1.8.1.1.4.1.3 "><p>Configure an IPv6 address for the VBDIF interface of the Layer 3 gateway.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.39%" headers="mcps1.4.1.8.1.1.4.1.1 "><p>Configure IPv6 VXLAN gateways to exchange specific types of routes.</p>
</td>
<td class="cellrowborder" valign="top" width="33.28%" headers="mcps1.4.1.8.1.1.4.1.2 "><ul><li><p>For IP prefix routes, perform the configuration in the BGP-VPN instance IPv4 address family view.</p>
</li><li><p>For IRB routes, run the <a href="cmdqueryname=arp+collect+host+enable"><b><span class="cmdname">arp collect host enable</span></b></a> command.</p>
</li><li>For IP prefix routes, run the <a href="cmdqueryname=arp+vlink-direct-route+advertise"><b><span class="cmdname">arp vlink-direct-route advertise</span></b></a> command in the IPv4 address family view of the VPN instance to which the involved VBDIF interface is bound.</li></ul>
</td>
<td class="cellrowborder" valign="top" width="33.33%" headers="mcps1.4.1.8.1.1.4.1.3 "><ul><li><p>For IP prefix routes, perform the configuration in the BGP-VPN instance IPv6 address family view.</p>
</li><li><p>For IRBv6 routes, run the <a href="cmdqueryname=ipv6+nd+collect+host+enable"><b><span class="cmdname">ipv6 nd collect host enable</span></b></a> command.</p>
</li><li>For IP prefix routes, run the <a href="cmdqueryname=nd+vlink-direct-route+advertise"><b><span class="cmdname">nd vlink-direct-route advertise</span></b></a> command in the IPv6 address family view of the VPN instance to which the involved VBDIF interface is bound.</li></ul>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0229407971__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring IPv6 VXLAN in distributed gateway mode using BGP EVPN, complete the following task:</p>
<ul><li>Configure IPv6 connectivity on the network.</li></ul>
</div></div>
</div>

<ul class="ullinks">
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0007.html">Configuring a VXLAN Service Access Point</a>
</dt>
<dd>
Layer 2 sub-interfaces are used for service access on VXLANs. These Layer 2 sub-interfaces can have different encapsulation types configured to transmit various types of data packets. After a Layer 2 sub-interface is associated with a BD, which is used as a broadcast domain, the sub-interface can transmit data packets through this BD.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0008.html">Configuring an IPv6 VXLAN Tunnel</a>
</dt>
<dd>
Using BGP EVPN to establish an IPv6 VXLAN tunnel between VTEPs involves a series of operations. These include establishing a BGP EVPN peer relationship, configuring an EVPN instance, and configuring ingress replication.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0009.html">(Optional) Configuring a VPN Instance for Route Leaking with an EVPN Instance</a>
</dt>
<dd>
To enable communication between VMs on different subnets, configure a VPN instance for route leaking with an EVPN instance. This configuration enables Layer 3 connectivity. To isolate multiple tenants, you can use different VPN instances.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0010.html">Configuring a Layer 3 IPv6 VXLAN Gateway</a>
</dt>
<dd>
To enable communication between VMs on different subnets, configure Layer 3 gateways on the IPv6 VXLAN, enable the distributed gateway function, and configure host route advertisement.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0011.html">(Optional) Configuring IPv6 VXLAN Gateways to Advertise Specific Types of Routes</a>
</dt>
<dd>
To enable communication between VMs on different subnets, configure IPv6 VXLAN gateways to exchange IRB or IP prefix routes. This configuration enables the gateways to learn the IP routes of the related hosts or the subnets where the hosts reside.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0015.html">(Optional) Configuring a Limit on the Number of MAC Addresses Learned by an Interface</a>
</dt>
<dd>
MAC address learning limiting helps improve VXLAN network security.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0012.html">Verifying the Configuration</a>
</dt>
<dd>
After configuring IPv6 VXLAN in distributed gateway mode using BGP EVPN, verify information about the IPv6 VXLAN tunnels, VNI status, and VBDIF interfaces.</dd>
</dl>
</ul>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1082.html">VXLAN Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1216.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1218.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>