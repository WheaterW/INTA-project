
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a QinQ VLAN Tag Termination Sub-Interface to Support 802.1p Mapping">
<meta name="abstract" content="After tags are terminated on the PEs, packets are sent to the carrier IP or MPLS network. To ensure inclusion of all the required Quality of Service (QoS) information in the packets, the 802.1p values in outer and inner tags must be mapped to the DSCP fields or the EXP fields.">
<meta name="description" content="After tags are terminated on the PEs, packets are sent to the carrier IP or MPLS network. To ensure inclusion of all the required Quality of Service (QoS) information in the packets, the 802.1p values in outer and inner tags must be mapped to the DSCP fields or the EXP fields.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0000_1.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0039.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0017.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wWX1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172363278">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring a QinQ VLAN Tag Termination Sub-Interface to Support 802.1p Mapping</title>
</head>
<body><a name="EN-US_TASK_0172363278"></a><a name="EN-US_TASK_0172363278"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a QinQ VLAN Tag Termination Sub-Interface to Support 802.1p Mapping</h1>
<div class="taskbody"><p>After tags are terminated on the PEs, packets are sent to the carrier IP or MPLS network. To ensure inclusion of all the required Quality of Service (QoS) information in the packets, the 802.1p values in outer and inner tags must be mapped to the DSCP fields or the EXP fields.</p>
<div class="context"><a name="EN-US_TASK_0172363278__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><div class="p"><h4 class="sectiontitle">Usage Scenario</h4><ul><li><p>QinQ VLAN tag termination can be used to implement the 802.1p and DSCP remark.</p>
<p>Relevant standards specify that the six bits of the Type of Service (ToS) field in an IPv4 packet header serve as the DiffServ Code Point (DSCP). DSCP provides a reference for differentiated services (DiffServ) and is used for QoS guarantee on the IP network. </p>
<p>With QinQ VLAN tag termination, a tagged packet is terminated on the PE before it is sent to the carrier IP network. In this scenario, you need to configure the mapping relationship between the 802.1p values in outer and inner tags and the DSCP field to ensure that all the required QoS information is included in the packet.</p>
</li><li><p>QinQ VLAN tag termination can be used to implement the 802.1p and EXP remark.</p>
<p>The EXP field in an MPLS packet is used for Class of Service (CoS) to implement traffic control on the gateway.</p>
<p>With QinQ VLAN tag termination, a tagged packet is terminated on the PE before it is sent to the carrier MPLS network. In this scenario, you need to configure the mapping relationship between the 802.1p values in outer and inner tags and the EXP field to ensure that all the required QoS information is included in the packet.</p>
</li></ul>
<h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before you configure a VLAN tag termination sub-interface to transmit IP services, plan user VLANs so that packets received by the VLAN tag termination sub-interface carry one or two VLAN tags.</p>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172363278__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172363278__en-us_task_0172388774_cmdname2013676678214612">system-view</span></b></a></span></span>
<p><p id="EN-US_TASK_0172363278__en-us_task_0172388774_p34087246214612">The system view is displayed. </p>
</p>
</li><li><span>Run <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type interface-number.subinterface-number</span></i></span><p><p>The view of an Ethernet sub-interface on the user side of a PE is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=encapsulation"><b><span class="cmdname">encapsulation</span></b></a> <strong><span>qinq-termination</span></strong> [ <span><strong><span>local-switch</span></strong> | </span><strong><span>rt-protocol</span></strong> ]</span><p><p>The encapsulation type is configured as QinQ VLAN tag termination for the sub-interface.</p>
</p><p><div class="p"><ul><li><p>Specify <strong><span>local-switch</span></strong> so that the QinQ VLAN tag termination sub-interface supports local switching.</p>
</li><li><p>Specify <strong><span>rt-protocol</span></strong> so that the QinQ VLAN tag termination sub-interface supports routing protocols.</p>
</li></ul>
</div>
</p></li><li><span>Run <a href="cmdqueryname=qinq+termination+pe-vid"><b><span class="cmdname">qinq termination pe-vid</span></b></a> <i><span class="varname">pe-vid</span></i> [ <strong><span>to</span></strong> <i><span class="varname">high-pe-vid</span></i> ] <strong><span>ce-vid</span></strong> <i><span class="varname">ce-vid</span></i> [ <strong><span>to</span></strong> <i><span class="varname">high-ce-vid</span></i> ]</span><p><p>The VLAN tag termination function is configured for the QinQ VLAN tag termination sub-interface.</p>
</p><p><p>If <strong><span id="EN-US_TASK_0172363278__en-us_task_0172363258_cmdparmname1831176795214028">rt-protocol</span></strong> is specified, the QinQ VLAN tag termination sub-interface terminates double-tagged packets whose inner and outer tags contain only single VLAN IDs (not VLAN ranges).</p>
</p></li><li><span>Run <a href="cmdqueryname=qinq+8021p-mode"><b><span class="cmdname">qinq 8021p-mode</span></b></a> { <strong><span>trust</span></strong> { <strong><span>ce-vid-8021p</span></strong> | <strong><span>pe-vid-8021p</span></strong> } | <i><span class="varname">precedence-value</span></i> }</span></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0172363278__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After a QinQ VLAN tag termination sub-interface is configured to support 802.1p mapping, run the <a href="cmdqueryname=display+qinq+information+termination"><b><span class="cmdname">display qinq information termination</span></b></a> [ <strong><span>interface</span></strong> <i><span class="varname">interface-type interface-number</span></i> [ .<i><span class="varname">subinterface-number</span></i> ] ] command on the PE to check detailed configurations on the QinQ VLAN tag termination sub-interface.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0000_1.html">QinQ Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0039.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0017.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>