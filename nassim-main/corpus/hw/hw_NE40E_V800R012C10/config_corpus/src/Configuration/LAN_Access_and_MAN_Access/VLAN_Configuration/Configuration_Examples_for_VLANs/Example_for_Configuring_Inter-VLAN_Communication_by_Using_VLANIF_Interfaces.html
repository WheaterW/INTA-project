
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Inter-VLAN Communication by Using VLANIF Interfaces">
<meta name="abstract" content="In this example, Layer 3 forwarding is performed by a Layer 3 PE instead of a router. This allows PCs in different VLANs to communicate with each other and reduces operating costs.">
<meta name="description" content="In this example, Layer 3 forwarding is performed by a Layer 3 PE instead of a router. This allows PCs in different VLANs to communicate with each other and reduces operating costs.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vlan_cfg_0033.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vlan_cfg_0037.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vlan_cfg_0060.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wwx1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172363178">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Inter-VLAN Communication by Using VLANIF Interfaces</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172363178"></a><a name="EN-US_TASK_0172363178"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Inter-VLAN Communication by Using VLANIF Interfaces</h1>
<div class="taskbody"><p>In this example, Layer 3 forwarding is performed by a Layer 3 PE instead of a router. This allows PCs in different VLANs to communicate with each other and reduces operating costs.</p>
<div class="context"><a name="EN-US_TASK_0172363178__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>Users in different residential compounds in different network segments require various services such as Internet, IPTV, and VoIP services. The network administrator of each residential compound configures a VLAN for each service to simplify management. After the configuration, users in different residential compounds belong to different VLANs, but they need to communicate with each other for the same type of service.</p>
<p>On the network shown in <a href="#EN-US_TASK_0172363178__fig_dc_vrp_vlan_cfg_003801">Figure 1</a>, users in residential compounds 1 to 4 belong to different VLANs and network segments but all require the Internet access service. It is required that these users communicate with each other at a low operating cost.</p>
<div class="fignone" id="EN-US_TASK_0172363178__fig_dc_vrp_vlan_cfg_003801"><a name="EN-US_TASK_0172363178__fig_dc_vrp_vlan_cfg_003801"></a><a name="fig_dc_vrp_vlan_cfg_003801"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring inter-VLAN communication through VLANIF interfaces</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interfaces 1 through 3 represent GE<span>0/1/1</span>, GE<span>0/1/2</span>, and GE<span>0/1/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001316257598.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363178__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Create VLANs on the CEs and determine the VLANs to which users belong.</li><li>Configure trunk ports on CEs to allow frames with certain VLAN IDs to pass through.</li><li>Create VLANIF interfaces on the PE and assign IP addresses to the interfaces to allow Layer 3 communication.</li></ol>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The default gateway address of each PC in a VLAN must be the IP address of the corresponding VLANIF interface. Otherwise, inter-VLAN communication will fail.</p>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363178__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li>User VLAN ID</li><li>User IP address</li><li>Number of each port connecting a CE to a PC</li><li><p>Number of the ports interconnecting CEs</p>
</li><li><p>Number and IP address of each VLANIF interface on the PE</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172363178__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Create VLANs on CE1 and CE2.</span><p><p id="EN-US_TASK_0172363178__en-us_task_0172363174_p1707382211214028"># Configure CE1.</p>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1180963026214028">&lt;<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1675197152214312">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1668942795214312">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen690777200214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword213546159214312"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword625120176214312">HUAWEI</span>] <strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b589928349214312">sysname CE1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen566328644214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword202363037214312">*</span><span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1648949658214312">HUAWEI</span>] <strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1659468912214312">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1520956025214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword884039251214312"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1521022650214312">vlan batch 30 40</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1449136229214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword174063067214312">*</span>CE1] <strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1783690793214312">interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1580145697214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword395419138214312">*</span>CE1-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1736791571214312"> portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen439369799214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword349362817214312">*</span>CE1-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b228058192214312"> undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen426544384214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1818968743214312">*</span>CE1-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b2022029203214312"> port link-type access</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1022055148214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1522602454214312">*</span>CE1-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b846253780214312"> port default vlan 30</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1440591778214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1798984911214312">*</span>CE1-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1628747536214312"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1062571021214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword550599704214312">*</span>CE1] <strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b464805747214312">interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1897472909214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1637434079214312">*</span>CE1-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b750119650214312"> portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen286883479214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword925289728214312">*</span>CE1-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1749367039214312"> undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1601020625214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword472196981214312">*</span>CE1-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1351850569214312"> port link-type access</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen624840539214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1745131075214312">*</span>CE1-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1658847091214312"> port default vlan 40</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1280078077214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword274835139214312">*</span>CE1-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1631120178214312"> quit</strong></pre>
<p id="EN-US_TASK_0172363178__en-us_task_0172363174_p669901479214028"># Configure CE2.</p>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1764148645214028">&lt;<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword2100689754214312">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b865382416214312">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen2038672215214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword564000655214312"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword166190727214312">HUAWEI</span>] <strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1373283103214312">sysname CE2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen2022524463214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword771362802214312">*</span><span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword2083319922214312">HUAWEI</span>] <strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1147773360214312">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen314057983214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword2109302786214312"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2] <strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b2136012480214312">vlan batch 10 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen896620016214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1593720805214312">*</span>CE2] <strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1304481122214312">interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1165968536214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1340602919214312">*</span>CE2-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1409417567214312"> portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen148194308214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword85420295214312">*</span>CE2-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1225547347214312"> undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen2022750182214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword816007882214312">*</span>CE2-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1567393422214312"> port link-type access</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1285850133214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1666976923214312">*</span>CE2-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1390056639214312"> port default vlan 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1018197732214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1843435442214312">*</span>CE2-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1429498360214312"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen107684491214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword855459563214312">*</span>CE2] <strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1638400261214312">interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1184009279214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1778861670214312">*</span>CE2-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1329436927214312"> portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen2056854381214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword2045381579214312">*</span>CE2-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b90501425214312"> undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen2140883216214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1107049620214312">*</span>CE2-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b555778222214312"> port link-type access</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen596949182214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1804917238214312">*</span>CE2-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b686352341214312"> port default vlan 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen908824957214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1601203001214312">*</span>CE2-GigabitEthernet<span>0/1/2</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1384854009214312"> quit</strong></pre>
</p></li><li><span>Configure trunk ports on CE 1 and CE 2 to allow frames with certain VLAN IDs to pass through.</span><p><p id="EN-US_TASK_0172363178__en-us_task_0172363174_p366125163214028"># Configure CE1.</p>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen267525369214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1940856998214312">*</span>CE1] <strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1329519210214312">interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen670538420214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1284430728214312">*</span>CE1-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1811900690214312"> portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1380037282214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1075220990214312">*</span>CE1-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1954986964214312"> undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1530413750214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword2034147196214312">*</span>CE1-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1711790255214312"> port link-type trunk</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen182820141214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword603496368214312">*</span>CE1-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1714814008214312"> port trunk allow-pass vlan 30 40</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen553602277214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword2133264774214312">*</span>CE1-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b48849302214312"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen71428915214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1732307230214312">*</span>CE1]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b898969203214312"> commit</strong></pre>
<p id="EN-US_TASK_0172363178__en-us_task_0172363174_p233427881214028"># Configure CE2.</p>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen338628580214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword478656661214312">*</span>CE2] <strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1004879203214312">interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1257043323214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1965489538214312">*</span>CE2-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1928138359214312"> portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1201744321214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1550511158214312">*</span>CE2-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b355365855214312"> undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen480553592214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword594507978214312">*</span>CE2-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1158015710214312"> port link-type trunk</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen371801710214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword345587654214312">*</span>CE2-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b210915851214312"> port trunk allow-pass vlan 10 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1267674266214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword1902448404214312">*</span>CE2-GigabitEthernet<span>0/1/3</span>]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b1013946315214312"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1437405391214028">[<span class="keyword" id="EN-US_TASK_0172363178__en-us_task_0172363174_keyword296449953214312">*</span>CE2]<strong id="EN-US_TASK_0172363178__en-us_task_0172363174_b242162260214312"> commit</strong></pre>
</p></li><li><span>Create VLANIF interfaces on the PE and assign IP addresses to the interfaces.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE]<strong> vlan batch 10 to 40</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE]<strong> interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>]<strong> portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>]<strong> port link-type trunk</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>]<strong> port trunk allow-pass vlan 30 40</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE]<strong> interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/2</span>]<strong> portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/2</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/2</span>]<strong> port link-type trunk</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/2</span>]<strong> port trunk allow-pass vlan 10 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-GigabitEthernet<span>0/1/2</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE]<strong> interface Vlanif 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Vlanif10] <strong>ip address 10.110.6.3 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Vlanif10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE]<strong> interface Vlanif 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Vlanif20] <strong>ip address 10.110.5.3 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Vlanif20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE]<strong> interface Vlanif 30</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Vlanif30] <strong>ip address 10.110.4.3 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Vlanif30] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE]<strong> interface Vlanif 40</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Vlanif40] <strong>ip address 10.110.3.3 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE-Vlanif40] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>On PCs in VLAN 10, configure the IP address 10.110.6.3/24 of VLANIF 10 as the default gateway address.</p>
<p>On PCs in VLAN 20, configure the IP address 10.110.5.3/24 of VLANIF 20 as the default gateway address.</p>
<p>On PCs in VLAN 30, configure the IP address 10.110.4.3/24 of VLANIF 30 as the default gateway address.</p>
<p>On PCs in VLAN 40, configure the IP address 10.110.3.3/24 of VLANIF 40 as the default gateway address.</p>
<p>After the configurations, PCs in VLANs 10, 20, 30, and 40 can ping each other successfully.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172363178__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p id="EN-US_TASK_0172363178__en-us_task_0172363174_p1595543417214028">Configuration file of CE1</p>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen2058512436214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1496025280214028"> sysname CE1</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen724691888214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen70470016214028"> vlan batch 30 40</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen75276894214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen290012474214028">interface GigabitEthernet<span>0/1/1</span></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1841142306214028"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1262824652214028"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1152648181214028"> port link-type access</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen506771645214028"> port default vlan 30</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen594796818214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1791674403214028">interface GigabitEthernet<span>0/1/2</span></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1413333113818"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen242752413381"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1439788034214028"> port link-type access</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen831844615214028"> port default vlan 40</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1580341135214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen879525296214028">interface GigabitEthernet<span>0/1/3</span></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1330917533819"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen61241627113820"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen2689314214028"> port link-type trunk</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen891597524214028"> port trunk allow-pass vlan 30 40</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen474343874214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen11211458214028">return</pre>
</li><li><p id="EN-US_TASK_0172363178__en-us_task_0172363174_p1483383372214028">Configuration file of CE2</p>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1548832979214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen560173363214028"> sysname CE2</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen312972032214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1803783712214028"> vlan batch 10 20</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1643147095214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1009680357214028">interface GigabitEthernet<span>0/1/1</span></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen48852973819"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen17268153023812"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1920645680214028"> port link-type access</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1189550172214028"> port default vlan 10</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen1095652522214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen681529255214028">interface GigabitEthernet<span>0/1/2</span></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen645261173814"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen842743313384"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen516297266214028"> port link-type access</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen846117034214028"> port default vlan 20</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen349215605214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen572900589214028">interface GigabitEthernet<span>0/1/3</span></pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen12507181419386"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen96925362381"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen727047880214028"> port link-type trunk</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen20139430214028"> port trunk allow-pass vlan 10 20</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen164634958214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363178__en-us_task_0172363174_screen486110996214028">return</pre>
</li><li><p>PE configuration file</p>
<pre class="screen">#</pre>
<pre class="screen"> sysname PE</pre>
<pre class="screen">#</pre>
<pre class="screen">vlan batch 10 to 40</pre>
<pre class="screen">#</pre>
<pre class="screen">interface Vlanif10</pre>
<pre class="screen"> ip address 10.110.6.3 255.255.255.0</pre>
<pre class="screen">#</pre>
<pre class="screen">interface Vlanif20</pre>
<pre class="screen"> ip address 10.110.5.3 255.255.255.0</pre>
<pre class="screen">#</pre>
<pre class="screen">interface Vlanif30</pre>
<pre class="screen"> ip address 10.110.4.3 255.255.255.0</pre>
<pre class="screen">#</pre>
<pre class="screen">interface Vlanif40</pre>
<pre class="screen"> ip address 10.110.3.3 255.255.255.0</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/1</span></pre>
<pre class="screen"> portswitch</pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> port link-type trunk</pre>
<pre class="screen"> port trunk allow-pass vlan 30 40</pre>
<pre class="screen">#</pre>
<pre class="screen">interface GigabitEthernet<span>0/1/2</span></pre>
<pre class="screen"> portswitch</pre>
<pre class="screen"> undo shutdown</pre>
<pre class="screen"> port link-type trunk</pre>
<pre class="screen"> port trunk allow-pass vlan 10 20</pre>
<pre class="screen">#</pre>
<pre class="screen">return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vlan_cfg_0033.html">Configuration Examples for VLANs
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vlan_cfg_0037.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vlan_cfg_0060.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>