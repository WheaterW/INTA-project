
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring VXLAN Gateways to Advertise Specific Types of Routes">
<meta name="abstract" content="To enable communication between VMs on different subnets, configure VXLAN gateways to exchange IRB or IP prefix routes. This configuration enables the gateways to learn the IP routes of the related hosts or the subnets where the hosts reside.">
<meta name="description" content="To enable communication between VMs on different subnets, configure VXLAN gateways to exchange IRB or IP prefix routes. This configuration enables the gateways to learn the IP routes of the related hosts or the subnets where the hosts reside.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1216.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1217.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0023c.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="h00847023">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="p00915595">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="p00915595">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0276943628">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring VXLAN Gateways to Advertise Specific Types of Routes</title>
</head>
<body><a name="EN-US_TASK_0276943628"></a><a name="EN-US_TASK_0276943628"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring VXLAN Gateways to Advertise Specific Types of Routes</h1>
<div class="taskbody"><p>To enable communication between VMs on different subnets, configure VXLAN gateways to exchange IRB or IP prefix routes. This configuration enables the gateways to learn the IP routes of the related hosts or the subnets where the hosts reside.</p>
<div class="context"><a name="EN-US_TASK_0276943628__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>By default, VXLAN gateways can exchange MAC routes, but must be configured to exchange IRB or IP prefix routes if VMs need to communicate across subnets. If an RR is deployed on the network, IRB or IP prefix routes must be exchanged only between the VXLAN gateways and RR.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Host routes can be advertised through IRB routes (recommended), IP prefix routes, or both. In contrast, network segment routes of hosts can be advertised through IP prefix routes only.</p>
</div></div>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0276943628__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure IRB route advertisement.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname">l2vpn-family evpn</span></b></a></span><p><p>The BGP-EVPN address family view is displayed.</p>
</p></li><li class="substepexpand"><span>Run one of the following commands based on the overlay network type to configure IRB route advertisement:</span><p><ul><li>For an IPv4 overlay network, run the <a href="cmdqueryname=peer+advertise+%28BGP-EVPN+address+family+view%29"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>advertise</span></strong> <strong><span>irb</span></strong> command.</li><li>For an IPv6 overlay network, run the <a href="cmdqueryname=peer+advertise+%28BGP-EVPN+address+family+view%29"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>advertise</span></strong> <strong><span>irbv6</span></strong> command.</li></ul>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li><li><span>Configure IP prefix route advertisement.</span><ol><li class="substepexpand"><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></span><p><p>The BGP view is displayed.</p>
</p></li><li class="substepexpand"><span>Run either of the following commands based on the overlay network type:</span><p><ul><li>For an IPv4 overlay network, run the <a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a> <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> command to enter the BGP-VPN instance IPv4 address family view.</li><li>For an IPv6 overlay network, run the <a href="cmdqueryname=ipv6-family"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> command to enter the BGP-VPN instance IPv6 address family view.</li></ul>
</p></li><li class="substepexpand"><span>Run either of the following commands based on the overlay network type:</span><p><ul><li>For an IPv4 overlay network, run the <a href="cmdqueryname=import-route"><b><span class="cmdname">import-route</span></b></a> { <strong><span>direct</span></strong> | <strong><span>isis</span></strong> <i><span class="varname">process-id</span></i> | <strong><span>ospf</span></strong> <i><span class="varname">process-id</span></i><span> | <strong><span>rip</span></strong> <i><span class="varname">process-id</span></i></span> | <strong><span>static</span></strong> } [ <strong><span>med</span></strong> <i><span class="varname">med</span></i> | <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> ] <sup>*</sup> command to import routes of other protocols to the BGP-VPN instance IPv4 address family.</li><li>For an IPv6 overlay network, run the <a href="cmdqueryname=import-route"><b><span class="cmdname">import-route</span></b></a> { <strong><span>direct</span></strong> | <strong><span>isis</span></strong> <i><span class="varname">process-id</span></i> | <strong><span>ospfv3</span></strong> <i><span class="varname">process-id</span></i><span> | <strong><span>ripng</span></strong> <i><span class="varname">process-id</span></i></span> | <strong><span>static</span></strong> } [ <strong><span>med</span></strong> <i><span class="varname">med</span></i> | <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> ] <sup>*</sup> command to import routes of other protocols to the BGP-VPN instance IPv6 address family.</li></ul>
<p>To advertise host IP routes, configure import of direct routes. To advertise the route to the network segment where hosts reside, configure a dynamic routing protocol (such as OSPF or OSPFv3) and then run either of the preceding commands based on the overlay network type to import the route into the dynamic routing protocol.</p>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=advertise+l2vpn+evpn"><b><span class="cmdname">advertise l2vpn evpn</span></b></a></span><p><p>IP prefix route advertisement is configured.</p>
</p><p><p>IP prefix routes are used to advertise host IP routes as well as the route to the network segment where the hosts reside. If many specific host routes exist, a VXLAN gateway can be configured to advertise an IP prefix route, which carries the routing information of the network segment where the hosts reside. After route advertisement, import the route to the target BGP-VPN instance address family, as this reduces the number of routes to be saved on the involved VXLAN gateway.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>A VXLAN gateway can advertise subnet routes only if the attached subnets are unique across the entire network.</p>
</li><li><p>After IP prefix route advertisement is configured, run the <a href="cmdqueryname=arp+vlink-direct-route+advertise"><b><span class="cmdname">arp vlink-direct-route advertise</span></b></a> or <a href="cmdqueryname=nd+vlink-direct-route+advertise"><b><span class="cmdname">nd vlink-direct-route advertise</span></b></a> command to advertise host routes. After this configuration, VM migration is restricted.</p>
</li></ul>
</div></div>
</p></li><li class="substepexpand"><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1216.html">Configuring VXLAN in Distributed Gateway Mode Using BGP EVPN
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan_cfg_1217.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vxlan6_cfg_0023c.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>