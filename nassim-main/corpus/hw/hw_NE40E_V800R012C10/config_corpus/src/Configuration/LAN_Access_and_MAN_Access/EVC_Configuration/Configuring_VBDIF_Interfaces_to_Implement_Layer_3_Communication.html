
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring VBDIF Interfaces to Implement Layer 3 Communication">
<meta name="abstract" content="VBDIF interfaces are Layer 3 logical interfaces. After creating VBDIF interfaces, you can configure Layer 3 features.">
<meta name="description" content="VBDIF interfaces are Layer 3 logical interfaces. After creating VBDIF interfaces, you can configure Layer 3 features.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evc_cfg_0000.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_evc_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evc_cfg_0030.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="h00847023,y00852169">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="EVC">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EVC">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="EVC">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="p00915595">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="h00847023">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172363384">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring VBDIF Interfaces to Implement Layer 3 Communication</title>
</head>
<body><a name="EN-US_TASK_0172363384"></a><a name="EN-US_TASK_0172363384"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring VBDIF Interfaces to Implement Layer 3 Communication</h1>
<div class="taskbody"><p>VBDIF interfaces are Layer 3 logical interfaces. After creating VBDIF interfaces, you can configure Layer 3 features.</p>
<div class="context"><a name="EN-US_TASK_0172363384__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><div class="p"><h4 class="sectiontitle">Usage Scenario</h4><p>When a device needs to communicate with a Layer 3 network through EVC, you can create a BD-based logical interface (namely, the VBDIF interface), because EVC defines Layer 2 interfaces, which do not support IP addresses. VBDIF interfaces are network layer interfaces and can be assigned IP addresses. Through these IP addresses, Layer 3 communication can be implemented through EVC.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Both Layer 2 traffic and Layer 3 traffic are transmitted over the VBDIF interface. Running the <a href="cmdqueryname=shutdown"><b><span class="cmdname">shutdown</span></b></a> command in the VBDIF interface view prohibits only Layer 3 traffic. After running the <a href="cmdqueryname=display+interface+vbdif"><b><span class="cmdname">display interface vbdif</span></b></a> command, you can view that traffic statistics still increase on this VBDIF interface.</p>
<p>To prohibit all traffic on the VBDIF interface, run the <a href="cmdqueryname=shutdown"><b><span class="cmdname">shutdown</span></b></a> command in the BD view.</p>
</div></div>
<h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring VBDIF interfaces to implement Layer 3 communication, complete the following task:</p>
<ul><li><a href="dc_vrp_evc_cfg_0003.html">Establish an EVC model</a>.</li></ul>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Configure the <a href="cmdqueryname=rewrite+pop"><b><span class="cmdname">rewrite pop</span></b></a> { <strong><span>single</span></strong> | <strong><span>double</span></strong> } command as an action to have all VLAN tags removed from packets.</p>
</div></div>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172363384__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <span><a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0172363384__en-us_task_0172363369_cmdname1275578372214312">system-view</span></b></a></span></span><p><p id="EN-US_TASK_0172363384__en-us_task_0172363369_p1280971140214312">The system view is displayed.</p>
</p></li><li><span>Run <a href="cmdqueryname=interface+vbdif"><b><span class="cmdname">interface vbdif</span></b></a> <i><span class="varname">bd-id</span></i></span><p><p>A VBDIF interface is created, and its view is displayed.</p>
</p><p><p>The VBDIF interface number must be the ID of a BD that has been created.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If an interface is bound to a BD, a VBDIF interface can be created for the BD only when the interface has EVC Layer 2 sub-interfaces encapsulated with untag, dot1q, or QinQ.</p>
</div></div>
</p></li><li><span>Run <span><a href="cmdqueryname=ip+address"><b><span class="cmdname">ip address</span></b></a> <i><span class="varname">ip-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } [ <strong><span>sub</span></strong> ]</span></span><p><p>An IP address is assigned to the VBDIF interface for communication at the network layer.</p>
</p><p><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If IP addresses assigned to VBDIF interfaces belong to different network segments, a routing protocol must be configured to provide reachable routes. Otherwise, VBDIF interfaces cannot communicate with each other at the network layer. For configurations of routing protocols, see <em><span class="keyword">NE40E</span> Configuration Guide - IP Routing</em>.</p>
</div></div>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=mtu"><b><span class="cmdname">mtu</span></b></a><i><span class="varname"> mtu</span></i></span><p><p>The maximum transmission unit (MTU) is configured for the VBDIF interface.</p>
</p><p><p>Generally, the IP layer controls the maximum length of frames that are sent each time. Any time the IP layer receives an IP packet to be sent, it checks which local interface the packet needs to be sent to and queries the MTU of the interface. Then, the IP layer compares the MTU with the length of the packets to be sent. If the packet length is greater than the MTU, the IP layer fragments the packet to ensure that the length of each fragment is smaller or equal to the MTU.</p>
<p>If forcible unfragmentation is configured, certain packets are lost during data transmission at the IP layer. To ensure jumbo packets are not dropped during transmission, you need to configure forcible fragmentation. In this case, you can run the <a href="cmdqueryname=mtu"><b><span class="cmdname">mtu</span></b></a> command to set the size of a fragment.</p>
<p>After using the <a href="cmdqueryname=mtu"><b><span class="cmdname">mtu</span></b></a> command to change the MTU of a VBDIF interface, you need to change the MTU of the peer VBDIF interface to ensure that the MTUs of both interfaces are the same. Otherwise, services may be interrupted.</p>
</p></li><li><span>(Optional) Run <a href="cmdqueryname=bandwidth"><b><span class="cmdname">bandwidth</span></b></a> <i><span class="varname">bandwidth</span></i></span><p><p>The bandwidth is configured for the VBDIF interface.</p>
<p>The bandwidth command mainly ensures that the network management station (NMS) can acquire the bandwidth of the VBDIF interface.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=forward-mode+loopback"><b><span class="cmdname">forward-mode loopback</span></b></a></span></span><p><p>The packet forwarding mode on a VBDIF interface is set to loopback.</p>
<p>After the <a href="cmdqueryname=forward-mode+loopback"><b><span class="cmdname">forward-mode loopback</span></b></a> command is run to set the packet forwarding mode to loopback, downstream MTU fragmentation is supported on a VBDIF interface, and only one copy of traffic forwarded by the VBDIF interface is collected in multicast traffic statistics.</p>
</p></li><li><span>(Optional) Run <span><a href="cmdqueryname=damping+time"><b><span class="cmdname">damping time</span></b></a> <i><span class="varname">delay-time</span></i></span></span><p><p>The BD damping function is enabled, and the delay after which the BD Down event is reported to the BDIF interface is set.</p>
</p><p><p>If all the interfaces added to a BD go Down, the BD will report a BD Down event to the corresponding BDIF interface, causing the BDIF interface status to change. The master/slave switchover will cause the BDIF interface to alternate frequently between Up and Down. As a result, network flapping occurs. To avoid this situation, enable the BD damping function on the BDIF interface. If the last Up interface in the BD becomes Down, the device enabled with the BD damping function will report the BD status to the BDIF interface after the set delay expires. If an interface in the BD becomes Up before the set delay expires, the BDIF interface status remains Up.</p>
</p></li><li><span>Run <span><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172363384__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After configuring a VBDIF interface, run the <a href="cmdqueryname=display+interface+vbdif"><b><span class="cmdname">display interface vbdif</span></b></a> command. The command output shows the physical status, link protocol status, IP address, and mask of a VBDIF interface.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evc_cfg_0000.html">EVC Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_evc_cfg_0001.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_evc_cfg_0030.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>