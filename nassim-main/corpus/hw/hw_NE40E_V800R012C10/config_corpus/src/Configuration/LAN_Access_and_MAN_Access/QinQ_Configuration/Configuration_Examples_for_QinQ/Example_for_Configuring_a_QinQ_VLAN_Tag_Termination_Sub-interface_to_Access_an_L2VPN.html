
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a QinQ VLAN Tag Termination Sub-interface to Access an L2VPN">
<meta name="abstract" content="This example shows how to configure the QinQ VLAN tag termination sub-interface to access a Layer 2 virtual private network (L2VPN). This configuration ensures that users communicate over the L2VPN using double-tagged packets.">
<meta name="description" content="This example shows how to configure the QinQ VLAN tag termination sub-interface to access a Layer 2 virtual private network (L2VPN). This configuration ensures that users communicate over the L2VPN using double-tagged packets.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0023_1.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0032.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0034.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wwx1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172363312">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring a QinQ VLAN Tag Termination Sub-interface to Access an L2VPN</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172363312"></a><a name="EN-US_TASK_0172363312"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a QinQ VLAN Tag Termination Sub-interface to Access an L2VPN</h1>
<div class="taskbody"><p>This example shows how to configure the QinQ VLAN tag termination sub-interface to access a Layer 2 virtual private network (L2VPN). This configuration ensures that users communicate over the L2VPN using double-tagged packets.</p>
<div class="context"><a name="EN-US_TASK_0172363312__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>When a VLAN tag termination sub-interface is used to access a L2VPN network, this sub-interface needs to be bound to a Virtual Switching Instance (VSI) or virtual private wire service (VPWS) to enable Layer 2 communication.</p>
<p>On the network shown in <a href="#EN-US_TASK_0172363312__fig_dc_vrp_qinq_cfg_003301">Figure 1</a>, the CEs connect to the PEs through <span class="keyword">Router</span>s, and the <span class="keyword">Router</span>s access the L2VPN through QinQ VLAN tag termination sub-interfaces. The packets sent from the <span class="keyword">Router</span>s to the PEs carry two VLAN tags. QinQ VLAN tag termination sub-interfaces need to be configured on PE1, PE2, and PE3 and bound to VSIs or L2VCs to access the L2VPN, implementing interworking between CEs 1 through 6.</p>
<div class="fignone" id="EN-US_TASK_0172363312__fig_dc_vrp_qinq_cfg_003301"><a name="EN-US_TASK_0172363312__fig_dc_vrp_qinq_cfg_003301"></a><a name="fig_dc_vrp_qinq_cfg_003301"></a><span class="figcap"><b>Figure 1 </b>Typical networking for configuring the QinQ VLAN tag termination sub-interface to access an L2VPN</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interfaces 1 through 3 and sub-interface1.1 represent GE<span>0/1/1</span>, GE<span>0/1/2</span>, GE<span>0/1/3</span>, and GE<span>0/1/1</span>.1, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_qinq_cfg_003301.png"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363312__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>L2VPNs include VPWS and VPLS networks.</p>
<ul><li id="EN-US_TASK_0172363312__en-us_task_0172363279_li849573426214028"><p id="EN-US_TASK_0172363312__en-us_task_0172363279_p161801879214028"><a name="EN-US_TASK_0172363312__en-us_task_0172363279_li849573426214028"></a><a name="en-us_task_0172363279_li849573426214028"></a>VPWS</p>
<p id="EN-US_TASK_0172363312__en-us_task_0172363279_p603589404214028">VPWS is a point-to-point virtual leased line technology and supports almost all link layer protocols. VPWS simulates the traditional leased line services on IP networks and provides asymmetric and low-cost digital data network (DDN) services. For users on both ends of the leased line, VPWS is similar to the traditional leased line services.</p>
</li><li id="EN-US_TASK_0172363312__en-us_task_0172363279_li178086690214028"><p id="EN-US_TASK_0172363312__en-us_task_0172363279_p1658278559214028"><a name="EN-US_TASK_0172363312__en-us_task_0172363279_li178086690214028"></a><a name="en-us_task_0172363279_li178086690214028"></a>VPLS</p>
<p id="EN-US_TASK_0172363312__en-us_task_0172363279_p1666655620214028">VPLS makes a multipoint-to-multipoint VPN networking possible. With VPLS, the carrier can transmit Ethernet-based multipoint-to-multipoint services for users over an MPLS backbone network.</p>
</li></ul>
<p>A VPLS network is used in this example to describe how to access an L2VPN using QinQ VLAN tag termination sub-interfaces so that CEs can communicate over the L2VPN. Configurations on a VPWS network are the same as those on a VPLS network except that the user-side sub-interfaces on PEs are configured as QinQ VLAN tag termination sub-interfaces and bound to an L2VC to access the L2VPN.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363312__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure the Layer 2 forwarding function on the CEs so that the packets sent by the CEs to the <span class="keyword">Router</span>s carry one VLAN tag.</p>
</li><li><p>Configure the QinQ and Layer 2 forwarding functions on the <span class="keyword">Router</span>s so that the packets sent by the <span class="keyword">Router</span>s to the PEs carry two VLAN tags.</p>
</li><li><p>Configure a VPLS network and QinQ VLAN tag termination sub-interfaces on the PEs and bind these sub-interfaces to a VSI so that users can communicate over the VPLS network.</p>
<ol type="a"><li><p>Configure a routing protocol on the PEs so that these devices can communicate on the Layer 3 network.</p>
<p>Open Shortest Path First (OSPF) is used in this example.</p>
</li><li>Configure basic Multiprotocol Label Switching (MPLS) functions and MPLS Label Distribution Protocol (LDP) on the PEs, and set up MPLS Label Switched Paths (LSPs) between these devices.</li><li>Enable MPLS L2VPN on the PEs globally.</li><li>Configure a VSI and QinQ VLAN tag termination sub-interfaces on the PEs, and bind these sub-interfaces to the VSI to access the L2VPN.</li></ol>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363312__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li>Users' VLAN IDs and IP addresses</li><li>Outer VLAN tag in the packets sent from the <span class="keyword">Router</span>s to the PEs</li><li>Names of the interfaces that connect the <span class="keyword">Router</span>s and the CEs, names of the interfaces that connect the PEs and the <span class="keyword">Router</span>s, and names and IP addresses of the interfaces that connect the PEs</li><li>MPLS LSR IDs, VSI ID, VSI name, and name and IP address of each interface bound to the VSI on the PEs</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172363312__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure the Layer 2 forwarding function on the CEs.</span><p><p># Configure CE1.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname CE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-vlan10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/1</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>interface gigabitethernet <span>0/1/1</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/1</span>.1] <strong>ip address 10.1.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/1</span>.1] <strong>vlan-type dot1q 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1-GigabitEthernet<span>0/1/1</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>commit</strong></pre>
<p># Configure CE2.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname CE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-vlan10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>interface gigabitethernet <span>0/1/1</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>.1] <strong>ip address 10.1.1.2 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>.1] <strong>vlan-type dot1q 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2-GigabitEthernet<span>0/1/1</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE2] <strong>commit</strong></pre>
<p># Configure CE3.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname CE3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE3] <strong>vlan 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-vlan10] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-GigabitEthernet<span>0/1/1</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3] <strong>interface gigabitethernet <span>0/1/1</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-GigabitEthernet<span>0/1/1</span>.1] <strong>ip address 10.1.1.3 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-GigabitEthernet<span>0/1/1</span>.1] <strong>vlan-type dot1q 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3-GigabitEthernet<span>0/1/1</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE3] <strong>commit</strong></pre>
<p># Configure CE4.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname CE4</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE4] <strong>vlan 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE4-vlan20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE4] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE4-GigabitEthernet<span>0/1/1</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE4-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE4] <strong>interface gigabitethernet <span>0/1/1</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE4-GigabitEthernet<span>0/1/1</span>.1] <strong>ip address 10.2.1.1 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE4-GigabitEthernet<span>0/1/1</span>.1] <strong>vlan-type dot1q 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE4-GigabitEthernet<span>0/1/1</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE4] <strong>commit</strong></pre>
<p># Configure CE5.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname CE5</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE5] <strong>vlan 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE5-vlan20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE5] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE5-GigabitEthernet<span>0/1/1</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE5-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE5] <strong>interface gigabitethernet <span>0/1/1</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE5-GigabitEthernet<span>0/1/1</span>.1] <strong>ip address 10.2.1.2 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE5-GigabitEthernet<span>0/1/1</span>.1] <strong>vlan-type dot1q 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE5-GigabitEthernet<span>0/1/1</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE5] <strong>commit</strong></pre>
<p># Configure CE6.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname CE6</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE6] <strong>vlan 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE6-vlan20] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE6] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE6-GigabitEthernet<span>0/1/1</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE6-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE6] <strong>interface gigabitethernet <span>0/1/1</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE6-GigabitEthernet<span>0/1/1</span>.1] <strong>ip address 10.2.1.3 24</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE6-GigabitEthernet<span>0/1/1</span>.1] <strong>vlan-type dot1q 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE6-GigabitEthernet<span>0/1/1</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>CE6] <strong>commit</strong></pre>
</p></li><li><span>Configure the QinQ and Layer 2 forwarding functions on the <span class="keyword">Router</span>s.</span><p><p># Configure <span class="keyword">Device</span> A.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>A</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>vlan 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-vlan100] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>] <strong>port vlan-stacking vlan 10 stack-vlan 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>] <strong>port vlan-stacking vlan 20 stack-vlan 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/3</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/3</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/3</span>] <strong>port link-type trunk</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/3</span>] <strong>port trunk allow-pass vlan 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-GigabitEthernet<span>0/1/3</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span> B.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>B</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>vlan 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-vlan100] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/1</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/1</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/1</span>] <strong>port vlan-stacking vlan 10 stack-vlan 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/2</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/2</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/2</span>] <strong>port vlan-stacking vlan 20 stack-vlan 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/3</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/3</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/3</span>] <strong>port link-type trunk</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/3</span>] <strong>port trunk allow-pass vlan 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B-GigabitEthernet<span>0/1/3</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span> C.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>C</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>vlan 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-vlan100] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/1</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/1</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/1</span>] <strong>port vlan-stacking vlan 10 stack-vlan 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/1</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/2</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/2</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/2</span>] <strong>port vlan-stacking vlan 20 stack-vlan 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/2</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/3</span>] <strong>undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/3</span>] <strong>portswitch</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/3</span>] <strong>port link-type trunk</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/3</span>] <strong>port trunk allow-pass vlan 100</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-GigabitEthernet<span>0/1/3</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>commit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172363312__en-us_task_0172363299_p637825194214028">If the device does not support the <strong><span id="EN-US_TASK_0172363312__en-us_task_0172363299_cmdparmname516997901214028">port vlan-stacking</span></strong> command, you can run the <a href="cmdqueryname=port+link-type+dot1q-tunnel"><b><span class="cmdname" id="EN-US_TASK_0172363312__en-us_task_0172363299_cmdname1201003618214028">port link-type dot1q-tunnel</span></b></a> command and <a href="cmdqueryname=port+default+vlan"><b><span class="cmdname" id="EN-US_TASK_0172363312__en-us_task_0172363299_cmdname1581172039214028">port default vlan</span></b></a> command on the interface to configure the QinQ function.</p>
</div></div>
</p></li><li><span>Configure a VPLS network.</span><p><ol type="a"><li><p id="EN-US_TASK_0172363312__en-us_task_0172363310_p1823307295214028">Configure OSPF on the PEs.</p>
<p id="EN-US_TASK_0172363312__en-us_task_0172363310_p1480903679214028">Assign an IP address to each interface on each PE. After OSPF is enabled, the 32-bit loopback interface address of each PE must be advertised.</p>
<p id="EN-US_TASK_0172363312__en-us_task_0172363310_p834807353214028"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1587573233214028">&lt;<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1254378480214028">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1148723455214028">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen985428621214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword385066282214028"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1440773163214028">HUAWEI</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b165471182214028">sysname PE1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen604979007214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword974590543214028">*</span><span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1085480532214028">HUAWEI</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b540623392214028">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen434083573214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword132505406214028"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b47786298214028">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen2023939361214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1893722507214028">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1992245600214028">ip address 1.1.1.9 32</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1421537787214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword566745371214028">*</span>PE1-LoopBack1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1163330875214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen378288285214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword621420977214028">*</span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1761678293214028">interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen399992771214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword795848871214028">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1450148835214028">ip address 192.168.1.1 30</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen503132525214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1033769192214028">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b621047064214028">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen282109357214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1791583013214028">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b567495659214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1644346510214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1860439796214028">*</span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1587770859214028">interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1044921890214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword414414652214028">*</span>PE1-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1741201918214028">ip address 192.168.3.1 30</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen9360279214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword850538661214028">*</span>PE1-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b158149095214028">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen328873101214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword612728869214028">*</span>PE1-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1288824930214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1279838110214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword366640512214028">*</span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b2130643081214028">ospf</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen423657703214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword391774988214028">*</span>PE1-ospf-1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b797436907214028">area 0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1998250201214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1280281132214028">*</span>PE1-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b654357712214028">network 1.1.1.9 0.0.0.0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen195212686214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword2005591746214028">*</span>PE1-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b401645760214028">network 192.168.1.0 0.0.0.3</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1905850922214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1740522720214028">*</span>PE1-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1721696604214028">network 192.168.3.0 0.0.0.3</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen308723935214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1195621454214028">*</span>PE1-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1107406599214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1304824493214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1555311388214028">*</span>PE1-ospf-1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1828362919214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen618997173214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword7071284214028">*</span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b121745489214028">commit</strong></pre>
<p id="EN-US_TASK_0172363312__en-us_task_0172363310_p729002357214028"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1269022914214028">&lt;<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword452164437214028">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b224456716214028">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen2054108551214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword868666134214028"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1077881832214028">HUAWEI</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b130961944214028">sysname PE2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen954962788214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1916739488214028">*</span><span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword238386169214028">HUAWEI</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b846501598214028">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1848072193214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1280137841214028"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b265231909214028">interface LoopBack 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1406278695214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword114156572214028">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b2110731834214028">ip address 2.2.2.9 32</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1734584254214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword255816974214028">*</span>PE2-LoopBack1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1995952620214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1875521156214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1022103956214028">*</span>PE2] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1341361473214028">interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen2117782580214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword732996328214028">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1152348110214028">ip address 192.168.2.2 30</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1203359703214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1445766416214028">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b921039549214028">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen145683966214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1407813472214028">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1409627978214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen710481660214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword156089998214028">*</span>PE2] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b189389251214028">interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen47526001214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword109156394214028">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1091754934214028">ip address 192.168.3.2 30</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen456873803214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1089153604214028">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b342524164214028">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1971705946214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword11959721214028">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1319451849214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1672612682214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1311015334214028">*</span>PE2] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b550044287214028">ospf</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1917198087214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1710018898214028">*</span>PE2-ospf-1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1129435961214028">area 0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen342075613214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1098948394214028">*</span>PE2-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b64950179214028">network 2.2.2.9 0.0.0.0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1900872477214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword358203806214028">*</span>PE2-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b742393302214028">network 192.168.2.0 0.0.0.3</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1884162714214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1935709821214028">*</span>PE2-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b733031193214028">network 192.168.3.0 0.0.0.3</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1647477310214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword801985103214028">*</span>PE2-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1229196785214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen626187043214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1288768781214028">*</span>PE2-ospf-1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1891298751214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen911548661214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1401887771214028">*</span>PE2] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1336365227214028">commit</strong></pre>
<p id="EN-US_TASK_0172363312__en-us_task_0172363310_p238414201214028"># Configure PE3.</p>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1420475077214028">&lt;<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1591443770214028">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1258701056214028">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1803258400214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword830184813214028"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword714897532214028">HUAWEI</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b232547588214028">sysname PE3</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen780714047214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1964260197214028">*</span><span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword55025648214028">HUAWEI</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b62415408214028">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1534104944214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword243215219214028"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b2040143354214028">interface loopback 1</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen601597378214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword976779286214028">*</span>PE3-LoopBack1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1684703472214028">ip address 3.3.3.9 32</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen824617832214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1470367133214028">*</span>PE3-LoopBack1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b930351637214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1130336401214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword97167199214028">*</span>PE3] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b937434325214028">interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen382914570214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1257548385214028">*</span>PE3-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1461084726214028">ip address 192.168.1.2 30</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen317406883214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword711325514214028">*</span>PE3-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1796617832214028">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1631766823214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1423398221214028">*</span>PE3-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1806577111214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen624942060214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword622843028214028">*</span>PE3] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b565888054214028">interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen792400767214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword459837315214028">*</span>PE3-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b403887355214028">ip address 192.168.2.1 30</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen720896892214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1402227354214028">*</span>PE3-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1930092212214028">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1028281968214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1413521087214028">*</span>PE3-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b62550695214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen144134395214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1103062362214028">*</span>PE3] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b604423337214028">ospf</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1827705237214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword542586325214028">*</span>PE3-ospf-1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b144373490214028">area 0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1162023867214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword504119180214028">*</span>PE3-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1927896333214028">network 3.3.3.9 0.0.0.0</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen885066224214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword998975285214028">*</span>PE3-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b855963612214028">network 192.168.1.0 0.0.0.255</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen544420068214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1214342215214028">*</span>PE3-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b21417352214028">network 192.168.2.0 0.0.0.255</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen236145071214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword687733679214028">*</span>PE3-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b2077094069214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1291816908214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1641244606214028">*</span>PE3-ospf-1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b590863699214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen130029163214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1063277631214028">*</span>PE3] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1640346130214028">commit</strong></pre>
<p id="EN-US_TASK_0172363312__en-us_task_0172363310_p1566380223214028">After the configurations are complete, PE1 and PE2 both have routes, discovered by OSPF, to loopback1 of each other. PE1 and PE3 also have routes, discovered by OSPF, to loopback1 of each other. And they can ping each other successfully.</p>
<p id="EN-US_TASK_0172363312__en-us_task_0172363310_p1985605244214028">The following example uses the command output on PE1.</p>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1978330469214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword232986323214028"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1277815692214028">display ip routing-table</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1675701605214028"><span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1416328477214028">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route</span>
------------------------------------------------------------------------------
Routing Table : _public_
         Destinations : 14       Routes : 14

Destination/Mask    Proto  Pre  Cost        Flags NextHop         Interface

        1.1.1.9/32  Direct 0    0             D  127.0.0.1       LoopBack1
        2.2.2.9/32  OSPF   10   1             D  192.168.3.2     GigabitEthernet<span>0/1/3</span>
        3.3.3.9/32  OSPF   10   1             D  192.168.1.2     GigabitEthernet<span>0/1/2</span>
    192.168.1.0/24  Direct 0    0             D  192.168.1.1     GigabitEthernet<span>0/1/2</span>
    192.168.1.1/32  Direct 0    0             D  127.0.0.1       GigabitEthernet<span>0/1/2</span>
  192.168.1.255/32  Direct 0    0             D  127.0.0.1       GigabitEthernet<span>0/1/2</span>
    192.168.2.0/24  OSPF   10   2             D  192.168.3.2     GigabitEthernet<span>0/1/3</span>
                    OSPF   10   2             D  192.168.1.2     GigabitEthernet<span>0/1/2</span>
    192.168.3.0/24  Direct 0    0             D  192.168.3.1     GigabitEthernet<span>0/1/3</span>
    192.168.3.1/32  Direct 0    0             D  127.0.0.1       GigabitEthernet<span>0/1/3</span>
  192.168.3.255/32  Direct 0    0             D  127.0.0.1       GigabitEthernet<span>0/1/3</span>
       127.0.0.0/8  Direct 0    0             D  127.0.0.1       InLoopBack0
      127.0.0.1/32  Direct 0    0             D  127.0.0.1       InLoopBack0
127.255.255.255/32  Direct 0    0             D  127.0.0.1       InLoopBack0
255.255.255.255/32  Direct 0    0             D  127.0.0.1       InLoopBack0</pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen691130959214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1426198252214028">*</span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1120406687214028">ping 192.168.2.2</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen920825464214028">  PING 192.168.2.2: 56  data bytes, press CTRL_C to break
    Reply from 192.168.2.2: bytes=56 Sequence=1 ttl=254 time=6 ms
    Reply from 192.168.2.2: bytes=56 Sequence=2 ttl=254 time=2 ms
    Reply from 192.168.2.2: bytes=56 Sequence=3 ttl=254 time=1 ms
    Reply from 192.168.2.2: bytes=56 Sequence=4 ttl=254 time=2 ms
    Reply from 192.168.2.2: bytes=56 Sequence=5 ttl=254 time=1 ms

  --- 192.168.2.2 ping statistics ---
    5 packet(s) transmitted
    5 packet(s) received
    0.00% packet loss
    round-trip min/avg/max = 1/2/6 ms</pre>
</li><li><p id="EN-US_TASK_0172363312__en-us_task_0172363310_p210519356214028">Enable basic MPLS functions and MPLS LDP.</p>
<p id="EN-US_TASK_0172363312__en-us_task_0172363310_p965430894214028"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen862943938214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1924303370214028">*</span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b13402107214028">mpls lsr-id 1.1.1.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1097875342214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword308383340214028">*</span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b953057546214028">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1232642547214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword437096325214028">*</span>PE1-mpls] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1709411024214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen267372161214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1436663415214028">*</span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1965608366214028">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1759526062214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword806886036214028">*</span>PE1-mpls-ldp] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b985796376214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1843805946214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1937155269214028">*</span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b803459988214028">interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen222388103214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword382197614214028">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b175938070214028">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1241197342214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword34052767214028">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b165159704214028">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen331872222214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword60210792214028">*</span>PE1-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1490386647214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen52591642214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword565856022214028">*</span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1162584975214028">interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1318511257214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword832463055214028">*</span>PE1-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b2141358207214028">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen367211809214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword291866278214028">*</span>PE1-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1951431542214028">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1605218722214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword381994538214028">*</span>PE1-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b532011289214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen477288525214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1899694753214028">*</span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b2054709182214028">commit</strong></pre>
<p id="EN-US_TASK_0172363312__en-us_task_0172363310_p166933371214028"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen834560617214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1356299354214028"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b182890947214028">mpls lsr-id 2.2.2.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1373936513214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword2081243594214028">*</span>PE2] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b2022701740214028">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen2046409596214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1917252827214028">*</span>PE2-mpls] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b375407111214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen73349652214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword2115595598214028">*</span>PE2] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1216203947214028">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen256342084214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1583489426214028">*</span>PE2-mpls-ldp] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1383262762214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen288379110214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword592909140214028">*</span>PE2] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1815626328214028">interface gigabitethernet<span>0/1/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1190189292214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword2021557406214028">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b2045963358214028">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1574717524214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword122929056214028">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1614102579214028">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen167160670214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1710105062214028">*</span>PE2-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b621177732214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1956504700214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1567038200214028">*</span>PE2] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1640352314214028">interface gigabitethernet<span>0/1/3</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1574832036214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1529951430214028">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b442316965214028">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen503151720214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword749965072214028">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b452644763214028">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen2017792157214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword567812794214028">*</span>PE2-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1881028888214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen775068899214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1359398195214028">*</span>PE2] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1666689098214028">commit</strong></pre>
<p id="EN-US_TASK_0172363312__en-us_task_0172363310_p1016294143214028"># Configure PE3.</p>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1445416906214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1632042120214028"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1334197010214028">mpls lsr-id 3.3.3.9</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1380028509214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1392367382214028">*</span>PE3] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1526798643214028">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen945338855214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword69778941214028">*</span>PE3-mpls] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1198537460214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1063280538214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword309658172214028">*</span>PE3] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b54408931214028">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen942689809214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword818113637214028">*</span>PE3-mpls-ldp] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b559937487214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1156254377214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword604376352214028">*</span>PE3] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1177069432214028">interface gigabitethernet <span>0/1/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen885374767214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1135913997214028">*</span>PE3-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1240692738214028">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1120575996214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword2061939715214028">*</span>PE3-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b650578936214028">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen545406106214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1767416130214028">*</span>PE3-GigabitEthernet<span>0/1/2</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b404010813214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1563244301214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1462328990214028">*</span>PE3] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1894575070214028">interface gigabitethernet <span>0/1/3</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen408081228214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword244527778214028">*</span>PE3-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1371485965214028">mpls</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen656047475214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1671620924214028">*</span>PE3-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b684184413214028">mpls ldp</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen790382549214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword606487417214028">*</span>PE3-GigabitEthernet<span>0/1/3</span>] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1754412535214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen739905247214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1344116650214028">*</span>PE3] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b316544093214028">commit</strong></pre>
<p id="EN-US_TASK_0172363312__en-us_task_0172363310_p1810338834214028">After the configurations are complete, LDP sessions are set up between between PE1 and PE2, and between PE1 and PE3. Run the <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b30147664214028">display mpls ldp session</strong> command. The command output shows that the LDP session status is <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b231678827214312">Operational</strong>.</p>
<p id="EN-US_TASK_0172363312__en-us_task_0172363310_p794885927214028">The following example uses the command output on PE1.</p>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1425307031214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword606971821214028"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1717063119214028">display mpls ldp session</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1665301083214028"> LDP Session(s) in Public Network
 Codes: LAM(Label Advertisement Mode), SsnAge Unit(DDDD:HH:MM)
<span> An asterisk (*) before a session means the session is being deleted.</span>
--------------------------------------------------------------------------
 PeerID             Status       LAM  SsnRole  SsnAge       KASent/Rcv
--------------------------------------------------------------------------
 2.2.2.9:0          <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b711468002214028">Operational</strong>  DU   Passive  0000:00:01   6/6
 3.3.3.9:0          <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1895511970214028">Operational</strong>  DU   Passive  0000:00:00   1/1
--------------------------------------------------------------------------
TOTAL: 2 Session(s) Found.</pre>
<div class="note" id="EN-US_TASK_0172363312__en-us_task_0172363310_note221141955214028"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172363312__en-us_task_0172363310_p1586128375214028">If PEs are not directly connected, run the <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b340622129214028">mpls ldp remote-peer</strong> command and <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1137743646214028">remote-ip</strong> command to set up a remote LDP session between PEs.</p>
</div></div>
</li><li><p id="EN-US_TASK_0172363312__en-us_task_0172363310_p349329047214028">Enable MPLS L2VPN.</p>
<p id="EN-US_TASK_0172363312__en-us_task_0172363310_p379117113214028"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1054935915214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1915313243214028">*</span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1257426158214028">mpls l2vpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1238409757214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword538365533214028">*</span>PE1-l2vpn] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b909108800214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1575153680214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword113319863214028">*</span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b282837819214028">commit</strong></pre>
<p id="EN-US_TASK_0172363312__en-us_task_0172363310_p245880864214028"># Configure PE2.</p>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen2141665408214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1526971882214028"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1965136177214028">mpls l2vpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen263491171214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword1779389464214028">*</span>PE2-l2vpn] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b729745298214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen873587148214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword425667365214028">*</span>PE2] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1453480964214028">commit</strong></pre>
<p id="EN-US_TASK_0172363312__en-us_task_0172363310_p242143899214028"># Configure PE3.</p>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1904436267214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword474182385214028"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b213355271214028">mpls l2vpn</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen936358319214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword409553637214028">*</span>PE3-l2vpn] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1153132600214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen1373913783214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword247454707214028">*</span>PE3] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1770375375214028">commit</strong></pre>
</li><li><p>Configure a VSI and bind the QinQ VLAN tag termination sub-interfaces to the VSI.</p>
<p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>vsi ldp1 static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-ldp1] <strong>pwsignal ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-ldp1-ldp] <strong>vsi-id 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-ldp1-ldp] <strong>peer 2.2.2.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-ldp1-ldp] <strong>peer 3.3.3.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-ldp1-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-vsi-ldp1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/1/1</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>.1] <strong>control-vid 1 qinq-termination</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>.1] <strong>qinq termination l2 symmetry</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>.1] <strong>qinq termination pe-vid 100 ce-vid 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>.1] <strong>qinq termination pe-vid 100 ce-vid 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>.1] <strong>l2 binding vsi ldp1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2] <strong>vsi ldp1 static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vsi-ldp1] <strong>pwsignal ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vsi-ldp1-ldp] <strong>vsi-id 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vsi-ldp1-ldp] <strong>peer 1.1.1.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vsi-ldp1-ldp] <strong>peer 3.3.3.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vsi-ldp1-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-vsi-ldp1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet <span>0/1/1</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>.1] <strong>control-vid 1 qinq-termination</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>.1] <strong>qinq termination l2 symmetry</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>.1] <strong>qinq termination pe-vid 100 ce-vid 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>.1] <strong>qinq termination pe-vid 100 ce-vid 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>.1] <strong>l2 binding vsi ldp1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>commit</strong></pre>
<p># Configure PE3.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE3] <strong>vsi ldp1 static</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-vsi-ldp1] <strong>pwsignal ldp</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-vsi-ldp1-ldp] <strong>vsi-id 2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-vsi-ldp1-ldp] <strong>peer 1.1.1.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-vsi-ldp1-ldp] <strong>peer 2.2.2.9</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-vsi-ldp1-ldp] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-vsi-ldp1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>interface gigabitethernet <span>0/1/1</span>.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/1</span>.1] <strong>control-vid 1 qinq-termination</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/1</span>.1] <strong>qinq termination l2 symmetry</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/1</span>.1] <strong>qinq termination pe-vid 100 ce-vid 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/1</span>.1] <strong>qinq termination pe-vid 100 ce-vid 20</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/1</span>.1] <strong>l2 binding vsi ldp1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3-GigabitEthernet<span>0/1/1</span>.1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE3] <strong>commit</strong></pre>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172363312__en-us_task_0172363307_p577660652214028">When you run the <strong id="EN-US_TASK_0172363312__en-us_task_0172363307_b990890360214028">qinq termination</strong> command on an interface, if the <em id="EN-US_TASK_0172363312__en-us_task_0172363307_i1562836517214028">pe-vid</em> values of the two different sub-interfaces are the same, make sure that the <em id="EN-US_TASK_0172363312__en-us_task_0172363307_i2074358658214028">ce-vid</em> values are different.</p>
</div></div>
<div class="p">After the configurations are complete, run the <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1013834421112">display vsi name ldp1 verbose</strong> command on PE1. The command output shows that PWs to PE2 and PE3 are set up on the VSI named <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1813814419119">ldp1</strong> and that the VSI status is <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b313834491112">up</strong>.<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen575687504214028">[<span class="keyword" id="EN-US_TASK_0172363312__en-us_task_0172363310_keyword2013953476214028"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b1409353229214028">display vsi name ldp1 verbose</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363312__en-us_task_0172363310_screen977296739214028"> ***VSI Name               : ldp1
    Administrator VSI      : no
    Isolate Spoken         : disable
    VSI Index              : 1
    PW Signaling           : ldp
    Member Discovery Style : static
<span>    Bridge-domain Mode     : disable</span>
    PW MAC Learn Style     : unqualify
    Encapsulation Type     : vlan
    MTU                    : 1500
    Diffserv Mode          : uniform
    Service Class          : --
    Color                  : --
    DomainId               : 255
    Domain Name            :
    Ignore AcState         : disable
    P2P VSI                : disable
    Create Time            : 0 days, 0 hours, 3 minutes, 8 seconds
    VSI State              : <strong id="EN-US_TASK_0172363312__en-us_task_0172363310_b2099425454214028">up</strong>

    VSI ID                 : 2
   *Peer Router ID         : 2.2.2.9
    primary or secondary   : primary
    ignore-standby-state   : no
    VC Label               : 17
    Peer Type              : dynamic
    Session                : up
    Tunnel ID              :0x0000000001006a5c21
    Broadcast Tunnel ID    : --
    Broad BackupTunnel ID  : --
    CKey                   : 1
    NKey                   : 3154116711
    Stp Enable             : 0
    PwIndex                : 0
<span>    Control Word           : disable</span>
   *Peer Router ID         : 3.3.3.9
    primary or secondary   : primary
    ignore-standby-state   : no
    VC Label               : 18
    Peer Type              : dynamic
    Session                : up
    Tunnel ID              : 0x0000000001004c4b43
    Broadcast Tunnel ID    : --
    Broad BackupTunnel ID  : --
    CKey                   : 2
    NKey                   : 3154116712
    Stp Enable             : 0
    PwIndex                : 0
<span>    Control Word           : disable</span>

    Interface Name         : GigabitEthernet<span>0/1/1</span>.1
    State                  : up
    Access Port            : false
    Last Up Time           : 2012/07/19 03:19:14
    Total Up Time          : 0 days, 0 hours, 3 minutes, 11 seconds

  **PW Information:

   *Peer Ip Address        : 2.2.2.9
    PW State               : up
    Local VC Label         : 17
    Remote VC Label        : 17
<span>    Remote Control Word    : disable</span>
    PW Type                : label
    Tunnel ID              : 0x0000000001006a5c21
    Broadcast Tunnel ID    : --
    Broad BackupTunnel ID  : --
    Ckey                   : 1
    Nkey                   : 3154116711
    Main PW Token          : 0x0
    Slave PW Token         : 0x0
    Tnl Type               : ldp
    OutInterface           : LDP LSP
    Backup OutInterface    :
    Stp Enable             : 0
    PW Last Up Time        : 2012/07/19 03:21:09
    PW Total Up Time       : 0 days, 0 hours, 0 minutes, 29 seconds
   *Peer Ip Address        : 3.3.3.9
    PW State               : up
    Local VC Label         : 18
    Remote VC Label        : 17
<span>    Remote Control Word    : disable</span>
    PW Type                : label
    Tunnel ID              : 0x0000000001004c4b43
    Broadcast Tunnel ID    : --
    Broad BackupTunnel ID  : --
    Ckey                   : 2
    Nkey                   : 3154116712
    Main PW Token          : 0x0
    Slave PW Token         : 0x0
    Tnl Type               : ldp
    OutInterface           : LDP LSP
    Backup OutInterface    :
    Stp Enable             : 0
    PW Last Up Time        : 2012/07/19 03:21:09
    PW Total Up Time       : 0 days, 0 hours, 0 minutes, 29 seconds</pre>
</div>
</li></ol>
</p></li><li><span>Verify the configuration.</span><p><p>After the configurations are complete, run the <strong>display qinq information termination interface</strong> command to view information about the QinQ VLAN tag termination sub-interfaces. The command output shows that the sub-interfaces are bound to the VSI.</p>
<p>Use the command output on PE1 as an example.</p>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>display qinq information termination interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">  GigabitEthernet<span>0/1/1</span>.1
    <strong>VSI bound</strong>
    qinq termination l2 symmetry
    Total QinQ Num: 2
      qinq termination pe-vid 100 ce-vid 10
      qinq termination pe-vid 100 ce-vid 20
    Total vlan-group Num: 0
    encapsulation qinq-termination</pre>
<p>Hosts attached to CE1, CE2, and CE3 can ping each other.</p>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>ping 10.1.1.2</strong></pre>
<pre class="screen">  PING 10.1.1.2: 56  data bytes, press CTRL_C to break
    Reply from 10.1.1.2: bytes=56 Sequence=1 ttl=255 time=43 ms
    Reply from 10.1.1.2: bytes=56 Sequence=2 ttl=255 time=33 ms
    Reply from 10.1.1.2: bytes=56 Sequence=3 ttl=255 time=98 ms
    Reply from 10.1.1.2: bytes=56 Sequence=4 ttl=255 time=181 ms
    Reply from 10.1.1.2: bytes=56 Sequence=5 ttl=255 time=129 ms

  --- 10.1.1.2 ping statistics ---
    5 packet(s) transmitted
    5 packet(s) received
    0.00% packet loss
    round-trip min/avg/max = 33/96/181 ms</pre>
<pre class="screen">[<span class="keyword">*</span>CE1] <strong>ping 10.1.1.3</strong></pre>
<pre class="screen">  PING 10.1.1.3: 56  data bytes, press CTRL_C to break
    Reply from 10.1.1.3: bytes=56 Sequence=1 ttl=255 time=3 ms
    Reply from 10.1.1.3: bytes=56 Sequence=2 ttl=255 time=2 ms
    Reply from 10.1.1.3: bytes=56 Sequence=3 ttl=255 time=2 ms
    Reply from 10.1.1.3: bytes=56 Sequence=4 ttl=255 time=2 ms
    Reply from 10.1.1.3: bytes=56 Sequence=5 ttl=255 time=2 ms

  --- 10.1.1.3 ping statistics ---
    5 packet(s) transmitted
    5 packet(s) received
    0.00% packet loss
    round-trip min/avg/max = 2/2/3 ms</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172363312__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#
 sysname PE1
#
 mpls lsr-id 1.1.1.9
#
 mpls
#
 mpls l2vpn
#
vsi ldp1 static
 pwsignal ldp
  vsi-id 2
  peer 3.3.3.9
  peer 2.2.2.9
#
mpls ldp
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/1</span>.1
 encapsulation qinq-termination
 qinq termination l2 symmetry
 qinq termination pe-vid 100 ce-vid 10
 qinq termination pe-vid 100 ce-vid 20
 l2 binding vsi ldp1
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 192.168.1.1 255.255.255.252
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/1/3</span>
 undo shutdown
 ip address 192.168.3.1 255.255.255.252
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 1.1.1.9 255.255.255.255
#
ospf 1
 area 0.0.0.0
  network 1.1.1.9 0.0.0.0
  network 192.168.1.0 0.0.0.3
  network 192.168.3.0 0.0.0.3
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
 sysname PE2
#
 mpls lsr-id 2.2.2.9
#
 mpls
#
 mpls l2vpn
#
vsi ldp1 static
 pwsignal ldp
  vsi-id 2
  peer 1.1.1.9
  peer 3.3.3.9
#
mpls ldp
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/1</span>.1
 encapsulation qinq-termination
 qinq termination l2 symmetry
 qinq termination pe-vid 100 ce-vid 10
 qinq termination pe-vid 100 ce-vid 20
 l2 binding vsi ldp1
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 192.168.2.2 255.255.255.252
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/1/3</span>
 undo shutdown
 ip address 192.168.3.2 255.255.255.252
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 2.2.2.9 255.255.255.255
#
ospf 1
 area 0.0.0.0
  network 2.2.2.9 0.0.0.0
  network 192.168.3.0 0.0.0.3
  network 192.168.2.0 0.0.0.3
#
return</pre>
</li><li><p>PE3 configuration file</p>
<pre class="screen">#
 sysname PE3
#
 mpls lsr-id 3.3.3.9
#
 mpls
#
 mpls l2vpn
#
vsi ldp1 static
 pwsignal ldp
  vsi-id 2
  peer 1.1.1.9
  peer 2.2.2.9
#
mpls ldp
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/1</span>.1
 encapsulation qinq-termination
 qinq termination l2 symmetry
 qinq termination pe-vid 100 ce-vid 10
 qinq termination pe-vid 100 ce-vid 20
 l2 binding vsi ldp1
#
interface GigabitEthernet<span>0/1/2</span>
 undo shutdown
 ip address 192.168.1.2 255.255.255.252
 mpls
 mpls ldp
#
interface GigabitEthernet<span>0/1/3</span>
 undo shutdown
 ip address 192.168.2.1 255.255.255.252
 mpls
 mpls ldp
#
interface LoopBack1
 ip address 3.3.3.9 255.255.255.255
#
ospf 1
 area 0.0.0.0
  network 3.3.3.9 0.0.0.0
  network 192.168.1.0 0.0.0.3
  network 192.168.2.0 0.0.0.3
#
return</pre>
</li><li><p><span class="keyword">Device</span> A configuration file</p>
<pre class="screen">#
 sysname <span class="keyword">Device</span>A
#
 vlan batch 100
#
interface GigabitEthernet<span>0/1/3</span>
 portswitch
 undo shutdown
 port link-type trunk
 port trunk allow-pass vlan 100
#
interface GigabitEthernet<span>0/1/1</span>
 portswitch
 undo shutdown
 port vlan-stacking vlan 10 stack-vlan 100
#
interface GigabitEthernet<span>0/1/2</span>
 portswitch
 undo shutdown
 port vlan-stacking vlan 20 stack-vlan 100
#
return</pre>
</li><li><p><span class="keyword">Device</span> B configuration file</p>
<pre class="screen">#
 sysname <span class="keyword">Device</span>B
#
 vlan batch 100
#
interface GigabitEthernet<span>0/1/3</span>
 portswitch
 undo shutdown
 port link-type trunk
 port trunk allow-pass vlan 100
#
interface GigabitEthernet<span>0/1/1</span>
 portswitch
 undo shutdown
 port vlan-stacking vlan 10 stack-vlan 100
#
interface GigabitEthernet<span>0/1/2</span>
 portswitch
 undo shutdown
 port vlan-stacking vlan 20 stack-vlan 100
#
return</pre>
</li><li><p><span class="keyword">Device</span> C configuration file</p>
<pre class="screen">#
 sysname <span class="keyword">Device</span>C
#
 vlan batch 100
#
interface GigabitEthernet<span>0/1/3</span>
 portswitch
 undo shutdown
 port link-type trunk
 port trunk allow-pass vlan 100
#
interface GigabitEthernet<span>0/1/1</span>
 portswitch
 undo shutdown
 port vlan-stacking vlan 10 stack-vlan 100
#
interface GigabitEthernet<span>0/1/2</span>
 portswitch
 undo shutdown
 port vlan-stacking vlan 20 stack-vlan 100
#
return</pre>
</li><li><p>CE1 configuration file</p>
<pre class="screen">#
 sysname CE1
#
 vlan batch 10
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/1</span>.1
 vlan-type dot1q 10
 ip address 10.1.1.1 255.255.255.0
#
return</pre>
</li><li><p>CE2 configuration file</p>
<pre class="screen">#
 sysname CE2
#
 vlan batch 10
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/1</span>.1
 vlan-type dot1q 10
 ip address 10.1.1.2 255.255.255.0
#
return</pre>
</li><li><p>CE3 configuration file</p>
<pre class="screen">#
 sysname CE3
#
 vlan batch 10
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/1</span>.1
 vlan-type dot1q 10
 ip address 10.1.1.3 255.255.255.0
#
return</pre>
</li><li><p>CE4 configuration file</p>
<pre class="screen">#
 sysname CE4
#
 vlan batch 20
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/1</span>.1
 vlan-type dot1q 20
 ip address 10.2.1.1 255.255.255.0
#
return</pre>
</li><li><p>CE5 configuration file</p>
<pre class="screen">#
 sysname CE5
#
 vlan batch 20
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/1</span>.1
 vlan-type dot1q 20
 ip address 10.2.1.2 255.255.255.0
#
return</pre>
</li><li><p>CE6 configuration file</p>
<pre class="screen">#
 sysname CE6
#
 vlan batch 20
#
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
#
interface GigabitEthernet<span>0/1/1</span>.1
 vlan-type dot1q 20
 ip address 10.2.1.3 255.255.255.0
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0023_1.html">Configuration Examples for QinQ
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0032.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0034.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>