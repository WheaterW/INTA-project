
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring MSTP Protection Functions">
<meta name="abstract" content="Multiple Spanning Tree Protocol (MSTP) protection functions are as follows, and you can configure one or more functions as required.">
<meta name="description" content="Multiple Spanning Tree Protocol (MSTP) protection functions are as follows, and you can configure one or more functions as required.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0021.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0060.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0028.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0029.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_stp_cfg_0026.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0030.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0031.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0032.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_stp_cfg_0035b.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0033.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MSTP">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MSTP">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="MSTP">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wwx1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172363635">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring MSTP Protection Functions</title>
</head>
<body><a name="EN-US_TASK_0172363635"></a><a name="EN-US_TASK_0172363635"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring MSTP Protection Functions</h1>
<div class="taskbody"><p>Multiple Spanning Tree Protocol (MSTP) protection functions are as follows, and you can configure one or more functions as required.</p>
<div class="context"><a name="EN-US_TASK_0172363635__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Applicable Environment</h4><p>MSTP provides the following protection functions, as listed in <a href="#EN-US_TASK_0172363635__tab_dc_vrp_mstp_cfg_0003_01">Table 1</a>.</p>

<div class="tableBorder"><a name="EN-US_TASK_0172363635__tab_dc_vrp_mstp_cfg_0003_01"></a><a name="tab_dc_vrp_mstp_cfg_0003_01"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172363635__tab_dc_vrp_mstp_cfg_0003_01" frame="border" border="1" rules="all"><caption><b>Table 1 </b>MSTP protection</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="17.330000000000002%" id="mcps1.4.1.3.2.4.1.1" liSelected="liSelected"><p>MSTP Protection</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="32.67%" id="mcps1.4.1.3.2.4.1.2" liSelected="liSelected"><p>Scenario</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="50%" id="mcps1.4.1.3.2.4.1.3" liSelected="liSelected"><p>Configuration Impact</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="17.330000000000002%" headers="mcps1.4.1.3.2.4.1.1 "><p>BPDU protection</p>
</td>
<td class="cellrowborder" valign="top" width="32.67%" headers="mcps1.4.1.3.2.4.1.2 "><p id="EN-US_TASK_0172363635__p_01">An edge port changes to be a non-edge port after receiving a BPDU, which triggers spanning tree recalculation. If an attacker keeps sending bogus BPDUs to a <span class="keyword" id="EN-US_TASK_0172363635__keyword700081560214030">device</span>, network flapping occurs.</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.4.1.3.2.4.1.3 "><p id="EN-US_TASK_0172363635__p_02">After BPDU protection is enabled on the <span class="keyword" id="EN-US_TASK_0172363635__keyword192491473198">device</span>, the <span class="keyword" id="EN-US_TASK_0172363635__keyword1761851861918">device</span> shuts down the edge port if the edge port receives an RST BPDU, and notifies the NMS of the shutdown event. The attributes of the edge port are not changed.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="17.330000000000002%" headers="mcps1.4.1.3.2.4.1.1 "><p>TC protection</p>
</td>
<td class="cellrowborder" valign="top" width="32.67%" headers="mcps1.4.1.3.2.4.1.2 "><p id="EN-US_TASK_0172363635__p_06">Generally, after receiving TC-BPDUs (packets for advertising network topology changes), a <span class="keyword" id="EN-US_TASK_0172363635__keyword112757302191">device</span> needs to delete MAC entries and ARP entries. Frequent deletion operations will exhaust CPU resources.</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.4.1.3.2.4.1.3 "><p id="EN-US_TASK_0172363635__p_04">TC protection is used to suppress TC-BPDUs. The number of times that TC-BPDUs are processed by a <span class="keyword" id="EN-US_TASK_0172363635__keyword16357838121917">device</span> within a given time period is configurable. If the number of TC-BPDUs that the <span class="keyword" id="EN-US_TASK_0172363635__keyword97018435190">device</span> receives within the given time exceeds the specified threshold, the <span class="keyword" id="EN-US_TASK_0172363635__keyword720185713197">device</span> handles TC-BPDUs only for the specified number of times. Excessive TC-BPDUs are processed by the <span class="keyword" id="EN-US_TASK_0172363635__keyword178518815209">device</span> as a whole for once after the timeout period expires. This protects the device from frequently deleting MAC entries and ARP entries, thus avoiding over-burden.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="17.330000000000002%" headers="mcps1.4.1.3.2.4.1.1 "><p>Root protection </p>
</td>
<td class="cellrowborder" valign="top" width="32.67%" headers="mcps1.4.1.3.2.4.1.2 "><p id="EN-US_TASK_0172363635__p_00">Due to incorrect configurations or malicious attacks on the network, a root bridge may receive BPDUs with a higher priority. Consequently, the legitimate root bridge is no longer able to serve as the root bridge, and the network topology is illegitimately changed, triggering spanning tree recalculation. This may transfer traffic from high-speed links to low-speed links, causing traffic congestion.</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.4.1.3.2.4.1.3 "><p id="EN-US_TASK_0172363635__p_03">To address this issue, the root protection function can be configured to protect the root bridge by preserving the role of the designated port. With this function, when the designated port receives RST BPDUs with a higher priority, the port enters the Discarding state and does not forward the BPDUs. If the port does not receive any RST BPDUs with a higher priority for a certain period (double the Forward Delay), the port transitions to the Forwarding state.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="17.330000000000002%" headers="mcps1.4.1.3.2.4.1.1 "><p>Loop protection</p>
</td>
<td class="cellrowborder" valign="top" width="32.67%" headers="mcps1.4.1.3.2.4.1.2 "><p id="EN-US_TASK_0172363635__p_07">A root port or an alternate port will age if link congestion or a one-way link failure occurs. After the root port ages, a device may re-select a root port incorrectly and after the alternate port ages, the port enters the Forwarding state. Loops may occur in such a situation.</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.4.1.3.2.4.1.3 "><p id="EN-US_TASK_0172363635__p_05">The loop protection function can be used to prevent such network loops. If the root port or alternate port cannot receive RST BPDUs from the upstream device, the root port is blocked and the device notifies the NMS that the port enters the Discarding state. The blocked port remains in the Blocked state and no longer forwards packets. This prevents loops on the network. The root port restores the Forwarding state after new RST BPDUs are received.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="17.330000000000002%" headers="mcps1.4.1.3.2.4.1.1 "><p>Share-link protection</p>
</td>
<td class="cellrowborder" valign="top" width="32.67%" headers="mcps1.4.1.3.2.4.1.2 "><p>In the scenario where a <span class="keyword">device</span> is dual-homed to a network, when the share link of multiple processes fails, loops may occur.</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.4.1.3.2.4.1.3 "><p>Share-link protection can address such a problem. This function forcibly changes the working mode of the local <span class="keyword">device</span> to RSTP. Share-link protection needs to be used together with root protection to avoid network loops.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="17.330000000000002%" headers="mcps1.4.1.3.2.4.1.1 "><p>Abnormal packet filtering</p>
</td>
<td class="cellrowborder" valign="top" width="32.67%" headers="mcps1.4.1.3.2.4.1.2 "><p>On a network running STP, RSTP, or MSTP, a device may receive unexpected STP, RSTP, or MSTP BPDUs due to incorrect configurations or malicious network attacks. If these unexpected packets are transparently transmitted on the network, spanning tree calculation may be affected, causing network flapping. </p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.4.1.3.2.4.1.3 "><p>After the function to filter abnormal packets is enabled, the device discards the packets carrying a specified source MAC address or VLAN ID. In this manner, unexpected packets are not transparently transmitted on the network, preventing network flapping.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>After a device normally starts, there is a default MSTP process with the ID 0. MSTP configurations in the system view and interface view both belong to this process.</p>
</li><li><p>For more information about MSTP multi-process configuration, see <a href="dc_vrp_mstp_cfg_0013.html">Configuring MSTP Multi-process</a>.</p>
</li></ul>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363635__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Pre-configuration Tasks</h4><p>Before configuring MSTP protection functions on a <span class="keyword">device</span>, complete the following task:</p>
<ul><li><p>Configure basic MSTP functions.</p>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Configure an edge port on the <span class="keyword">device</span> before configuring BPDU protection.</p>
</div></div>
</li></ul>
</div></div>
</div>

<ul class="ullinks">
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0028.html">Configuring BPDU Protection</a>
</dt>
<dd>
After bridge protocol data unit (BPDU) protection is enabled on a <span class="keyword">device</span>, the <span class="keyword">device</span> shuts down an edge port if the edge port receives a BPDU, and notifies the NMS of the shutdown event.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0029.html">Configuring TC Protection</a>
</dt>
<dd>
After Topology Change (TC) protection is enabled, you can set the number of times for a Multiple Spanning Tree Protocol (MSTP) process to process TC-BPDUs within <span>a specified time</span>. TC protection avoids frequent deletion of MAC address entries and ARP entries, thereby protecting devices.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_stp_cfg_0026.html">Configuring TC/TCN Packet Suppression</a>
</dt>
<dd>
If TC/TCN packets do not need to be flooded, you can enable TC/TCN packet suppression.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0030.html">Configuring Root Protection on an Interface</a>
</dt>
<dd>
The root protection function on a <span class="keyword">device</span> protects a root bridge by preserving the role of a designated port.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0031.html">Configuring Loop Protection on an Interface</a>
</dt>
<dd>
The loop protection function suppresses the loops caused by link congestion.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0032.html">Configuring Share-Link Protection on a Device</a>
</dt>
<dd>
The share-link protection function on a <span class="keyword">device</span> helps automatically transition to the Rapid Spanning Tree Protocol (RSTP) working mode. It can also be used together with root protection to avoid network loops.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_stp_cfg_0035b.html">Configuring Abnormal Packet Filtering</a>
</dt>
<dd>
You can configure the <span class="keyword">device</span> to process or discard specified packets in order to filter unexpected packets.</dd>
</dl>
<dl>
<dt>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0033.html">Verifying the MSTP Protection Function Configuration</a>
</dt>
<dd>
After Multiple Spanning Tree Protocol (MSTP) protection functions are configured, verify the configuration.</dd>
</dl>
</ul>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0001.html">MSTP Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0021.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_mstp_cfg_0060.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>