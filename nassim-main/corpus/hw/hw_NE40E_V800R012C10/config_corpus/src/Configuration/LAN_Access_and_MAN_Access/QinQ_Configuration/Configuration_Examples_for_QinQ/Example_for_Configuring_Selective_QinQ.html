
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Selective QinQ">
<meta name="abstract" content="This section provides an example for configuring Layer 2 selective QinQ. Layer 2 selective QinQ is an extension to Layer 2 QinQ tunneling and is more flexible. When receiving packets, a Layer 2 selective QinQ-enabled interface can add different outer tags depending on the inner tags of the packets, making user VLAN classification more fine-grained.">
<meta name="description" content="This section provides an example for configuring Layer 2 selective QinQ. Layer 2 selective QinQ is an extension to Layer 2 QinQ tunneling and is more flexible. When receiving packets, a Layer 2 selective QinQ-enabled interface can add different outer tags depending on the inner tags of the packets, making user VLAN classification more fine-grained.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0023_1.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0025_1.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0052.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="wwx1238417">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="QinQ">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="c00648116,w00437000">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wWX1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172363294">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Selective QinQ</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172363294"></a><a name="EN-US_TASK_0172363294"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Selective QinQ</h1>
<div class="taskbody"><p>This section provides an example for configuring Layer 2 selective QinQ. Layer 2 selective QinQ is an extension to Layer 2 QinQ tunneling and is more flexible. When receiving packets, a Layer 2 selective QinQ-enabled interface can add different outer tags depending on the inner tags of the packets, making user VLAN classification more fine-grained.</p>
<div class="context"><a name="EN-US_TASK_0172363294__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0172363294__en-us_task_0172363203_context1754400945214028"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p657120908214028">On the network shown in <a href="#EN-US_TASK_0172363294__en-us_task_0172363203_fig_dc_vrp_qinq_cfg_005101">Figure 1</a>, company 1 and company 2 each have multiple offices.</p>
<ul id="EN-US_TASK_0172363294__en-us_task_0172363203_ul308930087214028"><li id="EN-US_TASK_0172363294__en-us_task_0172363203_li719097603214028"><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p1982931952214028"><a name="EN-US_TASK_0172363294__en-us_task_0172363203_li719097603214028"></a><a name="en-us_task_0172363203_li719097603214028"></a>VLANs 2 to 500 are used on the network of company 1.</p>
</li><li id="EN-US_TASK_0172363294__en-us_task_0172363203_li1034627904214028"><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p816092769214028"><a name="EN-US_TASK_0172363294__en-us_task_0172363203_li1034627904214028"></a><a name="en-us_task_0172363203_li1034627904214028"></a>VLANs 501 to 4094 are used on the network of company 2.</p>
</li><li id="EN-US_TASK_0172363294__en-us_task_0172363203_li1420091904214028"><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p351377770214028"><a name="EN-US_TASK_0172363294__en-us_task_0172363203_li1420091904214028"></a><a name="en-us_task_0172363203_li1420091904214028"></a>GE <span>0/1/1</span> on <span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword26151140214028">Device</span> A receives packets from different VLANs of company 1 and company 2.</p>
</li></ul>
<p id="EN-US_TASK_0172363294__en-us_task_0172363203_p1316362110214028">Layer 2 selective QinQ is required on GE <span>0/1/1</span> of <span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword740605470214028">Device</span> A on the carrier network so that the office networks of each company can communicate with each other, but the office networks of different companies cannot.</p>
<div class="fignone" id="EN-US_TASK_0172363294__en-us_task_0172363203_fig_dc_vrp_qinq_cfg_005101"><a name="EN-US_TASK_0172363294__en-us_task_0172363203_fig_dc_vrp_qinq_cfg_005101"></a><a name="en-us_task_0172363203_fig_dc_vrp_qinq_cfg_005101"></a><span class="figcap"><b>Figure 1 </b>Networking of selective QinQ</span><div class="note" id="EN-US_TASK_0172363294__en-us_task_0172363203_note1962660259214028"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p1082155093214028">In this example, interfaces 1 through 3 represent GE<span>0/1/1</span>, GE<span>0/2/1</span>, and GE<span>0/3/1</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0172363294__en-us_task_0172363203_image165816491409" src="figure/en-us_image_0000001505350536.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363294__1.4.2"></a><a name="1.4.2"></a>
<div class="p" id="EN-US_TASK_0172363294__en-us_task_0172363203_context903918761214028"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p1381992131214028">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0172363294__en-us_task_0172363203_ol307091983214028"><li id="EN-US_TASK_0172363294__en-us_task_0172363203_li430181367214028"><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p1628279367214028"><a name="EN-US_TASK_0172363294__en-us_task_0172363203_li430181367214028"></a><a name="en-us_task_0172363203_li430181367214028"></a>Configure default outer VLAN IDs.</p>
</li><li id="EN-US_TASK_0172363294__en-us_task_0172363203_li1558127706214028"><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p1036763224214028"><a name="EN-US_TASK_0172363294__en-us_task_0172363203_li1558127706214028"></a><a name="en-us_task_0172363203_li1558127706214028"></a>Configure Layer 2 selective QinQ on Layer 2 interfaces so that the interfaces can add different outer VLAN tags to packets.</p>
</li><li id="EN-US_TASK_0172363294__en-us_task_0172363203_li1955243929214028"><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p989948309214028"><a name="EN-US_TASK_0172363294__en-us_task_0172363203_li1955243929214028"></a><a name="en-us_task_0172363203_li1955243929214028"></a>Configure other Layer 2 selective QinQ-incapable interfaces to forward packets carrying a specific outer VLAN ID.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172363294__1.4.3"></a><a name="1.4.3"></a>
<div class="p" id="EN-US_TASK_0172363294__en-us_task_0172363203_context1117218788214028"><h4 class="sectiontitle">Data Preparation</h4><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p577854610214028">To complete the configuration, you need the following data:</p>
<ul id="EN-US_TASK_0172363294__en-us_task_0172363203_ul574949991214028"><li id="EN-US_TASK_0172363294__en-us_task_0172363203_li234233209214028"><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p420018712214028"><a name="EN-US_TASK_0172363294__en-us_task_0172363203_li234233209214028"></a><a name="en-us_task_0172363203_li234233209214028"></a>Number of the access interfaces of company 1 and company 2</p>
</li><li id="EN-US_TASK_0172363294__en-us_task_0172363203_li448185998214028"><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p1436918357214028"><a name="EN-US_TASK_0172363294__en-us_task_0172363203_li448185998214028"></a><a name="en-us_task_0172363203_li448185998214028"></a>Outer VLAN IDs that Layer 2 interfaces on <span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1833215584214028">Device</span> A and <span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword233952835214028">Device</span> B add to packets from different companies</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172363294__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0172363294__en-us_task_0172363203_steps1367120224214028"><li id="EN-US_TASK_0172363294__en-us_task_0172363203_step839129186214028"><span id="EN-US_TASK_0172363294__en-us_task_0172363203_cmd719119253214028">Create default outer VLAN IDs on Layer 2 interfaces.</span><p><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p552208894214028"># Configure <span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1094667214214028">Device</span> A.</p>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen176956998214028">&lt;<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword243470298214028">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b2072774310214028">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen123217434214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1565594110214028"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1970563726214028">HUAWEI</span>] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1961074103214028">sysname <span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1918698844214028">Device</span>A</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen112979062214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1979914733214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1167807266214028">HUAWEI</span>] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1604509986214028">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1314394496214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1613601536214028"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1377521236214028">Device</span>A]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1081645652214028"> vlan batch 10 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1328761776214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword2113607776214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1878886205214028">Device</span>A]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1242120900214028"> commit</strong></pre>
<p id="EN-US_TASK_0172363294__en-us_task_0172363203_p1701663855214028"># Configure <span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1395592842214028">Device</span> B.</p>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1256525493214028">&lt;<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword203412909214028">HUAWEI</span>&gt; <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1382064585214028">system-view</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1249627119214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword508904642214028"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1880435740214028">HUAWEI</span>] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b2115181281214028">sysname <span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword482258220214028">Device</span>B</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1229778967214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword481396748214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1264245387214028">HUAWEI</span>] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1881584836214028">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1140662135214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword550962037214028"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword69469995214028">Device</span>B]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1040706692214028"> vlan batch 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen797728676214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1244287469214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword543736997214028">Device</span>B]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1969215486214028"> commit</strong></pre>
</p></li><li id="EN-US_TASK_0172363294__en-us_task_0172363203_step944032314214028"><span id="EN-US_TASK_0172363294__en-us_task_0172363203_cmd741917362214028">Configure Layer 2 selective QinQ on Layer 2 interfaces.</span><p><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p2056424931214028"># Configure <span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1946056677214028">Device</span> A.</p>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen932825467214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1401868977214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1168805202214028">Device</span>A] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b88705301214028">interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1165036514214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword338411064214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1138055392214028">Device</span>A-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1453830951214028">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1349942370214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1010484979214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword920361577214028">Device</span>A-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1521113840214028"> port vlan-stacking vlan 2 to 500 stack-vlan 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen59180510214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword830183959214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword700544354214028">Device</span>A-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b816747212214028"> port vlan-stacking vlan 1000 to 2000 stack-vlan 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1586083501214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1142266744214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1720845875214028">Device</span>A-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1264166761214028">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1258534236214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1515886341214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1903228826214028">Device</span>A-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b269319164214028">quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen294477227214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword210696222214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword2118352898214028">Device</span>A]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1523824864214028"> interface gigabitethernet <span>0/2/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen711939553214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword200262459214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword704273564214028">Device</span>A-GigabitEthernet<span>0/2/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b83317651214028"> portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1129199006214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1337242161214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1612634072214028">Device</span>A-GigabitEthernet<span>0/2/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1861974013214028"> port vlan-stacking vlan 100 to 500 stack-vlan 10</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen537032116214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1504278532214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword84311193214028">Device</span>A-GigabitEthernet<span>0/2/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1700964661214028"> undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen467358126214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword353852036214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword808950509214028">Device</span>A-GigabitEthernet<span>0/2/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1443949643214028"> commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen494639633214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword542814076214028"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword565642876214028">Device</span>A-GigabitEthernet<span>0/2/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1501003595214028"> quit</strong></pre>
<p id="EN-US_TASK_0172363294__en-us_task_0172363203_p1892450431214028"># Configure <span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1856116598214028">Device</span> B.</p>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1796882165214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1155354550214028"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword496785676214028">Device</span>B] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b4826741214028">interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen404708276214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1005610867214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword605539779214028">Device</span>B-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1123662929214028">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen642380329214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1338611232214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1000290252214028">Device</span>B-GigabitEthernet<span>0/1/1</span>] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b89207184214028">port vlan-stacking vlan 1000 to 4094 stack-vlan 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1438471411214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1524969830214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword2098089512214028">Device</span>B-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1000738839214028"> undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen839709380214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1134450062214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1342373968214028">Device</span>B-GigabitEthernet<span>0/1/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1103385885214028"> quit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1677807479214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1541295923214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1612827747214028">Device</span>B]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1065809285214028"> interface gigabitethernet <span>0/2/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen409918109214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword811081654214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1770651269214028">Device</span>B-GigabitEthernet<span>0/2/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b251841616214028"> portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen281407601214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword863749398214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword46678466214028">Device</span>B-GigabitEthernet<span>0/2/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1264619280214028"> port vlan-stacking vlan 501 to 2500 stack-vlan 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen2006616086214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1299093287214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword394635560214028">Device</span>B-GigabitEthernet<span>0/2/1</span>] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1408071283214028">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen244233913214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1515201101214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1123818381214028">Device</span>B-GigabitEthernet<span>0/2/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1511070842214028"> commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen610555006214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword62228909214028"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword56737474214028">Device</span>B-GigabitEthernet<span>0/2/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b2008118989214028"> quit</strong></pre>
</p></li><li id="EN-US_TASK_0172363294__en-us_task_0172363203_step478531529214028"><span id="EN-US_TASK_0172363294__en-us_task_0172363203_cmd353149888214028">Configure other interfaces.</span><p><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p1546083730214028"># Configure GE <span>0/3/1</span> on <span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword275599972214028">Device</span> A to forward packets carrying outer VLAN ID 20.</p>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1107884515214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1333940569214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1957352150214028">Device</span>A] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b919704866214028">interface gigabitethernet <span>0/3/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1284774741214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1488956240214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword260587189214028">Device</span>A-GigabitEthernet<span>0/3/1</span>] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1315142206214028">portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1870381582214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword601287086214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1921495267214028">Device</span>A-GigabitEthernet<span>0/3/1</span>] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1502880807214028">port trunk allow-pass vlan 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen420040744214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword849909446214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1514322725214028">Device</span>A-GigabitEthernet<span>0/3/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1279743951214028"> undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1512121663214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword2049528801214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword792860527214028">Device</span>A-GigabitEthernet<span>0/3/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b655939271214028"> commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1854525879214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword382082767214028"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword688960439214028">Device</span>A-GigabitEthernet<span>0/3/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b509785850214028"> quit</strong></pre>
<p id="EN-US_TASK_0172363294__en-us_task_0172363203_p291379009214028"># Configure GE <span>0/3/1</span> on <span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword762802791214028">Device</span> B to forward packets carrying outer VLAN ID 20.</p>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1554188278214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword958113486214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1180973996214028">Device</span>B] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b619412575214028">interface gigabitethernet <span>0/3/1</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen653973589214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword861373028214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword909217169214028">Device</span>B-GigabitEthernet<span>0/3/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1092886824214028"> portswitch</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1116197171214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword10736350214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword57208102214028">Device</span>B-GigabitEthernet<span>0/3/1</span>]<strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1136856675214028"> port trunk allow-pass vlan 20</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen999212111214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword2076195589214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword157484220214028">Device</span>B-GigabitEthernet<span>0/3/1</span>] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b598850534214028">undo shutdown</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1440347288214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword905224600214028">*</span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1335696852214028">Device</span>B-GigabitEthernet<span>0/3/1</span>] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b815047177214028">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1921808279214028">[<span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword547361201214028"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1827245106214028">Device</span>B-GigabitEthernet<span>0/3/1</span>] <strong id="EN-US_TASK_0172363294__en-us_task_0172363203_b1982937172214028">quit</strong></pre>
</p></li><li id="EN-US_TASK_0172363294__en-us_task_0172363203_step1146136611214028"><span id="EN-US_TASK_0172363294__en-us_task_0172363203_cmd189707487214028">Verify the configuration.</span><p><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p2017380585214028">Hosts in different offices but the same VLAN can ping each other in company 1.</p>
<p id="EN-US_TASK_0172363294__en-us_task_0172363203_p2134312652214028">Hosts in different offices but the same VLAN can ping each other in company 2.</p>
<p id="EN-US_TASK_0172363294__en-us_task_0172363203_p966486393214028">Hosts in company 1 and hosts in company 2 cannot ping each other.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0172363294__en-us_task_0172363203_example1277886095214028"><a name="EN-US_TASK_0172363294__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul id="EN-US_TASK_0172363294__en-us_task_0172363203_ul1161848437214028"><li id="EN-US_TASK_0172363294__en-us_task_0172363203_li1203825282214028"><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p1248076187214028"><a name="EN-US_TASK_0172363294__en-us_task_0172363203_li1203825282214028"></a><a name="en-us_task_0172363203_li1203825282214028"></a><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1943694660214028">Device</span> A configuration file</p>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen863467828214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen489419916214028"> sysname <span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword480723273214028">Device</span>A</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen84532405214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1245803210214028"> vlan batch 10 20</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1514097184214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1325333698214028">interface GigabitEthernet<span>0/1/1</span></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1918185789214028"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen2002988456214028"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen383402407214028"> port vlan-stacking vlan 2 to 500 stack-vlan 10</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1257450455214028"> port vlan-stacking vlan 1000 to 2000 stack-vlan 20</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1181798898214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen156661791214028">interface GigabitEthernet<span>0/2/1</span></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen137881242214028"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1286584587214028"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1789002133214028"> port vlan-stacking vlan 100 to 500 stack-vlan 10</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1198782316214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen669547106214028">interface GigabitEthernet<span>0/3/1</span></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1618949406214028"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen2106537213214028"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1372864522214028"> port trunk allow-pass vlan 20</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1383205364214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen275571858214028">return</pre>
</li><li id="EN-US_TASK_0172363294__en-us_task_0172363203_li1185355020214028"><p id="EN-US_TASK_0172363294__en-us_task_0172363203_p56027921214028"><a name="EN-US_TASK_0172363294__en-us_task_0172363203_li1185355020214028"></a><a name="en-us_task_0172363203_li1185355020214028"></a><span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword1063430861214028">Device</span> B configuration file</p>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen642361468214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1479868050214028"> sysname <span class="keyword" id="EN-US_TASK_0172363294__en-us_task_0172363203_keyword87489660214028">Device</span>B</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen776954528214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen216762112214028"> vlan batch 20</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1644373912214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen568665459214028">interface GigabitEthernet<span>0/1/1</span></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen792166898214028"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1295261595214028"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen586455440214028"> port vlan-stacking vlan 1000 to 4094 stack-vlan 20</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen906511563214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1982609512214028">interface GigabitEthernet<span>0/2/1</span></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen218393923214028"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1235509536214028"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1278245887214028"> port vlan-stacking vlan 501 to 2500 stack-vlan 20</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1458312371214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1510016978214028">interface GigabitEthernet<span>0/3/1</span></pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen390112739214028"> undo shutdown</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1749194809214028"> portswitch</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen445319689214028"> port trunk allow-pass vlan 20</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen1949190759214028">#</pre>
<pre class="screen" id="EN-US_TASK_0172363294__en-us_task_0172363203_screen231841064214028">return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0023_1.html">Configuration Examples for QinQ
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0025_1.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_qinq_cfg_0052.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>