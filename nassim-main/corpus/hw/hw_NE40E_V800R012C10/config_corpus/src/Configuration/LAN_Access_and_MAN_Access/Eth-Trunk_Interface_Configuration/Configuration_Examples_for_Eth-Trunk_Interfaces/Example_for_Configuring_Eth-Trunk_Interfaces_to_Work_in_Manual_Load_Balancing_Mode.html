
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Eth-Trunk Interfaces to Work in Manual Load Balancing Mode">
<meta name="abstract" content="In manual load balancing mode, traffic can be evenly distributed among all the member interfaces. You can also set different weights for the member interfaces so that uneven load balancing can be carried out. That means, certain interfaces that have greater weights transmit more traffic.">
<meta name="description" content="In manual load balancing mode, traffic can be evenly distributed among all the member interfaces. You can also set different weights for the member interfaces so that uneven load balancing can be carried out. That means, certain interfaces that have greater weights transmit more traffic.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ethtrunk_cfg_0060.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ethtrunk_cfg_0061.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="Eth-Trunk">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Eth-Trunk">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="Eth-Trunk">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="featurename" content="Eth-Trunk">
<meta name="featuretype" content="LAN Access and MAN Access">
<meta name="OWNER" content="l00425560">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="wWX1238417">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172362932">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Eth-Trunk Interfaces to Work in Manual Load Balancing Mode</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172362932"></a><a name="EN-US_TASK_0172362932"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Eth-Trunk Interfaces to Work in Manual Load Balancing Mode</h1>
<div class="taskbody"><p>In manual load balancing mode, traffic can be evenly distributed among all the member interfaces. You can also set different weights for the member interfaces so that uneven load balancing can be carried out. That means, certain interfaces that have greater weights transmit more traffic.</p>
<div class="context"><a name="EN-US_TASK_0172362932__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>You can bundle multiple Ethernet interfaces into a logical Eth-Trunk interface (link aggregation group) to increase bandwidth, improve link reliability, and implement load balancing.</p>
<p>On the network shown in <a href="#EN-US_TASK_0172362932__fig_dc_vrp_ethtrunk_cfg_002201">Figure 1</a>, user group 1 communicates with user group 2. To allow traffic to be load-balanced among links, you can create Eth-Trunk interfaces on PE1 and PE2 and configure the Eth-Trunk interfaces to work in manual load balancing mode.</p>
<div class="fignone" id="EN-US_TASK_0172362932__fig_dc_vrp_ethtrunk_cfg_002201"><a name="EN-US_TASK_0172362932__fig_dc_vrp_ethtrunk_cfg_002201"></a><a name="fig_dc_vrp_ethtrunk_cfg_002201"></a><span class="figcap"><b>Figure 1 </b>Eth-Trunk interfaces in manual load balancing mode</span><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Interfaces 1 through 3 in this example represent GE <span>0/1/1</span>, GE <span>0/2/1</span>, and GE <span>0/3/1</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="images/fig_dc_vrp_ethtrunk_cfg_002201.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362932__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>After an Eth-Trunk interface is created, it works in manual load balancing mode by default. You can adopt the default working mode.</p>
<p>If the Eth-Trunk interface has been configured to work in another mode, you can run the <a href="cmdqueryname=mode"><b><span class="cmdname">mode</span></b></a> command to configure the Eth-Trunk interface to work in manual load balancing mode.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362932__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Create an Eth-Trunk interface in manual load balancing mode on each PE to implement link aggregation.</p>
</li><li><p>Add Ethernet interfaces to each Eth-Trunk interface and set a load balancing weight for each member interface to increase bandwidth and implement load balancing.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172362932__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Eth-Trunk interface ID</p>
</li><li><p>Type and number of the member interface of the Eth-Trunk interface</p>
</li></ul>
<p>Default value of every parameter of the Eth-Trunk interface</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172362932__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Create an Eth-Trunk interface.</span><p><p># Configure PE1.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>]<strong> sysname PE1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1]<strong> interface eth-trunk 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-Eth-Trunk1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-Eth-Trunk1]<strong> quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>]<strong> sysname PE2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2]<strong> interface eth-trunk 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-Eth-Trunk1]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-Eth-Trunk1]<strong> quit</strong></pre>
</p></li><li><span>Add Ethernet interfaces to the Eth-Trunk interfaces and configure a load balancing weight for every member interface.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>]<strong> eth-trunk 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/1/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> interface gigabitethernet <span>0/2/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/1</span>]<strong> eth-trunk 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/1</span>]<strong> distribute-weight 3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/2/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1] <strong>interface gigabitethernet <span>0/3/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/3/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/3/1</span>]<strong> eth-trunk 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE1-GigabitEthernet<span>0/3/1</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1-GigabitEthernet<span>0/3/1</span>]<strong> quit</strong></pre>
<p># Configure PE2.</p>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet <span>0/1/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>]<strong> eth-trunk 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/1/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2]<strong> interface gigabitethernet <span>0/2/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/1</span>]<strong> eth-trunk 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/1</span>]<strong> distribute-weight 3</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/2/1</span>]<strong> quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2] <strong>interface gigabitethernet <span>0/3/1</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/3/1</span>]<strong> undo shutdown</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/3/1</span>]<strong> eth-trunk 1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>PE2-GigabitEthernet<span>0/3/1</span>]<strong> commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE2-GigabitEthernet<span>0/3/1</span>]<strong> quit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p>Run the <a href="cmdqueryname=display+trunkmembership+eth-trunk"><b><span class="cmdname"><span>display trunkmembership eth-trunk</span></span></b></a> command in any view. The command output shows the weight of every member interface of the Eth-Trunk interface, manual load balancing mode and up state of the Eth-Trunk interface. Use the command output on PE1 as an example.</p>
<pre class="screen">[<span class="keyword">*</span>PE1]<strong> display trunkmembership eth-trunk 1</strong></pre>
<pre class="screen">Trunk ID: 1
used status: VALID
TYPE: ethernet
Working Mode : <strong>Normal</strong>
Number Of Ports in Trunk = 3
Number Of Up Ports in Trunk = 3
<span>operate</span> status: <strong>up</strong>

Interface GigabitEthernet<span>0/1/1</span>, valid, operate up, weight 1,
Interface GigabitEthernet<span>0/2/1</span>, valid, operate up, <strong>weight 3</strong>,
Interface GigabitEthernet<span>0/3/1</span>, valid, operate up, weight 1,</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172362932__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>PE1 configuration file</p>
<pre class="screen">#
sysname PE1
#
interface Eth-Trunk1
 #
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 eth-trunk 1
#
interface GigabitEthernet<span>0/2/1</span>
 undo shutdown
 eth-trunk 1
 distribute-weight 3
#
interface GigabitEthernet<span>0/3/1</span>
 undo shutdown
 eth-trunk 1
#
return</pre>
</li><li><p>PE2 configuration file</p>
<pre class="screen">#
sysname PE2
#
interface Eth-Trunk1
 #
interface GigabitEthernet<span>0/1/1</span>
 undo shutdown
 eth-trunk 1
#
interface GigabitEthernet<span>0/2/1</span>
 undo shutdown
 eth-trunk 1
 distribute-weight 3
#
interface GigabitEthernet<span>0/3/1</span>
 undo shutdown
 eth-trunk 1
admin
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ethtrunk_cfg_0060.html">Configuration Examples for Eth-Trunk Interfaces
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_ethtrunk_cfg_0061.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>