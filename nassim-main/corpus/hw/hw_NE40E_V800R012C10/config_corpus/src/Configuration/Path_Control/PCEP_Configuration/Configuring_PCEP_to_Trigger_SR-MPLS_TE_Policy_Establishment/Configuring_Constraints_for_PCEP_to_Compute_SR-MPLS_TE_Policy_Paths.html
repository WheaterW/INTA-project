
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Constraints for PCEP to Compute SR-MPLS TE Policy Paths">
<meta name="abstract" content="Before configuring PCEP to compute an SR-MPLS TE Policy path, you can perform the following steps to configure specific path constraints.">
<meta name="description" content="Before configuring PCEP to compute an SR-MPLS TE Policy path, you can perform the following steps to configure specific path constraints.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_pcep_cfg_0022.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_pcep_cfg_0014a.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_pcep_cfg_0017a.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="MPLS TE">
<meta name="featurename" content="PCE">
<meta name="featuretype" content="MPLS">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MPLS TE">
<meta name="featurename" content="PCE">
<meta name="featuretype" content="MPLS">
<meta name="featurename" content="MPLS TE">
<meta name="featurename" content="PCE">
<meta name="featuretype" content="MPLS">
<meta name="OWNER" content="l00468467">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00468467">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001196230708">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Configuring Constraints for PCEP to Compute SR-MPLS TE Policy Paths</title>
</head>
<body><a name="EN-US_TASK_0000001196230708"></a><a name="EN-US_TASK_0000001196230708"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Constraints for PCEP to Compute SR-MPLS TE Policy Paths</h1>
<div class="taskbody"><p>Before configuring PCEP to compute an SR-MPLS TE Policy path, you can perform the following steps to configure specific path constraints.</p>
<div class="steps"><a name="EN-US_TASK_0000001196230708__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run <a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span><p><p>The system view is displayed.</p>
</p></li><li><span>Set the SR-MPLS TE Policy path computation mode to PCEP.</span><ol type="a"><li class="substepexpand"><span>Run the <a href="cmdqueryname=segment-routing"><b><span class="cmdname">segment-routing</span></b></a> command to enable Segment Routing globally and enter the Segment Routing view.</span></li><li class="substepexpand"><span>(Optional) Run the <a href="cmdqueryname=sr-te-policy+pcep+lsp-identifiers+report"><b><span class="cmdname">sr-te-policy pcep lsp-identifiers report</span></b></a> command to enable SR-MPLS TE Policy to report the IPV4-LSP-IDENTIFIERS TLV to PCEP.</span><p><p>The IPv4-LSP-IDENTIFIERS TLV appears in the LSP object of a PCRpt message. In an interworking scenario with a third-party controller, you can enable this function to report information such as the tunnel ID and extended tunnel ID of a candidate path and the endpoint address of an SR-MPLS TE Policy.</p>
</p></li><li class="substepexpand"><span>Perform either or both of the following configurations as required:</span><p><ul><li>Set the global path computation mode to PCEP for all SR-MPLS TE Policies.<p>Run the <a href="cmdqueryname=sr-te-policy+dynamic-computation-seq"><b><span class="cmdname">sr-te-policy dynamic-computation-seq</span></b></a><strong> </strong><strong><span>pcep</span></strong> command to set the dynamic path computation mode to PCEP.</p>
</li><li>Set a path computation mode for a single SR-MPLS TE Policy.<ol class="substepthirdol"><li>Run the <a href="cmdqueryname=sr-te+policy"><b><span class="cmdname">sr-te policy</span></b></a> <i><span class="varname">policy-name</span></i><i><span class="varname"> </span></i>[ <strong><span>endpoint</span></strong> <i><span class="varname">ipv4-address</span></i> <strong><span>color</span></strong> <i><span class="varname">color-value</span></i> ] command to enter the SR-MPLS TE Policy view.</li><li>Run the <a href="cmdqueryname=dynamic-computation-seq"><b><span class="cmdname">dynamic-computation-seq</span></b></a><strong> </strong>{ <strong><span>pcep</span></strong> | <strong><span>none</span></strong> } command to set the dynamic path computation mode to PCEP for the SR-MPLS TE Policy.<p>If you specify the <strong><span>none</span></strong> parameter, the dynamic path computation mode set for the specified SR-MPLS TE Policy is canceled.</p>
</li><li>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the Segment Routing view.</li></ol>
</li></ul>
</p><p><p>Note that the priority of global configurations is lower than that of single-policy configurations. If both configurations exist, single-policy configurations take effect. If single-policy configurations do not exist, global configurations are inherited.</p>
<div class="p">In real-world applications, there are typically the following three scenarios:<ol class="substepthirdol"><li>To set the dynamic path computation mode to PCEP for all SR-MPLS TE Policies, run the <a href="cmdqueryname=sr-te-policy+dynamic-computation-seq"><b><span class="cmdname">sr-te-policy dynamic-computation-seq</span></b></a><strong> </strong><strong><span>pcep</span></strong> command to enable PCEP-based path computation globally.</li><li>To set the dynamic path computation mode to PCEP for most SR-MPLS TE Policies, run the <a href="cmdqueryname=sr-te-policy+dynamic-computation-seq"><b><span class="cmdname">sr-te-policy dynamic-computation-seq</span></b></a><strong> </strong><strong><span>pcep</span></strong> command to enable PCEP-based path computation globally, and then run the <a href="cmdqueryname=dynamic-computation-seq"><b><span class="cmdname">dynamic-computation-seq</span></b></a> <strong><span>none</span></strong> command for each of the SR-MPLS TE Policies that do not require PCEP-based path computation.</li><li>To set the dynamic path computation mode to PCEP for only a few SR-MPLS TE Policies, you do not need to run the <a href="cmdqueryname=sr-te-policy+dynamic-computation-seq"><b><span class="cmdname">sr-te-policy dynamic-computation-seq</span></b></a><strong> </strong><strong><span>pcep</span></strong> command. Instead, run the <a href="cmdqueryname=dynamic-computation-seq"><b><span class="cmdname">dynamic-computation-seq</span></b></a> <strong><span>pcep</span></strong> command for each of the SR-MPLS TE Policies that require PCEP-based path computation.</li></ol>
</div>
</p></li><li class="substepexpand"><span>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</span></li></ol>
</li><li><span>(Optional) Configure SR-MPLS TE Policy path constraints.</span><p><p>If SR-MPLS TE Policy path constraints need to be configured in subsequent steps, perform this step to configure the specific constraints in advance.</p>
</p><ol type="a"><li><span>Run the <strong>segment-routing policy constraint-path </strong><em>path-name</em> command to create an SR-MPLS TE Policy path constraint and enter the path constraint view.</span></li><li><span>Run the <a href="cmdqueryname=index+address+ipv4"><b><span class="cmdname">index</span></b></a><strong> </strong><em>index-value</em><strong> </strong><strong><span>address</span></strong> <strong><span>ipv4</span></strong><em> ipv4-address</em> [ <strong>include</strong> [ <strong>strict</strong> | <strong>loose</strong> ] | <strong>exclude</strong> ] command to specify the next-hop IP address in the path constraint.</span></li><li><span>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</span></li></ol>
</li><li><span>Configure SR-MPLS TE Policy creation constraints.</span><p><p>Note that the priority of the configuration performed based on a constraint template is lower than that of the configuration performed directly on the specific SR-MPLS TE Policy. If both configurations exist, the configuration performed directly on the specific SR-MPLS TE Policy takes effect. If the configuration performed directly on the specific SR-MPLS TE Policy does not exist, the configuration performed based on a constraint template is inherited.</p>
</p><ul><li>Perform the configuration based on an SR-MPLS TE Policy constraint template.<ol type="a"><li>Run the <a href="cmdqueryname=segment-routing+policy+constraint-template"><b><span class="cmdname">segment-routing policy constraint-template</span></b></a><strong> </strong><em>constraintName</em> command to create an SR-MPLS TE Policy constraint template and enter the constraint template view.</li><li>Run the <a href="cmdqueryname=priority"><b><span class="cmdname">priority</span></b></a><strong> </strong><em>setup-priority </em><em>hold-priority</em> command to configure the path setup priority and hold priority in the constraint template.</li><li>Run the <a href="cmdqueryname=affinity"><b><span class="cmdname">affinity</span></b></a><strong> </strong>{ <strong>include-all</strong> | <strong>include-any</strong> | <strong>exclude</strong> } { <em>affinity-name</em> } &amp;&lt;1-32&gt; command to configure affinity constraints in the constraint template.</li><li>Run the <a href="cmdqueryname=bandwidth+ct0"><b><span class="cmdname">bandwidth ct0</span></b></a><strong> </strong><em>bandwidth-value</em> command to configure a bandwidth constraint in the constraint template.</li><li>Run the <a href="cmdqueryname=constraint-path"><b><span class="cmdname">constraint-path</span></b></a><strong> </strong><em>constraint-path-name</em> command to configure a path constraint in the constraint template.<p>The <em>constraint-path-name</em> parameter is configured using the <strong>segment-routing policy constraint-path </strong><em>path-name</em> command, and its value is the same as the value of the <em>path-name</em> parameter.</p>
</li><li>Run the <a href="cmdqueryname=link-bandwidth+utilization"><b><span class="cmdname">link-bandwidth utilization</span></b></a><strong> </strong><em>utilization-value</em> command to configure bandwidth usage in the constraint template.</li><li>Run the <a href="cmdqueryname=metric-type"><b><span class="cmdname">metric-type</span></b></a><strong> </strong>{ <strong>igp</strong> | <strong>te</strong> | <strong>delay</strong> | <strong>hop-count</strong> } command to configure a metric type in the constraint template.<p>After the configuration is complete, run the following commands to configure the corresponding constraint values:</p>
<ul><li>Run the <a href="cmdqueryname=max-cumulation"><b><span class="cmdname">max-cumulation</span></b></a> <strong><span>igp</span></strong><strong> </strong><em>max-igp-cost</em> command to configure the maximum IGP cost in the constraint template.</li><li>Run the <a href="cmdqueryname=max-cumulation+te"><b><span class="cmdname">max-cumulation te</span></b></a><strong> </strong><em>max-te-cost</em> command to configure the maximum TE cost in the constraint template.</li><li>Run the <a href="cmdqueryname=max-cumulation+delay"><b><span class="cmdname">max-cumulation delay</span></b></a><strong> </strong><em>max-delay</em> command to configure the maximum delay in the constraint template.</li><li>Run the <a href="cmdqueryname=max-cumulation+hop-count"><b><span class="cmdname">max-cumulation hop-count</span></b></a><strong> </strong><em>max-hop-count</em> command to configure the maximum number of hops in the constraint template.</li></ul>
</li><li>(Optional) Run the <a href="cmdqueryname=sid+selection"><b><span class="cmdname">sid selection</span></b></a><strong> </strong>{ <strong><span>unprotected-preferred</span></strong> | <strong><span>protected-preferred</span></strong> | <strong><span>unprotected-only</span></strong> | <strong><span>protected-only</span></strong> } command to configure a SID selection rule in the constraint template.<p>The default SID selection rule in the constraint template is unprotected-SID-preferred (<strong><span>unprotected-preferred</span></strong>).</p>
</li><li>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</li><li>Run the <a href="cmdqueryname=segment-routing"><b><span class="cmdname">segment-routing</span></b></a> command to enable Segment Routing globally and enter the Segment Routing view.</li><li>Run the <a href="cmdqueryname=sr-te+policy"><b><span class="cmdname">sr-te policy</span></b></a> <i><span class="varname">policy-name</span></i><i><span class="varname"> </span></i>[ <strong><span>endpoint</span></strong> <i><span class="varname">ipv4-address</span></i> <strong><span>color</span></strong> <i><span class="varname">color-value</span></i> ] command to enter the SR-MPLS TE Policy view.</li><li>Run the <a href="cmdqueryname=constraint-template"><b><span class="cmdname">constraint-template </span></b></a><em>constraintName</em> command to specify the constraint template to be referenced by the SR-MPLS TE Policy.</li><li>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the Segment Routing view.</li><li>Run the <a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a> command to return to the system view.</li></ol>
</li><li>Perform the configuration directly on the specific SR-MPLS TE Policy.<ol type="a"><li>Run the <a href="cmdqueryname=segment-routing"><b><span class="cmdname">segment-routing</span></b></a> command to enable Segment Routing globally and enter the Segment Routing view.</li><li>Run the <a href="cmdqueryname=sr-te+policy"><b><span class="cmdname">sr-te policy</span></b></a> <i><span class="varname">policy-name</span></i><i><span class="varname"> </span></i>[ <strong><span>endpoint</span></strong> <i><span class="varname">ipv4-address</span></i> <strong><span>color</span></strong> <i><span class="varname">color-value</span></i> ] command to enter the SR-MPLS TE Policy view.</li><li>Run the <a href="cmdqueryname=candidate-path+preference"><b><span class="cmdname">candidate-path preference</span></b></a> <i><span class="varname">preference</span></i> command to configure a candidate path for the SR-MPLS TE Policy and specify a preference value for the path.<p>Each SR-MPLS TE Policy supports multiple candidate paths. A larger <i><span class="varname">preference</span></i> value indicates a higher candidate path preference. If multiple candidate paths are configured, the one with the highest preference takes effect.</p>
</li><li>Run the <a href="cmdqueryname=dynamic"><b><span class="cmdname">dynamic</span></b></a> command to configure the candidate path of the SR-MPLS TE Policy as a dynamic one.</li><li>Run the <a href="cmdqueryname=affinity"><b><span class="cmdname">affinity</span></b></a><strong> </strong>{ <strong>include-all</strong> | <strong>include-any</strong> | <strong>exclude</strong> } { <em>affinity-name</em> } &amp;&lt;1-32&gt; command to configure affinity constraints for the dynamic candidate path of the SR-MPLS TE Policy.</li><li>Run the <a href="cmdqueryname=constraint-path"><b><span class="cmdname">constraint-path</span></b></a><strong> </strong><em>constraint-path-name</em> command to configure a path constraint for the dynamic candidate path of the SR-MPLS TE Policy.<p>The <em>constraint-path-name</em> parameter is configured using the <strong>segment-routing policy constraint-path </strong><em>path-name</em> command, and its value is the same as the value of the <em>path-name</em> parameter.</p>
</li><li>Run the <a href="cmdqueryname=link-bandwidth+utilization"><b><span class="cmdname">link-bandwidth utilization</span></b></a><strong> </strong><em>utilization-value</em> command to configure bandwidth usage for the dynamic candidate path of the SR-MPLS TE Policy.</li><li>Run the <a href="cmdqueryname=metric-type"><b><span class="cmdname">metric-type</span></b></a><strong> </strong>{ <strong>igp</strong> | <strong>te</strong> | <strong>delay</strong> | <strong>hop-count</strong> } command to configure a metric type for the dynamic candidate path of the SR-MPLS TE Policy.<p>After the configuration is complete, run the following commands to configure the corresponding constraint values:</p>
<ul><li>Run the <a href="cmdqueryname=max-cumulation"><b><span class="cmdname">max-cumulation</span></b></a> <strong><span>igp</span></strong><strong> </strong><em>max-igp-cost</em> command to configure the maximum IGP cost for the dynamic candidate path of the SR-MPLS TE Policy.</li><li>Run the <a href="cmdqueryname=max-cumulation+te"><b><span class="cmdname">max-cumulation te</span></b></a><strong> </strong><em>max-te-cost</em> command to configure the maximum TE cost for the dynamic candidate path of the SR-MPLS TE Policy.</li><li>Run the <a href="cmdqueryname=max-cumulation+delay"><b><span class="cmdname">max-cumulation delay</span></b></a><strong> </strong><em>max-delay</em> command to configure the maximum delay for the dynamic candidate path of the SR-MPLS TE Policy.</li><li>Run the <a href="cmdqueryname=max-cumulation+hop-count"><b><span class="cmdname">max-cumulation hop-count</span></b></a><strong> </strong><em>max-hop-count</em> command to configure the maximum number of hops for the dynamic candidate path of the SR-MPLS TE Policy.</li></ul>
</li><li>(Optional) Run the <a href="cmdqueryname=sid+selection"><b><span class="cmdname">sid selection</span></b></a><strong> </strong>{ <strong><span>unprotected-preferred</span></strong> | <strong><span>protected-preferred</span></strong> | <strong><span>unprotected-only</span></strong> | <strong><span>protected-only</span></strong> } command to configure a SID selection rule for the candidate path of the SR-MPLS TE Policy.<p>The default SID selection rule in the constraint template is unprotected-SID-preferred (<strong><span>unprotected-preferred</span></strong>).</p>
</li></ol>
</li></ul>
</li><li><span>Run <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span><p><p>The configuration is committed.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_pcep_cfg_0022.html">Configuring PCEP to Trigger SR-MPLS TE Policy Establishment
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_pcep_cfg_0014a.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_pcep_cfg_0017a.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>