
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a DHCPv4 Server and Relay Agent">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ztp_cfg_0002.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ztp_cfg_0004.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ztp_cfg_0012.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00800033,ztpne,w00556928,w00606909,l00455378">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="ZTP">
<meta name="featuretype" content="Basic Configurations">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ZTP">
<meta name="featuretype" content="Basic Configurations">
<meta name="featurename" content="ZTP">
<meta name="featuretype" content="Basic Configurations">
<meta name="featurename" content="ZTP">
<meta name="featuretype" content="Basic Configurations">
<meta name="OWNER" content="lwx1238418">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="l00799643">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172360188">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/jquery.min.idp.js"></script>
<script type="text/javascript" src="../../../../public_sys-resources/RowOrColfreezeSupport.js"></script>

<script type="text/javascript">
setTimeout(function(){
	jQueryHW(document).ready(function(){
		jQueryHW("table[rowfreeze='yes']").rowfreeze();
		jQueryHW("table[colfreeze='yes']").colfreeze();
	});
},500);
</script>
<title>Configuring a DHCPv4 Server and Relay Agent</title>
</head>
<body><a name="EN-US_TASK_0172360188"></a><a name="EN-US_TASK_0172360188"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a DHCPv4 Server and Relay Agent</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0172360188__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Before powering on a device that requires automatic deployment through ZTP, deploy a DHCPv4 server from which the device can obtain a device management IP address, gateway address, intermediate file server address, and intermediate file name.</p>
<p>In the DHCP discover phase, the device sends to the DHCPv4 server a DHCP discover packet that carries DHCP Option 60 and Option 61. Option 60 (Vendor class identifier) records the device manufacturer and model, and Option 61 (Client-identifier) records the device ESN.</p>
<div class="p"><a href="#EN-US_TASK_0172360188__table_01">Table 1</a> describes the Option fields that need to be configured on the DHCPv4 server.
<div class="tableBorder"><a name="EN-US_TASK_0172360188__table_01"></a><a name="table_01"></a><table cellpadding="4" cellspacing="0" summary="" rowfreeze="yes" id="EN-US_TASK_0172360188__table_01" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Option field description</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="19.03%" id="mcps1.3.1.3.2.2.4.1.1" liSelected="liSelected"><p>Option</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="19%" id="mcps1.3.1.3.2.2.4.1.2" liSelected="liSelected"><p>Mandatory or Optional</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="61.970000000000006%" id="mcps1.3.1.3.2.2.4.1.3" liSelected="liSelected"><p>Function</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="19.03%" headers="mcps1.3.1.3.2.2.4.1.1 "><p>1</p>
</td>
<td class="cellrowborder" valign="top" width="19%" headers="mcps1.3.1.3.2.2.4.1.2 "><p>Mandatory</p>
</td>
<td class="cellrowborder" valign="top" width="61.970000000000006%" headers="mcps1.3.1.3.2.2.4.1.3 "><p>Specifies the subnet mask of an IP address.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.03%" headers="mcps1.3.1.3.2.2.4.1.1 "><p>3</p>
</td>
<td class="cellrowborder" valign="top" width="19%" headers="mcps1.3.1.3.2.2.4.1.2 "><p>Mandatory</p>
</td>
<td class="cellrowborder" valign="top" width="61.970000000000006%" headers="mcps1.3.1.3.2.2.4.1.3 "><p>Specifies the egress gateway of a DHCP client.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.03%" headers="mcps1.3.1.3.2.2.4.1.1 "><p>6</p>
</td>
<td class="cellrowborder" valign="top" width="19%" headers="mcps1.3.1.3.2.2.4.1.2 "><p>Optional</p>
</td>
<td class="cellrowborder" valign="top" width="61.970000000000006%" headers="mcps1.3.1.3.2.2.4.1.3 "><p>Specifies the IP address of a DNS server. If a domain name (for example, www.ztp.com) is specified as the host name of an intermediate file server, deploy a DNS server to resolve the domain name to an IP address. If an IP address is specified as the host name of an intermediate file server, a DNS server does not need to be deployed.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.03%" headers="mcps1.3.1.3.2.2.4.1.1 "><p>66</p>
</td>
<td class="cellrowborder" valign="top" width="19%" headers="mcps1.3.1.3.2.2.4.1.2 "><p>Optional</p>
</td>
<td class="cellrowborder" valign="top" width="61.970000000000006%" headers="mcps1.3.1.3.2.2.4.1.3 "><div class="p">Specifies the host name of the intermediate file server. An intermediate file server can be a TFTP, an FTP, or an SFTP server. The format of this field is as follows:<ul><li><p>tftp://<i><span class="varname">hostname</span></i></p>
</li><li><p>ftp://[<i><span class="varname">username</span></i>[:<i><span class="varname">password</span></i>]@]<i><span class="varname">hostname</span></i></p>
</li><li><p>sftp://[<i><span class="varname">username</span></i>[:<i><span class="varname">password</span></i>]@]<i><span class="varname">hostname</span></i>[:<em>port</em>]</p>
</li></ul>
</div>
<p><i><span class="varname">username</span></i>, <i><span class="varname">password</span></i>, and <em>port</em> are optional. <i><span class="varname">hostname</span></i> can be a domain name or an IP address. If <i><span class="varname">hostname</span></i> is set to a domain name, a DNS server needs to be deployed. The value of <em>port</em> ranges from 0 to 65535. If the specified value is out of the range, the default value 22 is used. A port number can be configured only when <i><span class="varname">hostname</span></i> of an SFTP server is set to an IPv4 address.</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>If <i><span class="varname">hostname</span></i> is set to an IP address, you do not need to set the file transfer type. The default file transfer type is TFTP.</p>
</div></div>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.03%" headers="mcps1.3.1.3.2.2.4.1.1 "><p>67</p>
</td>
<td class="cellrowborder" valign="top" width="19%" headers="mcps1.3.1.3.2.2.4.1.2 "><p>Mandatory</p>
</td>
<td class="cellrowborder" valign="top" width="61.970000000000006%" headers="mcps1.3.1.3.2.2.4.1.3 "><p>Specifies the name of an intermediate file. The intermediate file name extension is .ini, .py, or .cfg.</p>
<ul><li>The name of an intermediate file must not exceed 64 characters. Otherwise, the file may fail to be downloaded.</li><li>The name of an intermediate file must not contain special characters, such as the ampersand (&amp;), greater-than sign (&gt;), less-than sign (&lt;), double quote ("), and single quote (').</li><li>The intermediate file name is in the format <i><span class="varname">path</span></i>/<i><span class="varname">filename</span></i>. In the format, <i><span class="varname">path</span></i> can be a relative path without the host name of the file server, <strong>/script/ztp_script.py</strong> for example, or an absolute path with the host name of the file server, <strong>sftp://10.1.1.1/script/ztp_script.py</strong> for example. If a path does not contain a host name, Option 66 needs to be set.</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.03%" headers="mcps1.3.1.3.2.2.4.1.1 "><p>150</p>
</td>
<td class="cellrowborder" valign="top" width="19%" headers="mcps1.3.1.3.2.2.4.1.2 "><p>Optional</p>
</td>
<td class="cellrowborder" valign="top" width="61.970000000000006%" headers="mcps1.3.1.3.2.2.4.1.3 "><p>Specifies the IP address of a TFTP server.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The IPv4 address lease that ZTP applies for through DHCPv4 is at least one hour and cannot be renewed.</p>
<p>If a ZTP device and DHCPv4 server reside on different network segments, deploy a DHCP relay agent to forward DHCP packets.</p>
</div></div>
<p>A router is used as a DHCPv4 server or relay agent example in the following procedures. If another type of device is used as the DHCPv4 server or relay agent, see the documentation of the corresponding product.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172360188__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure an address pool on the DHCPv4 server. For configuration details, see <a href="dc_ne_ipv4_address_cfg_0050.html">Configuring an Address Pool</a>. For details about configuring the options 6, 66, 67, and 150, see <a href="dc_ne_ipv4_address_cfg_0054.html">(Optional) Configuring DHCPv4 User-Defined Options</a>.</span></li><li><span>Configure the DHCPv4 server to assign addresses in the specified address pool. For configuration details, see <a href="dc_ne_ipv4_address_cfg_0066.html">Example for Configuring User Address Assignment Through a Local Address Pool</a>.</span></li><li><span>(Optional) Configure the DHCP relay agent, if deployed. For configuration details, see <a href="../vrp/dc_vrp_dhcp_relay_cfg_0003.html">Configuring DHCP Relay</a>.</span></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ztp_cfg_0002.html">Configuring Automatic ZTP Deployment Through DHCP
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ztp_cfg_0004.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_ztp_cfg_0012.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>