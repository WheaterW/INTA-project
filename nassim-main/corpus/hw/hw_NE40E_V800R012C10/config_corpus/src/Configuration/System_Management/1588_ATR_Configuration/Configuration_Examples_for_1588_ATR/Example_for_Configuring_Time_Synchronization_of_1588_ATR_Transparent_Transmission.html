
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Time Synchronization of 1588 ATR Transparent Transmission">
<meta name="abstract" content="In a 1588 ATR domain, a client can establish a client/server relationship with two remote clock servers and send unicast negotiation requests to these clock servers to implement 1588 ATR time synchronization. Once the master clock server becomes faulty, the client automatically initiates a connection request to the slave clock server.">
<meta name="description" content="In a 1588 ATR domain, a client can establish a client/server relationship with two remote clock servers and send unicast negotiation requests to these clock servers to implement 1588 ATR time synchronization. Once the master clock server becomes faulty, the client automatically initiates a connection request to the slave clock server.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_atr_cfg_9010.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_atr_cfg_9110.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909,l00587852">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="1588 ATR">
<meta name="featuretype" content="System Management">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="1588 ATR">
<meta name="featuretype" content="System Management">
<meta name="featurename" content="1588 ATR">
<meta name="featuretype" content="System Management">
<meta name="OWNER" content="w00845984">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00845984">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001782038062">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/thickbox.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/imageResize.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery-migrate-1.2.1.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery-ui.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/jquery.mousewheel.min.js"></script>
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/thickbox.js"></script>
<title>Example for Configuring Time Synchronization of 1588 ATR Transparent Transmission</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001782038062"></a><a name="EN-US_TASK_0000001782038062"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Time Synchronization of 1588 ATR <span>Transparent Transmission</span></h1>
<div class="taskbody"><p>In a 1588 ATR domain, a client can establish a client/server relationship with two remote clock servers and send unicast negotiation requests to these clock servers to implement 1588 ATR time synchronization. Once the master clock server becomes faulty, the client automatically initiates a connection request to the slave clock server.</p>
<div class="context"><a name="EN-US_TASK_0000001782038062__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the IP RAN shown in <a href="#EN-US_TASK_0000001782038062__fig_dc_ne_atr_cfg_900301">Figure 1</a>, time synchronization needs to be performed between gNodeBs, but the third-party network (such as a microwave or switch network) does not support 1588v2. In this case, 1588 ATR can be configured to allow time synchronization over the third-party network. <span class="keyword">NE40E</span>s enabled with 1588 ATR can function as a BC to synchronize time information with upstream devices and as a 1588 ATR server to synchronize time information with gNodeBs.</p>
<p>Server1 and Server2 are the master and slave clock servers. A client initiates Layer 3 unicast negotiation requests to both Server1 and Server2 using 1588 ATR packets to obtain time synchronization information. If the client is disconnected from Server1, the client then initiates a Layer 3 unicast negotiation request to Server2 to ensure time synchronization with the clock server.</p>
<div class="fignone" id="EN-US_TASK_0000001782038062__fig_dc_ne_atr_cfg_900301"><a name="EN-US_TASK_0000001782038062__fig_dc_ne_atr_cfg_900301"></a><a name="fig_dc_ne_atr_cfg_900301"></a><span class="figcap"><b>Figure 1 </b>1588 ATR configuration in a dual-server scenario</span><br><span><img class="imgResize" src="figure/en-us_image_0000001782197742.png" width="504.13650000000007" title="Click to enlarge"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001782038062__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure unicast negotiation on a 1588 ATR client.</p>
</li><li><p>Configure unicast negotiation on Server1 and Server2.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001782038062__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Local server's IP address</p>
</li><li><p>1588 ATR domain where the servers reside</p>
</li><li><p>Outbound interface for transmitting 1588 ATR packets</p>
</li><li><p>DSCP priority value of 1588 ATR packets</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001782038062__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure unicast negotiation on a 1588 ATR client.</span><p><p>For details about how to configure unicast negotiation on a client, see the related configuration guide.</p>
</p></li><li><span>Configure unicast negotiation on Server1 and Server2.</span><p><ul><li><div class="p">Configure Server1 as the server.<pre class="screen">&lt;Server1&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Server1] <strong>interface loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server1-Loopback0] <strong>ip address 1.1.1.1 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server1-Loopback0] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Server1-Loopback0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Server1] <strong>ptp-adaptive enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server1] <strong>ptp-adaptive device-type server</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server1] <strong>ptp-adaptive time profile</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server1] <strong>ptp-adaptive domain 45</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server1] <strong>ptp-adaptive dscp 60</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server1] <strong>ptp-adaptive local-ip 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server1] <strong>ptp-adaptive atr unicast-negotiate enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server1] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server1-GigabitEthernet<span>0/1/0</span>] <strong>ptp-adaptive atr enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server1-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server1-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server1] <strong>commit</strong></pre>
</div>
</li><li><div class="p">Configure unicast negotiation on Server2.<pre class="screen">&lt;Server2&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Server2] <strong>interface loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server2-Loopback0] <strong>ip address 2.2.2.2 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server2-Loopback0] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Server2-Loopback0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Server2] <strong>ptp-adaptive enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server2] <strong>ptp-adaptive device-type server</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server2] <strong>ptp-adaptive time profile</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server2] <strong>ptp-adaptive domain 45</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server2] <strong>ptp-adaptive dscp 60</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server2] <strong>ptp-adaptive local-ip 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server2] <strong>ptp-adaptive atr unicast-negotiate enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server2] <strong>interface gigabitethernet <span>0/1/0</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server2-GigabitEthernet<span>0/1/0</span>] <strong>ptp-adaptive atr enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server2-GigabitEthernet<span>0/1/0</span>] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server2-GigabitEthernet<span>0/1/0</span>] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span>Server2] <strong>commit</strong></pre>
</div>
</li></ul>
</p></li><li><span>Verify the configuration.</span><p><p># View all configurations of the 1588 ATR module on the servers. The following example uses the command output on Server1.</p>
<pre class="screen">&lt;Server1&gt; <strong>display ptp-adaptive all</strong></pre>
<pre class="screen">Device config info
-------------------------------------------------------------------------------
Ptp adaptive state      :enable           Device type        :server
Sync mode               :time             Current state      :master
Packet dscp             :60               Domain value       :45
Local ip                :1.1.1.1          Server board       :<span>3</span>
Profile                 :time
VPN                     :none

Client info
    ID  Ip Address       Clock ID          Mode     Announce  Sync  Delay_resp
-------------------------------------------------------------------------------
0   0   3.3.3.3          2cab00fffec65e58  two-way  1         -7    -7
1   1   4.4.4.4          286ed4fffebcdc76  two-way  1         -7    -7
</pre>
<p># View 1588 ATR related configurations on the servers. The following example uses the command output on Server1.</p>
<pre class="screen">&lt;Server1&gt; <strong>display ptp-adaptive config</strong></pre>
<pre class="screen">Device config info
-------------------------------------------------------------------------------
Ptp adaptive state      :enable           Device type        :server
Sync mode               :time             Current state      :master
Packet dscp             :60               Domain value       :45
Local ip                :1.1.1.1          Server board       :
<span>3</span>
Profile                 :time
VPN                     :none

Port config info
Name                         ATR enable
-----------------------------------
GigabitEthernet<span>0/1/0</span>         true
</pre>
<p># View configurations of the 1588 ATR client.</p>
<pre class="screen">&lt;Server1&gt; <strong>display ptp-adaptive client 0</strong></pre>
<pre class="screen">Client id           :0                 IP address          :3.3.3.3
Clock id            :2cab00fffec65e58  Mode                :two-way
Announce interval   :1                 Announce duration   :300s
Sync interval       :-7                Sync duration       :300s
Delay_resp interval :-7                Delay_resp duration :300s

Receive packet statistics
---------------------------------------------------------------------------
Signalling          :60                Delay_req           :655778

Send packet statistics
---------------------------------------------------------------------------
Signalling          :60                Announce            :2547
Sync                :655945            Delay_resp          :655778

Discard packet statistics
---------------------------------------------------------------------------
Signalling          :0
Delay_req           :0
</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001782038062__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p>Server1 configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname Server1</pre>
<pre class="screen">#
ptp-adaptive enable
ptp-adaptive device-type server
ptp-adaptive time profile
ptp-adaptive domain 45
ptp-adaptive dscp 60
ptp-adaptive local-ip 1.1.1.1
ptp-adaptive atr unicast-negotiate enable
#
interface gigabitethernet <span>0/1/0</span>
 ptp-adaptive atr enable
#
interface LoopBack0                                                                                                                 
 ip address 1.1.1.1 255.255.255.255</pre>
<pre class="screen"># </pre>
<pre class="screen">return</pre>
</li><li><p>Server2 configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname Server2</pre>
<pre class="screen">#
ptp-adaptive enable
ptp-adaptive device-type server
ptp-adaptive time profile
ptp-adaptive domain 45
ptp-adaptive dscp 60
ptp-adaptive local-ip 2.2.2.2
ptp-adaptive atr unicast-negotiate enable
#
interface gigabitethernet <span>0/1/0</span>
 ptp-adaptive atr enable
#
interface LoopBack0                                                                                                                 
 ip address 2.2.2.2 255.255.255.255</pre>
<pre class="screen"># </pre>
<pre class="screen">return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_atr_cfg_9010.html">Configuration Examples for 1588 ATR
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_atr_cfg_9110.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>

<script language="JavaScript">
<!--
image_size('.imgResize');
var msg_imageMax = "view original image";
var msg_imageClose = "close";
//--></script></body>
</html>