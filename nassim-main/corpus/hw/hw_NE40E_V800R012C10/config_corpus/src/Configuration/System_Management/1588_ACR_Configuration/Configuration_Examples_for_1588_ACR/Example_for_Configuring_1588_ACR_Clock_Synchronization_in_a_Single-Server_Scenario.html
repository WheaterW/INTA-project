
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring 1588 ACR Clock Synchronization in a Single-Server Scenario">
<meta name="abstract" content="This section describes how to configure 1588 ACR on the Router functioning as a client and the Router functioning as a server to restore clock information in a single-server scenario by using an example.">
<meta name="description" content="This section describes how to configure 1588 ACR on the Router functioning as a client and the Router functioning as a server to restore clock information in a single-server scenario by using an example.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_1588v2_cfg_5044.html">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_1588v2_cfg_5037.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909,l00587852">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="1588 ACR">
<meta name="featuretype" content="System Management">

<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="1588 ACR">
<meta name="featuretype" content="System Management">
<meta name="featurename" content="1588 ACR">
<meta name="featuretype" content="System Management">
<meta name="OWNER" content="w00845984">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00845984">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001779081038">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring 1588 ACR Clock Synchronization in a Single-Server Scenario</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001779081038"></a><a name="EN-US_TASK_0000001779081038"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring 1588 ACR Clock Synchronization in a Single-Server Scenario</h1>
<div class="taskbody"><p>This section describes how to configure 1588 ACR on the <span class="keyword">Router</span> functioning as a client and the <span class="keyword">Router</span> functioning as a server to restore clock information in a single-server scenario by using an example.</p>
<div class="context"><a name="EN-US_TASK_0000001779081038__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the IP RAN shown in <a href="#EN-US_TASK_0000001779081038__fig_dc_ne_1588v2_cfg_503601">Figure 1</a>, <span class="keyword">Device</span>A functions as a clock server. <span class="keyword">Device</span>C functions as a client, and sends a 1588 ACR Layer 3 unicast negotiation request to the server to achieve clock synchronization.</p>
<div class="fignone" id="EN-US_TASK_0000001779081038__fig_dc_ne_1588v2_cfg_503601"><a name="EN-US_TASK_0000001779081038__fig_dc_ne_1588v2_cfg_503601"></a><a name="fig_dc_ne_1588v2_cfg_503601"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring 1588 ACR clock synchronization in a single-server scenario</span><br><span><img class="vsd" src="figure/en-us_image_0000001778921490.png"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001779081038__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure <span class="keyword">Device</span>A as a server.</p>
</li><li><p>Configure <span class="keyword">Device</span>C as a client.</p>
</li><li><p>Configure unicast negotiation on the server and client.</p>
</li><li><p>On the client, configure a PTP clock reference source.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001779081038__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IP address of the server and the IP address of the client</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001779081038__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure <span class="keyword">Device</span>A as a server.</span><p><pre class="screen">&lt;<span class="keyword">Device</span>A&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A-Loopback0] <strong>ip address 1.1.1.1 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-Loopback0] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-Loopback0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>ptp-adaptive enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>ptp-adaptive device-type server</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>ptp-adaptive local-ip 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</p></li><li><span>Configure <span class="keyword">Device</span>C as a client.</span><p><pre class="screen">&lt;<span class="keyword">Device</span>C&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>interface loopback 0</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-Loopback0] <strong>ip address 2.2.2.2 32</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-Loopback0] <strong>commit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C-Loopback0] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>ptp-adaptive enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>ptp-adaptive device-type client</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>ptp-adaptive local-ip 2.2.2.2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>ptp-adaptive remote-server1-ip 1.1.1.1</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>commit</strong></pre>
</p></li><li><span>Configure unicast negotiation on the server and client.</span><p><p># Configure the server.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>ptp-adaptive acr unicast-negotiate enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</p><p><p># Configure the client.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>ptp-adaptive acr unicast-negotiate enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>commit</strong></pre>
</p></li><li><span>On the client, configure a PTP clock reference source.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>clock source ptp synchronization enable</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>clock source ptp priority 10</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>clock source ptp ssm prc</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>commit</strong></pre>
</p></li><li><span>Verify the configuration.</span><p><p># Check the 1588 ACR configuration on <span class="keyword">Device</span>C.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>C&gt; <strong>display ptp-adaptive all</strong></pre>
<pre class="screen"> Device config info
 ---------------------------------------------------------------------------
 Ptp adaptive state      :enable         Device type        :client
 Sync mode               :frequency      Current state      :slave
 Packet dscp             :56             Domain value       :0
 Announce interval       :11             Announce duration  :300s
 Sync interval           :3              Sync duration      :300s
 Delay_resp interval     :3              Delay_resp duration:300s
 Announce receipt timeout:3              Acr mode           :one-way
 Local ip                :2.2.2.2        Client board       :<span>3</span>
 Frequency profile       :no
 VPN                     :none

 BMCA run info
 ---------------------------------------------------------------------------
 Current trace source    :server1
 Frequency lock success  :yes

 Time performance statistics(ns):
 ------------------------------------------------------------------------
 Realtime(T2-T1)         :987740873
 Max(T2-T1)              :987742555
 Min(T2-T1)              :987423502

 Remote server info
 ---------------------------------------------------------------------------
          Ip address        Negotiate state  Pri1 Class   Accuracy  Pri2
 Server1: 1.1.1.1           Nego success     128  6       0x34      128
 Server2:                                                               
</pre>
<p># Check the 1588 ACR configuration on <span class="keyword">Device</span>A.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>A&gt; <strong>display ptp-adaptive all</strong></pre>
<pre class="screen"> Device config info
 ---------------------------------------------------------------------------
 Ptp adaptive state      :enable         Device type        :server
 Sync mode               :frequency      Current state      :master
 Packet dscp             :56             Domain value       :0
 Local ip                :1.1.1.1        Server board       :<span>3</span>
 Frequency profile       :no
 VPN                     :none

 Client info
     ID  Ip Address        Clock ID          Mode    Announce  Sync  Delay_resp
 ---------------------------------------------------------------------------
 1   0   2.2.2.2           001882fffed48301  one-way 11         3     3
</pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001779081038__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Files</h4><ul><li><p><span class="keyword">Device</span>A configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>A</pre>
<pre class="screen">#
ptp-adaptive enable
ptp-adaptive device-type server
ptp-adaptive local-ip 1.1.1.1
ptp-adaptive acr unicast-negotiate enable
#
interface Loopback0
 ip address 1.1.1.1 255.255.255.255
#
return</pre>
</li><li><p><span class="keyword">Device</span>C configuration file</p>
<pre class="screen">#</pre>
<pre class="screen">sysname <span class="keyword">Device</span>C</pre>
<pre class="screen">#
ptp-adaptive enable
ptp-adaptive device-type client
ptp-adaptive local-ip 2.2.2.2
ptp-adaptive remote-server1-ip 1.1.1.1
ptp-adaptive acr unicast-negotiate enable
clock source ptp synchronization enable
clock source ptp priority 10
clock source ptp ssm prc
#
interface GE<span>0/1/0</span>
 clock synchronization enable
#
interface Loopback0
 ip address 2.2.2.2 255.255.255.255
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_1588v2_cfg_5044.html">Configuration Examples for 1588 ACR
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../../../software/nev8r10_vrpv8r16/user/ne/dc_ne_1588v2_cfg_5037.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>