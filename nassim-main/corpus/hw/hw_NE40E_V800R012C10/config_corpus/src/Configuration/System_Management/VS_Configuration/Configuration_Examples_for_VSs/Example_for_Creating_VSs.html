
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Creating VSs">
<meta name="abstract" content="This section provides an example for creating VSs and allocating resources to the VSs.">
<meta name="description" content="This section provides an example for creating VSs and allocating resources to the VSs.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vs_cfg_0008.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R23C00">
<meta name="DC.Creator" content="w00606909">
<meta name="DC.Publisher" content="20240229">
<meta name="featurename" content="VS">
<meta name="featuretype" content="System Management">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VS">
<meta name="featuretype" content="System Management">
<meta name="featurename" content="VS">
<meta name="featuretype" content="System Management">
<meta name="featurename" content="VS">
<meta name="featuretype" content="System Management">
<meta name="OWNER" content="l00425560,lwx1238418">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="w00845984">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0172360324">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../../../public_sys-resources/browseVersion.js"></script>
<title>Example for Creating VSs</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0172360324"></a><a name="EN-US_TASK_0172360324"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Creating VSs</h1>
<div class="taskbody"><p>This section provides an example for creating VSs and allocating resources to the VSs.</p>
<div class="context"><a name="EN-US_TASK_0172360324__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><div class="note"><img src="../../../../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This configuration example is supported only by the Admin-VS.</p>
</div></div>
<p>On a network, the <span>MMB</span> of a PS processes all services offered by a service provider (SP). If a service failure on the PS causes a PS failure, other services running on the PS cannot be properly forwarded. To prevent this problem, configure different VSs on the PS to independently carry services to improve network security.</p>
<p>As shown in <a href="#EN-US_TASK_0172360324__fig_dc_vrp_vs_cfg_000901">Figure 1</a>, different VSs can be created on a PS. The VSs carry their own services that are mutually isolated. Services can be quickly differentiated by VS, and physical interfaces can be shared between the VSs, saving physical links and reducing networking costs.</p>
<div class="fignone" id="EN-US_TASK_0172360324__fig_dc_vrp_vs_cfg_000901"><a name="EN-US_TASK_0172360324__fig_dc_vrp_vs_cfg_000901"></a><a name="fig_dc_vrp_vs_cfg_000901"></a><span class="figcap"><b>Figure 1 </b>Creating VSs</span><br><span><img class="vsd" src="images/fig_dc_vrp_vs_cfg_000901.png" width="NaN" height="NaN"></span><br></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0172360324__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><ul><li>A VS starts after it is created.</li><li>The slot resources of a VS can be allocated only by a PS administrator.</li><li>The same slot resources can be allocated to multiple VSs.</li><li>If a physical interface is allocated to a VS, it cannot be allocated to other VSs. If the physical interface needs to be shared among different VSs, multiple sub-interfaces corresponding to the physical interface need to be allocated to different VSs.</li><li>After slot resources are deleted from a VS, the resources are automatically allocated to the Admin-VS. In this case, the services in the VS are stopped, but relevant services in the Admin-VS are started.</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0172360324__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Create VSs and configure PVMBs for each VS so that the VSs can start.</p>
</li><li><p>Allocate interfaces to VSs to allow the VSs to forward services.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0172360324__1.4.4"></a><a name="1.4.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li>Names of the VSs to be created: vs1, vs2, and vs3</li><li>Interface number allocated to each VS</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0172360324__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Create and start VSs.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>admin</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-admin] <strong>virtual-system vs1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin-vs:vs1] <strong>port-mode port</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin-vs:vs1] <strong>description vs1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin-vs:vs1] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-admin] <strong>virtual-system vs2</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin-vs:vs2] <strong>port-mode port</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin-vs:vs2] <strong>description vs2</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin-vs:vs2] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-admin] <strong>virtual-system vs3</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin-vs:vs3] <strong>port-mode port</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin-vs:vs3] <strong>description vs3</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin-vs:vs3] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin] <strong>commit</strong></pre>
</p></li><li><span>Allocate resources to the VSs.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-admin] <strong>virtual-system vs1</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin-vs:vs1] <strong>assign interface gigabitethernet <span>0/3/2</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin-vs:vs1] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-admin] <strong>virtual-system vs2</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin-vs:vs2] <strong>assign interface gigabitethernet <span>0/3/3</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin-vs:vs2] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-admin] <strong>virtual-system vs3</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin-vs:vs3] <strong>assign interface gigabitethernet <span>0/3/4</span></strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin-vs:vs3] <strong>quit</strong></pre>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-admin] <strong>commit</strong></pre>
</p></li><li><span>Configure different services or features on the VSs.</span><p><p>For configuration details, see the related feature configurations. For example, to configure a routing protocol on VS1, see "IP Routing" in <em><span class="keyword">NE40E</span> Configuration Guide - IP Routing</em>.</p>
</p></li><li><span>Verify the configuration.</span><p><p>Run the <strong><span>display virtual-system</span></strong> command on the PS. The command output shows that vs1, vs2, and vs3 have been created and started.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-admin] <strong>display virtual-system</strong></pre>
<pre class="screen">---------------------------------------------------------------
Name                             Status         <span>Description</span>
---------------------------------------------------------------
Admin-VS                         running         admin-vs
vs1                              running         vs1
vs2                              running         vs2
vs3                              running         vs3
----------------------------------------------------<span>-----------</span>  </pre>
<p>Run the <a href="cmdqueryname=display+virtual-system"><b><span class="cmdname">display virtual-system</span></b></a> [ <strong><span>name</span></strong> <i><span class="varname">vs-name</span></i> ] [ <strong><span>verbose</span></strong> ] command on the PS. The following example uses vs1 configurations.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-admin] <strong>display virtual-system name vs1 verbose</strong></pre>
<pre class="screen">Name         : vs1
Status       : running
Description  :
Create time  : 2017-03-13 21:24:27+09:30 DST
Port mode    : port
System MAC   : 00-e0-fc-12-34-56
Assigned slot(s)
pvmb         : 
pvmb         : 
CPU(s)
slot       : 4%
slot       : 4%
fcard:/VS_huawei: 0%, 16/41943040 (Used Kbytes/Max Kbytes)
Assigned interface(s)
  GE3/0/0, slot 3
Assigned resource(s)
u4route      : 10000(Max)
m4route      : 1000(Max)
u6route      : 1000(Max)
m6route      : 1000(Max)
vpn-instance : 256(Max)
cpu          : 5(weight)</pre>
<div class="p">Run the <a href="cmdqueryname=display+virtual-system+configuration+state"><b><span class="cmdname">display virtual-system configuration state</span></b></a> command on the PS to check whether VS configurations have been saved.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-admin] <strong>display virtual-system configuration state</strong></pre>
<pre class="screen">-----------------------------------------------------------------
Name                             Saved-configuration             
-----------------------------------------------------------------
Admin-VS                         not saved                       
vs1                              not saved                       
vs2                              not saved                       
vs3                              not saved                       
-----------------------------------------------------------------</pre>
</div>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0172360324__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Files</h4><p>PS configuration files</p>
<pre class="screen">#
admin
 virtual-system vs1
  description vs1
  port-mode port
  resource u4route upper-limit 1048576
  resource m4route upper-limit 2000
  resource u6route upper-limit 1048576 
  resource m6route upper-limit 512 
  resource vpn-instance upper-limit 512
  resource cpu weight 5 
  assign interface GigabitEthernet<span>0/3/2</span>
 virtual-system vs2
  description vs2
  port-mode port
  resource u4route upper-limit 1048576
  resource m4route upper-limit 2000
  resource u6route upper-limit 1048576 
  resource m6route upper-limit 512 
  resource vpn-instance upper-limit 512
  resource cpu weight 5 
  assign interface GigabitEthernet<span>0/3/3</span>
 virtual-system vs3
  description vs3
  port-mode port
  resource u4route upper-limit 1048576
  resource m4route upper-limit 2000
  resource u6route upper-limit 1048576 
  resource m6route upper-limit 512 
  resource vpn-instance upper-limit 512
  resource cpu weight 5 
  assign interface GigabitEthernet<span>0/3/4</span>
#</pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../../../software/nev8r10_vrpv8r16/user/vrp/dc_vrp_vs_cfg_0008.html">Configuration Examples for VSs
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
</div>
</div>
</body>
</html>