Configuration Precautions for EVPN
==================================

Configuration Precautions for EVPN

#### Feature Requirements

**Table 1** Feature requirements
| Feature Requirements | Series | Models |
| --- | --- | --- |
| BGP EVPN IPv4 peers cannot receive routes with IPv6 next hops. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In an EVPN over VXLAN IPv4/IPv6 dual-stack scenario, if the number of received Add-Path routes with the same prefix exceeds the upper limit and the number of advertised Add-Path routes reaches the upper limit, the RR prefers only the maximum number of Add-Path routes allowed and advertises these routes to IPv4 or IPv6 peers. The remaining routes are not advertised. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| After EVPN VPWS is upgraded, the EVPN VPWS over MPLS specification is subject to the EVPN SRv6 specification. EVPN MPLS services that exceed the EVPN SRv6 specification are affected. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In an EVPN VPLS accessing EVPN L3VPN scenario, the arp collect host enable command cannot be run on a device with both Layer 2 and Layer 3 services. Otherwise, the device cannot deliver MAC address entries, causing traffic forwarding problems. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN L3VPN carrier's carrier can be deployed only on MPLS networks and cannot be deployed on SRv6 networks. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In a scenario where EVPN L3VPN over SRv6 and EVPN L3VPN over MPLS interwork in Option B mode, EVPN L3VPN is deployed on the SRv6 network, and EVPN L3VPN over MPLS is deployed on the metro network. The two types of networks can communicate using Option B. In this scenario, pay attention to the following:  1. According to the command configuration, load balancing takes effect only for prefix routes received from peers. In addition, the routes must recurse to SRv6 or MPLS tunnels, and load balancing cannot be implemented between the routes and other routes. The load balancing rules in the same instance are the same. If the next hop of a route is an MPLS tunnel or an SRv6 tunnel, load balancing cannot be implemented.  2. In the EVPN Option B solution, ECMP or FRR is supported. The RDs of the same VPN deployed on dual-homing PEs must be the same.  3. For the same service instance, it is not recommended that Option B and re-origination be deployed at the same time. If the RDs are the same, the re-originated route suppresses the Option B route. If the RDs are different, the XGW sends two routes, wasting labels and forming useless FRR or ECMP on the remote PE.  4. In an Option B scenario, explicit network slicing cannot be configured on the EVPN SRv6 side. By default, traffic is forwarded through SRv6 BE or SRv6 TE Policy based on the optimal IGP cost. The EVPN address family does not support the reference of network slice attributes for network slice ID deployment.  5. Load balancing among two links is supported.  6. Inter-BGP instance route import is not supported.  7. Only 64k SRv6 VPN SIDs are supported. If the legacy network is an EVPN L3EVPN over LDP network and L3EVPN instances on PEs use the per-route per-label mode, the per-next-hop per-label configuration on the XGW does not take effect. As a result, VPN SID resources are exhausted when a large number of routes are deployed, and other services that require SIDs are affected.  Workarounds:  Properly plan configurations.  Impact:  1. Deployment restrictions  2. Load balancing specification | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| Constraints during the evolution:  1. Only PW redundancy in independent mode can be upgraded to EVPN VPWS. If FRR or PW redundancy in master/slave mode coexists with EVPN VPWS, the traffic model may be different before and after an upgrade to EVPN VPWS.  2. In the scenario where PWs have the same source and destination, the primary and secondary PWs can take different tunnels before the evolution, and corresponding protection is provided. However, after the upgrade to EVPN VPWS, no corresponding tunnel protection is provided.  Evolution to EVPN is not supported in the following scenarios:  1. Local CCC does not support evolution to EVPN.  2. Remote CCC does not support evolution to EVPN.  3. Mutual protection between local and remote sites does not support evolution to EVPN.  4. Only VPWS PW redundancy in E-Trunk master/backup mode can evolve to EVPN. VPWS PW redundancy in non-E-Trunk master/backup mode cannot evolve to EVPN. For example, VPWS PW redundancy in VRRP or ICCP master/backup mode cannot evolve to EVPN.  5. Segmented PWs do not support evolution to EVPN.  6. VPWS accessing VPLS does not support evolution to EVPN.  7. VPWS accessing EVPN does not support evolution to EVPN.  8. TDM/ATM PWE3 does not support evolution to EVPN.  9. Heterogeneous interworking cannot evolve to EVPN. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| After auto RD is configured to automatically assign an RD to an EVPN instance, the RD of the EVPN instance may change after the device restarts. Therefore, the RD assigned based on auto RD is not fixed and cannot be used for route-filters. If an RD attribute policy is used to filter EVPN routes, you need to configure static RDs. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In static EVPN VPWS scenarios, the EVPN address family l2vpn-family evpn must be configured. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| 1. In a port-active scenario, the AC affects the DF function, and the VLAN-based DF election mode and service ID-based DF election mode do not take effect. When a Huawei device interworks with a non-Huawei device, you are not advised to configure the VLAN-based DF election mode or service ID-based DF election mode.  2. BD EVPN instances cannot be used in EVPN VPLS scenarios.  3. The Eth-Trunk interfaces on the dual-homing PEs must be configured to work in LACP mode.  4. The maximum number of active links, minimum number of active links, or minimum bandwidth cannot be set on the CE or PE. This is to ensure that the active/standby status of the Eth-Trunk interface is determined by the DF status.  5. The DF election delay function cannot be configured in port-active scenarios.  6. EVPN VXLAN anycast scenarios are not supported. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| Limitations on evolution from common VPLS to EVPN VPLS are as follows:  1. After evolution to EVPN VPLS, default hub-AC/hub-PW isolation is not supported.  2. After evolution to EVPN VPLS, AC loop suppression is not supported.  3. After a VBDIF interface is configured during the evolution, traffic cannot enter the VBDIF interface after PW termination.  4. For features supported by both EVPN VPLS and common VPLS, evolution is implemented through configuration replacement. For example, to evolve the DiffServ mode, you need to configure the DiffServ mode in a BD first, and then use the DiffServ mode in the BD after the broadcast domain is switched.  5. During the evolution, the alarms generated before and after the broadcast domain is switched are deleted through the aging mechanism.  6. If a common VSI is unbound from a BD before the vpls-to-evpn migration in-process command is deleted, the forwarding broadcast domain rolls back to the VSI.  7. After a VSI is bound to a BD, MAC addresses are re-learned due to broadcast domain switching. As a result, transient unicast packets change to broadcast packets.  8. During the evolution, double forwarding resources are occupied. Therefore, you need to evaluate whether the resources will exceed the threshold before the evolution.  9. If STP is enabled on a main interface but the stp vpls-subinterface enable command is not run, the broadcast domain is switched from a VSI to a BD during switching. As a result, the interface may be blocked in advance. During the switchback, the broadcast domain is switched from a BD to a VSI, which may cause a loop in advance.  10. Before the evolution, static MAC addresses based on common VPLS PWs are configured. During the evolution, the broadcast domain is switched from VSIs to BDs. Static MAC addresses based on common VPLS PWs do not take effect for BDs.  11. During the evolution, the interface is blocked based on MAC flapping in the original broadcast domain. After the broadcast domain is switched, the interface is not automatically unblocked. You need to manually clear the loop or wait for the loop to be cleared by the aging mechanism. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| After a non-EVC sub-interface is bound to a BD, the limitations on binding the BD to a VSI are as follows:  1. BD EVPN is mutually exclusive with E-Tree.  2. UMR cannot be configured for the BD.  3. VNIs cannot be configured for the BD.  4. The sub-interface cannot be bound to an EVPN instance.  5. The sub-interface cannot be bound to an EVPL instance.  6. The sub-interface cannot be bound to an EVPL CCC.  7. VLAN aware cannot be configured on the sub-interface.  8. EVPN P2MP cannot be configured on the sub-interface.  9. The sub-interface cannot be bound to a VLL or local CCC.  10. L2TPv3 cannot be configured on the sub-interface.  11. No VLAN group can be configured on the sub-interface.  12. Layer 3 services (such as ip address/ipv6 enable/ip binding vpn-instance/ip address unnumbered) cannot be configured on the sub-interface.  13. Sticky MAC cannot be configured in the BD.  14. MAC address learning in qualify mode cannot be configured on the sub-interface.  15. DHCP snooping cannot be configured on the sub-interface. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| 1. In a UMR-enabled EVPN instance, each pair of A-Leaf nodes can advertise specific MAC addresses only through directly connected peers, but not RRs.  2. The EVPN instances on each pair of A-Leaf nodes are different and isolated by RTs. Different BDs need to be configured for different A-Leaf pairs.  3. OLT1 and OLT2 are isolated using EVPN E-Tree. UMRs are based on the BD granularity and cannot carry the E-Tree attribute of the AC interface. E-Tree isolation cannot be performed for incoming UMR traffic on the S-Leaf node.  4. The UMR forwarding function is configured through the BD EVPN instance. After the UMR forwarding function is enabled, the control plane delivers 0-0-0 and forwards packets based on UMRs. If the forwarding plane learns 0-0-0, it overwrites the learned 0-0-0 MAC address (based on details).  5. UMR: Only mac-only is controlled. mac-ip is not controlled.  6. After UMR is enabled, an extra BE table (UMR) is searched for known unicast packets (no specific route is found) and unknown unicast packets on the S-Leaf node. As a result, the forwarding performance decreases by about 20%.  7. ESI single-active cannot be configured in a BD in UMR scenarios.  8. UMR can be enabled only in EVPN VPLS SRv6 and EVPN VPLS MPLS scenarios, but not in EVPN VPLS VXLAN scenarios.  9. Mixed networking scenario (load balancing supports only two routes, and traffic detour occurs): Change the mixed networking device to single-homing or add VPN instances so that OLTs access different EVPN instances. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In EVPN VPLS, traditional MPLS EVPN VPLS and SRv6 cannot coexist in the same instance. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN VPLS over SRv6 BE does not support Option B. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN VPLS over SRv6 BE does not support remote FRR in dual-homing single-active scenarios. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN VPLS over SRv6 BE supports ACL filtering based on IPv6 and public network addresses on the network side, but does not support ACL filtering based on private network addresses. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN L3VPNv4 routes can be recursed only to SRv6 BE or MPLS tunnels. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN L3VPNv6 routes can recurse only to SRv6 BE or MPLS tunnels. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In an EVPN L3VPN scenario, if an IP route with a prefix specified using the gateway-ip field recurses to multiple MPLS tunnels, only one recursion result can be used for traffic forwarding. As a result, only one tunnel is used to forward traffic.  Therefore, in an EVPN L3VPN scenario, it is not recommended that a route with a prefix specified using the gateway-ip field recurse to an IP address shared by multiple MPLS tunnels for load balancing. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In an EVPN+VLL scenario, if a VE interface is configured on an SPE, the main interface must be bound to the VLL and the sub-interface must be bound to the EVPN.  If the type of the VLL AC interface on a UPE and that of the EVPN AC interface on the SPE are both QinQ in asymmetrical mode, EVPN traffic cannot be forwarded between the UPE and SPE. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In EVPN+VLL scenarios in non-decoupling mode, VLL supports only LDP, TE, and LDP over TE tunnels. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| The EVPN public network interface does not support MF classification. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN loop protection depends on MAC address learning. If MAC address learning is disabled, EVPN loop protection does not take effect. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In a scenario with EVPN and VPLS interworking, MAC FRR is not supported on the PW side. If MAC FRR is enabled based on EVPN, the MAC addresses on the PW side point only to PW interfaces, not to the protection links. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| IGMP snooping is not supported in EVPN and VPLS interworking scenarios. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In an EVPN and VPLS interworking scenario, only the primary and secondary PWs and EVPN single-active mode are supported. The EVPN active-active mode is not supported. The independent PW redundancy mode is not supported. The ignore-standby command cannot be configured for the secondary PW. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In a scenario with VPLS and EVPN interworking, a loop occurs in the following situations if the full-mesh networking is used:  (1) VPLS is configured to work in Spoken mode.  (2) VPLS E-Trunk is configured to work in active-active mode.  There, it is required to configure VPLS to work in Hub mode and VPLS E-Trunk to work in master/backup mode. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| PBB-EVPN does not support the use of BGP tunnels as public network tunnels.  Change the tunnel policy to prevent PBB EVPN routes from recursing to BGP tunnels. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| PBB-EVPN does not support the DiffServ mode.  The priority setting function needs to be implemented on the upstream and downstream nodes. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| When loopback is used in the downstream direction in a VLL accessing EVPN scenario, CAR for downstream traffic on a PW-VE sub-interface is inaccurate.  The workaround is to configure the evpn access vll convergence separate disable command. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| If multiple BDs are bound to a VSI and only one of the BDs is re-bound to an EVPN instance, PWs go down due to the re-binding. As a result, the services of other BDs that are not bound to the EVPN instance are interrupted.  Therefore, when a VSI is used by multiple BDs, the BDs to be rebound to EVPN instances are unbound from the VSI. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In a scenario where a VPLS with primary and secondary PWs interworks with a VXLAN in active-active mode, the ignore-standby PW attribute cannot be configured on the device where the VPLS interworks with the VXLAN. Otherwise, if both the primary and secondary PWs are configured to receive traffic, two copies of BUM traffic from the VXLAN to the VPLS will be generated. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| If the PE at one end of a VPLS has only one VSI and the PE at the other end has multiple VSIs, the VPLS network cannot be reconstructed into an EVPN. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| For a BD bound to both an EVPN instance and a VPLS VSI, the VPLS PWs cannot be set to be in Spoken mode.  If a VPLS PW is set to be in Spoken mode, loops may occur. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| A user device connects to another device through a switch. The user device first uses a switch connected to an EVPN network, and then switches to a switch connected to a VPLS network. After the user device switches back to the switch connected to the EVPN network within the MAC address aging time, services are interrupted until the VPLS network ages the MAC address of the device.  In the scenario where devices are connected through switches, you are advised to manually shut down the interfaces connected to the devices when the VPLS service is upgraded to the EVPN service and then enable the interfaces after the service upgrade. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| On a node where EVPN and VPLS coexist, if the node receives a MAC Withdraw message from the PW of the remote VSI, the MAC address of the AC interface is cleared, but the MAC address learned by EVPN is not cleared.  Deleting the MAC address triggers EVPN to broadcast MAC address deletion. After the AC interface MAC address is relearned, the address is re-broadcast on the EVPN. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In an EVPN dual-homing scenario, the dynamic ESI mode cannot ensure the switchover time. Only protocol convergence can be relied on. Therefore, the static ESI mode is recommended. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In an EVPN dual-homing active-active scenario, if the BGP connection between dual-homing PEs is disconnected, both dual-homing PEs are in the DF state. As a result, BUM traffic is doubled, and the dual-homing active-active function for BUM traffic fails.  Do not reset BGP on the dual-homing PEs. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| After an EVPN instance is added to a BD-VPLS network that already has service flows, services may be interrupted. After the upgrade is complete, services recover.  It is recommended that you set the VPLS PW to down before adding a VPLS PW. In a master/backup E-Trunk scenario, bind an EVPN instance to the backup E-Trunk and then to the master E-Trunk. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| The EVPN VPLS service supports only static configuration of the control word, which must be consistent between devices.  EVPN-VPWS services allow routes to carry the control word for matching and negotiation. If a route does not carry the control word, the service is not established. Control word auto-negotiation (preferred control-word) is not supported.  In EVPN-VPWS dual-homing networking, a bypass path needs to be established. Therefore, the same control word must be configured between PEs (between single-homing PEs and dual-homing PEs, and between dual-homing PEs) to prevent bypass path establishment failures due to mismatch. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In an L2-to-L3 EVPN scenario, an L3VE main interface inherits the system MAC address by default after being created. To connect L2VE interfaces corresponding to different L3VE interfaces to a BD, configure an independent MAC address for each L3VE main interface. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| When VLL VPN QoS recurses to a BGP LSP, the BGP entropy label function is not supported.  The BGP entropy label function is not supported in VPLS basic forwarding, VPLS VPN QoS, PBB VPLS, or BGP LSP recursion scenarios.  When public-network-and-private-network decoupling is not enabled for VPLS and MPLS services and VPLS services recurse to BGP LSPs, known unicast traffic does not support the BGP entropy label function. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In the EVPN VPLS SRv6 egress dual-homing scenario, egress protection does not take effect for BUM traffic. Therefore, you need to plan locators to implement egress protection only for known unicast routes. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| 1. Egress protection does not support CE multi-homing.  2. Different locators need to be deployed for single-homing and dual-homing services. Egress protection is not deployed for the locators used by single-homing services.  3. EVPN VPLS BUM and unicast services use different locators, and egress protection is not deployed for the locator used by BUM services.  4. When a route is leaked into multiple VPN instances, the remote SID can be mapped to only one local service instance. Ensure that the route leaking results on the dual-homing PEs are the same. (The RTs or route import relationships between instances on the dual-homing PEs must be the same.)  The egress protection function may fail. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In an EVPN dual-homing single-active scenario, CFM needs to be deployed between the CE and PEs to improve switchback performance. The CE and dual-homing PEs must support DF association with CFM to clear MAC addresses on the CE. Otherwise, switchback performance cannot be ensured. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| PBB EVPN public network tunnels do not support the following scenarios:  1. TE over GRE  2. LDP over TE over GRE | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In a sampling scenario where SRv6 and MPLS interworks in Option B mode:  1. In the SRv6 -> MPLS direction, the inbound interface restored through outbound interface sampling is the master interface, and the outbound interface restored through inbound interface sampling is the master interface.  2. In the MPLS -> SRv6 direction, the inbound interface restored through outbound interface sampling is the master interface. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| [SRv6] Option B SRv6 interworks with MPLS. In the SRv6-to-MPLS direction, when simple traffic classification is configured, the VPN label priority on the router is IP.TC[7:3], and simple traffic demapping is not performed. The priority of the public network label supports simple traffic demapping. For ATN devices, VPN label and public network label priorities are both IP.TC[7:3]. Simple traffic demapping is not performed. (The uniform mode is configured for the public network.) | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN in BD VLAN aware mode does not support SRv6. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| When an ESI has multiple sub-interfaces and AC status to influence DF election is enabled, the non-revertive function for ESI priority election does not take effect. BUM traffic on some sub-interfaces may not meet the expectation. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In a BD EVPN scenario, IGMP snooping does not support synchronization of user leave events between dual-homing PEs on the access side through EVPN Leave Synch routes (BGP EVPN Type 8 routes).  Per-flow Eth-Trunk deployment is recommended on the downstream CE to prevent join and leave messages from being sent to different devices between the dual-homing PEs on the access side.  If the IGMP Report message sent by the CE arrives at one PE and the Leave message sent by the CE arrives at the other PE, the PEs cannot respond to the Leave messages immediately, which delays the leave process. Instead, the PEs can only wait for the expiry of the user entries. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| Regarding EVPN active-active:  1. Dual-homing devices do not support inter-AS interconnection.  2. Non-anycast VXLAN active-active is not supported.  3. The ESIs of different interfaces on the dual-homing side must be different.  4. In active-active scenarios, a CE must be directly connected to PEs, and no transmission device can be deployed between the CE and PEs.  Traffic switching performance in case of a link failure is affected. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| The E-Tree attributes configured on the two dual-homing access interfaces must be the same. Otherwise, traffic may flow back. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| When a VLL accesses an EVPN, only non-BD EVPN (MPLS EVPN) is supported. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| For the EVPN E-Line feature:  EVPN single-active networking blocks access interface traffic. If the E-Trunk determines the active/standby status, the interface goes down. Therefore, EVPN single-active access and other active-active or Layer 3 services cannot use the same link for dual-homing access.  If the EVPN redundancy mode is single-active, EVPN cannot use the same link as active-active or Layer 3 services. Otherwise, other services may fail to forward traffic. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In the EVPL smooth evolution scenario, detection using ping/tracert evpn vpws -r 4 is not supported. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| 1. Egress protection does not support CE multi-homing.  2. Different locators need to be deployed for single-homing and dual-homing services. Do not deploy egress protection for locators used by single-homing services.  3. BUM and unicast services of EVPN E-LAN services use different locators, and egress protection is not deployed for the locators used by BUM services.  4. When a route is leaked into multiple VPN instances, the remote SID can be mapped to only one local service instance. Ensure that the route leaking results on the dual-homing PEs are the same (the instance leaking RTs or instance route import relationships on the dual-homing PEs must be the same). Otherwise, the egress protection function may fail. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In an IBGP scenario, if segmented VXLAN is configured on PE1, PE1 reflects the inclusive route learned by the local CE to PE2 through an RR. As a result, an extra VXLAN tunnel destined for the CE is generated on PE2. To solve this problem, you need to configure a routing policy on PE2 to deny the inclusive route on the CE side. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In a distributed gateway deployment scenario where both Layer 2 and Layer 3 services are transmitted (a BDIF interface is bound to an EVPN L3VPNv6 Layer 3 instance and a BD is bound to an EVPN Layer 2 instance) and HEVPN is configured, local traffic cannot be forwarded along the shortest path.  Basic protocol exchange and traffic forwarding are not affected in the scenario where both Layer 2 and Layer 3 services are transmitted and HEVPNv6 is configured. Only local forwarding along the shortest path is affected. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In a BGP EVPN L3VPN over SR-MPLS BE scenario, primary and backup SR-MPLS BE tunnels exist between an EVPN L3VPN edge PE and the peer edge PE. If fast tunnel fault detection is disabled, and the peer edge PE fails, protocol hard convergence triggers active/standby tunnel switching. If multiple types of tunnels (such as LDP LSPs) exist, a tunnel policy needs to be configured to speed up route convergence. Only the status of primary and backup SR-MPLS BE tunnels needs to be considered.  You need to switch to the VPN view and configure the following tunnel policy. If the primary SR-MPLS BE tunnel fails, traffic is rapidly switched to the backup SR-MPLS BE tunnel, instead of other types of tunnels (such as LDP tunnels). The recommended configurations are as follows:  tunnel-policy AAA  tunnel select-seq sr-lsp ldp load-balance-number 1 //Configure a tunnel policy to select only SR-MPLS BE tunnels.  #  ip vpn-instance vpn-801  ipv4-family  route-distinguisher 100:801  tnl-policy AAA  ip frr  vpn-target 801:801 export-extcommunity evpn  vpn-target 801:801 export-extcommunity  vpn-target 801:801 import-extcommunity evpn  vpn-target 801:801 import-extcommunity  tnl-policy AAA evpn  evpn mpls routing-enable  In an EVPN L3VPN over SR-MPLS BE scenario where fast tunnel switching detection (for example, BFD detection) is not enabled, if the edge PE of an EVPN L3VPN restarts, protocol hard convergence triggers tunnel switching. During the restart, traffic is switched to the backup SR-MPLS BE tunnel, and tunnel switching is slow. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN SRv6 instances do not support the EVPN IGMP multicast function, which is mutually exclusive with the igmp-snooping proxy command.  SRv6-enabled EVPN instances do not support the IGMP multicast function. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In an EVPN L3VPN scenario, if the gateway IP address is used to recurse IP routes and the recursion results are multiple MPLS tunnels, only one recursion result can be selected. As a result, only one recursion result is used to forward traffic, and the other recursion results are not used to forward traffic.  In an EVPN L3VPN scenario, if a gateway IP address is used for IP address recursion, you are not advised to select a gateway IP address with multiple MPLS tunnels for load balancing. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN peers and instances do not support MPLS-label-based export routing policies.  Configure an MPLS-label-based import routing policy for the EVPN peer and instance that receive EVPN routes.  The MPLS-label-based export routing policy cannot be uniformly configured for all remote devices in an EVPN routing policy scenario. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN L3VPNv6 does not support the import of VPN labeled IPv6 routes.  Level-2 carriers' hierarchical access to EVPN L3VPNv6 is not supported. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| Two EVPN instances with the same ERT are configured on a PE. The PE advertises EVPN routes to its EVPN peers. The EVPN peers select an optimal route and send BUM traffic to the local PE. In this case, traffic may fail to be forwarded.  Configure different ERTs for different EVPN instances on a PE. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN SRv6 instances do not support mLDP PMSI tunnels, which are mutually exclusive with inclusive-provider-tunnel. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In a distributed VXLAN gateway scenario using BGP EVPN, gateways at both ends of a VXLAN tunnel cannot be configured with the same static ARP entry or the same static route whose next hop recurses to the VXLAN tunnel. Otherwise, a loop may occur. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| A PW-VE interface cannot be bound to an EVPL instance in SRv6 mode.  Interworking between EVPN VPWS over SRv6 and traditional VPWS cannot be deployed. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| Different instances can coexist in CloudVPN and DCI scenarios.  ARP/IRB route:  When VBDIF interfaces are configured for CloudVPN and both Layer 2 and Layer 3 services are running, routing policies need to be configured to prevent routes from being re-originated and advertised in the following scenarios:  Scenario 1: Layer 2 services belong to different EVPN instances, but Layer 3 services belong to the same VPN but different network segments. In this case, you can configure a route filtering policy for the network segment to prevent routes from being regenerated and advertised.  Scenario 2: Layer 2 services belong to different EVPN instances, but Layer 3 services do not belong to the same VPN instance. In this case, you can configure a route filtering policy for all routes from the DC side to prevent routes from being re-originated and advertised.  Prefix route:  You also need to configure a routing policy to prevent routes from being re-originated and advertised. The specific processing policy is the same as the preceding one.  Routes on the DCI network are re-originated and advertised to the CloudVPN network, affecting service traffic planning. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| The command for ignoring the AC interface status (evpn-vpws ignore-ac-state) applies only to dual-homing networking scenarios with one-to-one protection. This command does not apply to scenarios where one side uses dual-homing networking and the other side uses single-homing networking.  In a scenario with dual-homing networking on one side and single-homing networking on the other side, if one AC interface on the dual-homing side goes down, routes are not withdrawn. In this case, if the bypass function is not configured, packet loss occurs. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In a VPN evolution scenario, VPLS supports LDP, and EVPN supports only MPLS EVPN. VPLS and EVPN converge broadcast domains through BDs. After PWs access EVPN, the learned MAC addresses are sent to the platform. MAC FRR, IRB routes, and redirection of MAC addresses learned by PWs are not supported.  Commands are used to control whether MPLS EVPN and LDP VPLS can be bound to a BD.  A command is used to disable the device from supporting IRB routes.  VXLAN EVPN and VPLS cannot be bound to the same BD.  IRB routes cannot be learned.  MAC addresses learned by PWs cannot be redirected. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In a scenario where routes are imported between VPN and public network instances, the color attribute cannot be modified using a route-policy. The imported routes inherit the route recursion result of the source instance. That is, if the source route supports SR-MPLS TE Policy recursion, the imported routes are also supported. If the source route does not support SR-MPLS TE Policy recursion, the imported routes are not supported.  Routes are imported based on the protocol type or specified network segment to prevent route import between public network and VPN instances.  The coloring accuracy in the scenario with route import between public network and VPN instances is affected. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| ES and ES-AD routes do not support instance-level export PBR.  Configure coloring based on the peer and specified route type (ES and ES-AD routes only).  ES and ES-AD routes cannot recurse to SR Policies correctly. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| Devices except SPEs in HEVPN scenarios can allocate labels only based on EVPN instances, but cannot allocate labels based on routes or next hops.  Basic protocol interaction and traffic forwarding are not affected. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In an EVPN dual-homing scenario, the dynamic ESI mode cannot ensure the switchover time and can only rely on protocol convergence. Therefore, the static ESI mode is recommended.  When dynamic ESIs are configured, dual-homing switchover performance cannot be ensured. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| If an ESI corresponds to multiple sub-interfaces and AC status affecting DF election is configured, the non-revertive function does not take effect after ESI priority-based DF election. BUM traffic on some sub-interfaces may not be forwarded as expected. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| If the outbound interface specified by the SID dynamically allocated to each next hop in an EVPN instance is different from that specified by the SID statically allocated to each next hop, the outbound interface specified by the SID statically allocated to each next hop takes effect. If the actual outbound interface does not match the next hop configured for the EVPN instance, traffic may be interrupted.  The outbound interface and next hop must be the same for dynamically allocated SIDs and statically allocated SIDs. Otherwise,  services may be interrupted. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In the L3VPN CSC scenario, the level-1 carrier PE needs to support the one-label-per-route mode. EVPN L3VPN does not support this mode. Therefore, the EVPN L3VPN CSC scenario is not supported.  Do not deploy EVPN L3VPN CSC on PEs.  Traffic fails to be forwarded in an EVPN L3VPN CSC scenario. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| VLL accessing SRv6 BD EVPN VPLS is not supported.  After a BD EVPN instance is configured with the segment-routing ipv6 best-effort command and bound to a BD, the BD cannot be bound to any PW VE interface or sub-interface. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| For east-west traffic of routed VNFs, hybrid load balancing is not supported between specific routes recursive to static routes and BGP routes. When specific routes recursive to static routes coexist with BGP routes, traffic is forwarded based on static routes. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| Non-BD EVPN does not support EVPN VPLS over SRv6.  SRv6 cannot be enabled for non-BD EVPN instances. That is, segment-routing ipv6 best-effort cannot be configured. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| When a BD VPLS network is dual-homed to an EVPN through PWs, you are not advised to configure an ESI in the dual-homing access-side PW view.  Do not configure an ESI in the dual-homing access-side PW view.  In this scenario, if the same ESI is configured in the access-side PW view, the switchback performance is poor when the master device is faulty, and traffic is interrupted. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| According to standards, EVPN routes carrying the GW-IP attribute cannot carry labels or SIDs. Therefore, if an export policy is used to add the GW-IP attribute to EVPN routes, the following scenarios are not supported:  PE1 sends a route to PE2 and PE3 through the RR, its single peer. PE1 expects the route received by PE2 to recurse to a VPN IP address and the route received by PE3 to recurse to an SR tunnel.  Different RRs are used to reflect routes, and routing policies are specified for multiple peers.  Traffic fails to be forwarded along the path that is expected to recurse to an SR tunnel. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| VXLAN/VXLAN EVPN and SRv6 BD EVPN VPLS cannot interwork.  After a BD is bound to a BD EVPN for which the segment-routing ipv6 best-effort command is configured, the BD cannot be bound to a VNI. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| When VXLAN6 and VXLAN4 coexist, if the router-id-extend private enable command is run on the local end, ensure that the remote end can preferentially select the unicast MAC route to VXLAN4.  Proper planning is recommended.  When VXLAN6 and VXLAN4 coexist and the router-id-extend private enable command is run, if a unicast MAC route to VXLAN6 is preferentially selected, remote unicast traffic is interrupted. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN-VPLS services support only static configuration of control words, which must be consistent between devices.  EVPN-VPWS services support control word-based route matching and negotiation. If routes do not match, services are not established. The preferred control word function is not supported.  In EVPN-VPWS dual-homing networking, a bypass path needs to be established. Therefore, the same control word must be configured between PEs (between single-homing PEs and dual-homing PEs, and between dual-homing PEs). Otherwise, the bypass path cannot be established due to control word mismatch.  Configure the control word according to the requirements in the restriction description.  If the control word is not configured according to this restriction, services may fail to run. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In the E2E SRv6 telco cloud scenario, if multiple links between different leaf nodes and a VM fail or multiple VMs fail, traffic may take detours between leaf nodes, causing loops.  To prevent loops, configure a TTL based on the peer leaf locator ID in the SRv6 view (set the TTL to 2 in E2E SRv6 telco cloud scenarios).  Otherwise, a traffic loop may occur. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In an EVPN L3VPN scenario, routes in an L3VPN instance are sent to the BGP EVPN address family as well as the BGP-VPNv4/VPNv6 address family by default (for local route leaking).  If the routes of an L3VPN instance need to be sent to the BGP-EVPN address family but not the BGP-VPNv4/v6 address family, you need to configure an export routing policy for the L3VPN instance IPv4 or IPv6 address family.  By default, routes of an L3VPN instance are sent only to the BGP VPNv4 address family. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In an E-Tree dual-homing scenario, the leaf attributes of the AC interfaces bound to an E-Tree instance must be the same. Otherwise, a traffic loop occurs, and the device reports an EVPN\_ETREE\_MULTIHOMED\_CONFIG\_ERROR event.  Configure the same leaf attribute for AC interfaces. Otherwise,  traffic forwarding in the EVPN E-Tree scenario is affected. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| ESI priority-based election is not supported in VPWS EVPN scenarios.  ESI priority-based DF election is not supported in VPWS EVPN scenarios. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In the same VPN instance, if SID allocation in per-instance mode and SID allocation in per-instance per-next-hop mode coexist, traffic may be unevenly load balanced.  It is recommended that SIDs be allocated in per-instance per-next-hop mode in the same VPN instance.  Load balancing may be unbalanced. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN VPLS over SRv6 TE is not allowed. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| VLAN-aware EVPN in BD mode does not support SRv6. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| 1. Only EVPN E-LAN and E-Line E-Trunk single-active scenarios are supported. The EVPN instance deployed for E-LAN is in BD EVPN mode, and other non-BD modes are not supported.  2. Only EVC sub-interfaces with E-Trunk single-active configured are supported. Other VPLS or VLL single-active scenarios are not supported.  The switching performance cannot be guaranteed, and a large number of packets are lost during the switching. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In the E2E SRv6 telco cloud scenario, if FRR is enabled on a PE and the costs of Add-Path routes advertised by different leaf nodes are different, the PEs do not form FRR + ECMP. Instead, they form ECMP.  Active/standby protection and load balancing cannot coexist. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| The non-revertive switching mode can be configured for ESI priority-based DF election. The non-revertive switching function must be enabled for the same ESIs on multi-homing PEs. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| Traditional VPLS and SRv6 BD EVPN VPLS cannot interwork.  After a BD is bound to a BD EVPN for which the segment-routing ipv6 best-effort command is run, the BD cannot be bound to a VSI. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| The Option B scenario is not supported. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| MPLS VPLS EVPN Option B and SRv6 cannot coexist. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| When a CE is dual-homed to an EVPN through an Eth-Trunk in single-active mode, deploying LACP on the CE side is recommended. Configuring different ESIs on the dual-homing access side is recommended.  In this scenario, the same ESI is configured on the access side. As a result, the switchback performance is poor if the active device fails. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| After the mac-learn-style qualify command is run in a BD, the VLAN encapsulation type and traffic behavior of a sub-interface bound to the BD are mutually exclusive as follows:  1. If the encapsulation type is dot1q, the pop outer traffic behavior is not supported.  2. If the encapsulation mode is dot1q flexible access, the pop outer traffic behavior is not supported.  3. If the encapsulation type is QinQ, the pop double traffic behavior is not supported.  4. If the encapsulation mode is untag, no traffic behavior is supported.  5. If the encapsulation type is any other, no traffic behavior is supported. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In EVPN L3VPNv6 scenarios, IPv6-prefix routes cannot carry gateway-IP addresses as link-local addresses.  In a telco cloud symmetric forwarding scenario with typical DC GW-TOR-VNF networking, if IPv6 services are transmitted, the VNF and TOR switch cannot advertise routes through IS-IS IPv6/OSPFv3.  If IPv6 services are transmitted, static routes must be configured between VNFs and TOR switches.  In a telco cloud symmetric forwarding scenario, if IPv6 services are used, dynamic routing protocols cannot be deployed between VNFs and TOR switches. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| A maximum of 1024 EVPL instances can be associated with the same VRRP group. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| Configuring an ESI on a slot VE interface is mutually exclusive with active/standby status determination based on the DF election result.  1. If an ESI is configured on a slot VE interface, active/standby status determination based on the DF election result cannot be configured for the static ESI.  2. If active/standby status determination based on the DF election result is configured for a static ESI, the ESI cannot be configured on a slot VE interface. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| Coexistence of EVPN and VSI:  1. In coexistence scenarios, only dual-homing single-active access to EVPN is supported.  2. In coexistence scenarios, only independent PW redundancy is supported on the network side.  3. In coexistence scenarios, MAC addresses may fail to be updated immediately in the case of MAC address flapping.  4. BGP VPLS does not support MAC Withdraw signaling triggered by an AC down event. Packet loss lasts for a long time in a switchover scenario, and the MAC addresses need to be aged.  5. VPLS multicast cannot coexist with EVPN.  6. In coexistence scenarios, the MPLS LSR ID must be the same as the EVPN source.  7. Only the coexistence of EVPN over MPLS/EVPN over SRv6 and VSI is supported. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| Interworking between VXLAN and EVPN over SRv6 is not supported. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN VPLS does not support dual-homing networking based on L2VE interfaces:  1. If an L2VE sub-interface is bound to a BD, an ESI cannot be configured on the L2VE main interface.  2. If an ESI is configured on an L2VE interface, the L2VE sub-interface cannot be bound to a BD. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| If mac-learn-style qualify is enabled for a BD, no VNI can be bound to the BD. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| The sticky MAC function must be configured or deleted on the dual-homing PEs. When the sticky MAC function is configured, you need to configure the MAC address localization command. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| If mac-learn-style qualify is enabled for a BD, no VBDIF interface can be created for the BD. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| If mac-learn-style qualify is enabled for a BD, the system checks the VSI bound to the BD. If the peer upe command is configured for the VSI, the two configurations are mutually exclusive. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| The bypass-vxlan enable command cannot be configured for the EVPN instance on an interworking node. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In DCI scenarios, EVPN ping supports only segment ping and does not support E2E ping or EVPN tracert. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In an EVPN dual-homing single-active scenario where the active/standby status is determined by E-Trunk, if the dual-homing PEs use dynamic ESIs, the max active-linknumber 1 command cannot be run on the CE. Downlink traffic may be interrupted.  In this scenario, it is recommended that static ESIs be configured for dual-homing PEs. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN ring access does not support non-BD EVPN or EVPN VPWS. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| EVPN ring access supports only dot1q EVC sub-interfaces. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| Interworking between EVPN and VSI:  1. In interworking scenarios, BGP AD and BGP VPLS accessing EVPN cannot be deployed. Only LDP VPLS accessing EVPN can be deployed.  2. In interworking protection scenarios, only PW redundancy in master/slave mode can be deployed for EVPN access. PW redundancy in independent mode cannot be deployed.  3. Interworking between VPLS and EVPN in qualify mode cannot be deployed.  4. In interworking scenarios, VBDIF interfaces cannot be configured for SPEs.  5. In interworking scenarios, only Y.1731, Y.1564, and RFC2544 end-to-end detection capabilities are supported. The ping and tracert protocols cannot be used for detection.  6. Only interworking between EVPN over MPLS/EVPN over SRv6 and VSI can be deployed. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| Interworking between VXLANv6 and EVPN over SRv6 is not supported. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In EVPN VPWS scenarios, if different EVPN instances are bound to different EVPL instances and the same local-service-id and same remote-service-id are configured for the EVPL instances, the same RT cannot be configured for different EVPN instances. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| The mac-learn-style qualify command and the arp collect host enable/nd collect host enable/arp l2-proxy enable command are mutually exclusive for a BD. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| If mac-learn-style qualify is enabled for a BD, an EVPN instance bound to the BD cannot carry the BD tag. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In an EVPN VPLS/VPWS dual-homing single-active scenario where master/backup status is determined based on the DF election result:  1. Aggregation and mixed non-direct connection cannot be used for access.  2. A CE cannot be dual-homed to PEs through an Eth-Trunk. A DF is dual-homed to PEs in single-active mode.  3. The DF single-active scenario cannot be deployed when a PW accesses an EVPN or EVPN interworks with VPLS.  4. The EVPN standard DF and traditional VPLS cannot coexist.  5. VXLAN EVPN cannot be deployed in single-active mode. Therefore, DF single-active cannot be deployed to determine the master/backup status.  6. Multi-homing single-active DFs cannot be deployed. Only dual-homing single-active DFs can be deployed.  7. When the DF becomes the master, the CE cannot clear MAC addresses. Interworking with non-Huawei devices depends on MAC address aging or reverse flow learning on the CE.  8. After a DF switchover is performed, the PE becomes the backup PE only instructs the CE to clear Layer 2 MAC addresses through CFM, but cannot send gratuitous ARP packets to instruct the CE to learn new ARP entries. Therefore, the CE cannot be dual-homed to the CE through VBDIF interfaces as a Layer 3 device.  9. Only BD EVPN dual-homing single-active DFs can be configured to determine the master/backup status.  10. Dynamic ESIs cannot be deployed in dual-homing single-active mode to determine the master/backup status.  11. The single-active DF cannot be specified globally to determine the master/backup status. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| VRRP can be configured only for EVPL instances whose AC interfaces are slot VE interfaces.  1. If a non-slot VE sub-interface is bound to an EVPL instance, VRRP cannot be configured for the EVPL instance.  2. If VRRP is configured for an EVPL instance, a non-slot VE sub-interface cannot be bound to the EVPL instance. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| A PW-VE interface cannot be bound to an EVPL instance in SRv6 mode. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| E-LAN supports smooth evolution from MPLS/SR-MPLS to SRv6.  1. In SRv6 tunnel scenarios, EVPN VPLS is not supported in DCI or HVPLS scenarios, such as interworking, coexistence, and re-origination between EVPN VPLS and traditional MPLS VPN.  DCI (VXLAN4/VXLAN6 and EVPN SRv6 interworking) is not supported.  2. EVPN VPLS supports only the BD access mode. Other EVPN modes (non-BD EVPN and PBB-EVPN) are not supported.  3. VLAN aware is not supported.  4. P2MP is not supported.  5. The traffic-policy command cannot be run in the BD EVPN view.  6. Add-Path needs to be configured on the RR to support the sending and receiving of IPv4/IPv6 routes.  7. Re-origination between EVPN VPLS over MPLS and EVPN VPLS over SRv6 is not supported.  8. In the target version, the specification occupied by EVPN VPLS over MPLS is subject to the specification occupied by EVPN VPLS over SRv6.  9. If a routing policy is used to add the SOO attribute, the SOOs of IPv4 and IPv6 routes on the same PE must be the same, and the SOOs on different PEs must be different.  10. In the Option B scenario where a PE is reflected by two ASBR PEs, load balancing is not supported during the evolution. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| In EVPN L3VPN over SRv6 TE Policy + MPLS L3VPN Option B interworking scenarios, EVPN L3VPN is deployed on the SRv6 network, and traditional VPN is deployed on the metro network, which is a traditional MPLS network. The two types of networks can communicate with each other in Option B mode. Pay attention to the following points in this scenario:  1. According to the command configuration, load balancing based on mapping from SRv6 SIDs to MPLS labels can be performed only among routes imported between protocols and cannot be performed with other routes. The load balancing rules in the same instance are the same. Load balancing cannot be implemented between routes whose next hops are MPLS tunnels and SRv6 tunnels, or between routes whose next hops are SRv6 BE tunnels and SRv6 TE Policies.  2. The inter-protocol Option B solution supports ECMP or FRR. The RDs of the same VPN deployed on the dual-homing PEs must be the same.  3. For the same service instance, it is not recommended that Option B and route re-origination be deployed together. If the RDs are the same, Option B routes are suppressed before being re-originated. If the RDs are different, the XGW sends two routes before Option B routes. As a result, labels are wasted and useless FRR or ECMP is formed on the remote PE.  4. In Option B scenarios, explicit network slicing cannot be configured on the EVPN SRv6 side. By default, SRv6 BE forwarding or SRv6 TE Policy forwarding is performed based on the lowest IGP cost. The EVPN address family cannot reference network slice attributes to deploy network slice IDs.  5. Two-channel load balancing is supported.  6. Inter-BGP instance route import is not supported.  7. Only 64K SRv6 VPN SIDs are supported. If the legacy network is an L3VPN over LDP network and the L3VPN instance on the PE uses the one-label-per-route mode, the one-label-per-next-hop configuration on the XGW becomes invalid. As a result, VPN SID resources are exhausted when a large number of routes are transmitted, and other services that need to apply for SIDs are affected.  Workaround:  Plan the configuration properly.  Impact:  1. Deployment limitations  2. Load balancing specifications | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |
| DF election result flooding for a BD ESI:  1. MAC redirection and local-remote FRR cannot be configured.  2. Active-active networking cannot be configured.  3. Only priority-based DF election and interface-based DF election can be configured. VLAN-based DF election cannot be configured.  4. Evolution cannot be deployed.  5. Only the DF election result can be used to determine the master/backup status, and the E-Trunk cannot be configured to determine the master/backup status. | NE40E-M2 | NE40E-M2E/NE40E-M2F/NE40E-M2H/NE40E-M2K/NE40E-M2K-B |