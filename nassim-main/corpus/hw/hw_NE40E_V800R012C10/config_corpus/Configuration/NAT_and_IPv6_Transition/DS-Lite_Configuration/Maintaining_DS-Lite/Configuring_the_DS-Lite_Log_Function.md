Configuring the DS-Lite Log Function
====================================

You can configure the DS-Lite log function to record DS-Lite translation information in real time, which strengthens device maintainability.

#### Context

DS-Lite logs are generated by a DS-Lite device during NAT operation. Their information contains basic NAT user information and DS-Lite operation information. These logs also record internal users' access to external networks, as well as external users' access to internal servers. When intranet users access an external network through the DS-Lite device, they share an external network address. For this reason, the users cannot be located. The log function helps record intranet users' access to external networks in real time, enhancing network maintainability.


#### Procedure

1. Run [**system-view**](cmdqueryname=system-view)
   
   
   
   The system view is displayed.
2. Run [**nat log rate**](cmdqueryname=nat+log+rate) *rate-value*
   
   
   
   The rate at which a DS-Lite device sends logs is set.
3. Run [**commit**](cmdqueryname=commit)
   
   
   
   The configuration is committed.
4. Run [**ds-lite instance**](cmdqueryname=ds-lite+instance+id) *instance-name* [ **id** *id* ]
   
   
   
   The DS-Lite instance view is displayed.
5. Run [**ds-lite log session enable**](cmdqueryname=ds-lite+log+session+enable+elog+syslog) [ **elog** | **syslog** ]
   
   
   
   The DS-Lite log function is enabled.
6. Run [**ds-lite log user enable**](cmdqueryname=ds-lite+log+user+enable+syslog+netstream) [ **syslog** | **netstream** ]
   
   
   
   The DS-Lite user log function is enabled.
7. Run [**ds-lite log host**](cmdqueryname=ds-lite+log+host+source+name+vpn-instance) *host-ip-address* *host-port* **source** *source-ip-address* *source-port* **name** *host-name* [ **vpn-instance** *vpn-instance-name* ]
   
   
   
   The DS-Lite log host information is configured.
8. (Optional) Run [**ds-lite log radius enable**](cmdqueryname=ds-lite+log+radius+enable)
   
   
   
   The DS-Lite RADIUS log function is enabled.
   
   If the semi-dynamic port pre-allocation mode is configured, the available port range is automatically extended after the initial port range is exhausted. In this situation, if the device needs to send logs to a RADIUS server, the function of semi-dynamic allocation of RADIUS logs must be enabled.
   
   In VS mode, this command is supported only by the admin VS.
9. (Optional) Run [**ds-lite log send-mode**](cmdqueryname=ds-lite+log+send-mode+session-start-only+session-end-only) { **session-start-only** | **session-end-only** }
   
   
   
   The mode of sending DS-Lite logs is configured.
10. Run [**commit**](cmdqueryname=commit)
    
    
    
    The configuration is committed.
11. (Optional) Configure a flexible DS-Lite log template.
    
    
    1. Run [**quit**](cmdqueryname=quit)
       
       Return to the system view.
    2. Run [**nat syslog flexible template**](cmdqueryname=nat+syslog+flexible+template+user+session) { **user** | **session** }
       
       A NAT flexible syslog template is created, and its view is displayed.
    3. (Optional) Run [**ds-lite time local**](cmdqueryname=ds-lite+time+local)
       
       The local time is displayed in logs.
    4. (Optional) Run [**ds-lite time**](cmdqueryname=ds-lite+time) { **endtime-second-dec** | **endtime-second-hex** | **starttime-second-dec** | **starttime-second-hex** | **starttime** | **timestamp-second-dec** | **timestamp-second-hex** | **timestamp** } { **local** | **utc** }
       
       The end time, start time, or timestamp in the log is set to the local time or UTC time.
       
       ![](../../../../public_sys-resources/note_3.0-en-us.png) 
       
       The **ds-lite time** command takes precedence over the **ds-lite time local** command run in the flexible log template view. If the **ds-lite time** command is run, the time format of the end time, start time, or timestamp takes effect according to the configured format. If the **ds-lite time** command is not run, the **ds-lite time local** command takes effect. If neither the **ds-lite time** nor the **ds-lite time local** command is run, the default UTC time format takes effect.
    5. Enter the DS-Lite flexible flow log template view and run the [**ds-lite position**](cmdqueryname=ds-lite+position) command to configure a DS-Lite flexible flow log template. Enter the DS-Lite flexible user log template view and run the [**ds-lite position**](cmdqueryname=ds-lite+position) command to configure a DS-Lite flexible user log template.
    6. Run [**commit**](cmdqueryname=commit)
       
       The configuration is committed.
    7. Run [**quit**](cmdqueryname=quit)
       
       Return to the system view.
    8. Run [**nat syslog descriptive format flexible template**](cmdqueryname=nat+syslog+descriptive+format+flexible+template+session+user) { **session** | **user** }
       
       Logs are bound to the flexible log template.
12. (Optional) Run [**nat syslog descriptive format**](cmdqueryname=nat+syslog+descriptive+format+cn+type2+type3)
    
    
    
    DS-Lite syslogs are configured to be in the extended format.
13. Run [**commit**](cmdqueryname=commit)
    
    
    
    The configuration is committed.