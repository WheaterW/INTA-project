
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="ip-tunnel(ECMP load balancing view)">
<meta name="DC.subject" content="ip-tunnel(ECMP load balancing view)">
<meta name="keywords" content="ip-tunnel(ECMP load balancing view)">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_PNF-Load_Balancing_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/IP(ECMP).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/LOAD-BALANCE_ECMP.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Load Balancing">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="Load Balancing">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="Load Balancing">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Creator" content="SUBSYS_ID_FWM_FIB">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907602308">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>ip-tunnel(ECMP load balancing view)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907602308"></a><a name="EN-US_CLIREF_0000001907602308"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">ip-tunnel(ECMP load balancing view)</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907602308__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">ip-tunnel</span></b> command configures the load balancing mode of tunnel packets.</p>
<p>The <b><span class="cmdname">undo ip-tunnel</span></b> command restores the default load balancing mode of tunnel packets.</p>
</p>
<p><p>
For the CE8855, CE6885, CE6885-T, and CE6885-LL in common forwarding mode and the CE6885-SAN and CE6885-LL in low-latency mode:
</p>
<p>
By default, tunnel packets are load balanced based on outer src-ip, dst-ip, l4-src-port, and l4-dst-port.
</p>
<p>
For the CE6866, CE6860-SAN, CE6860-HAM, CE6866K, CE8851-32CQ4BQ, CE6855-48XS8CQ, CE8851-32CQ8DQ-P, CE8850-SAN, CE8850-HAM, CE8851K, CE6820H, CE6820H-K, CE6820S, CE6863H, CE6863H-K, CE6881H, and CE6881H-K:
</p>
<p>
By default, tunnel packets are load balanced based on the inner inner-src-ip, inner-dst-ip, inner-l4-sport, and inner-l4-dport.
</p>
</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907602308__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p>For CE8851-32CQ8DQ-P, CE8850-HAM, CE8850-SAN, CE8851K, CE8855, CE8851-32CQ4BQ, CE6860-SAN, CE6866, CE6860-HAM, CE6866K, CE6855-48XS8CQ, CE6885, CE6885-T, CE6885-LL (standard forwarding mode), CE6863E-48S8CQ, CE6885-SAN: </p>

<p><b><span class="cmdname">ip-tunnel </span></b>{ <strong><span>inner-src-ip</span></strong> | <strong><span>inner-dst-ip</span></strong> | <strong><span>inner-l4-sport</span></strong> | <strong><span>inner-l4-dport</span></strong> | <strong><span>inner-protocol</span></strong> | <strong><span>src-interface</span></strong> | <strong><span>include-erspan</span></strong> } <sup>*</sup></p>

<p><b><span class="cmdname">undo ip-tunnel </span></b>{ <strong><span>inner-src-ip</span></strong> | <strong><span>inner-dst-ip</span></strong> | <strong><span>inner-l4-sport</span></strong> | <strong><span>inner-l4-dport</span></strong> | <strong><span>inner-protocol</span></strong> | <strong><span>src-interface</span></strong> | <strong><span>include-erspan</span></strong> } <sup>*</sup></p>

<p>For CE6820H, CE6820H-K, CE6820S, CE6863H, CE6863H-K, CE6881H, CE6881H-K: </p>

<p><b><span class="cmdname">ip-tunnel </span></b>{ <strong><span>inner-src-ip</span></strong> | <strong><span>inner-dst-ip</span></strong> | <strong><span>inner-l4-sport</span></strong> | <strong><span>inner-l4-dport</span></strong> | <strong><span>src-mac</span></strong> | <strong><span>dst-mac</span></strong> } <sup>*</sup></p>

<p><b><span class="cmdname">undo ip-tunnel </span></b>{ <strong><span>inner-src-ip</span></strong> | <strong><span>inner-dst-ip</span></strong> | <strong><span>inner-l4-sport</span></strong> | <strong><span>inner-l4-dport</span></strong> | <strong><span>src-mac</span></strong> | <strong><span>dst-mac</span></strong> } <sup>*</sup></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907602308__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>inner-src-ip</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Performs load balancing based on the inner source IP address.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>inner-dst-ip</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Performs load balancing based on the inner destination IP address.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>inner-l4-sport</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Performs load balancing based on the inner transport-layer source port.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>inner-l4-dport</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Performs load balancing based on the inner transport-layer destination port.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>inner-protocol</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Performs load balancing based on the inner transport-layer protocol.</p>
</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>This parameter is supported only on the CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>src-interface</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Performs load balancing based on the source interface.</p>
</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>This parameter is supported only on the CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>include-erspan</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Performs load balancing based on the source IP address, destination IP address, source port, and destination port of ERSPAN inner packets.</p>
</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>This parameter is supported only on the CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>src-mac</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Performs load balancing based on the source mac.</p>
</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>This parameter is supported only on the CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6820H, CE6820H-K and CE6820S.</p>
</div></div>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>dst-mac</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Performs load balancing based on the destination mac.</p>
</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>This parameter is supported only on the CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6820H, CE6820H-K and CE6820S.</p>
</div></div>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907602308__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>ECMP load balancing view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907602308__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907602308__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>When the device functions as an intermediate node of a tunnel and there is a load balancing link, you can run the ip-tunnel command to enable the device to perform load balancing based on the inner IP header fields of packets. This prevents uneven load balancing due to the use of the outer IP header for load balancing.</p>
<p><strong>Precautions</strong></p>
<div class="p"><p>Currently, GRE, 4over6, 6over4, VXLAN, and ERSPAN packets are supported.<p></p>
<span>For the CE6820H</span>, CE6820H-K, CE6820S, CE6863H, CE6863H-K, CE6881H, and CE6881H-K:</p>

<ul><li>GRE, 4over6, 6over4, and VXLAN packets: Load balancing is performed based only on the inner IP header.</li><li>ERSPAN packets: Load balancing is performed based only on the outer IP header.<p></p>
<span>For the CE8851-32CQ8DQ-P</span>, CE8850-HAM, CE8850-SAN, CE8851K, CE8855, CE8851-32CQ4BQ, CE6860-SAN, CE6866, CE6860-HAM, CE6866K, CE6855-48XS8CQ, CE6885, CE6885-T, CE6885-LL in standard forwarding mode, CE6863E-48S8CQ, CE6885-SAN, and CE6885-LL in low latency mode:</li><li>Load balancing is performed based only on the inner IP header.</li></ul>
</div>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907602308__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Perform ECMP load balancing based on the inner source IP address of tunnel packets.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>load-balance ecmp</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-ecmp] <strong>ip-tunnel inner-src-ip</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_PNF-Load_Balancing_Configuration_Commands_title.html">Load Balancing Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/IP(ECMP).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/LOAD-BALANCE_ECMP.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>