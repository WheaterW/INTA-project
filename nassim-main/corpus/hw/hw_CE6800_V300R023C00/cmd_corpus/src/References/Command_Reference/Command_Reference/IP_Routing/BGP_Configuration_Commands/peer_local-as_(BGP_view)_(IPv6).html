
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="peer local-as (BGP view) (IPv6)">
<meta name="DC.subject" content="peer local-as (BGP view) (IPv6)">
<meta name="keywords" content="peer local-as (BGP view) (IPv6)">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_BGP_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/GROUP-LOCAL-AS-DC(BGPOM).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/VRF-PEER-LOCAL-AS-DC(BGPOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Creator" content="SUBSYS_ID_BGPIPV6">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907764516">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>peer local-as (BGP view) (IPv6)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907764516"></a><a name="EN-US_CLIREF_0000001907764516"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">peer local-as (BGP view) (IPv6)</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907764516__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">peer local-as</span></b> command enables a device to use a fake AS number to establish a BGP peer relationship with a specified peer.</p>
<p>The <b><span class="cmdname">undo peer local-as</span></b> command cancels the existing configuration.</p>
</p>
<p>By default, a device uses an actual AS number to establish a BGP peer relationship with a peer.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907764516__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">peer </span></b><i><span class="varname">ipv6-address</span></i> <strong><span>local-as</span></strong> <i><span class="varname">local-as-value</span></i> [ <strong><span>dual-as</span></strong> ] [ <strong><span>prepend-global-as</span></strong> ] [ <strong><span>prepend-local-as</span></strong> ]</p>

<p><b><span class="cmdname">undo peer </span></b><i><span class="varname">ipv6-address</span></i> <strong><span>local-as</span></strong></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907764516__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">ipv6-address</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the IPv6 address of a peer.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a 32-digit hexadecimal number, in the format of X:X:X:X:X:X:X:X.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">local-as-value</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies an AS number.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p><p>For an AS number in integer format, the value ranges from 1 to 4294967295.</p>
<p>For an AS number in dotted notation, it is in the format of x.y, in which x and y are integers, with x ranging from 1 to 65535 and y ranging from 0 to 65535.</p>
</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>dual-as</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Allows the local end to use either the real AS number or the fake AS number to establish a connection with the peer end.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>prepend-global-as</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Adds the actual AS number to the AS_Path in the messages to be sent.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>prepend-local-as</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Adds the fake AS number to the AS_Path in received messages.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907764516__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>BGP view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907764516__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907764516__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>If the <b><span class="cmdname">peer local-as</span></b> command is run, without dual-as, prepend-global-as, or prepend-local-as specified, the local end uses only the fake AS number to establish a BGP peer relationship with the specified peer and adds only the fake AS number to the AS_Path of the routes to be advertised to the peer.<p></p>
<span>The</span> <b><span class="cmdname">peer local-as</span></b> command is used in a scenario where a carrier modifies network deployment. For example, in a carrier merger and acquisition scenario, if the acquirer's network and the acquiree's network belong to different ASs, BGP peers on the acquiree's network need to be shifted from their original AS to the AS of the acquirer's AS. If the customers of the acquiree do not want their BGP configurations to be changed or do not want them to be changed immediately during the shift, BGP peer relationships may be interrupted for a long time.<p></p>
<span>If a device uses a fake AS number to establish a BGP</span> peer relationship with an EBGP peer or confederation EBGP peer, it performs the following actions before sending routes to the EBGP peer or confederation EBGP peer:</p>

<ul><li>If prepend-global-as is not specified in the command, the device adds only the fake AS number to the AS_Path of the routes that match a specified export policy.</li><li>If prepend-global-as is specified in the command, the device adds the fake AS number followed by the global AS number to the AS_Path of the routes that match a specified export policy.<p></p>
<span>If a device uses a fake AS number to establish a BGP</span> peer relationship with an EBGP peer or confederation EBGP peer, it performs the following actions after receiving routes from the EBGP peer or confederation EBGP peer:</li><li>If prepend-local-as is not specified in the command, the device does not change the AS_Path of the received routes.</li><li>If prepend-local-as is specified in the command, the device adds the fake AS number to the AS_Path of the received routes before filtering them using the specified import policy.<p></p>
<span>The</span> <b><span class="cmdname">peer local-as</span></b> command is valid only for EBGP peers. If the local device uses the actual AS number to establish an EBGP peer relationship with a remote device, the actual AS number is carried in the AS_Path of the route to be sent to the remote device. If the local device uses the fake AS number to establish the EBGP peer relationship, the fake AS number is carried in the AS_Path of the route to be sent to the remote device.</li></ul>
<p><strong>Prerequisites</strong></p>
<p>Peers have been created using the <b><span class="cmdname">peer as-number</span></b> command.</p>
<p><strong>Configuration Impact</strong></p>
<p>If this command is run several times for a peer or a peer group, the latest configuration will overwrite the previous one.</p>
<p><strong>Precautions</strong></p>
<p>If the fake AS number configured on the local end is the same as the peer AS number and dual-as is configured, the peer cannot be added to the peer group. If the fake AS number configured on the local end is the same as the peer AS number and dual-as is not configured, the peer can be added to the peer group. Similarly, if the peer is added to a peer group, the fake AS number configured on the local end must be the same as the peer AS number, and dual-as cannot be configured. Confederation EBGP does not allow the fake AS number configured on the local end to be the same as the peer AS number configured on the peer. If the fake AS number configured on the local end is the same as the peer AS number configured on the peer, EBGP-specific configurations are not allowed. If the fake AS number is deleted, IBGP-specific configurations are not allowed. If the fake AS number configured on the local end is the same as the peer AS number configured on the peer and the dual-as parameter is configured, the type of the established connection may be EBGP or IBGP. Therefore, some IBGP or EBGP configurations may become invalid. Running the <b><span class="cmdname">peer local-as</span></b> command causes the re-establishment of the peer relationship. After the peer local-as [ dual-as ] [ prepend-global-as ] [ prepend-local-as ] command is run, if the dual-as or prepend-local-as configuration is modified again, the peer relationship is re-established. However, if the prepend-global-as configuration is modified again, the peer relationship is not re-established.<p></p>
<span>A loop occurs in the following scenarios</span>:</p>

<ul><li>The peer established based on the real AS number receives the route advertised by the peer established based on the fake AS number.</li><li>The peer established based on the fake AS number receives the route advertised by the peer established based on the real AS number.<p></p>
<span>You can configure the prepend-global-as parameter</span> to prevent loops.</li></ul>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907764516__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Set a 2-byte fake AS number for a peer.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>bgp 100</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp] <strong>peer 2001:DB8:1::1 as-number 200</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp] <strong>peer 2001:DB8:1::1 local-as 99</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_BGP_Configuration_Commands_title.html">BGP Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/GROUP-LOCAL-AS-DC(BGPOM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/VRF-PEER-LOCAL-AS-DC(BGPOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>