
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="peer allow-cluster-loop (BGP-VPN-Target address family view)">
<meta name="DC.subject" content="peer allow-cluster-loop (BGP-VPN-Target address family view)">
<meta name="keywords" content="peer allow-cluster-loop (BGP-VPN-Target address family view)">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_BGP_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/PEER-VPNTARGET-ALLOW-AS-LOOP(BGPVPNTARGET).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/BGP-MULI-INSTANCE-PEER-AS(BGPOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Creator" content="SUBSYS_ID_BGPVPNTARGET">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001942843277">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>peer allow-cluster-loop (BGP-VPN-Target address family view)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001942843277"></a><a name="EN-US_CLIREF_0000001942843277"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">peer allow-cluster-loop (BGP-VPN-Target address family view)</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001942843277__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">peer allow-cluster-loop</span></b> command sets the maximum number of times the local cluster ID can be included in the Cluster_List of each received route.</p>
<p>The <b><span class="cmdname">undo peer allow-cluster-loop</span></b> command does not allow the local cluster ID to be included in the Cluster_List of each received route.</p>
</p>
<p>By default, the local cluster ID cannot be included in the Cluster_List of each received route.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001942843277__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p>For CE8851-32CQ8DQ-P, CE8850-HAM, CE8850-SAN, CE8851K, CE8855, CE8851-32CQ4BQ, CE6860-SAN, CE6866, CE6860-HAM, CE6866K, CE6820H, CE6820H-K, CE6820S, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6855-48XS8CQ, CE6885, CE6885-T, CE6885-LL (standard forwarding mode), CE6863E-48S8CQ, CE6885-SAN: </p>

<p><b><span class="cmdname">peer </span></b>{ <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">ipv6-address</span></i> } <strong><span>allow-cluster-loop</span></strong> [ <i><span class="varname">loop-number</span></i> ]</p>

<p><b><span class="cmdname">undo peer </span></b>{ <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">ipv6-address</span></i> } <strong><span>allow-cluster-loop</span></strong></p>

<p>For CE6885-LL (low latency mode): </p>

<p><b><span class="cmdname">peer </span></b><i><span class="varname">ipv4-address</span></i> <strong><span>allow-cluster-loop</span></strong> [ <i><span class="varname">loop-number</span></i> ]</p>

<p><b><span class="cmdname">undo peer </span></b><i><span class="varname">ipv4-address</span></i> <strong><span>allow-cluster-loop</span></strong></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001942843277__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">ipv4-address</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the IPv4 address of a peer.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is in dotted decimal notation.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">ipv6-address</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies an IPv6 peer address.</p>
</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a 32-bit hexadecimal string in format X:X:X:X:X:X:X:X.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">loop-number</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the number of local AS number repetitions.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 1 to 10. The default value is 1.</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001942843277__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>BGP-VPN-target address family view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001942843277__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001942843277__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p>All PEs and RRs are in the same AS, and the BGP-EVPN and VPN-Target address families are enabled for the peers on all PEs and RRs. PE1 is the client of RR1, PE2 is the client of RR2, RRR is the level-2 reflector, and RR1 and RR2 are the clients of RR2. A private network with RT 1:1 is configured on PE1 and PE2. PE1 receives a private network route from CE1.<p></p>
<span>In the case that the cluster ID loop of the reflector</span> is not allowed: RR1 and RR2 advertise the RT routes received from PEs to the level-2 RRR. The level-2 RRR selects routes, for example, it selects the route from RR1, and advertises the route to RR1 and RR2, respectively. However, the RR cluster list carried by RR1 contains the cluster ID of the local RR. Therefore, the VPN ORF route is discarded. As a result, RR1 does not have the RT filter of RRR and cannot instruct the BGP EVPN peer to advertise routes. As a result, CE2 cannot learn routes from CE1. In this case, you need to run the <b><span class="cmdname">peer allow-cluster-loop</span></b> command in the VPN ORF address family view of RR1 for the peer RRR so that RR1 can receive RT routes advertised by the level-2 RRR and guide route advertisement to BGP EVPN peers.</p>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001942843277__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Set the maximum number of times the local cluster ID can be included in the Cluster_List of each received route to 1.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>bgp 100</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp] <strong>peer 10.2.2.2 as-number 100</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp] <strong>ipv4-family vpn-target</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp-af-vpn-target] <strong>peer 10.2.2.2 enable</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp-af-vpn-target] <strong>peer 10.2.2.2 allow-cluster-loop 1</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_BGP_Configuration_Commands_title.html">BGP Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/PEER-VPNTARGET-ALLOW-AS-LOOP(BGPVPNTARGET).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/BGP-MULI-INSTANCE-PEER-AS(BGPOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>