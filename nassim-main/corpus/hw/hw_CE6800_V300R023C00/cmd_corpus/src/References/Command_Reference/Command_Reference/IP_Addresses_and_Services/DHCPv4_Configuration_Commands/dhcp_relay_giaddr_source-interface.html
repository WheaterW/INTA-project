
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="dhcp relay giaddr source-interface">
<meta name="DC.subject" content="dhcp relay giaddr source-interface">
<meta name="keywords" content="dhcp relay giaddr source-interface">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_PNF-DHCP_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/DHCP_RELAY_GIADDR_OUTGOING-INTERFACE-ADDRESS.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/DHCP_RELAY_INFORMATION_ENABLE.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="DHCPv4">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="DHCPv4">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="DHCPv4">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Creator" content="SUBSYS_ID_ESAP_DHCPRELAY">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907762432">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>dhcp relay giaddr source-interface</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907762432"></a><a name="EN-US_CLIREF_0000001907762432"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">dhcp relay giaddr source-interface</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907762432__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">dhcp relay giaddr source-interface</span></b> command configures the source interface of DHCP relayed packets and enters the primary IP address of the interface into the giaddr field.</p>
<p>The <b><span class="cmdname">undo dhcp relay giaddr source-interface</span></b> command restores the default settings.</p>
</p>
<p>By default, the source interface of DHCP relayed packets is not configured and the IP address of the DHCP relay agent is entered into the giaddr field.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907762432__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">dhcp relay giaddr source-interface </span></b>{ <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-num</span></i> | <i><span class="varname">interface-name</span></i> }</p>

<p><b><span class="cmdname">undo dhcp relay giaddr source-interface</span></b></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907762432__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">interface-type</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the interface type.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">interface-num</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies an interface number.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">interface-name</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies an interface name.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907762432__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>100ge sub-interface view,</span><span>100GE interface view,</span><span>10GE sub-interface view,</span><span>10GE interface view,</span><span>200GE sub-interface view,</span><span>200GE interface view,</span><span>25GE sub-interface view,</span><span>25GE interface view,</span><span>400GE sub-interface view,</span><span>400GE interface view,</span><span>50GE sub-interface view,</span><span>50GE interface view,</span><span>Eth-Trunk sub-interface view,</span><span>Eth-Trunk interface view,</span><span>VBDIF interface view,</span><span>VLANIF interface view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907762432__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907762432__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<ul><li>In a distributed gateway scenario, configure the DHCP relay function on the gateway interface of each distributed gateway. The DHCP relay agent fills the giaddr field with the IP address of the gateway interface in the request packet sent to the DHCP server. Based on the giaddr field, the DHCP server sets the destination IP address of the response packet to the IP address of the gateway interface. However, because the gateway interfaces of distributed gateways have the same IP address, the response packet from the DHCP server may be sent back to other distributed gateways (not the device that sends the request packet). As a result, users cannot obtain IP addresses. To solve the preceding problems, you can configure a source interface for DHCP relay packets on each distributed gateway. Then, the DHCP relay agent uses the primary IP address of the interface to fill in the giaddr field to communicate with the DHCP server. The IP address of the source interface can communicate with the DHCP server, and the IP address is unique on all distributed gateways. Therefore, the response packets from the DHCP server can be sent to the correct distributed gateways.</li><li>When a user and a DHCP server are located in different VPNs, if the DHCP relay agent still uses the IP address of the relay interface as the relay agent address, the DHCP server cannot communicate with the DHCP relay agent through this address, and DHCP reply packets are unreachable. To solve this problem, run the <b><span class="cmdname">dhcp relay giaddr source-interface</span></b> command to configure the IP address of the source interface as the relay agent address so that the DHCP reply packets from the DHCP server can be forwarded to the DHCP relay agent.</li></ul>
<p><strong>Prerequisites</strong></p>
<p>DHCP relay has been enabled by running the <b><span class="cmdname">dhcp select relay</span></b> command in the interface view.</p>
<p><strong>Follow-up Procedure</strong></p>
<p>By default, the DHCP server selects an IP address pool based on the giaddr field. After this command is configured, the primary IP address of the source interface is entered into the giaddr field. Because the primary IP address of the source interface and the IP address of the DHCP relay-enabled interface are on different network segments, if the DHCP server still selects an IP address pool based on the giaddr field, DHCP clients cannot properly communicate even if they have obtained IP addresses. The DHCP relay-enabled interface functions as the gateway for connected DHCP clients. Therefore, you need to run the <b><span class="cmdname">dhcp option82 link-selection insert enable</span></b> command to configure the function of inserting the Link-selection suboption of the Option82 field into DHCP relayed DHCP request packets. The IP address of the DHCP relay-enabled interface is entered into the Link-selection suboption. The DHCP server then selects an IP address pool based on the Link-selection suboption after receiving a request packet.</p>
<p><strong>Precautions</strong></p>
<ul><li>Ensure that the IP address of the source interface and the DHCP server can communicate with each other.</li><li>The source interface and the DHCP relay-enabled interface can be bound to different VPNs.</li><li>The DHCP server must be capable of parsing the Link-selection suboption.</li></ul>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907762432__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">



<div class="p"># On interface <span>100GE</span><span>1/0/1</span>, set the source interface of DHCP relayed packets to LoopBack1.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>interface loopback 1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-LoopBack1] <strong>ip address 10.1.1.1 24</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-LoopBack1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>dhcp enable</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>interface <span>100GE</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>dhcp select relay</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>dhcp relay giaddr source-interface loopback 1</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_PNF-DHCP_Configuration_Commands_title.html">DHCPv4 Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/DHCP_RELAY_GIADDR_OUTGOING-INTERFACE-ADDRESS.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/DHCP_RELAY_INFORMATION_ENABLE.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>