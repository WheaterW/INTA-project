
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="peer allow-as-loop (BGP-EVPN address family view) (IPv6)">
<meta name="DC.subject" content="peer allow-as-loop (BGP-EVPN address family view) (IPv6)">
<meta name="keywords" content="peer allow-as-loop (BGP-EVPN address family view) (IPv6)">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_VXLAN_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/GROUP-EVPN-ADVERTISE-LARGE-COMMUNITY(BGPEVPNOM).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/GROUP-EVPN-ALLOW-AS-LOOP(BGPEVPNOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="DC.Creator" content="SUBSYS_ID_BGPEVPNOM">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907766964">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>peer allow-as-loop (BGP-EVPN address family view) (IPv6)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907766964"></a><a name="EN-US_CLIREF_0000001907766964"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">peer allow-as-loop (BGP-EVPN address family view) (IPv6)</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907766964__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">peer allow-as-loop</span></b> command sets the number of local AS number repetitions.</p>
<p>The <b><span class="cmdname">undo peer allow-as-loop</span></b> command cancels the configuration.</p>
</p>
<p>By default, the local AS number cannot be repeated.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907766964__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">peer </span></b><i><span class="varname">peerIpv6Addr</span></i> <strong><span>allow-as-loop</span></strong> [ <i><span class="varname">num</span></i> ]</p>

<p><b><span class="cmdname">undo peer </span></b><i><span class="varname">peerIpv6Addr</span></i> <strong><span>allow-as-loop</span></strong></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907766964__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">peerIpv6Addr</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the IPv6 address of a BGP EVPN peer.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a 32-bit hexadecimal string in format X:X:X:X:X:X:X:X.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">num</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Maximum number of times the local AS number can be included in the AS_Path of each received route.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer in the range from 1 to 10. The default value is 1.</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907766964__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>BGP-EVPN address family view,</span><span>bgp-muli-instance-af-evpn view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907766964__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907766964__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>Generally, BGP uses AS numbers to detect routing loops. The local AS number configured using the bgp command and the fake AS number configured using the peer fake-as command are compared with the AS_Path carried in the received route. The number of loops is the largest. In Hub and Spoke networking, if EBGP runs between the PE and CE of the Hub, the routing information advertised by the Hub-PE to the Hub-CE carries the AS number of the Hub-CE. When the Hub-PE receives the routing update from the Hub-CE, the routing update carries the AS number of the Hub-PE. In this case, the Hub-PE cannot receive the routing update.<p></p>
<span>To ensure correct route transmission in the Hub and</span> Spoke networking, configure the BGP peers on the path from the Hub-CE to the Spoke-CE to allow the routes with the same AS number in the AS_Path attribute to pass.</p>
<p><strong>Prerequisites</strong></p>
<p>BGP peers have been enabled in the BGP-EVPN address family view.</p>
<p><strong>Configuration Impact</strong></p>
<p>If the peer command is run more than once for the same peer, the latest configuration overrides the previous one.</p>
<p><strong>Precautions</strong></p>
<p>The <b><span class="cmdname">peer allow-as-loop</span></b> command does not take effect for IBGP peers or BGP peers in a sub-confederation. The device checks whether the routes received from EBGP peers or EBGP peers in the confederation contain the local AS number. The minimum number of repetitions is 2, and the value 1 is not displayed.<p></p>
<span>Running the</span> <b><span class="cmdname">peer allow-as-loop</span></b> command may cause routing loops. Therefore, exercise caution when running this command and specify the number of AS number repetitions as required.</p>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907766964__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Set the number of local AS number repetitions to 2 in the BGP-EVPN address family view.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>bgp 200</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp] <strong>peer 2001:db8:1::1 as-number 200</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp] <strong>l2vpn-family evpn</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp-af-evpn] <strong>peer 2001:db8:1::1 enable</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp-af-evpn] <strong>peer 2001:db8:1::1 allow-as-loop 2</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_VXLAN_Configuration_Commands_title.html">VXLAN Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/GROUP-EVPN-ADVERTISE-LARGE-COMMUNITY(BGPEVPNOM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/GROUP-EVPN-ALLOW-AS-LOOP(BGPEVPNOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>