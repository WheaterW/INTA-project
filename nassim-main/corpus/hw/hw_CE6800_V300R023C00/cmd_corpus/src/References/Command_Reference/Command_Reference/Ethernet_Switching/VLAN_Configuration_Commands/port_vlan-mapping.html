
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="port vlan-mapping">
<meta name="DC.subject" content="port vlan-mapping">
<meta name="keywords" content="port vlan-mapping">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_VLAN_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/PORTTRUNKPVID(VLANOM).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/PORTVLANSTACKING(ETHBASEOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Creator" content="SUBSYS_ID_ETHBASEOM">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001942841125">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>port vlan-mapping</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001942841125"></a><a name="EN-US_CLIREF_0000001942841125"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">port vlan-mapping</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001942841125__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">port vlan-mapping</span></b> command configures VLAN mapping on an interface.</p>
<p>The <b><span class="cmdname">undo port vlan-mapping</span></b> command deletes VLAN mapping on an interface.</p>
</p>
<p>By default, VLAN mapping is disabled on interfaces.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command is supported only on the CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6820H, CE6820H-K and CE6820S.</p>
</div></div>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001942841125__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">

<p><b><span class="cmdname">port vlan-mapping vlan </span></b><i><span class="varname">vlan-id1</span></i> <strong><span>map-vlan</span></strong> <i><span class="varname">vlan-id3</span></i> [ <strong><span>remark-8021p</span></strong> <i><span class="varname">8021p-value</span></i> ]</p>

<p><b><span class="cmdname">port vlan-mapping vlan </span></b><i><span class="varname">vlan-id1</span></i> <strong><span>inner-vlan</span></strong> <i><span class="varname">vlan-id5</span></i> <strong><span>map-vlan</span></strong> <i><span class="varname">vlan-id3</span></i> [ <strong><span>map-inner-vlan</span></strong> <i><span class="varname">vlan-id4</span></i> ] [ <strong><span>remark-8021p</span></strong> <i><span class="varname">8021p-value</span></i> ]</p>

<p><b><span class="cmdname">port vlan-mapping vlan </span></b><i><span class="varname">vlan-id1</span></i> <strong><span>inner-vlan</span></strong> <i><span class="varname">vlan-id5</span></i> <strong><span>map-single-vlan</span></strong> <i><span class="varname">vlan-id3</span></i></p>

<p><b><span class="cmdname">port vlan-mapping vlan </span></b><i><span class="varname">vlan-id1</span></i> <strong><span>inner-vlan</span></strong> <i><span class="varname">vlan-id5</span></i> <strong><span>to</span></strong> <i><span class="varname">vlan-id6</span></i> <strong><span>map-vlan</span></strong> <i><span class="varname">vlan-id3</span></i> [ <strong><span>remark-8021p</span></strong> <i><span class="varname">8021p-value</span></i> ]</p>


<p><b><span class="cmdname">undo port vlan-mapping </span></b>{ <strong><span>vlan</span></strong> <i><span class="varname">vlan-id1</span></i> [ <strong><span>map-vlan</span></strong> <i><span class="varname">vlan-id3</span></i> [ <strong><span>remark-8021p</span></strong> <i><span class="varname">8021p-value</span></i> ] ] }</p>

<p><b><span class="cmdname">undo port vlan-mapping vlan </span></b><i><span class="varname">vlan-id1</span></i> <strong><span>inner-vlan</span></strong> <i><span class="varname">vlan-id5</span></i> [ <strong><span>map-vlan</span></strong> <i><span class="varname">vlan-id3</span></i> [ <strong><span>map-inner-vlan</span></strong> <i><span class="varname">vlan-id4</span></i> ] [ <strong><span>remark-8021p</span></strong> <i><span class="varname">8021p-value</span></i> ] ]</p>

<p><b><span class="cmdname">undo port vlan-mapping all</span></b></p>

<p><b><span class="cmdname">undo port vlan-mapping vlan </span></b><i><span class="varname">vlan-id1</span></i> <strong><span>inner-vlan</span></strong> <i><span class="varname">vlan-id5</span></i> <strong><span>map-single-vlan</span></strong> <i><span class="varname">vlan-id3</span></i></p>

<p><b><span class="cmdname">undo port vlan-mapping vlan </span></b><i><span class="varname">vlan-id1</span></i> <strong><span>inner-vlan</span></strong> <i><span class="varname">vlan-id5</span></i> <strong><span>to</span></strong> <i><span class="varname">vlan-id6</span></i> [ <strong><span>map-vlan</span></strong> <i><span class="varname">vlan-id3</span></i> ] [ <strong><span>remark-8021p</span></strong> <i><span class="varname">8021p-value</span></i> ]</p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001942841125__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>to</span></strong> <i><span class="varname">vlan-id6</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the VLAN ID before mapping.</p>
<p>For double-tagged packets, this parameter specifies the end VLAN ID in the inner VLAN tag before mapping.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 1 to 4094.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>map-vlan</span></strong> <i><span class="varname">vlan-id3</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the VLAN ID after mapping.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 1 to 4094.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>remark-8021p</span></strong> <i><span class="varname">8021p-value</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the 802.1p priority in the VLAN tag to be mapped to.</p>
<p>If this parameter is specified, after a Layer 2 Ethernet interface receives tagged packets, it maps the VLAN tag of packets to a specified VLAN tag and uses the specified 802.1p priority.</p>
<p>If double-tagged packets are received, this parameter specifies the 802.1p priority in the outer VLAN tag to be mapped to.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 0 to 7.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>vlan</span></strong> <i><span class="varname">vlan-id1</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies a VLAN range carried in received frames.</p>
<p>lowVid specifies the start VLAN ID in received frames.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 1 to 4094.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>inner-vlan</span></strong> <i><span class="varname">vlan-id5</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the VLAN ID before mapping.</p>
<p>For double-tagged packets, this parameter specifies the start inner VLAN ID before mapping.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 1 to 4094.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>map-inner-vlan</span></strong> <i><span class="varname">vlan-id4</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the VLAN ID after mapping.</p>
<p>For double-tagged packets, this parameter specifies the inner VLAN ID after mapping.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 1 to 4094.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>map-single-vlan</span></strong> <i><span class="varname">vlan-id3</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>If double-tagged packets are received, this parameter specifies the single VLAN ID to be mapped to.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 1 to 4094.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>all</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Deletes all VLAN mapping configurations.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001942841125__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>Layer 2 100GE interface view,</span><span>Layer 2 10GE interface view,</span><span>Layer 2 200GE interface view,</span><span>25GE-L2 view,</span><span>400GE-L2 view,</span><span>Layer 2 50GE interface view,</span><span>Layer 2 Eth-Trunk interface view,</span><span>Layer 2 GE interface view,</span><span>Interface group view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001942841125__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001942841125__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>A network needs to be expanded with the growth of access users and data services, which poses the following challenges to the administrator:</p>

<ul><li>Existing and new sites assigned different VLAN IDs need to communicate.</li><li>Inconsistent VLAN plans among sites access the public network causes VLAN ID conflicts. Therefore, VLANs at a site need to be isolated with those at another site.</li><li>Sites that access to the public network have asymmetrical VLAN planning.<p></p>
<span>To prevent these problems</span>, you can run the <b><span class="cmdname">port vlan-mapping</span></b> command to configure VLAN mapping on edge devices of the public network to map the user VLAN tag to the public VLAN tag to implement inter-VLAN communication.</li></ul>
<p><strong>Prerequisites</strong></p>
<p>The interface has been configured as a hybrid or trunk interface using the port link-type { hybrid | trunk } command.</p>
<p><strong>Configuration Impact</strong></p>
<p>VLAN mapping is implemented after packets are received on an inbound interface and before packets are sent out from an outbound interface. After VLAN mapping is enabled:</p>

<ul><li>Service VLAN IDs and user VLAN IDs change.</li><li>Private network VLAN IDs and public network VLAN IDs change.</li></ul>
<p><strong>Precautions</strong></p>
<p>When VLAN mapping is used to implement inter-VLAN communication, the IP addresses of the devices in the two VLANs must be on the same network segment. If the IP addresses of the devices in the two VLANs are not in the same network segment, Layer 3 routing is required for the devices to communicate with each other.</p>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001942841125__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Configure 2 to 2 VLAN mapping to map outer VLAN 100 and inner VLAN 200 of received packets to outer VLAN 10 and inner VLAN 20 before the packets are forwarded.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>interface <span>100GE</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>port link-type trunk</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>port vlan-mapping vlan 100 inner-vlan 200 map-vlan 10 map-inner-vlan 20</strong>
</pre>
</div>

<div class="p"># Configure 2 to 1 VLAN mapping to map the outer VLAN ID 100 and inner VLAN IDs 200 to 300 of incoming packets to the outer VLAN ID 10 and transparently transmit the inner VLAN ID as data.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>interface <span>100GE</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>port link-type trunk</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>port vlan-mapping vlan 100 inner-vlan 200  to 300 map-vlan 10</strong>
</pre>
</div>

<div class="p"># Configure 2 to 1 VLAN mapping to map outer VLAN 100 of received packets to outer VLAN 10 and retain inner VLAN 200 before the packets are forwarded.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>interface <span>100GE</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>port link-type trunk</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>port vlan-mapping vlan 100 inner-vlan 200 map-vlan 10</strong>
</pre>
</div>

<div class="p"># Configure 2 to 1 VLAN mapping to map outer VLAN 200 and inner VLAN 100 of received packets to VLAN 20.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>interface <span>100GE</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>port link-type trunk</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>port vlan-mapping vlan 200 inner-vlan 100 map-single-vlan 20</strong>
</pre>
</div>

<div class="p"># Configure 1 to 1 VLAN mapping to map VLAN 100 of received packets to VLAN 10 before the packets are forwarded.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>interface <span>100GE</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>port link-type trunk</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>port vlan-mapping vlan 100 map-vlan 10</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_VLAN_Configuration_Commands_title.html">VLAN Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/PORTTRUNKPVID(VLANOM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/PORTVLANSTACKING(ETHBASEOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>