
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="ip community-filter (System view)">
<meta name="DC.subject" content="ip community-filter (System view)">
<meta name="keywords" content="ip community-filter (System view)">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_IP_Routing_Policy_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/BASIC-COMMUNITY-FILTER(RTPOM).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/ADVANCED-COMMUNITY-FILTER_1(RTPOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Routing Policy">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="Routing Policy">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="Routing Policy">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Creator" content="SUBSYS_ID_RTPOM">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907606064">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>ip community-filter (System view)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907606064"></a><a name="EN-US_CLIREF_0000001907606064"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">ip community-filter (System view)</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907606064__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">ip community-filter</span></b> command adds an advanced community filter.</p>
<p>The <b><span class="cmdname">undo ip community-filter</span></b> command deletes an advanced community filter.</p>
</p>
<p>By default, no advanced community filter exists.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907606064__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">ip community-filter </span></b><i><span class="varname">adv-comm-filter-num</span></i> [ <strong><span>index</span></strong> <i><span class="varname">index-number</span></i> ] <i><span class="varname">matchMode</span></i> <i><span class="varname">regular-expression</span></i></p>

<p><b><span class="cmdname">undo ip community-filter </span></b><i><span class="varname">adv-comm-filter-num</span></i> [ <strong><span>index</span></strong> <i><span class="varname">index-number</span></i> ] [ <i><span class="varname">matchMode</span></i> <i><span class="varname">regular-expression</span></i> ]</p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907606064__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">adv-comm-filter-num</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the number of an advanced community filter.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 100 to 199.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>index</span></strong> <i><span class="varname">index-number</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the sequence number of a basic community filter.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 1 to 4294967295.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">matchMode</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Sets the matching mode of the community filter.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><div class="p"><p>The value is an enumerated type:</p>
<ul><li>deny: Sets the matching mode of the community filter to deny.</li><li>permit: Sets the matching mode of the community filter to permit.</li></ul>
</div>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">regular-expression</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies a community-based regular expression.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a string of 1 to 1024 characters, spaces supported.</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907606064__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>System view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907606064__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907606064__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p><p>The community attribute is a private attribute of BGP and can be used to filter only BGP routes. The community attribute can be used as a matching condition of a route-policy using a command, such as the <b><span class="cmdname">if-match community-filter</span></b> command.</p>
</p>
<p><strong>Follow-up Procedure</strong></p>
<p><p>Run the <b><span class="cmdname">display ip community-filter</span></b> command to view detailed community filter configurations.</p>
</p>
<p><strong>Precautions</strong></p>
<p><p>Only the community number or well-known community attribute can be specified in a basic community filter. Only the regular expression can be specified as a matching condition in an advanced community filter.<p></p>
<span>The relationship between the rules of a community</span> filter is AND, which is different from that of an RD filter. This is because each route can have only one RD but can have multiple communities.<p></p>
<span>For example</span>, if a community filter is configured in either of the following formats, the filtering results are different.<p></p>
<span>Form 1</span>:<p></p>
<span>ip community-filter 1 permit 100</span>:1 200:1 300:1<p></p>
<span>The relationship between 100</span>:1, 200:1, and 300:1 is AND.<p></p>
<span>Form 2</span>:<p></p>
<span>ip community-filter 1 permit 100</span>:1<p></p>
<span>ip community-filter 1 permit 200</span>:1 300:1<p></p>
<span>The relationship between 200</span>:1 and 300:1 is AND, and the relationship between 100:1 and 200:1 and 300:1 is OR.<p></p>
<span>In the preceding community-filter configuration</span>, the community in each rule must be a subset of the community set of the route so that the rule can be matched.<p></p>
<span>In the following RD filter configurations</span>, the two types of RD filters have the same effect.<p></p>
<span>Form 1</span>:<p></p>
<span>ip rd-filter 100 permit 100</span>:1 200:1 2.2.2.2:1 3.3.3.3:1<p></p>
<span>Form 2</span>:<p></p>
<span>ip rd-filter 100 permit 100</span>:1 200:1<p></p>
<span>ip rd-filter 100 permit 2</span>.2.2.2:1<p></p>
<span>ip rd-filter 100 permit 3</span>.3.3.3:1<p></p>
<span>When you run the</span> <b><span class="cmdname">apply comm-filter delete</span></b> command in the Route-Policy view to delete the community filter value, the <b><span class="cmdname">ip community-filter</span></b> command can contain only one community attribute each time. To delete multiple community attributes, run the <b><span class="cmdname">ip community-filter</span></b> command multiple times. If multiple community attributes are configured in the same filter, these attributes cannot be deleted. For an example, see the <b><span class="cmdname">apply comm-filter delete</span></b> command.<p></p>
<span>The default action of a community filter is deny</span>. That is, if a route is not permitted in a certain filtering, the route cannot pass the filtering of the community filter. If all filtering rules in a filter are deny, no route can pass the filter. In this case, you need to set permit after deny for multiple times or one time to allow all the other routes to pass the filter. When an advanced community filter is used to filter routes, the regular expression can be configured to match a character string in the format of aa:nn or an integer. For example:<p></p>
<span>Configure ip community-filter advanced aa index 30</span> permit ^1:1$ to filter routes with community attribute 65537 or 1:1.<p></p>
<span>ip community-filter advanced aa index 30 permit</span> ^65537$ can also be used to filter routes with community attribute 65537 or 1:1.<p></p>
<span>Regular expression matching is CPU-intensive processing</span>. When a large number of regular expressions are configured in a policy to match route attributes and the corresponding route attributes are long, the policy processing performance deteriorates. To improve the processing performance of the routing policy, reduce the number of regular expressions or use non-regular expression matching commands.<p></p>
<span>If too many regular expressions are configured</span>, the performance is affected, and even the protocol peer flapping occurs.</p>
</p>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907606064__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Configure an advanced community filter with the sequence number 100.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ip community-filter 100 permit ^10</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_IP_Routing_Policy_Configuration_Commands_title.html">Routing Policy Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/BASIC-COMMUNITY-FILTER(RTPOM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/ADVANCED-COMMUNITY-FILTER_1(RTPOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>