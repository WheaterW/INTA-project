
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="adjust original-dscp">
<meta name="DC.subject" content="adjust original-dscp">
<meta name="keywords" content="adjust original-dscp">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_PNF-Adaptive_Routing_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/ADAPTIVE-ROUTING_ENABLE_DRAGONFLY-ROLE.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/DISPLAY_ADAPTIVE-ROUTING_CONFIGURATION_STATUS.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Adaptive Routing">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="Adaptive Routing">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="featurename" content="Adaptive Routing">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="DC.Creator" content="SUBSYS_ID_AIS">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001942848621">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>adjust original-dscp</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001942848621"></a><a name="EN-US_CLIREF_0000001942848621"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">adjust original-dscp</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001942848621__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">adjust original-dscp</span></b> command enables dragonfly deadlock prevention and adjusts the queue priority and DSCP value of matched packets.</p>
<p>The <b><span class="cmdname">undo adjust original-dscp</span></b> command disables dragonfly deadlock prevention and deletes the queue adjustment configuration for matched packets in a dragonfly profile.</p>
</p>
<p>By default, dragonfly deadlock prevention is disabled in a dragonfly profile.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command is supported only on the CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P and CE8850-HAM.</p>
</div></div>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001942848621__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">adjust original-dscp </span></b><i><span class="varname">original-dscpvalue</span></i> <strong><span>to</span></strong> <strong><span>priority</span></strong> <i><span class="varname">prioritynumber</span></i> <strong><span>dscp</span></strong> <i><span class="varname">dscpvalue</span></i></p>

<p><b><span class="cmdname">undo adjust original-dscp </span></b><i><span class="varname">original-dscpvalue</span></i> <strong><span>to</span></strong> <strong><span>priority</span></strong> <i><span class="varname">prioritynumber</span></i> <strong><span>dscp</span></strong> <i><span class="varname">dscpvalue</span></i></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001942848621__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>to</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Adjusts the information about the matched packets.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>priority</span></strong> <i><span class="varname">prioritynumber</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Adjusts the queue priority of the matched packets so that the packets are forwarded from the specified queue.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer that ranges from 0 to 5.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>dscp</span></strong> <i><span class="varname">dscpvalue</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Adjusts the DSCP value of the matched packets to ensure that packets in a hook-shaped flow are still mapped to the specified queue on the downstream device.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer that ranges from 0 to 63.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>original-dscp</span></strong> <i><span class="varname">original-dscpvalue</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the DSCP value of packets to be adjusted.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer that ranges from 0 to 63.</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001942848621__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>Dragonfly-profile view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001942848621__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001942848621__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>In a direct topology, you can run this command in the dragonfly profile to switch the queue of service flows whose inbound and outbound interfaces are both local ports or whose inbound interface is a global port, proactively adjusting the queue priority and DSCP value of packets to prevent deadlock.</p>
<p><strong>Precautions</strong></p>
<ul><li>PFC deadlock prevention and dragonfly deadlock prevention cannot be both enabled.</li><li>The <b><span class="cmdname">adjust original-dscp</span></b> command can be run twice at most, with different values configured for original-dscpvalue, prioritynumber, and dscpvalue the second time. To modify the configuration, run the <b><span class="cmdname">undo adjust original-dscp</span></b> command to delete the original configuration first.</li></ul>

<p>For the CE8851-32CQ8DQ-P, CE8850-SAN, CE8851K, and CE8850-HAM:</p>

<ul><li>Before running the <b><span class="cmdname">adjust original-dscp</span></b> command to enable dragonfly deadlock prevention, you must run the <b><span class="cmdname">abs-pfc priority enable</span></b> command to enable dragonfly antilocking PFC. In addition, the priority queue that original-dscp is mapped to and the priority queue specified by priority in the <b><span class="cmdname">adjust original-dscp</span></b> command must be within the range specified by priority in the <b><span class="cmdname">abs-pfc priority enable</span></b> command.</li><li>If the priority queue that the original-dscp parameter is mapped to changes to a queue for which dragonfly antilocking PFC is not enabled due to the mapping change between DSCP values and priority queues, dragonfly deadlock prevention does not take effect for the priority queue that the original-dscp parameter is mapped to before and after the mapping change.</li><li>To enable dragonfly deadlock prevention, enable dragonfly antilocking PFC for the corresponding lossless queue first.</li></ul>

<p>For the CE8855 and CE8851-32CQ4BQ:</p>

<ul><li>If the adaptive routing role has been configured, you must enable PFC on the corresponding interface before running the <b><span class="cmdname">adjust original-dscp</span></b> command to enable dragonfly deadlock prevention. In addition, the priority queue that original-dscp is mapped to and the priority queue specified by priority in the <b><span class="cmdname">adjust original-dscp</span></b> command must be within the range of the PFC-enabled priority queues.</li><li>When configuring the adaptive routing role on an interface, you must enable PFC for the priority queue that the original-dscp parameter is mapped to and the priority queue specified by the priority parameter in the <b><span class="cmdname">adjust original-dscp</span></b> command.</li><li>If the priority queue that the original-dscp parameter is mapped to changes to a queue for which PFC is not enabled due to the mapping change between DSCP values and priority queues, dragonfly deadlock prevention does not take effect for the priority queue that the original-dscp parameter is mapped to before and after the mapping change.</li></ul>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001942848621__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Adjust the queue priority and DSCP value of matched packets to 4 and 32, respectively. The original DSCP value is 10. (CE8851-32CQ8DQ-P, CE8850-SAN, CE8851K, and CE8850-HAM)<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>dragonfly profile default</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-dragonfly-profile-default] <strong>abs-pfc priority 1 4 enable</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-dragonfly-profile-default] <strong>adjust original-dscp 10 to priority 4 dscp 32</strong>
</pre>
</div>

<div class="p"># Adjust the queue priority and DSCP value of matched packets to 4 and 32, respectively. The original DSCP value is 10. (CE8855 and CE8851-32CQ4BQ)<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>qos buffer headroom-pool size 4 mbytes slot <span>1</span></strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>dcb pfc default</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-dcb-pfc-default] <strong>priority 1 4</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-dcb-pfc-default] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>interface <span>100GE</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>dcb pfc enable</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>dragonfly profile default</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-dragonfly-profile-default] <strong>adjust original-dscp 10 to priority 4 dscp 32</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_PNF-Adaptive_Routing_Configuration_Commands_title.html">Adaptive Routing Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/ADAPTIVE-ROUTING_ENABLE_DRAGONFLY-ROLE.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/DISPLAY_ADAPTIVE-ROUTING_CONFIGURATION_STATUS.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>