
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="ztp certificate-remote">
<meta name="DC.subject" content="ztp certificate-remote">
<meta name="keywords" content="ztp certificate-remote">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_PNF-ZTP_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/ZTPENABLE(ZTP).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="ZTP">
<meta name="featuretype" content="Basic Configuration">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="ZTP">
<meta name="featuretype" content="Basic Configuration">
<meta name="featurename" content="ZTP">
<meta name="featuretype" content="Basic Configuration">
<meta name="featuretype" content="Basic Configuration">
<meta name="featuretype" content="Basic Configuration">
<meta name="DC.Creator" content="SUBSYS_ID_ZTP">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907600212">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>ztp certificate-remote</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907600212"></a><a name="EN-US_CLIREF_0000001907600212"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">ztp certificate-remote</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907600212__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">ztp certificate-remote</span></b> command configures the device to download a CA certificate from a bootstrap server.</p>
<p>The <b><span class="cmdname">undo ztp certificate-remote</span></b> command disables the device from downloading a CA certificate from a bootstrap server.</p>
</p>
<p>By default, a device is not configured to download a CA certificate from a bootstrap server.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907600212__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">ztp certificate-remote </span></b>{ <i><span class="varname">ipv4-addr</span></i> | <strong><span>ipv6</span></strong> <i><span class="varname">ipv6-addr</span></i> } [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpnvalue</span></i> ] <strong><span>port</span></strong> <i><span class="varname">portvalue</span></i> <strong><span>ssl-policy</span></strong> <i><span class="varname">policyname</span></i> [ <strong><span>verify-type</span></strong> <strong><span>esn</span></strong> ]</p>

<p><b><span class="cmdname">undo ztp certificate-remote </span></b>{ <i><span class="varname">ipv4-addr</span></i> | <strong><span>ipv6</span></strong> <i><span class="varname">ipv6-addr</span></i> } [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpnvalue</span></i> ]</p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907600212__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>ipv6</span></strong> <i><span class="varname">ipv6-addr</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>IPv6 address of the bootstrap server.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a 32-bit hexadecimal string in format X:X:X:X:X:X:X:X.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>vpn-instance</span></strong> <i><span class="varname">vpnvalue</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the name of a VPN instance.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a string of 1 to 31 case-sensitive characters. _public_ cannot be used as the VPN instance name.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>port</span></strong> <i><span class="varname">portvalue</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Port number of the bootstrap server.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 1 to 65535.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>ssl-policy</span></strong> <i><span class="varname">policyname</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the name of an SSL policy.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a string of 1 to 23 case-insensitive characters, including letters, digits, and underscores (_). It cannot contain spaces.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>verify-type</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Authentication type.</p>
<p>If this parameter is not specified, the IP address pair is used for authentication.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>esn</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates that the authentication type is ESN.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>certificate-remote</span></strong> <i><span class="varname">ipv4-addr</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>IP address of the bootstrap server.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is in dotted decimal notation.</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907600212__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>System view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907600212__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907600212__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>If NCE does not initialize a certificate, run the <b><span class="cmdname">ztp certificate-remote</span></b> command to enable the device to download a CA certificate from the BootStrap server. The certificate name is NCE-bootstrap.pem. During ZTP deployment, the CA certificate is used for certificate authentication and NETCONF connection establishment with NCE. Currently, NCE integrates the functions of the BootStrap server.<p></p>
<span>A maximum of 10 BootStrap servers can be configured</span> on the device. The BootStrap servers with the same IP address and VPN instance name are considered as one BootStrap server. The interaction process between the device and BootStrap server is as follows:</p>

<ol><li>The device proactively establishes an HTTPS connection with the BootStrap server.</li><li>The device sends a request packet to the BootStrap server to download the CA certificate. The request packet carries the ESN of the device or the IP address of the BootStrap server. If verify-type esn is specified, the request packet carries the ESN of the device. If verify-type esn is not specified, the request packet carries the IP address of the BootStrap server.</li><li>The BootStrap server searches for the CA certificate based on the ESN or IP address in the request packet and sends a packet carrying the CA certificate to the device. The packet also carries the ESN of the device or the IP address of the BootStrap server.</li><li>After receiving the response packet from the BootStrap server, the device terminates the HTTPS connection with the BootStrap server, parses the response packet, and verifies the validity of the response packet. If verify-type esn is specified, the device uses the ESN for authentication when parsing the packet. If verify-type esn is not specified, the device uses the IP address of the BootStrap server for authentication when parsing the packet. If the verification fails, the CA certificate cannot be obtained. In this case, the system attempts to obtain the CA certificate from the next BootStrap server until the CA certificate is obtained successfully.</li></ol>
<p><strong>Prerequisites</strong></p>
<p>You are advised to run the <b><span class="cmdname">ssl policy</span></b> command to create an SSL policy and run the <b><span class="cmdname">pki-domain default</span></b> command in the SSL policy view to bind the default domain to the SSL policy. If these commands are not preconfigured, run them before running the <b><span class="cmdname">ztp certificate-remote</span></b> command.</p>
<p><strong>Configuration Impact</strong></p>
<p>After this command is run, the device automatically imports the initial certificate of the device to the realm named default for establishing an HTTPS connection with the bootstrap server. After obtaining the CA certificate from the bootstrap server, the device disconnects the HTTPS connection with the bootstrap server and deletes the initial certificate of the device from the default realm.<p></p>
<span>After successfully obtaining the CA certificate NCE</span>-bootstrap.pem from the bootstrap server, the device automatically imports the certificate to the default realm.</p>
<p><strong>Precautions</strong></p>
<p>After NCE-bootstrap.pem is imported to the default domain, if you need to download the CA certificate from the BootStrap server again, delete the imported certificate from the default domain and run the <b><span class="cmdname">ztp certificate-remote</span></b> command again.</p>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907600212__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Configure the device to download a CA certificate from the bootstrap server. Set the IP address of the bootstrap server to 10.1.1.1, port number to 30217, SSL policy name to ztp_policy, and certificate authentication type to IP address.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ssl policy ztp_policy</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-ssl-policy-ztp_policy] <strong>pki-domain default</strong>
Warning: A preset certificate is loaded to the specified PKI domain. The current operation has security risks. Continue? [Y/N]:y
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-ssl-policy-ztp_policy] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>ztp certificate-remote 10.1.1.1 port 30217 ssl-policy ztp_policy</strong>
</pre>
</div>

<div class="p"># Configure the device to download a CA certificate from the bootstrap server. Set the IP address of the bootstrap server to 2001:db8:1::1, port number to 30217, SSL policy domain name to ztp_policy, and certificate authentication type to ESN.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ssl policy ztp_policy</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-ssl-policy-ztp_policy] <strong>pki-domain default</strong>
Warning: A preset certificate is loaded to the specified PKI domain. The current operation has security risks. Continue? [Y/N]:y
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-ssl-policy-ztp_policy] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>ztp certificate-remote ipv6 2001:db8:1::1 port 30217 ssl-policy ztp_policy verify-type esn</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_PNF-ZTP_Configuration_Commands_title.html">ZTP Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/ZTPENABLE(ZTP).html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>