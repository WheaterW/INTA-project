
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="redirect load-balance">
<meta name="DC.subject" content="redirect load-balance">
<meta name="keywords" content="redirect load-balance">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_PNF-Redirection_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/REDIRECT_INTERFACE.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/REDIRECT_NEXTHOP.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Redirection">
<meta name="featuretype" content="QoS">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="Redirection">
<meta name="featuretype" content="QoS">
<meta name="featurename" content="Redirection">
<meta name="featuretype" content="QoS">
<meta name="featuretype" content="QoS">
<meta name="featuretype" content="QoS">
<meta name="DC.Creator" content="SUBSYS_ID_DC_MQC">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001942847841">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>redirect load-balance</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001942847841"></a><a name="EN-US_CLIREF_0000001942847841"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">redirect load-balance</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001942847841__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">redirect load-balance</span></b> command configures an action of redirecting packets to multiple next-hop IP addresses in a traffic behavior.</p>
<p>The <b><span class="cmdname">undo redirect</span></b> command deletes the redirection configuration.</p>
</p>
<p>By default, the action of redirecting packets to multiple next-hop IP addresses is not configured in a traffic behavior.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001942847841__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p>For CE8851-32CQ8DQ-P, CE8850-HAM, CE8850-SAN, CE8851K, CE8855, CE8851-32CQ4BQ, CE6860-SAN, CE6866, CE6860-HAM, CE6866K, CE6820H, CE6820H-K, CE6820S, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6855-48XS8CQ, CE6885, CE6885-T, CE6885-LL (standard forwarding mode), CE6863E-48S8CQ, CE6885-SAN: </p>

<p><b><span class="cmdname">redirect ipv6 load-balance </span></b>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <strong><span>nexthop</span></strong> { <i><span class="varname">ipv6-address</span></i> [ <strong><span>track</span></strong> <strong><span>nqa</span></strong> <i><span class="varname">admin-name</span></i> <i><span class="varname">test-name</span></i> [ <strong><span>reaction</span></strong> <strong><span>probe-failtimes</span></strong> <i><span class="varname">fail-times</span></i> ] ] } &amp;&lt;1-16&gt; [ <strong><span>fail-action</span></strong> <strong><span>discard</span></strong> ]</p>

<p><b><span class="cmdname">undo redirect ipv6 load-balance </span></b>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <strong><span>nexthop</span></strong> { <i><span class="varname">ipv6-address</span></i> [ <strong><span>track</span></strong> <strong><span>nqa</span></strong> <i><span class="varname">admin-name</span></i> <i><span class="varname">test-name</span></i> [ <strong><span>reaction</span></strong> <strong><span>probe-failtimes</span></strong> <i><span class="varname">fail-times</span></i> ] ] } &amp;&lt;1-16&gt; [ <strong><span>fail-action</span></strong> <strong><span>discard</span></strong> ]</p>

<p>For CE8851-32CQ8DQ-P, CE8850-HAM, CE8850-SAN, CE8851K, CE8855, CE8851-32CQ4BQ, CE6860-SAN, CE6866, CE6860-HAM, CE6866K, CE6820H, CE6820H-K, CE6820S, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6855-48XS8CQ: </p>

<p><b><span class="cmdname">undo redirect</span></b></p>

<p>For CE8851-32CQ8DQ-P, CE8850-HAM, CE8850-SAN, CE8851K, CE8855, CE8851-32CQ4BQ, CE6860-SAN, CE6866, CE6860-HAM, CE6866K, CE6820H, CE6820H-K, CE6820S, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6855-48XS8CQ, CE6885, CE6885-T, CE6885-LL (standard forwarding mode), CE6863E-48S8CQ, CE6885-SAN: </p>

<p><b><span class="cmdname">redirect load-balance </span></b>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <strong><span>nexthop</span></strong> { <i><span class="varname">ip-address</span></i> [ <strong><span>track</span></strong> <strong><span>nqa</span></strong> <i><span class="varname">admin-name</span></i> <i><span class="varname">test-name</span></i> [ <strong><span>reaction</span></strong> <strong><span>probe-failtimes</span></strong> <i><span class="varname">fail-times</span></i> ] ] } &amp;&lt;1-16&gt; [ <strong><span>fail-action</span></strong> <strong><span>discard</span></strong> ] [ <strong><span>low-precedence</span></strong> ]</p>

<p><b><span class="cmdname">undo redirect load-balance </span></b>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <strong><span>nexthop</span></strong> { <i><span class="varname">ip-address</span></i> [ <strong><span>track</span></strong> <strong><span>nqa</span></strong> <i><span class="varname">admin-name</span></i> <i><span class="varname">test-name</span></i> [ <strong><span>reaction</span></strong> <strong><span>probe-failtimes</span></strong> <i><span class="varname">fail-times</span></i> ] ] } &amp;&lt;1-16&gt; [ <strong><span>fail-action</span></strong> <strong><span>discard</span></strong> ] [ <strong><span>low-precedence</span></strong> ]</p>




<p>For CE6885-LL (low latency mode): </p>

<p><b><span class="cmdname">redirect load-balance </span></b>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <strong><span>nexthop</span></strong> { <i><span class="varname">ip-address</span></i> [ <strong><span>track</span></strong> <strong><span>nqa</span></strong> <i><span class="varname">admin-name</span></i> <i><span class="varname">test-name</span></i> [ <strong><span>reaction</span></strong> <strong><span>probe-failtimes</span></strong> <i><span class="varname">fail-times</span></i> ] ] } &amp;&lt;1-16&gt; [ <strong><span>fail-action</span></strong> <strong><span>discard</span></strong> ]</p>

<p><b><span class="cmdname">undo redirect load-balance </span></b>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <strong><span>nexthop</span></strong> { <i><span class="varname">ip-address</span></i> [ <strong><span>track</span></strong> <strong><span>nqa</span></strong> <i><span class="varname">admin-name</span></i> <i><span class="varname">test-name</span></i> [ <strong><span>reaction</span></strong> <strong><span>probe-failtimes</span></strong> <i><span class="varname">fail-times</span></i> ] ] } &amp;&lt;1-16&gt; [ <strong><span>fail-action</span></strong> <strong><span>discard</span></strong> ]</p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001942847841__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the name of a VPN instance.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a string of 1 to 31 case-sensitive characters. It cannot be _public_. If spaces are used, the string must be enclosed in double quotation marks (" ").</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>nexthop</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Redirects packets to the next hop.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">ipv6-address</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the next-hop IPv6 address. The address cannot be of the link-local type.</p>
</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a 32-bit hexadecimal string in format X:X:X:X:X:X:X:X.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>track</span></strong> <strong><span>nqa</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates an NQA test instance.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">admin-name</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the administrator name of an NQA test instance.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a string of 1 to 32 case-sensitive characters, spaces not supported.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">test-name</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the name of an NQA test instance.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a string of 1 to 32 case-sensitive characters, spaces not supported.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>reaction</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Cancels redirection.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>probe-failtimes</span></strong> <i><span class="varname">fail-times</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the maximum number of link detection failures in an NQA test instance.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer in the range from 1 to 15.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>fail-action</span></strong> <strong><span>discard</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates that packets are forcibly discarded if all next hops are unreachable.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>undo</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Cancels the current configuration.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>ipv6</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the IPv6 addresses of multiple next hops to which a packet is redirected.</p>
</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">ip-address</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the IP address of the next hop.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>It is in dotted decimal notation.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>low-precedence</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the low priority of policy-based routing.</p>
</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>


</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001942847841__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>Traffic behavior view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001942847841__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001942847841__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>The <b><span class="cmdname">redirect load-balance</span></b> command allows you to specify a maximum of 16 next-hop IP addresses (using the ip-address parameter for multiple times). If multiple next-hop IP addresses are specified, the device redirects packets in ECMP load balancing mode.</p>

<p>If the outbound interface corresponding to a next-hop IP address becomes Down or a route changes, the device switches traffic to the outbound interface corresponding to an available next hop. If the specified next hops are unavailable, the device forwards the packets to the original destination.</p>

<p>If an NQA test instance is configured to detect the link for the redirection next-hop IP address and the number of NQA link detection failures is greater than or equal to the configured maximum value, the current next hop will be canceled. If multiple next hops work in load balancing mode, this next hop will not participate in load balancing, and traffic is load balanced between the remaining reachable next hops.</p>

<p>PBR is implemented based on the redirection action configured in a traffic behavior and takes effect only on incoming packets of interfaces. By default, a device forwards packets to the next hop found in its routing table. If PBR is configured, the device forwards packets to the next hop specified by PBR. After you specify the low-precedence parameter, the device forwards packets matching PBR to the next hop/outbound interface of the specific route in its routing table. When the specific route becomes invalid, the device forwards packets to the next hop/outbound interface specified by PBR. When both the next hop of the specific route and next hop specified by PBR become invalid, and the routing table has default routes, the device continues forwarding packets according to the matching default route.</p>
<p><strong>Precautions</strong></p>
<ul><li>The <b><span class="cmdname">redirect load-balance</span></b> command allows a maximum of 16 next-hop IP addresses. If the device has no ARP entry matching the specified next-hop IP address, the <b><span class="cmdname">redirect load-balance</span></b> command can be used but redirection does not take effect. The device still forwards packets to the original destination until the device has the corresponding ARP entry.</li><li>The redirected IP address cannot be the IP address of the device.</li><li>IPv6 PBR does not support redirection based on routes created using OSPFv3.</li></ul>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001942847841__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Configure three next-hop IP addresses in the traffic behavior b1: 10.1.1.1, 10.2.1.1, and 192.168.1.1.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>traffic behavior b1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-behavior-b1] <strong>redirect load-balance nexthop 10.1.1.1 10.2.1.1 192.168.1.1</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_PNF-Redirection_Configuration_Commands_title.html">Redirection Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/REDIRECT_INTERFACE.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/REDIRECT_NEXTHOP.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>