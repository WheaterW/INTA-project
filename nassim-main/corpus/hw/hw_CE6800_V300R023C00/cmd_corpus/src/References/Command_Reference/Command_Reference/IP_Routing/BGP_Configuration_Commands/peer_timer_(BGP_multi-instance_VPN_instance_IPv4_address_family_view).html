
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="peer timer (BGP multi-instance VPN instance IPv4 address family view)">
<meta name="DC.subject" content="peer timer (BGP multi-instance VPN instance IPv4 address family view)">
<meta name="keywords" content="peer timer (BGP multi-instance VPN instance IPv4 address family view)">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_BGP_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/BGP-MULI-INSTANCE-GROUP-TIMER-KEEPALIVE-HOLD(BGPOM).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/BGP-MULI-VRF-GROUP-TIMER-KEEPALIVE-HOLD(BGPOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Creator" content="SUBSYS_ID_BGPOM">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907765444">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>peer timer (BGP multi-instance VPN instance IPv4 address family view)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907765444"></a><a name="EN-US_CLIREF_0000001907765444"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">peer timer (BGP multi-instance VPN instance IPv4 address family view)</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907765444__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">peer timer</span></b> command sets the Keepalive time and hold time for a peer.</p>
<p>The <b><span class="cmdname">undo peer timer</span></b> command restores the default Keepalive time and hold time.</p>
</p>
<p>By default, the keepalive time is 60s, the hold time is 180s, and the session hold time is 86400s.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907765444__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">peer </span></b><i><span class="varname">ipv4-address</span></i> <strong><span>timer</span></strong> <strong><span>keepalive</span></strong> <i><span class="varname">keepalive-time</span></i> <strong><span>hold</span></strong> <i><span class="varname">hold-time</span></i></p>

<p><b><span class="cmdname">peer </span></b><i><span class="varname">ipv4-address</span></i> <strong><span>timer</span></strong> <strong><span>keepalive</span></strong> <i><span class="varname">keepalive-time</span></i> <strong><span>hold</span></strong> <i><span class="varname">hold-time</span></i> <strong><span>min-holdtime</span></strong> <i><span class="varname">min-hold-value</span></i></p>

<p><b><span class="cmdname">peer </span></b><i><span class="varname">ipv4-address</span></i> <strong><span>timer</span></strong> <strong><span>send-hold</span></strong> <i><span class="varname">send-hold-time</span></i></p>

<p><b><span class="cmdname">undo peer </span></b><i><span class="varname">ipv4-address</span></i> <strong><span>timer</span></strong> <strong><span>keepalive</span></strong> <strong><span>hold</span></strong> [ <strong><span>min-holdtime</span></strong> ]</p>

<p><b><span class="cmdname">undo peer </span></b><i><span class="varname">ipv4-address</span></i> <strong><span>timer</span></strong> <strong><span>keepalive</span></strong> <i><span class="varname">keepalive-time</span></i> <strong><span>hold</span></strong> <i><span class="varname">hold-time</span></i></p>


<p><b><span class="cmdname">undo peer </span></b><i><span class="varname">ipv4-address</span></i> <strong><span>timer</span></strong> <strong><span>keepalive</span></strong> <i><span class="varname">keepalive-time</span></i> <strong><span>hold</span></strong> <i><span class="varname">hold-time</span></i> <strong><span>min-holdtime</span></strong> <i><span class="varname">min-hold-value</span></i></p>

<p><b><span class="cmdname">undo peer </span></b><i><span class="varname">ipv4-address</span></i> <strong><span>timer</span></strong> <strong><span>send-hold</span></strong> <i><span class="varname">send-hold-time</span></i></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907765444__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">ipv4-address</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies an IPv4 peer address.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is in dotted decimal notation.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>keepalive</span></strong> <i><span class="varname">keepalive-time</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the Keepalive time.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 0 to 21845, in seconds. The default value is 60 seconds.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>hold</span></strong> <i><span class="varname">hold-time</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates the hold time.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p><p>The value is 0 or an integer ranging from 3 to 65535, in seconds. The default value is 180.</p>
<p>It is recommended that the configured hold time be related to the total number of BGP address family peers. For details, see the mapping between the total number of BGP peers in each address family and the recommended minimum hold time in the usage guide of the peer timer command.</p>
</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>min-holdtime</span></strong> <i><span class="varname">min-hold-value</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the minimum hold time. On the same device, min-hold-value must be less than hold-time.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 20 to 65535, in seconds.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>send-hold</span></strong> <i><span class="varname">send-hold-time</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the interval for holding a session when the local end fails to send messages.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is 0 or an integer ranging from 360 to 172800, in seconds. The default value is 86400. The value 0 indicates that the function is disabled.</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907765444__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>BGP multi-instance VPN instance IPv4 address family view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907765444__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907765444__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<div class="p"><p>After establishing a BGP connection, two peers periodically send Keepalive messages to each other to detect the status of the BGP connection. If a device receives no Keepalive message or any other type of message from its peer within the specified hold time, the device considers the BGP connection interrupted and closes the BGP connection.<p></p>
<span>In addition</span>, if the device fails to send BGP Update and Keepalive messages within twice the hold time, an alarm is reported. If the alarm is not cleared within the specified send hold time, the BGP connection is reset.</p>

<p>The keepalive-time and hold-time values are determined through negotiation between peers. The smaller value of hold-time contained in Open messages of both peers is used as the final value of hold-time. The smaller value of one third of hold-time and the locally configured keepalive-time is used as the final value of keepalive-time.<p></p>
<span>You can run this command to set the Keepalive time</span> and hold time of BGP.</p>

<ul><li>If short keepalive time and hold time are set, BGP can detect a link fault quickly. This speeds up link switchover, but increases the number of keepalive messages on the network and loads of devices, and consumes more network bandwidth resources.</li><li>If long keepalive time and hold time are set, the number of keepalive messages on the network and loads of devices are reduced, and fewer network bandwidths are consumed. However, if the keepalive time is too long, BGP is unable to detect link status changes in time. This may cause a large amount of traffic loss.<p></p>
<span>If the hold time configured on a remote device is</span> less than the min-hold-value configured on the local device, no peer relationship can be established between the two devices. If the hold time configured on the local end is 0s, the rule does not take effect, and a peer relationship can still be established.</li></ul>

<p>Mapping between the total number of peers in each BGP address family and the recommended minimum hold-time:</p>


<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><thead align="left">

<tr>
<th align="left" class="cellrowborder" valign="top" width="50%" id="mcps1.3.6.2.5.1.3.1.1" liSelected="liSelected">Total Number of Peers</th>

<th align="left" class="cellrowborder" valign="top" width="50%" id="mcps1.3.6.2.5.1.3.1.2" liSelected="liSelected">Recommended Minimum hold-time</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.5.1.3.1.1 ">0â100</td>

<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.5.1.3.1.2 ">20</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.5.1.3.1.1 ">101â200</td>

<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.5.1.3.1.2 ">30</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.5.1.3.1.1 ">201â300</td>

<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.5.1.3.1.2 ">45</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.5.1.3.1.1 ">301â400</td>

<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.5.1.3.1.2 ">60</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.5.1.3.1.1 ">401â500</td>

<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.5.1.3.1.2 ">75</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.5.1.3.1.1 ">Greater than or equal to 501</td>

<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.5.1.3.1.2 ">90</td>

</tr>

</tbody>

</table>
</div>
</div>
<p><strong>Configuration Impact</strong></p>
<p><p>If the value of a timer changes, the BGP peer relationship between devices is disconnected. This is because the devices need to re-negotiate keepalive-time and hold-time. Therefore, exercise caution before changing the value of a timer.</p>
</p>
<p><strong>Precautions</strong></p>
<div class="p"><p>In actual configuration, the hold time must be at least three times the Keepalive time.<p></p>
<span>Avoid the following situations when setting the values</span> for the timers:</p>

<ul><li>Both keepalive-time and hold-time are set to 0. In this case, BGP timers become invalid. That is, BGP does not detect link faults based on the timers, which may cause heavy traffic loss.</li><li>The value of hold-time is much greater than the value of keepalive-time, for example, keepalive 1 hold 65535. In this case, there are a large number of Keepalive messages on the network. In addition, BGP does not consider the connection interrupted even if it does not receive Keepalive messages for a long time.</li><li>Keepalive-time is set to 0. In this case, the keepalive timer is not started, and the send-hold timer function does not take effect.<p></p>
<span>The Keepalive time and hold time can be configured</span> for a single peer, a peer group, or globally. The Keepalive time and Holdtime of a single peer take precedence over those of a peer group, and those of a peer group take precedence over the global configurations. If the global Keepalive time and hold time have been set using the <b><span class="cmdname">timer</span></b> command, you can still run this command to change the Keepalive time and hold time of a single peer or peer group.<p></p>
<span>After the</span> <b><span class="cmdname">keep-all-routes</span></b> command is run, the <b><span class="cmdname">undo peer timer keepalive</span></b> command does not take effect. To configure this function, run the <b><span class="cmdname">undo keep-all-routes</span></b> command and then the <b><span class="cmdname">peer timer keepalive</span></b> command.<p></p>
<span>BGP messages are sent to peers through an update peer</span>-group. When there is only one peer in the update peer-group or there is no message in the update peer-group, the session hold time does not take effect.</li></ul>
</div>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907765444__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Set the Keepalive time and hold time for peer.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ip vpn-instance vpna</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-vpn-instance-vpna] <strong>ipv4-family</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-vpn-instance-vpna-af-ipv4] <strong>route-distinguisher 100:1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-vpn-instance-vpna-af-ipv4] <strong>vpn-target 111:1 both</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-vpn-instance-vpna-af-ipv4] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-instance-vpna] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>bgp 100 instance a</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp-instance-a] <strong>ipv4-family vpn-instance vpna</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp-instance-a-vpna] <strong>peer 10.1.1.1 as-number 100</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp-instance-a-vpna] <strong>peer 10.1.1.1 timer keepalive 10 hold 30</strong>
</pre>
</div>

<div class="p"># Set the session hold time for a specified peer.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ip vpn-instance vpna</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-vpn-instance-vpna] <strong>ipv4-family</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-vpn-instance-vpna-af-ipv4] <strong>route-distinguisher 100:1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-vpn-instance-vpna-af-ipv4] <strong>vpn-target 111:1 both</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-vpn-instance-vpna-af-ipv4] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-instance-vpna] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>bgp 100 instance a</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp-instance-a] <strong>ipv4-family vpn-instance vpna</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp-instance-a-vpna] <strong>peer 10.1.1.1 as-number 100</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp-instance-a-vpna] <strong>peer 10.1.1.1 timer send-hold 720</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_BGP_Configuration_Commands_title.html">BGP Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/BGP-MULI-INSTANCE-GROUP-TIMER-KEEPALIVE-HOLD(BGPOM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/BGP-MULI-VRF-GROUP-TIMER-KEEPALIVE-HOLD(BGPOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>