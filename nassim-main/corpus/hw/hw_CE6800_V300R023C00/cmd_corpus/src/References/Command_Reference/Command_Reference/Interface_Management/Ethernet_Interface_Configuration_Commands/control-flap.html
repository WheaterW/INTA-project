
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="control-flap">
<meta name="DC.subject" content="control-flap">
<meta name="keywords" content="control-flap">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_Ethernet_Interface_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/ETH-HOLD(PICDRIVER).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/DEVICETRANS(PICDRIVER).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Ethernet Interface">
<meta name="featuretype" content="Interface Management">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="Ethernet Interface">
<meta name="featuretype" content="Interface Management">
<meta name="featurename" content="Ethernet Interface">
<meta name="featuretype" content="Interface Management">
<meta name="featuretype" content="Interface Management">
<meta name="featuretype" content="Interface Management">
<meta name="DC.Creator" content="SUBSYS_ID_IFMOM">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907760300">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>control-flap</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907760300"></a><a name="EN-US_CLIREF_0000001907760300"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">control-flap</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907760300__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">control-flap</span></b> command enables flapping control on an interface.</p>
<p>The <b><span class="cmdname">undo control-flap</span></b> command disables flapping control.</p>
</p>
<p>By default, flapping control is disabled on an interface.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907760300__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">control-flap </span></b>[ <i><span class="varname">suppress</span></i> <i><span class="varname">reuse</span></i> <i><span class="varname">ceiling</span></i> <i><span class="varname">decay-ok</span></i> <i><span class="varname">decay-ng</span></i> ]</p>

<p><b><span class="cmdname">undo control-flap</span></b></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907760300__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">suppress</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Input device actually suppress threshold value is 1000 times the actual value of the device.</p>
<p>If the penalty value exceeds the interface suppressing threshold, the interface is suppressed. When the interface is suppressed, the outputs of the display interface, display interface brief, and display ip interface brief commands show that the protocol status of the interface remains DOWN(dampening suppressed) and does not change with the physical status.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value ranges from 1 to 20000. The default value is 2000. This value must be greater than the reuse threshold and less than the ceiling threshold.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">reuse</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>The value of the interface reuse threshold actually entered by the device is 1000 times the actual value of the device.</p>
<p>If the penalty value falls below the interface reuse threshold, the interface is freed from suppression. When the interface is freed from suppression, the protocol status of the interface is in compliance with the actual status and does not remain Down (dampening suppressed).</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value ranges from 1 to 20000. The default value is 750. This value must be smaller than the suppress threshold of the interface.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">ceiling</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>The maximum value of the interface suppression penalty value actually entered by the device is 1000 times the actual value of the device. The suppress penalty value stops increasing when it exceeds this value.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value ranges from 1001 to 20000. The default value is 6000. This value must be greater than the suppress threshold of the interface.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">decay-ok</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the half life of the penalty value for an interface in the Up state.</p>
<p>When an interface is Up, if the period since the end of the previous half life reaches the current half life, the penalty value decreases by half.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value ranges from 1 to 900, in seconds. The default value is 54s.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">decay-ng</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the half life of the penalty value for an interface in the Down state.</p>
<p>When the interface is Down, if the period since the end of the previous half life reaches the current half life, the penalty value decreases by half.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value ranges from 1 to 900, in seconds. The default value is 54s.</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907760300__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>100GE interface view,</span><span>10GE interface view,</span><span>200GE interface view,</span><span>25GE interface view,</span><span>400GE interface view,</span><span>50GE interface view,</span><span>Eth-Trunk interface view,</span><span>Tunnel interface view,</span><span>Sub-interface view,</span><span>Interface group view,</span><span>Management interface view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907760300__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907760300__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>Physical signal interference and incorrect link layer configuration may cause a device interface to alternate between Up and Down frequently, causing routing protocols to flap constantly. This greatly affects the device and network, and may cause a specific device to collapse and the network to be unavailable.<p></p>
<span>Flapping control applies to reduce the adverse impact</span> on the network stability caused by interface status changes.<p></p>
<span>By default</span>, the penalty value for interface suppression increases by 400 each time the interface goes Down, this value is 1000 times the actual value of the device.<p></p>
<span>For concepts and principles of interface flapping</span> control, see interface flapping control.<p></p>
<span>decay-ok and decay-ng can be configured separately</span>:</p>

<ul><li>If an interface remains Up for a long period and the interface must be soon available when it is Up, decreasing decay-ok is recommended.</li><li>If an interface remains Down for a long period and the interface must be long suppressed when it is Down, increasing decay-ng is recommended.</li></ul>
<p><strong>Precautions</strong></p>
<div class="p"><ul><li>This command can be run only on Layer 3 interfaces.</li><li>You can run the <b><span class="cmdname">display control-flap</span></b> command to view the running status and statistics of control-flap on an interface.</li><li>NULL and loopback interfaces do not support control-flap.</li><li>For directly connected interfaces that have static routes configured, if control-flap has to be configured, you are advised to configure it on both ends. If control-flap is configured only on one end, the interface waits for a period of time before changing from Down to Up when the interface recovers from a fault. This causes the states of the directly connected interfaces on both ends to be different within a period of time. As a result, packet loss occurs.</li><li>After control-flap is configured on a sub-interface, if the IP address of the sub-interface is deleted when the sub-interface is in the suppressed state, the sub-interface remains in the suppressed state.</li><li>Do not run the <b><span class="cmdname">control-flap</span></b> command on the interface tracked by a VRRP group. If control-flapping is enabled on the network-side interface tracked by a VRRP group, the interface waits for a period of time before changing from Down to Up after the fault is rectified. In this situation, the network-side routing information has not been restored, but the VRRP group directly switches from the backup state to the master state. As a result, user-side traffic is discarded by the master device.</li></ul>
</div>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907760300__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Enable flapping control on <span>100GE</span> <span>1/0/1</span>. Set the values of the suppress, reuse, ceiling, decay-ok, and decay-ng parameters to 2000, 750, 16000, 15, and 15, respectively.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>interface <span>100GE</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>control-flap 2000 750 16000 15 15</strong>
</pre>
</div>



</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_Ethernet_Interface_Configuration_Commands_title.html">Ethernet Interface Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/ETH-HOLD(PICDRIVER).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/DEVICETRANS(PICDRIVER).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>