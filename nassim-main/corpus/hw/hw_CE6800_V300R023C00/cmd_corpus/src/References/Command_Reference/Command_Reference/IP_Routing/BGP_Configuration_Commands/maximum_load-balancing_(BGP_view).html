
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="maximum load-balancing (BGP view)">
<meta name="DC.subject" content="maximum load-balancing (BGP view)">
<meta name="keywords" content="maximum load-balancing (BGP view)">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_BGP_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/LOAD-BALANCING-UCMP-IPV6UNI(BGPUCASTOM).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/BGP-IPV4-MAXIMUM-LOAD-BALANCING(BGPOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Creator" content="SUBSYS_ID_BGPOM">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907603968">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>maximum load-balancing (BGP view)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907603968"></a><a name="EN-US_CLIREF_0000001907603968"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">maximum load-balancing (BGP view)</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907603968__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">maximum load-balancing</span></b> command sets the maximum number of equal-cost routes for load balancing.</p>
<p>The <b><span class="cmdname">undo maximum load-balancing</span></b> command restores the default setting.</p>
</p>
<p>By default, the maximum number of equal-cost routes for load balancing is 1, and load balancing is not implemented.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907603968__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">maximum load-balancing </span></b><i><span class="varname">number</span></i></p>

<p><b><span class="cmdname">maximum load-balancing ebgp </span></b><i><span class="varname">ebgpNumber</span></i></p>

<p><b><span class="cmdname">maximum load-balancing ibgp </span></b><i><span class="varname">ibgpNumber</span></i></p>

<p><b><span class="cmdname">maximum load-balancing </span></b><i><span class="varname">number</span></i> <strong><span>ecmp-nexthop-changed</span></strong></p>

<p><b><span class="cmdname">maximum load-balancing ebgp </span></b><i><span class="varname">ebgpNumber</span></i> <strong><span>ecmp-nexthop-changed</span></strong></p>

<p><b><span class="cmdname">maximum load-balancing ibgp </span></b><i><span class="varname">ibgpNumber</span></i> <strong><span>ecmp-nexthop-changed</span></strong></p>

<p><b><span class="cmdname">undo maximum load-balancing</span></b></p>

<p><b><span class="cmdname">undo maximum load-balancing ebgp</span></b></p>

<p><b><span class="cmdname">undo maximum load-balancing ibgp</span></b></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907603968__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">number</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the maximum number of equal-cost routes for load balancing.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p><p>The value is an integer ranging from 1 to 128.</p>
</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>ebgp</span></strong> <i><span class="varname">ebgpNumber</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the maximum number of equal-cost EBGP routes for load balancing.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p><p>The value is an integer ranging from 1 to 128.</p>
</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>ibgp</span></strong> <i><span class="varname">ibgpNumber</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the maximum number of equal-cost IBGP routes for load balancing.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p><p>The value is an integer ranging from 1 to 128.</p>
</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>ecmp-nexthop-changed</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Configures the device to change the next hop addresses of only the routes that carry out load balancing to its address.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907603968__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>BGP view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907603968__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907603968__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>After this command is run, multiple BGP equal-cost routes will implement load balancing, improving network resource efficiency.<p></p>
<span>After this command is run</span>, the routes that meet the following conditions will become equal-cost routes and implement load balancing:</p>

<ul><li>The original next hops are different.</li><li>The PrefVal values are the same.</li><li>Local_Pref values are the same.</li><li>All routes are summary routes or none of them are summary routes.</li><li>Origin types (IGP, EGP, and Incomplete) are the same.</li><li>The MED values are the same.</li><li>All routes are EBGP or IBGP routes.</li><li>The IGP metric values within an AS are the same.</li><li>The AS_Path attributes are the same.<p></p>
<span>For BGP routes with the same prefix in the routing</span> table:</li><li>If the optimal routes are labeled routes, the routes selected for load balancing are also labeled routes. The number of routes for load balancing is determined by the <b><span class="cmdname">maximum load-balancing ingress-lsp</span></b> or <b><span class="cmdname">maximum load-balancing transit-lsp</span></b> command.</li><li>If the optimal route is a common route, the routes selected for load balancing are also common routes, and the maximum number of routes for load balancing is determined by the <b><span class="cmdname">maximum load-balancing</span></b> command.<p></p>
<span>When load balancing is performed among BGP labeled</span> routes, ingress LSPs are created for the labeled routes if the routes meet the conditions for creating ingress LSPs. When load balancing is performed among BGP labeled routes, transit LSPs are created for the labeled routes if the routes meet the conditions for creating transit LSPs.<p></p>
<span>After the</span> <b><span class="cmdname">maximum load-balancing ebgp</span></b> command is run, only EBGP routes implement load balancing. After the <b><span class="cmdname">maximum load-balancing ibgp</span></b> command is run, only IBGP routes implement load balancing. If [ ebgp | ibgp ] is not specified, both EBGP and IBGP routes can carry out load balancing, and the number of EBGP routes for load balancing is the same as the number of IBGP routes for load balancing.<p></p>
<span>By default</span>, after the <b><span class="cmdname">maximum load-balancing</span></b> command is run, a BGP device changes the next hop of a route to itself before advertising the route to a peer, regardless of whether the route is used for load balancing. After ecmp-nexthop-changed is set, a BGP device changes the next-hop of only routes that participate in load balancing to itself before advertising them to peers and keeps the next-hop of the routes that do not participate in load balancing unchanged.<p></p>
<span>Note</span>:<p></p>
<span>After the</span> <b><span class="cmdname">maximum load-balancing</span></b> command is run, the device changes the next hop addresses of the routes to be advertised to a local address, regardless of whether the routes are used for load balancing. However, in RR and BGP confederation scenarios, the device does not change the next hop address of non-local routes to the local address.<p></p>
<span>After the</span> maximum load-balancing { ebgp | ibgp } command is run, the device does not forcibly change the next hop addresses of the routes to be advertised to a local address, regardless of whether the routes are used for load balancing.<p></p>
<span>After the</span> maximum load-balancing [ ebgp | ibgp ] ecmp-nexthop-changed command is run, the device changes the next hop addresses of the routes to be advertised to a local address only when the routes are used for load balancing. When advertising the routes that are not used for load balancing, the device does not process the next hops of these routes. That is, the original next hop of these routes is the same as the next hop of the routes that are advertised when load balancing is not configured.<p></p>
<span>In the Add-Path scenario</span>, the next hop of Add-Path routes is processed in the same way as that of optimal routes, regardless of whether Add-Path routes are used for load balancing.</li></ul>
<p><strong>Configuration Impact</strong></p>
<p><p>If the command is run for multiple times, the latest configuration overrides the previous one.</p>
</p>
<p><strong>Precautions</strong></p>
<p><p>If the <b><span class="cmdname">maximum load-balancing</span></b> command has been configured, the <b><span class="cmdname">maximum load-balancing ebgp</span></b> or <b><span class="cmdname">maximum load-balancing ibgp</span></b> command configuration does not take effect. If the <b><span class="cmdname">maximum load-balancing ebgp</span></b> or <b><span class="cmdname">maximum load-balancing ibgp</span></b> command has been configured, the <b><span class="cmdname">maximum load-balancing</span></b> command configuration does not take effect.<p></p>
<span>If either the ebgp or the ibgp parameter is configured</span> in the <b><span class="cmdname">maximum load-balancing</span></b> command, this parameter must be also configured in the <b><span class="cmdname">undo maximum load-balancing</span></b> command when deleting load balancing.<p></p>
<span>The maximum load-balancing and</span> <b><span class="cmdname">peer load-balancing</span></b> commands are mutually exclusive.<p></p>
<span>When the number of equal-cost routes for load balancing</span> reaches 16, the number of next hops of a route is limited to 128. When the number of equal-cost routes for load balancing reaches 254, the number of next hops of a route is limited to 2.</p>
</p>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907603968__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Set two equal-cost routes to a specified destination.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>bgp 100</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp] <strong>maximum load-balancing 2</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_BGP_Configuration_Commands_title.html">BGP Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/LOAD-BALANCING-UCMP-IPV6UNI(BGPUCASTOM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/BGP-IPV4-MAXIMUM-LOAD-BALANCING(BGPOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>