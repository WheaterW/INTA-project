
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="multicast rpf-frr fib-wtr">
<meta name="DC.subject" content="multicast rpf-frr fib-wtr">
<meta name="keywords" content="multicast rpf-frr fib-wtr">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_IPv4_Multicast_Route_Management_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/MCAST-ROUTING-ENABLE-IPV4-VPN(MRMOM).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/MCAST-VERF-LIMIT-ROUTE(MRMOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="IPv4 Multicast Route Management">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="IPv4 Multicast Route Management">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IPv4 Multicast Route Management">
<meta name="featuretype" content="IP Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Creator" content="SUBSYS_ID_FWM_MCAST">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907766120">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>multicast rpf-frr fib-wtr</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907766120"></a><a name="EN-US_CLIREF_0000001907766120"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">multicast rpf-frr fib-wtr</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907766120__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">multicast rpf-frr fib-wtr</span></b> command sets the wait-to-restore (WTR) time of multicast forwarding entries.</p>
</p>
<p>By default, the WTR time of multicast forwarding entries is 10 seconds.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command is supported only on the CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE6885-LL (low latency mode), CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907766120__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">multicast rpf-frr fib-wtr </span></b><i><span class="varname">wtr-time</span></i></p>

<p><b><span class="cmdname">undo multicast rpf-frr fib-wtr</span></b></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907766120__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">wtr-time</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the WTR time.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer that ranges from 10 to 280. The default value is 10.</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907766120__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>System view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907766120__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907766120__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p>After PIM FRR is configured, a multicast routing entry with two inbound interfaces (primary and backup inbound interfaces) is generated. If the primary inbound interface fails (the link status or BFD status is Down), the corresponding multicast group accepts and forwards the multicast streams received from the backup inbound interface to quickly restore multicast services. If the primary inbound interface recovers (the link status or BFD status is Up) when the multicast routing entry has not been updated to an entry with a single inbound interface, the device waits for a time to restore (WTR) period before accepting and forwarding multicast streams received from the primary inbound interface. If the device accepts and forwards multicast streams received from the primary inbound interface when the upstream device is not ready, multicast traffic is interrupted. WTR can prevent this problem.<p></p>
<span>The time required for the recovery of the multicast</span> traffic received from the primary inbound interface is closely related to the number of multicast groups and CPU load. Therefore, you need to adjust the WTR time based on the number of multicast groups and CPU load. In the case of CPU light load (the CPU usage is lower than 50%), recommended configurations are as follows:</p>


<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><thead align="left">

<tr>
<th align="left" class="cellrowborder" valign="top" width="50%" id="mcps1.3.6.2.1.3.1.1" liSelected="liSelected">Number of Multicast Groups</th>

<th align="left" class="cellrowborder" valign="top" width="50%" id="mcps1.3.6.2.1.3.1.2" liSelected="liSelected">WTR Time (in Seconds)</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.1.3.1.1 ">1â2000</td>

<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.1.3.1.2 ">10 (default value)</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.1.3.1.1 ">2001â4000</td>

<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.1.3.1.2 ">20</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.1.3.1.1 ">4001â8000</td>

<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.1.3.1.2 ">40</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.1.3.1.1 ">8001â16000</td>

<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.6.2.1.3.1.2 ">80</td>

</tr>

</tbody>

</table>
</div>

<p>For a multicast group for which the <strong>rpf-frr</strong> command is run in the PIM view, to ensure that traffic on the backup inbound interface is not interrupted during the WTR period, the device adjusts the delay for sending Prune messages to the upstream device. To ensure that traffic on the primary inbound interface recovers as soon as possible, the device adjusts the maximum delay for delivering new link forwarding entries and the delay for delivering forwarding entries of the backup inbound interface. The delays are adjusted to proper values in typical scenarios based on the configured WTR time, meet the performance requirement of minimizing packet loss during WTR switchback, and do not need to be manually modified. If adjustment is required in special cases, refer to the following suggestions:</p>


<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><thead align="left">

<tr>
<th align="left" class="cellrowborder" valign="top" id="mcps1.3.6.4.1.3.1.1" liSelected="liSelected">Command</th>

<th align="left" class="cellrowborder" valign="top" id="mcps1.3.6.4.1.3.1.2" liSelected="liSelected">Function</th>

<th align="left" class="cellrowborder" valign="top" id="mcps1.3.6.4.1.3.1.3">Configuration Suggestions</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" headers="mcps1.3.6.4.1.3.1.1 mcps1.3.6.4.1.3.1.3 ">rpf-prune-delay</td>

<td class="cellrowborder" valign="top" headers="mcps1.3.6.4.1.3.1.2 ">Sets the delay for sending Prune messages to the upstream device.</td>

<td class="cellrowborder" valign="top" headers="mcps1.3.6.4.1.3.1.1 mcps1.3.6.4.1.3.1.3 ">Set the same value in all PIM views, and ensure that the value is greater than the WTR time.</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" headers="mcps1.3.6.4.1.3.1.1 mcps1.3.6.4.1.3.1.3 ">rpf-switch-delay mode sm max-time</td>

<td class="cellrowborder" valign="top" headers="mcps1.3.6.4.1.3.1.2 ">Sets the maximum delay for delivering new link forwarding entries.</td>

<td class="cellrowborder" valign="top" headers="mcps1.3.6.4.1.3.1.1 mcps1.3.6.4.1.3.1.3 ">Set the same value in all PIM views, and ensure that the value is less than the WTR time.</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" headers="mcps1.3.6.4.1.3.1.1 mcps1.3.6.4.1.3.1.3 ">backup-rpf-switchover-delay</td>

<td class="cellrowborder" valign="top" headers="mcps1.3.6.4.1.3.1.2 ">Sets the delay for delivering forwarding entries of the backup inbound interface.</td>

<td class="cellrowborder" valign="top" headers="mcps1.3.6.4.1.3.1.1 mcps1.3.6.4.1.3.1.3 ">Set the same value in all PIM views, and ensure that the value is greater than the WTR time.</td>

</tr>

</tbody>

</table>
</div>

<p>Improper configuration of the preceding delays may cause a large number of packets to be lost during the WTR period or when traffic is switched back to the primary inbound interface after the WTR period ends.</p>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907766120__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Set the WTR time of PIM FRR forwarding entries to 20 seconds.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>multicast rpf-frr fib-wtr 20</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_IPv4_Multicast_Route_Management_Commands_title.html">IPv4 Multicast Route Management Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/MCAST-ROUTING-ENABLE-IPV4-VPN(MRMOM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/MCAST-VERF-LIMIT-ROUTE(MRMOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>