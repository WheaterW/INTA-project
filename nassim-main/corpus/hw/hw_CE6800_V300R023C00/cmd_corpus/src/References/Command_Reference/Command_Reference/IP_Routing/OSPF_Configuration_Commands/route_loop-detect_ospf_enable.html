
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="route loop-detect ospf enable">
<meta name="DC.subject" content="route loop-detect ospf enable">
<meta name="keywords" content="route loop-detect ospf enable">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_OSPF_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/RFC1583-PREFER(OSPFCOMMOM).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/OSPF-ROUTE-TAG(OSPFCOMMOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Creator" content="SUBSYS_ID_OSPFCOMMOM">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907603372">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>route loop-detect ospf enable</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907603372"></a><a name="EN-US_CLIREF_0000001907603372"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">route loop-detect ospf enable</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907603372__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">route loop-detect ospf enable</span></b> command enables OSPF to detect loops of imported OSPF, IS-IS, and BGP routes.</p>
<p>The <b><span class="cmdname">undo route loop-detect ospf enable</span></b> command disables OSPF from detecting loops of imported OSPF, IS-IS, and BGP routes.</p>
<p>The <b><span class="cmdname">route loop-detect ospf import-ospf enable</span></b> command enables OSPF to detect loops of imported OSPF routes.</p>
<p>The <b><span class="cmdname">undo route loop-detect ospf import-ospf enable</span></b> command disables OSPF from detecting loops of imported OSPF routes.</p>
</p>
<p>By default, loop detection is disabled for routes imported into OSPF.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907603372__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">route loop-detect ospf enable</span></b></p>

<p><b><span class="cmdname">route loop-detect ospf import-ospf enable</span></b></p>

<p><b><span class="cmdname">undo route loop-detect ospf enable</span></b></p>

<p><b><span class="cmdname">undo route loop-detect ospf import-ospf enable</span></b></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907603372__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
None
</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907603372__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>System view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907603372__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907603372__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>When an OSPF process imports routes, routing loops are likely to occur. You can run the route loop-detect ospf [import-ospf] enable command to enable loop detection for imported OSPF routes. When a device detects that it has imported a route advertised by itself, the device advertises a large link cost for the route so that other devices can preferentially select another path after learning the route. This prevents routing loops.</p>
<p><strong>Precautions</strong></p>
<ul><li>Before enabling routing loop detection, check whether non-Huawei devices exist on the network and ensure that OSPF services are not affected when non-Huawei devices receive LSAs advertised by a Huawei device and private TLVs carried in the LSAs.</li></ul>

<ol><li>According to the protocol, if a non-Huawei device has the Opaque capability, it must be able to receive and flood AS Opaque LSAs. If a non-Huawei device does not have the Opaque capability, it must be able to discard AS Opaque LSAs without affecting neighbor relationship establishment.</li><li>If a non-Huawei device receives an AS Opaque LSA but cannot identify the TLV or sub-TLV carried in the AS Opaque LSA, the non-Huawei device needs to ignore this TLV without affecting the processing of other TLVs.</li><li>If a non-Huawei device uses the same private TLV type and the TLV values of the two functions conflict, do not configure this function.<p></p>
<span>Note</span>: OSPF advertises loop detection information through the sub-TLV (TLV type value: 32770) of the Extended Prefix TLV in the AS Opaque LSA.</li></ol>

<ul><li>OSPF uses opaque LSAs to detect loops of imported routes. Therefore, the opaque LSA capability must be enabled using the <b><span class="cmdname">opaque-capability enable</span></b> command.</li><li>After a loop is removed, the device cannot automatically exit the routing loop state, the alarm cannot be automatically cleared, and the normal cost cannot be restored. Manual intervention is required. For example, after a routing policy or route tag is correctly configured, run the <b><span class="cmdname">clear route loop-detect ospf alarm-state</span></b> command to exit the routing loop state and clear the alarm.</li><li>A single process supports routing loop detection for a maximum of 100,000 routes. If more than 100,000 routes are imported, loops cannot be detected for the excess routes. The system checks the number of routes for loop detection at 03:00 every day. If the number of routes for loop detection is less than 100,000, the system performs loop detection on the previously excess imported routes. The maximum number of imported routes for loop detection is still 100,000.</li><li>When a large cost is advertised upon a routing loop, the <b><span class="cmdname">apply cost</span></b> command does not take effect.</li><li>Summary routes and NSSA routes do not support routing loop detection.</li><li>The default route advertised using the <b><span class="cmdname">default-route-advertise</span></b> command supports loop detection and cost increasing. However, increasing the cost of the default route cannot ensure self-healing of loops.</li><li>Only loops caused by inter-process route import between two devices can be detected. If more than two devices import routes between processes, loops cannot be detected.</li><li>Router ID conflicts are not supported, including intra-AS and inter-AS router ID conflicts. A router ID conflict may trigger incorrect detection.</li><li>When the OSPF process that imports routes calculates routes with the same prefix and the calculated routes participate in load balancing with the imported routes, loops cannot be detected.</li></ul>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907603372__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Enable loop detection for imported OSPF routes.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>route loop-detect ospf import-ospf enable</strong>
</pre>
</div>

<div class="p"># Enable loop detection.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>route loop-detect ospf enable</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_OSPF_Configuration_Commands_title.html">OSPF Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/RFC1583-PREFER(OSPFCOMMOM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/OSPF-ROUTE-TAG(OSPFCOMMOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>