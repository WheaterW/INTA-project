
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="dhcp option82 insert enable">
<meta name="DC.subject" content="dhcp option82 insert enable">
<meta name="keywords" content="dhcp option82 insert enable">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_PNF-DHCP_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/DHCP_OPTION82_FORMAT.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/DHCP_OPTION82_LINK-SELECTION_SUBNET-IP-ADDRESS.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="DHCPv4">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="DHCPv4">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="DHCPv4">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Creator" content="SUBSYS_ID_ESAP_DHCPRELAY">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907602496">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>dhcp option82 insert enable</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907602496"></a><a name="EN-US_CLIREF_0000001907602496"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">dhcp option82 insert enable</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907602496__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">dhcp option82 insert enable</span></b> command enables a DHCP relay interface to insert Option 82 into DHCP packets.</p>
<p>The <b><span class="cmdname">undo dhcp option82 insert enable</span></b> command disables a DHCP relay interface from inserting Option 82 into DHCP packets.</p>
</p>
<p>By default, the function of inserting the Option 82 option to DHCP packets on the DHCP relay interface in inter-VPN scenarios is disabled.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907602496__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">dhcp option82 </span></b>{ <strong><span>vss-control</span></strong> | <strong><span>link-selection</span></strong> | <strong><span>server-id-override</span></strong> } <strong><span>insert</span></strong> <strong><span>enable</span></strong></p>

<p><b><span class="cmdname">undo dhcp option82 </span></b>{ <strong><span>vss-control</span></strong> | <strong><span>link-selection</span></strong> | <strong><span>server-id-override</span></strong> } <strong><span>insert</span></strong> <strong><span>enable</span></strong></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907602496__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>vss-control</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates suboption 151 and suboption 152 that carry VPN information of a DHCP client.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>link-selection</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates suboption 5 that carries the GiAddr address of the DHCP relay interface.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>server-id-override</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates suboption 11 that carries the IP address of the DHCP relay interface.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907602496__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>100ge sub-interface view,</span><span>100GE interface view,</span><span>10GE sub-interface view,</span><span>10GE interface view,</span><span>200GE sub-interface view,</span><span>200GE interface view,</span><span>25GE sub-interface view,</span><span>25GE interface view,</span><span>400GE sub-interface view,</span><span>400GE interface view,</span><span>50GE sub-interface view,</span><span>50GE interface view,</span><span>Eth-Trunk sub-interface view,</span><span>Eth-Trunk interface view,</span><span>VBDIF interface view,</span><span>VLANIF interface view,</span><span>Interface group view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907602496__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907602496__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>When the DHCP server and DHCP clients are in different VPNs, run the dhcp option82 command on the DHCP relay so that suboption 151, suboption 152, suboption 5, and suboption 11 can be inserted to the Option 82 field in DHCP request packets. In this manner, DHCP clients can properly obtain IP addresses from the DHCP server.<p></p>
<span>The functions of the three suboptions are as follows</span>:</p>

<ul><li>suboption151 and suboption 152: corresponds to the vss-control parameter that indicates VPN information of DHCP clients. Inserting this suboption to the Option 82 field is a proof of address allocation by the DHCP server.</li><li>suboption5: corresponds to the link-selection parameter that indicates the GiAddr information of the DHCP relay interface. In inter-VPN scenarios, the <b><span class="cmdname">dhcp relay giaddr outgoing-interface-address</span></b> command is run to allow the DHCP reply packets to be properly sent to the DHCP relay. The suboption 5 allows the GiAddr information to be sent to the DHCP server. Then DHCP server then selects the desired address pool based on suboption151, suboption 152 and suboption5 and allocates IP addresses to DHCP clients.</li><li>suboption11: corresponds to the server-id-override parameter that indicates the IP address of the DHCP relay interface. This suboption helps DHCP clients to obtain the correct destination IP address of renewal packets. Generally, when a DHCP client applies for an IP address for the first time, the DHCP reply packet sent by the DHCP server carries the Option 54 field that contains the IP address of the DHCP server. Upon receipt of the DHCP reply packet, the DHCP client uses this IP address as the destination IP address of renewal packets. Then, the DHCP client can interact with the DHCP server using unicast packets whenever it wants to renew the lease. In inter-VPN scenarios, if suboption 11 is inserted to the Option 82 field on the DHCP relay, the DHCP server encapsulates the content in suboption 11 into Option 54 in a DHCP reply packet. Upon receipt of the DHCP reply packet, the DHCP client uses the IP address of the DHCP relay interface as the destination IP address of renewal packets. In this manner, the DHCP client can properly send packets to the DHCP server through DHCP relay when it renews the lease.</li></ul>
<p><strong>Prerequisites</strong></p>
<p>DHCP relay has been enabled on the VLANIF interface using the <b><span class="cmdname">dhcp select relay</span></b> command.</p>
<p><strong>Precautions</strong></p>
<p>If the DHCP server does not support suboption link-selection, configure a loopback interface on the DHCP relay agent, set the IP address of the loopback interface to the giaddr address, and bind the loopback interface to the VPN where the DHCP server resides.</p>

<p>This method may be time consuming when the live network is complex as this method requires the configuration of a loopback interface on each server or client. If the server supports the suboption function, you are advised to insert suboptions on the relay agent.</p>

<p>In inter-VPN scenarios where the server-id-override command is configured, only the first-hop DHCP request packets can be relayed. The multi-hop DHCP relay agent does not process received DHCP request packets.</p>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907602496__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">



<div class="p"># Enable the function of inserting suboption 5 and suboption 11 into DHCP packets on interface <span>100GE</span><span>1/0/1</span>.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>interface <span>100GE</span><span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>dhcp option82 link-selection insert enable</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>dhcp option82 server-id-override insert enable</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_PNF-DHCP_Configuration_Commands_title.html">DHCPv4 Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/DHCP_OPTION82_FORMAT.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/DHCP_OPTION82_LINK-SELECTION_SUBNET-IP-ADDRESS.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>