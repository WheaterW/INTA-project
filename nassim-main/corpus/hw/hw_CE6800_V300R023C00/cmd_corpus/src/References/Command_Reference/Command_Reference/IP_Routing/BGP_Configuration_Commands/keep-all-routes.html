
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="keep-all-routes">
<meta name="DC.subject" content="keep-all-routes">
<meta name="keywords" content="keep-all-routes">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_BGP_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/BGP-IPV6-VRF(BGPVPNBASE).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/BGP-LOAD-BANALN-AS-PATH-IGNORE(BGPOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Creator" content="SUBSYS_ID_BGPOM">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001942843113">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>keep-all-routes</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001942843113"></a><a name="EN-US_CLIREF_0000001942843113"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">keep-all-routes</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001942843113__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">keep-all-routes</span></b> command saves all the routes carried in BGP Update messages advertised by BGP peers or peer groups after BGP connections are established.</p>
<p>The <b><span class="cmdname">undo keep-all-routes</span></b> command disables this function.</p>
</p>
<p>By default, the device saves only accepted routes (routes that match the import policy).</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001942843113__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">keep-all-routes</span></b></p>

<p><b><span class="cmdname">undo keep-all-routes</span></b></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001942843113__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
None
</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001942843113__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>BGP view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001942843113__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001942843113__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>After the import policy of BGP is changed, you can reset the BGP connection for the new import policy to take effect immediately on the BGP peer that does not support route-refresh. This, however, interrupts the BGP connection temporarily. To solve this problem, run the <b><span class="cmdname">keep-all-routes</span></b> command to retain all the original routes of the peer. In this manner, the routing table can be refreshed without resetting the BGP connection.</p>
<p><strong>Precautions</strong></p>
<p><p>If the device does not support the route-refresh capability, you need to run this command on both the local device and its peer. After the <b><span class="cmdname">keep-all-routes</span></b> command is run for the first time, the sessions between the local device and its peers are reestablished.<p></p>
<span>If the device supports the route-refresh capability</span>, running this command does not cause the sessions between the device and its peers to be reestablished. However, updating the routing table using the <b><span class="cmdname">refresh bgp</span></b> command does not take effect on the device.<p></p>
<span>After the</span> <b><span class="cmdname">keep-all-routes</span></b> command is run in the BGP view, the configuration of the <b><span class="cmdname">peer keep-all-routes</span></b> command is overwritten by the keep-all-routes configuration in the BGP view.<p></p>
<span>After the</span> <b><span class="cmdname">keep-all-routes</span></b> command is run in the BGP view, this function takes effect only in the BGP-IPv4 unicast address family, BGP-VPN instance IPv4 address family, BGP-IPv6 unicast address family, BGP-VPN instance IPv6 address family, BGP-IPv4 multicast address family, BGP-VPNv4 address family, and BGP-VPNv6 address family.</p>
</p>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001942843113__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Configure a device to save all BGP routing updates received from its peers.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>bgp 100</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp] <strong>keep-all-routes</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_BGP_Configuration_Commands_title.html">BGP Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/BGP-IPV6-VRF(BGPVPNBASE).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/BGP-LOAD-BANALN-AS-PATH-IGNORE(BGPOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>