
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="dns-server-select-algorithm">
<meta name="DC.subject" content="dns-server-select-algorithm">
<meta name="keywords" content="dns-server-select-algorithm">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_PNF-DNS_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/DNS_SERVER_VPN-INSTANCE.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/IP_HOST.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="DNS">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="DNS">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="DNS">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Creator" content="SUBSYS_ID_ESAP_DNS">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907762688">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>dns-server-select-algorithm</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907762688"></a><a name="EN-US_CLIREF_0000001907762688"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">dns-server-select-algorithm</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907762688__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">dns-server-select-algorithm</span></b> command configures the DNS server selection mode of the device.</p>
<p>The <b><span class="cmdname">undo dns-server-select-algorithm</span></b> command restores the default setting.</p>
</p>
<p>By default, the device selects a DNS server in auto mode.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907762688__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">dns-server-select-algorithm </span></b>{ <strong><span>fixed</span></strong> | <strong><span>auto</span></strong> }</p>

<p><b><span class="cmdname">undo dns-server-select-algorithm</span></b></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907762688__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>fixed</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Selects a DNS server in fixed mode.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>auto</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Selects a DNS server in auto mode.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907762688__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>System view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907762688__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907762688__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>The device selects a DNS server in either of the following modes:</p>

<ul><li>When the DNS server mode is set to auto, the device uses an internal algorithm to calculate the priorities of all configured DNS servers (IP addresses of DNS servers can be configured using the <b><span class="cmdname">dns server</span></b> command) before sending a DNS query request. (The difference between the number of sent DNS request packets and the number of valid response packets from the DNS server is used as the criterion. If the difference is less than 3, the DNS server is available. If the difference is 0, the DNS server is of the high priority. Other DNS servers are of the second highest priority. The priority is updated each time a packet is sent or received.) Then, the DNS server sends a DNS query request to the DNS server with a higher priority. If the DNS server does not receive a response within the specified period, the DNS server sends a DNS query request to another DNS server with a higher priority. If the device still does not receive any response from the DNS server, it sends a DNS query request to the DNS server with the second highest priority. Repeat the preceding steps until a response is received or all configured DNS servers are queried in sequence. (If all available servers are used but retransmission is still required, the difference is cleared and the request is sent again according to the preceding rule.)</li><li>When the DNS server mode is set to fixed, the device sends a DNS query request to the first configured DNS server. If no response is received within a specified period, the device resends the DNS query request. If the device does not receive any response from the DNS server after sending the DNS query request multiple times, the device sends a DNS query request to the next DNS server until it receives a response or queries all configured DNS servers.</li></ul>
<p><strong>Precautions</strong></p>
<div class="p"><p>This function is supported when the device functions as a DNS client.<p></p>
<span>When the device functions as a DNS client</span>:</p>

<ul><li>This function is supported for DNS asynchronous query requests sent by the IPsec, PKI, HeathCheck, and AAA services.</li><li>The DNS server selection mode cannot be configured for DNS synchronization query requests (for example, pinging domain names) initiated by the data-agent service. The device sends the requests according to the sequence in which DNS servers are configured. If no response is received, the device retransmits the requests according to the sequence in which DNS servers are configured.</li></ul>
</div>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907762688__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Configure the device to select a DNS server in fixed mode.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>dns-server-select-algorithm fixed</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_PNF-DNS_Configuration_Commands_title.html">DNS Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/DNS_SERVER_VPN-INSTANCE.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/IP_HOST.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>