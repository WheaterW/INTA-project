
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="ospf valid-ttl-hops">
<meta name="DC.subject" content="ospf valid-ttl-hops">
<meta name="keywords" content="ospf valid-ttl-hops">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_OSPF_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/OSPF-TRANS-DELAY-MA(OSPFCOMMOM).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/OSPF-PEER(OSPFCOMMOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Creator" content="SUBSYS_ID_OSPFCOMMOM">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001942842541">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>ospf valid-ttl-hops</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001942842541"></a><a name="EN-US_CLIREF_0000001942842541"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">ospf valid-ttl-hops</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001942842541__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">ospf valid-ttl-hops</span></b> command enables OSPF GTSM and sets the TTL value to be checked.</p>
<p>The <b><span class="cmdname">undo ospf valid-ttl-hops</span></b> command disables OSPF GTSM.</p>
</p>
<p>By default, OSPF GTSM is disabled.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001942842541__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">ospf valid-ttl-hops </span></b><i><span class="varname">ttl</span></i> [ <strong><span>nonstandard-multicast</span></strong> ] [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ]</p>


<p><b><span class="cmdname">undo ospf valid-ttl-hops </span></b>[ <i><span class="varname">ttl</span></i> ] [ <strong><span>nonstandard-multicast</span></strong> ] [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ]</p>


</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001942842541__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">ttl</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the TTL value to be checked.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer that ranges from 1 to 255. If you specify the parameter hops, the valid range of the TTL value in the packet to be checked is [ 255-hops+1, 255 ].</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>nonstandard-multicast</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<div class="p"><p>Specifies the GTSM configuration is also valid for multicast packets.<p>When the.</p>
<p>nonstandard-multicast parameter is configured:</p>
</p>
<ul><li>The TTL values of the multicast packets which will be sent are set to 255.</li><li>Received multicast packets are not checked.</li></ul>
</div>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the VPN instance name.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a string of 1 to 31 case-sensitive characters, spaces not supported. The VPN instance name cannot be _public_. If the character string is quoted by double quotation marks, the character string can contain spaces.</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001942842541__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>System view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001942842541__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001942842541__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<div class="p"><p>On a network requiring high security, you can configure GTSM to improve the security of the OSPF network. GTSM defends against attacks through TTL detection. If an attacker continuously sends simulated OSPF unicast packets to a device, the device receives these packets and finds that they are local packets. Then, the device directly sends the packets to OSPF on the control plane for processing, without checking the validity of these packets. As a result, the control plane of the device is busy processing these packets, and the CPU usage is high. GTSM protects a device by checking whether the TTL value in the IP packet header is within a pre-defined range to enhance system security.<p></p>
<span>This command can be used to enable OSPF GTSM and check</span> the TTL value.</p>

<ul><li>After the <b><span class="cmdname">ospf valid-ttl-hops</span></b> command is run, OSPF GTSM can be enabled, regardless of whether the public network or private network is used.</li><li>If vpn-instance is specified, only the TTL values of OSPF packets in a specified VPN instance are checked, and the default action (configured using the <b><span class="cmdname">gtsm default-action</span></b> command) for the packets that do not match GTSM policies is taken on the OSPF packets in the public network instance and other VPN instances. If vpn-instance is not specified, only the TTL values of OSPF packets in the public network instance are checked, and the default action for the packets that do not match GTSM policies is taken on OSPF packets in VPN instances.</li></ul>
</div>
<p><strong>Precautions</strong></p>
<div class="p"><ul><li>If a VPN instance is specified in the <b><span class="cmdname">ospf valid-ttl-hops</span></b> command and an interface is bound to the VPN instance, all the OSPF unicast packets sent to this interface are discarded when the set TTL value is smaller than the actual TTL value on the network.</li><li>If a virtual link or sham link is configured, the configured TTL value must be the same as the actual TTL value. That is, the number of devices that the virtual link or sham link passes through is counted. Otherwise, packets sent from neighbors over the virtual link or sham link are discarded.</li><li>The default TTL value of OSPF packets sent by a device is 1. After the <b><span class="cmdname">ospf valid-ttl-hops</span></b> command is run, the TTL value of OSPF packets sent by the device changes to 255. If the <b><span class="cmdname">ospf valid-ttl-hops</span></b> command is run only on one end, OSPF unicast packets may fail to be forwarded. Although the established OSPF neighbor relationship is not affected, the new OSPF neighbor relationship cannot go Up.</li><li>After the <b><span class="cmdname">ospf valid-ttl-hops hops</span></b> command is run, the valid TTL range of the detected packet changes to [255-hops+1, 255]. For example, if the value of hops is 5, the received OSPF packet is valid only when the TTL value of the packet ranges from 251 to 255.</li></ul>
</div>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001942842541__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Enable OSPF GTSM, and set the maximum number of TTL hops to 5 for the packets that can be received from the public network.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ospf valid-ttl-hops 5</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_OSPF_Configuration_Commands_title.html">OSPF Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/OSPF-TRANS-DELAY-MA(OSPFCOMMOM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/OSPF-PEER(OSPFCOMMOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>