
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="redirect nexthop">
<meta name="DC.subject" content="redirect nexthop">
<meta name="keywords" content="redirect nexthop">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_PNF-Redirection_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/REDIRECT_LOAD-BALANCE.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/REDIRECT_OBSERVE-PORT_GROUP.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Redirection">
<meta name="featuretype" content="QoS">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="Redirection">
<meta name="featuretype" content="QoS">
<meta name="featurename" content="Redirection">
<meta name="featuretype" content="QoS">
<meta name="featuretype" content="QoS">
<meta name="featuretype" content="QoS">
<meta name="DC.Creator" content="SUBSYS_ID_DC_MQC">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907608680">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>redirect nexthop</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907608680"></a><a name="EN-US_CLIREF_0000001907608680"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">redirect nexthop</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907608680__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">redirect nexthop</span></b> command configures an action of redirecting packets to a next-hop IP address in a traffic behavior.</p>
<p>The <b><span class="cmdname">undo redirect</span></b> command deletes the redirection configuration.</p>
</p>
<p>By default, the action of redirecting packets to a remote next hop is not configured in a traffic behavior.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907608680__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">






<p>For CE8851-32CQ8DQ-P, CE8850-HAM, CE8850-SAN, CE8851K, CE8855, CE8851-32CQ4BQ, CE6860-SAN, CE6866, CE6860-HAM, CE6866K, CE6820H, CE6820H-K, CE6820S, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6855-48XS8CQ, CE6885, CE6885-T, CE6885-LL (standard forwarding mode), CE6863E-48S8CQ, CE6885-SAN: </p>

<p><b><span class="cmdname">redirect </span></b>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <strong><span>nexthop</span></strong> { <i><span class="varname">ip-address</span></i> [ <strong><span>track</span></strong> <strong><span>nqa</span></strong> <i><span class="varname">admin-name</span></i> <i><span class="varname">test-name</span></i> [ <strong><span>reaction</span></strong> <strong><span>probe-failtimes</span></strong> <i><span class="varname">fail-times</span></i> ] ] } &amp;&lt;1-16&gt; [ <strong><span>fail-action</span></strong> <strong><span>discard</span></strong> ] [ <strong><span>low-precedence</span></strong> ]</p>

<p><b><span class="cmdname">undo redirect </span></b>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <strong><span>nexthop</span></strong> { <i><span class="varname">ip-address</span></i> [ <strong><span>track</span></strong> <strong><span>nqa</span></strong> <i><span class="varname">admin-name</span></i> <i><span class="varname">test-name</span></i> [ <strong><span>reaction</span></strong> <strong><span>probe-failtimes</span></strong> <i><span class="varname">fail-times</span></i> ] ] } &amp;&lt;1-16&gt; [ <strong><span>fail-action</span></strong> <strong><span>discard</span></strong> ] [ <strong><span>low-precedence</span></strong> ]</p>

<p>For CE8851-32CQ8DQ-P, CE8850-HAM, CE8850-SAN, CE8851K, CE8855, CE8851-32CQ4BQ, CE6860-SAN, CE6866, CE6860-HAM, CE6866K, CE6820H, CE6820H-K, CE6820S, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6855-48XS8CQ, CE6885, CE6885-T, CE6885-LL (standard forwarding mode), CE6863E-48S8CQ, CE6885-SAN: </p>

<p><b><span class="cmdname">redirect ipv6 </span></b>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <strong><span>nexthop</span></strong> { <i><span class="varname">ipv6-address</span></i> [ <strong><span>track</span></strong> <strong><span>nqa</span></strong> <i><span class="varname">admin-name</span></i> <i><span class="varname">test-name</span></i> [ <strong><span>reaction</span></strong> <strong><span>probe-failtimes</span></strong> <i><span class="varname">fail-times</span></i> ] ] } &amp;&lt;1-16&gt; [ <strong><span>fail-action</span></strong> <strong><span>discard</span></strong> ]</p>

<p><b><span class="cmdname">undo redirect ipv6 </span></b>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <strong><span>nexthop</span></strong> { <i><span class="varname">ipv6-address</span></i> [ <strong><span>track</span></strong> <strong><span>nqa</span></strong> <i><span class="varname">admin-name</span></i> <i><span class="varname">test-name</span></i> [ <strong><span>reaction</span></strong> <strong><span>probe-failtimes</span></strong> <i><span class="varname">fail-times</span></i> ] ] } &amp;&lt;1-16&gt; [ <strong><span>fail-action</span></strong> <strong><span>discard</span></strong> ]</p>

<p>For CE8851-32CQ8DQ-P, CE8850-HAM, CE8850-SAN, CE8851K, CE8855, CE8851-32CQ4BQ, CE6860-SAN, CE6866, CE6860-HAM, CE6866K, CE6820H, CE6820H-K, CE6820S, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6855-48XS8CQ: </p>

<p><b><span class="cmdname">undo redirect</span></b></p>




<p>For CE6885-LL (low latency mode): </p>

<p><b><span class="cmdname">redirect </span></b>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <strong><span>nexthop</span></strong> { <i><span class="varname">ip-address</span></i> [ <strong><span>track</span></strong> <strong><span>nqa</span></strong> <i><span class="varname">admin-name</span></i> <i><span class="varname">test-name</span></i> [ <strong><span>reaction</span></strong> <strong><span>probe-failtimes</span></strong> <i><span class="varname">fail-times</span></i> ] ] } &amp;&lt;1-16&gt; [ <strong><span>fail-action</span></strong> <strong><span>discard</span></strong> ]</p>

<p><b><span class="cmdname">undo redirect </span></b>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <strong><span>nexthop</span></strong> { <i><span class="varname">ip-address</span></i> [ <strong><span>track</span></strong> <strong><span>nqa</span></strong> <i><span class="varname">admin-name</span></i> <i><span class="varname">test-name</span></i> [ <strong><span>reaction</span></strong> <strong><span>probe-failtimes</span></strong> <i><span class="varname">fail-times</span></i> ] ] } &amp;&lt;1-16&gt; [ <strong><span>fail-action</span></strong> <strong><span>discard</span></strong> ]</p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907608680__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the name of a VPN instance.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a string of 1 to 31 case-sensitive characters, spaces not supported. The VPN instance name cannot be _public_. If the character string is quoted by double quotation marks, the character string can contain spaces.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">ip-address</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the next-hop IPv4 address.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is in dotted decimal notation.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>track</span></strong> <strong><span>nqa</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates an NQA test instance.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">admin-name</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the administrator name of an NQA test instance.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a string of 1 to 32 case-sensitive characters, spaces not supported.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">test-name</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the name of an NQA test instance.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a string of 1 to 32 case-sensitive characters, spaces not supported.</p>
</td>
</tr>








<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>fail-action</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the action to be taken if the next hop is unreachable.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>discard</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Discards the packets.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>ipv6</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the next-hop IPv6 address.</p>
</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">ipv6-address</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the next-hop IPv6 address. The address cannot be of the link-local type.</p>
</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a 32-bit hexadecimal string in format X:X:X:X:X:X:X:X.</p>
</td>
</tr>



<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>reaction</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Cancels redirection.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>probe-failtimes</span></strong> <i><span class="varname">fail-times</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the maximum number of link detection failures in an NQA test instance.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer in the range from 1 to 15.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>low-precedence</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the low priority of policy-based routing.</p>
</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>


</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907608680__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>Traffic behavior view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907608680__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907608680__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p><p>The <b><span class="cmdname">redirect nexthop</span></b> command allows you to specify a maximum of 16 next-hop IP addresses (using the ip-address parameter for multiple times). If multiple next-hop IP addresses are configured, the device redirects packets in active/standby mode. The device determines the primary link and backup links according to the sequence in which next-hop IP addresses were configured. The next-hop IP address that was configured first has the highest priority and this next hop is used as the primary path. Other next hops are used as backup paths. When the primary link becomes Down, a next hop with higher priority is used as the primary path.</p>

<p>If an NQA test instance is configured to detect the link for the redirection next-hop IP address and the number of NQA link detection failures is greater than or equal to the configured maximum value, the current next hop will be canceled. If multiple next hops work in active/standby mode, traffic will be automatically switched to a reachable next hop.<p></p>
<span>PBR is implemented based on the redirection action</span> configured in a traffic behavior and takes effect only on incoming packets of interfaces. By default, a device forwards packets to the next hop found in its routing table. If PBR is configured, the device forwards packets to the next hop specified by PBR. After you specify the low-precedence parameter, the device forwards packets matching PBR to the next hop/outbound interface of the specific route in its routing table. When the specific route becomes invalid, the device forwards packets to the next hop/outbound interface specified by PBR. When both the next hop of the specific route and next hop specified by PBR become invalid, and the routing table has default routes, the device continues forwarding packets according to the matching default route.</p>
</p>
<p><strong>Precautions</strong></p>
<div class="p"><ul><li>If no ARP entry matches the next-hop address on the device, the device triggers ARP learning. If the ARP entry cannot be learned, redirection does not take effect and packets are forwarded along the original forwarding path.</li><li>The redirected IP address cannot be the IP address of the device.</li><li>IPv6 PBR does not support redirection based on routes created using OSPFv3.</li></ul>
</div>
<p><p>The NQA test instance associated with redirection must be of the ICMP type.</p>
</p>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907608680__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Configure an action of redirecting packets to the next hop at 10.0.0.1 in the traffic behavior b1.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>traffic behavior b1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-behavior-b1] <strong>redirect nexthop 10.0.0.1</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_PNF-Redirection_Configuration_Commands_title.html">Redirection Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/REDIRECT_LOAD-BALANCE.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/REDIRECT_OBSERVE-PORT_GROUP.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>