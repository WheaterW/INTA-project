
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="ip ip-prefix">
<meta name="DC.subject" content="ip ip-prefix">
<meta name="keywords" content="ip ip-prefix">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_IP_Routing_Policy_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/BASIC-ECL-SOO(RTPOM).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/PREFIX-FILTER-DESC(RTPOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Routing Policy">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="Routing Policy">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="Routing Policy">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Creator" content="SUBSYS_ID_RTPOM">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907766020">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>ip ip-prefix</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907766020"></a><a name="EN-US_CLIREF_0000001907766020"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">ip ip-prefix</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907766020__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">ip ip-prefix</span></b> command configures an IP prefix list or one entry in the IP prefix list.</p>
<p>The <b><span class="cmdname">undo ip ip-prefix</span></b> command deletes an IP prefix list or one entry in the IP prefix list.</p>
</p>
<p>By default, no IP prefix list is configured.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907766020__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">ip ip-prefix </span></b><i><span class="varname">ip-prefix-name</span></i> [ <strong><span>index</span></strong> <i><span class="varname">index-number</span></i> ] <i><span class="varname">matchMode</span></i> <i><span class="varname">ipv4-address</span></i> <i><span class="varname">masklen</span></i> [ <strong><span>match-network</span></strong> ] [ <strong><span>greater-equal</span></strong> <i><span class="varname">greater-equal-value</span></i> ] [ <strong><span>less-equal</span></strong> <i><span class="varname">less-equal-value</span></i> ]</p>


<p><b><span class="cmdname">undo ip ip-prefix </span></b><i><span class="varname">ip-prefix-name</span></i> [ <strong><span>index</span></strong> <i><span class="varname">index-number</span></i> ]</p>

<p><b><span class="cmdname">undo ip ip-prefix </span></b><i><span class="varname">ip-prefix-name</span></i> <i><span class="varname">ipv4-address</span></i> <i><span class="varname">masklen</span></i> [ <strong><span>match-network</span></strong> ] [ <strong><span>greater-equal</span></strong> <i><span class="varname">greater-equal-value</span></i> ] [ <strong><span>less-equal</span></strong> <i><span class="varname">less-equal-value</span></i> ]</p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907766020__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">ip-prefix-name</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the name of an IP prefix list.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a string of 1 to 169 case-sensitive characters. The character string can contain spaces if it is enclosed in double quotation marks ("").</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>index</span></strong> <i><span class="varname">index-number</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the sequence number of the entry in the IP prefix list.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p><p>The value is an integer ranging from 1 to 4294967295.</p>
<p>By default, the sequence number increases with a step of 10 according to the configuration order, and the first number is 10.</p>
</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">matchMode</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the matching mode of the IP prefix list.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><div class="p"><p>The value is an enumerated type:</p>
<ul><li>permit: Specifies the matching mode of the IP prefix list as permit. In permit mode, if the IP address to be filtered is in the defined prefix range, the IP address matches the route-policy and no longer match against the next entry. Otherwise, the IP address continues to match against the next entry.</li><li>deny: Specifies the matching mode of the IP prefix list as deny. In deny mode, if the IP address to be filtered is in the defined prefix range, the IP address fails to match the route-policy and cannot match against the next entry. Otherwise, the IP address continues to match against the next entry.</li></ul>
</div>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">ipv4-address</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the IP address.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>It is in dotted decimal notation.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">masklen</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the mask length.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 0 to 32.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>match-network</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Matches the network address. match-network is used to match routes to a specified network address and can be configured only when ipv4-address is 0.0.0.0. For example, ip ip-prefix prefix1 permit 0.0.0.0 8 matches all the routes with the mask length of 8, and ip ip-prefix prefix1 permit 0.0.0.0 8 match-network matches all the routes with the mask length ranging from 0.0.0.1 to 0.255.255.255.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>greater-equal</span></strong> <i><span class="varname">greater-equal-value</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the minimum value of the mask length range.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value of greater-equal-value is subject to the following rule: masklen&lt;=greater-equal-value&lt;=less-equal-value&lt;=32.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>less-equal</span></strong> <i><span class="varname">less-equal-value</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the maximum value of the mask length range.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value of less-equal-value is subject to the following rule: masklen&lt;=greater-equal-value&lt;=less-equal-value&lt;=32.</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907766020__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>System view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907766020__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907766020__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<div class="p"><p>An IP prefix list can be used as a filter or as filtering conditions of a route-policy when it is used with the <b><span class="cmdname">if-match</span></b> command.<p></p>
<span>Each entry in an IP prefix list can be used as a filtering</span> rule. When a route to be filtered matches an entry, whether the route matches the IP prefix list is determined by the matching mode. A route to be filtered matches an entry or entries based on the following rules:</p>

<ul><li>Sequential matching: The route has to match the entries in the IP prefix list in ascending order of their &lt;producer-pid&gt; values. Therefore, specifying &lt;producer-pid&gt; in a required sequence is recommended.</li><li>One-time matching: If a route matches one entry, the route matches the IP prefix list and will not be matched against the next entry.</li><li>Matching failure by default: If a route fails to match any of the entries, it fails to match the IP prefix list.<p></p>
<span>The following example shows how different IP prefix</span> lists take effect on the routes 1.1.1.0/24, 1.1.1.1/32, 1.1.1.0/26, 2.2.2.0/24, and 1.1.0.0/16.</li><li>Case1:<p></p>
<span>ip ip-prefix aa index 10 permit 1</span>.1.1.0 24<p></p>
<span>Matching result</span>: Only the route 1.1.1.0/24 is permitted, and the other routes are denied.<p></p>
<span>Note</span>: This is a single-node accurate matching case, which indicates that only the route whose destination IP address and mask are the same as those specified by the entry meets the filtering conditions. In addition, permit is configured as the matching mode. Therefore, the route 1.1.1.0/24 is permitted, and other routes are denied because they fail to meet the filtering conditions.</li><li>Case2:<p></p>
<span>ip ip-prefix aa index 10 deny 1</span>.1.1.0 24<p></p>
<span>Matching result</span>: All routes are denied.<p></p>
<span>Note</span>: This is also a single-node accurate matching case. deny is configured as the matching mode. Therefore, the route 1.1.1.0/24 is denied, and the other routes are denied based on the rule of matching failure by default because they fail to meet the filtering conditions.</li><li>Case3:<p></p>
<span>ip ip-prefix aa index 10 permit 1</span>.1.1.0 24 less-equal 32<p></p>
<span>Matching result</span>: The routes 1.1.1.0/24, 1.1.1.1/32, and 1.1.1.0/26 are permitted, and the other routes are denied.<p></p>
<span>Note</span>: This is also a single-node accurate matching case. permit is configured as the matching mode, and less-equal is set to 32. Therefore, the routes with 1.1.1.0 as the prefix and the mask ranging from 24 to 32 can be permitted, and the other routes are denied based on the rule of matching failure by default because they fail to meet the filtering conditions.</li><li>Case4:<p></p>
<span>ip ip-prefix aa index 10 permit 1</span>.1.1.0 24 greater-equal 24 less-equal 32<p></p>
<span>Matching result</span>: The routes 1.1.1.0/24, 1.1.1.1/32, and 1.1.1.0/26 are permitted, and the other routes are denied.<p></p>
<span>Note</span>: This is also a single-node accurate matching case. permit is configured as the matching mode, greater-equal is set to 24, and less-equal is set to 32. Therefore, the routes with 1.1.1.0 as the prefix and the mask ranging from 24 to 32 can be permitted, and the other routes are denied based on the rule of matching failure by default because they fail to meet the filtering conditions. This case is similar to case 3 in terms of the matching result.</li><li>Case5:<p></p>
<span>ip ip-prefix aa index 10 permit 1</span>.1.1.0 24 greater-equal 26<p></p>
<span>Matching result</span>: The routes 1.1.1.1/32 and 1.1.1.0/26 are permitted, and the other routes are denied.<p></p>
<span>Note</span>: This is also a single-node accurate matching case. permit is configured as the matching mode, and greater-equal is set to 26. Therefore, the routes with 1.1.1.0 as the prefix and the mask ranging from 26 to 32 can be permitted, and the other routes are denied based on the rule of matching failure by default because they fail to meet the filtering conditions.</li><li>Case6:<p></p>
<span>ip ip-prefix aa index 10 permit 1</span>.1.1.0/24 greater-equal 26 less-equal 32<p></p>
<span>Matching result</span>: The routes 1.1.1.1/32 and 1.1.1.0/26 are permitted, and the other routes are denied.<p></p>
<span>Note</span>: This is also a single-node accurate matching case. permit is configured as the matching mode, greater-equal is set to 26, and less-equal is set to 32. Therefore, the routes with 1.1.1.0 as the prefix and the mask ranging from 26 to 32 can be permitted, and the other routes are denied based on the rule of matching failure by default because they fail to meet the filtering conditions. This case is similar to case 5 in terms of the matching result.</li><li>Case7:<p></p>
<span>ip ip-prefix aa index 10 deny 1</span>.1.1.0 24<p></p>
<span>ip ip-prefix aa index 20 permit 1</span>.1.1.1 32<p></p>
<span>Matching result</span>: The route 1.1.1.1/32 is permitted, and the other routes are denied.<p></p>
<span>Note</span>: This is a multi-node accurate matching case. deny is configured as the matching mode of the matching entry indexed 10, and therefore the route 1.1.1.0/24 is denied by the matching entry indexed 10 based on the rule of one-time matching. The route 1.1.1.1/32 fails to match the filtering conditions, and it is then matched against the entry indexed 20 for which permit is configured as the matching mode. Consequently, the route 1.1.1.1/32 matches the filtering conditions of the entry indexed 20. The other routes are denied based on the rule of matching failure by default because they fail to meet the filtering conditions.<p></p>
<span>If the IP prefix is 0</span>.0.0.0 and you specify a mask and a mask length range after this IP prefix, all routes with the mask length within the specified mask length range are denied or permitted, regardless of the mask.</li><li>Case8:<p></p>
<span>ip ip-prefix aa index 10 permit 0</span>.0.0.0 8 less-equal 32<p></p>
<span>Matching result</span>: The routes 1.1.1.0/24, 1.1.1.1/32, 1.1.1.0/26, 2.2.2.0/24, and 1.1.0.0/16 are all permitted.<p></p>
<span>Note</span>: The mask length range is from 8 to 32, 0.0.0.0 is specified as the IP address, and permit is configured as the matching mode. Therefore, all routes with the mask length within the range are permitted.</li><li>Case9:<p></p>
<span>ip ip-prefix aa index 10 deny 0</span>.0.0.0 24 less-equal 32<p></p>
<span>ip ip-prefix aa index 20 permit 0</span>.0.0.0 0 less-equal 32<p></p>
<span>Matching result</span>: The route 1.1.0.0/16 is permitted, and the other routes are denied.<p></p>
<span>Note</span>: For the entry indexed 10, the mask length range is from 24 to 32, 0.0.0.0 is specified as the IP address, and deny is configured as the matching mode. Therefore, all routes with the mask length within the range are denied, and the route 1.1.0.0/16 that fails to match its filtering conditions is then matched against the entry indexed 20. For the entry indexed 20, the mask length range is from 0 to 32, 0.0.0.0 is specified as the IP address, and permit is configured as the matching mode. Therefore, the route 1.1.0.0/16 is permitted by the entry indexed 20.</li><li>Case10:<p></p>
<span>ip ip-prefix aa index 10 deny 2</span>.2.2.0 24<p></p>
<span>ip ip-prefix aa index 20 permit 0</span>.0.0.0 0 less-equal 32<p></p>
<span>Matching result</span>: All routes except the route 2.2.2.0/24 are permitted.<p></p>
<span>Note</span>: For the entry indexed 10, deny is configured as the matching mode. Therefore, the route 2.2.2.0/24 that matches its filtering conditions is denied, and the other routes that fail to match the filtering conditions are then matched against the entry indexed 20. For the entry indexed 20, the mask length range is from 0 to 32, 0.0.0.0 is specified as the IP address, and permit is configured as the matching mode. Therefore, all routes except the route 2.2.2.0/24 are permitted by the entry indexed 20.</li></ul>
</div>
<p><strong>Configuration Impact</strong></p>
<p><p>If you create an entry whose &lt;producer-pid&gt; has existed in the same IP prefix list but has different filtering rules, the new entry overwrites the existing one.</p>
</p>
<p><strong>Precautions</strong></p>
<p><p>Because of the matching failure by default, if one or more than one entry with deny as the matching mode is created, create an entry using the ip ip-prefix ip-prefix-name [ index index-number ] permit 0.0.0.0 0 less-equal 32 command so that all IPv4 routes may match the IP prefix list.<p></p>
<span>If ipv4-address mask-length is specified as 0</span>.0.0.0 0, only default routes are matched.<p></p>
<span>If ipv4-address mask-length is set to 0</span>.0.0.0 0 less-equal 32, all routes are matched.<p></p>
<span>The IP prefix lists in use cannot be deleted</span>.<p></p>
<span>After a configuration is delivered</span>, the device checks the validity of the parameters in the configuration and processes these parameters. After the processing, the generated configuration is the result of the AND calculation between the specified ipv4-address and mask-length. For example, if the specified ipv4-address and mask-length are 1.1.1.1 and 24, respectively, the generated configuration is 1.1.1.0 24.<p></p>
<span>If the ipv4-address in the generated configuration</span> is 0.0.0.0, the configuration matches all IPv4 addresses.</p>
</p>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907766020__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Configure the IP prefix list named p3 to deny the routes to the IP address range from 0.0.0.1 to 0.255.255.255.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ip ip-prefix p3 index 10 deny 0.0.0.0 8 match-network</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>ip ip-prefix p3 index 20 permit 0.0.0.0 0 less-equal 32</strong>
</pre>
</div>

<div class="p"># Configure the IP prefix list named p2 to permit only the routes with the mask length ranging from 17 to 18.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ip ip-prefix p2 permit 0.0.0.0 0 greater-equal 17 less-equal 18</strong>
</pre>
</div>

<div class="p"># Configure an IP prefix list named p1, permitting only the routes with the mask length 17 or 18 and on network segment 10.0.0.0/8.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ip ip-prefix p1 permit 10.0.0.0 8 greater-equal 17 less-equal 18</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_IP_Routing_Policy_Configuration_Commands_title.html">Routing Policy Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/BASIC-ECL-SOO(RTPOM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/PREFIX-FILTER-DESC(RTPOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>