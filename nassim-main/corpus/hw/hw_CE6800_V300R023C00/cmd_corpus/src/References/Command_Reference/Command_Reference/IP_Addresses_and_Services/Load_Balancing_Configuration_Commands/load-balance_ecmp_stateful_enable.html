
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="load-balance ecmp stateful enable">
<meta name="DC.subject" content="load-balance ecmp stateful enable">
<meta name="keywords" content="load-balance ecmp stateful enable">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_PNF-Load_Balancing_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/LOAD-BALANCE_ECMP_RAIL-GROUP_ENABLE.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/LOAD-BALANCE_ECMP_STATEFUL_ENHANCED_ENABLE.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Load Balancing">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="Load Balancing">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="Load Balancing">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Creator" content="SUBSYS_ID_FWM_IPV4">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001942841497">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>load-balance ecmp stateful enable</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001942841497"></a><a name="EN-US_CLIREF_0000001942841497"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">load-balance ecmp stateful enable</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001942841497__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">load-balance ecmp stateful enable</span></b> command enables the ECMP load balancing consistency function.</p>
<p>The <b><span class="cmdname">undo load-balance ecmp stateful enable</span></b> command disables the ECMP load balancing consistency function.</p>
</p>
<p>By default, the ECMP load balancing consistency function is disabled.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001942841497__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">load-balance ecmp stateful enable</span></b></p>

<p><b><span class="cmdname">undo load-balance ecmp stateful enable</span></b></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001942841497__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
None
</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001942841497__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>System view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001942841497__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001942841497__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>When a switch that participates in traffic load balancing becomes faulty, the number of equal-cost routes reduces, and so all traffic needs to be load balanced again using the hash algorithm. As a result, traffic forwarding paths may change. Requests of the same user may be sent to different servers, greatly affecting the services in which sessions need to be maintained. To prevent this problem, run the <b><span class="cmdname">load-balance ecmp stateful enable</span></b> command. This command enables the ECMP load balancing consistency function so that hash calculation is performed only for traffic on the faulty link, without affecting traffic on other normal links.</p>
<p><strong>Prerequisites</strong></p>
<ul><li>When using the ECMP load balancing consistency function, ensure that routes are symmetrically deployed. Multiple equal-cost paths to different destination addresses are either all the same or all different.</li><li>If the hash consistency enhancement command has been run, run the <b><span class="cmdname">undo load-balance ecmp stateful enhanced enable</span></b> command in the system view to disable hash consistency enhancement before canceling load-balance ecmp stateful enable.</li></ul>
<p><strong>Configuration Impact</strong></p>
<p>After enabling the ECMP load balancing consistency function, do not change the configured load balancing hash algorithm, hash algorithm offset, or load balancing mode. Otherwise, this function may be unable to take effect.<p></p>
<span>This function may be unable to take effect when outbound</span> interfaces of equal-cost links are intermittently disconnected.<p></p>
<span>The ECMP load balancing consistency function takes</span> effect only for common IP traffic, but not for traffic transmitted over tunnels.<p></p>
<span>After the ECMP load balancing consistency function</span> is enabled, if the number of next-hop paths is not a power of 2, traffic cannot be evenly load balanced.</p>
<p><strong>Precautions</strong></p>
<div class="p"><ul><li>This command and the <b><span class="cmdname">load-balancing ucmp</span></b> command are mutually exclusive.</li><li>On the CE6863H, CE6863H-K, CE6881H, and CE6881H-K models, this command and the <b><span class="cmdname">local-preference enhanced</span></b> command are mutually exclusive.</li><li>On the CE8851-32CQ8DQ-P, CE8850-HAM, CE8850-SAN, and CE8851K, this command and the <b><span class="cmdname">load-balancing adaptive-routing</span></b> command are mutually exclusive.</li><li>On the CE8851-32CQ8DQ-P, CE8850-HAM, CE8850-SAN, and CE8851K, this command and the <b><span class="cmdname">adaptive-routing enable</span></b> command are mutually exclusive.</li></ul>
</div>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001942841497__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Enable the ECMP load balancing consistency function.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>load-balance ecmp stateful enable</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_PNF-Load_Balancing_Configuration_Commands_title.html">Load Balancing Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/LOAD-BALANCE_ECMP_RAIL-GROUP_ENABLE.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/LOAD-BALANCE_ECMP_STATEFUL_ENHANCED_ENABLE.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>