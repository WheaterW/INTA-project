
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="peer substitute-as (BGP-VPN instance IPv6 address family view)">
<meta name="DC.subject" content="peer substitute-as (BGP-VPN instance IPv6 address family view)">
<meta name="keywords" content="peer substitute-as (BGP-VPN instance IPv6 address family view)">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_BGP_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/VRF-GROUP-SUBSTITUTE-AS(BGPOM).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/VRF6-GROUP-SUBSTITUTE-AS(BGPVPNBASE).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Creator" content="SUBSYS_ID_BGPVPNBASE">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907604928">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>peer substitute-as (BGP-VPN instance IPv6 address family view)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907604928"></a><a name="EN-US_CLIREF_0000001907604928"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">peer substitute-as (BGP-VPN instance IPv6 address family view)</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907604928__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">peer substitute-as</span></b> command substitutes the local AS number for the AS number of a specified peer in the AS_Path attribute in the advertisement direction.</p>
<p>The <b><span class="cmdname">undo peer substitute-as</span></b> command disables AS number substitution.</p>
</p>
<p>By default, AS number substitution is disabled.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907604928__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">peer </span></b><i><span class="varname">ipv4-address</span></i> <strong><span>substitute-as</span></strong></p>

<p><b><span class="cmdname">undo peer </span></b><i><span class="varname">ipv4-address</span></i> <strong><span>substitute-as</span></strong></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907604928__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">ipv4-address</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the IPv4 address of a peer.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>It is in dotted decimal notation.</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907604928__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>BGP-VPN instance IPv6 address family view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907604928__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907604928__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>In an L3VPN scenario, if the ASs where two VPN sites reside use private AS numbers, the AS numbers of the two VPN sites may be the same. If a CE in a VPN site sends a VPN route to the local PE through EBGP and the remote PE sends the route to the remote CE, the remote CE discards the route due to duplicate AS numbers. As a result, different sites in the same VPN cannot communicate with each other. In this case, you need to run the <b><span class="cmdname">peer substitute-as</span></b> command on the PE to enable AS number substitution in the advertisement direction. That is, when advertising the routes learned from the remote PE to its connected CE, the PE replaces the AS number of the VPN site where the CE in the received VPN site resides with the local AS number.<p></p>
<span>In a BGP public network scenario</span>, when two devices with the same AS number learn a BGP route from each other through the same EBGP peer, the route may be discarded because the AS_Path attribute contains duplicate AS numbers. To prevent this problem, run the <b><span class="cmdname">peer substitute-as</span></b> command on this EBGP peer to enable AS number substitution in the advertisement direction.</p>
<p><strong>Prerequisites</strong></p>
<p>Enabling BGP AS number substitution may cause route loops in a CE multi-homing network. The <b><span class="cmdname">peer soo</span></b> command must be run to prevent a routing loop in a VPN site.<p></p>
<span>On BGP public networks</span>, if three or more BGP peers form a ring network, the <b><span class="cmdname">peer substitute-as</span></b> command cannot be run; otherwise, a routing loop may occur.</p>
<p><strong>Precautions</strong></p>
<p>If the <b><span class="cmdname">peer substitute-as</span></b> command is run, the AS number of the route is replaced, which may cause routing loops. To solve this problem, run the <b><span class="cmdname">peer soo</span></b> command to configure the SoO feature.</p>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907604928__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Configure a device to replace the AS number of a specified peer in the AS_Path of a route with the local AS number.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ip vpn-instance vpna</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-vpn-instance-vpna] <strong>ipv6-family</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-vpn-instance-vpna-af-ipv6] <strong>route-distinguisher 100:1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-vpn-instance-vpna-af-ipv6] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-vpn-instance-vpna] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>bgp 100</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp] <strong>vpn-instance vpna</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp-vpna] <strong>peer 10.1.1.1 as-number 200</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp-vpna] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp] <strong>ipv6-family vpn-instance vpna</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp-6-vpna] <strong>peer 10.1.1.1 enable</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp-6-vpna] <strong>peer 10.1.1.1 substitute-as</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_BGP_Configuration_Commands_title.html">BGP Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/VRF-GROUP-SUBSTITUTE-AS(BGPOM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/VRF6-GROUP-SUBSTITUTE-AS(BGPVPNBASE).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>