
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="ip as-path-filter">
<meta name="DC.subject" content="ip as-path-filter">
<meta name="keywords" content="ip as-path-filter">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_IP_Routing_Policy_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/MATCH-TAG(RTPOM).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/BASIC-COMMUNITY-FILTER(RTPOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Routing Policy">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="Routing Policy">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="Routing Policy">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Creator" content="SUBSYS_ID_RTPOM">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907606056">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>ip as-path-filter</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907606056"></a><a name="EN-US_CLIREF_0000001907606056"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">ip as-path-filter</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907606056__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">ip as-path-filter</span></b> command adds an AS_Path filter.</p>
<p>The <b><span class="cmdname">undo ip as-path-filter</span></b> command deletes a specified AS_Path filter.</p>
</p>
<p>By default, no AS_Path filter exists.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907606056__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">ip as-path-filter </span></b>{ <i><span class="varname">as-path-filter-number</span></i> | <i><span class="varname">as-path-filter-name</span></i> } [ <strong><span>index</span></strong> <i><span class="varname">index-number</span></i> ] <i><span class="varname">matchMode</span></i> <i><span class="varname">regular-expression</span></i></p>

<p><b><span class="cmdname">undo ip as-path-filter </span></b>{ <i><span class="varname">as-path-filter-number</span></i> | <i><span class="varname">as-path-filter-name</span></i> } [ <strong><span>index</span></strong> <i><span class="varname">index-number</span></i> ] [ <i><span class="varname">matchMode</span></i> <i><span class="varname">regular-expression</span></i> ]</p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907606056__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">as-path-filter-number</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the number of an AS_Path filter.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 1 to 256.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">as-path-filter-name</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the name of an AS_Path filter.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a string of 1 to 51 case-sensitive characters, spaces not supported. The character string can contain spaces if it is enclosed in double quotation marks (").</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>index</span></strong> <i><span class="varname">index-number</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the sequence number of an AS_Path filter.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 1 to 4294967295.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">matchMode</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Sets the matching mode of the AS_Path filter.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><div class="p"><p>The value is an enumerated type:</p>
<ul><li>deny: Sets the matching mode of the AS_Path filter to deny.</li><li>permit: Sets the matching mode of the AS_Path filter to permit.</li></ul>
</div>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">regular-expression</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the AS_Path regular expression.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a string of 1 to 1024 characters, spaces supported.</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907606056__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>System view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907606056__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907606056__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<div class="p"><p>An AS_Path filter uses the regular expression to define matching rules. After an AS_Path filter is set, the RM module immediately instructs each protocol to apply the filter by default.<p></p>
<span>The AS_Path attribute is a private attribute of BGP</span> and is mainly used to filter BGP routes.</p>

<ul><li>The AS_Path attribute can be directly applied using a command, such as the peer as-path-filter command.</li><li>The AS_Path attribute can be configured as a matching condition for a route-policy using a command, such as the if-match as-path-filter zz command.</li></ul>
</div>
<p><strong>Configuration Impact</strong></p>
<p><p>Multiple rules (in permit or deny mode) can be specified for a filter.</p>
</p>
<p><strong>Follow-up Procedure</strong></p>
<p><p>To view detailed configurations of an AS_Path filter, run the display ip as-path-filter command.</p>
</p>
<p><strong>Precautions</strong></p>
<p><p>The default action of an AS_Path filter is deny. That is, if a route is not permitted in a certain filtering, the route cannot pass the filtering of the AS_Path filter. If all filtering rules in a filter are deny, no route can pass the filter. In this case, you need to set permit after deny for multiple times or one time to allow all the other routes to pass the filter.<p></p>
<span>The AS number in the regular expression of the AS_Path</span> filter must be in the same format as the 4-byte AS number of BGP. Otherwise, the matching fails.<p></p>
<span>Regular expression matching is CPU-intensive processing</span>. When a large number of regular expressions are configured in a policy to match route attributes and the corresponding route attributes are long, the policy processing performance deteriorates. To improve the processing performance of the routing policy, reduce the number of regular expressions or use non-regular expression matching commands.<p></p>
<span>If too many regular expressions are configured</span>, the performance is affected, and even the protocol peer flapping occurs.</p>
</p>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907606056__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Create an AS_Path filter with sequence number 1 to permit the routes with the AS_Path beginning with 10.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ip as-path-filter 1 permit ^10_</strong>
</pre>
</div>

<div class="p"># Create an AS_Path filter with sequence number 3 to deny the routes that contain 30 in the AS path.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ip as-path-filter 3 deny _30_</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>ip as-path-filter 3 permit .*</strong>
</pre>
</div>

<div class="p"># Create an AS_Path filter with sequence number 2 to permit the routes that contain 20 in the AS path.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ip as-path-filter 2 permit _20_</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_IP_Routing_Policy_Configuration_Commands_title.html">Routing Policy Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/MATCH-TAG(RTPOM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/BASIC-COMMUNITY-FILTER(RTPOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>