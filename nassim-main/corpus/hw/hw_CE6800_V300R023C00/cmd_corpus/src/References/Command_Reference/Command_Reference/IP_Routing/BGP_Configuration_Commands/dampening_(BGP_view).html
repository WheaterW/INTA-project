
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="dampening (BGP view)">
<meta name="DC.subject" content="dampening (BGP view)">
<meta name="keywords" content="dampening (BGP view)">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_BGP_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/CONFEDERATION-PEER-AS(BGPOM).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/IPV4-DAMPENING(BGPOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Creator" content="SUBSYS_ID_BGPOM">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907763592">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>dampening (BGP view)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907763592"></a><a name="EN-US_CLIREF_0000001907763592"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">dampening (BGP view)</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907763592__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">dampening</span></b> command enabled route flapping dampening for EBGP peers or modifies route flapping dampening parameters for EBGP peers.</p>
<p>The <b><span class="cmdname">undo dampening</span></b> command cancels the dampening on the flapping of EBGP routes.</p>
<p>The <b><span class="cmdname">dampening ibgp</span></b> command enables IBGP peer route flapping dampening or modifies various IBGP peer route flapping dampening parameters.</p>
<p>The <b><span class="cmdname">undo dampening ibgp</span></b> command canceld the dampening on IBGP route flapping.</p>
</p>
<p>By default, BGP route flapping suppression is disabled.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907763592__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">

<p><b><span class="cmdname">dampening </span></b>[ <i><span class="varname">half-life-reach</span></i> <i><span class="varname">reuse</span></i> <i><span class="varname">suppress</span></i> <i><span class="varname">ceiling</span></i> | <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> ] <sup>*</sup> [ <strong><span>update-standard</span></strong> ]</p>


<p><b><span class="cmdname">dampening ibgp </span></b>[ <i><span class="varname">half-life-reach</span></i> <i><span class="varname">reuse</span></i> <i><span class="varname">suppress</span></i> <i><span class="varname">ceiling</span></i> | <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> ] <sup>*</sup> [ <strong><span>update-standard</span></strong> ]</p>

<p><b><span class="cmdname">undo dampening</span></b></p>

<p><b><span class="cmdname">undo dampening ibgp</span></b></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907763592__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">half-life-reach</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies a half-life for reachable routes.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 1 to 45, in minutes. The default value is 15, in minutes.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">reuse</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies a Reuse value. If the penalty of a route falls below the Reuse value, the route is reused.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 1 to 20000. The default value is 750.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">suppress</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies a Suppress value. If the penalty value of a route exceeds the Suppress value, the route is dampened.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 1 to 20000 and must be greater than the value of reuse. The default value is 2000.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">ceiling</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies a penalty ceiling.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 1001 to 20000. The configured value must be greater than the value of suppress. The default value is 16000.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the name of the route-policy.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is a string of 1 to 200 case-sensitive characters without spaces. The character string can contain spaces if it is enclosed with double quotation marks (").</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>update-standard</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Enables BGP to add a penalty value (500) to the route carried in each received Update message (excluding Withdraw message).</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907763592__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>BGP view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907763592__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907763592__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>If a policy is configured for route dampening, routes are preferentially matched against the dampening parameters defined by route-policy in the command.<p></p>
<span>The four parameters of the command are mutually dependent</span>. If you configure one of the parameters, the other parameters also need to be configured in the command.<p></p>
<span>BGP dampening measures route stability using a penalty</span> value. The greater the penalty value, the less stable a route. Each time route flapping occurs (the device receives a Withdraw), BGP adds a penalty value to the route carried in the message. If a route changes from active to inactive, the penalty value increases by 1000.<p></p>
<span>If the penalty value of a route exceeds the Suppress</span> value, the route is dampened. The device does not add the route to the IP routing table or advertise any Update message to other BGP peers. BGP removes the best flag of the route. If the route is carried in an Update message, BGP adds a d flag to the route; if the route is carried in a Withdraw message, BGP adds an h flag to the route. If a route carries both a d flag and an h flag, the route is considered a deleted one. After the penalty value reaches the penalty ceiling, it does not increase any more.<p></p>
<span>The penalty value of a dampened route reduces by half</span> after a half-life period. If the route is carried in an Update message and its penalty value decreases to the Reuse value, the route becomes reusable, and BGP removes the d flag from it, adds it to the IP routing table if it is an optimal route, and advertises an Update message carrying the route to BGP peers. If the route is carried in a Withdraw message and its penalty value decreases to 0, BGP deletes this route from the BGP routing table.<p></p>
<span>After BGP route dampening is configured</span>, any parameter in the command can be used to dampen flapping routes. You can adjust the parameters as required. To increase the dampening time of flapping routes, perform any of the following operations (to reduce the dampening time, perform otherwise):</p>

<ul><li>Increase ceiling.</li><li>Increase half-life-reach.</li><li>Reduce reuse.</li></ul>
<p><strong>Configuration Impact</strong></p>
<p>If the <b><span class="cmdname">dampening</span></b> command is run more than once, the latest configuration overrides the previous one.<p></p>
<span>After the</span> <b><span class="cmdname">dampening</span></b> command is run, the system dampens unstable routes. Specifically, the system does not add unstable routes to the BGP routing table or advertise them to other BGP peers.</p>
<p><strong>Precautions</strong></p>
<p>When configuring BGP route dampening, pay attention to the following points:</p>

<ul><li>The reuse, suppress, and ceiling thresholds increase in sequence.</li><li>According to the formula MaxSuppressTime=half-life-reachÃ60Ã(ln(ceiling/reuse)/ln(2)), if the value of MaxSuppressTime is less than 1, the dampening cannot be performed. Therefore, to ensure that the value of MaxSuppressTime is greater than or equal to 1, the value of ceiling/reuse must be large enough.<p></p>
<span>If</span> <strong>route-policy</strong> <em>route-policy-name</em>is configured, the following items can be matched: IPv4 ACLs, AS_Path filters, AS_Path length filters, community filters, route costs, VPN-Target extended community filters, bandwidth extended community filters, outbound interfaces, MPLS labels, large-community filters, Next-hop address ACL list of routing information, next-hop address ACL list of IPv6 routing information, next-hop address prefix list of routing information, next-hop address prefix list based on IPv6 routing information, route priority, destination address prefix list of IP routing information, route modulo, route source IP address ACL, route source IPv6 address ACL, route source IP address prefix, route type. Route dampening parameters can be set.<p></p>
<span>If</span> the referenced policy contains unsupported attribute matching or setting behaviors, unexpected results may occur. For some attribute matching behaviors, the device may display warning-level messages.</li></ul>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907763592__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Enable EBGP peer route dampening and configure EBGP peer route dampening parameters.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>bgp 100</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp] <strong>dampening 10 1000 2000 5000</strong>
</pre>
</div>

<div class="p"># Enable IBGP peer route dampening and configure IBGP peer route dampening parameters.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>bgp 100</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp] <strong>dampening ibgp 10 1000 2000 5000</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_BGP_Configuration_Commands_title.html">BGP Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/CONFEDERATION-PEER-AS(BGPOM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/IPV4-DAMPENING(BGPOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>