
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="detect loop-times">
<meta name="DC.subject" content="detect loop-times">
<meta name="keywords" content="detect loop-times">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_VXLAN_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/PROFILEDESC(BDOM).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/DETECT-LOOP-TIMES-CYCLE(EVPNOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="DC.Creator" content="SUBSYS_ID_EVPNOM">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001907606912">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>detect loop-times</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001907606912"></a><a name="EN-US_CLIREF_0000001907606912"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">detect loop-times</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001907606912__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">detect loop-times</span></b> command sets loop detection parameters for MAC duplication suppression.</p>
<p>The <b><span class="cmdname">undo detect loop-times</span></b> command restores the default configuration.</p>
</p>
<p>By default, the loop detection period for MAC duplication suppression is 180s, and the threshold for MAC entry flaps is 5 within a detection period.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001907606912__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">detect loop-times </span></b><i><span class="varname">loop-times</span></i> <strong><span>detect-cycle</span></strong> <i><span class="varname">detect-cycle-time</span></i></p>

<p><b><span class="cmdname">undo detect loop-times detect-cycle</span></b></p>

<p><b><span class="cmdname">undo detect loop-times </span></b><i><span class="varname">loop-times</span></i> <strong><span>detect-cycle</span></strong> <i><span class="varname">detect-cycle-time</span></i></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001907606912__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">loop-times</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the maximum number of times MAC entry flapping is allowed in a detection period.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 3 to 10.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>detect-cycle</span></strong> <i><span class="varname">detect-cycle-time</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies a detection period.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 60 to 900, in seconds. The value must be a multiple of 10.</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001907606912__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>BD-EVPN mac-duplication view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001907606912__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001907606912__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>On an EVPN VXLAN, two PEs may interconnect through both network-side and access-side links. If this is the case, BUM traffic loops and MAC route flapping both occur, preventing devices from working properly. In this case, MAC duplication suppression on the devices works. By default, the system checks the number of times a MAC address entry flaps within a detection period (180s by default). If the number of times a MAC address entry flaps exceeds the upper threshold (5 by default), the system considers MAC route flapping to be occurring on the network and consequently suppresses the flapping MAC routes. The suppressed MAC routes cannot be sent to a remote PE through a BGP EVPN peer relationship. To modify the detection period or the threshold for MAC entry flapping, run the <b><span class="cmdname">detect loop-times</span></b> command.</p>
<p><strong>Configuration Impact</strong></p>
<p>If the <b><span class="cmdname">detect loop-times</span></b> command is run in both EVPN instance view and global EVPN configuration view, the configuration in the EVPN instance view takes precedence.</p>
<p><strong>Precautions</strong></p>
<p>This command takes effect does not take effect for MAC/IP routes but takes effect only for MAC routes.</p>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001907606912__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Configure loop detection parameters for MAC duplication suppression per EVPN instance.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>bridge-domain 1</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-bd1] <strong>evpn</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-bd1-evpn] <strong>mac-duplication</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-bd1-evpn-mac-dup] <strong>detect loop-times 4 detect-cycle 100</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bd1-evpn-mac-dup]
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_VXLAN_Configuration_Commands_title.html">VXLAN Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/PROFILEDESC(BDOM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/DETECT-LOOP-TIMES-CYCLE(EVPNOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>