
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="mac-address flapping">
<meta name="DC.subject" content="mac-address flapping">
<meta name="keywords" content="mac-address flapping">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_MAC_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/SETBDMACADR(MACOM).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/SETMACFLAPEXMAC(MACOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="MAC">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="MAC">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featurename" content="MAC">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Creator" content="SUBSYS_ID_MACOM">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001942840861">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>mac-address flapping</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001942840861"></a><a name="EN-US_CLIREF_0000001942840861"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">mac-address flapping</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001942840861__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">mac-address flapping detection</span></b> command configures global MAC address flapping detection.</p>
<p>The <b><span class="cmdname">undo mac-address flapping detection</span></b> command disables global MAC address flapping detection.</p>
<p>The <b><span class="cmdname">mac-address flapping detection exclude</span></b> command configures a whitelist for MAC address flapping detection.</p>
<p>The <b><span class="cmdname">undo mac-address flapping detection exclude</span></b> command deletes a whitelist for MAC address flapping detection.</p>
<p>The <b><span class="cmdname">mac-address flapping aging-time</span></b> command sets the aging time of flapping MAC addresses.</p>
<p>The <b><span class="cmdname">undo mac-address flapping aging-time</span></b> command restores the default aging time of flapping MAC addresses.</p>
</p>
<p>By default, global MAC address flapping detection is configured, the security level is medium, the VLAN/BD whitelist for MAC address flapping detection is not configured, and the aging time of flapping MAC addresses is 300 seconds.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001942840861__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">


<p>For CE8851-32CQ8DQ-P, CE8850-HAM, CE8850-SAN, CE8851K, CE8855, CE8851-32CQ4BQ, CE6860-SAN, CE6866, CE6860-HAM, CE6866K, CE6820H, CE6820H-K, CE6820S, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6855-48XS8CQ, CE6885, CE6885-T, CE6885-LL (standard forwarding mode), CE6863E-48S8CQ, CE6885-SAN, CE6885-LL (low latency mode): </p>

<p><b><span class="cmdname">mac-address flapping detection </span></b>[ <strong><span>security-level</span></strong> { <strong><span>low</span></strong> | <strong><span>middle</span></strong> | <strong><span>high</span></strong> } | <strong><span>security-threshold</span></strong> <i><span class="varname">flapCnt</span></i> ]</p>

<p><b><span class="cmdname">mac-address flapping detection exclude vlan </span></b>{ { <i><span class="varname">vlan-id1</span></i> } [ <strong><span>to</span></strong> <i><span class="varname">vlan-id2</span></i> ] } &amp;&lt;1-10&gt;</p>

<p><b><span class="cmdname">mac-address flapping aging-time </span></b><i><span class="varname">aging-time</span></i></p>

<p><b><span class="cmdname">undo mac-address flapping detection </span></b>[ <strong><span>security-level</span></strong> { <strong><span>low</span></strong> | <strong><span>middle</span></strong> | <strong><span>high</span></strong> } | <strong><span>security-threshold</span></strong> <i><span class="varname">flapCnt</span></i> ]</p>

<p><b><span class="cmdname">undo mac-address flapping detection exclude vlan </span></b>{ { { <i><span class="varname">vlan-id1</span></i> } [ <strong><span>to</span></strong> <i><span class="varname">vlan-id2</span></i> ] } &amp;&lt;1-10&gt; | <strong><span>all</span></strong> }</p>

<p><b><span class="cmdname">undo mac-address flapping aging-time</span></b></p>

<p>For CE8851-32CQ8DQ-P, CE8850-HAM, CE8850-SAN, CE8851K, CE8855, CE8851-32CQ4BQ, CE6860-SAN, CE6866, CE6860-HAM, CE6866K, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6855-48XS8CQ, CE6885, CE6885-T, CE6885-LL (standard forwarding mode), CE6863E-48S8CQ, CE6885-SAN, CE6885-LL (low latency mode): </p>

<p><b><span class="cmdname">mac-address flapping detection exclude bridge-domain </span></b><i><span class="varname">bd-id1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">bd-id2</span></i> ]</p>

<p><b><span class="cmdname">undo mac-address flapping detection exclude bridge-domain </span></b>{ <i><span class="varname">bd-id1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">bd-id2</span></i> ] | <strong><span>all</span></strong> }</p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001942840861__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>security-level</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Globally enables or disables MAC address flapping detection with a specific security level.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>low</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Sets the security level of MAC address flapping detection to low. That is, the system considers that MAC address flapping occurs after MAC address flapping occurs 500 times.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>middle</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies a middle security level for MAC address flapping detection. Specifically, after MAC addresses change for 10 times, the system considers that MAC address flapping occurs.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>high</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies a high security level for MAC address flapping detection. Specifically, after MAC addresses change for 3 times, the system considers that MAC address flapping occurs.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>security-threshold</span></strong> <i><span class="varname">flapCnt</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the security threshold for MAC address flapping detection. The system considers that MAC address flapping occurs when a MAC address flaps between interfaces for the specified number of times.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 3 to 10000.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">vlan-id1</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the start VLAN ID number in the VLAN whitelist.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p><p>For the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ:The value is an integer ranging from 1 to 4094.</p>
<p>For the CE6885-LL (low latency mode):The value is an integer ranging from 1 to 1023.</p>
</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>to</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the range.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">vlan-id2</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the end VLAN ID in the VLAN whitelist. If vlanEnd is not specified, only the VLAN specified by vlanBgn is displayed in the whitelist.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p><p>For the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ:The value is an integer ranging from 1 to 4094.</p>
<p>For the CE6885-LL (low latency mode):The value is an integer ranging from 1 to 1023.</p>
</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>aging-time</span></strong> <i><span class="varname">aging-time</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specified the aging period of MAC address flapping entries.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 60 to 900 seconds.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>all</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Deletes all VLANs where MAC address flapping detection is performed from the whitelist.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">bd-id1</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the start BD ID in a BD whitelist.</p>
</p>
<p><p>The parameter bridge-domain is supported only on the CE6866, CE6860-HAM, CE6860-SAN, CE6866K, CE6885, CE8851-32CQ4BQ, CE8851-32CQ8DQ-P, CE8855, CE8850-HAM, CE8850-SAN, CE8851K, CE6863H, CE6863H-K, CE6881H and CE6881H-K.</p>
</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE6885-LL (low latency mode), CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p><p>For the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE6885-LL (low latency mode), CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ:The value is an integer ranging from 1 to 16777215.</p>
</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">bd-id2</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the end BD ID in a BD whitelist. If &lt;bd-id2&gt; is not specified, the whitelist contains only the BD specified by &lt;bd-id1&gt;.</p>
</p>
<p><p>The parameter bridge-domain is supported only on the CE6866, CE6860-HAM, CE6860-SAN, CE6866K, CE6885, CE8851-32CQ4BQ, CE8851-32CQ8DQ-P, CE8855, CE8850-HAM, CE8850-SAN, CE8851K, CE6863H, CE6863H-K, CE6881H and CE6881H-K.</p>
</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE6885-LL (low latency mode), CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.</p>
</div></div>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p><p>For the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE6885-LL (low latency mode), CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ:The value is an integer ranging from 1 to 16777215.</p>
</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001942840861__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>System view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001942840861__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001942840861__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<ul><li>MAC address flapping occurs when a MAC address learned by an interface is also learned by another interface in the same broadcast domain. The MAC address entry learned later overwrites the original one. To detect MAC address flapping, run the <b><span class="cmdname">mac-address flapping aging-time</span></b> command to change the aging time of flapping MAC address entries.</li><li>MAC address flapping may be caused by the following reasons:
<ul><li>The network cable of the switching device is incorrectly connected or there is an incorrect configuration, forming a ring network.</li><li>Some unauthorized users launch MAC address attacks on the network.</li></ul>

</li><li>Global MAC address flapping detection can detect MAC address flapping on a device. If MAC address flapping occurs, the device reports a trap to the NMS. You can locate the fault according to the trap information. You can also run the <b><span class="cmdname">display mac-address flapping</span></b> command to view MAC address flapping records.</li><li>By default, the system performs MAC address flapping detection in all broadcast domains on a switching device. In some scenarios, for example, when a switching device is connected to a load balancing server with two network adapters, the MAC address of the server may be learned by two interfaces. In this case, MAC address flapping does not need to be detected. To achieve this, you can run the <b><span class="cmdname">mac-address flapping detection exclude</span></b> command to add the broadcast domain where the server resides to the MAC address flapping detection whitelist so that MAC address flapping detection is not performed in this broadcast domain. After the configuration is complete, MAC address flapping in the broadcast domain is not reported to the NMS or displayed in the MAC address flapping history.</li></ul>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001942840861__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Disable MAC address flapping detection in VLAN 5.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>mac-address flapping detection exclude vlan 5</strong>
</pre>
</div>

<div class="p"># Enable MAC address flapping detection with a middle security level.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>mac-address flapping detection security-level middle</strong>
</pre>
</div>

<div class="p"># Set the security threshold for MAC address flapping detection.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>mac-address flapping detection security-threshold 200</strong>
</pre>
</div>

<div class="p"># Disable MAC address flapping detection in BDs 5 to 10.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>mac-address flapping detection exclude bridge-domain 5 to 10</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_MAC_Configuration_Commands_title.html">MAC Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/SETBDMACADR(MACOM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/SETMACFLAPEXMAC(MACOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>