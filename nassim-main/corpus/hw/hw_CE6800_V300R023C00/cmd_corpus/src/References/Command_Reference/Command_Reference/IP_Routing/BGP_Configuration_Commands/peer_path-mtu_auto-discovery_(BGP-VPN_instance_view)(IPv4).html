
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="peer path-mtu auto-discovery (BGP-VPN instance view)(IPv4)">
<meta name="DC.subject" content="peer path-mtu auto-discovery (BGP-VPN instance view)(IPv4)">
<meta name="keywords" content="peer path-mtu auto-discovery (BGP-VPN instance view)(IPv4)">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/dc_BGP_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/SESSION-GROUP-PATH-MTU-DISCOVERY(BGPOM).html">
<meta name="DC.Relation" scheme="URI" content="../v3r23c00/BGP-MULI-VRF-GROUP-IPV4-PREFER-VALUE(BGPOM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Reference">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Creator" content="SUBSYS_ID_BGPOM">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001942844637">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>peer path-mtu auto-discovery (BGP-VPN instance view)(IPv4)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001942844637"></a><a name="EN-US_CLIREF_0000001942844637"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">peer path-mtu auto-discovery (BGP-VPN instance view)(IPv4)</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001942844637__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">peer path-mtu auto-discovery</span></b> command enables path MTU discovery.</p>
<p>The <b><span class="cmdname">undo peer path-mtu auto-discovery</span></b> command restores the default configuration.</p>
</p>
<p>By default, path MTU discovery is disabled.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001942844637__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">peer </span></b><i><span class="varname">ipv4-address</span></i> <strong><span>path-mtu</span></strong> <strong><span>auto-discovery</span></strong></p>

<p><b><span class="cmdname">undo peer </span></b><i><span class="varname">ipv4-address</span></i> <strong><span>path-mtu</span></strong> <strong><span>auto-discovery</span></strong></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001942844637__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><i><span class="varname">ipv4-address</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies an IPv4 peer address.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is in dotted decimal notation.</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001942844637__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p><span>BGP multi-instance VPN instance session view</span></p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001942844637__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>


<div class="clidesc"><a name="EN-US_CLIREF_0000001942844637__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>When hosts on the same network communicate, the MTU of the network is important to both communication ends. When hosts need to communicate across multiple networks, the smallest MTU on the communication path is most important to both ends. This is because different networks along the communication path have different link-layer MTUs. The minimum MTU on the communication path is called the path MTU.<p></p>
<span>The path MTU has the following characteristics</span>:</p>

<ul><li>Uncertainty: During communication, the path MTU of hosts depends on the selected path and thus may change.</li><li>Inconsistency: The path MTUs in the inbound and outbound directions may be inconsistent because the path from the sender to the receiver may be different from the path from the receiver to the sender.</li></ul>
<p><strong>Configuration Impact</strong></p>
<p>After this command is run, the peer learns the maximum number of bytes of a BGP data message on the transmission path, preventing message fragmentation. In addition, the local device sets the DF bit in the IP header of the message to be sent to the peer to 1.<p></p>
<span>Enabling path MTU auto discovery affects TCP MSS calculation</span>:</p>

<ul><li>When path MTU auto discovery is disabled:
<ol><li>For the sender, the TCP MSS is calculated using the following formula: MSS = MIN { CFGMSS, MTU-40 }.</li><li>For the receiver, if it supports SYN Cookie, the MSS is calculated using the following formula: MSS = MIN { MIN { CFGMSS, MTU-40 } , internally-defined MSS value }. If it does not support SYN Cookie, the MSS is calculated using the following formula: MSS = MIN { CFGMSS, MTU-40 }.</li></ol>

</li><li>After path MTU auto discovery is enabled:
<ol><li>The sender updates the local MSS only when it sends a message with the MSS greater than the path MTU. The TCP MSS is calculated using the following formula: MSS = MIN { MIN { CFGMSS, MTU-40 } , PMTU-40 }.</li><li>For the receiver, if it supports SYN Cookie, the TCP MSS is calculated using the following formula: MSS = MIN { MIN { MIN { CFGMSS, MTU-40 } , internally-defined MSS value } , PMTU-40 }. If it does not support SYN Cookie, the TCP MSS is calculated using the following formula: MSS = MIN { MIN { CFGMSS, MTU-40 } , PMTU-40 }.</li></ol>

</li></ul>

<p>The parameters in the formula are described as follows:</p>

<ul><li>CFGMSS: "MIN { APPMSS, CLICFGMSS}," where APPMSS indicates the MSS value configured using the <b><span class="cmdname">peer tcp-mss</span></b> command. CLICFGMSS specifies the maximum MSS value configured using the <b><span class="cmdname">tcp max-mss</span></b> command.</li><li>MTU-40 indicates the MTU of the interface minus 40.</li><li>PMTU-40 indicates the path MTU minus 40.</li><li>internally-defined MSS value indicates the MSS value, which can be 216, 460, 952, 1400, 2900, 4900, 7900, or 9500. Upon receipt of a message, the receiver uses the MSS value which is smaller than but closest to the MSS of the received message.</li></ul>
<p><strong>Precautions</strong></p>
<p>Enabling the path MTU requires extra costs. If the MTU is known during network planning, you do not need to enable the path MTU.</p>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001942844637__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Configure path MTU discovery for peer 10.1.1.2.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ip vpn-instance vpn1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-vpn-instance-vpn1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>bgp 100</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp] <strong>vpn-instance vpn1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp-instance-vpn1] <strong>peer 10.1.1.2 as-number 200</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-bgp-instance-vpn1] <strong>peer 10.1.1.2 path-mtu auto-discovery</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../v3r23c00/dc_BGP_Configuration_Commands_title.html">BGP Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../v3r23c00/SESSION-GROUP-PATH-MTU-DISCOVERY(BGPOM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../v3r23c00/BGP-MULI-VRF-GROUP-IPV4-PREFER-VALUE(BGPOM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>