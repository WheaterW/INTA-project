default-route-advertise (IS-IS view)
====================================

default-route-advertise (IS-IS view)

Function
--------



The **default-route-advertise** command configures an IS-IS device to generate a default route.

The **undo default-route-advertise** command cancels the default route generated by an IS-IS device.



By default, an IS-IS device does not generate a default route.


Format
------

**default-route-advertise** [ **always** | **match** **default** | { **route-policy** *route-policy-name* } ] [ [ **cost** *cost* ] | [ **tag** *tag* ] | [ **level-1** | **level-2** | **level-1-2** ] ] \* [ **avoid-learning** ]

**undo default-route-advertise**


Parameters
----------

| Parameter | Description | Value |
| --- | --- | --- |
| **always** | Enables an IS-IS device to advertise the default IPv4 route unconditionally. This parameter is specified by default when the default-route-advertise command is run. In this case, if the avoid-learning parameter is not specified, the device is allowed to calculate the IS-IS default routes advertised by other devices, which may cause routing loops. | - |
| **match** | If a default route generated by other routing protocols or other IS-IS processes exists in the routing table, the default route is advertised through an LSP. | - |
| **default** | Indicates that the device advertises the default routes in local LSPs if the device has active default IPv4 routes of other routing protocols or IS-IS processes. The priority of the matched default route must be higher than that of the routes in the IS-IS process on the local device. Otherwise, the IS-IS process on the local device changes the default route on which the IS-IS process depends to inactive after calculating the received default route. | - |
| **route-policy** *route-policy-name* | Specifies the name of a route-policy.   * If the routes that match the route-policy include non-default routes, a default IPv4 route that belongs to a process of another routing protocol, or a default IPv4 route that belongs to another IS-IS process, the device advertises a default route through a local LSP. In this case, if the avoid-learning parameter is not specified, the device is allowed to calculate the IS-IS default routes advertised by other devices, which may cause routing loops. * If only the default IPv4 route in the current local IS-IS process matches the route-policy, the device does not advertise a default route through a local LSP. | The value is a string of 1 to 200 case-sensitive characters without spaces. The character string can contain spaces if it is enclosed with double quotation marks ("). |
| **cost** *cost* | Specifies a cost for the default route. | The value is an integer and its range varies with the cost type.   * When the cost type is narrow, narrow-compatible, or compatible, the value ranges from 0 to 63. * When the cost type is wide or wide-compatible, the value ranges from 0 to 4261412864.   The default value is 0.  The cost type can be configured using the cost-style command. |
| **tag** *tag* | Specifies the tag value of the default route to be advertised. The advertised LSPs contain the administrative tag value only when the IS-IS cost type is wide, wide-compatible, or compatible. | The value is an integer ranging from 1 to 4294967295. The default value is 0. |
| **level-1** | Sets the level as Level-1. | - |
| **level-2** | Sets the level as Level-2.  If no level is specified, the level of the default route is Level-2. | - |
| **level-1-2** | Sets the level as Level-1-2. | - |
| **avoid-learning** | Prevents the specified IS-IS process from adding a learned default IPv4 route to the routing table.   * If the local device has advertised a default route in the specified IS-IS process, the device no longer adds a learned IS-IS default route to the routing table. * If the device has not advertised a default route in the specified IS-IS process, the device can still add a learned IS-IS default route to the routing table even if avoid-learning is specified. | - |



Views
-----

IS-IS view


Default Level
-------------

2: Configuration level


Usage Guidelines
----------------

**Usage Scenario**

In the IS-IS view, the **default-route-advertise** command is valid only for the base topology.When IS-IS and other routing protocols are deployed on a network, you can use either of the following methods to allow traffic within an IS-IS domain to reach a destination outside the IS-IS domain:

* Run the **default-route-advertise** command on a boundary device in the IS-IS domain to advertise default routes to the IS-IS domain.
* Run the **import-route** command on a boundary device to import routes from other routing domains to IS-IS.Using the **default-route-advertise** command to configure the device to advertise default routes is simple and does not need to learn external routes. This mode is applicable to the scenario where there are few border devices and no route selection exists.After the **default-route-advertise** command is run on a border device, all traffic in the IS-IS domain is first forwarded to the border device. Compared with configuring a static default route on each device, this method simplifies operations. That is, the configuration is performed only on a border device. In addition, this command is used to dynamically advertise default routes, which is more flexible. Multiple modes are available for advertising default routes.
* If always is specified, default routes can be advertised unconditionally, but default routes from other devices can still be calculated.If always is configured on multiple devices in the same domain but avoid-learning is not configured, the devices advertise default routes in IS-IS and allow calculation of default IS-IS routes advertised by other devices. This may cause routing loops. You are advised to configure avoid-learning together with always to prevent routing loops.
* After a route-policy is configured using the route-policy route-policy-name command, a boundary device advertises default routes to the IS-IS domain only when its routing table contains external routes that match the route-policy. This prevents a routing blackhole if the device still advertises default routes when it does not have important external routes due to faults, such as link faults.

**Prerequisites**



An IS-IS process has been created using the **isis** command.



**Configuration Impact**

* All traffic destined outside an IS-IS area is forwarded by the device configured with the **default-route-advertise** command. This increases the load on edge devices. Therefore, you are advised to run this command on devices with sufficient load capability.
* If always is configured but avoid-learning is not configured, routing loops may occur or traffic may be forwarded to a device in a centralized manner. Therefore, you are advised to configure avoid-learning together with always.
* When configuring avoid-learning, you are advised to increase the priority of routes of other protocols or IS-IS processes. Otherwise, avoid-learning may not take effect in the following scenarios:
* The device first learns the IS-IS default route advertised by another device. This route has a higher priority. As a result, the routes of other routing protocols or other IS-IS processes become inactive. To resolve this problem, run the **default-route-advertise match default avoid-learning** command. The device then cannot advertise the default route because it does not have active routes of other routing protocols or other IS-IS processes. As a result, the device still adds the learned IS-IS default route to the routing table.
* After the **undo default-route-advertise** command is run, the default route generated by an IS-IS device is deleted, which may interrupt services on the device.

**Precautions**

If always is specified, default routes are advertised unconditionally. In some fault scenarios, route blackholes may occur when the route source is unreachable. Therefore, you are advised to select always or match default based on the networking plan.

* If the **default-route-advertise** command is run on a Level-1 device, the device advertises default routes only to the Level-1 area and does not advertise default routes to the Level-2 area.
* If always is configured, traffic is forwarded to the local device after the uplink fails. To prevent this problem, configure the match default mode.
* If match default is specified, the priority of the dependent default route is higher than that of the IS-IS route. Otherwise, the default route may fail to be advertised or a loop may occur.

Example
-------

# Enable the router to advertise the default Level-2 routes that match the route-policy named policy1 and set their cost to 15.
```
<HUAWEI> system-view
[~HUAWEI] route-policy policy1 permit node 10
[*HUAWEI-route-policy] quit
[*HUAWEI] isis 1
[*HUAWEI-isis-1] default-route-advertise route-policy policy1 cost 15

```