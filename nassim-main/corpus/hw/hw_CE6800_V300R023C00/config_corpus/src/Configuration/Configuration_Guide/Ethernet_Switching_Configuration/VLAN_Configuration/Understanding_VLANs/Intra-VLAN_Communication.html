
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Intra-VLAN Communication">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_vlan_cfg_0003.html">
<meta name="DC.Relation" scheme="URI" content="vrp_vlan_cfg_0007.html">
<meta name="DC.Relation" scheme="URI" content="vrp_vlan_cfg_0009.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featurename" content="QinQ">
<meta name="featurename" content="VLAN">
<meta name="featurename" content="VLAN Mapping">
<meta name="featurename" content="VLAN Pool">
<meta name="featurename" content="Voice VLAN">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001130782652">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Intra-VLAN Communication</title>
</head>
<body><a name="EN-US_CONCEPT_0000001130782652"></a><a name="EN-US_CONCEPT_0000001130782652"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Intra-VLAN Communication</h1>
<div><div class="section"><h4 class="sectiontitle">Intra-VLAN Communication Through a Single Device</h4><p>In <a href="#EN-US_CONCEPT_0000001130782652__fig20927104917120">Figure 1</a>, Host1 and Host2 are connected to DeviceA, belong to VLAN 2, and are located on the same network segment. DeviceA connects to the two hosts using access interfaces.</p>
<div class="fignone" id="EN-US_CONCEPT_0000001130782652__fig20927104917120"><a name="EN-US_CONCEPT_0000001130782652__fig20927104917120"></a><a name="fig20927104917120"></a><span class="figcap"><b>Figure 1 </b>Intra-VLAN communication through a single device</span><br><span><img class="vsd" src="figure/en-us_image_0000001130782690.png"></span></div>
<p></p>
<p>When Host1 sends a packet to Host2, the packet is transmitted as follows (assuming that no forwarding entry is created on DeviceA):</p>
<ol><li>Host1 determines that the destination IP address is on the same network segment as its IP address, and broadcasts an ARP Request packet to obtain the MAC address of Host2. The ARP Request packet carries the all-F destination MAC address and the destination IP address 10.1.1.3 (Host2's IP address).</li><li>When the packet reaches interface 1 on DeviceA, DeviceA determines that the ARP Request packet is untagged and adds a tag with VLAN ID 2 (which is the PVID of interface 1) to the packet. DeviceA then adds the mapping between the source MAC address, VLAN ID, and interface (00e0-fc00-1111, 2, interface 1) to its MAC address table.</li><li>As DeviceA does not find a MAC address entry matching the destination MAC address and VLAN ID of the ARP Request packet, it broadcasts the ARP Request packet to all interfaces that allow VLAN 2 (interface 2 in this example).</li><li>Before sending the ARP Request packet, interface 2 on DeviceA removes the VLAN tag 2 from the packet.</li><li>Host2 receives the ARP Request packet from interface 2 and records the mapping between the MAC address and the IP address of Host1 in its ARP table. Host2 then compares the destination IP address with its own IP address. If they are the same, Host2 sends an ARP Reply packet carrying Host2's MAC address (00e0-fc00-2222) and Host1's IP address (10.1.1.2) as the destination IP address.</li><li>After receiving the ARP Reply packet, interface 2 on DeviceA tags the packet with VLAN ID 2.</li><li>DeviceA adds the mapping between the source MAC address, VLAN ID, and interface (00e0-fc00-2222, 2, interface 2) to its MAC address table, and then searches for an entry in its MAC address table based on the destination MAC address and VLAN ID (00e0-fc00-1111, 2).</li><li>Before sending the ARP Reply packet from interface 1, DeviceA removes the tag with VLAN ID 2 from the packet.</li><li>Host1 receives the ARP Reply packet from interface 1 and records the mapping between the MAC address and the IP address of Host2 in its ARP table.</li></ol>
</div>
<div class="section"><h4 class="sectiontitle">Intra-VLAN Communication Through Multiple Devices</h4><p>In <a href="#EN-US_CONCEPT_0000001130782652__fig38392411792">Figure 2</a>, Host1 and Host2 belong to VLAN 2, are located on the same network segment, and are connected to DeviceA and DeviceB, respectively. DeviceA and DeviceB are connected using a trunk link over which frames tagged with VLAN ID 2 can be identified and transmitted between them.</p>
<p>Users in the same VLAN but on different network segments cannot communicate with each other at Layer 2 through DeviceA and DeviceB. They can communicate with each other at Layer 3 using VLANIF interfaces. This implementation is similar to that described in <a href="vrp_vlan_cfg_0009.html#EN-US_CONCEPT_0000001176742329__section73131523183516">Inter-VLAN Communication Through Multiple Devices Using VLANIF Interfaces</a>.</p>
<div class="fignone" id="EN-US_CONCEPT_0000001130782652__fig38392411792"><a name="EN-US_CONCEPT_0000001130782652__fig38392411792"></a><a name="fig38392411792"></a><span class="figcap"><b>Figure 2 </b>Intra-VLAN communication through multiple devices</span><br><span><img class="vsd" src="figure/en-us_image_0000001176742359.png"></span></div>
<p></p>
<p>When Host1 sends a packet to Host2, the packet is transmitted as follows (assuming that no forwarding entry is created on DeviceA and DeviceB):</p>
<ol><li>Host1 determines that the destination IP address is on the same network segment as its IP address, and broadcasts an ARP Request packet to obtain the MAC address of Host2. The ARP Request packet carries the all-F destination MAC address and destination IP address 10.1.1.3 (Host2's IP address).</li><li>When the packet reaches interface 1 on DeviceA, DeviceA determines that the ARP Request packet is untagged and adds a tag with VLAN ID 2 (which is the PVID of interface 1) to the packet. DeviceA then adds the mapping between the source MAC address, VLAN ID, and interface (00e0-fc00-1111, 2, interface 1) to its MAC address table.</li><li>As DeviceA does not find a MAC address entry matching the destination MAC address and VLAN ID of the ARP Request packet, it broadcasts the ARP Request packet to all interfaces that allow VLAN 2 (interface 2 in this example).</li><li>Interface 2 on DeviceA transparently transmits the ARP Request packet to interface 2 on DeviceB without removing the packet's VLAN tag, as the VLAN ID of the packet is different from the PVID (which is 1 in this example) of interface 2 on DeviceA.</li><li>After receiving the ARP Request packet, interface 2 on DeviceB determines that VLAN 2 is allowed and accepts the packet.</li><li>As DeviceB does not find a MAC address entry matching the destination MAC address and VLAN ID of the ARP Request packet, it broadcasts the ARP Request packet to all interfaces that allow VLAN 2 (interface 1 in this example).</li><li>Before sending the ARP Request packet, interface 1 on DeviceB removes the tag with VLAN ID 2 from the packet.</li><li>Host2 receives the ARP Request packet from interface 1 on DeviceB and records the mapping between the MAC address and IP address of Host1 in its ARP table. Host2 then compares the destination IP address with its own IP address. If they are the same, Host2 sends an ARP Reply packet carrying Host2's MAC address (00e0-fc00-2222) and Host1's IP address (10.1.1.2) as the destination IP address.</li><li>After receiving the ARP Reply packet, interface 1 on DeviceB tags the packet with VLAN ID 2.</li><li>DeviceB transparently transmits the ARP Reply packet of Host2 through interface 2 to interface 2 on DeviceA. This is because interface 2 on DeviceB is a trunk interface and its PVID (which is 1) is different from the VLAN ID of the packet. As a result, interface 2 on DeviceB does not remove the VLAN tag of the packet.</li><li>After receiving the ARP Reply packet, interface 2 on DeviceA determines that VLAN 2 is an allowed VLAN and accepts the packet.</li><li>DeviceA adds the mapping between the source MAC address, VLAN ID, and interface (00e0-fc00-2222, 2, interface 2) to its MAC address table, and then searches for an entry in its MAC address table based on the destination MAC address and VLAN ID (00e0-fc00-1111, 2).</li><li>Before sending the ARP Reply packet from interface 1, DeviceA removes the tag with VLAN ID 2 from the packet.</li><li>Host1 receives the ARP Reply packet from interface 1 and records the mapping between the MAC address and the IP address of Host2 in its ARP table.</li></ol>
<p>In addition to transmitting frames from multiple VLANs, a trunk link can transparently transmit frames without adding or removing VLAN tags of packets.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_vlan_cfg_0003.html">Understanding VLANs
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_vlan_cfg_0007.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_vlan_cfg_0009.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>