
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring a Device to Discard DHCP Messages Whose GIADDR Field Is a Non-0 Value">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../toctopics/en-us_task_0000001563760653.html">
<meta name="DC.Relation" scheme="URI" content="../toctopics/en-us_task_0000001563760661.html">
<meta name="DC.Relation" scheme="URI" content="../toctopics/en-us_task_0000001513160282.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="DHCP Snooping">
<meta name="featurename" content="VLAN">
<meta name="featurename" content="VLAN Mapping">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="DHCP Snooping">
<meta name="featurename" content="VLAN">
<meta name="featurename" content="VLAN Mapping">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="DHCP Snooping">
<meta name="featurename" content="VLAN">
<meta name="featurename" content="VLAN Mapping">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001512681130">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring a Device to Discard DHCP Messages Whose GIADDR Field Is a Non-0 Value</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001512681130"></a><a name="EN-US_TASK_0000001512681130"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring a Device to Discard DHCP Messages Whose GIADDR Field Is a Non-0 Value</h1>
<div class="taskbody"><p></p>
<div class="context"><a name="EN-US_TASK_0000001512681130__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>The GIADDR (gateway IP address) field in a DHCP message records the IP address of the first DHCP relay agent through which the message passes. If the DHCP server and client are on different network segments, the first DHCP relay agent fills its own IP address in the GIADDR field before forwarding the message to the DHCP server. After receiving the message, the DHCP server determines the network segment where the client resides based on this field, selects a proper address pool, and allocates an IP address in this network segment to the client.</p>
<p>As shown in <a href="#EN-US_TASK_0000001512681130__fig296114171592">Figure 1</a>, to ensure that a device can obtain parameters such as the user MAC address when generating DHCP snooping binding entries, DHCP snooping needs to be applied to the access device on the Layer 2 network or the first DHCP relay agent (for example, DHCP relay agent A in the figure). Therefore, the value of the GIADDR field in a DHCP message received by the DHCP snooping-enabled device must be 0. Otherwise, the device considers the message invalid and discards it. This function is recommended if DHCP snooping is enabled on the DHCP relay agent.</p>
<p>Usually, the GIADDR field value in a DHCP message sent by a client is 0. If the value is not 0, the DHCP server may allocate an incorrect IP address. To prevent the client from forging a DHCP message whose GIADDR field is a non-0 value to apply for an IP address, you are advised to configure this function.</p>
<div class="fignone" id="EN-US_TASK_0000001512681130__fig296114171592"><a name="EN-US_TASK_0000001512681130__fig296114171592"></a><a name="fig296114171592"></a><span class="figcap"><b>Figure 1 </b>DHCP message processing when multiple DHCP relay agents exist (DHCPREQUEST messages are used as an example)</span><br><span><img class="vsd" src="../images/en-us_image_0000001564120421.png"></span></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001512681130__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enable the device to check whether the GIADDR field value in a DHCPREQUEST message is not 0.</span><p><ul><li>In the system view, enable the device to check whether the GIADDR field value in a DHCPREQUEST message is not 0.<pre class="screen"><a href="cmdqueryname=dhcp+snooping+check+dhcp-giaddr+enable"><b><span class="cmdname">dhcp snooping check dhcp-giaddr enable</span></b></a> <strong><span>vlan</span></strong> { <i><span class="varname">vlan-id1</span></i> [ <a href="cmdqueryname=to"><b><span class="cmdname">to</span></b></a> <i><span class="varname">vlan-id2</span></i> ] } &amp;&lt;1-10&gt;</pre>
</li><li>In the interface view, enable the device to check whether the GIADDR field value in a DHCPREQUEST message is not 0.<pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i>
<strong>portswitch</strong>
<a href="cmdqueryname=dhcp+snooping+check+dhcp-giaddr+enable"><b><span class="cmdname">dhcp snooping check dhcp-giaddr enable</span></b></a>
<a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</li><li>In the VLAN view, enable the device to check whether the GIADDR field value in a DHCPREQUEST message is not 0.<pre class="screen"><a href="cmdqueryname=vlan"><b><span class="cmdname">vlan</span></b></a> <i><span class="varname">vlan-id</span></i>
<a href="cmdqueryname=dhcp+snooping+check+dhcp-giaddr+enable"><b><span class="cmdname">dhcp snooping check dhcp-giaddr enable</span></b></a>
<a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</li></ul>
<p>By default, a device does not check whether the GIADDR field value in a DHCPREQUEST message is not 0.</p>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001512681130__en-us_task_0228023023_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001512681130__en-us_task_0228023023_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../toctopics/en-us_task_0000001563760653.html">Configuring Basic DHCP Snooping Functions
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../toctopics/en-us_task_0000001563760661.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../toctopics/en-us_task_0000001513160282.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>