
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring MAC Address Flapping Prevention">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_mac_cfg_0030.html">
<meta name="DC.Relation" scheme="URI" content="vrp_mac_cfg_0033.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="MAC">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MAC">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featurename" content="MAC">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001884597729">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring MAC Address Flapping Prevention</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001884597729"></a><a name="EN-US_TASK_0000001884597729"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring MAC Address Flapping Prevention</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001884597729__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0000001884597729__fig881552172510">Figure 1</a>, users need to access an enterprise server connected to an interface of a device. If an unauthorized user uses the MAC address of the server to send packets to another interface of the device, that interface learns the MAC address of the server. Then, packets sent from users to the server are forwarded to the unauthorized user. As a result, users cannot access the server, and important data may be intercepted by the unauthorized user. MAC address flapping prevention can be configured to improve server security and prevent attacks from unauthorized users.</p>
<div class="fignone" id="EN-US_TASK_0000001884597729__fig881552172510"><a name="EN-US_TASK_0000001884597729__fig881552172510"></a><a name="fig881552172510"></a><span class="figcap"><b>Figure 1 </b>Networking for configuring MAC address flapping prevention</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1 and interface 2 represent <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span>, respectively.</p>
</div></div>
<br><span><img src="figure/en-us_image_0000001924169041.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001884597729__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Create a VLAN and add interfaces to the VLAN to implement Layer 2 forwarding.</p>
</li><li><p>Configure MAC address flapping prevention on the interface connected to the server.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001884597729__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>On DeviceA, create a VLAN and add interfaces to the VLAN.</span><p><p># Add <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span> to VLAN 10.</p>
</p><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;  <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> vlan batch 10</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span><span>1/0/2</span></span>] <strong>portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span><span>1/0/2</span></span>] <strong>port link-type trunk</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span><span>1/0/2</span></span>] <strong>port trunk allow-pass vlan 10 </strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span><span>1/0/2</span></span>] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface <span>100ge</span>int </strong><strong><span>1/0/1</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span><span>1/0/2</span></span>] <strong>portswitch</strong>
<span>[<span class="keyword">*</span>DeviceA-<span>100GE</span><span><span>1/0/1</span></span>] <strong>port link-type hybrid</strong></span>
<span>[<span class="keyword">*</span>DeviceA-<span>100GE</span><span><span>1/0/1</span></span>] <strong>port hybrid pvid vlan 10</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>port hybrid untagged vlan 10</strong></span>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>commit</strong></pre>
</p></li><li><span># Configure MAC address flapping prevention on <span>100GE</span> <span>1/0/1</span>.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>mac-address learning priority 2</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>undo mac-address learning priority 2 allow-flapping</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001884597729__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Run the <strong>display current-configuration</strong> command in any view to check whether the MAC address learning priority of the interface is correct.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]  <strong>display current-configuration interface</strong> <strong><span>100ge</span> <span>1/0/1</span></strong>
#
interface <span>100GE</span><span>1/0/1</span>
<span> port link-type hybrid</span>
<span> port hybrid pvid vlan 10  </span>
<span> port hybrid untagged vlan 10</span>
 mac-address learning priority 2
#
return</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001884597729__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Configuration Scripts</h4><pre class="screen">#
sysname DeviceA
#
vlan batch 10
undo mac-address learning priority 2 allow-flapping
#
interface <span>100GE</span><span>1/0/1</span>
<span> port link-type hybrid</span>
<span> port hybrid pvid vlan 10  </span>
<span> port hybrid untagged vlan 10</span>
 mac-address learning priority 2
#
interface <span><span>100GE</span><span>1/0/2</span></span>
 port link-type trunk
 port trunk allow-pass vlan 10
#
return</pre>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_mac_cfg_0030.html">Configuring MAC Address Flapping Prevention and Detection
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_mac_cfg_0033.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>