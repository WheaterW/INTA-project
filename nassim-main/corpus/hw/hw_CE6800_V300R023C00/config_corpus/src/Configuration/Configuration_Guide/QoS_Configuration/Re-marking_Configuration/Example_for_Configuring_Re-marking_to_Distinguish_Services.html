
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Re-marking to Distinguish Services">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_qos_remark_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_qos_remark_cfg_0007.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Re-marking">
<meta name="featuretype" content="QoS">
<meta name="featuretype" content="QoS">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000002010277493">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Re-marking to Distinguish Services</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000002010277493"></a><a name="EN-US_TASK_0000002010277493"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Re-marking to Distinguish Services</h1>
<div class="taskbody"><p></p>
<div class="context"><a name="EN-US_TASK_0000002010277493__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0000002010277493__fig_dc_cfg_qos_006101">Figure 1</a>, voice, video, and data terminals on the LAN of an enterprise are connected to interface 1 and interface 2 of <span class="keyword">Device</span>C through <span class="keyword">Device</span>A and <span class="keyword">Device</span>B, and are connected to the WAN through <span class="keyword">Device</span>C and <span class="keyword">Device</span>D.</p>
<p>Packets of different services are identified by 802.1p priorities on the LAN side. When packets reach the WAN side through interface 3, it is required that differentiated services be provided based on DSCP priorities of packets.</p>
<div class="fignone" id="EN-US_TASK_0000002010277493__fig_dc_cfg_qos_006101"><a name="EN-US_TASK_0000002010277493__fig_dc_cfg_qos_006101"></a><a name="fig_dc_cfg_qos_006101"></a><span class="figcap"><b>Figure 1 </b>Network diagram for configuring re-marking</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, and <span>100GE</span> <span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img src="figure/en-us_image_0000002010328769.png"></span></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000002010277493__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Set the device name to DeviceC.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">DeviceC</span></strong>
[*<span class="keyword">HUAWEI</span>] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li><li><span>Configure traffic classifiers.</span><p><p># On <span class="keyword">Device</span>C, create and configure traffic classifiers <strong>c1</strong>, <strong>c2</strong>, and <strong>c3</strong> to classify packets based on 802.1p priorities.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceC] <strong>traffic classifier c1</strong>
[*DeviceC-classifier-c1] <strong>if-match 8021p 2</strong>
[*DeviceC-classifier-c1] <strong>quit</strong>
[*DeviceC] <strong>traffic classifier c2</strong>
[*DeviceC-classifier-c2] <strong>if-match 8021p 5</strong>
[*DeviceC-classifier-c2] <strong>quit</strong>
[*DeviceC] <strong>traffic classifier c3</strong>
[*DeviceC-classifier-c3] <strong>if-match 8021p 6</strong>
[*DeviceC-classifier-c3] <strong>quit</strong>
[*DeviceC] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li><li><span>Configure traffic behaviors.</span><p><p># On <span class="keyword">Device</span>C, create and configure traffic behaviors <strong>b1</strong>, <strong>b2</strong>, and <strong>b3</strong> to re-mark priorities of user packets.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceC] <strong>traffic behavior b1</strong>
[*DeviceC-behavior-b1] <strong>remark </strong><strong>dscp 15</strong>
[*DeviceC-behavior-b1] <strong>quit</strong>
[*DeviceC] <strong>traffic behavior b2</strong>
[*DeviceC-behavior-b2] <strong>remark dscp 40</strong>
[*DeviceC-behavior-b2] <strong>quit</strong>
[*DeviceC] <strong>traffic behavior b3</strong>
[*DeviceC-behavior-b3] <strong>remark dscp 50</strong>
[*DeviceC-behavior-b3] <strong>quit</strong>
[*DeviceC] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li><li><span>Configure a traffic policy and apply it to interfaces.</span><p><p># On <span class="keyword">Device</span>C, create a traffic policy <strong>p1</strong>, bind traffic classifiers to traffic behaviors in the traffic policy, and apply the traffic policy to the inbound direction of interface 1 and interface 2 to re-mark packets.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceC] <strong>traffic policy p1</strong>
[*DeviceC-trafficpolicy-p1] <strong>classifier c1 behavior b1</strong>
[*DeviceC-trafficpolicy-p1] <strong>classifier c2 behavior b2</strong>
[*DeviceC-trafficpolicy-p1] <strong>classifier c3 behavior b3</strong>
[*DeviceC-trafficpolicy-p1] <strong>quit</strong>
[*DeviceC] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[*DeviceC-<span>100GE</span><span>1/0/1</span>] <strong>traffic-policy p1 inbound</strong>
[*DeviceC-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[*DeviceC] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[*DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>traffic-policy p1 inbound</strong>
[*DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[*DeviceC] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000002010277493__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Check the traffic classifier configuration.</p>
<pre class="screen">&lt;<span class="keyword">DeviceC</span>&gt; <strong>display traffic classifier</strong>
  Traffic Classifier Information:
    Classifier: c1
      Type: OR
     <strong> Rule(s):</strong>
        <strong>if-match 8021p 2</strong>

    Classifier: c2
      Type: OR
      <strong>Rule(s):</strong>
        <strong>if-match 8021p 5</strong>

    Classifier: c3
      Type: OR
      <strong>Rule(s):</strong>
        <strong>if-match 8021p 6</strong>

Total classifier number is 3 </pre>
<p># Check the traffic policy configuration.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>C&gt; <strong>display traffic policy</strong>
  Traffic Policy Information: 
    Policy: p1                                                                  
      Classifier: c1                                                           
        Type: OR                                                                
      Behavior: b1                                                             
        Remark:                                                                 
          Remark dscp 15                                                        

      Classifier: c2                                                           
        Type: OR                                                                
      Behavior: b2                                                             
        Remark:                                                                 
          Remark dscp cs5                                                       

      Classifier: c3                                                           
        Type: OR                                                                
      Behavior: b3                                                             
        Remark:                                                                 
          Remark dscp 50              

Total policy number is 3</pre>
<p># Check the traffic policy application records.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>C&gt; <strong>display traffic-policy applied-record</strong>
Total records : 2 
--------------------------------------------------------------------------------     
Policy Type/Name                Apply Parameter                 Slot   State          
--------------------------------------------------------------------------------            
p1                               <span>100GE</span><span>1/0/1</span>(IN)                  slot_1     success  

                                 <span>100GE</span><span>1/0/2</span>(IN)                  slot_1     success 
--------------------------------------------------------------------------------  </pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000002010277493__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Configuration Scripts</h4><p><span class="keyword">Device</span>C</p>
<pre class="screen">#
sysname <span class="keyword">DeviceC</span>
#                                                                               
traffic classifier c1 type or                                                  
 if-match 8021p 2                                                               
#                                                                               
traffic classifier c2 type or                                                  
 if-match 8021p 5                                                               
#                                                                               
traffic classifier c3 type or                                                  
 if-match 8021p 6 
#                                                                               
traffic behavior b1                                                            
 remark dscp 15                                                                 
#                                                                               
traffic behavior b2                                                            
 remark dscp cs5                                                                
#                                                                               
traffic behavior b3                                                            
 remark dscp 50 
#                                                                               
traffic policy p1                                                               
 classifier c1 behavior b1 precedence 5                                       
 classifier c2 behavior b2 precedence 10                                      
 classifier c3 behavior b3 precedence 15
#                                                                               
interface <span>100GE</span><span>1/0/1</span>      
 traffic-policy p1 inbound                                                      
#                                                                               
interface <span>100GE</span><span>1/0/2</span> 
 traffic-policy p1 inbound 
#
return</pre>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_qos_remark_cfg_0001.html">Re-marking Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_qos_remark_cfg_0007.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>