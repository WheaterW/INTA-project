
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring EVPN ORF">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/dc_vrp_vxlan_cfg_1250.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/dc_vrp_vxlan_cfg_1251.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001550321953">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Configuring EVPN ORF</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001550321953"></a><a name="EN-US_TASK_0000001550321953"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring EVPN ORF</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001550321953__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>The growing number of services run over an EVPN has triggered a proliferation of new users. As a result, BGP-EVPN peers on an EVPN are sending vast quantities of EVPN routes to each other. Even if the remote peer does not have an RT-matching EVPN instance, the local PE still sends EVPN routes to it. To reduce the pressure on the network, each PE needs to receive only desired routes. However, configuring a separate export route-policy for each user drives up O&amp;M costs significantly. To address this issue, configure EVPN outbound route filtering (ORF) on the network.</p>
<p>After EVPN ORF is configured, each PE on the EVPN sends the IRT and original AS number of locally desired routes to the other PEs that function as EVPN peers or BGP EVPN RRs. Upon receipt of such information, which is sent through ORF routes, the peers construct export route-policies based on these routes. This ensures that the local PE receives only the desired routes, thereby reducing pressure on the PE.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001550321953__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the BGP view.</span><p><pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></pre>
</p></li><li><span>Enter the BGP-VPN-target address family view.</span><p><pre class="screen"><a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a> <strong><span>vpn-target</span></strong></pre>
</p></li><li><span>Enable the function of exchanging ORF routes with a specified peer or peer group.</span><p><pre class="screen"><a href="cmdqueryname=peer+enable"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">group-name</span></i> | <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">ipv6-address</span></i> }  <strong><span>enable</span></strong></pre>
</p></li><li><span>(Optional) Enable the RR function on the current device and configure the peer or peer group as the RR client.</span><p><pre class="screen"><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">group-name</span></i> | <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">ipv6-address</span></i> } <strong><span>reflect-client</span></strong></pre>
<p>On an EVPN where an RR is deployed, you also need to perform this step in the BGP-VPN-target address family view of the RR to enable the RR function for the address family.</p>
</p></li><li><span>Exit the BGP-VPN-target address family view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li><span>Enter the BGP-EVPN address family view.</span><p><pre class="screen"><a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname">l2vpn-family evpn</span></b></a></pre>
</p></li><li><span>Enable EVPN ORF.</span><p><pre class="screen"><a href="cmdqueryname=vpn-orf+enable"><b><span class="cmdname">vpn-orf enable</span></b></a></pre>
</p></li><li><span>(Optional) Disable EVPN ORF for a specified BGP EVPN peer or peer group.</span><p><pre class="screen"><a href="cmdqueryname=peer+vpn-orf+disable"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">group-name</span></i> | <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">ipv6-address</span></i> } <strong><span>vpn-orf disable</span></strong></pre>
</p><p><p>On a network where both EVPN and L3VPN services are deployed, if a PE runs an earlier version and does not support EVPN ORF, this PE cannot exchange EVPN routes with the RRs after BGP-VPN-target peer relationships are established and EVPN ORF is enabled on other PEs and RRs. As a result, EVPN services cannot run properly. To ensure that EVPN services can run properly, run the <a href="cmdqueryname=peer+vpn-orf+disable"><b><span class="cmdname">peer vpn-orf disable</span></b></a> command. This command disables the RR from filtering IRT-related routes for the PE so that the PE can send and receive EVPN routes as expected.</p>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001550321953__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001550321953__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001550321953__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+bgp+vpn-target+routing-table"><b><span class="cmdname">display bgp vpn-target routing-table</span></b></a> command. The command output shows information about routes in the BGP-VPN-target address family.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/dc_vrp_vxlan_cfg_1250.html">Configuring EVPN ORF
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/dc_vrp_vxlan_cfg_1251.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>