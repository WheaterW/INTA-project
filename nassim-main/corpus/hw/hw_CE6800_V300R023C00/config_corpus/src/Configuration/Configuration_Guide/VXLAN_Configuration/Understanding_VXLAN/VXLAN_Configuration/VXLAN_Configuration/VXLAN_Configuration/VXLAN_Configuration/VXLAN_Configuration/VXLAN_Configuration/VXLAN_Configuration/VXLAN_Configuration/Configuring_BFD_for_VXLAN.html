
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring BFD for VXLAN">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../toctopics/en-us_topic_0000001130784304.html">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_cfg_vxlan_0010_new.html">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_vrp_vxlan_cfg_1206.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176664051">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Configuring BFD for VXLAN</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176664051"></a><a name="EN-US_TASK_0000001176664051"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring BFD for VXLAN</h1>
<div class="taskbody"><div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001176664051__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><div class="p">Before configuring BFD for VXLAN, you have completed one of the following tasks:<ul><li><a href="dc_vrp_vxlan_cfg_1039.html">Establishing VXLAN Tunnels in Static Mode (Centralized VXLAN Gateway)</a></li><li><a href="dc_vrp_vxlan_cfg_1072.html">Establishing VXLAN Tunnels in BGP EVPN Mode (Centralized VXLAN Gateway)</a></li><li><a href="dc_vrp_vxlan_cfg_1066.html">Establishing VXLAN Tunnels in BGP EVPN Mode (Distributed VXLAN Gateway)</a></li></ul>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176664051__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>BFD for VXLAN enables a network to quickly detect a primary tunnel fault and switch traffic to a backup tunnel. This ensures normal traffic forwarding and improves network reliability. To implement BFD for a VXLAN tunnel, configure a BFD session for the VXLAN tunnel.</p>
<p><strong>Application Scenarios</strong></p>
<p>BFD for VXLAN uses BFD to detect the connectivity of VXLAN tunnels. It implements VXLAN tunnel switching and improves the reliability of services transmitted over VXLAN tunnels.</p>
<p>BFD for VXLAN is typically used when VXLAN gateways interwork with VM simulation devices, as shown in <a href="#EN-US_TASK_0000001176664051__fig116441245164714">Figure 1</a>. On a network where no VM simulation device is deployed, if service traffic of VM3 needs to be forwarded to VM1 and VM2, Device3 directly forwards unicast service traffic to Device1 or Device2. For BUM traffic, Device3 uses ingress replication for multiple traffic copies and sends them to Device1 and Device2. If there are many VMs, ingress replication wastes a lot of resources. To reduce network pressure, deploy the VM simulation device. The VM simulation device uses replicator nodes to perform centralized replication of BUM packets. In this case, each VTEP encapsulates a BUM packet into the replicator tunnel and sends it only to the replicator, which then sends the packet to other VTEPs (except the source VTEP). Replicators can be deployed in clusters (consisting of multiple replicator nodes) to improve network reliability.</p>
<div class="fignone" id="EN-US_TASK_0000001176664051__fig116441245164714"><a name="EN-US_TASK_0000001176664051__fig116441245164714"></a><a name="fig116441245164714"></a><span class="figcap"><b>Figure 1 </b>BFD for VXLAN</span><br><span><img class="vsd" src="figure/en-us_image_0000001130624548.png"></span></div>
<p><strong>Fundamentals</strong></p>
<p><a href="#EN-US_TASK_0000001176664051__fig_dc_vrp_feature_vxlan_105002">Figure 2</a> shows the format of a BFD for VXLAN packet.</p>
<div class="fignone" id="EN-US_TASK_0000001176664051__fig_dc_vrp_feature_vxlan_105002"><a name="EN-US_TASK_0000001176664051__fig_dc_vrp_feature_vxlan_105002"></a><a name="fig_dc_vrp_feature_vxlan_105002"></a><span class="figcap"><b>Figure 2 </b>Format of a BFD for VXLAN packet</span><br><span><img class="vsd" src="figure/en-us_image_0000001130784342.png"></span></div>
<div class="p">The BFD for VXLAN packet forwarding process is as follows:<ul><li>A VTEP establishes multiple VXLAN tunnels, one for each replicator, which back each other up. Only one of them is used to forward BUM traffic. Therefore, the replicator that receives a BUM packet replicates and forwards it to the other replicators.</li><li>A BFD for VXLAN session is deployed between a VXLAN gateway and a replicator cluster to detect the tunnel connectivity between them. If one tunnel fails, traffic is automatically switched to a backup link for forwarding.</li></ul>
Assume that a centralized VXLAN replication group on Device3 has two VXLAN tunnels.</div>
<ol><li><p>The destination VTEPs are Replicator1 and Replicator2 for the two VXLAN tunnels in the centralized replication group on Device3. The tunnel between Device3 and Replicator1 is the primary VXLAN tunnel.</p>
</li><li><p>Device3 forwards a BUM packet received from VM3 to the primary VXLAN tunnel between Device3 and Replicator1.</p>
</li><li><p>BFD for VXLAN monitors the primary VXLAN tunnel.</p>
</li><li><p>If the VXLAN tunnel between Device3 and Replicator1 fails, Device3 detects the fault through BFD, performs fast traffic switching, and selects the backup tunnel. BUM traffic on Device3 is then forwarded through the tunnel between Device3 and Replicator2, ensuring reliable traffic forwarding.</p>
</li></ol>
<p>The following procedure uses Device3 to describe how to configure BFD for VXLAN.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176664051__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enable BFD globally.</span><p><pre class="screen"><a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a></pre>
<p>By default, BFD is not enabled globally.</p>
</p></li><li><span>Return to the system view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li><span>Create a BFD for VXLAN session and enter the session view.</span><p><pre class="screen"><a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a> <i><span class="varname">session-name</span></i> <strong><span>bind vxlan</span></strong> <strong><span>peer-ip</span></strong> <i><span class="varname">peer-ip-address</span></i> <strong><span>source-ip</span></strong> <i><span class="varname">source-ip-address</span></i> <strong><span>peer-mac</span></strong> <i><span class="varname">peer-mac-address</span></i> <strong><span>auto</span></strong></pre>
<p>By default, no BFD for VXLAN session is created.</p>
</p></li><li><span>(Optional) Configure the interval at which BFD packets are sent.</span><p><pre class="screen"><a href="cmdqueryname=min-tx-interval"><b><span class="cmdname">min-tx-interval</span></b></a> <i><span class="varname">tx-interval</span></i></pre>
<p>The default interval is 1000 milliseconds.</p>
</p></li><li><span>(Optional) Configure the interval at which BFD packets are received.</span><p><pre class="screen"><a href="cmdqueryname=min-rx-interval"><b><span class="cmdname">min-rx-interval</span></b></a> <i><span class="varname">rx-interval</span></i></pre>
<p>The default interval is 1000 milliseconds.</p>
</p></li><li><span>(Optional) Configure a local detection multiplier.</span><p><pre class="screen"><a href="cmdqueryname=detect-multiplier"><b><span class="cmdname">detect-multiplier</span></b></a> <i><span class="varname">multiplier</span></i></pre>
<p>By default, the local detection multiplier is 3.</p>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001176664051__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001176664051__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001176664051__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+bfd+session+all"><b><span class="cmdname">display bfd session all</span></b></a> command to check BFD session information.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../toctopics/en-us_topic_0000001130784304.html">VXLAN Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../dc/dc_cfg_vxlan_0010_new.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../dc/dc_vrp_vxlan_cfg_1206.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>