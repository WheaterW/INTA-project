
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Antilocking PFC (CE6885-SAN)">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_antilocking_pfc_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_antilocking_pfc_cfg_0006.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Antilocking PFC">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Antilocking PFC">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001609400202">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Antilocking PFC (CE6885-SAN)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001609400202"></a><a name="EN-US_TASK_0000001609400202"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Antilocking PFC (<span>CE6885-SAN</span>)</h1>
<div class="taskbody"><p></p>
<div class="context"><a name="EN-US_TASK_0000001609400202__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In the following figure, a lossless service is deployed on data center servers in a DCI scenario. The physical distance between DeviceA and DeviceB (ingress devices for DCI) is 90 km (a relatively long distance), which may cause packet loss in the lossless service. To provide sufficient buffer space for queues that carry the lossless service and make full use of the buffer space, you can enable distance-based headroom buffer check and antilocking PFC on DeviceA and DeviceB.</p>
<div class="fignone"><span class="figcap"><b>Figure 1 </b>Network diagram of antilocking PFC in a DCI scenario</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 represents <span>100GE</span><span>1/0/1</span>.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001658360061.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001609400202__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure the distance-based headroom buffer check function.</span><p><p># Configure DeviceA. Because the distance between DeviceA and DeviceB is 90 km, set the long-distance mode of the interface on DeviceA to <strong><span>level-100</span></strong> and enable the distance-based headroom buffer check function.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[*<span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>long-distance mode level-100</strong>
[<span class="keyword">*DeviceA</span>-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[*DeviceA] <strong>commit</strong></pre>
<p># Configure DeviceB. Specifically, set the long-distance mode of the interface on DeviceB to <strong><span>level-100</span></strong> and enable the distance-based headroom buffer check function.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <strong>sysname DeviceB</strong>
[*<span class="keyword">HUAWEI</span>] <strong>commit</strong>
&lt;DeviceB&gt; <strong>system-view</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceB] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>long-distance mode level-100</strong>
[<span class="keyword">*DeviceB</span>-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[*DeviceB] <strong>commit</strong></pre>
<p># When the distance-based headroom buffer check function is enabled on DeviceA but not enabled on DeviceB, the detection fails. In this case, you need to trigger the interface on DeviceA to send a detection packet.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>start long-distance detect</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font>DeviceA</span>-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong></pre>
</p></li><li><span>Configure antilocking PFC.</span><p><p># In this example, queue 3 is used to carry the lossless service, so specify priority queue 3 in the antilocking PFC profile and apply the profile to the interface of DeviceA to enable antilocking PFC. The configurations on DeviceB are similar to those on DeviceA.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>abs-pfc profile myabspfc</strong>
[*DeviceA-abs-pfc-myabspfc] <strong>priority</strong> <strong>3</strong>
[*DeviceA-abs-pfc-myabspfc] <strong>quit</strong>
[*DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>abs-pfc enable</strong> <strong>myabspfc</strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[*DeviceA] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001609400202__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Display the configuration and status of antilocking PFC on DeviceA.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>display abs-pfc status interface <span>100ge</span> <span>1/0/1</span></strong>
-----------------------------------------------------------------------------------------------
Interface         Queue         Status         RTT(us)        Threshold(KB)         Speed(Gbps)
-----------------------------------------------------------------------------------------------
<span>100GE</span><span>1/0/1</span>            3         Enable             397                    0                 100
-----------------------------------------------------------------------------------------------</pre>
<p># Display the statistics about antilocking PFC on DeviceA.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>display abs-pfc interface <span>100ge</span> <span>1/0/1</span></strong> 
-----------------------------------------------------------------------------------------
Interface         Queue         Received(Frames)        ReceivedRate(pps)     DeadlockNum
                             Transmitted(Frames)     TransmittedRate(pps)     RecoveryNum
-----------------------------------------------------------------------------------------
<span>100GE</span><span>1/0/1</span>            3                118789880                    43517               0
                                               0                        0               0
-----------------------------------------------------------------------------------------</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001609400202__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Configuration Scripts</h4><p>DeviceA</p>
<pre class="screen">#
sysname <span class="keyword">DeviceA</span>
#
interface <span><span>100GE</span><span>1/0/1</span></span>
 long-distance mode level-100
<strong> </strong>abs-pfc enable myabspfc
#
abs-pfc profile myabspfc 
<strong> </strong>priority 3
#
return</pre>
<p>DeviceB</p>
<pre class="screen">#
sysname <span class="keyword">DeviceA</span>
#
interface <span><span>100GE</span><span>1/0/1</span></span>
 long-distance mode level-100
<strong> </strong>abs-pfc enable myabspfc
#
abs-pfc profile myabspfc 
<strong> </strong>priority 3
#
return</pre>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_antilocking_pfc_cfg_0001.html">Antilocking PFC Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_antilocking_pfc_cfg_0006.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>