
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring IPv4 Static Route Creation-triggered Learning of next-hop-specific ARP Entries">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_ipv4-static-route_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="vrp_ipv4-static-route_cfg_0019.html">
<meta name="DC.Relation" scheme="URI" content="vrp_ipv4-static-route_cfg_0021.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="IPv4 Static Route">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv4 Static Route">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176742415">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring IPv4 Static Route Creation-triggered Learning of next-hop-specific ARP Entries</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176742415"></a><a name="EN-US_TASK_0000001176742415"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring IPv4 Static Route Creation-triggered Learning of next-hop-specific ARP Entries</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176742415__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>If the <strong><span>arp-detect</span></strong> <i><span class="varname">arp-interface-type arp-interface-number</span></i> parameter is specified when you configure an IPv4 static route, a device automatically learns next-hop-specific ARP entries when creating IPv4 static routes.</p>
<p>You need to configure an IPv4 static route to proactively learn next hop entries in the following scenarios:</p>
<ul><li>When a device forwards traffic through an IPv4 static route, if the device does not have the next-hop ARP entry of the static route, the device needs to trigger ARP entry learning through traffic forwarding. In this case, packet loss occurs when traffic is sent. After an IPv4 static route is configured to trigger the learning of the next-hop-specific ARP entry, the device can learn the next-hop-specific ARP entry before forwarding traffic. This ensures that no packet is lost during traffic forwarding.</li><li>If the <strong><span>arp-vlink-only</span></strong> parameter is configured to enable static routes to recurse only to ARP Vlink direct routes, even though a local device has no ARP entry, the device cannot generate an ARP Vlink direct route due to the lack of the ARP entry. Consequently, no static route can recurse to the ARP Vlink direct route or go up. In the scenario where traffic can be imported only after the static route is advertised by another protocol, the static route cannot be advertised by another protocol and therefore traffic cannot be imported. As a result, the ARP entry cannot be learned. To address this problem, set the <strong><span>arp-detect</span></strong> <i><span class="varname">arp-interface-type arp-interface-number</span></i> value to configure a device to proactively learn next-hop-specific ARP entries.</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176742415__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Perform either of the following operations to configure an IPv4 static route and enable the device to learn a next-hop-specific ARP entry based on the specified IPv4 static route.</span><p><ul><li>Configure an IPv4 static route on the public network and enable the device to learn a next-hop-specific ARP entry based on the specified IPv4 static route.<pre class="screen"><a href="cmdqueryname=ip+route-static"><b><span class="cmdname">ip route-static</span></b></a> <i><span class="varname">ip-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } { <i><span class="varname">nexthop-address</span></i> | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> <i><span class="varname">nexthop-address</span></i> } [ <strong><span>recursive-lookup</span></strong> <strong><span>host-route</span></strong> [ <strong><span>arp-vlink-only</span></strong> ] ] <strong><span>arp-detect</span></strong> <i><span class="varname">arp-interface-type arp-interface-number</span></i>
<a href="cmdqueryname=ip+route-static"><b><span class="cmdname">ip route-static</span></b></a> <i><span class="varname">ip-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> <i><span class="varname">nexthop-address</span></i> [ <strong><span>arp-detect</span></strong> <i><span class="varname">arp-interface-type arp-interface-number</span></i> ]</pre>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The CE6885-LL in low latency mode does not support <a href="cmdqueryname=ip+route-static"><b><span class="cmdname">ip route-static</span></b></a> <i><span class="varname">ip-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } { <i><span class="varname">nexthop-address</span></i> | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> <i><span class="varname">nexthop-address</span></i> } [ <strong><span>recursive-lookup</span></strong> <strong><span>host-route</span></strong> [ <strong><span>arp-vlink-only</span></strong> ] ] <strong><span>arp-detect</span></strong> <i><span class="varname">arp-interface-type arp-interface-number</span></i>.</p>
</div></div>
</li><li>Configure an IPv4 static route in a VPN instance and enable the device to proactively learn a next-hop-specific ARP entry based on the specified IPv4 static route.<pre class="screen"><a href="cmdqueryname=ip+route-static+vpn-instance"><b><span class="cmdname">ip route-static vpn-instance</span></b></a> <i><span class="varname">vpn-source-name</span></i> <i><span class="varname">destination-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } <span>{ <i><span class="varname">interface-name</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> }</span> <i><span class="varname">nexthop-address</span></i> <strong><span>arp-detect</span></strong> { <span><i><span class="varname">arp-interface-name</span></i> | </span><i><span class="varname">arp-interface-type arp-interface-number</span></i> }
<a href="cmdqueryname=ip+route-static+vpn-instance"><b><span class="cmdname">ip route-static vpn-instance</span></b></a> <i><span class="varname">vpn-source-name</span></i> <i><span class="varname">destination-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-destination-name</span></i> <i><span class="varname">nexthop-address</span></i><span> [ <strong><span>recursive-lookup</span></strong> <strong><span>host-route</span></strong> ] </span><strong><span>arp-detect</span></strong> { <span><i><span class="varname">arp-interface-name</span></i> | </span><i><span class="varname">arp-interface-type arp-interface-number</span></i> }
<a href="cmdqueryname=ip+route-static+vpn-instance"><b><span class="cmdname">ip route-static vpn-instance</span></b></a> <i><span class="varname">vpn-source-name</span></i> <i><span class="varname">destination-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } <i><span class="varname">nexthop-address</span></i> [ <strong><span>recursive-lookup</span></strong> <strong><span>host-route</span></strong> [ <strong><span>arp-vlink-only</span></strong> ] ] <strong><span>arp-detect</span></strong> { <span><i><span class="varname">arp-interface-name</span></i> | </span><i><span class="varname">arp-interface-type arp-interface-number</span></i> }</pre>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The CE6885-LL in low latency mode does not support <a href="cmdqueryname=ip+route-static+vpn-instance"><b><span class="cmdname">ip route-static vpn-instance</span></b></a> <i><span class="varname">vpn-source-name</span></i> <i><span class="varname">destination-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-destination-name</span></i> <i><span class="varname">nexthop-address</span></i><span> [ <strong><span>recursive-lookup</span></strong> <strong><span>host-route</span></strong> ] </span><strong><span>arp-detect</span></strong> { <span><i><span class="varname">arp-interface-name</span></i> | </span><i><span class="varname">arp-interface-type arp-interface-number</span></i> }.</p>
</div></div>
</li></ul>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001176742415__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001176742415__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001176742415__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+current-configuration"><b><span class="cmdname">display current-configuration</span></b></a> command to check information about next-hop-specific ARP entries that the device proactively learns based on IPv4 static routes.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_ipv4-static-route_cfg_0001.html">IPv4 Static Route Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_ipv4-static-route_cfg_0019.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_ipv4-static-route_cfg_0021.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>