
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Next_Hop-related Functions">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp6_cfg_0013.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp6_cfg_0017.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp6_cfg_0019.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP4+">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP4+">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP4+">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176741867">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring Next_Hop-related Functions</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176741867"></a><a name="EN-US_TASK_0000001176741867"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Next_Hop-related Functions</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176741867__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>The Next_Hop attribute of BGP4+ differs from that of an IGP, as the former is not necessarily the IPv6 address of a neighboring device. Configuring the Next_Hop-related functions allows for flexible control of BGP4+ route selection.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176741867__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the BGP view.</span><p><pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></pre>
</p></li><li><span>Enter the IPv6 unicast address family view.</span><p><pre class="screen"><a href="cmdqueryname=ipv6-family+unicast"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>unicast</span></strong></pre>
</p></li><li><span>Configure Next_Hop-related functions. For details, see <a href="#EN-US_TASK_0000001176741867__table29861143141218">Table 1</a>.</span><p>
<div class="tableBorder"><a name="EN-US_TASK_0000001176741867__table29861143141218"></a><a name="table29861143141218"></a><table cellpadding="4" cellspacing="0" summary="" id="EN-US_TASK_0000001176741867__table29861143141218" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Configuring Next_Hop-related functions</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.4.2.1.2.4.1.1" liSelected="liSelected"><p>Operation</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.4.2.1.2.4.1.2" liSelected="liSelected"><p>Command</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.4.2.1.2.4.1.3" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.4.2.1.2.4.1.1 "><p>Configure the device to change the next hop of each route to itself when the device advertises them to a specified IBGP peer or peer group.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.4.2.1.2.4.1.2 "><p><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> | <i><span class="varname">ipv4-address</span></i> } <a href="cmdqueryname=next-hop-local"><b><span class="cmdname">next-hop-local</span></b></a></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.4.2.1.2.4.1.3 "><p>To ensure that an IBGP peer can find the correct next hop, you can configure the local device to use its own address as the next-hop address of each route when the local device advertises routes to the IBGP peer.</p>
<p>By default, a device does not change the next-hop address of a route when advertising the route to an IBGP peer.</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>If BGP4+ load balancing is configured on a device, the device changes the next hop address of a route to its own IP address when advertising the route to IBGP peers or peer groups, regardless of whether the <a href="cmdqueryname=peer+next-hop-local"><b><span class="cmdname">peer next-hop-local</span></b></a> command is run.</p>
</div></div>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.4.2.1.2.4.1.1 "><p>Configure the device to recurse routes to next hops based on a specified route-policy.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.4.2.1.2.4.1.2 "><p><a href="cmdqueryname=nexthop+recursive-lookup+route-policy"><b><span class="cmdname">nexthop recursive-lookup</span></b></a> <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.4.2.1.2.4.1.3 "><p>By default, no route-policy is configured for next hop recursion.</p>
<p>After this command is run, the device matches the recursive next hops against the specified route-policy after recursing routes. A route with a recursive next hop that does not match the route-policy will be set to invalid.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.4.2.1.2.4.1.1 "><p>Configure the device not to change the next hop address of a route when advertising the route to a peer in a specific scenario. This ensures that traffic is transmitted along the optimal path.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.4.2.1.2.4.1.2 "><p><a href="cmdqueryname=nexthop+third-party"><b><span class="cmdname">nexthop third-party</span></b></a></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.4.2.1.2.4.1.3 "><p>The specific scenarios include the following:</p>
<ul><li>The route is learned from a directly connected peer and is to be advertised to a directly connected EBGP peer, the original next hop of the route resides on the same network segment as the local interface that is used to establish the BGP4+ peer relationship with the EBGP peer, and directly connected interfaces are broadcast interfaces.</li><li>The route is locally imported and is to be advertised to a directly connected IBGP or EBGP peer, the next hop to which the route recurses resides on the same network segment as the local interface that is used to establish the BGP4+ peer relationship with the IBGP or EBGP peer, and directly connected interfaces are broadcast interfaces.</li></ul>
</td>
</tr>
</tbody>
</table>
</div>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001176741867__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001176741867__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_bgp6_cfg_0013.html">Configuring BGP4+ Route Attributes
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_bgp6_cfg_0017.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_bgp6_cfg_0019.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>