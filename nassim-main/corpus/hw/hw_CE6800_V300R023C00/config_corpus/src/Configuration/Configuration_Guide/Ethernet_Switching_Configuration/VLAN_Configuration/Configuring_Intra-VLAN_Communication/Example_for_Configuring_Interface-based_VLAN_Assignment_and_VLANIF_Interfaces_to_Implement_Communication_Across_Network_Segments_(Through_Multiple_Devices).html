
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Interface-based VLAN Assignment and VLANIF Interfaces to Implement Communication Across Network Segments (Through Multiple Devices)">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_vlan_cfg_0016.html">
<meta name="DC.Relation" scheme="URI" content="vrp_vlan_cfg_0023.html">
<meta name="DC.Relation" scheme="URI" content="vrp_vlan_cfg_0025.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featurename" content="QinQ">
<meta name="featurename" content="VLAN">
<meta name="featurename" content="VLAN Mapping">
<meta name="featurename" content="VLAN Pool">
<meta name="featurename" content="Voice VLAN">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130622832">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<link rel="stylesheet" type="text/css" href="public_sys-resources/imagePopup.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/customQuery.js"></script>
<script language="javascript" type="text/javascript" src="public_sys-resources/imagePopup.js"></script>
<title>Example for Configuring Interface-based VLAN Assignment and VLANIF Interfaces to Implement Communication Across Network Segments (Through Multiple Devices)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130622832"></a><a name="EN-US_TASK_0000001130622832"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Interface-based VLAN Assignment and VLANIF Interfaces to Implement Communication Across Network Segments (Through Multiple Devices)</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001130622832__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0000001130622832__fig17296449123314">Figure 1</a>, Host1 and Host2 connected to DeviceA and Host3 and Host4 connected to DeviceB all belong to VLAN 2. The hosts connected to DeviceA belong to a different network segment from the hosts connected to DeviceB, and DeviceA and DeviceB can communicate at Layer 3. Host1 and Host2 connected to DeviceA need to communicate with Host3 and Host4 connected to DeviceB.</p>
<div class="fignone" id="EN-US_TASK_0000001130622832__fig17296449123314"><a name="EN-US_TASK_0000001130622832__fig17296449123314"></a><a name="fig17296449123314"></a><span class="figcap"><b>Figure 1 </b>Networking diagram of configuring interface-based VLAN assignment and VLANIF interfaces for communication through multiple devices</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, and <span>100GE</span> <span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="imgResize" src="figure/en-us_image_0000001176662433.png" width="522.69" height="192.355639" title="Click to enlarge"></span></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130622832__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Create VLANs on DeviceA and DeviceB.</span><p><p># Configure DeviceA.</p>
</p><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>vlan batch 2</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>]<strong> portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>]<strong> port link-type access</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>]<strong> port default vlan 2</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>]<strong> quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>]<strong> portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>]<strong> port link-type access</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>]<strong> port default vlan 2</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>]<strong> quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<div class="p"># Configure DeviceB.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceB</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>vlan batch 2</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface <span>100ge</span> </strong><strong><span>1/0/1</span></strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>]<strong> portswitch</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>]<strong> port link-type access</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>]<strong> port default vlan 2</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>]<strong> quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>]<strong> portswitch</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>]<strong> port link-type access</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>]<strong> port default vlan 2</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>]<strong> quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
</div>
</p></li><li><span>Configure the link between DeviceA and DeviceB as a trunk link.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>vlan batch 4</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>]<strong> portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>]<strong> port link-type trunk</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>]<strong> port trunk allow-pass vlan 4</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>]<strong> quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>vlan batch 4</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>]<strong> portswitch</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>]<strong> port link-type trunk</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>]<strong> port trunk allow-pass vlan 4</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>]<strong> quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
</p></li><li><span>Create VLANIF interfaces and configure their IP addresses.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> interface vlanif 2</strong>
[<span class="keyword">*</span>DeviceA-Vlanif2] <strong>ip address 10.10.10.1 24</strong>
[<span class="keyword">*</span>DeviceA-Vlanif2] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA]<strong> interface vlanif 4</strong>
[<span class="keyword">*</span>DeviceA-Vlanif4] <strong>ip address 10.10.30.1 24</strong>
[<span class="keyword">*</span>DeviceA-Vlanif4] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong> interface vlanif 2</strong>
[<span class="keyword">*</span>DeviceB-Vlanif2] <strong>ip address 10.10.20.1 24</strong>
[<span class="keyword">*</span>DeviceB-Vlanif2] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB]<strong> interface vlanif 4</strong>
[<span class="keyword">*</span>DeviceB-Vlanif4] <strong>ip address 10.10.30.2 24</strong>
[<span class="keyword">*</span>DeviceB-Vlanif4] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
</p></li><li><span>Configure basic OSPF functions on DeviceA and DeviceB to ensure that there are reachable routes between them.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> </strong><strong>router id 1.1.1.1</strong>
[<span class="keyword">*</span>DeviceA]<strong> ospf</strong> <strong>1</strong>
[<span class="keyword">*</span>DeviceA-ospf-1] <strong>area 0</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.0] <strong>network 10.10.10.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.0] <strong>network 10.10.30.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA-ospf-1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong> </strong><strong>router id 2.2.2.2</strong>
[<span class="keyword">*</span>DeviceB]<strong> ospf</strong> <strong>1</strong>
[<span class="keyword">*</span>DeviceB-ospf-1] <strong>area 0</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0] <strong>network 10.10.20.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0] <strong>network 10.10.30.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB-ospf-1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001130622832__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>On the hosts connected to DeviceA, set the default gateway address to 10.10.10.1/24 (the IP address of VLANIF 2). On the hosts connected to DeviceB, set the default gateway address to 10.10.20.1/24 (the IP address of VLANIF 2). After the configuration is complete, Host1, Host2, Host3, and Host4 can ping one another.</p>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001130622832__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#  
router id 1.1.1.1
#
vlan batch 2 4
# 
interface Vlanif2
 ip address 10.10.10.1 255.255.255.0 
# 
interface Vlanif4  
 ip address 10.10.30.1 255.255.255.0 
#
interface <span>100GE</span><span>1/0/1</span>
 port default vlan 2
#
interface <span>100GE</span><span>1/0/2</span>
 port default vlan 2
#
interface <span>100GE</span><span>1/0/3</span>
 port link-type trunk
 port trunk allow-pass vlan 4
#
ospf 1
 area 0.0.0.0
  network 10.10.10.0 0.0.0.255
  network 10.10.30.0 0.0.0.255
#
return</pre>
</li><li>DeviceB<pre class="screen">#
sysname DeviceB
#  
router id 2.2.2.2
#
vlan batch 2 4
# 
interface Vlanif2  
 ip address 10.10.20.1 255.255.255.0 
# 
interface Vlanif4  
 ip address 10.10.30.2 255.255.255.0 
#
interface <span>100GE</span><span>1/0/1</span>
 port default vlan 2
#
interface <span>100GE</span><span>1/0/2</span>
 port default vlan 2
#
interface <span>100GE</span><span>1/0/3</span>
 port link-type trunk
 port trunk allow-pass vlan 4
#
ospf 1
 area 0.0.0.0
  network 10.10.20.0 0.0.0.255
  network 10.10.30.0 0.0.0.255
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_vlan_cfg_0016.html">Configuring Intra-VLAN Communication
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_vlan_cfg_0023.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_vlan_cfg_0025.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>

<script language="JavaScript">
<!--
initImageViewer('.imgResize');
var msg_imageMax = "view original image";
var msg_imageClose = "close";
//--></script></body>
</html>