
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Rate Limiting for ICMPv6 Error Messages">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_ipv6_cfg_0019.html">
<meta name="DC.Relation" scheme="URI" content="vrp_ipv6_cfg_0021.html">
<meta name="DC.Relation" scheme="URI" content="vrp_ipv6_cfg_0038.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="IPv6 Basic">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv6 Basic">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="IPv6 Basic">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176661699">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring Rate Limiting for ICMPv6 Error Messages</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176661699"></a><a name="EN-US_TASK_0000001176661699"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Rate Limiting for ICMPv6 Error Messages</h1>
<div class="taskbody"><div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001176661699__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before configuring rate limiting for ICMPv6 error messages, you have completed the following tasks:</p>
<ul><li><p>Connect interfaces and configure physical parameters for the interfaces to ensure that the physical status of the interfaces is up.</p>
</li><li><p>Configure link layer protocol parameters for the interfaces to ensure that the link layer protocol status of the interfaces is up.</p>
</li><li><p>Configure IPv6 addresses for interfaces.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176661699__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Context</h4><p>In ICMPv6 message control, the token bucket algorithm is adopted, with one token representing one ICMPv6 message. Tokens are placed in the virtual bucket at fixed intervals until the capacity of the token bucket reaches the upper threshold. If the number of ICMPv6 messages exceeds the upper threshold, excess messages are discarded.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176661699__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Configure rate limiting for ICMPv6 error messages.</span><p><pre class="screen"><a href="cmdqueryname=ipv6+icmp-error+ratelimit+bucket"><b><span class="cmdname">ipv6 icmp-error</span></b></a> { <strong><span>ratelimit</span></strong> <i><span class="varname">interval</span></i> | <strong><span>bucket</span></strong> <i><span class="varname">bucket-size</span></i> } <sup>*</sup></pre>
</p></li><li><span>(Optional) Disable the device from suppressing ICMPv6 Packet Too Big messages.</span><p><pre class="screen"><a href="cmdqueryname=ipv6+icmp+rate-limit+packet-too-big+disable"><b><span class="cmdname">ipv6 icmp rate-limit packet-too-big disable</span></b></a></pre>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001176661699__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001176661699__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001176661699__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Example</h4><p>As shown in the following figure, DeviceA and DeviceB are connected to PC1 and PC2 respectively. Attackers often send a large number of ICMPv6 messages to attack the network, increasing network traffic and degrading device performance. To reduce network traffic and improve device performance, configure rate limiting for ICMPv6 error messages on DeviceA.</p>
<div class="fignone"><span class="figcap"><b>Figure 1 </b>Network diagram of configuring rate limiting for ICMPv6 error messages</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1 represents <span>100GE</span> <span>1/0/1</span>.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001176741619.png"></span></div>
<p># Configure rate limiting for ICMPv6 error messages on DeviceA.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
<span>[<span class="keyword">*</span>HUAWEI] <strong>commit</strong></span>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>ipv6 icmp-error </strong><strong>bucket 50 ratelimit 120</strong>
<span>[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></span></pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001176661699__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Assume that the <span>100GE</span> <span>1/0/1</span> IP addresses on DeviceA and DeviceB are 2001:db8::2/24 and 2001:db8::1/24 respectively. Run the <strong>ping</strong> command on DeviceB. The command output shows that some reply messages are discarded, indicating that rate limiting takes effect.</p>
<p>Run the <a href="cmdqueryname=display+icmpv6+statistics+interface"><b><span class="cmdname">display icmpv6 statistics interface</span></b></a> [ <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> ] command to check statistics about ICMPv6 traffic.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_ipv6_cfg_0019.html">Configuring ICMPv6
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_ipv6_cfg_0021.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_ipv6_cfg_0038.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>