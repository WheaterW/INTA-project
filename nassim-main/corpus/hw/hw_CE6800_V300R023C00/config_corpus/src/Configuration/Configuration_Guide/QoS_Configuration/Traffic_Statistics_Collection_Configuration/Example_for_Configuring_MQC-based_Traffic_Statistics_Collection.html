
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring MQC-based Traffic Statistics Collection">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_qos_statistics_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_qos_statistics_cfg_0004.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Traffic Statistics Collection">
<meta name="featuretype" content="QoS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Traffic Statistics Collection">
<meta name="featuretype" content="QoS">
<meta name="featuretype" content="QoS">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001512688846">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring MQC-based Traffic Statistics Collection</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001512688846"></a><a name="EN-US_TASK_0000001512688846"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring MQC-based Traffic Statistics Collection</h1>
<div class="taskbody" id="taskbody176170472175351"><div class="context"><a name="EN-US_TASK_0000001512688846__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001512688846__context478926650175351"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001512688846__p1462517775175351">In <a href="#EN-US_TASK_0000001512688846__fig_dc_cfg_qos_006301">Figure 1</a>, Host1 sends packets with the 802.1p value of 6 to DeviceA. Statistics on service packets need to be collected to properly allocate bandwidth resources.</p>
<div class="fignone" id="EN-US_TASK_0000001512688846__fig_dc_cfg_qos_006301"><a name="EN-US_TASK_0000001512688846__fig_dc_cfg_qos_006301"></a><a name="fig_dc_cfg_qos_006301"></a><span class="figcap"><b>Figure 1 </b>Network diagram of traffic statistics collection</span><div class="note" id="EN-US_TASK_0000001512688846__note163690483552"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001512688846__p113691482557">In this example, interface 1 represents <span>100GE</span> <span>1/0/1</span>.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001512688846__image168248565175351" src="figure/en-us_image_0000001564128069.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001512688846__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001512688846__steps658852058175351"><li id="EN-US_TASK_0000001512688846__step908155968175351"><span id="EN-US_TASK_0000001512688846__cmd1211074947175351">Set the host name of the device to DeviceA.</span><p><pre class="screen" id="EN-US_TASK_0000001512688846__screen2099068936175351">&lt;<span class="keyword" id="EN-US_TASK_0000001512688846__keyword1517086799183309">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001512688846__b365977254175351">system-view</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword" id="EN-US_TASK_0000001512688846__keyword9825182075710">HUAWEI</span>] <strong id="EN-US_TASK_0000001512688846__b133102027155111">sysname DeviceA</strong>
[*<span class="keyword" id="EN-US_TASK_0000001512688846__keyword12492125095720">HUAWEI</span>] <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001512688846__cmdname865718165817">commit</span></b></a></pre>
</p></li><li id="EN-US_TASK_0000001512688846__step1116179251175351"><span id="EN-US_TASK_0000001512688846__cmd1355015012175351">Configure an ACL rule.</span><p><p id="EN-US_TASK_0000001512688846__p25886238175351"># On <span class="keyword" id="EN-US_TASK_0000001512688846__keyword1051982616175351">DeviceA</span>, create Layer 2 ACL 4000 to match packets with the 802.1p value of 6.</p>
<pre class="screen" id="EN-US_TASK_0000001512688846__screen1017266882175351">[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword" id="EN-US_TASK_0000001512688846__keyword283353696175351">DeviceA</span>] <strong id="EN-US_TASK_0000001512688846__b932074758175351">acl 4000</strong>
[*<span class="keyword" id="EN-US_TASK_0000001512688846__keyword1544506894175351">DeviceA</span>-acl-L2-4000] <strong id="EN-US_TASK_0000001512688846__b1307026666175351">rule permit 8021p 6</strong>
[<span class="keyword" id="EN-US_TASK_0000001512688846__keyword1693003284175351">*DeviceA</span>-acl-L2-4000] <strong id="EN-US_TASK_0000001512688846__b636678887175351">quit</strong>
[*<span class="keyword" id="EN-US_TASK_0000001512688846__keyword267714461412">DeviceA</span>] <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001512688846__cmdname14217391243">commit</span></b></a></pre>
</p></li><li id="EN-US_TASK_0000001512688846__step1448290779175351"><span id="EN-US_TASK_0000001512688846__cmd1843467555175351">Configure a traffic classifier.</span><p><p id="EN-US_TASK_0000001512688846__p638551051175351"># On <span class="keyword" id="EN-US_TASK_0000001512688846__keyword1857646675175351">DeviceA</span>, create traffic classifier <strong id="EN-US_TASK_0000001512688846__b125613401465">c1</strong> and match ACL 4000.</p>
<pre class="screen" id="EN-US_TASK_0000001512688846__screen1677200177175351">[<span class="keyword" id="EN-US_TASK_0000001512688846__keyword274130061175351"><font style="font-size:8pt" Face="Courier New" >~</font>DeviceA</span>] <strong id="EN-US_TASK_0000001512688846__b1905872922175351">traffic classifier c1</strong>
[<span class="keyword" id="EN-US_TASK_0000001512688846__keyword224690727175351">*DeviceA</span>-classifier-c1] <strong id="EN-US_TASK_0000001512688846__b527980336175351">if-match acl 4000</strong>
[<span class="keyword" id="EN-US_TASK_0000001512688846__keyword1630771338175351">*DeviceA</span>-classifier-c1] <strong id="EN-US_TASK_0000001512688846__b1648820224175351">quit</strong>
[*<span class="keyword" id="EN-US_TASK_0000001512688846__keyword14167911182111">DeviceA</span>] <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001512688846__cmdname41676115212">commit</span></b></a></pre>
</p></li><li id="EN-US_TASK_0000001512688846__step121040966175351"><span id="EN-US_TASK_0000001512688846__cmd668501853175351">Configure a traffic behavior.</span><p><p id="EN-US_TASK_0000001512688846__p149293713175351"># On <span class="keyword" id="EN-US_TASK_0000001512688846__keyword1700164229175351">DeviceA</span>, create traffic behavior <strong id="EN-US_TASK_0000001512688846__b1470115221377">b1</strong> and define the traffic statistics collection action in the traffic behavior.</p>
<pre class="screen" id="EN-US_TASK_0000001512688846__screen349592247175351">[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword" id="EN-US_TASK_0000001512688846__keyword926254017175351">DeviceA</span>] <strong id="EN-US_TASK_0000001512688846__b1406392845175351">traffic behavior b1</strong>
[<span class="keyword" id="EN-US_TASK_0000001512688846__keyword1922953849175351">*DeviceA</span>-behavior-b1] <strong id="EN-US_TASK_0000001512688846__b2145009936175351">statistics enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001512688846__keyword265234658175351">*DeviceA</span>-behavior-b1] <strong id="EN-US_TASK_0000001512688846__b541657982175351">quit</strong>
[*<span class="keyword" id="EN-US_TASK_0000001512688846__keyword344481312115">DeviceA</span>] <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001512688846__cmdname24449137214">commit</span></b></a></pre>
</p></li><li id="EN-US_TASK_0000001512688846__step1728820289175351"><span id="EN-US_TASK_0000001512688846__cmd828853313175351">Configure a traffic policy and apply it to the interface.</span><p><p id="EN-US_TASK_0000001512688846__p757284347175351"># On <span class="keyword" id="EN-US_TASK_0000001512688846__keyword2147101374175351">DeviceA</span>, create traffic policy <strong id="EN-US_TASK_0000001512688846__b1028018184812">p1</strong>, in which traffic classifier <strong id="EN-US_TASK_0000001512688846__b528131812816">c1</strong> is associated with traffic behavior <strong id="EN-US_TASK_0000001512688846__b2281121810816">b1</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001512688846__screen1406844771175351">[<span class="keyword" id="EN-US_TASK_0000001512688846__keyword1009001071175351"><font style="font-size:8pt" Face="Courier New" >~</font>DeviceA</span>] <strong id="EN-US_TASK_0000001512688846__b243580136175351">traffic policy p1</strong>
[*<span class="keyword" id="EN-US_TASK_0000001512688846__keyword1095929021175351">DeviceA</span>-trafficpolicy-p1] <strong id="EN-US_TASK_0000001512688846__b825161116175351">classifier c1 behavior b1</strong>
[*<span class="keyword" id="EN-US_TASK_0000001512688846__keyword1527935990175351">DeviceA</span>-trafficpolicy-p1] <strong id="EN-US_TASK_0000001512688846__b1178837470175351">quit</strong></pre>
<p id="EN-US_TASK_0000001512688846__p655659905175351"># Apply traffic policy <strong id="EN-US_TASK_0000001512688846__b1540114539816">p1</strong> to the inbound direction of <span>100GE</span> <span>1/0/1</span>.</p>
<pre class="screen" id="EN-US_TASK_0000001512688846__screen1986779343175351">[<span class="keyword" id="EN-US_TASK_0000001512688846__keyword1284090924175351">*DeviceA</span>] <strong id="EN-US_TASK_0000001512688846__b172951416324">interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001512688846__keyword1190646685175351">*DeviceA</span>-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001512688846__b320979157175351">traffic-policy p1 inbound</strong>
[<span class="keyword" id="EN-US_TASK_0000001512688846__keyword1509095902175351">*DeviceA</span>-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001512688846__b1154136518175351">quit</strong>
[*<span class="keyword" id="EN-US_TASK_0000001512688846__keyword1191614239216">DeviceA</span>] <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001512688846__cmdname1391682316218">commit</span></b></a>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword" id="EN-US_TASK_0000001512688846__keyword1578333438175329">DeviceA</span>] <strong id="EN-US_TASK_0000001512688846__b830902679175329">quit</strong></pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001512688846__example898957065175351"><a name="EN-US_TASK_0000001512688846__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0000001512688846__p1878125178175351"># Check the ACL configuration.</p>
<pre class="screen" id="EN-US_TASK_0000001512688846__screen1653799465175351">&lt;<span class="keyword" id="EN-US_TASK_0000001512688846__keyword1414014204175351">DeviceA</span>&gt; <strong id="EN-US_TASK_0000001512688846__b433305166175351">display acl 4000</strong>
L2 ACL 4000, 1 rule
ACL's step is 5
 rule 5 permit 8021p 6 (0 times matched)</pre>
<p id="EN-US_TASK_0000001512688846__p1178994491175351"># Check the traffic classifier configuration.</p>
<pre class="screen" id="EN-US_TASK_0000001512688846__screen1243646690175351">&lt;<span class="keyword" id="EN-US_TASK_0000001512688846__keyword1791366312175351">DeviceA</span>&gt; <strong id="EN-US_TASK_0000001512688846__b747514183175351">display traffic classifier c1</strong>
  Traffic Classifier Information:
    Classifier: c1
      Type: OR
      Rule(s):
        if-match acl 4000
</pre>
<p id="EN-US_TASK_0000001512688846__p436636488175351"># Check the traffic policy configuration.</p>
<pre class="screen" id="EN-US_TASK_0000001512688846__screen1834209053175351">&lt;<span class="keyword" id="EN-US_TASK_0000001512688846__keyword1769078950175351">DeviceA</span>&gt; <strong id="EN-US_TASK_0000001512688846__b6874260175351">display traffic policy p1</strong>
  Traffic Policy Information:
    Policy: p1
      Classifier: c1
        Type: OR
      Behavior: b1
        Statistics: enable
</pre>
<p id="EN-US_TASK_0000001512688846__p807899966175351"># Check traffic statistics.</p>
<pre class="screen" id="EN-US_TASK_0000001512688846__screen1221014556175351">&lt;<span class="keyword" id="EN-US_TASK_0000001512688846__keyword2119244653175351">DeviceA</span>&gt; <strong id="EN-US_TASK_0000001512688846__b1804243583175351">display traffic-policy statistics interface <span>100ge</span> <span>1/0/1</span> inbound</strong>
Traffic policy: p1, inbound                                                                                                         
--------------------------------------------------------------------------------
 Slot: <span>1</span>                                                                        
 Item                  Packets                Bytes           pps           bps 
 -------------------------------------------------------------------------------
 Matched                212185             22067448          1600       1379215 
  Passed                212185             22067448          1600       1379215 
  Dropped                    0                    0             0             0 
   Filter                    0                    0             0             0 
   CAR                       0                    0             0             0 
 -------------------------------------------------------------------------------</pre>
<p id="EN-US_TASK_0000001512688846__p613211320591">You can view the statistics on service packets on <span>100GE</span> <span>1/0/1</span>.</p>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001512688846__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Configuration Scripts</h4><p id="EN-US_TASK_0000001512688846__p1479015134175351"><span class="keyword" id="EN-US_TASK_0000001512688846__keyword684143113175351">DeviceA</span></p>
<pre class="screen" id="EN-US_TASK_0000001512688846__screen1841253000175351">#
sysname <span class="keyword" id="EN-US_TASK_0000001512688846__keyword68653491175351">DeviceA</span>
#
acl number 4000
 rule 5 permit 8021p 6 
#
traffic classifier c1 type or
 if-match acl 4000
#
traffic behavior b1
 statistics enable
#
traffic policy p1
 classifier c1 behavior b1 precedence 5 
#
interface <span>100GE</span><span>1/0/1</span>
 traffic-policy p1 inbound
#
return</pre>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_qos_statistics_cfg_0001.html">Traffic Statistics Collection Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_qos_statistics_cfg_0004.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>