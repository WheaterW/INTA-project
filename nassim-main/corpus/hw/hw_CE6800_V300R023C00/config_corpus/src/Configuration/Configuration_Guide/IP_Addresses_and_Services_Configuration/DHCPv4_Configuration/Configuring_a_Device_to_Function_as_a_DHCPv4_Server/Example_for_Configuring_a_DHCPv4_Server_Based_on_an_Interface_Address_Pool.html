
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a DHCPv4 Server Based on an Interface Address Pool">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_dhcpv4_cfg_0012.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_dhcpv4_cfg_0016.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_dhcpv4_cfg_0019.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="DHCPv4">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="DHCPv4">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="DHCPv4">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001564126241">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring a DHCPv4 Server Based on an Interface Address Pool</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001564126241"></a><a name="EN-US_TASK_0000001564126241"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a DHCPv4 Server Based on an Interface Address Pool</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001564126241__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0000001564126241__dc_cfg_dhcp_104701">Figure 1</a>, <span class="keyword" id="EN-US_TASK_0000001564126241__keyword1860010421605">DeviceA</span> functions as a DHCPv4 server; the PCs on network segment 10.1.1.0/24 are fixed terminals; network segment 10.1.2.0/24 is used for the terminals' temporary access. To facilitate unified management, the administrator requires the terminals to automatically obtain IPv4 addresses and the IPv4 address of the DNS server (if users need to access the network using domain names, a DNS server must be configured). A PC named Client_1 requires a fixed IPv4 address of 10.1.1.100/24 to meet service requirements.</p>
<div class="fignone" id="EN-US_TASK_0000001564126241__dc_cfg_dhcp_104701"><a name="EN-US_TASK_0000001564126241__dc_cfg_dhcp_104701"></a><a name="dc_cfg_dhcp_104701"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring a DHCPv4 server based on an interface address pool</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1 and interface 2 represent <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001563766553.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001564126241__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><div class="p">The configuration roadmap is as follows:<ol><li>Set an IPv4 address lease to 30 days for the PCs (Client_1 to Client_n) on network segment 10.1.1.0/24, and allocate a fixed IPv4 address of 10.1.1.100/24 to Client_1 statically.</li><li>Set an IPv4 address lease to two days for the PCs (Client_s to Client_t) on network segment 10.1.2.0/24 for temporary access.</li></ol>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001564126241__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enable DHCPv4.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">DeviceA</span></strong>
[*<span class="keyword">HUAWEI</span>] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">DeviceA</span>] <strong>dhcp enable</strong>
[*<span class="keyword">DeviceA</span>] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li><li><span>Add interfaces to VLANs.</span><p><p># Add <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span> to VLAN 10 and VLAN 11, respectively.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>vlan batch 10 11</strong>
[*DeviceA] <strong>interface </strong><strong><span>100ge</span> <span>1/0/1</span></strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>portswitch</strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>port link-type access</strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>port default vlan 10</strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[*DeviceA] <strong>interface </strong><strong><span>100ge</span> <span>1/0/2</span></strong>
[*DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>portswitch</strong>
[*DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>port link-type access</strong>
[*DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>port default vlan 11</strong>
[*DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[*<span class="keyword">DeviceA</span>] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li><li><span>Configure IPv4 addresses for VLANIF interfaces.</span><p><p># Configure an IPv4 address for VLANIF 10.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>interface vlanif 10</strong>
[*DeviceA-Vlanif10] <strong>ip address 10.1.1.1 24</strong>
[*DeviceA-Vlanif10] <strong>quit</strong>
[*<span class="keyword">DeviceA</span>] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
<p># Configure an IPv4 address for VLANIF 11.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>interface vlanif 11</strong>
[*DeviceA-Vlanif11] <strong>ip address 10.1.2.1 24</strong>
[*DeviceA-Vlanif11] <strong>quit</strong>
[*<span class="keyword">DeviceA</span>] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li><li><span>Configure interface address pools.</span><p><p># Configure the clients connected to VLANIF 10 to obtain IPv4 addresses and other network parameters from the address pool on VLANIF 10.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>interface vlanif 10</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA-Vlanif10] <strong>dhcp select interface</strong>
[*DeviceA-Vlanif10] <strong>dhcp server gateway-list 10.1.1.1</strong>
[*DeviceA-Vlanif10] <strong>dhcp server lease day 30</strong>
[*DeviceA-Vlanif10] <strong>dhcp server domain-name huawei.com</strong>
[*DeviceA-Vlanif10] <strong>dhcp server dns-list 10.1.3.1</strong>
[*DeviceA-Vlanif10] <strong>dhcp server static-bind ip-address 10.1.1.100 mac-address 00e0-fc12-3456</strong>
[*DeviceA-Vlanif10] <strong>quit</strong>
[*<span class="keyword">DeviceA</span>] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
<p># Configure the clients connected to VLANIF 11 to obtain IPv4 addresses and other network parameters from the address pool on VLANIF 11.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>interface vlanif 11</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA-Vlanif11] <strong>dhcp select interface</strong>
[*DeviceA-Vlanif11] <strong>dhcp server gateway-list 10.1.2.1</strong>
[*DeviceA-Vlanif11] <strong>dhcp server lease day 2</strong>
[*DeviceA-Vlanif11] <strong>dhcp server domain-name huawei.com</strong>
[*DeviceA-Vlanif11] <strong>dhcp server dns-list 10.1.3.1</strong>
[*DeviceA-Vlanif11] <strong>quit</strong>
[*<span class="keyword">DeviceA</span>] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001564126241__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># On DeviceA, run the <a href="cmdqueryname=display+ip+pool"><b><span class="cmdname">display ip pool</span></b></a> command to check IPv4 address configuration and allocation in address pools. The <strong>Used</strong> field displays the number of used IPv4 addresses in each address pool.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>display ip pool interface vlanif10</strong>
  Pool-name        : Vlanif10
  Pool-No          : 0
  Lease            : 30 Days 0 Hours 0 Minutes
  Domain-name      : huawei.com
  DNS-server0      : 10.1.3.1
  NBNS-server0     : -
  Netbios-type     : -
  Position         : Interface
  Status           : Unlocked
  Gateway-0        : 10.1.1.1
  Network          : 10.1.1.0
  Mask             : 255.255.255.0
  VPN instance     : --
  Logging          : Disable
  Conflicted address recycle interval: -
  Address Statistic: Total       :253       Used        :100
                     Idle        :153       Expired     :0
                     Conflict    :0         Disabled     :0

 -------------------------------------------------------------------------------
  Network section
         Start           End       Total    Used Idle(Expired) Conflict Disabled
 -------------------------------------------------------------------------------
        10.1.1.1      10.1.1.254     253     100        153(0)       0     0
 -------------------------------------------------------------------------------</pre>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>display ip pool interface vlanif11</strong>
  Pool-name        : Vlanif11
  Pool-No          : 1
  Lease            : 2 Days 0 Hours 0 Minutes
  Domain-name      : huawei.com
  DNS-server0      : 10.1.3.1
  NBNS-server0     : -
  Netbios-type     : -
  Position         : Interface
  Status           : Unlocked
  Gateway-0        : 10.1.2.1
  Network          : 10.1.2.0
  Mask             : 255.255.255.0
  VPN instance     : --
  Logging          : Disable
  Conflicted address recycle interval: -
  Address Statistic: Total       :253       Used        :3
                     Idle        :250       Expired     :0
                     Conflict    :0         Disabled     :0

 -------------------------------------------------------------------------------
  Network section
         Start           End       Total    Used Idle(Expired) Conflict Disabled
 -------------------------------------------------------------------------------
        10.1.2.1      10.1.1.254    253       3        250(0)       0     0
 -------------------------------------------------------------------------------</pre>
<p># Check IPv4 address information on Client_1. You can check that Client_1 has obtained the IPv4 address 10.1.1.100/24.</p>
<p># Check IPv4 address information on other DHCPv4 clients. You can check that the clients have obtained IPv4 addresses.</p>
<h4 class="sectiontitle">Configuration Scripts</h4><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
vlan batch 10 11
#
dhcp enable
#
interface Vlanif10
 ip address 10.1.1.1 255.255.255.0
 dhcp select interface
 dhcp server gateway-list 10.1.1.1
 dhcp server static-bind ip-address 10.1.1.100 mac-address  00e0-fc12-3456
 dhcp server lease day 30 hour 0 minute 0
 dhcp server dns-list 10.1.3.1
 dhcp server domain-name huawei.com
#
interface Vlanif11
 ip address 10.1.2.1 255.255.255.0
 dhcp select interface
 dhcp server gateway-list 10.1.2.1
 dhcp server lease day 2 hour 0 minute 0
 dhcp server dns-list 10.1.3.1
 dhcp server domain-name huawei.com
#
interface <span>100GE</span><span>1/0/1</span>
 port default vlan 10
#
interface <span>100GE</span><span>1/0/2</span>
 port default vlan 11
#
return</pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_dhcpv4_cfg_0012.html">Configuring a Device to Function as a DHCPv4 Server
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_dhcpv4_cfg_0016.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_dhcpv4_cfg_0019.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>