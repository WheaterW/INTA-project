
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Enabling MLD">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_mld_cfg_0008.html">
<meta name="DC.Relation" scheme="URI" content="vrp_mld_cfg_0012.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="MLD">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MLD">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="MLD">
<meta name="featuretype" content="IP Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001589496153">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Enabling MLD</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001589496153"></a><a name="EN-US_TASK_0000001589496153"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Enabling MLD</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001589496153__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the ISP network shown in <a href="#EN-US_TASK_0000001589496153__fig_dc_vrp_multicast_cfg_206801">Figure 1</a>, IPv6 multicast services are deployed. An IGP has been deployed on the network, and IPv6 unicast is running properly. Hosts on the network are required to receive VOD information in IPv6 multicast mode. HostA and HostB are required to steadily receive popular programs from the IPv6 multicast group FF13::101.</p>
<div class="fignone" id="EN-US_TASK_0000001589496153__fig_dc_vrp_multicast_cfg_206801"><a name="EN-US_TASK_0000001589496153__fig_dc_vrp_multicast_cfg_206801"></a><a name="fig_dc_vrp_multicast_cfg_206801"></a><span class="figcap"><b>Figure 1 </b>Network diagram of enabling MLD</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1, interface2, interface3, and interface4 represent <span>100GE</span><span>1/0/1</span>, <span>100GE</span><span>1/0/2</span>, <span>100GE</span><span>1/0/3</span>, and <span>100GE</span><span>1/0/4</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001538257250.png" width="NaN" height="NaN"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="31.080389144905276%" id="mcps1.3.1.4.1.4.1.1" liSelected="liSelected"><p>Device</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="29.429083461341527%" id="mcps1.3.1.4.1.4.1.2" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="39.4905273937532%" id="mcps1.3.1.4.1.4.1.3" liSelected="liSelected"><p>IPv6 Address</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="2" valign="top" width="31.080389144905276%" headers="mcps1.3.1.4.1.4.1.1 "><p><span class="keyword">Device</span>A</p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="29.429083461341527%" headers="mcps1.3.1.4.1.4.1.2 "><p><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" valign="top" width="39.4905273937532%" headers="mcps1.3.1.4.1.4.1.3 "><p>2001:db8:5::1/64</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.1.4.1.1 "><p><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.1.4.1.2 "><p>2001:db8:1::1/64</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" valign="top" width="31.080389144905276%" headers="mcps1.3.1.4.1.4.1.1 "><p><span class="keyword">Device</span>B</p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="29.429083461341527%" headers="mcps1.3.1.4.1.4.1.2 "><p><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" valign="top" width="39.4905273937532%" headers="mcps1.3.1.4.1.4.1.3 "><p>2001:db8:6::1/64</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.1.4.1.1 "><p><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.1.4.1.2 "><p>2001:db8:2::1/64</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" valign="top" width="31.080389144905276%" headers="mcps1.3.1.4.1.4.1.1 "><p><span class="keyword">Device</span>C</p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="29.429083461341527%" headers="mcps1.3.1.4.1.4.1.2 "><p><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" valign="top" width="39.4905273937532%" headers="mcps1.3.1.4.1.4.1.3 "><p>2001:db8:7::1/64</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.1.4.1.1 "><p><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.1.4.1.2 "><p>2001:db8:3::1/64</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="4" valign="top" width="31.080389144905276%" headers="mcps1.3.1.4.1.4.1.1 "><p><span class="keyword">Device</span>D</p>
<p></p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="29.429083461341527%" headers="mcps1.3.1.4.1.4.1.2 "><p><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" valign="top" width="39.4905273937532%" headers="mcps1.3.1.4.1.4.1.3 "><p>2001:db8:1::2/64</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.1.4.1.1 "><p><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.1.4.1.2 "><p>2001:db8:2::2/64</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.1.4.1.1 "><p><span>100GE</span><span>1/0/3</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.1.4.1.2 "><p>2001:db8:3::2/64</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.1.4.1.1 "><p><span>100GE</span><span>1/0/4</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.1.4.1.2 "><p>2001:db8:4::1/64</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001589496153__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure IPv6 addresses and a unicast routing protocol for interfaces on each device to ensure connectivity at the network layer.</p>
</li><li><p>Configure basic IPv6 multicast functions on each device to implement multicast data forwarding on the network.</p>
</li><li><p>Enable MLD on the interfaces connected to user hosts.</p>
</li><li><p>Add DeviceA's <span>100GE</span><span>1/0/1</span> to the IPv6 multicast group FF13::101 statically.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001589496153__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure IPv6 addresses and a unicast routing protocol for interfaces on each device.</span><p><p># Configure DeviceA.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>ospfv3 1</strong>
[<span class="keyword">*</span>DeviceA-ospfv3-1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 address 2001:db8:5::1 64</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ospfv3 1 area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span><span><span>1/0/2</span></span></span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>ipv6 address 2001:db8:1::1 64</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>ospfv3 1 area 0.0.0.0</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p>The configurations of DeviceB, DeviceC, and DeviceD are similar to the configuration of DeviceA. For detailed configurations, see Configuration Scripts.</p>
</p></li><li><span>Enable the multicast function on all the devices, enable IPv6 PIM-SM on all the involved interfaces, and configure RPs.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>multicast ipv6 routing-enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface </strong><strong><span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/2</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>pim ipv6</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-pim6] <strong>c-bsr 2001:db8:1::1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-pim6] <strong>c-rp 2001:db8:1::1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-pim6] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p>The configurations of DeviceB, DeviceC, and DeviceD are similar to the configuration of DeviceA. For detailed configurations, see Configuration Scripts.</p>
</p></li><li><span>Enable MLD on the interfaces connected to user hosts.</span><p><p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong>mld enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p>The configurations of DeviceB and DeviceC are similar to the configuration of DeviceA. For detailed configurations, see Configuration Scripts.</p>
</p></li><li><span>Add interface1 of <span class="keyword">Device</span>A to the multicast group FF13::101 statically.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong>mld static-group ff13::101</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001589496153__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Run the <strong>display mld interface</strong> command to check MLD information on interfaces. For example, MLD information on <span>100GE</span><span>1/0/1</span> of <span class="keyword">Device</span>B is as follows:</p>
<pre class="screen">&lt;<span class="keyword">Device</span>B&gt; <strong>display mld interface</strong>
Interface information of VPN Instance: public net
 <span>100GE</span><span>1/0/1</span>(2001:db8:6::1):
   MLD is enabled   
   Current MLD version is 2   
   MLD state: up
   MLD group policy: none
   MLD limit: -
   <span>Q</span>uery interval for MLD (negotiated): -
   <span>Q</span>uery interval for MLD(configured): 60 s
   Other querier timeout for MLD: 0 s
   <span>M</span>aximum query response time for MLD: 10 s
   <strong>Querier for MLD: 2001:db8:6::1 (this router)</strong>
   Total 1 MLD Group reported</pre>
<p>The command output shows that <span class="keyword">Device</span>B is the querier, as the IPv6 address of <span class="keyword">Device</span>B's <span>100GE</span><span>1/0/1</span> connected to the user network segment is smaller.</p>
<p># Run the <a href="cmdqueryname=display+pim+ipv6+routing-table"><b><span class="cmdname">display pim ipv6 routing-table</span></b></a> command on <span class="keyword">Device</span>A to check whether <span>100GE</span><span>1/0/1</span> is statically added to the multicast group FF13::101. If a (*, FF13::101) entry exists, the downstream interface is <span>100GE</span><span>1/0/1</span>, and the protocol type is static, <span>100GE</span><span>1/0/1</span> has statically joined the multicast group FF13::101. The following information is displayed:</p>
<pre class="screen">&lt;<span class="keyword">Device</span>A&gt; <strong>display pim ipv6 routing-table</strong>
VPN-Instance: public net
 Total 1 (*, G) entry; 0 (S, G) entry
 <strong>(*, FF13::101)</strong>
     RP: 2001:db8:4::1
     Protocol: pim-sm, Flag: WC
     UpTime: 00:12:17
     Upstream interface: <span>100GE</span><span>1/0/2</span>, Refresh time: 00:12:17
         Upstream neighbor: 2001:db8:1::2
         RPF prime neighbor: 2001:db8:1::2
     Downstream interface(s) information:
     Total number of downstreams: 1
         1: <strong><span>100GE</span></strong><strong><span>1/0/1</span></strong>
             <strong>Protocol: static</strong>, UpTime: 00:12:17, Expires: -</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001589496153__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p><span class="keyword">Device</span>A</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>A
#
multicast ipv6 routing-enable
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:5::1/64
 pim ipv6 sm
 mld enable
 mld static-group ff13::101
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/2</span> 
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:1::1/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
ospfv3 1
 router-id 1.1.1.1
 area 0.0.0.0
#
pim ipv6
 c-bsr 2001:db8:1::1
 c-rp 2001:db8:1::1
#
return</pre>
</li><li><p><span class="keyword"></span><span class="keyword">Device</span>B</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>B
#
multicast ipv6 routing-enable
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:6::1/64
 pim ipv6 sm
 mld enable
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/2</span> 
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:2::1/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
ospfv3 1
 router-id 2.2.2.2
 area 0.0.0.0
#
pim ipv6
 c-bsr 2001:db8:2::1
 c-rp 2001:db8:2::1
#
return</pre>
</li><li><p><span class="keyword"></span><span class="keyword">Device</span>C</p>
<pre class="screen">#
sysname <span class="keyword">Device</span><span class="keyword"></span>C
#
multicast ipv6 routing-enable
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:7::1/64
 pim ipv6 sm
 mld enable
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/2</span> 
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:3::1/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
ospfv3 1
 router-id 3.3.3.3
 area 0.0.0.0
#
pim ipv6
 c-bsr 2001:db8:3::1
 c-rp 2001:db8:3::1
#
return</pre>
</li><li><p><span class="keyword"></span><span class="keyword">Device</span>D</p>
<pre class="screen">#
sysname <span class="keyword">Device</span><span class="keyword"></span>D
#
multicast ipv6 routing-enable
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:1::2/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/2</span> 
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:2::2/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/3</span> 
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:3::2/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/4</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:4::1/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
ospfv3 1
 router-id 4.4.4.4
 area 0.0.0.0
#
pim ipv6
 c-bsr 2001:db8:4::1
 c-rp 2001:db8:4::1
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_mld_cfg_0008.html">Enabling MLD
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_mld_cfg_0012.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>