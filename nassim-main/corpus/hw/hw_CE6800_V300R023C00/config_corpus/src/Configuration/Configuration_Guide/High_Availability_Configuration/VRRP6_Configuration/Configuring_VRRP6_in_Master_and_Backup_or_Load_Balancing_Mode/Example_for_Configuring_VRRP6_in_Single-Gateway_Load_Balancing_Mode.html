
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring VRRP6 in Single-Gateway Load Balancing Mode">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp6_cfg_0008.html">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp6_cfg_0016.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VRRP6">
<meta name="featuretype" content="High Availability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VRRP6">
<meta name="featuretype" content="High Availability">
<meta name="featurename" content="VRRP6">
<meta name="featuretype" content="High Availability">
<meta name="featuretype" content="High Availability">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176741669">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring VRRP6 in Single-Gateway Load Balancing Mode</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176741669"></a><a name="EN-US_TASK_0000001176741669"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring VRRP6 in Single-Gateway Load Balancing Mode</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176741669__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>Hosts are connected to an upper-layer network through gateways. To improve network reliability, configure VRRP6 groups working in master/backup mode on gateways. If multiple VRRP6 groups run on a device, configure the groups to work in single-gateway load balancing mode to balance traffic.</p>
<div class="p">In <a href="#EN-US_TASK_0000001176741669__fig8509122411516">Figure 1</a>, two VRRP6 groups are configured on both DeviceA and DeviceB. VRRP6 group 1 is an LBRG and VRRP6 group 2 is an LBRG member group.<ul><li><p>DeviceA functions as the master in VRRP6 group 1 and as the backup in VRRP6 group 2.</p>
</li><li><p>DeviceB functions as the master in VRRP6 group 2 and as the backup in VRRP6 group 1.</p>
</li><li><p>Both HostA and HostB use VRRP6 group 1 as their gateway. After receiving an NS message from a user, VRRP6 group 1 encapsulates its own or VRRP6 group 2's virtual MAC address into an NA message to implement load balancing.</p>
</li></ul>
</div>
<div class="fignone" id="EN-US_TASK_0000001176741669__fig8509122411516"><a name="EN-US_TASK_0000001176741669__fig8509122411516"></a><a name="fig8509122411516"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring VRRP6 groups in single-gateway load balancing mode</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span><span>1/0/1</span>, <span>100GE</span><span>1/0/2</span>, and <span>100GE</span><span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001176661785.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176741669__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><div class="p">The configuration roadmap is as follows:<ol><li><p>Assign an IPv6 address to each interface on the devices and configure OSPFv3 to ensure IPv6 connectivity.</p>
</li><li><div class="p">Create two VRRP6 groups on both DeviceA and DeviceB. One functions as an LBRG, and the other functions as an LBRG member group.<ul><li><p>Create VRRP6 groups 1 and 2 on DeviceA's interface <span>100GE</span><span>1/0/1</span>. Configure DeviceA as the master in VRRP6 group 1 and as the backup in VRRP6 group 2.</p>
</li><li><p>Create VRRP6 groups 1 and 2 on DeviceB's interface <span>100GE</span><span>1/0/1</span>. Configure DeviceB as the backup in VRRP6 group 1 and as the master in VRRP6 group 2.</p>
</li></ul>
</div>
</li></ol>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176741669__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Procedure</h4><ol><li>Configure OSPFv3 on DeviceA, DeviceB, and DeviceC to ensure that they can communicate. For configuration details, see <a href="#EN-US_TASK_0000001176741669__section_05">Configuration Scripts</a> in this section.</li><li>Configure VRRP6 groups.<p># Configure an IPv6 address for DeviceA's interface <span>100GE</span><span>1/0/1</span>. Create VRRP6 groups 1 and 2 on DeviceA's <span>100GE</span><span>1/0/1</span>. Set the priority to 120 for DeviceA to ensure that it functions as the master in VRRP6 group 1, and use the default priority 100 for DeviceA to ensure that it functions as the backup in VRRP6 group 2.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span><span>100GE</span><span>1/0/1</span>1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 address 2001:db8::1 64</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 1 virtual-ip fe80::1 link-local</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 1 virtual-ip 2001:db8::100</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 1 priority 120</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 2</strong></pre>
<p># On DeviceA's <span>100GE</span><span>1/0/1</span>, configure VRRP6 group 1 as an LBRG and add VRRP6 group 2 to the LBRG.</p>
<pre class="screen">[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 1 load-balance</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 2 join load-balance-vrrp vrid 1</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure an IPv6 address for DeviceB's interface <span>100GE</span><span>1/0/1</span>. Create VRRP6 groups 1 and 2 on DeviceB's <span>100GE</span><span>1/0/1</span>. Use the default priority 100 for DeviceB to ensure that it functions as the backup in VRRP6 group 1, and set the priority to 120 for DeviceB to ensure that it functions as the master in VRRP6 group 2.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceB</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 address 2001:db8::2 64</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 1 virtual-ip fe80::1 link-local</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 1 virtual-ip 2001:db8::100</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 2</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 2 priority 120</strong></pre>
<p># On DeviceB's <span>100GE</span><span>1/0/1</span>, configure VRRP6 group 1 as an LBRG and add VRRP6 group 2 to the LBRG.</p>
<pre class="screen">[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 1 load-balance</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 2 join load-balance-vrrp vrid 1</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176741669__1.3.4"></a><a name="1.3.4"></a>
<div class="p"><h4 class="sectiontitle">Verifying the Configuration</h4><p># Check the states of DeviceA and DeviceB in the VRRP6 groups.</p>
<pre class="screen">&lt;DeviceA&gt; <strong>display vrrp6 verbose</strong>
<span>100GE</span><span>1/0/1</span> | Virtual Router 1
State           : <strong>Master</strong>
Virtual IP      : FE80::1
                  2001:DB8::100
Master IP       : 2001:DB8::1
PriorityRun     : 120
PriorityConfig  : 120
MasterPriority  : 120
Preempt         : YES   Delay Time : 0s   Remain : --
Hold Multiplier : 4
TimerRun        : 100cs
TimerConfig     : 100cs
Virtual MAC     : 00-e0-fc-12-34-56
Check hop limit : YES
Config Type     : <strong>Load-Balance</strong>
Create Time     : 2020-07-27 20:15:46
Last Change Time: 2020-07-27 20:15:46

<span>100GE</span><span>1/0/1</span> | Virtual Router 2
State           : <strong>Backup</strong>
Virtual IP      : ::
Master IP       : 2001:DB8::2
PriorityRun     : 100
PriorityConfig  : 100
MasterPriority  : 120
Preempt         : YES   Delay Time : 0s   Remain : --
TimerRun        : 100cs
TimerConfig     : 100cs
Virtual MAC     : 00-e0-fc-12-34-57
Check hop limit : YES
Config Type     : <strong>Load-Balance-Member</strong>
Create Time     : 2020-07-27 20:17:46
Last Change Time: 2020-07-27 20:17:46</pre>
<p>The command output shows that DeviceA functions as the master in the LBRG (VRRP6 group 1) and as the backup in the LBRG member group (VRRP6 group 2).</p>
<pre class="screen">&lt;DeviceB&gt; <strong>display vrrp6 verbose</strong>
<span>100GE</span><span>1/0/1</span> | Virtual Router 1
State           : <strong>Backup</strong>
Virtual IP      : FE80::1
                  2001:DB8::100
Master IP       : 2001:DB8::1
PriorityRun     : 100
PriorityConfig  : 100
MasterPriority  : 120
Preempt         : YES   Delay Time : 0s   Remain : --
Hold Multiplier : 4
TimerRun        : 100cs
TimerConfig     : 100cs
Virtual MAC     : 00-e0-fc-12-34-56
Check hop limit : YES
Config Type     : Load-Balance
Create Time     : 2020-07-27 20:19:46
Last Change Time: 2020-07-27 20:19:46

<span>100GE</span><span>1/0/1</span> | Virtual Router 2
State           : <strong>Master</strong>
Virtual IP      : ::
Master IP       : 2001:DB8::2
PriorityRun     : 120
PriorityConfig  : 120
MasterPriority  : 120
Preempt         : YES   Delay Time : 0s   Remain : --
TimerRun        : 100cs
TimerConfig     : 100cs
Virtual MAC     : 00-e0-fc-12-34-57
Check hop limit : YES
Config Type     : Load-Balance-Member
Create Time     : 2020-07-27 20:21:46
Last Change Time: 2020-07-27 20:21:46</pre>
<p>The command output shows that DeviceB functions as the backup in the LBRG (VRRP6 group 1) and as the master in the LBRG member group (VRRP6 group 2).</p>
<p># Check information about the VRRP6 LBRG and its member group on DeviceA and DeviceB.</p>
<pre class="screen">&lt;DeviceA&gt; <strong>display vrrp6 load-balance member-vrrp</strong>
Interface: <span>1/0/1</span>, <strong>load-balance-vrrp vrid: 1, state: Master</strong>
  Member-vrrp number: 1
    <strong>Member-vrrp vrid: 2, state: Backup</strong></pre>
<pre class="screen">&lt;DeviceB&gt; <strong>display vrrp6 load-balance member-vrrp</strong>
Interface: <span>1/0/1</span>, <strong>load-balance-vrrp vrid: 1, state: Backup</strong>
  Member-vrrp number: 1
    <strong>Member-vrrp vrid: 2, state: Master</strong></pre>
</div></div>
<div class="example" id="EN-US_TASK_0000001176741669__section_05"><a name="EN-US_TASK_0000001176741669__section_05"></a><a name="section_05"></a><a name="EN-US_TASK_0000001176741669__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
 sysname DeviceA
#
ospfv3 1
 router-id 10.1.1.1
#
interface <span>100GE</span><span>1/0/1</span>
<strong> </strong>undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8::1/64
 vrrp6 vrid 1 virtual-ip FE80::1 link-local
 vrrp6 vrid 1 virtual-ip 2001:DB8::100
 vrrp6 vrid 1 load-balance
 vrrp6 vrid 1 priority 120
 vrrp6 vrid 2
 vrrp6 vrid 2 join load-balance-vrrp vrid 1
 ospfv3 1 area 0.0.0.0
 #
interface <span>100GE</span><span>1/0/2</span>
<strong> </strong>undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8:1::1/64
 ospfv3 1 area 0.0.0.0
#
return</pre>
</li><li><p>DeviceB</p>
<pre class="screen">#
 sysname DeviceB
#
ospfv3 1
 router-id 10.1.1.1
#
interface <span>100GE</span><span>1/0/1</span>
<strong> </strong>undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8::2/64
 vrrp6 vrid 1 virtual-ip FE80::1 link-local
 vrrp6 vrid 1 virtual-ip 2001:DB8::100
 vrrp6 vrid 1 load-balance
 vrrp6 vrid 2
 vrrp6 vrid 2 priority 120
 vrrp6 vrid 2 join load-balance-vrrp vrid 1
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/2</span>
<strong> </strong>undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8:2::1/64
 ospfv3 1 area 0.0.0.0
#
return</pre>
</li><li><p>DeviceC</p>
<pre class="screen">#
 sysname DeviceC
#
ospfv3 1
 router-id 10.1.1.3
#
interface <span>100GE</span><span>1/0/3</span>
<strong> </strong>undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8:3::2/64
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/1</span>
<strong> </strong>undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8:1::2/64
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/2</span>
<strong> </strong>undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8:2::2/64
 ospfv3 1 area 0.0.0.0
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_vrrp6_cfg_0008.html">Configuring VRRP6 in Master/Backup or Load Balancing Mode
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_vrrp6_cfg_0016.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>