
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Re-marking to Distinguish Users">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_qos_remark_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_qos_remark_cfg_0006.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_qos_remark_cfg_0008.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Re-marking">
<meta name="featuretype" content="QoS">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Re-marking">
<meta name="featuretype" content="QoS">
<meta name="featuretype" content="QoS">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001563996149">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Re-marking to Distinguish Users</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001563996149"></a><a name="EN-US_TASK_0000001563996149"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Re-marking to Distinguish Users</h1>
<div class="taskbody" id="taskbody767061397175348"><div class="context"><a name="EN-US_TASK_0000001563996149__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001563996149__context1141145180175348"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001563996149__p205182473546">On the network shown in <a href="#EN-US_TASK_0000001563996149__fig_dc_cfg_qos_006101">Figure 1</a>, packets sent from Host1 and Host2 to <span class="keyword" id="EN-US_TASK_0000001563996149__keyword276278141175348">DeviceB</span> are identified by different VLAN IDs (10 and 20, respectively). <span class="keyword" id="EN-US_TASK_0000001563996149__keyword832120912552">DeviceB</span> re-marks the VLAN packets received from Host1 and Host2 so that the internal priority of the packets sent by Host1 is higher than that of the packets sent by Host2 on DeviceA. This ensures the experience of services on Host1.</p>
<div class="fignone" id="EN-US_TASK_0000001563996149__fig_dc_cfg_qos_006101"><a name="EN-US_TASK_0000001563996149__fig_dc_cfg_qos_006101"></a><a name="fig_dc_cfg_qos_006101"></a><span class="figcap"><b>Figure 1 </b>Network diagram for configuring re-marking</span><div class="note" id="EN-US_TASK_0000001563996149__note163690483552"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001563996149__p113691482557">In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, and <span>100GE</span> <span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001563996149__image303815995175329" src="figure/en-us_image_0000001564116017.png"></span></div>
<p id="EN-US_TASK_0000001563996149__p9504725165114"></p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001563996149__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001563996149__steps1104060762175348"><li id="EN-US_TASK_0000001563996149__step1308115368175348"><span id="EN-US_TASK_0000001563996149__cmd1704895637175348">Create VLANs and configure interfaces so that <span class="keyword" id="EN-US_TASK_0000001563996149__keyword650584212310">DeviceB</span> can communicate with Host1, Host2, and DeviceA.</span><p><p id="EN-US_TASK_0000001563996149__p1773312770175348"># Create VLAN 10, VLAN 20, and VLAN 30 on <span class="keyword" id="EN-US_TASK_0000001563996149__keyword970300297175348">Device</span>B.</p>
<pre class="screen" id="EN-US_TASK_0000001563996149__screen1937110315175348">&lt;<span class="keyword" id="EN-US_TASK_0000001563996149__keyword1517086799183309">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001563996149__b182894533175348">system-view</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword" id="EN-US_TASK_0000001563996149__keyword1943027164920">HUAWEI</span>] <strong id="EN-US_TASK_0000001563996149__b278176590175348">sysname <span class="keyword" id="EN-US_TASK_0000001563996149__keyword776977659175348">DeviceB</span></strong>
[*<span class="keyword" id="EN-US_TASK_0000001563996149__keyword12492125095720">HUAWEI</span>] <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001563996149__cmdname865718165817">commit</span></b></a>
[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceB] <strong id="EN-US_TASK_0000001563996149__b836890698175348">vlan batch 10 20</strong><strong id="EN-US_TASK_0000001563996149__b1380108172312"> 30</strong>
[*DeviceB] <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001563996149__cmdname17471146121515">commit</span></b></a></pre>
<p id="EN-US_TASK_0000001563996149__p1605243642175348"># Configure <span>100GE</span> <span>1/0/1</span> as a trunk interface and add it to VLAN 30. Configure <span>100GE</span> <span>1/0/2</span> and <span>100GE</span> <span>1/0/3</span> as access interfaces and add them to VLAN 10 and VLAN 20, respectively.</p>
<pre class="screen" id="EN-US_TASK_0000001563996149__screen1526131497175348">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceB] <strong id="EN-US_TASK_0000001563996149__b898977232175348">interface <span>100ge</span> <span>1/0/1</span></strong>
[*DeviceB-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001563996149__b1697471411249">portswitch</strong>
[*DeviceB-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001563996149__b528708123175348">port link-type trunk</strong>
[*DeviceB-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001563996149__b895783956175348">port trunk allow-pass vlan 30</strong>
[*DeviceB-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001563996149__b282432510175348">quit</strong>
[*DeviceB] <strong id="EN-US_TASK_0000001563996149__b1254964143175348">interface <span>100ge</span> <span>1/0/2</span></strong>
[*DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001563996149__b17239819461">portswitch</strong>
[*DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001563996149__b4351432331">port link-type access</strong>
[*DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001563996149__b263214744175348">port default vlan 10</strong>
[*DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001563996149__b1419759538175348">quit</strong>
[*DeviceB] <strong id="EN-US_TASK_0000001563996149__b476796065175348">interface <span>100ge</span> <span>1/0/3</span></strong>
[*DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001563996149__b173521803249">portswitch</strong>
[*DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001563996149__b12531124410478">port link-type access</strong>
[*DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001563996149__b1649355667175348">port default vlan 20</strong>
[*DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001563996149__b1917944177175348">quit</strong>
[*DeviceB] <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001563996149__cmdname120712571716">commit</span></b></a></pre>
<p id="EN-US_TASK_0000001563996149__p37481361508"># Create VLANIF 10, VLANIF 20, and VLANIF 30, and configure IP addresses for them.</p>
<pre class="screen" id="EN-US_TASK_0000001563996149__screen15280134641212">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceB] <strong id="EN-US_TASK_0000001563996149__b1924386088183249">interface vlanif 10</strong>
[*DeviceB-Vlanif10] <strong id="EN-US_TASK_0000001563996149__b1757010067183249">ip address 192.168.10.1 24</strong>
[*DeviceB-Vlanif10] <strong id="EN-US_TASK_0000001563996149__b1075804157183249">quit</strong>
[*DeviceB] <strong id="EN-US_TASK_0000001563996149__b1549232434183249">interface vlanif 20</strong>
[*DeviceB-Vlanif20] <strong id="EN-US_TASK_0000001563996149__b2086303519183249">ip address 192.168.20.1 24</strong>
[*DeviceB-Vlanif20] <strong id="EN-US_TASK_0000001563996149__b474415856183249">quit</strong>
[*DeviceB] <strong id="EN-US_TASK_0000001563996149__b113897120250">interface vlanif 30</strong>
[*DeviceB-Vlanif30] <strong id="EN-US_TASK_0000001563996149__b1738911128255">ip address 192.168.100.1 24</strong>
[*DeviceB-Vlanif30] <strong id="EN-US_TASK_0000001563996149__b13389111219257">quit</strong>
[*DeviceB] <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001563996149__cmdname471312818491">commit</span></b></a></pre>
</p></li><li id="EN-US_TASK_0000001563996149__step275087080175348"><span id="EN-US_TASK_0000001563996149__cmd2003745216175348">Configure traffic classifiers.</span><p><p id="EN-US_TASK_0000001563996149__p1416008599175348"># On <span class="keyword" id="EN-US_TASK_0000001563996149__keyword223689718175348">Device</span>B, create and configure traffic classifiers <strong id="EN-US_TASK_0000001563996149__b1910593617116">c1</strong> and <strong id="EN-US_TASK_0000001563996149__b73551138171119">c2</strong> to classify packets based on VLAN IDs.</p>
<pre class="screen" id="EN-US_TASK_0000001563996149__screen1580738232175348">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceB] <strong id="EN-US_TASK_0000001563996149__b2006687380175348">traffic classifier c1</strong>
[*DeviceB-classifier-c1] <strong id="EN-US_TASK_0000001563996149__b2017877515175348">if-match vlan 10</strong>
[*DeviceB-classifier-c1] <strong id="EN-US_TASK_0000001563996149__b1705421834175348">quit</strong>
[*DeviceB] <strong id="EN-US_TASK_0000001563996149__b255120129175348">traffic classifier c2</strong>
[*DeviceB-classifier-c2] <strong id="EN-US_TASK_0000001563996149__b1850610023175348">if-match vlan 20</strong>
[*DeviceB-classifier-c2] <strong id="EN-US_TASK_0000001563996149__b1818249848175348">quit</strong>
[*DeviceB] <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001563996149__cmdname3653181212179">commit</span></b></a></pre>
</p></li><li id="EN-US_TASK_0000001563996149__step2085399127175348"><span id="EN-US_TASK_0000001563996149__cmd222524802175348">Configure traffic behaviors.</span><p><p id="EN-US_TASK_0000001563996149__p1704112953175348"># Create and configure traffic behaviors <strong id="EN-US_TASK_0000001563996149__b18371848128">b1</strong> and <strong id="EN-US_TASK_0000001563996149__b51081962123">b2</strong> on <span class="keyword" id="EN-US_TASK_0000001563996149__keyword1253570841175348">DeviceB</span> to re-mark the 802.1p value of VLAN packets sent from Host1 into 4 and the 802.1p value of VLAN packets sent from Host2 into 2. In this manner, the priority of packets from Host1 is higher than that of packets from Host2.</p>
<pre class="screen" id="EN-US_TASK_0000001563996149__screen1515927464175348">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceB] <strong id="EN-US_TASK_0000001563996149__b229302955175348">traffic behavior b1</strong>
[*DeviceB-behavior-b1] <strong id="EN-US_TASK_0000001563996149__b4477151674114">remark 8021p 4</strong>
[*DeviceB-behavior-b1] <strong id="EN-US_TASK_0000001563996149__b2127214499175348">quit</strong>
[*DeviceB] <strong id="EN-US_TASK_0000001563996149__b1817536443175348">traffic behavior b2</strong>
[*DeviceB-behavior-b2] <strong id="EN-US_TASK_0000001563996149__b1462289396175348">remark 8021p 2</strong>
[*DeviceB-behavior-b2] <strong id="EN-US_TASK_0000001563996149__b696546400175348">quit</strong>
[*DeviceB] <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001563996149__cmdname663571720175">commit</span></b></a></pre>
</p></li><li id="EN-US_TASK_0000001563996149__step1660344363175348"><span id="EN-US_TASK_0000001563996149__cmd1005199823175348">Configure traffic policies and apply them to interfaces.</span><p><p id="EN-US_TASK_0000001563996149__p919934477175348"># Create traffic policies <strong id="EN-US_TASK_0000001563996149__b19607175014123">p1</strong> and <strong id="EN-US_TASK_0000001563996149__b084735215122">p2</strong> on <span class="keyword" id="EN-US_TASK_0000001563996149__keyword732765311175348">Device</span>B, bind the traffic classifiers and traffic behaviors to the traffic policies, and apply the traffic policy <strong id="EN-US_TASK_0000001563996149__b17635161991316">p1</strong> to <span>100GE</span> <span>1/0/2</span> in the inbound direction and the traffic policy <strong id="EN-US_TASK_0000001563996149__b043534420132">p2</strong> to <span>100GE</span> <span>1/0/3</span> in the inbound direction to re-mark packet priorities.</p>
<pre class="screen" id="EN-US_TASK_0000001563996149__screen571252280175348">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceB] <strong id="EN-US_TASK_0000001563996149__b173952547175348">traffic policy p1</strong>
[*DeviceB-trafficpolicy-p1] <strong id="EN-US_TASK_0000001563996149__b323881108175348">classifier c1 behavior b1</strong>
[*DeviceB-trafficpolicy-p1] <strong id="EN-US_TASK_0000001563996149__b1878447655175348">quit</strong>
[*DeviceB] <strong id="EN-US_TASK_0000001563996149__b211976770175348">traffic policy p2</strong>
[*DeviceB-trafficpolicy-p2] <strong id="EN-US_TASK_0000001563996149__b171061573175348">classifier c2 behavior b2</strong>
[*DeviceB-trafficpolicy-p2] <strong id="EN-US_TASK_0000001563996149__b1795475062175348">quit</strong>
[*DeviceB] <strong id="EN-US_TASK_0000001563996149__b1391349438175348">interface <span>100ge</span> <span>1/0/2</span></strong>
[*DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001563996149__b1009023097175348">traffic-policy p1 inbound</strong>
[*DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001563996149__b125626353175348">quit</strong>
[*DeviceB] <strong id="EN-US_TASK_0000001563996149__b73541548175348">interface <span>100ge</span> <span>1/0/3</span></strong>
[*DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001563996149__b1013808518175348">traffic-policy p2 inbound</strong>
[*DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001563996149__b1139798500175348">quit</strong>
[*DeviceB] <a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001563996149__cmdname158695231175">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001563996149__example567395428175348"><a name="EN-US_TASK_0000001563996149__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0000001563996149__p983647611175348"># Check the traffic classifier configuration.</p>
<pre class="screen" id="EN-US_TASK_0000001563996149__screen135827482175348">&lt;<span class="keyword" id="EN-US_TASK_0000001563996149__keyword1183984456175348">DeviceB</span>&gt; <strong id="EN-US_TASK_0000001563996149__b751170756175348">display traffic classifier</strong>
  Traffic Classifier Information:
    Classifier: c1
      Type: OR
     <strong id="EN-US_TASK_0000001563996149__b722493246175348"> Rule(s):</strong>
        <strong id="EN-US_TASK_0000001563996149__b1991931531175348">if-match vlan 10</strong>

    Classifier: c2
      Type: OR
      <strong id="EN-US_TASK_0000001563996149__b1021404025175348">Rule(s):</strong>
        <strong id="EN-US_TASK_0000001563996149__b862061726175348">if-match vlan 20</strong>

Total classifier number is 2 
</pre>
<p id="EN-US_TASK_0000001563996149__p485839082175348"># Check the traffic policy configuration.</p>
<pre class="screen" id="EN-US_TASK_0000001563996149__screen514937312175348">&lt;<span class="keyword" id="EN-US_TASK_0000001563996149__keyword113532083175348">Device</span>B&gt; <strong id="EN-US_TASK_0000001563996149__b332190497175348">display traffic policy</strong>
  Traffic Policy Information:
    Policy: p1
      Classifier: c1
        Type: OR
      Behavior: b1
        <strong id="EN-US_TASK_0000001563996149__b818761399175348">Remark:</strong>
          <strong id="EN-US_TASK_0000001563996149__b1486598037175348">Remark 8021p 4</strong>

    Policy: p2
      Classifier: c2
        Type: OR
      Behavior: b2
        <strong id="EN-US_TASK_0000001563996149__b676121747175348">Remark:</strong>
          <strong id="EN-US_TASK_0000001563996149__b1041537601175348">Remark 8021p 2</strong>

Total policy number is 2
</pre>
<p id="EN-US_TASK_0000001563996149__p1249506835175348"># Check the traffic policy application records.</p>
<pre class="screen" id="EN-US_TASK_0000001563996149__screen742316760175348">&lt;<span class="keyword" id="EN-US_TASK_0000001563996149__keyword1529011752175348">Device</span>B&gt; <strong id="EN-US_TASK_0000001563996149__b1095114097175348">display traffic-policy applied-record</strong>
Total records : 2 
--------------------------------------------------------------------------------     
Policy Type/Name                     Apply Parameter             Slot State          
--------------------------------------------------------------------------------            
p1                                   <span>100GE</span><span>1/0/2</span>(IN)                  <span>1</span> <strong id="EN-US_TASK_0000001563996149__b7892349276">success</strong>
--------------------------------------------------------------------------------        
p2                                   <span>100GE</span><span>1/0/3</span>(IN)                  <span>1</span> <strong id="EN-US_TASK_0000001563996149__b4163456162819">success</strong>        
--------------------------------------------------------------------------------  </pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001563996149__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Configuration Scripts</h4><p id="EN-US_TASK_0000001563996149__p1354988653175348"><span class="keyword" id="EN-US_TASK_0000001563996149__keyword132981941191418">Device</span>B</p>
<pre class="screen" id="EN-US_TASK_0000001563996149__screen1547646530175348">#
sysname <span class="keyword" id="EN-US_TASK_0000001563996149__keyword823874323175348">DeviceB</span>
#
vlan batch 10 20 30
#
traffic classifier c1 type or 
 if-match vlan 10
#
traffic classifier c2 type or
 if-match vlan 20
#
traffic behavior b1
 remark 8021p 4
#
traffic behavior b2
 remark 8021p 2
#
traffic policy p1
 classifier c1 behavior b1 precedence 5
#
traffic policy p2
 classifier c2 behavior b2 precedence 5
#
interface Vlanif10                                                              
 ip address 192.168.10.1 255.255.255.0                                           
#                                                                               
interface Vlanif20                                                              
 ip address 192.168.20.1 255.255.255.0
#
interface Vlanif30                                                              
 ip address 192.168.100.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/1</span>
 port link-type trunk
 port trunk allow-pass vlan 30 
#
interface <span>100GE</span><span>1/0/2</span>
 port default vlan 10
 traffic-policy p1 inbound
#
interface <span>100GE</span><span>1/0/3</span>
 port default vlan 20
 traffic-policy p2 inbound
#
return</pre>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_qos_remark_cfg_0001.html">Re-marking Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_qos_remark_cfg_0006.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_qos_remark_cfg_0008.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>