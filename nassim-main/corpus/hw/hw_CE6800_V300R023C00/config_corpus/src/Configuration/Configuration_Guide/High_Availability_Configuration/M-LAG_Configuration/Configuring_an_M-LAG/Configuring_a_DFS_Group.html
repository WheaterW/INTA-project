
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a DFS Group">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_cfg_m-lag_0020.html">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_cfg_m-lag_0007.html">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_cfg_m-lag_0013.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="M-LAG">
<meta name="featuretype" content="High Availability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="M-LAG">
<meta name="featuretype" content="High Availability">
<meta name="featurename" content="M-LAG">
<meta name="featuretype" content="High Availability">
<meta name="featuretype" content="High Availability">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001563888769">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Configuring a DFS Group</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001563888769"></a><a name="EN-US_TASK_0000001563888769"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a DFS Group</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001563888769__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>The two M-LAG member devices in a DFS group exchange negotiation packets to determine their master and backup roles based on their DFS group priorities and system MAC addresses, where the device with a higher DFS group priority functions as the M-LAG master device. If the two devices have the same DFS group priority, the device with a smaller system MAC address functions as the M-LAG master device. M-LAG member devices use the DFS group protocol to synchronize information such as the interface status and entries. To improve network security and prevent hackers from performing network attacks aimed at disclosing network information, you need to configure authentication for DFS group synchronization packets.</p>
<p>For the <span>CE6820H, CE6820H-K, and CE6820S</span>: VXLAN-related configurations are not supported.</p>
<p>For the <span>CE6885-LL (low latency mode)</span>: VXLAN and IPv6-related configurations are not supported.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001563888769__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Create a DFS group and enter its view.</span><p><pre class="screen"><a href="cmdqueryname=dfs-group"><b><span class="cmdname">dfs-group</span></b></a> <i><span class="varname">dfs-group-id</span></i></pre>
</p></li><li><span>(Optional) Configure the DFS group priority.</span><p><pre class="screen"><a href="cmdqueryname=priority"><b><span class="cmdname">priority</span></b></a> <i><span class="varname">priorityvalue</span></i></pre>
</p><p><p>By default, the DFS group priority is 100.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the two M-LAG member devices have the same DFS group priority and system MAC address, they both function as M-LAG master devices. In this case, you are advised to configure different DFS group priorities for M-LAG member devices.</p>
</div></div>
</p></li><li><span>Configure the authentication mode and password for DFS group synchronization packets.</span><p><pre class="screen"><a href="cmdqueryname=authentication-mode"><b><span class="cmdname">authentication-mode</span></b></a> <strong><span>hmac-sha256</span></strong> <strong><span>password</span></strong> <i><span class="varname">pwdtext</span></i></pre>
</p><p><p>By default, the authentication mode of DFS group synchronization packets is not configured.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The authentication mode and password must be configured, and the devices in an M-LAG must use the same authentication password.</p>
<p>After the weak password dictionary maintenance function is enabled, the passwords defined in the weak password dictionary cannot be used in the <strong><a href="cmdqueryname=authentication-mode"><b><span class="cmdname">authentication-mode</span></b></a></strong> command.</p>
</div></div>
</p></li><li><span>(Optional) Configure the delay in switching the M-LAG LACP system ID.</span><p><pre class="screen"><a href="cmdqueryname=set+lacp+system-id+switch-delay"><b><span class="cmdname">set lacp system-id switch-delay</span></b></a> { <i><span class="varname">switch-delay-time</span></i> | <strong><span>immediately</span></strong> }</pre>
</p><p><p>If <strong>immediately</strong> is specified, the M-LAG LACP system ID is switched immediately. If <i><span class="varname">switch-delay-time</span></i> is set to 0, the M-LAG LACP system ID is not switched.</p>
<p>By default, the M-LAG LACP system ID is not switched.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>When DFS group pairing is successful, the master device synchronizes its M-LAG LACP system ID to the backup device, and the M-LAG member interface on the backup device uses the synchronized M-LAG LACP system ID to perform LACP negotiation. However, if DFS group pairing fails or the M-LAG splits and the device does not join the M-LAG again within the time specified by <em>switch-delay-time</em>, the M-LAG backup device changes the synchronized M-LAG LACP system ID to its own M-LAG LACP system ID. If the device joins the M-LAG again within the time specified by <em>switch-delay-time</em>, the M-LAG LACP system ID is not switched.</li><li>After a master/backup switchover of M-LAG devices, the M-LAG LACP system ID is not switched.</li></ul>
</div></div>
</p></li><li><span>(Optional) Configure an IP address bound to the TCP channel for transmitting M-LAG protocol synchronization packets. Run either of the following commands. The commands cannot be configured together.</span><p><ul><li>Configure an IPv4 address and a TCP port number bound to the TCP channel for transmitting M-LAG protocol synchronization packets.<pre class="screen"><strong>peer-link source ip</strong> <em>ipv4-address1</em> [ <strong>vpn-instance</strong> <em>vpnname</em> ] <strong>peer</strong> <em>ipv4-address2</em> <strong>tcp-port</strong> <em>portnum</em></pre>
</li><li>Configure an IPv6 address and a TCP port number bound to the TCP channel for transmitting M-LAG protocol synchronization packets.<pre class="screen"><strong>peer-link source ipv6</strong> <em>ipv6-address1</em> [ <strong>vpn-instance</strong> <em>vpnname</em> ] <strong>peer</strong> <em>ipv6-address2</em> <strong>tcp-port</strong> <em>portnum</em></pre>
</li></ul>
<p>By default, no TCP channel is configured for transmitting M-LAG protocol synchronization packets. To improve M-LAG synchronization reliability when a device is dual-homed to an Ethernet, VXLAN, or IP network through an M-LAG, you need to bind the IP addresses and TCP port numbers of the Layer 3 interfaces on the two M-LAG devices to a TCP channel. This TCP channel is used only for ARP and ND entry synchronization between M-LAG devices.</p>
</p></li><li><span>(Optional) Configure the type of packets for electing the M-LAG master and backup member interfaces in an M-LAG in active/standby mode.</span><p><pre class="screen"><a href="cmdqueryname=m-lag+active-standby+election"><b><span class="cmdname">m-lag active-standby election</span></b></a> { <strong><span>arp</span></strong> | <strong><span>nd</span></strong> | <strong><span>igmp</span></strong> | <strong><span>dhcp</span></strong> | <strong><span>mld</span></strong> }</pre>
<p>By default, the type of packets for electing the M-LAG master and backup member interfaces in an M-LAG in active/standby mode is not configured.</p>
<p>For the <span>CE6885-LL (low latency mode)</span>: The <strong>nd</strong> and <strong>mld</strong> packet types cannot be configured.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>If the M-LAG works in active/standby mode, this step is mandatory.</li><li>An M-LAG in active/standby mode elects the M-LAG master and backup member interfaces based on protocol packets received from a server connected to the M-LAG. ARP, ND, IGMP, MLD, and DHCP packets are supported. You can configure the type of packets for electing the M-LAG master and backup member interfaces based on actual requirements. At least one packet type must be configured. To ensure that IGMP/DHCP/MLD packets can be sent to the CPU, you need to enable IGMP snooping in a VLAN or BD so that M-LAG master and backup member interface election can be performed through IGMP packets. Alternatively, you need to enable DHCP globally so that M-LAG master and backup member interface election can be performed through DHCP packets. You can also enable MLD snooping in a VLAN or BD so that M-LAG master and backup member interface election can be performed through MLD packets. In addition, when an M-LAG device functions as a Layer 2 transparent transmission device or Layer 2 gateway, ARP/ND packets are not sent to the CPU, and M-LAG master and backup member interface election cannot be performed through packets for electing the M-LAG master member interface. In this case, you need to enable Layer 2 proxy ARP in a VLAN and enable ARP broadcast suppression or NS multicast suppression in a BD so that ARP/ND packets can be used for M-LAG master and backup member interface election.</li><li>The two devices in an M-LAG must be configured with the same type of packets for electing the M-LAG master and backup member interfaces.</li></ul>
</div></div>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001563888769__en-us_task_0228023023_en-us_task_0228023023_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001563888769__en-us_task_0228023023_en-us_task_0228023023_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../dc/dc_cfg_m-lag_0020.html">Configuring an M-LAG
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../dc/dc_cfg_m-lag_0007.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../dc/dc_cfg_m-lag_0013.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>