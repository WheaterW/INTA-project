
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring ARP Security">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_arp_security_cfg_Example_0018.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="ARP Security">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ARP Security">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="ARP Security">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130622092">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring ARP Security</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130622092"></a><a name="EN-US_TASK_0000001130622092"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring ARP Security</h1>
<div class="taskbody" id="taskbody1578480334698"><div class="context"><a name="EN-US_TASK_0000001130622092__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001130622092__context1903658926214100"><h4 class="sectiontitle">Networking Requirements</h4><div class="p" id="EN-US_TASK_0000001130622092__p278487646214100">As shown in <a href="#EN-US_TASK_0000001130622092__fig_dc_vrp_arp-sec_cfg_001901">Figure 1</a>, Device is connected to the server through <span>100GE</span> <span>1/0/3</span>, to HostA and HostB in VLAN 10 through <span>100GE</span> <span>1/0/1</span>, and to HostC and HostD in VLAN 20 through <span>100GE</span> <span>1/0/2</span>. In this scenario, the following ARP attacks may occur:<ul id="EN-US_TASK_0000001130622092__ul694676686214100"><li id="EN-US_TASK_0000001130622092__li1612899416214100">If the server is attacked, it may send a large number of packets with unreachable destination IP addresses.</li><li id="EN-US_TASK_0000001130622092__li1921699214214100">If HostA is attacked, it may send a large number of bogus ARP messages with different source IP addresses.</li><li id="EN-US_TASK_0000001130622092__li1624382631214100">If HostC is attacked, it may send a large number of ARP messages with fixed source IP addresses.</li><li id="EN-US_TASK_0000001130622092__li568590896214100">If HostD is attacked, it may send a large number of ARP messages with unreachable destination IP addresses.</li></ul>
</div>
<p id="EN-US_TASK_0000001130622092__p363445779214100">To prevent these attacks, configure ARP security on Device.</p>
<div class="fignone" id="EN-US_TASK_0000001130622092__fig_dc_vrp_arp-sec_cfg_001901"><a name="EN-US_TASK_0000001130622092__fig_dc_vrp_arp-sec_cfg_001901"></a><a name="fig_dc_vrp_arp-sec_cfg_001901"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring ARP security</span><div class="note" id="EN-US_TASK_0000001130622092__note1569515446205"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001130622092__p1881111794017">In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, and <span>100GE</span> <span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001130622092__image1944274018271" src="figure/en-us_image_0000001130781926.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130622092__1.3.2"></a><a name="1.3.2"></a>
<div class="p" id="EN-US_TASK_0000001130622092__context1483868322214100"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0000001130622092__p1159240259214100">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0000001130622092__ol1278549838214100"><li id="EN-US_TASK_0000001130622092__li1549030463214100">Configure strict ARP learning globally so that the device learns only address information carried in the ARP reply messages in response to the ARP request messages that the device itself sends.</li><li id="EN-US_TASK_0000001130622092__li182614485214100">Configure ARP entry limiting on an interface to enable the device to limit the number of ARP entries that the interface can learn, preventing an ARP entry overflow.</li><li id="EN-US_TASK_0000001130622092__li1666243433214100">Configure fixed ARP to prevent attackers from sending bogus ARP messages to modify ARP entries.</li><li id="EN-US_TASK_0000001130622092__li101625927214100">Configure rate limiting on ARP messages to limit the number of ARP messages processed per second, reducing system overheads.</li><li id="EN-US_TASK_0000001130622092__li674747794214100">Configure rate limiting on ARP Miss messages to limit the number of ARP Miss messages processed per second, reducing system overheads. In addition, ensure that the device can process a large number of ARP Miss messages from the server.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130622092__1.3.3"></a><a name="1.3.3"></a>
<div class="p" id="EN-US_TASK_0000001130622092__context1574441344214100"><h4 class="sectiontitle">Data Preparation</h4><p id="EN-US_TASK_0000001130622092__p22121539214100">To complete the configuration, you need the following data:</p>
<ul id="EN-US_TASK_0000001130622092__ul666541965214100"><li id="EN-US_TASK_0000001130622092__li1676539900214100">Limit on the number of ARP entries that an interface can learn: 20</li><li id="EN-US_TASK_0000001130622092__li670720963214100">Mode of fixed ARP: fixed-mac</li><li id="EN-US_TASK_0000001130622092__li582794392214100">Rate limit for ARP messages: 15</li><li id="EN-US_TASK_0000001130622092__li731472648214100">Rate limit for ARP Miss messages: 30 for HostD; 20 for other hosts; 50 for the server</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130622092__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001130622092__steps1081461562214100"><li id="EN-US_TASK_0000001130622092__step1776685471214100"><span id="EN-US_TASK_0000001130622092__cmd2140083209214100">Configure IP addresses and routing protocols for the interfaces. For detailed configurations, see <a href="#EN-US_TASK_0000001130622092__p2087070106214100">Configuration Scripts</a>.</span></li><li id="EN-US_TASK_0000001130622092__step195635677214100"><span id="EN-US_TASK_0000001130622092__cmd251359782214100">Configure strict ARP learning.</span><p><pre class="screen" id="EN-US_TASK_0000001130622092__screen198212420510">&lt;<span class="keyword" id="EN-US_TASK_0000001130622092__keyword171158421359">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001130622092__b011513421855">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001130622092__keyword166339135719"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001130622092__keyword511516427516">HUAWEI</span>] <strong id="EN-US_TASK_0000001130622092__b1311564211518">sysname Device</strong>
[<span class="keyword" id="EN-US_TASK_0000001130622092__keyword1028113754218">*</span>Device] <strong id="EN-US_TASK_0000001130622092__b151152421152">arp learning strict</strong>
[<span class="keyword" id="EN-US_TASK_0000001130622092__keyword1861113085511">*</span>Device] <span><strong id="EN-US_TASK_0000001130622092__b75043618568">commit</strong></span></pre>
</p></li><li id="EN-US_TASK_0000001130622092__step390171951214100"><span id="EN-US_TASK_0000001130622092__cmd1352406166214100">Configure an ARP entry limit for an interface.</span><p><p id="EN-US_TASK_0000001130622092__p966338126214100"># Set an ARP entry limit to 20 for VLAN 10 on <span>100GE</span><span>1/0/1</span>.</p>
<pre class="screen" id="EN-US_TASK_0000001130622092__screen2088554032214100">[<span class="keyword" id="EN-US_TASK_0000001130622092__keyword13150428124217"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong id="EN-US_TASK_0000001130622092__b657241502214100">interface <span>100ge</span><span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130622092__keyword1167811116296"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130622092__b95056278290">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130622092__keyword1516193984211">*</span>Device-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130622092__b1313862513113">arp limit vlan 10 20</strong>
[<span class="keyword" id="EN-US_TASK_0000001130622092__keyword9302114064214">*</span>Device-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130622092__b1513814259117">quit</strong>
<span>[<span class="keyword" id="EN-US_TASK_0000001130622092__keyword25044635613">*</span><span class="keyword" id="EN-US_TASK_0000001130622092__keyword773681645618">Device</span>] <strong id="EN-US_TASK_0000001130622092__b144212185716">commit</strong></span></pre>
<p id="EN-US_TASK_0000001130622092__p2003095824214100"># Configure an ARP entry limit for <span>100GE</span> <span>1/0/2</span> and <span>100GE</span> <span>1/0/3</span>. For configuration details, see the configuration of <span>100GE</span> <span>1/0/1</span>.</p>
</p></li><li id="EN-US_TASK_0000001130622092__step1732053005214100"><span id="EN-US_TASK_0000001130622092__cmd1474019950214100">Configure fixed ARP.</span><p><pre class="screen" id="EN-US_TASK_0000001130622092__screen1128064832214100">[<span class="keyword" id="EN-US_TASK_0000001130622092__keyword716114514424"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong id="EN-US_TASK_0000001130622092__b32220108214100">arp anti-attack entry-check fixed-mac enable</strong>
<span>[<span class="keyword" id="EN-US_TASK_0000001130622092__keyword273916385910">*</span><span class="keyword" id="EN-US_TASK_0000001130622092__keyword7739153115912">Device</span>] <strong id="EN-US_TASK_0000001130622092__b773914314599">commit</strong></span></pre>
</p></li><li id="EN-US_TASK_0000001130622092__step116063390214100"><span id="EN-US_TASK_0000001130622092__cmd762244254214100">Configure rate limiting on ARP messages.</span><p><pre class="screen" id="EN-US_TASK_0000001130622092__screen1406582863214100">[<span class="keyword" id="EN-US_TASK_0000001130622092__keyword5899352194218"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong id="EN-US_TASK_0000001130622092__b1452156349214100">arp anti-attack rate-limit source-ip maximum 15</strong>
<span>[<span class="keyword" id="EN-US_TASK_0000001130622092__keyword17548181018587">*</span><span class="keyword" id="EN-US_TASK_0000001130622092__keyword165481310185812">Device</span>] <strong id="EN-US_TASK_0000001130622092__b754881035816">commit</strong></span></pre>
</p></li><li id="EN-US_TASK_0000001130622092__step441671160214100"><span id="EN-US_TASK_0000001130622092__cmd1463702088214100">Configure rate limiting on ARP Miss messages.</span><p><pre class="screen" id="EN-US_TASK_0000001130622092__screen577823210143">[<span class="keyword" id="EN-US_TASK_0000001130622092__keyword1691225344218"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device] <strong id="EN-US_TASK_0000001130622092__b177941832121415">arp miss anti-attack rate-limit source-ip 10.10.10.10 maximum 30</strong>
[<span><span class="keyword" id="EN-US_TASK_0000001130622092__keyword191862056134210">*</span></span>Device] <strong id="EN-US_TASK_0000001130622092__b10794123271419">arp miss anti-attack rate-limit source-ip maximum 20</strong>
[<span><span class="keyword" id="EN-US_TASK_0000001130622092__keyword11856257164220">*</span></span>Device] <strong id="EN-US_TASK_0000001130622092__b17795153219140">arp miss anti-attack rate-limit source-ip 10.20.20.20 maximum 50</strong>
<span>[<span class="keyword" id="EN-US_TASK_0000001130622092__keyword208581723165813">*</span><span class="keyword" id="EN-US_TASK_0000001130622092__keyword085820237587">Device</span>] <strong id="EN-US_TASK_0000001130622092__b185832365812">commit</strong></span></pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001130622092__example02972462395"><a name="EN-US_TASK_0000001130622092__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0000001130622092__p873091903214100"># Run the <strong><span id="EN-US_TASK_0000001130622092__cmdparmname1645676528214100">display arp learning strict</span></strong> command to check the configuration of strict ARP learning.</p>
<pre class="screen" id="EN-US_TASK_0000001130622092__screen361300423214100">&lt;<span class="keyword" id="EN-US_TASK_0000001130622092__keyword985215549146">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001130622092__b510152274214100">display arp learning strict</strong>
 The global arp learning strict state:enable
------------------------------------------------------------
 Interface                           LearningStrictState
------------------------------------------------------------
------------------------------------------------------------
 Total:0     Force-enable:0     Force-disable:0</pre>
<p id="EN-US_TASK_0000001130622092__p1818563954511"># Run the <strong><span id="EN-US_TASK_0000001130622092__cmdparmname1723492628214100">display arp limit</span></strong> command to check the ARP entry limit configured on <span>100GE</span> <span>1/0/1</span>.</p>
<pre class="screen" id="EN-US_TASK_0000001130622092__screen1032305150214100">&lt;<span class="keyword" id="EN-US_TASK_0000001130622092__keyword1488165211513">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001130622092__b2001143286214100">display arp limit interface <span>100ge</span><span>1/0/1</span></strong>
Interface                 VLAN     Limit        Learnt
---------------------------------------------------------------------------
 <span>100GE</span><span>1/0/1</span>                 10       20            0
---------------------------------------------------------------------------
 Total:1 </pre>
<p id="EN-US_TASK_0000001130622092__p1918853914454"># Run the <strong><span id="EN-US_TASK_0000001130622092__cmdparmname1293354695214100">display arp miss anti-attack rate-limit</span></strong> command to check the rate limits configured for ARP Miss messages.</p>
<pre class="screen" id="EN-US_TASK_0000001130622092__screen747787840214100">&lt;<span class="keyword" id="EN-US_TASK_0000001130622092__keyword10829185418512">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001130622092__b109791463485">display arp miss anti-attack rate-limit</strong>
Global ARP miss rate-limit  :  500 (0 means no limit)

VLAN ID          Suppress Rate(pps)(0 means no limit)
-------------------------------------------------------------------------------
All                 0
-------------------------------------------------------------------------------
Total: 0, spec of rate-limit configuration for VLAN is 1024.

Source IP        Suppress Rate(pps)(0 means no limit)
-------------------------------------------------------------------------------
10.10.10.10/32          30
10.20.20.20/32          50
Other                   20
-------------------------------------------------------------------------------
Total: 2, spec of rate-limit configuration for Source IP is 1024.</pre>
<p id="EN-US_TASK_0000001130622092__p2019215399452"># Run the <strong><span id="EN-US_TASK_0000001130622092__cmdparmname347150670214100">display arp packet statistics</span></strong> command to check ARP message statistics.</p>
<pre class="screen" id="EN-US_TASK_0000001130622092__screen1837326139214100">&lt;<span class="keyword" id="EN-US_TASK_0000001130622092__keyword127874577513">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001130622092__b644668633214100">display arp packet statistics</strong>
ARP Packets Received
  Total:                      154333
  Learnt Count:                    8
  Discard For Entry Limit:         5
  Discard For Speed Limit:         0
  Discard For Proxy Suppress:      0
  Discard For Other:          151597
ARP Packets Sent 
  Total:                           0
  Request:                         0
  Reply:                           0
  Gratuitous ARP:                  0
ARP-Miss Message Received:  
  Total:                           0
  Discard For Speed Limit:         0
  Discard For Other:               3</pre>
<h4 class="sectiontitle">Configuration Scripts</h4><p id="EN-US_TASK_0000001130622092__p2087070106214100"><a name="EN-US_TASK_0000001130622092__p2087070106214100"></a><a name="p2087070106214100"></a>Device</p>
<pre class="screen" id="EN-US_TASK_0000001130622092__screen11516162114399">#
sysname Device
#
vlan batch 10 20 30
#
arp learning strict
arp anti-attack entry-check fixed-mac enable
arp anti-attack rate-limit source-ip maximum 15
arp miss anti-attack rate-limit source-ip 10.10.10.10 maximum 30
arp miss anti-attack rate-limit source-ip maximum 20
arp miss anti-attack rate-limit source-ip 10.20.20.20 maximum 50
#
interface Vlanif10
 ip address 10.9.9.1 255.255.255.0
#
interface Vlanif20
 ip address 10.10.10.1 255.255.255.0
#
interface Vlanif30
 ip address 10.20.20.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/1</span>
 arp limit vlan 10 20
#
interface <span>100GE</span><span>1/0/2</span>
 arp limit vlan 20 20
#
interface <span>100GE</span><span>1/0/3</span>
 arp limit vlan 30 20
#
return</pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_arp_security_cfg_Example_0018.html">Configuration Examples for ARP Security
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
</div>
</div>
</body>
</html>