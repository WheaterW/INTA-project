
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a Dynamic Routing Protocol for Communication with an M-LAG in V-STP Mode">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_cfg_m-lag_0021.html">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_cfg_m-lag_0042.html">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_cfg_ospf_cfgcase_0085_c.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="M-LAG">
<meta name="featuretype" content="High Availability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="M-LAG">
<meta name="featuretype" content="High Availability">
<meta name="featurename" content="M-LAG">
<meta name="featuretype" content="High Availability">
<meta name="featuretype" content="High Availability">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001513168790">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring a Dynamic Routing Protocol for Communication with an M-LAG in V-STP Mode</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001513168790"></a><a name="EN-US_TASK_0000001513168790"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a Dynamic Routing Protocol for Communication with an M-LAG in V-STP Mode</h1>
<div class="taskbody" id="taskbody1587993028008"><div class="context"><a name="EN-US_TASK_0000001513168790__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_context776424945175357"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p1561190445175357">On the network shown in <a href="#EN-US_TASK_0000001513168790__fig7533163320230">Figure 1</a>, DeviceA, DeviceB, and DeviceC constitute an M-LAG. The M-LAG member interfaces on DeviceB and DeviceC support dynamic routing protocols. A dynamic routing protocol is configured on DeviceA so that it can communicate with the M-LAG through Layer 3 routes.</p>
<div class="fignone" id="EN-US_TASK_0000001513168790__fig7533163320230"><a name="EN-US_TASK_0000001513168790__fig7533163320230"></a><a name="fig7533163320230"></a><span class="figcap"><b>Figure 1 </b>Network diagram for configuring a dynamic routing protocol for communication with an M-LAG</span><div class="note" id="EN-US_TASK_0000001513168790__note732211506234"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001513168790__p13322195016233">In this example, interface 1 and interface 2 on DeviceA represent <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span>, respectively.</p>
<p id="EN-US_TASK_0000001513168790__p18322125013238">In this example, interface 1, interface 2, interface 4, interface 5, and interface 6 on DeviceB represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, <span>100GE</span> <span>1/0/4</span>, <span>100GE</span> <span>1/0/5</span>, and MEth0/0/0, respectively.</p>
<p id="EN-US_TASK_0000001513168790__p23231150122318">In this example, interface 1, interface 2, interface 4, interface 5, and interface 6 on DeviceC represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, <span>100GE</span> <span>1/0/4</span>, <span>100GE</span> <span>1/0/5</span>, and MEth0/0/0, respectively.</p>
<p id="EN-US_TASK_0000001513168790__p332312509237">In this example, interface 1 and interface 2 on DeviceD represent <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001513168790__image253303302313" src="figure/en-us_image_0000001913177116.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001513168790__1.3.2"></a><a name="1.3.2"></a>
<div class="p" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_context906235850175357"><h4 class="sectiontitle">Configuration Roadmap</h4><div class="p" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p910403793175357">The configuration roadmap is as follows:<ol id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_ol533368310175357"><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_li1638655901175357">Configure a routing protocol on DeviceB, DeviceC, and DeviceD to implement Layer 3 connectivity.</li><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_li1620671058175357">Create Eth-Trunk interfaces.</li><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_li2044952862175357"><p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p1194465046175357"><a name="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_li2044952862175357"></a><a name="en-us_task_0241512178_en-us_task_0141119105_li2044952862175357"></a>Configure V-STP.</p>
</li><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_li2004751543175357">Configure an M-LAG.<ul id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_ul1595193006175357"><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_li1440292621175357">Configure a DFS group on DeviceB and DeviceC, and bind IP addresses of their management interfaces to the DFS group.</li><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_li2031162790175357">Configure the link between DeviceB and DeviceC as the peer-link.</li><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_li791374812175357">Bind the user-side Eth-Trunk interface to the DFS group on DeviceB and DeviceC, respectively.</li></ul>
</li><li id="EN-US_TASK_0000001513168790__li9189543122320">Configure an IP address for OSPF over M-LAG. Configure different M-LAG IP addresses on DeviceB and DeviceC. Otherwise, neighbor relationships of the routing protocol cannot be established.</li><li id="EN-US_TASK_0000001513168790__li3682748563">Configure M-LAG member devices to use the specified IP address to establish OSPF neighbor relationships with DeviceA.</li></ol>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001513168790__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_steps65163759175357"><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_step1558975079175357"><span id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_cmd246175706175357">Configure a routing protocol.</span><p><p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p71400108175357"># Configure DeviceB. The configurations of DeviceC and DeviceD are similar to the configuration of DeviceB. When configuring OSPF, configure the devices to advertise the 32-bit IP addresses of loopback interfaces.</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_screen600228528175357">&lt;<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword2047729868175357">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1457138222175357">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1539762641175357"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1612760937175357">HUAWEI</span>] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b980713431175357">sysname DeviceB</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword25236127175357">*</span><span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1089308030175357">HUAWEI</span>] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1874301774175357">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword1536412817316"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b771308660175357"> interface loopback 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1183519764175357">*</span>DeviceB-LoopBack2]<strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b2105139799175357"> ip address 10.3.3.3 32</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword191088435175357">*</span>DeviceB-LoopBack2]<strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b171023865175357"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1323633471175357">*</span>DeviceB]<strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b188123386175357"> interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1483805121175357">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>]<strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1399822508175357"> undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword371943045175357">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>]<strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b976104650175357"> ip address 192.168.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1201130854175357">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>]<strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1730168181175357"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1838459818175357">*</span>DeviceB]<strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b106961796175357"> ospf</strong> <strong id="EN-US_TASK_0000001513168790__b19237846131214">1 router-id 10.11.1.1</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword706821514175357">*</span>DeviceB-ospf-1]<strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1210244500175357"> area 0</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1790873017175357">*</span>DeviceB-ospf-1-area-0.0.0.0]<strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1076874908175357"> network 10.3.3.3 0.0.0.0</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1767565367175357">*</span>DeviceB-ospf-1-area-0.0.0.0]<strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1661387597175357"> network 192.168.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1121023011175357">*</span>DeviceB-ospf-1-area-0.0.0.0]<strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b696927850175357"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1387149426175357">*</span>DeviceB-ospf-1]<strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b687415225175357"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1219547931175357">*</span>DeviceB]<strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b812424680175357"> commit</strong></pre>
<p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p945149705175357">After OSPF is configured successfully, DeviceB, DeviceC, and DeviceD can learn the IP address of each other's loopback interface through OSPF and successfully ping each other.</p>
</p></li><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_step672543072175357"><span id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_cmd1224976943175357">Create Eth-Trunk interfaces and add physical Ethernet interfaces to them.</span><p><p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p1095503602175357">The uplink interfaces that connect a server to two switches must be added to an Eth-Trunk interface, and the working mode of the Eth-Trunk interface must be the same as that of the Eth-Trunk interfaces on both switches.</p>
<p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p1524609258175357"># Create Eth-Trunk interfaces in LACP mode on DeviceB and add member interfaces to the Eth-Trunk interfaces. The configuration of DeviceC is similar to that of DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_screen1245355579175357">[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword673047425175357"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1288390482175357">interface eth-trunk 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword568276051175357">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1725015921175357">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1672389363175357">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1553014528175357">trunkport <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1724445370175357">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1596705467175357">trunkport <span>100ge</span> <span>1/0/5</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1810556335175357">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1319623390175357">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword138963269611">*</span>DeviceB] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1501120191175357">vlan batch 10</strong><strong id="EN-US_TASK_0000001513168790__b3578115815401">0</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1668706438175357">*</span>DeviceB] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1964478471175357">interface eth-trunk 10</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword54033347175357">*</span>DeviceB-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b2040865781175357">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword674218551296">*</span>DeviceB-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__b12742555497">port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword01097518378">*</span>DeviceB-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__b22385101386">undo port trunk allow-pass vlan 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword5907453143711">*</span>DeviceB-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__b19377644173816">port trunk allow-pass vlan 100</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword188981542185620">*</span>DeviceB-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__b4147115111569">lacp mixed-rate link enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword20021251175357">*</span>DeviceB-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b155476002175357">trunkport <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1255860528175357">*</span>DeviceB-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b149097420175357">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1509169167175357">*</span>DeviceB] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b345840805175357">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_step1799079980175357"><span id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_cmd567474100175357">Configure V-STP.</span><p><p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p1778418510175357"># Configure DeviceB. The configuration of DeviceC is similar to that of DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_screen425771651175357">[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword486628632175357"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1933626077175357"> stp mode rstp</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1967745983175357">*</span>DeviceB]<strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b496971529175357"> stp v-stp enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword17811120191516">*</span>DeviceB] <strong id="EN-US_TASK_0000001513168790__b2811172019157">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_step1547619907175357"><span id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_cmd525844485175357">Configure a DFS group on DeviceB and DeviceC, and bind IP addresses of their management interfaces to the DFS group. Ensure that DeviceB and DeviceC can communicate at Layer 3 through their management interfaces.</span><p><p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p894358756175357"># Configure DeviceB. The configuration of DeviceC is similar to that of DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_screen1225598360175357">[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword91261234114711"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong id="EN-US_TASK_0000001513168790__b11126163418477"> interface meth 0/0/0</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword13126103420477"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-MEth0/0/0]<strong id="EN-US_TASK_0000001513168790__b4126934124713"> ip address 10.200.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword812617347471">*</span>DeviceB-MEth0/0/0]<strong id="EN-US_TASK_0000001513168790__b14126113414711"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword17319714171113">*</span>DeviceB] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1071944577175357">dfs-group 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1029296652175357">*</span>DeviceB-dfs-group-1] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512096_b1009210466175337">dual-active detection </strong><strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b2034195960175357">source ip 10.200.1.1</strong><strong id="EN-US_TASK_0000001513168790__b10922720114017"> peer </strong><strong id="EN-US_TASK_0000001513168790__b2081944403919">10.200.2.1</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword19157281401">*</span>DeviceB-dfs-group-1] <strong id="EN-US_TASK_0000001513168790__b4177927124210">authentication-mode hmac-sha256 password</strong> <strong id="EN-US_TASK_0000001513168790__b819514613313">YsHsjx_202206</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1639893509175357">*</span>DeviceB-dfs-group-1] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b2070594033175357">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword945060872175357">*</span>DeviceB] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1639672376175357">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_step1210398111175357"><span id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_cmd48463546175357">Configure the link between DeviceB and DeviceC as the peer-link.</span><p><p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p1645784551175357"># Configure DeviceB. The configuration of DeviceC is similar to that of DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_screen1285771426175357">[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword931416811175357"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b339949910175357">interface eth-trunk 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword592109663175357"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b878783722175357">peer-link 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword862344627175357">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1831210235175357">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1340067402175357">*</span>DeviceB] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b46899304175357">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_step2076010995175357"><span id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_cmd1349980156175357">Bind the user-side Eth-Trunk interface to the DFS group on DeviceB and DeviceC, respectively.</span><p><p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p1381773976175357"># Configure DeviceB. The configuration of DeviceC is similar to that of DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_screen1109880700175357">[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword817738256175357"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1018530537175357">interface eth-trunk 10</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1235587383175357"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b896409510175357">dfs-group 1 m-lag 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1336254218175357">*</span>DeviceB-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b499711454175357">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword438555944175357">*</span>DeviceB] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1827075390175357">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_step1412158524175357"><span id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_cmd159046224175357">Configure an IP address for OSPF over M-LAG on DeviceB and DeviceC, respectively.</span><p><p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p1330422955175357"># Configure DeviceB. The configuration of DeviceC is similar to that of DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_screen1708527671175357">[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword29671854269"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1033021853175357">interface vlanif 10</strong><strong id="EN-US_TASK_0000001513168790__b199502834117">0</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword151559199175357">*</span>DeviceB-Vlanif100] <strong id="EN-US_TASK_0000001513168790__b1173820315429">ip address 10.100.0.1 255.255.255.0</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1622705645175357">*</span>DeviceB-Vlanif100] <strong id="EN-US_TASK_0000001513168790__b20436103144711">ospf source sub-address 10.100.0.3</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword10861449472">*</span>DeviceB-Vlanif100] <strong id="EN-US_TASK_0000001513168790__b693303684716">m-lag ip address 10.100.0.3 255.255.255.0</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword784771111816">*</span>DeviceB-Vlanif100] <strong id="EN-US_TASK_0000001513168790__b2374122712189">mac-address 0000-5e00-0101</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword18499020458">*</span>DeviceB-Vlanif100]<strong id="EN-US_TASK_0000001513168790__b17847200114516"> arp proxy enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword1123105931810">*</span>DeviceB-Vlanif100] <strong id="EN-US_TASK_0000001513168790__b1714411711917">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1774181130175357">*</span>DeviceB] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1300394303175357">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001513168790__step18326936112312"><span id="EN-US_TASK_0000001513168790__cmd11326163619237">Configure M-LAG member devices to use the specified IP address to establish OSPF neighbor relationships with DeviceA. The ID of the OSPF area to which DeviceA, DeviceB, and DeviceC belong must be different from the ID of the OSPF area to which DeviceB, DeviceC, and DeviceD belong.</span><p><div class="p" id="EN-US_TASK_0000001513168790__p172415382413"># Configure DeviceB. The configuration of DeviceC is similar to that of DeviceB.<pre class="screen" id="EN-US_TASK_0000001513168790__screen35007171244">[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword5817104611312"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong id="EN-US_TASK_0000001513168790__b038312246247"> ospf</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword111771971261"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-ospf-1]<strong id="EN-US_TASK_0000001513168790__b238310241240"> area 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword17383202442416">*</span>DeviceB-ospf-1-area-0.0.0.1]<strong id="EN-US_TASK_0000001513168790__b1738322452419"> network 10.100.0.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword1438372416247">*</span>DeviceB-ospf-1-area-0.0.0.1]<strong id="EN-US_TASK_0000001513168790__b143833246248"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword3383102414240">*</span>DeviceB-ospf-1]<strong id="EN-US_TASK_0000001513168790__b1838402442412"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword143841524102417">*</span>DeviceB]<strong id="EN-US_TASK_0000001513168790__b13384524152410"> commit</strong></pre>
</div>
<p id="EN-US_TASK_0000001513168790__p184841243520"># Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__screen73961428163510">&lt;<span class="keyword" id="EN-US_TASK_0000001513168790__keyword216515464225">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001513168790__b31651046192216">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword7165174613222"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001513168790__keyword1816564602212">HUAWEI</span>] <strong id="EN-US_TASK_0000001513168790__b10165164618221">sysname DeviceA</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword2771834102217">*</span><span class="keyword" id="EN-US_TASK_0000001513168790__keyword1771143412225">HUAWEI</span>] <strong id="EN-US_TASK_0000001513168790__b197711734162217">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword049565613361"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001513168790__b349645611368">vlan batch 10</strong><strong id="EN-US_TASK_0000001513168790__b20496165673612">0</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword1150518400162">*</span>DeviceA] <strong id="EN-US_TASK_0000001513168790__b8505154041613">interface eth-trunk 10</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword25051840171611">*</span>DeviceA-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__b9506134016166">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword165061140151618">*</span>DeviceA-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__b850664014168">port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword10506134011164">*</span>DeviceA-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__b75061240131619">undo port trunk allow-pass vlan 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword1950634061619">*</span>DeviceA-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__b135061140131615">port trunk allow-pass vlan 100</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword1450684016161">*</span>DeviceA-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__b850664021617">lacp mixed-rate link enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword370235212175">*</span>DeviceA-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__b199017431718">trunkport <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword14506164013165">*</span>DeviceA-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__b9506114014163">trunkport <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword11255121791815">*</span>DeviceA-Eth-Trunk10] <strong id="EN-US_TASK_0000001513168790__b19450142710187">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword6660195171816">*</span>DeviceA] <strong id="EN-US_TASK_0000001513168790__b1866075119186">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword1049605603610">*</span>DeviceA] <strong id="EN-US_TASK_0000001513168790__b13496205618362">interface vlanif 10</strong><strong id="EN-US_TASK_0000001513168790__b84968568368">0</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword449695613363">*</span>DeviceA-Vlanif100] <strong id="EN-US_TASK_0000001513168790__b13496956133613">ip address 10.100.0.2 255.255.255.0</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword1049610561365">*</span>DeviceA-Vlanif100] <strong id="EN-US_TASK_0000001513168790__b2049645615366">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword5496165618366">*</span>DeviceA] <strong id="EN-US_TASK_0000001513168790__b1549612566365">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword10490438143614"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001513168790__b167171142211">ospf 1 router-id 10.11.4.4</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword10538125217396">*</span>DeviceA-ospf-1]<strong id="EN-US_TASK_0000001513168790__b8538852133919"> area 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword95381052173917">*</span>DeviceA-ospf-1-area-0.0.0.1]<strong id="EN-US_TASK_0000001513168790__b2053885210390"> network 10.100.0.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword1953865263913">*</span>DeviceA-ospf-1-area-0.0.0.1]<strong id="EN-US_TASK_0000001513168790__b145381252193920"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword4538105214395">*</span>DeviceA-ospf-1]<strong id="EN-US_TASK_0000001513168790__b55381521392"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword9538185263910">*</span>DeviceA]<strong id="EN-US_TASK_0000001513168790__b253835217393"> commit</strong></pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_example591225140175357"><a name="EN-US_TASK_0000001513168790__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p425859797175357"># Run the <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1624523668175357">display dfs-group 1 m-lag</strong> command to check M-LAG information.</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_screen1229643101175357">[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1526955298175357"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_b1057440868175357">display dfs-group 1 m-lag</strong>
*                     : Local node
Heart beat state      : OK
Node 1 *
  Dfs-Group ID        : 1
  Priority            : 100
  Dual-active Address : 10.200.1.1
  VPN-Instance        : public net
  State               : <strong id="EN-US_TASK_0000001513168790__b715194517273">Master</strong>
  Causation           : -
  System ID           : 00e0-fc12-3457
  SysName             : DeviceB
  Version             : <span class="keyword" id="EN-US_TASK_0000001513168790__keyword4459185815183">V300R023C00</span>
  Device Type         : <span>CE6860-SAN</span>
Node 2
  Dfs-Group ID        : 1
  Priority            : 100
  Dual-active Address : 10.200.2.1
  VPN-Instance        : public net
  State               : <strong id="EN-US_TASK_0000001513168790__b151684498278">Backup</strong>
  Causation           : -
  System ID           : 00e0-fc12-3458
  SysName             : DeviceC
  Version             : <span class="keyword" id="EN-US_TASK_0000001513168790__keyword2242050143212">V300R023C00</span>
  Device Type         : <span>CE6860-SAN</span></pre>
<p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p2138772448175357"># Check M-LAG information on DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__screen15801112010473">[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword392982514716"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001513168790__b1292917258473">display dfs-group 1 node 1 m-lag brief</strong>
* - Local node

M-Lag ID     Interface      Port State    Status                Consistency-check
       1     Eth-Trunk 10   <strong id="EN-US_TASK_0000001513168790__b15929325154715">Up</strong>            active(*)-active      --

Failed reason:
    1 -- Relationship between vlan and port is inconsistent
    2 -- STP configuration under the port is inconsistent
    3 -- STP port priority configuration is inconsistent
    4 -- LACP mode of M-LAG is inconsistent
    5 -- M-LAG configuration is inconsistent
    6 -- The number of M-LAG members is inconsistent
    7 -- LACP system-id of M-LAG is inconsistent
    8 -- LACP priority of M-LAG is inconsistent
    9 -- STP port edged configuration is inconsistent
    10 -- M-LAG mode configuration is inconsistent</pre>
<p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p1090731227175357"># Check M-LAG information on DeviceC.</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__screen3192192216489">[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword159713263481"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001513168790__b169711326114810">display dfs-group 1 node 2 m-lag brief</strong>
* - Local node

M-Lag ID     Interface      Port State    Status                Consistency-check
       1     Eth-Trunk 10   <strong id="EN-US_TASK_0000001513168790__b997117265482">Up</strong>            active-active(*)      --

Failed reason:
    1 -- Relationship between vlan and port is inconsistent
    2 -- STP configuration under the port is inconsistent
    3 -- STP port priority configuration is inconsistent
    4 -- LACP mode of M-LAG is inconsistent
    5 -- M-LAG configuration is inconsistent
    6 -- The number of M-LAG members is inconsistent
    7 -- LACP system-id of M-LAG is inconsistent
    8 -- LACP priority of M-LAG is inconsistent
    9 -- STP port edged configuration is inconsistent
    10 -- M-LAG mode configuration is inconsistent</pre>
<p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p1201775087175357">Run the <a href="cmdqueryname=display+ospf+peer+brief"><b><span class="cmdname" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_cmdname1695526771175357">display ospf peer brief</span></b></a> command on DeviceB, DeviceC, and DeviceA to check OSPF neighbor information.</p>
<p id="EN-US_TASK_0000001513168790__p2284195731816"># Check OSPF neighbor information on DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_screen197051639175357">[<span class="keyword" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_keyword1597825919175357"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <a href="cmdqueryname=display+ospf+peer+brief"><b><span class="cmdname" id="EN-US_TASK_0000001513168790__cmdname010033717466">display ospf peer brief</span></b></a>
(M) Indicates MADJ interface
        OSPF Process 1 with Router ID 10.11.1.1                    
                  Peer Statistic Information   
  Total number of peer(s): 3                                                       
  Peer(s) in full state: 3   
  ----------------------------------------------------------------------------
  Area Id         Interface                  Neighbor id      State
  0.0.0.0         <span>100GE</span><span>1/0/1</span>                  10.11.3.3         Full
  0.0.0.1         Vlanif100                  10.11.2.2         Full  
  0.0.0.1         Vlanif100                  10.11.4.4         Full</pre>
<p id="EN-US_TASK_0000001513168790__p1553154781813"># Check OSPF neighbor information on DeviceC.</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__screen26081539131820">[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword1868124212191"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <a href="cmdqueryname=display+ospf+peer+brief"><b><span class="cmdname" id="EN-US_TASK_0000001513168790__cmdname13681642141917">display ospf peer brief</span></b></a>
(M) Indicates MADJ interface
        OSPF Process 1 with Router ID 10.11.2.2                    
                  Peer Statistic Information   
  Total number of peer(s): 3                                                       
  Peer(s) in full state: 3   
  ----------------------------------------------------------------------------
  Area Id         Interface                  Neighbor id      State
  0.0.0.0         <span>100GE</span><span>1/0/1</span>                  10.11.3.3         Full
  0.0.0.1         Vlanif100                  10.11.1.1         Full  
  0.0.0.1         Vlanif100                  10.11.4.4         Full</pre>
<p id="EN-US_TASK_0000001513168790__p139537518200"># Check OSPF neighbor information on DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__screen2054511613215">[<span class="keyword" id="EN-US_TASK_0000001513168790__keyword127061115122115"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <a href="cmdqueryname=display+ospf+peer+brief"><b><span class="cmdname" id="EN-US_TASK_0000001513168790__cmdname1970651515216">display ospf peer brief</span></b></a>
(M) Indicates MADJ interface
        OSPF Process 1 with Router ID 10.11.4.4                    
                  Peer Statistic Information   
  Total number of peer(s): 2                                                       
  Peer(s) in full state: 2   
  ----------------------------------------------------------------------------
  Area Id         Interface                  Neighbor id      State
  0.0.0.1         Vlanif100                  10.11.1.1         Full  
  0.0.0.1         Vlanif100                  10.11.2.2         Full</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001513168790__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_ul857927506175357"><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_li1130484752175357"><p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p1269401855175357"><a name="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_li1130484752175357"></a><a name="en-us_task_0241512178_en-us_task_0141119105_li1130484752175357"></a>DeviceB</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_screen631722101175357">#
sysname DeviceB
#
dfs-group 1
<strong id="EN-US_TASK_0000001513168790__b636510421404"> </strong>dual-active detection source ip 10.200.1.1 peer 10.200.2.1
 authentication-mode hmac-sha256 password %+%##!!!!!!!!!"!!!!"!!!!*!!!!C+tR0CW9x*eB&amp;pWp`t),Azgw-h\o8#4LZPD!!!!!!!!!!!!!!!9!!!!&gt;fwJ)I0E{=:%,*,XRhbH&amp;t0MCy_8=7!!!!!!!!!!%+%# 
#
vlan batch 100
#
stp mode rstp
stp v-stp enable
#
interface Vlanif100
 ip address 10.100.0.1 255.255.255.0
 ospf source sub-address 10.100.0.3
 mac-address 0000-5e00-0101
 m-lag ip address 10.100.0.3 255.255.255.0
 arp proxy enable
#
interface Eth-Trunk1
 mode lacp-static
 peer-link 1
#
interface Eth-Trunk10
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 100
 mode lacp-static
 lacp mixed-rate link enable
 dfs-group 1 m-lag 1
#
interface MEth0/0/0
 ip address 10.200.1.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.1.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 eth-trunk 10
#
interface <span>100GE</span><span>1/0/4</span>
 eth-trunk 1
#
interface <span>100GE</span><span>1/0/5</span>
 eth-trunk 1
#
interface LoopBack2
 ip address 10.3.3.3 255.255.255.255
#
ospf 1 router-id 10.11.1.1
 area 0.0.0.0
  network 10.3.3.3 0.0.0.0
  network 192.168.1.0 0.0.0.255
 area 0.0.0.1
  network 10.100.0.0 0.0.0.255
#
return</pre>
</li><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_li1784355733175357"><p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p57674176175357"><a name="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_li1784355733175357"></a><a name="en-us_task_0241512178_en-us_task_0141119105_li1784355733175357"></a>DeviceC</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_screen1393938242175357">#
sysname DeviceC
#
dfs-group 1
 dual-active detection source ip 10.200.2.1 peer 10.200.1.1
 authentication-mode hmac-sha256 password %+%##!!!!!!!!!"!!!!"!!!!*!!!!=I9f8&gt;C{!P_bhB31@7r-=jrS8c|_"(Bn<font style="font-size:8pt" Face="Courier New" >~</font>#=!!!!!!!!!!!!!!!9!!!!kx-6@.tGA(wAt/IQXl6&gt;[g{6YlOi9$!!!!!!!!!!%+%#
#
vlan batch 100
#
stp mode rstp
stp v-stp enable
#
interface Vlanif100
 ip address 10.100.0.1 255.255.255.0
 ospf source sub-address 10.100.0.4
 mac-address 0000-5e00-0101
 m-lag ip address 10.100.0.4 255.255.255.0
<strong id="EN-US_TASK_0000001513168790__b560724116465"> </strong>arp proxy enable
#
interface Eth-Trunk1
 mode lacp-static
 peer-link 1
#
interface Eth-Trunk10
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 100
 mode lacp-static
 lacp mixed-rate link enable
 dfs-group 1 m-lag 1
#
interface MEth0/0/0
 ip address 10.200.2.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.2.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 eth-trunk 10
#
interface <span>100GE</span><span>1/0/4</span>
 eth-trunk 1
#
interface <span>100GE</span><span>1/0/5</span>
 eth-trunk 1
#
interface LoopBack2
 ip address 10.4.4.4 255.255.255.255
#
ospf 1 router-id 10.11.2.2
 area 0.0.0.0
  network 10.4.4.4 0.0.0.0
  network 192.168.2.0 0.0.0.255
 area 0.0.0.1
  network 10.100.0.0 0.0.0.255
#
return</pre>
</li><li id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_li1055353192175357"><p id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_p1253657371175357"><a name="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_li1055353192175357"></a><a name="en-us_task_0241512178_en-us_task_0141119105_li1055353192175357"></a>DeviceD</p>
<pre class="screen" id="EN-US_TASK_0000001513168790__en-us_task_0241512178_en-us_task_0141119105_screen1907766253175357">#
sysname DeviceD
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.1.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.2.2 255.255.255.0
#
interface LoopBack1
 ip address 10.1.1.1 255.255.255.255
#
ospf 1 router-id 10.11.3.3
 area 0.0.0.0
  network 10.1.1.1 0.0.0.0
  network 192.168.1.0 0.0.0.255
  network 192.168.2.0 0.0.0.255
#
return</pre>
</li><li id="EN-US_TASK_0000001513168790__li1687412556423">DeviceA<pre class="screen" id="EN-US_TASK_0000001513168790__screen1741772016434">#
sysname DeviceA
#
vlan batch 100
#
interface Vlanif100
 ip address 10.100.0.2 255.255.255.0
#
interface Eth-Trunk10
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 100
 mode lacp-static
 lacp mixed-rate link enable
#
interface <span>100GE</span><span>1/0/1</span>
 eth-trunk 10
#
interface <span>100GE</span><span>1/0/2</span>
 eth-trunk 10
#
ospf 1 router-id 10.11.4.4
 area 0.0.0.1
  network 10.100.0.0 0.0.0.255
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../dc/dc_cfg_m-lag_0021.html">Configuring a Dynamic Routing Protocol for Communication with an M-LAG
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../dc/dc_cfg_m-lag_0042.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../dc/dc_cfg_ospf_cfgcase_0085_c.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>