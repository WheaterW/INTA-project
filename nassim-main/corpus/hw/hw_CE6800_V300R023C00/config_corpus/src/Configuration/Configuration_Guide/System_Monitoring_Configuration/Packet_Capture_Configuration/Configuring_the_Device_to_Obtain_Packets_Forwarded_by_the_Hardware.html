
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring the Device to Obtain Packets Forwarded by the Hardware">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_CP_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_CP_cfg_0005.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_CP_cfg_0007.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Packet Capture">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Packet Capture">
<meta name="featuretype" content="System Monitoring">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001563992493">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring the Device to Obtain Packets Forwarded by the Hardware</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001563992493"></a><a name="EN-US_TASK_0000001563992493"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring the Device to Obtain Packets Forwarded by the Hardware</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001563992493__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Context</h4><p>If the device fails to forward traffic correctly, you can configure the device to obtain hardware-forwarded packets for analysis. In this way, you can process invalid packets promptly to ensure correct transmission of network data.</p>
<p>Only one instance for obtaining hardware-forwarded packets is supported.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>Enabling the packet capture function affects device performance. Therefore, exercise caution when using this function.</li><li>The device may fail to obtain packets or obtain all packets in some cases (for example, when there are too many packets of a following type: protocol packets sent to the CPU, packets sent by the local device, session update packets, some discarded packets, and obtained packets). In such cases, you are advised to use other methods to obtain packets, such as mirroring.</li></ul>
<ul><li>The hardware-forwarded packets can be obtained on Eth-Trunk interfaces, but not on specified Eth-Trunk member interfaces.</li><li>When using commands to configure the packet capture function, you can configure a maximum of four interfaces to obtain packets.</li></ul>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001563992493__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure an instance for obtaining hardware-forwarded packets.</span><p><p></p>
<p></p>
<p></p>
<p></p>
<p>For device models excluding the CE6885-LL working in low latency mode:</p>
<pre class="screen"><a href="cmdqueryname=capture-packet"><b><span class="cmdname">capture-packet</span></b></a> { { <strong><span>interface</span></strong> { <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> | <i><span class="varname">interface-name</span></i> } &amp;&lt;1-4&gt; } | { <strong><span>acl</span></strong> { <i><span class="varname">acl-number</span></i> | <strong><span>name</span></strong> <i><span class="varname">acl-name</span></i> } } } <sup>*</sup> [ <strong><span>vxlan</span></strong> [ <strong><span>vni</span></strong> <i><span class="varname">vni-id</span></i> ] | [ <strong><span>vlan</span></strong> <i><span class="varname">vlan-id</span></i> | <strong><span>inner-vlan</span></strong> <i><span class="varname">cvlan-id</span></i> ] <sup>*</sup> ] [ <strong><span>clear</span></strong> <strong><span>payload</span></strong> ] <strong><span>destination</span></strong> { <strong><span>file</span></strong> <i><span class="varname">filename</span></i> | <strong><span>terminal</span></strong> } [ <strong><span>time-out</span></strong> <i><span class="varname">time</span></i> | <strong><span>packet-num</span></strong> <i><span class="varname">number</span></i> | <strong><span>packet-len</span></strong> <i><span class="varname">length</span></i> ] <sup>*</sup> [ <strong><span>inbound</span></strong> | <strong><span>outbound</span></strong> ]</pre>
<pre class="screen"><a href="cmdqueryname=capture-packet"><b><span class="cmdname">capture-packet</span></b></a> { { <strong><span>interface</span></strong> { <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> | <i><span class="varname">interface-name</span></i> } &amp;&lt;1-4&gt; } | { <strong><span>acl</span></strong> <strong><span>ipv6</span></strong> { <i><span class="varname">acl-number2</span></i> | <strong><span>name</span></strong> <i><span class="varname">acl-name</span></i> } } } <sup>*</sup> [ <strong><span>vxlan</span></strong> [ <strong><span>vni</span></strong> <i><span class="varname">vni-id</span></i> ] | [ <strong><span>vlan</span></strong> <i><span class="varname">vlan-id</span></i> | <strong><span>inner-vlan</span></strong> <i><span class="varname">cvlan-id</span></i> ] <sup>*</sup> ] [ <strong><span>clear</span></strong> <strong><span>payload</span></strong> ] <strong><span>destination</span></strong> { <strong><span>file</span></strong> <i><span class="varname">filename</span></i> | <strong><span>terminal</span></strong> } [ <strong><span>time-out</span></strong> <i><span class="varname">time</span></i> | <strong><span>packet-num</span></strong> <i><span class="varname">number</span></i> | <strong><span>packet-len</span></strong> <i><span class="varname">length</span></i> ] <sup>*</sup> [ <strong><span>inbound</span></strong> | <strong><span>outbound</span></strong> ]</pre>
<p></p>
<p>For the <span>CE6885-LL (low latency mode)</span>:</p>
<pre class="screen"><a href="cmdqueryname=capture-packet"><b><span class="cmdname">capture-packet</span></b></a> { { <strong><span>interface</span></strong> { <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> | <i><span class="varname">interface-name</span></i> } &amp;&lt;1-4&gt; } | <strong><span>acl</span></strong> { <i><span class="varname">acl-number</span></i> | <strong><span>name</span></strong> <i><span class="varname">acl-name</span></i> } } <sup>*</sup> [ <strong><span>vlan</span></strong> <i><span class="varname">vlan-id</span></i> ] <sup>*</sup> [ <strong><span>clear payload</span></strong> ] <strong><span>destination</span></strong> { <strong><span>file</span></strong> <i><span class="varname">filename</span></i> | <strong><span>terminal</span></strong> } [ <strong><span>time-out</span></strong> <i><span class="varname">time</span></i> | <strong><span>packet-num</span></strong> <i><span class="varname">number</span></i> | <strong><span>packet-len</span></strong> <i><span class="varname">length</span></i> ] <sup>*</sup> <strong>inbound</strong> </pre>
<p></p>
<p></p>
<p></p>
<p>You can configure the command parameters listed in the following table to obtain packets that match specified rules.</p>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="40%" id="mcps1.3.2.1.2.15.1.3.1.1" liSelected="liSelected"><p>Parameter</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="60%" id="mcps1.3.2.1.2.15.1.3.1.2" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="40%" headers="mcps1.3.2.1.2.15.1.3.1.1 "><p><strong><span>interface</span></strong> { <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> }</p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.2.1.2.15.1.3.1.2 "><p>Obtains packets on a specified interface.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="40%" headers="mcps1.3.2.1.2.15.1.3.1.1 "><p><strong><span>acl</span></strong> [ <strong><span>ipv6</span></strong> ] { <i><span class="varname">acl-number</span></i> | <strong><span>name</span></strong> <i><span class="varname">acl-name</span></i> }</p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.2.1.2.15.1.3.1.2 "><p>Obtains packets that match a specified ACL.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="40%" headers="mcps1.3.2.1.2.15.1.3.1.1 "><p><strong><span>vlan</span></strong> <i><span class="varname">vlan-id</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.2.1.2.15.1.3.1.2 "><p>Obtains packets from a specified VLAN.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="40%" headers="mcps1.3.2.1.2.15.1.3.1.1 "><p><strong><span>inner-vlan</span></strong> <i><span class="varname">cvlan-id</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.2.1.2.15.1.3.1.2 "><p>Obtains packets with a specified inner VLAN ID.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="40%" headers="mcps1.3.2.1.2.15.1.3.1.1 "><p><strong><span>clear payload</span></strong></p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.2.1.2.15.1.3.1.2 "><p>Clears the payload of obtained packets.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="40%" headers="mcps1.3.2.1.2.15.1.3.1.1 "><p><strong><span>destination</span></strong> { <strong><span>terminal</span></strong> | <strong><span>file</span></strong> <i><span class="varname">file-name</span></i> }</p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.2.1.2.15.1.3.1.2 "><ul><li><strong><span>destination terminal</span></strong>: Displays obtained packet information on a terminal.</li><li><strong><span>destination file</span></strong> <i><span class="varname">file-name</span></i>: Saves obtained packet information to a specified .cap file.</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="40%" headers="mcps1.3.2.1.2.15.1.3.1.1 "><p><strong><span>time-out</span></strong> <i><span class="varname">time</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.2.1.2.15.1.3.1.2 "><p>Specifies the timeout period for obtaining packets. The device stops obtaining packets when the timeout period expires.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="40%" headers="mcps1.3.2.1.2.15.1.3.1.1 "><p><strong><span>packet-num</span></strong> <i><span class="varname">number</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.2.1.2.15.1.3.1.2 "><p>Specifies the number of packets to be obtained. The device stops obtaining packets when the specified number of packets are obtained.</p>
<p>You can set <strong><span>packet-num</span></strong> <i><span class="varname">number</span></i> and <strong><span>time-out</span></strong> <i><span class="varname">time</span></i> based on the traffic volume on an interface. Specifically, if a large number of packets are forwarded on the interface, set a small value of <i><span class="varname">time</span></i> and a large value of <i><span class="varname">number</span></i>; otherwise, set a large value of <i><span class="varname">time</span></i> and a small value of <i><span class="varname">number</span></i>.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="40%" headers="mcps1.3.2.1.2.15.1.3.1.1 "><p><strong><span>packet-len</span></strong> <i><span class="varname">length</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.2.1.2.15.1.3.1.2 "><p>Specifies the length of obtained packets to be displayed on the terminal or stored on the storage medium.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="40%" headers="mcps1.3.2.1.2.15.1.3.1.1 "><p><strong>outbound</strong></p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.2.1.2.15.1.3.1.2 "><p>Obtains outgoing packets.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="40%" headers="mcps1.3.2.1.2.15.1.3.1.1 "><p><strong>inbound</strong></p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.2.1.2.15.1.3.1.2 "><p>Obtains incoming packets.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="40%" headers="mcps1.3.2.1.2.15.1.3.1.1 "><p><strong><span>vxlan</span></strong></p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.2.1.2.15.1.3.1.2 "><p>Obtains the VXLAN packets in which the inner packets match the specified conditions.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="40%" headers="mcps1.3.2.1.2.15.1.3.1.1 "><p><strong><span>vni</span></strong> <i><span class="varname">vin-id</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="60%" headers="mcps1.3.2.1.2.15.1.3.1.2 "><p>Obtains the VXLAN packets matching the specified VNI.</p>
</td>
</tr>
</tbody>
</table>
</div>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_CP_cfg_0001.html">Packet Capture Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_CP_cfg_0005.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_CP_cfg_0007.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>