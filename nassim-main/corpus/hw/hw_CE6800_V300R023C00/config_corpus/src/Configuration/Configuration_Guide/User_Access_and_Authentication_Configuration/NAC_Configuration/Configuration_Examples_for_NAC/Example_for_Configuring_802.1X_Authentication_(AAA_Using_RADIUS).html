
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring 802.1X Authentication (AAA Using RADIUS)">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_cfg_nac_0245.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_nac_cfg_0066.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="802.1X Authentication">
<meta name="featurename" content="NAC">
<meta name="featuretype" content="User Access and Authentication">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="802.1X Authentication">
<meta name="featurename" content="MAC Address Authentication">
<meta name="featurename" content="NAC">
<meta name="featuretype" content="User Access and Authentication">
<meta name="featuretype" content="User Access and Authentication">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001564120297">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring  802.1X Authentication (AAA Using RADIUS)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001564120297"></a><a name="EN-US_TASK_0000001564120297"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring  802.1X Authentication (AAA Using RADIUS)</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001564120297__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0000001564120297__fig_01">Figure 1</a>, terminals in a company's office area are connected to the company's intranet through DeviceA. The downlink interfaces (for example, <span>100GE</span> <span>1/0/2</span>) of DeviceA are directly connected to terminals in the office area, and the uplink interface <span>100GE</span> <span>1/0/1</span> of DeviceA is connected to the RADIUS server through the intranet.</p>
<p>To meet the company's high security requirements, 802.1X authentication needs to be configured to authenticate terminals in the office area through the RADIUS server. Additionally, authentication points need to be deployed on DeviceA's interfaces (for example, <span>100GE</span> <span>1/0/2</span>) that are directly connected to the terminals.</p>
<div class="fignone" id="EN-US_TASK_0000001564120297__fig_01"><a name="EN-US_TASK_0000001564120297__fig_01"></a><a name="fig_01"></a><span class="figcap"><b>Figure 1 </b>Network diagram for configuring 802.1X authentication</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1 and interface 2 represent <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span>, respectively.</p>
</div></div>
<br><span><img src="figure/en-us_image_0000002209819389.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001564120297__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>In the 802.1X authentication scenario, if there is a Layer 2 switch between the 802.1X-enabled device and users, Layer 2 transparent transmission must be enabled for 802.1X authentication packets on the Layer 2 switch; otherwise, users cannot be successfully authenticated. This function needs to be configured on all interfaces through which 802.1X authentication packets pass.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001564120297__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure network connectivity.</span><p><p># Create VLANs, configure the allowed VLANs on interfaces, and configure IP addresses for interfaces.</p>
<pre class="screen">&lt;HUAWEI&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>HUAWEI] <strong>sysname DeviceA</strong>
[<span class="keyword">*</span><span class="keyword">DeviceA</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>vlan batch 10 20</strong>
[<span class="keyword">*</span><span class="keyword">DeviceA</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>portswitch</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>port link-type trunk</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>port trunk allow-pass vlan 10</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface vlanif 10</strong>
[<span class="keyword">*</span>DeviceA-Vlanif10] <strong>ip address 192.168.1.10 24</strong>
[<span class="keyword">*</span>DeviceA-Vlanif10] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>port link-type access</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>port default vlan 20</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface vlanif 20</strong>
[<span class="keyword">*</span>DeviceA-Vlanif20] <strong>ip address 192.168.2.10 24</strong>
[<span class="keyword">*</span>DeviceA-Vlanif20] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">DeviceA</span>] <strong>commit</strong></pre>
</p></li><li><span>Configure AAA.</span><p><p># Create and configure the RADIUS server template <strong>rd1</strong>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>radius-server template rd1</strong>
[<span class="keyword">*</span>DeviceA-radius-rd1] <strong>radius-server authentication 192.168.1.30 1812</strong>
[<span class="keyword">*</span>DeviceA-radius-rd1] <strong>radius-server shared-key cipher Huawei@123456789</strong>
[<span class="keyword">*</span>DeviceA-radius-rd1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">DeviceA</span>] <strong>commit</strong></pre>
<p># Create the AAA authentication scheme <strong>abc</strong> and set the authentication mode to RADIUS authentication.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>aaa</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-aaa] <strong>authentication-scheme abc</strong>
[<span class="keyword">*</span>DeviceA-aaa-authen-abc] <strong>authentication-mode radius</strong>
[<span class="keyword">*</span>DeviceA-aaa-authen-abc] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">DeviceA</span>] <strong>commit</strong></pre>
<p># Create the authentication domain <strong>example.com</strong>, and bind the authentication scheme <strong>abc</strong> and RADIUS server template <strong>rd1</strong> to the domain.</p>
<pre class="screen">[<span class="keyword">*</span>DeviceA-aaa] <strong>domain example.com</strong>
[<span class="keyword">*</span>DeviceA-aaa-domain-example.com] <strong>authentication-scheme abc</strong>
[<span class="keyword">*</span>DeviceA-aaa-domain-example.com] <strong>radius-server rd1</strong>
[<span class="keyword">*</span>DeviceA-aaa-domain-example.com] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA-aaa] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">DeviceA</span>] <strong>commit</strong></pre>
<p># Check whether a user can pass RADIUS authentication. (The test user <strong>test</strong> and password <strong>Example2012</strong> have been configured on the RADIUS server.)</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>test-aaa test Example2012 radius-template rd1</strong>
Info: Account test succeeded.</pre>
</p></li><li><span>Configure 802.1X authentication.</span><p><div class="p"># Configure the 802.1X access profile <strong>d1</strong>.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>dot1x-access-profile name d1</strong>
[<span class="keyword">*</span>DeviceA-dot1x-access-profile-d1] <strong>dot1x authentication-method eap</strong>
[<span class="keyword">*</span>DeviceA-dot1x-access-profile-d1] <strong>dot1x timer client-timeout 30</strong>
[<span class="keyword">*</span>DeviceA-dot1x-access-profile-d1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">DeviceA</span>] <strong>commit</strong></pre>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>By default, an 802.1X access profile uses EAP authentication. Ensure that the RADIUS server supports the EAP protocol. Otherwise, the RADIUS server cannot process 802.1X authentication requests.</p>
</div></div>
</div>
<p># Configure the authentication profile <strong>p1</strong>, bind the 802.1X access profile <strong>d1</strong> to the authentication profile, and configure the forcible authentication domain <strong>example.com</strong> for users using the authentication profile.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>authentication-profile name p1</strong>
[<span class="keyword">*</span>DeviceA-authen-profile-p1] <strong>dot1x-access-profile d1</strong>
[<span class="keyword">*</span>DeviceA-authen-profile-p1] <strong>access-domain example.com force</strong>
[<span class="keyword">*</span>DeviceA-authen-profile-p1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">DeviceA</span>] <strong>commit</strong></pre>
<p># Bind the authentication profile <strong>p1</strong> to a downlink interface and enable 802.1X authentication on the interface. The following uses <span>100GE</span> <span>1/0/2</span> as an example. Other interfaces have similar configurations.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface </strong><strong><span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>authentication-profile p1</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">DeviceA</span>] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001564120297__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ol><li>A user starts the 802.1X client on a terminal, and enters the user name and password for authentication.</li><li>If the user name and password are correct, an authentication success message is displayed on the client page. The user then can access the network.</li><li>After the user goes online, you can run the <strong>display access-user access-type dot1x</strong> command on the device to check online 802.1X user information.</li></ol>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001564120297__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Configuration Scripts</h4><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
authentication-profile name p1
 dot1x-access-profile d1
 access-domain example.com force
#
vlan batch 10 20
#
aaa
 authentication-scheme abc    
  authentication-mode radius    
 domain example.com            
  authentication-scheme abc     
  radius-server rd1      
#  
radius-server template rd1
 radius-server shared-key cipher %+%##!!!!!!!!!"!!!!"!!!!*!!!!SKvr${[Fs.3t@/5k|BENhEu&gt;W(3\<font style="font-size:8pt" Face="Courier New" >~</font>XG!!D;!!!!!2jp5!!!!!!A!!!!3"pK8qv!}9M#(4$jGWvQF/R[CNe/+:W^jk8HUe&amp;W%+%#
 radius-server authentication 192.168.1.30 1812 weight 80
#
dot1x-access-profile name d1
 dot1x timer client-timeout 30
#
interface Vlanif10
 ip address 192.168.1.10 255.255.255.0
#
interface Vlanif20
 ip address 192.168.2.10 255.255.255.0
#
interface <span>100GE</span><span>1/0/1</span>
 port link-type trunk
 port trunk allow-pass vlan 10
#
interface <span>100GE</span><span>1/0/2</span>
 port default vlan 20
 authentication-profile p1
#
return </pre>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_cfg_nac_0245.html">Configuration Examples for NAC
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_nac_cfg_0066.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>