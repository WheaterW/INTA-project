
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="RADIUS Server Status Detection">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_aaa_cfg_0021.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_aaa_cfg_0026.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_aaa_cfg_0028.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="AAA">
<meta name="featurename" content="RADIUS">
<meta name="featuretype" content="User Access and Authentication">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="AAA">
<meta name="featurename" content="RADIUS">
<meta name="featuretype" content="User Access and Authentication">
<meta name="featurename" content="AAA">
<meta name="featurename" content="RADIUS">
<meta name="featuretype" content="User Access and Authentication">
<meta name="featurename" content="AAA">
<meta name="featurename" content="AD">
<meta name="featurename" content="HWTACACS">
<meta name="featurename" content="LDAP">
<meta name="featurename" content="RADIUS">
<meta name="featurename" content="Local User">
<meta name="featuretype" content="User Access and Authentication">
<meta name="featuretype" content="User Access and Authentication">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001512676482">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>RADIUS Server Status Detection</title>
</head>
<body><a name="EN-US_CONCEPT_0000001512676482"></a><a name="EN-US_CONCEPT_0000001512676482"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">RADIUS Server Status Detection</h1>
<div><p>Availability and maintainability of a RADIUS server are the prerequisites of user access authentication. If a device cannot communicate with the RADIUS server, the server cannot perform authentication or authorization for users. </p>
<div class="section"><h4 class="sectiontitle">RADIUS Server Status</h4><p>A device can mark the RADIUS server status as up, down, or force-up. The following table describes the three RADIUS server statuses and their scenarios.</p>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="16.11%" id="mcps1.3.2.3.1.4.1.1" liSelected="liSelected"><p>Status</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="44.17%" id="mcps1.3.2.3.1.4.1.2" liSelected="liSelected"><p>Whether the RADIUS Server Is Available</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="39.72%" id="mcps1.3.2.3.1.4.1.3" liSelected="liSelected"><p>Condition for Switching the Server Status</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="16.11%" headers="mcps1.3.2.3.1.4.1.1 "><p>Up</p>
</td>
<td class="cellrowborder" valign="top" width="44.17%" headers="mcps1.3.2.3.1.4.1.2 "><p>The RADIUS server is available.</p>
</td>
<td class="cellrowborder" valign="top" width="39.72%" headers="mcps1.3.2.3.1.4.1.3 "><ul><li>The device initially marks the RADIUS server status as up.</li><li>The device marks the RADIUS server status as up after receiving packets from the server.</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="16.11%" headers="mcps1.3.2.3.1.4.1.1 "><p>Down</p>
</td>
<td class="cellrowborder" valign="top" width="44.17%" headers="mcps1.3.2.3.1.4.1.2 "><p>The RADIUS server is unavailable.</p>
</td>
<td class="cellrowborder" valign="top" width="39.72%" headers="mcps1.3.2.3.1.4.1.3 "><p>The conditions for marking the RADIUS server status as down are met.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="16.11%" headers="mcps1.3.2.3.1.4.1.1 "><p>Force-up</p>
</td>
<td class="cellrowborder" valign="top" width="44.17%" headers="mcps1.3.2.3.1.4.1.2 "><p>When no RADIUS server is available, the device selects the RADIUS server in force-up state.</p>
</td>
<td class="cellrowborder" valign="top" width="39.72%" headers="mcps1.3.2.3.1.4.1.3 "><p>The device marks the RADIUS server status as force-up if the timer specified by <strong>dead-time</strong> expires.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>The RADIUS server status is initially marked as up. After a RADIUS Access-Request packet is received and the conditions for marking the RADIUS server status as down are met, the RADIUS server transitions to down. The RADIUS Access-Request packet that triggers the server status transition can be sent during user authentication or constructed by the administrator. For example, the RADIUS Access-Request packet can be a test packet sent when the <a href="cmdqueryname=test-aaa"><b><span class="cmdname">test-aaa</span></b></a> command is run or a detection packet sent during automatic detection.</p>
<div class="p">The device changes the RADIUS server status from down to up or to force-up in the following scenarios:<ul><li>Down to force-up: The timer specified by <strong>dead-time</strong> starts after the device marks the RADIUS server status as down. The timer indicates the duration for which the server status remains down. After the timer expires, the device marks the RADIUS server status as force-up. If a new user needs to be authenticated using RADIUS and no RADIUS server is available, the device attempts to re-establish a connection with a RADIUS server in force-up state.</li><li>Down to up: After receiving packets from the RADIUS server, the device changes the RADIUS server status from down to up. For example, after automatic detection is configured, the device receives response packets from the RADIUS server.</li></ul>
</div>
</div>
<div class="section"><h4 class="sectiontitle">Conditions for Marking the RADIUS Server Status as Down</h4><p>Whether the status of a RADIUS server can be marked as down depends on the following factors:</p>
<ul><li>Longest unresponsive interval of the RADIUS server (specified by <strong>max-unresponsive-interval</strong>)</li><li>Number of times the RADIUS Access-Request packet is sent</li><li>Interval for sending the RADIUS Access-Request packet</li><li>Interval for detecting the RADIUS server status</li><li>Number of RADIUS server detection interval cycles</li><li>Maximum number of consecutive unacknowledged packets in each detection interval (specified by <strong>dead-count</strong>)</li></ul>
<p>The device marks the RADIUS server status as down if either of the following conditions is met.</p>
<p>Condition 1: The device marks the RADIUS server status as down during RADIUS server status detection. After the system starts, the RADIUS server status detection timer runs. If the device does not receive any packet from the RADIUS server after sending the first RADIUS Access-Request packet to the server and the number of times the device does not receive any packet from the server (n) is greater than or equal to the maximum number of consecutive unacknowledged packets in a detection interval (specified by <strong>dead-count</strong>), a communication interruption is recorded. If the device still does not receive any packet from the RADIUS server, the device marks the RADIUS server status as down when recording the communication interruption for the same times as the detection interval cycles.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the device does not record any communication interruption in a detection interval, all the previous communication interruption records are cleared.</p>
</div></div>
<p>Condition 2: The device marks the RADIUS server status as down if no response is received from the server for a long period of time. If the user access frequency is low, the device receives only a few RADIUS Access-Request packets from users, conditions for marking the RADIUS server status as down during RADIUS server status detection cannot be met, and the interval between two consecutive unacknowledged RADIUS Access-Request packets is greater than the value of <strong>max-unresponsive-interval</strong>, then the device marks the RADIUS server status as down. This mechanism ensures that users can obtain escape authorization.</p>
<p><a href="#EN-US_CONCEPT_0000001512676482__fig_dc_cfg_aaa_601801">Figure 1</a> shows the flowchart for marking the RADIUS server status as down. In this example, the detection interval cycles twice. If multiple servers are configured in the RADIUS server template, the overall status detection time is related to the number of servers and the server selection algorithm. If a user terminal uses the client software for authentication and the timeout period of the terminal client software is less than the sum of all the status detection time, the terminal client software may dial up repeatedly and cannot access the network. If the user escape function is configured, the sum of all the status detection time must be less than the timeout period of the terminal client software so that the users can obtain escape rights.</p>
<div class="fignone" id="EN-US_CONCEPT_0000001512676482__fig_dc_cfg_aaa_601801"><a name="EN-US_CONCEPT_0000001512676482__fig_dc_cfg_aaa_601801"></a><a name="fig_dc_cfg_aaa_601801"></a><span class="figcap"><b>Figure 1 </b>Flowchart for marking the RADIUS server status as down</span><br><span><img class="vsd" src="figure/en-us_image_0000001563756057.png" width="NaN" height="NaN"></span></div>
<p>The following table lists the related commands.</p>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="50.629999999999995%" id="mcps1.3.3.11.1.3.1.1" liSelected="liSelected"><p>Command</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="49.370000000000005%" id="mcps1.3.3.11.1.3.1.2" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="50.629999999999995%" headers="mcps1.3.3.11.1.3.1.1 "><p><a href="cmdqueryname=radius-server"><b><span class="cmdname">radius-server</span></b></a> { <strong><span>dead-interval</span></strong> <i><span class="varname">dead-interval</span></i> | <strong><span>dead-count</span></strong> <i><span class="varname">dead-count </span></i>| <strong><span>detect-cycle</span></strong> <i><span class="varname">detect-cycle</span></i> }</p>
</td>
<td class="cellrowborder" valign="top" width="49.370000000000005%" headers="mcps1.3.3.11.1.3.1.2 "><p>Configures conditions for marking the RADIUS server status as down during RADIUS server status detection.</p>
<ul><li><strong><span>dead-interval</span></strong> <i><span class="varname">dead-interval</span></i>: specifies the detection interval. The default value is 5 seconds.</li><li><strong><span>dead-count</span></strong> <i><span class="varname">dead-count</span></i>: specifies the maximum number of consecutive unacknowledged packets. The default value is 2.</li><li><strong><span>detect-cycle</span></strong> <i><span class="varname">detect-cycle</span></i>: specifies the number of detection interval cycles. The default value is 2.</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50.629999999999995%" headers="mcps1.3.3.11.1.3.1.1 "><p><a href="cmdqueryname=radius-server+max-unresponsive-interval"><b><span class="cmdname">radius-server max-unresponsive-interval</span></b></a> <i><span class="varname">max-unresponsive-interval</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="49.370000000000005%" headers="mcps1.3.3.11.1.3.1.2 "><p>Configures the maximum unresponsive interval of the RADIUS server. The default value is 300 seconds.</p>
<p>If the interval between two consecutive unacknowledged RADIUS Access-Request packets is greater than the value of <strong>max-unresponsive-interval</strong>, the device marks the RADIUS server status as down.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50.629999999999995%" headers="mcps1.3.3.11.1.3.1.1 "><p><a href="cmdqueryname=radius-server+dead-time"><b><span class="cmdname">radius-server dead-time</span></b></a> <i><span class="varname">dead-time</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="49.370000000000005%" headers="mcps1.3.3.11.1.3.1.2 "><p>Configures the duration for which the RADIUS server status remains down.</p>
<p><em>dead-time</em>: specifies the duration for which the RADIUS server status remains down after the server status is marked as down. After the duration expires, the device marks the server status as force-up. The default value is 5 minutes.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section"><h4 class="sectiontitle">Automatic Detection</h4><p>After the RADIUS server status is marked as down, you can configure the automatic detection function to test the RADIUS server reachability.</p>
<p>The automatic detection function needs to be enabled manually and can be enabled when the user name and password used for automatic detection are configured in the RADIUS server template view on the device. Authentication success is not required. If the device can receive an authentication failure response packet, the RADIUS server is working properly and the device marks the RADIUS server status as up. If the device cannot receive any response packet, the RADIUS server is unavailable and the device marks the RADIUS server status as down.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In a scenario where user accounts are stored on the third-party server, for example, user accounts are stored on the AD or LDAP server, you are advised to configure accounts for automatic detection on the local RADIUS server; otherwise, the server performance deteriorates because the local RADIUS server needs to query accounts through the third-party server.</p>
</div></div>
<div class="p">After the automatic detection function is enabled, automatic detection is classified into the following conditions depending on differences of the RADIUS server status.
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="12.42%" id="mcps1.3.4.5.1.1.5.1.1" liSelected="liSelected"><p>Server Status</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="20.5%" id="mcps1.3.4.5.1.1.5.1.2" liSelected="liSelected"><p>Whether Automatic Detection Is Supported</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="20.080000000000002%" id="mcps1.3.4.5.1.1.5.1.3" liSelected="liSelected"><p>Time When an Automatic Detection Packet Is Sent</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="47%" id="mcps1.3.4.5.1.1.5.1.4" liSelected="liSelected"><p>Condition for Switching the Server Status</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="12.42%" headers="mcps1.3.4.5.1.1.5.1.1 "><p>Down</p>
</td>
<td class="cellrowborder" valign="top" width="20.5%" headers="mcps1.3.4.5.1.1.5.1.2 "><p>Automatic detection is supported by default.</p>
</td>
<td class="cellrowborder" valign="top" width="20.080000000000002%" headers="mcps1.3.4.5.1.1.5.1.3 "><p>An automatic detection packet is sent after the automatic detection period expires.</p>
</td>
<td class="cellrowborder" valign="top" width="47%" headers="mcps1.3.4.5.1.1.5.1.4 "><p>If the device receives a response packet from the RADIUS server within the timeout period for detection packets, the device marks the RADIUS server status as up; otherwise, the RADIUS server status remains down.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The following table lists commands related to automatic detection.</p>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="50.629999999999995%" id="mcps1.3.4.7.1.3.1.1" liSelected="liSelected"><p>Command</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="49.370000000000005%" id="mcps1.3.4.7.1.3.1.2" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="50.629999999999995%" headers="mcps1.3.4.7.1.3.1.1 "><p><a href="cmdqueryname=radius-server+testuser+username"><b><span class="cmdname">radius-server testuser username</span></b></a> <i><span class="varname">username</span></i> <strong><span>password cipher</span></strong> <i><span class="varname">password</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="49.370000000000005%" headers="mcps1.3.4.7.1.3.1.2 "><p>Enables the automatic detection function.</p>
<ul><li><i><span class="varname">user-name</span></i>: specifies the user name for automatic detection.</li><li><i><span class="varname">password</span></i>: specifies the password for automatic detection.</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50.629999999999995%" headers="mcps1.3.4.7.1.3.1.1 "><p><a href="cmdqueryname=radius-server+detect-server+interval"><b><span class="cmdname">radius-server detect-server interval</span></b></a> <i><span class="varname">interval</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="49.370000000000005%" headers="mcps1.3.4.7.1.3.1.2 "><p>Specifies the automatic detection interval for RADIUS servers in down state. The default value is 60 seconds.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section"><h4 class="sectiontitle">Processing After the RADIUS Server Status Is Marked as Down</h4><p>After the device marks the RADIUS server status as down, you can configure the escape function to make users obtain escape authorization. After the device detects that the RADIUS server becomes up, you can configure the reauthentication function to make users obtain authorization from the server through reauthentication, as shown in <a href="#EN-US_CONCEPT_0000001512676482__fig_dc_cfg_aaa_601802">Figure 2</a>.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>After the RADIUS server goes up, 802.1Xauthentication users exit escape authorization and are re-authenticated</p>
</div></div>
<div class="fignone" id="EN-US_CONCEPT_0000001512676482__fig_dc_cfg_aaa_601802"><a name="EN-US_CONCEPT_0000001512676482__fig_dc_cfg_aaa_601802"></a><a name="fig_dc_cfg_aaa_601802"></a><span class="figcap"><b>Figure 2 </b>Processing after the RADIUS server status is marked as down</span><br><span><img class="vsd" src="figure/en-us_image_0000001512676586.png" width="NaN" height="NaN"></span></div>
<p>The following table lists the commands for configuring escape rights upon transition of the RADIUS server status to down and configuring the reauthentication function.</p>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="50.629999999999995%" id="mcps1.3.5.6.1.3.1.1" liSelected="liSelected"><p>Command</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="49.370000000000005%" id="mcps1.3.5.6.1.3.1.2" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="50.629999999999995%" headers="mcps1.3.5.6.1.3.1.1 "><p><a href="cmdqueryname=authentication+event"><b><span class="cmdname">authentication event</span></b></a> <strong><span>authen-server-down action authorize </span></strong>{ <strong>vlan</strong> <i><span class="varname">vlan-id</span></i> | <strong><span>service-scheme</span></strong> <i><span class="varname">service-scheme-name</span></i> } [ <strong><span>response-fail</span></strong> ]</p>
</td>
<td class="cellrowborder" valign="top" width="49.370000000000005%" headers="mcps1.3.5.6.1.3.1.2 "><p>Configures the escape function upon transition of the RADIUS server status to down.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50.629999999999995%" headers="mcps1.3.5.6.1.3.1.1 "><p><a href="cmdqueryname=authentication+event+authen-server-up+action+re-authen"><b><span class="cmdname">authentication event authen-server-up action re-authen</span></b></a></p>
</td>
<td class="cellrowborder" valign="top" width="49.370000000000005%" headers="mcps1.3.5.6.1.3.1.2 "><p>Configures the reauthentication function for users in escape state when the RADIUS server becomes up.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_aaa_cfg_0021.html">Understanding RADIUS-based AAA
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_aaa_cfg_0026.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_aaa_cfg_0028.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>