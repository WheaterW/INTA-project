
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Enabling MLD Snooping Proxy">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_l2mc6_cfg_0022.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_l2mc6_cfg_0024.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_l2mc6_cfg_0027.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="MLD Snooping">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MLD Snooping">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="MLD Snooping">
<meta name="featuretype" content="IP Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001321470962">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Enabling MLD Snooping Proxy</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001321470962"></a><a name="EN-US_TASK_0000001321470962"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Enabling MLD Snooping Proxy</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001321470962__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>When MLD is disabled on Layer 3 devices (for example, when only a static multicast group is configured), no MLD querier is available on the network to maintain multicast group memberships. In this case, you can configure MLD snooping proxy on the Layer 2 device so that it functions as an MLD querier and sends Query messages.</p>
<p>Conversely, when MLD is enabled on the network, you can also configure MLD snooping proxy on a Layer 2 device. In this case, the device sends MLD Report/Done messages to its upstream Layer 3 device on behalf of user hosts. This helps reduce the number of such messages sent to the Layer 3 device.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>MLD snooping proxy and the following functions cannot be configured in the same VLAN:<ul><li>MLD snooping querier</li><li>Report and Done message suppression</li></ul>
</li><li>The MLD snooping proxy function cannot be enabled in a VLAN if the corresponding Layer 3 VLANIF interface has Layer 3 multicast functions (such as MLD and PIM) enabled.</li><li>When configuring MLD snooping in an M-LAG scenario, ensure that the MLD snooping proxy configuration is consistent on the active and standby M-LAG devices.</li></ul>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001321470962__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the VLAN view.</span><p><pre class="screen"><a href="cmdqueryname=vlan"><b><span class="cmdname">vlan</span></b></a> <i><span class="varname">vlan-id</span></i></pre>
</p></li><li><span>Enable MLD snooping proxy.</span><p><pre class="screen"><a href="cmdqueryname=mld+snooping+proxy"><b><span class="cmdname">mld snooping proxy</span></b></a></pre>
</p></li><li><span>(Optional) Configure the device to transparently transmit protocol messages in a VLAN.</span><p><pre class="screen"><a href="cmdqueryname=mld+snooping+proxy+router-protocol-pass"><b><span class="cmdname">mld snooping proxy router-protocol-pass</span></b></a></pre>
<p>By default, an MLD snooping proxy device terminates received protocol messages and learns multicast forwarding entries from these messages. If MLD snooping proxy is enabled on both the upstream and downstream devices, you can run this command so that the device transparently forwards the protocol messages it receives on a router port to other router ports, without learning the entries from the messages. In this way, the upstream and downstream devices do not learn entries from each other, which would otherwise cause entry aging problems.</p>
</p></li><li><span>(Optional) Disable the device from forwarding MLD Query messages to the upstream router.</span><ol type="a"><li class="substepexpand"><span>Return to the system view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the interface view.</span><p><pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></pre>
</p></li><li class="substepexpand"><span>Switch the interface working mode from Layer 3 to Layer 2.</span><p><pre class="screen"><a href="cmdqueryname=portswitch"><b><span class="cmdname">portswitch</span></b></a></pre>
<p></p>
<p>Determine whether to perform this step based on the current interface working mode.</p>
</p></li><li class="substepexpand"><span>Disable the device from forwarding MLD Query messages to the upstream router.</span><p><pre class="screen"><a href="cmdqueryname=mld+snooping+proxy-uplink-port"><b><span class="cmdname">mld snooping proxy-uplink-port</span></b></a> <strong><span>vlan</span></strong> <i><span class="varname">vlan-id</span></i></pre>
</p><p><p>After MLD snooping proxy is enabled on a device, it periodically broadcasts MLD Query messages to all the interfaces (including router ports) in a VLAN. This may result in reelection of the MLD querier. To prevent such reelection if MLD is enabled on the upstream device, run this command to disable forwarding of MLD messages to router ports.</p>
</p></li></ol>
</li><li><span>Commit the configuration.</span><p><pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_l2mc6_cfg_0022.html">Configuring MLD Snooping Proxy
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_l2mc6_cfg_0024.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../vrp/vrp_l2mc6_cfg_0027.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>