
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Understanding the IPv4 Prefix List">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_route-policy_cfg_0004.html">
<meta name="DC.Relation" scheme="URI" content="vrp_route-policy_cfg_0104.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Routing Policy">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Routing Policy">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="Routing Policy">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001130783778">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Understanding the IPv4 Prefix List</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CONCEPT_0000001130783778"></a><a name="EN-US_CONCEPT_0000001130783778"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Understanding the IPv4 Prefix List</h1>
<div><p>An IP prefix list is a filter that contains a group of matching rules and is used to filter routes to be advertised or accepted. You can specify an IP prefix and a mask length range in an IP prefix list so that the destination network segment addresses or next-hop addresses of routes can be matched against the IP prefix list. IP prefix lists can be configured for both IPv4 and IPv6 routes, and IPv4 and IPv6 prefix lists are implemented in the same way. An IP prefix list is matched against routes using either of the following parameters:</p>
<ul><li>Mask length: A mask length, together with an IP address, identifies an IP prefix. The IP prefix in an IP prefix list is used to filter routes with the same IP prefix. For example, the mask length of a route to 10.1.1.1/16 is 16, indicating that the valid prefix is 16 (10.1.0.0).</li><li>Mask length range: A mask length range can be defined in an IP prefix list to match routes with the same IP prefix and different mask lengths within the specified mask length range.</li></ul>
<div class="section"><h4 class="sectiontitle">IP prefix matching rules</h4><p>Multiple indexes can be created in an IP prefix list, and each index identifies a matching rule. As shown in <a href="#EN-US_CONCEPT_0000001130783778__fig8214115318126">Figure 1</a>, routes to be filtered are matched against an IP prefix list in ascending order by IP prefix index.</p>
<ul><li><p>If a route matches an index that is mapped to an entry configured in permit mode, the route is permitted. If the index is mapped to an entry configured in deny mode, the route is rejected.</p>
</li><li><p>If the route does not match any index in the IP prefix list, the route is filtered out.</p>
</li></ul>
<div class="fignone" id="EN-US_CONCEPT_0000001130783778__fig8214115318126"><a name="EN-US_CONCEPT_0000001130783778__fig8214115318126"></a><a name="fig8214115318126"></a><span class="figcap"><b>Figure 1 </b>IP prefix matching rules</span><br><span><img class="vsd" src="figure/en-us_image_0000001130783788.png" width="NaN" height="NaN"></span></div>
<p>Rules for filtering routes based on an IP prefix list are as follows:</p>
<ul><li><p>Sequential match: Routes are matched against IP prefixes one by one in the IP prefix list in ascending order by index number of the IP prefixes. During configuration, note that entries in the same IP prefix list can be sorted in different orders by index, leading to different filtering results.</p>
</li><li><p>Unique match: Once a route matches a prefix, the route stops being matched against other prefixes in the IP prefix list.</p>
</li><li><p>Default deny: If routes do not match any prefix in an IP prefix list, the routes are filtered out by default. If one or more entries in deny mode are created in the IP prefix list, create an entry to allow all other routes to pass.</p>
</li></ul>
</div>
<div class="section"><h4 class="sectiontitle">Rules for Matching Routes Against Masks in IP Prefixes</h4><p>Compared with an ACL, an IP prefix list is easy to configure and flexible to apply and can match route masks.</p>
<p>An IPv4 prefix list can be configured using the <strong>ip ip-prefix</strong> command. The common syntax is as follows:</p>
<p><a href="cmdqueryname=ip+ip-prefix"><b><span class="cmdname">ip ip-prefix</span></b></a> <i><span class="varname">ip-prefix-name</span></i> [ <strong><span>index</span></strong> <i><span class="varname">index-number</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } <i><span class="varname">ipv4-address</span></i> <i><span class="varname">mask-length</span></i> [ <strong><span>greater-equal</span></strong> <i><span class="varname">greater-equal-value</span></i> ] [ <strong><span>less-equal</span></strong> <i><span class="varname">less-equal-value</span></i> ]</p>
<p>The <i><span class="varname">ipv4-address</span></i> <i><span class="varname">mask-length</span></i> parameters set a network ID and the [ <strong><span>greater-equal</span></strong> <i><span class="varname">greater-equal-value</span></i> ] [ <strong><span>less-equal</span></strong> <i><span class="varname">less-equal-value</span></i> ] parameters set a mask length range for routes to be filtered. <a href="#EN-US_CONCEPT_0000001130783778__fig8214115318126">Figure 1</a> describes address range parameters in an IP prefix list.</p>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Parameters used to set a mask length range in an IP prefix list</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="27.98%" id="mcps1.3.4.6.2.3.1.1" liSelected="liSelected"><p>Parameter</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="72.02%" id="mcps1.3.4.6.2.3.1.2" liSelected="liSelected"><p>Meaning</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="27.98%" headers="mcps1.3.4.6.2.3.1.1 "><p><i><span class="varname">ipv4-address</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="72.02%" headers="mcps1.3.4.6.2.3.1.2 "><p>Specifies a network ID.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="27.98%" headers="mcps1.3.4.6.2.3.1.1 "><p><i><span class="varname">mask-length</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="72.02%" headers="mcps1.3.4.6.2.3.1.2 "><p>Specifies the number of the most significant bits in a specified network ID that a route prefix must match.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="27.98%" headers="mcps1.3.4.6.2.3.1.1 "><p><strong><span>greater-equal</span></strong> <i><span class="varname">greater-equal-value</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="72.02%" headers="mcps1.3.4.6.2.3.1.2 "><p>Specifies the minimum mask length in a mask length range.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="27.98%" headers="mcps1.3.4.6.2.3.1.1 "><p><strong><span>less-equal</span></strong> <i><span class="varname">less-equal-value</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="72.02%" headers="mcps1.3.4.6.2.3.1.2 "><p>Specifies the maximum mask length in a mask length range.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>For given routes to be filtered, they can be matched against a specific mask length or against a mask length range:</p>
<ul><li><p>If neither <strong>greater-equal</strong> nor<strong> less-equal</strong> is specified, the routes are exactly matched against the specified <em>mask-length</em>.</p>
</li><li><p>If only <strong>greater-equal</strong> is specified, the routes are matched against the mask length range of [<em>greater-equal-value</em>, 32]. <em>greater-equal-value</em> must be greater than or equal to <em>mask-length</em>.</p>
</li><li><p>If only<strong> less-equal </strong>is specified, the routes are matched against the mask length range of [<em>mask-length</em>, <em>less-equal-value</em>].</p>
</li><li><p>If both <strong>greater-equal</strong> and <strong>less-equal</strong> are specified, the routes are matched against the mask length range of [<em>greater-equal-value</em>, <em>less-equal-value</em>].</p>
</li></ul>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p><em>ipv4-address</em> can be set to all 0s (0.0.0.0) that is a wildcard address. In this case, either a mask length or a mask length range can be specified for the prefix:</p>
<ul><li><p>If a mask length is specified, all routes with the mask length are permitted or rejected.</p>
</li><li><p>If a mask length range is specified, all routes with mask lengths in the range are permitted or rejected.</p>
</li></ul>
</div></div>
<p><a href="#EN-US_CONCEPT_0000001130783778__table396025011510">Table 2</a> describes the implementation of route matching rules when the preceding wildcard address is used.</p>

<div class="tableBorder"><a name="EN-US_CONCEPT_0000001130783778__table396025011510"></a><a name="table396025011510"></a><table cellpadding="4" cellspacing="0" summary="" id="EN-US_CONCEPT_0000001130783778__table396025011510" frame="border" border="1" rules="all"><caption><b>Table 2 </b>Implementation of wildcard address-based route matching rules (IPv4)</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="17.5%" id="mcps1.3.4.11.2.5.1.1" liSelected="liSelected"><p>Whether <i><span class="varname">greater-equal</span></i> and <i><span class="varname">less-equal</span></i> Are Configured</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="17.84%" id="mcps1.3.4.11.2.5.1.2" liSelected="liSelected"><p>Condition</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="20.8%" id="mcps1.3.4.11.2.5.1.3" liSelected="liSelected"><p>Matching Rule</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="43.86%" id="mcps1.3.4.11.2.5.1.4" liSelected="liSelected"><p>Example</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="2" valign="top" width="17.5%" headers="mcps1.3.4.11.2.5.1.1 "><p>Neither <i><span class="varname">greater-equal</span></i> nor <i><span class="varname">less-equal</span></i> is configured.</p>
</td>
<td class="cellrowborder" valign="top" width="17.84%" headers="mcps1.3.4.11.2.5.1.2 "><p>After the processing, <i><span class="varname">ipv4-address</span></i> and <i><span class="varname">mask-length</span></i> are 0.0.0.0 and 0, respectively.</p>
</td>
<td class="cellrowborder" valign="top" width="20.8%" headers="mcps1.3.4.11.2.5.1.3 "><p>Matches only default IPv4 routes.</p>
</td>
<td class="cellrowborder" valign="top" width="43.86%" headers="mcps1.3.4.11.2.5.1.4 "><p>An IPv4 prefix list cannot be configured if the prefix and mask do not match. For example:</p>
<pre class="screen">ip ip-prefix aa index 10 permit 1.1.1.1 0
<strong>Error</strong>: Failed to add the address prefix list 0.0.0.0/0, because the destination address and mask do not match.</pre>
<p>Correct configuration:</p>
<pre class="screen">ip ip-prefix aa index 10 permit 0.0.0.0 0</pre>
<p>Matching rule: Only the default IPv4 route is permitted.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.4.11.2.5.1.1 "><p>After the processing, <i><span class="varname">ipv4-address</span></i> and <i><span class="varname">mask-length</span></i> are 0.0.0.0 and <em>X</em> (non-0 value), respectively.</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.4.11.2.5.1.2 "><p>Matches all routes with the mask length of <em>X</em>.</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.4.11.2.5.1.3 "><p>Pre-processing:</p>
<pre class="screen">ip ip-prefix aa index 10 permit 0.0.1.1 16</pre>
<p>Post-processing:</p>
<pre class="screen">ip ip-prefix aa index 10 permit 0.0.0.0 16</pre>
<p>Matching rule: Routes with the mask length of 16 are permitted.</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" valign="top" width="17.5%" headers="mcps1.3.4.11.2.5.1.1 "><p><i><span class="varname">greater-equal</span></i> is configured, but <i><span class="varname">less-equal</span></i> is not.</p>
</td>
<td class="cellrowborder" valign="top" width="17.84%" headers="mcps1.3.4.11.2.5.1.2 "><p>After the processing, <i><span class="varname">ipv4-address</span></i> and <i><span class="varname">mask-length</span></i> are 0.0.0.0 and 0, respectively.</p>
</td>
<td class="cellrowborder" valign="top" width="20.8%" headers="mcps1.3.4.11.2.5.1.3 "><p>Matches all routes with mask lengths within the range of <i><span class="varname">greater-equal</span></i> to 32.</p>
</td>
<td class="cellrowborder" valign="top" width="43.86%" headers="mcps1.3.4.11.2.5.1.4 "><p>An IPv4 prefix list cannot be configured if the prefix and mask do not match. For example:</p>
<pre class="screen">ip ip-prefix aa index 10 permit 1.1.1.1 0 greater-equal 16
<strong>Error</strong>: Failed to add the address prefix list 0.0.0.0/0, because the destination address and mask do not match.</pre>
<p>Correct configuration:</p>
<pre class="screen">ip ip-prefix aa index 10 permit 0.0.0.0 0 greater-equal 16 less-equal 32</pre>
<p>Matching rule: Routes with mask lengths within the range of 16 to 32 are permitted.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.4.11.2.5.1.1 "><p>After the processing, <i><span class="varname">ipv4-address</span></i> and <i><span class="varname">mask-length</span></i> are 0.0.0.0 and <em>X</em> (non-0 value), respectively.</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.4.11.2.5.1.2 "><p>Matches all routes with mask lengths within the range of <i><span class="varname">greater-equal</span></i> to 32.</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.4.11.2.5.1.3 "><p>Pre-processing:</p>
<pre class="screen">ip ip-prefix aa index 10 permit 0.0.1.1 16 greater-equal 20</pre>
<p>Post-processing:</p>
<pre class="screen">ip ip-prefix aa index 10 permit 0.0.0.0 16 greater-equal 20 less-equal 32</pre>
<p>Matching rule: Routes with mask lengths within the range of 20 to 32 are permitted.</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" valign="top" width="17.5%" headers="mcps1.3.4.11.2.5.1.1 "><p><i><span class="varname">greater-equal</span></i> is not configured, but <i><span class="varname">less-equal</span></i> is configured.</p>
</td>
<td class="cellrowborder" valign="top" width="17.84%" headers="mcps1.3.4.11.2.5.1.2 "><p>After the processing, <i><span class="varname">ipv4-address</span></i> and <i><span class="varname">mask-length</span></i> are 0.0.0.0 and 0, respectively.</p>
</td>
<td class="cellrowborder" valign="top" width="20.8%" headers="mcps1.3.4.11.2.5.1.3 "><p>Matches all routes with mask lengths within the range of 0 to <i><span class="varname">less-equal</span></i>.</p>
</td>
<td class="cellrowborder" valign="top" width="43.86%" headers="mcps1.3.4.11.2.5.1.4 "><p>An IPv4 prefix list cannot be configured if the prefix and mask do not match. For example:</p>
<pre class="screen">ip ip-prefix aa index 10 permit 1.1.1.1 0 less-equal 30
<strong>Error</strong>: Failed to add the address prefix list 0.0.0.0/0, because the destination address and mask do not match.</pre>
<p>Correct configuration:</p>
<pre class="screen">ip ip-prefix aa index 10 permit 0.0.0.0 0 less-equal 30</pre>
<p>Matching rule: Routes with mask lengths within the range of 0 to 30 are permitted.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.4.11.2.5.1.1 "><p>After the processing, <i><span class="varname">ipv4-address</span></i> and <i><span class="varname">mask-length</span></i> are 0.0.0.0 and <em>X</em> (non-0 value), respectively.</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.4.11.2.5.1.2 "><p>Matches all the routes whose mask lengths are within the range of <em>X</em> to <i><span class="varname">less-equal</span></i>.</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.4.11.2.5.1.3 "><p>Pre-processing:</p>
<pre class="screen">ip ip-prefix aa index 10 permit 0.0.1.1 16 less-equal 30</pre>
<p>Post-processing:</p>
<pre class="screen">ip ip-prefix aa index 10 permit 0.0.0.0 16 greater-equal 16 less-equal 30</pre>
<p>Matching rule: Routes with mask lengths within the range of 16 to 30 are permitted.</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" valign="top" width="17.5%" headers="mcps1.3.4.11.2.5.1.1 "><p>Both <i><span class="varname">greater-equal</span></i> and <i><span class="varname">less-equal</span></i> are configured.</p>
</td>
<td class="cellrowborder" valign="top" width="17.84%" headers="mcps1.3.4.11.2.5.1.2 "><p>After the processing, <i><span class="varname">ipv4-address</span></i> and <i><span class="varname">mask-length</span></i> are 0.0.0.0 and 0, respectively.</p>
</td>
<td class="cellrowborder" valign="top" width="20.8%" headers="mcps1.3.4.11.2.5.1.3 "><p>Matches all routes with mask lengths within the range from <i><span class="varname">greater-equal</span></i> to <i><span class="varname">less-equal</span></i>.</p>
</td>
<td class="cellrowborder" valign="top" width="43.86%" headers="mcps1.3.4.11.2.5.1.4 "><p>An IPv4 prefix list cannot be configured if the prefix and mask do not match. For example:</p>
<pre class="screen">ip ip-prefix aa index 10 permit 1.1.1.1 0 greater-equal 5 less-equal 30
<strong>Error</strong>: Failed to add the address prefix list 0.0.0.0/0, because the destination address and mask do not match.</pre>
<p>Correct configuration:</p>
<pre class="screen">ip ip-prefix aa index 10 permit 0.0.0.0 0 greater-equal 5 less-equal 30</pre>
<p>Matching rule: Routes with mask lengths within the range of 5 to 30 are permitted.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.4.11.2.5.1.1 "><p>After the processing, <i><span class="varname">ipv4-address</span></i> and <i><span class="varname">mask-length</span></i> are 0.0.0.0 and <em>X</em> (non-0 value), respectively.</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.4.11.2.5.1.2 "><p>Matches all routes with mask lengths within the range from <i><span class="varname">greater-equal</span></i> to <i><span class="varname">less-equal</span></i>.</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.4.11.2.5.1.3 "><p>Pre-processing:</p>
<pre class="screen">ip ip-prefix aa index 10 permit 0.0.1.1 16 greater-equal 20 less-equal 30</pre>
<p>Post-processing:</p>
<pre class="screen">ip ip-prefix aa index 10 permit 0.0.0.0 16 greater-equal 20 less-equal 30</pre>
<p>Matching rule: Routes with mask lengths within the range of 20 to 30 are permitted.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_route-policy_cfg_0004.html">Configuring an IPv4 Prefix List
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_route-policy_cfg_0104.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>