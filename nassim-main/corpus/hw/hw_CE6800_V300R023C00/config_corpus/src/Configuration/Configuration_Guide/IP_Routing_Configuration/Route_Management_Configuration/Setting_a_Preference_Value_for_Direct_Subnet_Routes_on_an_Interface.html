
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Setting a Preference Value for Direct Subnet Routes on an Interface">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_ip_routing_management_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="vrp_ip_routing_management_cfg_0006.html">
<meta name="DC.Relation" scheme="URI" content="vrp_ip_routing_management_cfg_008.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Route Management">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Route Management">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130782556">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Setting a Preference Value for Direct Subnet Routes on an Interface</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130782556"></a><a name="EN-US_TASK_0000001130782556"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Setting a Preference Value for Direct Subnet Routes on an Interface</h1>
<div class="taskbody"><p></p>
<div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001130782556__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before setting a preference value for direct subnet routes on an interface, configure link layer protocol parameters for the interface to ensure that the link layer protocol status on the interface is up.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130782556__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>In <a href="#EN-US_TASK_0000001130782556__fig_dc_vrp_ip-route_cfg_006101">Figure 1</a>, VM1 and VM2 communicates with each other. Before VM2 is migrated from campus 1 to campus 2, VM1's traffic is forwarded to VM2 through DeviceA. After VM2 is migrated from campus 1 to campus 2, traffic is still forwarded along the path used before migration, because a direct route has a higher preference than a static route. As a result, traffic fails to be forwarded. To solve the preceding problem, on DeviceA, configure a static route to the virtual migration and distribution device, and run the <a href="cmdqueryname=direct-route+ip+preference"><b><span class="cmdname">direct-route ip preference</span></b></a> command to change the preference of direct subnet routes to be lower than that of the static route. In this way, traffic is diverted to the virtual migration and distribution device, and this device forwards the traffic to VM2, which ensures normal traffic forwarding.</p>
<div class="fignone" id="EN-US_TASK_0000001130782556__fig_dc_vrp_ip-route_cfg_006101"><a name="EN-US_TASK_0000001130782556__fig_dc_vrp_ip-route_cfg_006101"></a><a name="fig_dc_vrp_ip-route_cfg_006101"></a><span class="figcap"><b>Figure 1 </b>Network diagram of VM migration</span><br><span><img src="figure/en-us_image_0000001699141213.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130782556__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the VBDIF interface view or VLANIF interface view.</span><p><ul><li>Enter the VBDIF interface view.<pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <strong><span>vbdif</span></strong> <i><span class="varname">bd-id</span></i></pre>
</li></ul>
<ul><li>Enter the VLANIF interface view.<pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <strong><span>vlanif</span></strong> <i><span class="varname">vlan-id</span></i></pre>
</li></ul>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The CE6885-LL in low latency mode does not support VBDIF interfaces.</p>
</div></div>
</p></li><li><span>Switch the working mode of the interface to Layer 2.</span><p><pre class="screen"><a href="cmdqueryname=portswitch"><b><span class="cmdname">portswitch</span></b></a></pre>
<p> Determine whether to perform this step based on the current interface working mode.</p>
</p></li><li><span>Set a preference value for direct subnet routes.</span><p><pre class="screen"><a href="cmdqueryname=direct-route+ip+preference"><b><span class="cmdname">direct-route ip preference</span></b></a> <i><span class="varname">preference-value</span></i></pre>
</p><p><p>By default, this configuration does not exist on an interface, and the preference value of direct subnet routes is 0.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command takes effect only in the VBDIF interface view and VLANIF interface view.</p>
</div></div>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001130782556__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001130782556__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001130782556__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+this"><b><span class="cmdname">display this</span></b></a> command in the interface view of a specific interface to check the configured preference value of direct subnet routes.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_ip_routing_management_cfg_0001.html">Route Management Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_ip_routing_management_cfg_0006.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_ip_routing_management_cfg_008.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>