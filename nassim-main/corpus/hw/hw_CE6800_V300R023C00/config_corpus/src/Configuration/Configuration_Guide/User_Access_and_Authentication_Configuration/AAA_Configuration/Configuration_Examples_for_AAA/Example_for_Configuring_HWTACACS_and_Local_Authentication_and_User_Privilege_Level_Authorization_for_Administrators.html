
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring HWTACACS and Local Authentication and User Privilege Level Authorization for Administrators">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_aaa_cfg_0056.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_aaa_cfg_0058.html">
<meta name="DC.Relation" scheme="URI" content="toctopics/en-us_task_0000001945219498.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="AAA">
<meta name="featurename" content="HWTACACS">
<meta name="featuretype" content="User Access and Authentication">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="AAA">
<meta name="featurename" content="AD">
<meta name="featurename" content="HWTACACS">
<meta name="featurename" content="LDAP">
<meta name="featurename" content="RADIUS">
<meta name="featurename" content="Local User">
<meta name="featuretype" content="User Access and Authentication">
<meta name="featurename" content="AAA">
<meta name="featurename" content="AD">
<meta name="featurename" content="HWTACACS">
<meta name="featurename" content="LDAP">
<meta name="featurename" content="RADIUS">
<meta name="featurename" content="Local User">
<meta name="featuretype" content="User Access and Authentication">
<meta name="featuretype" content="User Access and Authentication">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001563995893">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring HWTACACS and Local Authentication and User Privilege Level Authorization for Administrators</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001563995893"></a><a name="EN-US_TASK_0000001563995893"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring HWTACACS and Local Authentication and User Privilege Level Authorization for Administrators</h1>
<div class="taskbody" id="taskbody1580782409555"><div class="context"><a name="EN-US_TASK_0000001563995893__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001563995893__dc_cfg_aaa_0030_01"><h4 class="sectiontitle">Networking Requirements</h4><div class="p" id="EN-US_TASK_0000001563995893__p15167113773711">In <a href="#EN-US_TASK_0000001563995893__fig1348613432384">Figure 1</a>, an HWTACACS server is deployed on an enterprise network. The enterprise requires that the administrator use HWTACACS authentication to log in to DeviceA through STelnet. The specific requirements are as follows:<ol id="EN-US_TASK_0000001563995893__ol0419112918379"><li id="EN-US_TASK_0000001563995893__li12419152993710">The administrator can log in to the device through STelnet only after entering a correct user name and password.</li><li id="EN-US_TASK_0000001563995893__li9419162903716">After the administrator logs in to the device through STelnet, the privilege level 3 is authorized to the administrator.</li><li id="EN-US_TASK_0000001563995893__li173044513243">If the server does not respond to the authentication request from the device (for example, the link between the device and server is disconnected), local authentication is performed when the administrator attempts to log in to the device.</li></ol>
</div>
<div class="fignone" id="EN-US_TASK_0000001563995893__fig1348613432384"><a name="EN-US_TASK_0000001563995893__fig1348613432384"></a><a name="fig1348613432384"></a><span class="figcap"><b>Figure 1 </b>Network diagram for configuring HWTACACS and local authentication and user privilege level authorization for administrators</span><div class="note" id="EN-US_TASK_0000001563995893__note681516527280"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001563995893__p924219382914">In this example, interface 1 and interface 2 represent <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001563995893__image154861743183816" src="figure/en-us_image_0000001512836206.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001563995893__1.3.2"></a><a name="1.3.2"></a>
<div class="p" id="EN-US_TASK_0000001563995893__dc_cfg_aaa_0030_02"><h4 class="sectiontitle">Configuration Roadmap</h4><ol id="EN-US_TASK_0000001563995893__ol17542103044118"><li id="EN-US_TASK_0000001563995893__li1054211303412">Configure STelnet login on DeviceA: Set the authentication mode for accessing VTY user interfaces to AAA, enable the STelnet service, and configure the authentication mode and service type for SSH users.</li><li id="EN-US_TASK_0000001563995893__li254216308418">Configure HWTACACS authentication on DeviceA: Create an HWTACACS server template and configure AAA schemes.</li><li id="EN-US_TASK_0000001563995893__li1439510254254">Configure a local user on DeviceA.</li><li id="EN-US_TASK_0000001563995893__li175435306417">Configure the HWTACACS server.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001563995893__1.3.3"></a><a name="1.3.3"></a>
<div class="p" id="EN-US_TASK_0000001563995893__context112201516134616"><h4 class="sectiontitle">Precautions</h4><ul id="EN-US_TASK_0000001563995893__ul1584195611265"><li id="EN-US_TASK_0000001563995893__en-us_task_0000001945219498_li125249121910">Ensure that there are reachable routes between devices before the configuration.</li><li id="EN-US_TASK_0000001563995893__en-us_task_0000001945219498_li1955494196">Ensure that the shared key in the HWTACACS server template is the same as that configured on the HWTACACS server.</li><li id="EN-US_TASK_0000001563995893__en-us_task_0000001945219498_li444633442614">If the login account is not created on the server but exists on the local host, HWTACACS authentication is considered failed, and local authentication is not performed. Local authentication is performed only when the server is down or does not respond.</li><li id="EN-US_TASK_0000001563995893__en-us_task_0000001945219498_li5446143472615">If the accounting mode is set to HWTACACS in an accounting scheme, the administrator will pass local authentication but fail to log in to the device because accounting will fail to start after the link between the device and server is disconnected. To prevent this problem, run the <strong id="EN-US_TASK_0000001563995893__en-us_task_0000001945219498_b418517241234">accounting start-fail</strong> <strong id="EN-US_TASK_0000001563995893__en-us_task_0000001945219498_b41861624152315">online</strong> command in the accounting scheme view to allow users to go online after initial accounting fails. By default, users are allowed to go online after initial accounting fails.</li></ul>
<p id="EN-US_TASK_0000001563995893__p54911635174611"></p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001563995893__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001563995893__steps629987134180144"><li id="EN-US_TASK_0000001563995893__step130232719011"><span id="EN-US_TASK_0000001563995893__cmd9302127200">Configure IP addresses for interfaces.</span><p><pre class="screen" id="EN-US_TASK_0000001563995893__screen158116218303">&lt;<span class="keyword" id="EN-US_TASK_0000001563995893__keyword7830193145010">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001563995893__b19830183145010">system-view</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword" id="EN-US_TASK_0000001563995893__keyword1983017365019">HUAWEI</span>] <strong id="EN-US_TASK_0000001563995893__b38301635508">sysname DeviceA</strong>
[*<span class="keyword" id="EN-US_TASK_0000001563995893__keyword184754741315">DeviceA</span>] <strong id="EN-US_TASK_0000001563995893__b16395153591710">commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword" id="EN-US_TASK_0000001563995893__keyword20830331508">DeviceA</span>] <strong id="EN-US_TASK_0000001563995893__b1485517595716">vlan batch 10 20</strong>
[*DeviceA] <strong id="EN-US_TASK_0000001563995893__b183019315501">interface </strong><strong id="EN-US_TASK_0000001563995893__b192291824"><span>100ge</span> </strong><strong id="EN-US_TASK_0000001563995893__b3669128"><span>1/0/1</span></strong> 
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001563995893__b840385192616">portswitch</strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001563995893__b10233816205513">port link-type trunk</strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001563995893__b12630397583">port trunk allow-pass vlan 10</strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001563995893__b4831113135019">quit</strong>
[*DeviceA] <strong id="EN-US_TASK_0000001563995893__b17831103175016">interface </strong><strong id="EN-US_TASK_0000001563995893__b98251239557"><span>100ge</span></strong><strong id="EN-US_TASK_0000001563995893__b95481531017"> <span>1/0/2</span></strong> 
[*DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001563995893__b174391312102717">portswitch</strong>
[*DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001563995893__b16286164895815">port link-type trunk</strong>
[*DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001563995893__b526785615586">port trunk allow-pass vlan 20</strong>
[*DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001563995893__b15831103135014">quit</strong>
[*<span class="keyword" id="EN-US_TASK_0000001563995893__keyword1883133175018">DeviceA</span>] <strong id="EN-US_TASK_0000001563995893__b17220427758">interface vlanif 10</strong>
[*<span class="keyword" id="EN-US_TASK_0000001563995893__keyword243214573310">DeviceA-Vlanif10</span>] <strong id="EN-US_TASK_0000001563995893__b51181031854">ip address </strong><strong id="EN-US_TASK_0000001563995893__b163894191653">10.1.1.2 255.255.255.0</strong>
[*<span class="keyword" id="EN-US_TASK_0000001563995893__keyword13604015415">DeviceA-Vlanif10</span>] <strong id="EN-US_TASK_0000001563995893__b12491052456">quit</strong>
[*<span class="keyword" id="EN-US_TASK_0000001563995893__keyword19529131241">DeviceA</span>]<strong id="EN-US_TASK_0000001563995893__b34010131166"> interface vlanif 20</strong>
[*<span class="keyword" id="EN-US_TASK_0000001563995893__keyword175331527416">DeviceA</span>-Vlanif20]<strong id="EN-US_TASK_0000001563995893__b35591434568"> ip address</strong> <strong id="EN-US_TASK_0000001563995893__b11430103014610">10.1.6.2 255.255.255.0</strong>
[*<span class="keyword" id="EN-US_TASK_0000001563995893__keyword25851239414">DeviceA</span>-Vlanif20] <strong id="EN-US_TASK_0000001563995893__b924934612614">quit</strong>
[*<span class="keyword" id="EN-US_TASK_0000001563995893__keyword35399381461">DeviceA</span>] <strong id="EN-US_TASK_0000001563995893__b053953864615">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001563995893__step3477436164214"><span id="EN-US_TASK_0000001563995893__cmd6477183634215">Configure STelnet login.</span><p><p id="EN-US_TASK_0000001563995893__p3165184819437"># Configure DeviceA to generate a local key pair.</p>
<pre class="screen" id="EN-US_TASK_0000001563995893__screen103541745121516">[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword11458115514352"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001563995893__b7200134213711">rsa local-key-pair create</strong>
The key name will be:Host
The range of public key size is (2048, 4096).
NOTE: Key pair generation will take a short while.
Please input the modulus [default = 3072]:3072 </pre>
<p id="EN-US_TASK_0000001563995893__p13165648154318"># Set the authentication mode and protocol for accessing VTY user interfaces 0 to 4 to AAA and SSH, respectively.</p>
<pre class="screen" id="EN-US_TASK_0000001563995893__screen1116544812432">[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword208881529144810">*</span>DeviceA] <strong id="EN-US_TASK_0000001563995893__b01656488433">user-interface vty 0 4</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword2080983016488">*</span>DeviceA-ui-vty0-4] <strong id="EN-US_TASK_0000001563995893__b16165194824311">authentication-mode aaa</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword185215312483">*</span>DeviceA-ui-vty0-4] <strong id="EN-US_TASK_0000001563995893__b1416544894320">protocol inbound ssh</strong>
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword6557193254817">*</span>DeviceA-ui-vty0-4] <strong id="EN-US_TASK_0000001563995893__b216554819435">quit</strong></pre>
<p id="EN-US_TASK_0000001563995893__p41652481434"># Enable the SSH server function on DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001563995893__screen12281132517443">[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword11614163913718">*</span>DeviceA] <strong id="EN-US_TASK_0000001563995893__b1261410394377">stelnet server enable</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword15614103963714">*</span>DeviceA] <strong id="EN-US_TASK_0000001563995893__b3614193943720">ssh server-source -i </strong><strong id="EN-US_TASK_0000001563995893__b18682175919287">vlanif 10</strong></pre>
<p id="EN-US_TASK_0000001563995893__p13165184814315"># Set the authentication mode of all SSH users to password authentication.</p>
<pre class="screen" id="EN-US_TASK_0000001563995893__screen016534814317">[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword03571346494">*</span>DeviceA] <strong id="EN-US_TASK_0000001563995893__b1316544818435">ssh authentication-type default password</strong>
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword9310181174918">*DeviceA</span>] <strong id="EN-US_TASK_0000001563995893__b20310111104916">commit</strong></pre>
<div class="note" id="EN-US_TASK_0000001563995893__note1356818311498"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001563995893__en-us_task_0000001512836118_p13568138164810">If only the authentication mode and service type of a few SSH users need to be set to password authentication and STelnet, you can specify the SSH user name to set the authentication mode and service type of a single SSH user. For example, set the authentication mode and service type of an SSH user named <strong id="EN-US_TASK_0000001563995893__en-us_task_0000001512836118_b109551148172614">admin</strong> to password authentication and STelnet, respectively.</p>
<p id="EN-US_TASK_0000001563995893__en-us_task_0000001512836118_p155681781488">[<span class="keyword" id="EN-US_TASK_0000001563995893__en-us_task_0000001512836118_keyword2069313224815">DeviceA</span>] <strong id="EN-US_TASK_0000001563995893__en-us_task_0000001512836118_b1856815854819">ssh user admin authentication-type password</strong></p>
<p id="EN-US_TASK_0000001563995893__en-us_task_0000001512836118_p12568108194815">[<span class="keyword" id="EN-US_TASK_0000001563995893__en-us_task_0000001512836118_keyword13425133415489">DeviceA</span>] <strong id="EN-US_TASK_0000001563995893__en-us_task_0000001512836118_b16568158164817">ssh user admin service-type stelnet</strong></p>
</div></div>
</p></li><li id="EN-US_TASK_0000001563995893__step17549159124319"><span id="EN-US_TASK_0000001563995893__cmd10549794434">Configure HWTACACS authentication, authorization, and accounting.</span><p><p id="EN-US_TASK_0000001563995893__p1598463094414"># Create an HWTACACS server template named <strong id="EN-US_TASK_0000001563995893__b1181658122213">template1</strong> for communication between DeviceA and the HWTACACS server.</p>
<pre class="screen" id="EN-US_TASK_0000001563995893__screen1998423024412">[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword440514209499"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001563995893__b1798463012440">hwtacacs-server template template1</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword15809429204914">*</span>DeviceA-hwtacacs-template1] <strong id="EN-US_TASK_0000001563995893__b4984153064415">hwtacacs-server authentication 10.1.6.6 49</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword1057553034916">*</span>DeviceA-hwtacacs-template1] <strong id="EN-US_TASK_0000001563995893__b89849307440">hwtacacs-server authorization 10.1.6.6 49</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword203091831104920">*</span>DeviceA-hwtacacs-template1] <strong id="EN-US_TASK_0000001563995893__b119841430144410">hwtacacs-server accounting 10.1.6.6 49</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword15133234913">*</span>DeviceA-hwtacacs-template1] <strong id="EN-US_TASK_0000001563995893__b209841303442">hwtacacs-server shared-key cipher YsHsjx_202206139</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword174253210494">*</span>DeviceA-hwtacacs-template1] <strong id="EN-US_TASK_0000001563995893__b39841130204414">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword1434420396495">*DeviceA</span>] <strong id="EN-US_TASK_0000001563995893__b1834423934919">commit</strong></pre>
<p id="EN-US_TASK_0000001563995893__p998443024417"># Create an authentication scheme named <strong id="EN-US_TASK_0000001563995893__b581165812221">sch1</strong> and set the authentication mode to HWTACACS and local authentication.</p>
<pre class="screen" id="EN-US_TASK_0000001563995893__screen19984183094412">[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword2357184654919"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001563995893__b4984430134416">aaa</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword336634710498"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-aaa] <strong id="EN-US_TASK_0000001563995893__b1298473014444">authentication-scheme sch1</strong>
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword1130275819493">*</span>DeviceA-aaa-authen-sch1] <strong id="EN-US_TASK_0000001563995893__b398418301447">authentication-mode hwtacacs</strong> <strong id="EN-US_TASK_0000001563995893__b1092710517287">local</strong>
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword1722145994918">*</span>DeviceA-aaa-authen-sch1] <strong id="EN-US_TASK_0000001563995893__b8984830154419">quit</strong></pre>
<p id="EN-US_TASK_0000001563995893__p29845305447"># Configure an authorization scheme named <strong id="EN-US_TASK_0000001563995893__b39055572347">sch2</strong> and set the authorization mode to HWTACACS and local authorization.</p>
<pre class="screen" id="EN-US_TASK_0000001563995893__screen1598463016448">[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword20807650591">*</span>DeviceA-aaa] <strong id="EN-US_TASK_0000001563995893__b198483014415">authorization-scheme sch2</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword16311920185017">*</span>DeviceA-aaa-author-sch2] <strong id="EN-US_TASK_0000001563995893__b1984153017447">authorization-mode hwtacacs</strong> <strong id="EN-US_TASK_0000001563995893__b24788149282">local</strong>
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword13353722115017">*</span>DeviceA-aaa-author-sch2] <strong id="EN-US_TASK_0000001563995893__b15984153016441">quit</strong></pre>
<p id="EN-US_TASK_0000001563995893__p1798523018445"># Create an accounting scheme named <strong id="EN-US_TASK_0000001563995893__b1828581227">sch3</strong> and set the accounting mode to HWTACACS accounting.</p>
<pre class="screen" id="EN-US_TASK_0000001563995893__screen159851030134413">[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword4951414515">*</span>DeviceA-aaa] <strong id="EN-US_TASK_0000001563995893__b69851307444">accounting-scheme sch3</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword177591643519">*</span>DeviceA-aaa-accounting-sch3] <strong id="EN-US_TASK_0000001563995893__b59851830184412">accounting-mode hwtacacs</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword137181058516">*</span>DeviceA-aaa-accounting-sch3] <strong id="EN-US_TASK_0000001563995893__b169855301445">quit</strong></pre>
<p id="EN-US_TASK_0000001563995893__p898518309442"># Apply the HWTACACS server template and AAA schemes to the domain <strong id="EN-US_TASK_0000001563995893__b38219580222">huawei.com</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001563995893__screen1898513094420">[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword02881412115115">*</span>DeviceA-aaa] <strong id="EN-US_TASK_0000001563995893__b7985830104414">domain huawei.com</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword192315138512">*</span>DeviceA-aaa-domain-huawei.com] <strong id="EN-US_TASK_0000001563995893__b1798593004413">hwtacacs-server template1</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword1268717135517">*</span>DeviceA-aaa-domain-huawei.com] <strong id="EN-US_TASK_0000001563995893__b798553019440">authentication-scheme sch1</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword15345141417518">*</span>DeviceA-aaa-domain-huawei.com] <strong id="EN-US_TASK_0000001563995893__b798593044419">authorization-scheme sch2</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword131211154518">*</span>DeviceA-aaa-domain-huawei.com] <strong id="EN-US_TASK_0000001563995893__b14985113064414">accounting-scheme sch3</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword8767111517517">*</span>DeviceA-aaa-domain-huawei.com] <strong id="EN-US_TASK_0000001563995893__b199857309443">quit</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword14570121615514">*</span>DeviceA-aaa] <strong id="EN-US_TASK_0000001563995893__b15985030114413">quit</strong></pre>
<p id="EN-US_TASK_0000001563995893__p0985530104418"># Set the domain <strong id="EN-US_TASK_0000001563995893__b1837587223">huawei.com</strong> as the global default administrative domain.</p>
<pre class="screen" id="EN-US_TASK_0000001563995893__screen14985730174418">[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword1528973561918">*</span>DeviceA] <strong id="EN-US_TASK_0000001563995893__b2985183084416">domain huawei.com</strong><strong id="EN-US_TASK_0000001563995893__b922013536182"> admin</strong> 
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword290710513513">*DeviceA</span>] <strong id="EN-US_TASK_0000001563995893__b190765115112">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001563995893__step1285142125180144"><span id="EN-US_TASK_0000001563995893__cmd2140656996180144">Configure AAA local authentication. Set the local user name to <strong id="EN-US_TASK_0000001563995893__b1757012425311">user1-huawei</strong>, password to <strong id="EN-US_TASK_0000001563995893__b357018424312">YsHsjx_202206</strong>, and privilege level to 3.</span><p><pre class="screen" id="EN-US_TASK_0000001563995893__screen1327691757180144">[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword10104534010"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001563995893__b1077448753180144">aaa</strong>
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword7653456003"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-aaa] <strong id="EN-US_TASK_0000001563995893__b1264860725180144">local-user user1-huawei password irreversible-cipher </strong><strong id="EN-US_TASK_0000001563995893__b1829713231144">YsHsjx_202206</strong>
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword59621991211">*</span>DeviceA-aaa] <strong id="EN-US_TASK_0000001563995893__b363791212180144">local-user user1-huawei service-type ssh</strong>
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword7158512211">*</span>DeviceA-aaa] <strong id="EN-US_TASK_0000001563995893__b25908927180144">local-user user1-huawei privilege level 3</strong>
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword135001014811">*</span>DeviceA-aaa] <strong id="EN-US_TASK_0000001563995893__b992359841180144">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001563995893__keyword321918911">*</span>DeviceA] <strong id="EN-US_TASK_0000001563995893__b107545572342">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001563995893__step1310124610440"><span id="EN-US_TASK_0000001563995893__cmd231064617443">Configure the HWTACACS server. Here, the Secure ACS is used as an example.</span><p><p id="EN-US_TASK_0000001563995893__p93973467459">The configuration includes adding a device, adding a user, and setting the user privilege level to 3.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001563995893__example3582111720336"><a name="EN-US_TASK_0000001563995893__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ul id="EN-US_TASK_0000001563995893__ul3582717193320"><li id="EN-US_TASK_0000001563995893__li2582117193318">The administrator can log in to DeviceA through the STelnet client after entering the correct user name and password.</li><li id="EN-US_TASK_0000001563995893__li93617558215">When the link between DeviceA and the server is operational, run the <strong id="EN-US_TASK_0000001563995893__b108161054153110">display access-user username</strong> <em id="EN-US_TASK_0000001563995893__i1181605419315">user-name </em><strong id="EN-US_TASK_0000001563995893__b881745419311">detail</strong> command on DeviceA to check information about the user <strong id="EN-US_TASK_0000001563995893__b1581725463116">user1-huawei</strong>.<p id="EN-US_TASK_0000001563995893__p122572421532">In the command output, the values of <strong id="EN-US_TASK_0000001563995893__b265719462352">User access type</strong>, <strong id="EN-US_TASK_0000001563995893__b1465816461353">User Privilege</strong>, <strong id="EN-US_TASK_0000001563995893__b14658134683519">User authentication type</strong>, <strong id="EN-US_TASK_0000001563995893__b365864611352">Current authentication method</strong>, <strong id="EN-US_TASK_0000001563995893__b1865824616359">Current authorization method</strong>, and <strong id="EN-US_TASK_0000001563995893__b1658144615357">Current accounting method</strong> indicate that the user login mode is SSH, the privilege level is 3, the authentication type is administrator authentication, and the authentication, authorization, as well as accounting modes are HWTACACS.</p>
<pre class="screen" id="EN-US_TASK_0000001563995893__screen2413450262">&lt;DeviceA&gt; display access-user username user1-huawei detail
 ------------------------------------------------------------------------------
Basic:
  User ID                         : 16414
  User name                       : user1-huawei
  Domain-name                     : huawei.com
  User MAC                        : -
  User IP address                 : 10.1.1.10
  User IPv6 address               : -
  User access time                : 2024/07/01 10:49:22
  User accounting session ID      : example010000000000006d****010001e
  User access type                : SSH
  User Privilege                  : 3
  User Group                      : -

AAA:
  User authentication type        : Administrator authentication
  Current authentication method   : HWTACACS
  Current authorization method    : HWTACACS
  Current accounting method       : HWTACACS</pre>
</li><li id="EN-US_TASK_0000001563995893__li16841141181411">When the link between DeviceA and the HWTACACS server is disconnected, run the <strong id="EN-US_TASK_0000001563995893__b1613272643610">display access-user username</strong> <em id="EN-US_TASK_0000001563995893__i61321226133619">user-name</em><strong id="EN-US_TASK_0000001563995893__b181321326143610"> detail</strong> command on DeviceA to check information about the user <strong id="EN-US_TASK_0000001563995893__b1213215261361">user1-huawei</strong>.<p id="EN-US_TASK_0000001563995893__p29384261410">In the command output, the values of <strong id="EN-US_TASK_0000001563995893__b32545488365">User access type</strong>, <strong id="EN-US_TASK_0000001563995893__b6254548193613">User Privilege</strong>, <strong id="EN-US_TASK_0000001563995893__b1025416484369">User authentication type</strong>, <strong id="EN-US_TASK_0000001563995893__b8254348163616">Current authentication method</strong>, <strong id="EN-US_TASK_0000001563995893__b142546487365">Current authorization method</strong>, and <strong id="EN-US_TASK_0000001563995893__b192548484365">Current accounting method</strong> indicate that the login mode is SSH, the privilege level is 3, the authentication type is administrator authentication, the authentication and authorization modes are local, and the accounting mode is HWTACACS.</p>
<pre class="screen" id="EN-US_TASK_0000001563995893__screen15629643201411">&lt;DeviceA&gt; display access-user username user1-huawei detail
 ------------------------------------------------------------------------------
Basic:
  User ID                         : 16414
  User name                       : user1-huawei
  Domain-name                     : huawei.com
  User MAC                        : -
  User IP address                 : 10.1.1.10
  User IPv6 address               : -
  User access time                : 2024/07/01 10:49:22
  User accounting session ID      : example010000000000006d****010001e
  User access type                : SSH
  User Privilege                  : 3
  User Group                      : -

AAA:
  User authentication type        : Administrator authentication
  Current authentication method   : Local
  Current authorization method    : Local
  Current accounting method       : HWTACACS</pre>
</li></ul>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001563995893__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><p id="EN-US_TASK_0000001563995893__p056912392390">DeviceA</p>
<pre class="screen" id="EN-US_TASK_0000001563995893__screen39854618392"># 
sysname DeviceA 
# 
hwtacacs-server template template1                                           
 hwtacacs-server authentication 10.1.6.6                                    
 hwtacacs-server authorization 10.1.6.6                                   
 hwtacacs-server accounting 10.1.6.6  
 hwtacacs-server shared-key cipher %+%##!!!!!!!!!"!!!!"!!!!*!!!!SKvr${[Fs."u,S-6a-X1'[X=L"cpF!5Oz`1!!!!!2jp5!!!!!!A!!!!Ix&gt;cM8i{y6!);(8Dr9:dK`&amp;BHfE(H2=.:SH{@pT%+%#  
# 
aaa 
 authentication-scheme sch1     
  authentication-mode hwtacacs local
 authorization-scheme sch2                                                       
  authorization-mode hwtacacs local
 accounting-scheme sch3                                                          
  accounting-mode hwtacacs  
 domain huawei.com                                                               
  authentication-scheme sch1                                                     
  accounting-scheme sch3                                                         
  authorization-scheme sch2                                                      
  hwtacacs-server template1  
 local-user user1-huawei password irreversible-cipher $1d$OwseVRh@LH}ZeTBm$1nH4$ab&gt;d(N{-%0!ab48y=Ic*xEUR4pVhR2"9-<font style="font-size:8pt" Face="Courier New" >~</font>,$
 local-user user1-huawei privilege level 3
 local-user user1-huawei service-type ssh   
#  
domain huawei.com admin 
#
vlan batch 10 20
#
interface Vlanif10
 ip address 10.1.1.2 255.255.255.0
#
interface Vlanif20
 ip address 10.1.6.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/1</span>
 port link-type trunk
 port trunk allow-pass vlan 10
#
interface <span>100GE</span><span>1/0/2</span>
 port link-type trunk
 port trunk allow-pass vlan 20
#
stelnet server enable 
ssh server-source -i Vlanif10
# 
user-interface vty 0 4           
 authentication-mode aaa           
 protocol inbound ssh
# 
return</pre>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_aaa_cfg_0056.html">Configuration Examples for AAA
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_aaa_cfg_0058.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="toctopics/en-us_task_0000001945219498.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>