
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring an ERP Instance and Activating the Mapping Between the ERP Instance and a VLAN">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_erps_cfg_0017.html">
<meta name="DC.Relation" scheme="URI" content="vrp_erps_cfg_0019.html">
<meta name="DC.Relation" scheme="URI" content="vrp_erps_cfg_0021.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="ERPS">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ERPS">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featurename" content="ERPS">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001187964407">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring an ERP Instance and Activating the Mapping Between the ERP Instance and a VLAN</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001187964407"></a><a name="EN-US_TASK_0000001187964407"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring an ERP Instance and Activating the Mapping Between the ERP Instance and a VLAN</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001187964407__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_context1677625172748"><p id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_p1618778900183241">On a Layer 2 device running ERPS, the VLANs in which R-APS PDUs and data packets are transmitted must be mapped to an ERP instance so that ERPS forwards or blocks the packets based on blocking rules. Otherwise, the preceding packets may cause broadcast storms on the ring network, causing the network to become unavailable.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001187964407__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_steps10132325172748"><li id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_step2346164215917"><span id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmd53461421293">Enter the system view.</span><p><pre class="screen" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_screen81695451014"><a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdname111790421018">system-view</span></b></a></pre>
</p></li><li id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_step15643439151014"><span id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmd19643193912107">Enter the ERPS ring view.</span><p><pre class="screen" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_screen10305102617118"><a href="cmdqueryname=erps+ring"><b><span class="cmdname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdname1192792814183241">erps ring</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_varname1147594516183241">ring-id</span></i></pre>
</p></li><li id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_step883045311138"><span id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmd383035310137">Create an ERP instance for the ERPS ring.</span><p><pre class="screen" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_screen36963501158"><a href="cmdqueryname=protected-instance"><b><span class="cmdname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdname502271124183241">protected-instance</span></b></a> { <strong><span id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdparmname1029249154183241">all</span></strong> | { <i><span class="varname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_varname1346762956183241">instance-id1</span></i> [ <strong><span id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdparmname620011509183241">to</span></strong> <i><span class="varname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_varname48476745183241">instance-id2</span></i> ] } &amp;&lt;1-10&gt; }</pre>
<p id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_p364717962183241">By default, no ERP instance is configured for an ERPS ring.</p>
<div class="note" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_note37717020183241"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_ul402279275183241"><li id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_li105949353183241"><p id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_p426832508183241"><a name="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_li105949353183241"></a><a name="en-us_task_0000001141653370_li105949353183241"></a>If the <a href="cmdqueryname=stp+mode"><b><span class="cmdname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdname21303704183241">stp mode</span></b></a> command has been run in the system view to set the STP working mode to VBST, the ERP instance configured using the <a href="cmdqueryname=protected-instance"><b><span class="cmdname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdname268151168183241">protected-instance</span></b></a> command must be a created static instance.</p>
</li><li id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_li1242592048183241"><p id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_p2113567308183241"><a name="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_li1242592048183241"></a><a name="en-us_task_0000001141653370_li1242592048183241"></a>If you run the <a href="cmdqueryname=protected-instance"><b><span class="cmdname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdname1687978396183241">protected-instance</span></b></a> command multiple times in the same ERPS ring, multiple ERP instances are configured.</p>
</li><li id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_li20041010183241"><p id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_p1821806138183241"><a name="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_li20041010183241"></a><a name="en-us_task_0000001141653370_li20041010183241"></a>If ports have been added to the ERPS ring, the ERP instance cannot be changed. To delete a configured ERP instance, you must run the <a href="cmdqueryname=undo+erps+ring"><b><span class="cmdname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdname1756993559183241">undo erps ring</span></b></a> command in the interface view or the <a href="cmdqueryname=undo+port"><b><span class="cmdname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdname521394259183241">undo port</span></b></a> command in the ERPS ring view to remove the ports from the ERPS ring, and then run the <a href="cmdqueryname=undo+protected-instance"><b><span class="cmdname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdname133864688183241">undo protected-instance</span></b></a> command to delete the ERP instance.</p>
</li></ul>
</div></div>
</p></li><li id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_step1791402571312"><span id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmd169142256135">Exit the ERPS ring view to enter the system view.</span><p><pre class="screen" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_screen17566115021514"><a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdname916630777183241">quit</span></b></a></pre>
</p></li><li id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_step21544151179"><span id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmd11541815161710">Configure the mapping between the ERP instance and a VLAN.</span><ol type="a" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_substeps5839191619205"><li class="substepexpand" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_substep1149902960214040"><span id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmd1213709367214040">Enter the MST region view.</span><p><pre class="screen" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_screen19812112178"><a href="cmdqueryname=stp+region-configuration"><b><span class="cmdname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdname1149584214183241">stp region-configuration</span></b></a></pre>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_substep1574813471214040"><span id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmd154057822214040">Configure the mapping between the ERP instance and a VLAN.</span><p><pre class="screen" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_screen2122131571717"><a href="cmdqueryname=instance"><b><span class="cmdname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdname330415460183241">instance</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_varname239487620183241">instance-id</span></i> <strong><span id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdparmname583732620183241">vlan</span></strong> { <i><span class="varname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_varname882295582183241">vlan-id1</span></i> [ <strong><span id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdparmname1091704147183241">to</span></strong> <i><span class="varname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_varname1579665170183241">vlan-id2</span></i> ] } &amp;&lt;1-10&gt;</pre>
</p><p><p id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_p739164992113">By default, all VLANs in an MST region are mapped to instance 0.</p>
<p id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_p14553125642115">The value of the <i><span class="varname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_varname1467823753183241">instance-id</span></i> parameter must be the same as the value of the <i><span class="varname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_varname1352751198183241">instance-id</span></i> parameter specified in the <a href="cmdqueryname=protected-instance"><b><span class="cmdname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdname1741797936183241">protected-instance</span></b></a> command.</p>
</p><p><div class="note" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_note1749140866183241"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_ul906891079183241"><li id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_li1328067109183241"><p id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_p2026357692183241"><a name="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_li1328067109183241"></a><a name="en-us_task_0000001141653370_li1328067109183241"></a>A VLAN cannot be mapped to multiple instances. If you map a VLAN that has been mapped to an instance to another instance, the original mapping is deleted.</p>
</li><li id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_li1602117084183241"><p id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_p1631864702183241"><a name="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_li1602117084183241"></a><a name="en-us_task_0000001141653370_li1602117084183241"></a>The <a href="cmdqueryname=vlan-mapping+modulo"><b><span class="cmdname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdname966339967183241">vlan-mapping modulo</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_varname246902157183241">modulo</span></i> command configures mappings between MSTIs and VLANs based on a default algorithm. However, the mappings configured using this command cannot meet the actual requirements. Therefore, this command is not recommended.</p>
</li><li id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_li1890288524183241"><p id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_p206149150183241"><a name="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_li1890288524183241"></a><a name="en-us_task_0000001141653370_li1890288524183241"></a>To configure the mapping between an ERP instance and a MUX VLAN, you are advised to configure the principal VLAN, group VLANs, and separate VLANs of the MUX VLAN to map the same ERP instance. Otherwise, loops may occur.</p>
</li></ul>
</div></div>
</p></li></ol>
</li><li id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_step93927616581"><span id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmd43922612584">Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_screen1863683117487"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001187964407__en-us_task_0000001141653370_cmdname763613194819">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_erps_cfg_0017.html">Configuring ERPSv2
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_erps_cfg_0019.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_erps_cfg_0021.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>