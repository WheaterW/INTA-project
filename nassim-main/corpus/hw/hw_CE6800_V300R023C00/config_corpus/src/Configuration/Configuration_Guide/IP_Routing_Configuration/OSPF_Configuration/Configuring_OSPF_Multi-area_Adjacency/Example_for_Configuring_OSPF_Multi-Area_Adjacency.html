
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring OSPF Multi-Area Adjacency">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0122.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0130.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130783242">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring OSPF Multi-Area Adjacency</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130783242"></a><a name="EN-US_TASK_0000001130783242"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring OSPF Multi-Area Adjacency</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001130783242__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0000001130783242__fig_dc_vrp_ospf_cfg_207101">Figure 1</a>, all the devices run OSPF, and the entire AS is divided into two areas. In area 1, the link between DeviceA and DeviceB is a high-speed link. According to OSPF, an intra-area path takes precedence over an inter-area path. Therefore, traffic from DeviceA to DeviceB in area 2 is forwarded along the intra-area path DeviceA-&gt;DeviceC-&gt;DeviceD-&gt;DeviceB, meaning that traffic cannot be transmitted over the high-speed link between DeviceA and DeviceB. To address this problem, configure OSPF multi-area adjacency by creating multi-area adjacency interfaces on DeviceA and DeviceB and specifying area 2 for these interfaces so that they belong to this area. In this way, traffic from DeviceA to DeviceB in area 2 can be forwarded along the high-speed link.</p>
<div class="fignone" id="EN-US_TASK_0000001130783242__fig_dc_vrp_ospf_cfg_207101"><a name="EN-US_TASK_0000001130783242__fig_dc_vrp_ospf_cfg_207101"></a><a name="fig_dc_vrp_ospf_cfg_207101"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring OSPF multi-area adjacency</span><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1 and interface 2 represent <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001176742979.png" width="NaN" height="NaN"></span></div>
<h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure basic OSPF functions.</p>
</li><li><p>Enable OSPF for an interface.</p>
</li><li><p>Enable OSPF for a multi-area adjacency interface.</p>
</li></ol>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130783242__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>To improve security, OSPF area authentication or interface authentication is recommended. For details, see "Improving OSPF Network Security." OSPF area authentication is used as an example. For details, see "Example for Configuring Basic OSPF Functions."</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130783242__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface.</span><p><p>Assign an IP address to each interface according to <a href="#EN-US_TASK_0000001130783242__fig_dc_vrp_ospf_cfg_207101">Figure 1</a>. For detailed configurations, see Configuration Scripts.</p>
</p></li><li><span>Configure basic OSPF functions.</span><p><p>See <a href="vrp_ospf_cfg_0018.html">Example for Configuring Basic OSPF Functions</a>. For detailed configurations, see Configuration Scripts.</p>
</p></li><li><span>Enable OSPF for a multi-area adjacency interface.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface <span>100GE</span><span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA<strong>-</strong><span>100GE</span><span>1/0/1</span>]<strong> ospf enable multi-area 2</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceA] <strong>commit</strong></span></pre>
</p><p><p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>interface <span>100GE</span><span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB<strong>-</strong><span>100GE</span><span>1/0/1</span>]<strong> ospf enable multi-area 2</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceB] <strong>commit</strong></span></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001130783242__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Run the <a href="cmdqueryname=display+ospf+peer+brief"><b><span class="cmdname">display ospf peer brief</span></b></a> command on DeviceA to check brief information about OSPF neighbors. The command output shows that DeviceA has established OSPF neighbor relationships with DeviceB and DeviceC. It also shows that the multi-area adjacency between DeviceA and DeviceB has been established.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display ospf peer brief</strong></pre>
<pre class="screen">(M) Indicates MADJ neighbor

          OSPF Process 1 with Router ID 1.1.1.1
                   Peer Statistic Informations
  Total number of peer(s): 3
  Peer(s) in full state: 3
-------------------------------------------------------------------------
 Area Id         Interface      Neighbor id      State
 0.0.0.1         <span>100GE</span><span>1/0/1</span>      10.1.1.2          Full
 0.0.0.2         <span>100GE</span><span>1/0/1</span>      <strong>10.1.1.2(M)</strong>      Full
 0.0.0.2         <span>100GE</span><span>1/0/2</span>      10.1.2.2          Full
-------------------------------------------------------------------------</pre>
<p># Run the <a href="cmdqueryname=display+ip+routing-table"><b><span class="cmdname">display ip routing-table</span></b></a> command on DeviceA to check IP routing information. The command output shows that a route to the destination address 1.1.1.1 exists and its outbound interface is <span>100GE</span> <span>0/1/0</span>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display ip routing-table</strong></pre>
<pre class="screen"><span class="keyword">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route</span>
------------------------------------------------------------------------------
Routing Table : _public_
         Destinations : 13       Routes : 13        

Destination/Mask    Proto   Pre  Cost        Flags NextHop         Interface

        1.1.1.1/32  OSPF    10   1             D   10.1.1.2        <span>100GE</span><span>1/0/1</span>
       10.1.1.0/24  Direct  0    0             D   10.1.1.1        <span>100GE</span><span>1/0/1</span>
       10.1.1.1/32  Direct  0    0             D   127.0.0.1       <span>100GE</span><span>1/0/1</span>
     10.1.1.255/32  Direct  0    0             D   127.0.0.1       <span>100GE</span><span>1/0/1</span>
       10.1.2.0/24  Direct  0    0             D   10.1.2.1        <span>100GE</span><span>1/0/2</span>
       10.1.2.1/32  Direct  0    0             D   127.0.0.1       <span>100GE</span><span>1/0/2</span>
     10.1.2.255/32  Direct  0    0             D   127.0.0.1       <span>100GE</span><span>1/0/2</span>
       10.1.3.0/24  OSPF    10   2             D   10.1.1.2        <span>100GE</span><span>1/0/1</span>
       10.1.4.0/24  OSPF    10   2             D   10.1.2.2        <span>100GE</span><span>1/0/2</span>
      127.0.0.0/8   Direct  0    0             D   127.0.0.1       InLoopBack0
      127.0.0.1/32  Direct  0    0             D   127.0.0.1       InLoopBack0
127.255.255.255/32  Direct  0    0             D   127.0.0.1       InLoopBack0
255.255.255.255/32  Direct  0    0             D   127.0.0.1       InLoopBack0</pre>
<h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#               
interface <span>100GE</span><span>1/0/1</span> 
 undo portswitch
 ip address 10.1.1.1 255.255.255.0
 ospf enable 1 area 0.0.0.1
 ospf enable multi-area 0.0.0.2
#               
interface <span>100GE</span><span>1/0/2</span> 
 
 undo portswitch
 ip address 10.1.2.1 255.255.255.0
 ospf enable 1 area 0.0.0.2
#               
ospf 1          
 area 0.0.0.1   
 area 0.0.0.2   
#               
return   </pre>
</li></ul>
<ul><li><p>DeviceB</p>
<pre class="screen">#
sysname DeviceB
#               
interface <span>100GE</span><span>1/0/1</span>
  
 undo portswitch
 ip address 10.1.1.2 255.255.255.0
 ospf enable 1 area 0.0.0.1
 ospf enable multi-area 0.0.0.2
#               
interface <span>100GE</span><span>1/0/2</span> 
 
 undo portswitch
 ip address 10.1.3.1 255.255.255.0
 ospf enable 1 area 0.0.0.2
#               
interface LoopBack0
 ip address 1.1.1.1 255.255.255.255
 ospf enable 1 area 0.0.0.2
#               
ospf 1          
 area 0.0.0.1   
 area 0.0.0.2   
#               
return         </pre>
</li><li><p>DeviceC</p>
<pre class="screen">#
sysname DeviceC
#               
interface <span>100GE</span><span>1/0/1</span>  
 undo portswitch
 ip address 10.1.4.1 255.255.255.0
 ospf enable 1 area 0.0.0.2
#               
interface <span>100GE</span><span>1/0/2</span>  
 undo portswitch
 ip address 10.1.2.2 255.255.255.0
 ospf enable 1 area 0.0.0.2
#               
ospf 1          
 area 0.0.0.2   
#               
return      </pre>
</li><li><p>DeviceD</p>
<pre class="screen">#
sysname DeviceD
#               
interface <span>100GE</span><span>1/0/1</span>  
 undo portswitch
 ip address 10.1.4.2 255.255.255.0
 ospf enable 1 area 0.0.0.2
#
interface <span>100GE</span><span>1/0/2</span> 
 
 undo portswitch
 ip address 10.1.3.2 255.255.255.0
 ospf enable 1 area 0.0.0.2
#               
ospf 1          
 area 0.0.0.2   
#               
return          </pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_ospf_cfg_0122.html">Configuring OSPF Multi-area Adjacency
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_ospf_cfg_0130.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>