
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring DHCP Snooping in a VLAN Mapping Scenario">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../toctopics/en-us_concept_0000002056501870.html">
<meta name="DC.Relation" scheme="URI" content="../dc_cfg_dhcp-snooping_0001.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="DHCP Snooping">
<meta name="featurename" content="VLAN">
<meta name="featurename" content="VLAN Mapping">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="DHCP Snooping">
<meta name="featurename" content="VLAN">
<meta name="featurename" content="VLAN Mapping">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001512681146">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring DHCP Snooping in a VLAN Mapping Scenario</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001512681146"></a><a name="EN-US_TASK_0000001512681146"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring DHCP Snooping in a VLAN Mapping Scenario</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001512681146__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0000001512681146__fig8627748238">Figure 1</a>, PC1 and PC2 connected to DeviceA belong to VLAN 5, and PC3 and PC4 connected to DeviceC belong to VLAN 6. PC1, PC2, PC3, and PC4 are on the same network segment. It is required that PCs in different VLANs communicate with each other through 1 to 1 VLAN mapping on DeviceB.</p>
<div class="fignone" id="EN-US_TASK_0000001512681146__fig8627748238"><a name="EN-US_TASK_0000001512681146__fig8627748238"></a><a name="fig8627748238"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring VLAN-based VLAN mapping (1 to 1)</span><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, and <span>100GE</span> <span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="../images/en-us_image_0000001513040418.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001512681146__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><ol><li>Configure VLAN-based VLAN mapping. For configuration details, see <a href="../vrp_vlan_cfg_0057.html">Example for Configuring VLAN-based VLAN Mapping (1 to 1)</a>.</li><li>Configure DHCP snooping on DeviceB where VLAN mapping is enabled.</li></ol>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001512681146__en-us_task_0000001176742281_p128381413191711">VLAN-based VLAN mapping can be configured only on the <span>CE6820H, CE6820H-K, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6820S</span>.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001512681146__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure DHCP snooping on DeviceB. Configure VLAN mapping on <span>100GE</span> <span>1/0/1</span> and configure <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span> to allow packets from VLAN 6 to pass through.</span><p><p># Enable DHCP snooping globally.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <strong>sysname DeviceB</strong>
[*DeviceB] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceB] <strong>dhcp enable</strong>
[*DeviceB] <strong>dhcp snooping enable</strong>
[*DeviceB] <strong>commit</strong></pre>
<p># Enable DHCP snooping on <span>100GE</span> <span>1/0/1</span> connected to the user side.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceB] <strong>interface <span>100GE</span> <span>1/0/1</span></strong>
[*DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>dhcp snooping enable</strong>
[*DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong></pre>
</p><p><p># Configure the interface connected to the DHCP server as a trusted one.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceB] <strong>interface <span>100GE</span> <span>1/0/2</span></strong>
[*DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>dhcp snooping trusted</strong>
[*DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[*<span class="keyword">DeviceB</span>] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001512681146__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Check the information about the DHCP snooping binding table on DeviceB.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceB] <strong>display dhcp snooping user-bind all</strong>
DHCP Dynamic Bind-table:
Flags:O - outer vlan ,I - inner vlan   
IP Address       MAC Address     VLAN(O/I)/(BD-VLAN)        Interface          Lease            
------------------------------------------------------------------------------------------------------- 
10.1.1.141      00e0-fc12-3456    6/-/--                    <span>100GE</span><span>1/0/1</span>           2022.03.27-07:31
------------------------------------------------------------------------------------------------------- 
Print count:           1          Total count:           1 </pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001512681146__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li>DeviceA<pre class="screen">#
sysname DeviceA
#
vlan batch 5
#
interface <span>100GE</span><span>1/0/1</span>
 port link-type access
 port default vlan 5
#
interface <span>100GE</span><span>1/0/2</span>
 port link-type access
 port default vlan 5
#
interface <span>100GE</span><span>1/0/3</span>
 port link-type trunk
 port trunk allow-pass vlan 5
#
return</pre>
</li><li>DeviceB<pre class="screen">#
sysname DeviceB
#
vlan batch 6
#
dhcp enable
#
dhcp snooping enable
#
interface <span>100GE</span><span>1/0/1</span>
 port link-type trunk
 port trunk allow-pass vlan 6
 port vlan-mapping vlan 5 map-vlan 6
 dhcp snooping enable 
#
interface <span>100GE</span><span>1/0/2</span>
 port link-type trunk
 port trunk allow-pass vlan 6
 dhcp snooping trusted
#
return</pre>
</li><li>DeviceC<pre class="screen">#
sysname DeviceC
#
vlan batch 6
#
interface <span>100GE</span><span>1/0/1</span>
 port link-type access
 port default vlan 6
#
interface <span>100GE</span><span>1/0/2</span>
 port link-type access
 port default vlan 6
#
interface <span>100GE</span><span>1/0/3</span>
 port link-type trunk
 port trunk allow-pass vlan 6
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../toctopics/en-us_concept_0000002056501870.html">Configuration Examples
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../dc_cfg_dhcp-snooping_0001.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>