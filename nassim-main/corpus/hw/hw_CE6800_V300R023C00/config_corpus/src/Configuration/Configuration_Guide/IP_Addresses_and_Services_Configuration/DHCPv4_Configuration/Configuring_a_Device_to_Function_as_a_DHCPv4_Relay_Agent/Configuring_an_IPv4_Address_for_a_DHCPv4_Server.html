
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring an IPv4 Address for a DHCPv4 Server">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_dhcpv4_cfg_0022.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_dhcpv4_cfg_0025.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_dhcpv4_cfg_0026.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="DHCPv4">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="DHCPv4">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="DHCPv4">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001513046158">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring an IPv4 Address for a DHCPv4 Server</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001513046158"></a><a name="EN-US_TASK_0000001513046158"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring an IPv4 Address for a DHCPv4 Server</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001513046158__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>To ensure that DHCPv4 messages can be forwarded from a DHCPv4 relay agent to a DHCPv4 server, you must configure the IPv4 address of the server on the interface where DHCPv4 relay is enabled. You can configure the IPv4 address of a DHCPv4 server in either the interface or DHCPv4 server group view. If DHCPv4 relay needs to be configured on only one interface, the interface view is recommended. Otherwise, the DHCPv4 server group view is recommended.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The number of times that DHCPv4 messages are relayed between a DHCPv4 server and client cannot exceed 16. Otherwise, DHCPv4 messages are discarded.</p>
<p>All servers in a DHCPv4 server group must be in the same VPN instance.</p>
</div></div>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0000001513046158__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span><strong>Configure an IPv4 address for a DHCPv4 server in the interface view.</strong></span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>(Optional) Enable DHCPv4 server polling on the DHCPv4 relay agent.</span><p><pre class="screen"><a href="cmdqueryname=ip+relay+address+cycle"><b><span class="cmdname">ip relay address cycle</span></b></a></pre>
<p>By default, DHCPv4 server polling is disabled on a DHCPv4 relay agent.</p>
</p></li><li class="substepexpand"><span>(Optional) Set a TTL value for DHCPv4 request messages after they are forwarded by the DHCPv4 relay agent at Layer 3.</span><p><pre class="screen"><a href="cmdqueryname=dhcp+set+ttl"><b><span class="cmdname">dhcp set ttl</span></b></a> { <strong><span>unvaried</span></strong> | <i><span class="varname">ttl-value</span></i> }</pre>
<p>By default, the TTL value of DHCPv4 request messages decreases by 1 after they are forwarded by the DHCPv4 relay agent at Layer 3.</p>
</p></li><li class="substepexpand"><span>Configure an IPv4 address for a DHCPv4 server.</span><p><pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type interface-number</span></i>
<a href="cmdqueryname=undo+portswitch"><b><span class="cmdname">undo portswitch</span></b></a>
<a href="cmdqueryname=dhcp+relay+server-ip"><b><span class="cmdname">dhcp relay server-ip</span></b></a> <i><span class="varname">ip-address</span></i> [ <strong>vpn-instance</strong><em> vpn-instance-name</em> | <strong>public-net</strong> ]</pre>
<p>By default, no IPv4 address is configured for a DHCPv4 server on an interface.</p>
<p> Determine whether to run the <a href="cmdqueryname=undo+portswitch"><b><span class="cmdname">undo portswitch</span></b></a> command to switch the interface working mode to Layer 3 based on the current interface working mode.</p>
<p>In an inter-VPN scenario, if the DHCPv4 client and server are located in different VPNs, you must specify the <strong>vpn-instance</strong> <em>vpn-instance-name</em> parameter when performing this step.</p>
<p>In a non-inter-VPN scenario, you are advised not to specify the <strong>vpn-instance</strong> <em>vpn-instance-name</em> parameter because the DHCPv4 server and relay interface belong to the same VPN by default. In this case, you only need to bind the interface to a VPN and use the VPN information of the interface.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001513046158__substep1480305014418"><span id="EN-US_TASK_0000001513046158__cmd148031450154112">(Optional) Enable DHCPv4 relay gateway switching.</span><p><pre class="screen" id="EN-US_TASK_0000001513046158__screen8818492428"><a href="cmdqueryname=dhcp+relay+gateway-switch+enable"><b><span class="cmdname" id="EN-US_TASK_0000001513046158__cmdname1105692224180208">dhcp relay gateway-switch enable</span></b></a></pre>
<p id="EN-US_TASK_0000001513046158__p4755202111574">By default, DHCPv4 relay gateway switching is disabled.</p>
<div class="p" id="EN-US_TASK_0000001513046158__p707427554180208">When the primary and secondary IPv4 addresses are configured on an interface, the primary IPv4 address functions as the gateway of clients in normal cases. If clients cannot obtain IPv4 addresses from the gateway with the primary IPv4 address, enable DHCPv4 relay gateway switching to allow them to do so with a secondary IPv4 address. After DHCPv4 relay gateway switching is enabled, configure the address pool on the same network segment as the secondary IPv4 address on the remote DHCPv4 server.<ul id="EN-US_TASK_0000001513046158__ul1699351334918"><li id="EN-US_TASK_0000001513046158__li699331314496">The gateway address switches from the primary to a secondary IPv4 address only when a user has failed to obtain an IPv4 address using the primary IPv4 address at least three times and the interval between the first and last failures exceeds 24 seconds.</li><li id="EN-US_TASK_0000001513046158__li163812181493">When a primary IPv4 address and multiple secondary IPv4 addresses are configured on an interface, the primary and secondary IPv4 addresses are traversed in turn until users successfully obtain IPv4 addresses (the secondary IPv4 addresses are traversed based on the configuration sequence).</li></ul>
</div>
</p></li></ol>
</li><li><span><strong>Configure an IPv4 address for a DHCPv4 server in the DHCPv4 server group view.</strong></span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>(Optional) Enable DHCPv4 server polling on the DHCPv4 relay agent.</span><p><pre class="screen"><a href="cmdqueryname=ip+relay+address+cycle"><b><span class="cmdname">ip relay address cycle</span></b></a></pre>
<p>By default, DHCPv4 server polling is disabled on a DHCPv4 relay agent.</p>
</p></li><li class="substepexpand"><span>(Optional) Set a TTL value for DHCPv4 request messages after they are forwarded by the DHCPv4 relay agent at Layer 3.</span><p><pre class="screen"><a href="cmdqueryname=dhcp+set+ttl"><b><span class="cmdname">dhcp set ttl</span></b></a> { <strong><span>unvaried</span></strong> | <i><span class="varname">ttl-value</span></i> }</pre>
<p>By default, the TTL value of DHCPv4 request messages decreases by 1 after they are forwarded by the DHCPv4 relay agent at Layer 3.</p>
</p></li><li class="substepexpand"><span>Create a DHCPv4 server group and enter its view.</span><p><pre class="screen"><a href="cmdqueryname=dhcp+relay+server+group"><b><span class="cmdname">dhcp relay server group</span></b></a> <i><span class="varname">group-name</span></i></pre>
<p>By default, no DHCPv4 server group is created.</p>
</p></li><li class="substepexpand"><span>Configure a DHCPv4 server in the DHCPv4 server group.</span><p><pre class="screen"><a href="cmdqueryname=server"><b><span class="cmdname">server</span></b></a> <i><span class="varname">ip-address</span></i> [ <i><span class="varname">ip-address-index</span></i> ]</pre>
<p>By default, no DHCPv4 server is configured in a DHCPv4 server group.</p>
<p>A maximum of 20 DHCPv4 servers can be configured in a DHCPv4 server group.</p>
</p></li><li class="substepexpand"><span>(Optional) Configure a gateway address for the DHCPv4 server.</span><p><pre class="screen"><a href="cmdqueryname=gateway"><b><span class="cmdname">gateway</span></b></a> <i><span class="varname">ip-address</span></i></pre>
</p><p><p>By default, no gateway address is configured for a DHCPv4 server.</p>
<p>If the IPv4 address of the interface that connects the DHCPv4 relay agent to clients functions as the gateway address, skip this step. The gateway address configured in this step must be the same as the egress gateway address of clients configured on the DHCPv4 server.</p>
</p></li><li class="substepexpand"><span>(Optional) Bind the DHCPv4 server group to a specified VPN instance.</span><p><pre class="screen"><a href="cmdqueryname=vpn-instance"><b><span class="cmdname">vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></pre>
<p>By default, no DHCPv4 server group is bound to a VPN instance.</p>
<p>If the DHCPv4 relay agent is deployed on a VPN, you must bind the DHCPv4 server group to the VPN instance that has been bound to the address pool of the DHCPv4 server. Otherwise, DHCPv4 clients cannot obtain IPv4 addresses.</p>
</p></li><li class="substepexpand"><span>Return to the system view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li class="substepexpand"><span>Configure a DHCPv4 server group on an interface.</span><p><pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type interface-number</span></i>
<a href="cmdqueryname=undo+portswitch"><b><span class="cmdname">undo portswitch</span></b></a>
<a href="cmdqueryname=dhcp+relay+server-group"><b><span class="cmdname">dhcp relay server-group</span></b></a> <i><span class="varname">group-name</span></i></pre>
<p>By default, no DHCPv4 server group is configured on an interface.</p>
<p> Determine whether to run the <a href="cmdqueryname=undo+portswitch"><b><span class="cmdname">undo portswitch</span></b></a> command to switch the interface working mode to Layer 3 based on the current interface working mode.</p>
</p></li><li class="substepexpand"><span>(Optional) Enable DHCPv4 relay gateway switching.</span><p><pre class="screen" id="EN-US_TASK_0000001513046158__en-us_task_0000001513046158_screen8818492428"><a href="cmdqueryname=dhcp+relay+gateway-switch+enable"><b><span class="cmdname" id="EN-US_TASK_0000001513046158__en-us_task_0000001513046158_cmdname1105692224180208">dhcp relay gateway-switch enable</span></b></a></pre>
<p id="EN-US_TASK_0000001513046158__en-us_task_0000001513046158_p4755202111574">By default, DHCPv4 relay gateway switching is disabled.</p>
<div class="p" id="EN-US_TASK_0000001513046158__en-us_task_0000001513046158_p707427554180208">When the primary and secondary IPv4 addresses are configured on an interface, the primary IPv4 address functions as the gateway of clients in normal cases. If clients cannot obtain IPv4 addresses from the gateway with the primary IPv4 address, enable DHCPv4 relay gateway switching to allow them to do so with a secondary IPv4 address. After DHCPv4 relay gateway switching is enabled, configure the address pool on the same network segment as the secondary IPv4 address on the remote DHCPv4 server.<ul id="EN-US_TASK_0000001513046158__en-us_task_0000001513046158_ul1699351334918"><li id="EN-US_TASK_0000001513046158__en-us_task_0000001513046158_li699331314496">The gateway address switches from the primary to a secondary IPv4 address only when a user has failed to obtain an IPv4 address using the primary IPv4 address at least three times and the interval between the first and last failures exceeds 24 seconds.</li><li id="EN-US_TASK_0000001513046158__en-us_task_0000001513046158_li163812181493">When a primary IPv4 address and multiple secondary IPv4 addresses are configured on an interface, the primary and secondary IPv4 addresses are traversed in turn until users successfully obtain IPv4 addresses (the secondary IPv4 addresses are traversed based on the configuration sequence).</li></ul>
</div>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001513046158__en-us_task_0228023023_screen14848162118611"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001513046158__en-us_task_0228023023_cmdname1784862115612">commit</span></b></a></pre>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_dhcpv4_cfg_0022.html">Configuring a Device to Function as a DHCPv4 Relay Agent
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_dhcpv4_cfg_0025.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_dhcpv4_cfg_0026.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>