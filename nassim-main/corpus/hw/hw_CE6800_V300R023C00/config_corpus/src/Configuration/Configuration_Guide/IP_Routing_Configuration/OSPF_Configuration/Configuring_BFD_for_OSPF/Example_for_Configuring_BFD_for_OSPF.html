
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring BFD for OSPF">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0090.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0093.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130623436">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring BFD for OSPF</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130623436"></a><a name="EN-US_TASK_0000001130623436"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring BFD for OSPF</h1>
<div class="taskbody" id="taskbody1582969730515"><div class="context"><a name="EN-US_TASK_0000001130623436__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001130623436__context1677625172748"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001130623436__p1999434557214036">An OSPF device periodically sends Hello packets to its neighbors for fault detection, and actually detecting a fault takes more than 1 second. As related technologies mature and develop, voice, video, and video on demand (VOD) services are now more widely used than ever before. Such services are sensitive to the packet loss rate and delay, and when the traffic rate reaches gigabit per second (Gbit/s), time-consuming fault detection results in the loss of a large number of packets. As such, the high reliability requirements of carrier-class networks cannot be met. To address this problem, configure BFD for OSPF to implement fault detection within milliseconds, maximizing OSPF convergence speeds in the case of link status changes.</p>
<p id="EN-US_TASK_0000001130623436__p353886940214036">For example, on the network shown in <a href="#EN-US_TASK_0000001130623436__fig_dc_vrp_ospf_cfg_010201">Figure 1</a>, the primary link (DeviceA -&gt; DeviceB) and backup link (DeviceA -&gt; DeviceC -&gt; DeviceB) are deployed. In normal scenarios, service traffic is transmitted along the primary link. If the primary link goes faulty, DeviceA is expected to rapidly detect the fault and efficiently switch traffic to the backup link.</p>
<p id="EN-US_TASK_0000001130623436__p867379634214036">You can configure BFD for OSPF to monitor the OSPF neighbor relationship between DeviceA and DeviceB. If the link between DeviceA and DeviceB fails, BFD can rapidly detect the failure and report it to OSPF. This allows traffic to be switched to the backup link.</p>
<div class="fignone" id="EN-US_TASK_0000001130623436__fig_dc_vrp_ospf_cfg_010201"><a name="EN-US_TASK_0000001130623436__fig_dc_vrp_ospf_cfg_010201"></a><a name="fig_dc_vrp_ospf_cfg_010201"></a><span class="figcap"><b>Figure 1 </b>Network diagram of BFD for OSPF</span><div class="note" id="EN-US_TASK_0000001130623436__note940515907214036"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001130623436__p1771207029214036">In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, and <span>100GE</span> <span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001130623436__image1701331271214036" src="figure/en-us_image_0000001130783290.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130623436__1.3.2"></a><a name="1.3.2"></a>
<div class="p" id="EN-US_TASK_0000001130623436__context1211816359"><h4 class="sectiontitle">Configuration Precautions</h4><p id="EN-US_TASK_0000001130623436__p14185764612">To improve security, OSPF area authentication or interface authentication is recommended. For details, see "Improving OSPF Network Security." OSPF area authentication is used as an example. For details, see "Example for Configuring Basic OSPF Functions."</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130623436__1.3.3"></a><a name="1.3.3"></a>
<div class="p" id="EN-US_TASK_0000001130623436__context123815387283"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0000001130623436__p1006272263214036">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0000001130623436__ol1599528418214036"><li id="EN-US_TASK_0000001130623436__li377651872214036"><p id="EN-US_TASK_0000001130623436__p1380835819214036"><a name="EN-US_TASK_0000001130623436__li377651872214036"></a><a name="li377651872214036"></a>Configure basic OSPF functions on each device to ensure routing reachability.</p>
</li><li id="EN-US_TASK_0000001130623436__li1306529322214036"><p id="EN-US_TASK_0000001130623436__p818024279214036"><a name="EN-US_TASK_0000001130623436__li1306529322214036"></a><a name="li1306529322214036"></a>Enable BFD globally.</p>
</li><li id="EN-US_TASK_0000001130623436__li1926625161214036"><p id="EN-US_TASK_0000001130623436__p1030651461214036"><a name="EN-US_TASK_0000001130623436__li1926625161214036"></a><a name="li1926625161214036"></a>Configure BFD for OSPF in the specified process on DeviceA, DeviceB, and DeviceC.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130623436__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001130623436__steps10132325172748"><li id="EN-US_TASK_0000001130623436__step184812572307"><span id="EN-US_TASK_0000001130623436__cmd3848457163015">Assign an IP address to each interface.</span><p><p id="EN-US_TASK_0000001130623436__p236193772810">Assign an IP address to each interface as shown in <a href="#EN-US_TASK_0000001130623436__fig_dc_vrp_ospf_cfg_010201">Figure 1</a>. For configuration details, see configuration scripts.</p>
</p></li><li id="EN-US_TASK_0000001130623436__step1019628175319"><span id="EN-US_TASK_0000001130623436__cmd51832845316">Configure basic OSPF functions.</span><p><p id="EN-US_TASK_0000001130623436__p13369140155914">For detailed configurations, see the configuration scripts.</p>
</p></li><li id="EN-US_TASK_0000001130623436__step1909654422214036"><span id="EN-US_TASK_0000001130623436__cmd1418766139214036">Configure BFD for OSPF in the specified process.</span><p><p id="EN-US_TASK_0000001130623436__p1762810890214036"># Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001130623436__screen2891201215455">[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword425112910188"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001130623436__b2908212184517">bfd</strong>
[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword59257101233">*</span>DeviceA-bfd] <strong id="EN-US_TASK_0000001130623436__b290881215451">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword146411231134812">*</span>DeviceA] <strong id="EN-US_TASK_0000001130623436__b15908412204512">ospf 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword1252983410483">*</span>DeviceA-ospf-1] <strong id="EN-US_TASK_0000001130623436__b1790815127454">bfd all-interfaces enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword58141537174819">*</span>DeviceA-ospf-1] <strong id="EN-US_TASK_0000001130623436__b1890891254515">quit</strong>
<span>[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword3392124194818">*</span>DeviceA] <strong id="EN-US_TASK_0000001130623436__b5986214103819">commit</strong></span></pre>
<p id="EN-US_TASK_0000001130623436__p23966548214036"># Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001130623436__screen2604759154518">[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword692213317529"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001130623436__b56071599458">bfd</strong>
[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword6279164619488">*</span>DeviceB-bfd] <strong id="EN-US_TASK_0000001130623436__b1260718590459">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword054516719492">*</span>DeviceB] <strong id="EN-US_TASK_0000001130623436__b1260795954516">ospf 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword9767189174912">*</span>DeviceB-ospf-1] <strong id="EN-US_TASK_0000001130623436__b1960835911459">bfd all-interfaces enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword157988106494">*</span>DeviceB-ospf-1] <strong id="EN-US_TASK_0000001130623436__b6608759194513">quit</strong>
<span>[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword1312161204918">*</span>DeviceB] <strong id="EN-US_TASK_0000001130623436__b812919122314">commit</strong></span></pre>
<p id="EN-US_TASK_0000001130623436__p1508846497214036"># Configure DeviceC.</p>
<pre class="screen" id="EN-US_TASK_0000001130623436__screen4947135314717">[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword14226104225315"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001130623436__b17948125364717">bfd</strong>
[<span><span class="keyword" id="EN-US_TASK_0000001130623436__keyword45211618111">*</span></span>DeviceC-bfd] <strong id="EN-US_TASK_0000001130623436__b1994814531476">quit</strong>
[<span><span class="keyword" id="EN-US_TASK_0000001130623436__keyword1473816916119">*</span></span>DeviceC] <strong id="EN-US_TASK_0000001130623436__b4949145313474">ospf 1</strong>
[<span><span class="keyword" id="EN-US_TASK_0000001130623436__keyword1296115129118">*</span></span>DeviceC-ospf-1] <strong id="EN-US_TASK_0000001130623436__b1949553174711">bfd all-interfaces enable</strong>
[<span><span class="keyword" id="EN-US_TASK_0000001130623436__keyword151867187115">*</span></span>DeviceC-ospf-1] <strong id="EN-US_TASK_0000001130623436__b39491953134711">quit</strong>
<span>[<span><span class="keyword" id="EN-US_TASK_0000001130623436__keyword072612214113">*</span></span>DeviceC] <strong id="EN-US_TASK_0000001130623436__b394116175128">commit</strong></span></pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001130623436__example121226172748"><a name="EN-US_TASK_0000001130623436__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0000001130623436__p1864950432214036"># Run the <strong id="EN-US_TASK_0000001130623436__b2132728534214036">display ospf bfd session all</strong> command on any of DeviceA, DeviceB, or DeviceC. Check whether the <strong id="EN-US_TASK_0000001130623436__b11281037143215">BFDState</strong> field is displayed as <strong id="EN-US_TASK_0000001130623436__b778544463219">up</strong> in the command output.</p>
<p id="EN-US_TASK_0000001130623436__p188142925214036">The following example uses the command output on DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001130623436__screen798248931214036">[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword161221549205318"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001130623436__b1580735411214036">display ospf bfd session all</strong>
          OSPF Process 1 with Router ID 1.1.1.1
  Area 0.0.0.0 interface 1.1.1.1(<span>100GE</span><span>1/0/1</span>)'s BFD Sessions

 NeighborId:2.2.2.2          AreaId:0.0.0.0          Interface: <span>100GE</span><span>1/0/1</span>
 <strong id="EN-US_TASK_0000001130623436__b498733299214036">BFDState:up</strong>                 rx    :1000             tx       :1000
 Multiplier:3                BFD Local Dis:0         LocalIpAdd:1.1.1.1
 RemoteIpAdd:1.1.1.2         Diagnostic Info:0

  Area 0.0.0.0 interface 3.3.3.1(<span>100GE</span><span>1/0/2</span>)'s BFD Sessions

 NeighborId:3.3.3.3          AreaId:0.0.0.0          Interface: <span>100GE</span><span>1/0/2</span>
 <strong id="EN-US_TASK_0000001130623436__b1757581489214036">BFDState:up</strong>                 rx    :1000             tx       :1000
 Multiplier:3                BFD Local Dis:0         LocalIpAdd:3.3.3.1
 RemoteIpAdd:3.3.3.2         Diagnostic Info:0</pre>
<p id="EN-US_TASK_0000001130623436__p88155263529"># Run the <a href="cmdqueryname=shutdown"><b><span class="cmdname" id="EN-US_TASK_0000001130623436__cmdname183575230529">shutdown</span></b></a> command on DeviceB's <span>100GE</span><span>1/0/2</span> to simulate a fault on the primary link.</p>
<pre class="screen" id="EN-US_TASK_0000001130623436__screen585596754214036">[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword10647105420537"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001130623436__b1859964912214036">interface <span>100ge</span> <span>1/0/2</span></strong></pre>
<pre class="screen" id="EN-US_TASK_0000001130623436__screen1295397834214036">[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword43341958105310"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130623436__b2030674725214036">shutdown</strong></pre>
<p id="EN-US_TASK_0000001130623436__p1642250258214036"># Check information about the routing table on DeviceA. The routing path is switched to the backup link DeviceA -&gt; DeviceC -&gt; DeviceB after the primary link fails, and you can see that the next hop address of the route to 172.16.1.0/24 is 1.1.1.2.</p>
<pre class="screen" id="EN-US_TASK_0000001130623436__screen1505939425214036">[<span class="keyword" id="EN-US_TASK_0000001130623436__keyword184717218549"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001130623436__b337997263214036">display ospf routing</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001130623436__screen802007923214036">          OSPF Process 1 with Router ID 1.1.1.1
                   Routing Tables

 Routing for Network
 Destination        Cost       Type       NextHop         AdvRouter       Area
 2.2.2.0/24         2          Stub       1.1.1.2         3.3.3.3         0.0.0.0
 <strong id="EN-US_TASK_0000001130623436__b1476613101214036">172.16.1.0/24      3          Stub       1.1.1.2         2.2.2.2         0.0.0.0</strong>

 Total Nets: 2
 Intra Area: 2  Inter Area: 0  ASE: 0  NSSA: 0</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001130623436__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul id="EN-US_TASK_0000001130623436__ul688385339214036"><li id="EN-US_TASK_0000001130623436__li1894603863214036"><p id="EN-US_TASK_0000001130623436__p1867091372214036"><a name="EN-US_TASK_0000001130623436__li1894603863214036"></a><a name="li1894603863214036"></a>DeviceA</p>
<pre class="screen" id="EN-US_TASK_0000001130623436__screen11696719125516">#
sysname DeviceA
#
router id 1.1.1.1
#
bfd
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 1.1.1.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 3.3.3.1 255.255.255.0
#
ospf 1
 bfd all-interfaces enable
 area 0.0.0.0
  network 3.3.3.0 0.0.0.255
  network 1.1.1.0 0.0.0.255
#
return</pre>
</li><li id="EN-US_TASK_0000001130623436__li402677172214036"><p id="EN-US_TASK_0000001130623436__p1074258107214036"><a name="EN-US_TASK_0000001130623436__li402677172214036"></a><a name="li402677172214036"></a>DeviceB</p>
<pre class="screen" id="EN-US_TASK_0000001130623436__screen171320538564">#
sysname DeviceB
#
router id 2.2.2.2
#
bfd
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 2.2.2.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 3.3.3.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 172.16.1.1 255.255.255.0
#
ospf 1
 bfd all-interfaces enable
 area 0.0.0.0
  network 3.3.3.0 0.0.0.255
  network 2.2.2.0 0.0.0.255
  network 172.16.1.0 0.0.0.255
#
return</pre>
</li><li id="EN-US_TASK_0000001130623436__li891390865214036"><p id="EN-US_TASK_0000001130623436__p760346583214036"><a name="EN-US_TASK_0000001130623436__li891390865214036"></a><a name="li891390865214036"></a>DeviceC</p>
<pre class="screen" id="EN-US_TASK_0000001130623436__screen256620414578">#
sysname DeviceC
#
router id 3.3.3.3
#
bfd
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 1.1.1.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 2.2.2.1 255.255.255.0
#
ospf 1
 bfd all-interfaces enable
 area 0.0.0.0
  network 1.1.1.0 0.0.0.255
  network 2.2.2.0 0.0.0.255
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_ospf_cfg_0090.html">Configuring BFD for OSPF
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_ospf_cfg_0093.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>