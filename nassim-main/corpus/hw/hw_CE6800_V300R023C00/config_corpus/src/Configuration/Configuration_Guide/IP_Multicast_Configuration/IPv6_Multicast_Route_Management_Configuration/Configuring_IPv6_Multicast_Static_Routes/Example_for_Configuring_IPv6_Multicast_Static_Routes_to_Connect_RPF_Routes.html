
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring IPv6 Multicast Static Routes to Connect RPF Routes">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_mcastv6_cfg_0008.html">
<meta name="DC.Relation" scheme="URI" content="vrp_mcastv6_cfg_0012.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="IPv6 Multicast Route Management">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv6 Multicast Route Management">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IPv6 Multicast Route Management">
<meta name="featuretype" content="IP Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001533240822">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring IPv6 Multicast Static Routes to Connect RPF Routes</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001533240822"></a><a name="EN-US_TASK_0000001533240822"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring IPv6 Multicast Static Routes to Connect RPF Routes</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001533240822__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><div class="p"><h4 class="sectiontitle">Networking Scenario</h4><p>In <a href="#EN-US_TASK_0000001533240822__fig1912652714446">Figure 1</a>, IPv6 PIM-SM is running on the network, all devices support multicast, and the receiver can receive information from the multicast source Source1. DeviceB and DeviceC run OSPFv3, and no unicast routes are available for communication between DeviceA and DeviceB or between DeviceA and DeviceC. To enable the receiver to receive multicast data from multicast source Source2 that is not in the OSPF domain, configure multicast static routes to connect the RPF routes.</p>
<div class="fignone" id="EN-US_TASK_0000001533240822__fig1912652714446"><a name="EN-US_TASK_0000001533240822__fig1912652714446"></a><a name="fig1912652714446"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring IPv6 multicast static routes to connect RPF routes</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1, interface2, and interface3 represent <span>100GE</span><span>1/0/1</span>, <span>100GE</span><span>1/0/2</span>, and <span>100GE</span><span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001583640761.png"></span></div>
<h4 class="sectiontitle">Precautions</h4><p>Note the following during the configuration:</p>
<ul><li><p>When configuring a multicast static route, if the next hop is a P2P interface, you can specify the next hop through the outbound interface number. If the next hop is not a P2P interface, you must specify the next hop through the next-hop address.</p>
</li></ul>
<h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Assign IPv6 addresses to interfaces and configure OSPFv3 as the unicast routing protocol.</p>
</li><li><p>Enable multicast routing on each device, enable IPv6 PIM-SM on each interface, and enable MLD on interfaces connected to hosts.</p>
</li><li><p>Configure a C-BSR and a C-RP.</p>
</li><li><p>Configure an IPv6 multicast static route on DeviceB and DeviceC.</p>
</li></ol>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001533240822__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign IPv6 addresses to interfaces and configure OSPFv3 as the unicast routing protocol.</span><p><p># Configure DeviceB.</p>
<pre class="screen">&lt;HUAWEI&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceB</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>interface </strong><strong><span>100GE</span></strong> <strong><span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>undo </strong><strong>portswitch</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 address 2001:db8:2::2 64</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface </strong><strong><span>100GE</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>undo </strong><strong>portswitch</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>]<strong> ipv6 enable</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>ipv6 address 2001:db8:3::1 64</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface </strong><strong><span>100GE</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong>undo </strong><strong>portswitch</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong>ipv6 address 2001:db8:4::1 64</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>ospfv3 1</strong>
[<span class="keyword">*</span>DeviceB-ospfv3-1] <strong>router-id 2.2.2.2</strong>
[<span class="keyword">*</span>DeviceB-ospfv3-1] <strong>area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span>DeviceB-ospfv3-1-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB-ospfv3-1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
<p>The configurations of DeviceA and DeviceC are similar to the configuration of DeviceB. For detailed configurations, see Configuration Scripts.</p>
</p></li><li><span>Enable the multicast function on all the devices and enable IPv6 PIM-SM on all the involved interfaces.</span><p><p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>multicast ipv6 routing-enable</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface </strong><strong><span>100GE</span></strong> <strong><span>1/0/1</span></strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface </strong><strong><span>100GE</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface </strong><strong><span>100GE</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>]<strong> pim ipv6 sm</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
<p>The configurations of DeviceA and DeviceC are similar to the configuration of DeviceB. For detailed configurations, see Configuration Scripts.</p>
</p></li><li><span>Enable MLD on the interfaces connected to user hosts.</span><p><p># Enable MLD on the interface connecting DeviceC to the host.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>interface </strong><strong><span>100GE</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>mld enable</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC] <strong>commit</strong></pre>
</p></li><li><span>Configure a C-BSR and a C-RP.</span><p><p># Configure interface1 on DeviceB as the C-BSR and C-RP.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>pim</strong><strong> ipv6</strong>
[<span class="keyword">*</span>DeviceB-pim6] <strong>c-bsr </strong><strong>2001:db8:2::2</strong>
[<span class="keyword">*</span>DeviceB-pim6] <strong>c-rp </strong><strong>2001:db8:2::2</strong>
[<span class="keyword">*</span>DeviceB-pim6] <strong>commit</strong></pre>
<p>Both Source1 (2001:db8:3::1/64) and Source2 (2001:db8:5::2/64) send multicast data to multicast group G (FF13::1). After Receiver joins group G, it can receive multicast data from Source1 but not from Source2. After the <strong>display multicast ipv6 rpf-info 2001:db8:5::</strong> command is run on DeviceB and DeviceC, no command output is displayed, indicating that the devices have no RPF routes to Source2.</p>
</p></li><li><span>Configure multicast static routes.</span><p><p># Configure a multicast static route on DeviceB, and specify DeviceA as the RPF neighbor to Source2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>ipv6 rpf-route-static 2001:db8:5::2 64 2001:db8:4::2</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
<p># Configure a multicast static route on DeviceC, and specify DeviceB as the RPF neighbor to Source2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>ipv6 rpf-route-static 2001:db8:5::2 64 2001:db8:2::2</strong>
[<span class="keyword">*</span>DeviceC] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001533240822__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Run the <a href="cmdqueryname=display+multicast+ipv6+rpf-info"><b><span class="cmdname">display multicast ipv6 rpf-info</span></b></a> command on DeviceB and DeviceC to check the RPF routes to Source2. The displayed information is as follows:</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display multicast ipv6 rpf-info 2001:db8:5::</strong>
VPN-Instance: public net
RPF information about source 2001:db8:5::2
     RPF interface: <strong><span>100GE</span><span>1/0/3</span></strong>, RPF neighbor: <strong>2001:db8:4::2</strong>
     Referenced route/mask: 2001:db8:5::/64
     Referenced route type:<strong>mstatic</strong>
     Route selection rule: preference-preferred
     Load splitting rule: disable</pre>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>display multicast ipv6 rpf-info 2001:db8:5::</strong>
VPN-Instance: public net
RPF information about source 2001:db8:5::2
     RPF interface: <strong><span>100GE</span></strong><strong><span>1/0/1</span></strong>, RPF neighbor: <strong>2001:db8:2::2</strong>
     Referenced route/mask: 2001:db8:5::/64
     Referenced route type:<strong>mstatic</strong>
     Route selection rule: preference-preferred
     Load splitting rule: disable</pre>
<p># Run the <strong>display pim ipv6 routing-table</strong> command on DeviceC to check the routing table information. DeviceC has the multicast entry of Source2. The receiver can receive multicast data from Source2.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>display pim ipv6 routing-table</strong>
VPN-Instance: public net
 Total 1 (*, G) entry; 2 (S, G) entries

 (*, FF13::1)
     RP: 2001:db8:2::2
     Protocol: PIM-SM, Flag: WC
     UpTime: 03:54:19
     Upstream interface: NULL, Refresh time: 03:54:19
         Upstream neighbor: NULL
         RPF prime neighbor: NULL
     Downstream interface(s) information:
     Total number of downstreams: 1
         1: <strong><span>100GE</span></strong><strong><span>1/0/2</span></strong>
             Protocol: PIM-SM, UpTime: 01:38:19, Expires: never

(2001:db8:3::2, FF13::1)     
     RP: 2001:db8:2::2
     Protocol: PIM-SM, Flag: ACT
     UpTime: 00:00:44
     Upstream interface: <strong><span>100GE</span></strong><strong><span>1/0/1</span></strong>, Refresh time: 00:00:44
         Upstream neighbor: 2001:db8:2::2
         RPF prime neighbor: 2001:db8:2::2
     Downstream interface(s) information:
     Total number of downstreams: 1
          1: <strong><span>100GE</span></strong><strong><span>1/0/2</span></strong>
              Protocol: PIM-SM, UpTime: 00:00:44, Expires: never

(2001:db8:5::2, FF13::1)     
     RP: 2001:db8:2::2
     Protocol: PIM-SM, Flag: ACT
     UpTime: 00:00:44
     Upstream interface: <strong><span>100GE</span></strong><strong><span>1/0/1</span></strong>, Refresh time: 00:00:44
         Upstream neighbor: 2001:db8:2::2
         RPF prime neighbor: 2001:db8:2::2
     Downstream interface(s) information:
     Total number of downstreams: 1
          1: <strong><span>100GE</span></strong><strong><span>1/0/2</span></strong>
              Protocol: PIM-SM, UpTime: 00:00:44, Expires: never</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001533240822__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
multicast ipv6 routing-enable
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:5::1/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:4::2/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
ospfv3 1
 router-id 1.1.1.1
 area 0.0.0.0
#
return</pre>
</li><li><p>DeviceB</p>
<pre class="screen">#
sysname DeviceB
#
multicast ipv6 routing-enable
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:2::2/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:3::1/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:4::1/64
 pim ipv6 sm
#
ospfv3 1
 router-id 2.2.2.2
 area 0.0.0.0
#
pim ipv6
 c-bsr 2001:db8:2::2
 c-rp 2001:db8:2::2
#
ipv6 rpf-route-static 2001:db8:5:: 64 2001:db8:4::2
#
return</pre>
</li><li><p>DeviceC</p>
<pre class="screen">#
sysname DeviceC
#
multicast ipv6 routing-enable
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:1::1/64
 pim ipv6 sm
 mld enable
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:2::1/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
ospfv3 1
 router-id 3.3.3.3
 area 0.0.0.0
#
ipv6 rpf-route-static 2001:db8:5:: 64 2001:db8:2::2
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_mcastv6_cfg_0008.html">Configuring IPv6 Multicast Static Routes
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_mcastv6_cfg_0012.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>