
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring an NQA TCP Test to Measure the Response Time on an IP Network">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_nqa_cfg_0009.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_nqa_cfg_0016.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_nqa_cfg_0018.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="NQA">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NQA">
<meta name="featuretype" content="System Monitoring">
<meta name="featurename" content="NQA">
<meta name="featuretype" content="System Monitoring">
<meta name="featurename" content="NQA">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176661835">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring an NQA TCP Test to Measure the Response Time on an IP Network</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176661835"></a><a name="EN-US_TASK_0000001176661835"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring an NQA TCP Test to Measure the Response Time on an IP Network</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176661835__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0000001176661835__fig_dc_vrp_nqa_cfg_002601">Figure 1</a>, the headquarters and its subsidiary need to communicate with each other across an external network. DeviceA and DeviceD are egress devices of the headquarters and subsidiary, respectively. DeviceB and DeviceC are edge devices of the external network.</p>
<p>The headquarters and its subsidiary often need to use TCP to exchange files with each other. The time taken to respond to a TCP transmission request must be less than 800 ms. An NQA TCP test can be configured to measure the TCP response time between DeviceA and DeviceD.</p>
<div class="fignone" id="EN-US_TASK_0000001176661835__fig_dc_vrp_nqa_cfg_002601"><a name="EN-US_TASK_0000001176661835__fig_dc_vrp_nqa_cfg_002601"></a><a name="fig_dc_vrp_nqa_cfg_002601"></a><span class="figcap"><b>Figure 1 </b>Network diagram for an NQA TCP test to measure the response time on an IP network</span><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 and interface2 represent <span><span>100GE</span> <span>1/0/1</span> and </span><span><span>100GE</span></span> <span>1/0/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001176741759.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176661835__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure DeviceD as an NQA client and DeviceA as an NQA server, and configure a TCP test instance on DeviceA.</p>
</li><li>Start the test instance.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176661835__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>IP addresses of DeviceA and DeviceD</p>
</li><li><p>Listening port number of the TCP service</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176661835__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure DeviceA as the NQA server.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> nqa server tcpconnect 10.1.1.1 4000</strong></pre>
</p></li><li><span>Configure DeviceD as the NQA client, create a TCP test instance, and set the destination IP address to the IP address of DeviceA.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceD</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD]<strong> nqa test-instance admin tcp</strong>
[<span class="keyword">*</span>DeviceD-nqa-admin-tcp]<strong> test-type tcp</strong>
[<span class="keyword">*</span>DeviceD-nqa-admin-tcp]<strong> destination-address ipv4 10.1.1.1</strong>
[<span class="keyword">*</span>DeviceD-nqa-admin-tcp]<strong> destination-port 4000</strong></pre>
</p></li><li><span>Start the test instance immediately.</span><p><pre class="screen">[<span class="keyword">*</span>DeviceD-nqa-admin-tcp]<strong> start now</strong>
[<span class="keyword">*</span>DeviceD-nqa-admin-tcp] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001176661835__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Verify the test result. The command output indicates that the response time is less than 800 ms.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD-nqa-admin-tcp] <strong>display nqa results test-instance admin tcp</strong>

NQA entry(admin, tcp): test flag is active, test type is TCP
1 . Test 1 result The test is finished
    Send operation times: 3               Receive response times: 3 
    Completion: success                   RTD over thresholds number: 0
    Attempts number: 1                    Drop operation number: 0
    Disconnect operation number: 0        Operation timeout number: 0
    System busy operation number: 0       Connection fail number: 0
    Operation sequence errors number: 0   RTT Status errors number: 0
    Destination IP address: 10.1.1.1
    <strong>Min/Max/Average completion time</strong>: 600/610/603
    Sum/Square-Sum completion time: 1810/1092100
    Last response packet receiving time: 2020-04-16 12:59:41.6
    Lost packet ratio: 0 %</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001176661835__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
vlan batch 100
#
interface Vlanif100
 ip address 10.1.1.1 255.255.255.0
#
nqa server tcpconnect 10.1.1.1 4000
#
isis 1
 network-entity 00.0000.0000.0001.00
#
interface <span><span>100GE</span></span><span>1/0/1</span>
 port link-type trunk
 port trunk allow-pass vlan 100
 isis enable 1
#
return</pre>
</li><li><p><span class="keyword">Device</span>D</p>
<pre class="screen">#
sysname DeviceD
#
vlan batch 100
#
interface Vlanif100
 ip address 10.2.2.1 255.255.255.0
#
isis 1
 network-entity 00.0000.0000.0002.00
#
interface <span><span>100GE</span></span><span>1/0/1</span>
 port link-type trunk
 port trunk allow-pass vlan 100 
 isis enable 1
#
nqa test-instance admin tcp
 test-type tcp
 destination-address ipv4 10.1.1.1
 destination-port 4000
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_nqa_cfg_0009.html">Configuring NQA to Test an IP Network
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_nqa_cfg_0016.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../vrp/vrp_nqa_cfg_0018.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>