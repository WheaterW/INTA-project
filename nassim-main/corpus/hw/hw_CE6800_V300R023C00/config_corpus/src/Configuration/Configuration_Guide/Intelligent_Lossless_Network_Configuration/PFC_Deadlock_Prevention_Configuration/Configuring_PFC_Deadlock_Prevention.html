
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring PFC Deadlock Prevention">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_ai_pfcdeadlock_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_ai_pfcdeadlock_cfg_0006.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_ai_pfcdeadlock_cfg_0008.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="PFC Deadlock Prevention">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="PFC Deadlock Prevention">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001512689322">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring PFC Deadlock Prevention</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001512689322"></a><a name="EN-US_TASK_0000001512689322"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring PFC Deadlock Prevention</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001512689322__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>PFC deadlock prevention preemptively avoids PFC deadlocks for Clos networks. The PFC-enabled device identifies a service flow (hook-shaped flow) that may cause a PFC deadlock, and modifies the queue priority of the hook-shaped flow to prevent a PFC deadlock.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001512689322__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Create a PFC uplink interface group and enter the PFC uplink interface group view.</span><p><pre class="screen"><a href="cmdqueryname=dcb+pfc+uplink+group"><b><span class="cmdname">dcb pfc uplink group</span></b></a> <i><span class="varname">groupname</span></i></pre>
<p>By default, no PFC uplink interface group exists in the system.</p>
</p></li><li><span>Add interfaces to the PFC uplink interface group.</span><p><pre class="screen"><a href="cmdqueryname=group-member+interface"><b><span class="cmdname">group-member interface</span></b></a> { <em><i><span class="varname">interface-name</span></i></em> | <i><span class="varname">interface-type interface-number</span></i> } [ <strong><span>to</span></strong> { <em>interface-name</em> | <i><span class="varname">interface-type interface-number</span></i> } ] &amp;&lt;1-32&gt;</pre>
<p>By default, no interface is added to a PFC uplink interface group.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>Only physical interfaces can be added to a PFC uplink interface group.</li><li>A maximum of one PFC uplink interface group can be created. If two PFC uplink interface groups exist before the upgrade, the two PFC uplink interface groups still take effect after the upgrade.</li></ul>
<p>For the <span>CE6866, CE6860-SAN, CE6866K, CE6860-HAM, CE8851-32CQ8DQ-P, CE8850-SAN, CE8851K, CE8850-HAM</span>:</p>
<ul><li>The PFC deadlock prevention function takes effect only when the physical interfaces added to the PFC uplink interface group have no logical interface configuration or when they are main interfaces or member interfaces of an Eth-Trunk. Logical interfaces such as sub-interfaces, VLANIF interfaces, and VBDIF interfaces cannot be configured on such physical interfaces.</li><li>If you add a physical interface that has been added to an Eth-Trunk to a PFC uplink interface group, PFC deadlock prevention takes effect on the Eth-Trunk.</li></ul>
<p>For the <span>CE6855-48XS8CQ, CE6863E-48S8CQ, CE6885, CE6885-LL, CE6885-SAN, CE6885-T, CE8851-32CQ4BQ, CE8855</span>:</p>
<p>PFC deadlock prevention takes effect on physical interfaces.</p>
</div></div>
</p></li><li><span>Adjust the queue priority and DSCP value of packets in a hook-shaped flow matching a PFC uplink interface group.</span><p><pre class="screen"><a href="cmdqueryname=adjust"><b><span class="cmdname">adjust</span></b></a> <strong><span>original-dscp</span></strong> <i><span class="varname">original-dscpvalue</span></i> <strong><span>to</span></strong> <strong><span>priority</span></strong> <i><span class="varname">prioritynumber</span></i> <strong><span>dscp</span></strong> <i><span class="varname">dscpvalue</span></i></pre>
<p>By default, there is no configuration for a hook-shaped flow matching a PFC uplink interface group.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>You can adjust the DSCP value of packets in a hook-shaped flow by referring to the table that lists the mappings of IP packet DSCP values to internal priorities or drop priorities in the inbound direction in <a href="galaxy_qos_priority_mapping_cfg_0005.html">Default Settings for Priority Mapping</a>. This ensures that the packets are still forwarded through the specified queue on the downstream device.</li><li>The <a href="cmdqueryname=adjust"><b><span class="cmdname">adjust</span></b></a> command can be configured at most twice in a PFC uplink interface group, and the settings of the <i><span class="varname">original-dscpvalue</span></i>, <i><span class="varname">prioritynumber</span></i>, and <i><span class="varname">dscpvalue</span></i> parameters must be different in the two command configurations. If the configuration needs to be modified, run the <a href="cmdqueryname=undo+adjust"><b><span class="cmdname">undo adjust</span></b></a> <strong><span>original-dscp</span></strong> <i><span class="varname">original-dscpvalue</span></i> <strong><span>to</span></strong> <strong><span>priority</span></strong> <i><span class="varname">prioritynumber</span></i> <strong><span>dscp</span></strong> <i><span class="varname">dscpvalue</span></i> command to delete the original configuration first.</li></ul>
</div></div>
</p></li><li><span>Return to the system view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001512689322__en-us_task_0228023023_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001512689322__en-us_task_0228023023_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_ai_pfcdeadlock_cfg_0001.html">PFC Deadlock Prevention Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_ai_pfcdeadlock_cfg_0006.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_ai_pfcdeadlock_cfg_0008.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>