
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Setting the Network Type to P2MP">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0020.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0024.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0100.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176742929">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Setting the Network Type to P2MP</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176742929"></a><a name="EN-US_TASK_0000001176742929"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Setting the Network Type to P2MP</h1>
<div class="taskbody"><div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001176742929__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before setting the network type to P2MP, you have completed the following task:</p>
<ul><li><p><a href="vrp_ospf_cfg_0010.html">Configure basic OSPF functions</a>.</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176742929__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the interface view.</span><p><pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></pre>
</p></li><li><span>Switch the interface working mode to Layer 3.</span><p><pre class="screen"><a href="cmdqueryname=undo+portswitch"><b><span class="cmdname">undo portswitch</span></b></a></pre>
<p></p>
<p>Determine whether to perform this step based on the current interface working mode.</p>
</p></li><li><span>Set the network type of the OSPF interface to P2MP.</span><p><pre class="screen"><a href="cmdqueryname=ospf+network-type"><b><span class="cmdname">ospf network-type</span></b></a> <strong><span>p2mp</span></strong></pre>
<p>A P2MP network can be obtained only by changing a network type to P2MP. For an interface with the NBMA network type, if the network is not fully meshed, change the network type of the interface to P2MP. By doing this, two indirectly connected devices can communicate through a third device that can directly reach both devices. After the network type of the interface is changed to P2MP, there is no need to manually specify a neighbor.</p>
</p></li><li><span>(Optional) Disable OSPF from checking the network mask.</span><p><pre class="screen"><a href="cmdqueryname=ospf+p2mp-mask-ignore"><b><span class="cmdname">ospf p2mp-mask-ignore</span></b></a></pre>
<p>By default, OSPF checks the network mask of Hello packets on a P2MP network. Devices with different network mask lengths cannot establish a neighbor relationship. After devices are configured not to check the network masks in Hello packets, OSPF neighbor relationships can be established.</p>
</p></li><li><span>(Optional) Configure the device to filter the LSAs to be sent on the P2MP network.</span><ol type="a"><li class="substepexpand"><span>Return to the system view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li class="substepexpand"><span>Create an ACL and enter the ACL view.</span><p><pre class="screen"><a href="cmdqueryname=acl"><b><span class="cmdname">acl</span></b></a> { <strong><span>name</span></strong> <i><span class="varname">basic-acl-name</span></i> { <strong><span>basic</span></strong> | [ <strong><span>number</span></strong> ] <i><span class="varname">basic-acl-number</span></i> } | [ <strong><span>number</span></strong> ] <i><span class="varname">basic-acl-number</span></i> }</pre>
</p></li><li class="substepexpand"><span>Configure an ACL rule.</span><p><pre class="screen"><a href="cmdqueryname=rule"><b><span class="cmdname">rule </span></b></a>[ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } [ <strong><span>fragment-type</span></strong> <strong><span>fragment</span></strong> | <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">src-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>logging</span></strong> ] <sup>*</sup></pre>
<p>When the <a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> command is used to configure a filtering rule for a named ACL, only the configurations specified by <strong><span>source</span></strong> and <strong><span>time-range</span></strong> take effect.</p>
<p>The following table lists the strategies that can be taken when an ACL is used for filtering.</p>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 1 </b>ACL strategies</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="32.59%" id="mcps1.3.2.6.2.3.2.4.2.3.1.1" liSelected="liSelected"><p>Condition</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="67.41%" id="mcps1.3.2.6.2.3.2.4.2.3.1.2" liSelected="liSelected"><p>Result</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="32.59%" headers="mcps1.3.2.6.2.3.2.4.2.3.1.1 "><p>The action in an ACL rule is <strong>permit</strong>.</p>
</td>
<td class="cellrowborder" valign="top" width="67.41%" headers="mcps1.3.2.6.2.3.2.4.2.3.1.2 "><p>The matched LSAs will be advertised.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.59%" headers="mcps1.3.2.6.2.3.2.4.2.3.1.1 "><p>The action in an ACL rule is <strong>deny</strong>.</p>
</td>
<td class="cellrowborder" valign="top" width="67.41%" headers="mcps1.3.2.6.2.3.2.4.2.3.1.2 "><p>The matched LSAs will not be advertised.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.59%" headers="mcps1.3.2.6.2.3.2.4.2.3.1.1 "><p>The network segment of a route is beyond the range specified in an ACL rule.</p>
</td>
<td class="cellrowborder" valign="top" width="67.41%" headers="mcps1.3.2.6.2.3.2.4.2.3.1.2 "><p>The LSA carrying the route information will not be advertised by default.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.59%" headers="mcps1.3.2.6.2.3.2.4.2.3.1.1 "><p>The ACL does not contain rules.</p>
</td>
<td class="cellrowborder" valign="top" width="67.41%" headers="mcps1.3.2.6.2.3.2.4.2.3.1.2 "><p>Any LSAs matched against the filtering policy based on this ACL will not be advertised.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.59%" headers="mcps1.3.2.6.2.3.2.4.2.3.1.1 "><p>If the configuration order is used as the ACL rule matching order, LSAs are matched against the ACL rules based on the configuration order by default. If the ACL rules are numbered with IDs, LSAs are matched against the ACL rules in ascending order of their IDs.</p>
</td>
<td class="cellrowborder" valign="top" width="67.41%" headers="mcps1.3.2.6.2.3.2.4.2.3.1.2 "><p>In this case, LSAs can be filtered using a blacklist or whitelist:</p>
<p>Filtering using a blacklist: Configure a rule with a smaller ID and specify the action <strong>deny</strong> in this rule to filter out the unwanted LSAs. Then, configure another rule with a larger ID in the same ACL and specify the action <strong>permit</strong> in this rule to advertise the other LSAs.</p>
<p>Filtering using a whitelist: Configure a rule with a smaller ID and specify the action <strong>permit</strong> in this rule to permit the LSAs to be advertised. Then, configure another rule with a larger ID in the same ACL and specify the action <strong>deny</strong> in this rule to filter out unwanted LSAs.</p>
</td>
</tr>
</tbody>
</table>
</div>
</p></li><li class="substepexpand"><span>Enter the OSPF view.</span><p><pre class="screen"><a href="cmdqueryname=ospf"><b><span class="cmdname">ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ]</pre>
</p></li><li class="substepexpand"><span>Configure the device to filter the LSAs to be sent to a specified neighbor.</span><p><pre class="screen"><a href="cmdqueryname=filter-lsa-out+peer"><b><span class="cmdname">filter-lsa-out peer</span></b></a> <i><span class="varname">peer-addr</span></i> { <strong><span>all</span></strong> | { <strong><span>ase</span></strong> [ <strong><span>acl</span></strong> { <i><span class="varname">ase-acl-num</span></i> | <i><span class="varname">ase-acl-name</span></i> } ] | <strong><span>nssa</span></strong> [ <strong><span>acl</span></strong> { <i><span class="varname">nssa-acl-num</span></i> | <i><span class="varname">nssa-acl-name</span></i> } ] | <strong><span>summary</span></strong> [ <strong><span>acl</span></strong> { <i><span class="varname">sum-acl-num</span></i> | <i><span class="varname">sum-acl-name</span></i> } ] } <sup>*</sup> }</pre>
</p></li></ol>
</li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001176742929__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001176742929__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001176742929__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ul><li>Run the <a href="cmdqueryname=display+ospf"><b><span class="cmdname">display ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ] <strong><span>interface</span></strong> [ <strong><span>all</span></strong><span> | <strong><span>no-peer</span></strong></span> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> ] [ <strong><span>verbose</span></strong> ] command to check information about OSPF interfaces.</li><li>Run the <a href="cmdqueryname=display+ospf"><b><span class="cmdname">display ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ] <strong><span>peer</span></strong> command to check information about OSPF neighbors.</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_ospf_cfg_0020.html">Configuring Network Types for OSPF Interfaces
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_ospf_cfg_0024.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../vrp/vrp_ospf_cfg_0100.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>