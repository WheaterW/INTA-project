
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Understanding Active-Route-Advertise">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_0157.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_0158.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001130783912">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Understanding Active-Route-Advertise</title>
</head>
<body><a name="EN-US_CONCEPT_0000001130783912"></a><a name="EN-US_CONCEPT_0000001130783912"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Understanding Active-Route-Advertise</h1>
<div><p></p>
<div class="section"><h4 class="sectiontitle">Context</h4><p>Active-route-advertise allows a device to advertise only optimal routes in the IP routing table to its BGP peers.</p>
<p>This feature prevents changes in selected routes to be advertised that may occur after independent BGP route selection is implemented. Currently, BGP uses independent route selection policies for route advertisement by default, allowing the optimal routes selected in the BGP routing table to be advertised to BGP peers, regardless of whether these routes are optimal in the IP routing table. However, in earlier versions that do not support independent route selection, a BGP route can be advertised to a peer only if the route is optimal in the IP routing table. Once a device is upgraded to support independent BGP route selection, the selected routes to be advertised to a peer may change, causing the data forwarding paths to be different from those used before the upgrade. To prevent these changes, you can configure active-route-advertise on the device.</p>
</div>
<div class="section"><h4 class="sectiontitle">Related Concepts</h4><p>IP routing table: stores routes that are optimal in each available protocol-specific routing table. The route management module selects optimal routes from the stored routes and delivers those selected to the forwarding information base (FIB) table.</p>
<p>Independent BGP route selection: enables a device to advertise optimal routes selected in the BGP routing table to BGP peers, regardless of whether these routes are optimal in the IP routing table.</p>
</div>
<div class="section"><h4 class="sectiontitle">Implementation</h4><p>On the network shown in <a href="#EN-US_CONCEPT_0000001130783912__fig_dc_vrp_bgp_feature_003101">Figure 1</a>, DeviceA and DeviceB are connected through a route reflector (RR), and DeviceA and the RR establish an OSPF neighbor relationship. DeviceB and DeviceC establish an EBGP peer relationship, and DeviceA and DeviceC are not directly connected.</p>
<div class="fignone" id="EN-US_CONCEPT_0000001130783912__fig_dc_vrp_bgp_feature_003101"><a name="EN-US_CONCEPT_0000001130783912__fig_dc_vrp_bgp_feature_003101"></a><a name="fig_dc_vrp_bgp_feature_003101"></a><span class="figcap"><b>Figure 1 </b>Network diagram of active-route-advertise</span><br><span><img class="vsd" src="figure/en-us_image_0000001130783984.png" width="NaN" height="NaN"></span></div>
<p>The route 10.0.0.0/8 is imported to the BGP and OSPF routing tables on DeviceA, and the RR learns both the BGP route 10.0.0.0/8 and OSPF route 10.0.0.0/8. By default, the OSPF route 10.0.0.0/8 is selected as an optimal route in the IP routing table through route preference comparison. <a href="#EN-US_CONCEPT_0000001130783912__table_active-route01">Table 1</a> describes the changes after the RR is upgraded to support independent BGP route selection, including the changes in optimal route selection, route advertisement, and data forwarding path.</p>

<div class="tableBorder"><a name="EN-US_CONCEPT_0000001130783912__table_active-route01"></a><a name="table_active-route01"></a><table cellpadding="4" cellspacing="0" summary="" id="EN-US_CONCEPT_0000001130783912__table_active-route01" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Change description</caption><thead align="left"><tr valign="middle"><th align="left" class="cellrowborder" valign="middle" width="25%" id="mcps1.4.3.5.2.5.1.1" liSelected="liSelected"><p>Item</p>
</th>
<th align="left" class="cellrowborder" valign="middle" width="25%" id="mcps1.4.3.5.2.5.1.2" liSelected="liSelected"><p>Source Version</p>
</th>
<th align="left" class="cellrowborder" valign="middle" width="25%" id="mcps1.4.3.5.2.5.1.3" liSelected="liSelected"><p>Target Version Without Active-Route-Advertise</p>
</th>
<th align="left" class="cellrowborder" valign="middle" width="25%" id="mcps1.4.3.5.2.5.1.4" liSelected="liSelected"><p>Target Version with Active-Route-Advertise</p>
</th>
</tr>
</thead>
<tbody><tr valign="middle"><td class="cellrowborder" valign="middle" headers="mcps1.4.3.5.2.5.1.1 "><p><strong>Optimal route selection</strong></p>
</td>
<td class="cellrowborder" colspan="3" align="center" valign="middle" headers="mcps1.4.3.5.2.5.1.2 mcps1.4.3.5.2.5.1.3 mcps1.4.3.5.2.5.1.4 "><p>The BGP route 10.0.0.0/8 is optimal in the RR's BGP routing table, but not optimal in the IP routing table.</p>
</td>
</tr>
<tr valign="middle"><td class="cellrowborder" valign="middle" width="25%" headers="mcps1.4.3.5.2.5.1.1 "><p><strong>Route advertisement</strong></p>
</td>
<td class="cellrowborder" valign="middle" width="25%" headers="mcps1.4.3.5.2.5.1.2 "><p>Because independent BGP route selection is not supported, the RR does not advertise the BGP route 10.0.0.0/8 to DeviceB. As a result, DeviceC learns only the routes advertised by DeviceE and not by DeviceB.</p>
</td>
<td class="cellrowborder" valign="middle" width="25%" headers="mcps1.4.3.5.2.5.1.3 "><p>Because independent BGP route selection is supported, the RR advertises the BGP route 10.0.0.0/8 to DeviceB. As a result, DeviceC learns the routes advertised by both DeviceB and DeviceE.</p>
</td>
<td class="cellrowborder" valign="middle" width="25%" headers="mcps1.4.3.5.2.5.1.4 "><p>Because the BGP route 10.0.0.0/8 is not an optimal route in the RR's IP routing table, the RR does not advertise this route to DeviceB. As a result, DeviceC learns only the routes advertised by DeviceE and not by DeviceB.</p>
</td>
</tr>
<tr valign="middle"><td class="cellrowborder" valign="middle" width="25%" headers="mcps1.4.3.5.2.5.1.1 "><p><strong>Available data forwarding paths</strong></p>
</td>
<td class="cellrowborder" valign="middle" width="25%" headers="mcps1.4.3.5.2.5.1.2 "><p>Link B</p>
</td>
<td class="cellrowborder" valign="middle" width="25%" headers="mcps1.4.3.5.2.5.1.3 "><p>Link A and Link B</p>
</td>
<td class="cellrowborder" valign="middle" width="25%" headers="mcps1.4.3.5.2.5.1.4 "><p>Link B</p>
</td>
</tr>
<tr valign="middle"><td class="cellrowborder" valign="middle" width="25%" headers="mcps1.4.3.5.2.5.1.1 "><p><strong>Actually selected data forwarding path</strong></p>
</td>
<td class="cellrowborder" valign="middle" width="25%" headers="mcps1.4.3.5.2.5.1.2 "><p>DeviceC selects Link B to send data to 10.0.0.0/8.</p>
</td>
<td class="cellrowborder" valign="middle" width="25%" headers="mcps1.4.3.5.2.5.1.3 "><p>DeviceC selects Link A to send data to 10.0.0.0/8.</p>
</td>
<td class="cellrowborder" valign="middle" width="25%" headers="mcps1.4.3.5.2.5.1.4 "><p>DeviceC selects Link B to send data to 10.0.0.0/8.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>As described in <a href="#EN-US_CONCEPT_0000001130783912__table_active-route01">Table 1</a>, after active-route-advertise is configured on the RR after the upgrade, data sent by DeviceC to 10.0.0.0/8 is still forwarded through Link B.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Before you configure active-route-advertise, check whether BGP routes are optimal in the IP routing table. If all BGP routes are optimal in the IP routing table, data forwarding paths do not change after active-route-advertise is configured. If only some BGP routes are optimal in the IP routing table, analyze the impacts of active-route-advertise upon traffic forwarding and determine whether to configure this feature.</p>
</div></div>
</div>
<div class="section"><h4 class="sectiontitle">Benefits</h4><p>Active-route-advertise prevents changes to data forwarding paths that may occur after a device is upgraded to support independent BGP route selection.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_bgp_cfg_0157.html">Configuring Active-Route-Advertise
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_bgp_cfg_0158.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>