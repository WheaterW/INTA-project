
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring OSPFv3 Between an MCE and a PE">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_L3VPNv6_cfg_0010.html">
<meta name="DC.Relation" scheme="URI" content="vrp_L3VPNv6_cfg_0013.html">
<meta name="DC.Relation" scheme="URI" content="vrp_L3VPNv6_cfg_0015.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="IPv6 L3VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv6 L3VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="IPv6 L3VPN">
<meta name="featuretype" content="VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130781466">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring OSPFv3 Between an MCE and a PE</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130781466"></a><a name="EN-US_TASK_0000001130781466"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring OSPFv3 Between an MCE and a PE</h1>
<div class="taskbody"><p></p>
<div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001130781466__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p id="EN-US_TASK_0000001130781466__en-us_task_0000001130621696_p382378817214050">Before configuring MCE, complete the following tasks:</p>
<ul id="EN-US_TASK_0000001130781466__en-us_task_0000001130621696_ul1763042272214050"><li id="EN-US_TASK_0000001130781466__en-us_task_0000001130621696_li1850663768214050"><p id="EN-US_TASK_0000001130781466__en-us_task_0000001130621696_p2100289275214050"><a name="EN-US_TASK_0000001130781466__en-us_task_0000001130621696_li1850663768214050"></a><a name="en-us_task_0000001130621696_li1850663768214050"></a>Configure a VPN instance for each service on the MCE and its connected PE. For details, see <a href="vrp_L3VPNv6_cfg_0006.html">Configuring an IPv6 VPN Instance on a PE</a>.</p>
</li><li id="EN-US_TASK_0000001130781466__en-us_task_0000001130621696_li1519591190214050"><p id="EN-US_TASK_0000001130781466__en-us_task_0000001130621696_p1893600206214050"><a name="EN-US_TASK_0000001130781466__en-us_task_0000001130621696_li1519591190214050"></a><a name="en-us_task_0000001130621696_li1519591190214050"></a>Configure link and network layer protocols for LAN interfaces, and connect the LAN interface for each type of service to the MCE.</p>
</li><li id="EN-US_TASK_0000001130781466__en-us_task_0000001130621696_li1638983767214050"><p id="EN-US_TASK_0000001130781466__en-us_task_0000001130621696_p627431900214050"><a name="EN-US_TASK_0000001130781466__en-us_task_0000001130621696_li1638983767214050"></a><a name="en-us_task_0000001130621696_li1638983767214050"></a>Bind the MCE's interfaces and the PE's interface connected to the MCE to VPN instances and configure IP addresses for these interfaces. For details, see <a href="vrp_L3VPNv6_cfg_0007.html">Binding an Interface to the IPv6 VPN Instance</a>.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130781466__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Deleting a VPN instance or disabling the IPv6 address family of a VPN instance will also delete the related OSPFv3 processes.</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0000001130781466__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure the PE.</span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Create an OSPFv3 process, bind it to a VPN instance, and enter the OSPFv3 view.</span><p><pre class="screen"><a href="cmdqueryname=ospfv3"><b><span class="cmdname">ospfv3</span></b></a> [ <i><span class="varname">process-id</span></i> ] <strong><span>vpn-instance</span></strong> <i><span class="varname">vpnname</span></i></pre>
<p>An OSPFv3 process can be bound to only one VPN instance.</p>
<p>A router ID needs to be specified when an OSPF process is started after it is bound to a VPN instance. The router ID must be different from the public network router ID configured in the system view. If the router ID is not specified, OSPFv3 selects the IP address of one of the interfaces bound to the VPN instance as the router ID based on a certain rule.</p>
</p></li><li class="substepexpand"><span>Configure a router ID.</span><p><pre class="screen"><a href="cmdqueryname=router-id"><b><span class="cmdname">router-id</span></b></a> <i><span class="varname">router-id</span></i></pre>
<p>A router ID uniquely identifies an OSPFv3 process in an AS. If no router ID is configured, the OSPFv3 process cannot run.</p>
</p></li><li class="substepexpand"><span>(Optional) Configure a domain ID for the OSPFv3 process.</span><p><pre class="screen"><a href="cmdqueryname=domain-id"><b><span class="cmdname">domain-id</span></b></a> <i><span class="varname">domain-idvalue</span></i> [ <strong><span>secondary</span></strong> ]</pre>
<p>The domain ID can be either an integer or a dotted decimal number.</p>
<p>Generally, the routes that are imported from a PE are advertised as External-LSAs. The routes that belong to different nodes of the same OSPFv3 domain are advertised as Type-3 LSAs (intra-domain routes). This requires that different nodes in the same OSPFv3 domain have the same domain ID.</p>
</p></li><li class="substepexpand"><span>Import BGP routes.</span><p><pre class="screen"><a href="cmdqueryname=import-route"><b><span class="cmdname">import-route</span></b></a> <strong><span>bgp</span></strong> [ <strong><span>cost</span></strong> <i><span class="varname">cost</span></i> | <strong><span>tag</span></strong> <i><span class="varname">tag</span></i> | <strong><span>type</span></strong> <i><span class="varname">type</span></i> | <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> ]<sup>*</sup></pre>
</p></li><li class="substepexpand"><span>Return to the system view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the view of the interface bound to the VPN instance.</span><p><pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></pre>
</p></li><li class="substepexpand"><span>Switch the interface working mode from Layer 2 to Layer 3.</span><p><pre class="screen"><a href="cmdqueryname=undo+portswitch"><b><span class="cmdname">undo portswitch</span></b></a></pre>
<p> Determine whether to perform this step based on the current interface working mode.</p>
</p></li><li class="substepexpand"><span>Enable IPv6 on the interface.</span><p><pre class="screen"><a href="cmdqueryname=ipv6+enable"><b><span class="cmdname">ipv6 enable</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enable OSPFv3 on the interface.</span><p><pre class="screen"><a href="cmdqueryname=ospfv3"><b><span class="cmdname">ospfv3</span></b></a> <i><span class="varname">process-id</span></i> <strong><span>area</span></strong> <i><span class="varname">area-id</span></i> [ <strong><span>instance</span></strong> <i><span class="varname">instance-id</span></i> ]</pre>
</p></li><li class="substepexpand"><span>Return to the system view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the BGP view.</span><p><pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></pre>
</p></li><li class="substepexpand"><span>Enter the BGP VPN instance IPv6 address family view.</span><p><pre class="screen"><a href="cmdqueryname=ipv6-family"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i></pre>
</p></li><li class="substepexpand"><span>Import OSPFv3 routes into the routing table for the BGP VPN instance IPv6 address family.</span><p><pre class="screen"><a href="cmdqueryname=import-route"><b><span class="cmdname">import-route</span></b></a> <strong><span>ospfv3</span></strong> <i><span class="varname">process-id</span></i> [ <strong><span>med</span></strong> <i><span class="varname">med-value</span></i> | <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> ] <sup>*</sup></pre>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li></ol>
</li><li><span>Configure the MCE.</span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Create an OSPFv3 process, bind it to a VPN instance, and enter the OSPFv3 view.</span><p><pre class="screen"><a href="cmdqueryname=ospfv3"><b><span class="cmdname">ospfv3</span></b></a> [ <i><span class="varname">process-id</span></i> ] <strong><span>vpn-instance</span></strong> <i><span class="varname">vpnname</span></i></pre>
<p>An OSPFv3 process can be bound to only one VPN instance.</p>
<p>A router ID needs to be specified when an OSPF process is started after it is bound to a VPN instance. The router ID must be different from the public network router ID configured in the system view. If the router ID is not specified, OSPFv3 selects the IP address of one of the interfaces bound to the VPN instance as the router ID based on a certain rule.</p>
</p></li><li class="substepexpand"><span>Configure a router ID.</span><p><pre class="screen"><a href="cmdqueryname=router-id"><b><span class="cmdname">router-id</span></b></a> <i><span class="varname">router-id</span></i></pre>
<p>A router ID uniquely identifies an OSPFv3 process in an AS. If no router ID is configured, the OSPFv3 process cannot run.</p>
</p></li><li class="substepexpand"><span>(Optional) Configure a domain ID for the OSPFv3 process.</span><p><pre class="screen"><a href="cmdqueryname=domain-id"><b><span class="cmdname">domain-id</span></b></a> <i><span class="varname">domain-idvalue</span></i> [ <strong><span>secondary</span></strong> ]</pre>
<p>The domain ID can be either an integer or a dotted decimal number.</p>
<p>Generally, the routes that are imported from a PE are advertised as External-LSAs. The routes that belong to different nodes of the same OSPFv3 domain are advertised as Type 3 LSAs (intra-domain routes). This requires that different nodes in the same OSPFv3 domain have the same domain ID.</p>
</p></li><li class="substepexpand"><span>Disable routing loop detection.</span><p><pre class="screen"><a href="cmdqueryname=vpn-instance-capability+simple"><b><span class="cmdname">vpn-instance-capability simple</span></b></a></pre>
<p>If OSPFv3 multi-instance is deployed on the MCE, the MCE receives LSAs with the Down (DN) bit set to 1 from the PE. Because routing loop detection has been enabled for VPN instances on the MCE, the MCE cannot use these LSAs to calculate routes. In this case, run the <a href="cmdqueryname=vpn-instance-capability+simple"><b><span class="cmdname">vpn-instance-capability simple</span></b></a> command to disable OSPFv3 routing loop detection. The MCE can then use LSAs to calculate OSPFv3 routes without checking the DN bits and route tags carried in these LSAs.</p>
</p></li><li class="substepexpand"><span>Enter the view of the interface bound to a VPN instance.</span><p><pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></pre>
</p></li><li class="substepexpand"><span>Switch the interface working mode from Layer 2 to Layer 3.</span><p><pre class="screen"><a href="cmdqueryname=undo+portswitch"><b><span class="cmdname">undo portswitch</span></b></a></pre>
<p> Determine whether to perform this step based on the current interface working mode.</p>
</p></li><li class="substepexpand"><span>Enable IPv6 on the interface.</span><p><pre class="screen"><a href="cmdqueryname=ipv6+enable"><b><span class="cmdname">ipv6 enable</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enable OSPFv3 on the interface.</span><p><pre class="screen"><a href="cmdqueryname=ospfv3"><b><span class="cmdname">ospfv3</span></b></a> <i><span class="varname">process-id</span></i> <strong><span>area</span></strong> <i><span class="varname">area-id</span></i> [ <strong><span>instance</span></strong> <i><span class="varname">instance-id</span></i> ]</pre>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li></ol>
</li></ul></div>
<div class="postreq"><a name="EN-US_TASK_0000001130781466__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+ipv6+routing-table+vpn-instance"><b><span class="cmdname">display ipv6 routing-table vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i> [ <strong><span>verbose</span></strong> ] command on the MCE to check the IPv6 routing table of the VPN instance.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_L3VPNv6_cfg_0010.html">Configuring IPv6 MCE
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_L3VPNv6_cfg_0013.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_L3VPNv6_cfg_0015.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>