
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring DHCPv6 Relay">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_dhcpv6_cfg_0026.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_dhcpv6_cfg_0028.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="DHCPv6">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="DHCPv6">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="DHCPv6">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001512691242">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring DHCPv6 Relay</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001512691242"></a><a name="EN-US_TASK_0000001512691242"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring DHCPv6 Relay</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001512691242__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><div class="p">You can configure DHCPv6 relay using either of the following methods:<ul><li>Method 1: Configure an IPv6 address for a DHCPv6 server or next-hop relay agent on an interface. This method applies to the scenario where the peer end of a DHCPv6 relay agent is connected to a DHCPv6 server or next-hop relay agent.</li><li>Method 2: Bind a DHCPv6 server group to an interface. Specifically, create a DHCPv6 server group in the system view, add the IPv6 addresses of multiple DHCPv6 servers or next-hop relay agents in the DHCPv6 server group, and bind the DHCPv6 server group to the interface. This method is applicable to the scenario where the peer end of the DHCPv6 relay agent is connected to multiple DHCPv6 servers or next-hop relay agents. In this way, the DHCPv6 relay agent can flexibly select and manage DHCPv6 servers or next-hop relay agents.</li></ul>
</div>
<p>Multiple DHCPv6 relay agents can be deployed between a DHCPv6 client and server. If a device functions as a DHCPv6 relay agent and is connected to a DHCPv6 server, you must specify the IPv6 address of the DHCPv6 server when enabling DHCPv6 relay. If the device is connected to a next-hop relay agent (for example, relay agent A), you must specify the IPv6 address of relay agent A on the device and specify the IPv6 address of the peer DHCPv6 server or next-hop relay agent connected to relay agent A on relay agent A.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>When configuring DHCPv6 relay on a Multichassis Link Aggregation Group (M-LAG), you must configure DHCPv6 relay on the two devices that constitute the M-LAG.</p>
<p>When a VRRP6 device functions as a DHCPv6 relay agent, the DHCPv6 relay interface in the VRRP6 backup state does not forward DHCPv6 request messages.</p>
</div></div>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0000001512691242__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span><strong>Method 1: Configure an IPv6 address for a DHCPv6 server or next-hop relay agent on an interface.</strong></span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enable DHCP.</span><p><pre class="screen"><a href="cmdqueryname=dhcp+enable"><b><span class="cmdname">dhcp enable</span></b></a> </pre>
</p></li><li class="substepexpand"><span>Enter the interface view.</span><p><pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type interface-number</span></i></pre>
</p></li><li class="substepexpand"><span>Switch the interface working mode to Layer 3.</span><p><pre class="screen" id="EN-US_TASK_0000001512691242__en-us_task_0228023023_screen132321812144720"><a href="cmdqueryname=undo+portswitch"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__en-us_task_0228023023_cmdname42322122476">undo portswitch</span></b></a></pre>
<p id="EN-US_TASK_0000001512691242__en-us_task_0228023023_p64817191519">Determine whether to perform this step based on the current interface working mode.</p>
</p></li><li class="substepexpand"><span>Enable IPv6 on the interface.</span><p><pre class="screen"><a href="cmdqueryname=ipv6+enable"><b><span class="cmdname">ipv6 enable</span></b></a></pre>
</p></li><li class="substepexpand"><span>Configure a global unicast IPv6 address for the interface.</span><p><pre class="screen"><a href="cmdqueryname=ipv6+address"><b><span class="cmdname">ipv6 address</span></b></a> { <i><span class="varname">ipv6-address prefix-length</span></i> |<i><span class="varname">ipv6-address</span></i>/<i><span class="varname">prefix-length</span></i> }</pre>
</p></li><li class="substepexpand"><span>Perform either of the following operations to enable DHCPv6 relay on the interface as required.</span><p>
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Enabling DHCPv6 relay on the interface</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.1.2.7.2.1.2.4.1.1" liSelected="liSelected"><p>Operation</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.1.2.7.2.1.2.4.1.2" liSelected="liSelected"><p>Command</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.1.2.7.2.1.2.4.1.3" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.1.2.7.2.1.2.4.1.1 "><p>In an intra-VPN scenario, configure the IPv6 address or outbound interface of a DHCPv6 server or next-hop relay agent.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.1.2.7.2.1.2.4.1.2 "><p><a href="cmdqueryname=dhcpv6+relay"><b><span class="cmdname">dhcpv6 relay</span></b></a> <span>{ <strong><span>destination</span></strong> <i><span class="varname">ipv6-address</span></i> | <strong><span>interface</span></strong> <i><span class="varname">interface-type interface-number</span></i> }</span></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.1.2.7.2.1.2.4.1.3 "><p>By default, DHCPv6 relay is disabled on an interface.</p>
<p>The configured IPv6 address is a global unicast address or unique local address. The device searches for routes and sends relay messages to the configured IPv6 address.</p>
<p>If a DHCPv6 relay agent is connected to multiple DHCPv6 servers or next-hop relay agents, repeat this step.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.1.2.7.2.1.2.4.1.1 "><p>In an inter-VPN scenario, configure the IPv6 address and VPN information of a DHCPv6 server or next-hop relay agent.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.1.2.7.2.1.2.4.1.2 "><p><a href="cmdqueryname=dhcpv6+relay"><b><span class="cmdname">dhcpv6 relay</span></b></a> <span><strong><span>destination</span></strong> <i><span class="varname">ipv6-address</span></i> { <strong><span>vpn-instance</span></strong> </span><i><span class="varname">vpn-instance-name</span></i> | <strong><span>public-net</span></strong> }</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.1.2.7.2.1.2.4.1.3 "><p>By default, the IPv6 address and VPN information of a DHCPv6 server or next-hop relay agent are not configured.</p>
<p>The configured IPv6 address is a global unicast address or unique local address. The device searches for routes and sends relay messages to the configured IPv6 address.</p>
<p>If a DHCPv6 relay agent is connected to multiple DHCPv6 servers or next-hop relay agents, repeat this step.</p>
<p>If the DHCPv6 server or next-hop relay agent belongs to the public network, specify the <strong>public-net</strong> parameter.</p>
<p>If the DHCPv6 server or the next-hop relay agent belongs to a VPN, set the <span><strong><span>vpn-instance</span></strong></span> <i><span class="varname">vpn-instance-name</span></i> parameter to the name of the VPN instance to which the DHCPv6 server or the next-hop relay agent belongs.</p>
</td>
</tr>
</tbody>
</table>
</div>
</p></li><li class="substepexpand"><span>(Optional) Configure a client's gateway address or a source IPv6 address used for forwarding DHCPv6 messages on the DHCPv6 relay agent.</span><p><p id="EN-US_TASK_0000001512691242__p063763618519">To meet requirements in some scenarios, you can configure a client's gateway address on the DHCPv6 relay agent and a source IPv6 address for DHCPv6 messages that the DHCPv6 relay agent forwards. For example, this configuration is suitable if the source IPv6 address of DHCPv6 messages must remain unchanged and the DHCPv6 server must know the message forwarding path of a client for address allocation and parameter configuration. The device supports the following two configuration methods.</p>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" id="EN-US_TASK_0000001512691242__table109694569232" frame="border" border="1" rules="all"><caption><b>Table 2 </b>Configuring a client's gateway address on the DHCPv6 relay agent and a source IPv6 address for DHCPv6 messages that the DHCPv6 relay agent forwards</caption><thead align="left"><tr id="EN-US_TASK_0000001512691242__row597025662319"><th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.1.2.8.2.2.2.4.1.1" liSelected="liSelected"><p id="EN-US_TASK_0000001512691242__p119703565233">Operation</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.1.2.8.2.2.2.4.1.2" liSelected="liSelected"><p id="EN-US_TASK_0000001512691242__p1997095619233">Command</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.1.2.8.2.2.2.4.1.3" liSelected="liSelected"><p id="EN-US_TASK_0000001512691242__p20970195612234">Description</p>
</th>
</tr>
</thead>
<tbody><tr id="EN-US_TASK_0000001512691242__row11971115610231"><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.1.2.8.2.2.2.4.1.1 "><p id="EN-US_TASK_0000001512691242__p205080164315"><strong id="EN-US_TASK_0000001512691242__b1025523721518">Method 1:</strong> Use the IPv6 address of a specified interface.</p>
<ul id="EN-US_TASK_0000001512691242__ul182491917536"><li id="EN-US_TASK_0000001512691242__li192497120534">If a global unicast address is configured on a DHCPv6 relay interface, running the <a href="cmdqueryname=dhcpv6+relay+source-interface"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__cmdname1043518411538">dhcpv6 relay source-interface</span></b></a> command does not change a client's gateway address configured on the DHCPv6 relay agent, but changes only the source IPv6 address of DHCPv6 messages that the DHCPv6 relay agent forwards.</li><li id="EN-US_TASK_0000001512691242__li1454042165410">If multiple IPv6 addresses are configured on a specified interface, the first configured IPv6 address is used as the source IPv6 address of DHCPv6 messages that the DHCPv6 relay agent forwards. If the DHCPv6 relay agent restarts, the smallest IPv6 address is used as the source IPv6 address of DHCPv6 messages that the DHCPv6 relay agent forwards. In this case, if service requirements cannot be met, you can use method 2.</li></ul>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.1.2.8.2.2.2.4.1.2 "><p id="EN-US_TASK_0000001512691242__p209711256142312"><a href="cmdqueryname=dhcpv6+relay+source-interface"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__cmdname0971165612232">dhcpv6 relay source-interface</span></b></a> <span><i><span class="varname" id="EN-US_TASK_0000001512691242__varname16971175662319">interface-type interface-number</span></i></span></p>
</td>
<td class="cellrowborder" rowspan="2" valign="top" width="33.33333333333333%" headers="mcps1.3.2.1.2.8.2.2.2.4.1.3 "><p id="EN-US_TASK_0000001512691242__p1076145202414">By default, a DHCPv6 relay agent selects the first configured global unicast IPv6 address from an interface with DHCPv6 relay enabled as its gateway address, and uses the gateway IPv6 address as the source address of DHCPv6 messages.</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001512691242__row1375445142416"><td class="cellrowborder" valign="top" headers="mcps1.3.2.1.2.8.2.2.2.4.1.1 "><p id="EN-US_TASK_0000001512691242__p476184515245"><strong id="EN-US_TASK_0000001512691242__b1643443319402">Method 2:</strong> Configure a gateway address for the DHCPv6 relay agent and a source IPv6 address for DHCPv6 messages that the DHCPv6 relay agent forwards.</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.2.1.2.8.2.2.2.4.1.2 "><ul id="EN-US_TASK_0000001512691242__ul71148477262"><li id="EN-US_TASK_0000001512691242__li8328194515373">Configure a gateway address for the DHCPv6 relay agent.<p id="EN-US_TASK_0000001512691242__p123301946133718"><a name="EN-US_TASK_0000001512691242__li8328194515373"></a><a name="li8328194515373"></a><a href="cmdqueryname=dhcpv6+relay+link-address"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__cmdname114913411262">dhcpv6 relay link-address</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001512691242__varname19491741162620">ipv6-address</span></i></p>
</li><li id="EN-US_TASK_0000001512691242__li291549183720">Configure a source IPv6 address for DHCPv6 messages that the DHCPv6 relay agent forwards.<p id="EN-US_TASK_0000001512691242__p643775920528"><a name="EN-US_TASK_0000001512691242__li291549183720"></a><a name="li291549183720"></a><a href="cmdqueryname=dhcpv6+relay"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__cmdname234131072720">dhcpv6 relay</span></b></a><span> <strong><span id="EN-US_TASK_0000001512691242__cmdparmname73441017276">source-ip-address</span></strong> <i><span class="varname" id="EN-US_TASK_0000001512691242__varname03511082712">ipv6-address</span></i></span></p>
</li></ul>
</td>
</tr>
</tbody>
</table>
</div>
</p><p><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li id="EN-US_TASK_0000001512691242__li3555163103717">The <a href="cmdqueryname=dhcpv6+relay+link-address"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__cmdname184991147374">dhcpv6 relay link-address</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001512691242__varname949916463718">ipv6-address</span></i> and <a href="cmdqueryname=dhcpv6+relay+source-interface"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__cmdname1649912463719">dhcpv6 relay source-interface</span></b></a> <span id="EN-US_TASK_0000001512691242__ph549924173711"><i><span class="varname" id="EN-US_TASK_0000001512691242__varname134994473720">interface-type interface-number</span></i></span> commands are mutually exclusive on an interface.</li><li id="EN-US_TASK_0000001512691242__li208525145017">The <a href="cmdqueryname=dhcpv6+relay"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__cmdname148521815501">dhcpv6 relay</span></b></a><span id="EN-US_TASK_0000001512691242__ph1385219145017"> <strong><span id="EN-US_TASK_0000001512691242__cmdparmname16852111502">source-ip-address</span></strong> <i><span class="varname" id="EN-US_TASK_0000001512691242__varname1852171165016">ipv6-address</span></i></span> and <a href="cmdqueryname=dhcpv6+relay+source-interface"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__cmdname16852181175019">dhcpv6 relay source-interface</span></b></a> <span id="EN-US_TASK_0000001512691242__ph1585216110502"><i><span class="varname" id="EN-US_TASK_0000001512691242__varname385213145012">interface-type interface-number</span></i></span> commands are mutually exclusive on an interface.</li><li>In inter-VPN scenarios, the <a href="cmdqueryname=dhcpv6+relay"><b><span class="cmdname">dhcpv6 relay</span></b></a><span> <strong><span>source-ip-address</span></strong> <i><span class="varname">ipv6-address</span></i></span> or <a href="cmdqueryname=dhcpv6+relay+source-interface"><b><span class="cmdname">dhcpv6 relay source-interface</span></b></a> <span><i><span class="varname">interface-type interface-number</span></i></span> command must be run, because the destination address of reply messages sent from the DHCPv6 server to the DHCPv6 relay agent is the source address of request messages received by the DHCPv6 server. To ensure that there is a reachable route to the destination address of reply messages in the VPN, you must configure the IPv6 address of the outbound interface on the DHCPv6 relay agent as a source IPv6 address for DHCPv6 request messages that the DHCPv6 relay agent forwards.</li></ul>
</div></div>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001512691242__substep6223121111153"><span id="EN-US_TASK_0000001512691242__cmd1322315111151">(Optional) Enable the DHCPv6 relay agent to forward routing information of DHCPv6 PD clients.</span><p><pre class="screen" id="EN-US_TASK_0000001512691242__screen19224111114159"><a href="cmdqueryname=dhcpv6+relay+advertise+prefix-delegation+route"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__cmdname1218075313169">dhcpv6 relay advertise prefix-delegation route</span></b></a></pre>
<p id="EN-US_TASK_0000001512691242__p47785151716">By default, a DHCPv6 relay agent is disabled from forwarding routing information of DHCPv6 PD clients.</p>
<p id="EN-US_TASK_0000001512691242__p1977815119175">This command takes effect only for the first-hop DHCPv6 relay agent connected to DHCPv6 PD clients.</p>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001512691242__substep1813842919179"><span id="EN-US_TASK_0000001512691242__cmd11381729121717">Return to the system view.</span><p><pre class="screen" id="EN-US_TASK_0000001512691242__screen171383297179"><a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__cmdname16138112921712">quit</span></b></a></pre>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001512691242__substep1136193191818"><span id="EN-US_TASK_0000001512691242__cmd113620320183">(Optional) Save routing information forwarded by the DHCPv6 relay agent to a specified file.</span><p><pre class="screen" id="EN-US_TASK_0000001512691242__screen1613693101817"><a href="cmdqueryname=dhcpv6+relay+prefix-delegation+route"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__cmdname34651714181819">dhcpv6 relay prefix-delegation route</span></b></a> <strong><span id="EN-US_TASK_0000001512691242__cmdparmname14651414141815">autosave</span></strong> <i><span class="varname" id="EN-US_TASK_0000001512691242__varname946521419183">file-name</span></i></pre>
<p id="EN-US_TASK_0000001512691242__p41361335182">By default, routing information forwarded by a DHCPv6 relay agent is not saved.</p>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001512691242__en-us_task_0228023023_screen14848162118611"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__en-us_task_0228023023_cmdname1784862115612">commit</span></b></a></pre>
</p></li></ol>
</li><li><span><strong>Method 2: Bind a DHCPv6 server group to an interface.</strong></span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enable DHCP.</span><p><pre class="screen"><a href="cmdqueryname=dhcp+enable"><b><span class="cmdname">dhcp enable</span></b></a></pre>
</p></li><li class="substepexpand"><span>Create a DHCPv6 server group.</span><p><pre class="screen"><a href="cmdqueryname=dhcpv6+server+group"><b><span class="cmdname">dhcpv6 server group</span></b></a> <i><span class="varname">group-name</span></i></pre>
</p><p><p>By default, no DHCPv6 server group is created.</p>
</p></li><li class="substepexpand"><span>Add the IPv6 address or outbound interface of the DHCPv6 server or next-hop relay agent in the DHCPv6 server group.</span><p><pre class="screen"><a href="cmdqueryname=dhcpv6-server"><b><span class="cmdname">dhcpv6-server</span></b></a> <i><span class="varname">ipv6-address</span></i><span> [ <strong><span>interface</span></strong> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> ]</span></pre>
</p><p><p>By default, no DHCPv6 server or next-hop relay agent is configured in a DHCPv6 server group.</p>
<p>If a DHCPv6 relay agent is connected to multiple DHCPv6 servers or next-hop relay agents, repeat this step. The device supports a maximum of 20 DHCPv6 servers or next-hop relay agents in this scenario.</p>
</p></li><li class="substepexpand"><span>(Optional) Bind a VPN instance to the DHCPv6 server group.</span><p><pre class="screen"><strong>vpn-instance</strong> <em>vpn-instance-name</em></pre>
<p>By default, no VPN instance is bound to a DHCPv6 server group.</p>
</p></li><li class="substepexpand"><span>Return to the system view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the interface view.</span><p><pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type interface-number</span></i></pre>
</p></li><li class="substepexpand"><span>Switch the interface working mode to Layer 3.</span><p><pre class="screen" id="EN-US_TASK_0000001512691242__en-us_task_0228023023_screen132321812144720_1"><a href="cmdqueryname=undo+portswitch"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__en-us_task_0228023023_cmdname42322122476_1">undo portswitch</span></b></a></pre>
<p id="EN-US_TASK_0000001512691242__en-us_task_0228023023_p64817191519_1">Determine whether to perform this step based on the current interface working mode.</p>
</p></li><li class="substepexpand"><span>Enable IPv6 on the interface.</span><p><pre class="screen"><a href="cmdqueryname=ipv6+enable"><b><span class="cmdname">ipv6 enable</span></b></a></pre>
</p></li><li class="substepexpand"><span>Configure a global unicast IPv6 address for the interface.</span><p><pre class="screen"><a href="cmdqueryname=ipv6+address"><b><span class="cmdname">ipv6 address</span></b></a> { <i><span class="varname">ipv6-address prefix-length</span></i> |<i><span class="varname">ipv6-address</span></i>/<i><span class="varname">prefix-length</span></i> }</pre>
</p></li><li class="substepexpand"><span>Configure a DHCPv6 server group for the DHCPv6 relay agent.</span><p><pre class="screen"><a href="cmdqueryname=dhcpv6+relay+server-select"><b><span class="cmdname">dhcpv6 relay server-select</span></b></a> <i><span class="varname">group-name</span></i></pre>
<p>By default, no DHCPv6 server group is configured for a DHCPv6 relay agent.</p>
</p></li><li class="substepexpand"><span>(Optional) Configure a client's gateway address or a source IPv6 address used for forwarding DHCPv6 messages on the DHCPv6 relay agent.</span><p><p>To meet requirements in some scenarios, you can configure a client's gateway address on the DHCPv6 relay agent and a source IPv6 address for DHCPv6 messages that the DHCPv6 relay agent forwards. For example, this configuration is suitable if the source IPv6 address of DHCPv6 messages must remain unchanged and the DHCPv6 server must know the message forwarding path of a client for address allocation and parameter configuration. The device supports the following two configuration methods.</p>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 3 </b>Configuring a client's gateway address on the DHCPv6 relay agent and a source IPv6 address for DHCPv6 messages that the DHCPv6 relay agent forwards</caption><thead align="left"><tr id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_row597025662319"><th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.2.2.12.2.2.2.4.1.1" liSelected="liSelected"><p id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_p119703565233">Operation</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.2.2.12.2.2.2.4.1.2" liSelected="liSelected"><p id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_p1997095619233">Command</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.2.2.12.2.2.2.4.1.3" liSelected="liSelected"><p id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_p20970195612234">Description</p>
</th>
</tr>
</thead>
<tbody><tr id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_row11971115610231"><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.2.2.12.2.2.2.4.1.1 "><p id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_p205080164315"><strong id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_b1025523721518">Method 1:</strong> Use the IPv6 address of a specified interface.</p>
<ul id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_ul182491917536"><li id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_li192497120534">If a global unicast address is configured on a DHCPv6 relay interface, running the <a href="cmdqueryname=dhcpv6+relay+source-interface"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_cmdname1043518411538">dhcpv6 relay source-interface</span></b></a> command does not change a client's gateway address configured on the DHCPv6 relay agent, but changes only the source IPv6 address of DHCPv6 messages that the DHCPv6 relay agent forwards.</li><li id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_li1454042165410">If multiple IPv6 addresses are configured on a specified interface, the first configured IPv6 address is used as the source IPv6 address of DHCPv6 messages that the DHCPv6 relay agent forwards. If the DHCPv6 relay agent restarts, the smallest IPv6 address is used as the source IPv6 address of DHCPv6 messages that the DHCPv6 relay agent forwards. In this case, if service requirements cannot be met, you can use method 2.</li></ul>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.2.2.12.2.2.2.4.1.2 "><p id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_p209711256142312"><a href="cmdqueryname=dhcpv6+relay+source-interface"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_cmdname0971165612232">dhcpv6 relay source-interface</span></b></a> <span><i><span class="varname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_varname16971175662319">interface-type interface-number</span></i></span></p>
</td>
<td class="cellrowborder" rowspan="2" valign="top" width="33.33333333333333%" headers="mcps1.3.2.2.2.12.2.2.2.4.1.3 "><p id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_p1076145202414">By default, a DHCPv6 relay agent selects the first configured global unicast IPv6 address from an interface with DHCPv6 relay enabled as its gateway address, and uses the gateway IPv6 address as the source address of DHCPv6 messages.</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_row1375445142416"><td class="cellrowborder" valign="top" headers="mcps1.3.2.2.2.12.2.2.2.4.1.1 "><p id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_p476184515245"><strong id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_b1643443319402">Method 2:</strong> Configure a gateway address for the DHCPv6 relay agent and a source IPv6 address for DHCPv6 messages that the DHCPv6 relay agent forwards.</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.2.2.2.12.2.2.2.4.1.2 "><ul id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_ul71148477262"><li id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_li8328194515373">Configure a gateway address for the DHCPv6 relay agent.<p id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_p123301946133718"><a name="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_li8328194515373"></a><a name="en-us_task_0000001512691242_li8328194515373"></a><a href="cmdqueryname=dhcpv6+relay+link-address"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_cmdname114913411262">dhcpv6 relay link-address</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_varname19491741162620">ipv6-address</span></i></p>
</li><li id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_li291549183720">Configure a source IPv6 address for DHCPv6 messages that the DHCPv6 relay agent forwards.<p id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_p643775920528"><a name="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_li291549183720"></a><a name="en-us_task_0000001512691242_li291549183720"></a><a href="cmdqueryname=dhcpv6+relay"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_cmdname234131072720">dhcpv6 relay</span></b></a><span> <strong><span id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_cmdparmname73441017276">source-ip-address</span></strong> <i><span class="varname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_varname03511082712">ipv6-address</span></i></span></p>
</li></ul>
</td>
</tr>
</tbody>
</table>
</div>
</p><p><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>The <a href="cmdqueryname=dhcpv6+relay+link-address"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_cmdname184991147374">dhcpv6 relay link-address</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_varname949916463718">ipv6-address</span></i> and <a href="cmdqueryname=dhcpv6+relay+source-interface"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_cmdname1649912463719">dhcpv6 relay source-interface</span></b></a> <span><i><span class="varname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_varname134994473720">interface-type interface-number</span></i></span> commands are mutually exclusive on an interface.</li><li>The <a href="cmdqueryname=dhcpv6+relay"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_cmdname148521815501">dhcpv6 relay</span></b></a><span> <strong><span id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_cmdparmname16852111502">source-ip-address</span></strong> <i><span class="varname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_varname1852171165016">ipv6-address</span></i></span> and <a href="cmdqueryname=dhcpv6+relay+source-interface"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_cmdname16852181175019">dhcpv6 relay source-interface</span></b></a> <span><i><span class="varname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_varname385213145012">interface-type interface-number</span></i></span> commands are mutually exclusive on an interface.</li></ul>
</div></div>
</p></li><li class="substepexpand"><span>(Optional) Enable the DHCPv6 relay agent to forward routing information of DHCPv6 PD clients.</span><p><pre class="screen" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_screen19224111114159"><a href="cmdqueryname=dhcpv6+relay+advertise+prefix-delegation+route"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_cmdname1218075313169">dhcpv6 relay advertise prefix-delegation route</span></b></a></pre>
<p id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_p47785151716">By default, a DHCPv6 relay agent is disabled from forwarding routing information of DHCPv6 PD clients.</p>
<p id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_p1977815119175">This command takes effect only for the first-hop DHCPv6 relay agent connected to DHCPv6 PD clients.</p>
</p></li><li class="substepexpand"><span>Return to the system view.</span><p><pre class="screen" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_screen171383297179"><a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_cmdname16138112921712">quit</span></b></a></pre>
</p></li><li class="substepexpand"><span>(Optional) Save routing information forwarded by the DHCPv6 relay agent to a specified file.</span><p><pre class="screen" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_screen1613693101817"><a href="cmdqueryname=dhcpv6+relay+prefix-delegation+route"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_cmdname34651714181819">dhcpv6 relay prefix-delegation route</span></b></a> <strong><span id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_cmdparmname14651414141815">autosave</span></strong> <i><span class="varname" id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_varname946521419183">file-name</span></i></pre>
<p id="EN-US_TASK_0000001512691242__en-us_task_0000001512691242_p41361335182">By default, routing information forwarded by a DHCPv6 relay agent is not saved.</p>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001512691242__en-us_task_0228023023_screen14848162118611_1"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__en-us_task_0228023023_cmdname1784862115612_1">commit</span></b></a></pre>
</p></li></ol>
</li></ul></div>
<div class="postreq"><a name="EN-US_TASK_0000001512691242__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Follow-up Procedure</h4>
<div class="p"><p>If the DHCPv6 relay agent functions as the gateway of clients (such as PCs) that automatically obtain IPv6 addresses based on RA messages by default, configure flags in RA messages on the gateway so that the clients can obtain IPv6 addresses using DHCPv6.</p>
<ol><li>Enter the system view.<pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</li><li>Enter the interface view.<pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></pre>
</li><li>Switch the interface working mode to Layer 3.<pre class="screen" id="EN-US_TASK_0000001512691242__en-us_task_0228023023_screen0133194716551"><a href="cmdqueryname=undo+portswitch"><b><span class="cmdname" id="EN-US_TASK_0000001512691242__en-us_task_0228023023_cmdname6133447135516">undo portswitch</span></b></a></pre>
<p id="EN-US_TASK_0000001512691242__en-us_task_0228023023_p3489727121512">Determine whether to perform this step based on the current interface working mode.</p>
</li><li><div class="p">Enable the device to send RA messages.<pre class="screen"><a href="cmdqueryname=ipv6+nd+ra+halt+disable"><b><span class="cmdname">ipv6 nd ra halt disable</span></b></a></pre>
</div>
<p>By default, a device is disabled from sending RA messages.</p>
</li><li><div class="p">Configure the managed address configuration flag of stateful address autoconfiguration in an RA message.<pre class="screen"><a href="cmdqueryname=ipv6+nd+autoconfig+managed-address-flag"><b><span class="cmdname">ipv6 nd autoconfig managed-address-flag</span></b></a></pre>
</div>
<p>By default, the managed address configuration flag of stateful address autoconfiguration in an RA message is not configured.</p>
</li><li><div class="p">Configure the other configuration flag of stateful address autoconfiguration in an RA message.<pre class="screen"><a href="cmdqueryname=ipv6+nd+autoconfig+other-flag"><b><span class="cmdname">ipv6 nd autoconfig other-flag</span></b></a></pre>
</div>
<p>By default, the other configuration flag of stateful address autoconfiguration in an RA message is not configured.</p>
<p>After the managed address configuration and other configuration flags of stateful address autoconfiguration in an RA message are configured, the clients can obtain IPv6 addresses using DHCPv6.</p>
</li><li>Commit the configuration.<pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</li></ol>
</div></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_dhcpv6_cfg_0026.html">Configuring a Device as a DHCPv6 Relay Agent
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_dhcpv6_cfg_0028.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>