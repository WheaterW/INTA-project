
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="IPv4 Layer 2 Multicast Traffic Fails to Be Forwarded">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_l2mc_cfg_0055.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_l2mc_cfg_0057.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="IGMP Snooping">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IGMP Snooping">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IGMP Snooping">
<meta name="featuretype" content="IP Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130622124">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>IPv4 Layer 2 Multicast Traffic Fails to Be Forwarded</title>
</head>
<body><a name="EN-US_TASK_0000001130622124"></a><a name="EN-US_TASK_0000001130622124"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">IPv4 Layer 2 Multicast Traffic Fails to Be Forwarded</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001130622124__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Fault Symptom</h4><p>Users fail to receive multicast data after IGMP snooping is configured.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130622124__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Check whether the device is running the correct IGMP snooping version.</span><p><p>If the IGMP snooping version configured on the device is earlier than that running on user hosts, the device forwards IGMP Report messages to router ports but does not generate group member ports or forwarding entries.</p>
<p>Run the <a href="cmdqueryname=display+igmpsnooping+configuration"><b><span class="cmdname">display igmp<span> </span>snooping configuration</span></b></a> command to check the IGMP snooping configuration. If the IGMP snooping version configured on the device is earlier than that running on user hosts, configure the device to use the same version used on user hosts by running the <a href="cmdqueryname=igmpsnooping+version"><b><span class="cmdname">igmp<span> </span>snooping version</span></b></a> <i><span class="varname">version</span></i> command.</p>
</p></li><li><span>Check whether the configured General Query intervals are inconsistent.</span><p><p>If the General Query interval of the local IGMP snooping device is smaller than that used on the upstream IGMP querier or IGMP snooping device, the local device may often mistakenly age out some IGMP snooping entries that are still in use. As a result, multicast data matching these entries cannot be forwarded.</p>
<p>Run the <a href="cmdqueryname=display+igmpsnooping"><b><span class="cmdname">display igmp<span> </span>snooping</span></b></a> command to check the IGMP snooping running parameters. If the General Query interval on the local device is smaller than that used on the upstream IGMP querier or IGMP snooping device, run the <a href="cmdqueryname=igmpsnooping+query+interval"><b><span class="cmdname">igmp<span> </span>snooping query interval</span></b></a> <i><span class="varname">query-interval</span></i> command to adjust the General Query interval. It is recommended that the upstream and downstream devices use the same General Query interval.</p>
</p></li><li><span>Check whether dynamic learning of router ports is disabled.</span><p><p>If dynamic learning of router ports is disabled in a VLAN, the device does not listen to IGMP Query messages in the VLAN. In this case, the device cannot generate router ports.</p>
<p>Run the <a href="cmdqueryname=display+igmpsnooping+configuration"><b><span class="cmdname">display igmp<span> </span>snooping configuration</span></b></a> command to check the configuration. If the command output contains "<span><strong>igmp snooping router-learning disable</strong></span>", run the <a href="cmdqueryname=undo+igmp+snooping+router-learning+disable"><b><span class="cmdname">undo igmp snooping router-learning disable</span></b></a> command in the VLAN to enable dynamic learning of router ports.</p>
</p></li><li><span>Check whether prompt leave is configured for member ports.</span><p><p>Prompt leave can be configured only on an interface that is connected to only one host. If an interface is connected to multiple hosts and prompt leave is enabled for member ports in the VLAN, the device deletes the forwarding entry of a member port immediately after receiving an IGMP Leave message from the member port, without sending a Group-Specific Query message. In this case, traffic fails to be forwarded.</p>
<p>Run the <a href="cmdqueryname=display+igmpsnooping+configuration"><b><span class="cmdname">display igmp<span> </span>snooping configuration</span></b></a> command to check the configuration. If the command output contains "<strong>igmp</strong><span> </span><strong>snooping prompt-leave</strong>", run the <a href="cmdqueryname=undo+igmpsnooping+prompt-leave"><b><span class="cmdname">undo igmp<span> </span>snooping prompt-leave</span></b></a> command in the VLAN view to disable prompt leave for member ports.</p>
</p></li><li><span>Check whether Router-Alert option checking is configured.</span><p><p>If Router-Alert option checking is configured, the device checks the Option field of IGMP messages and discards those that do not contain the Router-Alert option.</p>
<p>Run the <a href="cmdqueryname=display+igmpsnooping+configuration"><b><span class="cmdname">display igmp<span> </span>snooping configuration</span></b></a> command to check the configuration. If the command output contains "<strong>igmp</strong><span> </span><strong>snooping require-router-alert</strong>", run the <a href="cmdqueryname=undo+igmpsnooping+require-router-alert"><b><span class="cmdname">undo igmp<span> </span>snooping require-router-alert</span></b></a> command in the VLAN view to cancel the configuration.</p>
</p></li><li><span>Check whether a multicast group filtering policy is configured.</span><p><p>If a multicast group filtering policy is configured, the multicast groups that hosts in a VLAN can join may be limited. Run the <a href="cmdqueryname=display+igmpsnooping+configuration"><b><span class="cmdname">display igmp<span> </span>snooping configuration</span></b></a> command to check the multicast group filtering policy configuration. If an ACL rule is configured, run the <a href="cmdqueryname=display+acl"><b><span class="cmdname">display acl</span></b></a> command to check whether the ACL rule configuration is correct.</p>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_l2mc_cfg_0055.html">Troubleshooting IGMP Snooping
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_l2mc_cfg_0057.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>