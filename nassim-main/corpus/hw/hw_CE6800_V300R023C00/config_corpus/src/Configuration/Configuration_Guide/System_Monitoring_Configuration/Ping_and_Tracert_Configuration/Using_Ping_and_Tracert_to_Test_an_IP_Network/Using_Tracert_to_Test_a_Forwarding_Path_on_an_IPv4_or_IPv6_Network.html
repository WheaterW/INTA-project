
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Using Tracert to Test a Forwarding Path on an IPv4 or IPv6 Network">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ping_tracert_cfg_0008.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ping_tracert_cfg_0011.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Ping and Tracert">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Ping and Tracert">
<meta name="featuretype" content="System Monitoring">
<meta name="featurename" content="Ping and Tracert">
<meta name="featuretype" content="System Monitoring">
<meta name="featurename" content="Ping and Tracert">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176664541">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Using Tracert to Test a Forwarding Path on an IPv4 or IPv6 Network</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176664541"></a><a name="EN-US_TASK_0000001176664541"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Using Tracert to Test a Forwarding Path on an IPv4 or IPv6 Network</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176664541__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>The tracert function is used to test the reachability of each hop on the path from the source to the destination.</p>
<p>You can perform a tracert operation on the source by sending three UDP packets at a time. The TTL value of the first batch of UDP packets is 1, and the TTL value of each further batch is incremented by 1.</p>
<p>If the source receives response packets within a specified period after sending packets, the address and RTT of the response node are displayed on the source. If no response packet is received, a response timeout prompt is displayed on the source. If a response timeout prompt is displayed after the source sends a UDP packet with the maximum TTL value, the destination cannot be reached and the test fails.</p>
<p>To prevent malicious users from forging ICMP Port Unreachable or Time Exceeded messages in order to detect the IPv4 or IPv6 address of a device, you can specify the source IPv4 or IPv6 address of ICMP Port Unreachable or Time Exceeded messages in the loopback interface view. After this configuration, if you run the <a href="cmdqueryname=tracert"><b><span class="cmdname">tracert</span></b></a>/<a href="cmdqueryname=tracert+ipv6"><b><span class="cmdname">tracert ipv6</span></b></a> command to test the reachability of each hop, each hop uses the loopback interface address as the source address in ICMP Port Unreachable or Time Exceeded messages.</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0000001176664541__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure tracert to test an IPv4 network.</span><ol><li class="substepexpand"><span>(Optional) Configure the IP address of the loopback interface as the source IP address of ICMP Port Unreachable or Time Exceeded messages.</span><p><ol type="a"><li><p>Enter the system view.</p>
<pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</li><li><p>Create a loopback interface and enter the loopback interface view.</p>
<pre class="screen"><a href="cmdqueryname=interface+loopback"><b><span class="cmdname">interface loopback</span></b></a> <i><span class="varname">loopback-number</span></i></pre>
</li><li><p>(Optional) Bind the loopback interface with a VPN instance.</p>
<pre class="screen"><a href="cmdqueryname=ip+binding+vpn-instance"><b><span class="cmdname">ip binding vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></pre>
<p>By default, an interface functions as a public network interface that is not bound to any VPN instance.</p>
</li><li><p>On each hop between the source and destination, configure the IP address of the loopback interface as the source IP address in the ICMP Time Exceeded messages. On the destination, configure the IP address of the loopback interface as the source IP address in the ICMP Port Unreachable messages.</p>
<pre class="screen"><a href="cmdqueryname=ip+icmp"><b><span class="cmdname">ip icmp</span></b></a> { <strong><span>ttl-exceeded</span></strong> | <strong><span>port-unreachable</span></strong> } <strong><span>source-address</span></strong></pre>
</li><li>Commit the configuration.<pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</li></ol>
</p></li><li class="substepexpand"><span>Test the fault position.</span><p><pre class="screen"><a href="cmdqueryname=tracert"><b><span class="cmdname">tracert</span></b></a> [ <strong><span>-a</span></strong> <i><span class="varname">source-ip-address</span></i> [ <strong><span>-response-public</span></strong> | <strong><span>-ignore-vpn</span></strong> | <strong><span>-response-vpn</span></strong> <i><span class="varname">respVrfName</span></i> ] | <strong><span>-f</span></strong> <i><span class="varname">initTtl</span></i> | <strong><span>-m</span></strong> <i><span class="varname">maxTtl</span></i> | <strong><span>-p</span></strong> <i><span class="varname">destPort</span></i> | <strong><span>-q</span></strong> <i><span class="varname">nqueries</span></i> | <strong><span>-vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>-w</span></strong> <i><span class="varname">timeout</span></i> | <strong><span>-s</span></strong> <i><span class="varname">size</span></i>| <strong><span>-name</span></strong> | { <strong><span>-tos</span></strong> <i><span class="varname">tos-value</span></i> | <strong><span>-dscp</span></strong> <i><span class="varname">dscp</span></i> } | <strong><span>-pipe</span></strong> ] <sup>*</sup> <i><span class="varname">host</span></i></pre>
</p></li></ol>
</li><li id="EN-US_TASK_0000001176664541__step1659474236214104"><span id="EN-US_TASK_0000001176664541__cmd1413360863214104">Configure tracert to test an IPv6 network.</span><p><p id="EN-US_TASK_0000001176664541__p52111931112215">Test the fault position.</p>
<pre class="screen" id="EN-US_TASK_0000001176664541__screen1757013294567"><a href="cmdqueryname=tracert+ipv6"><b><span class="cmdname" id="EN-US_TASK_0000001176664541__cmdname51a502fec7da0b796ff175b8c0388a1b">tracert ipv6</span></b></a> [ <strong><span id="EN-US_TASK_0000001176664541__cmdpar8d98ccbadfce887603b334da8279b5f4">-f</span></strong> <i><span class="varname" id="EN-US_TASK_0000001176664541__varnamed7bd8f6981ffee54664ce597f3f9bb84">first-hop-limit</span></i> | <strong><span id="EN-US_TASK_0000001176664541__cmdparea3f1847ae5cee2ccfb9330e0f0646b3">-m</span></strong> <i><span class="varname" id="EN-US_TASK_0000001176664541__varnamefdb5ae837be5fe31b9c2952f13061805">max-hop-limit</span></i> | <strong><span id="EN-US_TASK_0000001176664541__cmdpar815e56e2a060d9b93b699f5713af62a5">-p</span></strong> <i><span class="varname" id="EN-US_TASK_0000001176664541__varname493f0f0fc664fcba953b20eab78ef950">port-number</span></i> | <strong><span id="EN-US_TASK_0000001176664541__cmdpar4f5eef744fb3ccda68e41c2b0ebc293c">-q</span></strong> <i><span class="varname" id="EN-US_TASK_0000001176664541__varname24d2c411afd66ebf3dfe34c57587fe77">probes</span></i> | <strong><span id="EN-US_TASK_0000001176664541__cmdpar98657bd0577f6e5fb19d6fc9e98a483a">-w</span></strong> <i><span class="varname" id="EN-US_TASK_0000001176664541__varname1af2b10fe17167f4cfb0330e6d94284d">timeout</span></i> | <strong><span id="EN-US_TASK_0000001176664541__cmdpar743f43085c215932a1689f878cb65b58">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0000001176664541__varnameac2915486224008674edad61ba4224ec">vpn-instance-name</span></i> | <strong><span id="EN-US_TASK_0000001176664541__cmdpar6d578d5bb94b890ed26814db8f719b8f">-s</span></strong> <i><span class="varname" id="EN-US_TASK_0000001176664541__varname4c2706fc9853aea831eca17ae5d327d8">size</span></i> | <strong><span id="EN-US_TASK_0000001176664541__cmdpar49a05f4a4998b790edeba1e40ab71993">-name</span></strong> | { <strong><span id="EN-US_TASK_0000001176664541__cmdparmname141497228384">-nexthop</span></strong> <i><span class="varname" id="EN-US_TASK_0000001176664541__varname720541414383">nextHopAddr</span></i> | <strong><span id="EN-US_TASK_0000001176664541__cmdparmname62095421413">-passroute</span></strong> | <strong><span id="EN-US_TASK_0000001176664541__cmdparmname175891475365">-pipe</span></strong> }<sup id="EN-US_TASK_0000001176664541__sup312064410416">*</sup> | <strong><span id="EN-US_TASK_0000001176664541__cmdparmname1347311817555">-a</span></strong> <i><span class="varname" id="EN-US_TASK_0000001176664541__varname62901822115518">source-ipv6-address</span></i> | { <strong><span id="EN-US_TASK_0000001176664541__cmdparmname1530852718400">-tc</span></strong> <i><span class="varname" id="EN-US_TASK_0000001176664541__varname11292431134018">tc</span></i> | <strong><span id="EN-US_TASK_0000001176664541__cmdparmname128853216401">-dscp</span></strong> <i><span class="varname" id="EN-US_TASK_0000001176664541__varname7869151134017">dscp</span></i> } ] <sup id="EN-US_TASK_0000001176664541__sup9692271be9ded5f5beb8543859fd2dee">*</sup> <i><span class="varname" id="EN-US_TASK_0000001176664541__varname17711517118">host-name</span></i>  [ <strong><span id="EN-US_TASK_0000001176664541__cmdpar78cee4921a9b1db75e4f96069f4e1c80">-i</span></strong> { <i><span class="varname" id="EN-US_TASK_0000001176664541__varname959d96839d6e5bf3676f1cf3c4399961">ifName</span></i> | <i><span class="varname" id="EN-US_TASK_0000001176664541__varnamedd443bfe91ab95f35b487f8c06138e00">ifType</span></i> <i><span class="varname" id="EN-US_TASK_0000001176664541__varname1897e3f8caf1e267b2099d0383b5928b">ifNum</span></i> } ]</pre>
</p></li></ul></div>
<div class="example"><a name="EN-US_TASK_0000001176664541__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Example</h4><ul><li>Perform a tracert operation to test an IPv4 network.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> tracert -m 10 10.1.1.1</strong>
traceroute to 10.1.1.1 (10.1.1.1), max hops: 10 ,packet length: 40,press CTRL_C to break
1  172.16.112.1   19 ms   19 ms   1 ms
2  172.16.216.1   39 ms   39 ms   19 ms
3  172.16.136.23   39 ms   40 ms   39 ms
4  172.16.168.22   39 ms   39 ms   39 ms
5  172.16.197.4   40 ms   59 ms   59 ms
6  172.16.221.5   59 ms   59 ms   59 ms
7  172.31.70.13   99 ms   99 ms   80 ms
8  172.31.71.6   139 ms   239 ms   319 ms
9  172.31.81.7   220 ms   199 ms   199 ms
10 10.1.1.1   239 ms   239 ms   239 ms</pre>
<p>If a loopback interface address is configured as the source IP address of ICMP Port Unreachable or Time Exceeded messages on the second hop (with the loopback interface address 10.2.2.9), the following information is displayed when a tracert operation is performed to check the IPv4 network:</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> tracert -m 10 10.1.1.1</strong>
traceroute to 10.1.1.1 (10.1.1.1), max hops: 10 ,packet length: 40,press CTRL_C to break
1  172.16.112.1   19 ms   19 ms   1 ms
<strong>2  10.2.2.9   39 ms   39 ms   19 ms</strong>
3  172.16.136.23   39 ms   40 ms   39 ms
4  172.16.168.22   39 ms   39 ms   39 ms
5  172.16.197.4   40 ms   59 ms   59 ms
6  172.16.221.5   59 ms   59 ms   59 ms
7  172.31.70.13   99 ms   99 ms   80 ms
8  172.31.71.6   139 ms   239 ms   319 ms
9  172.31.81.7   220 ms   199 ms   199 ms
10 10.1.1.1   239 ms   239 ms   239 ms</pre>
<p>The situation is similar on an IPv6 network.</p>
</li><li>Perform a tracert operation to test an IPv6 network.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> tracert ipv6 -q 5 -w 8000 2001:DB8:100::3</strong>
traceroute to 2001:DB8:100::3 30 hops max,60 bytes packet
1 2001:DB8:200::2 26 ms 23 ms 26 ms 30 ms 29 ms 
2 2001:DB8:100::3 3020 ms 3024 ms 4040 ms 6820 ms 5584 ms</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_ping_tracert_cfg_0008.html">Using Ping and Tracert to Test an IP Network
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_ping_tracert_cfg_0011.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>