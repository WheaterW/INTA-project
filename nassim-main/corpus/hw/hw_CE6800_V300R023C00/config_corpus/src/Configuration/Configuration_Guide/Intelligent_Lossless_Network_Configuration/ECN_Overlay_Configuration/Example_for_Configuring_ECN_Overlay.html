
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring ECN Overlay">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_ai_ecnoverlay_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_ai_ecnoverlay_cfg_0005.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="ECN Overlay">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ECN Overlay">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001513170018">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<link rel="stylesheet" type="text/css" href="public_sys-resources/imagePopup.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/customQuery.js"></script>
<script language="javascript" type="text/javascript" src="public_sys-resources/imagePopup.js"></script>
<title>Example for Configuring ECN Overlay</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001513170018"></a><a name="EN-US_TASK_0000001513170018"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring ECN Overlay</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001513170018__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0000001513170018__fig19978171395514">Figure 1</a>, the hybrid overlay is deployed on a VXLAN network, and a VXLAN tunnel is established between DeviceA and the vSwitch of Server2, enabling Server1 and Server2 to communicate with each other. Queue 3 is configured to carry services with heavy traffic, and static ECN needs to be deployed for this queue to prevent congestion. Because the network is a VXLAN network, you also need to configure the ECN Overlay function on all devices to apply the ECN function.</p>
<div class="fignone" id="EN-US_TASK_0000001513170018__fig19978171395514"><a name="EN-US_TASK_0000001513170018__fig19978171395514"></a><a name="fig19978171395514"></a><span class="figcap"><b>Figure 1 </b>Network diagram of ECN Overlay</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 and interface2 represent <span>100GE</span><span>1/0/1</span> and <span>100GE</span><span>1/0/2</span>, respectively.</p>
</div></div>
<br><span><img class="imgResize" src="figure/en-us_image_0000001512690890.png" width="410.97" height="317.20500000000004" title="Click to enlarge"></span></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001513170018__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure the static ECN function.</span><p><p># Configure the static ECN function for queue 3 on DeviceA, and set the lower drop threshold to 30, upper drop threshold to 50, and maximum drop probability to 20. (These values are presented in the form of percentage.) The configurations of DeviceB and DeviceC are similar to that of DeviceA.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[*<span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>drop-profile dp1</strong>
[*DeviceA-drop-dp1] <strong>ecn low-limit 30 high-limit 50 discard-percentage 20</strong>
[*DeviceA-drop-dp1] <strong>quit</strong>
[*DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>qos queue 3 wred dp1</strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>qos queue 3 ecn</strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[*DeviceA] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[*DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>qos queue 3 wred dp1</strong>
[*DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>qos queue 3 ecn</strong>
[*DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[*DeviceA] <strong>commit</strong></pre>
</p></li><li><span>Configure the ECN Overlay function.</span><p><p># Configure the ECN Overlay function on DeviceA to ensure the inner ECN mark of VXLAN packets is the same as the outer ECN mark. The configurations of DeviceB and DeviceC are similar to that of DeviceA.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>assign forward nvo3 egress mark-ecn enable</strong>
[*DeviceA] <strong>assign forward nvo3 transit mark inner-ecn enable</strong>
[*DeviceA] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001513170018__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Check the ECN thresholds on DeviceA.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>display qos ecn threshold interface <span>100ge</span> </strong><strong><span>1/0/1</span></strong>                                         
* : indicates AI ECN                                           
[]: indicates the upper ECN threshold                          
Interface       Queue     Min     Max  Probability  Queue Size 
                         (KB)    (KB)          (%)        (KB) 
-------------------------------------------------------------- 
<span>100GE</span><span>1/0/1</span>          0       0       0            0           0 
                    1       0       0            0           0 
                    2       0       0            0           0 
                    3    2150    3584           20           0 
                    4       0       0            0           0 
                    5       0       0            0           0 </pre>
<div class="p"># Check whether the ECN Overlay function is enabled on DeviceA.<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>display nvo3 ecn configuration</strong>
---------------------------------------------------------------------------------------
 Slot                   Mark inner ECN                      Copy outer ECN
---------------------------------------------------------------------------------------
  1                         Enable                              Enable
---------------------------------------------------------------------------------------
</pre>
</div>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001513170018__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Configuration Scripts</h4><p><span class="keyword">DeviceA</span></p>
<pre class="screen">#
sysname <span class="keyword">DeviceA</span>
#
drop-profile dp1
 ecn low-limit 30 high-limit 50 discard-percentage 20
# 
assign forward nvo3 egress mark-ecn enable 
assign forward nvo3 transit mark inner-ecn enable
#
interface <span>100GE</span><span>1/0/1</span>
 qos queue 3 wred dp1
 qos queue 3 ecn
#
interface <span>100GE</span><span>1/0/2</span>
 qos queue 3 wred dp1
 qos queue 3 ecn
#
return
</pre>
<p><span class="keyword">DeviceB</span></p>
<pre class="screen">#
sysname <span class="keyword">DeviceB</span>
#
drop-profile dp1
 ecn low-limit 30 high-limit 50 discard-percentage 20
# 
assign forward nvo3 egress mark-ecn enable 
assign forward nvo3 transit mark inner-ecn enable
#
interface <span>100GE</span><span>1/0/1</span>
 qos queue 3 wred dp1
 qos queue 3 ecn
#
interface <span>100GE</span><span>1/0/2</span>
 qos queue 3 wred dp1
 qos queue 3 ecn
#
return
</pre>
<p><span class="keyword">DeviceC</span></p>
<pre class="screen">#
sysname <span class="keyword">DeviceC</span>
#
drop-profile dp1
 ecn low-limit 30 high-limit 50 discard-percentage 20
# 
assign forward nvo3 egress mark-ecn enable 
assign forward nvo3 transit mark inner-ecn enable
#
interface <span>100GE</span><span>1/0/1</span>
 qos queue 3 wred dp1
 qos queue 3 ecn
#
interface <span>100GE</span><span>1/0/2</span>
 qos queue 3 wred dp1
 qos queue 3 ecn
#
return
</pre>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_ai_ecnoverlay_cfg_0001.html">ECN Overlay Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_ai_ecnoverlay_cfg_0005.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>

<script language="JavaScript">
<!--
initImageViewer('.imgResize');
var msg_imageMax = "view original image";
var msg_imageClose = "close";
//--></script></body>
</html>