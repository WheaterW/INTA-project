
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Export of TCP Flow Analysis Results">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_traffic-analysis_cfg_0009.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_traffic-analysis_cfg_0011.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_traffic-analysis_cfg_0013.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Intelligent Traffic Analysis">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Intelligent Traffic Analysis">
<meta name="featuretype" content="System Monitoring">
<meta name="featurename" content="Intelligent Traffic Analysis">
<meta name="featuretype" content="System Monitoring">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001563773325">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring Export of TCP Flow Analysis Results</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001563773325"></a><a name="EN-US_TASK_0000001563773325"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Export of TCP Flow Analysis Results</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001563773325__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>After intelligent traffic analysis for TCP flows is enabled on the device, the TCP flow tables that contain TCP flow analysis results are first stored on the device. When a TCP flow table meets aging conditions, the device sends the flow table to the specified TDA for further processing and graphical display of flow information. </p>
<p>TCP flow analysis results can be exported only after you specify the source IP address as well as at least one destination IP address and one destination port number for the exported packets that carry these analysis results.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001563773325__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Configure the source IP address for the exported packets that carry TCP flow analysis results.</span><p><pre class="screen"><a href="cmdqueryname=traffic-analysis+tcp+export+source"><b><span class="cmdname">traffic-analysis tcp export source</span></b></a> { <strong><span>ip</span></strong> <i><span class="varname">ip-address</span></i> | <strong><span>ipv6</span></strong> <i><span class="varname">ipv6-address</span></i> }</pre>
<p>By default, no source IP address is configured for the exported packets that carry TCP flow analysis results.</p>
<p>If no source IP address is configured, packets are not exported. The source address can be an IPv4 or IPv6 address. Ensure that there are reachable routes between the source IP address and destination IP address (TDA's IP address) of the exported packets. A maximum of two source IP addresses can be specified: one IPv4 address and one IPv6 address. The two addresses are independent of each other.</p>
<p>When this command is executed, the IPv4 and IPv6 address families of the VPN instance are automatically verified. If no IP address family is configured for the VPN instance, the configuration will be lost after the upgrade. In this case, reconfigure the IP address family of the VPN instance and then run the command again.</p>
</p></li><li><span>Configure the destination IP address and destination port number for the exported packets that carry TCP flow analysis results.</span><p><pre class="screen"><a href="cmdqueryname=traffic-analysis+tcp+export+host"><b><span class="cmdname">traffic-analysis tcp export host</span></b></a> { <strong><span>ip</span></strong> <i><span class="varname">ip-address</span></i> | <strong><span>ipv6</span></strong> <i><span class="varname">ipv6-address</span></i> } <i><span class="varname">port-number</span></i><span> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ]</span></pre>
<p>By default, no destination IP address or destination port number is configured for the exported packets that carry TCP flow analysis results.</p>
<p>You can configure a maximum of two destination addresses to implement backup of TDAs. To configure a third destination IP address, first run the <a href="cmdqueryname=undo+traffic-analysis+tcp+export+host"><b><span class="cmdname">undo traffic-analysis tcp export host</span></b></a> { <strong><span>ip</span></strong> <i><span class="varname">ip-address</span></i> | <strong><span>ipv6</span></strong> <i><span class="varname">ipv6-address</span></i> } <i><span class="varname">port-number</span></i><span> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ]</span> command to delete a configured destination IP address. Otherwise, the system displays a message indicating that the number of destination addresses exceeds the maximum and the configuration fails.</p>
<p>When this command is executed, the IPv4 and IPv6 address families of the VPN instance are automatically verified. If no IP address family is configured for the VPN instance, the configuration will be lost after the upgrade. In this case, reconfigure the IP address family of the VPN instance and then run the command again.</p>
</p></li><li><span>(Optional) Configure the interval of delivering the template for exporting packets that carry TCP flow analysis results.</span><p><pre class="screen"><a href="cmdqueryname=traffic-analysis+tcp+export+template+timeout-rate"><b><span class="cmdname">traffic-analysis tcp export template timeout-rate</span></b></a> <i><span class="varname">timeout-interval</span></i></pre>
<p>By default, the template is delivered at an interval of 1 minute.</p>
</p></li><li id="EN-US_TASK_0000001563773325__step1157911116121"><span id="EN-US_TASK_0000001563773325__cmd125791111131211">(Optional) Set the length of truncated packets to be sent for intelligent traffic analysis.</span><p><pre class="screen" id="EN-US_TASK_0000001563773325__screen1489941431311"><a href="cmdqueryname=observe-port+packet-length"><b><span class="cmdname" id="EN-US_TASK_0000001563773325__cmdname2740112741620">observe-port packet-length</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001563773325__varname12181112220167">packet-length</span></i></pre>
<p id="EN-US_TASK_0000001563773325__p17824819101315">By default, the length of truncated packets to be sent for intelligent traffic analysis is 256 bytes.</p>
<div class="note" id="EN-US_TASK_0000001563773325__note11670536175"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001563773325__p152916326343">This command is originally used to configure truncation for mirrored packets. For details, see "Configuring an Observing Port" in Configuration Guide &gt; System Monitoring Configuration &gt; Mirroring Configuration.</p>
<p id="EN-US_TASK_0000001563773325__p146719536177">On the <span>CE6866, CE6860-SAN, CE6866K, CE6860-HAM, CE8851-32CQ8DQ-P, CE8850-SAN, CE8851K, CE8850-HAM</span>, this command also takes effect for packets to be sent for intelligent traffic analysis. For other products, the length of truncated packets is fixed at 256 bytes.</p>
</div></div>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_traffic-analysis_cfg_0009.html">Configuring Intelligent Traffic Analysis for TCP Flows
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_traffic-analysis_cfg_0011.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_traffic-analysis_cfg_0013.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>