
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring IGMP Snooping Querier">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_l2mc_cfg_0022.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_l2mc_cfg_0023.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_l2mc_cfg_0025.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="IGMP Snooping">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IGMP Snooping">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IGMP Snooping">
<meta name="featuretype" content="IP Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130781898">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring IGMP Snooping Querier</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130781898"></a><a name="EN-US_TASK_0000001130781898"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring IGMP Snooping Querier</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001130781898__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>A Layer 2 device on which IGMP snooping is enabled can dynamically create Layer 2 multicast forwarding entries and provide Layer 2 multicast functions by listening to IGMP messages exchanged between an IGMP querier and user hosts.</p>
<p>However, an IGMP snooping-enabled device cannot listen to IGMP messages and therefore cannot create dynamic Layer 2 multicast entries if the following conditions exist:</p>
<ul><li><p>The interfaces on the upstream Layer 3 multicast device have static multicast groups configured and do not run IGMP.</p>
</li><li><p>The multicast source is located on the same Layer 2 network as user hosts, and no Layer 3 multicast device is deployed.</p>
</li></ul>
<p>If the preceding conditions exist, you can configure the IGMP snooping querier function on the Layer 2 multicast device so that it sends IGMP Query messages to user hosts on behalf of the Layer 3 multicast device.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130781898__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the VLAN view.</span><p><pre class="screen"><a href="cmdqueryname=vlan"><b><span class="cmdname">vlan</span></b></a> <i><span class="varname">vlan-id</span></i></pre>
</p></li><li><span>Enable the IGMP snooping querier function.</span><p><pre class="screen"><a href="cmdqueryname=igmp+snooping+querier+enable"><b><span class="cmdname">igmp snooping querier enable</span></b></a></pre>
</p><p><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>The IGMP snooping querier function cannot be enabled in a VLAN if the corresponding Layer 3 VLANIF interface has Layer 3 multicast functions (such as IGMP and PIM) enabled.</li><li>After the IGMP snooping querier function is enabled in a VLAN, the device periodically broadcasts IGMP Query messages to all the interfaces (including the router ports) in the VLAN. This may result in the reelection of the IGMP querier if one already exists on the multicast network. In this case, you are advised not to configure the IGMP snooping querier function. However, if this function must be configured, ensure that the source IP address of the General Query messages sent from the device is larger than the IP address of the upstream IGMP querier.</li><li>IGMP snooping querier and IGMP snooping proxy cannot both be enabled in the same VLAN.</li></ul>
</div></div>
</p></li><li><span>(Optional) Configure the querier election function.</span><p><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>When setting the querier parameters, ensure that the interval for sending IGMP Query messages is larger than the maximum response time for IGMP Query messages.</p>
</div></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="20%" id="mcps1.3.2.4.2.2.1.6.1.1" liSelected="liSelected"><p>Querier Parameter</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="20%" id="mcps1.3.2.4.2.2.1.6.1.2" liSelected="liSelected"><p>Configuration Command</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="20%" id="mcps1.3.2.4.2.2.1.6.1.3" liSelected="liSelected"><p>Parameter Description</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="20%" id="mcps1.3.2.4.2.2.1.6.1.4" liSelected="liSelected"><p>Default Setting</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="20%" id="mcps1.3.2.4.2.2.1.6.1.5" liSelected="liSelected"><p>Supported Version</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.1 "><p>Interval for sending IGMP General Query messages</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.2 "><p><a href="cmdqueryname=igmp+snooping+query+interval"><b><span class="cmdname">igmp snooping query interval</span></b></a> <i><span class="varname">QueryIntervalValue</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.3 "><p>This parameter determines the interval at which a querier sends IGMP General Query messages to maintain the memberships in a VLAN.</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.4 "><p><span>60</span> seconds</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.5 "><p>IGMPv1, IGMPv2, and IGMPv3</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.1 "><p>IGMP robustness variable</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.2 "><p><a href="cmdqueryname=igmp+snooping+robust-count"><b><span class="cmdname">igmp snooping robust-count</span></b></a> <i><span class="varname">robust-count-value</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.3 "><div class="p">This parameter defines the following values:<ul><li>Number of times a querier sends General Query messages after startup. The interval for sending messages is 1/4 of the interval for sending General Query messages.</li><li>Number of times a querier sends Group-Specific Query messages after a Leave message is received. The interval for sending messages is the same as that for sending IGMP Group-Specific Query messages.</li></ul>
</div>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.4 "><p>2</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.5 "><p>IGMPv1, IGMPv2, and IGMPv3</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.1 "><p>Maximum response time for IGMP Query messages</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.2 "><p><a href="cmdqueryname=igmp+snooping+query+max-response-time"><b><span class="cmdname">igmp snooping query max-response-time</span></b></a> <i><span class="varname">QueryRspIntValue</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.3 "><p>When receiving an IGMP Report message from a host, the device determines the aging time of the member port as follows: General Query interval x IGMP robustness variable + Maximum response time.</p>
<p>After a multicast member receives an IGMP Query message, it must send a Report message before the maximum response time expires if it still requires the group's traffic.</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.4 "><p>10 seconds</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.5 "><p>IGMPv2 and IGMPv3</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.1 "><p>Interval for sending Group-Specific Query messages</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.2 "><p><a href="cmdqueryname=igmp+snooping+query+last-member-interval"><b><span class="cmdname">igmp snooping query last-member-interval</span></b></a> <i><span class="varname">LastMemQIValue</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.3 "><p>This parameter specifies the interval for sending Group-Specific Query messages. When receiving a Leave message from a host, the device determines the aging time of the member port as follows: Group-Specific Query interval x IGMP robustness variable. The device continuously sends Group-Specific Query messages (the number of which is specified by the IGMP robustness variable) to check whether the multicast group has other members.</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.4 "><p>1 second</p>
</td>
<td class="cellrowborder" valign="top" width="20%" headers="mcps1.3.2.4.2.2.1.6.1.5 "><p>IGMPv2 and IGMPv3</p>
</td>
</tr>
</tbody>
</table>
</div>
</p></li><li><span>Return to the system view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li><span>(Optional) Configure a source IP address for IGMP General Query messages.</span><p><ul><li>Perform the configuration in the system view:<pre class="screen"><a href="cmdqueryname=igmp+snooping+send-query+source-address"><b><span class="cmdname">igmp snooping send-query source-address</span></b></a><i><span class="varname"> ip-source-address</span></i></pre>
</li><li>Perform the configuration in the VLAN view:<pre class="screen"><a href="cmdqueryname=vlan"><b><span class="cmdname">vlan</span></b></a> <em>vlan-id</em>
<a href="cmdqueryname=igmp+snooping+send-query+source-address"><b><span class="cmdname">igmp snooping send-query source-address</span></b></a><i><span class="varname"> ip-source-address</span></i>
<a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</li></ul>
<p>By default, the source IP address of General Query messages sent by the IGMP snooping querier is 192.168.0.1. If this address is already in use on the network, use this command to set a different address. If the <a href="cmdqueryname=igmp-snooping+send-query+source-address"><b><span class="cmdname">igmp-snooping send-query source-address</span></b></a> command is run in both the system view and VLAN view, the configuration in the VLAN view is preferentially used.</p>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_l2mc_cfg_0022.html">Configuring IGMP Snooping Proxy
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_l2mc_cfg_0023.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../vrp/vrp_l2mc_cfg_0025.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>