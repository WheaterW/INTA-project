
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Basic BGP Functions">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_0014.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_0018.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_0020.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130624140">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Basic BGP Functions</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130624140"></a><a name="EN-US_TASK_0000001130624140"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Basic BGP Functions</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001130624140__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>If multiple ASs in a region require mutual access, they need to exchange their local routes with one another, and BGP can be used to meet this requirement.</p>
<p>On the network shown in <a href="#EN-US_TASK_0000001130624140__fig_dc_vrp_bgp_cfg_407101">Figure 1</a>, DeviceA is in AS 65008, and DeviceB, DeviceC, and DeviceD are in AS 65009. The routing tables of these devices store a large number of routes, and routes change frequently. After BGP is enabled on the devices, they can exchange routes with one another. If the routes on one device are updated, the device sends Update messages to its peers carrying only the updated routing information, which greatly reduces bandwidth consumption.</p>
<div class="fignone" id="EN-US_TASK_0000001130624140__fig_dc_vrp_bgp_cfg_407101"><a name="EN-US_TASK_0000001130624140__fig_dc_vrp_bgp_cfg_407101"></a><a name="fig_dc_vrp_bgp_cfg_407101"></a><span class="figcap"><b>Figure 1 </b>Network diagram of basic BGP functions</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span><span>1/0/1</span>, <span>100GE</span><span>1/0/2</span>, and <span>100GE</span><span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001130624210.png"></span></div>
<p>To complete the configuration, you need the following data:</p>
<ul><li><p>AS number and router ID of DeviceA</p>
</li><li><p>AS number and router IDs of DeviceB, DeviceC, and DeviceD</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130624140__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>During the configuration, note the following:</p>
<ul><li>Before establishing a BGP peer relationship, ensure that BGP peers are reachable to each other through IGP routes. In this way, the BGP peers can exchange routing information.</li><li><p>During the establishment of a peer relationship, if the IP address of the specified peer is a loopback interface address<span> or a sub-interface address</span>, the <strong>peer connect-interface</strong> command needs to be run on both ends to ensure correct connection.</p>
</li><li><p>If there is no directly connected physical link between EBGP peers, run the <strong>peer ebgp-max-hop</strong> command to allow the EBGP peers to establish a TCP connection through multiple hops.</p>
</li><li>To improve security, you are advised to deploy BGP security measures. For details, see "Configuring BGP Authentication." Keychain authentication is used as an example. For details, see <a href="vrp_bgp_cfg_0130.html">Example for Configuring Keychain Authentication for BGP</a>.</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130624140__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Establish IGP connections among DeviceB, DeviceC, and DeviceD. (OSPF is used as the IGP in this example.)</li><li><p>Establish IBGP connections between DeviceB, DeviceC, and DeviceD.</p>
</li><li><p>Establish an EBGP connection between DeviceA and DeviceB.</p>
</li><li><p>Use the <strong>network</strong> command on DeviceA to configure BGP to import local routes and advertise them to peers. Then, check the BGP routing tables on DeviceA, DeviceB, and DeviceC.</p>
</li><li><p>Configure BGP on DeviceB to import direct routes, and then check the routing tables of DeviceA and DeviceC.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130624140__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface. DeviceA is used here as an example, and configurations of other devices are similar to that of DeviceA.</span><p><p># Configure DeviceA.</p>
<pre class="screen">&lt;<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ip address 172.16.0.1 16</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span><span><span>1/0/2</span></span></span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>ip address 192.168.0.1 24</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface loopback0</strong>
[<span class="keyword">*</span>DeviceA-loopback0] <strong>ip address 1.1.1.1 32</strong>
[<span class="keyword">*</span>DeviceA-loopback0] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
</p></li><li><span>Configure OSPF to ensure that BGP peers can exchange routing information.</span><p><p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong> ospf 1</strong>
[<span class="keyword">*</span>DeviceB-ospf-1]<strong> area 0</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0]<strong> network 10.1.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0]<strong> network 10.1.3.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0]<strong> network 2.2.2.2 0.0.0.0</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0]<strong> quit</strong>
[<span class="keyword">*</span>DeviceB-ospf-1]<strong> quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
<p># Configure DeviceC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC]<strong> ospf 1</strong>
[<span class="keyword">*</span>DeviceC-ospf-1]<strong> area 0</strong>
[<span class="keyword">*</span>DeviceC-ospf-1-area-0.0.0.0]<strong> network 10.1.2.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceC-ospf-1-area-0.0.0.0]<strong> network 10.1.3.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceC-ospf-1-area-0.0.0.0]<strong> network 3.3.3.3 0.0.0.0</strong>
[<span class="keyword">*</span>DeviceC-ospf-1-area-0.0.0.0]<strong> quit</strong>
[<span class="keyword">*</span>DeviceC-ospf-1]<strong> quit</strong>
[<span class="keyword">*</span>DeviceC] <strong>commit</strong></pre>
<p># Configure DeviceD.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD]<strong> ospf 1</strong>
[<span class="keyword">*</span>DeviceD-ospf-1]<strong> area 0</strong>
[<span class="keyword">*</span>DeviceD-ospf-1-area-0.0.0.0]<strong> network 10.1.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceD-ospf-1-area-0.0.0.0]<strong> network 10.1.2.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceD-ospf-1-area-0.0.0.0]<strong> network 4.4.4.4 0.0.0.0</strong>
[<span class="keyword">*</span>DeviceD-ospf-1-area-0.0.0.0]<strong> quit</strong>
[<span class="keyword">*</span>DeviceD-ospf-1]<strong> quit</strong>
[<span class="keyword">*</span>DeviceD] <strong>commit</strong></pre>
</p></li><li><span>Configure IBGP connections.</span><p><p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong> bgp 65009</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-bgp]<strong> router-id 2.2.2.2</strong>
[<span class="keyword">*</span>DeviceB-bgp] <strong>peer 3.3.3.3 as-number 65009</strong>
[<span class="keyword">*</span>DeviceB-bgp]<strong> peer 4.4.4.4 as-number 65009</strong>
[<span class="keyword">*</span>DeviceB-bgp] <strong>peer 3.3.3.3 connect-interface LoopBack0</strong>
[<span class="keyword">*</span>DeviceB-bgp]<strong> peer 4.4.4.4 connect-interface LoopBack0</strong>
[<span class="keyword">*</span>DeviceB-bgp]<strong> quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
<p># Configure DeviceC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC]<strong> bgp 65009</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC-bgp]<strong> router-id 3.3.3.3</strong>
[<span class="keyword">*</span>DeviceC-bgp]<strong> peer 2.2.2.2 as-number 65009</strong>
[<span class="keyword">*</span>DeviceC-bgp]<strong> peer 4.4.4.4 as-number 65009</strong>
[<span class="keyword">*</span>DeviceC-bgp]<strong> peer 2.2.2.2 connect-interface LoopBack0</strong>
[<span class="keyword">*</span>DeviceC-bgp]<strong> peer 4.4.4.4 connect-interface LoopBack0</strong>
[<span class="keyword">*</span>DeviceC-bgp]<strong> quit</strong>
[<span class="keyword">*</span>DeviceC] <strong>commit</strong></pre>
<p># Configure DeviceD.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD]<strong> bgp 65009</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD-bgp]<strong> router-id 4.4.4.4</strong>
[<span class="keyword">*</span>DeviceD-bgp]<strong> peer 2.2.2.2 as-number 65009</strong>
[<span class="keyword">*</span>DeviceD-bgp]<strong> peer 3.3.3.3 as-number 65009</strong>
[<span class="keyword">*</span>DeviceD-bgp]<strong> peer 2.2.2.2 connect-interface LoopBack0</strong>
[<span class="keyword">*</span>DeviceD-bgp]<strong> peer 3.3.3.3 connect-interface LoopBack0</strong>
[<span class="keyword">*</span>DeviceD-bgp]<strong> quit</strong>
[<span class="keyword">*</span>DeviceD] <strong>commit</strong></pre>
</p></li><li><span>Configure EBGP.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> bgp 65008</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-bgp] <strong>router-id 1.1.1.1</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-bgp]<strong> peer 192.168.0.2 as-number 65009</strong>
[<span class="keyword">*</span>DeviceA-bgp]<strong> quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong> bgp 65009</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-bgp]<strong> peer 192.168.0.1 as-number 65008</strong>
[<span class="keyword">*</span>DeviceB-bgp]<strong> quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
<p># Check the status of BGP connections.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display bgp peer</strong>

 BGP local router ID : 2.2.2.2
 Local AS number : 65009
 Total number of peers : 3                 Peers in established state : 3

  Peer            V    AS  MsgRcvd  MsgSent  OutQ  Up/Down       State PrefRcv

  3.3.3.3         4 65009        5        5     0 00:44:58 <strong>Established</strong>       0
  4.4.4.4         4 65009        4        4     0 00:40:54 <strong>Established</strong>       0
  192.168.0.1     4 65008        3        3     0 00:44:03 <strong>Established</strong>       0</pre>
<p>The command output shows that DeviceB has established BGP connections with other devices and the connection status is <strong>Established</strong>.</p>
</p></li><li><span>Configure DeviceA to advertise the route 172.16.0.0/16 to BGP peers.</span><p><p># Configure DeviceA to advertise the route.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> bgp 65008</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-bgp] <strong>ipv4-family unicast</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-bgp-af-ipv4] <strong>network 172.16.0.0 255.255.0.0</strong>
[<span class="keyword">*</span>DeviceA-bgp-af-ipv4] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA-bgp] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Check the routing table of DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display bgp routing-table</strong>

 BGP Local router ID is 1.1.1.1
 Status codes: * - valid, &gt; - best, d - damped,<span> x - best external,</span><span> a - add path,</span>
               h - history,  i - internal, s - suppressed, S - Stale
               Origin : i - IGP, e - EGP, ? - incomplete
 RPKI validation codes: V - valid, I - invalid, N - not-found

 Total Number of Routes: 1
      Network            NextHop        MED        LocPrf    PrefVal Path/Ogn

 *&gt;   172.16.0.0         0.0.0.0         0                     0      i</pre>
<p># Check the routing table of DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display bgp routing-table</strong>

 BGP Local router ID is 2.2.2.2
 Status codes: * - valid, &gt; - best, d - damped,<span> x - best external,</span><span> a - add path,</span>
               h - history,  i - internal, s - suppressed, S - Stale
               Origin : i - IGP, e - EGP, ? - incomplete
 RPKI validation codes: V - valid, I - invalid, N - not-found

 Total Number of Routes: 1
      Network            NextHop        MED        LocPrf    PrefVal Path/Ogn

 *&gt;   172.16.0.0         192.168.0.1    0                     0      65008i</pre>
<p># Check the routing table of DeviceC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>display bgp routing-table</strong>

 BGP Local router ID is 3.3.3.3
 Status codes: * - valid, &gt; - best, d - damped,<span> x - best external,</span><span> a - add path,</span>
               h - history,  i - internal, s - suppressed, S - Stale
               Origin : i - IGP, e - EGP, ? - incomplete
 RPKI validation codes: V - valid, I - invalid, N - not-found

 Total Number of Routes: 1
      Network            NextHop        MED        LocPrf    PrefVal Path/Ogn

   i  172.16.0.0         192.168.0.1    0          100        0      65008i</pre>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The command output shows that DeviceC has learned the route to 172.16.0.0 from AS 65008. However, this route is invalid because its next hop, 192.168.0.1, is unreachable.</p>
</div></div>
</p></li><li><span>Configure BGP to import direct routes.</span><p><p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong> bgp 65009</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-bgp] <strong>ipv4-family unicast</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-bgp-af-ipv4] <strong>import-route direct</strong>
[<span class="keyword">*</span>DeviceB-bgp-af-ipv4] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB-bgp] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001130624140__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Check the BGP routing table of DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display bgp routing-table</strong>

 BGP Local router ID is 1.1.1.1
 Status codes: * - valid, &gt; - best, d - damped,<span> x - best external,</span><span> a - add path,</span>
               h - history,  i - internal, s - suppressed, S - Stale
               Origin : i - IGP, e - EGP, ? - incomplete
<span> RPKI validation codes: V - valid, I - invalid, N - not-found</span>

 Total Number of Routes: 8
      Network            NextHop        MED        LocPrf    PrefVal Path/Ogn

 *&gt;   2.2.2.2/32         192.168.0.2     0                     0      65009?
 *&gt;   172.16.0.0         0.0.0.0         0                     0      i
 *&gt;   10.1.1.0/24        192.168.0.2     0                     0      65009?
 *&gt;   10.1.1.2/32        192.168.0.2     0                     0      65009?
 *&gt;   10.1.3.0/24        192.168.0.2     0                     0      65009?
 *&gt;   10.1.3.2/32        192.168.0.2     0                     0      65009?
 *    192.168.0.0        192.168.0.2     0                     0      65009?
 *    192.168.0.1/32     192.168.0.2     0                     0      65009?</pre>
<p># Check the routing table of DeviceC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>display bgp routing-table</strong>

 BGP Local router ID is 3.3.3.3
 Status codes: * - valid, &gt; - best, d - damped,<span> x - best external,</span><span> a - add path,</span>
               h - history,  i - internal, s - suppressed, S - Stale
               Origin : i - IGP, e - EGP, ? - incomplete
<span> RPKI validation codes: V - valid, I - invalid, N - not-found</span>

 Total Number of Routes: 8
      Network            NextHop        MED        LocPrf    PrefVal Path/Ogn

   i  2.2.2.2/32         2.2.2.2         0          100        0      ?
 *&gt;i  172.16.0.0         192.168.0.1     0          100        0      65008i
 *&gt;i  10.1.1.0/24        2.2.2.2         0          100        0      ?
 *&gt;i  10.1.1.2/32        2.2.2.2         0          100        0      ?
 * i  10.1.3.0/24        2.2.2.2         0          100        0      ?
 * i  10.1.3.2/32        2.2.2.2         0          100        0      ?
 *&gt;i  192.168.0.0        2.2.2.2         0          100        0      ?
 *&gt;i  192.168.0.1/32     2.2.2.2         0          100        0      ?</pre>
<p>The command output shows that the route to 172.16.0.0 becomes valid and that its next hop address is DeviceA's IP address.</p>
<p># Verify the configuration using the <strong>ping</strong> command.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>ping 172.16.0.1</strong>
  PING 172.16.0.1: 56  data bytes, press CTRL_C to break
    Reply from 172.16.0.1: bytes=56 Sequence=1 ttl=254 time=31 ms
    Reply from 172.16.0.1: bytes=56 Sequence=2 ttl=254 time=47 ms
    Reply from 172.16.0.1: bytes=56 Sequence=3 ttl=254 time=31 ms
    Reply from 172.16.0.1: bytes=56 Sequence=4 ttl=254 time=16 ms
    Reply from 172.16.0.1: bytes=56 Sequence=5 ttl=254 time=31 ms

  --- 172.16.0.1 ping statistics ---
    5 packet(s) transmitted
    5 packet(s) received
    0.00% packet loss
    round-trip min/avg/max = 16/31/47 ms</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001130624140__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 172.16.0.1 255.255.0.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.0.1 255.255.255.0
#
interface LoopBack0
 ip address 1.1.1.1 255.255.255.255
#
bgp 65008
 router-id 1.1.1.1
 peer 192.168.0.2 as-number 65009
 #
 ipv4-family unicast
  network 172.16.0.0 255.255.0.0
  peer 192.168.0.2 enable
#
return</pre>
</li><li><p>DeviceB</p>
<pre class="screen">#
sysname DeviceB
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.1.1.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.0.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 10.1.3.1 255.255.255.0
#
interface LoopBack0
 ip address 2.2.2.2 255.255.255.255
#
bgp 65009
 router-id 2.2.2.2
 peer 3.3.3.3 as-number 65009
 peer 3.3.3.3 connect-interface LoopBack0
 peer 4.4.4.4 as-number 65009
 peer 4.4.4.4 connect-interface LoopBack0
 peer 192.168.0.1 as-number 65008
 #
 ipv4-family unicast
  import-route direct
  peer 3.3.3.3 enable
  peer 4.4.4.4 enable 
  peer 192.168.0.1 enable
#
ospf 1
 area 0.0.0.0
  network 2.2.2.2 0.0.0.0
  network 10.1.1.0 0.0.0.255
  network 10.1.3.0 0.0.0.255
#
return</pre>
</li><li><p>DeviceC</p>
<pre class="screen">#
sysname DeviceC
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.1.2.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 10.1.3.2 255.255.255.0
#
interface LoopBack0
 ip address 3.3.3.3 255.255.255.255
#
bgp 65009
 router-id 3.3.3.3
 peer 2.2.2.2 as-number 65009
 peer 2.2.2.2 connect-interface LoopBack0
 peer 4.4.4.4 as-number 65009
 peer 4.4.4.4 connect-interface LoopBack0
 #
 ipv4-family unicast
  peer 2.2.2.2 enable
  peer 4.4.4.4 enable
#
ospf 1
 area 0.0.0.0
  network 3.3.3.3 0.0.0.0
  network 10.1.2.0 0.0.0.255
  network 10.1.3.0 0.0.0.255
#
return</pre>
</li><li><p>DeviceD</p>
<pre class="screen">#
sysname DeviceD
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.1.1.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.1.2.2 255.255.255.0
#
interface LoopBack0
 ip address 4.4.4.4 255.255.255.255
#
bgp 65009
 router-id 4.4.4.4
 peer 2.2.2.2 as-number 65009
 peer 2.2.2.2 connect-interface LoopBack0
 peer 3.3.3.3 as-number 65009
 peer 3.3.3.3 connect-interface LoopBack0
 #
 ipv4-family unicast
  peer 2.2.2.2 enable
  peer 3.3.3.3 enable
#
ospf 1
 area 0.0.0.0
  network 4.4.4.4 0.0.0.0
  network 10.1.1.0 0.0.0.255
  network 10.1.2.0 0.0.0.255
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_bgp_cfg_0014.html">Configuring Basic BGP Functions
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_bgp_cfg_0018.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_bgp_cfg_0020.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>