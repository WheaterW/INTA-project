
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring VXLAN Gateways to Exchange Specific Types of Routes">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_vrp_vxlan_cfg_1066.html">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_vrp_vxlan_cfg_1091.html">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_vrp_vxlan_cfg_1065.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130784296">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring VXLAN Gateways to Exchange Specific Types of Routes</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130784296"></a><a name="EN-US_TASK_0000001130784296"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring VXLAN Gateways to Exchange Specific Types of Routes</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001130784296__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>By default, VXLAN gateways can exchange MAC routes. They must be configured to exchange IRB or IP prefix routes if hosts need to communicate across network segments. If an RR is deployed on the network, IRB or IP prefix routes must be exchanged only between the VXLAN gateways and RR.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Host routes can be advertised through IRB routes (recommended), IP prefix routes, or both. In contrast, network segment routes of hosts can be advertised through IP prefix routes only.</p>
</div></div>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0000001130784296__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure IRB route advertisement.</span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the BGP view<span> or BGP multi-instance view</span>.</span><p><pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i><span> [ <strong><span>instance</span></strong> <i><span class="varname">instance-name</span></i> ]</span></pre>
</p></li><li class="substepexpand"><span>Enter the BGP-EVPN address family view or BGP multi-instance EVPN address family view.</span><p><pre class="screen"><a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname">l2vpn-family evpn</span></b></a></pre>
</p></li><li class="substepexpand"><span>Run one of the following commands based on the overlay network type to configure IRB route advertisement:</span><p><p>For an IPv4 overlay network, run the following command:</p>
<pre class="screen"><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>advertise</span></strong> <strong><span>irb</span></strong></pre>
<p>For an IPv6 overlay network, run the following command:</p>
<pre class="screen"><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>advertise</span></strong> <strong><span>irbv6</span></strong></pre>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001130784296__en-us_task_0234857734_screen14848162118611"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001130784296__en-us_task_0234857734_cmdname1784862115612">commit</span></b></a></pre>
</p></li></ol>
</li><li><span>Configure IP prefix route advertisement.</span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Perform one of the following steps based on the overlay network type to import IP routes to the BGP-VPN instance IPv4 or IPv6 address family:</span><p><p>For an IPv4 overlay network, run the following command:</p>
<pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i> [ <strong><span>instance</span></strong> <i><span class="varname">instance-name</span></i> ]
<a href="cmdqueryname=ipv4-family"><b><span class="cmdname">ipv4-family</span></b></a> <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i>
<a href="cmdqueryname=import-route"><b><span class="cmdname">import-route</span></b></a> { <strong><span>direct</span></strong> | <strong><span>isis</span></strong> <i><span class="varname">process-id</span></i> | <strong><span>ospf</span></strong> <i><span class="varname">process-id</span></i> | <strong><span>rip</span></strong> <i><span class="varname">process-id</span></i> | <strong><span>static</span></strong> } [ <strong><span>med</span></strong> <i><span class="varname">med</span></i> | <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> ] <sup>*</sup></pre>
<p>For an IPv6 overlay network, run the following command:</p>
<pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i>
<a href="cmdqueryname=ipv6-family"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i>
<a href="cmdqueryname=import-route"><b><span class="cmdname">import-route</span></b></a> { <strong><span>direct</span></strong> | <strong><span>isis</span></strong> <i><span class="varname">process-id</span></i> | <strong><span>ospfv3</span></strong> <i><span class="varname">process-id</span></i> | <strong><span>ripng</span></strong> <i><span class="varname">process-id</span></i> | <strong><span>static</span></strong> } [ <strong><span>med</span></strong> <i><span class="varname">med</span></i> | <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> ] <sup>*</sup></pre>
<p>To advertise host IP routes, configure import of direct routes. To advertise the route of a network segment where hosts reside, configure a dynamic routing protocol (such as OSPF or OSPFv3) and then run one of the preceding commands based on the overlay network type to import the route into the dynamic routing protocol.</p>
</p></li><li class="substepexpand"><span>Configure IP prefix route advertisement.</span><p><pre class="screen"><a href="cmdqueryname=advertise+l2vpn+evpn"><b><span class="cmdname">advertise l2vpn evpn</span></b></a> { <strong><span>valid-routes</span></strong> | <strong><span>best-route</span></strong> }</pre>
<p>IP prefix routes are Type 5 BGP EVPN routes that carry host IP addresses or network segment addresses as well as L3VNIs. Such routes are used to advertise host IP routes as well as network segment routes to which the host IP routes belong. If many specific host routes exist, you can reduce the number of routes that a VXLAN gateway needs to save by configuring it to advertise IP prefix routes and importing the routes to the target BGP VPN instance address family.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>A gateway can advertise network segment routes only if the attached network segments are unique across the entire network.</p>
</li><li><p>After configuring IP prefix route advertisement, run the <span><a href="cmdqueryname=arp+direct-route+enable"><b><span class="cmdname">arp direct-route enable</span></b></a></span> or <a href="cmdqueryname=ipv6+nd+direct-route+enable"><b><span class="cmdname">ipv6 nd direct-route enable</span></b></a> command to allow the device to generate direct routes to host IP addresses. This will affect host migration.</p>
</li></ul>
</div></div>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001130784296__en-us_task_0234857734_screen14848162118611_1"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001130784296__en-us_task_0234857734_cmdname1784862115612_1">commit</span></b></a></pre>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../dc/dc_vrp_vxlan_cfg_1066.html">Establishing VXLAN Tunnels in BGP EVPN Mode (Distributed VXLAN Gateway)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../dc/dc_vrp_vxlan_cfg_1091.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../dc/dc_vrp_vxlan_cfg_1065.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>