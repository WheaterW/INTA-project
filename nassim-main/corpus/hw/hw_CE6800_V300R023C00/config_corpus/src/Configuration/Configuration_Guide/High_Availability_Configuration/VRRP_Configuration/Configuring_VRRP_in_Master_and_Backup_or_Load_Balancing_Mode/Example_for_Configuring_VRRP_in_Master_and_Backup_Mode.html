
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring VRRP in Master/Backup Mode">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp_cfg_0104.html">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp_cfg_0109.html">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp_cfg_0132.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="High Availability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="High Availability">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="High Availability">
<meta name="featuretype" content="High Availability">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130784044">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring VRRP in Master/Backup Mode</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130784044"></a><a name="EN-US_TASK_0000001130784044"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring VRRP in Master/Backup Mode</h1>
<div class="taskbody" id="taskbody1571797906518"><div class="context"><a name="EN-US_TASK_0000001130784044__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001130784044__context1524653828214023"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001130784044__p2022566182214023">Hosts are connected to a network through gateways. To ensure non-stop service transmission, configure VRRP in master/backup mode on the gateways.</p>
<p id="EN-US_TASK_0000001130784044__p2047515311214023">As shown in <a href="#EN-US_TASK_0000001130784044__fig_dc_vrp_vrrp_cfg_012101">Figure 1</a>, DeviceD is dual-homed to DeviceA and DeviceB. DeviceA functions as the master device to forward service traffic, and DeviceB is the backup device. If DeviceA fails, DeviceB takes over to forward service traffic. Then, once DeviceA recovers, traffic switches back to DeviceA.</p>
<div class="fignone" id="EN-US_TASK_0000001130784044__fig_dc_vrp_vrrp_cfg_012101"><a name="EN-US_TASK_0000001130784044__fig_dc_vrp_vrrp_cfg_012101"></a><a name="fig_dc_vrp_vrrp_cfg_012101"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring VRRP in master/backup mode</span><div class="note" id="EN-US_TASK_0000001130784044__note661275718142"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001130784044__p151905481214023">In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span><span>1/0/1</span>, <span>100GE</span><span>1/0/2</span>, and <span>100GE</span><span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001130784044__image1278891722214023" src="figure/en-us_image_0000001176743733.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130784044__1.3.2"></a><a name="1.3.2"></a>
<div class="p" id="EN-US_TASK_0000001130784044__context1405250729214023"><h4 class="sectiontitle">Precautions</h4><p id="EN-US_TASK_0000001130784044__p1827187154214023">DeviceA's interface (<span>100GE</span><span>1/0/3</span>) and DeviceB's interface (<span>100GE</span><span>1/0/3</span>) must be on the same network segment.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130784044__1.3.3"></a><a name="1.3.3"></a>
<div class="p" id="EN-US_TASK_0000001130784044__context854996942214023"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0000001130784044__p1794605133214023">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0000001130784044__ol1686188434214023"><li id="EN-US_TASK_0000001130784044__li2038507214023">Assign an IP address to each interface on the devices and configure a routing protocol to ensure IP connectivity.</li><li id="EN-US_TASK_0000001130784044__li1585985029214023">Configure a VRRP group on DeviceA and DeviceB. Configure a higher priority for DeviceA to ensure it functions as the master and configure a lower priority for DeviceB to ensure it functions as the backup.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130784044__1.3.4"></a><a name="1.3.4"></a>
<div class="p" id="EN-US_TASK_0000001130784044__context16266202155218"><h4 class="sectiontitle">Procedure</h4><ol id="EN-US_TASK_0000001130784044__ol163845655218"><li id="EN-US_TASK_0000001130784044__li1264065635214">Assign an IP address to each interface on DeviceA, DeviceB, and DeviceC. Then, configure OSPF to ensure that the devices can communicate with one another. For details about DeviceD's configurations, see <a href="#EN-US_TASK_0000001130784044__section_dc_vrp_vrrp_cfg_012105">Configuration Scripts</a>.<div class="p" id="EN-US_TASK_0000001130784044__p1302164995316"># Configure DeviceA.<pre class="screen" id="EN-US_TASK_0000001130784044__screen141701813175413">&lt;<span class="keyword" id="EN-US_TASK_0000001130784044__keyword104237243544">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001130784044__b1242372419549">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword173112011412"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001130784044__keyword842342485412">HUAWEI</span>] <strong id="EN-US_TASK_0000001130784044__b1842362418549">sysname DeviceA</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword37362410388">*</span><span class="keyword" id="EN-US_TASK_0000001130784044__keyword609583901214023">HUAWEI</span>]<strong id="EN-US_TASK_0000001130784044__b54165603214023"> commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword66861422194112"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001130784044__b94248243543">interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword185581022121220"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784044__b3424122485418">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword3263357102519">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784044__b742442416549">ip address 10.1.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword127745618444">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784044__b134250249545">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword7228179164414">*</span>DeviceA] <strong id="EN-US_TASK_0000001130784044__b204251724185414">interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword617461124411">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784044__b1042532414548">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword1024591264415">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784044__b6426112418543">ip address 192.168.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword14279113104415">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784044__b342622455411">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword4317181424412">*</span>DeviceA] <strong id="EN-US_TASK_0000001130784044__b442619245544">ospf 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword5141815144418">*</span>DeviceA-ospf-1] <strong id="EN-US_TASK_0000001130784044__b18426192465419">area 0</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword123331816184413">*</span>DeviceA-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784044__b10426102455411">network 10.1.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword340519176447">*</span>DeviceA-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784044__b7426824205416">network 192.168.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword832619184441">*</span>DeviceA-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784044__b2426924165415">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword857611913448">*</span>DeviceA-ospf-1] <strong id="EN-US_TASK_0000001130784044__b134271824145419">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword189420291421">*</span>DeviceA] <strong id="EN-US_TASK_0000001130784044__b143751134194214">commit</strong></pre>
</div>
<p id="EN-US_TASK_0000001130784044__p1876894165616"># Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001130784044__screen476810416561">&lt;<span class="keyword" id="EN-US_TASK_0000001130784044__keyword17687465615">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001130784044__b1976810418568">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword750735694417"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001130784044__keyword13768942561">HUAWEI</span>] <strong id="EN-US_TASK_0000001130784044__b076816455616">sysname DeviceB</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword12352104914442">*</span><span class="keyword" id="EN-US_TASK_0000001130784044__keyword15352149114412">HUAWEI</span>]<strong id="EN-US_TASK_0000001130784044__b1435264944414"> commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword326175816441"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001130784044__b1676910465615">interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword630116018453"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784044__b1976911413569">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword14304132420447">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784044__b5769124155614">ip address 10.1.1.2 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword25361251447">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784044__b197700418568">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword99361926184419">*</span>DeviceB] <strong id="EN-US_TASK_0000001130784044__b1477010415614">interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword1089429114413">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784044__b477019418560">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword1715373014415">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784044__b177154145616">ip address 192.168.2.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword194342031114417">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784044__b1877144185616">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword2650734134410">*</span>DeviceB] <strong id="EN-US_TASK_0000001130784044__b14771144205620">ospf 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword10801173510444">*</span>DeviceB-ospf-1] <strong id="EN-US_TASK_0000001130784044__b877194165613">area 0</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword14970113664417">*</span>DeviceB-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784044__b1477184105617">network 10.1.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword1689133874413">*</span>DeviceB-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784044__b777117495610">network 192.168.2.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword3206539194414">*</span>DeviceB-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784044__b107718465616">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword10731114014419">*</span>DeviceB-ospf-1] <strong id="EN-US_TASK_0000001130784044__b47727413560">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword127106484310">*</span>DeviceB] <strong id="EN-US_TASK_0000001130784044__b18710184174314">commit</strong></pre>
<p id="EN-US_TASK_0000001130784044__p1177224145615"># Configure DeviceC.</p>
<pre class="screen" id="EN-US_TASK_0000001130784044__screen1277210412568">&lt;<span class="keyword" id="EN-US_TASK_0000001130784044__keyword1877218416569">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001130784044__b877254185612">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword181834134712"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001130784044__keyword1083173444718">HUAWEI</span>]<strong id="EN-US_TASK_0000001130784044__b178153418475"> sysname DeviceC</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword1812041212450">*</span><span class="keyword" id="EN-US_TASK_0000001130784044__keyword1612021219456">HUAWEI</span>]<strong id="EN-US_TASK_0000001130784044__b171204129450"> commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword12186827174518"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001130784044__b187721048567">interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword1131012315452"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784044__b9773194135619">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword17421887461">*</span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784044__b1277310445611">ip address 192.168.1.2 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword136408984617">*</span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784044__b47731443568">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword737611124615">*</span>DeviceC] <strong id="EN-US_TASK_0000001130784044__b177731547563">interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword204275144466">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784044__b477418475612">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword6186018104618">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784044__b117741449565">ip address 192.168.2.2 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword68515219469">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784044__b1377417414569">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword1930092214469">*</span>DeviceC] <strong id="EN-US_TASK_0000001130784044__b277412416564">interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword64391925124614">*</span>DeviceC-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784044__b19775042565">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword173162919469">*</span>DeviceC-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784044__b477516417565">ip address 172.16.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword14502133016469">*</span>DeviceC-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784044__b18776194125613">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword798723144613">*</span>DeviceC] <strong id="EN-US_TASK_0000001130784044__b187761448567">ospf 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword14968732114612">*</span>DeviceC-ospf-1] <strong id="EN-US_TASK_0000001130784044__b13776124195612">area 0</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword105573414462">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784044__b14776141565">network 192.168.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword31909350463">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784044__b377711417562">network 192.168.2.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword35354368462">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784044__b677711415618">network 172.16.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword9728103710465">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784044__b15777247565">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword171143396466">*</span>DeviceC-ospf-1] <strong id="EN-US_TASK_0000001130784044__b1077718425612">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword059511418430">*</span>DeviceC] <strong id="EN-US_TASK_0000001130784044__b14595201418431">commit</strong></pre>
</li><li id="EN-US_TASK_0000001130784044__li2361855185718">Configure a VRRP group on DeviceA and DeviceB.<p id="EN-US_TASK_0000001130784044__p596859217214023"><a name="EN-US_TASK_0000001130784044__li2361855185718"></a><a name="li2361855185718"></a># Create VRRP group 1 on DeviceA and configure a VRRP security policy. Configure a priority of 120 to ensure that DeviceA functions as the master device, and set the preemption delay to 20s.</p>
<pre class="screen" id="EN-US_TASK_0000001130784044__screen1088218248214023">[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword3958145814478"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong id="EN-US_TASK_0000001130784044__b1478479877214023"> interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword1076211104817"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784044__b1768170654214023">vrrp vrid 1 virtual-ip 10.1.1.111</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword1212818348429"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784044__b15494718296">vrrp vrid 1 authentication-mode md5 YsH_2022</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword0856444154619">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784044__b360717052214023">vrrp vrid 1 priority 120</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword148118458466">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784044__b76948959214023">vrrp vrid 1 preempt timer delay 20</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword215215478463">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784044__b891497662214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword81985034318">*</span>DeviceA] <strong id="EN-US_TASK_0000001130784044__b1719165010438">commit</strong></pre>
<p id="EN-US_TASK_0000001130784044__p1276215228214023"># Create VRRP group 1 on DeviceB, configure a VRRP security policy, and use the default priority (100) to ensure it functions as the backup.</p>
<pre class="screen" id="EN-US_TASK_0000001130784044__screen349918519397">[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword14499957391"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong id="EN-US_TASK_0000001130784044__b204999513391"> interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword549985203913"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/3</span>]<strong id="EN-US_TASK_0000001130784044__b144991659395"> vrrp vrid 1 virtual-ip 10.1.1.111</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword749919573916"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/3</span>]<strong id="EN-US_TASK_0000001130784044__b1149910520395"> vrrp vrid 1 authentication-mode md5 YsH_2022</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword16499752399">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>]<strong id="EN-US_TASK_0000001130784044__b15499758390"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword11499353395">*</span>DeviceB] <strong id="EN-US_TASK_0000001130784044__b64991056396">commit</strong></pre>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130784044__1.3.5"></a><a name="1.3.5"></a>
<div class="p" id="EN-US_TASK_0000001130784044__context33673101216"><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0000001130784044__p2565172414218"># Check the VRRP status on DeviceA and DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001130784044__screen94682021632">[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword129886155485"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001130784044__b34683210316">display vrrp verbose</strong>
<span>100GE</span><span>1/0/3</span> | Virtual Router 1
<strong id="EN-US_TASK_0000001130784044__b14689218319">State</strong>         : <strong id="EN-US_TASK_0000001130784044__b20468152531">Master</strong>
Virtual IP        : 10.1.1.111
Master IP         : 10.1.1.1
PriorityRun       : 120
PriorityConfig    : 120
MasterPriority    : 120
Preempt           : YES      Delay Time : 20s    Remain : --
Hold Multiplier   : 4
TimerRun          : 1s
TimerConfig       : 1s
Auth Type         : MD5      Auth Key : ******
Virtual MAC       : 00-e0-fc-12-78-90
Check TTL         : YES
Config Type       : <span>Normal</span>
Create Time       : 2020-12-29 05:41:23
Last Change Time  : 2020-12-29 05:41:33</pre>
<pre class="screen" id="EN-US_TASK_0000001130784044__screen9469528312">[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword850619228488"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001130784044__b44691727310">display vrrp verbose</strong>
<span>100GE</span><span>1/0/3</span> | Virtual Router 1
<strong id="EN-US_TASK_0000001130784044__b74704218316">State</strong>         : <strong id="EN-US_TASK_0000001130784044__b4470821138">Backup</strong>
Virtual IP        : 10.1.1.111
Master IP         : 10.1.1.1
PriorityRun       : 100
PriorityConfig    : 100
MasterPriority    : 120
Preempt           : YES      Delay Time : 0s    Remain : --
Hold Multiplier   : 4
TimerRun          : 1s
TimerConfig       : 1s
Auth Type         : MD5      Auth Key : ******
Virtual MAC       : 00-e0-fc-12-78-90
Check TTL         : YES
Config Type       : <span>Normal</span>
Create Time       : 2020-12-29 05:41:23
Last Change Time  : 2020-12-29 05:41:33</pre>
<p id="EN-US_TASK_0000001130784044__p92351081142">The command outputs show that DeviceA is in the Master state and DeviceB is in the Backup state.</p>
<p id="EN-US_TASK_0000001130784044__p347162233"># Check routing information on DeviceA and DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001130784044__screen19471162032">[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword192955275488"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001130784044__b1547112031">display ip routing-table</strong>
Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route
------------------------------------------------------------------------------
Routing Table : _public_
         Destinations : 14       Routes : 14        

Destination/Mask    Proto  Pre  Cost        Flags NextHop         Interface

       10.1.1.0/24  Direct 0    0             D  10.1.1.1        <span>100GE</span><span>1/0/3</span>
       10.1.1.1/32  Direct 0    0             D  127.0.0.1       <span>100GE</span><span>1/0/3</span>
<strong id="EN-US_TASK_0000001130784044__b54721121033">   10.1.1.111/32  Direct 0   0           D  127.0.0.1     <span>100GE</span><span>1/0/3</span></strong>
     10.1.1.255/32  Direct 0    0             D  127.0.0.1       <span>100GE</span><span>1/0/3</span>
     172.16.1.0/24  OSPF   10   2             D  192.168.1.2     <span>100GE</span><span>1/0/3</span>
      127.0.0.0/8   Direct 0    0             D  127.0.0.1       InLoopBack0
      127.0.0.1/32  Direct 0    0             D  127.0.0.1       InLoopBack0
127.255.255.255/32  Direct 0    0             D  127.0.0.1       InLoopBack0
    192.168.1.0/24  Direct 0    0             D  192.168.1.1     <span>100GE</span><span>1/0/1</span>
    192.168.1.1/32  Direct 0    0             D  127.0.0.1       <span>100GE</span><span>1/0/1</span>
    192.168.1.2/32  Direct 0    0             D  192.168.1.2     <span>100GE</span><span>1/0/1</span>
  192.168.1.255/32  Direct 0    0             D  127.0.0.1       <span>100GE</span><span>1/0/1</span>
    192.168.2.0/24  OSPF   10   2             D  10.1.1.2        <span>100GE</span><span>1/0/3</span>
255.255.255.255/32  Direct 0    0             D  127.0.0.1       InLoopBack0</pre>
<pre class="screen" id="EN-US_TASK_0000001130784044__screen144749220312">[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword1088417313485"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong id="EN-US_TASK_0000001130784044__b1247411214315"> display ip routing-table</strong>
Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route
------------------------------------------------------------------------------
Routing Table : _public_
         Destinations : 13       Routes : 13        

Destination/Mask    Proto  Pre  Cost        Flags NextHop         Interface

       10.1.1.0/24  Direct 0    0             D  10.1.1.2        <span>100GE</span><span>1/0/3</span>
       10.1.1.2/32  Direct 0    0             D  127.0.0.1       <span>100GE</span><span>1/0/3</span>
<strong id="EN-US_TASK_0000001130784044__b44751321236">   10.1.1.111/32  OSPF  10  2            D  10.1.1.1      <span>100GE</span><span>1/0/3</span></strong>
     10.1.1.255/32  Direct 0    0             D  127.0.0.1       <span>100GE</span><span>1/0/3</span>
     172.16.1.0/24  OSPF   10   2             D  192.168.2.2     <span>100GE</span><span>1/0/2</span>
      127.0.0.0/8   Direct 0    0             D  127.0.0.1       InLoopBack0
      127.0.0.1/32  Direct 0    0             D  127.0.0.1       InLoopBack0
127.255.255.255/32  Direct 0    0             D  127.0.0.1       InLoopBack0
    192.168.1.0/24  OSPF   10   2             D  10.1.1.1        <span>100GE</span><span>1/0/3</span>
    192.168.2.0/32  Direct 0    0             D  127.0.0.1       <span>100GE</span><span>1/0/2</span>
    192.168.2.1/32  Direct 0    0             D  192.168.2.1     <span>100GE</span><span>1/0/2</span>
    192.168.2.2/24  Direct 0    0             D  127.0.0.1       <span>100GE</span><span>1/0/2</span>
  192.168.2.255/32  Direct 0    0             D  127.0.0.1       <span>100GE</span><span>1/0/2</span>
255.255.255.255/32  Direct 0    0             D  127.0.0.1       InLoopBack0</pre>
<p id="EN-US_TASK_0000001130784044__p1560620484112">The command outputs show that a direct route to the virtual IP address of the VRRP group is available in DeviceA's routing table and an OSPF route to the virtual IP address of the VRRP group is available in DeviceB's routing table.</p>
<p id="EN-US_TASK_0000001130784044__p36235585128"># Verify that DeviceB becomes the master after DeviceA fails. Run the <strong id="EN-US_TASK_0000001130784044__b206651057635">shutdown</strong> command on DeviceA's <span>100GE</span><span>1/0/3</span> to simulate a fault on DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001130784044__screen1477228318">[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword445718372487"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001130784044__b7477121737">display vrrp verbose</strong>
<span>100GE</span><span>1/0/3</span> | Virtual Router 1
State             : <strong id="EN-US_TASK_0000001130784044__b94778216312">Initialize</strong>
Virtual IP        : 10.1.1.111
Master IP         : 0.0.0.0
PriorityRun       : 120
PriorityConfig    : 120
MasterPriority    : 0
Preempt           : YES      Delay Time : 20s    Remain : --
Hold Multiplier   : 4
TimerRun          : 1s
TimerConfig       : 1s
Auth Type         : MD5      Auth Key : ******
Virtual MAC       : 00-e0-fc-12-78-90
Check TTL         : YES
Config Type       : <span>Normal</span>
Create Time       : 2020-12-29 05:51:23
Last Change Time  : 2020-12-29 05:51:33</pre>
<pre class="screen" id="EN-US_TASK_0000001130784044__screen547819215319">[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword9410154174815"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001130784044__b1247810215310">display vrrp verbose</strong>
<span>100GE</span><span>1/0/3</span> | Virtual Router 1
State             : <strong id="EN-US_TASK_0000001130784044__b1479528318">Master</strong>
Virtual IP        : 10.1.1.111
Master IP         : 10.1.1.2
PriorityRun       : 100
PriorityConfig    : 100
MasterPriority    : 100
Preempt           : YES      Delay Time : 0s    Remain : --
Hold Multiplier   : 4
TimerRun          : 1s
TimerConfig       : 1s
Auth Type         : MD5      Auth Key : ******
Virtual MAC       : 00-e0-fc-12-78-90
Check TTL         : YES
Config Type       : <span>Normal</span>
Create Time       : 2020-12-29 05:51:23
Last Change Time  : 2020-12-29 05:51:33</pre>
<p id="EN-US_TASK_0000001130784044__p4207968145">The command outputs show that DeviceA is in the Initialize state and DeviceB is in the Master state.</p>
<p id="EN-US_TASK_0000001130784044__p752455018143"># Verify that DeviceA can preempt the master role after the fault is rectified. Run the <strong id="EN-US_TASK_0000001130784044__b44803216316">undo shutdown</strong> command on DeviceA's <span>100GE</span><span>1/0/3</span>. After the interface goes up, wait for 20 seconds or longer before you check the devices' status.</p>
<pre class="screen" id="EN-US_TASK_0000001130784044__screen194807210314">[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword1677084484816"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001130784044__b184801228320">display vrrp verbose</strong>
<span>100GE</span><span>1/0/3</span> | Virtual Router 1
State             : <strong id="EN-US_TASK_0000001130784044__b17365753081">Master</strong>
Virtual IP        : 10.1.1.111
Master IP         : 10.1.1.1
PriorityRun       : 120
PriorityConfig    : 120
MasterPriority    : 120
Preempt           : YES      Delay Time : 20s    Remain : --
Hold Multiplier   : 4
TimerRun          : 1s
TimerConfig       : 1s
Auth Type         : MD5      Auth Key : ******
Virtual MAC       : 00-e0-fc-12-78-90
Check TTL         : YES
Config Type       : <span>Normal</span>
Create Time       : 2020-12-29 05:56:23
Last Change Time  : 2020-12-29 05:56:33</pre>
<pre class="screen" id="EN-US_TASK_0000001130784044__screen13482621638">[<span class="keyword" id="EN-US_TASK_0000001130784044__keyword772744864814"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001130784044__b134822217315">display vrrp verbose</strong>
<span>100GE</span><span>1/0/3</span> | Virtual Router 1
State             : <strong id="EN-US_TASK_0000001130784044__b114821821319">Backup</strong>
Virtual IP        : 10.1.1.111
Master IP         : 10.1.1.1
PriorityRun       : 100
PriorityConfig    : 100
MasterPriority    : 120
Preempt           : YES      Delay Time : 0s    Remain : --
Hold Multiplier   : 4
TimerRun          : 1s
TimerConfig       : 1s
Auth Type         : MD5      Auth Key : ******
Virtual MAC       : 00-e0-fc-12-78-90
Check TTL         : YES
Config Type       : <span>Normal</span>
Create Time       : 2020-12-29 05:56:23
Last Change Time  : 2020-12-29 05:56:33</pre>
<p id="EN-US_TASK_0000001130784044__p724910351617">The command outputs show that DeviceA is in the Master state and DeviceB is in the Backup state.</p>
</div></div>
<div class="example" id="EN-US_TASK_0000001130784044__section_dc_vrp_vrrp_cfg_012105"><a name="EN-US_TASK_0000001130784044__section_dc_vrp_vrrp_cfg_012105"></a><a name="section_dc_vrp_vrrp_cfg_012105"></a><a name="EN-US_TASK_0000001130784044__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul id="EN-US_TASK_0000001130784044__ul1706317027214023"><li id="EN-US_TASK_0000001130784044__li1294080674214023"><p id="EN-US_TASK_0000001130784044__p2046994749214023"><a name="EN-US_TASK_0000001130784044__li1294080674214023"></a><a name="li1294080674214023"></a>DeviceA</p>
<pre class="screen" id="EN-US_TASK_0000001130784044__screen1824687155214023">#
 sysname DeviceA
#
interface <span>100GE</span><span>1/0/1</span>
<strong id="EN-US_TASK_0000001130784044__b062812374311"> </strong>undo portswitch
 ip address 192.168.1.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 10.1.1.1 255.255.255.0
 vrrp vrid 1 virtual-ip 10.1.1.111
 vrrp vrid 1 authentication-mode md5 YsH_2022
 vrrp vrid 1 priority 120
<span> vrrp vrid 1 preempt timer delay 20</span>
#
ospf 1
 area 0.0.0.0
  network 192.168.1.0 0.0.0.255
  network 10.1.1.0 0.0.0.255
#
return</pre>
</li><li id="EN-US_TASK_0000001130784044__li17816104354811">DeviceB<pre class="screen" id="EN-US_TASK_0000001130784044__screen208916968214023">#
sysname DeviceB
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.2.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 10.1.1.2 255.255.255.0
 vrrp vrid 1 virtual-ip 10.1.1.111
 vrrp vrid 1 authentication-mode md5 YsH_2022
#
ospf 1
 area 0.0.0.0
  network 192.168.2.0 0.0.0.255
  network 10.1.1.0 0.0.0.255
#
return</pre>
</li><li id="EN-US_TASK_0000001130784044__li13952103155011">DeviceC<pre class="screen" id="EN-US_TASK_0000001130784044__screen514235475214023">#
sysname DeviceC
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.1.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.2.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 172.16.1.1 255.255.255.0
#
ospf 1
 area 0.0.0.0
  network 192.168.1.0 0.0.0.255
  network 192.168.2.0 0.0.0.255
  network 172.16.1.0 0.0.0.255
#
return</pre>
</li><li id="EN-US_TASK_0000001130784044__li951180315214023"><p id="EN-US_TASK_0000001130784044__p619285937214023"><a name="EN-US_TASK_0000001130784044__li951180315214023"></a><a name="li951180315214023"></a>DeviceD</p>
<pre class="screen" id="EN-US_TASK_0000001130784044__screen2056726798214023">#
 sysname DeviceD
#
 vlan 10
#
interface <span>100GE</span><span>1/0/1</span>
 port default vlan 10
#
interface <span>100GE</span><span>1/0/2</span>
 port link-type access
 port default vlan 10
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_vrrp_cfg_0104.html">Configuring VRRP in Master/Backup or Load Balancing Mode
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_vrrp_cfg_0109.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_vrrp_cfg_0132.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>