
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="IPv6 Packet Format">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_ipv6_cfg_0003.html">
<meta name="DC.Relation" scheme="URI" content="vrp_ipv6_cfg_0004.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="IPv6 Basic">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv6 Basic">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="IPv6 Basic">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001130622162">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>IPv6 Packet Format</title>
</head>
<body><a name="EN-US_CONCEPT_0000001130622162"></a><a name="EN-US_CONCEPT_0000001130622162"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">IPv6 Packet Format</h1>
<div><p>An IPv6 packet consists of three parts: an IPv6 basic header, one or more IPv6 extension headers, and an upper-layer protocol data unit (PDU).</p>
<p>An upper-layer PDU is generally composed of the upper-layer protocol header and its payload. A payload is a datagram that follows an IPv6 basic header, including an IPv6 extension header. For example, a payload can be an ICMPv6, TCP6, or UDP6 message.</p>
<div class="section"><h4 class="sectiontitle">IPv6 Basic Header</h4><p>An IPv6 basic header has a fixed length of 40 bytes with eight fields. An IPv6 basic header, required in every IPv6 packet, provides basic packet forwarding information, which all devices parse on the forwarding path.</p>
<p><a href="#EN-US_CONCEPT_0000001130622162__fig91925186264">Figure 1</a> shows an IPv6 basic header.</p>
<div class="fignone" id="EN-US_CONCEPT_0000001130622162__fig91925186264"><a name="EN-US_CONCEPT_0000001130622162__fig91925186264"></a><a name="fig91925186264"></a><span class="figcap"><b>Figure 1 </b>IPv6 basic header</span><br><span><img class="vsd" src="figure/en-us_image_0000001130781962.png" width="NaN" height="NaN"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Fields in an IPv6 basic header</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="49.93%" id="mcps1.3.3.5.2.3.1.1" liSelected="liSelected"><p>Field</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="50.07%" id="mcps1.3.3.5.2.3.1.2" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="49.93%" headers="mcps1.3.3.5.2.3.1.1 "><p>Version</p>
</td>
<td class="cellrowborder" valign="top" width="50.07%" headers="mcps1.3.3.5.2.3.1.2 "><p>4 bits long. In IPv6, the value of this field is set to 6.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="49.93%" headers="mcps1.3.3.5.2.3.1.1 "><p>Traffic Class</p>
</td>
<td class="cellrowborder" valign="top" width="50.07%" headers="mcps1.3.3.5.2.3.1.2 "><p>8 bits long. This field indicates the class or priority of an IPv6 packet. It is similar to the ToS field in an IPv4 packet and mainly used in QoS control.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="49.93%" headers="mcps1.3.3.5.2.3.1.1 "><p>Flow Label</p>
</td>
<td class="cellrowborder" valign="top" width="50.07%" headers="mcps1.3.3.5.2.3.1.2 "><p>20 bits long. This field is added in IPv6 to differentiate real-time traffic. A flow label and source IPv6 address uniquely identify a data flow. Intermediate network devices can effectively differentiate data flows based on this field.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="49.93%" headers="mcps1.3.3.5.2.3.1.1 "><p>Payload Length</p>
</td>
<td class="cellrowborder" valign="top" width="50.07%" headers="mcps1.3.3.5.2.3.1.2 "><p>16 bits long. The payload refers to the extension header and upper-layer PDU that follow the IPv6 header. If the Payload Length exceeds its maximum value of 65535 bytes, the field is set to 0, and the Jumbo Payload option in the Hop-by-Hop Options header is used to express the actual payload length.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="49.93%" headers="mcps1.3.3.5.2.3.1.1 "><p>Next Header</p>
</td>
<td class="cellrowborder" valign="top" width="50.07%" headers="mcps1.3.3.5.2.3.1.2 "><p>8 bits long. This field identifies the type of the first extension header (if any) that follows the IPv6 basic header or the protocol type in the upper-layer PDU.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="49.93%" headers="mcps1.3.3.5.2.3.1.1 "><p>Hop Limit</p>
</td>
<td class="cellrowborder" valign="top" width="50.07%" headers="mcps1.3.3.5.2.3.1.2 "><p>8 bits long. This field is similar to the Time to Live field in an IPv4 packet, defining the maximum number of hops that an IPv6 packet can pass through. Each device that forwards the packet decrements the field value by 1. If the field value is reduced to 0, the packet is discarded.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="49.93%" headers="mcps1.3.3.5.2.3.1.1 "><p>Source Address</p>
</td>
<td class="cellrowborder" valign="top" width="50.07%" headers="mcps1.3.3.5.2.3.1.2 "><p>128 bits long. This field indicates the address of the packet originator.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="49.93%" headers="mcps1.3.3.5.2.3.1.1 "><p>Destination Address</p>
</td>
<td class="cellrowborder" valign="top" width="50.07%" headers="mcps1.3.3.5.2.3.1.2 "><p>128 bits long. This field indicates the address of the packet recipient.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>Unlike the IPv4 packet header, the IPv6 packet header does not carry IHL, Identification, Flags, Fragment Offset, Header Checksum, Options, or Padding fields, but it carries the Flow Label field. This facilitates IPv6 packet processing and improves processing efficiency. To support various options without changing the existing packet format, the Extension Header information field is added to the IPv6 packet header, improving flexibility. The following paragraphs describe IPv6 extension headers.</p>
</div>
<div class="section"><h4 class="sectiontitle">IPv6 Extension Header</h4><p>An IPv4 packet header has an optional field (Options), which includes Security, Timestamp, and Record Route options. The variable length of the Options field results in an IPv4 packet header length range of 20 bytes to 60 bytes. When devices forward IPv4 packets with the Options field, many resources are required; therefore in practice, these IPv4 packets are rarely used.</p>
<p>To improve packet processing efficiency, IPv6 uses extension headers to replace the Options field in the IPv4 header. An IPv6 packet may or may not carry extension headers, and they are placed between the IPv6 basic header and upper-layer PDU. When the sender of a packet requests the destination device or other devices to perform special handling, the sender adds one or more extension headers to the packet. Unlike IPv4, IPv6 has variable-length extension headers, which are not limited to 40 bytes, to facilitate further extension. To improve extension header processing efficiency and transport protocol performance, IPv6 requires that the extension header length be an integral multiple of 8 bytes.</p>
<p>When multiple extension headers are used, the Next Header field of an extension header indicates the type of the next header that follows. </p>
<p>The Next Header field in the IPv6 basic header indicates the first extension header type, and the Next Header field in the first extension header indicates the next (second) extension header type, and so on. The Next Header field of the final extension header indicates the upper-layer protocol type. <a href="#EN-US_CONCEPT_0000001130622162__fig1638611256326">Figure 2</a> shows an IPv6 extension header.</p>
<div class="fignone" id="EN-US_CONCEPT_0000001130622162__fig1638611256326"><a name="EN-US_CONCEPT_0000001130622162__fig1638611256326"></a><a name="fig1638611256326"></a><span class="figcap"><b>Figure 2 </b>IPv6 extension header</span><br><span><img class="vsd" src="figure/en-us_image_0000001130622178.png" width="NaN" height="NaN"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 2 </b>Fields in an IPv6 extension header</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="50%" id="mcps1.3.4.7.2.3.1.1" liSelected="liSelected"><p>Field</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="50%" id="mcps1.3.4.7.2.3.1.2" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.4.7.2.3.1.1 "><p>Next Header</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.4.7.2.3.1.2 "><p>8 bits long. This field is similar to the Next Header field in the IPv6 basic header, indicating the next extension header (if any) or upper-layer protocol type.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.4.7.2.3.1.1 "><p>Extension Header Len</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.4.7.2.3.1.2 "><p>8 bits long. This field indicates the extension header length excluding the Next Header field.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.4.7.2.3.1.1 "><p>Extension Head Data</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.4.7.2.3.1.2 "><p>Variable length. This field includes a series of options and the padding field.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>RFC defines six IPv6 extension headers: Hop-by-Hop Options header, Destination Options header, Routing header, Fragment header, Authentication header, and Encapsulating Security Payload header.</p>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 3 </b>IPv6 extension headers</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="21.45%" id="mcps1.3.4.9.2.4.1.1" liSelected="liSelected"><p>Header Type</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="20.630000000000003%" id="mcps1.3.4.9.2.4.1.2" liSelected="liSelected"><p>Next Header Field Value</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="57.92%" id="mcps1.3.4.9.2.4.1.3" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="21.45%" headers="mcps1.3.4.9.2.4.1.1 "><p>Hop-by-Hop Options header</p>
</td>
<td class="cellrowborder" valign="top" width="20.630000000000003%" headers="mcps1.3.4.9.2.4.1.2 "><p>0</p>
</td>
<td class="cellrowborder" valign="top" width="57.92%" headers="mcps1.3.4.9.2.4.1.3 "><p>This header carries information that every node must examine along the delivery path of a packet. It is used in the following applications:</p>
<ul><li><p>Jumbo payload (if the payload length exceeds 65535 bytes)</p>
</li><li><p>Device prompted to check this option before forwarding packets</p>
</li><li><p>Resource Reservation Protocol (RSVP)</p>
</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="21.45%" headers="mcps1.3.4.9.2.4.1.1 "><p>Destination Options header</p>
</td>
<td class="cellrowborder" valign="top" width="20.630000000000003%" headers="mcps1.3.4.9.2.4.1.2 "><p>60</p>
</td>
<td class="cellrowborder" valign="top" width="57.92%" headers="mcps1.3.4.9.2.4.1.3 "><p>This header carries information that only the destination node of a packet examines. Currently, this header is used in mobile IPv6.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="21.45%" headers="mcps1.3.4.9.2.4.1.1 "><p>Routing header</p>
</td>
<td class="cellrowborder" valign="top" width="20.630000000000003%" headers="mcps1.3.4.9.2.4.1.2 "><p>43</p>
</td>
<td class="cellrowborder" valign="top" width="57.92%" headers="mcps1.3.4.9.2.4.1.3 "><p>An IPv6 source node uses this header to specify the intermediate nodes that a packet must pass through on the way to its destination. This header is similar to the Loose Source and Record Route option in IPv4.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="21.45%" headers="mcps1.3.4.9.2.4.1.1 "><p>Fragment header</p>
</td>
<td class="cellrowborder" valign="top" width="20.630000000000003%" headers="mcps1.3.4.9.2.4.1.2 "><p>44</p>
</td>
<td class="cellrowborder" valign="top" width="57.92%" headers="mcps1.3.4.9.2.4.1.3 "><p>Like IPv4 packets, when the length of IPv6 packets to be forwarded exceeds the maximum transmission unit (MTU), the packets need to be fragmented. In IPv6, the Fragment header is used by an IPv6 source node to send a packet larger than the MTU.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="21.45%" headers="mcps1.3.4.9.2.4.1.1 "><p>Authentication header</p>
</td>
<td class="cellrowborder" valign="top" width="20.630000000000003%" headers="mcps1.3.4.9.2.4.1.2 "><p>51</p>
</td>
<td class="cellrowborder" valign="top" width="57.92%" headers="mcps1.3.4.9.2.4.1.3 "><p>IPsec uses this header to provide data origin authentication, data integrity check, and packet anti-replay functions. This header also protects some fields in the IPv6 basic header.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="21.45%" headers="mcps1.3.4.9.2.4.1.1 "><p>Encapsulating Security Payload header</p>
</td>
<td class="cellrowborder" valign="top" width="20.630000000000003%" headers="mcps1.3.4.9.2.4.1.2 "><p>50</p>
</td>
<td class="cellrowborder" valign="top" width="57.92%" headers="mcps1.3.4.9.2.4.1.3 "><p>This header provides the same functions as the Authentication header with the addition of IPv6 packet encryption.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Conventions for IPv6 extension headers</strong></p>
<p>When a single packet uses more than one extension header, the headers must be listed in the following order:</p>
<ul><li><p>IPv6 basic header</p>
</li><li><p>Hop-by-Hop Options header</p>
</li><li><p>Destination Options header</p>
</li><li><p>Routing header</p>
</li><li><p>Fragment header</p>
</li><li><p>Authentication header</p>
</li><li><p>Encapsulating Security Payload header</p>
</li><li><p>Destination Options header</p>
</li><li><p>Upper-layer header</p>
</li></ul>
<p>Intermediate devices do not need to examine or process all extension headers, but only those based on the Next Header field value in the IPv6 basic header.</p>
<p>Each extension header can only occur once in an IPv6 packet, except for the Destination Options header which may occur twice (once before a Routing header and once before the upper-layer header).</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_ipv6_cfg_0003.html">Understanding IPv6 Basic
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_ipv6_cfg_0004.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>