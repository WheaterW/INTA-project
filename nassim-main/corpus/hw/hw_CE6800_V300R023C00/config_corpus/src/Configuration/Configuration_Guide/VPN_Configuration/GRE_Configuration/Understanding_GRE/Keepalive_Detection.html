
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Keepalive Detection">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_gre_cfg_0002.html">
<meta name="DC.Relation" scheme="URI" content="vrp_gre_cfg_0003.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001176662371">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Keepalive Detection</title>
</head>
<body><a name="EN-US_CONCEPT_0000001176662371"></a><a name="EN-US_CONCEPT_0000001176662371"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Keepalive Detection</h1>
<div><div class="section"><h4 class="sectiontitle">Background</h4><p>The GRE protocol cannot detect the link status. As a result, if a remote interface becomes unreachable, the tunnel connection between the local and remote ends cannot be efficiently terminated. The local end continues to send data, which is then discarded by the remote end due to the unreachable tunnel. This leads to a data black hole.</p>
<p>To solve this problem, devices support the link status detection function, also known as the keepalive function, on GRE tunnels. The keepalive function detects whether a tunnel is in keepalive state, that is whether the remote end is reachable. Once the remote end is unreachable, the local device terminates the tunnel connection, preventing data black holes.</p>
</div>
<div class="section"><h4 class="sectiontitle">Implementation</h4><div class="p">After the keepalive function is enabled on the source end of a GRE tunnel, the source end periodically sends keepalive messages to the destination end. If the destination end is reachable, the source end receives a response message from the destination end. Otherwise, no response message is received. The keepalive detection process is as follows:<ol><li><p>After the keepalive function is enabled on the source end of a GRE tunnel, the source end creates a timer, periodically sends keepalive messages, and counts the number of failures to receive keepalive response messages. The unreachable counter increases by one each time a message is sent.</p>
</li><li><p>The destination end sends a response message to the source end each time it receives a keepalive message from the source end.</p>
</li><li><p>If the source end receives a response message before the number of sent keepalive messages reaches the <i><span class="varname">retry-times</span></i> value, the source end considers the destination end reachable and resets the number of sent keepalive messages. If the source does not receive any response message before the counter reaches the preset value, specifically, the retry times, the source considers the peer unreachable and resets the counter. Then, the source closes the tunnel connection.</p>
</li></ol>
</div>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The keepalive function takes effect on one end of a tunnel as long as it is configured on this end, regardless of whether it is configured on the other end. Once the destination end receives a keepalive message, it sends a response message to the source end, regardless of whether the keepalive function is configured on the destination end.</p>
</div></div>
</div>
<div class="section"><h4 class="sectiontitle">Benefits</h4><p>The keepalive function can detect the tunnel status and prevent data loss if the remote end becomes unreachable, ensuring reliable data transmission.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_gre_cfg_0002.html">Understanding GRE
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_gre_cfg_0003.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>