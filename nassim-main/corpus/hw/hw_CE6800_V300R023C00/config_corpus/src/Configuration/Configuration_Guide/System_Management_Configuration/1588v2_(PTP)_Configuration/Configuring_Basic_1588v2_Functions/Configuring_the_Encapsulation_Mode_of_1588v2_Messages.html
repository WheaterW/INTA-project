
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring the Encapsulation Mode of 1588v2 Messages">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_1588v2_cfg_0011.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_1588v2_cfg_0015.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_1588v2_cfg_0012.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="1588v2 (PTP)">
<meta name="featuretype" content="System Management">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="1588v2 (PTP)">
<meta name="featuretype" content="System Management">
<meta name="featurename" content="1588v2 (PTP)">
<meta name="featuretype" content="System Management">
<meta name="featuretype" content="System Management">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001512679782">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring the Encapsulation Mode of 1588v2 Messages</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001512679782"></a><a name="EN-US_TASK_0000001512679782"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring the Encapsulation Mode of 1588v2 Messages</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001512679782__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><div class="p">1588v2 messages can be encapsulated into Layer 2 or Layer 3 packets for transmission. Depending on the link type, 1588v2 messages can be transmitted in MAC or UDP encapsulation mode.<ul><li><p>MAC encapsulation</p>
<p>The MAC encapsulation mode is used when 1588v2 messages are transmitted over Layer 2 links, and the corresponding Ethernet type is 0x88F7.</p>
<div class="fignone"><span class="figcap"><b>Figure 1 </b>Untagged MAC-encapsulated messages</span><br><span><img class="vsd" src="figure/en-us_image_0000001563759313.png"></span></div>
<div class="fignone"><span class="figcap"><b>Figure 2 </b>Tagged MAC-encapsulated messages</span><br><span><img class="vsd" src="figure/en-us_image_0000001563878937.png"></span></div>
</li><li><p>UDP encapsulation</p>
<p>The UDP encapsulation mode is used when 1588v2 messages are transmitted over Layer 3 links, and the corresponding destination UDP port number is 319 (for non-Announce messages) or 320 (for Announce messages).</p>
<div class="fignone"><span class="figcap"><b>Figure 3 </b>Untagged UDP-encapsulated messages</span><br><span><img class="vsd" src="figure/en-us_image_0000001513158962.png"></span><br></div>
<div class="fignone"><span class="figcap"><b>Figure 4 </b>Tagged UDP-encapsulated messages</span><br><span><img class="vsd" src="figure/en-us_image_0000001563999225.png"></span></div>
</li></ul>
</div>
<p></p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0000001512679782__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure the MAC encapsulation mode.</span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the interface view.</span><p><pre class="screen"><strong>interface</strong><em> <i><span class="varname">interface-type</span></i> </em><em>interface-number</em></pre>
</p></li><li class="substepexpand"><span>Configure the interface to encapsulate 1588v2 messages in unicast MAC encapsulation mode and set the destination MAC address of 1588v2 messages.</span><p>
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="23.369999999999997%" id="mcps1.3.2.1.2.3.2.1.1.4.1.1" liSelected="liSelected"><p>MAC Encapsulation Mode</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="40.21%" id="mcps1.3.2.1.2.3.2.1.1.4.1.2" liSelected="liSelected"><p>Command</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="36.42%" id="mcps1.3.2.1.2.3.2.1.1.4.1.3" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="23.369999999999997%" headers="mcps1.3.2.1.2.3.2.1.1.4.1.1 "><p>Unicast MAC encapsulation</p>
</td>
<td class="cellrowborder" valign="top" width="40.21%" headers="mcps1.3.2.1.2.3.2.1.1.4.1.2 "><p><a href="cmdqueryname=ptp+mac-egress"><b><span class="cmdname">ptp mac-egress</span></b></a> <strong><span>destination-mac</span></strong> <i><span class="varname">destination-mac</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="36.42%" headers="mcps1.3.2.1.2.3.2.1.1.4.1.3 "><p>By default, no destination MAC address is configured for 1588v2 messages.</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>If an interface has been configured to encapsulate 1588v2 messages in UDP encapsulation mode, clear the existing encapsulation mode configuration on the interface before running this command to change the encapsulation mode.</p>
</div></div>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="23.369999999999997%" headers="mcps1.3.2.1.2.3.2.1.1.4.1.1 "><p>Multicast MAC encapsulation</p>
</td>
<td class="cellrowborder" valign="top" width="40.21%" headers="mcps1.3.2.1.2.3.2.1.1.4.1.2 "><p>-</p>
</td>
<td class="cellrowborder" valign="top" width="36.42%" headers="mcps1.3.2.1.2.3.2.1.1.4.1.3 "><p>In multicast MAC encapsulation scenarios, you do not need to run the <a href="cmdqueryname=ptp+mac-egress"><b><span class="cmdname">ptp mac-egress</span></b></a> <strong><span>destination-mac</span></strong> <i><span class="varname">destination-mac</span></i> command because 1588v2 messages use the default multicast destination MAC address defined in 1588v2.</p>
<p>When the delay measurement mechanism is Delay, the default multicast destination MAC address is 01-1B-19-00-00-00.</p>
</td>
</tr>
</tbody>
</table>
</div>
</p></li><li class="substepexpand"><span>(Optional) Configure a VLAN ID and 802.1p priority for sending MAC-encapsulated 1588v2 messages.</span><p><pre class="screen"><a href="cmdqueryname=ptp+mac-egress"><b><span class="cmdname">ptp mac-egress</span></b></a> <strong><span>vlan</span></strong> <i><span class="varname">vlan-id</span></i> [ <strong><span>priority</span></strong> <i><span class="varname">priority-value</span></i>]</pre>
<p>By default, no VLAN ID is configured and the 802.1p priority is 7.</p>
<p>1588v2 services require a higher <i><span class="varname">priority-value</span></i> value than other services. A high transmission priority minimizes the delay or congestion impact on clock signal recovery. Using the default highest priority value is recommended.</p>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001512679782__en-us_task_0228023023_screen14848162118611"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001512679782__en-us_task_0228023023_cmdname1784862115612">commit</span></b></a></pre>
</p></li></ol>
</li><li><span>Configure the UDP encapsulation mode.</span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the interface view.</span><p><pre class="screen"><strong>interface</strong><em> <i><span class="varname">interface-type</span></i> </em><em>interface-number</em></pre>
</p></li><li class="substepexpand"><span>Configure the interface to encapsulate 1588v2 messages in UDP encapsulation mode and set the source and destination IP addresses of 1588v2 messages.</span><p>
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="23.369999999999997%" id="mcps1.3.2.2.2.3.2.1.1.4.1.1" liSelected="liSelected"><p>UDP Encapsulation Mode</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="40.21%" id="mcps1.3.2.2.2.3.2.1.1.4.1.2" liSelected="liSelected"><p>Command</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="36.42%" id="mcps1.3.2.2.2.3.2.1.1.4.1.3" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="23.369999999999997%" headers="mcps1.3.2.2.2.3.2.1.1.4.1.1 "><p>Unicast UDP encapsulation</p>
</td>
<td class="cellrowborder" valign="top" width="40.21%" headers="mcps1.3.2.2.2.3.2.1.1.4.1.2 "><p><a href="cmdqueryname=ptp+udp-egress"><b><span class="cmdname">ptp udp-egress</span></b></a> <strong><span>source-ip</span></strong> <i><span class="varname">source-ip</span></i> <strong><span>destination-ip</span></strong> <i><span class="varname">destination-ip</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="36.42%" headers="mcps1.3.2.2.2.3.2.1.1.4.1.3 "><p>In unicast UDP encapsulation scenarios, the destination IP address of 1588v2 messages must be configured.</p>
<p>By default, the source and destination IP addresses of 1588v2 messages are not configured.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="23.369999999999997%" headers="mcps1.3.2.2.2.3.2.1.1.4.1.1 "><p>Multicast UDP encapsulation</p>
</td>
<td class="cellrowborder" valign="top" width="40.21%" headers="mcps1.3.2.2.2.3.2.1.1.4.1.2 "><p><a href="cmdqueryname=ptp+udp-egress"><b><span class="cmdname">ptp udp-egress</span></b></a> <strong><span>source-ip</span></strong> <i><span class="varname">source-ip</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="36.42%" headers="mcps1.3.2.2.2.3.2.1.1.4.1.3 "><p>In multicast UDP encapsulation scenarios, you do not need to specify the <strong><span>destination-ip</span></strong> <i><span class="varname">destination-ip</span></i> parameter because 1588v2 messages use the default multicast destination IP address defined in 1588v2.</p>
<p>When the delay measurement mechanism is Delay, the multicast destination IP address of 1588v2 messages encapsulated in multicast UDP mode is 224.0.1.129.</p>
</td>
</tr>
</tbody>
</table>
</div>
</p></li><li class="substepexpand"><span>(Optional) Configure the next-hop MAC address for the interface to send 1588v2 messages.</span><p><pre class="screen"><a href="cmdqueryname=ptp+udp-egress"><b><span class="cmdname">ptp udp-egress</span></b></a> <strong><span>destination-mac</span></strong> <i><span class="varname">destination-mac</span></i></pre>
<p>By default, the next-hop MAC address is not configured for an interface to send 1588v2 messages.</p>
</p></li><li class="substepexpand"><span>(Optional) Configure the DSCP priority for the interface to send UDP-encapsulated 1588v2 packets, and the VLAN ID and priority for the interface to send or receive UDP-encapsulated 1588v2 packets.</span><p><pre class="screen"><a href="cmdqueryname=ptp+udp-egress"><b><span class="cmdname">ptp udp-egress</span></b></a> <strong><span>source-ip</span></strong> <i><span class="varname">source-ip</span></i> [ <strong><span>dscp</span></strong> <i><span class="varname">dscp</span></i> ] <strong><span>vlan</span></strong> <i><span class="varname">vlan-id</span></i> [ <strong><span>priority</span></strong> <i><span class="varname">priority-value</span></i> ]</pre>
<p>By default, the DSCP priority for an interface to send UDP-encapsulated 1588v2 packets is 56, the VLAN ID for an interface to send or receive UDP-encapsulated 1588v2 packets is not configured, and the priority is 7.</p>
<p>1588v2 services require a higher <i><span class="varname">priority-value</span></i> value than other services. A high transmission priority minimizes the delay or congestion impact on clock signal recovery. Using the default highest priority value is recommended.</p>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001512679782__en-us_task_0228023023_screen14848162118611_1"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001512679782__en-us_task_0228023023_cmdname1784862115612_1">commit</span></b></a></pre>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_1588v2_cfg_0011.html">Configuring Basic 1588v2 Functions
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_1588v2_cfg_0015.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_1588v2_cfg_0012.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>