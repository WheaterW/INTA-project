
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Understanding VRRP in Master/Backup or Load Balancing Mode">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp_cfg_0104.html">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp_cfg_0131.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="High Availability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="High Availability">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="High Availability">
<meta name="featuretype" content="High Availability">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001176663823">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Understanding VRRP in Master/Backup or Load Balancing Mode</title>
</head>
<body><a name="EN-US_CONCEPT_0000001176663823"></a><a name="EN-US_CONCEPT_0000001176663823"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Understanding VRRP in Master/Backup or Load Balancing Mode</h1>
<div id="conbody_0000000001"><div class="section" id="EN-US_CONCEPT_0000001176663823__section_dc_vrp_vrrp_feature_012601"><h4 class="sectiontitle">VRRP in Master/Backup Mode</h4><p id="EN-US_CONCEPT_0000001176663823__p1139652013214008">VRRP usually works in master/backup mode, as shown in <a href="#EN-US_CONCEPT_0000001176663823__fig_dc_vrp_vrrp_feature_012602">Figure 1</a>. In this mode, a virtual router consists of one master device and multiple backup devices. Normally, DeviceA is the master device and forwards packets, whereas DeviceB and DeviceC are backup devices that monitor DeviceA's status. If DeviceA fails, either DeviceB or DeviceC is elected as the new master to take over the services from DeviceA.</p>
<div class="fignone" id="EN-US_CONCEPT_0000001176663823__fig_dc_vrp_vrrp_feature_012602"><a name="EN-US_CONCEPT_0000001176663823__fig_dc_vrp_vrrp_feature_012602"></a><a name="fig_dc_vrp_vrrp_feature_012602"></a><span class="figcap"><b>Figure 1 </b>VRRP in master/backup mode</span><br><span><img class="vsd" id="EN-US_CONCEPT_0000001176663823__image408249982214008" src="figure/en-us_image_0000001176663849.png"></span></div>
<p id="EN-US_CONCEPT_0000001176663823__p1378185065214008"><a href="#EN-US_CONCEPT_0000001176663823__fig_dc_vrp_vrrp_feature_012602">Figure 1</a> shows the implementation of VRRP in master/backup mode.</p>
<ul id="EN-US_CONCEPT_0000001176663823__ul1883724403214008"><li id="EN-US_CONCEPT_0000001176663823__li949029520214008">DeviceA is the master with delayed preemption configured. Its priority is set to 120.</li><li id="EN-US_CONCEPT_0000001176663823__li1175205602214008">DeviceB is a backup with immediate preemption configured. Its priority is set to 110.</li><li id="EN-US_CONCEPT_0000001176663823__li847132128214008">DeviceC is a backup with immediate preemption configured. The default priority 100 is used.</li></ul>
<ol id="EN-US_CONCEPT_0000001176663823__ol566489710214008"><li id="EN-US_CONCEPT_0000001176663823__li986261249214008"><p id="EN-US_CONCEPT_0000001176663823__p1814024397214008"><a name="EN-US_CONCEPT_0000001176663823__li986261249214008"></a><a name="li986261249214008"></a>When DeviceA works properly, user-to-network traffic travels along the path DeviceE -&gt; DeviceA -&gt; DeviceD. DeviceA sends VRRP Advertisement packets periodically to notify DeviceB and DeviceC of its status.</p>
</li><li id="EN-US_CONCEPT_0000001176663823__li1605546487214008"><p id="EN-US_CONCEPT_0000001176663823__p1287782454214008"><a name="EN-US_CONCEPT_0000001176663823__li1605546487214008"></a><a name="li1605546487214008"></a>If DeviceA fails, VRRP becomes unavailable on it. In this case, DeviceB assumes the master role because it has a higher priority than DeviceC, and DeviceC continues to remain as a backup device. User-to-network traffic then switches to the new path DeviceE -&gt; DeviceB -&gt; DeviceD.</p>
</li><li id="EN-US_CONCEPT_0000001176663823__li1045500344214008"><p id="EN-US_CONCEPT_0000001176663823__p1013081854214008"><a name="EN-US_CONCEPT_0000001176663823__li1045500344214008"></a><a name="li1045500344214008"></a>After DeviceA recovers, it enters the Backup state, with a priority of 120. After receiving a VRRP Advertisement packet from DeviceB (the current master), DeviceA finds that its priority is higher than DeviceB's. Therefore, DeviceA preempts the master role after the configured preemption delay elapses, and sends VRRP Advertisement and gratuitous ARP packets.</p>
<p id="EN-US_CONCEPT_0000001176663823__p2104838137214008">At this point, both DeviceA and DeviceB are in the Master state and send VRRP Advertisement packets. However, after receiving a VRRP Advertisement packet from DeviceA, DeviceB finds that the received priority is higher than the local priority. DeviceB then switches to the Backup state. User-to-network traffic then switches to the original path DeviceE -&gt; DeviceA -&gt; DeviceD.</p>
</li></ol>
</div>
<div class="section" id="EN-US_CONCEPT_0000001176663823__section_dc_vrp_vrrp_feature_012602"><h4 class="sectiontitle">VRRP in Load Balancing Mode</h4><p id="EN-US_CONCEPT_0000001176663823__p760412296214008">In load balancing mode, multiple VRRP groups work together to balance traffic, as shown in <a href="#EN-US_CONCEPT_0000001176663823__fig_dc_vrp_vrrp_feature_012603">Figure 2</a>. The implementation and packet negotiation mechanism of VRRP in load balancing mode are the same as those of VRRP in master/backup mode. Each VRRP group consists of one master device and multiple backup devices in either mode. The difference between the two modes is that in load balancing mode, two or more VRRP groups are configured, and the master device in each VRRP group may be different. In addition, the same VRRP device can be added to multiple VRRP groups and assigned different priorities in the groups.</p>
<p id="EN-US_CONCEPT_0000001176663823__p1882512015214008">VRRP load balancing is categorized into the following types:</p>
<div class="p" id="EN-US_CONCEPT_0000001176663823__p479122812505"><strong id="EN-US_CONCEPT_0000001176663823__b5208914195216">Multi-gateway load balancing</strong>: Multiple VRRP groups with virtual IP addresses are created and specified as gateways for different users to implement load balancing.<div class="fignone" id="EN-US_CONCEPT_0000001176663823__fig_dc_vrp_vrrp_feature_012603"><a name="EN-US_CONCEPT_0000001176663823__fig_dc_vrp_vrrp_feature_012603"></a><a name="fig_dc_vrp_vrrp_feature_012603"></a><span class="figcap"><b>Figure 2 </b>Network diagram of multi-gateway load balancing</span><br><span><img class="vsd" id="EN-US_CONCEPT_0000001176663823__image441597508214008" src="figure/en-us_image_0000001130624302.png"></span></div>
</div>
<div class="p" id="EN-US_CONCEPT_0000001176663823__p970349419214008">Two VRRP groups with the VRIDs of 1 and 2 are configured on the network shown in <a href="#EN-US_CONCEPT_0000001176663823__fig_dc_vrp_vrrp_feature_012603">Figure 2</a>.<ul id="EN-US_CONCEPT_0000001176663823__ul77722519214008"><li id="EN-US_CONCEPT_0000001176663823__li511477375214008">VRRP group 1: DeviceA is the master, and DeviceB is the backup.</li><li id="EN-US_CONCEPT_0000001176663823__li1737889368214008">VRRP group 2: DeviceB is the master, and DeviceA is the backup.</li></ul>
</div>
<p id="EN-US_CONCEPT_0000001176663823__p731853506214008">VRRP group 1 is specified as the gateway for some users, and VRRP group 2 is specified as the gateway for others. In this way, the VRRP groups can balance service traffic while also backing up each other.</p>
<p id="EN-US_CONCEPT_0000001176663823__p1540344295014"><strong id="EN-US_CONCEPT_0000001176663823__b3429142535">Single-gateway load balancing</strong>: A Load-Balance Redundancy Group (LBRG) with a virtual IP address is created, and VRRP groups (no virtual IP addresses need to be configured), are added to the LBRG. The LBRG is specified as the gateway for all users to implement load balancing.</p>
<p id="EN-US_CONCEPT_0000001176663823__p397542576214008">Single-gateway load balancing is an enhancement to multi-gateway load balancing. It simplifies user-side configurations and facilitates network maintenance and management by allowing different users to share the same gateway.</p>
<div class="fignone" id="EN-US_CONCEPT_0000001176663823__fig_dc_vrp_vrrp_feature_012604"><a name="EN-US_CONCEPT_0000001176663823__fig_dc_vrp_vrrp_feature_012604"></a><a name="fig_dc_vrp_vrrp_feature_012604"></a><span class="figcap"><b>Figure 3 </b>Single-gateway load balancing</span><br><span><img class="vsd" id="EN-US_CONCEPT_0000001176663823__image1968895005214008" src="figure/en-us_image_0000001130624300.png"></span></div>
<div class="p" id="EN-US_CONCEPT_0000001176663823__p94120427214008">Two VRRP groups with the VRIDs of 1 and 2 are configured on the network shown in <a href="#EN-US_CONCEPT_0000001176663823__fig_dc_vrp_vrrp_feature_012604">Figure 3</a>.<ul id="EN-US_CONCEPT_0000001176663823__ul558864104214008"><li id="EN-US_CONCEPT_0000001176663823__li242176940214008">VRRP group 1: an LBRG, in which DeviceA is the master, and DeviceB is the backup.</li><li id="EN-US_CONCEPT_0000001176663823__li425843073214008">VRRP group 2: an LBRG member group, in which DeviceB is the master, and DeviceA is the backup.</li></ul>
</div>
<p id="EN-US_CONCEPT_0000001176663823__p2011939631214008">VRRP group 1 serves as the gateway for all users. After receiving an ARP request packet from a user, VRRP group 1 encapsulates its own virtual MAC address or VRRP group 2's virtual MAC address into an ARP reply packet to implement load balancing.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_vrrp_cfg_0104.html">Configuring VRRP in Master/Backup or Load Balancing Mode
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_vrrp_cfg_0131.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>