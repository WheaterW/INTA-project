
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring BGP G-Shut">
<meta name="abstract" content="After EBGP and IBGP sessions between ASBRs and BGP devices are shut down during maintenance, the ASBRs and BGP devices are temporarily unreachable to each other during BGP convergence. To minimize traffic loss during session closure and re-establishment, you can configure the g-shut function to gracefully shut down one or more BGP sessions.">
<meta name="description" content="After EBGP and IBGP sessions between ASBRs and BGP devices are shut down during maintenance, the ASBRs and BGP devices are temporarily unreachable to each other during BGP convergence. To minimize traffic loss during session closure and re-establishment, you can configure the g-shut function to gracefully shut down one or more BGP sessions.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_0119.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_0121.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001289778578">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring BGP G-Shut</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001289778578"></a><a name="EN-US_TASK_0000001289778578"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring BGP G-Shut</h1>
<div class="taskbody"><p>After EBGP and IBGP sessions between ASBRs and BGP devices are shut down during maintenance, the ASBRs and BGP devices are temporarily unreachable to each other during BGP convergence. To minimize traffic loss during session closure and re-establishment, you can configure the g-shut function to gracefully shut down one or more BGP sessions.</p>
<div class="steps"><a name="EN-US_TASK_0000001289778578__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the BGP view.</span><p><pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></pre>
</p></li><li><span>Enable and activate BGP g-shut globally or for a specified peer as required.</span><p><ul><li>Enable and activate BGP g-shut globally.<ol type="a"><li>Enable g-shut globally.<pre class="screen"><a href="cmdqueryname=graceful-shutdown+all-peer"><b><span class="cmdname">graceful-shutdown all-peer</span></b></a></pre>
</li><li>Activate g-shut globally.<pre class="screen"><a href="cmdqueryname=graceful-shutdown+manual-activate"><b><span class="cmdname">graceful-shutdown manual-activate</span></b></a></pre>
</li></ol>
</li></ul>
</p><p><ul><li>Enable and activate BGP g-shut for a peer.<ol type="a"><li>Enable g-shut for a peer or peer group.<pre class="screen"><a href="cmdqueryname=peer+graceful-shutdown+local-preference+as-prepend"><b><span class="cmdname">peer </span></b></a>{ <i><span class="varname">peerIpv4Addr</span></i> | <i><span class="varname">peerIpv6Addr</span></i> | <i><span class="varname">groupName</span></i> } <strong><span>graceful-shutdown</span></strong> [ <strong><span>local-preference</span></strong> <i><span class="varname">local-preference-value</span></i> | <strong><span>as-prepend</span></strong> <i><span class="varname">as-prepend-value</span></i> ]</pre>
</li><li>Activate g-shut for a peer or peer group.<pre class="screen"><a href="cmdqueryname=peer+graceful-shutdown+manual-activate"><b><span class="cmdname">peer </span></b></a>{ <i><span class="varname">peerIpv4Addr</span></i> | <i><span class="varname">peerIpv6Addr</span></i> | <i><span class="varname">groupName</span></i> } <strong><span>graceful-shutdown</span></strong> <strong><span>manual-activate</span></strong></pre>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>To enable and activate g-shut for peers in the BGP-VPN instance view, BGP-VPN instance IPv4 address family view, or BGP-VPN instance IPv6 address family view, enter the corresponding view before performing this step.</p>
<p>If a peer group has been configured with g-shut but peer A in it does not need to inherit g-shut from the peer group, run the <a href="cmdqueryname=peer"><b><span class="cmdname">peer </span></b></a> { <i><span class="varname">peerIpv4Addr</span></i> | <i><span class="varname">peerIpv6Addr</span></i> } <strong><span>graceful-shutdown disable</span></strong> command. To prevent this peer from inheriting the g-shut activation status from the peer group, run the <a href="cmdqueryname=peer"><b><span class="cmdname">peer </span></b></a>{ <i><span class="varname">peerIpv4Addr</span></i> | <i><span class="varname">peerIpv6Addr</span></i> } <strong><span>graceful-shutdown manual-activate disable</span></strong> command.</p>
</div></div>
</li></ol>
</li></ul>
</p></li><li><span>(Optional) Configure the device to advertise the g-shut community attribute of the address family level.</span><p><pre class="screen"><a href="cmdqueryname=advertise-community-gshut+ibgp+ebgp"><b><span class="cmdname">advertise-community-gshut </span></b></a>{ <strong><span>ibgp</span></strong> | <strong><span>ebgp</span></strong> }</pre>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>To configure the device to advertise the g-shut community attribute in an address family view, enter the address family view before performing this step. Currently, the following address families are supported: BGP-IPv4 unicast address family view, BGP-IPv6 unicast address family view, BGP-EVPN address family view, BGP-VPN instance IPv4 address family view, and BGP-VPN instance IPv6 address family view.</p>
</div></div>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001289778578__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001289778578__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_bgp_cfg_0001.html">BGP Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_bgp_cfg_0119.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_bgp_cfg_0121.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>