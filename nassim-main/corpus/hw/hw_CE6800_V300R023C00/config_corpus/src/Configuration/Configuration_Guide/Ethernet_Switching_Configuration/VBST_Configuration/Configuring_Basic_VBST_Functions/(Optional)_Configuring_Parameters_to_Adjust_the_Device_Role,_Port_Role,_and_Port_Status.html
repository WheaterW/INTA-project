
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring Parameters to Adjust the Device Role, Port Role, and Port Status">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_vbst_cfg_0006.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_vbst_cfg_0008.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VBST">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VBST">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featurename" content="VBST">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001563888321">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring Parameters to Adjust the Device Role, Port Role, and Port Status</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001563888321"></a><a name="EN-US_TASK_0000001563888321"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring Parameters to Adjust the Device Role, Port Role, and Port Status</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001563888321__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>The message priority vector in BPDUs is related to the device priority, port priority, and path cost. Adjusting the settings for these parameters will affect spanning tree calculation, which involves the device role, port role, and port status in the spanning tree.</p>
<div class="p">As the logic center of a spanning tree, the root bridges can either be calculated automatically or specified manually. You can manually specify the root bridge and secondary root bridges or configure the device priorities to affect root bridge election. It is recommended that you manually specify the root bridge and secondary root bridges.<ul><li>On a network running a spanning tree protocol, configure a device with high performance and at a high network layer as the root bridge to ensure the stability of the Layer 2 network. Failing to do so may cause temporary service interruptions if deployment of new devices on the network triggers switchover of the root bridge.</li><li>Each spanning tree has only one root bridge that takes effect. When two or more devices are specified as root bridges for a spanning tree, the device with the smallest MAC address serves as the root bridge.</li><li>Multiple secondary root bridges can be specified for a spanning tree. If the root bridge fails or is powered off, the secondary root bridge with the smallest MAC address will serve as the new root bridge, unless a new root bridge is specified manually.</li><li>A device's roles in spanning trees are independent of one another. On an MSTP network, a device can function as the root bridge or a secondary root bridge in one or more spanning trees; however, it cannot function as both the root bridge and secondary root bridge in the same spanning tree.</li></ul>
</div>
<p>Path cost is an important metric in spanning tree calculation, and it can affect root port selection. On a non-root bridge, the port with the lowest path cost to the root bridge is selected as the root port. On a VBST network, different path costs can be set for the same port in different VLANs to enable traffic of different VLANs to be forwarded through different physical links. This implements load balancing of VLAN traffic.</p>
<p>The path cost calculation method determines the path cost value range. It is recommended that you set a small path cost value for ports with high link rates, and a large path cost value for ports with low link rates. This enables ports with low link rates to be elected as blocked ports through spanning tree calculation.</p>
<p>Port priority determines whether a port will be elected as a designated port. To block a port for loop prevention, set the port priority to a larger value than the default value, enabling the port to be elected as a blocked port.</p>
<p>In addition to the device priority, port priority, and path cost, other parameters can affect the VBST topology convergence. For details, see <a href="galaxy_vbst_cfg_0013.html">Configuring VBST Parameters That Affect VBST Convergence</a>.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><span>If the device has been configured as the root bridge or secondary root bridge in a specified VLAN using a command and you want to change the priority of the device in the VLAN, run the <a href="cmdqueryname=stp+vlan+root"><b><span class="cmdname">undo stp vlan root</span></b></a> command to cancel the root bridge or secondary root bridge configuration, and then run the <a href="cmdqueryname=stp+vlan+priority"><b><span class="cmdname">stp vlan priority</span></b></a> command to set a new priority for the device.</span></li><li>To prevent frequent network flapping, ensure that the Hello Time, Forward Delay, and Max Age timer values conform to the following formulas:<ul><li><p>2 x (Forward Delay â 1.0 second) â¥ Max Age</p>
</li><li><p>Max Age â¥ 2 x (Hello Time + 1.0 second)</p>
</li></ul>
</li></ul>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001563888321__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Set the device priority in a specified VLAN to adjust the device's role in the spanning tree. Perform any of the following operations as required.</span><p><ul><li>Configure the device as the root bridge in the specified VLAN.<pre class="screen"><a href="cmdqueryname=stp+vlan+root"><b><span class="cmdname">stp vlan</span></b></a> <i><span class="varname">vlan-id1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id2</span></i> ] [ <i><span class="varname">vlan-id3</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id4</span></i> ] ] &amp;&lt;1-9&gt; <strong><span>root primary</span></strong></pre>
<p>By default, a device does not function as the root bridge in any spanning tree. After the command is configured, the priority of the device will be 0 in this VLAN and cannot be changed.</p>
</li><li>Configure the device as a secondary root bridge in the specified VLAN.<pre class="screen"><a href="cmdqueryname=stp+vlan+root"><b><span class="cmdname">stp vlan</span></b></a> <i><span class="varname">vlan-id1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id2</span></i> ] [ <i><span class="varname">vlan-id3</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id4</span></i> ] ] &amp;&lt;1-9&gt; <strong><span>root secondary</span></strong></pre>
<p>By default, a device does not function as a secondary root bridge in any spanning tree. After the command is configured, the priority of the device will be 4096 in this VLAN and cannot be changed.</p>
</li><li>Set the device priority in the specified VLAN. A smaller value indicates a higher priority. A device with a higher priority is more likely to be elected as the root bridge.<pre class="screen"><a href="cmdqueryname=stp+vlan+priority"><b><span class="cmdname">stp vlan</span></b></a> <i><span class="varname">vlan-id1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id2</span></i> ] [ <i><span class="varname">vlan-id3</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id4</span></i> ] ] &amp;&lt;1-9&gt; <strong><span>priority</span></strong> <i><span class="varname">priority-value</span></i></pre>
<p>The default priority of a device in a spanning tree is 32768.</p>
<p><span>If the device has been configured as the root bridge or secondary root bridge in a specified VLAN using a command and you want to change the priority of the device in the VLAN, run the <a href="cmdqueryname=stp+vlan+root"><b><span class="cmdname">undo stp vlan root</span></b></a> command to cancel the root bridge or secondary root bridge configuration, and then run the <a href="cmdqueryname=stp+vlan+priority"><b><span class="cmdname">stp vlan priority</span></b></a> command to set a new priority for the device.</span></p>
</li></ul>
</p></li><li><span>(Optional) Configure the path cost calculation method.</span><p><pre class="screen"><a href="cmdqueryname=stp+pathcost-standard"><b><span class="cmdname">stp pathcost-standard</span></b></a> { <strong><span>dot1d-1998</span></strong> | <strong><span>dot1t</span></strong> | <strong><span>legacy</span></strong> }</pre>
<p>The default path cost calculation method is IEEE 802.1t (<strong><span>dot1t</span></strong>).</p>
<p>All devices on a network must use the same path cost calculation method.</p>
</p></li><li><span>Enter the interface view.</span><p><pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type interface-number</span></i></pre>
</p></li><li><span>Switch the interface working mode to Layer 2.</span><p><pre class="screen" id="EN-US_TASK_0000001563888321__en-us_task_0228023023_screen242613534459"><a href="cmdqueryname=portswitch"><b><span class="cmdname" id="EN-US_TASK_0000001563888321__en-us_task_0228023023_cmdname942715314511">portswitch</span></b></a></pre>
<p id="EN-US_TASK_0000001563888321__en-us_task_0228023023_p1175711105814">Determine whether to perform this step based on the current interface working mode.</p>
</p></li><li><span>Set a path cost value for the current port in the specified VLAN.</span><p><pre class="screen"><a href="cmdqueryname=stp+vlan+cost"><b><span class="cmdname">stp vlan</span></b></a> <i><span class="varname">vlan-id1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id2</span></i> ] [ <i><span class="varname">vlan-id3</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id4</span></i> ] ] &amp;&lt;1-9&gt; <strong><span>cost</span></strong> <i><span class="varname">cost</span></i></pre>
</p><p><ul><li>When the <strong><span>legacy</span></strong> calculation method is used, the <i><span class="varname">cost</span></i> value range is from 1 to 200000.</li><li>When the <strong><span>dot1d-1998</span></strong> calculation method is used, the <i><span class="varname">cost</span></i> value range is from 1 to 65535.</li><li>When the <strong><span>dot1t</span></strong> calculation method is used, the <i><span class="varname">cost</span></i> value range is from 1 to 200000000.</li></ul>
</p></li><li><span>Set the port priority in the specified VLAN.</span><p><pre class="screen"><a href="cmdqueryname=stp+vlan+port+priority"><b><span class="cmdname">stp vlan</span></b></a> <i><span class="varname">vlan-id1</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id2</span></i> ] [ <i><span class="varname">vlan-id3</span></i> [ <strong><span>to</span></strong> <i><span class="varname">vlan-id4</span></i> ] ] &amp;&lt;1-9&gt; <strong><span>port priority</span></strong> <i><span class="varname">priority-value</span></i></pre>
<p>The default priority of a device port is 128.</p>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001563888321__en-us_task_0228023023_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001563888321__en-us_task_0228023023_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_vbst_cfg_0006.html">Configuring Basic VBST Functions
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_vbst_cfg_0008.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>