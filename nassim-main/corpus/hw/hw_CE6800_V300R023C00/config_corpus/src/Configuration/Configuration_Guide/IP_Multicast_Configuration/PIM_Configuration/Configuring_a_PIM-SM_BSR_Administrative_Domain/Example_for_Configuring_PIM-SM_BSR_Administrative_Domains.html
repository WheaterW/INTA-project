
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring PIM-SM BSR Administrative Domains">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_pim_cfg_0023.html">
<meta name="DC.Relation" scheme="URI" content="vrp_pim_cfg_0028.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130783624">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring PIM-SM BSR Administrative Domains</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130783624"></a><a name="EN-US_TASK_0000001130783624"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring PIM-SM BSR Administrative Domains</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001130783624__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On a PIM-SM network that uses dynamic RP election, it is required that BSR administrative domains be configured to allow C-BSRs to serve multicast groups in a specified group address range.</p>
<p>On the ISP network shown in <a href="#EN-US_TASK_0000001130783624__fig_dc_vrp_multicast_cfg_003801">Figure 1</a>, multicast services are deployed. An IGP has been deployed on the network, unicast services are running properly, and the network has been connected to the Internet. It is required that configurations be performed to allow user hosts to receive VOD information in multicast mode.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1, interface2, and interface3 represent <span>100GE</span><span>1/0/1</span>, <span>100GE</span><span>1/0/2</span>, and <span>100GE</span><span>1/0/3</span>, respectively.</p>
</div></div>
<div class="fignone" id="EN-US_TASK_0000001130783624__fig_dc_vrp_multicast_cfg_003801"><a name="EN-US_TASK_0000001130783624__fig_dc_vrp_multicast_cfg_003801"></a><a name="fig_dc_vrp_multicast_cfg_003801"></a><span class="figcap"><b>Figure 1 </b>Networking diagram of configuring PIM-SM BSR administrative domains</span><br><span><img class="vsd" src="figure/en-us_image_0000001176743363.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130783624__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>Note the following during the configuration:</p>
<ul><li><p>Unicast routes on the network must be reachable because multicast routing depends on unicast routing.</p>
</li><li><p>Multicast routing must be enabled on all devices.</p>
</li><li><p>PIM-SM must be enabled on the interfaces that connect devices, the interfaces that directly connect devices to multicast sources, and the interfaces that directly connect devices to hosts.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130783624__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure IP addresses and a unicast routing protocol for interfaces on each device.</p>
</li><li><p>Enable multicast routing on all devices to be used to provide multicast services.</p>
</li><li><p>Enable PIM-SM on all interfaces of each multicast device.</p>
</li><li><p>Enable IGMP on the interfaces that directly connect devices to hosts.</p>
</li><li><p>Configure the BSR administrative domain function on all devices to be used to provide multicast services.</p>
</li><li><p>Configure dynamic RP election and C-BSRs in the BSR administrative domain corresponding to a specific multicast group.</p>
</li><li><p>Configure a multicast boundary on edge interfaces.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130783624__1.3.4"></a><a name="1.3.4"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Multicast group addresses: 239.1.0.0/16 and 239.2.0.0/16</p>
</li><li><p>Multicast source addresses: 192.168.1.2/24 and 192.168.7.2/24</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130783624__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each <span class="keyword">device</span> interface and configure a unicast routing protocol. For detailed configurations, see Configuration Scripts.</span></li><li><span>Enable the multicast function on all devices and PIM-SM on all the involved interfaces.</span><p><p># Enable the multicast function on all devices and PIM-SM on all the involved interfaces.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>multicast routing-enable</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100GE</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>]<strong> undo portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>pim sm</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100GE</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>pim sm</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100GE</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span>DeviceA-<strong><span>100GE</span> <span>1/0/3</span></strong>]<strong> undo portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>pim sm</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p>The configurations of DeviceB, DeviceC, and DeviceD are similar to the configuration of DeviceA, and are not mentioned here.</p>
</p></li><li><span>Enable IGMP on the interfaces connected to hosts. The configuration details are not mentioned here.</span></li><li><span>Configure the BSR administrative domain function on all devices to be used to provide multicast services.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>pim</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-pim] <strong>c-bsr admin-scope</strong>
[<span class="keyword">*</span>DeviceA-pim] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p>The configurations of DeviceB, DeviceC, and DeviceD are similar to the configuration of DeviceA, and are not mentioned here.</p>
</p></li><li><span>Configure dynamic RP election and C-BSRs in the BSR administrative domain corresponding to a specific multicast group.</span><p><p># Perform the following steps on one or more devices in the PIM-SM domain to configure dynamic RP election.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>pim</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-pim] <strong>c-bsr group 239.1.0.0 255.255.0.0</strong>
[<span class="keyword">*</span>DeviceA-pim] <strong>c-bsr LoopBack0</strong>
[<span class="keyword">*</span>DeviceA-pim] <strong>c-rp LoopBack0</strong>
[<span class="keyword">*</span>DeviceA-pim] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p>The configuration of DeviceB is similar to the configuration of DeviceA, and is not mentioned here.</p>
</p></li><li><span>Configure a multicast boundary on edge interfaces.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> interface <span>100GE</span> <span>1/0/2</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<strong><span>100GE</span> <span>1/0/2</span></strong>]<strong> undo portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>multicast boundary 239.1.0.0 16</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA-] <strong>commit</strong></pre>
<p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong> interface <span>100GE</span> <span>1/0/2</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<strong><span>100GE</span> <span>1/0/2</span></strong>]<strong> undo portswitch</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>multicast boundary 239.2.0.0 16</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001130783624__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Run the <strong>display pim bsr-info</strong> command to check BSR information on each device. For example, BSR information on DeviceA and DeviceB is as follows:</p>
<pre class="screen">&lt;DeviceA&gt; <strong>display pim bsr-info</strong>
VPN-Instance: public net
 Elected AdminScoped BSR Count: 1
 Elected BSR Address: 1.1.1.1
     Priority: 0
     Hash mask length: 30
     State: Elected
     Scope: 239.1.0.0/16
     Uptime: 01:03:41
     Next BSR message scheduled at: 00:00:21
     C-RP Count: 1
 Candidate AdminScoped BSR Count: 1
 Candidate BSR Address: 1.1.1.1
     Priority: 0
     Hash mask length: 30
     State: Elected
     Scope: 239.1.0.0/16
     Wait to be BSR: 0</pre>
<pre class="screen">&lt;DeviceB&gt; <strong>display pim bsr-info</strong>
VPN-Instance: public net
 Elected AdminScoped BSR Count: 1
 Elected BSR Address: 2.2.2.2
     Priority: 0
     Hash mask length: 30
     State: Elected
     Scope: 239.2.0.0/16
     Uptime: 00:44:34
     Next BSR message scheduled at: 00:00:27
     C-RP Count: 1
 Candidate AdminScoped BSR Count: 1
 Candidate BSR Address: 2.2.2.2
     Priority: 0
     Hash mask length: 30
     State: Elected
     Scope: 239.2.0.0/16
     Wait to be BSR: 0 </pre>
<p># Run the <strong>display pim rp-info</strong> command to check RP information on each device. The following example shows the RP information on DeviceA:</p>
<pre class="screen">&lt;DeviceA&gt; <strong>display pim rp-info</strong>
VPN-Instance: public net
 PIM-SM BSR RP Number:1
 Group/MaskLen: 239.1.0.0/16
     RP: 1.1.1.1 (local)
     Priority: 0
     Uptime: 01:05:04
     Expires: 00:02:28 </pre>
<p># Run the <strong>display pim routing-table</strong> command to view the PIM routing table on each device. Receiver1 requires the multicast data sent by the multicast source 192.168.1.2 to the multicast group 239.1.0.1, and Receiver2 requires the multicast data sent by the multicast source 192.168.7.2 to the multicast group 239.2.0.1. A command output example is as follows:</p>
<pre class="screen">&lt;DeviceC&gt;<strong> display pim routing-table</strong>
VPN-Instance: public net
 Total 1 (*, G) entry; 1 (S, G) entry

 (*, 239.1.0.1)
     RP: 1.1.1.1
     Protocol: pim-sm, Flag: WC
     UpTime: 00:00:03
     Upstream interface: <span>100GE</span><span>1/0/3</span>, Refresh time: 00:00:03
         Upstream neighbor: 192.168.3.1
         RPF prime neighbor: 192.168.3.1
     Downstream interface(s) information:
     Total number of downstreams: 1
        1: <span>100GE</span><span>1/0/4</span>
             Protocol: static, UpTime: 00:00:03, Expires: -

 (192.168.1.2, 239.1.0.1)
     RP: 1.1.1.1
     Protocol: pim-sm, Flag: SPT SG_RCVR
     UpTime: 00:04:10
     Upstream interface: <span>100GE</span><span>1/0/3</span>, Refresh time: 00:04:10
         Upstream neighbor: 192.168.3.1
         RPF prime neighbor: 192.168.3.1
     Downstream interface(s) information:
     Total number of downstreams: 1
        1: <span>100GE</span><span>1/0/4</span>
             Protocol: static, UpTime: 00:04:10, Expires: -</pre>
<pre class="screen">&lt;DeviceD&gt; <strong>display pim routing-table</strong>
VPN-Instance: public net
 Total 1 (*, G) entry; 1 (S, G) entry

 (*, 239.2.0.1)
     RP: 2.2.2.2
     Protocol: pim-sm, Flag: WC
     UpTime: 00:00:04
     Upstream interface: <span>100GE</span><span>1/0/3</span>, Refresh time: 00:00:04
         Upstream neighbor: 192.168.4.1
         RPF prime neighbor: 192.168.4.1
     Downstream interface(s) information:
     Total number of downstreams: 1
        1: <span>100GE</span><span>1/0/4</span>
             Protocol: static, UpTime: 00:00:04, Expires: -

 (192.168.7.2, 239.2.0.1)
     RP: 2.2.2.2
     Protocol: pim-sm, Flag: SPT SG_RCVR
     UpTime: 00:00:04
     Upstream interface: <span>100GE</span><span>1/0/3</span>, Refresh time: 00:00:04
         Upstream neighbor: 192.168.4.1
         RPF prime neighbor: 192.168.4.1
     Downstream interface(s) information:
     Total number of downstreams: 1
        1: <span>100GE</span><span>1/0/4</span>
             Protocol: static, UpTime: 00:00:04, Expires: -</pre>
<h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
multicast routing-enable
#
isis 1
 network-entity 10.0000.0000.0001.00  
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.1.1 255.255.255.0
 pim sm
 isis enable 1
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.2.1 255.255.255.0
 pim sm
 multicast boundary 239.1.0.0 16
 isis enable 1
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 192.168.3.1 255.255.255.0
 pim sm
 isis enable 1
#
interface LoopBack0
 ip address 1.1.1.1 255.255.255.255
 pim sm
 isis enable 1 
#
pim
 c-bsr admin-scope
 c-bsr group 239.1.0.0 255.255.0.0
 c-bsr LoopBack0
 c-rp LoopBack0
#
return</pre>
</li><li><p>DeviceB</p>
<pre class="screen">#
sysname DeviceB
#
multicast routing-enable  
#
isis 1
 network-entity 10.0000.0000.0002.00 
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.7.1 255.255.255.0
 pim sm
 isis enable 1 
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.2.2 255.255.255.0
 pim sm
 multicast boundary 239.2.0.0 16
 isis enable 1 
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 192.168.4.1 255.255.255.0
 pim sm
 isis enable 1
#
interface LoopBack1
 ip address 2.2.2.2 255.255.255.255
 pim sm
 isis enable 1
#
pim
 c-bsr admin-scope
 c-bsr group 239.2.0.0 255.255.0.0
 c-bsr LoopBack1
 c-rp LoopBack1
#
return</pre>
</li><li><p>DeviceC</p>
<pre class="screen">#
sysname DeviceC
#
multicast routing-enable
#
isis 1
 network-entity 10.0000.0000.0003.00  
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 192.168.3.2 255.255.255.0
 pim sm
 isis enable 1
#
interface <span>100GE</span><span>1/0/4</span>
 undo portswitch
 ip address 192.168.5.1 255.255.255.0
 pim sm
 igmp static-group 239.1.0.1 source 192.168.1.2
 isis enable 1     
#
pim
 c-bsr admin-scope
#
return </pre>
</li><li><p>DeviceD</p>
<pre class="screen">#
sysname DeviceD
#
multicast routing-enable
#
isis 1
 network-entity 10.0000.0000.0004.00 
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 192.168.4.2 255.255.255.0
 pim sm
 isis enable 1
#
interface <span>100GE</span><span>1/0/4</span>
 undo portswitch
 ip address 192.168.6.1 255.255.255.0
 pim sm
 igmp static-group 239.2.0.1 source 192.168.7.2
 isis enable 1        
#
pim
 c-bsr admin-scope
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_pim_cfg_0023.html">Configuring a PIM-SM BSR Administrative Domain
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_pim_cfg_0028.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>