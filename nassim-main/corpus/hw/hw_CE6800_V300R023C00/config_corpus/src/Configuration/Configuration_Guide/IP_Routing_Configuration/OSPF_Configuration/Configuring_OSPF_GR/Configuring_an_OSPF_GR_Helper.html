
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring an OSPF GR Helper">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0219.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176663021">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Configuring an OSPF GR Helper</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176663021"></a><a name="EN-US_TASK_0000001176663021"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring an OSPF GR Helper</h1>
<div class="taskbody"><div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001176663021__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before configuring an OSPF GR helper, you have completed the following task:</p>
<ul><li><p><a href="vrp_ospf_cfg_0010.html">Configure basic OSPF functions</a>.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176663021__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Graceful restart (GR) is a high availability (HA) technology used to ensure normal traffic forwarding and non-stop forwarding of key services during the restart of routing protocols. HA comprises of a comprehensive set of techniques, such as fault-tolerant redundancy, link protection, faulty node recovery, and traffic engineering. As a fault-tolerant redundancy technology, GR is widely used to ensure non-stop forwarding of key data during the active/standby switchover and system upgrade.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>GR involves two roles: GR restarter and GR helper. Currently, a device can only function as a GR helper.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176663021__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the OSPF view.</span><p><pre class="screen"><a href="cmdqueryname=ospf"><b><span class="cmdname">ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ]</pre>
<p>The <em id="EN-US_TASK_0000001176663021__en-us_task_0000001130623404_i145692117181812">process-id</em> parameter specifies the ID of a process, and the default value is 1.</p>
</p></li><li><span>Enable the opaque LSA capability.</span><p><pre class="screen"><a href="cmdqueryname=opaque-capability+enable"><b><span class="cmdname">opaque-capability enable</span></b></a></pre>
<p>OSPF supports OSPF GR by transmitting Type 9 LSAs (opaque LSAs). As such, before configuring OSPF GR, run the <a href="cmdqueryname=opaque-capability+enable"><b><span class="cmdname">opaque-capability enable</span></b></a> command to enable the opaque LSA capability.</p>
</p></li><li><span>Configure the device as a GR helper and specify a filtering policy so that the device functions as the GR helper only for the OSPF neighbors that match the filtering policy. Select either of the following filtering methods based on actual conditions:</span><p><ul><li>Based on an ACL<ol type="a"><li>Return to the system view.<pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</li><li>Create an ACL and enter the ACL view.<pre class="screen"><a href="cmdqueryname=acl"><b><span class="cmdname">acl</span></b></a> { <strong><span>name</span></strong> <i><span class="varname">basic-acl-name</span></i> { <strong><span>basic</span></strong> | [ <strong><span>number</span></strong> ] <i><span class="varname">basic-acl-number</span></i> } | [ <strong><span>number</span></strong> ] <i><span class="varname">basic-acl-number</span></i> }</pre>
</li><li>Configure an ACL rule.<pre class="screen"><span><a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> [ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>deny</span></strong> | <strong><span>permit</span></strong> } [ <strong><span>fragment-type</span></strong> <strong><span>fragment</span></strong> | <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong><span> | <i><span class="varname">src-netmask</span></i></span> } | <strong><span>any</span></strong> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>logging</span></strong> ] <sup>*</sup></span></pre>
<p>When the <a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> command is used to configure a filtering rule for a named ACL, only the configurations specified by <strong><span>source</span></strong> and <strong><span>time-range</span></strong> take effect.</p>
</li><li>Enter the OSPF view.<pre class="screen"><a href="cmdqueryname=ospf"><b><span class="cmdname">ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ]</pre>
</li><li>Implement filtering based on the ACL.<pre class="screen"><a href="cmdqueryname=graceful-restart"><b><span class="cmdname">graceful-restart</span></b></a> [ <strong><span>helper-role</span></strong> { { <strong><span>acl-number</span></strong> <i><span class="varname">acl-number</span></i> | <strong><span>acl-name</span></strong> <i><span class="varname">acl-name</span></i> } <sup>*</sup> | <strong><span>never</span></strong> } ]</pre>
</li></ol>
</li><li>Based on an IP prefix list<pre class="screen"><a href="cmdqueryname=graceful-restart"><b><span class="cmdname">graceful-restart</span></b></a> [ <strong><span>helper-role</span></strong> { { <strong><span>ip-prefix </span></strong> <i><span class="varname">ip-prefix-name</span></i> <sup>*</sup> } | <strong><span>never</span></strong> } ]</pre>
</li></ul>
</p></li><li><span>(Optional) Disable the device from checking AS external LSAs when it functions as a GR helper.</span><p><pre class="screen"><a href="cmdqueryname=graceful-restart"><b><span class="cmdname">graceful-restart</span></b></a> <strong><span>helper-role</span></strong> <strong><span>ignore-external-lsa</span></strong></pre>
<p>By default, a GR helper checks AS external LSAs.</p>
</p></li><li><span>(Optional) Configure the device to support only planned GR when it functions as a GR helper.</span><p><pre class="screen"><a href="cmdqueryname=graceful-restart"><b><span class="cmdname">graceful-restart</span></b></a> <strong><span>helper-role</span></strong> <strong><span>planned-only</span></strong></pre>
<p>By default, a GR helper supports both planned GR and unplanned GR.</p>
</p></li><li><span>(Optional) Enable the non-IETF mode.</span><p><pre class="screen"><a href="cmdqueryname=graceful-restart"><b><span class="cmdname">graceful-restart</span></b></a> <strong><span>non-ietf</span></strong></pre>
<p>By default, the device uses the IETF standard mode. When the neighbor restarter uses the non-IETF mode, the non-IETF mode must also be enabled on the local device. As the IETF mode and non-IETF mode are mutually exclusive, only one of them can be enabled on a device.</p>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001176663021__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001176663021__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0000001176663021__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+ospf+graceful-restart"><b><span class="cmdname">display ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ] <strong><span>graceful-restart</span></strong> [ <strong><span>verbose</span></strong> ] command to check the OSPF GR configuration.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_ospf_cfg_0219.html">Configuring OSPF GR
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
</div>
</div>
</body>
</html>