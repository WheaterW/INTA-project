
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Mutual Access Between Local IPv4 L3VPNs">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_L3VPNv4_cfg_1111.html">
<meta name="DC.Relation" scheme="URI" content="vrp_L3VPNv4_cfg_0009.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="IPv4 L3VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv4 L3VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="IPv4 L3VPN">
<meta name="featuretype" content="VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130621702">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Mutual Access Between Local IPv4 L3VPNs</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130621702"></a><a name="EN-US_TASK_0000001130621702"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Mutual Access Between Local IPv4 L3VPNs</h1>
<div class="taskbody" id="taskbody104480819214049"><div class="context"><a name="EN-US_TASK_0000001130621702__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001130621702__context1306969455214049"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001130621702__p1197817277212">As shown in <a href="#EN-US_TASK_0000001130621702__fig_dc_vrp_gre_cfg_203101">Figure 1</a>, CE1 and CE2 are connected to PE1. CE1 belongs to <strong id="EN-US_TASK_0000001130621702__b149441617184214">vpna</strong>, and CE2 belongs to <strong id="EN-US_TASK_0000001130621702__b76992119423">vpnb</strong>. It is required that Site 1 and Site 2 communicate with each other. To meet this requirement, configure mutual access between local VPNs.</p>
<div class="fignone" id="EN-US_TASK_0000001130621702__fig_dc_vrp_gre_cfg_203101"><a name="EN-US_TASK_0000001130621702__fig_dc_vrp_gre_cfg_203101"></a><a name="fig_dc_vrp_gre_cfg_203101"></a><span class="figcap"><b>Figure 1 </b>Mutual access between local IPv4 VPNs</span><div class="note" id="EN-US_TASK_0000001130621702__note1314981642214049"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001130621702__p1142245817214049">In this example, interface 1 and interface 2 represent <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/7</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001130621702__image179029596214049" src="figure/en-us_image_0000001176741247.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130621702__1.3.2"></a><a name="1.3.2"></a>
<div class="p" id="EN-US_TASK_0000001130621702__context1703579524214049"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0000001130621702__p20954165318816">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0000001130621702__ol139545538819"><li id="EN-US_TASK_0000001130621702__li179548531284">Configure VPN instances on PE1 and different VPN targets for the instances to isolate VPNs.</li><li id="EN-US_TASK_0000001130621702__li49541453683">On PE1, bind the interfaces connected to CEs to the VPN instances to provide access for VPN users.</li><li id="EN-US_TASK_0000001130621702__li5954353980">Import direct routes destined for local CEs into the VPN routing tables on PE1. On each CE connected to PE1, configure a static route to the other local CE so that both CEs can communicate with each other.</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130621702__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001130621702__steps794967251214049"><li id="EN-US_TASK_0000001130621702__step15261772611"><span id="EN-US_TASK_0000001130621702__cmd72917172616">Configure VPN instances on PE1 and bind PE1 interfaces connected to CEs to the corresponding VPN instances.</span><p><p id="EN-US_TASK_0000001130621702__p6301226202710"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0000001130621702__screen76583347275">&lt;HUAWEI&gt; <strong id="EN-US_TASK_0000001130621702__b0643133817325">system-view</strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword12643113818329"><font style="font-size:8pt" Face="Courier New" >~</font></span>HUAWEI] <strong id="EN-US_TASK_0000001130621702__b4643638203212">sysname PE1</strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword1164311386325">*</span>HUAWEI] <strong id="EN-US_TASK_0000001130621702__b664303816324">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword79861615560"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0000001130621702__b4713919322">ip vpn-instance vpna</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword16624659367">*</span></span>PE1-vpn-instance-vpna] <strong id="EN-US_TASK_0000001130621702__b44651959113110">ipv4-family</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword16161191078">*</span></span>PE1-vpn-instance-vpna-af-ipv4] <strong id="EN-US_TASK_0000001130621702__b42581535103114">route-distinguisher 100:1</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword152710101970">*</span></span>PE1-vpn-instance-vpna-af-ipv4] <strong id="EN-US_TASK_0000001130621702__b11177123343118">vpn-target 111:1 export-extcommunity</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword123281121173">*</span></span>PE1-vpn-instance-vpna-af-ipv4] <strong id="EN-US_TASK_0000001130621702__b10536163013113">vpn-target 111:1 222:2 import-extcommunity </strong>
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword1472142212714">*</span></span>PE1-vpn-instance-vpna-af-ipv4] <strong id="EN-US_TASK_0000001130621702__b14258153753111">quit</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword116631023175">*</span></span>PE1-vpn-instance-vpna] <strong id="EN-US_TASK_0000001130621702__b163213398312">quit</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword2574202419715">*</span></span>PE1] <strong id="EN-US_TASK_0000001130621702__b396324016315">ip vpn-instance vpnb</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword75997251874">*</span></span>PE1-vpn-instance-vpnb] <strong id="EN-US_TASK_0000001130621702__b18131174373114">ipv4-family</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword185701926273">*</span></span>PE1-vpn-instance-vpnb-af-ipv4] <strong id="EN-US_TASK_0000001130621702__b1575314456319">route-distinguisher 100:2</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword4689132716716">*</span></span>PE1-vpn-instance-vpnb-af-ipv4] <strong id="EN-US_TASK_0000001130621702__b582611272317">vpn-target 222:2 export-extcommunity</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword10573142819717">*</span></span>PE1-vpn-instance-vpnb-af-ipv4] <strong id="EN-US_TASK_0000001130621702__b116267252318">vpn-target 222:2 111:1 import-extcommunity</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword18533122910719">*</span></span>PE1-vpn-instance-vpnb-af-ipv4] <strong id="EN-US_TASK_0000001130621702__b0111148133113">quit</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword105816321379">*</span></span>PE1-vpn-instance-vpnb] <strong id="EN-US_TASK_0000001130621702__b28086492317">quit</strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword1656444132713">*</span>PE1] <strong id="EN-US_TASK_0000001130621702__b185634422712">interface <span>100ge</span> <span>1/0/1</span></strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword485816183113">*</span></span>PE1-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130621702__b592441754520">undo </strong><strong id="EN-US_TASK_0000001130621702__b1092461754512">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword115694412711">*</span>PE1-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130621702__b1390894910272">ip binding vpn-instance vpna</strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword185694419278">*</span>PE1-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130621702__b41219583276">ip address 10.1.1.2 24</strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword356194413273">*</span>PE1-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130621702__b205674492710">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword236231632818">*</span>PE1] <strong id="EN-US_TASK_0000001130621702__b2362141692811">interface <span>100ge</span> <span>1/0/7</span></strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword12377172611118">*</span>PE1-<span>100GE</span><span>1/0/7</span>] <strong id="EN-US_TASK_0000001130621702__b8607786474">undo </strong><strong id="EN-US_TASK_0000001130621702__b8607389477">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword6362916182814">*</span>PE1-<span>100GE</span><span>1/0/7</span>] <strong id="EN-US_TASK_0000001130621702__b2980192232820">ip binding vpn-instance vpnb</strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword14362101618289">*</span>PE1-<span>100GE</span><span>1/0/7</span>] <strong id="EN-US_TASK_0000001130621702__b104441628132818">ip address 10.2.1.2 24</strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword741436192819">*</span>PE1-<span>100GE</span><span>1/0/7</span>] <strong id="EN-US_TASK_0000001130621702__b5453101603114">quit</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword6563114212719">*</span></span>PE1] <strong id="EN-US_TASK_0000001130621702__b1743381411313">commit</strong></pre>
<p id="EN-US_TASK_0000001130621702__p189071826192916"># Configure an IP address for a related interface on CE1.</p>
<pre class="screen" id="EN-US_TASK_0000001130621702__screen2907192616298">&lt;HUAWEI&gt; <strong id="EN-US_TASK_0000001130621702__b11766105583216">system-view</strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword1766155513210"><font style="font-size:8pt" Face="Courier New" >~</font></span>HUAWEI] <strong id="EN-US_TASK_0000001130621702__b97661555329">sysname CE1</strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword77661255203214">*</span>HUAWEI] <strong id="EN-US_TASK_0000001130621702__b1676615553218">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword15726143018303"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong id="EN-US_TASK_0000001130621702__b10908826202911">interface <span>100ge</span> <span>1/0/1</span></strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword6797183512114"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130621702__b1747261324714">undo </strong><strong id="EN-US_TASK_0000001130621702__b1472613124718">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword99081926112915">*</span>CE1-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130621702__b1872818379296">ip address 10.1.1.1 24</strong>  
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword14908926102918">*</span>CE1-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130621702__b19081726162919">commit</strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword1908182632915"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130621702__b790812266292">quit</strong></pre>
<p id="EN-US_TASK_0000001130621702__p590882615296"># Configure an IP address for the related interface on CE2.</p>
<pre class="screen" id="EN-US_TASK_0000001130621702__screen209081926192918">&lt;HUAWEI&gt; <strong id="EN-US_TASK_0000001130621702__b4277764335">system-view</strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword1127714614330"><font style="font-size:8pt" Face="Courier New" >~</font></span>HUAWEI] <strong id="EN-US_TASK_0000001130621702__b102776663320">sysname CE2</strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword1227718663319">*</span>HUAWEI] <strong id="EN-US_TASK_0000001130621702__b1327713613339">commit </strong>
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword1909112615292"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2] <strong id="EN-US_TASK_0000001130621702__b1590917269291">interface <span>100ge</span> <span>1/0/1</span></strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword13122049171116"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130621702__b392119304509">undo </strong><strong id="EN-US_TASK_0000001130621702__b4921203065015">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword19090268299">*</span>CE2-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130621702__b26387419307">ip address 10.2.1.1 24</strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword1690992662916">*</span>CE2-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130621702__b1990913267298">commit</strong> 
[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword7909192616296"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130621702__b17909202616297">quit</strong></pre>
<p id="EN-US_TASK_0000001130621702__p4638185024012">The PE can ping its connected CE. The following uses the ping between PE1 and CE1 as an example.</p>
<pre class="screen" id="EN-US_TASK_0000001130621702__screen11261163411406">[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword96032311167"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0000001130621702__b8206105112317">ping -vpn-instance vpna 10.1.1.1</strong>
  PING 10.1.1.1: 56  data bytes, press CTRL_C to break         
    Reply from 10.1.1.1: bytes=56 Sequence=1 ttl=255 time=2 ms 
    Reply from 10.1.1.1: bytes=56 Sequence=2 ttl=255 time=2 ms 
    Reply from 10.1.1.1: bytes=56 Sequence=3 ttl=255 time=2 ms 
    Reply from 10.1.1.1: bytes=56 Sequence=4 ttl=255 time=2 ms 
    Reply from 10.1.1.1: bytes=56 Sequence=5 ttl=255 time=2 ms 

  --- 10.1.1.1 ping statistics ---                             
    5 packet(s) transmitted                                    
    5 packet(s) received                                       
    0.00% packet loss                                          
    round-trip min/avg/max = 2/2/2 ms</pre>
</p></li><li id="EN-US_TASK_0000001130621702__step1879500800214049"><span id="EN-US_TASK_0000001130621702__cmd1432981877214049">Configure BGP and import the local direct routes destined for CEs to the VPN routing table on PE1.</span><p><p id="EN-US_TASK_0000001130621702__p1997078144214049"># Configure PE1.</p>
<pre class="screen" id="EN-US_TASK_0000001130621702__screen76591633113510">[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword1112103410616"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0000001130621702__b97333763915">bgp 100</strong>  
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword1962215511278">*</span></span>PE1-bgp] <strong id="EN-US_TASK_0000001130621702__b65201443133914">ipv4-family vpn-instance vpna</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword356645212713">*</span></span>PE1-bgp-vpna] <strong id="EN-US_TASK_0000001130621702__b1759144514396">import-route direct</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword1770517531373">*</span></span>PE1-bgp-vpna] <strong id="EN-US_TASK_0000001130621702__b137833468396">quit</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword198640541478">*</span></span>PE1-bgp] <strong id="EN-US_TASK_0000001130621702__b443324810397">ipv4-family vpn-instance vpnb</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword120925814714">*</span></span>PE1-bgp-vpnb] <strong id="EN-US_TASK_0000001130621702__b1328805019397">import-route direct</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword2494596712">*</span></span>PE1-bgp-vpnb] <strong id="EN-US_TASK_0000001130621702__b174144519397">quit</strong> 
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword12386409814">*</span></span>PE1-bgp] <strong id="EN-US_TASK_0000001130621702__b0891175273916">quit </strong>
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword3633218815">*</span></span>PE1] <strong id="EN-US_TASK_0000001130621702__b8168954113916">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001130621702__step256525016214049"><span id="EN-US_TASK_0000001130621702__cmd1416264383214049">Configure a static route on each CE.</span><p><p id="EN-US_TASK_0000001130621702__p1117662984114"># Configure CE1.</p>
<pre class="screen" id="EN-US_TASK_0000001130621702__screen166231337104112">[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword181481337764"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong id="EN-US_TASK_0000001130621702__b373618710460">ip route-static 10.2.1.0 24 10.1.1.2</strong>
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword12656128111010">*</span></span>CE1] <strong id="EN-US_TASK_0000001130621702__b188938444617">commit</strong></pre>
<p id="EN-US_TASK_0000001130621702__p13176132934112"># Configure CE2.</p>
<pre class="screen" id="EN-US_TASK_0000001130621702__screen10374154118411">[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword796018385618"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE2] <strong id="EN-US_TASK_0000001130621702__b106641317463">ip route-static 10.1.1.0 24 10.2.1.2</strong>
[<span><span class="keyword" id="EN-US_TASK_0000001130621702__keyword10327630111018">*</span></span>CE2] <strong id="EN-US_TASK_0000001130621702__b630919394619">commit</strong></pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001130621702__example416316515914"><a name="EN-US_TASK_0000001130621702__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0000001130621702__p6369233194214">After the configuration is complete, run the <a href="cmdqueryname=display+ip+routing-table+vpn-instance"><b><span class="cmdname" id="EN-US_TASK_0000001130621702__cmdname1947173164317">display ip routing-table vpn-instance</span></b></a> command on PE1. The VPNs have imported routes of each other. The following uses <strong id="EN-US_TASK_0000001130621702__b2648181225413">vpna</strong> as an example.</p>
<pre class="screen" id="EN-US_TASK_0000001130621702__screen11591195494213">[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword132649374103"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong id="EN-US_TASK_0000001130621702__b1537287114316">display ip routing-table vpn-instance vpna</strong>
Proto: Protocol        Pre: Preference
Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route    
------------------------------------------------------------------------------   
Routing Table : vpna          
         Destinations : 7        Routes : 7                                      

Destination/Mask    Proto   Pre  Cost        Flags NextHop         Interface     

       10.1.1.0/24  Direct  0    0             D   10.1.1.2        <span>100GE</span><span>1/0/1</span>
       10.1.1.2/32  Direct  0    0             D   127.0.0.1       <span>100GE</span><span>1/0/1</span> 
     10.1.1.255/32  Direct  0    0             D   127.0.0.1       <span>100GE</span><span>1/0/1</span> 
       10.2.1.0/24  BGP     255  0             RD  10.2.1.2        <span>100GE</span><span>1/0/7</span>
       10.2.1.2/32  BGP     255  0             RD  127.0.0.1       <span>100GE</span><span>1/0/7</span>
      127.0.0.0/8   Direct  0    0             D   127.0.0.1       InLoopBack0   
255.255.255.255/32  Direct  0    0             D   127.0.0.1       InLoopBack0</pre>
<p id="EN-US_TASK_0000001130621702__p10369533124217">CE1 and CE2 can ping each other.</p>
<pre class="screen" id="EN-US_TASK_0000001130621702__screen1929511499427">[<span class="keyword" id="EN-US_TASK_0000001130621702__keyword158489396102"><font style="font-size:8pt" Face="Courier New" >~</font></span>CE1] <strong id="EN-US_TASK_0000001130621702__b13414114218454">ping 10.2.1.1</strong>
  PING 10.2.1.1: 56  data bytes, press CTRL_C to break                           
    Reply from 10.2.1.1: bytes=56 Sequence=1 ttl=254 time=8 ms                   
    Reply from 10.2.1.1: bytes=56 Sequence=2 ttl=254 time=3 ms                   
    Reply from 10.2.1.1: bytes=56 Sequence=3 ttl=254 time=2 ms                   
    Reply from 10.2.1.1: bytes=56 Sequence=4 ttl=254 time=3 ms                   
    Reply from 10.2.1.1: bytes=56 Sequence=5 ttl=254 time=2 ms                   

  --- 10.2.1.1 ping statistics ---                                               
    5 packet(s) transmitted   
    5 packet(s) received      
    0.00% packet loss         
    round-trip min/avg/max = 2/3/8 ms </pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001130621702__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul id="EN-US_TASK_0000001130621702__ul1638617270214049"><li id="EN-US_TASK_0000001130621702__li663558353214049"><p id="EN-US_TASK_0000001130621702__p542660000214049"><a name="EN-US_TASK_0000001130621702__li663558353214049"></a><a name="li663558353214049"></a>PE1</p>
<pre class="screen" id="EN-US_TASK_0000001130621702__screen305708752214049">#
sysname PE1
#
ip vpn-instance vpna
 ipv4-family
  route-distinguisher 100:1
  vpn-target 111:1 export-extcommunity
  vpn-target 111:1 import-extcommunity
  vpn-target 222:2 import-extcommunity
#
ip vpn-instance vpnb
 ipv4-family 
  route-distinguisher 100:2
  vpn-target 222:2 export-extcommunity
  vpn-target 222:2 import-extcommunity
  vpn-target 111:1 import-extcommunity
#
interface <span>100GE</span><span>1/0/1</span>
<strong id="EN-US_TASK_0000001130621702__b247882510316"> </strong>undo portswitch
 ip binding vpn-instance vpna
 ip address 10.1.1.2 255.255.255.0
# 
interface <span>100GE</span><span>1/0/7</span>
<strong id="EN-US_TASK_0000001130621702__b7733151265212"> </strong>undo portswitch
 ip binding vpn-instance vpnb
 ip address 10.2.1.2 255.255.255.0
#
bgp 100
 #
 ipv4-family unicast
 # 
 ipv4-family vpn-instance vpna
  import-route direct
 #
 ipv4-family vpn-instance vpnb
  import-route direct
#
return</pre>
</li><li id="EN-US_TASK_0000001130621702__li192300240214049"><p id="EN-US_TASK_0000001130621702__p27244945214049"><a name="EN-US_TASK_0000001130621702__li192300240214049"></a><a name="li192300240214049"></a>CE1</p>
<pre class="screen" id="EN-US_TASK_0000001130621702__screen955439010214049">#
sysname CE1
#
interface <span>100GE</span><span>1/0/1</span>
<strong id="EN-US_TASK_0000001130621702__b2056119176524"> </strong>undo portswitch
 ip address 10.1.1.1 255.255.255.0
#
ip route-static 10.2.1.0 255.255.255.0 10.1.1.2
#
return</pre>
</li><li id="EN-US_TASK_0000001130621702__li1417172713214049"><p id="EN-US_TASK_0000001130621702__p680658514214049"><a name="EN-US_TASK_0000001130621702__li1417172713214049"></a><a name="li1417172713214049"></a>CE2</p>
<pre class="screen" id="EN-US_TASK_0000001130621702__screen1665937357214049">#
sysname CE2
#
interface <span>100GE</span><span>1/0/1</span>
<strong id="EN-US_TASK_0000001130621702__b58040221525"> </strong>undo portswitch
 ip address 10.2.1.1 255.255.255.0
#
ip route-static 10.1.1.0 255.255.255.0 10.2.1.2
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_L3VPNv4_cfg_1111.html">Configuring Mutual Access Between Local IPv4 L3VPNs
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_L3VPNv4_cfg_0009.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>