
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring mVRRP Groups">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp_cfg_0110.html">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp_cfg_0142.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="High Availability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="High Availability">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="High Availability">
<meta name="featuretype" content="High Availability">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130784048">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring mVRRP Groups</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130784048"></a><a name="EN-US_TASK_0000001130784048"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring mVRRP Groups</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001130784048__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0000001130784048__fig_dc_vrp_vrrp_cfg_012401">Figure 1</a>, DeviceC and DeviceD are each dual-homed to DeviceA and DeviceB. VRRP in master/backup mode is configured on DeviceA and DeviceB. If multiple VRRP groups are configured on DeviceA and DeviceB, a large number of VRRP Advertisement packets are exchanged between the two devices during VRRP negotiation. To reduce bandwidth and system resource consumption, configure mVRRP groups and then bind common VRRP groups to the mVRRP groups as service VRRP groups. This allows mVRRP groups to determine the master/backup state of service VRRP groups.</p>
<div class="fignone" id="EN-US_TASK_0000001130784048__fig_dc_vrp_vrrp_cfg_012401"><a name="EN-US_TASK_0000001130784048__fig_dc_vrp_vrrp_cfg_012401"></a><a name="fig_dc_vrp_vrrp_cfg_012401"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring mVRRP groups</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1, interface 2, interface 3, interface 4, and interface 5 represent <span>100GE</span><span>1/0/1</span>, <span>100GE</span><span>1/0/2</span>, <span>100GE</span><span>1/0/3</span>, <span>100GE</span><span>1/0/4</span>, and <span>100GE</span><span>1/0/5</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001130624288.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130784048__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><div class="p"><h4 class="sectiontitle">Precautions</h4><p>To improve security, you are advised to configure a VRRP security policy. For details, see <a href="vrp_vrrp_cfg_0121.html">Example for Configuring VRRP in Master/Backup Mode</a>.</p>
<h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Assign an IP address to each interface on DeviceA and DeviceB, configure a routing protocol to ensure IP connectivity, and enable Layer 2 transparent transmission on DeviceC and DeviceD.</li><li>Configure mVRRP groups 1 and 2 on DeviceA and DeviceB.</li><li>Configure VRRP groups 10 and 20 on DeviceA and DeviceB and bind them to the mVRRP groups as service VRRP groups.</li></ol>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130784048__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Procedure</h4><ol><li>Assign an IP address to each interface on DeviceA and DeviceB and configure OSPF. For details about the configurations of DeviceC and DeviceD, see <a href="#EN-US_TASK_0000001130784048__context158161004500">Configuration Scripts</a>.<p># Configure DeviceA.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ip address 10.10.1.1 24</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>ip address 10.20.1.1 24</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>ip address 192.168.1.1 24</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong>ip address 10.10.3.1 24</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/5</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/5</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/5</span>] <strong>ip address 10.20.3.1 24</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/5</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>ospf</strong>
[<span class="keyword">*</span>DeviceA-ospf-1] <strong>area 0</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.0] <strong>network 10.10.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.0] <strong>network 10.10.3.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.0] <strong>network 10.20.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.0] <strong>network 10.20.3.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.0] <strong>network 192.168.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA-ospf-1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure DeviceB.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceB</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>ip address 10.10.1.2 24</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface </strong><strong><span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>ip address 10.20.1.2 24</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong>ip address 192.168.2.1 24</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong>ip address 10.10.3.2 24</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/5</span></strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/5</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/5</span>] <strong>ip address 10.20.3.2 24</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/5</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>ospf</strong>
[<span class="keyword">*</span>DeviceB-ospf-1] <strong>area 0</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0] <strong>network 10.10.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0] <strong>network 10.10.3.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0] <strong>network 10.20.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0] <strong>network 10.20.3.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0] <strong>network 192.168.2.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB-ospf-1]<strong> quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
</li><li>Configure mVRRP groups on DeviceA and DeviceB, and configure a higher priority for DeviceA so that it functions as the master.<p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong>vrrp vrid 1 virtual-ip 10.10.3.111</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong>vrrp vrid 1 admin</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong>vrrp vrid 1 priority 120</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/5</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/5</span>] <strong>vrrp vrid 2 virtual-ip 10.20.3.111</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/5</span>] <strong>vrrp vrid 2 admin</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/5</span>] <strong>vrrp vrid 2 priority 120</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/5</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong>vrrp vrid 1 virtual-ip 10.10.3.111</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong>vrrp vrid 1 admin</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/5</span></strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/5</span>] <strong>vrrp vrid 2 virtual-ip 10.20.3.111</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/5</span>] <strong>vrrp vrid 2 admin</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/5</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
</li><li>Configure VRRP groups 10 and 20 on DeviceA and DeviceB and bind them to the mVRRP groups as service VRRP groups.<p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>vrrp vrid 10 virtual-ip 10.10.1.111</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>vrrp vrid 10 track admin-vrrp interface <span>100ge</span> <span>1/0/4</span> vrid 1 unflowdown</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>vrrp vrid 20 virtual-ip 10.20.1.111</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>vrrp vrid 20 track admin-vrrp interface <span>100ge</span> <span>1/0/5</span> vrid 2 unflowdown</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>vrrp vrid 10 virtual-ip 10.10.1.111</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>vrrp vrid 10 track admin-vrrp interface <span>100ge</span> <span>1/0/1</span> vrid 1 unflowdown</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceB-<span><span>100GE</span><span>1/0/2</span></span>] <strong>vrrp vrid 20 virtual-ip 10.20.1.111</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>vrrp vrid 20 track admin-vrrp interface <span>100ge</span> <span>1/0/2</span> vrid 2 unflowdown</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>quit </strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130784048__1.3.4"></a><a name="1.3.4"></a>
<div class="p"><h4 class="sectiontitle">Verifying the Configuration</h4><p># Check the VRRP status on DeviceA and DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display vrrp</strong>
Type: 
        N: Normal 
        A: Administrator 
        M: Member
        L: Load-Balance 
        LM: Load-Balance-Member
Total:3     Master:3    Backup:0    Non-active:0    
VRID State       Interface        Type    Virtual IP
--------------------------------------------------------
   1 Master      <span>100GE</span><span>1/0/4</span>            <strong>A</strong>       10.10.3.111
   2 Master      <span>100GE</span><span>1/0/5</span>            <strong>A</strong>       10.20.3.111
  10 Master      <span>100GE</span><span>1/0/1</span>            <strong>M</strong>       10.10.1.111
  20 Master      <span>100GE</span><span>1/0/2</span>            <strong>M</strong>       10.20.1.111</pre>
<div class="p">The VRRP status on DeviceA is as follows:<ul><li><p>In mVRRP groups 1 and 2, <strong>State</strong> is <strong>Master</strong> and <strong>Type</strong> is <strong>Admin</strong>.</p>
</li><li><p>In each service VRRP group, <strong>State</strong> is <strong>Master</strong> and <strong>Type</strong> is <strong>Member</strong>.</p>
</li></ul>
</div>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display vrrp</strong>
Type: 
        N: Normal 
        A: Administrator 
        M: Member
        L: Load-Balance 
        LM: Load-Balance-Member
Total:3     Master:3    Backup:0    Non-active:0    
VRID State       Interface        Type    Virtual IP
--------------------------------------------------------
   1 Backup      <span>100GE</span><span>1/0/4</span>            <strong>A</strong>       10.10.3.111
   2 Backup      <span>100GE</span><span>1/0/5</span>            <strong>A</strong>       10.20.3.111
  10 Backup      <span>100GE</span><span>1/0/1</span>            <strong>M</strong>       10.10.1.111
  20 Backup      <span>100GE</span><span>1/0/2</span>            <strong>M</strong>       10.20.1.111</pre>
<div class="p">The VRRP status on DeviceB is as follows:<ul><li><p>In mVRRP groups 1 and 2, <strong>State</strong> is <strong>Backup</strong> and <strong>Type</strong> is <strong>Admin</strong>.</p>
</li><li><p>In each service VRRP group, <strong>State</strong> is <strong>Backup</strong> and <strong>Type</strong> is <strong>Member</strong>.</p>
</li></ul>
</div>
<p># Shut down <span>100GE</span><span>1/0/1</span>, <span>100GE</span><span>1/0/2</span>, <span>100GE</span><span>1/0/4</span>, and <span>100GE</span><span>1/0/5</span> on DeviceA to simulate a device fault. Check the VRRP status on DeviceA and DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display vrrp</strong>
Type: 
        N: Normal 
        A: Administrator 
        M: Member
        L: Load-Balance 
        LM: Load-Balance-Member
Total:3     Master:3    Backup:0    Non-active:0    
VRID State       Interface        Type    Virtual IP
--------------------------------------------------------
   1 Initialize  <span>100GE</span><span>1/0/4</span>           <strong>A</strong>   10.10.3.111
   2 Initialize  <span>100GE</span><span>1/0/5</span>           <strong>A</strong>   10.20.3.111
  10 Initialize  <span>100GE</span><span>1/0/1</span>           <strong>M</strong>  10.10.1.111
  20 Initialize  <span>100GE</span><span>1/0/2</span>           <strong>M</strong>  10.20.1.111</pre>
<div class="p">The VRRP status on DeviceA is as follows:<ul><li><p>In mVRRP groups 1 and 2, <strong>State</strong> is <strong>Initialize</strong> and <strong>Type</strong> is <strong>Admin</strong>.</p>
</li><li><p>In each service VRRP group, <strong>State</strong> is <strong>Initialize</strong> and <strong>Type</strong> is <strong>Member</strong>.</p>
</li></ul>
</div>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display vrrp</strong>
Type: 
        N: Normal 
        A: Administrator 
        M: Member
        L: Load-Balance 
        LM: Load-Balance-Member
Total:3     Master:3    Backup:0    Non-active:0    
VRID State       Interface        Type    Virtual IP
--------------------------------------------------------
   1 Master      <span>100GE</span><span>1/0/4</span>           <strong>A</strong>   10.10.3.111
   2 Master      <span>100GE</span><span>1/0/5</span>           <strong>A</strong>   10.20.3.111
  10 Master      <span>100GE</span><span>1/0/1</span>           <strong>M</strong>  10.10.1.111
  20 Master      <span>100GE</span><span>1/0/2</span>           <strong>M</strong>  10.20.1.111</pre>
<div class="p">The VRRP status on DeviceB is as follows:<ul><li><p>In mVRRP groups 1 and 2, <strong>State</strong> is <strong>Master</strong> and <strong>Type</strong> is <strong>Admin</strong>.</p>
</li><li><p>In each service VRRP group, <strong>State</strong> is <strong>Master</strong> and <strong>Type</strong> is <strong>Member</strong>.</p>
</li></ul>
</div>
<p>The command outputs show that the mVRRP status on DeviceA and DeviceB switches between <strong>Master</strong> and <strong>Backup</strong>.</p>
<p># Run the <strong>undo shutdown</strong> command on <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, <span>100GE</span> <span>1/0/4</span>, and <span>100GE</span> <span>1/0/5</span> of DeviceA to simulate fault recovery. Check the VRRP status on DeviceA and DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display vrrp</strong>
Type: 
        N: Normal 
        A: Administrator 
        M: Member
        L: Load-Balance 
        LM: Load-Balance-Member
Total:3     Master:3    Backup:0    Non-active:0    
VRID State       Interface        Type    Virtual IP
--------------------------------------------------------
   1 Master      <span>100GE</span><span>1/0/4</span>           <strong>A</strong>   10.10.3.111
   2 Master      <span>100GE</span><span>1/0/5</span>           <strong>A</strong>   10.20.3.111
  10 Master      <span>100GE</span><span>1/0/1</span>           <strong>M</strong>  10.10.1.111
  20 Master      <span>100GE</span><span>1/0/2</span>           <strong>M</strong>  10.20.1.111</pre>
<div class="p">The VRRP status on DeviceA is as follows:<ul><li><p>In mVRRP groups 1 and 2, <strong>State</strong> is <strong>Master</strong> and <strong>Type</strong> is <strong>Admin</strong>.</p>
</li><li><p>In each service VRRP group, <strong>State</strong> is <strong>Master</strong> and <strong>Type</strong> is <strong>Member</strong>.</p>
</li></ul>
</div>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display vrrp</strong>
Type: 
        N: Normal 
        A: Administrator 
        M: Member
        L: Load-Balance 
        LM: Load-Balance-Member
Total:3     Master:0    Backup:3    Non-active:0    
VRID State       Interface        Type    Virtual IP
--------------------------------------------------------
   1 Backup      <span>100GE</span><span>1/0/4</span>           <strong>A</strong>   10.10.3.111
   2 Backup      <span>100GE</span><span>1/0/5</span>           <strong>A</strong>   10.20.3.111
  10 Backup      <span>100GE</span><span>1/0/1</span>           <strong>M</strong>  10.10.1.111
  20 Backup      <span>100GE</span><span>1/0/2</span>           <strong>M</strong>  10.20.1.111</pre>
<div class="p">The VRRP status on DeviceB is as follows:<ul><li><p>In mVRRP groups 1 and 2, <strong>State</strong> is <strong>Backup</strong> and <strong>Type</strong> is <strong>Admin</strong>.</p>
</li><li><p>In each service VRRP group, <strong>State</strong> is <strong>Backup</strong> and <strong>Type</strong> is <strong>Member</strong>.</p>
</li></ul>
</div>
<p>The command outputs show that the mVRRP status on DeviceA and DeviceB recovers.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130784048__1.3.5"></a><a name="1.3.5"></a>
<div class="p" id="EN-US_TASK_0000001130784048__context158161004500"><a name="EN-US_TASK_0000001130784048__context158161004500"></a><a name="context158161004500"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.10.1.1 255.255.255.0
 vrrp vrid 10 virtual-ip 10.10.1.111
 vrrp vrid 10 track admin-vrrp interface <span>100ge</span> <span>1/0/4</span> vrid 1 unflowdown
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.20.1.1 255.255.255.0
 vrrp vrid 20 virtual-ip 10.20.1.111
 vrrp vrid 20 track admin-vrrp interface <span>100ge</span> <span>1/0/5</span> vrid 2 unflowdown
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 192.168.1.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/4</span>
 undo portswitch
 ip address 10.10.3.1 255.255.255.0 
 vrrp vrid 1 virtual-ip 10.10.3.111
 <span>vrrp vrid 1 admin</span>
 vrrp vrid 1 priority 120
#
interface <span>100GE</span><span>1/0/5</span>
 undo portswitch
 ip address 10.20.3.1 255.255.255.0 
 vrrp vrid 2 virtual-ip 10.1.1.222
 <span>vrrp vrid 2 admin</span>
 vrrp vrid 2 priority 120
#
ospf 1
 area 0.0.0.0
  network 10.10.1.0 0.0.0.255
  network 10.10.3.0 0.0.0.255
  network 10.20.1.0 0.0.0.255
  network 10.20.3.0 0.0.0.255
  network 192.168.1.0 0.0.0.255
#
return</pre>
</li><li><p>DeviceB</p>
<pre class="screen">#
sysname DeviceB
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.10.1.2 255.255.255.0
 vrrp vrid 10 virtual-ip 10.10.1.111
 vrrp vrid 10 track admin-vrrp interface <span>100ge</span> <span>1/0/4</span> vrid 1 unflowdown
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.20.1.2 255.255.255.0
 vrrp vrid 20 virtual-ip 10.20.1.111
 vrrp vrid 20 track admin-vrrp interface <span>100ge</span> <span>1/0/5</span> vrid 2 unflowdown
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 192.168.2.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/4</span>
 undo portswitch
 ip address 10.10.3.2 255.255.255.0 
 vrrp vrid 1 virtual-ip 10.10.3.111
 <span>vrrp vrid 1 admin</span>
#
interface <span>100GE</span><span>1/0/5</span>
 undo portswitch
 ip address 10.20.3.2 255.255.255.0 
 vrrp vrid 2 virtual-ip 10.1.1.222
 <span>vrrp vrid 2 admin</span>
#
ospf 1
 area 0.0.0.0
  network 10.10.1.0 0.0.0.255
  network 10.10.3.0 0.0.0.255
  network 10.20.1.0 0.0.0.255
  network 10.20.3.0 0.0.0.255
  network 192.168.2.0 0.0.0.255
#
return</pre>
</li><li><p>DeviceC</p>
<pre class="screen">#
sysname DeviceC
#
vlan batch 100 200
#
interface <span>100GE</span><span>1/0/1</span>
 port default vlan 100
#
interface <span>100GE</span><span>1/0/2</span>
 port default vlan 100
#
interface <span>100GE</span><span>1/0/3</span>
 port default vlan 200
#
interface <span>100GE</span><span>1/0/4</span>
 port default vlan 200
#
return</pre>
</li><li><p>DeviceD</p>
<pre class="screen">#
sysname DeviceD
#
 vlan batch 100 200
#
interface <span>100GE</span><span>1/0/1</span>
 port default vlan 100
#
interface <span>100GE</span><span>1/0/2</span>
 port default vlan 100
#
interface <span>100GE</span><span>1/0/3</span>
 port default vlan 200
#
interface <span>100GE</span><span>1/0/4</span>
 port default vlan 200
#
return</pre>
</li></ul>
</div></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_vrrp_cfg_0110.html">Configuring mVRRP
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_vrrp_cfg_0142.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>