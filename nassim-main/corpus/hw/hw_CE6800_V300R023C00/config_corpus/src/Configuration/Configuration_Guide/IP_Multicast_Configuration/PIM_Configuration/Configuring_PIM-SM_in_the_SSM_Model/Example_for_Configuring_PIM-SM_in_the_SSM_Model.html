
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring PIM-SM in the SSM Model">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_pim_cfg_0017.html">
<meta name="DC.Relation" scheme="URI" content="vrp_pim_cfg_1021.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176743303">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring PIM-SM in the SSM Model</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176743303"></a><a name="EN-US_TASK_0000001176743303"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring PIM-SM in the SSM Model</h1>
<div class="taskbody" id="taskbody0000001098117610"><div class="context"><a name="EN-US_TASK_0000001176743303__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001176743303__context1194201341214040"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001176743303__p1653926783214040">On the ISP network shown in <a href="#EN-US_TASK_0000001176743303__fig_dc_vrp_multicast_cfg_004101">Figure 1</a>, multicast services are deployed. An IGP has been deployed on this network, and unicast traffic forwarding is normal. It is required that hosts on the network join source-specific multicast groups. </p>
<div class="note" id="EN-US_TASK_0000001176743303__note938277739214040"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001176743303__p661539452214040">In this example, interface1 and interface2 represent <span>100GE</span><span>1/0/1</span> and <span>100GE</span><span>1/0/2</span>, respectively.</p>
</div></div>
<div class="fignone" id="EN-US_TASK_0000001176743303__fig_dc_vrp_multicast_cfg_004101"><a name="EN-US_TASK_0000001176743303__fig_dc_vrp_multicast_cfg_004101"></a><a name="fig_dc_vrp_multicast_cfg_004101"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring PIM-SM in the SSM model</span><br><span><img class="vsd" id="EN-US_TASK_0000001176743303__image448416916214040" src="figure/en-us_image_0000001130623944.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176743303__1.3.2"></a><a name="1.3.2"></a>
<div class="p" id="EN-US_TASK_0000001176743303__context1393211369214040"><h4 class="sectiontitle">Precautions</h4><p id="EN-US_TASK_0000001176743303__p771007462214040">During the configuration, ensure that the SSM group address ranges on all <span class="keyword" id="EN-US_TASK_0000001176743303__keyword146221656184411">devices</span> are the same.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176743303__1.3.3"></a><a name="1.3.3"></a>
<div class="p" id="EN-US_TASK_0000001176743303__context1674199511214040"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0000001176743303__p1992697483214040">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0000001176743303__ol756503974214040"><li id="EN-US_TASK_0000001176743303__li991010753214040"><p id="EN-US_TASK_0000001176743303__p34559539214040"><a name="EN-US_TASK_0000001176743303__li991010753214040"></a><a name="li991010753214040"></a>Configure IP addresses and a unicast routing protocol for interfaces on each <span class="keyword" id="EN-US_TASK_0000001176743303__keyword238881462019">device</span>.</p>
</li><li id="EN-US_TASK_0000001176743303__li256126340214040"><p id="EN-US_TASK_0000001176743303__p1158167792214040"><a name="EN-US_TASK_0000001176743303__li256126340214040"></a><a name="li256126340214040"></a>Enable the multicast function on all <span class="keyword" id="EN-US_TASK_0000001176743303__keyword19515153135318">devices</span> that need to provide multicast services and enable PIM-SM on all the involved interfaces.</p>
</li><li id="EN-US_TASK_0000001176743303__li673973642214040"><p id="EN-US_TASK_0000001176743303__p1646246816214040"><a name="EN-US_TASK_0000001176743303__li673973642214040"></a><a name="li673973642214040"></a>Enable IGMP on the interfaces that directly connect <span class="keyword" id="EN-US_TASK_0000001176743303__keyword1670143217202">devices</span> to hosts.</p>
</li><li id="EN-US_TASK_0000001176743303__li555982784214040"><p id="EN-US_TASK_0000001176743303__p701302591214040"><a name="EN-US_TASK_0000001176743303__li555982784214040"></a><a name="li555982784214040"></a>Set the same SSM group address range on all <span class="keyword" id="EN-US_TASK_0000001176743303__keyword194391150172018">devices</span>. </p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176743303__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001176743303__steps1302478025214040"><li id="EN-US_TASK_0000001176743303__step1102903759214040"><span id="EN-US_TASK_0000001176743303__cmd1572120256214040">Assign an IP address to each <span class="keyword" id="EN-US_TASK_0000001176743303__keyword5880191410396">device</span> interface and configure a unicast routing protocol. For detailed configurations, see Configuration Scripts.</span></li><li id="EN-US_TASK_0000001176743303__step1436306325214040"><span id="EN-US_TASK_0000001176743303__cmd136728348214040">Enable the multicast function on all <span class="keyword" id="EN-US_TASK_0000001176743303__keyword385445053915">devices</span> and enable PIM-SM on all the involved interfaces.</span><p><p id="EN-US_TASK_0000001176743303__p1773958887214040"># Configure <span class="keyword" id="EN-US_TASK_0000001176743303__keyword18142487819">Device</span>A. The configurations of <span class="keyword" id="EN-US_TASK_0000001176743303__keyword5625115612444">Device</span>B and <span class="keyword" id="EN-US_TASK_0000001176743303__keyword962525613444">Device</span>C are similar to the configuration of <span class="keyword" id="EN-US_TASK_0000001176743303__keyword1625145619443">Device</span>A, and are not mentioned here.</p>
<pre class="screen" id="EN-US_TASK_0000001176743303__screen1201073027214040">[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword145944515363"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword1262513569449">Device</span>A] <strong id="EN-US_TASK_0000001176743303__b1127561484214040">multicast routing-enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword14923103811400">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword19625175618441">Device</span>A] <strong id="EN-US_TASK_0000001176743303__b586298337214040">interface <span>100GE</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword1056854613446">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword19544899311">Device</span>A-<span>100GE</span><span>1/0/2</span>]<strong id="EN-US_TASK_0000001176743303__b1182152163111"> undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword9689174704411">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword962595610446">Device</span>A-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001176743303__b1064768103214040">pim sm</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword87411348174417">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword126254569446">Device</span>A-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001176743303__b896290254214040">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword1576664916440">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword1625856134412">Device</span>A] <strong id="EN-US_TASK_0000001176743303__b34819919214040">interface <span>100GE</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword14750145084416">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword19134039163110">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001176743303__b7154448113111">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword5845175124413">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword4625175624411">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001176743303__b1989718861214040">pim sm</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword15901753114413">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword56254567447">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001176743303__b643837447214040">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword12506115419445">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword1162565674411">Device</span>A] <strong id="EN-US_TASK_0000001176743303__b1938356813214040">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001176743303__step8175016214040"><span id="EN-US_TASK_0000001176743303__cmd2106024151214040">Enable IGMP on the interfaces directly connected to hosts.</span><p><p id="EN-US_TASK_0000001176743303__p1482022020214040"># Enable IGMP on the interface connecting <span class="keyword" id="EN-US_TASK_0000001176743303__keyword76251556154414">Device</span>C to a host and set the IGMP version to 3.</p>
<pre class="screen" id="EN-US_TASK_0000001176743303__screen2118399842214040">[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword4704192913419"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword262519565447">Device</span>C] <strong id="EN-US_TASK_0000001176743303__b1195538003214040">interface <span>100GE</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword148651832153420"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword17289102312323">Device</span>C-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001176743303__b276783463219">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword14788192554517">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword11625956154420">Device</span>C-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001176743303__b496893061214040">igmp enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword629010279459">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword1262565612447">Device</span>C-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001176743303__b907209813214040">igmp version 3</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword541302844516">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword15625105616445">Device</span>C-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001176743303__b156882787214040">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword146647299452">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword6625145634415">Device</span>C] <strong id="EN-US_TASK_0000001176743303__b667019244214040">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001176743303__step2048846276214040"><span id="EN-US_TASK_0000001176743303__cmd59081087214040">Set an SSM group address range.</span><p><p id="EN-US_TASK_0000001176743303__p744598690214040"># Set the SSM group address range to 232.1.1.0/24 on all <span class="keyword" id="EN-US_TASK_0000001176743303__keyword16251756104414">devices</span>. The configurations of <span class="keyword" id="EN-US_TASK_0000001176743303__keyword136251256104410">Device</span>B and <span class="keyword" id="EN-US_TASK_0000001176743303__keyword15625115624411">Device</span>C are similar to the configuration of <span class="keyword" id="EN-US_TASK_0000001176743303__keyword8625185684419">Device</span>A, and are not mentioned here.</p>
<pre class="screen" id="EN-US_TASK_0000001176743303__screen1867981275214040">[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword17322237103418"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword1062511561448">Device</span>A] <strong id="EN-US_TASK_0000001176743303__b900679469214040">acl number 2000</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword18761531144513">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword1462525674419">Device</span>A-acl4-basic-2000] <strong id="EN-US_TASK_0000001176743303__b2043056143214040">rule permit source 232.1.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword14736163213455">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword106258565448">Device</span>A-acl4-basic-2000] <strong id="EN-US_TASK_0000001176743303__b326596368214040">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword1191218331450">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword20625185615444">Device</span>A] <strong id="EN-US_TASK_0000001176743303__b1695663992214040">pim</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword131206352451">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword2625456154410">Device</span>A-pim] <strong id="EN-US_TASK_0000001176743303__b1572738581214040">ssm-policy 2000</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword73305368456">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword362611566448">Device</span>A-pim] <strong id="EN-US_TASK_0000001176743303__b114106278214040">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001176743303__keyword16291123744517">*</span><span class="keyword" id="EN-US_TASK_0000001176743303__keyword16626175614415">Device</span>A] <strong id="EN-US_TASK_0000001176743303__b2037662410214040">commit</strong></pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001176743303__example871923596214040"><a name="EN-US_TASK_0000001176743303__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0000001176743303__p1135574946214040"># Run the <strong id="EN-US_TASK_0000001176743303__b9992435112713">display pim routing-table</strong> command to view the PIM routing table on <span class="keyword" id="EN-US_TASK_0000001176743303__keyword1662645619447">devices</span> and check whether HostA can receive information sent from the multicast source 10.110.1.1/24 to the multicast group 232.1.1.1/24. The command output on <span class="keyword" id="EN-US_TASK_0000001176743303__keyword562695674419">Device</span>A and <span class="keyword" id="EN-US_TASK_0000001176743303__keyword862614567446">Device</span>B is as follows:</p>
<pre class="screen" id="EN-US_TASK_0000001176743303__screen2010978790214040">&lt;<span class="keyword" id="EN-US_TASK_0000001176743303__keyword17626135694411">Device</span>A&gt; <strong id="EN-US_TASK_0000001176743303__b1248649367214040">display pim routing-table</strong>
VPN-Instance: public net
 Total 0 (*, G) entry; 1 (S, G) entry

 (10.110.1.1, 232.1.1.1)
     Protocol: pim-ssm, Flag: LOC
     UpTime: 00:02:13
     Upstream interface: <span>100GE</span><span>1/0/2</span>, Refresh time: 00:02:13
         Upstream neighbor: 10.110.1.1
         RPF prime neighbor: 10.110.1.1
     Downstream interface(s) information:
     Total number of downstreams: 1
        1: <span>100GE</span><span>1/0/1</span>
             Protocol:  pim-ssm, UpTime: 00:02:13, Expires: 00:03:17

&lt;<span class="keyword" id="EN-US_TASK_0000001176743303__keyword13626856194414">Device</span>B&gt; <strong id="EN-US_TASK_0000001176743303__b729279798214040">display pim routing-table</strong>
 VPN-Instance: public net
 Total 0 (*, G) entry; 1 (S, G) entry

 (10.110.1.1, 232.1.1.1)
     Protocol: pim-ssm, Flag:
     UpTime: 00:09:15
     Upstream interface: <span>100GE</span><span>1/0/1</span>, Refresh time: 00:09:15
         Upstream neighbor: 192.168.2.1
         RPF prime neighbor: 192.168.2.1
     Downstream interface(s) information:
     Total number of downstreams: 1
        1: <span>100GE</span><span>1/0/2</span>
             Protocol:  pim-ssm, UpTime: 00:09:15, Expires: 00:03:13</pre>
<h4 class="sectiontitle">Configuration Scripts</h4><ul id="EN-US_TASK_0000001176743303__ul1471094985214040"><li id="EN-US_TASK_0000001176743303__li1020923005214040"><p id="EN-US_TASK_0000001176743303__p258605505214040"><a name="EN-US_TASK_0000001176743303__li1020923005214040"></a><a name="li1020923005214040"></a><span class="keyword" id="EN-US_TASK_0000001176743303__keyword56291156154416">Device</span>A</p>
<pre class="screen" id="EN-US_TASK_0000001176743303__screen1990576200214040">#
sysname <span class="keyword" id="EN-US_TASK_0000001176743303__keyword16291256124417">Device</span>A
#
multicast routing-enable
#
acl number 2000
 rule 5 permit source 232.1.1.0 0.0.0.255
#
isis 1
 network-entity 10.0000.0000.0001.00
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.2.1 255.255.255.0
 pim sm
 isis enable 1
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.110.1.2 255.255.255.0
 pim sm
 isis enable 1
#
pim
 ssm-policy 2000
#
return</pre>
</li><li id="EN-US_TASK_0000001176743303__li341868551214040"><p id="EN-US_TASK_0000001176743303__p1265980932214040"><a name="EN-US_TASK_0000001176743303__li341868551214040"></a><a name="li341868551214040"></a><span class="keyword" id="EN-US_TASK_0000001176743303__keyword0630195611446">Device</span>B</p>
<pre class="screen" id="EN-US_TASK_0000001176743303__screen35709326214040">#
sysname <span class="keyword" id="EN-US_TASK_0000001176743303__keyword10630856124417">Device</span>B
#
multicast routing-enable
#
acl number 2000
 rule 5 permit source 232.1.1.0 0.0.0.255
#
isis 1
 network-entity 10.0000.0000.0002.00
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.2.2 255.255.255.0
 pim sm
 isis enable 1
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.4.1 255.255.255.0
 pim sm
 isis enable 1
#
pim
 ssm-policy 2000
#
return</pre>
</li><li id="EN-US_TASK_0000001176743303__li537128035214040"><p id="EN-US_TASK_0000001176743303__p1637115904214040"><a name="EN-US_TASK_0000001176743303__li537128035214040"></a><a name="li537128035214040"></a><span class="keyword" id="EN-US_TASK_0000001176743303__keyword186304561445">Device</span>C</p>
<pre class="screen" id="EN-US_TASK_0000001176743303__screen241662962214040">#
sysname <span class="keyword" id="EN-US_TASK_0000001176743303__keyword15630125614449">Device</span>C
#
multicast routing-enable
#
acl number 2000
 rule 5 permit source 232.1.1.0 0.0.0.255
#
isis 1
 network-entity 10.0000.0000.0003.00
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.4.2 255.255.255.0
 pim sm
 isis enable 1
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.110.2.1 255.255.255.0
 pim sm
 igmp enable
 igmp version 3
 isis enable 1
#
pim
 ssm-policy 2000
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_pim_cfg_0017.html">Configuring PIM-SM in the SSM Model
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_pim_cfg_1021.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>