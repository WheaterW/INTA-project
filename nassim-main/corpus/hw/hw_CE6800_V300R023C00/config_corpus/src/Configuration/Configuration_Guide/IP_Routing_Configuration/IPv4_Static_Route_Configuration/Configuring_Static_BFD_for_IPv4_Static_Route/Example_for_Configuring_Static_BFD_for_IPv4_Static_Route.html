
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Static BFD for IPv4 Static Route">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_ipv4-static-route_cfg_0022.html">
<meta name="DC.Relation" scheme="URI" content="vrp_ipv4-static-route_cfg_0024.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="IPv4 Static Route">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv4 Static Route">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="IPv4 Static Route">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176742409">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Static BFD for IPv4 Static Route</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176742409"></a><a name="EN-US_TASK_0000001176742409"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Static BFD for IPv4 Static Route</h1>
<div class="taskbody" id="taskbody1563782577940"><div class="context"><a name="EN-US_TASK_0000001176742409__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001176742409__context1677625172748"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001176742409__p1890763323214036">On the network shown in <a href="#EN-US_TASK_0000001176742409__fig1279133692210">Figure 1</a>, DeviceA is connected to DeviceB through a switch. You can configure the default static route on DeviceA so that DeviceA can communicate with other devices. In addition, a BFD session needs to be configured between DeviceA and DeviceB to rapidly detect link faults.</p>
<div class="fignone" id="EN-US_TASK_0000001176742409__fig1279133692210"><a name="EN-US_TASK_0000001176742409__fig1279133692210"></a><a name="fig1279133692210"></a><span class="figcap"><b>Figure 1 </b>Network diagram of static BFD for IPv4 static route</span><div class="note" id="EN-US_TASK_0000001176742409__note144651912202917"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001176742409__p124651012192910">In this example, interface 1 and interface 2 represent <span>100GE</span><span>1/0/1</span> and <span>100GE</span><span>1/0/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001176742409__image19279936192212" src="figure/en-us_image_0000001130782792.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176742409__1.3.2"></a><a name="1.3.2"></a>
<div class="p" id="EN-US_TASK_0000001176742409__context098817292423"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0000001176742409__p1094395266214036">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0000001176742409__ol1382962430214036"><li id="EN-US_TASK_0000001176742409__li518093019475">Configure IPv4 addresses for interfaces on each device.</li><li id="EN-US_TASK_0000001176742409__li273371177214036"><p id="EN-US_TASK_0000001176742409__p1081850906214036"><a name="EN-US_TASK_0000001176742409__li273371177214036"></a><a name="li273371177214036"></a>Configure a BFD session on DeviceA and DeviceB to monitor the link between the two devices.</p>
</li><li id="EN-US_TASK_0000001176742409__li2115886997214036"><p id="EN-US_TASK_0000001176742409__p1531047906214036"><a name="EN-US_TASK_0000001176742409__li2115886997214036"></a><a name="li2115886997214036"></a>Configure a default static route from DeviceA to the external network and bind the default static route to the BFD session.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176742409__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001176742409__steps10132325172748"><li id="EN-US_TASK_0000001176742409__step3792121612142"><span id="EN-US_TASK_0000001176742409__cmd379271619147">Configure IPv4 addresses for interfaces on each device.</span><p><p id="EN-US_TASK_0000001176742409__p09961176214"># Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001176742409__screen5996171732119"><span class="keyword" id="EN-US_TASK_0000001176742409__keyword075583785412">&lt;HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001176742409__b16755837155418">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword173112011412"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001176742409__keyword14483024162213">HUAWEI</span>] <strong id="EN-US_TASK_0000001176742409__b1099715174214">sysname DeviceA</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword37362410388">*</span><span class="keyword" id="EN-US_TASK_0000001176742409__keyword609583901214023">HUAWEI</span>]<strong id="EN-US_TASK_0000001176742409__b54165603214023"> commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword167975617377"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001176742409__b1899720174216">interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword5307258173710"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001176742409__b16554354118">undo </strong><strong id="EN-US_TASK_0000001176742409__b6127183916412">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword1852891725513">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001176742409__b477726134818">ip address 10.1.1.1 255.255.255.0</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword1736191965511">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001176742409__b399751772116">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword189420291421">*</span>DeviceA] <strong id="EN-US_TASK_0000001176742409__b143751134194214">commit</strong></pre>
<p id="EN-US_TASK_0000001176742409__p14998141713211">The configuration of DeviceB is similar to the configuration of DeviceA. For detailed configurations, see <a href="#EN-US_TASK_0000001176742409__postreq24192593172748">Configuration Scripts</a>.</p>
</p></li><li id="EN-US_TASK_0000001176742409__step5253145172748"><span id="EN-US_TASK_0000001176742409__cmd7907968172748">Configure a BFD session on DeviceA and DeviceB to monitor the link between the two devices.</span><p><p id="EN-US_TASK_0000001176742409__p29989181565"># On DeviceA, configure a BFD session to DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001176742409__screen26471126246">[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword689616112388"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong id="EN-US_TASK_0000001176742409__b1501170599"> bfd</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword6525132265513">*</span>DeviceA-bfd]<strong id="EN-US_TASK_0000001176742409__b1550190193"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword13106142519557">*</span>DeviceA]<strong id="EN-US_TASK_0000001176742409__b950118018915"> bfd aa bind peer-ip 10.1.1.2</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword135501226175513">*</span>DeviceA-bfd-session-aa]<strong id="EN-US_TASK_0000001176742409__b17501205915"> discriminator local 10</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword189620294555">*</span>DeviceA-bfd-session-aa] <strong id="EN-US_TASK_0000001176742409__b105021001993">discriminator remote 20</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword10189183214558">*</span>LSRDeviceA-bfd-session-aa] <strong id="EN-US_TASK_0000001176742409__b1450218011915">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword1882518816152">*</span>DeviceA] <strong id="EN-US_TASK_0000001176742409__b108250811156">commit</strong></pre>
<p id="EN-US_TASK_0000001176742409__p1473482889214036"># On DeviceB, configure a BFD session to DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001176742409__screen658314652410">[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword1289013412383"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong id="EN-US_TASK_0000001176742409__b102121139918"> bfd</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword15789238115515">*</span>DeviceB-bfd] <strong id="EN-US_TASK_0000001176742409__b112122131090">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword5667134025515">*</span>DeviceB]<strong id="EN-US_TASK_0000001176742409__b0212613297"> bfd bb bind peer-ip 10.1.1.1</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword2041254210559">*</span>DeviceB-bfd-session-bb]<strong id="EN-US_TASK_0000001176742409__b121341310915"> discriminator local 20</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword959514447556">*</span>DeviceB-bfd-session-bb] <strong id="EN-US_TASK_0000001176742409__b1721312131911">discriminator remote 10</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword0339471559">*</span>DeviceB-bfd-session-bb]<strong id="EN-US_TASK_0000001176742409__b721351316911"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword2741141141517">*</span>DeviceB] <strong id="EN-US_TASK_0000001176742409__b0741111131513">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001176742409__step2642134169"><span id="EN-US_TASK_0000001176742409__cmd76421934368">Configure a default static route from DeviceA to the external network and bind the default static route to the BFD session.</span><p><p id="EN-US_TASK_0000001176742409__p869825437214036"># On DeviceA, configure a default static route to the external network and bind it to the BFD session named <strong id="EN-US_TASK_0000001176742409__b145491652153816">aa</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001176742409__screen924324049214036">[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword8308108163813"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong id="EN-US_TASK_0000001176742409__b127475780214036"> ip route-static 0.0.0.0 0 10.1.1.2 track bfd-session aa</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword17569120191517">*</span>DeviceA] <strong id="EN-US_TASK_0000001176742409__b75691720121515">commit</strong></pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001176742409__example121226172748"><a name="EN-US_TASK_0000001176742409__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0000001176742409__p13513459442"># Run the <a href="cmdqueryname=display+bfd+session+all"><b><span class="cmdname" id="EN-US_TASK_0000001176742409__cmdname855210835514">display bfd session all</span></b></a> command on DeviceA to check the status of the static BFD session.</p>
<pre class="screen" id="EN-US_TASK_0000001176742409__screen3515747144414">[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword86962115387"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001176742409__b17285505193">display bfd session all</strong> 
S: Static session
D: Dynamic session
IP: IP session
IF: Single-hop session
PEER: Multi-hop session
AUTO: Automatically negotiated session
VXLAN: VXLAN session
(w): State in WTR  
(*): State is invalid 
Total UP/DOWN Session Number : 1/0
------------------------------------------------------------------------------ 
Local  Remote PeerIpAddr       State     Type        InterfaceName 
------------------------------------------------------------------------------
 10    20    10.1.1.2        Up        S_IP_IF       <span>100GE</span><span>1/0/1</span> 
 ------------------------------------------------------------------------------   </pre>
<p id="EN-US_TASK_0000001176742409__p18758183903313">The command output shows that the <strong id="EN-US_TASK_0000001176742409__b71781410113912">State</strong> field value is <strong id="EN-US_TASK_0000001176742409__b1158014123399">Up</strong>, indicating that the BFD session has been established.</p>
<p id="EN-US_TASK_0000001176742409__p13222143917105"># Check the IP routing table of DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001176742409__screen12783535594">[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword9825171417381"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001176742409__b8484311091">display ip routing-table</strong>
<span class="keyword" id="EN-US_TASK_0000001176742409__keyword1981753515912">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route</span>
------------------------------------------------------------------------------
Routing Table: Public
         Destinations : 5        Routes : 5
Destination/Mask    Proto  Pre  Cost     Flags  NextHop         Interface

        <strong id="EN-US_TASK_0000001176742409__b6836147194713">0.0.0.0/0  Static 60   0         RD  10.1.1.2      <span>100GE</span><span>1/0/1</span></strong>
        10.1.1.0/24  Direct  0    0           D   10.1.1.1        <span>100GE</span><span>1/0/1</span>
        10.1.1.1/32  Direct  0    0           D   127.0.0.1       <span>100GE</span><span>1/0/1</span>
      10.1.1.255/32  Direct  0    0           D   127.0.0.1       <span>100GE</span><span>1/0/1</span>
 255.255.255.255/32  Direct  0    0           D   127.0.0.1       InLoopBack0</pre>
<p id="EN-US_TASK_0000001176742409__p1720013014471">The preceding command output shows that the default IPv4 static route exists in the routing table.</p>
<p id="EN-US_TASK_0000001176742409__p797716117488"># Run the <strong id="EN-US_TASK_0000001176742409__b17824594398">shutdown</strong> command on <span>100GE</span> <span>1/0/1</span> of DeviceA to simulate a link fault.</p>
<pre class="screen" id="EN-US_TASK_0000001176742409__screen6374438141717">[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword101931352111717"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong id="EN-US_TASK_0000001176742409__b419335218179"> interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword0193145261716">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>]<strong id="EN-US_TASK_0000001176742409__b91931552181712"> shutdown</strong>
[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword1836619157185">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001176742409__b13669156189">commit</strong></pre>
<p id="EN-US_TASK_0000001176742409__p1736230105013"># Run the <strong id="EN-US_TASK_0000001176742409__b19496110105011">display bfd session</strong> <strong id="EN-US_TASK_0000001176742409__b149691018505">all</strong> command on DeviceA to check the status of the static BFD session.</p>
<pre class="screen" id="EN-US_TASK_0000001176742409__screen192849163508">[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword9755517113813"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001176742409__b10383155401519">display bfd session all</strong> 
S: Static session
D: Dynamic session
IP: IP session
IF: Single-hop session
PEER: Multi-hop session
AUTO: Automatically negotiated session
VXLAN: VXLAN session
(w): State in WTR  
(*): State is invalid 
Total UP/DOWN Session Number : 0/1
------------------------------------------------------------------------------ 
Local  Remote PeerIpAddr       State     Type        InterfaceName 
------------------------------------------------------------------------------
 10     20    10.1.1.2        Down      S_IP_IF       <span>100GE</span><span>1/0/1</span> 
 ------------------------------------------------------------------------------ </pre>
<p id="EN-US_TASK_0000001176742409__p844112910504">The command output shows that <strong id="EN-US_TASK_0000001176742409__b661532717409">Down</strong> is displayed in the <strong id="EN-US_TASK_0000001176742409__b2061532764012">State</strong> field, indicating that the BFD session is down.</p>
<p id="EN-US_TASK_0000001176742409__p1906903908214036"># Check the routing table of DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001176742409__screen92201591591">[<span class="keyword" id="EN-US_TASK_0000001176742409__keyword1424772116380"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001176742409__b72355591695">display ip routing-table</strong>
<span class="keyword" id="EN-US_TASK_0000001176742409__keyword10235959797">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route</span>
------------------------------------------------------------------------------
Routing Table: Public
         Destinations : 4        Routes : 4
Destination/Mask    Proto  Pre  Cost      Flags  NextHop         Interface
        10.1.1.0/24  Direct 0    0           D  10.1.1.1         <span>100GE</span><span>1/0/1</span>
        10.1.1.1/32  Direct 0    0           D  127.0.0.1        <span>100GE</span><span>1/0/1</span>
      10.1.1.255/32  Direct 0    0           D  127.0.0.1        <span>100GE</span><span>1/0/1</span>
255.255.255.255/32   Direct 0    0           D  127.0.0.1        InLoopBack0</pre>
<p id="EN-US_TASK_0000001176742409__p974562624914">The command output shows that the default IPv4 static route to 0.0.0.0/0 does not exist in the routing table of DeviceA.</p>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001176742409__postreq24192593172748"></a><a name="postreq24192593172748"></a><a name="EN-US_TASK_0000001176742409__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul id="EN-US_TASK_0000001176742409__ul93742314211"><li id="EN-US_TASK_0000001176742409__li1522814685214037"><p id="EN-US_TASK_0000001176742409__p236305849214037"><a name="EN-US_TASK_0000001176742409__li1522814685214037"></a><a name="li1522814685214037"></a>DeviceA</p>
<pre class="screen" id="EN-US_TASK_0000001176742409__screen1461255334214036">#
sysname DeviceA
#
bfd
#
bfd aa bind peer-ip 10.1.1.2
 discriminator local 10
 discriminator remote 20
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.1.1.1 255.255.255.0
#
ip route-static 0.0.0.0 0.0.0.0 10.1.1.2 track bfd-session aa
#
return</pre>
</li><li id="EN-US_TASK_0000001176742409__li1527384361214037"><p id="EN-US_TASK_0000001176742409__p52687952216"><a name="EN-US_TASK_0000001176742409__li1527384361214037"></a><a name="li1527384361214037"></a>DeviceB</p>
<pre class="screen" id="EN-US_TASK_0000001176742409__screen845432019214036">#
sysname DeviceB
#
bfd
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.1.1.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.1.2.1 255.255.255.0
#
bfd bb bind peer-ip 10.1.1.1
 discriminator local 20
 discriminator remote 10
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_ipv4-static-route_cfg_0022.html">Configuring Static BFD for IPv4 Static Route
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_ipv4-static-route_cfg_0024.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>