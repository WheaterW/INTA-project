
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Differentiated Flow Scheduling">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_ai_dpp_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="spec/Differentiated_Flow_Scheduling_limitation_CE_v6r23c00.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_ai_dpp_cfg_0008.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Differentiated Flow Scheduling">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Differentiated Flow Scheduling">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001513159922">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring Differentiated Flow Scheduling</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001513159922"></a><a name="EN-US_TASK_0000001513159922"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Differentiated Flow Scheduling</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001513159922__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>In practice, differentiated flow scheduling must be enabled on both the inbound and outbound interfaces of a device based on the traffic forwarding path.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001513159922__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Set the system resource mode to <strong>balance</strong>. (This command is required only for the <span>CE6820H, CE6820H-K, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6820S</span>.)</span><p><pre class="screen"><strong><a href="cmdqueryname=system+resource"><b><span class="cmdname">system resource</span></b></a> balance</strong></pre>
</p></li><li><span>Enable the AI service and enter the AI service view.</span><p><pre class="screen"><a href="cmdqueryname=ai-service"><b><span class="cmdname">ai-service</span></b></a></pre>
<p>By default, the AI service is disabled.</p>
</p></li><li><span>Enter the mice-elephant-flow view.</span><p><pre class="screen"><a href="cmdqueryname=mice-elephant-flow"><b><span class="cmdname">mice-elephant-flow</span></b></a></pre>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>For the <span>CE6820H, CE6820H-K, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6820S</span>:</p>
<ul><li>You can run the <a href="cmdqueryname=mice-elephant-flow"><b><span class="cmdname">mice-elephant-flow</span></b></a> command to enter the mice-elephant-flow view only after you run the <strong><a href="cmdqueryname=system+resource"><b><span class="cmdname">system resource</span></b></a> balance</strong> command to set the system resource mode to <strong>balance</strong> and restart the device to make the configuration take effect. You cannot enter the mice-elephant-flow view if you have configured any other system resource mode, even if the configured mode does not take effect.</li><li>If the system resource mode has been set to <strong>balance</strong> and differentiated flow scheduling has been configured, you need to delete the differentiated flow scheduling configuration in the AI service view before changing the system resource mode.</li></ul>
</div></div>
</p></li><li><span>Specify the queue for which differentiated flow scheduling is to be enabled. The original queue for which differentiated flow scheduling is enabled is called an elephant-flow queue, and the high-priority queue to which a mice flow is scheduled is called a mice-flow queue.</span><p><ul><li>For the <span>CE6866, CE6860-SAN, CE6866K, CE6860-HAM, CE8851-32CQ8DQ-P, CE8850-SAN, CE8851K, CE8850-HAM</span>: Specify the elephant-flow queue for which differentiated flow scheduling is to be enabled.<pre class="screen"><a href="cmdqueryname=assign+queue"><b><span class="cmdname">assign queue</span></b></a>{ <i><span class="varname">start-queue-index</span></i> [ <strong><span>to</span></strong> <i><span class="varname">end-queue-index</span></i> ] } &amp;&lt;1-6&gt;</pre>
</li><li>For the <span>CE6855-48XS8CQ, CE6863E-48S8CQ, CE6885, CE6885-LL (standard forwarding mode), CE6885-SAN, CE6885-T, CE8851-32CQ4BQ, CE8855</span>: Specify the elephant-flow queue for which differentiated flow scheduling is to be enabled.<pre class="screen"><a href="cmdqueryname=assign+queue"><b><span class="cmdname">assign queue</span></b></a>{ <i><span class="varname">start-queue-index</span></i> [ <strong><span>to</span></strong> <i><span class="varname">end-queue-index</span></i> ] } &amp;&lt;1-2&gt;</pre>
</li><li>For the <span>CE6820H, CE6820H-K, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6820S</span>: Specify the elephant-flow queue for which differentiated flow scheduling is to be enabled and the mice-flow queue to which a mice flow is to be scheduled.<pre class="screen"><a href="cmdqueryname=assign+queue"><b><span class="cmdname">assign queue</span></b></a>{ <i><span class="varname">start-queue-index</span></i> [ <strong><span>to</span></strong> <i><span class="varname">end-queue-index</span></i> ] } &amp;&lt;1-7&gt; <strong>adjust mice-flow to queue</strong> <em><i><span class="varname">queue-id</span></i></em></pre>
</li></ul>
<p>By default, differentiated flow scheduling is disabled for all queues.</p>
</p></li><li><span>Configure the number of packets in a mice flow. The first <em>N</em> (specified by <i><span class="varname">number</span></i>) packets in a flow are identified as a mice flow. (This command is available only on the <span>CE6866, CE6860-SAN, CE6866K, CE6860-HAM, CE8851-32CQ8DQ-P, CE8850-SAN, CE8851K, CE8850-HAM</span>, <span>CE6855-48XS8CQ, CE6863E-48S8CQ, CE6885, CE6885-LL (standard forwarding mode), CE6885-SAN, CE6885-T, CE8851-32CQ4BQ, CE8855</span>.)</span><p><pre class="screen"><a href="cmdqueryname=mice-flow+packet-number"><b><span class="cmdname">mice-flow packet-number</span></b></a> <i><span class="varname">number</span></i></pre>
<div class="p">By default, the first 128 packets in a flow are identified as a mice flow in differentiated flow scheduling.<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If you configure the first <em>N</em> packets in a flow to be identified as a mice flow during traffic transmission, packets may become out of order. Therefore, you are advised to stop traffic transmission before configuring it.</p>
</div></div>
</div>
</p></li><li><span>(Optional) Configure the scheduling mode. (This command is available only on the <span>CE6820H, CE6820H-K, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6820S</span>.)</span><p><pre class="screen"><strong><a href="cmdqueryname=scheduling-mode"><b><span class="cmdname">scheduling-mode</span></b></a> <strong><span>hybrid</span></strong></strong></pre>
<p>The hybrid mode is used for performance optimization in hybrid scheduling scenarios. For example, it can effectively optimize performance in the scenario where TCP and UDP are used together in NVMe over TCP.</p>
</p></li><li><span>Exit the mice-elephant-flow view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li><span>Exit the AI service view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li><span>Enter the interface view.</span><p><pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></pre>
</p></li><li><span>Enable differentiated flow scheduling on the interface.</span><p><pre class="screen"><a href="cmdqueryname=mice-elephant-flow+enable"><b><span class="cmdname">mice-elephant-flow enable</span></b></a></pre>
<p>By default, differentiated flow scheduling is disabled on an interface.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>For the <span>CE6820H, CE6820H-K, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6820S</span>:</p>
<ul><li>If the <strong>assign queue adjust</strong> command has been run to specify the queue for which differentiated flow scheduling is to be enabled and the <strong>flex-buffer enable</strong> command has been run to enable the TCP FlexBuffer function, differentiated flow scheduling can be enabled on an interface only when the dynamic threshold of the queue-level service buffer for elephant-flow queues on the interface is set to 9 using the <strong>qos buffer queue</strong> <em>queue-index</em> <strong>shared-threshold dynamic</strong> <em>dynamic-value</em> command. You can run the <strong>display mice-elephant-flow configuration</strong> command to view information about interfaces and queues for which differentiated flow scheduling is enabled.</li><li>If the <strong>assign queue adjust</strong> command has been run to specify the queue for which differentiated flow scheduling is to be enabled and the <strong>flex-buffer enable</strong> command has been run to enable the TCP FlexBuffer function, differentiated flow scheduling can be enabled on an interface only when no WRED profile is configured for elephant-flow queues on the interface.</li></ul>
</div></div>
</p></li><li><span>Exit the interface view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_ai_dpp_cfg_0001.html">Differentiated Flow Scheduling Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="spec/Differentiated_Flow_Scheduling_limitation_CE_v6r23c00.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_ai_dpp_cfg_0008.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>