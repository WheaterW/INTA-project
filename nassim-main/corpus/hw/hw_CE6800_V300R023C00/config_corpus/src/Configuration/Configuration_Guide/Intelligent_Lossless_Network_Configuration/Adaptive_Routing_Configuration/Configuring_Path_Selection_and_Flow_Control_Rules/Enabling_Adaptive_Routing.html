
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Enabling Adaptive Routing">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_adaptive_routing_cfg_0022.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_adaptive_routing_cfg_0023.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_adaptive_routing_cfg_0015.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Dragonfly Adaptive Routing">
<meta name="featurename" content="Adaptive Routing">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Dragonfly Adaptive Routing">
<meta name="featurename" content="Adaptive Routing">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="featurename" content="Dragonfly Adaptive Routing">
<meta name="featurename" content="Adaptive Routing">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="featuretype" content="Intelligent Lossless Network">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001513030426">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Enabling Adaptive Routing</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001513030426"></a><a name="EN-US_TASK_0000001513030426"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Enabling Adaptive Routing</h1>
<div class="taskbody"><p></p>
<div class="context"><a name="EN-US_TASK_0000001513030426__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>To enable adaptive routing, enable it globally, enable it on an interface, and then configure the role of the interface in the direct topology.</p>
<p>The adaptive routing function can be configured only in the dragonfly topology and takes effect only when other devices in the topology are correctly configured.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001513030426__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enable global adaptive routing.</span><p><pre class="screen"><strong><a href="cmdqueryname=adaptive-routing+enable"><b><span class="cmdname">adaptive-routing enable</span></b></a></strong></pre>
<p>By default, global adaptive routing is disabled.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>The interval between enabling and disabling global adaptive routing must be greater than 300 seconds.</li><li>The <strong><a href="cmdqueryname=adaptive-routing+enable"><b><span class="cmdname">adaptive-routing enable</span></b></a></strong> and <strong><a href="cmdqueryname=load-balance+ecmp+stateful+enable"><b><span class="cmdname">load-balance ecmp stateful enable</span></b></a></strong> commands cannot both be run on a device.</li><li>The <strong><a href="cmdqueryname=adaptive-routing+enable"><b><span class="cmdname">adaptive-routing enable</span></b></a></strong> and <strong><a href="cmdqueryname=vxlan-overlay+local-preference+enable"><b><span class="cmdname">vxlan-overlay local-preference enable</span></b></a></strong> commands cannot both be run on a device.</li><li>When global adaptive routing is disabled, adaptive routing is disabled on all interfaces that have the adaptive routing function enabled, and the role configurations on these interfaces are also deleted.</li></ul>
</div></div>
</p></li><li><span>Enter the interface view.</span><p><pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></pre>
</p></li><li><span>Switch the interface working mode to Layer 3.</span><p><pre class="screen" id="EN-US_TASK_0000001513030426__en-us_task_0228023023_screen166833536478"><a href="cmdqueryname=undo+portswitch"><b><span class="cmdname" id="EN-US_TASK_0000001513030426__en-us_task_0228023023_cmdname182821059820">undo portswitch</span></b></a></pre>
<p id="EN-US_TASK_0000001513030426__en-us_task_0228023023_p18457174912148">Determine whether to perform this step based on the current interface working mode.</p>
</p></li><li><span>Enable adaptive routing on the interface and configure the role of the interface in the direct topology.</span><p><pre class="screen"><strong><a href="cmdqueryname=adaptive-routing+enable+dragonfly-role"><b><span class="cmdname">adaptive-routing enable dragonfly-role</span></b></a></strong> { <strong>global</strong> | <strong>local</strong> }</pre>
</p><p><p>By default, adaptive routing is disabled on an interface, and the role of the interface in the direct topology is not configured.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>If adaptive routing is enabled globally on a device, an interface is added to a direct topology and participates in adaptive routing calculation only if the role of the interface is configured in the direct topology.</li><li>If PFC or antilocking PFC has been enabled on an interface, PFC resources on the interface are occupied. To release PFC resources on the interface, disable PFC or antilocking PFC on the interface and restart the device.</li><li>This command can be delivered only to physical interfaces. It cannot be delivered to split interfaces or logical interfaces such as sub-interfaces, Eth-Trunk interfaces, VLANIF interfaces, and VBDIF interfaces.</li></ul>
<p>For the CE8851-32CQ8DQ-P, CE8850-SAN, CE8851K, and CE8850-HAM:</p>
<ul><li>PFC and dragonfly antilocking PFC cannot be both enabled on an interface.</li><li>Antilocking PFC and dragonfly antilocking PFC cannot be both enabled on an interface.</li><li>On an interface, dragonfly antilocking PFC for priority queue 1 is mutually exclusive with differentiated flow scheduling for any queue.</li><li>In a priority queue of an interface, dragonfly antilocking PFC is mutually exclusive with differentiated flow scheduling.</li><li>Currently, PFC or antilocking PFC can be enabled on a maximum of 127 interfaces. If the accumulated number of interfaces where PFC or antilocking PFC has been enabled has reached 127, disable the delivered configurations to reduce the number of such interfaces and restart the device. Then you can enable PFC or antilocking PFC on more interfaces.</li></ul>
<p>For the CE8855 and CE8851-32CQ4BQ:</p>
<p>If dragonfly deadlock prevention has been enabled, you must enable PFC for the priority queue corresponding to the deadlock prevention function on the interface before running this command to configure the role of the interface in the direct topology.</p>
</div></div>
</p></li><li><span>Exit the interface view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001513030426__en-us_task_0228023023_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001513030426__en-us_task_0228023023_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_adaptive_routing_cfg_0022.html">Configuring Path Selection and Flow Control Rules
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_adaptive_routing_cfg_0023.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_adaptive_routing_cfg_0015.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>