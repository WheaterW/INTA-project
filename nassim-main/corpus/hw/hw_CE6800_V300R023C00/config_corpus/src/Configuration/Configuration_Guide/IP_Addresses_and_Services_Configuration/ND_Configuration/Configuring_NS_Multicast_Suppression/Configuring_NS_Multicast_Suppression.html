
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring NS Multicast Suppression">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_nd_cfg_0058.html">
<meta name="DC.Relation" scheme="URI" content="vrp_nd_cfg_0059.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130622518">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring NS Multicast Suppression</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130622518"></a><a name="EN-US_TASK_0000001130622518"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring NS Multicast Suppression</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001130622518__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>On an IPv6 overlay network, IPv6 host neighbor discovery is implemented through NS multicast. When a gateway receives an NS message for IPv6 address resolution, it multicasts the message in its BD. If the gateway forwards a large number of NS messages that are received within a period of time, excessive VXLAN resources are consumed, affecting normal services. To address this issue, configure NS multicast suppression. After this function is configured, the gateway checks whether it can obtain the destination user information in a received NS message. If so, it performs proxy ND or multicast-to-unicast processing to reduce or suppress NS message flooding.</p>
<p>NS multicast suppression can also prevent ND spoofing attacks. In an ND spoofing attack, an attacker associates its MAC address with the IPv6 address of a host so that all traffic destined for the IPv6 address is sent to the attacker. After NS multicast suppression is enabled, an IPv6 address conflict alarm is generated through proxy ND table conflict detection to notify users of possible ND spoofing attacks.</p>
<p>Only VXLAN gateways support this function. For details about VXLAN support, see "<a href="spec/VXLAN_limitation_23.0.html">Configuration Precautions for VXLAN</a>" in VXLAN Configuration.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130622518__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the BD view.</span><p><pre class="screen"><a href="cmdqueryname=bridge-domain"><b><span class="cmdname">bridge-domain</span></b></a> <i><span class="varname">bd-id</span></i> </pre>
</p></li><li><span>Enable IPv6.</span><p><pre class="screen"><a href="cmdqueryname=ipv6+enable"><b><span class="cmdname">ipv6 enable</span></b></a></pre>
</p></li><li><span>Enable NS multicast suppression.</span><p><pre class="screen"><a href="cmdqueryname=ipv6+nd+multicast-suppress+%7B+proxy-reply+%5B+unknown-options-unicast+%5D+%7C+unicast-forward+%7D+%5B+mismatch-discard+%5D+enable"><b><span class="cmdname">ipv6 nd multicast-suppress { proxy-reply [ unknown-options-unicast ] | unicast-forward } [ mismatch-discard ] enable</span></b></a></pre>
</p></li><li><span>Configure proxy ND parameters.</span><p>
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Configure proxy ND parameters.</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.5.2.1.2.4.1.1" liSelected="liSelected"><p>Operation</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.5.2.1.2.4.1.2" liSelected="liSelected"><p>Command</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.5.2.1.2.4.1.3" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.5.2.1.2.4.1.1 "><p>Configure the R flag for NA messages when proxy ND is performed.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.5.2.1.2.4.1.2 "><p><a href="cmdqueryname=ipv6+nd+multicast-suppress"><b><span class="cmdname">ipv6 nd multicast-suppress</span></b></a> { <strong><span>host</span></strong> | <strong><span>router</span></strong> }</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.5.2.1.2.4.1.3 "><p>During interconnection with a non-Huawei device, if the proxy ND entries that the local device synchronizes from the remote device through EVPN routes do not carry the R flag, the local device cannot determine whether the device that replies with an NA message is a routing device or host. To allow the local device to make this determination, configure the R flag for NA messages.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.5.2.1.2.4.1.1 "><p>Configure the maximum number of dynamic proxy ND entries that can be learned in a BD.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.5.2.1.2.4.1.2 "><p><a href="cmdqueryname=ipv6+nd+multicast-suppress+dynamic+limit"><b><span class="cmdname">ipv6 nd multicast-suppress dynamic limit</span></b></a> <i><span class="varname">limit-value</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.5.2.1.2.4.1.3 "><p>When an attacker sends a large number of RA messages to attack a device, the device learns a large number of dynamic proxy ND entries within a short period of time. As a result, the CPU usage increases quickly, and a large amount of memory resources are consumed. To limit the maximum number of dynamic proxy ND entries that can be learned in a BD, run this command. This effectively prevents the overflow of dynamic proxy ND entries and ensures normal device running.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.5.2.1.2.4.1.1 "><p>Configure an aging time for dynamic proxy ND entries.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.5.2.1.2.4.1.2 "><p><a href="cmdqueryname=ipv6+nd+multicast-suppress+dynamic+expire-time"><b><span class="cmdname">ipv6 nd multicast-suppress dynamic expire-time</span></b></a> <i><span class="varname">expire-time-value</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.5.2.1.2.4.1.3 "><p>Every dynamic proxy ND entry has a lifecycle, which is also called aging time. If a dynamic proxy ND entry is not updated after its lifecycle ends, this entry is deleted from the proxy ND table. If the entry is updated before its lifecycle ends, its aging time is recalculated. This command ensures that dynamic proxy ND entries are promptly updated.</p>
</td>
</tr>
</tbody>
</table>
</div>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001130622518__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001130622518__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li><li><span>Enable the device to flood a proxy ND table or ND table through EVPN routes.</span><ul><li>If no Layer 3 gateway exists, perform the following operations:<ol type="a"><li>Enter the system view.<pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</li><li>Enter the BD view.<pre class="screen"><a href="cmdqueryname=bridge-domain"><b><span class="cmdname">bridge-domain</span></b></a> <i><span class="varname">bd-id</span></i></pre>
</li><li>Enable IPv6.<pre class="screen"><a href="cmdqueryname=ipv6+enable"><b><span class="cmdname">ipv6 enable</span></b></a></pre>
</li><li>Enable the device to flood a proxy ND table through EVPN routes.<pre class="screen"><a href="cmdqueryname=ipv6+nd+collect+host+enable"><b><span class="cmdname">ipv6 nd collect host enable</span></b></a></pre>
</li><li>Commit the configuration.<pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</li></ol>
</li><li>If a Layer 3 gateway exists, perform the following operations:<ol type="a"><li>Enter the system view.<pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</li><li>Enter the VBDIF interface view.<pre class="screen"><a href="cmdqueryname=interface+vbdif"><b><span class="cmdname">interface vbdif</span></b></a> <i><span class="varname">bd-id</span></i></pre>
</li><li>Enable IPv6.<pre class="screen"><a href="cmdqueryname=ipv6+enable"><b><span class="cmdname">ipv6 enable</span></b></a></pre>
</li><li>Enable the device to flood an ND table through EVPN routes.<pre class="screen"><a href="cmdqueryname=ipv6+nd+collect+host+enable"><b><span class="cmdname">ipv6 nd collect host enable</span></b></a></pre>
</li><li>Commit the configuration.<pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</li></ol>
</li></ul>
</li><li><span>Configure BGP EVPN to advertise routes.</span><ol type="a"><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the BGP view or BGP multi-instance view.</span><p><pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i> [ <strong><span>instance</span></strong> <i><span class="varname">instance-name</span></i> ]</pre>
</p></li><li class="substepexpand"><span>Enter the BGP-EVPN address family view or BGP multi-instance EVPN address family view.</span><p><pre class="screen"><a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname">l2vpn-family evpn</span></b></a></pre>
</p></li><li class="substepexpand"><span>Configure IRBv6 or ND route advertisement.</span><p><pre class="screen"><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>advertise</span></strong> { <strong><span>irbv6</span></strong> | <strong><span>nd</span></strong> }</pre>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001130622518__en-us_task_0234857734_screen14848162118611"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001130622518__en-us_task_0234857734_cmdname1784862115612">commit</span></b></a></pre>
</p></li></ol>
</li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001130622518__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+ipv6+nd+multicast-suppress+bridge-domain"><b><span class="cmdname">display ipv6 nd multicast-suppress bridge-domain</span></b></a> [ <i><span class="varname">bd-id</span></i> ] [ <strong><span>verbose</span></strong> ] command to check information about the proxy ND table in the BD.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_nd_cfg_0058.html">Configuring NS Multicast Suppression
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_nd_cfg_0059.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>