
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring OSPF Load Balancing">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0095.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0220.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130783236">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Configuring OSPF Load Balancing</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130783236"></a><a name="EN-US_TASK_0000001130783236"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring OSPF Load Balancing</h1>
<div class="taskbody"><div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001130783236__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before configuring OSPF load balancing, you have completed the following task:</p>
<ul><li><a href="vrp_ospf_cfg_0010.html">Configure basic OSPF functions</a>.</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130783236__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">OSPF Load Balancing Conditions</h4><p>When the number of OSPF routes allowed to participate in load balancing and the number of routes on the device that are allowed to participate in load balancing are both greater than 1 and multiple OSPF routes with the same prefix exist on the device, these OSPF routes work in load balancing mode if the following conditions are met:</p>
<ul><li>The OSPF route types (intra-area, inter-area, Type 1 external, or Type 2 external) are the same.</li><li>The direct next hops are different.</li><li>The costs are the same.</li><li>In the case of Type 2 external routes, the costs of the paths to the ASBR/forwarding address must be the same.</li><li>If OSPF selects routes according to the rules defined in related standards, the area IDs must be the same.</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130783236__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>You can set the maximum number of OSPF equal-cost routes and preferences to implement load balancing and adjust route selection. If the destinations and costs of the multiple routes discovered by a routing protocol are the same, load balancing can be implemented among the routes.</p>
<p>On the network shown in <a href="#EN-US_TASK_0000001130783236__fig_dc_vrp_ospf_cfg_003901">Figure 1</a>, three routes between DeviceA and DeviceB that run OSPF have the same cost. The three routes are equal-cost routes and are used for load balancing.</p>
<div class="fignone" id="EN-US_TASK_0000001130783236__fig_dc_vrp_ospf_cfg_003901"><a name="EN-US_TASK_0000001130783236__fig_dc_vrp_ospf_cfg_003901"></a><a name="fig_dc_vrp_ospf_cfg_003901"></a><span class="figcap"><b>Figure 1 </b>Network diagram of equal-cost routes</span><br><span><img class="vsd" src="figure/en-us_image_0000001130623526.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130783236__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the OSPF view.</span><p><pre class="screen"><a href="cmdqueryname=ospf"><b><span class="cmdname">ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ]</pre>
</p></li><li><span>Set the maximum number of equal-cost routes that can be used for load balancing.</span><p><pre class="screen"><a href="cmdqueryname=maximum+load-balancing"><b><span class="cmdname">maximum load-balancing</span></b></a> <i><span class="varname">number</span></i></pre>
<p>If the number of equal-cost routes is greater than the number specified in the <a href="cmdqueryname=maximum+load-balancing"><b><span class="cmdname">maximum load-balancing</span></b></a> <i><span class="varname">number</span></i> command, valid routes are selected for load balancing based on the following criteria:</p>
<ol type="a"><li>Next-hop weight: OSPF selects the routes with higher next-hop priorities (smaller weights) for load balancing. For details about the configuration, see Step 4.</li><li>Index of the outbound interface corresponding to a next hop: If the next-hop weights of the candidate routes are the same, OSPF compares the indexes of the outbound interfaces corresponding to the next hops and selects the routes with larger outbound interface indexes for load balancing.</li><li>Next-hop IP address: If the candidate routes have the same next-hop weight and outbound interface index, OSPF selects the routes with larger next-hop IP addresses for load balancing.</li></ol>
</p></li><li><span>(Optional) Set a weight for the next hop of an equal-cost route.</span><p><pre class="screen"><a href="cmdqueryname=nexthop"><b><span class="cmdname">nexthop</span></b></a> <i><span class="varname">ip-address</span></i> <strong><span>weight</span></strong> <i><span class="varname">value</span></i></pre>
<p>You can run the <a href="cmdqueryname=nexthop+weight+%28OSPFv3+view%29"><b><span class="cmdname">nexthop</span></b></a> command to set a weight for the next hop of each OSPF equal-cost route so that OSPF selects the routes with higher next-hop priorities for load balancing.</p>
<ul><li><i><span class="varname">ip-address</span></i> specifies the next-hop IP address of an equal-cost route.</li><li><i><span class="varname">value</span></i> specifies a weight value for the next hop. The smaller the weight value, the higher the priority. The default weight value is 255.</li></ul>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001130783236__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001130783236__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001130783236__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ul><li>Run the <a href="cmdqueryname=display+ospf"><b><span class="cmdname">display ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ] <strong><span>routing</span></strong> command to check information about the OSPF routing table. The command output shows information about equal-cost routes.</li><li>Run the <a href="cmdqueryname=display+ospf"><b><span class="cmdname">display ospf</span></b></a> [ <i><span class="varname">process-id</span></i> ] <strong><span>ecmp-group</span></strong> command to check information about OSPF ECMP groups.</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_ospf_cfg_0095.html">Configuring OSPF Load Balancing
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_ospf_cfg_0220.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>