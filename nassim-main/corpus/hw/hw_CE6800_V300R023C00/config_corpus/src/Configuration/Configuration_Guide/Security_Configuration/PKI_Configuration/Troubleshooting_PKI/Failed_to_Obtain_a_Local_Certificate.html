
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Failed to Obtain a Local Certificate">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="security_pki_cfg_0049.html">
<meta name="DC.Relation" scheme="URI" content="security_pki_cfg_0050.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="PKI">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="Security Protection">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="PKI">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="Security Protection">
<meta name="featurename" content="PKI">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="Security Protection">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="Security Protection">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001563766373">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Failed to Obtain a Local Certificate</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001563766373"></a><a name="EN-US_TASK_0000001563766373"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Failed to Obtain a Local Certificate</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001563766373__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Fault Symptom</h4><ul><li><p>A local certificate has been manually obtained in offline mode but does not exist in the device storage. The possible causes are as follows:</p>
<ul><li><p>The PKI entity is incorrect.</p>
</li><li><p>The challenge password is incorrect or not configured.</p>
</li><li><p>The configuration for local certificate download using <span>LDAP</span> is incorrect.</p>
</li></ul>
</li><li><p>A local certificate has been manually obtained using <span>CMPv2</span> but does not exist in the device storage. The possible causes are as follows:</p>
<ul><li><p>No CA certificate exists in the PKI realm.</p>
</li><li><p>The PKI entity is incorrectly configured or not configured.</p>
</li><li><p>The trusted CA name is incorrect or not configured.</p>
</li><li><p>The certificate enrollment server URL is incorrect or not configured.</p>
</li><li><p>The RSA key pair is not configured.</p>
</li><li><p>The source interface for TCP connection is incorrect.</p>
</li><li><p>The digest algorithm used for signing the certificate enrollment request is incorrect.</p>
</li><li><p>The challenge password is incorrect or not configured.</p>
</li><li><p>The reference and secret values of the message authentication code are incorrect or not configured.</p>
</li><li><p>The certificate for identity verification is incorrect.</p>
</li></ul>
</li></ul>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0000001563766373__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>If the local certificate is obtained manually:</span><ol><li class="substepexpand"><span>Check whether the PKI entity is correct.</span><p><p>To view the configuration of a PKI entity in a PKI realm, run the <a href="cmdqueryname=display+pki+entity"><b><span class="cmdname">display pki entity</span></b></a> command.</p>
<p>Modify the incorrect configurations, such as the country code.</p>
</p></li><li class="substepexpand"><span>Check whether the challenge password is correct.</span><p><p>Check whether the CA server requires a challenge password. If so, configure the challenge password to be the same as that of the CA server. To set the challenge password, run the <a href="cmdqueryname=pki+enroll-certificate"><b><span class="cmdname">pki enroll-certificate</span></b></a> command.</p>
</p></li><li class="substepexpand"><span>Check whether the configuration for local certificate download using <span>LDAP</span> is correct.</span><p><p>If not, correct the configuration by running the <a href="cmdqueryname=pki+ldap-server-template"><b><span class="cmdname">pki ldap-server-template</span></b></a> <i><span class="varname">template-name</span></i> <strong><span>attribute</span></strong> <i><span class="varname">attr-value</span></i> <i><span class="varname">save-name</span></i> <strong><span>dn</span></strong> <i><span class="varname">dn-value</span></i> command.</p>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001563766373__en-us_task_0232035842_screen14848162118611"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001563766373__en-us_task_0232035842_cmdname1784862115612">commit</span></b></a></pre>
</p></li></ol>
</li><li><span>If the local certificate is obtained using <span>CMPv2</span>:</span><ol><li class="substepexpand"><span>Check whether the CA certificate has been imported into the device memory.</span><p><p>To view the CA certificate in the device memory, run the <a href="cmdqueryname=display+pki+certificate"><b><span class="cmdname">display pki certificate</span></b></a> command.</p>
<p>If no CA certificate exists, obtain a CA certificate and run the <a href="cmdqueryname=pki+import-certificate"><b><span class="cmdname">pki import-certificate</span></b></a> command to import the CA certificate into the device memory.</p>
</p></li><li class="substepexpand"><span>Check whether the PKI entity is correct.</span><p><p>To view the configuration of a PKI entity in a PKI realm, run the <a href="cmdqueryname=display+pki+entity"><b><span class="cmdname">display pki entity</span></b></a> command.</p>
<p>Modify the incorrect configurations, such as the country code.</p>
</p></li><li class="substepexpand"><span>Check whether the CA certificate application configuration is correct in the PKI realm.</span><p><p>Run the <a href="cmdqueryname=display+this"><b><span class="cmdname">display this</span></b></a> command in the CMP session view.</p>
<div class="p">The following is a sample of CA certificate application configuration:<pre class="screen">pki cmp session cmp                                                             
 cmp-request ca-name "C=cn,ST=beijing,L=SD,O=BB,OU=BB,CN=BB"   //Configure a CA name. The field sequence in the CA name must be the same as that in the actual CA certificate.  
 cmp-request authentication-cert local.cer   //Configure a certificate for identity authentication in a CMPv2 request, which is used to update a certificate or apply for a certificate for another device.  
 cmp-request entity user01   //Specify the PKI entity to be used.  
 cmp-request server url http://10.3.0.1:8080   //Configure the URL of the CMPv2 server.  
 cmp-request rsa local-key-pair rsa regenerate   //Specify the RSA key pair to be used.  
 cmp-request message-authentication-code 1234 %^%#ZodFBGH[^BkU2(<font style="font-size:8pt" Face="Courier New" >~</font>&gt;[NRBv|#b&gt;se|@I7"'A,llG_B%^%#   //Configure the reference value and secret value of the message authentication code to be the same as those on the CA server.</pre>
</div>
<p>Correct the configuration if it is incorrect.</p>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001563766373__en-us_task_0232035842_screen14848162118611_1"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001563766373__en-us_task_0232035842_cmdname1784862115612_1">commit</span></b></a></pre>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="security_pki_cfg_0049.html">Troubleshooting PKI
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="security_pki_cfg_0050.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>