
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Understanding Association between VRRP6 and BFD for IPv6">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp6_cfg_0039.html">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp6_cfg_0041.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VRRP6">
<meta name="featuretype" content="High Availability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VRRP6">
<meta name="featuretype" content="High Availability">
<meta name="featurename" content="VRRP6">
<meta name="featuretype" content="High Availability">
<meta name="featuretype" content="High Availability">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001130622230">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Understanding Association between VRRP6 and BFD for IPv6</title>
</head>
<body><a name="EN-US_CONCEPT_0000001130622230"></a><a name="EN-US_CONCEPT_0000001130622230"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Understanding Association between VRRP6 and BFD for IPv6</h1>
<div><div class="section"><h4 class="sectiontitle">Application Scenarios</h4><p>After a VRRP6 group is configured, VRRP6 devices negotiate the master/backup state through VRRP6 Advertisement packets. If an interface or a link fails, or the network topology changes, devices in the VRRP6 group cannot immediately detect the failure or change. Consequently, the master/backup VRRP switchover is delayed. To resolve this problem, configure VRRP6 association. If an object associated with a VRRP6 group fails, the VRRP6 group is notified and performs a master/backup VRRP switchover. VRRP6 association ensures proper traffic forwarding and improves link reliability.</p>
<p>BFD can rapidly detect link faults. You can associate a VRRP6 group with a BFD for IPv6 session. If a link fault occurs, the BFD for IPv6 session detects the fault, changes the session status, and notifies the VRRP6 group of the fault. This process triggers a rapid master/backup VRRP switchover.</p>
<div class="p"><a href="#EN-US_CONCEPT_0000001130622230__tab_dc_vrp_vrrp6_cfg_012201">Table 1</a> describes VRRP6 and BFD for IPv6 association modes.
<div class="tableBorder"><a name="EN-US_CONCEPT_0000001130622230__tab_dc_vrp_vrrp6_cfg_012201"></a><a name="tab_dc_vrp_vrrp6_cfg_012201"></a><table cellpadding="4" cellspacing="0" summary="" id="EN-US_CONCEPT_0000001130622230__tab_dc_vrp_vrrp6_cfg_012201" frame="border" border="1" rules="all"><caption><b>Table 1 </b>VRRP6 and BFD for IPv6 association modes</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="11.058894110588945%" id="mcps1.3.1.4.2.2.5.1.1" liSelected="liSelected"><p>Association Mode</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="37.36626337366264%" id="mcps1.3.1.4.2.2.5.1.2" liSelected="liSelected"><p>Application Scenario</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="31.916808319168087%" id="mcps1.3.1.4.2.2.5.1.3" liSelected="liSelected"><p>Impact</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="19.658034196580346%" id="mcps1.3.1.4.2.2.5.1.4" liSelected="liSelected"><p>Device Requirement</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="11.058894110588945%" headers="mcps1.3.1.4.2.2.5.1.1 "><p>Association between a VRRP6 group and a common BFD for IPv6 session</p>
</td>
<td class="cellrowborder" valign="top" width="37.36626337366264%" headers="mcps1.3.1.4.2.2.5.1.2 "><p>The backup device monitors the status of the master device in a VRRP6 group. The BFD for IPv6 session monitors the status of the link between the master and backup devices.</p>
</td>
<td class="cellrowborder" valign="top" width="31.916808319168087%" headers="mcps1.3.1.4.2.2.5.1.3 "><p>The VRRP6 group adjusts the priority according to the BFD for IPv6 session status and determines whether to perform a master/backup VRRP switchover based on the adjusted priority.</p>
</td>
<td class="cellrowborder" valign="top" width="19.658034196580346%" headers="mcps1.3.1.4.2.2.5.1.4 "><p>VRRP6 devices must support BFD for IPv6.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="11.058894110588945%" headers="mcps1.3.1.4.2.2.5.1.1 "><p>Association between a VRRP6 group and link and peer BFD sessions for IPv6</p>
</td>
<td class="cellrowborder" valign="top" width="37.36626337366264%" headers="mcps1.3.1.4.2.2.5.1.2 "><p>The master and backup devices monitor the link and peer BFD sessions simultaneously. A link BFD for IPv6 session is established between the master and backup devices; a peer BFD for IPv6 session is established between a downstream device and each VRRP6 device. BFD for IPv6 helps determine whether the fault occurs between the master device and downstream device or between the backup device and downstream device.</p>
</td>
<td class="cellrowborder" valign="top" width="31.916808319168087%" headers="mcps1.3.1.4.2.2.5.1.3 "><p>If the link or peer BFD for IPv6 session status changes, BFD for IPv6 notifies the VRRP6 group of the change, and the VRRP6 group immediately performs a master/backup switchover.</p>
</td>
<td class="cellrowborder" valign="top" width="19.658034196580346%" headers="mcps1.3.1.4.2.2.5.1.4 "><p>VRRP6 devices and the downstream device must support BFD for IPv6.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section"><h4 class="sectiontitle">Association Between a VRRP6 Group and a Common BFD for IPv6 Session</h4><p>In <a href="#EN-US_CONCEPT_0000001130622230__fig_dc_vrp_vrrp_feature_011004">Figure 1</a>, a BFD for IPv6 session is established between DeviceA (master) and DeviceB (backup) and is bound to a VRRP6 group. If BFD for IPv6 detects a fault on the link between DeviceA and DeviceB, BFD for IPv6 notifies DeviceB to increase its priority so that it assumes the master role and forwards service traffic.</p>
<div class="fignone" id="EN-US_CONCEPT_0000001130622230__fig_dc_vrp_vrrp_feature_011004"><a name="EN-US_CONCEPT_0000001130622230__fig_dc_vrp_vrrp_feature_011004"></a><a name="fig_dc_vrp_vrrp_feature_011004"></a><span class="figcap"><b>Figure 1 </b>Network diagram of associating a VRRP6 group with a common BFD for IPv6 session</span><br><span><img class="vsd" src="figure/en-us_image_0000001176741699.png" width="NaN" height="NaN"></span></div>
<p>VRRP6 device configurations are as follows:</p>
<ul><li>DeviceA (master) works in delayed preemption mode and its priority is 120.</li><li>DeviceB works in immediate preemption mode and functions as the backup in the VRRP6 group with a priority of 100.</li><li>DeviceB in the VRRP6 group is configured to monitor a common BFD for IPv6 session. If BFD for IPv6 detects a fault and the BFD for IPv6 session goes down, DeviceB increases its priority by 40.</li></ul>
<p>The implementation is as follows:</p>
<ol><li>Normally, DeviceA periodically sends VRRP6 Advertisement packets to notify DeviceB that it is working properly. DeviceB monitors the status of DeviceA and the BFD for IPv6 session.</li><li>If BFD for IPv6 detects a fault, the BFD for IPv6 session goes down. DeviceB increases its priority to 140 (100 + 40 = 140), making it higher than DeviceA's priority. DeviceB then immediately preempts the master role and sends NA messages to allow DeviceE to update address entries.</li><li><p>The BFD session goes up after the fault is rectified. In this case:</p>
<p>DeviceB restores its priority to 100 (140 â 40 = 100). DeviceB remains in the Master state and continues to send VRRP6 Advertisement packets.</p>
<p>After receiving these packets, DeviceA checks that the priority carried in them is lower than the local priority and preempts the master role after the specified VRRP6 status recovery delay expires. DeviceA then sends VRRP6 Advertisement and NA messages.</p>
<p>After receiving a VRRP6 Advertisement packet that carries a priority higher than the local priority, DeviceB enters the Backup state.</p>
</li><li>Both DeviceA and DeviceB are restored to their original statuses. As such, DeviceA forwards user-to-network traffic again.</li></ol>
<p>The preceding process shows that association between VRRP6 and BFD for IPv6 differs from VRRP6. Specifically, after a VRRP6 group is associated with a BFD for IPv6 session and a fault occurs, the backup device immediately preempts the master role by increasing its priority, and it does not wait for a period three times the interval at which VRRP Advertisement packets are sent. This means that a master/backup VRRP switchover can be performed in milliseconds.</p>
</div>
<div class="section"><h4 class="sectiontitle">Association Between VRRP6 and Link and Peer BFD Sessions for IPv6</h4><p>In <a href="#EN-US_CONCEPT_0000001130622230__fig4387201554615">Figure 2</a>, the master and backup devices monitor the status of link and peer BFD sessions for IPv6. The BFD sessions for IPv6 help determine whether a link fault is a local or remote fault.</p>
<p>DeviceA and DeviceB run VRRP. A peer BFD for IPv6 session is established between DeviceA and DeviceB to detect link and device faults. A link BFD for IPv6 session is established between DeviceA and DeviceE and between DeviceB and DeviceE to detect link and device faults. After DeviceB detects that the peer BFD for IPv6 session goes down and the link BFD for IPv6 session between DeviceE and DeviceB goes up, DeviceB switches to the Master state and forwards user-to-network traffic.</p>
<div class="fignone" id="EN-US_CONCEPT_0000001130622230__fig4387201554615"><a name="EN-US_CONCEPT_0000001130622230__fig4387201554615"></a><a name="fig4387201554615"></a><span class="figcap"><b>Figure 2 </b>Network diagram of associating a VRRP6 group with link and peer BFD sessions for IPv6</span><br><span><img class="vsd" src="figure/en-us_image_0000001176741701.png" width="NaN" height="NaN"></span></div>
<p>VRRP6 device configurations are as follows:</p>
<ul><li>DeviceA and DeviceB run VRRP.</li><li>A peer BFD for IPv6 session is established between DeviceA and DeviceB to detect link and device faults.</li><li>Link 1 and link 2 BFD sessions for IPv6 are established between DeviceE and DeviceA and between DeviceE and DeviceB to detect link and device faults.</li></ul>
<p>The implementation is as follows:</p>
<ol><li>Normally, DeviceA periodically sends VRRP6 Advertisement packets to inform DeviceB that it is working properly and monitors the BFD for IPv6 session status. DeviceB monitors the status of DeviceA and the BFD for IPv6 session.</li><li>If BFD for IPv6 detects a fault, the BFD for IPv6 session goes down. The BFD session goes down if BFD detects either of the following faults:<ul><li><p>Link 1 or DeviceE fails. In this case, link 1 BFD for IPv6 session and the peer BFD for IPv6 session go down. Link 2 BFD for IPv6 session is up.</p>
<p>DeviceA's VRRP6 status switches to Initialize.</p>
<p>DeviceB's VRRP6 status switches to Master.</p>
</li><li><p>DeviceA fails. In this case, link 1 BFD for IPv6 session and the peer BFD for IPv6 session go down. Link 2 BFD for IPv6 session is up. DeviceB's VRRP6 status switches to Master.</p>
</li></ul>
</li><li>After the fault is rectified, all the BFD sessions for IPv6 go up. If DeviceA works in preemption mode, DeviceA and DeviceB are restored to their original VRRP6 statuses after VRRP6 negotiation is complete.</li></ol>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>DeviceA's VRRP6 status is not impacted by a link 2 fault, instead, DeviceA continues to forward user-to-network traffic. However, DeviceB's VRRP6 status switches to Master if both the peer BFD for IPv6 session and link 2 BFD for IPv6 session go down, and DeviceB detects the peer BFD for IPv6 session down event before detecting the link 2 BFD for IPv6 session down event. After DeviceB detects the link 2 BFD for IPv6 session down event, DeviceB's VRRP6 status switches to Initialize.</p>
</div></div>
<p><a href="#EN-US_CONCEPT_0000001130622230__fig111631710174715">Figure 3</a> shows the state machine for association between a VRRP6 group and link and peer BFD sessions for IPv6.</p>
<div class="fignone" id="EN-US_CONCEPT_0000001130622230__fig111631710174715"><a name="EN-US_CONCEPT_0000001130622230__fig111631710174715"></a><a name="fig111631710174715"></a><span class="figcap"><b>Figure 3 </b>State machine for association between a VRRP6 group and link and peer BFD sessions for IPv6</span><br><span><img class="vsd" src="figure/en-us_image_0000001176661797.png" width="NaN" height="NaN"></span></div>
<p>The preceding process shows that after VRRP6 is associated with link and peer BFD for IPv6, the backup device can immediately switch to the Master state if a fault occurs, without waiting for a period three times the interval at which VRRP6 Advertisement packets are sent or changing its priority. This means that a master/backup VRRP switchover can be performed in milliseconds.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_vrrp6_cfg_0039.html">Configuring Association Between VRRP6 and BFD
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_vrrp6_cfg_0041.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>