
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Defense Against Bogus DHCP Message Attacks">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../toctopics/en-us_task_0000001564000589.html">
<meta name="DC.Relation" scheme="URI" content="../toctopics/en-us_task_0000001512840734.html">
<meta name="DC.Relation" scheme="URI" content="../toctopics/en-us_task_0000001564120397.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="DHCP Snooping">
<meta name="featurename" content="VLAN">
<meta name="featurename" content="VLAN Mapping">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="DHCP Snooping">
<meta name="featurename" content="VLAN">
<meta name="featurename" content="VLAN Mapping">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="DHCP Snooping">
<meta name="featurename" content="VLAN">
<meta name="featurename" content="VLAN Mapping">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001513160290">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Configuring Defense Against Bogus DHCP Message Attacks</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001513160290"></a><a name="EN-US_TASK_0000001513160290"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Defense Against Bogus DHCP Message Attacks</h1>
<div class="taskbody"><p></p>
<div class="context"><a name="EN-US_TASK_0000001513160290__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>On a DHCP network, if an attacker pretends to be an authorized user and sends DHCP messages to the DHCP server, the authorized user cannot use the IP address or is logged out unexpectedly. After a DHCP snooping binding table is generated, the device checks DHCP messages against the binding table. Only DHCP messages that match entries are forwarded, and those that do not match entries are discarded. This prevents unauthorized users from sending bogus DHCP messages to renew the IP address lease or release IP addresses.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001513160290__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enable the device to check DHCP messages against the binding table.</span><p><ul><li>System view<ol type="a"><li>Enable the device to check DHCP messages from a specified VLAN against the binding table.<pre class="screen"><a href="cmdqueryname=dhcp+snooping+check+dhcp-request+enable"><b><span class="cmdname">dhcp snooping check dhcp-request enable</span></b></a> [ <a href="cmdqueryname=vlan"><b><span class="cmdname">vlan</span></b></a> { <i><span class="varname">vlan-id1</span></i> [ <a href="cmdqueryname=to"><b><span class="cmdname">to</span></b></a> <i><span class="varname">vlan-id2</span></i> ] } &amp;&lt;1-10&gt; ]</pre>
</li><li>Enable the device to check whether the CHADDR field value is the same as the source MAC address in the header of a DHCPREQUEST message in a specified VLAN.<pre class="screen"><a href="cmdqueryname=dhcp+snooping+check+dhcp-chaddr+enable"><b><span class="cmdname">dhcp snooping check dhcp-chaddr enable</span></b></a> [ <a href="cmdqueryname=vlan"><b><span class="cmdname">vlan</span></b></a> { <i><span class="varname">vlan-id1</span></i> [ <a href="cmdqueryname=to"><b><span class="cmdname">to</span></b></a> <i><span class="varname">vlan-id2</span></i> ] } &amp;&lt;1-10&gt; ]</pre>
<p>By default, a device does not check whether the CHADDR field value is the same as the source MAC address in the header of a DHCPREQUEST message.</p>
</li></ol>
</li><li>Interface view<pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i>
<strong>portswitch</strong>
<a href="cmdqueryname=dhcp+snooping+check+dhcp-request+enable"><b><span class="cmdname">dhcp snooping check dhcp-request enable</span></b></a>
<a href="cmdqueryname=dhcp+snooping+check+dhcp-chaddr+enable"><b><span class="cmdname">dhcp snooping check dhcp-chaddr enable</span></b></a> 
<a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</li><li>VLAN view<pre class="screen"><a href="cmdqueryname=vlan"><b><span class="cmdname">vlan</span></b></a> <i><span class="varname">vlan-id</span></i>
<a href="cmdqueryname=dhcp+snooping+check+dhcp-request+enable"><b><span class="cmdname">dhcp snooping check dhcp-request enable</span></b></a>
<a href="cmdqueryname=dhcp+snooping+check+dhcp-chaddr+enable"><b><span class="cmdname">dhcp snooping check dhcp-chaddr enable</span></b></a>
<a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</li></ul>
<p>By default, a device does not check DHCP messages against the binding table.</p>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001513160290__en-us_task_0228023023_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001513160290__en-us_task_0228023023_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../toctopics/en-us_task_0000001564000589.html">Configuring DHCP Snooping Attack Defense
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../toctopics/en-us_task_0000001512840734.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../toctopics/en-us_task_0000001564120397.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>