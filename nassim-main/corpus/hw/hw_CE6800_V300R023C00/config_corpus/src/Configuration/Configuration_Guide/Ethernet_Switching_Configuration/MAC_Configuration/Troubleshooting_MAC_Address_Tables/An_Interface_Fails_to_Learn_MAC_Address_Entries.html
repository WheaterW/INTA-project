
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="An Interface Fails to Learn MAC Address Entries">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_mac_cfg_0042.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="MAC">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MAC">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featurename" content="MAC">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176744395">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<script type="text/javascript" src="public_sys-resources/customQuery.js"></script>
<script type="text/javascript" src="public_sys-resources/colsort.js"></script>

<title>An Interface Fails to Learn MAC Address Entries</title>
</head>
<body><a name="EN-US_TASK_0000001176744395"></a><a name="EN-US_TASK_0000001176744395"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">An Interface Fails to Learn MAC Address Entries</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176744395__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Fault Symptom</h4><p>An interface cannot learn MAC address entries, causing Layer 2 forwarding failures.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176744395__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Check device configuration.</span><p>
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" class="dataTable J_table" data-sorttable="true" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="22.67%" id="mcps1.3.2.1.2.1.1.4.1.1" data-sorttable-type="string" liSelected="liSelected"><span class="filterTh"></span><div class="filterThDiv"><p>Check Item</p>
</div></th>
<th align="left" class="cellrowborder" valign="top" width="33%" id="mcps1.3.2.1.2.1.1.4.1.2" liSelected="liSelected"><p>Check Method</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="44.330000000000005%" id="mcps1.3.2.1.2.1.1.4.1.3" liSelected="liSelected"><p>Follow-up Procedure</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="22.67%" headers="mcps1.3.2.1.2.1.1.4.1.1 "><p>Whether the VLAN that the interface belongs to has been created</p>
</td>
<td class="cellrowborder" valign="top" width="33%" headers="mcps1.3.2.1.2.1.1.4.1.2 "><p>Run the <a href="cmdqueryname=display+vlan"><b><span class="cmdname">display vlan</span></b></a> <i><span class="varname">vlan-id</span></i> command in any view. If the system displays the message "Error: The VLAN does not exist.", the VLAN has not been created.</p>
</td>
<td class="cellrowborder" valign="top" width="44.330000000000005%" headers="mcps1.3.2.1.2.1.1.4.1.3 "><p>Run the <a href="cmdqueryname=vlan"><b><span class="cmdname">vlan</span></b></a> <i><span class="varname">vlan-id</span></i> command in the system view to create a VLAN.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="22.67%" headers="mcps1.3.2.1.2.1.1.4.1.1 "><p>Whether the interface transparently transmits packets from the VLAN</p>
</td>
<td class="cellrowborder" valign="top" width="33%" headers="mcps1.3.2.1.2.1.1.4.1.2 "><p>Run the <a href="cmdqueryname=display+vlan"><b><span class="cmdname">display vlan</span></b></a> <i><span class="varname">vlan-id</span></i> command in any view to check whether the interface name exists. If not, the interface does not transparently transmit packets from the VLAN.</p>
</td>
<td class="cellrowborder" valign="top" width="44.330000000000005%" headers="mcps1.3.2.1.2.1.1.4.1.3 "><p>For a trunk interface, run the <span><a href="cmdqueryname=port+trunk+allow-pass+vlan"><b><span class="cmdname">port trunk allow-pass vlan</span></b></a></span> command to add the interface to the VLAN.</p>
<p>For a hybrid interface, run the <a href="cmdqueryname=port+hybrid+tagged+vlan"><b><span class="cmdname">port hybrid tagged vlan</span></b></a> or <a href="cmdqueryname=port+hybrid+untagged+vlan"><b><span class="cmdname">port hybrid untagged vlan</span></b></a> command to add the interface to the VLAN.</p>
<p>For an access interface, run the <a href="cmdqueryname=port+default+vlan"><b><span class="cmdname">port default vlan</span></b></a> command to add the interface to the VLAN.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="22.67%" headers="mcps1.3.2.1.2.1.1.4.1.1 "><p>Whether a blackhole MAC address entry is configured</p>
</td>
<td class="cellrowborder" valign="top" width="33%" headers="mcps1.3.2.1.2.1.1.4.1.2 "><p>Run the <a href="cmdqueryname=display+mac-address+blackhole"><b><span class="cmdname">display mac-address blackhole</span></b></a> command in any view to check whether a blackhole MAC address entry is configured.</p>
</td>
<td class="cellrowborder" valign="top" width="44.330000000000005%" headers="mcps1.3.2.1.2.1.1.4.1.3 "><p>If a blackhole MAC address entry is displayed, run the <a href="cmdqueryname=undo+mac-address+blackhole"><b><span class="cmdname">undo mac-address blackhole</span></b></a> command in the system view to delete the blackhole MAC address entry.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="22.67%" headers="mcps1.3.2.1.2.1.1.4.1.1 "><p>Whether MAC address learning is disabled on the interface or in the VLAN</p>
</td>
<td class="cellrowborder" valign="top" width="33%" headers="mcps1.3.2.1.2.1.1.4.1.2 "><p>Run the <a href="cmdqueryname=display+this+%7C+include+learning"><b><span class="cmdname">display this | include learning</span></b></a> command in the interface view and VLAN view to check whether the <strong>mac-address learning disable</strong> configuration exists. If so, MAC address learning is disabled on the interface or in the VLAN.</p>
</td>
<td class="cellrowborder" valign="top" width="44.330000000000005%" headers="mcps1.3.2.1.2.1.1.4.1.3 "><p>Run the <a href="cmdqueryname=undo+mac-address+learning+disable"><b><span class="cmdname">undo mac-address learning disable</span></b></a> command in the interface view or VLAN view to enable MAC address learning.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="22.67%" headers="mcps1.3.2.1.2.1.1.4.1.1 "><p>Whether MAC address learning is disabled in a BD</p>
</td>
<td class="cellrowborder" valign="top" width="33%" headers="mcps1.3.2.1.2.1.1.4.1.2 "><p>Run the <a href="cmdqueryname=display+this+%7C+include+learning"><b><span class="cmdname">display this | include learning</span></b></a> command in the BD view to check whether the <strong>mac-address learning disable</strong> configuration exists. If so, MAC address learning is disabled in the BD.</p>
</td>
<td class="cellrowborder" valign="top" width="44.330000000000005%" headers="mcps1.3.2.1.2.1.1.4.1.3 "><p>Run the <a href="cmdqueryname=undo+mac-address+learning+disable"><b><span class="cmdname">undo mac-address learning disable</span></b></a> command in the BD view to enable MAC address learning.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="22.67%" headers="mcps1.3.2.1.2.1.1.4.1.1 "><p>Whether the numbers of MAC address entries that can be learned on the interface and in the VLAN are limited</p>
</td>
<td class="cellrowborder" valign="top" width="33%" headers="mcps1.3.2.1.2.1.1.4.1.2 "><p>Run the <a href="cmdqueryname=display+this+%7C+include+mac-address+limit"><b><span class="cmdname">display this | include mac-address limit</span></b></a> command in the interface view and VLAN view to check whether the number of learned MAC address entries is limited. If so, the maximum number of learned MAC address entries is set.</p>
</td>
<td class="cellrowborder" valign="top" width="44.330000000000005%" headers="mcps1.3.2.1.2.1.1.4.1.3 "><ul><li>Run the <a href="cmdqueryname=mac-address+limit"><b><span class="cmdname">mac-address limit</span></b></a> command in the interface view or VLAN view to increase the maximum number of learned MAC address entries.</li></ul>
<ul><li>Run the <a href="cmdqueryname=undo+mac-address+limit"><b><span class="cmdname">undo mac-address limit</span></b></a> command in the interface view or VLAN view to remove the MAC address learning limit.</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="22.67%" headers="mcps1.3.2.1.2.1.1.4.1.1 "><p>Whether the number of MAC addresses that can be learned in a BD is limited</p>
</td>
<td class="cellrowborder" valign="top" width="33%" headers="mcps1.3.2.1.2.1.1.4.1.2 "><p>Run the <a href="cmdqueryname=display+this+%7C+include+mac-address+limit"><b><span class="cmdname">display this | include mac-address limit</span></b></a> command in the BD view to check whether the number of learned MAC addresses is limited. If so, the maximum number of learned MAC addresses is set.</p>
</td>
<td class="cellrowborder" valign="top" width="44.330000000000005%" headers="mcps1.3.2.1.2.1.1.4.1.3 "><ul><li>Run the <a href="cmdqueryname=mac-address+limit"><b><span class="cmdname">mac-address limit</span></b></a> command in the BD view to increase the maximum number of learned MAC addresses.</li></ul>
<ul><li>Run the <a href="cmdqueryname=undo+mac-address+limit"><b><span class="cmdname">undo mac-address limit</span></b></a> command in the BD view to remove the MAC address learning limit.</li></ul>
</td>
</tr>
</tbody>
</table>
</div>
<p>If the fault persists, go to Step 2.</p>
</p></li><li><span>Check whether a loop causes MAC address entry flapping.</span><p><ol type="a"><li>Run the <span><a href="cmdqueryname=mac-address+flapping+detection"><b><span class="cmdname">mac-address flapping detection</span></b></a></span> command in the system view to configure MAC address flapping detection.</li><li>The system checks for MAC address flapping among all MAC addresses in the VLAN.</li></ol>
<p>If no loop is detected, go to Step 3.</p>
</p></li><li><span>Check whether the number of learned MAC address entries has reached the maximum value. If so, the device cannot learn new MAC address entries.</span><p><ul><li>If the number of MAC address entries learned on the interface is less than or equal to the number of hosts connected to the interface, the device is connected to more hosts than it supports. Adjust your network plan accordingly.</li><li>If the interface has learned much more MAC address entries than the number of hosts connected to the interface, the interface may be experiencing a MAC address attack from the attached network.
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="50%" id="mcps1.3.2.3.2.1.2.1.1.3.1.1" liSelected="liSelected"><p>Category</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="50%" id="mcps1.3.2.3.2.1.2.1.1.3.1.2" liSelected="liSelected"><p>Solution</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.3.2.1.2.1.1.3.1.1 "><p>The interface connects to another network device.</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.3.2.1.2.1.1.3.1.2 "><p>Run the <a href="cmdqueryname=display+mac-address"><b><span class="cmdname">display mac-address</span></b></a> command on the connected device to view MAC address entries. Use the displayed MAC address entries to locate the interface connected to the malicious host. If the located interface is connected to another network device, repeat this step until you locate the malicious host.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.3.2.1.2.1.1.3.1.1 "><p>The interface connects to a host.</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.3.2.1.2.1.1.3.1.2 "><ul><li>Disconnect the host after obtaining permission from the administrator. After the attack stops, reconnect the host to the network.</li><li>Run the <a href="cmdqueryname=mac-address+limit"><b><span class="cmdname">mac-address limit</span></b></a> command on the interface to set the maximum number of MAC addresses learned on the interface to 1.</li></ul>
</td>
</tr>
</tbody>
</table>
</div>
</li></ul>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_mac_cfg_0042.html">Troubleshooting MAC Address Tables
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
</div>
</div>
</body>
</html>