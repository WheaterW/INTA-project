
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="HWTACACS Packets">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_aaa_cfg_0038.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_aaa_cfg_0039.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_aaa_cfg_0041.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="AAA">
<meta name="featurename" content="HWTACACS">
<meta name="featuretype" content="User Access and Authentication">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="AAA">
<meta name="featurename" content="HWTACACS">
<meta name="featuretype" content="User Access and Authentication">
<meta name="featurename" content="AAA">
<meta name="featurename" content="HWTACACS">
<meta name="featuretype" content="User Access and Authentication">
<meta name="featurename" content="AAA">
<meta name="featurename" content="AD">
<meta name="featurename" content="HWTACACS">
<meta name="featurename" content="LDAP">
<meta name="featurename" content="RADIUS">
<meta name="featurename" content="Local User">
<meta name="featuretype" content="User Access and Authentication">
<meta name="featuretype" content="User Access and Authentication">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001513035654">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>HWTACACS Packets</title>
</head>
<body><a name="EN-US_CONCEPT_0000001513035654"></a><a name="EN-US_CONCEPT_0000001513035654"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">HWTACACS Packets</h1>
<div><p>An HWTACACS client and an HWTACACS server communicate using HWTACACS packets sent over TCP/IP networks. Unlike RADIUS packets with the same format, HWTACACS packets (including <a href="#EN-US_CONCEPT_0000001513035654__section_dc_fd_aaa_002002">HWTACACS Authentication Packet</a>, <a href="#EN-US_CONCEPT_0000001513035654__section_dc_fd_aaa_002003">HWTACACS Authorization Packet</a>, and <a href="#EN-US_CONCEPT_0000001513035654__section_dc_fd_aaa_002004">HWTACACS Accounting Packet</a>) are formatted differently. HWTACACS packets all share the same <a href="#EN-US_CONCEPT_0000001513035654__section_dc_fd_aaa_002001">HWTACACS Packet Header</a>.</p>
<div class="section" id="EN-US_CONCEPT_0000001513035654__section_dc_fd_aaa_002001"><a name="EN-US_CONCEPT_0000001513035654__section_dc_fd_aaa_002001"></a><a name="section_dc_fd_aaa_002001"></a><h4 class="sectiontitle">HWTACACS Packet Header</h4><p>HWTACACS defines a 12-byte header that appears in all HWTACACS packets. <a href="#EN-US_CONCEPT_0000001513035654__fig_dc_fd_aaa_002001">Figure 1</a> shows the header.</p>
<div class="fignone" id="EN-US_CONCEPT_0000001513035654__fig_dc_fd_aaa_002001"><a name="EN-US_CONCEPT_0000001513035654__fig_dc_fd_aaa_002001"></a><a name="fig_dc_fd_aaa_002001"></a><span class="figcap"><b>Figure 1 </b>HWTACACS packet header</span><br><span><img class="vsd" src="figure/en-us_image_0000001512676638.png" width="NaN" height="NaN"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Fields in an HWTACACS packet header</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="50%" id="mcps1.3.2.4.2.3.1.1" liSelected="liSelected"><p>Field</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="50%" id="mcps1.3.2.4.2.3.1.2" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.4.2.3.1.1 "><p>major version</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.4.2.3.1.2 "><p>Major HWTACACS version number. The current version is 0xc.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.4.2.3.1.1 "><p>minor version</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.4.2.3.1.2 "><p>Minor HWTACACS version number. The current version is 0x0.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.4.2.3.1.1 "><p>type</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.4.2.3.1.2 "><p>HWTACACS packet type:</p>
<ul><li>0x01 (authentication)</li><li>0x02 (authorization)</li><li>0x03 (accounting)</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.4.2.3.1.1 "><p>seq_no</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.4.2.3.1.2 "><p>Sequence number of the packet in a session. The sequence number of the first packet in a session is 1 and that of each subsequent packet increments by 1. The value ranges from 1 to 254.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.4.2.3.1.1 "><p>flags</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.4.2.3.1.2 "><p>Encryption flag on the packet body. This field contains 8 bits, of which only the first bit has a valid value. The value 0 indicates that the packet body is encrypted, and the value 1 indicates that the packet body is not encrypted.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.4.2.3.1.1 "><p>session_id</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.4.2.3.1.2 "><p>ID of the HWTACACS session, which is the unique identifier of a session.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.4.2.3.1.1 "><p>length</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.4.2.3.1.2 "><p>Total length of the HWTACACS packet body, excluding the packet header.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="EN-US_CONCEPT_0000001513035654__section_dc_fd_aaa_002002"><a name="EN-US_CONCEPT_0000001513035654__section_dc_fd_aaa_002002"></a><a name="section_dc_fd_aaa_002002"></a><h4 class="sectiontitle">HWTACACS Authentication Packet Format</h4><div class="p">HWTACACS defines three types of authentication packets:<ul><li><a href="#EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002002">Authentication Start</a>: indicates the type of authentication to be performed, and contains the user name and authentication data. This packet is only sent as the first packet in an HWTACACS authentication process.</li><li><a href="#EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002003">Authentication Continue</a>: indicates that the authentication process has not ended. This packet is sent by a client when the client receives an Authentication Reply packet from the server.</li><li><a href="#EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002004">Authentication Reply</a>: notifies the client of the current authentication status. When the server receives an Authentication Start or Authentication Continue packet from a client, the server sends this packet to the client.</li></ul>
</div>
<div class="p">The HWTACACS authentication packets have different formats.<ul><li id="EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002002"><p><a name="EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002002"></a><a name="step_dc_fd_aaa_002002"></a>The following figure shows the HWTACACS Authentication Start packet body.</p>
<div class="fignone"><span class="figcap"><b>Figure 2 </b>HWTACACS Authentication Start packet body</span><br><span><img class="vsd" src="figure/en-us_image_0000001513035826.png" width="NaN" height="NaN"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 2 </b>Fields in an HWTACACS Authentication Start packet</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="15.5%" id="mcps1.3.3.3.1.1.3.2.3.1.1" liSelected="liSelected"><p>Field</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="84.5%" id="mcps1.3.3.3.1.1.3.2.3.1.2" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.1 "><p>action</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.2 "><p>Specific authentication action. Currently, only authentication login (0x01) and password change (0x02) are supported.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.1 "><p>priv_lvl</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.2 "><p>Privilege level of a user. The value ranges from 0 to 15.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.1 "><p>authen_type</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.2 "><p>Authentication type:</p>
<ul><li>0x03 (CHAP authentication)</li><li>0x02 (PAP authentication)</li><li>0x01 (ASCII authentication)</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.1 "><p>service</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.2 "><p>Type of the service requesting authentication. The value varies depending on the user type:</p>
<ul><li>PPP users: PPP(0x03)</li><li>Administrators: LOGIN(0x01)</li><li>Other users: NONE(0x00)</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.1 "><p>user len</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.2 "><p>Length of the user name entered by a login user.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.1 "><p>port len</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.2 "><p>Length of the port field.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.1 "><p>rem_addr len</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.2 "><p>rem_addr field length.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.1 "><p>data len</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.2 "><p>Authentication data length.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.1 "><p>user</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.2 "><p>Name of the user requesting authentication. The maximum length is 129.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.1 "><p>port</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.2 "><p>Name of the user interface requesting authentication. The maximum length is 47.</p>
<ul><li>For administrators, this field indicates the user terminal interface, such as console0 and vty1. For example, the authen_type of Telnet users is ASCII, service is LOGIN, and port is vtyx.</li><li>For other users, this field indicates the user access interface.</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.1 "><p>rem_addr</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.2 "><p>IP address of the login user.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.1 "><p>data</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.1.3.2.3.1.2 "><p>Authentication data. Different data is encapsulated depending on the values of the action and authen_type fields. For example, when PAP authentication is used, the value of this field is PAP cleartext password.</p>
</td>
</tr>
</tbody>
</table>
</div>
</li><li id="EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002003"><p><a name="EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002003"></a><a name="step_dc_fd_aaa_002003"></a>The following figure shows the HWTACACS Authentication Continue packet body.</p>
<div class="fignone"><span class="figcap"><b>Figure 3 </b>HWTACACS Authentication Continue packet body</span><br><span><img class="vsd" src="figure/en-us_image_0000001563875773.png" width="NaN" height="NaN"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 3 </b>Fields in an HWTACACS Authentication Continue packet</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="15.5%" id="mcps1.3.3.3.1.2.3.2.3.1.1" liSelected="liSelected"><p>Field</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="84.5%" id="mcps1.3.3.3.1.2.3.2.3.1.2" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.2.3.2.3.1.1 "><p>user_msg len</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.2.3.2.3.1.2 "><p>Length of the character string entered by a login user.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.2.3.2.3.1.1 "><p>data len</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.2.3.2.3.1.2 "><p>Authentication data length.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.2.3.2.3.1.1 "><p>flags</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.2.3.2.3.1.2 "><p>Authentication continue flag:</p>
<ul><li>0: Authentication continues.</li><li>1: Authentication has ended.</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.2.3.2.3.1.1 "><p>user_msg</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.2.3.2.3.1.2 "><p>Character string entered by a login user. This field carries the user login password to respond to the server_msg field in the Authentication Reply packet.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.2.3.2.3.1.1 "><p>data</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.2.3.2.3.1.2 "><p>Authentication data. Different data is encapsulated depending on the values of the action and authen_type fields. For example, when PAP authentication is used, the value of this field is PAP cleartext password.</p>
</td>
</tr>
</tbody>
</table>
</div>
</li><li id="EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002004"><p><a name="EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002004"></a><a name="step_dc_fd_aaa_002004"></a>The following figure shows the HWTACACS Authentication Reply packet body.</p>
<div class="fignone"><span class="figcap"><b>Figure 4 </b>HWTACACS Authentication Reply packet body</span><br><span><img class="vsd" src="figure/en-us_image_0000001512676626.png" width="NaN" height="NaN"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 4 </b>Fields in an HWTACACS Authentication Reply packet</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="15.5%" id="mcps1.3.3.3.1.3.3.2.3.1.1" liSelected="liSelected"><p>Field</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="84.5%" id="mcps1.3.3.3.1.3.3.2.3.1.2" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.3.3.2.3.1.1 "><p>status</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.3.3.2.3.1.2 "><p>Current authentication status:</p>
<ul><li>PASS (0x01): Authentication succeeds.</li><li>FAIL (0x02): Authentication fails.</li><li>GETDATA (0x03): Request user information.</li><li>GETUSER (0x04): Request user name.</li><li>GETPASS (0x05): Request password.</li><li>RESTART (0x06): Request reauthentication.</li><li>ERROR (0x07): The authentication packets received by the server have errors.</li><li>FOLLOW (0x21): The server requests reauthentication.</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.3.3.2.3.1.1 "><p>flags</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.3.3.2.3.1.2 "><p>Whether the client displays the password entered by user in plain text. The value 1 indicates that the password is not displayed in plain text.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.3.3.2.3.1.1 "><p>server_msg len</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.3.3.2.3.1.2 "><p>Length of the server_msg field.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.3.3.2.3.1.1 "><p>data len</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.3.3.2.3.1.2 "><p>Authentication data length.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.3.3.2.3.1.1 "><p>server_msg</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.3.3.2.3.1.2 "><p>Optional field. This field is sent by the server to the user to provide additional information.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.3.3.1.3.3.2.3.1.1 "><p>data</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.3.3.1.3.3.2.3.1.2 "><p>Authentication data, providing information to the client.</p>
</td>
</tr>
</tbody>
</table>
</div>
</li></ul>
</div>
</div>
<div class="section" id="EN-US_CONCEPT_0000001513035654__section_dc_fd_aaa_002003"><a name="EN-US_CONCEPT_0000001513035654__section_dc_fd_aaa_002003"></a><a name="section_dc_fd_aaa_002003"></a><h4 class="sectiontitle">HWTACACS Authorization Packet Format</h4><div class="p">HWTACACS defines two types of authorization packets:<ul><li><a href="#EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002005">Authorization Request</a>: contains a fixed set of fields that indicate how a user is authenticated or processed and a variable set of attributes that describe the information for which authorization is requested.</li><li><a href="#EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002006">Authorization Response</a>: contains a variable set of attributes that can limit or change the client's action.</li></ul>
</div>
<div class="p">The HWTACACS authorization packets have different formats.<ul><li id="EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002005"><p><a name="EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002005"></a><a name="step_dc_fd_aaa_002005"></a>The following figure shows the HWTACACS Authorization Request packet body.</p>
<div class="fignone"><span class="figcap"><b>Figure 5 </b>HWTACACS Authorization Request packet body</span><br><span><img class="vsd" src="figure/en-us_image_0000001563875761.png" width="NaN" height="NaN"></span></div>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The meanings of the following fields in the Authorization Request packet are the same as those in the Authentication Start packet: priv_lvl, authen_type, authen_service, user len, port len, rem_addr len, port, and rem_addr.</p>
</div></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 5 </b>Fields in an HWTACACS Authorization Request packet</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="15.5%" id="mcps1.3.4.3.1.1.4.2.3.1.1" liSelected="liSelected"><p>Field</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="84.5%" id="mcps1.3.4.3.1.1.4.2.3.1.2" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.4.3.1.1.4.2.3.1.1 "><p>authen_method</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.4.3.1.1.4.2.3.1.2 "><p>Authentication method used by the client to acquire user information:</p>
<ul><li>0x00 (no authentication method configured)</li><li>0x01 (non-authentication)</li><li>0x05 (local authentication)</li><li>0x06 (HWTACACS authentication)</li><li>0x10 (RADIUS authentication)</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.4.3.1.1.4.2.3.1.1 "><p>authen_service</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.4.3.1.1.4.2.3.1.2 "><p>Type of the service requesting authentication. The value varies depending on the user type:</p>
<ul><li>PPP users: PPP(0x03)</li><li>Administrators: LOGIN(0x01)</li><li>Other users: NONE(0x00)</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.4.3.1.1.4.2.3.1.1 "><p>arg_cnt</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.4.3.1.1.4.2.3.1.2 "><p>Number of attributes carried in the Authorization Request packet.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.4.3.1.1.4.2.3.1.1 "><p>argN</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.4.3.1.1.4.2.3.1.2 "><p>Attribute of the Authorization Request packet:</p>
<ul><li>cmd: first argument in the command for authorization request.</li><li>cmd-arg: arguments in the command for authorization request. The format is fixed as cmd-arg=<em>command parameter</em>. The cmd-arg=&lt;cr&gt; is added at the end of the command line. The total length of cmd-arg=<em>command parameter</em> cannot exceed 255 bytes, and each command parameter cannot be longer than 247 bytes.</li></ul>
</td>
</tr>
</tbody>
</table>
</div>
</li><li id="EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002006"><p><a name="EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002006"></a><a name="step_dc_fd_aaa_002006"></a>The following figure shows the HWTACACS Authorization Response packet body.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The meanings of the following fields are the same as those in the HWTACACS Authentication Reply packet: server_msg len, data len, and server_msg.</p>
</div></div>
<div class="fignone"><span class="figcap"><b>Figure 6 </b>HWTACACS Authorization Response packet body</span><br><span><img class="vsd" src="figure/en-us_image_0000001513035782.png" width="NaN" height="NaN"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 6 </b>Fields in an HWTACACS Authorization Response packet</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="15.5%" id="mcps1.3.4.3.1.2.4.2.3.1.1" liSelected="liSelected"><p>Field</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="84.5%" id="mcps1.3.4.3.1.2.4.2.3.1.2" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.4.3.1.2.4.2.3.1.1 "><p>status</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.4.3.1.2.4.2.3.1.2 "><p>Authorization status:</p>
<ul><li>0x01 (authorization is successful)</li><li>0x02 (the attributes in Authorization Request packets are modified by the TACACS server)</li><li>0x10 (authorization fails)</li><li>0x11 (an error occurs on the authorization server)</li><li>0x21 (an authorization server is re-specified)</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.4.3.1.2.4.2.3.1.1 "><p>arg_cnt</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.4.3.1.2.4.2.3.1.2 "><p>Number of attributes carried in an Authorization Response packet.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.4.3.1.2.4.2.3.1.1 "><p>argN</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.4.3.1.2.4.2.3.1.2 "><p>Authorization attribute delivered by the HWTACACS authorization server.</p>
</td>
</tr>
</tbody>
</table>
</div>
</li></ul>
</div>
</div>
<div class="section" id="EN-US_CONCEPT_0000001513035654__section_dc_fd_aaa_002004"><a name="EN-US_CONCEPT_0000001513035654__section_dc_fd_aaa_002004"></a><a name="section_dc_fd_aaa_002004"></a><h4 class="sectiontitle">HWTACACS Accounting Packet Format</h4><div class="p">HWTACACS defines two types of accounting packets:<ul><li><a href="#EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002007">Accounting Request</a>: contains information used to provide accounting for a service provided to a user.</li><li><a href="#EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002008">Accounting Response</a>: After receiving and recording an Accounting Request packet, the server returns this packet, indicating that accounting has completed and the record has been securely committed.</li></ul>
</div>
<div class="p">The HWTACACS accounting packets have different formats.<ul><li id="EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002007"><p><a name="EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002007"></a><a name="step_dc_fd_aaa_002007"></a>The following figure shows the HWTACACS Accounting Request packet body.</p>
<div class="fignone"><span class="figcap"><b>Figure 7 </b>HWTACACS Accounting Request packet body</span><br><span><img class="vsd" src="figure/en-us_image_0000001564115853.png" width="NaN" height="NaN"></span></div>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The meanings of the following fields in the Accounting Request packet are the same as those in the Authorization Request packet: authen_method, priv_lvl, authen_type, user len, port len, rem_addr len, port, and rem_addr.</p>
</div></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 7 </b>Fields in an HWTACACS Accounting Request packet</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="15.5%" id="mcps1.3.5.3.1.1.4.2.3.1.1" liSelected="liSelected"><p>Field</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="84.5%" id="mcps1.3.5.3.1.1.4.2.3.1.2" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.5.3.1.1.4.2.3.1.1 "><p>flags</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.5.3.1.1.4.2.3.1.2 "><p>Accounting type:</p>
<ul><li>0x02 (start accounting)</li><li>0x04 (stop accounting)</li><li>0x08 (interim accounting)</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.5.3.1.1.4.2.3.1.1 "><p>authen_service</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.5.3.1.1.4.2.3.1.2 "><p>Type of the service requesting authentication, which varies by user type:</p>
<ul><li>PPP users: PPP(0x03)</li><li>Administrators: LOGIN(0x01)</li><li>Other users: NONE(0x00)</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.5.3.1.1.4.2.3.1.1 "><p>arg_cnt</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.5.3.1.1.4.2.3.1.2 "><p>Number of attributes carried in the Accounting Request packet.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.5.3.1.1.4.2.3.1.1 "><p>argN</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.5.3.1.1.4.2.3.1.2 "><p>Attribute of the Accounting Request packet.</p>
<p>The command executed by a user is recorded in a recording scheme and transmitted to the server through this field. The field format is cmd=<em>command line</em>. The total length of the field cannot exceed 255 bytes, and each command line cannot exceed 251 bytes. If a command line exceeds 251 bytes, the device truncates the command line.</p>
</td>
</tr>
</tbody>
</table>
</div>
</li><li id="EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002008"><p><a name="EN-US_CONCEPT_0000001513035654__step_dc_fd_aaa_002008"></a><a name="step_dc_fd_aaa_002008"></a>The following figure shows the HWTACACS Accounting Response packet body.</p>
<div class="fignone"><span class="figcap"><b>Figure 8 </b>HWTACACS Accounting Response packet body</span><br><span><img class="vsd" src="figure/en-us_image_0000001513035786.png" width="NaN" height="NaN"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 8 </b>Fields in an HWTACACS Accounting Response packet</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="15.5%" id="mcps1.3.5.3.1.2.3.2.3.1.1" liSelected="liSelected"><p>Field</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="84.5%" id="mcps1.3.5.3.1.2.3.2.3.1.2" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.5.3.1.2.3.2.3.1.1 "><p>server_msg len</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.5.3.1.2.3.2.3.1.2 "><p>Length of the server_msg field.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.5.3.1.2.3.2.3.1.1 "><p>data len</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.5.3.1.2.3.2.3.1.2 "><p>Length of the data field.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.5.3.1.2.3.2.3.1.1 "><p>status</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.5.3.1.2.3.2.3.1.2 "><p>Accounting status:</p>
<ul><li>0x01 (accounting is successful)</li><li>0x02 (accounting fails)</li><li>0x03 (no response)</li><li>0x21 (the server requests reaccounting)</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.5.3.1.2.3.2.3.1.1 "><p>server_msg</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.5.3.1.2.3.2.3.1.2 "><p>Information sent by the accounting server to the client.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="15.5%" headers="mcps1.3.5.3.1.2.3.2.3.1.1 "><p>data</p>
</td>
<td class="cellrowborder" valign="top" width="84.5%" headers="mcps1.3.5.3.1.2.3.2.3.1.2 "><p>Information sent by the accounting server to the administrator.</p>
</td>
</tr>
</tbody>
</table>
</div>
</li></ul>
</div>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_aaa_cfg_0038.html">Understanding HWTACACS-based AAA
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_aaa_cfg_0039.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_aaa_cfg_0041.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>