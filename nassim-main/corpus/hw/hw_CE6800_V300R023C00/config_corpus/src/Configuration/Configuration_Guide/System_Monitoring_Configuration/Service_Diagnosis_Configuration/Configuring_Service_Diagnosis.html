
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Service Diagnosis">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_servicediag_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="spec/Service_Diagnosis_limitation_CE_v6r23c00.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_servicediag_cfg_0005.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Service Diagnosis">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Service Diagnosis">
<meta name="featuretype" content="System Monitoring">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001563757537">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring Service Diagnosis</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001563757537"></a><a name="EN-US_TASK_0000001563757537"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Service Diagnosis</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001563757537__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>You can create diagnosis objects based on attributes, which vary according to services.</p>
<p>For the DHCP service, you can create diagnosis objects based on MAC addresses.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Service diagnosis affects system performance. Therefore, enable service diagnosis only when fault locating is required. After faults are located, immediately run the <a href="cmdqueryname=undo+trace+enable"><b><span class="cmdname">undo trace enable</span></b></a> command to disable service diagnosis.</p>
<p>Service diagnosis commands are at level 3 (management level). That is, only users at privilege level 3 can run service diagnosis commands.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001563757537__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enable service diagnosis.</span><p><pre class="screen"><a href="cmdqueryname=trace+enable"><b><span class="cmdname">trace enable</span></b></a> [ <strong><span>brief</span></strong> ]</pre>
<p>By default, service diagnosis is disabled.</p>
<p>The <a href="cmdqueryname=trace+enable"><b><span class="cmdname">trace enable</span></b></a> [ <strong><span>brief</span></strong> ] command configuration is not recorded in the configuration file and will be lost after the device restarts. To use the service diagnosis function after the device restarts, run this command again.</p>
</p></li><li><span>Create a diagnosis object.</span><p><p>For <span>CE6866, CE6860-SAN, CE6866K, CE6860-HAM, CE8851-32CQ8DQ-P, CE8850-SAN, CE8851K, CE8850-HAM</span>, <span>CE6820H, CE6820H-K, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6820S</span>, <span>CE8855, CE8851-32CQ4BQ, CE6855-48XS8CQ, CE6885, CE6885-SAN, CE6885-LL, CE6885-T, CE6863E-48S8CQ</span>:</p>
<pre class="screen"><a href="cmdqueryname=trace+object"><b><span class="cmdname">trace object</span></b></a> { <strong><span>mac-address</span></strong> <i><span class="varname">mac-address</span></i> | <strong><span>ip-address</span></strong> <i><span class="varname">ip-address</span></i><span> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ]</span> } <sup>*</sup> [ <strong><span>output</span></strong> { <strong><span>command-line</span></strong> | <strong><span>file</span></strong> <i><span class="varname">file-name</span></i> | <strong><span>syslog-server</span></strong> <i><span class="varname">syslog-server-ip</span></i> } ]</pre>
<p>For the <span>CE6820H, CE6820H-K, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6820S</span>:</p>
<pre class="screen"><a href="cmdqueryname=trace+object"><b><span class="cmdname">trace object</span></b></a> { <strong><span>mac-address</span></strong> <i><span class="varname">mac-address</span></i> | <strong><span>ip-address</span></strong> <i><span class="varname">ip-address</span></i><span> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ]</span> | <span><strong><span>interface</span></strong> { <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></span> } | <strong><span>user-vlan</span></strong> <i><span class="varname">user-vlan-id</span></i> | <strong><span>user-name</span></strong> <i><span class="varname">username</span></i> } } <sup>*</sup> [ <strong><span>output</span></strong> { <strong><span>command-line</span></strong> | <strong><span>file</span></strong> <i><span class="varname">file-name</span></i> | <strong><span>syslog-server</span></strong> <i><span class="varname">syslog-server-ip</span></i> } ]</pre>
<p>By default, no diagnosis object is created. If the <strong>output</strong> parameter is not specified, diagnostic information is displayed on the CLI by default.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>You are advised to export diagnostic information to a specified file. To configure the terminal display function, run the <a href="cmdqueryname=terminal+monitor"><b><span class="cmdname">terminal monitor</span></b></a> and <strong><a href="cmdqueryname=terminal+debugging"><b><span class="cmdname">terminal debugging</span></b></a></strong> commands in the user view.</p>
</div></div>
</p></li><li><span>(Optional) Save the diagnostic information in the device buffer to a file.</span><p><pre class="screen"><a href="cmdqueryname=save+trace+information"><b><span class="cmdname">save trace information</span></b></a></pre>
<p>After you specify the <strong>file</strong><em> file-name</em> parameter in the <strong>trace object</strong> command to save diagnostic information to a file, the system saves diagnostic information in the device buffer first, and then saves the diagnostic information to the specified file when the buffer is full. If you need to view diagnostic information in real time, run the <a href="cmdqueryname=save+trace+information"><b><span class="cmdname">save trace information</span></b></a> command to save diagnostic information in the buffer to the file immediately.</p>
</p></li><li><span>(Optional) Specify the interface through which diagnostic information is exported to a log server.</span><p><pre class="screen"><a href="cmdqueryname=trace+syslog+source"><b><span class="cmdname">trace syslog source</span></b></a> { <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> | <i><span class="varname">interface-name</span></i> }</pre>
<p>By default, no interface is specified to export diagnostic information to a log server.</p>
<ul><li>You can specify the interface only when a device is configured to export diagnostic information to a log server.</li><li>The configuration of this command is not recorded in the configuration file and will be lost after the device restarts. To export diagnostic information to a log server through a specified interface, run this command again.</li></ul>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0000001563757537__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ul><li>Run the <a href="cmdqueryname=display+trace+information"><b><span class="cmdname">display trace information</span></b></a> command to check information about service diagnosis.</li><li>Run the <a href="cmdqueryname=display+trace+instance"><b><span class="cmdname">display trace instance</span></b></a> [ <i><span class="varname">instance-start-id</span></i> [ <i><span class="varname">instance-end-id</span></i> ] | <strong><span>mac-address</span></strong> <i><span class="varname">mac-address</span></i> | <strong><span>ip-address</span></strong> <i><span class="varname">ip-address</span></i><span> </span><span>[ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ]</span> | <strong><span>interface</span></strong> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i>  ] command to check diagnosis instances on the device.<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Only the <span>CE6820H, CE6820H-K, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6820S</span> support the <strong><span>interface</span></strong> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> parameter.</p>
</div></div>
</li><li><p>Run the <a href="cmdqueryname=display+trace+object"><b><span class="cmdname">display trace object</span></b></a> [ <i><span class="varname">service-object-id</span></i> ] command to check the configuration of a diagnosis object.</p>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_servicediag_cfg_0001.html">Service Diagnosis Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="spec/Service_Diagnosis_limitation_CE_v6r23c00.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_servicediag_cfg_0005.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>