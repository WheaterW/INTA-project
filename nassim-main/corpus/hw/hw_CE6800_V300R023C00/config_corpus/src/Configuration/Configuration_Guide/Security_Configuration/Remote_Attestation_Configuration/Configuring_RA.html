
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring RA">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../dc/galaxy_ra_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="../dc/galaxy_ra_cfg_0005.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Remote Attestation">
<meta name="featuretype" content="Security">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Remote Attestation">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="Security Protection">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001513034938">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Configuring RA</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001513034938"></a><a name="EN-US_TASK_0000001513034938"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring RA</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001513034938__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>An RA system consists of the RA server and RA client. The administrator needs to configure both the RA server and RA client to implement the RA function. This section describes how to configure the RA client. For details about how to configure the RA server, see the product documentation of related NMS devices.</p>
<p>Huawei provides two sets of certificates, each with one Huawei root certificate and one Huawei level-2 CA certificate, for issuing IAK certificates. The two sets of certificates are as follows:</p>
<ul><li>Huawei root certificate: Huawei Equipment CA; Huawei level-2 CA certificate: Huawei Enterprise Network Product CA</li><li>Huawei root certificate: Huawei RSA Equipment Root CA 2; Huawei level-2 CA certificate: Huawei DataCom RSA Equipment CA 2</li></ul>
<p>You are advised to load the two sets of certificates on the RA server. To download Huawei root certificates and Huawei level-2 CA certificates, visit <a href="https://support.huawei.com/additionalres/pki" target="_blank" rel="noopener noreferrer">https://support.huawei.com/additionalres/pki</a>.</p>
<p>You can perform the following steps to view the IAK certificate currently used by the RA client, so as to obtain the matching Huawei root certificate and Huawei level-2 CA certificate.</p>
<ol><li>Run the <strong>display remote-attestation iak certificate slot</strong> <em>slotid</em> command in the diagnostic view to check IAK certificate information. Copy the content from <strong>-----BEGIN CERTIFICATE-----</strong> to <strong>-----END CERTIFICATE-----</strong> in the command output, including <strong>-----BEGIN CERTIFICATE-----</strong> and <strong>-----END CERTIFICATE-----</strong>, and save such information to the user PC in .pem format.</li><li>Install OpenSSL on the user PC.</li><li>On the CLI of the PC, run the <strong>openssl x509 -in</strong> <em>filename</em> <strong>-text -noout</strong> command to check the CN in the <strong>Issue</strong><strong>r</strong> field. <em>filename</em>: specifies that the certificate path contains the certificate name.</li><li>Download the Huawei level-2 CA certificate at <a href="https://support.huawei.com/additionalres/pki" target="_blank" rel="noopener noreferrer">https://support.huawei.com/additionalres/pki</a> based on the queried CN, and then download the Huawei root certificate based on the Huawei level-2 CA certificate.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001513034938__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Prerequisites</h4><p>Before configuring RA, complete the following tasks:</p>
<ul><li>Configure the device to communicate with the RA server, and configure the RA function on the RA server.</li><li>Obtain the baseline file, Huawei root certificate, and Huawei level-2 CA certificate. If the RA client uses the LAK certificate, you also need to obtain the CA certificate chain that issues the LAK certificate. Upload the obtained file to the RA server.</li><li>Configure NETCONF on the device so that the RA server can establish a NETCONF session with the device.</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001513034938__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the trusted management view and configure RA.</span><p><pre class="screen"><a href="cmdqueryname=trustem"><b><span class="cmdname">trustem</span></b></a></pre>
<p>By default, no trusted management view is created. After you enter the trusted management view, the device automatically enables RA.</p>
</p></li><li><span>(Optional) Return to the user view.</span><p><pre class="screen"><a href="cmdqueryname=return"><b><span class="cmdname">return</span></b></a></pre>
</p></li><li><span>(Optional) Configure a password for the HTM.</span><p><pre class="screen"><a href="cmdqueryname=set+htm+password"><b><span class="cmdname">set htm password</span></b></a> { <strong><span>slot</span></strong> <i><span class="varname">slot-id</span></i> | <strong><span>all</span></strong> }</pre>
<p>By default, the HTM uses a random password generated before hardware delivery. The device encrypts the configured password and stores it in a secure location to improve the security of the RA function.</p>
</p></li><li><span>(Optional) Apply for a LAK certificate for the HTM.</span><ol type="a"><li class="substepexpand" id="EN-US_TASK_0000001513034938__substep3300184513173"><a name="EN-US_TASK_0000001513034938__substep3300184513173"></a><a name="substep3300184513173"></a><span id="EN-US_TASK_0000001513034938__">Create a PKI entity and enter the PKI entity view or enter the PKI entity view directly.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a>
<a href="cmdqueryname=pki+entity"><b><span class="cmdname">pki entity</span></b></a> <i><span class="varname">entity-name</span></i></pre>
<p>By default, no PKI entity is configured.</p>
</p></li><li class="substepexpand"><span>Configure a common name for the PKI entity.</span><p><pre class="screen"><a href="cmdqueryname=common-name"><b><span class="cmdname">common-name</span></b></a> <i><span class="varname">common-name</span></i></pre>
<p>By default, no common name is configured for a PKI entity.</p>
</p></li><li class="substepexpand"><span>Exit the PKI entity view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001513034938__substep1198315311203"><a name="EN-US_TASK_0000001513034938__substep1198315311203"></a><a name="substep1198315311203"></a><span id="EN-US_TASK_0000001513034938__">Create a PKI CMP session and enter the PKI CMP session view, or enter the PKI CMP session view directly.</span><p><pre class="screen"><a href="cmdqueryname=pki+cmp+session"><b><span class="cmdname">pki cmp session</span></b></a> <i><span class="varname">session-name</span></i></pre>
<p>By default, no PKI CMP session is created.</p>
</p></li><li class="substepexpand"><span>Specify the PKI entity name used by a device to apply for a certificate through CMPv2.</span><p><pre class="screen"><a href="cmdqueryname=cmp-request+entity"><b><span class="cmdname">cmp-request entity</span></b></a> <i><span class="varname">entity-name</span></i></pre>
<p><i><span class="varname">entity-name</span></i> must be the PKI entity name in step <a href="#EN-US_TASK_0000001513034938__substep3300184513173">5.a</a>.</p>
</p></li><li class="substepexpand"><span>Configure a CA name for the PKI CMP session.</span><p><pre class="screen"><a href="cmdqueryname=cmp-request+ca-name"><b><span class="cmdname">cmp-request ca-name</span></b></a> <i><span class="varname">ca-name</span></i></pre>
<p>The sequence of each field in the configured CA name must be the same as that in the CA certificate. Otherwise, the CMPv2 server considers the CA name incorrect.</p>
</p></li><li class="substepexpand"><span>Configure a URL for the CMPv2 server.</span><p><pre class="screen"><a href="cmdqueryname=cmp-request+server+url"><b><span class="cmdname">cmp-request server url</span></b></a> [ <strong><span>esc</span></strong> ] <i><span class="varname">url-addr</span></i> </pre>
</p></li><li class="substepexpand"><span>Set the authentication mode for a CMPv2-based initialization request (IR) to signature.</span><p><pre class="screen"><a href="cmdqueryname=cmp-request+origin-authentication-method"><b><span class="cmdname">cmp-request origin-authentication-method</span></b></a> <strong><span>signature</span></strong></pre>
<p>By default, the authentication mode for a CMPv2-based IR is set to message authentication code. In RA scenarios, the authentication mode for a CMPv2-based IR must be set to signature.</p>
</p></li><li class="substepexpand"><span>Exit the PKI CMP session view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li class="substepexpand"><span>Obtain the CA certificate chain that issues the LAK certificate as well as the Huawei level-2 CA certificate of the IAK certificate, and upload them to the <strong>flash:/pki/public</strong> directory of the device through SFTP.</span></li><li class="substepexpand"><span>Import the CA certificate chain of the LAK certificate as well as the Huawei level-2 CA certificate of the IAK certificate.</span><p><pre class="screen"><a href="cmdqueryname=pki+import-certificate"><b><span class="cmdname">pki import-certificate</span></b></a> <strong><span>ca</span></strong> { <strong>der </strong>| <strong>pem</strong> } <strong><span>filename</span></strong> <i><span class="varname">file-name</span></i></pre>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>You are advised to import the two sets of certificates, each with one Huawei root certificate and one Huawei level-2 CA certificate. The same CA certificate cannot be imported repeatedly.</p>
<p>If the current CA server does not verify the IAK certificate, you do not need to import the Huawei level-2 CA certificate.</p>
</div></div>
</p></li><li class="substepexpand"><span>Bind the RA to a PKI CMP session.</span><p><pre class="screen"><a href="cmdqueryname=trustem"><b><span class="cmdname">trustem</span></b></a>
<a href="cmdqueryname=remote-attestation+pki+bind+cmp-session"><b><span class="cmdname">remote-attestation pki bind cmp-session</span></b></a> <i><span class="varname">session-name</span></i></pre>
<p>By default, the RA is not bound to a PKI CMP session.</p>
<p><i><span class="varname">session-name</span></i> must be the same as the CMP session name in step <a href="#EN-US_TASK_0000001513034938__substep1198315311203">5.d</a>.</p>
<p>If the certificate application is successful, the device automatically applies to the CA server for updating the certificate when the certificate validity period exceeds the 50% by default.</p>
</p></li></ol>
</li><li><span>(Optional) Manually update the LAK certificate for the HTM.</span><p><pre class="screen"><a href="cmdqueryname=remote-attestation+pki+update-request"><b><span class="cmdname">remote-attestation pki update-request</span></b></a> { <strong><span>all</span></strong> | <strong><span>slot</span></strong> <i><span class="varname">slotID</span></i> }</pre>
<p>When the RA is configured, if a PKI certificate becomes invalid (for example, the certificate is revoked due to certificate information disclosure), you must update the PKI certificate. After this command is executed, the device immediately applies to the CA server for certificate update.</p>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001513034938__en-us_task_0228023023_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001513034938__en-us_task_0228023023_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0000001513034938__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+htm+status"><b><span class="cmdname">display htm status</span></b></a> { <strong><span>slot</span></strong> <i><span class="varname">slot-id</span></i> | <strong><span>all</span></strong> } command to check the HTM chip status.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../dc/galaxy_ra_cfg_0001.html">Remote Attestation Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../dc/galaxy_ra_cfg_0005.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>