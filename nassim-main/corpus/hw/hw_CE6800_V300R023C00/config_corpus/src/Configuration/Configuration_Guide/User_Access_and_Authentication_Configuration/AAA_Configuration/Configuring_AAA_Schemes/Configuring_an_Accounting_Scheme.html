
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring an Accounting Scheme">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_aaa_cfg_0011.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_aaa_cfg_0080.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="AAA">
<meta name="featurename" content="AD">
<meta name="featurename" content="HWTACACS">
<meta name="featurename" content="LDAP">
<meta name="featurename" content="RADIUS">
<meta name="featurename" content="Local User">
<meta name="featuretype" content="User Access and Authentication">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="AAA">
<meta name="featurename" content="AD">
<meta name="featurename" content="HWTACACS">
<meta name="featurename" content="LDAP">
<meta name="featurename" content="RADIUS">
<meta name="featurename" content="Local User">
<meta name="featuretype" content="User Access and Authentication">
<meta name="featurename" content="AAA">
<meta name="featurename" content="AD">
<meta name="featurename" content="HWTACACS">
<meta name="featurename" content="LDAP">
<meta name="featurename" content="RADIUS">
<meta name="featurename" content="Local User">
<meta name="featuretype" content="User Access and Authentication">
<meta name="featuretype" content="User Access and Authentication">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001512836042">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring an Accounting Scheme</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001512836042"></a><a name="EN-US_TASK_0000001512836042"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring an Accounting Scheme</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001512836042__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>An accounting scheme defines the accounting methods used for user accounting. If an accounting scheme is configured, by default, users are allowed to go online after accounting fails. Local authentication does not support accounting.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>By default, the accounting scheme named <strong>default</strong> is bound to the domain named <strong></strong><strong>default_admin</strong>. Modifying this accounting scheme affects the domain configuration. Exercise caution when modifying this accounting scheme. Otherwise, user accounting fails.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001512836042__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the AAA view.</span><p><pre class="screen"><a href="cmdqueryname=aaa"><b><span class="cmdname">aaa</span></b></a></pre>
</p></li><li><span>Create an accounting scheme and enter the accounting scheme view.</span><p><pre class="screen"><a href="cmdqueryname=accounting-scheme"><b><span class="cmdname">accounting-scheme</span></b></a> <i><span class="varname">accounting-scheme-name</span></i></pre>
</p></li><li><span>Configure an accounting method.</span><p><pre class="screen"><a href="cmdqueryname=accounting-mode"><b><span class="cmdname">accounting-mode</span></b></a> { <strong><span>hwtacacs</span></strong> | <strong><span>none</span></strong> | <strong><span>radius</span></strong> | }</pre>
</p></li><li><span>(Optional) Configure a policy used after accounting-start fails.</span><p><pre class="screen"><a href="cmdqueryname=accounting+start-fail"><b><span class="cmdname">accounting start-fail</span></b></a> { <strong><span>offline</span></strong> | <strong><span>online</span></strong> }</pre>
<p>By default, users are allowed to go online after accounting-start fails.</p>
<ul><li><p><strong>online</strong>: allows users to go online to prevent users from being affected by accounting failures caused by network faults.</p>
</li><li><p><strong>offline</strong>: rejects users' access requests and stops providing services to users if accounting fails.</p>
</li></ul>
</p></li><li><span>(Optional) Configure a policy used after real-time accounting fails.</span><ol type="a"><li class="substepexpand"><span>Enable real-time accounting and set the accounting interval.</span><p><pre class="screen"><a href="cmdqueryname=accounting+realtime"><b><span class="cmdname">accounting realtime</span></b></a> <i><span class="varname">interval</span></i></pre>
<p>By default, the device performs duration-based accounting, and real-time accounting is disabled.</p>
</p></li><li class="substepexpand"><span>Set the maximum number of times that the system does not respond to real-time accounting requests and the policy to be used after real-time accounting fails.</span><p><pre class="screen"><a href="cmdqueryname=accounting+interim-fail"><b><span class="cmdname">accounting interim-fail</span></b></a> [ <strong><span>max-times</span></strong> <i><span class="varname">times</span></i> ] { <strong><span>offline</span></strong> | <strong><span>online</span></strong> }</pre>
<p>By default, the maximum number of times that the system does not respond to real-time accounting requests is 3, and users are allowed to go online after real-time accounting fails.</p>
</p></li></ol>
</li><li><span>(Optional) Configure a policy used after accounting-stop fails.</span><p><ul><li>Enter the RADIUS server template view, configure the function of retransmitting RADIUS Accounting-Request(Stop) packets, and set the maximum number of times Accounting-Request(Stop) packets can be retransmitted.<pre class="screen"><a href="cmdqueryname=radius-server+accounting-stop-packet"><b><span class="cmdname">radius-server accounting-stop-packet</span></b></a> <strong><span>resend</span></strong> [ <i><span class="varname">resend-times</span></i> ]</pre>
<p>By default, the device is allowed to retransmit Accounting-Request(Stop) packets for a maximum of three times.</p>
</li><li>Enter the system view, configure the function of retransmitting HWTACACS Accounting-Request(Stop) packets, and set the maximum number of times Accounting-Request(Stop) packets can be retransmitted.<pre class="screen"><a href="cmdqueryname=hwtacacs-server+accounting-stop-packet"><b><span class="cmdname">hwtacacs-server accounting-stop-packet</span></b></a> <strong><span>resend</span></strong> { <strong><span>disable</span></strong> | <strong><span>enable</span></strong> <i><span class="varname">number</span></i> }</pre>
<p>By default, the device is allowed to retransmit Accounting-Request(Stop) packets for a maximum of three times.</p>
</li></ul>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001512836042__en-us_task_0228023023_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001512836042__en-us_task_0228023023_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001512836042__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <strong>display accounting-scheme </strong>[ <strong>name</strong> <em>accounting-scheme-name</em> ] command to check the accounting scheme configuration.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_aaa_cfg_0011.html">Configuring AAA Schemes
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_aaa_cfg_0080.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>