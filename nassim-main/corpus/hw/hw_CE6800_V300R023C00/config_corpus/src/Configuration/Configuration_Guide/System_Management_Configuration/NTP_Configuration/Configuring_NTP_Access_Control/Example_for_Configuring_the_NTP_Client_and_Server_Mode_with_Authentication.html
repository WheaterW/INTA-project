
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring the NTP Client/Server Mode with Authentication">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_ntp_cfg_0023.html">
<meta name="DC.Relation" scheme="URI" content="vrp_ntp_cfg_0031.html">
<meta name="DC.Relation" scheme="URI" content="vrp_ntp_cfg_0045.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="NTP">
<meta name="featuretype" content="System Management">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NTP">
<meta name="featuretype" content="System Management">
<meta name="featurename" content="NTP">
<meta name="featuretype" content="System Management">
<meta name="featuretype" content="System Management">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001564115461">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring the NTP Client/Server Mode with Authentication</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001564115461"></a><a name="EN-US_TASK_0000001564115461"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring the NTP Client/Server Mode with Authentication</h1>
<div class="taskbody" id="taskbody1571984996302"><div class="context"><a name="EN-US_TASK_0000001564115461__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001564115461__context78216269214019"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001564115461__p766295198214019">On the network shown in <a href="#EN-US_TASK_0000001564115461__fig_dc_vrp_ntp_cfg_002701">Figure 1</a>:</p>
<ul id="EN-US_TASK_0000001564115461__ul1406614013214019"><li id="EN-US_TASK_0000001564115461__li88482525214019"><p id="EN-US_TASK_0000001564115461__p1067113951214019"><a name="EN-US_TASK_0000001564115461__li88482525214019"></a><a name="li88482525214019"></a><span class="keyword" id="EN-US_TASK_0000001564115461__keyword1348238360214019">Device</span>A functions as an NTP server, and its local clock functions as a stratum 2 NTP master clock.</p>
</li><li id="EN-US_TASK_0000001564115461__li866516520214019"><p id="EN-US_TASK_0000001564115461__p1456541333214019"><a name="EN-US_TASK_0000001564115461__li866516520214019"></a><a name="li866516520214019"></a><span class="keyword" id="EN-US_TASK_0000001564115461__keyword924091578214019">Device</span>B functions as an NTP client to synchronize its clock to <span class="keyword" id="EN-US_TASK_0000001564115461__keyword3700112492911">Device</span>A.</p>
</li><li id="EN-US_TASK_0000001564115461__li272541641214019"><p id="EN-US_TASK_0000001564115461__p24741236214019"><a name="EN-US_TASK_0000001564115461__li272541641214019"></a><a name="li272541641214019"></a><span class="keyword" id="EN-US_TASK_0000001564115461__keyword156212335295">Device</span>C and <span class="keyword" id="EN-US_TASK_0000001564115461__keyword0653154118296">Device</span>D function as NTP clients and use <span class="keyword" id="EN-US_TASK_0000001564115461__keyword164620563291">Device</span>B as their respective NTP server.</p>
</li><li id="EN-US_TASK_0000001564115461__li369608264214019"><p id="EN-US_TASK_0000001564115461__p1483385924214019"><a name="EN-US_TASK_0000001564115461__li369608264214019"></a><a name="li369608264214019"></a>NTP authentication needs to be enabled on all devices.</p>
</li></ul>
<div class="fignone" id="EN-US_TASK_0000001564115461__fig_dc_vrp_ntp_cfg_002701"><a name="EN-US_TASK_0000001564115461__fig_dc_vrp_ntp_cfg_002701"></a><a name="fig_dc_vrp_ntp_cfg_002701"></a><span class="figcap"><b>Figure 1 </b>Configuring the NTP client/server mode with authentication</span><div class="note" id="EN-US_TASK_0000001564115461__note32911911704"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001564115461__p349805619214035">In this example, Interface1 and Interface2 represent <span>100GE</span><span>1/0/1</span> and <span>100GE</span><span>1/0/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001564115461__image217798721214019" src="figure/en-us_image_0000001513035438.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001564115461__1.3.2"></a><a name="1.3.2"></a>
<div class="p" id="EN-US_TASK_0000001564115461__context566287890214019"><h4 class="sectiontitle">Precautions</h4><ul id="EN-US_TASK_0000001564115461__ul977430915214019"><li id="EN-US_TASK_0000001564115461__li1335415135214019">Before specifying the NTP server address and the authentication key to be sent to the NTP server, you must enable NTP authentication on an NTP client. Otherwise, clock synchronization is directly implemented without NTP authentication.</li><li id="EN-US_TASK_0000001564115461__li742597254214019">The authentication keys on the NTP client and server must be the same and the authentication key must be declared. Otherwise, NTP authentication will fail.</li><li id="EN-US_TASK_0000001564115461__li1085154058214019">Enable NTP authentication on both the server and client.</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001564115461__1.3.3"></a><a name="1.3.3"></a>
<div class="p" id="EN-US_TASK_0000001564115461__context1246196273214019"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0000001564115461__p812639137214019">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0000001564115461__ol1373426275214019"><li id="EN-US_TASK_0000001564115461__li840112737214019"><p id="EN-US_TASK_0000001564115461__p69791734214019"><a name="EN-US_TASK_0000001564115461__li840112737214019"></a><a name="li840112737214019"></a>Configure <span class="keyword" id="EN-US_TASK_0000001564115461__keyword689420016214019">Device</span>A as an NTP server to provide the master clock.</p>
</li><li id="EN-US_TASK_0000001564115461__li681579017214019"><p id="EN-US_TASK_0000001564115461__p620765621214019"><a name="EN-US_TASK_0000001564115461__li681579017214019"></a><a name="li681579017214019"></a>Configure <span class="keyword" id="EN-US_TASK_0000001564115461__keyword1525717359517">Device</span>B as an NTP client to synchronize its clock to <span class="keyword" id="EN-US_TASK_0000001564115461__keyword1955013521952">Device</span>A.</p>
</li><li id="EN-US_TASK_0000001564115461__li857043864214019"><p id="EN-US_TASK_0000001564115461__p1163401819214019"><a name="EN-US_TASK_0000001564115461__li857043864214019"></a><a name="li857043864214019"></a>Configure <span class="keyword" id="EN-US_TASK_0000001564115461__keyword823414305710">Device</span>C and <span class="keyword" id="EN-US_TASK_0000001564115461__keyword7267241071">Device</span>D as NTP clients to synchronize their clocks to <span class="keyword" id="EN-US_TASK_0000001564115461__keyword15972849373">Device</span>B.</p>
</li><li id="EN-US_TASK_0000001564115461__li409045859214019"><p id="EN-US_TASK_0000001564115461__p738598166214019"><a name="EN-US_TASK_0000001564115461__li409045859214019"></a><a name="li409045859214019"></a>Configure <span class="keyword" id="EN-US_TASK_0000001564115461__keyword176607191214019">Device</span>A, <span class="keyword" id="EN-US_TASK_0000001564115461__keyword589092766214019">Device</span>B, <span class="keyword" id="EN-US_TASK_0000001564115461__keyword968042261214019">Device</span>C, and <span class="keyword" id="EN-US_TASK_0000001564115461__keyword1806140350214019">Device</span>D to participate in NTP authentication after passwords are encrypted using the HMAC-SHA256 algorithm.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001564115461__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001564115461__steps516431238214019"><li id="EN-US_TASK_0000001564115461__step1432131875214019"><span id="EN-US_TASK_0000001564115461__cmd843707549214019">Assign an IP address to each device and ensure that the devices are routable.</span></li><li id="EN-US_TASK_0000001564115461__step138560790214019"><span id="EN-US_TASK_0000001564115461__cmd918924182214019">On <span class="keyword" id="EN-US_TASK_0000001564115461__keyword687165161913">Device</span>A, configure the NTP master clock, specify a listening interface, and enable NTP authentication.</span><p><p id="EN-US_TASK_0000001564115461__p403568027214019"># Configure <span class="keyword" id="EN-US_TASK_0000001564115461__keyword761263032212">Device</span>A to use its local clock as a stratum 2 NTP reference clock.</p>
<pre class="screen" id="EN-US_TASK_0000001564115461__screen88301643553">&lt;<span class="keyword" id="EN-US_TASK_0000001564115461__keyword1483564318512">Device</span>A&gt; <strong id="EN-US_TASK_0000001564115461__b28354431551">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword1484551778"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong id="EN-US_TASK_0000001564115461__b12845113713"> ntp refclock-master 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword176603891717">*</span>DeviceA] <strong id="EN-US_TASK_0000001564115461__b5660182176">commit</strong></pre>
<p id="EN-US_TASK_0000001564115461__p205251953112711"># Specify a listening interface on <span class="keyword" id="EN-US_TASK_0000001564115461__keyword195711292300">Device</span>A.</p>
<pre class="screen" id="EN-US_TASK_0000001564115461__screen052625392720">[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword204071901681"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001564115461__b1383084717139">ntp server source-interface <span>100ge</span> <span>1/0/1</span> </strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword534794015711">*</span>DeviceA] <strong id="EN-US_TASK_0000001564115461__b534715406711">commit</strong></pre>
<p id="EN-US_TASK_0000001564115461__p1789482332214019"># Enable NTP authentication on <span class="keyword" id="EN-US_TASK_0000001564115461__keyword2098351219318">Device</span>A and configure an authentication key.</p>
<pre class="screen" id="EN-US_TASK_0000001564115461__screen28553585513">[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword71441881488"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001564115461__b1387610585511">ntp authentication enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword957571615813">*</span>DeviceA] <strong id="EN-US_TASK_0000001564115461__b1987695814517">ntp authentication-keyid 42 authentication-mode hmac-sha256 ********</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword19103845279">*</span>DeviceA] <strong id="EN-US_TASK_0000001564115461__b5104204518711">commit</strong></pre>
<div class="p" id="EN-US_TASK_0000001564115461__p1642071751214019"><div class="note" id="EN-US_TASK_0000001564115461__note987571460214019"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001564115461__p212420557214019">The authentication keys configured on the server and the client must be the same.</p>
</div></div>
</div>
<p id="EN-US_TASK_0000001564115461__p1546623595"># Enable the NTP server function on <span class="keyword" id="EN-US_TASK_0000001564115461__keyword100833895242254">Device</span>A.</p>
<pre class="screen" id="EN-US_TASK_0000001564115461__screen76572925913">[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword28081838135913"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001564115461__b1435511416013">undo </strong><strong id="EN-US_TASK_0000001564115461__b88081938185919">ntp </strong><strong id="EN-US_TASK_0000001564115461__b136975011019">server disable</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword14808113855912">*</span>DeviceA] <strong id="EN-US_TASK_0000001564115461__b13808113820591">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001564115461__step1055064254214019"><span id="EN-US_TASK_0000001564115461__cmd692443699214019">On <span class="keyword" id="EN-US_TASK_0000001564115461__keyword1245824787214019">Device</span>B, enable NTP authentication, specify a listening interface, and specify an NTP server.</span><p><p id="EN-US_TASK_0000001564115461__p1956471652214019"># Enable NTP authentication on <span class="keyword" id="EN-US_TASK_0000001564115461__keyword1436422757214019">Device</span>B, configure an authentication key, and declare the authentication key as reliable.</p>
<pre class="screen" id="EN-US_TASK_0000001564115461__screen183751510163">&lt;<span class="keyword" id="EN-US_TASK_0000001564115461__keyword84017107610">Device</span>B&gt;<strong id="EN-US_TASK_0000001564115461__b19401201019620"> system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword063515694"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001564115461__keyword10402121011617">Device</span>B]<strong id="EN-US_TASK_0000001564115461__b940281016618"> ntp authentication enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword174021910763"><span class="keyword" id="EN-US_TASK_0000001564115461__keyword1161371416914">*</span>Device</span>B]<strong id="EN-US_TASK_0000001564115461__b1340241015612"> ntp authentication-keyid 42 authentication-mode hmac-sha256 ********</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword1640220101964"><span class="keyword" id="EN-US_TASK_0000001564115461__keyword220313171194">*</span>Device</span>B] <strong id="EN-US_TASK_0000001564115461__b1040211105617">ntp trusted authentication-keyid 42</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword58341423691">*</span>DeviceB] <strong id="EN-US_TASK_0000001564115461__b128343237912">commit</strong></pre>
<p id="EN-US_TASK_0000001564115461__p953712388163"># Specify a listening interface on <span class="keyword" id="EN-US_TASK_0000001564115461__keyword14788182319331">Device</span>B.</p>
<pre class="screen" id="EN-US_TASK_0000001564115461__screen17538123817160">[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword47977351015"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001564115461__keyword77971634103">Device</span>B] <strong id="EN-US_TASK_0000001564115461__b12592162762214">ntp server source-interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword101731938693">*</span>DeviceB] <strong id="EN-US_TASK_0000001564115461__b1917363813918">commit</strong></pre>
<p id="EN-US_TASK_0000001564115461__p2081559073214019"># Specify <span class="keyword" id="EN-US_TASK_0000001564115461__keyword466794015334">Device</span>A as the NTP server of <span class="keyword" id="EN-US_TASK_0000001564115461__keyword1432154012345">Device</span>B, and configure <span class="keyword" id="EN-US_TASK_0000001564115461__keyword1821718539349">Device</span>B to use the configured authentication key.</p>
<pre class="screen" id="EN-US_TASK_0000001564115461__screen1178495531214019">[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword672071221016"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001564115461__keyword972171201016">Device</span>B]<strong id="EN-US_TASK_0000001564115461__b1072081212103"> ntp unicast-server 2.2.2.2 authentication-keyid 42</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword20522419919">*</span>DeviceB] <strong id="EN-US_TASK_0000001564115461__b15521541999">commit</strong></pre>
<p id="EN-US_TASK_0000001564115461__p817023718327"># Enable the NTP server function on <span class="keyword" id="EN-US_TASK_0000001564115461__keyword822814486240">Device</span>B.</p>
<pre class="screen" id="EN-US_TASK_0000001564115461__screen15170183710322">[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword1817017374324"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001564115461__b617083723218">undo </strong><strong id="EN-US_TASK_0000001564115461__b1017073763215">ntp </strong><strong id="EN-US_TASK_0000001564115461__b01708371323">server disable</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword8171537193218">*</span>DeviceB] <strong id="EN-US_TASK_0000001564115461__b12171237143220">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001564115461__step1321400523214019"><span id="EN-US_TASK_0000001564115461__cmd1650196434214019">On <span class="keyword" id="EN-US_TASK_0000001564115461__keyword156616574169">Device</span>C, enable NTP authentication and specify its NTP server.</span><p><pre class="screen" id="EN-US_TASK_0000001564115461__screen75301420562">&lt;<span class="keyword" id="EN-US_TASK_0000001564115461__keyword19538420369">Device</span>C&gt; <strong id="EN-US_TASK_0000001564115461__b115381020469">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword5929243115"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001564115461__keyword69312416117">Device</span>C]<strong id="EN-US_TASK_0000001564115461__b20922248112"> ntp authentication enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword2283546141110">*</span>DeviceC]<strong id="EN-US_TASK_0000001564115461__b8283346111110"> ntp authentication-keyid 42 authentication-mode hmac-sha256 ********</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword2663141183811"><span class="keyword" id="EN-US_TASK_0000001564115461__keyword1666334119389">*</span>Device</span>C] <strong id="EN-US_TASK_0000001564115461__b14663134110381">ntp trusted authentication-keyid 42</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword225215449117">*</span>DeviceC]<strong id="EN-US_TASK_0000001564115461__b1252944161119"> ntp unicast-server 10.0.0.1 authentication-keyid 42</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword036495216103">*</span>DeviceC] <strong id="EN-US_TASK_0000001564115461__b0364195214102">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001564115461__step714454511214019"><span id="EN-US_TASK_0000001564115461__cmd1255896000214019">On <span class="keyword" id="EN-US_TASK_0000001564115461__keyword18629145161915">Device</span>D, enable NTP authentication and specify its NTP server.</span><p><pre class="screen" id="EN-US_TASK_0000001564115461__screen5903630366">&lt;<span class="keyword" id="EN-US_TASK_0000001564115461__keyword109121330761">Device</span>D&gt; <strong id="EN-US_TASK_0000001564115461__b291215301964">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword112912111216"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001564115461__keyword11292219129">Device</span>D]<strong id="EN-US_TASK_0000001564115461__b1712972191217"> ntp authentication enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword962451518121">*</span>DeviceD]<strong id="EN-US_TASK_0000001564115461__b15624715141212"> ntp authentication-keyid 42 authentication-mode hmac-sha256 ********</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword4228294510"><span class="keyword" id="EN-US_TASK_0000001564115461__keyword122124458">*</span>Device</span>D] <strong id="EN-US_TASK_0000001564115461__b822162134518">ntp trusted authentication-keyid 42</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword454121810126">*</span>DeviceD]<strong id="EN-US_TASK_0000001564115461__b55418186122"> ntp unicast-server 10.0.0.1 authentication-keyid 42</strong>
[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword159113587105">*</span>DeviceD] <strong id="EN-US_TASK_0000001564115461__b189105831014">commit</strong></pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001564115461__example71152866214019"><a name="EN-US_TASK_0000001564115461__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0000001564115461__p1095534404214019"># Check the NTP status of <span class="keyword" id="EN-US_TASK_0000001564115461__keyword723491312214019">Device</span>B. The command output shows that the clock status is <strong id="EN-US_TASK_0000001564115461__b2674145618373">synchronized</strong>, indicating that clock synchronization is complete. The stratum of <span class="keyword" id="EN-US_TASK_0000001564115461__keyword430212123815">Device</span>B is 3, one stratum lower than <span class="keyword" id="EN-US_TASK_0000001564115461__keyword0692172716388">Device</span>A.</p>
<pre class="screen" id="EN-US_TASK_0000001564115461__screen38371571612">[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword10630114812132"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001564115461__keyword11867125720616">Device</span>B]<strong id="EN-US_TASK_0000001564115461__b086719571768"> display ntp status</strong>
 clock status: synchronized
 clock stratum: 3
 reference clock ID: 2.2.2.2
 nominal frequency: 60.0002 Hz
 actual frequency: 60.0002 Hz
 clock precision: 2^18
 clock offset: 3.8128 ms
 root delay: 31.26 ms
 root dispersion: 74.20 ms
 peer dispersion: 34.30 ms
 reference time: 11:55:56.833 UTC Feb 2 2020(C7B15BCC.D5604189)
 synchronization state: clock synchronized</pre>
<p id="EN-US_TASK_0000001564115461__p405379505214019"># Check the NTP status of <span class="keyword" id="EN-US_TASK_0000001564115461__keyword1977892193918">Device</span>C. The command output shows that the clock status is <strong id="EN-US_TASK_0000001564115461__b1178018253915">synchronized</strong>, indicating that clock synchronization is complete. The stratum of <span class="keyword" id="EN-US_TASK_0000001564115461__keyword562585215388">Device</span>C is 4, one stratum lower than <span class="keyword" id="EN-US_TASK_0000001564115461__keyword11121015173711">Device</span>B.</p>
<pre class="screen" id="EN-US_TASK_0000001564115461__screen1157713151475">[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword18648533131414"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001564115461__keyword1964953318148">Device</span>C]<strong id="EN-US_TASK_0000001564115461__b964811333143"> display ntp status</strong>
 clock status: synchronized
 clock stratum: 4
 reference clock ID: 10.0.0.1
 nominal frequency: 60.0002 Hz
 actual frequency: 60.0002 Hz
 clock precision: 2^18
 clock offset: 3.8128 ms
 root delay: 31.26 ms
 root dispersion: 74.20 ms
 peer dispersion: 34.30 ms
 reference time: 11:55:56.833 UTC Feb 2 2020(C7B15BCC.D5604189)
 synchronization state: clock synchronized</pre>
<p id="EN-US_TASK_0000001564115461__p1019288975214019"># Check the NTP status of <span class="keyword" id="EN-US_TASK_0000001564115461__keyword52077208397">Device</span>D. The command output shows that the clock status is <strong id="EN-US_TASK_0000001564115461__b62101220123913">synchronized</strong>, indicating that clock synchronization is complete. The stratum of <span class="keyword" id="EN-US_TASK_0000001564115461__keyword70037103913">Device</span>D is 4, one stratum lower than <span class="keyword" id="EN-US_TASK_0000001564115461__keyword9525946203920">Device</span>B.</p>
<pre class="screen" id="EN-US_TASK_0000001564115461__screen11747202814716">[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword108144578130"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001564115461__keyword1177110285712">Device</span>D]<strong id="EN-US_TASK_0000001564115461__b37719281275"> display ntp status</strong>
 clock status: synchronized
 clock stratum: 4
 reference clock ID: 10.0.0.1
 nominal frequency: 60.0002 Hz
 actual frequency: 60.0002 Hz
 clock precision: 2^18
 clock offset: 3.8128 ms
 root delay: 31.26 ms
 root dispersion: 74.20 ms
 peer dispersion: 34.30 ms
 reference time: 11:55:56.833 UTC Feb 2 2020(C7B15BCC.D5604189)
 synchronization state: clock synchronized</pre>
<p id="EN-US_TASK_0000001564115461__p1827572088214019"># Check the NTP status of <span class="keyword" id="EN-US_TASK_0000001564115461__keyword106322319404">Device</span>A.</p>
<pre class="screen" id="EN-US_TASK_0000001564115461__screen8883242775">[<span class="keyword" id="EN-US_TASK_0000001564115461__keyword124814111417"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001564115461__keyword1391674216710">Device</span>A] <strong id="EN-US_TASK_0000001564115461__b19916114217715">display ntp status</strong>
 clock status: synchronized
 clock stratum: 2
 reference clock ID: LOCAL(0)
 nominal frequency: 60.0002 Hz
 actual frequency: 60.0002 Hz
 clock precision: 2^18
 clock offset: 0.0000 ms
 root delay: 0.00 ms
 root dispersion: 26.50 ms
 peer dispersion: 10.00 ms
 reference time: 12:01:48.377 UTC Feb 2 2020(C7B15D2C.60A15981)
 synchronization state: clock synchronized</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001564115461__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul id="EN-US_TASK_0000001564115461__ul513313070214019"><li id="EN-US_TASK_0000001564115461__li556888850214019"><p id="EN-US_TASK_0000001564115461__p897168324214019"><a name="EN-US_TASK_0000001564115461__li556888850214019"></a><a name="li556888850214019"></a><span class="keyword" id="EN-US_TASK_0000001564115461__keyword1225335881214019">Device</span>A</p>
<pre class="screen" id="EN-US_TASK_0000001564115461__screen117416416816">#
sysname <span class="keyword" id="EN-US_TASK_0000001564115461__keyword16165243820">Device</span>A
#
ntp authentication-keyid 42 authentication-mode hmac-sha256 cipher %+%#JA!v6M22=Gg\{&gt;U.lx%#)c%yY}0*"/`5mi&gt;&lt;QS)L%+%#
ntp refclock-master 2
ntp authentication enable
ntp server source-interface <span>100GE</span><span>1/0/1</span>
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 2.2.2.2 255.255.255.0
#
return</pre>
</li><li id="EN-US_TASK_0000001564115461__li54656758214019"><p id="EN-US_TASK_0000001564115461__p1640614437214019"><a name="EN-US_TASK_0000001564115461__li54656758214019"></a><a name="li54656758214019"></a><span class="keyword" id="EN-US_TASK_0000001564115461__keyword116815179214019">Device</span>B</p>
<pre class="screen" id="EN-US_TASK_0000001564115461__screen19121162916820">#
sysname <span class="keyword" id="EN-US_TASK_0000001564115461__keyword16208132917811">Device</span>B
#
ntp authentication-keyid 42 authentication-mode hmac-sha256 cipher %+%#&gt;hD8))_H-XZVut2u3!_0lq3,+Ph=:OE}pX;T2M'9%+%#
ntp trusted authentication-keyid 42
ntp unicast-server 2.2.2.2 authentication-keyid 42
ntp authentication enable
ntp server source-interface <span>100GE</span><span>1/0/1</span>
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.0.0.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.1.1.11 255.255.255.0
#
return</pre>
</li><li id="EN-US_TASK_0000001564115461__li413150208214019"><p id="EN-US_TASK_0000001564115461__p1000915105214019"><a name="EN-US_TASK_0000001564115461__li413150208214019"></a><a name="li413150208214019"></a><span class="keyword" id="EN-US_TASK_0000001564115461__keyword1140762784214019">Device</span>C</p>
<pre class="screen" id="EN-US_TASK_0000001564115461__screen8410165012819">#
sysname <span class="keyword" id="EN-US_TASK_0000001564115461__keyword184331450583">Device</span>C
#
ntp authentication-keyid 42 authentication-mode hmac-sha256 cipher %+%#m:fVJfk*r&amp;3x"1J`21^K`Y;LH;B+g(t2&lt;ZX^}Q_<font style="font-size:8pt" Face="Courier New" >~</font>%+%#
ntp trusted authentication-keyid 42
ntp unicast-server 10.0.0.1 authentication-keyid 42
ntp authentication enable
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.0.0.2 255.255.255.0
#
return</pre>
</li><li id="EN-US_TASK_0000001564115461__li1916365405214019"><p id="EN-US_TASK_0000001564115461__p393624129214019"><a name="EN-US_TASK_0000001564115461__li1916365405214019"></a><a name="li1916365405214019"></a><span class="keyword" id="EN-US_TASK_0000001564115461__keyword1391103343214019">Device</span>D</p>
<pre class="screen" id="EN-US_TASK_0000001564115461__screen1767059911">#
sysname <span class="keyword" id="EN-US_TASK_0000001564115461__keyword1877913516917">Device</span>D
#
ntp authentication-keyid 42 authentication-mode hmac-sha256 cipher %+%#$\`_6BKWy1]kdR@=c;O@UX!)Vor5iYi|zIYEG_v5%+%#
ntp trusted authentication-keyid 42
ntp unicast-server 10.0.0.1 authentication-keyid 42
ntp authentication enable
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.0.0.3 255.255.255.0
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_ntp_cfg_0023.html">Configuring NTP Access Control
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_ntp_cfg_0031.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_ntp_cfg_0045.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>