
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring ERPS Multi-Instance">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_erps_cfg_0028.html">
<meta name="DC.Relation" scheme="URI" content="vrp_erps_cfg_0034.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="ERPS">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ERPS">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featurename" content="ERPS">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001142718098">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring ERPS Multi-Instance</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001142718098"></a><a name="EN-US_TASK_0000001142718098"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring ERPS Multi-Instance</h1>
<div class="taskbody" id="taskbody0000001142718098"><div class="context"><a name="EN-US_TASK_0000001142718098__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001142718098__context1685135284010"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001142718098__p72947405398">On an ERPS network, a physical ring can be configured with only one ERPS ring and only one blocked port can be specified. When the ERPS ring is complete, the blocked port prevents all user packets from passing through. As a result, all user packets are transmitted over only one path on the ERPS ring, and the link on the other side of the blocked port becomes idle, wasting bandwidth resources.</p>
<p id="EN-US_TASK_0000001142718098__p655920825183241">In <a href="#EN-US_TASK_0000001142718098__fig8777358165819">Figure 1</a>, two ERPS instances, ERPS ring 1 and ERPS ring 2, are configured on DeviceA through DeviceD. P1 on DeviceB is a blocked port on ERPS ring 1, and P2 on DeviceA is a blocked port on ERPS ring 2, implementing load balancing and link backup.</p>
<div class="fignone" id="EN-US_TASK_0000001142718098__fig8777358165819"><a name="EN-US_TASK_0000001142718098__fig8777358165819"></a><a name="fig8777358165819"></a><span class="figcap"><b>Figure 1 </b>ERPS single-ring multi-instance networking</span><div class="note" id="EN-US_TASK_0000001142718098__note72061014113213"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001142718098__p2020651419327">In this example, interface 1 and interface 2 represent <span>100GE</span><span>1/0/1</span> and <span>100GE</span><span>1/0/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001142718098__image1701437607183241" src="figure/en-us_image_0000001188758123.png"></span></div>
<p id="EN-US_TASK_0000001142718098__p13572016154015"></p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001142718098__1.3.2"></a><a name="1.3.2"></a>
<div class="p" id="EN-US_TASK_0000001142718098__context2039058356175330"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0000001142718098__p741236473183241">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0000001142718098__ol320966695183241"><li id="EN-US_TASK_0000001142718098__li274710952183241"><p id="EN-US_TASK_0000001142718098__p2124612861183241"><a name="EN-US_TASK_0000001142718098__li274710952183241"></a><a name="li274710952183241"></a>Set the link type of all ports to be added to an ERPS ring to trunk.</p>
</li><li id="EN-US_TASK_0000001142718098__li806629958183241"><p id="EN-US_TASK_0000001142718098__p2112924242183241"><a name="EN-US_TASK_0000001142718098__li806629958183241"></a><a name="li806629958183241"></a>Create ERPS rings and configure control VLANs and ERP instances.</p>
</li><li id="EN-US_TASK_0000001142718098__li1396092772183241"><p id="EN-US_TASK_0000001142718098__p724891882183241"><a name="EN-US_TASK_0000001142718098__li1396092772183241"></a><a name="li1396092772183241"></a>Add Layer 2 ports to ERPS rings and configure port roles.</p>
</li><li id="EN-US_TASK_0000001142718098__li118485278183241"><p id="EN-US_TASK_0000001142718098__p664726577183241"><a name="EN-US_TASK_0000001142718098__li118485278183241"></a><a name="li118485278183241"></a>Configure the Guard timer and WTR timer for ERPS rings.</p>
</li><li id="EN-US_TASK_0000001142718098__li828255588183241"><p id="EN-US_TASK_0000001142718098__p502667662183241"><a name="EN-US_TASK_0000001142718098__li828255588183241"></a><a name="li828255588183241"></a>Configure the Layer 2 forwarding function on DeviceA through DeviceD.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001142718098__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001142718098__steps1317705587175357"><li id="EN-US_TASK_0000001142718098__step2038275004711"><span id="EN-US_TASK_0000001142718098__cmd19382250124719">Set the link type of all ports to be added to an ERPS ring to trunk.</span><p><p id="EN-US_TASK_0000001142718098__p16994120132419"># Configure DeviceA. The configurations of DeviceB, DeviceC, and DeviceD are similar to the configuration of DeviceA. For detailed configurations, see Configuration Scripts.</p>
<pre class="screen" id="EN-US_TASK_0000001142718098__screen886841984183241">&lt;<span class="keyword" id="EN-US_TASK_0000001142718098__keyword8110733132420">HUAWEI</span>&gt;<strong id="EN-US_TASK_0000001142718098__b2054827248183241"> system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword152807501025"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001142718098__keyword1863511507204">HUAWEI</span>]<strong id="EN-US_TASK_0000001142718098__b593157148183241"> sysname DeviceA</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword157731034018"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001142718098__keyword105771710194014">HUAWEI</span>]<strong id="EN-US_TASK_0000001142718098__b75775109405"> commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword17617178132119"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001142718098__b821496562183241">interface </strong><strong id="EN-US_TASK_0000001142718098__b1736241636175333"><span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword19828374495">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b13982113710493"> portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword198874103387">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b1305395357183241"> port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword493332092110">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b762607423183241"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword1982752262114">*</span>DeviceA] <strong id="EN-US_TASK_0000001142718098__b2108235287183241">interface </strong><strong id="EN-US_TASK_0000001142718098__b2001894962175333"><span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword2641220145011">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b36418206506"> portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword12404152418212">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b773004191183241"> port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword576152712119">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b336871729183241"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword108731731142116">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b759313265120"> commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001142718098__step1458050044183241"><span id="EN-US_TASK_0000001142718098__cmd511193591183241">Create ERPS ring 1 and ERPS ring 2 and configure ERP instances for the two rings. Set the control VLAN ID of ERPS ring 1 to 10 and the control VLAN ID of ERPS ring 2 to 20. Enable ERPS ring 1 to transmit data packets from VLANs 100 to 200 and ERPS ring 2 to transmit data packets from VLANs 300 to 400.</span><p><p id="EN-US_TASK_0000001142718098__p2041337349183241"># Configure DeviceA. The configurations of DeviceB, DeviceC, and DeviceD are similar to the configuration of DeviceA. For detailed configurations, see Configuration Scripts.</p>
<pre class="screen" id="EN-US_TASK_0000001142718098__screen900040974183241">[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword691510593243"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001142718098__b991299475183241">erps ring 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword0836585255">*</span>DeviceA-erps-ring1] <strong id="EN-US_TASK_0000001142718098__b1597478096183241">control-vlan 10</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword945781112513">*</span>DeviceA-erps-ring1] <strong id="EN-US_TASK_0000001142718098__b69518456183241">protected-instance 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword376617168252">*</span>DeviceA-erps-ring1] <strong id="EN-US_TASK_0000001142718098__b1615507795183241">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword999911710252">*</span>DeviceA] <strong id="EN-US_TASK_0000001142718098__b2061530622183241">stp region-configuration</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword342941910259">*</span>DeviceA-mst-region] <strong id="EN-US_TASK_0000001142718098__b694777282183241">instance 1 vlan 10 100 to 200</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword186111922102516">*</span>DeviceA-mst-region] <strong id="EN-US_TASK_0000001142718098__b1305967676183241">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword14629162318256">*</span>DeviceA] <strong id="EN-US_TASK_0000001142718098__b1915793550183241">erps ring 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword12670152414251">*</span>DeviceA-erps-ring2] <strong id="EN-US_TASK_0000001142718098__b183722561183241">control-vlan 20</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword115054318252">*</span>DeviceA-erps-ring2] <strong id="EN-US_TASK_0000001142718098__b588966163183241">protected-instance 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword159909323253">*</span>DeviceA-erps-ring2] <strong id="EN-US_TASK_0000001142718098__b1268637465183241">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword16910838102510">*</span>DeviceA] <strong id="EN-US_TASK_0000001142718098__b1085826831183241">stp region-configuration</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword4324184412253">*</span>DeviceA-mst-region] <strong id="EN-US_TASK_0000001142718098__b128592063183241">instance 2 vlan 20 300 to 400</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword10608346132510">*</span>DeviceA-mst-region] <strong id="EN-US_TASK_0000001142718098__b296563440183241">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword83322050192515">*</span>DeviceA-mst-region] <strong id="EN-US_TASK_0000001142718098__b139141519131311">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001142718098__step1073419120183241"><span id="EN-US_TASK_0000001142718098__cmd2092515040183241">Add Layer 2 ports to ERPS rings and configure port roles. Configure <span><span><span>100GE</span></span><span>1/0/1</span></span> on DeviceA and <span><span><span>100GE</span></span><span>1/0/2</span></span> on DeviceB as their respective RPL owner ports.</span><p><p id="EN-US_TASK_0000001142718098__p676117091183241"># Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001142718098__screen2110651654183241">[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword12961111152613"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001142718098__b1184436959183241">interface </strong><strong id="EN-US_TASK_0000001142718098__b132318509576"><span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword117131276267">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b1097733248183241"> stp disable</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword17671911122619">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b295689413183241"> erps ring 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword18933191332618">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b380656632183241"> erps ring 2 rpl owner</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword0783151762615">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b391471057183241"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword151539228268">*</span>DeviceA] <strong id="EN-US_TASK_0000001142718098__b1212709419183241">interface </strong><strong id="EN-US_TASK_0000001142718098__b796864515614"><span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword67971123112614">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b1345442200183241"> stp disable</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword11291102512614">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b1809312934183241"> erps ring 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword1380522617261">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b39240917183241"> erps ring 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword15873112817269">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b412546949183241"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword36991432102611">*</span>DeviceA]<strong id="EN-US_TASK_0000001142718098__b1111210124156"> commit</strong></pre>
<div class="p" id="EN-US_TASK_0000001142718098__p379399390183241"># Configure DeviceB.<pre class="screen" id="EN-US_TASK_0000001142718098__screen590936360183241">[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword31451615142819"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001142718098__b1014391647183241">interface </strong><strong id="EN-US_TASK_0000001142718098__b1726175435715"><span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword979462052811">*</span>DeviceB-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b208626706183241"> stp disable</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword15705172318282">*</span>DeviceB-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b366932215183241"> erps ring 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword1343422572813">*</span>DeviceB-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b1611591498183241"> erps ring 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword1124612276281">*</span>DeviceB-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b1176809631183241"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword716352912281">*</span>DeviceB] <strong id="EN-US_TASK_0000001142718098__b145823278183241">interface </strong><strong id="EN-US_TASK_0000001142718098__b41661450066"><span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword191956315289">*</span>DeviceB-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b459184565183241"> stp disable</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword04724339288">*</span>DeviceB-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b1350289202183241"> erps ring 1 rpl owner</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword33341838182818">*</span>DeviceB-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b384666922183241"> erps ring 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword1777553912810">*</span>DeviceB-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b1564720419183241"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword94231744142818">*</span>DeviceB]<strong id="EN-US_TASK_0000001142718098__b1849514716160"> commit</strong></pre>
</div>
<p id="EN-US_TASK_0000001142718098__p2099612617183241"># Configure DeviceC. The configuration of DeviceD is similar to that of DeviceC. For detailed configurations, see Configuration Scripts.</p>
<pre class="screen" id="EN-US_TASK_0000001142718098__screen1664704845183241">[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword74791441192412"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001142718098__b1659693898183241">interface </strong><strong id="EN-US_TASK_0000001142718098__b142795945719"><span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword1891842118467">*</span>DeviceC-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b857828207183241"> stp disable</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword18507112264613">*</span>DeviceC-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b1103594427183241"> erps ring 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword15712623164614">*</span>DeviceC-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b989412395183241"> erps ring 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword15751202418461">*</span>DeviceC-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b2097484724183241"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword7625132534620">*</span>DeviceC] <strong id="EN-US_TASK_0000001142718098__b1975054093183241">interface </strong><strong id="EN-US_TASK_0000001142718098__b12942153569"><span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword8710102674613">*</span>DeviceC-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b77709725183241"> stp disable</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword17765112718461">*</span>DeviceC-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b2101668520183241"> erps ring 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword881552817460">*</span>DeviceC-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b1320784579183241"> erps ring 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword1717163010468">*</span>DeviceC-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b2068175797183241"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword614989142512">*</span>DeviceC]<strong id="EN-US_TASK_0000001142718098__b41501097251"> commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001142718098__step187990017183241"><span id="EN-US_TASK_0000001142718098__cmd599770982183241">Configure the Guard timer and WTR timer for ERPS rings.</span><p><p id="EN-US_TASK_0000001142718098__p38991276183241"># Configure DeviceA. The configurations of DeviceB, DeviceC, and DeviceD are similar to the configuration of DeviceA. For detailed configurations, see Configuration Scripts.</p>
<pre class="screen" id="EN-US_TASK_0000001142718098__screen1892499217183241">[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword63849232619"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001142718098__b1164096081183241">erps ring 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword5388175223118"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-erps-ring1] <strong id="EN-US_TASK_0000001142718098__b336516639183241">wtr-timer 6</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword512795812319">*</span>DeviceA-erps-ring1] <strong id="EN-US_TASK_0000001142718098__b221745390183241">guard-timer 100</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword346911063219">*</span>DeviceA-erps-ring1] <strong id="EN-US_TASK_0000001142718098__b1802134034183241">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword549319213328">*</span>DeviceA] <strong id="EN-US_TASK_0000001142718098__b1590487030183241">erps ring 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword85133483213">*</span>DeviceA-erps-ring2] <strong id="EN-US_TASK_0000001142718098__b242635393183241">wtr-timer 6</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword1673856183219">*</span>DeviceA-erps-ring2] <strong id="EN-US_TASK_0000001142718098__b58037854183241">guard-timer 100</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword34411584321">*</span>DeviceA-erps-ring2] <strong id="EN-US_TASK_0000001142718098__b302603671183241">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword13111141243218">*</span>DeviceA] <strong id="EN-US_TASK_0000001142718098__b13970173952615">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001142718098__step1576422172183241"><span id="EN-US_TASK_0000001142718098__cmd1421691765183241">Configure the Layer 2 forwarding function on DeviceA through DeviceD.</span><p><p id="EN-US_TASK_0000001142718098__p1118292751183241"># Configure DeviceA. The configurations of DeviceB, DeviceC, and DeviceD are similar to the configuration of DeviceA. For detailed configurations, see Configuration Scripts.</p>
<pre class="screen" id="EN-US_TASK_0000001142718098__screen1664701459183241">[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword1471255013327"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001142718098__b1682571701183241">vlan batch 100 to 200 300 to 400</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword177851119193217">*</span>DeviceA] <strong id="EN-US_TASK_0000001142718098__b1910539758183241">interface </strong><strong id="EN-US_TASK_0000001142718098__b94417416588"><span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword1437792643210">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b5646343134015"> </strong><strong id="EN-US_TASK_0000001142718098__b1260143174112">undo port trunk allow-pass vlan 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword4742296325">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b1796978959183241"> port trunk allow-pass vlan 100 to 200 300 to 400</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword1336313218328">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/1</span></span>]<strong id="EN-US_TASK_0000001142718098__b2108968499183241"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword11192183411322">*</span>DeviceA] <strong id="EN-US_TASK_0000001142718098__b3262383183241">interface </strong><strong id="EN-US_TASK_0000001142718098__b14350102070"><span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword108791735103212">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b13907105414531"> </strong><strong id="EN-US_TASK_0000001142718098__b7101122410413">undo port trunk allow-pass vlan 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword10647639193215">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b732450979183241"> port trunk allow-pass vlan 100 to 200 300 to 400</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword3409541113219">*</span>DeviceA-<span><span><span>100GE</span></span><span>1/0/2</span></span>]<strong id="EN-US_TASK_0000001142718098__b227593376183241"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword3929184413214">*</span>DeviceA]<strong id="EN-US_TASK_0000001142718098__b17763123015284"> commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001142718098__step2140781875183241"><span id="EN-US_TASK_0000001142718098__cmd1179951287183241">Verify the configuration.</span><p><p id="EN-US_TASK_0000001142718098__p957334835183241"># After the network becomes stable, run the <a href="cmdqueryname=display+erps"><b><span class="cmdname" id="EN-US_TASK_0000001142718098__cmdname1521069133183241">display erps</span></b></a> command to check brief information about the ERPS ring and ports added to the ERPS ring. The following example uses the command output on DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001142718098__screen1935598737183241">[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword106431511378"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001142718098__b163019394183241">display erps</strong>
D : Discarding
F : Forwarding
R : RPL Owner
N  : RPL Neighbour
FS : Forced Device
MS : Manual Device
Total number of rings configured = 2
Ring  Control  WTR Timer  Guard Timer  Port 1              Port 2
ID    VLAN     (min)      (csec)
--------------------------------------------------------------------------------
   1       10          6          100  (F)<span><span>100GE</span><span>1/0/1</span></span>          (D,R)<span><span>100GE</span><span>1/0/2</span></span>
   2       20          6          100  (F)<span><span>100GE</span><span>1/0/1</span></span>          (F)<span><span>100GE</span><span>1/0/2</span></span>
--------------------------------------------------------------------------------
</pre>
<p id="EN-US_TASK_0000001142718098__p1154300330183241"># Run the <a href="cmdqueryname=display+erps+verbose"><b><span class="cmdname" id="EN-US_TASK_0000001142718098__cmdname560765706183241">display erps verbose</span></b></a> command to check detailed information about the ERPS ring and ports added to the ERPS ring. The following example uses the command output on DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001142718098__screen45321968183241">[<span class="keyword" id="EN-US_TASK_0000001142718098__keyword4297429173819"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001142718098__b1293279822183241">display erps verbose</strong>
Ring ID                             : 1
Description                         : Ring 1
Control Vlan                        : 10
Protected Instance                  : 1
Service Vlan                        : 100 to 200
WTR Timer Setting (min)             : 6      Running (s)           : <samp class="codeph" id="EN-US_TASK_0000001142718098__codeph2078424761183241">0</samp>
Guard Timer Setting (csec)          : 100    Running (csec)        : 0
Holdoff Timer Setting (deciseconds) : 0      Running (deciseconds) : 0
WTB Timer Running (csec)            : 0
Ring State                          : Idle
RAPS_MEL                            : 7
Revertive Mode                      : Revertive
R-APS Channel Mode                  : -
Version                             : 1
Sub-ring                            : No
Forced Device Port                  : -
Manual Device Port                  : -
TC-Notify                           : -
Time since last topology change     : <samp class="codeph" id="EN-US_TASK_0000001142718098__codeph2038218960183241">0</samp> days <samp class="codeph" id="EN-US_TASK_0000001142718098__codeph2093421909183241">0</samp>h:<samp class="codeph" id="EN-US_TASK_0000001142718098__codeph86085165183241">35</samp>m:<samp class="codeph" id="EN-US_TASK_0000001142718098__codeph1795377069183241">5</samp>s
 
--------------------------------------------------------------------------------
Port                Port Role     Port Status     Signal Status
--------------------------------------------------------------------------------
<span><span>100GE</span><span>1/0/1</span></span>             Common        Forwarding      Non-failed
<span><span>100GE</span><span>1/0/2</span></span>             RPL Owner     Discarding      Non-failed

Ring ID                             : 2
Description                         : Ring 2
Control Vlan                        : 20
Protected Instance                  : 2
Service Vlan                        : 300 to 400
WTR Timer Setting (min)             : 6      Running (s)           : <samp class="codeph" id="EN-US_TASK_0000001142718098__codeph1033962288183241">0</samp>
Guard Timer Setting (csec)          : 100    Running (csec)        : 0
Holdoff Timer Setting (deciseconds) : 0      Running (deciseconds) : 0
WTB Timer Running (csec)            : 0
Ring State                          : Idle
RAPS_MEL                            : 7
Revertive Mode                      : Revertive
R-APS Channel Mode                  : -
Version                             : 1
Sub-ring                            : No 
Forced Device Port                  : -
Manual Device Port                  : -
TC-Notify                           : -
Time since last topology change     : <samp class="codeph" id="EN-US_TASK_0000001142718098__codeph19327522183241">0</samp> days <samp class="codeph" id="EN-US_TASK_0000001142718098__codeph1048061340183241">0</samp>h:<samp class="codeph" id="EN-US_TASK_0000001142718098__codeph1054110098183241">35</samp>m:<samp class="codeph" id="EN-US_TASK_0000001142718098__codeph490330754183241">30</samp>s
--------------------------------------------------------------------------------
Port                Port Role     Port Status     Signal Status
--------------------------------------------------------------------------------
<span><span>100GE</span><span>1/0/1</span></span>             Common        Forwarding      Non-failed
<span><span>100GE</span><span>1/0/2</span></span>             Common        Forwarding      Non-failed</pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001142718098__example926791201183241"><a name="EN-US_TASK_0000001142718098__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul id="EN-US_TASK_0000001142718098__ul816855019183241"><li id="EN-US_TASK_0000001142718098__li929654337183241"><p id="EN-US_TASK_0000001142718098__p1756910034183241"><a name="EN-US_TASK_0000001142718098__li929654337183241"></a><a name="li929654337183241"></a>DeviceA</p>
<pre class="screen" id="EN-US_TASK_0000001142718098__screen661976398183241">#
sysname DeviceA
#
vlan batch 10 20 100 to 200 300 to 400
#
stp region-configuration
 instance 1 vlan 10 100 to 200
 instance 2 vlan 20 300 to 400
#
erps ring 1
 control-vlan 10
 protected-instance 1
 wtr-timer 6
 guard-timer 100
erps ring 2
 control-vlan 20
 protected-instance 2
 wtr-timer 6
 guard-timer 100
#
interface <span>100ge</span> <span>1/0/1</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 10 20 100 to 200 300 to 400
 stp disable
 erps ring 1
 erps ring 2 rpl owner
#
interface <span>100ge</span> <span>1/0/2</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 10 20 100 to 200 300 to 400
 stp disable
 erps ring 1
 erps ring 2
#
return</pre>
</li><li id="EN-US_TASK_0000001142718098__li1268878782183241"><p id="EN-US_TASK_0000001142718098__p1533074364183241"><a name="EN-US_TASK_0000001142718098__li1268878782183241"></a><a name="li1268878782183241"></a>DeviceB</p>
<pre class="screen" id="EN-US_TASK_0000001142718098__screen1630295816183241">#
sysname DeviceB
#
vlan batch 10 20 100 to 200 300 to 400
#
stp region-configuration
 instance 1 vlan 10 100 to 200
 instance 2 vlan 20 300 to 400
#
erps ring 1
 control-vlan 10
 protected-instance 1
 wtr-timer 6
 guard-timer 100
erps ring 2
 control-vlan 20
 protected-instance 2
 wtr-timer 6
 guard-timer 100
#
interface <span>100ge</span> <span>1/0/1</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 10 20 100 to 200 300 to 400
 stp disable
 erps ring 1
 erps ring 2
#
interface <span>100ge</span> <span>1/0/2</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 10 20 100 to 200 300 to 400
 stp disable
 erps ring 1 rpl owner
 erps ring 2
#
return</pre>
</li><li id="EN-US_TASK_0000001142718098__li1445054208183241"><p id="EN-US_TASK_0000001142718098__p1133509933183241"><a name="EN-US_TASK_0000001142718098__li1445054208183241"></a><a name="li1445054208183241"></a>DeviceC</p>
<pre class="screen" id="EN-US_TASK_0000001142718098__screen291489823183241">#
sysname DeviceC
#
vlan batch 10 20 100 to 200 300 to 400
#
stp region-configuration
 instance 1 vlan 10 100 to 200
 instance 2 vlan 20 300 to 400
#
erps ring 1
 control-vlan 10
 protected-instance 1
 wtr-timer 6
 guard-timer 100
erps ring 2
 control-vlan 20
 protected-instance 2
 wtr-timer 6
 guard-timer 100
#
interface <span>100ge</span> <span>1/0/1</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 10 20 100 to 200 300 to 400
 stp disable
 erps ring 1
 erps ring 2
#
interface <span>100ge</span> <span>1/0/2</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 10 20 100 to 200 300 to 400
 stp disable
 erps ring 1
 erps ring 2
#
return</pre>
</li><li id="EN-US_TASK_0000001142718098__li539647064183241"><p id="EN-US_TASK_0000001142718098__p1024763367183241"><a name="EN-US_TASK_0000001142718098__li539647064183241"></a><a name="li539647064183241"></a>DeviceD</p>
<pre class="screen" id="EN-US_TASK_0000001142718098__screen205518653183241">#
sysname DeviceD
#
vlan batch 10 20 100 to 200 300 to 400
#
stp region-configuration
 instance 1 vlan 10 100 to 200
 instance 2 vlan 20 300 to 400
#
erps ring 1
 control-vlan 10
 protected-instance 1
 wtr-timer 6
 guard-timer 100
erps ring 2
 control-vlan 20
 protected-instance 2
 wtr-timer 6
 guard-timer 100
#
interface <span>100ge</span> <span>1/0/1</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 10 20 100 to 200 300 to 400
 stp disable
 erps ring 1
 erps ring 2
#
interface <span>100ge</span> <span>1/0/2</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 10 20 100 to 200 300 to 400
 stp disable
 erps ring 1
 erps ring 2
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_erps_cfg_0028.html">Configuring ERPS Multi-Instance
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_erps_cfg_0034.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>