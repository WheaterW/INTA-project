
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Basic VBST Functions">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_vbst_cfg_0006.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_vbst_cfg_0010.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VBST">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VBST">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featurename" content="VBST">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001513168314">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Basic VBST Functions</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001513168314"></a><a name="EN-US_TASK_0000001513168314"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Basic VBST Functions</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001513168314__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0000001513168314__fig15719124213546">Figure 1</a>, DeviceC and DeviceD are dual-homed to DeviceA and DeviceB, respectively, forming a ring network. DeviceC transmits traffic from VLAN 10 and VLAN 20, and DeviceD transmits traffic from VLAN 20 and VLAN 30. The customer wants to deploy VBST on such a network to fulfill the following requirements: Service traffic in each VLAN is correctly forwarded and service traffic from different VLANs is load balanced to improve link efficiency.</p>
<div class="fignone" id="EN-US_TASK_0000001513168314__fig15719124213546"><a name="EN-US_TASK_0000001513168314__fig15719124213546"></a><a name="fig15719124213546"></a><span class="figcap"><b>Figure 1 </b>VBST networking</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interfaces 1, 2, 3, 4, and 5 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, <span>100GE</span> <span>1/0/3</span>, <span>100GE</span> <span>1/0/4</span>, and <span>100GE</span> <span>1/0/5</span> respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001513048370.png"></span></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001513168314__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Create required VLANs on devices.</span><p><p># Create VLAN 10, VLAN 20, and VLAN 30 on DeviceA.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>vlan batch 10 20 30</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Create VLAN 10, VLAN 20, and VLAN 30 on DeviceB.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceB</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>vlan batch 10 20 30</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
<p># Create VLAN 10 and VLAN 20 on DeviceC.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceC</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>vlan batch 10 20</strong>
[<span class="keyword">*</span>DeviceC] <strong>commit</strong></pre>
<p># Create VLAN 20 and VLAN 30 on DeviceD.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceD</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong>vlan batch 20 30</strong>
[<span class="keyword">*</span>DeviceD] <strong>commit</strong></pre>
</p></li><li><span>Add interfaces to VLANs.</span><p><p># On DeviceA, add <span>100GE</span> <span>1/0/1</span> to VLAN 10, VLAN 20, and VLAN 30, <span>100GE</span> <span>1/0/2</span> to VLAN 20 and VLAN 30, and <span>100GE</span> <span>1/0/3</span> to VLAN 10 and VLAN 20.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>portswitch</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>port link-type trunk</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>port trunk allow-pass vlan 10 20 30</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>undo port trunk allow-pass vlan 1</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>port</strong><strong>switch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>port link-type trunk</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>port trunk allow-pass vlan 20 30</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>undo port trunk allow-pass vlan 1</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>port</strong><strong>switch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>port link-type trunk</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>port trunk allow-pass vlan 10 20</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>undo port trunk allow-pass vlan 1</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p>#On DeviceB, add <span>100GE</span> <span>1/0/1</span> to VLAN 10, VLAN 20, and VLAN 30, <span>100GE</span> <span>1/0/2</span> to VLAN 10 and VLAN 20, and <span>100GE</span> <span>1/0/3</span> to VLAN 20 and VLAN 30.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>port</strong><strong>switch</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>port link-type trunk</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>port trunk allow-pass vlan 10 20 30</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>undo port trunk allow-pass vlan 1</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>port</strong><strong>switch</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>port link-type trunk</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>port trunk allow-pass vlan 10 20</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>undo port trunk allow-pass vlan 1</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong>port</strong><strong>switch</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong>port link-type trunk</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong>port trunk allow-pass vlan 20 30</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong>undo port trunk allow-pass vlan 1</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
<p>#On DeviceC, add <span>100GE</span> <span>1/0/2</span> to VLAN 10 and VLAN 20, <span>100GE</span> <span>1/0/3</span> to VLAN 10 and VLAN 20, <span>100GE</span> <span>1/0/4</span> to VLAN 10, and <span>100GE</span> <span>1/0/5</span> to VLAN 20.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>port</strong><strong>switch</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>port link-type trunk</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>port trunk allow-pass vlan 10 20</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>undo port trunk allow-pass vlan 1</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC] <strong>interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/3</span>] <strong>port</strong><strong>switch</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/3</span>] <strong>port link-type trunk</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/3</span>] <strong>port trunk allow-pass vlan 10 20</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/3</span>] <strong>undo port trunk allow-pass vlan 1</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC] <strong>interface <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/4</span>] <strong>port</strong><strong>switch</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/4</span>] <strong>port link-type access</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/4</span>] <strong>port default vlan 10</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/4</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC] <strong>interface <span>100ge</span> <span>1/0/5</span></strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/5</span>] <strong>port</strong><strong>switch</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/5</span>] <strong>port link-type access</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/5</span>] <strong>port default vlan 20</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/5</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC] <strong>commit</strong></pre>
<p>#On DeviceD, add <span>100GE</span> <span>1/0/2</span> to VLAN 20 and VLAN 30, <span>100GE</span> <span>1/0/3</span> to VLAN 20 and VLAN 30, <span>100GE</span> <span>1/0/4</span> to VLAN 20, and <span>100GE</span> <span>1/0/5</span> to VLAN 30.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD-<span>100GE</span><span>1/0/2</span>] <strong>port</strong><strong>switch</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD-<span>100GE</span><span>1/0/2</span>] <strong>port link-type trunk</strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/2</span>] <strong>port trunk allow-pass vlan 20 30</strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/2</span>] <strong>undo port trunk allow-pass vlan 1</strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceD] <strong>interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/3</span>] <strong>port</strong><strong>switch</strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/3</span>] <strong>port link-type trunk</strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/3</span>] <strong>port trunk allow-pass vlan 20 30</strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/3</span>] <strong>undo port trunk allow-pass vlan 1</strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceD] <strong>interface <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/4</span>] <strong>port</strong><strong>switch</strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/4</span>] <strong>port link-type access</strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/4</span>] <strong>port default vlan 20</strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/4</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceD] <strong>interface <span>100ge</span> <span>1/0/5</span></strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/5</span>] <strong>port</strong><strong>switch</strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/5</span>] <strong>port link-type access</strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/5</span>] <strong>port default vlan 30</strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/5</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceD] <strong>commit</strong></pre>
</p></li><li><span>Configure devices to work in VBST mode.</span><p><p># Configure DeviceA to work in VBST mode.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>stp mode vbst</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure DeviceB to work in VBST mode.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>stp mode vbst</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
<p># Configure DeviceC to work in VBST mode.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>stp mode vbst</strong>
[<span class="keyword">*</span>DeviceC] <strong>commit</strong></pre>
<p># Configure DeviceD to work in VBST mode.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong>stp mode vbst</strong>
[<span class="keyword">*</span>DeviceD] <strong>commit</strong></pre>
</p></li><li><span>Configure the root bridges and secondary root bridges in VLANs.</span><p><p># Configure DeviceA as the root bridge in VLAN 10.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>stp vlan 10 root primary</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure DeviceB as a secondary root bridge in VLAN 10.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>stp vlan 10 root secondary</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
<p># Configure DeviceA as the root bridge in VLAN 20.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>stp vlan 20 root primary</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure DeviceB as a secondary root bridge in VLAN 20.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>stp vlan 20 root secondary</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
<p># Configure DeviceB as the root bridge in VLAN 30.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>stp vlan 30 root primary</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
<p># Configure DeviceA as a secondary root bridge in VLAN 30.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>stp vlan 30 root secondary</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
</p></li><li><span>Configure a proper path cost for a port in corresponding VLANs so that the port will be blocked.</span><p><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>The path cost range varies depending on the path cost calculation method. In this example, setting the path cost to 2000000 for blocking interfaces complies with the default IEEE 802.1t calculation method.</p>
</li><li><p>All devices on a network must use the same path cost calculation method.</p>
</li></ul>
</div></div>
<p># Set the path cost of <span>100GE</span> <span>1/0/2</span> on DeviceC to 2000000 in VLAN 10 and VLAN 20.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>stp vlan 10 cost 2000000</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>stp vlan 20 cost 2000000</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC] <strong>commit</strong></pre>
<p># Set the path cost of <span>100GE</span> <span>1/0/2</span> on DeviceD to 2000000 in VLAN 20 and VLAN 30.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD-<span>100GE</span><span>1/0/2</span>] <strong>stp vlan 20 cost 2000000</strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/2</span>] <strong>stp vlan 30 cost 2000000</strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceD] <strong>commit</strong></pre>
</p></li><li><span>Enable VBST to eliminate loops.</span><p><p>Enable VBST globally.</p>
<p>By default, VBST is enabled globally. You can run the <a href="cmdqueryname=display+stp+vlan+information"><b><span class="cmdname">display stp vlan information</span></b></a> command to check the global VBST status. If VBST is disabled globally, run the <a href="cmdqueryname=undo+stp+vlan+disable"><b><span class="cmdname">undo stp vlan disable</span></b></a> command in the system view to enable VBST globally.</p>
<p>Enable VBST in a VLAN.</p>
<p>By default, VBST is enabled in a VLAN. You can run the <a href="cmdqueryname=display+stp+vlan"><b><span class="cmdname">display stp vlan</span></b></a> <i><span class="varname">vlan-id</span></i> <strong><span>information</span></strong> command to check the VBST status in a VLAN. If VBST is disabled in the VLAN, run the <a href="cmdqueryname=undo+stp"><b><span class="cmdname">undo stp</span></b></a> <strong><span>vlan</span></strong><i><span class="varname"> vlan-id</span></i> <strong><span>disable</span></strong> command in the system view to enable VBST in the VLAN.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001513168314__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After the configuration is complete and the network topology becomes stable, perform the following operations to verify the configuration.</p>
<p># Run the <a href="cmdqueryname=display+stp+vlan+bridge+local"><b><span class="cmdname">display stp vlan bridge local</span></b></a> command on DeviceA to check the spanning tree working mode. In the command output, the Protocol field shows that the device works in VBST mode.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display stp vlan bridge local</strong>
------------------------------------------------------------------
VLANID BridgeID             HelloTime MaxAge ForwardDelay Protocol
------------------------------------------------------------------
   10 10.00e0-fc00-df01            2     20           15     VBST
   20 20.00e0-fc00-df01            2     20           15     VBST
   30 4126.00e0-fc00-df01          2     20           15     VBST
------------------------------------------------------------------</pre>
<p># Run the <a href="cmdqueryname=display+stp+vlan+information+brief"><b><span class="cmdname">display stp vlan information brief</span></b></a> command on DeviceA, DeviceB, DeviceC, and DeviceD to check the port status. The command output on DeviceA is used as an example. DeviceA participates in spanning tree calculation in VLAN 10, VLAN 20, and VLAN 30. DeviceA is the root bridge in both VLAN 10 and VLAN 20, so <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/3</span> are elected as the designated ports in VLAN 10 whereas <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, and <span>100GE</span> <span>1/0/3</span> are elected as the designated ports in VLAN 20. DeviceA is the secondary root bridge in VLAN 30, so <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span> are elected as the root port and designated port, respectively, in VLAN 30.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display stp vlan information brief</strong>
--------------------------------------------------------------------------------
VLANID Interface              Role STPState    Protection           Cost Edged
--------------------------------------------------------------------------------
    10 <span>100GE</span><span>1/0/1</span>             DESI forwarding  none                  200 disable
    10 <span>100GE</span><span>1/0/3</span>             DESI forwarding  none                  200 disable
    20 <span>100GE</span><span>1/0/1</span>             DESI forwarding  none                  200 disable
    20 <span>100GE</span><span>1/0/2</span>             DESI forwarding  none                  200 disable
    20 <span>100GE</span><span>1/0/3</span>             DESI forwarding  none                  200 disable
    30 <span>100GE</span><span>1/0/1</span>             ROOT forwarding  none                  200 disable
    30 <span>100GE</span><span>1/0/2</span>             DESI forwarding  none                  200 disable
--------------------------------------------------------------------------------</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001513168314__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li>DeviceA<pre class="screen">#
sysname DeviceA
#
stp vlan 10 20 root primary
stp vlan 30 root secondary
#
vlan batch 10 20 30
#
stp mode vbst
#
interface <span>100GE</span><span>1/0/1</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 10 20 30
#
interface <span>100GE</span><span>1/0/2</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 20 30
#
interface <span>100GE</span><span>1/0/3</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 10 20
#
return</pre>
</li><li>DeviceB<pre class="screen">#
sysname DeviceB
#
stp vlan 10 20 root secondary
stp vlan 30 root primary
#
vlan batch 10 20 30
#
stp mode vbst
#
interface <span>100GE</span><span>1/0/1</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 10 20 30
#
interface <span>100GE</span><span>1/0/2</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 10 20
#
interface <span>100GE</span><span>1/0/3</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 20 30
#
return</pre>
</li><li>DeviceC<pre class="screen">#
sysname DeviceC
#
vlan batch 10 20
#
stp mode vbst
#
interface <span>100GE</span><span>1/0/2</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 10 20
 stp vlan 10 20 cost 2000000
#
interface <span>100GE</span><span>1/0/3</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 10 20
#
interface <span>100GE</span><span>1/0/4</span>
 port default vlan 10
#
interface <span>100GE</span><span>1/0/5</span>
 port default vlan 20
#
return</pre>
</li><li>DeviceD<pre class="screen">#
sysname DeviceD
#
vlan batch 20 30
#
stp mode vbst
#
interface <span>100GE</span><span>1/0/2</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 20 30
 stp vlan 20 30 cost 2000000
#
interface <span>100GE</span><span>1/0/3</span>
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 20 30
#
interface <span>100GE</span><span>1/0/4</span>
 port default vlan 20
#
interface <span>100GE</span><span>1/0/5</span>
 port default vlan 30
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_vbst_cfg_0006.html">Configuring Basic VBST Functions
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_vbst_cfg_0010.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>