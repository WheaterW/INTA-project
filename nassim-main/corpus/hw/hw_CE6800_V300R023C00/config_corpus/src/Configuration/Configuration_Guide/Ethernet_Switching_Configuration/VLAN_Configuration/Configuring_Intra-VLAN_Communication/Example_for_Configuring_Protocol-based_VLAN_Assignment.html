
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Protocol-based VLAN Assignment">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_vlan_cfg_0016.html">
<meta name="DC.Relation" scheme="URI" content="vrp_vlan_cfg_0026.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VLAN">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featurename" content="QinQ">
<meta name="featurename" content="VLAN">
<meta name="featurename" content="VLAN Mapping">
<meta name="featurename" content="VLAN Pool">
<meta name="featurename" content="Voice VLAN">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176742331">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Protocol-based VLAN Assignment</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176742331"></a><a name="EN-US_TASK_0000001176742331"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Protocol-based VLAN Assignment</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176742331__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0000001176742331__fig880859125815">Figure 1</a>, PC1 and PC2 use IPv4 and IPv6, respectively. PCs using different protocols need to be added to different VLANs. In this example, PC1 needs to be added to VLAN 10, and PC2 needs to be added to VLAN 20.</p>
<div class="fignone" id="EN-US_TASK_0000001176742331__fig880859125815"><a name="EN-US_TASK_0000001176742331__fig880859125815"></a><a name="fig880859125815"></a><span class="figcap"><b>Figure 1 </b>Networking diagram for configuring protocol-based VLAN assignment</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, and <span>100GE</span> <span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001130622910.png"></span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The <span>CE6885-LL (low latency mode)</span> does not support this example.</p>
</div></div>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176742331__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Create VLAN 10 and VLAN 20 and associate them with the IPv4 and IPv6 protocols, respectively.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>vlan batch 10 20</strong>
[<span class="keyword">*</span>DeviceA] <strong>vlan 10</strong>
[<span class="keyword">*</span>DeviceA-vlan10] <strong>protocol-vlan ipv4</strong>
[<span class="keyword">*</span>DeviceA-vlan10] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>vlan 20</strong>
[<span class="keyword">*</span>DeviceA-vlan20] <strong>protocol-vlan ipv6</strong>
[<span class="keyword">*</span>DeviceA-vlan20] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
</p></li><li><span>Associate <span>100GE</span> <span>1/0/2</span> and <span>100GE</span> <span>1/0/3</span> with VLAN 10 and VLAN 20, respectively.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>protocol-vlan vlan 10 all priority 5</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>port link-type hybrid</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>port hybrid untagged vlan 10</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>protocol-vlan vlan 20 all priority 6</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>port link-type hybrid</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>port hybrid untagged vlan 20</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>port link-type trunk</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>port trunk allow-pass vlan 10 20</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001176742331__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Run the <a href="cmdqueryname=display+protocol-vlan+vlan+all"><b><span class="cmdname">display protocol-vlan vlan all</span></b></a> command to check the types and indexes of the protocols associated with VLANs.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display protocol-vlan vlan all</strong>
----------------------------------------------------------------
VLAN           Protocol Index    Protocol Type
----------------------------------------------------------------
10             0                 ipv4
20             0                 ipv6</pre>
<p># Run the <a href="cmdqueryname=display+protocol-vlan+interface+all"><b><span class="cmdname">display protocol-vlan interface all</span></b></a> command to check the protocol-based VLAN configuration on all interfaces.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display protocol-vlan interface all</strong>
-------------------------------------------------------------------------------
Interface                   VLAN    Index     Protocol Type           Priority
-------------------------------------------------------------------------------
<span>100GE</span><span>1/0/2</span>                  10      0         ipv4                    5
<span>100GE</span><span>1/0/3</span>                  20      0         ipv6                    6</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001176742331__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Configuration Scripts</h4><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
vlan batch 10 20
#
vlan 10
 protocol-vlan 0 ipv4
#
vlan 20
 protocol-vlan 0 ipv6
#
interface <span>100GE</span><span>1/0/1</span>
 port link-type trunk
 port trunk allow-pass vlan 10 20
#
interface <span>100GE</span><span>1/0/2</span>
 port link-type hybrid
 port hybrid untagged vlan 10
 protocol-vlan vlan 10 0 priority 5
#
interface <span>100GE</span><span>1/0/3</span>
 port link-type hybrid
 port hybrid untagged vlan 20
 protocol-vlan vlan 20 0 priority 6
#
return</pre>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_vlan_cfg_0016.html">Configuring Intra-VLAN Communication
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_vlan_cfg_0026.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>