
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring BGP Load Balancing">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_0065.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_0066.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_2104.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176663685">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring BGP Load Balancing</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176663685"></a><a name="EN-US_TASK_0000001176663685"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring BGP Load Balancing</h1>
<div class="taskbody"><div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001176663685__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before configuring BGP load balancing, you have completed the following task:</p>
<ul><li><a href="vrp_bgp_cfg_0014.html">Configure basic BGP functions.</a></li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176663685__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the BGP view.</span><p><pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></pre>
</p></li><li><span>Enter the IPv4 unicast address family view.</span><p><pre class="screen"><a href="cmdqueryname=ipv4-family+unicast"><b><span class="cmdname">ipv4-family</span></b></a> <strong><span>unicast</span></strong></pre>
</p></li><li><span>Set the maximum number of BGP equal-cost routes that can participate in load balancing.</span><p><ul><li>Configure BGP peer or peer group-based load balancing.<pre class="screen"><a href="cmdqueryname=peer+load-balancing+as-path-ignore+as-path-relax"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>load-balancing</span></strong> [ <strong><span>as-path-ignore</span></strong> | <strong><span>as-path-relax</span></strong> ]</pre>
</li></ul>
<ul><li>Set the maximum number of BGP equal-cost routes that can participate in load balancing globally.<pre class="screen"><a href="cmdqueryname=maximum+load-balancing+ebgp+ibgp+ecmp-nexthop-changed"><b><span class="cmdname">maximum load-balancing</span></b></a> [ <strong><span>ebgp</span></strong> | <strong><span>ibgp</span></strong> ] <i><span class="varname">number</span></i> [ <strong><span>ecmp-nexthop-changed</span></strong> ]</pre>
<p>By default, the maximum number of BGP equal-cost routes for load balancing is 1, indicating that load balancing is not implemented.</p>
<p><strong><span>ebgp</span></strong> indicates that load balancing is implemented only among EBGP routes.</p>
<p><strong><span>ibgp</span></strong> indicates that load balancing is implemented only among IBGP routes.</p>
<p>If neither <strong><span>ebgp</span></strong> nor <strong><span>ibgp</span></strong> is specified, EBGP and IBGP routes can compete for preferred routes to balance traffic, and the number of allowed load-balancing EBGP routes is the same as the number of allowed load-balancing IBGP routes.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Before routes to the same destination implement load balancing on a public network, a device determines the type of optimal route. If IBGP routes are optimal, only IBGP routes carry out load balancing. If EBGP routes are optimal, only EBGP routes carry out load balancing. This means that load balancing cannot be implemented using both IBGP and EBGP routes with the same destination address.</p>
</div></div>
</li></ul>
</p></li><li><span>(Optional) Run one of the following commands to change a load balancing rule as needed:</span><p><ul><li>Disable the device from comparing the AS_Path attributes of the routes for load balancing.<pre class="screen"><a href="cmdqueryname=load-balancing+as-path-ignore"><b><span class="cmdname">load-balancing as-path-ignore</span></b></a></pre>
</li><li>Disable the device from comparing the AS_Path attributes of the same length of the routes for load balancing.<pre class="screen"><a href="cmdqueryname=load-balancing+as-path-relax"><b><span class="cmdname">load-balancing as-path-relax</span></b></a></pre>
</li><li>Disable the device from comparing the IGP metric values of the routes for load balancing.<pre class="screen"><a href="cmdqueryname=load-balancing+igp-metric-ignore"><b><span class="cmdname">load-balancing igp-metric-ignore</span></b></a></pre>
</li><li>Disable the device from comparing the MED values of the routes for load balancing.<pre class="screen"><a href="cmdqueryname=load-balancing+med-ignore"><b><span class="cmdname">load-balancing med-ignore</span></b></a></pre>
</li></ul>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Address family views of the preceding commands are different. When running any of the commands, ensure that the command is run in a correct address family view.</p>
<p>Change load balancing rules based on networking. Exercise caution when running the preceding commands.</p>
</div></div>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001176663685__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001176663685__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0000001176663685__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After configuring the function, verify the configuration.</p>
<ul><li><p>Run the <a href="cmdqueryname=display+bgp+routing-table"><b><span class="cmdname">display bgp routing-table</span></b></a> [ <i><span class="varname">network</span></i> ] [ <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> ] [ <strong><span>longer-prefixes</span></strong> ] command to check information about the BGP routing table.</p>
</li><li><p>Run the <a href="cmdqueryname=display+ip+routing-table"><b><span class="cmdname">display ip routing-table</span></b></a> [ <strong><span>verbose</span></strong> ] command to check information about routes in the IP routing table.</p>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_bgp_cfg_0065.html">Configuring BGP Load Balancing
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_bgp_cfg_0066.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_bgp_cfg_2104.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>