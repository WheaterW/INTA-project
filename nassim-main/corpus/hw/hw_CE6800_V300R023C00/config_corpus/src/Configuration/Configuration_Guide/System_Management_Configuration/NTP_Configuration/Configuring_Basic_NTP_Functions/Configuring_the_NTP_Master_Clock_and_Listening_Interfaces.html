
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring the NTP Master Clock and Listening Interfaces">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_ntp_cfg_0012.html">
<meta name="DC.Relation" scheme="URI" content="vrp_ntp_cfg_0014.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="NTP">
<meta name="featuretype" content="System Management">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NTP">
<meta name="featuretype" content="System Management">
<meta name="featurename" content="NTP">
<meta name="featuretype" content="System Management">
<meta name="featuretype" content="System Management">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001512676226">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring the NTP Master Clock and Listening Interfaces</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001512676226"></a><a name="EN-US_TASK_0000001512676226"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring the NTP Master Clock and Listening Interfaces</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001512676226__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>An NTP master clock can be configured on the server (which can be a unicast server, broadcast server, multicast server, manycast server, or symmetric passive peer) to provide the reference time for other devices. In addition, an interface that listens for external NTP packets needs to be specified. Otherwise, the server fails to respond to client requests.</p>
<p>An NTP master clock does not need to be configured when the local server has been synchronized with an NTP master clock at a higher stratum. When this is the case, if the NTP master clock at a higher stratum fails, the local server cannot provide the reference time for lower-level clients. To resolve this problem, you are advised to configure an NTP master clock on the local server and set its clock stratum to that of the upper-level server plus 1.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001512676226__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Configure the NTP master clock.</span><p><pre class="screen"><span><a href="cmdqueryname=ntp+refclock-master"><b><span class="cmdname">ntp refclock-master</span></b></a></span> [ <i><span class="varname">ip-address</span></i> ] [ <i><span class="varname">stratum</span></i> ]</pre>
<p>Configure the local clock as the NTP master clock to provide the reference time for other devices. The value of <i><span class="varname">stratum</span></i> must be smaller than the stratum value of a client. Otherwise, the client cannot synchronize with the clock on the server.</p>
</p></li><li><span>Configure a listening interface for the NTP server.</span><p>
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.3.2.1.1.4.1.1" liSelected="liSelected"><p>Listening interface of the NTP server</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.3.2.1.1.4.1.2" liSelected="liSelected"><p>Command</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.2.3.2.1.1.4.1.3" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.3.2.1.1.4.1.1 "><p>The device functions as an NTP IPv4 server to listen to all interfaces.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.3.2.1.1.4.1.2 "><p><a href="cmdqueryname=ntp+server+source-interface"><b><span class="cmdname">ntp server source-interface</span></b></a> <strong>all enable</strong></p>
</td>
<td class="cellrowborder" rowspan="3" valign="top" width="33.33333333333333%" headers="mcps1.3.2.3.2.1.1.4.1.3 "><p>By default, the device functions as an NTP IPv4 server and does not listen to any address. If all three commands are configured, the <a href="cmdqueryname=ntp+server+source-interface"><b><span class="cmdname">ntp server source-interface</span></b></a> <strong>all enable</strong> command takes precedence. The device functions as an NTP IPv4 server to receive and process packets received by all interfaces and addresses.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.2.3.2.1.1.4.1.1 "><p>The device functions as an NTP IPv4 server to listen to a specified interface.</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.2.3.2.1.1.4.1.2 "><p><a href="cmdqueryname=ntp+server+source-interface"><b><span class="cmdname">ntp server source-interface</span></b></a> { <i><span class="varname">interface-name </span></i><span>|<span><i><span class="varname">interface-type interface-number</span></i></span></span> }</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.2.3.2.1.1.4.1.1 "><p>The device functions as an NTP IPv4 server to listen to a specified interface and address.</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.2.3.2.1.1.4.1.2 "><p><a href="cmdqueryname=ntp+server"><b><span class="cmdname">ntp server</span></b></a><strong> <strong><span>physic-isolate</span></strong> <a href="cmdqueryname=source-interface"><b><span class="cmdname">source-interface</span></b></a> </strong>{ <i><span class="varname">interface-name</span></i> | <i><span class="varname">interface-type interface-number</span></i> } <strong><span>source-address</span></strong> <i><span class="varname">ipv4Addr</span></i></p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.3.2.1.1.4.1.1 "><p>The device functions as an NTP IPv6 server to listen to all interfaces.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.2.3.2.1.1.4.1.2 "><p><a href="cmdqueryname=ntp+ipv6+server+source-interface"><b><span class="cmdname">ntp ipv6 server source-interface</span></b></a> <strong>all enable</strong></p>
</td>
<td class="cellrowborder" rowspan="3" valign="top" width="33.33333333333333%" headers="mcps1.3.2.3.2.1.1.4.1.3 "><p>By default, the device functions as an NTP IPv6 server and does not listen to any address. If all three commands are configured, the <a href="cmdqueryname=ntp+ipv6+server+source-interface"><b><span class="cmdname">ntp ipv6 server source-interface</span></b></a> <strong>all enable</strong> command takes precedence. The device functions as an NTP IPv6 server to receive and process packets received by all interfaces and addresses.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.2.3.2.1.1.4.1.1 "><p>The device functions as an NTP IPv6 server to listen to a specified address.</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.2.3.2.1.1.4.1.2 "><p><a href="cmdqueryname=ntp+ipv6+server+source-address"><b><span class="cmdname">ntp ipv6 server source-address</span></b></a> <em>ipv6Addr</em> [ <strong>vpn-instance</strong> <span><i><span class="varname">vpnName</span></i></span> ]</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.2.3.2.1.1.4.1.1 "><p>The device functions as an NTP IPv6 server to listen to a specified interface and address.</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.2.3.2.1.1.4.1.2 "><p><a href="cmdqueryname=ntp+ipv6+server"><b><span class="cmdname">ntp ipv6 server</span></b></a><strong> <strong><span>physic-isolate</span></strong> <a href="cmdqueryname=source-interface"><b><span class="cmdname">source-interface</span></b></a> </strong>{ <i><span class="varname">interface-name</span></i> | <i><span class="varname">interface-type interface-number</span></i> } <strong><span>source-address</span></strong> <i><span class="varname">ipv6Addr</span></i></p>
</td>
</tr>
</tbody>
</table>
</div>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0000001512676226__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Follow-up Procedure</h4>
<div class="p"><p>For details about how to enable the NTP authentication function, see <a href="vrp_ntp_cfg_0025.html">Enabling NTP Authentication</a>. Before configuring the working mode, ensure that the authentication function has been configured.</p>
</div></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_ntp_cfg_0012.html">Configuring Basic NTP Functions
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_ntp_cfg_0014.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>