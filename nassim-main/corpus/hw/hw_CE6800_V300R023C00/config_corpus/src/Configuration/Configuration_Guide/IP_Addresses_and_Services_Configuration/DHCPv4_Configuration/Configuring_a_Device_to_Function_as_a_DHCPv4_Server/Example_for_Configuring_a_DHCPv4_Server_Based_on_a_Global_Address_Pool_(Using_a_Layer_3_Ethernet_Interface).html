
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a DHCPv4 Server Based on a Global Address Pool (Using a Layer 3 Ethernet Interface)">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_dhcpv4_cfg_0012.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_dhcpv4_cfg_0017.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_dhcpv4_cfg_0020.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="DHCPv4">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="DHCPv4">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="DHCPv4">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001564126229">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring a DHCPv4 Server Based on a Global Address Pool (Using a Layer 3 Ethernet Interface)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001564126229"></a><a name="EN-US_TASK_0000001564126229"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a DHCPv4 Server Based on a Global Address Pool (Using a Layer 3 Ethernet Interface)</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001564126229__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0000001564126229__dc_cfg_dhcp_104701">Figure 1</a>, <span class="keyword">DeviceA</span> functions as a DHCPv4 server; the PCs on network segment 10.1.1.0/24 are fixed terminals; network segment 10.1.2.0/24 is used for the terminals' temporary access. To facilitate unified management, the administrator requires the terminals to automatically obtain IPv4 addresses and the IPv4 address of the DNS server (if users need to access the network using domain names, a DNS server must be configured). A PC named Client_1 requires a fixed IPv4 address of 10.1.1.100/24 to meet service requirements.</p>
<div class="fignone" id="EN-US_TASK_0000001564126229__dc_cfg_dhcp_104701"><a name="EN-US_TASK_0000001564126229__dc_cfg_dhcp_104701"></a><a name="dc_cfg_dhcp_104701"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring a DHCPv4 server based on a global address pool (using a Layer 3 Ethernet interface)</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1 and interface 2 represent <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001564126273.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001564126229__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><div class="p">The configuration roadmap is as follows:<ol><li>Set an IPv4 address lease to 30 days for the PCs (Client_1 to Client_n) on network segment 10.1.1.0/24, and allocate a fixed IPv4 address of 10.1.1.100/24 to Client_1 statically.</li><li>Set an IPv4 address lease to two days for the PCs (Client_s to Client_t) on network segment 10.1.2.0/24 for temporary access.</li></ol>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001564126229__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enable DHCPv4.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">DeviceA</span></strong>
[*<span class="keyword">HUAWEI</span>] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword">DeviceA</span>] <strong>dhcp enable</strong>
[*<span class="keyword">DeviceA</span>] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li><li><span>Configure IPv4 addresses for interfaces.</span><p><pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>interface </strong><strong><span>100GE</span> <span>1/0/1</span></strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ip address 10.1.1.1 24</strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[*DeviceA] <strong>interface </strong><strong><span>100GE</span> <span>1/0/2</span></strong>
[*DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>undo portswitch</strong>
[*DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>ip address 10.1.2.1 24</strong>
[*DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[*DeviceA] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li><li><span>Configure global address pools.</span><p><p># Configure attributes for the address pool <strong>pool1</strong>.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>ip pool pool1</strong>
[*DeviceA-ip-pool-pool1] <strong>network 10.1.1.0 mask 24</strong>
[*DeviceA-ip-pool-pool1] <strong>gateway-list 10.1.1.1</strong>
[*DeviceA-ip-pool-pool1] <strong>lease day 30</strong>
[*DeviceA-ip-pool-pool1] <strong>domain-name huawei.com</strong>
[*DeviceA-ip-pool-pool1] <strong>dns-list 10.1.3.1</strong>
[*DeviceA-ip-pool-pool1] <strong>static-bind ip-address 10.1.1.100 mac-address 00e0-fc12-3456</strong>
[*DeviceA-ip-pool-pool1] <strong>quit</strong>
[*<span class="keyword">DeviceA</span>] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
<p># Configure attributes for the address pool <strong>pool2</strong>.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>ip pool pool2</strong>
[*DeviceA-ip-pool-pool2] <strong>network 10.1.2.0 mask 24</strong>
[*DeviceA-ip-pool-pool2] <strong>gateway-list 10.1.2.1</strong>
[*DeviceA-ip-pool-pool2] <strong>lease day 2</strong>
[*DeviceA-ip-pool-pool2] <strong>domain-name huawei.com</strong>
[*DeviceA-ip-pool-pool2] <strong>dns-list 10.1.3.1</strong>
[*DeviceA-ip-pool-pool2] <strong>quit</strong>
[*<span class="keyword">DeviceA</span>] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li><li><span>Enable the DHCPv4 server function based on global address pools on Layer 3 Ethernet interfaces.</span><p><pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>interface </strong><strong><span>100GE</span> <span>1/0/1</span></strong>
[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>dhcp select global</strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[*DeviceA] <strong>interface </strong><strong><span>100GE</span> <span>1/0/2</span></strong>
[*DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>dhcp select global</strong>
[*DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[*DeviceA] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001564126229__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># On DeviceA, run the <a href="cmdqueryname=display+ip+pool"><b><span class="cmdname">display ip pool</span></b></a> command to check IPv4 address configuration and allocation in address pools. The <strong>Used</strong> field displays the number of used IPv4 addresses in each address pool.</p>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>display ip pool name pool1</strong>

  Pool-name        : pool1                                                                                                          
  Pool-No          : 7                                                                                                              
  Lease            : 30 Days 0 Hours 0 Minutes                                                                                      
  Domain-name      : huawei.com                                                                                                     
  DNS-server0      : 10.1.3.1                                                                                                       
  NBNS-server0     : -                                                                                                              
  Netbios-type     : -                                                                                                              
  Position         : Local                                                                                                          
  Status           : Unlocked                                                                                                       
  Gateway-0        : 10.1.1.1                                                                                                       
  Network          : 10.1.1.0                                                                                                       
  Mask             : 255.255.255.0                                                                                                  
  VPN instance     : --                                                                                                             
  Logging          : Disable                                                                                                        
  Conflicted address recycle interval: -                                                                                            
  Address Statistic: Total       :253       Used        :1                                                                          
                     Idle        :252       Expired     :0                                                                          
                     Conflict    :0         Disabled    :0 
                                                                        

 -------------------------------------------------------------------------------------                                              
  Network section                                                                                                                   
         Start           End       Total    Used Idle(Expired) Conflict Disabled                                                    
 -------------------------------------------------------------------------------------                                              
        10.1.1.1      10.1.1.254     253       1        252(0)       0     0                                                        
 ------------------------------------------------------------------------------------- </pre>
<pre class="screen">[<font style="font-size:8pt" Face="Courier New" >~</font>DeviceA] <strong>display ip pool name pool2</strong>

  Pool-name        : pool2                                                                                                          
  Pool-No          : 8                                                                                                              
  Lease            : 2 Days 0 Hours 0 Minutes                                                                                       
  Domain-name      : huawei.com                                                                                                     
  DNS-server0      : 10.1.3.1                                                                                                       
  NBNS-server0     : -                                                                                                              
  Netbios-type     : -                                                                                                              
  Position         : Local                                                                                                          
  Status           : Unlocked                                                                                                       
  Gateway-0        : 10.1.2.1                                                                                                       
  Network          : 10.1.2.0                                                                                                       
  Mask             : 255.255.255.0                                                                                                  
  VPN instance     : --                                                                                                             
  Logging          : Disable                                                                                                        
  Conflicted address recycle interval: -                                                                                            
  Address Statistic: Total       :253       Used        :0                                                                          
                     Idle        :253       Expired     :0                                                                          
                     Conflict    :0         Disabled    :0
                                                                            

 -------------------------------------------------------------------------------------                                              
  Network section                                                                                                                   
         Start           End       Total    Used Idle(Expired) Conflict Disabled                                                    
 -------------------------------------------------------------------------------------                                              
        10.1.2.1      10.1.2.254     253       0        253(0)       0     0                                                        
 -------------------------------------------------------------------------------------</pre>
<p># Check IPv4 address information on Client_1. You can check that Client_1 has obtained the IPv4 address 10.1.1.100/24.</p>
<p># Check IPv4 address information on other DHCPv4 clients. You can check that the clients have obtained IPv4 addresses.</p>
<h4 class="sectiontitle">Configuration Scripts</h4><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
dhcp enable
#
ip pool pool1
 gateway-list 10.1.1.1 
 network 10.1.1.0 mask 255.255.255.0 
 static-bind ip-address 10.1.1.100 mac-address 00e0-fc12-3456 
 lease day 30 hour 0 minute 0 
 dns-list 10.1.3.1 
 domain-name huawei.com
# 
ip pool pool2
 gateway-list 10.1.2.1 
 network 10.1.2.0 mask 255.255.255.0 
 lease day 2 hour 0 minute 0 
 dns-list 10.1.3.1 
 domain-name huawei.com
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.1.1.1 255.255.255.0
 dhcp select global
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.1.2.1 255.255.255.0
 dhcp select global
#
return</pre>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_dhcpv4_cfg_0012.html">Configuring a Device to Function as a DHCPv4 Server
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_dhcpv4_cfg_0017.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_dhcpv4_cfg_0020.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>