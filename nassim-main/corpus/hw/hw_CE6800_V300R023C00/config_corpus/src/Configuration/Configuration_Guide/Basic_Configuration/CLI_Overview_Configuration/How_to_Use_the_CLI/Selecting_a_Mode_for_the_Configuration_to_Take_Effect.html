
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Selecting a Mode for the Configuration to Take Effect">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_cli_cfg_0002.html">
<meta name="DC.Relation" scheme="URI" content="vrp_cli_cfg_0003.html">
<meta name="DC.Relation" scheme="URI" content="vrp_cli_cfg_0004.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="CLI Overview">
<meta name="featuretype" content="Basic Configuration">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="CLI Overview">
<meta name="featuretype" content="Basic Configuration">
<meta name="featurename" content="CLI Overview">
<meta name="featuretype" content="Basic Configuration">
<meta name="featuretype" content="Basic Configuration">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001512691338">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Selecting a Mode for the Configuration to Take Effect</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CONCEPT_0000001512691338"></a><a name="EN-US_CONCEPT_0000001512691338"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Selecting a Mode for the Configuration to Take Effect</h1>
<div><p>To ensure the reliability of user configurations, the system allows configurations to take effect immediately or after two stages. The two-stage mode is used by default.</p>
<p>Before configuring a service, enter the system view. After the system view is displayed, the system initiates the corresponding configuration process based on the configured mode.</p>
<ul><li><p>The immediate mode is the traditional mode.</p>
<p>In immediate mode, after you enter a command line and press <strong>Enter</strong>, the system performs a syntax check. The configuration takes effect as soon as it passes the syntax check.</p>
</li><li><p>The two-stage mode divides the system configuration process into two stages.</p>
<ul><li><p>In the first stage, a user enters command lines and the system performs syntax and semantics checks in the candidate database. If syntax or semantics errors are found in the command lines, the system displays a message on the terminal to inform the user of the error and the cause.</p>
</li><li><p>In the second stage, the user commits the configuration, and the system enters the configuration commitment stage. The system delivers configurations in the candidate database to a service. If these service configurations take effect, the system adds them to the running database of the current system. During the configuration commitment stage, the system checks the validity of configurations and displays a message when the same configurations exist in the candidate database and running database.</p>
</li></ul>
</li></ul>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="hsides" border="1" rules="all"><caption><b>Table 1 </b>Advantages and disadvantages of the immediate mode and two-stage mode</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.4.2.4.1.1" liSelected="liSelected"><p>Mode</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.4.2.4.1.2" liSelected="liSelected"><p>Advantage</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.4.2.4.1.3" liSelected="liSelected"><p>Disadvantage</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.4.2.4.1.1 "><p>Immediate mode</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.4.2.4.1.2 "><p>The system can immediately detect configuration impacts on services.</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.4.2.4.1.3 "><p>Any configuration errors will immediately impact services. In addition, you cannot delete service configurations all at once, and must delete commands individually.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.4.2.4.1.1 "><p>Two-stage mode</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.4.2.4.1.2 "><ul><li>All committed configurations take effect at the same time.</li><li>Users can preview configurations in the candidate database.</li><li>A configuration that does not take effect can be deleted immediately if an error occurs, or in cases of unexpected results.</li><li>The impacts of configurations on existing services are minimized.</li></ul>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.4.2.4.1.3 "><p>Configurations take effect only after the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command is run.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="p">In two-stage mode, you must run the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command for configurations to take effect, except in the following cases:<ul><li>Query commands (such as <a href="cmdqueryname=display+interface"><b><span class="cmdname">display interface</span></b></a>) are run.</li><li>Maintenance commands (such as <a href="cmdqueryname=reset+saved-configuration"><b><span class="cmdname">reset saved-configuration</span></b></a> and <a href="cmdqueryname=reset+keepalive+packets+count"><b><span class="cmdname">reset keepalive packets count</span></b></a>) are run.</li><li>Commands such as <a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <strong><span>100GE</span></strong><strong><span>1/0/1</span></strong> are run to enter the existing views (such as the physical interface view) on a physical device.</li><li>Commands are run without changing the existing configurations.</li></ul>
</div>
<div class="section"><h4 class="sectiontitle">Immediate Mode</h4><div class="p">Enable the immediate mode.<pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a> <strong><span>immediately</span></strong></pre>
</div>
<p>In immediate mode, the command line prompt is as follows:</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view immediately</strong>
Enter system view, return user view with return command.
[<span class="keyword">HUAWEI</span>]</pre>
</div>
<div class="section"><h4 class="sectiontitle">Two-Stage Mode</h4><ol><li>Enable the two-stage mode.<pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</li><li>(Optional) Display all uncommitted configurations.<pre class="screen"><a href="cmdqueryname=display+configuration+candidate"><b><span class="cmdname">display configuration candidate</span></b></a> [ <strong><span>merge</span></strong> | <strong><span>changes</span></strong> ]</pre>
<p>If you do not specify the <strong><span>merge</span></strong> and <strong><span>changes</span></strong> keywords, the command displays uncommitted configurations only. If you specify the <strong><span>merge</span></strong> keyword, the command displays both uncommitted and committed configurations. The <strong><span>changes</span></strong> keyword is specified to display the differences between the uncommitted configurations and current running configurations.</p>
<p>You can edit uncommitted configurations.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the system displays a message indicating that the current running configurations are changed when you run the <a href="cmdqueryname=display+configuration+candidate"><b><span class="cmdname">display configuration candidate</span></b></a> <strong><span>changes</span></strong> command, run the <a href="cmdqueryname=refresh+configuration+candidate"><b><span class="cmdname">refresh configuration candidate</span></b></a> command to resolve the configuration conflict so that you can continue to view the configuration differences.</p>
</div></div>
</li><li>(Optional) Delete all uncommitted configurations.<pre class="screen"><a href="cmdqueryname=clear+configuration+candidate"><b><span class="cmdname">clear configuration candidate</span></b></a></pre>
</li><li>(Optional) Enable a trial run of system configurations.<pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> <strong><span>trial</span></strong> [ <i><span class="varname">time</span></i> ] [ <strong><span>persist</span></strong> <i><span class="varname">persistId</span></i> ]</pre>
<p>This command enables a trial run of new functions and services without interrupting those running on the live network, which improves network reliability. When the trial running period elapses, the configurations in trial running state are automatically rolled back. If the <strong><span>persist</span></strong> parameter is not specified, the configuration trial run takes effect only in the current session. If the <strong><span>persist</span></strong> parameter is specified, the configuration trial run does not stop when the session ends.</p>
<p>To disable the trial run of configurations before the trial run times out, run the <a href="cmdqueryname=abort+trial"><b><span class="cmdname">abort trial</span></b></a> command to roll the system configurations back to those used before the trial run. To view the trial run status of system configurations, run the <a href="cmdqueryname=display+configuration+trial+status"><b><span class="cmdname">display configuration trial status</span></b></a> command.</p>
</li><li>Commit configurations.<pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> [ <strong><span>persist</span></strong> <i><span class="varname">persistId</span></i> ]</pre>
<p>Before the persistent trial run is rolled back due to timeout, you can specify the <strong>persist</strong> keyword in any session to commit the configurations in trial run.</p>
</li></ol>
<p>In two-stage mode, if the user modifies but not commits configurations, the system prompt <strong><span class="keyword">~</span></strong> is changed to <strong><span class="keyword">*</span></strong>, notifying the user that the configurations are not committed. After the user runs the <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a> command to commit the configurations, the system prompt <strong><span class="keyword">*</span></strong> is restored to <strong><span class="keyword">~</span></strong>.</p>
<p>For example:</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; system-view
Enter system view, return user view with return command.
[<strong><span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span></strong><span class="keyword">HUAWEI</span>] sysname HUAWEIA
[<strong><span class="keyword">*</span></strong><span class="keyword">HUAWEI</span>] commit
[<strong><span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span></strong><span class="keyword">HUAWEI</span>A]</pre>
</div>
<div class="section"><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><p>In both the immediate and two-stage modes, the system can lock the configuration of a service as soon as the service process starts, in order to prevent a service from being affected. In this situation, users can query configurations but cannot edit or commit them. If configurations fail to be committed, you are advised to wait for 30 seconds before retrying. If configurations still fail to be committed, the configurations are locked by a user.</p>
</li><li><p>You can run the <a href="cmdqueryname=configuration+exclusive"><b><span class="cmdname">configuration exclusive</span></b></a> command to lock a configuration. If a configuration is locked by another user, you will need to ask the user to unlock it.</p>
</li><li>In two-stage mode, when multiple users perform the same configuration, only the first committed configuration takes effect. Other users will receive a configuration conflict prompt.</li></ul>
</div></div>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_cli_cfg_0002.html">How to Use the CLI
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_cli_cfg_0003.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_cli_cfg_0004.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>