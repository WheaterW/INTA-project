
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring BGP4+ GTSM">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp6_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp6_cfg_0169.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp6_cfg_0099.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP4+">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP4+">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176661973">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring BGP4+ GTSM</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176661973"></a><a name="EN-US_TASK_0000001176661973"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring BGP4+ GTSM</h1>
<div class="taskbody"><div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001176661973__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before configuring BGP4+ Generalized TTL Security Mechanism (GTSM), you have completed the following task:</p>
<ul><li><p><a href="vrp_bgp6_cfg_0006.html">Configure basic BGP4+ functions</a>.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176661973__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Attackers may simulate BGP4+ messages and continuously send them to a BGP4+ device. The device then sends these messages directly to the control plane for processing, without validating them, if they are destined for the device. This causes high CPU usage due to the increased workload in processing the messages on the control plane.</p>
<p>GTSM protects a BGP4+ device by checking whether the time to live (TTL) value in each IP packet header is within a pre-defined range to enhance system security.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>GTSM supports only unicast addresses. Therefore, GTSM must be configured on all the devices that run routing protocols.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176661973__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the BGP view.</span><p><pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></pre>
</p></li><li><span>Configure BGP4+ GTSM.</span><p><pre class="screen"><a href="cmdqueryname=peer+valid-ttl-hops"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">group-name</span></i> | <i><span class="varname">ipv6-address</span></i> } <strong><span>valid-ttl-hops</span></strong> [ <i><span class="varname">hops</span></i> ]</pre>
<p>The valid TTL range of detected messages is [255 â <i><span class="varname">hops</span></i> + 1, 255]. For example, the value of <i><span class="varname">hops</span></i> is 1 for an EBGP direct route, and the valid TTL value is 255. <span>By default, the value of <i><span class="varname">hops</span></i> is 255, and the valid TTL range is [1, 255].</span></p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>After GTSM is configured in the BGP view, the configuration also takes effect in the MP-BGP address family view because BGP and MP-BGP use the same TCP connection.</li><li>GTSM and EBGP-max-hop are mutually exclusive because they both affect the TTL values in sent BGP4+ messages. Therefore, only one of them can be used for a peer or peer group.</li></ul>
</div></div>
<p>A BGP4+ device that is enabled with GTSM checks the TTL values in all BGP4+ messages and discards the messages whose TTL values are not within the specified range. In scenarios where GTSM is not configured on a BGP4+ device, the received BGP4+ messages are forwarded if the BGP4+ peer configuration exists. Otherwise, the received BGP4+ messages are discarded. This prevents bogus BGP4+ messages from consuming CPU resources.</p>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001176661973__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001176661973__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001176661973__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After the configuration is complete, verify the configuration.</p>
<ul><li><p>Run the <a href="cmdqueryname=display+gtsm+statistics"><b><span class="cmdname">display gtsm statistics</span></b></a> <span>{ <i><span class="varname">slot-id</span></i> | </span><strong><span>all</span></strong><span> }</span> command to check GTSM statistics.</p>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_bgp6_cfg_0001.html">BGP4+ Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_bgp6_cfg_0169.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_bgp6_cfg_0099.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>