
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring OSPFv3 Neighbor Relationship Flapping Suppression">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospfv3_cfg_0063.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospfv3_cfg_0064.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospfv3_cfg_0066.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130783062">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Configuring OSPFv3 Neighbor Relationship Flapping Suppression</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130783062"></a><a name="EN-US_TASK_0000001130783062"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring OSPFv3 Neighbor Relationship Flapping Suppression</h1>
<div class="taskbody"><div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001130783062__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before configuring OSPFv3 neighbor relationship flapping suppression, you have completed the following task:</p>
<ul><li><p><a href="vrp_ospfv3_cfg_0009.html">Configure basic OSPFv3 functions</a>.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130783062__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>If an interface carrying OSPFv3 services frequently alternates between up and down, OSPFv3 neighbor relationship flapping will occur on the interface. In this case, OSPFv3 frequently sends Hello packets to re-establish neighbor relationships, synchronizes LSDBs, and recalculates routes. As a result, a large number of packets are exchanged, compromising the stability of existing neighbor relationships, OSPFv3 services, and other OSPFv3-dependent services. To overcome this problem, OSPFv3 neighbor relationship flapping suppression can delay the OSPFv3 neighbor relationship from being re-established or prevent service traffic from passing through flapping links.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130783062__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>(Optional) Disable OSPFv3 neighbor relationship flapping suppression globally.</span><p><pre class="screen"><a href="cmdqueryname=ospfv3"><b><span class="cmdname">ospfv3</span></b></a> [ <i><span class="varname">process-id</span></i> ]
<a href="cmdqueryname=suppress-flapping+peer+disable+%28OSPFv3+view%29"><b><span class="cmdname">suppress-flapping peer disable</span></b></a>
<a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
<p>By default, OSPFv3 neighbor relationship flapping suppression is enabled globally. This function is enabled on each interface in the current OSPFv3 process. To disable this function globally, perform this step.</p>
</p></li><li><span>Enter the interface view.</span><p><pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></pre>
</p></li><li><span>Switch the interface working mode to Layer 3.</span><p><pre class="screen"><a href="cmdqueryname=undo+portswitch"><b><span class="cmdname">undo portswitch</span></b></a></pre>
<p></p>
<p>Determine whether to perform this step based on the current interface working mode.</p>
</p></li><li><span>Enable the Hold-down mode and set a corresponding duration.</span><p><pre class="screen"><a href="cmdqueryname=ospfv3+suppress-flapping+peer+hold-down"><b><span class="cmdname">ospfv3 suppress-flapping peer hold-down</span></b></a> <i><span class="varname">interval</span></i> [ <strong><span>instance</span></strong> <i><span class="varname">instance-id</span></i> ]</pre>
<p>Flapping suppression is classified as Hold-down mode or Hold-max-cost mode:</p>
<ul><li>Hold-down mode: In the case of frequent flooding and topology changes during neighbor relationship establishment, interfaces prevent neighbor relationship re-establishment during Hold-down suppression, which minimizes LSDB synchronization attempts and packet exchanges.</li><li>Hold-max-cost mode: If the traffic forwarding path changes frequently, interfaces use 65535 (maximum value) as the cost of the flapping link during Hold-max-cost suppression, which prevents traffic from passing through the flapping link.<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>You can run the <a href="cmdqueryname=maximum-link-cost%28ospfv3%29"><b><span class="cmdname">maximum-link-cost</span></b></a> <i><span class="varname">cost</span></i> command in the OSPFv3 view to change the maximum cost for OSPFv3 links.</p>
</div></div>
</li></ul>
<p>By default, the Hold-max-cost mode takes effect. If both modes are enabled, flapping suppression initially works in Hold-down mode (until its duration expires) and then in Hold-max-cost mode.</p>
</p></li><li><span>(Optional) Disable the Hold-max-cost mode.</span><p><pre class="screen"><a href="cmdqueryname=ospfv3+suppress-flapping+peer+hold-max-cost+disable"><b><span class="cmdname">ospfv3 suppress-flapping peer hold-max-cost disable</span></b></a> [ <strong><span>instance</span></strong> <i><span class="varname">instance-id</span></i> ]</pre>
</p></li><li><span>(Optional) Configure detection parameters for OSPFv3 neighbor relationship flapping suppression.</span><p><pre class="screen"><a href="cmdqueryname=ospfv3+suppress-flapping+peer"><b><span class="cmdname">ospfv3 suppress-flapping peer</span></b></a> { <strong><span>detecting-interval</span></strong> <i><span class="varname">detecting-interval</span></i> | <strong><span>threshold</span></strong> <i><span class="varname">threshold</span></i> | <strong><span>resume-interval</span></strong> <i><span class="varname">resume-interval</span></i> } <sup>*</sup> [ <strong><span>instance</span></strong> <i><span class="varname">instance-id</span></i> ]</pre>
<p>An OSPFv3 interface with neighbor relationship flapping suppression enabled starts a flapping counter. If the interval between two successive neighbor relationship states (changing from Full to a non-Full state) is shorter than the <strong>detecting-interval</strong>, a valid flapping_event is recorded, and the flapping_count is incremented by 1. When the flapping_count reaches or exceeds the <strong>threshold</strong>, flapping suppression takes effect. If the interval between two successive neighbor relationship states (changing from Full to a non-Full state) is longer than the <strong>resume-interval</strong>, the flapping_count is reset.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The value of <i><span class="varname">resume-interval</span></i> must be greater than that of <i><span class="varname">detecting-interval</span></i>.</p>
</div></div>
<p>You can configure detection parameters for OSPFv3 neighbor relationship flapping suppression on specific interfaces according to network conditions. However, using the default values of these parameters is recommended. By default, the detection interval for OSPFv3 neighbor relationship flapping suppression is 60 seconds, the suppression threshold is 10, and the interval for exiting flapping suppression is 120 seconds.</p>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001130783062__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001130783062__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li><li><span>(Optional) Configure the specified OSPFv3 interface to exit neighbor relationship flapping suppression.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a>
<a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a>
<a href="cmdqueryname=reset+ospfv3"><b><span class="cmdname">reset ospfv3</span></b></a> <i><span class="varname">process-id</span></i> <strong><span>suppress-flapping peer</span></strong> [ <i><span class="varname">interface-type interface-number</span></i> ] [ <strong><span>notify-peer</span></strong> ]</pre>
</p><p><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><div class="p">Interfaces exit flapping suppression in the following scenarios:<ul><li>The suppression timer expires.</li><li>The corresponding OSPFv3 process is reset.</li><li>An OSPFv3 neighbor relationship is reset using the <a href="cmdqueryname=reset+ospfv3+peer"><b><span class="cmdname">reset ospfv3 peer</span></b></a> command.</li><li>OSPFv3 neighbor relationship flapping suppression is disabled globally using the <a href="cmdqueryname=suppress-flapping+peer+disable"><b><span class="cmdname">suppress-flapping peer disable</span></b></a> command in the OSPFv3 view.</li></ul>
</div>
</div></div>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0000001130783062__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+ospfv3"><b><span class="cmdname">display ospfv3</span></b></a> [ <i><span class="varname">process-id</span></i> ] <strong><span>interface</span></strong> [ <span><strong><span>no-peer</span></strong> | </span><strong><span>area</span></strong> <i><span class="varname">area-id</span></i> ] [ <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> ] command to check the status of OSPFv3 neighbor relationship flapping suppression.</p>
<p><strong>Suppress flapping peer</strong> in the command output indicates the current suppression mode (Hold-down), when flapping suppression started, and the remaining time before flapping suppression exits.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_ospfv3_cfg_0063.html">Configuring OSPFv3 Neighbor Relationship Flapping Suppression
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_ospfv3_cfg_0064.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../vrp/vrp_ospfv3_cfg_0066.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>