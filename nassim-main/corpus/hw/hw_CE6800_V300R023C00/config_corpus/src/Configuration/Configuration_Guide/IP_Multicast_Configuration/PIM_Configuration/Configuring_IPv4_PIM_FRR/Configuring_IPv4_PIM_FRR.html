
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring IPv4 PIM FRR">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_pim_cfg_0073.html">
<meta name="DC.Relation" scheme="URI" content="vrp_pim_cfg_0074.html">
<meta name="DC.Relation" scheme="URI" content="vrp_pim_cfg_0075.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="PIM">
<meta name="featuretype" content="IP Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130623816">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring IPv4 PIM FRR</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130623816"></a><a name="EN-US_TASK_0000001130623816"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring IPv4 PIM FRR</h1>
<div class="taskbody"><div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001130623816__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before configuring IPv4 PIM FRR, you have completed the following tasks:</p>
<ul><li>Configure a unicast routing protocol to ensure that devices are reachable through IP routes.</li><li>Configure unicast IGP FRR.</li><li>Configure basic PIM-SM functions.</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130623816__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Generally, when a multicast link is faulty, multicast traffic convergence depends on unicast route convergence, which is time-consuming. This is unacceptable for multicast networks with high requirements on real-time transmission. To solve this problem, you can configure IPv4 PIM FRR. After FRR is configured, PIM sets up primary and backup MDTs based on unicast backup FRR routes, allowing multicast traffic to be transmitted through both the primary and backup links. The forwarding plane of the device with primary and backup routes accepts multicast traffic from the primary link and discards traffic from the backup link. If the primary link fails, the forwarding plane accepts multicast traffic from the backup link immediately, which accelerates multicast traffic convergence.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>IPv4 PIM FRR can be configured only in IPv4 multicast scenarios. </p>
<p>This function is only supported by the following: <span>CE6866, CE6860-SAN, CE6866K, CE6860-HAM, CE8851-32CQ8DQ-P, CE8850-SAN, CE8851K, CE8850-HAM</span>, <span>CE8855, CE8851-32CQ4BQ, CE6855-48XS8CQ, CE6885, CE6885-SAN, CE6885-LL, CE6885-T, CE6863E-48S8CQ</span>.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130623816__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the PIM view.</span><p><pre class="screen"><strong><a href="cmdqueryname=pim"><b><span class="cmdname">pim</span></b></a></strong> [ <strong><strong><span>vpn-instance</span></strong></strong> <em><i><span class="varname">vpn-instance-name</span></i></em> ]</pre>
</p></li><li><span>Enable IPv4 PIM FRR.</span><p><pre class="screen"><strong><a href="cmdqueryname=rpf-frr"><b><span class="cmdname">rpf-frr</span></b></a></strong> [ <strong><strong><span>policy</span></strong></strong> { <em><i><span class="varname">acl-number</span></i></em> | <strong><strong><span>acl-name</span></strong></strong> <em><i><span class="varname">acl-name</span></i></em> } ]</pre>
</p></li><li><span>(Optional) Set a delay in sending Prune messages upstream.</span><p><pre class="screen"><strong><a href="cmdqueryname=rpf-prune-delay"><b><span class="cmdname">rpf-prune-delay</span></b></a></strong> <em><i><span class="varname">delay-time</span></i></em> [ <strong><strong><span>policy</span></strong></strong> { <em><i><span class="varname">acl-number</span></i></em> | <strong><a href="cmdqueryname=acl-name"><b><span class="cmdname">acl-name</span></b></a></strong> <em><i><span class="varname">acl-name</span></i></em> } ]</pre>
</p></li><li><span>(Optional) Set a delay in generating forwarding entries on interfaces connected to backup upstream devices.</span><p><pre class="screen"><strong><a href="cmdqueryname=backup-rpf-switchover-delay"><b><span class="cmdname">backup-rpf-switchover-delay</span></b></a></strong> <strong><strong><span>interval</span></strong></strong> <em><i><span class="varname">hold-time</span></i></em> [ <strong><strong><span>policy</span></strong></strong> { <em><i><span class="varname">acl-number</span></i></em> | <strong><strong><span>acl-name</span></strong></strong> <em><i><span class="varname">acl-name</span></i></em> } ]</pre>
</p></li><li><span>(Optional) Set the maximum delay in delivering forwarding entries on a new link after a switchback in PIM-SM or PIM-SSM mode.</span><p><pre class="screen"><a href="cmdqueryname=rpf-switch-delay+max-time"><b><span class="cmdname">rpf-switch-delay</span></b></a> <strong><span>mode</span></strong> { <strong><span>sm</span></strong> | <strong><span>ssm</span></strong> } <strong><span>max-time</span></strong> { <i><span class="varname">smTimeValue</span></i> | <i><span class="varname">ssmTimeValue</span></i> }</pre>
<p>By default, the maximum delays in delivering forwarding entries on a new link after a switchback in PIM-SM and PIM-SSM modes are 350s and 150s, respectively.</p>
</p></li><li><span>(Optional) Set the WTR time for multicast forwarding entries.</span><p><ol type="a"><li>Return to the system view.<pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</li><li>Set the WTR time for multicast forwarding entries.<pre class="screen"><a href="cmdqueryname=multicast+rpf-frr+fib-wtr"><b><span class="cmdname">multicast rpf-frr fib-wtr</span></b></a> <i><span class="varname">wtr-time</span></i></pre>
<p>By default, the WTR time for multicast forwarding entries is 10s.</p>
</li></ol>
</p></li><li><span>(Optional) Configure a PIM ECMP priority.</span><p><ol type="a"><li>Return to the system view.<pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</li><li>Enter the interface view.<pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></pre>
</li><li>Switch the interface working mode from Layer 2 to Layer 3.<pre class="screen"><a href="cmdqueryname=undo+portswitch"><b><span class="cmdname">undo portswitch</span></b></a></pre>
</li><li>Set a PIM ECMP priority for the interface.<pre class="screen"><a href="cmdqueryname=pim+ecmp-priority"><b><span class="cmdname">pim ecmp-priority</span></b></a> <i><span class="varname">priorityValue</span></i></pre>
<p>The PIM ECMP priority takes effect only after it is configured on both the primary and backup inbound interfaces.</p>
</li></ol>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001130623816__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ul><li>Run the <a href="cmdqueryname=display+multicast+routing-table"><b><span class="cmdname">display multicast routing-table</span></b></a> or <a href="cmdqueryname=display+multicast+vpn-instance+routing-table"><b><span class="cmdname">display multicast vpn-instance routing-table</span></b></a> command to check the IP multicast routing table.</li><li>Run the <a href="cmdqueryname=display+pim+routing-table"><b><span class="cmdname">display pim routing-table</span></b></a> command to check the PIM routing table.</li><li>Run the <a href="cmdqueryname=display+pim+join-prune"><b><span class="cmdname">display pim join-prune</span></b></a> command to check information about Join/Prune messages sent upstream by the device.</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_pim_cfg_0073.html">Configuring IPv4 PIM FRR
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_pim_cfg_0074.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_pim_cfg_0075.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>