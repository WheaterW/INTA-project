
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring an Advanced ACL6">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_acl6_cfg_0010.html">
<meta name="DC.Relation" scheme="URI" content="vrp_acl6_cfg_0011.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="ACL6">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ACL6">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="ACL6">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176741121">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring an Advanced ACL6</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176741121"></a><a name="EN-US_TASK_0000001176741121"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring an Advanced ACL6</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176741121__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Advanced ACL6s give more flexibility and functionality than basic ACL6s, allowing you to filter packets more accurately. For example, with advanced ACL6s, you can define packet filtering rules based on information such as source and destination IPv6 addresses, IP protocol types, TCP source and destination port numbers, UDP source and destination port numbers, fragment information, and time ranges.</p>
<div class="p"><strong id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_b10169155262">When ACL6 rules are configured:</strong><ul id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_en-us_concept_0177090555_ul1191338372183158"><li id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_en-us_concept_0177090555_li822401570183158"><p id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_en-us_concept_0177090555_p898434898183158"><a name="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_en-us_concept_0177090555_li822401570183158"></a><a name="en-us_task_0000001176661207_en-us_concept_0177090555_li822401570183158"></a>If the specified rule ID already exists and the new rule conflicts with the original, the original is replaced.</p>
</li><li id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_en-us_concept_0177090555_li504316878183158"><p id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_en-us_concept_0177090555_p2083297484183158"><a name="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_en-us_concept_0177090555_li504316878183158"></a><a name="en-us_task_0000001176661207_en-us_concept_0177090555_li504316878183158"></a>Matching stops for a packet once the packet matches a rule in an ACL6.</p>
</li><li id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_li1538122512195">Many services that are not configured with ACL6 rules also occupy ACL6 resources. You can run the <a href="cmdqueryname=display+system+tcam+service+brief"><b><span class="cmdname" id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_cmdname4391122852016">display system tcam service brief</span></b></a> command to check ACL6 resources occupied by services.</li></ul>
</div>
<p><strong id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_b178943810715">When ACL6 rules are deleted:</strong> The <a href="cmdqueryname=undo+rule"><b><span class="cmdname" id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_en-us_concept_0177090555_cmdname1539083973183158">undo rule</span></b></a> command can delete an ACL rule even if this rule is referenced. Before deleting a rule, run the <a href="cmdqueryname=display+current-configuration+%7C+include+acl"><b><span class="cmdname" id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_cmdname6906162174518">display current-configuration | include acl</span></b></a> command to check whether the rule is being referenced.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176741121__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Create an advanced ACL6. You can create a numbered or named advanced ACL6.</span><p><ul><li><div class="p">Create a numbered advanced ACL6 and enter its view.<pre class="screen"><a href="cmdqueryname=acl+ipv6+number"><b><span class="cmdname">acl ipv6</span></b></a> [ <strong><span>number</span></strong> ] <i><span class="varname">advance-acl6-number</span></i> </pre>
</div>
<p>The number of an advanced ACL6 ranges from 3000 to 3999.</p>
</li><li><p>Create a named advanced ACL6 and enter its view.</p>
<pre class="screen"><a href="cmdqueryname=acl+ipv6+name+advance"><b><span class="cmdname">acl ipv6 name</span></b></a> <i><span class="varname">advance-acl6-name</span></i> [ <strong><span>advance</span></strong> ]</pre>
</li></ul>
</p></li><li><span>(Optional) Configure an ACL6 step.</span><p><pre class="screen" id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_screen148201438191713"><a href="cmdqueryname=step"><b><span class="cmdname" id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_cmdname430815436176">step</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_varname7a89e9ce6252a026e863182255845f98">step-value</span></i></pre>
</p><p><p id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_p1373340508183306">The default ACL6 step is 5. Change the step value as required.</p>
</p></li><li><span>(Optional) Configure a description for the basic ACL6.</span><p><pre class="screen" id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_screen1670613531740"><a href="cmdqueryname=description"><b><span class="cmdname" id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_cmdname664116591417">description</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_varname126411059742">text</span></i></pre>
<p id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_p48583136183305">The ACL6 description helps you understand and remember the functions or purpose of the ACL6.</p>
</p></li><li><span>Configure a rule for the advanced ACL6. Run the following commands based on the protocol type:</span><p><ul><li><p>When <i><span class="varname">protocol</span></i> is specified as UDP, run:</p>
<pre class="screen"><a href="cmdqueryname=rule+name+permit+deny+udp+destination+any+destination-port+range"><b><span class="cmdname">rule </span></b></a>[ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } { <strong><span>udp</span></strong> | <i><span class="varname">17</span></i> } [ <strong><span>destination</span></strong> { <i><span class="varname">destination-ipv6-address</span></i> { <i><span class="varname">prefix-length</span></i> | <i><span class="varname">destination-wildcard</span></i> } | <i><span class="varname">dest-ipv6-addr-prefix</span></i> | <strong><span>any</span></strong> } | <strong><span>destination-port</span></strong> { <strong><span>range</span></strong> { <i><span class="varname">port</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } { <i><span class="varname">port</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } | { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> } { <i><span class="varname">port</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } } | <strong><span>fragment</span></strong> | <strong><span>source</span></strong> { <i><span class="varname">source-ipv6-address</span></i> { <i><span class="varname">prefix-length</span></i> | <i><span class="varname">source-wildcard</span></i> } | <i><span class="varname">src-ipv6-addr-prefix</span></i> | <strong><span>any</span></strong> } | <strong><span>source-port</span></strong> { <strong><span>range</span></strong> { <i><span class="varname">port</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } { <i><span class="varname">port</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } | { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> } { <i><span class="varname">port</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | [ <strong><span>dscp</span></strong> <i><span class="varname">dscp</span></i> ] | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>logging</span></strong> ] <sup>*</sup></pre>
</li><li><p>When <i><span class="varname">protocol</span></i> is specified as TCP, run:</p>
<pre class="screen"><a href="cmdqueryname=rule+name+permit+deny+tcp+destination+any+destination-port+range"><b><span class="cmdname">rule </span></b></a>[ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } { <strong><span>tcp</span></strong> | <i><span class="varname">6</span></i> } [ <strong><span>destination</span></strong> { <i><span class="varname">destination-ipv6-address</span></i> { <i><span class="varname">prefix-length</span></i> | <i><span class="varname">destination-wildcard</span></i> } | <i><span class="varname">dest-ipv6-addr-prefix</span></i> | <strong><span>any</span></strong> } | <strong><span>destination-port</span></strong> { <strong><span>range</span></strong> { <i><span class="varname">port</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } { <i><span class="varname">port</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } | { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> } { <i><span class="varname">port</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } } | <strong><span>fragment</span></strong> | <strong><span>source</span></strong> { <i><span class="varname">source-ipv6-address</span></i> { <i><span class="varname">prefix-length</span></i> | <i><span class="varname">source-wildcard</span></i> } | <i><span class="varname">src-ipv6-addr-prefix</span></i> | <strong><span>any</span></strong> } | <strong><span>source-port</span></strong> { <strong><span>range</span></strong> { <i><span class="varname">port</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } { <i><span class="varname">port</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } | { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> } { <i><span class="varname">port</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | [ <strong><span>dscp</span></strong> <i><span class="varname">dscp</span></i> ] | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>logging</span></strong> | <strong><span>tcp-flag</span></strong> { <i><span class="varname">tcp-flag</span></i> [ <strong><span>mask</span></strong> <i><span class="varname">mask-value</span></i> ] | <strong><span>established</span></strong> | { <strong><span>ack</span></strong> [ <strong><span>fin</span></strong> | <strong><span>psh</span></strong> | <strong><span>rst</span></strong> | <strong><span>syn</span></strong> | <strong><span>urg</span></strong> ] <sup>*</sup> } | { <strong><span>fin</span></strong> [ <strong><span>ack</span></strong> | <strong><span>psh</span></strong> | <strong><span>rst</span></strong> | <strong><span>syn</span></strong> | <strong><span>urg</span></strong> ] <sup>*</sup> } | { <strong><span>psh</span></strong> [ <strong><span>fin</span></strong> | <strong><span>ack</span></strong> | <strong><span>rst</span></strong> | <strong><span>syn</span></strong> | <strong><span>urg</span></strong> ] <sup>*</sup> } | { <strong><span>rst</span></strong> [ <strong><span>fin</span></strong> | <strong><span>psh</span></strong> | <strong><span>ack</span></strong> | <strong><span>syn</span></strong> | <strong><span>urg</span></strong> ] <sup>*</sup> } | { <strong><span>syn</span></strong> [ <strong><span>fin</span></strong> | <strong><span>psh</span></strong> | <strong><span>rst</span></strong> | <strong><span>ack</span></strong> | <strong><span>urg</span></strong> ] <sup>*</sup> } | { <strong><span>urg</span></strong> [ <strong><span>fin</span></strong> | <strong><span>psh</span></strong> | <strong><span>rst</span></strong> | <strong><span>syn</span></strong> | <strong><span>ack</span></strong> ] <sup>*</sup> } } ] <sup>*</sup></pre>
</li><li><p>When <i><span class="varname">protocol</span></i> is specified as ICMPv6, run:</p>
<pre class="screen"><a href="cmdqueryname=rule+name+permit+deny+icmpv6+destination+any+fragment+icmp6-type"><b><span class="cmdname">rule </span></b></a>[ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } { <strong><span>icmpv6</span></strong> | <i><span class="varname">58</span></i> } [ <strong><span>destination</span></strong> { <i><span class="varname">destination-ipv6-address</span></i> { <i><span class="varname">prefix-length</span></i> | <i><span class="varname">destination-wildcard</span></i> } | <i><span class="varname">dest-ipv6-addr-prefix</span></i> | <strong><span>any</span></strong> } | <strong><span>fragment</span></strong> | <strong><span>icmp6-type</span></strong> { <i><span class="varname">icmp6-type-name</span></i> | <i><span class="varname">icmp6-type</span></i> [ <i><span class="varname">icmp6-code</span></i> ] } | <strong><span>source</span></strong> { <i><span class="varname">source-ipv6-address</span></i> { <i><span class="varname">prefix-length</span></i> | <i><span class="varname">source-wildcard</span></i> } | <i><span class="varname">src-ipv6-addr-prefix</span></i> | <strong><span>any</span></strong> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | [ <strong><span>dscp</span></strong> <i><span class="varname">dscp</span></i> ] | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>logging</span></strong> ] <sup>*</sup></pre>
</li><li><p>When <i><span class="varname">protocol</span></i> is specified as any other protocol except the preceding well-known protocols, run:</p>
<pre class="screen"><a href="cmdqueryname=rule+name+permit+deny+hoport+gre+ipv6+ipv6-ah+ipv6-esp+ospf"><b><span class="cmdname">rule </span></b></a>[ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } { <strong><span>hoport</span></strong> | <i><span class="varname">protocol</span></i> | <strong><span>gre</span></strong> | <strong><span>ipv6</span></strong> | <strong><span>ipv6-ah</span></strong> | <strong><span>ipv6-esp</span></strong> | <strong><span>ospf</span></strong> | <i><span class="varname">7-16</span></i> | <i><span class="varname">18-57</span></i> | <i><span class="varname">59-255</span></i> | <strong><span>ipv6-frag</span></strong> | <strong><span>ipv6-routing</span></strong> | <strong><span>ipv6-destination</span></strong> } [ <strong><span>destination</span></strong> { <i><span class="varname">destination-ipv6-address</span></i> { <i><span class="varname">prefix-length</span></i> | <i><span class="varname">destination-wildcard</span></i> } | <i><span class="varname">dest-ipv6-addr-prefix</span></i> | <strong><span>any</span></strong> } | <strong><span>fragment</span></strong> | <strong><span>source</span></strong> { <i><span class="varname">source-ipv6-address</span></i> { <i><span class="varname">prefix-length</span></i> | <i><span class="varname">source-wildcard</span></i> } | <i><span class="varname">src-ipv6-addr-prefix</span></i> | <strong><span>any</span></strong> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | [ <strong><span>dscp</span></strong> <i><span class="varname">dscp</span></i> ] | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>logging</span></strong> ] <sup>*</sup></pre>
</li></ul>
</p><p><p>In this example, only one permit or deny rule is configured. In actual configuration, you can configure multiple ACL6 rules and decide the matching order of the rules according to service requirements.</p>
</p><p><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>To configure a time-based advanced ACL6, you must create a time range. For details, see <a href="vrp_acl6_cfg_0009.html">Creating a Time Range in Which an ACL6 Takes Effect</a>.</p>
<div class="p">When you configure a rule for an advanced ACL6:<ul><li><p>If a destination IPv6 address, destination port number, source IPv6 address, and source port number are specified by <strong><span>destination</span></strong>, <strong><span>destination-port</span></strong>, <strong><span>source</span></strong>, and <strong><span>source-port</span></strong> respectively, the system filters only packets with the specified destination IPv6 address, destination port number, source IPv6 address, and source port number.</p>
</li><li><p>If all destination and source IPv6 addresses are specified by <strong><span>any</span></strong>, the system does not check packets' destination or source IPv6 addresses, and considers that all packets have matched the rule and directly takes an action (<strong><span>deny</span></strong> or <strong><span>permit</span></strong>) on the packets.</p>
</li><li><p>If <strong><span>time-range</span></strong> is specified, the specified time range name must exist. If the specified time range name does not exist, the ACL6 rule configuration fails.</p>
</li></ul>
</div>
</div></div>
</p></li><li><span>(Optional) Configure a description for the ACL6 rule.</span><p><pre class="screen" id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_screen826615523308"><a href="cmdqueryname=rule+description"><b><span class="cmdname" id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_cmdname5950135873010">rule</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_varname99506588307">rule-id</span></i> <strong><span id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_cmdparmname9950195833018">description</span></strong> <i><span class="varname" id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_varname7f65f9ae3bfa636bde170682d2274f6c">destext</span></i></pre>
<p id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_p2120462660183305">The ACL6 rule description helps you understand and remember the functions or purpose of the ACL6 rule.</p>
<p id="EN-US_TASK_0000001176741121__en-us_task_0000001176661207_rule_description_01">You must create a rule before you can configure a description for it.</p>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001176741121__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001176741121__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001176741121__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Example</h4><ul><li><p>Configure a filtering rule for ICMPv6 packets based on the source IPv6 address (host address) and destination IPv6 address segment.</p>
<div class="p">To permit ICMPv6 packets from a host and destined for a network segment, configure a rule in an ACL6. For example, to permit ICMPv6 packets from the host at 2001:db8:1::2/128 and destined for the network segment 2001:db8:1::1/64, configure the following rule in ACL6 3001.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>acl ipv6 3001</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl6-advance-3001] <strong>rule permit icmpv6 source 2001:db8:1::2 128 destination 2001:db8:1::1 64</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl6-advance-3001] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
</div>
</li><li><p>Configure a filtering rule for TCP packets based on the TCP destination port number, source IPv6 address (host address), and destination IPv6 address segment.</p>
<div class="p">To prohibit Telnet connections between a specified host and the hosts on a network segment, configure a rule in an advanced ACL6. For example, to prohibit Telnet connections between the host at 2001:db8:1::3/128 and hosts on the network segment 2001:db8:2::1/64, configure the following rule in the advanced ACL6 <strong>deny-telnet</strong>.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>acl ipv6 name deny-telnet</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl6-advance-deny-telnet] <strong>rule deny tcp destination-port eq telnet source 2001:db8:1::3 128 destination 2001:db8:2::1 64</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl6-advance-deny-telnet] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
</div>
<div class="p">To prohibit the specified hosts from accessing web pages (HTTP is used to access web pages, and the TCP port number is 80), configure rules in an advanced ACL6. For example, to prohibit hosts at 2001:db8:1::3/128 and 2001:db8:1::4/128 from accessing web pages, configure the following rules in the advanced ACL6 <strong>no-web</strong>.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>acl ipv6 name no-web</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl6-advance-no-web] <strong>rule deny tcp destination-port eq 80 source 2001:db8:1::3 128</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl6-advance-no-web] <strong>rule deny tcp destination-port eq 80 source 2001:db8:1::4 128</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl6-advance-no-web] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
</div>
</li></ul>
<h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <span><a href="cmdqueryname=display+acl+ipv6+name+all"><b><span class="cmdname">display acl ipv6</span></b></a> { <i><span class="varname">advance-acl6-number</span></i> | <strong><span>name</span></strong> <i><span class="varname">advance-acl6-name</span></i> | <strong><span>all</span></strong> }</span> command to check the configuration of the advanced ACL6.</p>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001176741121__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Follow-up Procedure</h4>
<div class="p"><p>Apply the advanced ACL6 to a service module so that the advanced ACL6 rules can be delivered and take effect.</p>
</div></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_acl6_cfg_0010.html">Configuring an ACL6
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_acl6_cfg_0011.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>