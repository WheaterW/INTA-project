
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Understanding ARP Message Validity Check">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_arp_security_cfg_0018.html">
<meta name="DC.Relation" scheme="URI" content="vrp_arp_security_cfg_0020.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="ARP Security">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ARP Security">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="ARP Security">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001176661635">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Understanding ARP Message Validity Check</title>
</head>
<body><a name="EN-US_CONCEPT_0000001176661635"></a><a name="EN-US_CONCEPT_0000001176661635"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Understanding ARP Message Validity Check</h1>
<div><div class="section"><h4 class="sectiontitle">Definition</h4><p>ARP is easy to implement but lacks security mechanisms, making it vulnerable to attacks. An attacker can forge an ARP message by changing the MAC addresses carried in the Data field of an authorized user's message, which makes the source and destination MAC addresses carried in the Data field different from those carried in the Ethernet header.</p>
<p>This issue can be resolved by configuring ARP message validity check on devices. When a device capable of checking ARP message validity receives an ARP message, the device checks whether the source and destination MAC addresses carried in the Data field match those carried in the Ethernet header. If they match, the device considers the message valid. If they do not match, the device considers the message invalid and discards it.</p>
</div>
<div class="section"><h4 class="sectiontitle">Related Concepts</h4>
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 1 </b>ARP message validity check modes</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="50%" id="mcps1.3.2.2.2.3.1.1" liSelected="liSelected"><p>Check Mode</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="50%" id="mcps1.3.2.2.2.3.1.2" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.2.2.3.1.1 "><p>Source MAC address-based check</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.2.2.3.1.2 "><p>After receiving an ARP message, a device checks whether the source MAC address in the Data field matches that in the Ethernet header. If they match, the device considers the message valid. If they do not match, the device considers the message invalid and discards it.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.2.2.3.1.1 "><p>Destination MAC address-based check (only for ARP reply messages)</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.2.2.3.1.2 "><p>After receiving an ARP message, a device checks the destination MAC address in the Data field. If the destination MAC address comprises all 1s, the device considers the ARP message invalid and discards it.</p>
<p>After receiving an ARP message, a device checks whether the destination MAC address in the Data field matches that in the Ethernet header. If they match, the device considers the message valid. If they do not match, the device considers the message invalid and discards it.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.2.2.3.1.1 "><p>Source and destination MAC addresses-based check</p>
</td>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.2.2.2.3.1.2 "><p>After receiving an ARP request message, a device checks whether the source MAC address in the Data field matches that in the Ethernet header. If they match, the device considers the message valid. If they do not match, the device considers the message invalid and discards it.</p>
<p>After receiving an ARP reply message, a device checks whether the source and destination MAC addresses in the Data field match those in the Ethernet header and whether the destination MAC address comprises all 1s. If the source and destination MAC addresses in the Data field match those in the Ethernet header and the destination MAC address does not comprise all 1s, the device considers the message valid. Otherwise, the device considers the message invalid and discards it.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section"><h4 class="sectiontitle">Fundamentals</h4><div class="p"><a href="#EN-US_CONCEPT_0000001176661635__fig_dc_vrp_arp-sec_feature_000701">Figure 1</a> shows how the validity of an ARP request message is checked.<div class="fignone" id="EN-US_CONCEPT_0000001176661635__fig_dc_vrp_arp-sec_feature_000701"><a name="EN-US_CONCEPT_0000001176661635__fig_dc_vrp_arp-sec_feature_000701"></a><a name="fig_dc_vrp_arp-sec_feature_000701"></a><span class="figcap"><b>Figure 1 </b>Validity check of an ARP request message</span><br><span><img class="vsd" src="figure/en-us_image_0000001877803945.png"></span></div>
</div>
<p>As shown in <a href="#EN-US_CONCEPT_0000001176661635__fig_dc_vrp_arp-sec_feature_000701">Figure 1</a>, HostA is attacked, and the attacker changes the source MAC address of an ARP request message sent by HostA. As a result, the source MAC address in the Data field of the message is different from that in the Ethernet header. If ARP message validity check is not configured, both HostB and Device learn the fake address information carried in HostA's ARP request message.</p>
<p>If ARP message validity check is configured on Device, Device checks whether the source MAC address in the Data field of the received ARP request message matches that in the Ethernet header. If they match, Device learns the address information carried in the message. If they do not match, Device discards the message.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_arp_security_cfg_0018.html">Configuring ARP Message Validity Check
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_arp_security_cfg_0020.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>