
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Setting BGP Keepalive and Hold Timers">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_0087.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_0088.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_0090.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130783924">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Setting BGP Keepalive and Hold Timers</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130783924"></a><a name="EN-US_TASK_0000001130783924"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Setting BGP Keepalive and Hold Timers</h1>
<div class="taskbody"><div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001130783924__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before setting BGP Keepalive and Hold timers, you have completed the following task:</p>
<ul><li><p><a href="vrp_bgp_cfg_0014.html">Configure basic BGP functions</a>.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130783924__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><div class="p">Keepalive messages are used to maintain BGP peer relationships. A pair of BGP peers periodically send Keepalive messages to each other to inform their local states. If a device receives no Keepalive message from its peer after the Hold timer expires, the device considers the BGP connection to be closed.<ul><li>If small values are set for the Keepalive timer and Hold timer, BGP can fast detect link faults. This speeds up BGP network convergence, but increases the number of Keepalive messages on the network and the burden of devices and consumes more network bandwidth resources.</li><li>If large values are set for the Keepalive timer and Hold timer, the number of Keepalive messages on the network and the burden on devices are reduced. If the Keepalive time is too long, BGP cannot detect link status changes immediately after the changes occur, which slows down BGP network convergence and may cause packet loss.</li></ul>
</div>
<div class="notice"><span class="noticetitle"><img src="public_sys-resources/notice_3.0-en-us.png"> </span><div class="noticebody"><p>Changing timer values using the <a href="cmdqueryname=timer"><b><span class="cmdname">timer</span></b></a> command or the <a href="cmdqueryname=peer+timer"><b><span class="cmdname">peer timer</span></b></a> command interrupts BGP peer relationships. Therefore, exercise caution when changing the values of the timers.</p>
</div></div>
<p>Keepalive and Hold timers can be set for one or all peers or peer groups. Keepalive and Hold timers configured for a specific peer take precedence over those configured for the peer group to which this peer belongs. In addition, Keepalive and Hold timers configured for a specific peer or peer group take precedence over those configured for all peers or peer groups.</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0000001130783924__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span><a name="EN-US_TASK_0000001130783924__cmd1372590248214038"></a><a name="cmd1372590248214038"></a>Set BGP timers for all peers or peer groups.</span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the BGP view.</span><p><pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></pre>
</p></li><li class="substepexpand"><span>Set BGP timers.</span><p><p>Configure the Keepalive time and hold time for BGP.</p>
<pre class="screen"><a href="cmdqueryname=timer+keepalive+hold+min-holdtime"><b><span class="cmdname">timer</span></b></a> <strong><span>keepalive</span></strong> <i><span class="varname">keepalive-time</span></i> <strong><span>hold</span></strong> <i><span class="varname">hold-time</span></i><span> [ <strong><span>min-holdtime</span></strong> <i><span class="varname">min-hold-value</span></i> ]</span></pre>
<p>Alternatively, configure the hold time during which the local device does not proactively disconnect from the peer device.</p>
<pre class="screen"><a href="cmdqueryname=timer+send-hold"><b><span class="cmdname">timer</span></b></a> <strong><span>send-hold</span></strong> <i><span class="varname">send-hold-time</span></i></pre>
</p><p><p>The proper maximum interval at which Keepalive messages are sent is one third the hold timer and cannot be less than 1s. If the hold time is not set to 0, it is 3s at least. <span>By default, the keepalive time is 60s, the hold time is 180s, and the hold time during which the local device does not proactively disconnect from the peer device is 360s.</span></p>
<div class="note" id="EN-US_TASK_0000001130783924__note1971704117353"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001130783924__p571713411355">You are advised to configure <i><span class="varname" id="EN-US_TASK_0000001130783924__varname1699292344314">hold-time</span></i> according to the total number of peers in all BGP address families. The more peers, the larger the recommended minimum hold time value. You can adjust the hold time based on <a href="#EN-US_TASK_0000001130783924__table410763711163">Table 1</a>.</p>
</div></div>

<div class="tableBorder"><a name="EN-US_TASK_0000001130783924__table410763711163"></a><a name="table410763711163"></a><table cellpadding="4" cellspacing="0" summary="" id="EN-US_TASK_0000001130783924__table410763711163" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Mapping between the total number of BGP peers in all address families and the recommended minimum hold time</caption><thead align="left"><tr id="EN-US_TASK_0000001130783924__row510713710160"><th align="left" class="cellrowborder" valign="top" width="12.47%" id="mcps1.3.3.1.2.3.3.3.2.3.1.1" liSelected="liSelected"><p id="EN-US_TASK_0000001130783924__p1110717372163">Total Number of Peers</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="87.53%" id="mcps1.3.3.1.2.3.3.3.2.3.1.2" liSelected="liSelected"><p id="EN-US_TASK_0000001130783924__p010753721612">Recommended Minimum Hold Time</p>
</th>
</tr>
</thead>
<tbody><tr id="EN-US_TASK_0000001130783924__row51071037111610"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.3.3.1.2.3.3.3.2.3.1.1 "><p id="EN-US_TASK_0000001130783924__p9530101461916">0â100</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.3.3.1.2.3.3.3.2.3.1.2 "><p id="EN-US_TASK_0000001130783924__p35301714161911">20</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001130783924__row610823741614"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.3.3.1.2.3.3.3.2.3.1.1 "><p id="EN-US_TASK_0000001130783924__p205305142194">101â200</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.3.3.1.2.3.3.3.2.3.1.2 "><p id="EN-US_TASK_0000001130783924__p55301414181920">30</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001130783924__row201081337131615"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.3.3.1.2.3.3.3.2.3.1.1 "><p id="EN-US_TASK_0000001130783924__p1753001441911">201â300</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.3.3.1.2.3.3.3.2.3.1.2 "><p id="EN-US_TASK_0000001130783924__p45301514151919">45</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001130783924__row171082371165"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.3.3.1.2.3.3.3.2.3.1.1 "><p id="EN-US_TASK_0000001130783924__p125301614101919">301â400</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.3.3.1.2.3.3.3.2.3.1.2 "><p id="EN-US_TASK_0000001130783924__p053021419191">60</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001130783924__row15108123731613"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.3.3.1.2.3.3.3.2.3.1.1 "><p id="EN-US_TASK_0000001130783924__p1053011141191">401â500</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.3.3.1.2.3.3.3.2.3.1.2 "><p id="EN-US_TASK_0000001130783924__p1153014149193">75</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001130783924__row1710883716168"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.3.3.1.2.3.3.3.2.3.1.1 "><p id="EN-US_TASK_0000001130783924__p2530191421918">Greater than or equal to 501</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.3.3.1.2.3.3.3.2.3.1.2 "><p id="EN-US_TASK_0000001130783924__p953071414192">90</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>Avoid the following situations when setting values for the timers:</p>
<ul><li><p>The <i><span class="varname">keepalive-time</span></i> and <i><span class="varname">hold-time</span></i> values are both set to 0. In this case, BGP timers become invalid, and BGP will not send Keepalive messages.</p>
</li><li><p>The <i><span class="varname">hold-time</span></i> value is much greater than the <i><span class="varname">keepalive-time</span></i> value, for example, the <i><span class="varname">keepalive-time</span></i> value is set to 1 whereas <i><span class="varname">hold-time</span></i> is set to 65535. If the hold time value is too large, BGP cannot verify connection validity in time.</p>
</li><li><p>The <i><span class="varname">keepalive-time</span></i> value is set to 0. In this case, the keepalive timer does not start. As a result, the <i><span class="varname">send-hold-time</span></i> function does not take effect.</p>
</li></ul>
<p>After a connection is established between peers, the peers negotiate the <i><span class="varname">keepalive-time</span></i> and <i><span class="varname">hold-time</span></i> values. The smaller one of the <i><span class="varname">hold-time</span></i> values carried in Open messages of both peers is used as the effective <i><span class="varname">hold-time</span></i> value. The smaller value of one third of the negotiated <i><span class="varname">hold-time</span></i> value and the locally configured <i><span class="varname">keepalive-time</span></i> value is used as the effective <i><span class="varname">keepalive-time</span></i> value.</p>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001130783924__en-us_task_0234857734_screen14848162118611"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001130783924__en-us_task_0234857734_cmdname1784862115612">commit</span></b></a></pre>
</p></li></ol>
</li><li><span>Configure timers for a specific peer or peer group.</span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the BGP view.</span><p><pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></pre>
</p></li><li class="substepexpand"><span>Set the Keepalive and Hold timer values for a specific peer or peer group.</span><p><pre class="screen"><a href="cmdqueryname=peer+timer+keepalive+hold+min-holdtime"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>timer</span></strong> <strong><span>keepalive</span></strong> <i><span class="varname">keepalive-time</span></i> <strong><span>hold</span></strong> <i><span class="varname">hold-time</span></i><span> [ <strong><span>min-holdtime</span></strong> <i><span class="varname">min-hold-value</span></i> ]</span></pre>
<p>Alternatively, configure the hold time during which the local device does not proactively disconnect from the peer device.</p>
<pre class="screen"><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> <i><span class="varname">ipv4-address</span></i> <a href="cmdqueryname=timer+send-hold"><b><span class="cmdname">timer</span></b></a> <strong><span>send-hold</span></strong> <i><span class="varname">send-hold-time</span></i></pre>
<p>For information about the relationship between the Keepalive and hold timer values, see <a href="#EN-US_TASK_0000001130783924__cmd1372590248214038">Set BGP timers for all peers or peer groups</a>.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_p571713411355">You are advised to configure <i><span class="varname" id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_varname1699292344314">hold-time</span></i> according to the total number of peers in all BGP address families. The more peers, the larger the recommended minimum hold time value. You can adjust the hold time based on <a href="vrp_bgp_cfg_0089.html#EN-US_TASK_0000001130783924__table410763711163">Table 1</a>.</p>
</div></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 2 </b>Mapping between the total number of BGP peers in all address families and the recommended minimum hold time</caption><thead align="left"><tr id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_row510713710160"><th align="left" class="cellrowborder" valign="top" width="12.47%" id="mcps1.3.3.2.2.3.2.6.2.3.1.1" liSelected="liSelected"><p id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_p1110717372163">Total Number of Peers</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="87.53%" id="mcps1.3.3.2.2.3.2.6.2.3.1.2" liSelected="liSelected"><p id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_p010753721612">Recommended Minimum Hold Time</p>
</th>
</tr>
</thead>
<tbody><tr id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_row51071037111610"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.3.3.2.2.3.2.6.2.3.1.1 "><p id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_p9530101461916">0â100</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.3.3.2.2.3.2.6.2.3.1.2 "><p id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_p35301714161911">20</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_row610823741614"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.3.3.2.2.3.2.6.2.3.1.1 "><p id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_p205305142194">101â200</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.3.3.2.2.3.2.6.2.3.1.2 "><p id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_p55301414181920">30</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_row201081337131615"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.3.3.2.2.3.2.6.2.3.1.1 "><p id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_p1753001441911">201â300</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.3.3.2.2.3.2.6.2.3.1.2 "><p id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_p45301514151919">45</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_row171082371165"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.3.3.2.2.3.2.6.2.3.1.1 "><p id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_p125301614101919">301â400</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.3.3.2.2.3.2.6.2.3.1.2 "><p id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_p053021419191">60</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_row15108123731613"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.3.3.2.2.3.2.6.2.3.1.1 "><p id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_p1053011141191">401â500</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.3.3.2.2.3.2.6.2.3.1.2 "><p id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_p1153014149193">75</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_row1710883716168"><td class="cellrowborder" valign="top" width="12.47%" headers="mcps1.3.3.2.2.3.2.6.2.3.1.1 "><p id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_p2530191421918">Greater than or equal to 501</p>
</td>
<td class="cellrowborder" valign="top" width="87.53%" headers="mcps1.3.3.2.2.3.2.6.2.3.1.2 "><p id="EN-US_TASK_0000001130783924__en-us_task_0000001130783924_p953071414192">90</p>
</td>
</tr>
</tbody>
</table>
</div>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001130783924__en-us_task_0234857734_screen14848162118611_1"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001130783924__en-us_task_0234857734_cmdname1784862115612_1">commit</span></b></a></pre>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_bgp_cfg_0087.html">Configuring BGP Timers
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_bgp_cfg_0088.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_bgp_cfg_0090.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>