
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a Command Assistant for Automatic Health Check">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_ops_cfg_0007.html">
<meta name="DC.Relation" scheme="URI" content="vrp_ops_cfg_0011.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OPS">
<meta name="featuretype" content="System Management">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OPS">
<meta name="featuretype" content="System Management">
<meta name="featurename" content="OPS">
<meta name="featuretype" content="System Management">
<meta name="featuretype" content="System Management">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001564005297">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring a Command Assistant for Automatic Health Check</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001564005297"></a><a name="EN-US_TASK_0000001564005297"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a Command Assistant for Automatic Health Check</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001564005297__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><div class="p">As shown in <a href="#EN-US_TASK_0000001564005297__fig_dc_vrp_ops_cfg_new_001601">Figure 1</a>, the remote server is an SFTP server. DeviceA and the SFTP server have reachable routes to each other. To reduce maintenance workload, configure DeviceA to automatically collect daily health information.<div class="fignone" id="EN-US_TASK_0000001564005297__fig_dc_vrp_ops_cfg_new_001601"><a name="EN-US_TASK_0000001564005297__fig_dc_vrp_ops_cfg_new_001601"></a><a name="fig_dc_vrp_ops_cfg_new_001601"></a><span class="figcap"><b>Figure 1 </b>Network diagram of automatic health check using commands</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 represents <span>100GE</span><span>1/0/1</span>.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001512685918.png" width="NaN" height="NaN"></span></div>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001564005297__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><div class="p">The configuration roadmap is as follows:<ol><li><p>Create a command assistant and set a timer as the trigger condition for the assistant, so that the assistant performs a health check periodically.</p>
</li><li><p>Specify the commands that the command assistant runs to collect health information.</p>
</li></ol>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001564005297__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure a command assistant.</span><p><p># Create a command assistant and configure it to run at 01:00 a.m. every day.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>ops</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-ops] <strong>assistant collect_health</strong>
[<span class="keyword">*</span>DeviceA-ops-assistant-collect_health] <strong>condition timer cron 0 1 * * * *</strong>
[<span class="keyword">*</span>DeviceA-ops-assistant-collect_health] <strong>commit</strong></pre>
<p># Specify the commands that the command assistant runs to collect information, such as the hardware status, route status, and interface link status, configure the device to save the collected information to a file.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-ops-assistant-collect_health] <strong>execute 1 command display device &gt; health.txt</strong>
[<span class="keyword">*</span>DeviceA-ops-assistant-collect_health] <strong>execute 1.5 command display health &gt;&gt; health.txt</strong>
[<span class="keyword">*</span>DeviceA-ops-assistant-collect_health] <strong>execute 2 command display ip routing-table &gt;&gt; health.txt</strong>
[<span class="keyword">*</span>DeviceA-ops-assistant-collect_health] <strong>execute 2.5 command display lldp neighbor brief &gt;&gt; health.txt</strong>
[<span class="keyword">*</span>DeviceA-ops-assistant-collect_health] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-ops-assistant-collect_health] <strong>return</strong></pre>
</p></li><li><span>Configure an IP address for the specified interface.</span><p><pre class="screen">&lt;DeviceA&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ip address 10.1.1.1 24</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001564005297__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Check the configuration of the command assistant.</p>
<pre class="screen">&lt;DeviceA&gt; <strong>display ops assistant verbose name collect_health</strong>
Assistant information                                                           
  Name                 : collect_health                                         
  State                : ready                                                  
  Type                 : command                                                
  Default assistant    : no                                                     
 Running statistics                                                             
  Running times        : 0                                                      
  Queue size/(free)    : 10/(10)                                                
  Skip for queue full  : 0                                                      
  Skip for delay       : 0                                                      
  Skip for suppression : 0                                                      
  Skip for error       : 0                                                      
 Execute information                                                            
  Task abstract        : display device &gt; health.txt; display health &gt;&gt; health.txt; display ip routing-table &gt;&gt; health.txt; display lldp
neighbor brief &gt;&gt; health.txt;</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001564005297__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li>DeviceA<pre class="screen">#
sysname DeviceA
#
ops
 assistant collect_health
  execute 1 command display device &gt; health.txt
  execute 1.5 command display health &gt;&gt; health.txt
  execute 2 command display ip routing-table &gt;&gt; health.txt
  execute 2.5 command display lldp neighbor brief &gt;&gt; health.txt
  condition timer cron 0 1 * * * *
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.1.1.1 255.255.255.0
#</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_ops_cfg_0007.html">Configuring a Command Assistant
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_ops_cfg_0011.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>