
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring an OSPF NSSA">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0031.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0034.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130783272">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring an OSPF NSSA</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130783272"></a><a name="EN-US_TASK_0000001130783272"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring an OSPF NSSA</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001130783272__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>An excessive number of entries in a routing table wastes network resources and leads to high CPU usage. To solve this problem, a non-backbone area on the border of an AS can be configured as an NSSA, which does not transmit routes learned from other areas in the AS, and instead imports AS external routes. This reduces bandwidth and storage resource consumption.</p>
<p>On the network shown in <a href="#EN-US_TASK_0000001130783272__fig_dc_vrp_ospf_cfg_201901">Figure 1</a>, OSPF runs on all devices and the entire AS is divided into two areas. DeviceA and DeviceB function as ABRs to forward inter-area routes, and DeviceD functions as an ASBR and imports the external static route 10.0.0.0/8. To import AS-external routes, but reduce the number of LSAs advertised to area 1 without compromising route reachability, configure area 1 as an NSSA and DeviceA as an LSA translator in the NSSA.</p>
<div class="fignone" id="EN-US_TASK_0000001130783272__fig_dc_vrp_ospf_cfg_201901"><a name="EN-US_TASK_0000001130783272__fig_dc_vrp_ospf_cfg_201901"></a><a name="fig_dc_vrp_ospf_cfg_201901"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring an OSPF NSSA</span><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, and <span>100GE</span> <span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001130783360.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130783272__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>To improve security, OSPF area authentication or interface authentication is recommended. For details, see "Improving OSPF Network Security." OSPF area authentication is used as an example. For details, see "Example for Configuring Basic OSPF Functions."</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130783272__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Enable OSPF on each device and configure basic OSPF functions to ensure that the devices can communicate with each other using OSPF.</li><li>Configure area 1 as an NSSA.</li><li>Configure DeviceD to import the static route 10.0.0.0/8.</li><li>Configure DeviceA in the NSSA as an LSA translator.</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130783272__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface.</span><p><p>Assign an IP address to each interface as shown in <a href="#EN-US_TASK_0000001130783272__fig_dc_vrp_ospf_cfg_201901">Figure 1</a>. For detailed configurations, see the configuration scripts.</p>
</p></li><li><span>Configure basic OSPF functions.</span><p><p>For detailed configurations, see the configuration scripts.</p>
</p></li><li><span>Configure area 1 as an NSSA.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>ospf</strong>
[<span class="keyword">*</span>DeviceA-ospf-1] <strong>area 1</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.1] <strong>nssa</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA-ospf-1] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceA] <strong>commit</strong></span></pre>
<p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>ospf</strong>
[<span class="keyword">*</span>DeviceB-ospf-1] <strong>area 1</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.1] <strong>nssa</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB-ospf-1] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceB] <strong>commit</strong></span></pre>
<p># Configure DeviceD.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong>ospf</strong>
[<span class="keyword">*</span>DeviceD-ospf-1] <strong>area 1</strong>
[<span class="keyword">*</span>DeviceD-ospf-1-area-0.0.0.1] <strong>nssa</strong>
[<span class="keyword">*</span>DeviceD-ospf-1-area-0.0.0.1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceD-ospf-1] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceD] <strong>commit</strong></span></pre>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>All devices in the NSSA must have the <a href="cmdqueryname=nssa"><b><span class="cmdname">nssa</span></b></a> command configuration.</p>
</div></div>
</p></li><li><span>Configure static route 10.0.0.0/8 on DeviceD, and configure the device to import the route into the OSPF process.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong>ip route-static 10.0.0.0 8 null 0</strong>
[<span class="keyword">*</span>DeviceD] <strong>ospf</strong>
[<span class="keyword">*</span>DeviceD-ospf-1] <strong>import-route static</strong>
[<span class="keyword">*</span>DeviceD-ospf-1] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceD] <strong>commit</strong></span></pre>
<p># Check information about the OSPF routing table on DeviceC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>display ospf routing</strong>
          OSPF Process 1 with Router ID 3.3.3.3
                   Routing Tables

 Routing for Network
 Destination        Cost  Type       NextHop         AdvRouter       Area
 192.168.3.0/24     2     Inter-area 192.168.0.1     1.1.1.1       0.0.0.0
 192.168.4.0/24     2     Inter-area 192.168.2.1     2.2.2.2       0.0.0.0
 192.168.0.0/24     1     Stub       192.168.0.2     3.3.3.3       0.0.0.0
 192.168.1.0/24     2     Inter-area 192.168.0.1     1.1.1.1       0.0.0.0
 192.168.1.0/24     2     Inter-area 192.168.2.1     2.2.2.2       0.0.0.0
 192.168.2.0/24     1     Stub       192.168.2.2     3.3.3.3       0.0.0.0

 Routing for ASEs
 <strong>Destination</strong>      <strong>Cost</strong>      <strong>Type</strong>       <strong>Tag</strong>    <strong>NextHop</strong>         <strong>AdvRouter</strong>
 <strong>10.0.0.0/8</strong>       <strong>1</strong>         <strong>Type2</strong>      <strong>1</strong>      <strong>192.168.2.1</strong>     <strong>2.2.2.2</strong>

 Total Nets: 7
 Intra Area: 2  Inter Area: 4  <strong>ASE: 1</strong>  NSSA: 0</pre>
<p>The command output shows that the router ID of the AS external route imported into the NSSA is 2.2.2.2, meaning that DeviceB functions as an LSA translator. This is because OSPF selects the ABR with the larger router ID as an LSA translator.</p>
</p></li><li><span>Configure DeviceA as an LSA translator.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>ospf</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-ospf-1] <strong>area 1</strong>
[<span><span class="keyword">*</span></span>DeviceA-ospf-1-area-0.0.0.1] <strong>nssa default-route-advertise no-summary translator-always</strong>
[<span><span class="keyword">*</span></span>DeviceA-ospf-1-area-0.0.0.1] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceA-ospf-1] <strong>quit</strong>
<span>[<span><span class="keyword">*</span></span>DeviceA] <strong>commit</strong></span></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001130783272__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Check information about the OSPF routing table on DeviceC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>display ospf routing</strong>
          OSPF Process 1 with Router ID 3.3.3.3
                   Routing Tables

 Routing for Network
 Destination        Cost  Type       NextHop         AdvRouter       Area
 192.168.3.0/24     2     Inter-area 192.168.0.1     1.1.1.1       0.0.0.0
 192.168.4.0/24     2     Inter-area 192.168.2.1     2.2.2.2       0.0.0.0
 192.168.0.0/24     1     Stub       192.168.0.2     3.3.3.3       0.0.0.0
 192.168.1.0/24     2     Inter-area 192.168.2.1     2.2.2.2       0.0.0.0
 192.168.1.0/24     2     Inter-area 192.168.0.1     1.1.1.1       0.0.0.0
 192.168.2.0/24     1     Stub       192.168.2.2     3.3.3.3       0.0.0.0

 Routing for ASEs
 <strong>Destination</strong>      <strong>Cost</strong>      <strong>Type</strong>       <strong>Tag</strong>    <strong>NextHop</strong>         <strong>AdvRouter</strong>
 <strong>10.0.0.0/8</strong>       <strong>1</strong>         <strong>Type2</strong>      <strong>1</strong>      <strong>192.168.0.1</strong>     <strong>1.1.1.1</strong>

 Total Nets: 7
 Intra Area: 2  Inter Area: 4  <strong>ASE: 1</strong>  NSSA: 0</pre>
<p>The command output shows that DeviceC has imported an AS external route, and that the router ID of the device that advertises this route is 1.1.1.1, indicating that DeviceA functions as an LSA translator.</p>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001130783272__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
router id 1.1.1.1
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.0.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.3.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 192.168.1.1 255.255.255.0
#
ospf 1
 area 0.0.0.0
  network 192.168.0.0 0.0.0.255
 area 0.0.0.1
  network 192.168.1.0 0.0.0.255
  network 192.168.3.0 0.0.0.255
  nssa default-route-advertise no-summary translator-always
#
return</pre>
</li><li><p>DeviceB</p>
<pre class="screen">#
sysname DeviceB
#
router id 2.2.2.2
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.1.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.2.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 192.168.4.2 255.255.255.0
#
ospf 1
 area 0.0.0.0
  network 192.168.2.0 0.0.0.255
 area 0.0.0.1
  network 192.168.1.0 0.0.0.255
  network 192.168.4.0 0.0.0.255
  nssa
#
return</pre>
</li><li><p>DeviceC</p>
<pre class="screen">#
sysname DeviceC
#
router id 3.3.3.3
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.0.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.2.2 255.255.255.0
#
ospf 1
 area 0.0.0.0
  network 192.168.0.0 0.0.0.255
  network 192.168.2.0 0.0.0.255
#
return</pre>
</li><li><p>DeviceD</p>
<pre class="screen">#
sysname DeviceD
#
router id 4.4.4.4
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.3.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.4.1 255.255.255.0
#
ospf 1
import-route static
 area 0.0.0.1
  network 192.168.3.0 0.0.0.255
  network 192.168.4.0 0.0.0.255
  nssa
#
ip route-static 10.0.0.0 255.0.0.0 NULL0
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_ospf_cfg_0031.html">Configuring an OSPF NSSA
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_ospf_cfg_0034.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>