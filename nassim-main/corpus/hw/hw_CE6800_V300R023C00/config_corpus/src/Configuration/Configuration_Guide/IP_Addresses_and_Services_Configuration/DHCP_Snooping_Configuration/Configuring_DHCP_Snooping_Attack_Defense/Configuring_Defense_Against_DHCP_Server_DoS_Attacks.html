
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Defense Against DHCP Server DoS Attacks">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../toctopics/en-us_task_0000001564000589.html">
<meta name="DC.Relation" scheme="URI" content="../toctopics/en-us_task_0000001563760641.html">
<meta name="DC.Relation" scheme="URI" content="../toctopics/en-us_task_0000001513160290.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="DHCP Snooping">
<meta name="featurename" content="VLAN">
<meta name="featurename" content="VLAN Mapping">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="DHCP Snooping">
<meta name="featurename" content="VLAN">
<meta name="featurename" content="VLAN Mapping">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="DHCP Snooping">
<meta name="featurename" content="VLAN">
<meta name="featurename" content="VLAN Mapping">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001512840734">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Configuring Defense Against DHCP Server DoS Attacks</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001512840734"></a><a name="EN-US_TASK_0000001512840734"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Defense Against DHCP Server DoS Attacks</h1>
<div class="taskbody"><p></p>
<div class="context"><a name="EN-US_TASK_0000001512840734__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>If malicious DHCP users apply for IP addresses on the network, the IP addresses in the IP address pool will be quickly exhausted. As a result, the DHCP server cannot allocate IP addresses to authorized users. The DHCP server typically determines the MAC address of a DHCP client based on the CHADDR (client hardware address) field in a DHCPREQUEST message. If attackers apply for IP addresses by continuously changing the CHADDR field, addresses in the address pool on the DHCP server will be exhausted. As a result, authorized users cannot obtain IP addresses.</p>
<p>To prevent malicious DHCP users on some interfaces from applying for IP addresses, you can set the maximum number of DHCP snooping binding entries that can be learned by an interface to control the number of online users. When the number of online users reaches the maximum value, users can no longer obtain IP addresses through this interface. To prevent attackers from applying for IP addresses by continuously changing the CHADDR field in DHCPREQUEST messages, you can configure the device to check whether the CHADDR field value is the same as the source MAC address in the header of a DHCPREQUEST message. If they are the same, the device forwards the message. Otherwise, the device discards it.</p>
<p>After the alarm function is enabled, alarms are generated if corresponding attacks occur and the number of discarded attack packets exceeds the threshold. The minimum interval for sending alarms is 1 minute. You can run the <strong>dhcp snooping alarm threshold</strong> command to set an alarm threshold.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>When the maximum number of DHCP snooping binding entries to be learned on an interface is configured:<ul><li>For the system view configuration, the sum of the maximum numbers of DHCP snooping binding entries that can be learned by all interfaces is the configured maximum number. For the VLAN view configuration, the maximum number of DHCP snooping binding entries that can be learned by any interface in the VLAN is the configured maximum number.</li><li>If the configuration is performed in the system, VLAN, and interface views, the maximum number of DHCP snooping binding entries that can be learned by the interface is the smallest value among the three views.</li></ul>
</li><li>When CHADDR field check is configured:<p>If the function is configured in the system, VLAN, and interface views at the same time, the configurations in the three views all take effect.</p>
</li><li>When an alarm threshold for the number of messages discarded by DHCP snooping is configured:<p>If the function is configured in the system, VLAN, and interface views at the same time, the configurations in the three views all take effect.</p>
</li></ul>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001512840734__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Configure the maximum number of DHCP snooping binding entries to be learned on an interface.</span><p><ul><li>Enter the system view and configure the maximum number of DHCP snooping binding entries that can be learned by interfaces.<pre class="screen"><a href="cmdqueryname=dhcp+snooping+user-bind+max-number"><b><span class="cmdname">dhcp snooping user-bind max-number</span></b></a> <i><span class="varname">max-number</span></i> [ <a href="cmdqueryname=vlan"><b><span class="cmdname">vlan</span></b></a> { <i><span class="varname">vlan-id1</span></i> [ <a href="cmdqueryname=to"><b><span class="cmdname">to</span></b></a> <i><span class="varname">vlan-id2</span></i> ] } &amp;&lt;1-10&gt; ]</pre>
</li></ul>
<ul><li>Enter the interface view and configure the maximum number of DHCP snooping binding entries that can be learned by the interface.<pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i>
<strong>portswitch</strong>
<a href="cmdqueryname=dhcp+snooping+user-bind+max-number"><b><span class="cmdname">dhcp snooping user-bind max-number</span></b></a> <i><span class="varname">max-number</span></i>
<a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</li><li>Enter the VLAN view and configure the maximum number of DHCP snooping binding entries that can be learned by the interfaces in the VLAN.<pre class="screen"><a href="cmdqueryname=vlan"><b><span class="cmdname">vlan</span></b></a> <i><span class="varname">vlan-id</span></i>
<a href="cmdqueryname=dhcp+snooping+user-bind+max-number"><b><span class="cmdname">dhcp snooping user-bind max-number</span></b></a> <i><span class="varname">max-numb</span></i>er
<a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</li></ul>
</p></li><li><span>(Optional) Configure alarm thresholds for the percentage for DHCP snooping binding entries in the system view.</span><p><pre class="screen"><a href="cmdqueryname=dhcp+snooping+user-alarm+percentage"><b><span class="cmdname">dhcp snooping user-alarm percentage</span></b></a> <i><span class="varname">percent-lower-value</span></i> <i><span class="varname">percent-upper-value</span></i></pre>
<p>By default, the lower and upper alarm thresholds for the percentage of DHCP snooping binding entries are 50 and 100, respectively.</p>
</p></li><li><span>Enable CHADDR field check.</span><p><ul><li>Enter the system view and configure CHADDR field check.<pre class="screen"><a href="cmdqueryname=dhcp+snooping+check+dhcp-chaddr+enable"><b><span class="cmdname">dhcp snooping check dhcp-chaddr enable</span></b></a> [ <a href="cmdqueryname=vlan"><b><span class="cmdname">vlan</span></b></a> { <i><span class="varname">vlan-id1</span></i> [ <a href="cmdqueryname=to"><b><span class="cmdname">to</span></b></a> <i><span class="varname">vlan-id2</span></i> ] } &amp;&lt;1-10&gt; ]</pre>
</li><li>Enter the interface view and configure CHADDR field check.<pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i>
<strong>portswitch</strong>
<a href="cmdqueryname=dhcp+snooping+check+dhcp-chaddr+enable"><b><span class="cmdname">dhcp snooping check dhcp-chaddr enable</span></b></a>
<a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</li><li>Enter the VLAN view and configure CHADDR field check.<pre class="screen"><a href="cmdqueryname=vlan"><b><span class="cmdname">vlan</span></b></a> <i><span class="varname">vlan-id</span></i>
<a href="cmdqueryname=dhcp+snooping+check+dhcp-chaddr+enable"><b><span class="cmdname">dhcp snooping check dhcp-chaddr enable</span></b></a>
<a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</li></ul>
</p><p><p>By default, a device does not check whether the CHADDR field value is the same as the source MAC address in the header of a DHCPREQUEST message.</p>
</p></li><li><span>(Optional) Configure an alarm threshold for the number of messages discarded by DHCP snooping.</span><p><ul><li>In the system view, enable the DHCP snooping alarm function, and configure an alarm threshold for the number of messages discarded by DHCP snooping.<pre class="screen"><a href="cmdqueryname=dhcp+snooping+alarm"><b><span class="cmdname">dhcp snooping alarm </span></b></a>{ <strong>dhcp-request</strong> | <strong>dhcp-chaddr</strong> | <strong>dhcp-reply</strong> } <strong>enable</strong>
<a href="cmdqueryname=dhcp+snooping+alarm+threshold"><b><span class="cmdname">dhcp snooping alarm threshold</span></b></a> <i><span class="varname">threshold</span></i></pre>
<p>By default, the global alarm threshold for the number of messages discarded by DHCP snooping is 100.</p>
</li><li>Enter the interface view, enable the DHCP snooping alarm function, and configure an alarm threshold for the number of messages discarded by DHCP snooping.<pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i>
<strong>portswitch</strong>
<a href="cmdqueryname=dhcp+snooping+alarm"><b><span class="cmdname">dhcp snooping alarm </span></b></a>{ <strong>dhcp-request</strong> | <strong>dhcp-chaddr</strong> | <strong>dhcp-reply</strong> } <strong>enable</strong>
<a href="cmdqueryname=dhcp+snooping+alarm"><b><span class="cmdname">dhcp snooping alarm</span></b></a> { <strong><span>dhcp-request</span></strong> | <strong><span>dhcp-chaddr</span></strong> | <strong><span>dhcp-reply</span></strong> } <a href="cmdqueryname=threshold"><b><span class="cmdname">threshold</span></b></a> <i><span class="varname">threshold</span></i>
<a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
<p>By default, the alarm threshold for the number of messages discarded by DHCP snooping on an interface is the value configured using the <strong>dhcp snooping alarm threshold</strong> command in the system view.</p>
</li><li>Enter the VLAN view, enable the DHCP snooping alarm function, and configure an alarm threshold for the number of messages discarded by DHCP snooping.<pre class="screen"><a href="cmdqueryname=vlan"><b><span class="cmdname">vlan</span></b></a> <i><span class="varname">vlan-id</span></i>
<a href="cmdqueryname=dhcp+snooping+alarm"><b><span class="cmdname">dhcp snooping alarm </span></b></a>{ <strong>dhcp-request</strong> | <strong>dhcp-chaddr</strong> | <strong>dhcp-reply</strong> } <strong>enable</strong>
<a href="cmdqueryname=dhcp+snooping+alarm"><b><span class="cmdname">dhcp snooping alarm</span></b></a> { <strong><span>dhcp-request</span></strong> | <strong><span>dhcp-chaddr</span></strong> | <strong><span>dhcp-reply</span></strong> } <a href="cmdqueryname=threshold"><b><span class="cmdname">threshold</span></b></a> <i><span class="varname">threshold</span></i>
<a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
<p>By default, the alarm threshold for the number of messages discarded by DHCP snooping on an interface is the value configured using the <strong>dhcp snooping alarm threshold</strong> command in the system view.</p>
</li></ul>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001512840734__en-us_task_0228023023_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001512840734__en-us_task_0228023023_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../toctopics/en-us_task_0000001564000589.html">Configuring DHCP Snooping Attack Defense
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../toctopics/en-us_task_0000001563760641.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../toctopics/en-us_task_0000001513160290.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>