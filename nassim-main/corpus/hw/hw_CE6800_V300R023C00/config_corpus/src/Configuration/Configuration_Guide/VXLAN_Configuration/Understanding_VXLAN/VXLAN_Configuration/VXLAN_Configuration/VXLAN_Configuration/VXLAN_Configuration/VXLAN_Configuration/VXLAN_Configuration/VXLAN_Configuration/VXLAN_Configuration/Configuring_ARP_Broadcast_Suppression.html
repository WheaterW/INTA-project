
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring ARP Broadcast Suppression">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../toctopics/en-us_topic_0000001130784304.html">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_vrp_vxlan_cfg_1045.html">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_vrp_vxlan_cfg_1225.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="featurename" content="VXLAN">
<meta name="featuretype" content="VXLAN">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176664061">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Configuring ARP Broadcast Suppression</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176664061"></a><a name="EN-US_TASK_0000001176664061"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring ARP Broadcast Suppression</h1>
<div class="taskbody"><div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001176664061__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><div class="p">Before configuring ARP broadcast suppression, you have completed one of the following tasks:<ul><li><a href="dc_vrp_vxlan_cfg_1072.html">Establishing VXLAN Tunnels in BGP EVPN Mode (Centralized VXLAN Gateway)</a></li><li><a href="dc_vrp_vxlan_cfg_1066.html">Establishing VXLAN Tunnels in BGP EVPN Mode (Distributed VXLAN Gateway)</a></li></ul>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176664061__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><div class="p">When two end tenants communicate with one another for the first time, the initiator sends an ARP request, which is broadcast on the Layer 2 network. If a large number of ARP requests are broadcast, a broadcast storm may occur. To prevent this problem, you can enable ARP broadcast suppression on Layer 2 VXLAN gateways. <div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>ARP broadcast suppression is supported by IPv4 overlay networks only.</p>
</div></div>
</div>
<div class="fignone" id="EN-US_TASK_0000001176664061__fig_dc_fd_vxlan_001201"><a name="EN-US_TASK_0000001176664061__fig_dc_fd_vxlan_001201"></a><a name="fig_dc_fd_vxlan_001201"></a><span class="figcap"><b>Figure 1 </b>ARP broadcast suppression networking</span><br><span><img class="vsd" src="figure/en-us_image_0000001176744013.png"></span></div>
<p>On the network shown in <a href="#EN-US_TASK_0000001176664061__fig_dc_fd_vxlan_001201">Figure 1</a>, the Layer 3 VXLAN gateway dynamically learns the ARP entries of tenants and generates host information (including host IP addresses, MAC addresses, VTEP addresses, and VNIs) based on these ARP entries. The Layer 3 VXLAN gateway then uses BGP EVPN to advertise the host information to BGP peers. Layer 2 VXLAN gateways functioning as BGP peers use the learned host information for ARP broadcast suppression.</p>
<p>When Server1 accesses Server2 for the first time, Server1 broadcasts an ARP request message for Server2's MAC address. The process is as follows:</p>
<ol><li>Server1 broadcasts an ARP request for Server2's MAC address.</li><li>Device1, a Layer 2 VXLAN gateway, receives the ARP request and queries host information.<ul><li>If the host information on Device1 contains Server2 information, Device1 replaces the broadcast destination MAC address and target MAC address in the ARP request with Server2's MAC address, performs VXLAN encapsulation, and forwards the VXLAN packet.</li><li>If the host information on Device1 does not contain Server2 information, Device1 retains the broadcast destination MAC address in the broadcast ARP request, performs VXLAN encapsulation, and forwards the VXLAN packet.</li></ul>
</li><li>After Device2 (a Layer 2 VXLAN gateway) receives the VXLAN packet, it performs VXLAN decapsulation and obtains the ARP request. Device2 then determines whether the destination MAC address in the ARP request message is a broadcast MAC address.<ul><li>If the destination MAC address is a broadcast MAC address, Device2 broadcasts the ARP request to the non-VXLAN network side in the Layer 2 BD.</li><li>If the destination MAC address is not a broadcast MAC address, Device2 forwards the ARP request to the destination host.</li></ul>
</li><li>Server2 receives the ARP request and responds with an ARP reply.</li><li>Server1 receives the ARP reply and generates an ARP entry in the ARP cache. At this point, Server1 can communicate with Server2.</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176664061__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure BGP EVPN on Layer 2 and Layer 3 VXLAN gateways to advertise host information.</span><ol type="a"><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the BGP view or BGP multi-instance view.</span><p><pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i> [ <strong><span>instance</span></strong> <i><span class="varname">instance-name</span></i> ]</pre>
</p></li><li class="substepexpand"><span>Enter the BGP-EVPN address family view or BGP multi-instance EVPN address family view.</span><p><pre class="screen"><a href="cmdqueryname=l2vpn-family+evpn"><b><span class="cmdname">l2vpn-family evpn</span></b></a></pre>
</p></li><li class="substepexpand"><span>Configure ARP route advertisement.</span><p><pre class="screen"><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv4-address</span></i> | <i><span class="varname">group-name</span></i> } <strong><span>advertise</span></strong> <strong><span>arp</span></strong></pre>
<p>By default, a device does not advertise ARP routes to its BGP EVPN peers. </p>
</p></li></ol>
</li><li><span>Enable BGP EVPN on a Layer 3 VXLAN gateway to collect host information.</span><ol type="a"><li class="substepexpand"><span>Return to the system view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the VBDIF interface view.</span><p><pre class="screen"><a href="cmdqueryname=interface+vbdif"><b><span class="cmdname">interface vbdif</span></b></a> <i><span class="varname">bd-id</span></i></pre>
</p></li><li class="substepexpand"><span>Enable EVPN BGP to collect host information.</span><p><pre class="screen"><a href="cmdqueryname=arp+collect+host+enable"><b><span class="cmdname">arp collect host enable</span></b></a></pre>
<p>By default, BGP EVPN is disabled from collecting host information.</p>
</p></li></ol>
</li><li><span>Enable ARP broadcast suppression on a Layer 2 VXLAN gateway.</span><ol type="a"><li class="substepexpand"><span>Return to the system view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the BD view.</span><p><pre class="screen"><a href="cmdqueryname=bridge-domain"><b><span class="cmdname">bridge-domain</span></b></a> <i><span class="varname">bd-id</span></i></pre>
</p></li><li class="substepexpand"><span>Enable ARP broadcast suppression.</span><p><pre class="screen"><a href="cmdqueryname=arp+broadcast-suppress"><b><span class="cmdname">arp broadcast-suppress</span></b></a> [ <strong><span>mismatch-discard</span></strong> ] <strong><span>enable</span></strong></pre>
<p>By default, ARP broadcast suppression is disabled.</p>
<p>If <strong><span>mismatch-discard</span></strong> is not specified, the device still broadcasts the broadcast packets that do not match any entries in the ARP broadcast suppression table. If <strong><span>mismatch-discard</span></strong> is specified, the device discards such broadcast packets.</p>
</p></li></ol>
</li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001176664061__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001176664061__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001176664061__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+arp+broadcast-suppress+user+bridge-domain"><b><span class="cmdname">display arp broadcast-suppress user bridge-domain</span></b></a> <i><span class="varname">bd-id</span></i> command to check the ARP broadcast suppression table in a BD.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../toctopics/en-us_topic_0000001130784304.html">VXLAN Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../dc/dc_vrp_vxlan_cfg_1045.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../dc/dc_vrp_vxlan_cfg_1225.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>