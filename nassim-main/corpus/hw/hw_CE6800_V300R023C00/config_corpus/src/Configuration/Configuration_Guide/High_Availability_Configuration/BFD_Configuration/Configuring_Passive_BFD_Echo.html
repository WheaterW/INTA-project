
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Passive BFD Echo">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_bfd_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bfd_cfg_0037.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bfd_cfg_0028.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BFD">
<meta name="featuretype" content="High Availability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BFD">
<meta name="featuretype" content="High Availability">
<meta name="featuretype" content="High Availability">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130622336">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring Passive BFD Echo</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130622336"></a><a name="EN-US_TASK_0000001130622336"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Passive BFD Echo</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001130622336__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Context</h4><p>BFD Echo is a rapid fault detection mechanism in which the local system sends BFD Echo packets and the remote system loops back the packets. Passive Echo applies only to single-hop IP links.</p>
<p>BFD mainly works in asynchronous mode (for details, see <a href="vrp_bfd_cfg_0003.html#EN-US_CONCEPT_0000001130622344__section_dc_vrp_bfd_feature_000601">BFD Detection Mechanism</a>). In this mode, BFD supports the Echo function, which is an auxiliary function specific to the mode. If the peer device that supports the Echo function is deployed on a network, you can enable passive BFD Echo on the local device to interwork with the peer device.</p>
<p>In passive Echo, two devices are directly connected, and a BFD session in asynchronous mode is set up on each device. After the Echo and passive Echo functions are enabled on both devices, they work in asynchronous Echo mode and send BFD packets to each other. Before passive Echo is enabled, BFD in asynchronous mode can only adopt the larger detection interval supported by one end; however, after passive Echo is enabled, the smaller interval is adopted for fast link fault detection.</p>
<p>As shown in <a href="#EN-US_TASK_0000001130622336__fig_dc_vrp_bfd_feature_000501">Figure 1</a>, DeviceA is directly connected to DeviceB, and a BFD session in asynchronous mode is set up on each device. After the Echo and passive Echo functions are enabled on DeviceB and DeviceA respectively, the two devices work in asynchronous Echo mode and send BFD packets to each other. If DeviceA has a higher BFD performance than DeviceB, for example, the minimum intervals for receiving BFD packets supported by DeviceA and DeviceB are 3 ms and 100 ms respectively, BFD sessions in asynchronous mode can only adopt the larger interval (100 ms). After passive Echo is enabled, the smaller interval is adopted for fast link detection. If passive Echo is disabled, DeviceA and DeviceB can still send BFD packets to detect link failures, but the larger interval is used instead.</p>
<div class="fignone" id="EN-US_TASK_0000001130622336__fig_dc_vrp_bfd_feature_000501"><a name="EN-US_TASK_0000001130622336__fig_dc_vrp_bfd_feature_000501"></a><a name="fig_dc_vrp_bfd_feature_000501"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring passive BFD Echo</span><br><span><img class="vsd" src="figure/en-us_image_0000001176661909.png"></span></div>
<p><a href="#EN-US_TASK_0000001130622336__fig_dc_vrp_bfd_feature_000501">Figure 1</a> shows the process of establishing a passive BFD Echo session:</p>
<ol><li>DeviceB functions as the BFD session initiator and sends a BFD packet to DeviceA. The Required Min Echo RX Interval field value carried in the packet is greater than 0, which requires DeviceA to support passive BFD Echo.</li><li>After receiving the packet, DeviceA checks the value of the Required Min Echo RX Interval field, which is greater than 0. If DeviceA has passive BFD Echo enabled, it checks whether any ACL that restricts passive BFD Echo is referenced, and if such one is referenced, only the BFD session that matches specific ACL rules can enter the Echo mode. If no ACL is referenced, the BFD session immediately enters Echo mode.</li><li>DeviceB periodically sends BFD packets, and DeviceA sends BFD packets (the source and destination IP addresses are the local IP address, and the destination physical address is DeviceB's physical address) at the locally configured minimum interval for receiving BFD packets. Both DeviceA and DeviceB start a receive timer, with the receive interval being the same as the interval at which they each send BFD packets.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130622336__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Procedure</h4><ol><li>Enter the system view.<pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</li><li>(Optional) Create a basic ACL.<pre class="screen"><span><a href="cmdqueryname=acl"><b><span class="cmdname">acl</span></b></a> { <strong><span>name</span></strong> <i><span class="varname">basic-acl-name</span></i> { <strong><span>basic</span></strong> | [ <strong><span>basic</span></strong> ] <strong><span>number</span></strong> <i><span class="varname">basic-acl-number</span></i> } | [ <strong><span>number</span></strong> ] <i><span class="varname">basic-acl-number</span></i> }</span></pre>
</li><li>(Optional) Configure an ACL rule.<pre class="screen"><span><a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> [ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>deny</span></strong> | <strong><span>permit</span></strong> } [ <strong><span>fragment-type</span></strong> { <strong><span>fragment</span></strong> | <strong><span>non-fragment</span></strong> | <strong><span>non-subseq</span></strong> | <strong><span>fragment-subseq</span></strong> | <strong><span>fragment-spe-first</span></strong> } | <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong><span> | <i><span class="varname">src-netmask</span></i></span> } | <strong><span>any</span></strong> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <sup>*</sup></span></pre>
</li><li>(Optional) Return to the system view.<pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</li><li>Enter the BFD view.<pre class="screen"><a href="cmdqueryname=bfd"><b><span class="cmdname">bfd</span></b></a></pre>
</li><li>Enable passive BFD Echo.<pre class="screen"><a href="cmdqueryname=echo-passive"><b><span class="cmdname">echo-passive</span></b></a> { <strong><span>all</span></strong> | <strong><span>acl</span></strong> <i><span class="varname">basic-acl-number</span></i> }</pre>
<ul><li><strong><span>all</span></strong>: enables passive Echo for all BFD sessions.</li><li><strong><span>acl</span></strong>: enables passive Echo for BFD sessions that match the configured ACL rule. You can enable passive Echo for BFD packets that match the permit action and disable passive Echo for BFD packets that match the deny action or do not match any ACL rules.</li></ul>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If an ACL rule is created or modified after a BFD session goes up, this ACL rule can take effect only after the BFD session goes down and then up or the parameters of the BFD session are modified.</p>
</div></div>
</li><li>Commit the configuration.<pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130622336__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+bfd+session"><b><span class="cmdname">display bfd session</span></b></a> { <strong><span>all</span></strong> { [ <strong><span>for-ip</span></strong> ] | <strong><span>for-ipv6</span></strong> } | <strong><span>discriminator</span></strong> <i><span class="varname">discr-value</span></i> | <strong><span>dynamic</span></strong> | <strong><span>peer-ip</span></strong> { <i><span class="varname">peer-ip</span></i> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] | <strong><span>default-ip</span></strong> } | <strong><span>peer-ipv6</span></strong> <i><span class="varname">peer-ipv6</span></i> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] | <strong><span>static</span></strong> { [ <strong><span>for-ip</span></strong> ] | <strong><span>for-ipv6</span></strong> } | <strong><span>static-auto</span></strong> } [ <strong><span>verbose</span></strong> ] command to check BFD session information.</p>
</div></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_bfd_cfg_0001.html">BFD Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_bfd_cfg_0037.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_bfd_cfg_0028.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>