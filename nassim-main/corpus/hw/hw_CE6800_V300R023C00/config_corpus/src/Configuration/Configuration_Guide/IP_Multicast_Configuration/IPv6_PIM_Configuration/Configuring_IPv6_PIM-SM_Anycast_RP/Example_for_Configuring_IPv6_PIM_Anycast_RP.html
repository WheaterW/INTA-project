
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring IPv6 PIM Anycast RP">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_ipv6pim_cfg_0025.html">
<meta name="DC.Relation" scheme="URI" content="vrp_ipv6pim_cfg_0030.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="PIMv6">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="PIMv6">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="PIMv6">
<meta name="featuretype" content="IP Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001589525021">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring IPv6 PIM Anycast RP</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001589525021"></a><a name="EN-US_TASK_0000001589525021"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring IPv6 PIM Anycast RP</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001589525021__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In scenarios where multiple multicast sources and receivers are located in an IPv6 PIM-SM domain, you can configure anycast RP peer relationships so that multicast source registration and multicast group joining can be implemented through the closest RP. This alleviates RP burdens and optimizes multicast data forwarding paths.</p>
<p>In a traditional PIM-SM domain, each multicast group can be mapped to only one RP. When the network is overloaded or traffic congestion occurs, the following problems may occur: the RP is overburdened; route convergence is slow after the RP fails; the multicast forwarding path is not optimal. PIM anycast RP in a single AS allows multicast source registration and multicast group joining to be implemented through the closest RP. In this way, receivers can quickly receive multicast data. On the network shown in <a href="#EN-US_TASK_0000001589525021__fig61819557114">Figure 1</a>, Receiver 2 needs to receive multicast data from Source. To do this, configure an anycast RP peer relationship between <span class="keyword">Device</span>C and <span class="keyword">Device</span>D so that Receiver 2 can send a Join message to the closest RP (<span class="keyword">Device</span>D). After receiving multicast data from Source, <span class="keyword">Device</span>A encapsulates the multicast data into a Register message and sends it to <span class="keyword">Device</span>C. Upon receipt, <span class="keyword">Device</span>C forwards it to <span class="keyword">Device</span>D so that Receiver 2 can receive the multicast data from Source.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1, interface2, and interface3 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, and <span>100GE</span> <span>1/0/3</span>, respectively.</p>
</div></div>
<div class="fignone" id="EN-US_TASK_0000001589525021__fig61819557114"><a name="EN-US_TASK_0000001589525021__fig61819557114"></a><a name="fig61819557114"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring IPv6 PIM anycast RP</span><br><span><img class="vsd" src="figure/en-us_image_0000001589365349.png"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.1.6.1.4.1.1" liSelected="liSelected"><p>Device</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.1.6.1.4.1.2" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.3.1.6.1.4.1.3" liSelected="liSelected"><p>IPv6 Address</p>
<p>Link-local Address</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="2" valign="top" width="33.33333333333333%" headers="mcps1.3.1.6.1.4.1.1 "><p><span class="keyword">Device</span>A</p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.1.6.1.4.1.2 "><p>interface1</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.1.6.1.4.1.3 "><p>2001:db8:2::1/64</p>
<p>FE80::2</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.1 "><p>interface2</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.2 "><p>2001:db8:1::1/64</p>
<p>FE80::1</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.1.6.1.4.1.1 "><p><span class="keyword">Device</span>B</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.1.6.1.4.1.2 "><p>interface1</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.1.6.1.4.1.3 "><p>2001:db8:3::1/64</p>
<p>FE80::3</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="5" valign="top" width="33.33333333333333%" headers="mcps1.3.1.6.1.4.1.1 "><p><span class="keyword">Device</span>C</p>
<p></p>
<p></p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.1.6.1.4.1.2 "><p>interface1</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.1.6.1.4.1.3 "><p>2001:db8:4::1/64</p>
<p>FE80::4</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.1 "><p>interface2</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.2 "><p>2001:db8:2::2/64</p>
<p>FE80::5</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.1 "><p>interface3</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.2 "><p>2001:db8:5::1/64</p>
<p>FE80::6</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.1 "><p>Loopback0</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.2 "><p>2001:db8:7::7/128</p>
<p>FE80::7</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.1 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.2 "><p>2001:db8:8::8/128</p>
<p>FE80::8</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="5" valign="top" width="33.33333333333333%" headers="mcps1.3.1.6.1.4.1.1 "><p><span class="keyword">Device</span>D</p>
<p></p>
<p></p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.1.6.1.4.1.2 "><p>interface1</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.3.1.6.1.4.1.3 "><p>2001:db8:3::2/64</p>
<p>FE80::9</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.1 "><p>interface2</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.2 "><p>2001:db8:6::1/64</p>
<p>FE80::10</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.1 "><p>interface3</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.2 "><p>2001:db8:4::2/64</p>
<p>FE80::11</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.1 "><p>Loopback0</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.2 "><p>2001:db8:7::7/128</p>
<p>FE80::12</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.1 "><p>Loopback1</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.6.1.4.1.2 "><p>2001:db8:9::9/128</p>
<p>FE80::13</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>To complete the configuration, prepare the following data:</p>
<ul><li><p>Multicast group address: FF5E::6/64</p>
</li><li><p>RP address</p>
</li><li><p>Anycast RPs' local addresses</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001589525021__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Assign an IPv6 address to each <span class="keyword">device</span> interface and configure OSPFv3 to implement IP interworking.</p>
</li><li><p>Enable the IPv6 multicast function, and enable IPv6 PIM-SM on related interfaces.</p>
</li><li><p>Enable MLD on the interfaces connecting <span class="keyword">devices</span> to hosts.</p>
</li><li><p>Configure Loopback0 interfaces on <span class="keyword">Device</span>C and <span class="keyword">Device</span>D as both C-RPs and C-BSRs.</p>
</li><li><p>Configure the addresses of Loopback0 interfaces on <span class="keyword">Device</span>C and <span class="keyword">Device</span>D as the anycast RP address.</p>
</li><li><p>Configure the addresses of Loopback1 interfaces on <span class="keyword">Device</span>C and <span class="keyword">Device</span>D as the local addresses of the anycast RPs.</p>
</li><li><p>Configure an anycast RP peer relationship between <span class="keyword">Device</span>C and <span class="keyword">Device</span>D.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001589525021__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IPv6 address to each <span class="keyword">device</span> interface and configure OSPFv3 to implement IP interworking. Enable the multicast function, and enable IPv6 PIM-SM on related interfaces.</span><p><p># Assign an IPv6 address and mask to each <span class="keyword">device</span> interface in the IPv6 PIM-SM domain according to <a href="#EN-US_TASK_0000001589525021__fig61819557114">Figure 1</a>, and configure OSPFv3 between <span class="keyword">devices</span> to implement interworking. Enable the multicast function, and enable IPv6 PIM-SM on related interfaces.</p>
<p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>A</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>ospf</strong><strong>v3 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ospfv3-1] <strong>router-id 1.1.1.1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ospfv3-1] <strong>area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ospfv3-1-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-ospfv3-1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>multicast ipv6 routing-enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface <span>100GE</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 address 2001:db8:2::1/64</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong>ospfv3 1 area 0.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>interface <span>100GE</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/2</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/2</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/2</span>] <strong>ipv6 address 2001:db8:1::1/64</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/2</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/2</span>] <strong>ospfv3 1 area 0.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>B</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B] <strong>ospf</strong><strong>v3 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ospfv3-1] <strong>router-id 2.2.2.2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ospfv3-1] <strong>area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ospfv3-1-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-ospfv3-1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>multicast ipv6 routing-enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>interface <span>100GE</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 address 2001:db8:3::1/64</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-<span>100GE</span><span>1/0/1</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-<span>100GE</span><span>1/0/1</span>] <strong>ospf</strong><strong>v3 1</strong> <strong>area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span>C.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>C</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>ospf</strong><strong>v3 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1] <strong>router-id 3.3.3.3</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1] <strong>area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-ospfv3-1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>multicast ipv6 routing-enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>interface <span>100GE</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 address 2001:db8:4::1/64</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/1</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/1</span>] <strong>ospf</strong><strong>v3 1</strong> <strong>area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>interface <span>100GE</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/2</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/2</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/2</span>] <strong>ipv6 address 2001:db8:2::2/64</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/2</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/2</span>] <strong>ospf</strong><strong>v3 1</strong> <strong>area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>interface <span>100GE</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/3</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/3</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/3</span>] <strong>ipv6 address 2001:db8:5::1/64</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/3</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/3</span>] <strong>ospf</strong><strong>v3 1</strong> <strong>area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>interface loopback 0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-LoopBack0] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-LoopBack0] <strong>ipv6 address 2001:db8:7::7/128</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-LoopBack0] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-LoopBack0] <strong>ospf</strong><strong>v3 1</strong> <strong>area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-LoopBack0] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>interface loopback 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-LoopBack1] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-LoopBack1] <strong>ipv6 address 2001:db8:8::8/128</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-LoopBack1] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-LoopBack1] <strong>ospf</strong><strong>v3 1</strong> <strong>area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-LoopBack1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span>D.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>D</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D] <strong>ospfv3 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-ospfv3-1] <strong>router-id 4.4.4.4</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-ospfv3-1] <strong>area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-ospfv3-1-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-ospfv3-1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>multicast ipv6 routing-enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>interface <span>100GE</span><span>1/0/1</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 address 2001:db8:3::2/64</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/1</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/1</span>] <strong>ospfv3 1</strong> <strong>area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>interface <span>100GE</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/2</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/2</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/2</span>] <strong>ipv6 address 2001:db8:6::1/64</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/2</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/2</span>] <strong>ospfv3 1</strong> <strong>area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>interface <span>100GE</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/3</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/3</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/3</span>] <strong>ipv6 address </strong><strong>2001:db8:4::2/64</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/3</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/3</span>] <strong>ospfv3 1</strong> <strong>area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>interface loopback 0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack0] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack0] <strong>ipv6 address 2001:db8:7::7/128</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack0] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack0] <strong>ospfv3 1</strong> <strong>area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack0] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>interface loopback 1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack1] <strong>ipv6 enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack1] <strong>ipv6 address 2001:db8:9::9/128</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack1] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack1] <strong>ospfv3 1</strong> <strong>area 0</strong><strong>.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-LoopBack1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>commit</strong></pre>
</p></li><li><span>Enable MLD on the interfaces connecting <span class="keyword">devices</span> to hosts.</span><p><p># Enable MLD on the interfaces connecting <span class="keyword">Device</span>C and <span class="keyword">Device</span>D to hosts.</p>
<p># Configure <span class="keyword">Device</span>C.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>interface <span>100GE</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/3</span>] <strong>mld enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span>D.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D] <strong>interface <span>100GE</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/2</span>] <strong>mld enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-<span>100GE</span><span>1/0/2</span>]<strong> quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>commit</strong></pre>
</p></li><li><span>Configure Loopback0 interfaces on <span class="keyword">Device</span>C and <span class="keyword">Device</span>D as both C-RPs and C-BSRs.</span><p><p># Configure <span class="keyword">Device</span>C.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>C] <strong>pim</strong><strong> ipv6</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-pim6] <strong>c-bsr 2001:db8:7::7</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-pim6] <strong>c-rp 2001:db8:8::8</strong></pre>
<p># Configure <span class="keyword">Device</span>D.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>D] <strong>pim</strong> <strong>ipv6</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-pim6] <strong>c-bsr 2001:db8:7::7</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-pim6] <strong>c-rp 2001:db8:9::9</strong></pre>
</p></li><li><span>Configure the addresses of Loopback0 interfaces on <span class="keyword">Device</span>C and <span class="keyword">Device</span>D as the anycast RP address.</span><p><p># Configure <span class="keyword">Device</span>C.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-pim6] <strong>anycast-rp 2001:db8:7::7</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-pim6-anycast-rp-2001:db8:7::7] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span>D.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-pim] <strong>anycast-rp 2001:db8:7::7</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-pim6-anycast-rp-2001:db8:7::7] <strong>quit</strong></pre>
</p></li><li><span>Configure the addresses of Loopback1 interfaces on <span class="keyword">Device</span>C and <span class="keyword">Device</span>D as the local addresses of the anycast RPs.</span><p><p># Configure <span class="keyword">Device</span>C.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-pim6] <strong>anycast-rp 2001:db8:7::7</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-pim6-anycast-rp-2001:db8:7::7] <strong>local-address 2001:db8:8::8</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-pim6-anycast-rp-2001:db8:7::7] <strong>quit</strong></pre>
<p># Configure <span class="keyword">Device</span>D.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-pim6] <strong>anycast-rp 2001:db8:7::7</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-pim6-anycast-rp-2001:db8:7::7] <strong>local-address 2001:db8:9::9</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-pim6-anycast-rp-2001:db8:7::7] <strong>quit</strong></pre>
</p></li><li><span>Configure an anycast RP peer relationship between <span class="keyword">Device</span>C and <span class="keyword">Device</span>D.</span><p><p># Configure <span class="keyword">Device</span>C.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>C-pim6] <strong>anycast-rp 2001:db8:7::7</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-pim6-anycast-rp-2001:db8:7::7] <strong>peer 2001:db8:9::9</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-pim6-anycast-rp-2001:db8:7::7] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C-pim6] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>C] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span>D.</p>
<pre class="screen">[<span class="keyword">*</span><span class="keyword">Device</span>D-pim6] <strong>anycast-rp 2001:db8:7::7</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-pim6-anycast-rp-2001:db8:7::7] <strong>peer 2001:db8:8::8</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-pim6-anycast-rp-2001:db8:7::7] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D-pim6] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>D] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001589525021__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Run the <strong>display pim ipv6 rp-info</strong> command on <span class="keyword">Device</span>C and <span class="keyword">Device</span>D to check RP information.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>C&gt; <strong>display pim ipv6 rp-info</strong>
 VPN-Instance: public net
 PIM-SM BSR RP Number:1
 Group/MaskLen: FF00::/8
     <strong>RP: 2001:DB8:7::7 (local)</strong>
     Priority: 192
     Uptime: 00:45:19
     Expires: 00:02:11
&lt;<span class="keyword">Device</span>D&gt; <strong>display pim ipv6 rp-info</strong>
 VPN-Instance: public net
 PIM-SM BSR RP Number:1
 Group/MaskLen: FF00::/8
     <strong>RP: 2001:DB8:7::7 (local)</strong>
     Priority: 192
     Uptime: 02:27:56
     Expires: 00:01:39</pre>
<p>The preceding command outputs show that <span class="keyword">Device</span>C and <span class="keyword">Device</span>D both serve as RPs and can forward Register messages from the multicast source to each other.</p>
<p># Run the <strong>display pim ipv6 routing-table</strong> command on the <span class="keyword">devices</span> to check PIM entries. Source (2001:db8:1::2/64) in the PIM-SM domain sends multicast data to multicast group G (ff5e::6). Receiver 2 joins G and receives the multicast data sent to G. Source is registered with <span class="keyword">Device</span>C, and Receiver 2 sends a Join message to <span class="keyword">Device</span>D.</p>
<pre class="screen">&lt;<span class="keyword">Device</span>C&gt; <strong>display pim ipv6 routing-table</strong>
 VPN-Instance: public net
 Total 0 (*, G) entry; 1 (S, G) entries

 (2001:DB8:1::2, FF5E::6)
     <strong>RP: 2001:DB8:7::7 (local)</strong>
     Protocol: pim-sm, Flag: SPT ACT
     UpTime: 00:00:38
     Upstream interface: Register, Refresh time: 00:00:38
         Upstream neighbor: NULL
         RPF prime neighbor: NULL
     Downstream interface(s) information: None
&lt;<span class="keyword">Device</span>D&gt; <strong>display pim ipv6 routing-table</strong>
 VPN-Instance: public net
 Total 1 (*, G) entry; 1 (S, G) entries

 (*, FF5E::6)
     <strong>RP: 2001:DB8:7::7 (local)</strong>
     Protocol: pim-sm, Flag: WC
     UpTime: 00:01:25
     Upstream interface: Register, Refresh time: 00:01:25
         Upstream neighbor: NULL
         RPF prime neighbor: NULL
     Downstream interface(s) information:
     Total number of downstreams: 1
         1: <span>100GE</span><span>1/0/2</span>
             Protocol: mld, UpTime: 00:01:25, Expires: -

 (2001:DB8:1::2, FF5E::6)
     <strong>RP: 2001:DB8:7::7 (local)</strong>
     Protocol: pim-sm, Flag: SWT ACT
     UpTime: 00:00:02
     Upstream interface: Register, Refresh time: 00:00:02
         Upstream neighbor: NULL
         RPF prime neighbor: NULL
     Downstream interface(s) information:
     Total number of downstreams: 1
         1: <span>100GE</span><span>1/0/2</span>
             Protocol: pim-sm, UpTime: 00:00:02, Expires: -</pre>
<h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p><span class="keyword">Device</span>A</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>A
#
multicast ipv6 routing-enable
#
ospfv3 1
 router-id 1.1.1.1
 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:2::1/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:1::1/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
return</pre>
</li><li><p><span class="keyword">Device</span>B</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>B
#
multicast ipv6 routing-enable
#
ospfv3 1
 router-id 2.2.2.2
 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:3::1/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
return</pre>
</li><li><p><span class="keyword">Device</span>C</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>C
#
multicast ipv6 routing-enable
#
ospfv3 1
 router-id 3.3.3.3
 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:4::1/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:2::2/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span> <span>1/0/3</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:5::1/64
 pim ipv6 sm
 mld enable
 ospfv3 1 area 0.0.0.0
#
interface LoopBack0
 ipv6 enable
 ipv6 address 2001:db8:7::7/128
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
interface LoopBack1
 ipv6 enable
 ipv6 address 2001:db8:8::8/128
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
pim ipv6
 c-bsr 2001:db8:7::7
 c-rp 2001:db8:8::8
 anycast-rp 2001:db8:7::7
  local-address 2001:db8:8::8
  peer 2001:db8:9::9
#
return</pre>
</li><li><p><span class="keyword">Device</span>D</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>D
#
multicast ipv6 routing-enable
#
ospfv3 1
 router-id 4.4.4.4
 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:3::2/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:6::1/64
 pim ipv6 sm
 mld enable
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span> <span>1/0/3</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:4::2/64
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
interface LoopBack0
 ipv6 enable
 ipv6 address 2001:db8:7::7/128
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
interface LoopBack1
 ipv6 enable
 ipv6 address 2001:db8:9::9/128
 pim ipv6 sm
 ospfv3 1 area 0.0.0.0
#
pim ipv6
 c-bsr 2001:db8:7::7
 c-rp 2001:db8:9::9
 anycast-rp 2001:db8:7::7
  local-address 2001:db8:9::9
  peer 2001:db8:8::8
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_ipv6pim_cfg_0025.html">Configuring IPv6 PIM-SM Anycast RP
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_ipv6pim_cfg_0030.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>