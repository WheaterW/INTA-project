
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a Tunnel Interface">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_gre_cfg_0006.html">
<meta name="DC.Relation" scheme="URI" content="vrp_gre_cfg_0008.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="GRE">
<meta name="featuretype" content="VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130622824">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring a Tunnel Interface</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130622824"></a><a name="EN-US_TASK_0000001130622824"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a Tunnel Interface</h1>
<div class="taskbody"><div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001130622824__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before configuring a tunnel interface, you have completed the following task:</p>
<ul><li><p>Configure a routing protocol to ensure IP connectivity between devices.</p>
</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130622824__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>A tunnel interface must be configured on each end of a GRE tunnel to be established. You need to set the tunnel encapsulation type of the tunnel interfaces to GRE and specify a source address (or source interface) and a destination address for the interfaces. If the tunnel interfaces need to be advertised using dynamic routing protocols, you also need to configure IP addresses for the tunnel interfaces.</p>
<p>When configuring a source interface for a tunnel, do not specify the tunnel interface of this tunnel as the source interface. Instead, specify the tunnel interface of another tunnel.</p>
<p>The MTU value is valid only when a local device sends locally originated packets over a GRE tunnel and is invalid when a local device forwards received packets over a GRE tunnel.</p>
<div class="p">A tunnel interface is a logical interface and goes down in the following situations:<ul><li><p>The destination address configured for the tunnel interface is unreachable or is the IP address of the tunnel interface.</p>
</li><li><p>The source interface configured for the tunnel interface is down.</p>
</li><li><p>The IP address configured for the tunnel interface is invalid.</p>
</li><li><p>The keepalive function is configured on the tunnel interface and detects that the tunnel remote end is unreachable.</p>
</li></ul>
</div>
<p>Perform the following steps on the devices at both ends of a GRE tunnel.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130622824__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Create a tunnel interface and enter the tunnel interface view.</span><p><pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <strong><span>tunnel</span></strong> <i><span class="varname">interface-number</span></i></pre>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The tunnel interface on a centralized GRE tunnel must be named using the slot ID, subcard ID, and interface number. The tunnel interface's slot ID must be the same as the slot ID of the tunnel where the source interface resides. If the slot IDs are different, the GRE tunnel cannot be established.</p>
</div></div>
</p></li><li><span>(Optional) Configure a description for the tunnel interface.</span><p><pre class="screen"><a href="cmdqueryname=description"><b><span class="cmdname">description</span></b></a> <i><span class="varname">text</span></i></pre>
</p></li><li><span>Set the tunnel encapsulation type to GRE.</span><p><pre class="screen"><a href="cmdqueryname=tunnel-protocol"><b><span class="cmdname">tunnel-protocol</span></b></a> <strong><span>gre</span></strong></pre>
</p><p><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Configuring, changing, or deleting the tunnel mode of a tunnel interface will delete all tunnel-related configurations on the interface, such as the MTU. Exercise caution when performing this operation.</p>
</div></div>
</p></li><li><span>Configure a source address or source interface for the tunnel interface.</span><p><pre class="screen"><a href="cmdqueryname=source"><b><span class="cmdname">source</span></b></a> { <i><span class="varname">source-ip-address</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> }</pre>
</p></li><li><span>Configure a destination address for the tunnel interface.</span><p><pre class="screen"><a href="cmdqueryname=destination"><b><span class="cmdname">destination</span></b></a> <i><span class="varname">ip-address</span></i></pre>
</p></li><li><span>(Optional) Set the MTU for the tunnel interface.</span><p><pre class="screen"><a href="cmdqueryname=mtu"><b><span class="cmdname">mtu</span></b></a> <i><span class="varname">mtu</span></i></pre>
</p></li><li><span>(Optional) Enable path MTU auto-discovery on the tunnel interface.</span><p><pre class="screen"><a href="cmdqueryname=tunnel+pathmtu+enable"><b><span class="cmdname">tunnel pathmtu enable</span></b></a></pre>
</p><p><p>By default, path MTU auto-discovery is disabled.</p>
</p></li><li><span>(Optional) Enable the MTU check function for the GRE tunnel.</span><p><pre class="screen"><a href="cmdqueryname=mtu+check+enable"><b><span class="cmdname">mtu check enable</span></b></a></pre>
<p>By default, the MTU check function is disabled for a GRE tunnel.</p>
<p>After the MTU check function is enabled for a GRE tunnel using this command, when packets need to be transmitted through the GRE tunnel, the device first checks whether the packet lengths exceed the MTU of the tunnel. If so, the device sends an ICMP Packet Too Big message to the sender (specified by the source IP address of the packets) to notify the sender that the packet lengths exceed the MTU and provide a TCP packet fragment size reference for the sender.</p>
</p></li><li><span>(Optional) Configure the DiffServ mode for the tunnel interface.</span><p><pre class="screen"><a href="cmdqueryname=tunnel+pipe+dscp"><b><span class="cmdname">tunnel pipe dscp </span></b></a><i><span class="varname">dscpvalue</span></i></pre>
<p>By default, the DiffServ mode of a tunnel interface is uniform.</p>
</p></li><li><span>Configure an IP address for the tunnel interface. By default, no IP address is configured for a tunnel interface. If a dynamic routing protocol is used on the tunnel interface, configure an IP address for the tunnel interface. The IP addresses of tunnel interfaces on both ends of a tunnel must be on the same network segment. Perform one of the following operations:</span><p><ul><li><div class="p">Configure an IPv4 address for the tunnel interface.<pre class="screen"><a href="cmdqueryname=ip+address"><b><span class="cmdname">ip address</span></b></a> <i><span class="varname">ip-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } [ <strong><span>sub</span></strong> ]</pre>
</div>
</li><li><div class="p">Configure the tunnel interface to borrow an IPv4 address.<pre class="screen"><a href="cmdqueryname=ip+address+unnumbered"><b><span class="cmdname">ip address unnumbered</span></b></a> <strong><span>interface</span></strong><i><span class="varname"> interface-type</span></i> <i><span class="varname">interface-number</span></i></pre>
</div>
</li><li>Configure an IPv6 address for the tunnel interface.<pre class="screen"><a href="cmdqueryname=ipv6+enable"><b><span class="cmdname">ipv6 enable</span></b></a>
<a href="cmdqueryname=ipv6+address"><b><span class="cmdname">ipv6 address</span></b></a> <i><span class="varname">ipv6-address</span></i> <i><span class="varname">prefix-length</span></i></pre>
</li></ul>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001130622824__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001130622824__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_gre_cfg_0006.html">Configuring a GRE Tunnel
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_gre_cfg_0008.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>