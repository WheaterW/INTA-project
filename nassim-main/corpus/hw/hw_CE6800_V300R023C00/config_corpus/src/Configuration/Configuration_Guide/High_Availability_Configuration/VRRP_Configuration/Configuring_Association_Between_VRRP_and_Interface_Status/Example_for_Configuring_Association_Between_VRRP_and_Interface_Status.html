
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Association Between VRRP and Interface Status">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp_cfg_0114.html">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp_cfg_0115.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="High Availability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="High Availability">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="High Availability">
<meta name="featuretype" content="High Availability">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130784068">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Association Between VRRP and Interface Status</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130784068"></a><a name="EN-US_TASK_0000001130784068"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Association Between VRRP and Interface Status</h1>
<div class="taskbody" id="taskbody1571797909243"><div class="context"><a name="EN-US_TASK_0000001130784068__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001130784068__context1211179717214023"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001130784068__p643974861214023">VRRP cannot detect status changes of the interfaces that are not in a VRRP group. As such, if an uplink VRRP-disabled interface fails, VRRP cannot detect the failure and continues to forward user traffic through the faulty interface, resulting in service interruptions. To prevent service interruptions, configure the VRRP group to track the VRRP-disabled interface. This way, if the interface goes down, the master device in the VRRP group reduces its priority and sends a VRRP Advertisement packet carrying a priority lower than that of the backup device to enable the backup device to preempt the master role and take over traffic forwarding.</p>
<p id="EN-US_TASK_0000001130784068__p1246195675214023">In <a href="#EN-US_TASK_0000001130784068__fig_dc_vrp_vrrp_cfg_012501">Figure 1</a>, HostA is connected to HostB through a default gateway, and a VRRP group is configured on DeviceA (master) and DeviceB (backup). The traffic from HostA to HostB is transmitted along the path HostA -&gt; DeviceA -&gt; DeviceC -&gt; HostB. If the link between DeviceA and DeviceC fails, traffic from HostA to HostB is lost. To prevent traffic loss, configure the VRRP group to track the interface connecting DeviceA to DeviceC.</p>
<div class="fignone" id="EN-US_TASK_0000001130784068__fig_dc_vrp_vrrp_cfg_012501"><a name="EN-US_TASK_0000001130784068__fig_dc_vrp_vrrp_cfg_012501"></a><a name="fig_dc_vrp_vrrp_cfg_012501"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring association between VRRP and interface status</span><div class="note" id="EN-US_TASK_0000001130784068__note199845218166"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001130784068__p13989529167">In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span><span>1/0/1</span>, <span>100GE</span><span>1/0/2</span>, and <span>100GE</span><span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001130784068__image299898616214023" src="figure/en-us_image_0000001130784090.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130784068__1.3.2"></a><a name="1.3.2"></a>
<div class="p" id="EN-US_TASK_0000001130784068__context791400438214023"><h4 class="sectiontitle">Precautions</h4><p id="EN-US_TASK_0000001130784068__p2019236820214023">DeviceA's interface (<span>100GE</span><span>1/0/1</span>) and DeviceB's interface (<span>100GE</span><span>1/0/1</span>) must be on the same network segment.</p>
<p id="EN-US_TASK_0000001130784068__p13842139514">To improve security, you are advised to configure a VRRP security policy. For details, see <a href="vrp_vrrp_cfg_0121.html">Example for Configuring VRRP in Master/Backup Mode</a>.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130784068__1.3.3"></a><a name="1.3.3"></a>
<div class="p" id="EN-US_TASK_0000001130784068__context13155820173718"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0000001130784068__p30348959214023">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0000001130784068__ol724872420378"><li id="EN-US_TASK_0000001130784068__li1768162617239">Assign an IP address to each interface on the devices and configure a routing protocol to ensure IP connectivity.</li><li id="EN-US_TASK_0000001130784068__li105418584214023"><p id="EN-US_TASK_0000001130784068__p96132513214023"><a name="EN-US_TASK_0000001130784068__li105418584214023"></a><a name="li105418584214023"></a>Configure VRRP group 1 on DeviceA's <span>100GE</span><span>1/0/1</span> and set a higher VRRP priority for DeviceA so that it functions as the master in the VRRP group.</p>
</li><li id="EN-US_TASK_0000001130784068__li965983074214023"><p id="EN-US_TASK_0000001130784068__p301153398214023"><a name="EN-US_TASK_0000001130784068__li965983074214023"></a><a name="li965983074214023"></a>Configure VRRP group 1 on DeviceB's <span>100GE</span><span>1/0/1</span> and use the default priority so that it functions as the backup in the VRRP group.</p>
</li><li id="EN-US_TASK_0000001130784068__li05222119266">Configure VRRP group 1 on DeviceA to track the uplink interface <span id="EN-US_TASK_0000001130784068__ph12730921192611">100GE</span><span id="EN-US_TASK_0000001130784068__ph187301321182616">1/0/2</span>.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130784068__1.3.4"></a><a name="1.3.4"></a>
<div class="p" id="EN-US_TASK_0000001130784068__context1197044414248"><h4 class="sectiontitle">Procedure</h4><ol id="EN-US_TASK_0000001130784068__ol19393171152511"><li id="EN-US_TASK_0000001130784068__li1739481112517">Assign an IP address to each interface on DeviceA, DeviceB, and DeviceC. Then, configure OSPF to ensure that the devices can communicate with one another.<p id="EN-US_TASK_0000001130784068__p781033926214023"><a name="EN-US_TASK_0000001130784068__li1739481112517"></a><a name="li1739481112517"></a># Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001130784068__screen422172797214023">&lt;<span class="keyword" id="EN-US_TASK_0000001130784068__keyword2000582728214023">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001130784068__b1649822612214023">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword173112011412"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001130784068__keyword462501715214023">HUAWEI</span>] <strong id="EN-US_TASK_0000001130784068__b1296051591214023">sysname DeviceA</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword37362410388">*</span><span class="keyword" id="EN-US_TASK_0000001130784068__keyword609583901214023">HUAWEI</span>]<strong id="EN-US_TASK_0000001130784068__b54165603214023"> commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword9123141816137"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001130784068__b698028907214023">interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword2010762151316"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784068__b584820346420">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword3263357102519">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784068__b1338167951214023">ip address 10.1.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword1818341341415">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784068__b1116785460214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword364113149141">*</span>DeviceA] <strong id="EN-US_TASK_0000001130784068__b772274519214023">interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword178381216131414">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784068__b1427947123317">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword5999131861410">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784068__b566524321214023">ip address 192.168.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword895241921410">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784068__b159616338214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword7916320101410">*</span>DeviceA] <strong id="EN-US_TASK_0000001130784068__b779046289214023">ospf 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword17932821141411">*</span>DeviceA-ospf-1] <strong id="EN-US_TASK_0000001130784068__b1458838565214023">area 0</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword8790182210146">*</span>DeviceA-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784068__b879000860214023">network 10.1.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword10466824191414">*</span>DeviceA-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784068__b238162914214023">network 192.168.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword131788260148">*</span>DeviceA-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784068__b1259177670214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword1498522717146">*</span>DeviceA-ospf-1] <strong id="EN-US_TASK_0000001130784068__b496070570214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword742014334582">*</span>DeviceA] <strong id="EN-US_TASK_0000001130784068__b842003305816">commit</strong></pre>
<p id="EN-US_TASK_0000001130784068__p1161186755214023"># Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001130784068__screen791373464214023">&lt;<span class="keyword" id="EN-US_TASK_0000001130784068__keyword106849331214023">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001130784068__b379199982214023">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword1837514298138"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001130784068__keyword1797195338214023">HUAWEI</span>] <strong id="EN-US_TASK_0000001130784068__b1335155109214023">sysname DeviceB</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword195155514106">*</span><span class="keyword" id="EN-US_TASK_0000001130784068__keyword11951755191015">HUAWEI</span>]<strong id="EN-US_TASK_0000001130784068__b20951135581015"> commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword10236133116138"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001130784068__b793989234214023">interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword11350833181310"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784068__b92911323173310">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword623063216142">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784068__b1817824554214023">ip address 10.1.1.2 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword14561533171412">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784068__b2091096147214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword1899153421418">*</span>DeviceB] <strong id="EN-US_TASK_0000001130784068__b1510122663214023">interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword209361836171410">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784068__b45151352183316">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword68193375144">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784068__b1189404959214023">ip address 192.168.2.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword178041338101412">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784068__b1573983246214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword15969123913141">*</span>DeviceB] <strong id="EN-US_TASK_0000001130784068__b1580765085214023">ospf 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword1723419147">*</span>DeviceB-ospf-1] <strong id="EN-US_TASK_0000001130784068__b1608646798214023">area 0</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword1365144211414">*</span>DeviceB-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784068__b508034475214023">network 10.1.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword41335435148">*</span>DeviceB-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784068__b1932956358214023">network 192.168.2.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword17382194419149">*</span>DeviceB-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784068__b1832953176214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword129491451148">*</span>DeviceB-ospf-1] <strong id="EN-US_TASK_0000001130784068__b1511921778214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword142611629191115">*</span>DeviceB] <strong id="EN-US_TASK_0000001130784068__b226102920117">commit</strong></pre>
<p id="EN-US_TASK_0000001130784068__p1124429360214023"># Configure DeviceC.</p>
<pre class="screen" id="EN-US_TASK_0000001130784068__screen649827802214023">&lt;<span class="keyword" id="EN-US_TASK_0000001130784068__keyword1608498281214023">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001130784068__b1857921446214023">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword920315261518"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001130784068__keyword245334408214023">HUAWEI</span>] <strong id="EN-US_TASK_0000001130784068__b824060577214023">sysname DeviceC</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword1833185991017">*</span><span class="keyword" id="EN-US_TASK_0000001130784068__keyword3833159121016">HUAWEI</span>]<strong id="EN-US_TASK_0000001130784068__b4833359201010"> commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword17689153817132"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001130784068__b2054681469214023">interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword197071240101313"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784068__b11172481349">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword133193535141">*</span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784068__b1139580256214023">ip address 192.168.1.2 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword13288254111411">*</span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784068__b135648804214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword1037771916157">*</span>DeviceC] <strong id="EN-US_TASK_0000001130784068__b1984562761214023">interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword10136112211512">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784068__b163699204344">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword11400102315158">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784068__b1015214206214023">ip address 192.168.2.2 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword62722517151">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784068__b622920571214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword1067722616156">*</span>DeviceC] <strong id="EN-US_TASK_0000001130784068__b418337451214023">interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword12144029121513">*</span>DeviceC-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784068__b5841193413344">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword156011931111511">*</span>DeviceC-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784068__b22138318214023">ip address 172.16.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword106343333151">*</span>DeviceC-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001130784068__b1822500601214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword19382153611154">*</span>DeviceC] <strong id="EN-US_TASK_0000001130784068__b697320817214023">ospf 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword744319381153">*</span>DeviceC-ospf-1] <strong id="EN-US_TASK_0000001130784068__b459855518214023">area 0</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword165210407155">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784068__b769709070214023">network 192.168.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword143981541171510">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784068__b1707161531214023">network 192.168.2.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword2771442141517">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784068__b90257791214023">network 172.16.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword1799218449158">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001130784068__b700974128214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword17259174711517">*</span>DeviceC-ospf-1] <strong id="EN-US_TASK_0000001130784068__b1778211106214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword12466384118">*</span>DeviceC] <strong id="EN-US_TASK_0000001130784068__b1624610389111">commit</strong></pre>
</li><li id="EN-US_TASK_0000001130784068__li579313614252">Configure a VRRP group on DeviceA and DeviceB.<p id="EN-US_TASK_0000001130784068__p267462627214023"><a name="EN-US_TASK_0000001130784068__li579313614252"></a><a name="li579313614252"></a># Configure VRRP group 1 on DeviceA, and set the VRRP priority of DeviceA to 120 so that it functions as the master.</p>
<pre class="screen" id="EN-US_TASK_0000001130784068__screen1183718326214023">[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword187948441139"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001130784068__b895881906214023">interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword1867424515130"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784068__b300923263214023">vrrp vrid 1 virtual-ip 10.1.1.111</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword766425141514">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784068__b2122842519214023">vrrp vrid 1 priority 120</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword10864145318158">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784068__b17616412214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword950154512115">*</span>DeviceA] <strong id="EN-US_TASK_0000001130784068__b1502045131118">commit</strong></pre>
<p id="EN-US_TASK_0000001130784068__p1867234307214023"># Configure VRRP group 1 on DeviceB, and use the default priority so that it functions as the backup.</p>
<pre class="screen" id="EN-US_TASK_0000001130784068__screen318615163214023">[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword67921747131315"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001130784068__b406170750214023">interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword62351049131316"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784068__b1211090392214023">vrrp vrid 1 virtual-ip 10.1.1.111</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword12418583153">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784068__b764821015214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword91641547191113">*</span>DeviceB] <strong id="EN-US_TASK_0000001130784068__b10164174711118">commit</strong></pre>
</li><li id="EN-US_TASK_0000001130784068__li895210332611">Associate VRRP with interface status.<p id="EN-US_TASK_0000001130784068__p1283786443214023"><a name="EN-US_TASK_0000001130784068__li895210332611"></a><a name="li895210332611"></a># Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001130784068__screen13558169485">[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword15581391783"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001130784068__b1155813919817">interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword1255816912814"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784068__b12558391089">vrrp vrid 1 track interface <span>100ge</span> <span>1/0/2</span> reduce 30</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword9558109382">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001130784068__b5558129083">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword05581598817">*</span>DeviceA] <strong id="EN-US_TASK_0000001130784068__b1558591383">commit</strong></pre>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130784068__1.3.5"></a><a name="1.3.5"></a>
<div class="p" id="EN-US_TASK_0000001130784068__context116365342267"><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0000001130784068__p15541049182617"># Check the status of the interface tracked by the VRRP group. The following example uses the command output on DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001130784068__screen1036557693214023">[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword195767305164"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001130784068__b1045379186214023">display vrrp verbose</strong>
<span>100GE</span><span>1/0/1</span> | Virtual Router 1
State             : Master
Virtual IP        : 10.1.1.111
Master IP         : 10.1.1.1
Local IP          : 10.1.1.1
PriorityRun       : 120
PriorityConfig    : 120
MasterPriority    : 120
Preempt           : YES      Delay Time : 0s    Remain : --
Hold Multiplier   : 4
TimerRun          : 1s
TimerConfig       : 1s
Auth Type         : NONE
Virtual MAC       : 00-e0-fc-12-78-90
Check TTL         : YES
Config Type       : <span>Normal</span>
<strong id="EN-US_TASK_0000001130784068__b277412222214023">Track IF        : <span>100GE</span><span>1/0/2</span></strong>            
Priority Reduced :30
<strong id="EN-US_TASK_0000001130784068__b467028732214023">IF State        : UP</strong>
Create Time       : 2020-12-29 05:41:23
Last Change Time  : 2020-12-29 05:41:33</pre>
<p id="EN-US_TASK_0000001130784068__p1110673871214023"># Run the <a href="cmdqueryname=shutdown"><b><span class="cmdname" id="EN-US_TASK_0000001130784068__cmdname150389103214023">shutdown</span></b></a> command on DeviceA's <span>100GE</span><span>1/0/2</span> to simulate a link fault.</p>
<pre class="screen" id="EN-US_TASK_0000001130784068__screen1346337037214023">[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword984223311165"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001130784068__b1778493249214023">interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword478513344163"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784068__b685093306214023">shutdown</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword94051628122314">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001130784068__b1807319249214023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword1838019501368">*</span>DeviceA] <strong id="EN-US_TASK_0000001130784068__b938035043615">commit</strong></pre>
<p id="EN-US_TASK_0000001130784068__p1317826562214023"># Check the VRRP status on DeviceA and DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001130784068__screen673460647214023">[<span class="keyword" id="EN-US_TASK_0000001130784068__keyword14401840111614"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001130784068__b1822838653214023">display vrrp verbose</strong>
<span>100GE</span><span>1/0/1</span> | Virtual Router 1
<strong id="EN-US_TASK_0000001130784068__b1270884068214023">State           : Backup</strong>
Virtual IP        : 10.1.1.111
Master IP         : 10.1.1.2
Local IP          : 10.1.1.1
PriorityRun       : 90
PriorityConfig    : 120
MasterPriority    : 100
Preempt           : YES      Delay Time : 0s    Remain : --
Hold Multiplier   : 4
TimerRun          : 1s
TimerConfig       : 1s
Auth Type         : NONE
Virtual MAC       : 00-e0-fc-12-78-90
Check TTL         : YES
Config Type       : <span>Normal</span>
Track IF          : <span>100GE</span><span>1/0/2</span>            Priority Reduced :30
<strong id="EN-US_TASK_0000001130784068__b932675963214023">IF State        : DOWN</strong>
Create Time       : 2020-12-29 05:41:23
Last Change Time  : 2020-12-29 05:41:33</pre>
<p id="EN-US_TASK_0000001130784068__p017573781910">The command outputs show that DeviceA is in the <strong id="EN-US_TASK_0000001130784068__b104307450379">Backup</strong> state and DeviceB is in the <strong id="EN-US_TASK_0000001130784068__b123315820411">Master</strong> state in VRRP group 1.</p>
</div></div>
<div class="example" id="EN-US_TASK_0000001130784068__example785877979214023"><a name="EN-US_TASK_0000001130784068__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul id="EN-US_TASK_0000001130784068__ul1134465266214023"><li id="EN-US_TASK_0000001130784068__li1749960237214023"><p id="EN-US_TASK_0000001130784068__p1793157594214023"><a name="EN-US_TASK_0000001130784068__li1749960237214023"></a><a name="li1749960237214023"></a>DeviceA</p>
<pre class="screen" id="EN-US_TASK_0000001130784068__screen1204395975214023"># 
sysname DeviceA
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.1.1.1 255.255.255.0
 vrrp vrid 1 virtual-ip 10.1.1.111
 vrrp vrid 1 priority 120
 <span>vrrp vrid 1 track interface <span>100ge</span> <span>1/0/2</span> reduce 30</span>
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.1.1 255.255.255.0
#
ospf 1
 area 0.0.0.0
  network 10.1.1.0 0.0.0.255
  network 192.168.1.0 0.0.0.255
#
return</pre>
</li><li id="EN-US_TASK_0000001130784068__li229331941214023"><p id="EN-US_TASK_0000001130784068__p1796269669214023"><a name="EN-US_TASK_0000001130784068__li229331941214023"></a><a name="li229331941214023"></a>DeviceB</p>
<pre class="screen" id="EN-US_TASK_0000001130784068__screen2134406950214023"># 
sysname DeviceB
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.1.1.2 255.255.255.0
 vrrp vrid 1 virtual-ip 10.1.1.111
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.2.1 255.255.255.0
#
ospf 1
 area 0.0.0.0
  network 10.1.1.0 0.0.0.255
  network 192.168.2.0 0.0.0.255
#
return</pre>
</li><li id="EN-US_TASK_0000001130784068__li152288072214023"><div class="p" id="EN-US_TASK_0000001130784068__p1852602527214023"><a name="EN-US_TASK_0000001130784068__li152288072214023"></a><a name="li152288072214023"></a>DeviceC<pre class="screen" id="EN-US_TASK_0000001130784068__screen672522608214023"># 
sysname DeviceC
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.1.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.2.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 172.16.1.1 255.255.255.0
#
ospf 1
 area 0.0.0.0
  network 192.168.1.0 0.0.0.255
  network 192.168.2.0 0.0.0.255
  network 172.16.1.0 0.0.0.255
#
return</pre>
</div>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_vrrp_cfg_0114.html">Configuring Association Between VRRP and Interface Status
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_vrrp_cfg_0115.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>