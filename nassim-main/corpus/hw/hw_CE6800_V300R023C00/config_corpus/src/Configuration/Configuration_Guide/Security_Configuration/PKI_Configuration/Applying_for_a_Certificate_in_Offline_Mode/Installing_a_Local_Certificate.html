
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Installing a Local Certificate">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="security_pki_cfg_0012.html">
<meta name="DC.Relation" scheme="URI" content="security_pki_cfg_0043.html">
<meta name="DC.Relation" scheme="URI" content="security_pki_cfg_0019.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="PKI">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="Security Protection">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="PKI">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="Security Protection">
<meta name="featurename" content="PKI">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="Security Protection">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="Security Protection">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001563766357">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Installing a Local Certificate</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001563766357"></a><a name="EN-US_TASK_0000001563766357"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Installing a Local Certificate</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001563766357__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>After obtaining a local certificate in out-of-band mode (for example, by disk or email), you need to upload the local certificate to the specified storage directory on the device. Before installing a local certificate, you need to upload the certificate to <strong>flash:/pki/public</strong>. </p>
<p>The device automatically saves the local certificate that has been downloaded using LDAP to <strong>flash:/pki/public</strong>. </p>
<p>After the local certificate is saved to the specified directory, you also need to import it into the device memory. After the device restarts, the system automatically loads the certificate.</p>
<p></p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>To prevent a certificate installation failure, ensure that the local certificate file size does not exceed 1 MB.</p>
<p><span>By default, the public system has a PKI realm named <strong>default</strong>.</span> The initial local certificate on the device is stored in the <strong>default</strong> realm by default. The <strong>default</strong> realm can be modified but cannot be deleted.</p>
<p>The initial local certificate that identifies a Huawei device provides certificate authentication for user login services of the device<span> by default</span>.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001563766357__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><strong>Optional: </strong><span>Enter the user view and download the local certificate to the <strong>flash:/pki/public</strong> directory.</span><p><p>To obtain the local certificate in out-of-band mode and upload it to the device storage through FTP or SFTP (SFTP is recommended because it is more secure than FTP), perform this step. If you obtain the local certificate using LDAP, skip this step.</p>
</p><p><pre class="screen"><a href="cmdqueryname=cd+pki"><b><span class="cmdname">cd pki</span></b></a>
<a href="cmdqueryname=cd+public"><b><span class="cmdname">cd public</span></b></a><strong>/</strong>
<a href="cmdqueryname=ftp+172.16.104.110"><b><span class="cmdname">ftp 172.16.104.110</span></b></a>
Trying 172.16.104.110...
Press CTRL+K to abort
Connected to 172.16.104.110.
220 FTP service ready.
User(172.16.104.110:(none)):ftpuser
331 Password required for ftpuser
Enter password:
230 User logged in.
<a href="cmdqueryname=get+device.cer"><b><span class="cmdname">get device.cer</span></b></a>
200 Port command okay.
150 Opening ASCII mode data connection for temp1.c.
226 Transfer complete.
FTP: 4 byte(s) received in 8.190 second(s) .48byte(s)/sec.</pre>
</p></li><li><span>Enter the system view.</span><p><pre class="screen"><span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></pre>
</p></li><li><strong>Optional: </strong><span>Load the initial local certificate to the <strong>default</strong> realm.</span><p><pre class="screen"><a href="cmdqueryname=pki+import-certificate"><b><span class="cmdname">pki import-certificate</span></b></a> <strong><span>default_local</span></strong> <strong><span>realm</span></strong> <strong><span>default</span></strong></pre>
<p>The initial local certificate can be deleted. To restore the initial local certificate after it is deleted, run this command to load the certificate from the NVRAM to the <strong>default</strong> realm.</p>
</p></li><li><span>Create a PKI realm.</span><p><pre class="screen"><a href="cmdqueryname=pki+realm"><b><span class="cmdname">pki realm</span></b></a> <i><span class="varname">realm-name</span></i>
<strong>quit</strong></pre>
</p></li><li><span>In the system view, import the local certificate into the device memory.</span><p><ul><li>When applying for a local certificate from the CA based on the PKI entity information and RSA key pair created in the local PKI entity, you only need to run the following command to import the local certificate into the device memory. The RSA key pair has been imported into the device memory by default during the creation of the RSA key pair.<pre class="screen"><a href="cmdqueryname=pki+import-certificate"><b><span class="cmdname">pki import-certificate</span></b></a> <strong><span>local</span></strong> [ [ <strong><span>realm</span></strong> <i><span class="varname">realm-name</span></i> ] { <strong><span>der</span></strong> | <strong><span>pkcs12</span></strong> | <strong><span>pem</span></strong> } ] <strong><span>filename</span></strong> <i><span class="varname">file-name</span></i><span> [ <strong>cert-name</strong> <em>cert-name</em> ] [ <strong>no-check-hash-alg</strong> ] [ <strong><span>no-check-same-name</span></strong> ]</span></pre>
</li><li>If you need to use the key pair generated by another PKI entity and the certificate of another PKI entity, you need to import both the certificate and key pair. A key pair file can either be included in a certificate file or exist independently of the certificate file. The methods of importing a key pair file vary accordingly. Select a method of importing a key pair file accordingly.<ul><li>If the key pair file is included in a certificate file:<pre class="screen"><a href="cmdqueryname=pki+import+rsa-key-pair"><b><span class="cmdname">pki import rsa-key-pair</span></b></a> <i><span class="varname">keyname</span></i><span> </span>{ <a href="cmdqueryname=pem"><b><span class="cmdname">pem</span></b></a> | <a href="cmdqueryname=pkcs12"><b><span class="cmdname">pkcs12</span></b></a> } <i><span class="varname">file-name</span></i> [ <strong><span>exportable</span></strong> ] [ <a href="cmdqueryname=password"><b><span class="cmdname">password</span></b></a> <i><span class="varname">password</span></i> ]</pre>
</li><li>If the key pair file exists independently of the certificate file:<div class="p"># Import the certificate file.<pre class="screen"><a href="cmdqueryname=pki+import-certificate"><b><span class="cmdname">pki import-certificate</span></b></a> <strong><span>local</span></strong> [ [ <strong><span>realm</span></strong> <i><span class="varname">realm-name</span></i> ] { <strong><span>der</span></strong> | <strong><span>pkcs12</span></strong> | <strong><span>pem</span></strong> } ] <strong><span>filename</span></strong> <i><span class="varname">file-name</span></i><span> [ <strong>cert-name</strong> <em>cert-name</em> ] [ <strong>no-check-hash-alg</strong> ] [ <strong><span>no-check-same-name</span></strong> ]</span></pre>
</div>
<div class="p"># Import the key pair file.<pre class="screen"><a href="cmdqueryname=pki+import+rsa-key-pair"><b><span class="cmdname">pki import rsa-key-pair</span></b></a> <i><span class="varname">keyname</span></i><span> </span><span><strong><span>exclude-cert</span></strong> </span>{ <a href="cmdqueryname=pem"><b><span class="cmdname">pem</span></b></a> | <a href="cmdqueryname=pkcs12"><b><span class="cmdname">pkcs12</span></b></a> } <i><span class="varname">file-name</span></i> [ <strong><span>exportable</span></strong> ] [ <a href="cmdqueryname=password"><b><span class="cmdname">password</span></b></a> <i><span class="varname">password</span></i> ]</pre>
</div>
</li></ul>
</li></ul>
</p><p><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If no certificate format is specified, the system automatically detects the certificate format and imports the certificate.</p>
</div></div>
</p></li><li><strong>Optional: </strong><span>Set the number of days in advance you are notified that the local certificate in the memory is about to expire.</span><p><pre class="screen"><a href="cmdqueryname=pki+set-certificate+expire-prewarning"><b><span class="cmdname">pki set-certificate expire-prewarning</span></b></a> <i><span class="varname">day</span></i></pre>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001563766357__en-us_task_0228023023_en-us_task_0228023023_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001563766357__en-us_task_0228023023_en-us_task_0228023023_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0000001563766357__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+pki+certificate"><b><span class="cmdname">display pki certificate</span></b></a> <strong><span>local</span></strong> [ <strong><span>realm</span></strong> <i><span class="varname">realm-name</span></i> | <strong><span>filename</span></strong> <i><span class="varname">filename</span></i> ] command to check the local certificate that has been loaded on the device.</p>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="security_pki_cfg_0012.html">Applying for a Certificate in Offline Mode
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="security_pki_cfg_0043.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="security_pki_cfg_0019.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>