
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring RSTP">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_stp_cfg_1077.html">
<meta name="DC.Relation" scheme="URI" content="vrp_stp_cfg_1184.html">
<meta name="DC.Relation" scheme="URI" content="vrp_stp_cfg_1186.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="RSTP">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MSTP">
<meta name="featurename" content="RSTP">
<meta name="featurename" content="STP">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featurename" content="MSTP">
<meta name="featurename" content="RSTP">
<meta name="featurename" content="STP">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001315071130">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring RSTP</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001315071130"></a><a name="EN-US_TASK_0000001315071130"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring RSTP</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001315071130__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_context1677625172748"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p199081611132310">In <a href="#EN-US_TASK_0000001315071130__en-us_task_0000001130623344_fig_dc_cfg_stp_003701">Figure 1</a>, there is a loop between DeviceA, DeviceB, DeviceC, and DeviceD. In this case, RSTP can be deployed on this network to break the loop and thereby avoid broadcast storms and MAC address flapping.</p>
<div class="fignone" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_fig_dc_cfg_stp_003701"><a name="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_fig_dc_cfg_stp_003701"></a><a name="en-us_task_0000001130623344_fig_dc_cfg_stp_003701"></a><span class="figcap"><b>Figure 1 </b>Network diagram of RSTP</span><div class="note" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_note164145990214028"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p1432651182214028">In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, and <span>100GE</span> <span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_image072085183113" src="figure/en-us_image_0000001176662917.png"></span></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001315071130__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_steps1906474405175351"><li id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_step827337223175351"><span id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_cmd100092636175351">Configure each device to work in RSTP mode.</span><p><pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen1850783749175351">&lt;<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword1449072501175351">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b4440155175351">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword767623853516"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword1889175819015">HUAWEI</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1559009996175351">sysname DeviceA</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword26595199374">*</span><span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword16306103810408">HUAWEI</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b182551329133713">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword165672262113"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1922275377175351">stp mode rstp</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword185567193711">*</span>DeviceA] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b16218538143712">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen830715573914">&lt;<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword1367994010">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b969916401">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword7439927122114"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword1262095401">HUAWEI</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b106179124016">sysname DeviceB</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword124162498241">*</span><span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword8416549112414">HUAWEI</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b741611495244">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword1757352913219"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b16714918408">stp mode rstp</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword1821015152517">*</span>DeviceB] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b82101513259">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen83149596393">&lt;<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword1627211064018">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b7272810184011">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword18351133692115"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword42721410174012">HUAWEI</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1027211034019">sysname DeviceC</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword38733538244">*</span><span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword19873153152412">HUAWEI</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b08731153122419">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword1131164017213"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b82721310144011">stp mode rstp</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword14475522132513">*</span>DeviceC] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b184751226254">commit</strong></pre>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen18747823406">&lt;<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword184308114402">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b9430181134014">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword44291747172119"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword2430111204012">HUAWEI</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b34301911114010">sysname DeviceD</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword186631356102415">*</span><span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword1366310563243">HUAWEI</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b466325622418">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword9205125017211"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1243081114012">stp mode rstp</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword209884315259">*</span>DeviceD] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1988631112516">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_step1984009007175351"><span id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_cmd1260793680175351">Specify the root bridge and a secondary root bridge. It is best reality to specify network devices with high performance and higher network layers as the root bridge and a secondary root bridge.</span><p><p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p1417878451175351"># Configure DeviceA as the root bridge.</p>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen1294000472175351">[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword2204914172217"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1454883728175351">stp root primary</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword2770114418256">*</span>DeviceA] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1770444202519">commit</strong></pre>
<p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p182631374175351"># Configure DeviceB as a secondary root bridge.</p>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen1671731851175351">[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword2511151619222"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b2042690957175351">stp root secondary</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword719424814254">*</span>DeviceB] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b11194104802519">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_step237233791175351"><span id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_cmd1458676505175351">Configure all devices on the network to use the same path cost calculation method. Set a path cost value for <span>100GE</span> <span>1/0/1</span> on DeviceC to block this port.</span><p><p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p2058005625175351"># Configure DeviceA to use the Huawei legacy standard to calculate the path cost.</p>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen870698753175351">[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword10929112082217"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b545526747175351">stp pathcost-standard legacy</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword151505518252">*</span>DeviceA] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b115158551256">commit</strong></pre>
<p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p1387811446175351"># Configure DeviceB to use the Huawei legacy standard to calculate the path cost.</p>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen1702466874175351">[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword05682228225"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b529809089175351">stp pathcost-standard legacy</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword85331559182514">*</span>DeviceB] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b153365910255">commit</strong></pre>
<p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p425732183175351"># Configure DeviceC to use the Huawei legacy standard to calculate the path cost. Set the path cost value for <span>100GE</span> <span>1/0/1</span> on DeviceC to 20000, which is greater than that for any other interface, to block this <span>100GE</span> <span>1/0/1</span>.</p>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen823262892175351">[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword1082412613226"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1363207648175351">stp pathcost-standard legacy</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword1424848144617">*</span>DeviceC] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b863953717175351">interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword1330564513615">*</span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1104986900214028">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword632618810247">*</span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1506614906175351">stp cost 20000</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword272718982411">*</span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b2125660436175351">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword1846928122616">*</span>DeviceC] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b104695852612">commit</strong></pre>
<p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p203749780175351"># Configure DeviceD to use the Huawei legacy standard to calculate the path cost.</p>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen1023004879175351">[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword986014291226"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b523986969175351">stp pathcost-standard legacy</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword278191702616">*</span>DeviceD] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b57819179268">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_step1051980662175351"><span id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_cmd406120483175351">Configure DeviceB's and DeviceC's ports that are connected to PCs as edge ports.</span><p><p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p941733761175351"># Configure <span>100GE</span> <span>1/0/2</span> on DeviceB as an edge port and enable BPDU protection.</p>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen99326066175351">[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword16308732122211"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1687575949175351">interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword4483165419365"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b2420195811382">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword5292347222"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b15731334514">stp edged-port enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword1456141315243">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1912099260175351">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword182632146245">*</span>DeviceB] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b3659271523">stp bpdu-protection</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword193142414264">*</span>DeviceB] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b17313244264">commit</strong></pre>
<p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p795825111175351"># Configure <span>100GE</span> <span>1/0/2</span> on DeviceC as an edge port and enable BPDU protection.</p>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen1640725146175351">[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword20820133752211"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b831286639175351">interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword527091123718"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b11786011393">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword13252173972210"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b189701224115213">stp edged-port enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword1540771642418">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1099480943175351">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword105551842419">*</span>DeviceC] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b8705104212529">stp bpdu-protection</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword166701831102614">*</span>DeviceC] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b167016313262">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_step5522184771911"><span id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_cmd352234741912">Enable RSTP on each device.</span><p><p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p10242164312174">By default, STP, RSTP, or MSTP is enabled on a device. You can run the <a href="cmdqueryname=stp+enable"><b><span class="cmdname" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_cmdname19304419161616">stp enable</span></b></a> command in the system view to enable this function if it is disabled.</p>
</p></li><li id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_step106700601175351"><span id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_cmd168155762175351">Enable root protection for the designated ports <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span> on the root bridge DeviceA.</span><p><pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen1804664545175351">[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword954055342211"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b204739682175351">interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword32251132133718"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b197026233917">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword9509165632214"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b606844816175351">stp root-protection</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword12145152272417">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b422725950175351">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword13130624102417">*</span>DeviceA] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b111173090175351">interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword13398943153717">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1638763173911">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword4489825152420">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b950884851175351">stp root-protection</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword33827102410">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b318876953175351">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword17417155162714">*</span>DeviceA] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b04178512718">commit</strong></pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_example121226172748"><a name="EN-US_TASK_0000001315071130__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p612883710175351">After the spanning tree calculation is stable, verify the configuration as follows:</p>
<p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p1293596341175351"># Run the <a href="cmdqueryname=display+stp+brief"><b><span class="cmdname" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_cmdname977837974175351">display stp brief</span></b></a> command on DeviceA to check the port status and enabled protection function. The command output shows that <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span> have been elected as designated ports through spanning tree calculation and that root protection has been enabled for the designated ports.</p>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen856434783175351">[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword6948431234"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b778678919175351">display stp brief</strong>
 MSTID  Port                        Role  STP State     Protection      Cost    Edged
     0  <span>100GE</span><span>1/0/1</span>                  <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1025370142175351">DESI</strong>  forwarding    <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1106119374175351">root</strong>              2    disable
     0  <span>100GE</span><span>1/0/2</span>                  <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b2099033107175351">DESI</strong>  forwarding    <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b242186022175351">root</strong>              2    disable
</pre>
<p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p1548441694175351"># Run the <a href="cmdqueryname=display+stp+interface+brief"><b><span class="cmdname" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_cmdname491493063175351">display stp interface brief</span></b></a> command on DeviceB to check the role and status of <span>100GE</span> <span>1/0/1</span>. The command output shows that <span>100GE</span> <span>1/0/1</span> has been elected as a designated port and is in Forwarding state.</p>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen819813143175351">[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword6516146142317"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b838157789175351">display stp interface <span>100ge</span> <span>1/0/1</span> brief</strong>
 MSTID  Port                        Role  STP State     Protection      Cost    Edged
     0  <span>100GE</span><span>1/0/1</span>                  <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1634281947175351">DESI</strong>  forwarding    none              2    disable
</pre>
<p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p1772198348175351"># Run the <a href="cmdqueryname=display+stp+brief"><b><span class="cmdname" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_cmdname224882102175351">display stp brief</span></b></a> command on DeviceC to check the port role and status. The command output shows that <span>100GE</span> <span>1/0/1</span> has been elected as an alternate port and is in Discarding state. Furthermore, <span>100GE</span> <span>1/0/3</span> has been elected as a root port and is in Forwarding state.</p>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen295507335175351">[<span class="keyword" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_keyword9227991230"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b1080146528175351">display stp brief</strong>
 MSTID  Port                        Role  STP State     Protection      Cost    Edged
     0  <span>100GE</span><span>1/0/1</span>                  <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b659892689175351">ALTE</strong>  discarding    none          20000    disable
     0  <span>100GE</span><span>1/0/3</span>                  <strong id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_b531063206175351">ROOT</strong>  forwarding    none              2    disable
</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001315071130__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_ul2058518403175351"><li id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_li1251173168175351"><p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p307563152175351"><a name="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_li1251173168175351"></a><a name="en-us_task_0000001130623344_li1251173168175351"></a>DeviceA</p>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen1207487058175351">#
sysname DeviceA
#
stp mode rstp
stp instance 0 root primary
stp pathcost-standard legacy
#
interface <span>100GE</span><span>1/0/1</span>
 stp root-protection
#
interface <span>100GE</span><span>1/0/2</span>
 stp root-protection
#
return</pre>
</li><li id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_li63684164175351"><p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p892888142175351"><a name="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_li63684164175351"></a><a name="en-us_task_0000001130623344_li63684164175351"></a>DeviceB</p>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen472520662175351">#
sysname DeviceB
#
stp mode rstp
stp bpdu-protection
stp instance 0 root secondary
stp pathcost-standard legacy
#
interface <span>100GE</span><span>1/0/2</span>
 stp edged-port enable
#
return</pre>
</li><li id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_li1146506495175351"><p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p2111380581175351"><a name="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_li1146506495175351"></a><a name="en-us_task_0000001130623344_li1146506495175351"></a>DeviceC</p>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen392649025175351">#
sysname DeviceC
#
stp mode rstp
stp bpdu-protection
stp pathcost-standard legacy
#
interface <span>100GE</span><span>1/0/1</span>
 stp instance 0 cost 20000
#
interface <span>100GE</span><span>1/0/2</span>
 stp edged-port enable
#
return</pre>
</li><li id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_li2061171696175351"><p id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_p1053984915175351"><a name="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_li2061171696175351"></a><a name="en-us_task_0000001130623344_li2061171696175351"></a>DeviceD</p>
<pre class="screen" id="EN-US_TASK_0000001315071130__en-us_task_0000001130623344_screen616928478175351">#
sysname DeviceD
#
stp mode rstp
stp pathcost-standard legacy
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_stp_cfg_1077.html">Configuring STP/RSTP/MSTP
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_stp_cfg_1184.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_stp_cfg_1186.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>