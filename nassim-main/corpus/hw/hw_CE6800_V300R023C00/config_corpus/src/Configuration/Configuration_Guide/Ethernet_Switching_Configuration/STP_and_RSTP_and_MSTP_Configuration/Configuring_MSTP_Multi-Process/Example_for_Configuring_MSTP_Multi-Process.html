
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring MSTP Multi-Process">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_stp_cfg_1088.html">
<meta name="DC.Relation" scheme="URI" content="vrp_stp_cfg_1094.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="MSTP">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MSTP">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featurename" content="MSTP">
<meta name="featurename" content="RSTP">
<meta name="featurename" content="STP">
<meta name="featuretype" content="Ethernet Switching">
<meta name="featuretype" content="Ethernet Switching">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001366159869">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring MSTP Multi-Process</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001366159869"></a><a name="EN-US_TASK_0000001366159869"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring MSTP Multi-Process</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001366159869__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_context1677625172748"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p28397519416">In <a href="#EN-US_TASK_0000001366159869__en-us_task_0000001130783108_fig17195027193012">Figure 1</a>, DeviceA and DeviceB, as PE devices, are connected to CE devices, forming multiple access rings. DeviceA, CE1, and CE2 are in a ring; DeviceB, CE5, and CE6 are in another ring; DeviceA, DeviceB, CE3, and CE4 are in the third ring.</p>
<p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p16113144385919">In this case, MSTP multi-process can be deployed to allow each access ring to calculate a spanning tree independently.</p>
<div class="fignone" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_fig17195027193012"><a name="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_fig17195027193012"></a><a name="en-us_task_0000001130783108_fig17195027193012"></a><span class="figcap"><b>Figure 1 </b>Network diagram of MSTP multi-process</span><div class="note" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_note164145990214028"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p1432651182214028">In this example, interface 1, interface 2, interface 3, interface 4, and interface 5 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, <span>100GE</span> <span>1/0/3</span>, <span>100GE</span> <span>1/0/4</span>, and <span>100GE</span> <span>1/0/5</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_image2195172715309" src="figure/en-us_image_0000001176742841.png"></span></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001366159869__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_steps2116476269183240"><li id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_step175580252183240"><span id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_cmd334764386183240">Configure basic MSTP functions, add devices to an MST region, and create instances.</span><p><p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p455052410183240"># Add DeviceA to an MST region and create instances.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen1075067301183240">&lt;<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1072229196175351">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b2117262085183240">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword767623853516"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1024693813367">HUAWEI</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1939133513183240">sysname DeviceA</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword26595199374">*</span><span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword16306103810408">HUAWEI</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b182551329133713">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword289015016312"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1867347955183240">stp region-configuration</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword0993151191614"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-mst-region] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b403751424183240">region-name RG1</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1171173316332">*</span>DeviceA-mst-region] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1757121524183240">instance 1 vlan 2 to 100</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword48931535123311">*</span>DeviceA-mst-region] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b596673627183240">instance 2 vlan 101 to 200</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword16839183720332">*</span>DeviceA-mst-region] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b374980875183240">instance 3 vlan 201 to 300</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword324533917333">*</span>DeviceA-mst-region] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b598278971183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword185567193711">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b16218538143712">commit</strong></pre>
<p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p1155151855183240"># Add DeviceB to the MST region and create instances.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen2096320902183240">&lt;<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword19149154173710">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1477311395183240">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword269647113116"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword10350344193719">HUAWEI</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1528295180183240">sysname DeviceB</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1711971310397">*</span><span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword51191313163917">HUAWEI</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1011961383918">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword66158127319"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1917737903183240">stp region-configuration</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword297919129164"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-mst-region] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b175969917183240">region-name RG1</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword59541436338">*</span>DeviceB-mst-region] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1785457106183240">instance 1 vlan 2 to 100</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword74251145193310">*</span>DeviceB-mst-region] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1813639261183240">instance 2 vlan 101 to 200</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword16934124673314">*</span>DeviceB-mst-region] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b329567787183240">instance 3 vlan 201 to 300</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword364664853317">*</span>DeviceB-mst-region] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1033947646183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword12847423164110">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b98471923114116">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_step839416316322"><span id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_cmd1939418314321">Enable MSTP on DeviceA and DeviceB.</span><p><p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p175619241337">By default, STP, RSTP, or MSTP is enabled on a device. You can run the <a href="cmdqueryname=stp+enable"><b><span class="cmdname" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_cmdname19304419161616">stp enable</span></b></a> command in the system view to enable this function if it is disabled.</p>
</p></li><li id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_step1135300658183240"><span id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_cmd605955411183240">Create multiple MSTP processes on the devices and add ports to the processes.</span><p><p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p1695539549183240"># On DeviceA, create process 1 and process 2, and add <span>100GE</span> <span>1/0/3</span> and <span>100GE</span> <span>1/0/4</span> to process 1 and <span>100GE</span> <span>1/0/2</span> to process 2.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen2114673614183240">[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword129841825123115"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1783003503183240">stp process 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword157341753183318">*</span>DeviceA-mst-process-1] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b771350127183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1471115573335">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b508985404183240">stp process 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword339812599333">*</span>DeviceA-mst-process-2] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b390818732183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword782960163419">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b355160463183240">interface <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword581117422446">*</span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b12287040124716">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword17444162143417">*</span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b163320807183240">stp binding process 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword4119164163416">*</span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b2135431621183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword10850958349">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b23981127183240">interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1278615711343">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b415398522183240">stp binding process 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword45143912348">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b118435008183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword39461214340">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b813920650183240">interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword777315117446">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1627124210472">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword134221518133417">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b2114070672183240">stp binding process 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword9295172023415">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b557552059183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword422984484118">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b7229164484114">commit</strong></pre>
<p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p1228783411183240"># On DeviceB, create process 2 and process 3, and add <span>100GE</span> <span>1/0/3</span> and <span>100GE</span> <span>1/0/4</span> to process 3 and <span>100GE</span> <span>1/0/2</span> to process 2.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen2125912542183240">[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword132553133118"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1203656007183240">stp process 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword18304142310343">*</span>DeviceB-mst-process-2] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b2107158563183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword364417248345">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1957728171183240">stp process 3</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword13105261343">*</span>DeviceB-mst-process-3] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b899254708183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword194640273341">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b374073233183240">interface <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword103353592444">*</span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1910324584712">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword96081528173414">*</span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1600954934183240">stp binding process 3</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword47212303340">*</span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1556492186183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword11586931143415">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1495897565183240">interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword41819713458">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b128336454474">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword7651233153416">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1229629078183240">stp binding process 3</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword7558123433414">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1422861769183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword557903643415">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b868098662183240">interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1615222012450">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b131671647164720">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword163391338103413">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b424315383183240">stp binding process 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword151251440103413">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1468930192183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword17881114910413">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1888110495419">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_step14842751192418"><span id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_cmd784217512242">Configure a shared link.</span><p><p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p1316591151183240"># Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen1914278510183240">[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword943343510316"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b204861223183240">interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1099842520458"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1351074924710">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword141069399317"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b880862469183240">stp binding process 2 link-share</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword15211195393414">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1499496494183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword19737164184210">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b12738194184215">commit</strong></pre>
<p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p320388562183240"># Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen1700484244183240">[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword9383184112316"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b489764164183240">interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword18269193812458"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b7251251184717">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword687643143110"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b2016059996183240">stp binding process 2 link-share</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword57731357163419">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1808390394183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword83221194211">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1832151124212">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_step145874872417"><span id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_cmd8581748132412">Enable MSTP for processes.</span><p><p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p502027385183240"># Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen1739886428183240">[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1450494983117"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b771879208183240">stp process 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword126201549161613"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-mst-process-1] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1409795245183240">stp enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1385415383511">*</span>DeviceA-mst-process-1] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b702765755183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword116625512352">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1577135147183240">stp process 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword18685168173511">*</span>DeviceA-mst-process-2] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1919949361183240">stp enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword174592010143516">*</span>DeviceA-mst-process-2] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1109289468183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword18557221114216">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b15557621204214">commit</strong></pre>
<p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p67065031183240"># Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen1802797224183240">[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword887316073212"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b677746303183240">stp process 3</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1890395916164"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-mst-process-3] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1384713808183240">stp enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1779121519359">*</span>DeviceB-mst-process-3] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b89660403183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword130211710357">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1496692000183240">stp process 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword11899118133512">*</span>DeviceB-mst-process-2] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1904235320183240">stp enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword104431020203510">*</span>DeviceB-mst-process-2] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1081821086183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword9101183011425">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b10101193014217">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_step778361323183240"><span id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_cmd1595861784183240">Configure other functions.</span><p><p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p178679054183240"># On DeviceA, configure priorities and root protection.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen1182562037183240">[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1942110793219"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1479738895183240">stp process 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword172701910141812"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-mst-process-1] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1118833487183240">stp instance 0 root primary</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword9146112512359">*</span>DeviceA-mst-process-1] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b917464112183240">stp instance 1 root primary</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword117712026153510">*</span>DeviceA-mst-process-1] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b2040410221183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1634612287355">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b963670299183240">stp process 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword7938122973519">*</span>DeviceA-mst-process-2] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1644283145183240">stp instance 0 root primary</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword17435133173512">*</span>DeviceA-mst-process-2] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1197410120183240">stp instance 2 root primary</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword7560532113514">*</span>DeviceA-mst-process-2] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1121401787183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1298703413515">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1237425225183240">interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword117262019480">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b11719610114816">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword175961036143512">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1778946430183240">stp root-protection</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword410713812354">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b875860060183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1669973964212">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b116991539144218">commit</strong></pre>
<p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p32944275183240"># On DeviceB, configure priorities and root protection.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen140617676183240">[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1039121493218"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b160787238183240">stp process 3</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword9584151861817"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-mst-process-3] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1661807650183240">stp instance 0 root primary</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword17173424359">*</span>DeviceB-mst-process-3] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1727480962183240">stp instance 3 root primary</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword6644449358">*</span>DeviceB-mst-process-3] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1885052450183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1442120454359">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1796985889183240">stp process 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword81822047103512">*</span>DeviceB-mst-process-2] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1369607550183240">stp instance 0 root secondary</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1467274913513">*</span>DeviceB-mst-process-2] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b211527312183240">stp instance 2 root secondary</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword164791351103515">*</span>DeviceB-mst-process-2] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1582285962183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword14241553103518">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b261323208183240">interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1042218172483">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b0791420194817">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword17304165411356">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1670483902183240">stp root-protection</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword195931455173515">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b2131004524183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1419244124212">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b541964414421">commit</strong></pre>
<div class="note" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_note1310052689183240"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_ul2053194979183240"><li id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_li352863049183240"><p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p1366915176183240"><a name="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_li352863049183240"></a><a name="en-us_task_0000001130783108_li352863049183240"></a>In each ring, the CE devices have lower MSTP process priorities than the PE device.</p>
</li><li id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_li2093282341183240"><p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p1719200033183240"><a name="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_li2093282341183240"></a><a name="en-us_task_0000001130783108_li2093282341183240"></a>For DeviceA and DeviceB in the dual-access ring, you are recommended to configure them as the primary or a secondary root bridge in different instances.</p>
</li></ul>
</div></div>
<p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p1607213017183240"># On DeviceA, enable shared link protection for the MSTP process.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen710999718183240">[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1388692013326"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b592995272183240">stp process 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword429322920187"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-mst-process-2] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1201928055183240">stp link-share-protection</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1042719413612">*</span>DeviceA-mst-process-2] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b544439970183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword11671195594214">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b10671205510429">commit</strong></pre>
<p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p924559967183240"># On DeviceB, enable shared link protection for the MSTP process.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen139369052183240">[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword2065922512326"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1794630436183240">stp process 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword127116343185"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-mst-process-2] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1749754552183240">stp link-share-protection</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1660715843612">*</span>DeviceB-mst-process-2] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b56234052183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword20120180114310">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b101201007438">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_step1143604340183240"><span id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_cmd579501730183240">Create VLANs and add ports to the VLANs.</span><p><p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p1963588372183240"># On DeviceA, create VLANs 2 to 200, and add <span>100GE</span> <span>1/0/3</span> and <span>100GE</span> <span>1/0/4</span> to VLANs 2 to 100 and <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span> to VLANs 101 to 200.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen593823691183240">[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword14851193011327"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1849307721183240">vlan batch 2 to 200</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1865131115368">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b781614501183240">interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1472183317550">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b3141162145711">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword109035135364">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1847727401183240">port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword4713315103618">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b346166547183240">port trunk allow-pass vlan 2 to 100</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword13762171773612">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b599313536183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword163971219193614">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b998847569183240">interface <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1726564285517">*</span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1134192514571">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword9192121143619">*</span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b425138804183240">port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword14968172653610">*</span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b2091715818183240">port trunk allow-pass vlan 2 to 100</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword10722122833617">*</span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1289214926183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1146783018362">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1157227225183240">interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword866474713559">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b971162735715">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword6198132173617">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b427326075183240">port link-type trunk </strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword183183463611">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1251368643183240">port trunk allow-pass vlan 101 to 200</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword19214336103613">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1457661457183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword11012038123616">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1863514523183240">interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1525721175612">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b6553112913571">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword2251040103617">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1216632502183240">port link-type trunk </strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword460134113366">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1431640175183240">port trunk allow-pass vlan 101 to 200</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword025874313360">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1499434830183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword19880199134312">*</span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b188801916437">commit</strong></pre>
<p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p6495043183240"># On DeviceB, create VLANs 101 to 300, and add <span>100GE</span> <span>1/0/3</span> and <span>100GE</span> <span>1/0/4</span> to VLANs 201 to 300 and <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span> to VLANs 101 to 200.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen1267261786183240">[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword869954213211"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b706089350183240">vlan batch 101 to 300</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword989816496369">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1729221660183240">interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword573019915557">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b13928113312571">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword447645115363">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1183113597183240">port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1227353133616">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1405548871183240">port trunk allow-pass vlan 201 to 300</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1837211551366">*</span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1144222654183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword13882115643610">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b297482373183240">interface <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword912916127559">*</span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b279910352574">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword13582155819365">*</span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b639967421183240">port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword855610023712">*</span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b728060250183240">port trunk allow-pass vlan 201 to 300</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword530915218379">*</span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1672130497183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword15771245377">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b2013966087183240">interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword626715147562">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b35016388571">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword85711653712">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b123491733183240">port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword10691811376">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1507293039183240">port trunk allow-pass vlan 101 to 200</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1451812121378">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b807294473183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword13108161510374">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b810534529183240">interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword18308133511564">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b352993911573">portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword6153117163711">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b2008422276183240">port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword198801919203717">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b2063005828183240">port trunk allow-pass vlan 101 to 200</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword68337213379">*</span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b764872043183240">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword861719166438">*</span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b56171816114314">commit</strong></pre>
<p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p1768212255563"></p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_example121226172748"><a name="EN-US_TASK_0000001366159869__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ul id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_ul1577985326183240"><li id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_li1083218921183240"><p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p1441529628183240"><a name="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_li1083218921183240"></a><a name="en-us_task_0000001130783108_li1083218921183240"></a>Run the <a href="cmdqueryname=display+stp+interface+brief"><b><span class="cmdname" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_cmdname1739378526183240">display stp interface brief</span></b></a> command on DeviceA.</p>
<p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p1196904261183240"># <span>100GE</span> <span>1/0/4</span> is a designated port in the CIST of MSTP process 1 and in instance 1.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen238523056183240">[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword11892147103219"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b445363579183240">display stp process 1 interface <span>100ge</span> <span>1/0/4</span> brief</strong>
 MSTID      Port                    Role  STP State       Protection
   0        <span>100GE</span><span>1/0/4</span>              DESI  FORWARDING      NONE
   1        <span>100GE</span><span>1/0/4</span>              DESI  FORWARDING      NONE</pre>
<p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p563176574183240"># <span>100GE</span> <span>1/0/2</span> is a designated port in the CIST of MSTP process 2 and in instance 2.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen1885503926183240">[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword1173145233215"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b2064367869183240">display stp process 2 interface <span>100ge</span> <span>1/0/2</span> brief</strong>
 MSTID      Port                    Role  STP State       Protection
   0        <span>100GE</span><span>1/0/2</span>              DESI  FORWARDING      ROOT
   2        <span>100GE</span><span>1/0/2</span>              DESI  FORWARDING      ROOT</pre>
</li><li id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_li1223156968183240"><p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p1885692092183240"><a name="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_li1223156968183240"></a><a name="en-us_task_0000001130783108_li1223156968183240"></a>Run the <a href="cmdqueryname=display+stp+interface+brief"><b><span class="cmdname" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_cmdname1934324306183240">display stp interface brief</span></b></a> command on DeviceB.</p>
<p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p998180558183240"># <span>100GE</span> <span>1/0/4</span> is a designated port in the CIST of MSTP process 3 and in instance 3.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen1646758028183240">[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword3743175610320"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b1310227496183240">display stp process 3 interface <span>100ge</span> <span>1/0/4</span> brief</strong>
 MSTID      Port                    Role  STP State       Protection
   0        <span>100GE</span><span>1/0/4</span>              DESI  FORWARDING      NONE
   3        <span>100GE</span><span>1/0/4</span>              DESI  FORWARDING      NONE</pre>
<p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p1911540957183240"># <span>100GE</span> <span>1/0/2</span> is a designated port in the CIST of MSTP process 2 and in instance 2.</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen920951050183240">[<span class="keyword" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_keyword9339172123317"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_b225757442183240">display stp process 2 interface <span>100ge</span> <span>1/0/2</span> brief</strong>
 MSTID      Port                    Role  STP State       Protection
   0        <span>100GE</span><span>1/0/2</span>              DESI  FORWARDING      ROOT
   2        <span>100GE</span><span>1/0/2</span>              DESI  FORWARDING      ROOT</pre>
</li></ul>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001366159869__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_ul1994952794183240"><li id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_li2089049687183240"><p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p1447944606183240"><a name="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_li2089049687183240"></a><a name="en-us_task_0000001130783108_li2089049687183240"></a>DeviceA</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen1776115684183240">#
sysname DeviceA
#
vlan batch 2 to 200
#
stp region-configuration
 region-name RG1
 instance 1 vlan 2 to 100
 instance 2 vlan 101 to 200
 instance 3 vlan 201 to 300
#
stp process 1
 stp instance 0 root primary
 stp instance 1 root primary
 stp enable
stp process 2
 stp instance 0 root primary
 stp instance 2 root primary
 stp link-share-protection
 stp enable
#
interface <span>100GE</span><span>1/0/1</span>
 port link-type trunk
 port trunk allow-pass vlan 101 to 200
 stp binding process 2 link-share
#
interface <span>100GE</span><span>1/0/2</span>
 port link-type trunk
 port trunk allow-pass vlan 101 to 200
 stp binding process 2
 stp root-protection
#
interface <span>100GE</span><span>1/0/3</span>
 port link-type trunk
 port trunk allow-pass vlan 2 to 100
 stp binding process 1
#
interface <span>100GE</span><span>1/0/4</span>
 port link-type trunk
 port trunk allow-pass vlan 2 to 100
 stp binding process 1
#
return</pre>
</li><li id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_li1829328968183240"><p id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_p8591077183240"><a name="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_li1829328968183240"></a><a name="en-us_task_0000001130783108_li1829328968183240"></a>DeviceB</p>
<pre class="screen" id="EN-US_TASK_0000001366159869__en-us_task_0000001130783108_screen571977176183240">#
sysname DeviceB
#
vlan batch 101 to 300
#
stp region-configuration
 region-name RG1
 instance 1 vlan 2 to 100
 instance 2 vlan 101 to 200
 instance 3 vlan 201 to 300
#
stp process 2
 stp instance 0 root secondary
 stp instance 2 root secondary
 stp link-share-protection
 stp enable
stp process 3
 stp instance 0 root primary
 stp instance 3 root primary
 stp enable
#
interface <span>100GE</span><span>1/0/1</span>
 port link-type trunk
 port trunk allow-pass vlan 101 to 200
 stp binding process 2 link-share
#
interface <span>100GE</span><span>1/0/2</span>
 port link-type trunk
 port trunk allow-pass vlan 101 to 200
 stp binding process 2
 stp root-protection
#
interface <span>100GE</span><span>1/0/3</span>
 port link-type trunk
 port trunk allow-pass vlan 201 to 300
 stp binding process 3
#
interface <span>100GE</span><span>1/0/4</span>
 port link-type trunk
 port trunk allow-pass vlan 201 to 300
 stp binding process 3
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_stp_cfg_1088.html">Configuring MSTP Multi-Process
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_stp_cfg_1094.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>