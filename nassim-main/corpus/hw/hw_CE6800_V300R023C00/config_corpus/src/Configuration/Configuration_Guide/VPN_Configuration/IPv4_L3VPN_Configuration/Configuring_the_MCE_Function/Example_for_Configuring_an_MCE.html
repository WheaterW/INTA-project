
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring an MCE">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_L3VPNv4_cfg_0016.html">
<meta name="DC.Relation" scheme="URI" content="vrp_L3VPNv4_cfg_0023.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="IPv4 L3VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv4 L3VPN">
<meta name="featuretype" content="VPN">
<meta name="featurename" content="IPv4 L3VPN">
<meta name="featuretype" content="VPN">
<meta name="featuretype" content="VPN">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130781458">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<link rel="stylesheet" type="text/css" href="public_sys-resources/imagePopup.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/customQuery.js"></script>
<script language="javascript" type="text/javascript" src="public_sys-resources/imagePopup.js"></script>
<title>Example for Configuring an MCE</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130781458"></a><a name="EN-US_TASK_0000001130781458"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring an MCE</h1>
<div class="taskbody"><p></p>
<div class="context"><a name="EN-US_TASK_0000001130781458__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0000001130781458__fig_dc_vrp_mpls-l3vpn-v4_cfg_012201">Figure 1</a>, Site 1 and Site 2 are both connected to PE1, but the two sites need to be isolated from each other and use independent address spaces. To meet the preceding requirements and reduce costs, an MCE solution can be used.</p>
<div class="fignone" id="EN-US_TASK_0000001130781458__fig_dc_vrp_mpls-l3vpn-v4_cfg_012201"><a name="EN-US_TASK_0000001130781458__fig_dc_vrp_mpls-l3vpn-v4_cfg_012201"></a><a name="fig_dc_vrp_mpls-l3vpn-v4_cfg_012201"></a><span class="figcap"><b>Figure 1 </b>MCE networking</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1, interface 2, interface 3, and interface 4 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, <span>100GE</span> <span>1/0/3</span>, and <span>100GE</span> <span>1/0/4</span>, respectively.</p>
</div></div>
<br><span><img class="imgResize" src="figure/en-us_image_0000001130621860.png" width="307.227207" height="353.10652124999996" title="Click to enlarge"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130781458__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>Note the following during the configuration:</p>
<ul><li><p>The MCE must have multiple VPN instances configured and have a different interface bound to each VPN instance.</p>
</li><li><p>Routing loop detection must be disabled on the MCE so that the MCE exchanges routing information with the PE using the OSPF multi-VPN-instance.</p>
</li><li>Configure RIPv2 on the MCE to import VPN routes from Site 1 and Site 2.</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130781458__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure VPN instances on the MCE and PE1 and bind related interfaces to the VPN instances.</p>
</li><li><p>Configure OSPF multi-instance on the MCE and PE1 to exchange VPN routing information.</p>
</li><li><p>Configure RIPv2 on the MCE, <span class="keyword">Device</span>A, and <span class="keyword">Device</span>B to exchange VPN routes.</p>
</li><li>Disable routing loop detection on the MCE and import RIP routes destined for VPN sites.</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130781458__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure VPN instances on the MCE and PE1 and bind related interfaces to the VPN instances.</span><p><p># Configure PE1.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname PE1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>ip vpn-instance vpna</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpna] <strong>ipv4-family</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpna-af-ipv4] <strong>route-distinguisher 200:1</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpna-af-ipv4] <strong>vpn-target 111:1 both</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpna-af-ipv4] <strong>quit</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpna] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>ip vpn-instance vpnb</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpnb] <strong>ipv4-family</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpnb-af-ipv4] <strong>route-distinguisher 200:2</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpnb-af-ipv4] <strong>vpn-target 222:2 both</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpnb-af-ipv4] <strong>quit</strong>
[<span class="keyword">*</span>PE1-vpn-instance-vpnb] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>interface <span>100GE</span><span>1/0/1</span></strong>
[<span class="keyword">*</span>PE1-<span>100GE</span><span>1/0/1</span>] <strong>undo </strong><strong>portswitch</strong>
[<span class="keyword">*</span>PE1-<span>100GE</span><span>1/0/1</span>] <strong>ip binding vpn-instance vpna</strong>
[<span class="keyword">*</span>PE1-<span>100GE</span><span>1/0/1</span>] <strong>ip address 10.5.1.1 24</strong>
[<span class="keyword">*</span>PE1-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>PE1]<strong>interface <span>100GE</span><span>1/0/2</span></strong>
[<span class="keyword">*</span>PE1-<span>100GE</span><span>1/0/2</span>] <strong>undo </strong><strong>portswitch</strong>
[<span class="keyword">*</span>PE1-<span>100GE</span><span>1/0/2</span>] <strong>ip binding vpn-instance vpnb</strong>
[<span class="keyword">*</span>PE1-<span>100GE</span><span>1/0/2</span>] <strong>ip address 10.5.2.1 24</strong>
[<span class="keyword">*</span>PE1-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>commit</strong></pre>
<p># Configure an MCE.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname MCE</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>MCE] <strong>ip vpn-instance vpna</strong>
[<span class="keyword">*</span>MCE-vpn-instance-vpna] <strong>ipv4-family</strong>
[<span class="keyword">*</span>MCE-vpn-instance-vpna-af-ipv4] <strong>route-distinguisher 100:1</strong>
[<span class="keyword">*</span>MCE-vpn-instance-vpna-af-ipv4] <strong>quit</strong>
[<span class="keyword">*</span>MCE-vpn-instance-vpna] <strong>quit</strong>
[<span class="keyword">*</span>MCE] <strong>ip vpn-instance vpnb</strong>
[<span class="keyword">*</span>MCE-vpn-instance-vpnb] <strong>ipv4-family</strong>
[<span class="keyword">*</span>MCE-vpn-instance-vpnb-af-ipv4] <strong>route-distinguisher 100:2</strong>
[<span class="keyword">*</span>MCE-vpn-instance-vpnb-af-ipv4] <strong>quit</strong>
[<span class="keyword">*</span>MCE-vpn-instance-vpnb] <strong>quit</strong>
[<span class="keyword">*</span>MCE] <strong>interface <span>100GE</span><span>1/0/1</span></strong>
[<span class="keyword">*</span>MCE-<span>100GE</span><span>1/0/1</span>] <strong>undo </strong><strong>portswitch</strong>
[<span class="keyword">*</span>MCE-<span>100GE</span><span>1/0/1</span>] <strong>ip binding vpn-instance vpna</strong>
[<span class="keyword">*</span>MCE-<span>100GE</span><span>1/0/1</span>] <strong>ip address 10.5.1.2 24</strong>
[<span class="keyword">*</span>MCE-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>MCE] <strong>interface <span>100GE</span><span>1/0/2</span></strong>
[<span class="keyword">*</span>MCE-<span>100GE</span><span>1/0/2</span>] <strong>undo </strong><strong>portswitch</strong>
[<span class="keyword">*</span>MCE-<span>100GE</span><span>1/0/2</span>] <strong>ip binding vpn-instance vpnb</strong>
[<span class="keyword">*</span>MCE-<span>100GE</span><span>1/0/2</span>] <strong>ip</strong> <strong>address 10.5.2.2 24</strong>
[<span class="keyword">*</span>MCE-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>MCE] <strong>interface <span>100GE</span><span>1/0/3</span></strong>
[<span class="keyword">*</span>MCE-<span>100GE</span><span>1/0/3</span>] <strong>undo </strong><strong>portswitch</strong>
[<span class="keyword">*</span>MCE-<span>100GE</span><span>1/0/3</span>] <strong>ip binding vpn-instance vpna</strong>
[<span class="keyword">*</span>MCE-<span>100GE</span><span>1/0/3</span>] <strong>ip address 10.3.1.2 24</strong>
[<span class="keyword">*</span>MCE-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword">*</span>MCE] <strong>interface <span>100GE</span><span>1/0/4</span></strong>
[<span class="keyword">*</span>MCE-<span>100GE</span><span>1/0/4</span>] <strong>undo </strong><strong>portswitch</strong>
[<span class="keyword">*</span>MCE-<span>100GE</span><span>1/0/4</span>] <strong>ip binding vpn-instance vpnb</strong>
[<span class="keyword">*</span>MCE-<span>100GE</span><span>1/0/4</span>] <strong>ip address 10.4.1.2 24</strong>
[<span class="keyword">*</span>MCE-<span>100GE</span><span>1/0/4</span>] <strong>quit</strong>
[<span class="keyword">*</span>MCE] <strong>commit</strong></pre>
</p></li><li><span>Configure OSPF multi-instance between PE1 and the MCE.</span><p><p># Configure PE1.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>PE1] <strong>ospf 100 vpn-instance vpna</strong>
[<span class="keyword">*</span>PE1-ospf-100] <strong>area 0</strong>
[<span class="keyword">*</span>PE1-ospf-100-area-0.0.0.0] <strong>network 10.5.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>PE1-ospf-100-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span>PE1-ospf-100] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>ospf 200 vpn-instance vpnb</strong>
[<span class="keyword">*</span>PE1-ospf-200] <strong>area 0</strong>
[<span class="keyword">*</span>PE1-ospf-200-area-0.0.0.0] <strong>network 10.5.2.0 0.0.0.255</strong>
[<span class="keyword">*</span>PE1-ospf-200-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span>PE1-ospf-200] <strong>quit</strong>
[<span class="keyword">*</span>PE1] <strong>comm</strong><strong>it</strong></pre>
<p># Configure the MCE.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>MCE]<strong> ospf 100 vpn-instance vpna</strong>
[<span class="keyword">*</span>MCE-ospf-100]<strong> area 0</strong>
[<span class="keyword">*</span>MCE-ospf-100-area-0.0.0.0]<strong> network 10.5.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>MCE-ospf-100-area-0.0.0.0]<strong> quit</strong>
[<span class="keyword">*</span>MCE-ospf-100] <strong>quit</strong>
[<span class="keyword">*</span>MCE] <strong>ospf 200 vpn-instance vpnb</strong>
[<span class="keyword"><span class="keyword">*</span></span>MCE-ospf-200] <strong>area 0</strong>
[<span class="keyword">*</span>MCE-ospf-200-area-0.0.0.0] <strong>network 10.5.2.0 0.0.0.255</strong>
[<span class="keyword">*</span>MCE-ospf-200-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span>MCE-ospf-200] <strong>quit</strong>
[<span class="keyword">*</span>MCE] <strong>commit</strong></pre>
</p></li><li><span>Configure RIPv2 on the MCE to import VPN routes from Site 1 and Site 2.</span><p><p># Configure the MCE.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>MCE] <strong>rip 100 vpn-instance vpna</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>MCE-rip-100] <strong>version 2</strong>
[<span class="keyword">*</span>MCE-rip-100] <strong>network 10.0.0.0</strong>
[<span class="keyword">*</span>MCE-rip-100] <strong>import-route ospf 100</strong>
[<span class="keyword">*</span>MCE-rip-100] <strong>quit</strong>
[<span class="keyword">*</span>MCE]<strong> rip 200 vpn-instance vpnb</strong>
[<span class="keyword">*</span>MCE-rip-200] <strong>version 2</strong>
[<span class="keyword">*</span>MCE-rip-200] <strong>network 10.0.0.0</strong>
[<span class="keyword">*</span>MCE-rip-200] <strong>import-route ospf 200</strong>
[<span class="keyword">*</span>MCE-rip-200] <strong>quit</strong>
[<span class="keyword">*</span>MCE] <strong>commit</strong></pre>
</p><p><p># Configure <span class="keyword">Device</span>A.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>A</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A]<strong> </strong><strong>interface <span>100GE</span><span>1/0/1</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong>undo </strong><strong>portswitch</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong>ip address 10.3.1.1 24</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A]<strong> </strong><strong>interface Loopback1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-Loopback1] <strong>ip address 3.3.3.3 32</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-Loopback1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>rip 100</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-rip-100] <strong>version 2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-rip-100] <strong>network 10.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-rip-100] <strong>network 3.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-rip-100] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
<p># Configure <span class="keyword">Device</span>B.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>B</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>B]<strong> </strong><strong>interface <span>100GE</span><span>1/0/1</span></strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-<span>100GE</span><span>1/0/1</span>] <strong>undo </strong><strong>portswitch</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-<span>100GE</span><span>1/0/1</span>] <strong>ip address 10.4.1.1 24</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B]<strong> </strong><strong>interface Loopback1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-Loopback1] <strong>ip address 4.4.4.4 32</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-Loopback1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>rip 200</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-rip-200]<strong> version 2</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-rip-200] <strong>network 10.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-rip-200] <strong>network 4.0.0.0</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B-rip-200] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>B] <strong>comm</strong><strong>it</strong></pre>
</p></li><li><span>Disable routing loop detection on the MCE and import RIP routes destined for VPN sites.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>MCE] <strong>ospf 100 vpn-instance vpna</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>MCE-ospf-100] <strong>vpn-instance-capability simple</strong>
[<span class="keyword">*</span>MCE-ospf-100] <strong>import-route rip 100</strong>
[<span class="keyword">*</span>MCE-ospf-100] <strong>quit</strong>
[<span class="keyword">*</span>MCE] <strong>ospf 200 vpn-instance vpnb</strong>
[<span class="keyword">*</span>MCE-ospf-200] <strong>vpn-instance-capability simple</strong>
[<span class="keyword">*</span>MCE-ospf-200] <strong>import-route rip 200</strong>
[<span class="keyword">*</span>MCE-ospf-200] <strong>quit</strong>
[<span class="keyword">*</span>MCE] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001130781458__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After the configuration is complete, run the <strong>display ip routing-table</strong> <strong>vpn-instance</strong> command on the MCE to check the routing information of the VPN instances.</p>
<p>The following uses the routing table of the VPN instance named <strong>vpna</strong> as an example.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>MCE] <strong>display ip routing-table vpn-instance vpna</strong>
Proto: Protocol        Pre: Preference
<span class="keyword">Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route</span>
------------------------------------------------------------------------------
Routing Table : vpna
         Destinations : 9       Routes : 9

Destination/Mask    Proto  Pre  Cost        Flags NextHop         Interface

       10.3.1.0/24  Direct 0    0             D  10.3.1.2        <span>100GE</span><span>1/0/3</span>
       10.3.1.2/32  Direct 0    0             D  127.0.0.1       <span>100GE</span><span>1/0/3</span>
     10.3.1.255/32  Direct 0    0             D  127.0.0.1       <span>100GE</span><span>1/0/3</span>
        3.3.3.3/32  RIP    100  1             D  10.3.1.1        <span>100GE</span><span>1/0/3</span>
       10.5.1.0/24  Direct 0    0             D  10.5.1.2        <span>100GE</span><span>1/0/1</span>
       10.5.1.1/32  Direct 0    0             D  10.5.1.1        <span>100GE</span><span>1/0/1</span>
       10.5.1.2/32  Direct 0    0             D  127.0.0.1       <span>100GE</span><span>1/0/1</span>
     10.5.1.255/32  Direct 0    0             D  127.0.0.1       <span>100GE</span><span>1/0/1</span>
255.255.255.255/32  Direct 0    0             D  127.0.0.1       InLoopBack0</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001130781458__1.4.6"></a><a name="1.4.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>PE1</p>
<pre class="screen">#
sysname PE1
#
ip vpn-instance vpna
 ipv4-family
  route-distinguisher 200:1
  vpn-target 111:1 export-extcommunity
  vpn-target 111:1 import-extcommunity
#
ip vpn-instance vpnb
 ipv4-family
  route-distinguisher 200:2
  vpn-target 222:2 export-extcommunity
  vpn-target 222:2 import-extcommunity
#
interface <span>100GE</span><span>1/0/1</span>
<strong> </strong>undo portswitch
 ip binding vpn-instance vpna
 ip address 10.5.1.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
<strong> </strong>undo portswitch
 ip binding vpn-instance vpnb
 ip address 10.5.2.1 255.255.255.0
#
interface LoopBack1
 ip address 2.2.2.2 255.255.255.255
#
ospf 100 vpn-instance vpna
 area 0.0.0.0
  network 10.5.1.0 0.0.0.255
#
ospf 200 vpn-instance vpnb
 area 0.0.0.0
  network 10.5.2.0 0.0.0.255
#
return</pre>
</li><li><p>MCE</p>
<pre class="screen">#
sysname MCE
#
ip vpn-instance vpna
 ipv4-family
  route-distinguisher 100:1
#
ip vpn-instance vpnb
 ipv4-family
  route-distinguisher 100:2
#
interface <span>100GE</span><span>1/0/1</span>
<strong> </strong>undo portswitch
 ip binding vpn-instance vpna
 ip address 10.5.1.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
<strong> </strong>undo portswitch
 ip binding vpn-instance vpnb
 ip address 10.5.2.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/3</span>
<strong> </strong>undo portswitch
 ip binding vpn-instance vpna
 ip address 10.3.1.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/4</span>
<strong> </strong>undo portswitch
 ip binding vpn-instance vpnb
 ip address 10.4.1.2 255.255.255.0
#
ospf 100 vpn-instance vpna
 import-route rip 100
 vpn-instance-capability simple
 area 0.0.0.0
  network 10.3.1.0 0.0.0.255
  network 10.5.1.0 0.0.0.255
#
ospf 200 vpn-instance vpnb
 import-route rip 200
 vpn-instance-capability simple
 area 0.0.0.0
  network 10.4.1.0 0.0.0.255
  network 10.5.2.0 0.0.0.255
#
rip 100 vpn-instance vpna
 version 2
 network 10.0.0.0
 import-route ospf 100
#
rip 200 vpn-instance vpnb
 version 2
 network 10.0.0.0
 import-route ospf 200
#
return</pre>
</li><li><p><span class="keyword">Device</span>A</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>A
#
interface <span>100GE</span><span>1/0/1</span>
<strong> </strong>undo portswitch
 ip address 10.3.1.1 255.255.255.0
#
interface LoopBack1
 ip address 3.3.3.3 255.255.255.255
#
rip 100
 version 2
 network 10.0.0.0
 network 3.0.0.0
#
return</pre>
</li><li><p><span class="keyword">Device</span>B</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>B
#
interface <span>100GE</span><span>1/0/1</span>
<strong> </strong>undo portswitch
 ip address 10.4.1.1 255.255.255.0
#
interface LoopBack1
 ip address 4.4.4.4 255.255.255.255
#
rip 200
 version 2
 network 10.0.0.0
 network 4.0.0.0
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_L3VPNv4_cfg_0016.html">Configuring the MCE Function
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_L3VPNv4_cfg_0023.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>

<script language="JavaScript">
<!--
initImageViewer('.imgResize');
var msg_imageMax = "view original image";
var msg_imageClose = "close";
//--></script></body>
</html>