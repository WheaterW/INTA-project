
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a Device to Permanently Advertise IPv4 Static Routes">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_ipv4-static-route_cfg_0001.html">
<meta name="DC.Relation" scheme="URI" content="vrp_ipv4-static-route_cfg_0020.html">
<meta name="DC.Relation" scheme="URI" content="vrp_ipv4-static-route_cfg_0022.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="IPv4 Static Route">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv4 Static Route">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130622968">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring a Device to Permanently Advertise IPv4 Static Routes</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130622968"></a><a name="EN-US_TASK_0000001130622968"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a Device to Permanently Advertise IPv4 Static Routes</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001130622968__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>In existing static route implementation, if a static route-related link fails, the static route is withdrawn from the routing table, routes are re-converged, and traffic is switched to another path. Permanent advertisement for static routes is designed to lock traffic to a specific path even if a link failure occurs.</p>
<p>After the permanent advertisement attribute is configured for IPv4 static routes, static routes that have not been advertised before the function is enabled are advertised to the routing table and participate in route selection. Specifically, the following two cases may be included:</p>
<ul><li><p>An outbound interface is specified for a static route and assigned an IP address. In this situation, once permanent advertisement is enabled, the static route is advertised to the routing table, regardless of whether the outbound interface is up.</p>
</li><li><p>No outbound interface is specified for a static route. In this situation, once permanent advertisement is enabled, the static route is advertised to the routing table, no matter whether the static route can obtain an outbound interface in route recursion.</p>
</li></ul>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>After permanent advertisement is enabled, static routes are retained in the IP routing table, regardless of route reachability. If the actual path is unreachable, traffic may be lost.</p>
</div></div>
<div class="fignone" id="EN-US_TASK_0000001130622968__fig1889612327416"><a name="EN-US_TASK_0000001130622968__fig1889612327416"></a><a name="fig1889612327416"></a><span class="figcap"><b>Figure 1 </b>Network diagram of permanent advertisement for IPv4 static routes</span><br><span><img class="vsd" src="figure/en-us_image_0000001176662541.png" width="NaN" height="NaN"></span></div>
<p>On the network shown in <a href="#EN-US_TASK_0000001130622968__fig1889612327416">Figure 1</a>, DeviceA, DeviceB, and DeviceC belong to network 1, network 2, and network 3, respectively. There are two links (link A and link B) between DeviceA and DeviceB. Network 1 requires that service traffic be forwarded directly to network 2 along link A, without passing through network 3.</p>
<p>A single-hop External Border Gateway Protocol (EBGP) peer relationship needs to be established between DeviceA and DeviceB. On DeviceA, a static route is configured, with the destination address set to the BGP peer DeviceB's address and the outbound interface set to a local interface directly connected to DeviceB.</p>
<p>Traffic is forwarded along link A. If permanent advertisement for static routes is not configured and link A fails, the dynamic routing protocol automatically calculates a route over link B and switches traffic to link B.</p>
<p>If permanent advertisement for static routes is configured, traffic is forwarded through link A, regardless of whether link A is reachable. If link A fails, traffic fails to be forwarded. You can ping the destination address carried in a static route to check the reachability of the static route.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130622968__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Configure an IPv4 static route and enable permanent advertisement for it.</span><p><p>Configure a public-network IPv4 static route and enable permanent advertisement for it.</p>
</p><p><pre class="screen"><a href="cmdqueryname=ip+route-static"><b><span class="cmdname">ip route-static</span></b></a> <i><span class="varname">ip-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> }{ <i><span class="varname">nexthop-address</span></i> | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> <i><span class="varname">nexthop-address</span></i> } <strong><span>permanent</span></strong>
<a href="cmdqueryname=ip+route-static"><b><span class="cmdname">ip route-static</span></b></a> <i><span class="varname">ip-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> <i><span class="varname">nexthop-address</span></i> <strong><span>permanent</span></strong></pre>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The CE6885-LL in low latency mode does not support <a href="cmdqueryname=ip+route-static"><b><span class="cmdname">ip route-static</span></b></a> <i><span class="varname">ip-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } { <i><span class="varname">nexthop-address</span></i> | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> <i><span class="varname">nexthop-address</span></i>  } <strong><span>permanent</span></strong>.</p>
</div></div>
<p>Configure an IPv4 static route in a VPN instance and enable permanent advertisement for it.</p>
<pre class="screen"><a href="cmdqueryname=ip+route-static+vpn-instance"><b><span class="cmdname">ip route-static vpn-instance</span></b></a> <i><span class="varname">vpn-source-name</span></i> <i><span class="varname">destination-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } <span>{ <i><span class="varname">interface-name</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> }</span> <i><span class="varname">nexthop-address</span></i> <strong><span>permanent</span></strong>
<a href="cmdqueryname=ip+route-static+vpn-instance"><b><span class="cmdname">ip route-static vpn-instance</span></b></a> <i><span class="varname">vpn-source-name</span></i> <i><span class="varname">destination-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } <strong><strong><span>vpn-instance</span></strong></strong><em> <i><span class="varname">vpn-destination-name</span></i> <i><span class="varname">nexthop-address </span></i></em><strong><span>permanent</span></strong>
<a href="cmdqueryname=ip+route-static+vpn-instance"><b><span class="cmdname">ip route-static vpn-instance</span></b></a> <i><span class="varname">vpn-source-name</span></i> <i><span class="varname">destination-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } <i><span class="varname">nexthop-address </span></i><span><strong><span>permanent</span></strong></span></pre>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The CE6885-LL in low latency mode does not support <a href="cmdqueryname=ip+route-static+vpn-instance"><b><span class="cmdname">ip route-static vpn-instance</span></b></a> <i><span class="varname">vpn-source-name</span></i> <i><span class="varname">destination-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } <span>{ <i><span class="varname">interface-name</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> }</span> <i><span class="varname">nexthop-address</span></i> <strong><span>permanent</span></strong>, <a href="cmdqueryname=ip+route-static+vpn-instance"><b><span class="cmdname">ip route-static vpn-instance</span></b></a> <i><span class="varname">vpn-source-name</span></i> <i><span class="varname">destination-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } <strong><strong><span>vpn-instance</span></strong></strong><em> <i><span class="varname">vpn-destination-name</span></i> <i><span class="varname">nexthop-address </span></i></em><strong><span>permanent</span></strong>, or <a href="cmdqueryname=ip+route-static+vpn-instance"><b><span class="cmdname">ip route-static vpn-instance</span></b></a> <i><span class="varname">vpn-source-name</span></i> <i><span class="varname">destination-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> } <i><span class="varname">nexthop-address </span></i><span><strong><span>permanent</span></strong></span>.</p>
</div></div>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001130622968__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001130622968__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001130622968__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <a href="cmdqueryname=display+ip+routing-table"><b><span class="cmdname">display ip routing-table</span></b></a> command to check information about routes with permanent advertisement enabled in the IPv4 routing table.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_ipv4-static-route_cfg_0001.html">IPv4 Static Route Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_ipv4-static-route_cfg_0020.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_ipv4-static-route_cfg_0022.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>