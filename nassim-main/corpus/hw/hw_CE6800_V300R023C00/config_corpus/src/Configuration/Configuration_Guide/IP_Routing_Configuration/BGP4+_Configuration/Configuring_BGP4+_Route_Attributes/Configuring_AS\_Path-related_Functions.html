
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring AS_Path-related Functions">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp6_cfg_0013.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp6_cfg_0018.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp6_cfg_0020.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP4+">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP4+">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP4+">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176741869">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring AS_Path-related Functions</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176741869"></a><a name="EN-US_TASK_0000001176741869"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring AS_Path-related Functions</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176741869__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>The AS_Path attribute is used to prevent routing loops and control route selection.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176741869__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the BGP view.</span><p><pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></pre>
</p></li><li><span>Configure AS_Path-related functions in the BGP view. For details, see <a href="#EN-US_TASK_0000001176741869__table243015269237">Table 1</a>.</span><p>
<div class="tableBorder"><a name="EN-US_TASK_0000001176741869__table243015269237"></a><a name="table243015269237"></a><table cellpadding="4" cellspacing="0" summary="" id="EN-US_TASK_0000001176741869__table243015269237" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Configuring AS_Path-related functions in the BGP view</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="24.462446244624463%" id="mcps1.3.2.3.2.1.2.4.1.1" liSelected="liSelected"><p>Operation</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="38.00380038003801%" id="mcps1.3.2.3.2.1.2.4.1.2" liSelected="liSelected"><p>Command</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="37.53375337533754%" id="mcps1.3.2.3.2.1.2.4.1.3" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="24.462446244624463%" headers="mcps1.3.2.3.2.1.2.4.1.1 "><p>Set the maximum quantity of AS numbers allowed in the AS_Path attribute.</p>
</td>
<td class="cellrowborder" valign="top" width="38.00380038003801%" headers="mcps1.3.2.3.2.1.2.4.1.2 "><p><a href="cmdqueryname=as-path-limit"><b><span class="cmdname">as-path-limit</span></b></a> <i><span class="varname">limit</span></i></p>
</td>
<td class="cellrowborder" valign="top" width="37.53375337533754%" headers="mcps1.3.2.3.2.1.2.4.1.3 "><p>By default, a maximum of 255 AS numbers are allowed in the AS_Path attribute.</p>
<p>After the <a href="cmdqueryname=as-path-limit"><b><span class="cmdname">as-path-limit</span></b></a> command is run, the device checks whether the quantity of AS numbers in the AS_Path attribute of each received route exceeds the maximum value, and discards the route if this is the case. As such, if the maximum value is set too low, routes may be discarded.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="24.462446244624463%" headers="mcps1.3.2.3.2.1.2.4.1.1 "><p>Disable the device from checking the first AS number in the AS_Path attribute of each Update message received from an EBGP peer.</p>
</td>
<td class="cellrowborder" valign="top" width="38.00380038003801%" headers="mcps1.3.2.3.2.1.2.4.1.2 "><p><a href="cmdqueryname=undo+check-first-as"><b><span class="cmdname">undo check-first-as</span></b></a></p>
</td>
<td class="cellrowborder" valign="top" width="37.53375337533754%" headers="mcps1.3.2.3.2.1.2.4.1.3 "><p>By default, BGP4+ checks whether the first AS number in the AS_Path attribute of an Update message received from an EBGP peer is the same as the number of the AS where the EBGP peer resides. If they are different, the Update message is rejected.</p>
<div class="notice"><span class="noticetitle"> NOTICE: </span><div class="noticebody"><p>Exercise caution when running the <a href="cmdqueryname=undo+check-first-as"><b><span class="cmdname">undo check-first-as</span></b></a> command, as use of this command may result in routing loops.</p>
<p>After the configuration is modified, you can run the <a href="cmdqueryname=refresh+bgp+ipv6"><b><span class="cmdname">refresh bgp ipv6</span></b></a> command for the new configuration to take effect immediately.</p>
</div></div>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="24.462446244624463%" headers="mcps1.3.2.3.2.1.2.4.1.1 "><p>Enable BGP4+ to check, or disable BGP4+ from checking, the first AS number in the AS_Path attribute of each Update message received from a specified EBGP peer or peer group.</p>
</td>
<td class="cellrowborder" valign="top" width="38.00380038003801%" headers="mcps1.3.2.3.2.1.2.4.1.2 "><p><a href="cmdqueryname=peer+check-first-as+enable+disable"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">group-name</span></i> | <i><span class="varname">ipv6-address</span></i> } <strong><span>check-first-as</span></strong> { <strong><span>enable</span></strong> | <strong><span>disable</span></strong> }</p>
</td>
<td class="cellrowborder" valign="top" width="37.53375337533754%" headers="mcps1.3.2.3.2.1.2.4.1.3 "><p>If the <a href="cmdqueryname=peer+check-first-as"><b><span class="cmdname">peer check-first-as enable</span></b></a> command is run, BGP4+ checks whether the first AS number in the AS_Path attribute of each Update message received from the specified EBGP peer or peer group is the same as the number of the AS where the EBGP peer or peer group resides. The two AS numbers must be the same. If the AS numbers are different, the Update message is rejected. If the <a href="cmdqueryname=peer+check-first-as+disable"><b><span class="cmdname">peer check-first-as disable</span></b></a> command is run, BGP4+ accepts Update messages received from the specified EBGP peer or peer group, regardless of whether the two AS numbers are the same. If the undo command is run, the related configuration for the specified EBGP peer or peer group is deleted, and the default configuration is used.</p>
<p>The check on the first AS number in the AS_Path attribute of each received Update message can be configured for a specified EBGP peer, the peer group that the EBGP peer belongs to, or the entire BGP process. The configuration takes effect in descending order of priority as follows: EBGP peer &gt; peer group &gt; entire BGP process.</p>
<p>After the configuration is modified, you can run the <a href="cmdqueryname=refresh+bgp+ipv6"><b><span class="cmdname">refresh bgp ipv6</span></b></a> command for the new configuration to take effect immediately.</p>
</td>
</tr>
</tbody>
</table>
</div>
</p></li><li><span>Enter the IPv6 unicast address family view.</span><p><pre class="screen"><a href="cmdqueryname=ipv6-family+unicast"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>unicast</span></strong></pre>
</p></li><li><span>Configure AS_Path-related functions. For details, see <a href="#EN-US_TASK_0000001176741869__table208316358116">Table 2</a>.</span><p>
<div class="tableBorder"><a name="EN-US_TASK_0000001176741869__table208316358116"></a><a name="table208316358116"></a><table cellpadding="4" cellspacing="0" summary="" id="EN-US_TASK_0000001176741869__table208316358116" frame="border" border="1" rules="all"><caption><b>Table 2 </b>Configuring AS_Path-related functions in the BGP-IPv6 unicast address family view</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="19.221922192219225%" id="mcps1.3.2.5.2.1.2.4.1.1" liSelected="liSelected"><p>Operation</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="43.24432443244324%" id="mcps1.3.2.5.2.1.2.4.1.2" liSelected="liSelected"><p>Command</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="37.53375337533754%" id="mcps1.3.2.5.2.1.2.4.1.3" liSelected="liSelected"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="19.221922192219225%" headers="mcps1.3.2.5.2.1.2.4.1.1 "><p>Allow repetition of the local AS number.</p>
</td>
<td class="cellrowborder" valign="top" width="43.24432443244324%" headers="mcps1.3.2.5.2.1.2.4.1.2 "><p><a href="cmdqueryname=peer+allow-as-loop"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> | <i><span class="varname">ipv4-address</span></i> } <strong><span>allow-as-loop</span></strong> [ <i><span class="varname">number</span></i> ]</p>
</td>
<td class="cellrowborder" valign="top" width="37.53375337533754%" headers="mcps1.3.2.5.2.1.2.4.1.3 "><p>Generally, BGP4+ checks the AS_Path attribute of each route received from a peer. If the local AS number is carried in a route, BGP4+ discards this route to prevent routing loops.</p>
<p>However, you can use this command in some special applications to allow the AS_Path attribute of a route received from a peer to contain the local AS number. You can also set a limit on the number of repetitions for the local AS number.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.221922192219225%" headers="mcps1.3.2.5.2.1.2.4.1.1 "><p>Disable the device from comparing AS_Path attributes during route selection.</p>
</td>
<td class="cellrowborder" valign="top" width="43.24432443244324%" headers="mcps1.3.2.5.2.1.2.4.1.2 "><p><a href="cmdqueryname=bestroute+as-path-ignore"><b><span class="cmdname">bestroute as-path-ignore</span></b></a></p>
</td>
<td class="cellrowborder" valign="top" width="37.53375337533754%" headers="mcps1.3.2.5.2.1.2.4.1.3 "><p>-</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.221922192219225%" headers="mcps1.3.2.5.2.1.2.4.1.1 "><p>Configure the AS_Path attribute to carry only public AS numbers in the BGP Update messages to be sent.</p>
</td>
<td class="cellrowborder" valign="top" width="43.24432443244324%" headers="mcps1.3.2.5.2.1.2.4.1.2 "><p><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> | <i><span class="varname">ipv4-address</span></i> } <a href="cmdqueryname=public-as-only+force+replace+include-peer-as+limited+replace"><b><span class="cmdname">public-as-only</span></b></a><span> [ <strong><span>force</span></strong></span><span> [ <strong><span>replace</span></strong> ] [ <strong><span>include-peer-as</span></strong> ] | <strong><span>limited</span></strong> [ <strong><span>replace</span></strong> ] [ <strong><span>include-peer-as</span></strong> ]</span><span> ]</span></p>
</td>
<td class="cellrowborder" valign="top" width="37.53375337533754%" headers="mcps1.3.2.5.2.1.2.4.1.3 "><p>Generally, AS numbers range from 1 to 4294967295, including public AS numbers, private AS numbers, and reserved AS numbers. Private AS numbers range from 64512 to 65534 and from 4200000000 to 4294967294. The AS numbers 65535 and 4294967295 are reserved for special applications. Other AS numbers are public AS numbers.</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>If the 4-byte private AS number capability is disabled using the <a href="cmdqueryname=private-4-byte-as+disable"><b><span class="cmdname">private-4-byte-as disable</span></b></a> command, private AS numbers range from 64512 to 65534; the AS number 65535 is reserved, and others are public AS numbers.</p>
</div></div>
<p>Public AS numbers can be used on the Internet, and are assigned and managed by the Internet Assigned Number Authority (IANA). Private AS numbers cannot be advertised to the Internet, and are used only within ASs.</p>
<p>Generally, BGP4+ routes to be advertised to peers carry either public or private AS numbers, or both. In certain cases, private AS numbers do not need to be advertised. To ensure this, run this command.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.221922192219225%" headers="mcps1.3.2.5.2.1.2.4.1.1 "><p>Configure the device to accept the BGP Update messages in which the AS_Path attribute carries only public AS numbers.</p>
</td>
<td class="cellrowborder" valign="top" width="43.24432443244324%" headers="mcps1.3.2.5.2.1.2.4.1.2 "><p><a href="cmdqueryname=peer+public-as-only+import+force"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">peerIpv6Addr</span></i> | <i><span class="varname">peerGroupName</span></i> | <i><span class="varname">peerIpv4Addr</span></i> }  <strong><span>public-as-only</span></strong> <strong><span>import</span></strong><span> [ <strong><span>force</span></strong></span> ]</p>
</td>
<td class="cellrowborder" valign="top" width="37.53375337533754%" headers="mcps1.3.2.5.2.1.2.4.1.3 "><p>-</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.221922192219225%" headers="mcps1.3.2.5.2.1.2.4.1.1 "><p>Substitute the AS numbers in the AS_Path attribute.</p>
</td>
<td class="cellrowborder" valign="top" width="43.24432443244324%" headers="mcps1.3.2.5.2.1.2.4.1.2 "><p><strong>peer</strong> { <em>ipv4-address</em> | <em>ipv6-address</em> | <em>group-name</em> } <strong>substitute-as</strong></p>
</td>
<td class="cellrowborder" valign="top" width="37.53375337533754%" headers="mcps1.3.2.5.2.1.2.4.1.3 "><p>-</p>
</td>
</tr>
</tbody>
</table>
</div>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001176741869__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001176741869__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_bgp6_cfg_0013.html">Configuring BGP4+ Route Attributes
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_bgp6_cfg_0018.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_bgp6_cfg_0020.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>