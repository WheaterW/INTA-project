
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Export of UDP Flow Analysis Results">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_traffic-analysis_cfg_0015.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_traffic-analysis_cfg_0024.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Intelligent Traffic Analysis">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Intelligent Traffic Analysis">
<meta name="featuretype" content="System Monitoring">
<meta name="featurename" content="Intelligent Traffic Analysis">
<meta name="featuretype" content="System Monitoring">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001512853440">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Export of UDP Flow Analysis Results</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001512853440"></a><a name="EN-US_TASK_0000001512853440"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Export of UDP Flow Analysis Results</h1>
<div class="taskbody"><p></p>
<div class="context"><a name="EN-US_TASK_0000001512853440__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0000001512853440__fig_dc_cfg_traffic-analysis_001501">Figure 1</a>, the client with the IP address 10.1.1.1 sends UDP packets to the server with the IP address 10.1.2.1 and UDP port number 3300. <span class="keyword">Device</span>A on the path can be configured with intelligent traffic analysis for the UDP flow to analyze the flow and export the flow analysis results to the FabricInsight analyzer.</p>
<div class="fignone" id="EN-US_TASK_0000001512853440__fig_dc_cfg_traffic-analysis_001501"><a name="EN-US_TASK_0000001512853440__fig_dc_cfg_traffic-analysis_001501"></a><a name="fig_dc_cfg_traffic-analysis_001501"></a><span class="figcap"><b>Figure 1 </b>Network diagram of intelligent traffic analysis for UDP flows</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, and <span>100GE</span> <span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001564013217.png"></span></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001512853440__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure an advanced ACL rule.</span><p><p># Configure an advanced ACL rule to match the UDP flow transmitted between the client with the IP address 10.1.1.1 and the server with the IP address 10.1.2.1 and port number 3300.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>A</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>acl number 3055</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-acl4-advance-3055] <strong>rule 4 permit udp source 10.1.1.1 0.0.0.0 destination 10.1.2.1 0.0.0.0 destination-port eq 3300 </strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-acl4-advance-3055] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</p></li><li><span>Enable intelligent traffic analysis for the UDP flow.</span><p><p># Configure a traffic classifier.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic classifier c1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-classifier-c1] <strong>if-match acl 3055</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-classifier-c1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
<p># Enable intelligent traffic analysis for the UDP flow on <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic behavior b1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-behavior-b1] <strong>traffic-analysis enable</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-behavior-b1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</p><p><p># Configure a traffic policy.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic policy p1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-trafficpolicy-p1] <strong>classifier c1 behavior b1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A-trafficpolicy-p1] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
<p># Apply the traffic policy globally.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic-policy p1 global inbound</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
<p># Set the number of blocks in the UDP flow to be intelligently analyzed to 128 on <span class="keyword">Device</span>A.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic-analysis udp identification block 128</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</p></li><li><span>Configure UDP flow aging.</span><p><p># Set the inactive flow aging time to 100 seconds.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic-analysis udp timeout inactive 100</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</p></li><li><span>Configure export of UDP flow analysis results.</span><p><p># Set the source IP address to 10.1.3.1, destination IP address to 10.1.3.2, and destination port number to 6000 for the exported packets carrying UDP flow analysis results.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>traffic-analysis udp export source ip 10.1.3.1</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>traffic-analysis udp export host ip 10.1.3.2 6000</strong>
[<span class="keyword">*</span><span class="keyword">Device</span>A] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001512853440__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Display detailed information about intelligent traffic analysis results of UDP flows.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">Device</span>A] <strong>display traffic-analysis udp cache slot 1</strong>
Source IP          : 10.1.1.1 
Destination IP     : 10.1.2.1
Source Port        : 1024
Destination Port   : 3300
Direction          : InBound
Interface          : <span>100GE</span><span>1/0/1</span>
Flow Start Time    : 2023-06-16 19:47:07
VNI                : --
----------------------------------------------------------------------------------
Status        Block Id      Block Timestamp    Receive Packets      Receive Bytes 
----------------------------------------------------------------------------------
Previous           154           1516680000                 20               1640 
Current            206           3368361000                 49               4018 
----------------------------------------------------------------------------------</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001512853440__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Configuration Scripts</h4><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
acl number 3055
 rule 4 permit udp source 10.1.1.1 0.0.0.0 destination 10.1.2.1 0.0.0.0 destination-port eq 3300
#
traffic classifier c1
 if-match acl 3055 
#
traffic behavior b1
 traffic-analysis enable
#
traffic policy p1
 classifier c1 behavior b1
#
traffic-policy p1 global inbound
#
traffic-analysis udp identification block 128
#
traffic-analysis udp timeout inactive 100
#
traffic-analysis udp export source ip 10.1.3.1
#
traffic-analysis udp export host ip 10.1.3.2 6000
#</pre>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_traffic-analysis_cfg_0015.html">Configuring Intelligent Traffic Analysis for UDP Flows
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_traffic-analysis_cfg_0024.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>