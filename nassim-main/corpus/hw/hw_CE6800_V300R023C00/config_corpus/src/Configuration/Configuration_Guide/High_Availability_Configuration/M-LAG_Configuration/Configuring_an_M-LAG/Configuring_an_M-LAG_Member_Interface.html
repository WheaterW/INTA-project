
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring an M-LAG Member Interface">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_cfg_m-lag_0020.html">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_cfg_m-lag_0009.html">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_cfg_m-lag_0044.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="M-LAG">
<meta name="featuretype" content="High Availability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="M-LAG">
<meta name="featuretype" content="High Availability">
<meta name="featurename" content="M-LAG">
<meta name="featuretype" content="High Availability">
<meta name="featuretype" content="High Availability">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001563888777">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Configuring an M-LAG Member Interface</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001563888777"></a><a name="EN-US_TASK_0000001563888777"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring an M-LAG Member Interface</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001563888777__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Prerequisites</h4><p>The links connecting a user-side device to each of the M-LAG member devices have been configured as Eth-Trunks.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001563888777__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Some service interfaces on the M-LAG master and backup devices are bundled into an M-LAG member interface, respectively. Both devices use these interfaces to establish Eth-Trunks with a user-side device, implementing cross-device link aggregation.</p>
<p>To improve system reliability and prevent incorrect connections during M-LAG configuration or loops, you are advised to configure the Eth-Trunks between M-LAG member devices and the user-side device to work in LACP mode. In an M-LAG in active/standby mode, the Eth-Trunks between M-LAG member devices and the user-side device need to work in manual load balancing mode.</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0000001563888777__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>(Recommended in dual-active mode) If the Eth-Trunks work in LACP mode, perform the following operations:</span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the view of an Eth-Trunk interface that needs to be configured as the M-LAG member interface.</span><p><pre class="screen"><a href="cmdqueryname=interface+eth-trunk"><b><span class="cmdname">interface eth-trunk</span></b></a> <i><span class="varname">trunk-id</span></i></pre>
</p></li><li class="substepexpand"><span>Configure the Eth-Trunk interface to work in LACP mode.</span><p><pre class="screen"><a href="cmdqueryname=mode"><b><span class="cmdname">mode</span></b></a> { <a href="cmdqueryname=lacp-static"><b><span class="cmdname">lacp-static</span></b></a> | <a href="cmdqueryname=lacp-dynamic"><b><span class="cmdname">lacp-dynamic</span></b></a> }</pre>
<p>By default, an Eth-Trunk interface works in manual load balancing mode.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The dynamic LACP mode applies only to a scenario where the device is connected to a server. In other scenarios, you are advised to configure the static LACP mode. If the dynamic LACP mode is used, loops may occur on the network.</p>
</div></div>
</p></li><li class="substepexpand"><span>Bind the user-side Eth-Trunk interface to a DFS group. This operation is equivalent to configuring the Eth-Trunk interface as an M-LAG member interface.</span><p><pre class="screen"><a href="cmdqueryname=icssearchname"><b><span class="cmdname">dfs-group</span></b></a> <i><span class="varname">dfs-group-id</span></i> <a href="cmdqueryname=icssearchname"><b><span class="cmdname">m-lag</span></b></a> <i><span class="varname">m-lag-id </span></i></pre>
<p>By default, a user-side Eth-Trunk interface is not bound to a DFS group.</p>
</p><p><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>A Layer 3 Eth-Trunk main interface cannot function as an M-LAG member interface.</li><li>The M-LAG member devices must be configured with the same M-LAG ID, and the configurations (including the M-LAG mode) of the interfaces configured with the same M-LAG ID must also be the same to ensure normal traffic forwarding.</li></ul>
</div></div>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001563888777__substep196571119153116"><span id="EN-US_TASK_0000001563888777__cmd186572019133116">(Optional) Add the Eth-Trunk interface to the STP process with a specified ID.</span><p><pre class="screen" id="EN-US_TASK_0000001563888777__screen18791438153115"><strong class="cmdqueryname" id="EN-US_TASK_0000001563888777__b1694104515312"><a href="cmdqueryname=stp+binding+process"><b><span class="cmdname" id="EN-US_TASK_0000001563888777__cmdname7236174411103">stp binding process</span></b></a></strong> <em id="EN-US_TASK_0000001563888777__i19941745153116">process-id</em></pre>
<p id="EN-US_TASK_0000001563888777__p19826182011382">This command is applicable only to the V-STP mode. After STP multi-process is enabled, M-LAG member interfaces can be managed in different processes. As devices perform spanning tree calculation based on processes, the interfaces that are not in a certain process do not participate in the spanning tree calculation of this process. Instead, M-LAG member interfaces need to be added to specified STP processes.</p>
<div class="note" id="EN-US_TASK_0000001563888777__note68231450103719"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul id="EN-US_TASK_0000001563888777__ul1275283110382"><li id="EN-US_TASK_0000001563888777__li150073843817"><p id="EN-US_TASK_0000001563888777__p155001938163817"><a name="EN-US_TASK_0000001563888777__li150073843817"></a><a name="li150073843817"></a>Network loops may occur if M-LAG member interfaces in different processes belong to the same broadcast domain and peer-link interfaces are blocked. To address this problem, assign M-LAG member interfaces in different processes to different broadcast domains.</p>
</li><li id="EN-US_TASK_0000001563888777__li5685448133812"><p id="EN-US_TASK_0000001563888777__p4685144818385"><a name="EN-US_TASK_0000001563888777__li5685448133812"></a><a name="li5685448133812"></a>Before switching the process of an M-LAG member interface, run the <strong id="EN-US_TASK_0000001563888777__b1068515488381">shutdown</strong> command to shut down the interface and do not configure services on it. After the processes of M-LAG member interfaces on the M-LAG master and backup devices are successfully switched, run the <strong id="EN-US_TASK_0000001563888777__b539851531115">undo shutdown</strong> command to enable the interfaces and configure services on them.</p>
</li></ul>
</div></div>
</p></li><li class="substepexpand"><span>(Optional) Configure the M-LAG LACP system priority and system ID.</span><p><ol type="a"><li>(Optional) Exit the Eth-Trunk interface view.<pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</li><li>Configure the M-LAG LACP system priority.<pre class="screen"><a href="cmdqueryname=lacp+m-lag+priority"><b><span class="cmdname">lacp m-lag priority</span></b></a> <i><span class="varname">priority</span></i> </pre>
<p>By default, the M-LAG LACP system priority is 32768 in the system view, and there is no default M-LAG LACP system priority in the Eth-Trunk interface view.</p>
</li><li>Configure the M-LAG LACP system ID.<pre class="screen"><a href="cmdqueryname=lacp+m-lag+system-id"><b><span class="cmdname">lacp m-lag system-id</span></b></a> <i><span class="varname">mac-address</span></i></pre>
<p>By default, the M-LAG LACP system ID in the system view is the MAC address of the Ethernet management interface on the device, and there is no default M-LAG LACP system ID in the Eth-Trunk interface view.</p>
<p>You are advised to use the smaller MAC address on the M-LAG master and backup devices as the M-LAG LACP system ID.</p>
</li></ol>
</p><p><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>You can configure the M-LAG LACP system priority and system ID in both the system view and Eth-Trunk interface view.</li></ul>
<ul><li>The M-LAG LACP system priority and system ID configured in the system view take effect on all Eth-Trunk interfaces. The M-LAG LACP system priority and system ID configured in the view of an Eth-Trunk interface take effect only on the Eth-Trunk interface.</li><li>If the system priority and system ID are configured only in the system view, the M-LAG master device automatically synchronizes its M-LAG LACP system priority and system ID to the M-LAG backup device when the DFS group pairing is successful. You do not need to manually configure the M-LAG LACP system priority and system ID for the backup device.</li><li>If the system priority and system ID are configured in both the system view and a specified Eth-Trunk interface view, the configuration in the Eth-Trunk interface view takes effect. When the DFS group pairing is successful, the M-LAG master device does not synchronize the M-LAG LACP system priority and system ID of the Eth-Trunk interface to the M-LAG backup device. Therefore, the same M-LAG LACP system priority and system ID must be configured on both the M-LAG master and backup devices.</li><li>The M-LAG LACP system priority and system ID are valid for an M-LAG composed of Eth-Trunks in LACP mode.</li></ul>
</div></div>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001563888777__en-us_task_0228023023_screen14848162118611"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001563888777__en-us_task_0228023023_cmdname1784862115612">commit</span></b></a></pre>
</p></li></ol>
</li><li><span>If the Eth-Trunks work in manual load balancing mode, perform the following operations:</span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the view of an Eth-Trunk interface that needs to be configured as the M-LAG member interface.</span><p><pre class="screen"><a href="cmdqueryname=interface+eth-trunk"><b><span class="cmdname">interface eth-trunk</span></b></a> <i><span class="varname">trunk-id</span></i></pre>
</p></li><li class="substepexpand"><span>Bind the user-side Eth-Trunk interface to a DFS group. This operation is equivalent to configuring the Eth-Trunk interface as an M-LAG member interface.</span><p><pre class="screen"><a href="cmdqueryname=icssearchname"><b><span class="cmdname">dfs-group</span></b></a> <i><span class="varname">dfs-group-id</span></i> <a href="cmdqueryname=icssearchname"><b><span class="cmdname">m-lag</span></b></a> <i><span class="varname">m-lag-id </span></i>[<strong><span> active-standby</span></strong> ]</pre>
<p>By default, a user-side Eth-Trunk interface is not bound to a DFS group.</p>
</p><p><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>A Layer 3 Eth-Trunk main interface cannot function as an M-LAG member interface.</li><li><p>The M-LAG member devices must be configured with the same M-LAG ID, and the configurations (including the M-LAG mode) of the interfaces configured with the same M-LAG ID must also be the same to ensure normal traffic forwarding.</p>
</li><li><p>If the <strong><span>active-standby</span></strong> parameter is not specified, the M-LAG mode is set to dual-active. If the <strong><span>active-standby</span></strong> parameter is specified, the M-LAG mode is set to active/standby.</p>
</li><li><p>Before configuring the M-LAG active/standby mode, run the <a href="cmdqueryname=m-lag+active-standby+election"><b><span class="cmdname">m-lag active-standby election</span></b></a> command in the DFS group view to configure the type of packets for electing the M-LAG master and backup member interfaces.</p>
</li></ul>
</div></div>
</p></li><li class="substepexpand"><span>(Optional) Add the Eth-Trunk interface to the STP process with a specified ID.</span><p><pre class="screen" id="EN-US_TASK_0000001563888777__en-us_task_0000001563888777_screen18791438153115"><strong class="cmdqueryname" id="EN-US_TASK_0000001563888777__en-us_task_0000001563888777_b1694104515312"><a href="cmdqueryname=stp+binding+process"><b><span class="cmdname" id="EN-US_TASK_0000001563888777__en-us_task_0000001563888777_cmdname7236174411103">stp binding process</span></b></a></strong> <em id="EN-US_TASK_0000001563888777__en-us_task_0000001563888777_i19941745153116">process-id</em></pre>
<p id="EN-US_TASK_0000001563888777__en-us_task_0000001563888777_p19826182011382">This command is applicable only to the V-STP mode. After STP multi-process is enabled, M-LAG member interfaces can be managed in different processes. As devices perform spanning tree calculation based on processes, the interfaces that are not in a certain process do not participate in the spanning tree calculation of this process. Instead, M-LAG member interfaces need to be added to specified STP processes.</p>
<div class="note" id="EN-US_TASK_0000001563888777__en-us_task_0000001563888777_note68231450103719"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul id="EN-US_TASK_0000001563888777__en-us_task_0000001563888777_ul1275283110382"><li id="EN-US_TASK_0000001563888777__en-us_task_0000001563888777_li150073843817"><p id="EN-US_TASK_0000001563888777__en-us_task_0000001563888777_p155001938163817"><a name="EN-US_TASK_0000001563888777__en-us_task_0000001563888777_li150073843817"></a><a name="en-us_task_0000001563888777_li150073843817"></a>Network loops may occur if M-LAG member interfaces in different processes belong to the same broadcast domain and peer-link interfaces are blocked. To address this problem, assign M-LAG member interfaces in different processes to different broadcast domains.</p>
</li><li id="EN-US_TASK_0000001563888777__en-us_task_0000001563888777_li5685448133812"><p id="EN-US_TASK_0000001563888777__en-us_task_0000001563888777_p4685144818385"><a name="EN-US_TASK_0000001563888777__en-us_task_0000001563888777_li5685448133812"></a><a name="en-us_task_0000001563888777_li5685448133812"></a>Before switching the process of an M-LAG member interface, run the <strong id="EN-US_TASK_0000001563888777__en-us_task_0000001563888777_b1068515488381">shutdown</strong> command to shut down the interface and do not configure services on it. After the processes of M-LAG member interfaces on the M-LAG master and backup devices are successfully switched, run the <strong id="EN-US_TASK_0000001563888777__en-us_task_0000001563888777_b539851531115">undo shutdown</strong> command to enable the interfaces and configure services on them.</p>
</li></ul>
</div></div>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001563888777__en-us_task_0228023023_screen14848162118611_1"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001563888777__en-us_task_0228023023_cmdname1784862115612_1">commit</span></b></a></pre>
</p></li></ol>
<p><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>A static MAC address can be configured for an M-LAG member interface. When the M-LAG member interface fails, the static MAC address configured on the faulty member interface still points to the member interface, and the dynamic MAC address learned by the faulty member interface is synchronized to the peer-link interface.</p>
</div></div>
</p></li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../dc/dc_cfg_m-lag_0020.html">Configuring an M-LAG
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../dc/dc_cfg_m-lag_0009.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../dc/dc_cfg_m-lag_0044.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>