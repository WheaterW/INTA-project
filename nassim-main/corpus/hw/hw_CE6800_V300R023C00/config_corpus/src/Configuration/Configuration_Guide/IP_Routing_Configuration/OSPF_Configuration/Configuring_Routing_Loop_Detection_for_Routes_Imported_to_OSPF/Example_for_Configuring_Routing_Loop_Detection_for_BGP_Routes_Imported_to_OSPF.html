
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Routing Loop Detection for BGP Routes Imported to OSPF">
<meta name="abstract" content="This section describes how to configure routing loop detection for routes imported from BGP to OSPF.">
<meta name="description" content="This section describes how to configure routing loop detection for routes imported from BGP to OSPF.">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0301.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0300.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001211171423">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Routing Loop Detection for BGP Routes Imported to OSPF</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001211171423"></a><a name="EN-US_TASK_0000001211171423"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Routing Loop Detection for BGP Routes Imported to OSPF</h1>
<div class="taskbody"><p>This section describes how to configure routing loop detection for routes imported from BGP to OSPF.</p>
<div class="context"><a name="EN-US_TASK_0000001211171423__1.4.1"></a><a name="1.4.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the live network, OSPF routes can be imported to a BGP process for redistribution. In such a scenario, routing policies are usually configured on multiple devices to prevent routing loops. If routing policies are incorrectly configured on the devices that import routes, routing loops may occur. To prevent this problem, configure routing loop detection for the routes imported to OSPF.</p>
<p>On the network shown in <a href="#EN-US_TASK_0000001211171423__fig1261541011544">Figure 1</a>, DeviceA, DeviceB, DeviceC, and DeviceD establish IBGP peer relationships, and an OSPF process is configured on DeviceC and DeviceD. OSPF is configured on DeviceC to import BGP routes, and BGP is configured on DeviceD to import OSPF routes.</p>
<div class="fignone" id="EN-US_TASK_0000001211171423__fig1261541011544"><a name="EN-US_TASK_0000001211171423__fig1261541011544"></a><a name="fig1261541011544"></a><span class="figcap"><b>Figure 1 </b>Routing loop detection for routes imported from BGP to OSPF</span><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, and <span>100GE</span><span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001230985383.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001211171423__1.4.2"></a><a name="1.4.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>To improve security, OSPF area authentication or interface authentication is recommended. For details, see "Improving OSPF Network Security." OSPF area authentication is used as an example. For details, see "Example for Configuring Basic OSPF Functions."</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001211171423__1.4.3"></a><a name="1.4.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure IP addresses for interfaces on each device.</p>
</li><li><p>Enable OSPF and BGP, and configure basic OSPF and BGP functions.</p>
</li><li>Configure route import to construct a routing loop.</li><li><p>Check whether a routing loop occurs.</p>
</li><li>Enable routing loop detection to check whether the routing loop is eliminated.</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001211171423__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface.</span><p><p>DeviceA is used as an example.</p>
<pre class="screen">&lt;DeviceA&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface</strong> <strong><span>100GE</span><span>1/0/1</span> </strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ip address 10.12.1.1 24</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceA] <strong>commit</strong></span></pre>
<p>The configurations of other devices are similar to those of DeviceA. For configuration details, see <a href="#EN-US_TASK_0000001211171423__section_dc_vrp_isis_cfg_201205">Configuration Scripts</a> in this section.</p>
<p>In addition, configure a static route on DeviceA to simulate a looped route.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>ip route-static 10.0.0.0 255.255.255.255 NULL0</strong>
<span>[<span class="keyword">*</span>DeviceA] <strong>commit</strong></span></pre>
</p></li><li><span>Enable OSPF and BGP, and configure basic OSPF and BGP functions to implement intra-AS communication.</span><p><p># Enable BGP on DeviceA and establish an IBGP peer relationship between DeviceA and DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>bgp 100</strong>
[<span class="keyword">*</span>DeviceA-bgp] <strong>router-id 10.11.1.1</strong>
[<span class="keyword">*</span>DeviceA-bgp] <strong>peer 10.12.1.2 as-number 100</strong>
[<span class="keyword">*</span>DeviceA-bgp] <strong>ipv4-family unicast</strong>
[<span class="keyword">*</span>DeviceA-bgp-af-ipv4] <strong>peer 10.12.1.2 enable</strong>
[<span class="keyword">*</span>DeviceA-bgp] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceA] <strong>commit</strong></span></pre>
<p># Enable BGP on DeviceB, and establish IBGP peer relationships between DeviceB and DeviceA, between DeviceB and DeviceC, and between DeviceB and DeviceD.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>bgp 100</strong>
[<span class="keyword">*</span>DeviceB-bgp] <strong>router-id 10.22.2.2</strong>
[<span class="keyword">*</span>DeviceB-bgp] <strong>peer 10.12.1.1 as-number 100</strong>
[<span class="keyword">*</span>DeviceB-bgp] <strong>peer 10.23.1.3 as-number 100</strong>
[<span class="keyword">*</span>DeviceB-bgp] <strong>peer 10.24.1.4 as-number 100</strong>
[<span class="keyword">*</span>DeviceB-bgp] <strong>ipv4-family unicast</strong>
[<span class="keyword">*</span>DeviceB-bgp-af-ipv4] <strong>peer 10.12.1.1 enable</strong>
[<span class="keyword">*</span>DeviceB-bgp-af-ipv4] <strong>peer 10.23.1.3 enable</strong>
[<span class="keyword">*</span>DeviceB-bgp-af-ipv4] <strong>peer 10.24.1.4 enable</strong>
[<span class="keyword">*</span>DeviceB-bgp-af-ipv4] <strong>peer 10.23.1.3 reflect-client</strong>
[<span class="keyword">*</span>DeviceB-bgp] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceB] <strong>commit</strong></span></pre>
<p># Enable BGP on DeviceC and establish an IBGP peer relationship between DeviceC and DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>bgp 100</strong>
[<span class="keyword">*</span>DeviceC-bgp] <strong>router-id 10.33.3.3</strong>
[<span class="keyword">*</span>DeviceC-bgp] <strong>peer 10.23.1.2 as-number 100</strong>
[<span class="keyword">*</span>DeviceC-bgp] <strong>ipv4-family unicast</strong>
[<span class="keyword">*</span>DeviceC-bgp-af-ipv4] <strong>peer 10.23.1.2 enable</strong>
[<span class="keyword">*</span>DeviceC-bgp] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceC] <strong>commit</strong></span></pre>
<p># Enable BGP on DeviceD and establish an IBGP peer relationship between DeviceD and DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong>bgp 100</strong>
[<span class="keyword">*</span>DeviceD-bgp] <strong>router-id 10.44.4.4</strong>
[<span class="keyword">*</span>DeviceD-bgp] <strong>peer 10.24.1.2 as-number 100</strong>
[<span class="keyword">*</span>DeviceD-bgp] <strong>ipv4-family unicast</strong>
[<span class="keyword">*</span>DeviceD-bgp-af-ipv4] <strong>peer 10.24.1.2 enable</strong>
[<span class="keyword">*</span>DeviceD-bgp] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceD] <strong>commit</strong></span></pre>
<p># Configure OSPF on DeviceC and DeviceD. The configuration on DeviceC is used as an example.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>ospf 1 router-id 10.33.3.3</strong>
[<span class="keyword">*</span>DeviceC-ospf-1] <strong>area 0</strong>
[<span class="keyword">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong>network 10.34.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC-ospf-1] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceC] <strong>commit</strong></span></pre>
</p></li><li><span>Configure route import.</span><p><p># Configure OSPF on DeviceC to import BGP routes.</p>
</p><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>ospf 1</strong> <strong>router-id 10.33.3.3</strong>
[<span class="keyword">*</span>DeviceC-ospf-1] <strong>import-route bgp permit-ibgp</strong>
[<span class="keyword">*</span>DeviceC-ospf-1] <strong>opaque-capability enable</strong>
[<span class="keyword">*</span>DeviceC-ospf-1] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceC] <strong>commit</strong></span></pre>
<p># Configure BGP on DeviceD to import OSPF routes.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong>bgp 100</strong>
[<span class="keyword">*</span>DeviceD-bgp] <strong>ipv4-family unicast</strong>
[<span class="keyword">*</span>DeviceD-bgp-af-ipv4] <strong>import-route ospf 1</strong>
[<span class="keyword">*</span>DeviceD-bgp] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceD] <strong>commit</strong></span></pre>
</p></li><li><span>Display the routing table on each device to check whether a routing loop occurs.</span><p><p># Check BGP peer information on DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display bgp peer</strong></pre>
<pre class="screen"> BGP local router ID : 10.22.2.2
 Local AS number : 100
 Total number of peers : 3                 Peers in established state : 3

  Peer                              V          AS  MsgRcvd  MsgSent  OutQ  Up/Down       State   PrefRcv
  <strong>10.12.1.1</strong>                         4         100      453      458     0 06:30:47 <strong>Established</strong>        1
  <strong>10.23.1.3</strong>                         4         100      452      458     0 06:30:46 <strong>Established</strong>        0
  <strong>10.24.1.4</strong>                         4         100      451      457     0 06:29:39 <strong>Established</strong>        3</pre>
<p># Check OSPF neighbor information on DeviceC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>display ospf peer</strong></pre>
<pre class="screen">(M) Indicates MADJ neighbor


          OSPF Process 1 with Router ID 10.33.3.3
                Neighbors

 Area 0.0.0.0 interface 10.34.1.3 (<span>100GE</span><span>1/0/1</span>)'s neighbors
 <strong>Router ID: 10.44.4.4             Address: 10.34.1.4</strong>
   <strong>State: Full</strong>           Mode:Nbr is Master     Priority: 1
   DR: 10.34.1.4          BDR: 10.34.1.3          MTU: 0
   Dead timer due in  31  sec
   Retrans timer interval: 5
   Neighbor is up for 06h28m21s
   Neighbor Up Time : 2021-08-27 02:59:32
   Authentication Sequence: [ 0 ]</pre>
<p># Check OSPF neighbor information on DeviceD.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong>display ospf peer</strong></pre>
<pre class="screen">(M) Indicates MADJ neighbor


          OSPF Process 1 with Router ID 10.44.4.4
                Neighbors

 Area 0.0.0.0 interface 10.34.1.4 (<span>100GE</span><span>1/0/2</span>)'s neighbors
 R<strong>outer ID: 10.33.3.3             Address: 10.34.1.3</strong>
   <strong>State: Full</strong>           Mode:Nbr is Slave      Priority: 1
   DR: 10.34.1.4          BDR: 10.34.1.3          MTU: 0
   Dead timer due in  32  sec
   Retrans timer interval: 5
   Neighbor is up for 06h28m25s
   Neighbor Up Time : 2021-08-27 02:59:32
   Authentication Sequence: [ 0 ]</pre>
<p>The preceding command outputs show that BGP peer relationships and OSPF neighbor relationships have been established between the devices.</p>
<p># Check the BGP routing table of DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display bgp routing-table 10.0.0.0</strong></pre>
<pre class="screen"> BGP local router ID : 10.22.2.2
 Local AS number : 100
 Paths:   2 available, 1 best, 1 select, 0 best-external, 0 add-path
 BGP routing table entry information of 10.0.0.0/32:
 RR-client route.
 <strong>From: 10.24.1.4 (10.44.4.4)</strong>
 Route Duration: 0d00h00m52s
 Relay IP Nexthop: 10.24.1.4
 Relay IP Out-Interface: <span>100GE</span><span>1/0/1</span>
 Original nexthop: 10.24.1.4
 Qos information : 0x0
 AS-path Nil, origin incomplete, MED 1, localpref 100, pref-val 0, valid, internal, best, select, pre 255
 Advertised to such 3 peers:
    10.23.1.3
    10.24.1.4
    10.12.1.1

 BGP routing table entry information of 10.0.0.0/32:
 From: 10.12.1.1 (10.11.1.1)
 Route Duration: 0d22h53m22s
 Relay IP Nexthop: 10.12.1.1
 Relay IP Out-Interface:<span>100GE</span><span>1/0/2</span>
 Original nexthop: 10.12.1.1
 Qos information : 0x0
 AS-path 10, origin incomplete, MED 0, localpref 100, pref-val 0, valid, internal, pre 255, not preferred for AS-Path
 Not advertised to any peer yet</pre>
<p>The preceding command output shows that DeviceB has learned the BGP route advertised by DeviceD.</p>
<p># Check the BGP routing table of DeviceC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>display bgp routing-table 10.0.0.0</strong></pre>
<pre class="screen"> BGP local router ID : 10.33.3.3
 Local AS number : 100
 Paths:   1 available, 1 best, 1 select, 0 best-external, 0 add-path
 BGP routing table entry information of 10.0.0.0/32:
<strong> From: 10.23.1.2 (10.22.2.2)</strong>
 Route Duration: 0d07h12m30s
 Relay IP Nexthop: 0.0.0.0
 Relay IP Out-Interface: NULL0
 Original nexthop: 10.12.1.1
 Qos information : 0x0
 AS-path 10, origin incomplete, MED 0, localpref 100, pref-val 0, valid, internal, best, select, pre 255
 Originator: 10.11.1.1
 Cluster list: 10.22.2.2
 Not advertised to any peer yet</pre>
<p>The preceding command output shows that DeviceC has learned the BGP route advertised by DeviceB.</p>
<p># Check the routing table of DeviceD.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong>display ospf routing 10.0.0.0</strong></pre>
<pre class="screen">          OSPF Process 1 with Router ID 10.44.4.4

 Destination    : 10.0.0.0/32
 AdverRouter    : 10.33.3.3                 Tag                 : 1
 Cost           : 1                        Type                : Type2
 NextHop        : <strong>10.34.1.3</strong>               Interface           : <span>100GE</span><span>1/0/2</span>
 Priority       : Medium                   Age                 : 01h31m18s</pre>
<p>The preceding command output shows that DeviceD has learned the OSPF route distributed by DeviceC.</p>
</p><p><p>In this case, a routing loop occurs on DeviceB, DeviceC, and DeviceD.</p>
</p></li><li><span>Enable routing loop detection on each device.</span><p><p># Enable routing loop detection for routes imported into OSPF and BGP. DeviceA is used as an example.</p>
<pre class="screen">[<span class="keyword">*</span>DeviceA] <strong>route loop-detect ospf enable</strong>
[<span class="keyword">*</span>DeviceA] <strong>route loop-detect bgp enable</strong>
<span>[<span class="keyword">*</span>DeviceA] <strong>commit</strong></span></pre>
</p><p><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In the case of inter-protocol route import, if a routing protocol with a higher priority detects a routing loop, although this protocol increases the cost of the corresponding route, the cost increase will not render the route inactive. As a result, the routing loop cannot be eliminated. If a routing protocol with a lower preference detects a routing loop and increases the cost of the corresponding route, this route will not be preferred over the originally received route. In this case, the routing loop can be eliminated. OSPF has a higher preference than BGP. Therefore, to eliminate the routing loop, you need to reduce the preference of the corresponding BGP route.</p>
</div></div>
</p></li><li><span>Check whether the routing loop is eliminated.</span><p><p># Check the BGP routing table of DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display bgp routing-table 10.0.0.0</strong></pre>
<pre class="screen"> BGP local router ID : 10.22.2.2
 Local AS number : 100
 Paths:   1 available, 1 best, 1 select, 0 best-external, 0 add-path
 BGP routing table entry information of 10.0.0.0/32:
 <strong>From:</strong> <strong>10.12.1.1 (10.11.1.1)</strong>
 Route Duration: 1d00h10m02s
 Relay IP Nexthop: 10.12.1.1
 Relay IP Out-Interface: <span>100GE</span><span>1/0/2</span>
 Original nexthop: 10.12.1.1
 Qos information : 0x0
 AS-path 10, origin incomplete, MED 0, localpref 100, pref-val 0, valid, internal, best, select, pre 255
 Advertised to such 2 peers:
    10.23.1.3
    10.24.1.4</pre>
<p>The preceding command output shows that DeviceB has learned the route distributed by DeviceA and no longer preferentially selects the route distributed by DeviceD. This means that the routing loop on DeviceB, DeviceC, and DeviceD is resolved.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001211171423__section_dc_vrp_isis_cfg_201205"><a name="EN-US_TASK_0000001211171423__section_dc_vrp_isis_cfg_201205"></a><a name="section_dc_vrp_isis_cfg_201205"></a><a name="EN-US_TASK_0000001211171423__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.12.1.1 255.255.255.0
#
bgp 100
 router-id 10.11.1.1
 private-4-byte-as enable
 peer 10.12.1.2 as-number 100
 #
 ipv4-family unicast
  import-route static
  peer 10.12.1.2 enable
#
ip route-static 10.0.0.0 255.255.255.255 NULL0
#
route loop-detect ospf enable
#
route loop-detect bgp enable
#
return</pre>
</li><li><p>DeviceB</p>
<pre class="screen">#
sysname DeviceB
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.12.1.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 10.24.1.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.23.1.2 255.255.255.0
#
bgp 100
 router-id 10.22.2.2
 private-4-byte-as enable
 peer 10.12.1.1 as-number 100
 peer 10.23.1.3 as-number 100
 peer 10.24.1.4 as-number 100
 #
 ipv4-family unicast
  peer 10.12.1.1 enable
  peer 10.23.1.3 enable
  peer 10.23.1.3 reflect-client
  peer 10.24.1.4 enable
  peer 10.24.1.4 reflect-client
#
route loop-detect ospf enable
#
route loop-detect bgp enable
#
return</pre>
</li><li><p>DeviceC</p>
<pre class="screen">#
sysname DeviceC
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.34.1.3 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.23.1.3 255.255.255.0
#
bgp 100
 router-id 10.33.3.3
 private-4-byte-as enable
 peer 10.23.1.2 as-number 100
 #
 ipv4-family unicast
  peer 10.23.1.2 enable
#
ospf 1 router-id 10.33.3.3
 import-route bgp permit-ibgp
 opaque-capability enable
 area 0.0.0.0
  network 10.34.1.0 0.0.0.255
#
route loop-detect ospf enable
#
route loop-detect bgp enable
#
return</pre>
</li><li><p>DeviceD</p>
<pre class="screen">#
sysname DeviceD
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.34.1.4 255.255.255.0
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.24.1.4 255.255.255.0
#
bgp 100
 router-id 10.44.4.4
 private-4-byte-as enable
 peer 10.24.1.2 as-number 100
 #
 ipv4-family unicast
  import-route ospf 1
  peer 10.24.1.2 enable
#
ospf 1 router-id 10.44.4.4
 opaque-capability enable
 area 0.0.0.0
  network 10.34.1.0 0.0.0.255
#
route loop-detect ospf enable
#
route loop-detect bgp enable
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_ospf_cfg_0301.html">Configuring Routing Loop Detection for Routes Imported to OSPF
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_ospf_cfg_0300.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>