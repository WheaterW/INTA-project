
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring an OSPF Stub Area">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0026.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0029.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176663001">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring an OSPF Stub Area</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176663001"></a><a name="EN-US_TASK_0000001176663001"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring an OSPF Stub Area</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176663001__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p><a href="#EN-US_TASK_0000001176663001__fig_dc_vrp_ospf_cfg_009501">Figure 1</a> shows a network where all devices run OSPF, and the entire AS is divided into three areas. DeviceA and DeviceB function as ABRs to advertise inter-area routes, and DeviceD functions as the ASBR to import external routes (static routes).</p>
<p>To reduce the number of LSAs advertised to area 1 without compromising route reachability, configure area 1 as a stub area.</p>
<div class="fignone" id="EN-US_TASK_0000001176663001__fig_dc_vrp_ospf_cfg_009501"><a name="EN-US_TASK_0000001176663001__fig_dc_vrp_ospf_cfg_009501"></a><a name="fig_dc_vrp_ospf_cfg_009501"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring an OSPF stub area</span><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1 and interface 2 represent <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001176663073.png"></span><div class="tableBorder"><table cellpadding="4" cellspacing="0" summary=""><tr><th valign="bottom" align="left" id="mcps1.3.1.4.4.1.1"><p><strong>Device</strong></p>
</th>
<th valign="bottom" align="left" id="mcps1.3.1.4.4.1.2"><p><strong>Router ID</strong></p>
</th>
<th valign="bottom" align="left" id="mcps1.3.1.4.4.1.3"><p><strong>Process ID</strong></p>
</th>
<th valign="bottom" align="left" id="mcps1.3.1.4.4.1.4"><p><strong>IP Address</strong></p>
</th>
</tr>
<tr><td valign="top" headers="mcps1.3.1.4.4.1.1"><p>DeviceA</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.2"><p>1.1.1.1</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.3"><p>1</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.4"><p>Area 0: 192.168.0.0/24</p>
<p>Area 1: 192.168.1.0/24</p>
</td>
</tr>
<tr><td valign="top" headers="mcps1.3.1.4.4.1.1"><p>DeviceB</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.2"><p>2.2.2.2</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.3"><p>1</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.4"><p>Area 0: 192.168.0.0/24</p>
<p>Area 2: 192.168.2.0/24</p>
</td>
</tr>
<tr><td valign="top" headers="mcps1.3.1.4.4.1.1"><p>DeviceC</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.2"><p>3.3.3.3</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.3"><p>1</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.4"><p>Area 1: 192.168.1.0/24 and 172.16.1.0/24</p>
</td>
</tr>
<tr><td valign="top" headers="mcps1.3.1.4.4.1.1"><p>DeviceD</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.2"><p>4.4.4.4</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.3"><p>1</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.4"><p>Area 2: 192.168.2.0/24 and 172.17.1.0/24</p>
</td>
</tr>
<tr><td valign="top" headers="mcps1.3.1.4.4.1.1"><p>DeviceE</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.2"><p>5.5.5.5</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.3"><p>1</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.4"><p>Area 1: 172.16.1.0/24</p>
</td>
</tr>
<tr><td valign="top" headers="mcps1.3.1.4.4.1.1"><p>DeviceF</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.2"><p>6.6.6.6</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.3"><p>1</p>
</td>
<td valign="top" headers="mcps1.3.1.4.4.1.4"><p>Area 2: 172.17.1.0/24</p>
</td>
</tr>
</table></div>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176663001__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>When configuring an OSPF stub area, note the following rules:</p>
<ul><li>The backbone area cannot be configured as a stub area.</li><li>A device in a stub area cannot be used as an ASBR. As such, AS external routes cannot be transmitted in the stub area.</li><li>A virtual link cannot pass through a stub area.</li><li>To improve security, OSPF area authentication or interface authentication is recommended. For details, see "Improving OSPF Network Security." OSPF area authentication is used as an example. For details, see <a href="vrp_ospf_cfg_0018.html">Example for Configuring Basic OSPF Functions</a>.</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176663001__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure basic OSPF functions on each device to ensure routing reachability.</p>
</li><li><p>Configure a static route on DeviceD, and configure DeviceD to import the route into the OSPF process.</p>
</li><li><p>Configure area 1 as a stub area by running the <a href="cmdqueryname=stub"><b><span class="cmdname">stub</span></b></a> command on all devices in area 1, and check the OSPF routing information on DeviceC.</p>
</li><li><p>Stop DeviceA from advertising Type 3 LSAs to the stub area, and check the OSPF routing information on DeviceC.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176663001__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface. For detailed configurations, see <a href="#EN-US_TASK_0000001176663001__postreq19369155811203">Configuration Scripts</a>.</span></li><li><span>Configure basic OSPF functions. For details, see <a href="vrp_ospf_cfg_0018.html">Example for Configuring Basic OSPF Functions</a>.</span></li><li><span>Configure DeviceD to import a static route.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong>ip route-static 10.0.0.0 8 null 0</strong>
[<span class="keyword">*</span>DeviceD] <strong>ospf 1</strong>
[<span class="keyword">*</span>DeviceD-ospf-1] <strong>import-route static type 1</strong>
[<span class="keyword">*</span>DeviceD-ospf-1] <strong>quit</strong>
<span>[DeviceD] <strong>commit</strong></span></pre>
<p># Check the ABR and ASBR information on DeviceC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>display ospf abr-asbr</strong>

          OSPF Process 1 with Router ID 3.3.3.3
                  Routing Table to ABR and ASBR

 Type        Destination       Area       Cost  NextHop         RtType
 Intra-area  1.1.1.1           0.0.0.1    1     192.168.1.1     ABR
 Inter-area  4.4.4.4           0.0.0.1    3     192.168.1.1     ASBR</pre>
<p># Check information about the OSPF routing table on DeviceC.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If DeviceC resides in a common area, AS external routes exist in the routing table.</p>
</div></div>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>display ospf routing</strong>
          OSPF Process 1 with Router ID 3.3.3.3
                   Routing Tables

 Routing for Network
 Destination        Cost       Type       NextHop         AdvRouter       Area

 172.17.1.0/24      4          Inter-area 192.168.1.1     1.1.1.1         0.0.0.1
 192.168.0.0/24     2          Inter-area 192.168.1.1     1.1.1.1         0.0.0.1
 192.168.2.0/24     3          Inter-area 192.168.1.1     1.1.1.1         0.0.0.1

 Routing for ASEs
 Destination        Cost       Type       Tag        NextHop         AdvRouter

 <strong>10.0.0.0/8        4         Type1      1         192.168.1.1     4.4.4.4</strong>


 Total Nets: 4
 Intra Area: 0  Inter Area: 3  ASE: 1  NSSA: 0</pre>
</p></li><li><span>Configure area 1 as a stub area.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>ospf 1</strong>
[<span class="keyword">*</span>DeviceA-ospf-1] <strong>area 1</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.1] <strong>stub</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA-ospf-1] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceA] <strong>commit</strong></span></pre>
<p># Configure DeviceC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>ospf 1</strong>
[<span class="keyword">*</span>DeviceC-ospf-1] <strong>area 1</strong>
[<span class="keyword">*</span>DeviceC-ospf-1-area-0.0.0.1] <strong>stub</strong>
[<span class="keyword">*</span>DeviceC-ospf-1-area-0.0.0.1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC-ospf-1] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceC] <strong>commit</strong></span></pre>
<p># Configure DeviceE.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceE] <strong>ospf 1</strong>
[<span class="keyword">*</span>DeviceE-ospf-1] <strong>area 1</strong>
[<span class="keyword">*</span>DeviceE-ospf-1-area-0.0.0.1] <strong>stub</strong>
[<span class="keyword">*</span>DeviceE-ospf-1-area-0.0.0.1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceE-ospf-1]<strong> quit</strong>
<span>[<span class="keyword">*</span>DeviceE] <strong>commit</strong></span></pre>
<p># Check information about the routing table on DeviceC.</p>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>After the area where DeviceC resides is configured as a stub area, a default route rather than AS external routes exists in the routing table.</p>
</div></div>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>display ospf routing</strong>
          OSPF Process 1 with Router ID 3.3.3.3
                   Routing Tables

 Routing for Network
 Destination        Cost       Type       NextHop         AdvRouter       Area
 <strong>0.0.0.0/0          2          Inter-area 192.168.1.1     1.1.1.1         0.0.0.1</strong>
 172.17.1.0/24      4          Inter-area 192.168.1.1     1.1.1.1         0.0.0.1
 192.168.0.0/24     2          Inter-area 192.168.1.1     1.1.1.1         0.0.0.1
 192.168.2.0/24     3          Inter-area 192.168.1.1     1.1.1.1         0.0.0.1

 Total Nets: 4
 Intra Area: 0  Inter Area: 4  ASE: 0  NSSA: 0</pre>
</p></li><li><span># Stop DeviceA from advertising Type 3 LSAs to the stub area.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>ospf</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-ospf-1] <strong>area 1</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.1] <strong>stub no-summary</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA-ospf-1] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceA] <strong>commit</strong></span></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001176663001__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Check information about the OSPF routing table on DeviceC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>display ospf routing</strong>
          OSPF Process 1 with Router ID 3.3.3.3
                   Routing Tables

 Routing for Network
 Destination        Cost       Type       NextHop         AdvRouter       Area
 0.0.0.0/0          2          Inter-area 192.168.1.1     1.1.1.1         0.0.0.1

 Total Nets: 1
 Intra Area: 0  Inter Area: 1  ASE: 0  NSSA: 0</pre>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>After the advertisement of summary LSAs to the stub area is disabled, the number of routing entries on devices in the stub area further decreases, and only the default route to a destination beyond the stub area is reserved.</p>
</div></div>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001176663001__postreq19369155811203"></a><a name="postreq19369155811203"></a><a name="EN-US_TASK_0000001176663001__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
router id 1.1.1.1
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.0.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.1.1 255.255.255.0
#
ospf 1
 area 0.0.0.0
  network 192.168.0.0 0.0.0.255
 area 0.0.0.1
  network 192.168.1.0 0.0.0.255
  stub no-summary
#
return</pre>
</li><li><p>DeviceB</p>
<pre class="screen">#
sysname DeviceB
#
router id 2.2.2.2
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.0.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.2.1 255.255.255.0
#
ospf 1
 area 0.0.0.0
  network 192.168.0.0 0.0.0.255
 area 0.0.0.2
  network 192.168.2.0 0.0.0.255
#
return</pre>
</li><li><p>DeviceC</p>
<pre class="screen">#
sysname DeviceC
#
router id 3.3.3.3
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.1.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 172.16.1.1 255.255.255.0
#
ospf 1
 area 0.0.0.1
  network 192.168.1.0 0.0.0.255
  network 172.16.1.0 0.0.0.255
  stub
#
return</pre>
</li><li><p>DeviceD</p>
<pre class="screen">#
sysname DeviceD
#
router id 4.4.4.4
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.2.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 172.17.1.1 255.255.255.0
#
ospf 1
 import-route static type 1
 area 0.0.0.2
  network 192.168.2.0 0.0.0.255
  network 172.17.1.0 0.0.0.255
#
ip route-static 10.0.0.0 255.0.0.0 NULL0
#
return</pre>
</li><li><p>DeviceE</p>
<pre class="screen">#
sysname DeviceE
#
router id 5.5.5.5
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 172.16.1.2 255.255.255.0
#
ospf 1
 area 0.0.0.1
  network 172.16.1.0 0.0.0.255
  stub
#
return</pre>
</li><li><p>DeviceF</p>
<pre class="screen">#
sysname DeviceF
#
router id 6.6.6.6
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 172.17.1.2 255.255.255.0
#
ospf 1
 area 0.0.0.2
  network 172.17.1.0 0.0.0.255
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_ospf_cfg_0026.html">Configuring an OSPF Stub Area
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_ospf_cfg_0029.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>