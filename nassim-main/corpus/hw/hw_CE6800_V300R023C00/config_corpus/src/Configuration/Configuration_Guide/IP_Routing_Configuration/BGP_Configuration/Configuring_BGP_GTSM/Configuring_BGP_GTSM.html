
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring BGP GTSM">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_0131.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_0132.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_0134.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176743565">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring BGP GTSM</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176743565"></a><a name="EN-US_TASK_0000001176743565"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring BGP GTSM</h1>
<div class="taskbody"><p></p>
<div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001176743565__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before configuring BGP GTSM, you have completed the following task:</p>
<ul><li><p><a href="vrp_bgp_cfg_0014.html">Configure basic BGP functions.</a></p>
</li></ul>
<p>Perform the following steps at both ends of a BGP peer relationship:</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176743565__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enter the BGP view.</span><p><pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></pre>
</p></li><li><span>Configure BGP GTSM.</span><p><pre class="screen"><a href="cmdqueryname=peer+valid-ttl-hops"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">group-name</span></i> | <i><span class="varname">ipv4-address</span></i> } <strong><span>valid-ttl-hops</span></strong> [ <i><span class="varname">hops</span></i> ]</pre>
</p><p><p>The valid TTL range of detected messages is [255 â <i><span class="varname">hops</span></i> + 1, 255]. For example, the value of <i><span class="varname">hops</span></i> is 1 for an EBGP direct route, and the valid TTL value is 255. By default, the value of <i><span class="varname">hops</span></i> is 255, and the valid TTL range is [1, 255].</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>After GTSM is configured in the BGP view, the configuration also takes effect in the MP-BGP VPNv4 address family view because BGP and MP-BGP VPNv4 use the same TCP connection.</li><li>GTSM and EBGP-max-hop are mutually exclusive because they both affect the TTL values in sent BGP messages. Therefore, only one of them can be used for a peer or peer group.</li></ul>
</div></div>
<p>After a GTSM policy is configured for BGP, the device checks the TTL values of all BGP messages. As required by the actual networking, messages whose TTL values do not match the specified range in a GTSM policy are discarded directly. In scenarios where GTSM is not configured on a BGP device, the received BGP messages are forwarded if the BGP peer configuration exists. Otherwise, the received BGP messages are discarded. This prevents bogus BGP messages from consuming CPU resources.</p>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001176743565__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001176743565__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="postreq"><a name="EN-US_TASK_0000001176743565__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p>After the configuration is complete, verify the configuration.</p>
<ul><li>Run the <a href="cmdqueryname=display+gtsm+statistics"><b><span class="cmdname">display gtsm statistics</span></b></a> <span>{ <i><span class="varname">slot-id</span></i> | </span><strong><span>all</span></strong><span> }</span> command to check GTSM statistics.</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_bgp_cfg_0131.html">Configuring BGP GTSM
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_bgp_cfg_0132.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_bgp_cfg_0134.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>