
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Understanding Source MAC Address-based ND Attack Defense">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_nd_cfg_0035.html">
<meta name="DC.Relation" scheme="URI" content="vrp_nd_cfg_0037.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001176741953">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Understanding Source MAC Address-based ND Attack Defense</title>
</head>
<body><a name="EN-US_CONCEPT_0000001176741953"></a><a name="EN-US_CONCEPT_0000001176741953"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Understanding Source MAC Address-based ND Attack Defense</h1>
<div><div class="section"><h4 class="sectiontitle">Context</h4><p>ND has powerful functions. However, if there is no security mechanism, attackers may use ND to attack network devices. As shown in <a href="#EN-US_CONCEPT_0000001176741953__fig539983713414">Figure 1</a>, HostB can simulate a user to send a large number of ND messages to other devices, causing Device to be attacked.</p>
<div class="fignone" id="EN-US_CONCEPT_0000001176741953__fig539983713414"><a name="EN-US_CONCEPT_0000001176741953__fig539983713414"></a><a name="fig539983713414"></a><span class="figcap"><b>Figure 1 </b>Network diagram of ND attack defense</span><br><span><img class="vsd" src="figure/en-us_image_0000001176662085.png"></span></div>
</div>
<div class="section"><h4 class="sectiontitle">Attack Detection for ND Messages with Fixed Source MAC Addresses</h4><p>The system collects statistics about ND messages sent to the CPU based on the source MAC addresses of the messages. If the number of ND messages with the same source MAC address received within 5 seconds exceeds a specified threshold, the system considers that an attack has occurred and adds the MAC address to an attack entry. Before the attack entry ages out, the system performs the following operations based on a configured detection mode:</p>
<ul><li>If the detection mode is set to filter, the system generates log information and filters out ND messages sent from the source MAC address.</li><li>If the detection mode is set to monitor, the system generates only log information and does not filter out ND messages sent from the source MAC address.</li></ul>
<p>After a configured aging time expires, the ND attack entries with fixed source MAC addresses are aged out. Some important servers may send a large number of ND messages. To prevent these messages from being filtered out, configure the MAC addresses of the servers as protected ones.</p>
</div>
<div class="section"><h4 class="sectiontitle">MAC Address Check for ND</h4><p>To improve network reliability, configure the system to proactively check source MAC address consistency for four types of ICMPv6 messages. The check rules are as follows:</p>
<ul><li><p>NS: The system checks whether the source MAC address is the same as the MAC address in the Source Link-Layer Address (SLLA) option. If not, the NS message is discarded.</p>
</li><li><p>NA: The system checks whether the source MAC address is the same as the MAC address in the Target Link-layer Address (TLLA) option. If not, the NA message is discarded.</p>
</li><li><p>RS: The system checks whether the source MAC address is the same as the MAC address in the SLLA. If not, the RS message is discarded.</p>
</li><li><p>RA: The system checks whether the source MAC address is the same as the MAC address in the SLLA. If not, the RA message is discarded.</p>
</li></ul>
</div>
<div class="section"><h4 class="sectiontitle">Benefits</h4><p>Source MAC address-based ND attack defense improves network reliability and prevents ND attack messages with source MAC addresses from consuming CPU resources, protecting other services.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_nd_cfg_0035.html">Configuring Source MAC Address-based ND Attack Defense
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_nd_cfg_0037.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>