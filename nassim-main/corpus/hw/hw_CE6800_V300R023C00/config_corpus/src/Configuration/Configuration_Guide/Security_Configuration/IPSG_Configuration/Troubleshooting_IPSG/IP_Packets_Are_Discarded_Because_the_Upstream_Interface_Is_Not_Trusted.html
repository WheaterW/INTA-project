
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="IP Packets Are Discarded Because the Upstream Interface Is Not Trusted">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_IPSG_cfg_0016.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_IPSG_cfg_0018.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_IPSG_cfg_0020.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="IPSG">
<meta name="featuretype" content="Security">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPSG">
<meta name="featuretype" content="Security">
<meta name="featurename" content="IPSG">
<meta name="featuretype" content="Security">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001563889229">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>IP Packets Are Discarded Because the Upstream Interface Is Not Trusted</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001563889229"></a><a name="EN-US_TASK_0000001563889229"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">IP Packets Are Discarded Because the Upstream Interface Is Not Trusted</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001563889229__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><div class="p"><h4 class="sectiontitle">Fault Symptom</h4><p>After IPSG is enabled in a VLAN, none of the hosts in the VLAN can access the Internet, and IP packets from these hosts are discarded.</p>
<div class="p">In <a href="#EN-US_TASK_0000001563889229__fig731121412439">Figure 1</a>, PC1 and PC2 belong to VLAN 10, and Interface1 allows packets from VLAN 10. The static binding entries of PC1 and PC2 have been configured on DeviceA, and IPSG has been enabled in VLAN 10. The PCs can communicate with each other, but cannot access the Internet. The following uses PC1 as an example.<ul><li>PC1 sends a packet to the Internet. When the packet reaches Interface1 on DeviceA, DeviceA detects that the packet matches a binding entry, and forwards it.</li><li>A packet is sent from the Internet to PC1. When the packet reaches Interface3 (which belongs to VLAN 10) on DeviceA, DeviceA detects that the packet does not match any binding entry, and discards the packet.</li></ul>
</div>
<div class="fignone" id="EN-US_TASK_0000001563889229__fig731121412439"><a name="EN-US_TASK_0000001563889229__fig731121412439"></a><a name="fig731121412439"></a><span class="figcap"><b>Figure 1 </b>Network diagram for scenarios where IP packets are discarded because the upstream interface is not trusted</span><br><span><img class="vsd" src="figure/en-us_image_0000001563769621.png"></span></div>
<h4 class="sectiontitle">Possible Causes</h4><p>The upstream interface is not configured as a trusted interface in the IPSG-enabled VLAN.</p>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001563889229__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Check whether the upstream interface belongs to the IPSG-enabled VLAN.</span><p><pre class="screen"><a href="cmdqueryname=display+ip+source+check+user-bind+status+static"><b><span class="cmdname">display ip source check user-bind status static</span></b></a> [ { <strong>interface</strong> <em>interface-type</em> <em>interface-number </em>| <strong>ip-address</strong> <em>ip-address</em> | <strong>mac-address</strong> <em>mac-address</em> | <strong>vlan</strong>  <em>vlan-id</em> } * ] [ <strong>valid </strong>|<strong> invalid </strong>] [ <strong>slot </strong><em>slot-id</em> ]</pre>
</p></li><li><span>If the upstream interface belongs to the VLAN, configure the interface as a trusted interface; otherwise, the return packets will be discarded because they do not match the binding entries.</span><p><ol type="a"><li>Enter the system view.<pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</li><li>Enable DHCP globally.<pre class="screen"><a href="cmdqueryname=dhcp+enable"><b><span class="cmdname">dhcp enable</span></b></a></pre>
</li><li>Enable DHCP snooping globally.<pre class="screen"><a href="cmdqueryname=dhcp+snooping+enable"><b><span class="cmdname">dhcp snooping enable</span></b></a></pre>
</li><li>Configure Interface3 as a trusted interface in the interface view.<pre class="screen"><a href="cmdqueryname=dhcp+snooping+trusted"><b><span class="cmdname">dhcp snooping trusted</span></b></a></pre>
</li></ol>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_IPSG_cfg_0016.html">Troubleshooting IPSG
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_IPSG_cfg_0018.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_IPSG_cfg_0020.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>