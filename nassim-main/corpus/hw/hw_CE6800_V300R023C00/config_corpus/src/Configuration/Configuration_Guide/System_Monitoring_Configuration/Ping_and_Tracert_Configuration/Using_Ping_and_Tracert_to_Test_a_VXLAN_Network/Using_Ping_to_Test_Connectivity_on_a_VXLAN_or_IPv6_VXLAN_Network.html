
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Using Ping to Test Connectivity on a VXLAN or IPv6 VXLAN Network">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ping_tracert_cfg_0018.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ping_tracert_cfg_0020.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Ping and Tracert">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Ping and Tracert">
<meta name="featuretype" content="System Monitoring">
<meta name="featurename" content="Ping and Tracert">
<meta name="featuretype" content="System Monitoring">
<meta name="featurename" content="Ping and Tracert">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176744459">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Using Ping to Test Connectivity on a VXLAN or IPv6 VXLAN Network</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176744459"></a><a name="EN-US_TASK_0000001176744459"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Using Ping to Test Connectivity on a VXLAN or IPv6 VXLAN Network</h1>
<div class="taskbody"><div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001176744459__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before using the VXLAN ping function to test connectivity of a VXLAN tunnel, ensure that the VXLAN or IPv6 VXLAN network has been configured correctly.</p>
<div class="note" id="EN-US_TASK_0000001176744459__note6882201774115"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001176744459__p054616128591">This function is supported only on the <span>CE8855, CE8851-32CQ4BQ, CE6855-48XS8CQ, CE6885, CE6885-SAN, CE6885-LL (standard forwarding mode), CE6885-T, CE6863E-48S8CQ, </span><span>CE6866, CE6860-SAN, CE6866K, CE6860-HAM, CE8851-32CQ8DQ-P, CE8850-SAN, CE8851K, CE8850-HAM</span>, and <span>CE6820H, CE6820H-K, CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6820S</span>.</p>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176744459__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>A VXLAN tunnel is specified by a pair of VTEP IP addresses. A static VXLAN tunnel is created by manually configuring the VXLAN Network Identifier (VNI), IP addresses, and ingress replication lists for the local and remote VTEPs. The tunnel can go up as long as the two VTEPs can communicate with each other at Layer 3.</p>
<p>The following uses an IPv4 scenario as an example. In <a href="#EN-US_TASK_0000001176744459__fig_dc_vrp_feature_ping_102801">Figure 1</a>, DeviceA is connected to Server1, and DeviceC is connected to Server2. To enable communication between VMs on Server1 and Server2, VNIs and VTEP IP addresses are configured for DeviceA and DeviceC to create a static VXLAN tunnel between them. DeviceB is a forwarding device on the IP network.</p>
<div class="fignone" id="EN-US_TASK_0000001176744459__fig_dc_vrp_feature_ping_102801"><a name="EN-US_TASK_0000001176744459__fig_dc_vrp_feature_ping_102801"></a><a name="fig_dc_vrp_feature_ping_102801"></a><span class="figcap"><b>Figure 1 </b>VXLAN network diagram</span><br><span><img class="vsd" src="figure/en-us_image_0000001130625012.png"></span></div>
<div class="p">A VNI-based VXLAN ping test can be initiated on DeviceA (source) to check its connectivity with DeviceC (destination). The ping process is as follows:<ol><li>DeviceA sends a VXLAN Echo Request message to DeviceC. The ping test can be initiated by specifying parameters of the following combinations:<ul><li>VNI, source VTEP IP address, and destination VTEP IP address</li><li>VNI, source VTEP IP address, destination VTEP IP address, and VXLAN source port number</li><li>VNI, source VTEP IP address, destination VTEP IP address, and 7-tuple information</li></ul>
</li><li>When receiving the VXLAN Echo Request message, DeviceC verifies the VNI information and returns a VXLAN Echo Reply message.</li><li>DeviceA receives the VXLAN Echo Reply packet from DeviceC. The VXLAN ping test is now complete.</li></ol>
</div>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>After the VXLAN ping/tracert function is enabled using the <a href="cmdqueryname=nqa+vxlanecho+enable"><b><span class="cmdname">nqa vxlanecho enable</span></b></a> command, packets with the destination MAC address 00:00:5E:90:00:01 are identified as VXLAN ping/tracert packets and cannot be forwarded normally.</p>
<p>By default, the source IP address used to perform a ping or tracert operation on a VXLAN network is on the underlay network. If you are not sure whether there is a route from the remote end to the local end, specify the <strong>-a</strong> parameter to configure the IP address of the tunnel as the source IP address.</p>
</div></div>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0000001176744459__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Test connectivity of an IPv4 VXLAN tunnel.</span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>(Optional) Enable the VXLAN ping function on the source.</span><p><ol type="a"><li>Enable the VXLAN ping function, and configure the UDP port number used in VXLAN packets.<pre class="screen"><a href="cmdqueryname=nqa+vxlanecho+enable"><b><span class="cmdname">nqa vxlanecho enable</span></b></a> <strong><span>udp-port</span></strong> <i><span class="varname">udpPort</span></i> [ <strong><span>source-ip-interface</span></strong> { <i><span class="varname">ifName</span></i> | <i><span class="varname">ifType</span></i> <i><span class="varname">ifNum</span></i> } ]</pre>
</li><li>Commit the configuration.<pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</li></ol>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This step is mandatory if the <strong><span>-r</span></strong> <i><span class="varname">replymode</span></i> parameter is set to <strong>3</strong> in the <a href="cmdqueryname=ping+vxlan"><b><span class="cmdname">ping vxlan</span></b></a> command on the source.</p>
</div></div>
</p></li><li class="substepexpand"><span>Enable the VXLAN ping function on the destination.</span><p><ol type="a"><li>Enable the VXLAN ping function, and configure the UDP port number used in VXLAN packets.<pre class="screen"><a href="cmdqueryname=nqa+vxlanecho+enable"><b><span class="cmdname">nqa vxlanecho enable</span></b></a> <strong><span>udp-port</span></strong> <i><span class="varname">udpPort</span></i> [ <strong><span>source-ip-interface</span></strong> { <i><span class="varname">ifName</span></i> | <i><span class="varname">ifType</span></i> <i><span class="varname">ifNum</span></i> } ]</pre>
</li><li>Commit the configuration.<pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</li></ol>
</p></li><li class="substepexpand"><span>Initiate a connectivity test for an IPv4 VXLAN tunnel.</span><p><pre class="screen"><a href="cmdqueryname=ping+vxlan"><b><span class="cmdname">ping vxlan</span></b></a> [ <strong><span>-c</span></strong> <i><span class="varname">count</span></i> | <strong><span>-m</span></strong> <i><span class="varname">interval</span></i> | <strong><span>-t</span></strong> <i><span class="varname">timeout</span></i> | <strong><span>-r</span></strong> <i><span class="varname">replymode</span></i> | <strong><span>-a</span></strong> <em>innersrc-address</em> | <strong><span>-tos</span></strong> <i><span class="varname">tos</span></i> ] <sup>*</sup> <strong><span>vni</span></strong> <i><span class="varname">vniid</span></i> <strong><span>source</span></strong> <em>source-address</em> <strong><span>peer</span></strong> <em>dest-address</em> [ <strong><span>udp-port</span></strong> <i><span class="varname">dest-port</span></i> ] [ <strong><span>load-balance</span></strong> { <strong><span>vxlan-source-udpport</span></strong> <em>vxlan-source-udpport</em> [ <i><span class="varname">vxlan-source-end-udpport</span></i> ] | { <strong><span>source-address</span></strong> <em>lb-src-address</em> <strong><span>destination-address</span></strong> <em>lb-dst-address</em> <strong><span>protocol</span></strong> { <strong><span>udp</span></strong> | <em>lb-protocolid</em> } <strong><span>source-port</span></strong> <em>lb-src-port</em> <strong><span>destination-port</span></strong> <em>lb-dst-port</em> <strong><span>source-mac</span></strong> <i><span class="varname">source-mac</span></i> <strong><span>destination-mac</span></strong> <i><span class="varname">destination-mac</span></i> } } ]</pre>
</p></li></ol>
<p><p>The command output contains the following information:</p>
<ul><li><p>Response to each test packet: If no response packet is received before the timer on the source expires, the message "Request time out" is displayed. If a response packet is received, information such as the number of bytes in the payload, packet sequence number, and response time is displayed.</p>
</li><li><p>Ping statistics: include the numbers of sent and received packets, the packet loss rate, and the minimum, maximum, and average response time durations.</p>
</li></ul>
</p></li><li><span>Test connectivity of an IPv6 VXLAN tunnel.</span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>(Optional) Enable the VXLAN ping function on the source.</span><p><pre class="screen"><a href="cmdqueryname=nqa+vxlanecho+enable"><b><span class="cmdname">nqa vxlanecho enable</span></b></a> <strong><span>ipv6</span></strong> <strong><span>udp-port</span></strong> <i><span class="varname">udpPort6</span></i> [ <strong><span>source-ip-interface</span></strong> { <i><span class="varname">ifName6</span></i> | <i><span class="varname">ifType6</span></i> <i><span class="varname">ifNum6</span></i> } ]</pre>
</p><p><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This step is mandatory if the <strong><span>-r</span></strong> <i><span class="varname">replymode</span></i> parameter is set to <strong>3</strong> in the <a href="cmdqueryname=ping+vxlan"><b><span class="cmdname">ping vxlan</span></b></a> command on the source.</p>
</div></div>
</p></li><li class="substepexpand"><span>Enable the VXLAN ping function on the destination, and set the listening port number for the VXLAN server.</span><p><pre class="screen"><a href="cmdqueryname=nqa+vxlanecho+enable"><b><span class="cmdname">nqa vxlanecho enable</span></b></a> <strong><span>ipv6</span></strong> <strong><span>udp-port</span></strong> <i><span class="varname">udpPort6</span></i> [ <strong><span>source-ip-interface</span></strong> { <i><span class="varname">ifName6</span></i> | <i><span class="varname">ifType6</span></i> <i><span class="varname">ifNum6</span></i> } ]</pre>
</p></li><li class="substepexpand"><span>Initiate a connectivity test for an IPv6 VXLAN tunnel.</span><p><pre class="screen"><a href="cmdqueryname=ping+vxlan"><b><span class="cmdname">ping vxlan</span></b></a> [ <strong><span>-c</span></strong> <i><span class="varname">count</span></i> | <strong><span>-m</span></strong> <i><span class="varname">interval</span></i> | <strong><span>-t</span></strong> <i><span class="varname">timeout</span></i> | <strong><span>-r</span></strong> <i><span class="varname">replymode</span></i> | <strong><span>-a</span></strong> <em>innersrc-address6</em> | <strong><span>-tos</span></strong> <i><span class="varname">tos</span></i> ] <sup>*</sup> <strong><span>ipv6</span></strong> <strong><span>vni</span></strong> <i><span class="varname">vniid</span></i> <strong><span>source</span></strong> <em>source-address6</em> <strong><span>peer</span></strong> <em>dest-address6</em> [ <strong><span>udp-port</span></strong> <i><span class="varname">dest-port</span></i> ] [ <strong><span>load-balance</span></strong> { <strong><span>vxlan-source-udpport</span></strong> <em>vxlan-source-udpport</em> [ <i><span class="varname">vxlan-source-end-udpport</span></i> ] | { <strong><span>source-address</span></strong> <em>lb-src-address</em> <strong><span>destination-address</span></strong> <em>lb-dst-address</em> <strong><span>protocol</span></strong> { <strong><span>udp</span></strong> | <em>lb-protocolid</em> } <strong><span>source-port</span></strong> <em>lb-src-port</em> <strong><span>destination-port</span></strong> <em>lb-dst-port</em> <strong><span>source-mac</span></strong> <i><span class="varname">source-mac</span></i> <strong><span>destination-mac</span></strong> <i><span class="varname">destination-mac</span></i> } } ]</pre>
</p></li></ol>
<p><p>The command output contains the following information:</p>
<ul><li><p>Response to each test packet: If no response packet is received before the timer on the source expires, the message "Request time out" is displayed. If a response packet is received, information such as the number of bytes in the payload, packet sequence number, and response time is displayed.</p>
</li><li><p>Ping statistics: include the numbers of sent and received packets, the packet loss rate, and the minimum, maximum, and average response time durations.</p>
</li></ul>
</p></li></ul></div>
<div class="example"><a name="EN-US_TASK_0000001176744459__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Example</h4><ul><li>Test connectivity of the IPv4 VXLAN tunnel between the source 10.1.1.1 and the destination 10.2.2.1.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>ping vxlan vni 111 source 10.1.1.1 peer 10.2.2.1 udp-port 5001</strong> 
PING VXLAN: vni 111 source 10.1.1.1 peer 10.2.2.1, press CTRL_C to break
    Reply from 10.2.2.1 bytes=52 Sequence=1 time=3 ms
    Reply from 10.2.2.1 bytes=52 Sequence=2 time=3 ms
    Reply from 10.2.2.1 bytes=52 Sequence=3 time=2 ms
    Reply from 10.2.2.1 bytes=52 Sequence=4 time=3 ms
    Reply from 10.2.2.1 bytes=52 Sequence=5 time=3 ms

  --- ping vxlan statistics ---
    5 packet(s) transmitted
    5 packet(s) received
    0.00% packet loss
    round-trip min/avg/max = 2/2/3 ms</pre>
</li><li>Test connectivity of the IPv6 VXLAN tunnel between the source 2001:DB8:1::1 and the destination 2001:DB8:2::1.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> </strong><strong>ping vxlan ipv6 vni 60 source 2001:DB8:1::1 peer 2001:DB8:2::1</strong>
PING VXLAN IPV6: vni 60 source 2001:DB8:1::1 peer 2001:DB8:2::1, press CTRL_C to break
    Reply from 2001:DB8:2::1 
    bytes=52 Sequence=1 time=167 ms
    Reply from 2001:DB8:2::1 
    bytes=52 Sequence=2 time=2 ms
    Reply from 2001:DB8:2::1 
    bytes=52 Sequence=3 time=1 ms
    Reply from 2001:DB8:2::1 
    bytes=52 Sequence=4 time=2 ms
    Reply from 2001:DB8:2::1 
    bytes=52 Sequence=5 time=2 ms

  --ping vxlan statistics--
    5 packet(s) transmitted
    5 packet(s) received
    0.00% packet loss
    round-trip min/avg/max = 1/34/167 ms </pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_ping_tracert_cfg_0018.html">Using Ping and Tracert to Test a VXLAN Network
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_ping_tracert_cfg_0020.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>