
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Multi-Level M-LAG (V-STP Mode)">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_cfg_m-lag_0020.html">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_cfg_m-lag_0024.html">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_cfg_m-lag_0082.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="M-LAG">
<meta name="featuretype" content="High Availability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="M-LAG">
<meta name="featuretype" content="High Availability">
<meta name="featurename" content="M-LAG">
<meta name="featuretype" content="High Availability">
<meta name="featuretype" content="High Availability">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001715064873">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Multi-Level M-LAG (V-STP Mode)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001715064873"></a><a name="EN-US_TASK_0000001715064873"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Multi-Level M-LAG (V-STP Mode)</h1>
<div class="taskbody" id="taskbody0000001715064873"><p id="shortdesc10481832172748"></p>
<div class="context"><a name="EN-US_TASK_0000001715064873__1.4.1"></a><a name="1.4.1"></a>
<div class="p" id="EN-US_TASK_0000001715064873__context1729641507182247"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001715064873__p1105027453182247">In <a href="#EN-US_TASK_0000001715064873__fig7709173194617">Figure 1</a>, multi-level M-LAG ensures reliability, improves link utilization, and expands the network scale in dual-homing mode, meeting customer requirements. In addition, aggregation devices function as dual-active gateways, and core and aggregation devices are cross-connected to ensure device-level reliability. A server is connected to access devices in load balancing or active/standby mode. If load balancing mode is used for server access, you are advised to configure the M-LAG to work in dual-active mode. If active/standby mode is used for server access, you are advised to configure the M-LAG to work in active/standby mode. In this example, the server is connected to access devices in load balancing mode. M-LAG devices at the access and aggregation layers use independent links as DAD links to improve reliability.</p>
<div class="fignone" id="EN-US_TASK_0000001715064873__fig7709173194617"><a name="EN-US_TASK_0000001715064873__fig7709173194617"></a><a name="fig7709173194617"></a><span class="figcap"><b>Figure 1 </b>Network diagram for configuring multi-level M-LAG</span><div class="note" id="EN-US_TASK_0000001715064873__note19324144914614"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001715064873__p17324104911462">In this example, interface 1, interface 2, interface 3, interface 4, interface 5, interface 6, and interface 7 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, <span>100GE</span> <span>1/0/3</span>, <span>100GE</span> <span>1/0/4</span>, <span>100GE</span> <span>1/0/5</span>, <span>100GE</span> <span>1/0/6</span>, and <span>100GE</span> <span>1/0/7</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001715064873__image1970912318461" src="figure/en-us_image_0000002001229902.png" width="NaN" height="NaN"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" id="EN-US_TASK_0000001715064873__table2134639627182247" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Data plan</caption><thead align="left"><tr id="EN-US_TASK_0000001715064873__row259723275182247"><th align="left" class="cellrowborder" valign="top" width="25%" id="mcps1.4.1.4.2.5.1.1" liSelected="liSelected"><p id="EN-US_TASK_0000001715064873__p1906802739182247">Device Name</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="25%" id="mcps1.4.1.4.2.5.1.2" liSelected="liSelected"><p id="EN-US_TASK_0000001715064873__p1705841693182247">Interface</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="25%" id="mcps1.4.1.4.2.5.1.3" liSelected="liSelected"><p id="EN-US_TASK_0000001715064873__p1148839495182247">IP Address</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="25%" id="mcps1.4.1.4.2.5.1.4" liSelected="liSelected"><p id="EN-US_TASK_0000001715064873__p2019963615182247">Virtual MAC Address</p>
</th>
</tr>
</thead>
<tbody><tr id="EN-US_TASK_0000001715064873__row74949349182247"><td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.1 "><p id="EN-US_TASK_0000001715064873__p2146308955182247">DeviceA</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.2 "><p id="EN-US_TASK_0000001715064873__p771441795182247"><span>100GE</span><span>1/0/4</span></p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.3 "><p id="EN-US_TASK_0000001715064873__p103106103182247">10.1.1.1/24</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.4 "><p id="EN-US_TASK_0000001715064873__p1595715105182247">-</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001715064873__row902996969182247"><td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.1 "><p id="EN-US_TASK_0000001715064873__p1508356932182247">DeviceB</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.2 "><p id="EN-US_TASK_0000001715064873__p1824178321182247"><span>100GE</span><span>1/0/4</span></p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.3 "><p id="EN-US_TASK_0000001715064873__p1242418549182247">10.1.1.2/24</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.4 "><p id="EN-US_TASK_0000001715064873__p865415385182247">-</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001715064873__row1071234970182247"><td class="cellrowborder" rowspan="5" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.1 "><p id="EN-US_TASK_0000001715064873__p1403244742182247">DeviceC</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.2 "><p id="EN-US_TASK_0000001715064873__p84152494182247"><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.3 "><p id="EN-US_TASK_0000001715064873__p440226619182247">10.4.1.1/24</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.4 "><p id="EN-US_TASK_0000001715064873__p28073859182247">-</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001715064873__row785154442012"><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.1 "><p id="EN-US_TASK_0000001715064873__p108684412011"><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.2 "><p id="EN-US_TASK_0000001715064873__p1807887555182247">10.5.1.1/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.3 "><p id="EN-US_TASK_0000001715064873__p188614412018">-</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001715064873__row287656109182247"><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.1 "><p id="EN-US_TASK_0000001715064873__p1980655515182247">VLANIF 11</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.2 "><p id="EN-US_TASK_0000001715064873__p536135159182247">10.3.1.1/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.3 "><p id="EN-US_TASK_0000001715064873__p867904355182247">0000-5e00-0110</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001715064873__row759455325310"><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.1 "><p id="EN-US_TASK_0000001715064873__p759425320533">VLANIF 100</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.2 "><p id="EN-US_TASK_0000001715064873__p7594205375319">10.10.10.1/30</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.3 "><p id="EN-US_TASK_0000001715064873__p65947534535">-</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001715064873__row1970716028182247"><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.1 "><p id="EN-US_TASK_0000001715064873__p14711141122111"><span>100GE</span><span>1/0/5</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.2 "><p id="EN-US_TASK_0000001715064873__p11798174620217">10.2.1.1/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.3 "><p id="EN-US_TASK_0000001715064873__p1890996890182247">-</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001715064873__row332500059182247"><td class="cellrowborder" rowspan="5" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.1 "><p id="EN-US_TASK_0000001715064873__p452179649182247">DeviceD</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.2 "><p id="EN-US_TASK_0000001715064873__p197581511102211"><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.3 "><p id="EN-US_TASK_0000001715064873__p14923143613224">10.6.1.1/24</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.4 "><p id="EN-US_TASK_0000001715064873__p1732033821182247">-</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001715064873__row5737142392217"><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.1 "><p id="EN-US_TASK_0000001715064873__p18737823182211"><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.2 "><p id="EN-US_TASK_0000001715064873__p189231336102218">10.7.1.1/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.3 "><p id="EN-US_TASK_0000001715064873__p2737423112215">-</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001715064873__row1068428838182247"><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.1 "><p id="EN-US_TASK_0000001715064873__p814873322182247">VLANIF 11</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.2 "><p id="EN-US_TASK_0000001715064873__p1366227744182247">10.3.1.1/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.3 "><p id="EN-US_TASK_0000001715064873__p49556407182247">0000-5e00-0110</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001715064873__row3565141555517"><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.1 "><p id="EN-US_TASK_0000001715064873__p1833322035517">VLANIF 100</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.2 "><p id="EN-US_TASK_0000001715064873__p13565315135518">10.10.10.2/30</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.3 "><p id="EN-US_TASK_0000001715064873__p20565201535516">-</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001715064873__row1306104162182247"><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.1 "><p id="EN-US_TASK_0000001715064873__p318437194182247"><span>100GE</span><span>1/0/5</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.2 "><p id="EN-US_TASK_0000001715064873__p79275192215">10.2.1.2/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.3 "><p id="EN-US_TASK_0000001715064873__p1170704907182247">-</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001715064873__row1630699679182247"><td class="cellrowborder" rowspan="2" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.1 "><p id="EN-US_TASK_0000001715064873__p760493235182247">DeviceE</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.2 "><p id="EN-US_TASK_0000001715064873__p1993581413233"><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.3 "><p id="EN-US_TASK_0000001715064873__p1414218802182247">10.4.1.2/24</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.4 "><p id="EN-US_TASK_0000001715064873__p227466636182247">-</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001715064873__row1309069994182247"><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.1 "><p id="EN-US_TASK_0000001715064873__p1893551416232"><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.2 "><p id="EN-US_TASK_0000001715064873__p999932071182247">10.7.1.2/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.3 "><p id="EN-US_TASK_0000001715064873__p598370246182247">-</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001715064873__row573306844182247"><td class="cellrowborder" rowspan="2" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.1 "><p id="EN-US_TASK_0000001715064873__p1239608418182247">DeviceF</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.2 "><p id="EN-US_TASK_0000001715064873__p1835191820233"><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.3 "><p id="EN-US_TASK_0000001715064873__p1531488205182247">10.6.1.2/24</p>
</td>
<td class="cellrowborder" valign="top" width="25%" headers="mcps1.4.1.4.2.5.1.4 "><p id="EN-US_TASK_0000001715064873__p563621141182247">-</p>
</td>
</tr>
<tr id="EN-US_TASK_0000001715064873__row1448467008182247"><td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.1 "><p id="EN-US_TASK_0000001715064873__p10835618152318"><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.2 "><p id="EN-US_TASK_0000001715064873__p1053780974182247">10.5.1.2/24</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.4.1.4.2.5.1.3 "><p id="EN-US_TASK_0000001715064873__p1596698938182247">-</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001715064873__1.4.2"></a><a name="1.4.2"></a>
<div class="p" id="EN-US_TASK_0000001715064873__context1606935336182247"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0000001715064873__p654690404182247">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0000001715064873__ol1418876627182247"><li id="EN-US_TASK_0000001715064873__li1606028607182247"><p id="EN-US_TASK_0000001715064873__p800838706182247"><a name="EN-US_TASK_0000001715064873__li1606028607182247"></a><a name="li1606028607182247"></a>On DeviceA and DeviceB at the access layer, configure M-LAG, links between the access and aggregation layers, and server access.</p>
</li><li id="EN-US_TASK_0000001715064873__li1016583302182247"><p id="EN-US_TASK_0000001715064873__p335661182182247"><a name="EN-US_TASK_0000001715064873__li1016583302182247"></a><a name="li1016583302182247"></a>On DeviceC and DeviceD at the aggregation layer, configure M-LAG, links between the aggregation and access layers, Layer 3 gateways, and the egress network.</p>
</li><li id="EN-US_TASK_0000001715064873__li1231529661182247"><p id="EN-US_TASK_0000001715064873__p871622641182247"><a name="EN-US_TASK_0000001715064873__li1231529661182247"></a><a name="li1231529661182247"></a>On DeviceE and DeviceF at the core layer, configure interface IP addresses and enable OSPF to implement Layer 3 communication with the aggregation layer.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001715064873__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001715064873__steps1311463869182247"><li id="EN-US_TASK_0000001715064873__step239906426182247"><span id="EN-US_TASK_0000001715064873__cmd1280496363182247">Configure DeviceA and DeviceB at the access layer.</span><ol type="a" id="EN-US_TASK_0000001715064873__substeps642865215366"><li class="substepexpand" id="EN-US_TASK_0000001715064873__substep114281252203619"><span id="EN-US_TASK_0000001715064873__cmd124281523360">Configure M-LAG.</span><p><p id="EN-US_TASK_0000001715064873__p11933106133711"># Configure M-LAG in V-STP mode.</p>
<p id="EN-US_TASK_0000001715064873__p79771227151110">Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen39291133154211">&lt;<span class="keyword" id="EN-US_TASK_0000001715064873__keyword149331542644">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001715064873__b722817711439">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword48838083919"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001715064873__keyword13902114584318">HUAWEI</span>] <strong id="EN-US_TASK_0000001715064873__b6518010124412">sysname DeviceA</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword440816376426">*</span><span class="keyword" id="EN-US_TASK_0000001715064873__keyword141152516191">HUAWEI</span>] <strong id="EN-US_TASK_0000001715064873__b13212155473">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword19746182910475"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001715064873__b89731493123">stp mode rstp</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword10597145664710">*</span>DeviceA] <strong id="EN-US_TASK_0000001715064873__b3251131261217">stp v-stp enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword66591446105011">*</span>DeviceA] <strong id="EN-US_TASK_0000001715064873__b1488461311122">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p919264331110">Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen12398420141118">&lt;<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1939832015118">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001715064873__b17398820151114">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword113984202117"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001715064873__keyword839852019117">HUAWEI</span>] <strong id="EN-US_TASK_0000001715064873__b2398192013116">sysname DeviceB</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword8398112016112">*</span><span class="keyword" id="EN-US_TASK_0000001715064873__keyword11342732205">HUAWEI</span>] <strong id="EN-US_TASK_0000001715064873__b139852014114">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword539882031117"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001715064873__b922461661214">stp mode rstp</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1039892010113">*</span>DeviceB] <strong id="EN-US_TASK_0000001715064873__b1381618121212">stp v-stp enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword5398132017119">*</span>DeviceB] <strong id="EN-US_TASK_0000001715064873__b84601919111211">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p10564740195915"># Configure a DFS group and bind IP addresses to the DFS group.</p>
<p id="EN-US_TASK_0000001715064873__p830443541418">Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen37281211317">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword14344291133"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001715064873__b14562154812145">dfs-group 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword19683916966">*</span>DeviceA-dfs-group-1] <strong id="EN-US_TASK_0000001715064873__b86801850151417">priority 150</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword126392581469">*</span>DeviceA-dfs-group-1] <strong id="EN-US_TASK_0000001715064873__b842995316147">dual-active detection source ip 10.1.1.1 peer 10.1.1.2</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword481219314811">*</span>DeviceA-dfs-group-1] <strong id="EN-US_TASK_0000001715064873__b14709115610144">authentication-mode hmac-sha256 password YsHsjx_202206</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1762020393">*</span>DeviceA-dfs-group-1] <strong id="EN-US_TASK_0000001715064873__b167411758121411">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword155543517915">*</span>DeviceA] <strong id="EN-US_TASK_0000001715064873__b168501924153">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p4587181711518">Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen1730532811515">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword13051628131511"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001715064873__b7305152871517">dfs-group 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword123052288157">*</span>DeviceB-dfs-group-1] <strong id="EN-US_TASK_0000001715064873__b5305102820156">priority 120</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword143050282155">*</span>DeviceB-dfs-group-1] <strong id="EN-US_TASK_0000001715064873__b1930542812153">dual-active detection source ip 10.1.1.2 peer 10.1.1.1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword103051828151512">*</span>DeviceB-dfs-group-1] <strong id="EN-US_TASK_0000001715064873__b133051628161513">authentication-mode hmac-sha256 password YsHsjx_202206</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword123053286154">*</span>DeviceB-dfs-group-1] <strong id="EN-US_TASK_0000001715064873__b19305162820159">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1630512861515">*</span>DeviceB] <strong id="EN-US_TASK_0000001715064873__b15305202816152">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p64844207530"># Deploy an independent direct physical link for M-LAG heartbeat detection.</p>
<p id="EN-US_TASK_0000001715064873__p3175523161211">Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen1366765113536">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1842613175412"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001715064873__b20733165591217">interface <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword167591818559"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001715064873__b090804991216">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword15271142935512">*</span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001715064873__b1614730191318">ip address 10.1.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword185044206597">*</span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001715064873__b64401311137">m-lag unpaired-port reserved</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword175903591736">*</span>DeviceA-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001715064873__b03212841316">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1121932614599">*</span>DeviceA] <strong id="EN-US_TASK_0000001715064873__b14187111017138">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p75574401130">Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen2068785821315">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1468715810137"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001715064873__b1068785814132">interface <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword468765814131"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001715064873__b26871958101313">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword136875583136">*</span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001715064873__b176871358111311">ip address 10.1.1.2 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword18687115816130">*</span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001715064873__b268755841314">m-lag unpaired-port reserved</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword13687558141317">*</span>DeviceB-<span>100GE</span><span>1/0/4</span>] <strong id="EN-US_TASK_0000001715064873__b10687958121310">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword116881458141315">*</span>DeviceB] <strong id="EN-US_TASK_0000001715064873__b568875814138">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p195144681615"># Configure peer-link interfaces in the M-LAG.</p>
<p id="EN-US_TASK_0000001715064873__p9995173219170">Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen137131945191718">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword67139450176"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001715064873__b22731215181">interface Eth-Trunk0</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword2713104516174">*</span>DeviceA-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b8257145814199">trunkport <span>100ge</span> <span>1/0/5</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword97131045141711">*</span>DeviceA-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b13530611162020">trunkport <span>100ge</span> <span>1/0/6</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword137136451174">*</span>DeviceA-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b1518516717215">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword638834962018">*</span>DeviceA-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b16896496216">peer-link 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword2498553112014">*</span>DeviceA-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b916618143213">port vlan exclude 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword57131145141720">*</span>DeviceA-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b77136456177">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword171312452179">*</span>DeviceA] <strong id="EN-US_TASK_0000001715064873__b1871374518177">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p57011220132115">Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen586833117218">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword17868123112215"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001715064873__b286813317219">interface Eth-Trunk0</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword78681131202116">*</span>DeviceB-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b0868143112114">trunkport <span>100ge</span> <span>1/0/5</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword186853115214">*</span>DeviceB-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b20868103122118">trunkport <span>100ge</span> <span>1/0/6</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword148681531192114">*</span>DeviceB-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b2086803114211">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword886814314217">*</span>DeviceB-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b1886843132116">peer-link 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1786853112219">*</span>DeviceB-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b12868113152118">port vlan exclude 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword086863182115">*</span>DeviceB-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b9868113122111">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword10868123118212">*</span>DeviceB] <strong id="EN-US_TASK_0000001715064873__b158681331192117">commit</strong></pre>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001715064873__substep188594208233"><span id="EN-US_TASK_0000001715064873__cmd1859182017232">Configure links between the access and aggregation layers.</span><p><p id="EN-US_TASK_0000001715064873__p1776619254249"># Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen9670145613243">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword122929342254"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001715064873__b42548343314">vlan batch 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1932863871813">*</span>DeviceA] <strong id="EN-US_TASK_0000001715064873__b7744141018264">interface Eth-Trunk10</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword35471594271">*</span>DeviceA-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b4914822132813">trunkport <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword10829185318277">*</span>DeviceA-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b5183142692811">trunkport <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword16797111515316">*</span>DeviceA-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b844114118319">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword57531441112819">*</span>DeviceA-Eth-Trunk10]<strong id="EN-US_TASK_0000001715064873__b892002833118"> port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword153812511307">*</span>DeviceA-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b062017310316">undo port trunk allow-pass vlan 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword5252141711309">*</span>DeviceA-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b287537113115">port trunk allow-pass vlan 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword14565124923020">*</span>DeviceA-Eth-Trunk10]<strong id="EN-US_TASK_0000001715064873__b19132739173116"> dfs-group 1 m-lag 10</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword0268338143320">*</span>DeviceA-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b1526815382332">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword09094553338">*</span>DeviceA] <strong id="EN-US_TASK_0000001715064873__b990911556332">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p115231034142418"># Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen18321949133119">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword5321049203113"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001715064873__b1432115494312">vlan batch 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword13798942171819">*</span>DeviceB] <strong id="EN-US_TASK_0000001715064873__b5321134913115">interface Eth-Trunk10</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword5321154993112">*</span>DeviceB-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b10321849113115">trunkport <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword232184915318">*</span>DeviceB-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b1232194933116">trunkport <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1032124953111">*</span>DeviceB-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b832120490316">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1532124913120">*</span>DeviceB-Eth-Trunk10]<strong id="EN-US_TASK_0000001715064873__b2321949193111"> port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword3321164953111">*</span>DeviceB-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b153212049173112">undo port trunk allow-pass vlan 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword232194911314">*</span>DeviceB-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b4321949183114">port trunk allow-pass vlan 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword7321749153111">*</span>DeviceB-Eth-Trunk10]<strong id="EN-US_TASK_0000001715064873__b1832174913314"> dfs-group 1 m-lag 10</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword18602541341">*</span>DeviceB-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b1860254103419">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword17602104133419">*</span>DeviceB] <strong id="EN-US_TASK_0000001715064873__b260213416342">commit</strong></pre>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001715064873__substep7192125103213"><span id="EN-US_TASK_0000001715064873__cmd1191152523217">Configure server access.</span><p><p id="EN-US_TASK_0000001715064873__p53722047123219"># Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen13273112123418">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1327332114346"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001715064873__b19273142173419">interface Eth-Trunk1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword7273122133420">*</span>DeviceA-Eth-Trunk1] <strong id="EN-US_TASK_0000001715064873__b13273721113420">trunkport </strong><strong id="EN-US_TASK_0000001715064873__b189542071445"><span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword9274102183419">*</span>DeviceA-Eth-Trunk1] <strong id="EN-US_TASK_0000001715064873__b227412219342">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1727382113416">*</span>DeviceA-Eth-Trunk1]<strong id="EN-US_TASK_0000001715064873__b927322110345"> port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1273521103411">*</span>DeviceA-Eth-Trunk1] <strong id="EN-US_TASK_0000001715064873__b22734211343">undo port trunk allow-pass vlan 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword027322113412">*</span>DeviceA-Eth-Trunk1] <strong id="EN-US_TASK_0000001715064873__b02733219342">port trunk allow-pass vlan 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword11273122120348">*</span>DeviceA-Eth-Trunk1]<strong id="EN-US_TASK_0000001715064873__b4273142113416"> dfs-group 1 m-lag 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1227412163415">*</span>DeviceA-Eth-Trunk1] <strong id="EN-US_TASK_0000001715064873__b12274121113412">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1274192112342">*</span>DeviceA] <strong id="EN-US_TASK_0000001715064873__b3274132113343">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p865663464215"># Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen108343534424">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword78341153194218"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001715064873__b08343532422">interface Eth-Trunk1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword15834135384217">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001715064873__b1683417535423">trunkport <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1583515312421">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001715064873__b98351653134215">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1834195319424">*</span>DeviceB-Eth-Trunk1]<strong id="EN-US_TASK_0000001715064873__b11834453134211"> port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword2083435315427">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001715064873__b11834195374212">undo port trunk allow-pass vlan 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword128345533421">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001715064873__b3835125374210">port trunk allow-pass vlan 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword183555311427">*</span>DeviceB-Eth-Trunk1]<strong id="EN-US_TASK_0000001715064873__b11835165314423"> dfs-group 1 m-lag 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword19835953184219">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001715064873__b3835353174215">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1835125311421">*</span>DeviceB] <strong id="EN-US_TASK_0000001715064873__b15835115374219">commit</strong></pre>
</p></li></ol>
</li><li id="EN-US_TASK_0000001715064873__step0219165254415"><span id="EN-US_TASK_0000001715064873__cmd721911525445">Configure DeviceC and DeviceD at the aggregation layer.</span><ol type="a" id="EN-US_TASK_0000001715064873__substeps3663161917469"><li class="substepexpand" id="EN-US_TASK_0000001715064873__substep18091227184615"><span id="EN-US_TASK_0000001715064873__cmd188092027144610">Configure M-LAG.</span><p><p id="EN-US_TASK_0000001715064873__p14809162711461"># Configure M-LAG in V-STP mode.</p>
<p id="EN-US_TASK_0000001715064873__p198091827204614">Configure DeviceC.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen580912714610">&lt;<span class="keyword" id="EN-US_TASK_0000001715064873__keyword88091327194610">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001715064873__b380982714462">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword19809027164616"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001715064873__keyword118091276462">HUAWEI</span>] <strong id="EN-US_TASK_0000001715064873__b8809122712461">sysname DeviceC</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1380912715460">*</span><span class="keyword" id="EN-US_TASK_0000001715064873__keyword6766161292015">HUAWEI</span>] <strong id="EN-US_TASK_0000001715064873__b178097276464">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword2080913272466"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b1380962714614">stp mode rstp</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1680962714612">*</span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b38098277465">stp v-stp enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword280912276462">*</span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b9809827134615">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p1481062711467">Configure DeviceD.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen0810112704617">&lt;<span class="keyword" id="EN-US_TASK_0000001715064873__keyword2810132710468">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001715064873__b1981082719461">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1181012710468"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001715064873__keyword48105278462">HUAWEI</span>] <strong id="EN-US_TASK_0000001715064873__b17810627194616">sysname DeviceD</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword118102027184615">*</span><span class="keyword" id="EN-US_TASK_0000001715064873__keyword5333415162010">HUAWEI</span>] <strong id="EN-US_TASK_0000001715064873__b5810172714619">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword16810132744613"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b58103276461">stp mode rstp</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword188101127104613">*</span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b981013278467">stp v-stp enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1281082704618">*</span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b10810627204617">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p1781272774619"># Configure a DFS group and bind IP addresses to the DFS group.</p>
<p id="EN-US_TASK_0000001715064873__p981242774615">Configure DeviceC.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen10812182774619">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword11812202716462"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b108121627194617">dfs-group 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword10812112774610">*</span>DeviceC-dfs-group-1] <strong id="EN-US_TASK_0000001715064873__b16812162715468">priority 150</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword9812142794616">*</span>DeviceC-dfs-group-1] <strong id="EN-US_TASK_0000001715064873__b4812132718464">dual-active detection source ip 10.2.1.1 peer 10.2.1.2</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword2812132714462">*</span>DeviceC-dfs-group-1] <strong id="EN-US_TASK_0000001715064873__b681272764611">authentication-mode hmac-sha256 password YsHsjx_202206</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword381216278464">*</span>DeviceC-dfs-group-1] <strong id="EN-US_TASK_0000001715064873__b181282715462">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1281216270464">*</span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b881214271460">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p581232719467">Configure DeviceD.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen88121527194616">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword78122277462"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b8812172710461">dfs-group 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword17812527124611">*</span>DeviceD-dfs-group-1] <strong id="EN-US_TASK_0000001715064873__b78125271465">priority 120</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword8812112764614">*</span>DeviceD-dfs-group-1] <strong id="EN-US_TASK_0000001715064873__b188121027154611">dual-active detection source ip 10.2.1.2 peer 10.2.1.1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword0812112716461">*</span>DeviceD-dfs-group-1] <strong id="EN-US_TASK_0000001715064873__b18124272467">authentication-mode hmac-sha256 password YsHsjx_202206</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1081342754618">*</span>DeviceD-dfs-group-1] <strong id="EN-US_TASK_0000001715064873__b13813122710469">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1781302716463">*</span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b1081322714620">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p138109270467"># Deploy an independent direct physical link for M-LAG heartbeat detection.</p>
<p id="EN-US_TASK_0000001715064873__p178101727184618">Configure DeviceC.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen981072774610">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1681015271465"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b15810327154618">interface <span>100ge</span> <span>1/0/5</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword8810152712465"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC-<span>100GE</span><span>1/0/5</span>] <strong id="EN-US_TASK_0000001715064873__b118102278469">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword15810102774610">*</span>DeviceC-<span>100GE</span><span>1/0/5</span>] <strong id="EN-US_TASK_0000001715064873__b981002714615">ip address 10.2.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword78119272468">*</span>DeviceC-<span>100GE</span><span>1/0/5</span>] <strong id="EN-US_TASK_0000001715064873__b18811152784613">m-lag unpaired-port reserved</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword18811172713465">*</span>DeviceC-<span>100GE</span><span>1/0/5</span>] <strong id="EN-US_TASK_0000001715064873__b0811172794619">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword38119278465">*</span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b17811152764612">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p4811182712460">Configure DeviceD.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen1981113271464">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword128111127124613"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b781102710467">interface <span>100ge</span> <span>1/0/5</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword981112719462"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD-<span>100GE</span><span>1/0/5</span>] <strong id="EN-US_TASK_0000001715064873__b1781112734615">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword138111827204619">*</span>DeviceD-<span>100GE</span><span>1/0/5</span>] <strong id="EN-US_TASK_0000001715064873__b1081117273462">ip address 10.2.1.2 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1781110271469">*</span>DeviceD-<span>100GE</span><span>1/0/5</span>] <strong id="EN-US_TASK_0000001715064873__b15811527104618">m-lag unpaired-port reserved</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword381182774618">*</span>DeviceD-<span>100GE</span><span>1/0/5</span>] <strong id="EN-US_TASK_0000001715064873__b0811132717469">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword15812182711462">*</span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b1781232704615">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p581302715462"># Configure peer-link interfaces in the M-LAG.</p>
<p id="EN-US_TASK_0000001715064873__p281317279460">Configure DeviceC.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen48131427114612">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword118137275461"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b108136273463">interface Eth-Trunk0</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword17813127104619">*</span>DeviceC-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b181332724617">trunkport <span>100ge</span> <span>1/0/6</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword18813132794618">*</span>DeviceC-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b8813122719463">trunkport <span>100ge</span> <span>1/0/7</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1881372774611">*</span>DeviceC-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b2813182714618">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword7813152710465">*</span>DeviceC-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b781312278466">peer-link 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword10813142774614">*</span>DeviceC-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b38137279461">port vlan exclude 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword381311279469">*</span>DeviceC-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b8813327204617">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword118131627134620">*</span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b1681313271460">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p16813112714620">Configure DeviceD.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen128135277467">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1981412794617"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b17814112714611">interface Eth-Trunk0</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1581432714618">*</span>DeviceD-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b78145275463">trunkport <span>100ge</span> <span>1/0/6</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword48141727194610">*</span>DeviceD-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b581442734614">trunkport <span>100ge</span> <span>1/0/7</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword14814127134616">*</span>DeviceD-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b18814227134619">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword68141127134611">*</span>DeviceD-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b14814172794619">peer-link 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword18814112719464">*</span>DeviceD-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b78149278469">port vlan exclude 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword18141627114615">*</span>DeviceD-Eth-Trunk0] <strong id="EN-US_TASK_0000001715064873__b38147275464">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword8814327164615">*</span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b2081418279468">commit</strong></pre>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001715064873__substep7307825126"><span id="EN-US_TASK_0000001715064873__cmd12307525128">Configure links between the aggregation and access layers.</span><p><p id="EN-US_TASK_0000001715064873__p10307162515214"># Configure DeviceC.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen7307172511212">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword130711254219"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b130718251727">vlan batch 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword4833162092218">*</span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b1930762519210">interface Eth-Trunk10</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1830752517215">*</span>DeviceC-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b1930712251326">trunkport <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword930742518213">*</span>DeviceC-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b103072251922">trunkport <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword73085251321">*</span>DeviceC-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b33085255214">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword143071425226">*</span>DeviceC-Eth-Trunk10]<strong id="EN-US_TASK_0000001715064873__b3307725321"> port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword5308202518214">*</span>DeviceC-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b0308192516220">undo port trunk allow-pass vlan 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword153087258214">*</span>DeviceC-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b1230814253215">port trunk allow-pass vlan 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword20308725125">*</span>DeviceC-Eth-Trunk10]<strong id="EN-US_TASK_0000001715064873__b193086251222"> dfs-group 1 m-lag 10</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword123089256217">*</span>DeviceC-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b53082251023">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword5308152510214">*</span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b730819252216">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p113081125322"># Configure DeviceD.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen43081257212">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword15308162512216"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b7308112512212">vlan batch 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword962019244228">*</span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b9308325529">interface Eth-Trunk10</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1530816251022">*</span>DeviceD-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b930892514216">trunkport <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1730812255213">*</span>DeviceD-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b1030832511212">trunkport <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword13309202515215">*</span>DeviceD-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b930913251429">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword530920257218">*</span>DeviceD-Eth-Trunk10]<strong id="EN-US_TASK_0000001715064873__b93091425824"> port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword730942517212">*</span>DeviceD-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b830917257214">undo port trunk allow-pass vlan 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword13309102510214">*</span>DeviceD-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b23099251422">port trunk allow-pass vlan 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword030916251823">*</span>DeviceD-Eth-Trunk10]<strong id="EN-US_TASK_0000001715064873__b0309172516210"> dfs-group 1 m-lag 10</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1309225728">*</span>DeviceD-Eth-Trunk10] <strong id="EN-US_TASK_0000001715064873__b4309152515210">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword9309132517210">*</span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b193091925529">commit</strong></pre>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001715064873__substep8807102710518"><span id="EN-US_TASK_0000001715064873__cmd198072278513">Configure Layer 3 gateways. On DeviceC and DeviceD, configure the same IP addresses and MAC addresses for VLANIF interfaces so that the devices function as dual-active gateways for the access layer.</span><p><p id="EN-US_TASK_0000001715064873__p1244084214514"># Configure DeviceC.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen16598417615">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword77685243615"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b2768132412618">interface</strong><strong id="EN-US_TASK_0000001715064873__b19186344369"> vlanif 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword2687157462">*</span>DeviceC-Vlanif11] <strong id="EN-US_TASK_0000001715064873__b184373251875">ip address 10.3.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1837511402711">*</span>DeviceC-Vlanif11] <strong id="EN-US_TASK_0000001715064873__b17971131787">mac-address 0000-5e00-0110</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword67701141486">*</span>DeviceC-Vlanif11] <strong id="EN-US_TASK_0000001715064873__b10692412910">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword4224651580">*</span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b136561339910">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p1229523913919"># Configure DeviceD.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen1249282817113">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword149217287113"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b2492142881116">interface</strong><strong id="EN-US_TASK_0000001715064873__b184926283111"> vlanif 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword17492628191114">*</span>DeviceD-Vlanif11] <strong id="EN-US_TASK_0000001715064873__b10492828171119">ip address 10.3.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword104922284119">*</span>DeviceD-Vlanif11] <strong id="EN-US_TASK_0000001715064873__b1449272816110">mac-address 0000-5e00-0110</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword12492172861112">*</span>DeviceD-Vlanif11] <strong id="EN-US_TASK_0000001715064873__b20492142851116">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1493112818117">*</span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b04939283118">commit</strong></pre>
</p></li><li class="substepexpand" id="EN-US_TASK_0000001715064873__substep9717105519118"><span id="EN-US_TASK_0000001715064873__cmd0717255141119">Configure the egress network. Configure physical links of the peer-link as egress bypass links between DeviceC and DeviceD, and configure dedicated VLANIF interfaces for the peer-link for Layer 3 interconnection.</span><p><p id="EN-US_TASK_0000001715064873__p8596121911121"># Configure DeviceC.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen168520245134">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword786324201314"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b108652461314">interface</strong><strong id="EN-US_TASK_0000001715064873__b1586172413135"> <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1627417145241"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001715064873__b1555340151415">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword3866249136">*</span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001715064873__b10861424141316">ip address 10.4.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword138614244131">*</span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001715064873__b1086192413130">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword12595641161516">*</span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b413934620157">interface</strong><strong id="EN-US_TASK_0000001715064873__b131391246161518"> <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword6217132311612">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001715064873__b11217723141617">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword132170232162">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001715064873__b18217023101613">ip address 10.5.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword12217423141612">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001715064873__b14217112381611">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword542134916190">*</span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b1465215944513">vlan batch 100</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword184817171215">*</span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b1840152425111">interface vlanif 100 </strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1620895417212">*</span>DeviceC-Vlanif100] <strong id="EN-US_TASK_0000001715064873__b113640205515">ip address 10.10.10.1 30</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword412943114914">*</span>DeviceC-Vlanif100]<strong id="EN-US_TASK_0000001715064873__b41291314491"> ospf cost 10000</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1130145515498">*</span>DeviceC-Vlanif100] <strong id="EN-US_TASK_0000001715064873__b251119202341">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword16876125661419">*</span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b58641121156">ospf 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword27759177153">*</span>DeviceC-ospf-1] <strong id="EN-US_TASK_0000001715064873__b166101530191510">area 0</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword895023301911">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001715064873__b29506337196">network 10.3.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword4677255191615">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001715064873__b188743211173">network 10.4.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1937417394176">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001715064873__b237423911714">network 10.5.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword14121747125115">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001715064873__b10899165195112">network 10.10.10.0 0.0.0.3</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1486717515170">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001715064873__b362655721715">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword13691105192511">*</span>DeviceC-ospf-1] <strong id="EN-US_TASK_0000001715064873__b1370162122612">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword08612461315">*</span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b18672491310">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p199431716181814"># Configure DeviceD.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen4743102641815">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword10743122611819"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b374372610188">interface</strong><strong id="EN-US_TASK_0000001715064873__b14743152616185"> <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1455012692413"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001715064873__b1074442615188">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword57442026201816">*</span>DeviceD-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001715064873__b157440263181">ip address 10.6.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword13744326171810">*</span>DeviceD-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001715064873__b1474442661818">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1874482611814">*</span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b474402641815">interface</strong><strong id="EN-US_TASK_0000001715064873__b1974462619187"> <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1774411268182">*</span>DeviceD-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001715064873__b1874452614182">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword7744626141813">*</span>DeviceD-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001715064873__b8744226201818">ip address 10.7.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword274462661813">*</span>DeviceD-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001715064873__b5744162616187">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1085514549511">*</span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b14855165418511">vlan batch 100</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword2056816228521">*</span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b55682228521">interface vlanif 100 </strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword195681922125210">*</span>DeviceD-Vlanif100] <strong id="EN-US_TASK_0000001715064873__b1856892265214">ip address 10.10.10.2 30</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword156912219522">*</span>DeviceD-Vlanif100]<strong id="EN-US_TASK_0000001715064873__b16569132285211"> ospf cost 10000</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1556922205216">*</span>DeviceD-Vlanif100] <strong id="EN-US_TASK_0000001715064873__b17569152255210">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword11744142621818">*</span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b187444263183">ospf 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword974492612185">*</span>DeviceD-ospf-1] <strong id="EN-US_TASK_0000001715064873__b174482611181">area 0</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1174164716194">*</span>DeviceD-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001715064873__b17742174731913">network 10.3.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword274562615180">*</span>DeviceD-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001715064873__b17454264189">network 10.6.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword147451626201817">*</span>DeviceD-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001715064873__b107451226171818">network 10.7.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword251416613531">*</span>DeviceD-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001715064873__b1851416195311">network 10.10.10.0 0.0.0.3</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword7745112651811">*</span>DeviceD-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001715064873__b12745132615181">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword13418210172616">*</span>DeviceD-ospf-1] <strong id="EN-US_TASK_0000001715064873__b9495141818262">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword474513267188">*</span>DeviceD] <strong id="EN-US_TASK_0000001715064873__b274513262182">commit</strong></pre>
</p></li></ol>
</li><li id="EN-US_TASK_0000001715064873__step1169777963182247"><span id="EN-US_TASK_0000001715064873__cmd245435856182247">Configure DeviceE and DeviceF at the core layer.</span><p><p id="EN-US_TASK_0000001715064873__p1574416259182247"># Configure DeviceE.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen87582028182518">&lt;<span class="keyword" id="EN-US_TASK_0000001715064873__keyword12364802515">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001715064873__b22444892512">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword162494818255"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001715064873__keyword172414852519">HUAWEI</span>] <strong id="EN-US_TASK_0000001715064873__b82434802518">sysname DeviceE</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword42434832514">*</span><span class="keyword" id="EN-US_TASK_0000001715064873__keyword16451142112718">HUAWEI</span>] <strong id="EN-US_TASK_0000001715064873__b624124842518">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword2075892812514"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceE] <strong id="EN-US_TASK_0000001715064873__b5758192862515">interface</strong><strong id="EN-US_TASK_0000001715064873__b137581228182519"> <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword13540154145418"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceE-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001715064873__b6759828152516">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1475912842517">*</span>DeviceE-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001715064873__b10759428172518">ip address 10.4.1.2 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1275982816256">*</span>DeviceE-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001715064873__b8759162822512">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword77591628142514">*</span>DeviceE] <strong id="EN-US_TASK_0000001715064873__b10759112810255">interface</strong><strong id="EN-US_TASK_0000001715064873__b575952811253"> <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword20759122832516">*</span>DeviceE-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001715064873__b5759182872512">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword16759202812256">*</span>DeviceE-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001715064873__b5759142832512">ip address 10.7.1.2 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword19760132852520">*</span>DeviceE-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001715064873__b876018280251">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1076032816256">*</span>DeviceE] <strong id="EN-US_TASK_0000001715064873__b12760328142513">ospf 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword6760132842510">*</span>DeviceE-ospf-1] <strong id="EN-US_TASK_0000001715064873__b2760192812519">area 0</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword0760152852515">*</span>DeviceE-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001715064873__b576072819258">network 10.4.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword576012288253">*</span>DeviceE-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001715064873__b14760192816254">network 10.7.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword19760928142514">*</span>DeviceE-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001715064873__b19760182820253">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword22021228122713">*</span>DeviceE-ospf-1] <strong id="EN-US_TASK_0000001715064873__b2031923422717">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword5760128182514">*</span>DeviceE] <strong id="EN-US_TASK_0000001715064873__b3760122818252">commit</strong></pre>
<p id="EN-US_TASK_0000001715064873__p43270381182247"># Configure DeviceF.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen17603155816274">&lt;<span class="keyword" id="EN-US_TASK_0000001715064873__keyword12603195892717">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001715064873__b260365862713">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword26031958172713"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001715064873__keyword126031658152719">HUAWEI</span>] <strong id="EN-US_TASK_0000001715064873__b1560385810276">sysname DeviceF</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword6603205812720">*</span><span class="keyword" id="EN-US_TASK_0000001715064873__keyword69303202279">HUAWEI</span>] <strong id="EN-US_TASK_0000001715064873__b4603115815274">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword86037588278"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceF] <strong id="EN-US_TASK_0000001715064873__b2603105810273">interface</strong><strong id="EN-US_TASK_0000001715064873__b860355820274"> <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword2051017155515"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceF-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001715064873__b13603155872718">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword146036587276">*</span>DeviceF-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001715064873__b5603658112711">ip address 10.6.1.2 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword7604175842714">*</span>DeviceF-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001715064873__b1660455813279">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1260425813272">*</span>DeviceF] <strong id="EN-US_TASK_0000001715064873__b196041358162719">interface</strong><strong id="EN-US_TASK_0000001715064873__b186044585273"> <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword160415814279">*</span>DeviceF-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001715064873__b1604858172713">undo portswitch</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword26041058142717">*</span>DeviceF-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001715064873__b1960405802716">ip address 10.5.1.2 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword106042583279">*</span>DeviceF-<span>100GE</span><span>1/0/2</span>] <strong id="EN-US_TASK_0000001715064873__b15604185817274">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword96048586277">*</span>DeviceF] <strong id="EN-US_TASK_0000001715064873__b15604258122712">ospf 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword76041458182717">*</span>DeviceF-ospf-1] <strong id="EN-US_TASK_0000001715064873__b1560435832711">area 0</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword1660415872719">*</span>DeviceF-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001715064873__b146041858152713">network 10.5.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword0605358162717">*</span>DeviceF-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001715064873__b1560510585278">network 10.6.1.0 0.0.0.255</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword9605195814275">*</span>DeviceF-ospf-1-area-0.0.0.0] <strong id="EN-US_TASK_0000001715064873__b1960515811278">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword178217556267">*</span>DeviceF-ospf-1] <strong id="EN-US_TASK_0000001715064873__b1581313282718">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword126052586272">*</span>DeviceF] <strong id="EN-US_TASK_0000001715064873__b146058583279">commit</strong></pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001715064873__example1771494086182247"><a name="EN-US_TASK_0000001715064873__1.4.4"></a><a name="1.4.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ul id="EN-US_TASK_0000001715064873__ul6509195517296"><li id="EN-US_TASK_0000001715064873__li250914551299">Run the <strong id="EN-US_TASK_0000001715064873__b1177164192410">display dfs-group 1 m-lag</strong> command to check the M-LAG status. Under normal circumstances, the states of two member devices are displayed. One device is in Master state, and the other device is in Backup state.<p id="EN-US_TASK_0000001715064873__p333535764713"># Check the M-LAG status at the access layer.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen18337129185012">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword14261951154810"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001715064873__b38945962410">display dfs-group 1 m-lag</strong>
*                     : Local node
Heart beat state      : <strong id="EN-US_TASK_0000001715064873__b177651911115617">OK</strong>
<strong id="EN-US_TASK_0000001715064873__b72362529553">Node 1</strong> *                            
  Dfs-Group ID        : 1
  Priority            : 150
  Dual-active Address : 10.1.1.1
  VPN-Instance        : public net
  State               : <strong id="EN-US_TASK_0000001715064873__b964544485513">Master</strong>
  Causation           : - 
  System ID           : 00e0-fc12-3457
  SysName             : DeviceA
  Version             : <span class="keyword" id="EN-US_TASK_0000001715064873__keyword6491138115415">V300R023C00</span>
  Device Type         : <span>CE6860-SAN</span>
<strong id="EN-US_TASK_0000001715064873__b4908347145511">Node 2</strong>                            
  Dfs-Group ID        : 1
  Priority            : 120
  Dual-active Address : 10.1.1.2
  VPN-Instance        : public net
  State               : <strong id="EN-US_TASK_0000001715064873__b20672245185514">Backup</strong>
  Causation           : - 
  System ID           : 00e0-fc12-3458
  SysName             : DeviceB
  Version             : <span class="keyword" id="EN-US_TASK_0000001715064873__keyword182421042123917">V300R023C00</span>
  Device Type         : <span>CE6860-SAN</span></pre>
<p id="EN-US_TASK_0000001715064873__p1670815512558"># Check the M-LAG status at the aggregation layer.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen17823915125611">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword48231152566"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b168231158563">display dfs-group 1 m-lag</strong>
*                     : Local node
Heart beat state      : <strong id="EN-US_TASK_0000001715064873__b1182391575614">OK</strong>
<strong id="EN-US_TASK_0000001715064873__b16823141545618">Node 1</strong> *                            
  Dfs-Group ID        : 1
  Priority            : 150
  Dual-active Address : 10.2.1.1
  VPN-Instance        : public net
  State               : <strong id="EN-US_TASK_0000001715064873__b1382311157564">Master</strong>
  Causation           : - 
  System ID           : 00e0-fc12-3459
  SysName             : DeviceC
  Version             : <span class="keyword" id="EN-US_TASK_0000001715064873__keyword11571855103918">V300R023C00</span>
  Device Type         : <span>CE6860-SAN</span>
<strong id="EN-US_TASK_0000001715064873__b168241153565">Node 2</strong>                            
  Dfs-Group ID        : 1
  Priority            : 120
  Dual-active Address : 10.2.1.2
  VPN-Instance        : public net
  State               : <strong id="EN-US_TASK_0000001715064873__b182461535614">Backup</strong>
  Causation           : - 
  System ID           : 00e0-fc12-3460
  SysName             : DeviceD
  Version             : <span class="keyword" id="EN-US_TASK_0000001715064873__keyword8766180194016">V300R023C00</span>
  Device Type         : <span>CE6860-SAN</span></pre>
</li><li id="EN-US_TASK_0000001715064873__li19373850104713">Run the <strong id="EN-US_TASK_0000001715064873__b1761195312419">display dfs-group 1 node 1 m-lag</strong> <strong id="EN-US_TASK_0000001715064873__b77878117429">brief</strong> command to check the M-LAG Eth-Trunk status.<p id="EN-US_TASK_0000001715064873__p736734031418"># Check the M-LAG Eth-Trunk status on DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen35414920172">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword18235320161714"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001715064873__b109345102718">display dfs-group 1 node 1 m-lag brief</strong>
* - Local node

M-Lag ID     Interface      Port State    Status                Consistency-check
<strong id="EN-US_TASK_0000001715064873__b16912527182112">       1     Eth-Trunk 1    Up            active(*)-active      success</strong>
      10     Eth-Trunk 10   Up            active(*)-active      success
......</pre>
<p id="EN-US_TASK_0000001715064873__p16133183822010"># Check the M-LAG Eth-Trunk status on DeviceC.</p>
<pre class="screen" id="EN-US_TASK_0000001715064873__screen14789129192211">[<span class="keyword" id="EN-US_TASK_0000001715064873__keyword378989142213"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001715064873__b10790299228">display dfs-group 1 node 1 m-lag brief</strong>
* - Local node

M-Lag ID     Interface      Port State    Status                Consistency-check
      <strong id="EN-US_TASK_0000001715064873__b1768512482312">10     Eth-Trunk 10   Up            active(*)-active      success</strong>
......</pre>
</li></ul>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001715064873__1.4.5"></a><a name="1.4.5"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul id="EN-US_TASK_0000001715064873__ul19509119261"><li id="EN-US_TASK_0000001715064873__li0509171122617">DeviceA<pre class="screen" id="EN-US_TASK_0000001715064873__screen29351255122613">#
sysname DeviceA
#
dfs-group 1
 priority 150
 dual-active detection source ip 10.1.1.1 peer 10.1.1.2
 authentication-mode hmac-sha256 password %+%##!!!!!!!!!"!!!!"!!!!*!!!!C+tR0CW9x*eB&amp;pWp`t),Azgw-h\o8#4LZPD!!!!!!!!!!!!!!!9!!!!&gt;fwJ)I0E{=:%,*,XRhbH&amp;t0MCy_8=7!!!!!!!!!!%+%#
#
vlan batch 11
#
stp mode rstp
stp v-stp enable 
#
interface Eth-Trunk0
 mode lacp-static
 peer-link 1
 port vlan exclude 1
#
interface Eth-Trunk1
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 11
 mode lacp-static
 dfs-group 1 m-lag 1
#
interface Eth-Trunk10
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 11
 mode lacp-static
 dfs-group 1 m-lag 10
#
interface <span>100GE</span><span>1/0/1</span>
 eth-trunk 10
#
interface <span>100GE</span><span>1/0/2</span>
 eth-trunk 10
#
interface <span>100GE</span><span>1/0/3</span>
 eth-trunk 1
#
interface <span>100GE</span><span>1/0/4</span>
 undo portswitch
 ip address 10.1.1.1 255.255.255.0
 m-lag unpaired-port reserved
#
interface <span>100GE</span><span>1/0/5</span>
 eth-trunk 0
#
interface <span>100GE</span><span>1/0/6</span>
 eth-trunk 0
#
return</pre>
</li><li id="EN-US_TASK_0000001715064873__li4522111862611">DeviceB<pre class="screen" id="EN-US_TASK_0000001715064873__screen111691218174218">#
sysname DeviceB
#
dfs-group 1
 priority 120
 dual-active detection source ip 10.1.1.2 peer 10.1.1.1
 authentication-mode hmac-sha256 password %+%##!!!!!!!!!"!!!!"!!!!*!!!!C+tR0CW9x*eB&amp;pWp`t),Azgw-h\o8#4LZPD!!!!!!!!!!!!!!!9!!!!&gt;fwJ)I0E{=:%,*,XRhbH&amp;t0MCy_8=7!!!!!!!!!!%+%#
#
vlan batch 11
#
stp mode rstp
stp v-stp enable
#
interface Eth-Trunk0
 mode lacp-static
 peer-link 1
 port vlan exclude 1
#
interface Eth-Trunk1
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 11
 mode lacp-static
 dfs-group 1 m-lag 1
#
interface Eth-Trunk10
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 11
 mode lacp-static
 dfs-group 1 m-lag 10
#
interface <span>100GE</span><span>1/0/1</span>
 eth-trunk 10
#
interface <span>100GE</span><span>1/0/2</span>
 eth-trunk 10
#
interface <span>100GE</span><span>1/0/3</span>
 eth-trunk 1
#
interface <span>100GE</span><span>1/0/4</span>
 undo portswitch
 ip address 10.1.1.2 255.255.255.0
 m-lag unpaired-port reserved
#
interface <span>100GE</span><span>1/0/5</span>
 eth-trunk 0
#
interface <span>100GE</span><span>1/0/6</span>
 eth-trunk 0
#
return</pre>
</li><li id="EN-US_TASK_0000001715064873__li48313241268">DeviceC<pre class="screen" id="EN-US_TASK_0000001715064873__screen19634149154910">#
sysname DeviceC
#
dfs-group 1
 priority 150
 dual-active detection source ip 10.2.1.1 peer 10.2.1.2
 authentication-mode hmac-sha256 password %+%##!!!!!!!!!"!!!!"!!!!*!!!!C+tR0CW9x*eB&amp;pWp`t),Azgw-h\o8#4LZPD!!!!!!!!!!!!!!!9!!!!&gt;fwJ)I0E{=:%,*,XRhbH&amp;t0MCy_8=7!!!!!!!!!!%+%#
#
vlan batch 11 100
#
stp mode rstp
stp v-stp enable 
#
interface Vlanif11
 ip address 10.3.1.1 255.255.255.0
 mac-address 0000-5e00-0110 
#
interface Vlanif100
 ip address 10.10.10.1 255.255.255.252
 ospf cost 10000
#
interface Eth-Trunk0
 mode lacp-static
 peer-link 1
 port vlan exclude 1
#
interface Eth-Trunk10
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 11
 mode lacp-static
 dfs-group 1 m-lag 10
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.4.1.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.5.1.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/3</span>
 eth-trunk 10
#
interface <span>100GE</span><span>1/0/4</span>
 eth-trunk 10
#
interface <span>100GE</span><span>1/0/5</span>
 undo portswitch
 ip address 10.2.1.1 255.255.255.0
 m-lag unpaired-port reserved
#
interface <span>100GE</span><span>1/0/6</span>
 eth-trunk 0
#
interface <span>100GE</span><span>1/0/7</span>
 eth-trunk 0
#
ospf 1
 area 0.0.0.0
  network 10.3.1.0 0.0.0.255
  network 10.4.1.0 0.0.0.255
  network 10.5.1.0 0.0.0.255
  network 10.10.10.0 0.0.0.3
#
return</pre>
</li><li id="EN-US_TASK_0000001715064873__li1386623017269">DeviceD<pre class="screen" id="EN-US_TASK_0000001715064873__screen106239113575">#
sysname DeviceD
#
dfs-group 1
 priority 120
 dual-active detection source ip 10.2.1.2 peer 10.2.1.1
 authentication-mode hmac-sha256 password %+%##!!!!!!!!!"!!!!"!!!!*!!!!C+tR0CW9x*eB&amp;pWp`t),Azgw-h\o8#4LZPD!!!!!!!!!!!!!!!9!!!!&gt;fwJ)I0E{=:%,*,XRhbH&amp;t0MCy_8=7!!!!!!!!!!%+%#
#
vlan batch 11 100
#
stp mode rstp
stp v-stp enable 
#
interface Vlanif11
 ip address 10.3.1.1 255.255.255.0
 mac-address 0000-5e00-0110
#
interface Vlanif100
 ip address 10.10.10.2 255.255.255.252
 ospf cost 10000
#
interface Eth-Trunk0
 mode lacp-static
 peer-link 1
 port vlan exclude 1
#
interface Eth-Trunk10
 port link-type trunk
 undo port trunk allow-pass vlan 1
 port trunk allow-pass vlan 11
 mode lacp-static
 dfs-group 1 m-lag 10
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.6.1.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.7.1.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/3</span>
 eth-trunk 10
#
interface <span>100GE</span><span>1/0/4</span>
 eth-trunk 10
#
interface <span>100GE</span><span>1/0/5</span>
 undo portswitch
 ip address 10.2.1.2 255.255.255.0
 m-lag unpaired-port reserved
#
interface <span>100GE</span><span>1/0/6</span>
 eth-trunk 0
#
interface <span>100GE</span><span>1/0/7</span>
 eth-trunk 0
#
ospf 1
 area 0.0.0.0
  network 10.3.1.0 0.0.0.255
  network 10.6.1.0 0.0.0.255
  network 10.7.1.0 0.0.0.255
  network 10.10.10.0 0.0.0.3
#
return</pre>
</li><li id="EN-US_TASK_0000001715064873__li57633618260">DeviceE<pre class="screen" id="EN-US_TASK_0000001715064873__screen18231855595">#
sysname DeviceE
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.4.1.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.7.1.2 255.255.255.0
#
ospf 1
 area 0.0.0.0
  network 10.4.1.0 0.0.0.255
  network 10.7.1.0 0.0.0.255
#
return</pre>
</li><li id="EN-US_TASK_0000001715064873__li1151754614264">DeviceF<pre class="screen" id="EN-US_TASK_0000001715064873__screen697916191509">#
sysname DeviceF
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.5.1.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.6.1.2 255.255.255.0
#
ospf 1
 area 0.0.0.0
  network 10.5.1.0 0.0.0.255
  network 10.6.1.0 0.0.0.255
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../dc/dc_cfg_m-lag_0020.html">Configuring an M-LAG
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../dc/dc_cfg_m-lag_0024.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../dc/dc_cfg_m-lag_0082.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>