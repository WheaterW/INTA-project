
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Association Between VRRP6 and Interface Status">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp6_cfg_0034.html">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp6_cfg_0036.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VRRP6">
<meta name="featuretype" content="High Availability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VRRP6">
<meta name="featuretype" content="High Availability">
<meta name="featurename" content="VRRP6">
<meta name="featuretype" content="High Availability">
<meta name="featuretype" content="High Availability">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176661769">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<link rel="stylesheet" type="text/css" href="public_sys-resources/imagePopup.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/customQuery.js"></script>
<script language="javascript" type="text/javascript" src="public_sys-resources/imagePopup.js"></script>
<title>Example for Configuring Association Between VRRP6 and Interface Status</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176661769"></a><a name="EN-US_TASK_0000001176661769"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Association Between VRRP6 and Interface Status</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176661769__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>Hosts are connected to an upper-layer network through gateways. To improve network reliability, configure a VRRP6 group on the gateways to implement gateway redundancy. To further improve network reliability and implement rapid master/backup VRRP switchovers, configure VRRP6 association.</p>
<div class="p">In <a href="#EN-US_TASK_0000001176661769__fig_dc_vrp_vrrp6_cfg_011701">Figure 1</a>, the master device (DeviceA) transmits data during normal operation. When the interface associated with the VRRP6 group fails, the backup device (DeviceB) is required to take over data transmission. After DeviceA recovers, traffic switches back to it.<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span><span>1/0/1</span>, <span>100GE</span><span>1/0/2</span>, and <span>100GE</span><span>1/0/3</span>, respectively.</p>
</div></div>
</div>
<div class="fignone" id="EN-US_TASK_0000001176661769__fig_dc_vrp_vrrp6_cfg_011701"><a name="EN-US_TASK_0000001176661769__fig_dc_vrp_vrrp6_cfg_011701"></a><a name="fig_dc_vrp_vrrp6_cfg_011701"></a><span class="figcap"><b>Figure 1 </b>Network diagram for configuring VRRP6 association</span><br><span><img class="imgResize" src="figure/en-us_image_0000001176661789.png" width="521.4329176030737" height="NaN" title="Click to enlarge"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176661769__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><div class="p">The configuration roadmap is as follows:<ol><li><p>Assign an IPv6 address to each interface on the devices and configure OSPFv3 to ensure IPv6 connectivity.</p>
</li><li><p>Configure a VRRP6 group on user-side gateways (DeviceA and DeviceB) and set a higher priority for DeviceA so that it functions as the master in the VRRP6 group.</p>
</li><li><p>Configure the VRRP6 group on DeviceA to track the uplink interface so that a master/backup VRRP switchover can be performed if the tracked interface goes down.</p>
</li></ol>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176661769__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Procedure</h4><ol><li>Configure OSPFv3 on DeviceA, DeviceB, and DeviceC to ensure that they can communicate. For configuration details, see <a href="#EN-US_TASK_0000001176661769__context1421141332420">Configuration Scripts</a> in this section.</li><li>Configure a VRRP6 group on DeviceA and DeviceB.<div class="p"># Configure an IPv6 address for DeviceA's interface <span>100GE</span><span>1/0/1</span>. Create VRRP6 group 1 on DeviceA's <span>100GE</span><span>1/0/1</span>, and set DeviceA's priority to 120 to ensure that it functions as the master.<pre class="screen"><span class="keyword">&lt;HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 address 2001:db8::1 64</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 1 virtual-ip fe80::1 link-local</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 1 virtual-ip 2001:db8::100</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 1 priority 120</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 1 preempt timer delay 20</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
</div>
<div class="p"># Configure an IPv6 address for DeviceB's interface <span>100GE</span><span>1/0/1</span>. Create VRRP6 group 1 on DeviceB's <span>100GE</span><span>1/0/1</span>, and use the default priority 100 to ensure that DeviceB functions as the backup.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceB</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 address 2001:db8::2 64</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 1 virtual-ip fe80::1 link-local</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 1 virtual-ip 2001:db8::100</strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
</div>
</li><li>Configure VRRP6 association. On DeviceA, associate the VRRP6 group with the uplink interface.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>vrrp6 vrid 1 track interface <span>100ge</span> <span>1/0/2</span> reduce 40</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176661769__1.3.4"></a><a name="1.3.4"></a>
<div class="p"><h4 class="sectiontitle">Verifying the Configuration</h4><p># Check the states of DeviceA and DeviceB in the VRRP6 group.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display vrrp6 verbose</strong>
<span>100GE</span><span>1/0/1</span> | Virtual Router 1
State           : <strong>Master</strong>
Virtual IP      : FE80::1
                  2001:DB8::100
Master IP       : 2001:DB8::1
Local IP        : 2001:DB8::1   
PriorityRun     : 120
PriorityConfig  : 120
MasterPriority  : 120
Preempt         : YES   Delay Time : 20s   Remain : --
Hold Multiplier : 4
TimerRun        : 100cs
TimerConfig     : 100cs
Virtual MAC     : 0000-5e00-0201
Check hop limit : YES
Config Type     : Normal
Track IF        : <strong><span>100GE</span></strong><strong><span>1/0/2</span></strong>             Priority Reduced : 40
IF State        : <strong>UP</strong>
Create Time     : 2020-07-27 17:33:00
Last Change Time: 2020-07-27 17:33:04</pre>
<p>The command output shows that DeviceA is in the <strong>Master</strong> state in the group and the group is associated with the uplink interface <span>100GE</span><span>1/0/1</span>.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display vrrp6 verbose</strong>
<span>100GE</span><span>1/0/1</span> | Virtual Router 1
State           : <strong>Backup</strong>
Virtual IP      : FE80::1
                  2001:DB8::100
Master IP       : 2001:DB8::1
Local IP        : 2001:DB8::2
PriorityRun     : 100
PriorityConfig  : 100
MasterPriority  : 120
Preempt         : YES   Delay Time : 0s   Remain : --
Hold Multiplier : 4
TimerRun        : 100cs
TimerConfig     : 100cs
Virtual MAC     : 0000-5e00-0202
Check hop limit : YES
Config Type     : Normal
Create Time     : 2020-07-27 17:33:00
Last Change Time: 2020-07-27 17:33:04</pre>
<p>The command output shows that DeviceB is in the <strong>Backup</strong> state in the VRRP6 group.</p>
<p># Run the <strong>shutdown</strong> command on DeviceA's <span>100GE</span><span>1/0/2</span> to simulate a device fault. Check the states of DeviceA and DeviceB in the VRRP6 group.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display vrrp6 verbose</strong>
<span>100GE</span><span>1/0/1</span> | Virtual Router 1
State           : <strong>Backup</strong>
Virtual IP      : FE80::1
                  2001:DB8::100
Master IP       : 2001:DB8::2
Local IP        : 2001:DB8::1 
PriorityRun     : 80
PriorityConfig  : 120
MasterPriority  : 100
Preempt         : YES   Delay Time : 20s   Remain : --
Hold Multiplier : 4
TimerRun        : 100cs
TimerConfig     : 100cs
Virtual MAC     : 0000-5e00-0201
Check hop limit : YES
Config Type     : Normal
Track IF        : <strong><span>100GE</span></strong><strong><span>1/0/2</span></strong>             Priority Reduced : 40
IF State        : <strong>DOWN</strong>
Create Time     : 2020-07-27 17:33:00
Last Change Time: 2020-07-27 17:35:14</pre>
<p>The command output shows that DeviceA is in the <strong>Backup</strong> state in the VRRP6 group.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display vrrp6 verbose</strong>
<span>100GE</span><span>1/0/1</span> | Virtual Router 1
State           : <strong>Master</strong>
Virtual IP      : FE80::1
                  2001:DB8::100
Master IP       : 2001:DB8::2
Local IP        : 2001:DB8::2
PriorityRun     : 100
PriorityConfig  : 100
MasterPriority  : 100
Preempt         : YES   Delay Time : 0s   Remain : --
Hold Multiplier : 4
TimerRun        : 100cs
TimerConfig     : 100cs
Virtual MAC     : 0000-5e00-0202
Check hop limit : YES
Config Type     : Normal
Create Time     : 2020-07-27 17:33:00
Last Change Time: 2020-07-27 17:33:04</pre>
<p>The command output shows that DeviceB is in the <strong>Master</strong> state in the group.</p>
<p># Run the <strong>undo shutdown</strong> command on DeviceA's <span>100GE</span><span>1/0/2</span>. After <span>100GE</span><span>1/0/2</span> goes up, wait 20 seconds and check the state of DeviceA in the VRRP6 group.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display vrrp6 verbose</strong>
<span>100GE</span><span>1/0/1</span> | Virtual Router 1
State           : <strong>Master</strong>
Virtual IP      : FE80::1
                  2001:DB8::100
Master IP       : 2001:DB8::1
Local IP        : 2001:DB8::1 
PriorityRun     : 120
PriorityConfig  : 120
MasterPriority  : 120
Preempt         : YES   Delay Time : 20s   Remain : --
Hold Multiplier : 4
TimerRun        : 100cs
TimerConfig     : 100cs
Virtual MAC     : 0000-5e00-0201
Check hop limit : YES
Config Type     : Normal
Track IF        : <strong><strong><span>100GE</span></strong><strong><span>1/0/2</span></strong>   </strong>            Priority Reduced : 40
IF State        : <strong>UP</strong>
Create Time     : 2020-07-27 17:33:00
Last Change Time: 2020-07-27 17:40:04</pre>
<p>The command output shows that DeviceA is restored to the <strong>Master</strong> state.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176661769__1.3.5"></a><a name="1.3.5"></a>
<div class="p" id="EN-US_TASK_0000001176661769__context1421141332420"><a name="EN-US_TASK_0000001176661769__context1421141332420"></a><a name="context1421141332420"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li>DeviceA<pre class="screen">#
 sysname DeviceA
#
ospfv3 1
 router-id 1.1.1.1
#
interface <span>100GE</span><span>1/0/1</span>
<strong> </strong>undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8::1/64
 vrrp6 vrid 1 virtual-ip FE80::1 link-local
 vrrp6 vrid 1 virtual-ip 2001:DB8::100
 vrrp6 vrid 1 priority 120
 vrrp6 vrid 1 preempt timer delay 20
 vrrp6 vrid 1 track interface <span>100GE</span><span>1/0/2</span> reduce 40
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/2</span>
<strong> </strong>undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8:1::1/64
 ospfv3 1 area 0.0.0.0
#
return</pre>
</li><li>DeviceB<pre class="screen">#
 sysname DeviceB
#
 ospfv3 1
 router-id 2.2.2.2
#
interface <span>100GE</span><span>1/0/1</span>
<strong> </strong>undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8::2/64
 vrrp6 vrid 1 virtual-ip FE80::1 link-local
 vrrp6 vrid 1 virtual-ip 2001:DB8::100
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/2</span>
<strong> </strong>undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8:2::1/64
 ospfv3 1 area 0.0.0.0
#
return</pre>
</li><li>DeviceC<pre class="screen">#
 sysname DeviceC
#
ospfv3 1
 router-id 3.3.3.3
#
interface <span>100GE</span><span>1/0/3</span>
<strong> </strong>undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8:3::2/64
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/1</span>
<strong> </strong>undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8:1::2/64
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/2</span>
<strong> </strong>undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8:2::2/64
 ospfv3 1 area 0.0.0.0
#
return</pre>
</li></ul>
</div></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_vrrp6_cfg_0034.html">Configuring Association Between VRRP6 and Interface Status
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_vrrp6_cfg_0036.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>

<script language="JavaScript">
<!--
initImageViewer('.imgResize');
var msg_imageMax = "view original image";
var msg_imageClose = "close";
//--></script></body>
</html>