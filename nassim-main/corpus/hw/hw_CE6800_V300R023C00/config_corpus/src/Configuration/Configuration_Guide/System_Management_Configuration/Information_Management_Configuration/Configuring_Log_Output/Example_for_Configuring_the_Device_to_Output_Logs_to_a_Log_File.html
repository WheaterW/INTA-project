
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring the Device to Output Logs to a Log File">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_info-center_cfg_0013.html">
<meta name="DC.Relation" scheme="URI" content="vrp_info-center_cfg_0020.html">
<meta name="DC.Relation" scheme="URI" content="vrp_info-center_cfg_0022.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Information Management">
<meta name="featuretype" content="System Management">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Information Management">
<meta name="featuretype" content="System Management">
<meta name="featurename" content="Information Management">
<meta name="featuretype" content="System Management">
<meta name="featuretype" content="System Management">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001513039378">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring the Device to Output Logs to a Log File</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001513039378"></a><a name="EN-US_TASK_0000001513039378"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring the Device to Output Logs to a Log File</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001513039378__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>Information can be saved as files on a device. If a fault occurs on the device, log files can be exported and used for fault locating. As shown in <a href="#EN-US_TASK_0000001513039378__fig3344141161119">Figure 1</a>, log information can be saved in the log file of DeviceA. If there are a large number of log files, you can configure the device to send them to an external server (for example, an SFTP server) to reduce storage resource consumption and implement unified maintenance. DeviceA is connected to the SFTP server through a network, and there are reachable routes between DeviceA and the SFTP server. Maintenance personnel can view logs generated on DeviceA on the SFTP server to query the running status of DeviceA.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 represents <span>100GE</span><span>1/0/1</span>.</p>
</div></div>
<div class="fignone" id="EN-US_TASK_0000001513039378__fig3344141161119"><a name="EN-US_TASK_0000001513039378__fig3344141161119"></a><a name="fig3344141161119"></a><span class="figcap"><b>Figure 1 </b>Network diagram of outputting logs to a log file</span><br><span><img class="vsd" src="figure/en-us_image_0000001513159418.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001513039378__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Configure the AAA authentication mode.</li><li><p>Enable the IM function.</p>
</li><li><p>Configure a channel and a rule for outputting logs to a log file.</p>
</li><li><p>Configure the device to send log files to the SFTP server.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001513039378__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure a routing protocol to ensure that there are reachable routes between the device and SFTP server. For details, see Configuration Scripts.</span></li><li><span>Configure the SFTP server function and parameters, create an SSH user, and set the authentication mode to AAA authentication.</span></li><li><span>Enable the IM function.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> info-center enable</strong></pre>
</p></li><li><span>Configure a channel and a rule for outputting logs to a log file.</span><p><p># Specify a channel through which logs are output to a log file.</p>
<pre class="screen">[<span class="keyword">*</span>DeviceA]<strong> info-center logfile channel channel8</strong>
[<span class="keyword">*</span>DeviceA]<strong> commit</strong></pre>
</p><p><p># Configure a rule for outputting logs to an information channel, allowing the output of IM information and information with a severity level higher than warning.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> info-center source im channel channel8 log level warning</strong>
[<span class="keyword">*</span>DeviceA]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> quit</strong></pre>
</p></li><li><span>Configure the device to send the log file to the SFTP server.</span><p><p># Switch to the save path of the log file.</p>
<pre class="screen">&lt;DeviceA&gt;<strong> cd <span><strong><span>flash</span></strong></span><span><span></span></span>:</strong></pre>
<p># Log in to the SFTP server.</p>
<pre class="screen">&lt;DeviceA&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>ssh client first-time enable</strong>
[<span class="keyword">*</span>DeviceA]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>sftp 10.2.1.2</strong> 
Trying 10.2.1.2 ...
Press CTRL+K to abort
Connected to 10.2.1.2 ...
The server's public key does not match the one cached before. 
The server is not authenticated. Continue to access it? [Y/N]:<strong>y</strong>
The keyname:10.2.1.2 already exists. Update it? [Y/N]:<strong>n</strong>  

Please input the username: <strong>admin123</strong>
Enter password:
sftp-client&gt;</pre>
<p># Configure the device to transfer the log file to the SFTP server.</p>
<pre class="screen">sftp-client&gt;<strong> put log_17_20110504041811.log</strong>
sftp-client&gt;<strong> quit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001513039378__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># View the logs output through the channel.</p>
<pre class="screen">&lt;DeviceA&gt; <strong>display info-center</strong>
Information Center:enabled
Log host:
        10.0.0.1, channel number 2, channel name loghost,
language English , host facility local7
Console:
        channel number : 0, channel name : console
Monitor:
        channel number : 1, channel name : monitor
SNMP Agent:
        channel number : 5, channel name : snmpagent
Log buffer:
        enabled,max buffer size 10240, current buffer size 512,
current messages 10, channel number : 4, channel name : logbuffer
dropped messages 0, overwritten messages 0
Trap buffer:
        enabled,max buffer size 1024, current buffer size 256,
current messages 3, channel number:3, channel name:trapbuffer
dropped messages 0, overwritten messages 0
<strong>logfile:</strong>
        channel number : 8, channel name : channel8, language : English
Information timestamp setting:
        log - date, trap - date, debug - date millisecond</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001513039378__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Configuration Scripts</h4><pre class="screen">#
sysname DeviceA
info-center enable
#
info-center logfile channel channel8
info-center source im channel channel8 log level warning
#
interface <span>100GE</span><span>1/0/1</span>
<span> undo portswitch</span>
 ip address 10.2.1.1 255.255.0.0
#
ssh client first-time enable 
# 
return</pre>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_info-center_cfg_0013.html">Configuring Log Output
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_info-center_cfg_0020.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_info-center_cfg_0022.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>