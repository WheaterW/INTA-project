
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="Understanding OpenFlow">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_cfg_openflow_0001.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_cfg_openflow_0002.html">
<meta name="DC.Relation" scheme="URI" content="spec/OpenFlow_limitation_CE_v6r23c00.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OpenFlow">
<meta name="featuretype" content="System Management">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OpenFlow">
<meta name="featuretype" content="System Management">
<meta name="featuretype" content="System Management">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CONCEPT_0000001563750121">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Understanding OpenFlow</title>
</head>
<body><a name="EN-US_CONCEPT_0000001563750121"></a><a name="EN-US_CONCEPT_0000001563750121"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Understanding OpenFlow</h1>
<div><div class="section"><h4 class="sectiontitle">OpenFlow System Architecture</h4><p>OpenFlow separates the control and data planes, serves a standard communication protocol between them, and allows the data plane to implement flow-based forwarding. <a href="#EN-US_CONCEPT_0000001563750121__fig_1">Figure 1</a> shows the OpenFlow system architecture, which consists of the controller, OpenFlow devices, and OpenFlow protocol.</p>
<div class="fignone" id="EN-US_CONCEPT_0000001563750121__fig_1"><a name="EN-US_CONCEPT_0000001563750121__fig_1"></a><a name="fig_1"></a><span class="figcap"><b>Figure 1 </b>OpenFlow system architecture</span><br><span><img class="vsd" src="figure/en-us_image_0000001564109837.png"></span></div>
<p><strong>Controller</strong></p>
<p>A server residing at the OpenFlow control plane, which creates and maintains flow tables.</p>
<p><strong>OpenFlow Device</strong></p>
<div class="p">There are two types of OpenFlow devices:<ul><li>Dedicated OpenFlow device: a standard OpenFlow device that supports only OpenFlow forwarding.</li><li>OpenFlow-compatible device: a device supporting OpenFlow forwarding in addition to Layer 2 and Layer 3 data forwarding. Huawei CE series switches are OpenFlow-compatible switches.</li></ul>
</div>
<p><strong>OpenFlow Agent</strong></p>
<p>This is an OpenFlow management component on the OpenFlow device. The OpenFlow agent sets up OpenFlow connections with the controller. It then reports the interface information of the OpenFlow device.</p>
</div>
<div class="section"><h4 class="sectiontitle">OpenFlow Working Mechanism</h4><p>The controller controls and manages devices using the OpenFlow protocol. The controller and device establish an OpenFlow channel, through which they exchange information. If one device establishes OpenFlow connections with multiple controllers, the controllers notify the device of their roles through the OpenFlow channels.</p>
<p><strong>OpenFlow Channel Establishment and Maintenance</strong></p>
<p>The controller and device need to establish an OpenFlow channel before they can exchange information. After the channel is established, it needs to be maintained to ensure stability. The establishment and maintenance process of an OpenFlow channel is as follows:</p>
<ol><li>After the OpenFlow connection parameters are configured on the controller and device, the controller and device establish a TCP connection. </li><li>The controller and device exchange HELLO packets carrying information such as the OpenFlow protocol version through the TCP connection to negotiate the OpenFlow channel parameters.</li><li>After the OpenFlow channel parameters are negotiated, the controller sends a FEATURES_REQUEST packet to request the device's attributes. The device responds with a FEATURES_REPLY packet carrying its attributes. The OpenFlow channel is then established.</li><li><p>The controller and device exchange ECHO packets to detect peer device status. ECHO packets include ECHO_REQUEST and ECHO_REPLY packets. The detection initiator periodically sends ECHO_REQUEST packets, and the peer responds with ECHO_REPLY packets.</p>
<p>If the initiator does not receive any ECHO_REPLY packet after sending five consecutive ECHO_REQUEST packets, the initiator considers the peer device failed and closes the OpenFlow connection. If the initiator receives a packet (except ECHO_REPLY) before closing the OpenFlow connection, it restarts the counter.</p>
</li></ol>
<div class="fignone"><span class="figcap"><b>Figure 2 </b>OpenFlow channel establishment and maintenance</span><br><span><img class="vsd" src="figure/en-us_image_0000001563989997.png"></span></div>
<p><strong>Controller Role Notification</strong></p>
<p>A device can connect to one or more controllers through OpenFlow connections. Establishing OpenFlow connections to multiple controllers improves reliability and implements load balancing. If one controller is faulty or an OpenFlow connection fails, the device is still connected to the other controllers and works normally.</p>
<div class="p">A device must set up an OpenFlow connection with every configured controller and maintain connectivity. After OpenFlow channels are set up, the controllers actively send ROLE_REQUEST packets carrying controller roles to the device. The controller roles include EQUAL, MASTER, and SLAVE.<ul><li>When the ROLE_REQUEST packet contains OFPCR_ROLE_EQUAL, the controller is determined as the EQUAL. The EQUAL controller has the highest operating permissions on the device and can receive synchronization information from the device. This controller can send the forwarding information database and Packet-out packets to the device. By default, the role of the controller is EQUAL when it sets up a connection with a device.</li><li>When the ROLE_REQUEST message contains OFPCR_ROLE_MASTER, the controller is determined as the MASTER. The MASTER has the same permissions as EQUAL. If one MASTER exists, the other controllers can only be EQUAL or SLAVE.</li><li>When the ROLE_REQUEST packet contains OFPCR_ROLE_SLAVE, the controller is determined as the SLAVE. In this case, the controller has only read permission. The device does not send synchronization information to the controller or receive forwarding information databases or Packet-out packets from the slave device. If the device receives such information from the slave device, it discards the information and returns an OFPT_ERROR message.</li></ul>
</div>
<p>A controller determines its own role, and the controllers elect the MASTER. The device does not intervene with the MASTER or EQUAL controller election, and is informed of the controller role based on the ROLE_REQUEST packet. The role notification process for the controller is as follows:</p>
<ol><li>After the channel is established, the controller proactively sends a ROLE_REQUEST packet to the device. After receiving the packet, the device returns a ROLE_REPLY packet to the corresponding controller.</li><li>If a slave controller is elected as the MASTER controller, this controller sends a ROLE_REQUEST(MASTER) packet to notify the device of its role change. The device records the new MASTER controller and replies with a ROLE_REPLY packet. At the same time, the device sends a ROLE_STATUS packet to the previous MASTER controller, requesting it to change its role to SLAVE.</li></ol>
<div class="fignone"><span class="figcap"><b>Figure 3 </b>Controller role notification process</span><br><span><img class="vsd" src="figure/en-us_image_0000001512670618.png"></span></div>
<p><strong>Transparent Transmission of Packets</strong></p>
<p>The controller and device encapsulate packets into the Packet-in and Packet-out packets and transparently transmit them.</p>
<p>Packet-in: The device forwards information to the controller through Packet-in packets.</p>
<p>Packet-out: The controller delivers information to the device through Packet-out packets.</p>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_cfg_openflow_0001.html">OpenFlow Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_cfg_openflow_0002.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="spec/OpenFlow_limitation_CE_v6r23c00.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>