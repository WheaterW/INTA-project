
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring AAA Local Authentication and User Privilege Level Authorization for Administrators">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_aaa_cfg_0056.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_aaa_cfg_0077.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_aaa_cfg_0058.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="AAA">
<meta name="featurename" content="Local User">
<meta name="featuretype" content="User Access and Authentication">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="AAA">
<meta name="featurename" content="AD">
<meta name="featurename" content="HWTACACS">
<meta name="featurename" content="LDAP">
<meta name="featurename" content="RADIUS">
<meta name="featurename" content="Local User">
<meta name="featuretype" content="User Access and Authentication">
<meta name="featurename" content="AAA">
<meta name="featurename" content="AD">
<meta name="featurename" content="HWTACACS">
<meta name="featurename" content="LDAP">
<meta name="featurename" content="RADIUS">
<meta name="featurename" content="Local User">
<meta name="featuretype" content="User Access and Authentication">
<meta name="featuretype" content="User Access and Authentication">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001512836118">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring AAA Local Authentication and User Privilege Level Authorization for Administrators</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001512836118"></a><a name="EN-US_TASK_0000001512836118"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring AAA Local Authentication and User Privilege Level Authorization for Administrators</h1>
<div class="taskbody" id="taskbody1580782408811"><div class="context"><a name="EN-US_TASK_0000001512836118__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001512836118__dc_cfg_aaa_0030_01"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001512836118__p1677134242180144">In <a href="#EN-US_TASK_0000001512836118__fig_dc_ar_cfg_004001">Figure 1</a>, the enterprise requires that the administrator use AAA local authentication to log in to the device through STelnet. The specific requirements are as follows:</p>
<ol id="EN-US_TASK_0000001512836118__ol744391109180144"><li id="EN-US_TASK_0000001512836118__li2128797468180144">The administrator can log in to the device through STelnet only after entering a correct user name and password.</li><li id="EN-US_TASK_0000001512836118__li1494886852180144">After the administrator logs in to the device through STelnet, the privilege level 3 is authorized to the administrator.</li></ol>
<div class="fignone" id="EN-US_TASK_0000001512836118__fig_dc_ar_cfg_004001"><a name="EN-US_TASK_0000001512836118__fig_dc_ar_cfg_004001"></a><a name="fig_dc_ar_cfg_004001"></a><span class="figcap"><b>Figure 1 </b>Network diagram for configuring AAA local authentication and user privilege level authorization for administrators</span><div class="note" id="EN-US_TASK_0000001512836118__note1645559582"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001512836118__p1564575195810">In this example, interface 1 represents <span>100GE</span> <span>1/0/1</span>.</p>
</div></div>
<br><span><img class="vsd" id="EN-US_TASK_0000001512836118__image1144936523180144" src="figure/en-us_image_0000001564115885.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001512836118__1.3.2"></a><a name="1.3.2"></a>
<div class="p" id="EN-US_TASK_0000001512836118__dc_cfg_aaa_0030_02"><h4 class="sectiontitle">Configuration Roadmap</h4><ol id="EN-US_TASK_0000001512836118__ol53167870180144"><li id="EN-US_TASK_0000001512836118__li470276047180144">Configure STelnet login on DeviceA: Set the authentication mode for accessing VTY user interfaces to AAA, enable the STelnet service, and configure the authentication mode and service type for SSH users.</li><li id="EN-US_TASK_0000001512836118__li1290016564180144">Configure AAA local authentication: Configure a user name and password, set the user access type, and set the user privilege level.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001512836118__1.3.3"></a><a name="1.3.3"></a>
<div class="p" id="EN-US_TASK_0000001512836118__context14295364357"><h4 class="sectiontitle">Precautions</h4><p id="EN-US_TASK_0000001512836118__p78335101362">Ensure that there are reachable routes between devices before the configuration.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001512836118__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001512836118__steps562715363180144"><li id="EN-US_TASK_0000001512836118__step130232719011"><span id="EN-US_TASK_0000001512836118__cmd9302127200">Configure IP addresses for interfaces.</span><p><pre class="screen" id="EN-US_TASK_0000001512836118__screen108472273419">&lt;<span class="keyword" id="EN-US_TASK_0000001512836118__keyword1255584214419">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001512836118__b105551421543">system-view</strong> 
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword" id="EN-US_TASK_0000001512836118__keyword1755517423413">HUAWEI</span>] <strong id="EN-US_TASK_0000001512836118__b1055516421417">sysname DeviceA</strong> 
[*<span class="keyword" id="EN-US_TASK_0000001512836118__keyword184754741315">DeviceA</span>] <strong id="EN-US_TASK_0000001512836118__b16395153591710">commit</strong>
[<font style="font-size:8pt" Face="Courier New" >~</font><span class="keyword" id="EN-US_TASK_0000001512836118__keyword165559423416">DeviceA</span>]<strong id="EN-US_TASK_0000001512836118__b6969193714352"> vlan batch 10</strong>
[*DeviceA] <strong id="EN-US_TASK_0000001512836118__b655534211411">interface </strong><strong id="EN-US_TASK_0000001512836118__b1772115312199"><span>100ge</span> </strong><strong id="EN-US_TASK_0000001512836118__b2721053141913"><span>1/0/1</span></strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001512836118__b1514329121313">portswitch</strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001512836118__b7451171713372">port link-type trunk</strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001512836118__b1055613421413">port trunk allow-pass vlan 10</strong>
[*DeviceA-<span>100GE</span><span>1/0/1</span>] <strong id="EN-US_TASK_0000001512836118__b45568421343">quit</strong>
[*DeviceA] <strong id="EN-US_TASK_0000001512836118__b1575415346435">interface vlanif 10</strong>
[*DeviceA-Vlanif10] <strong id="EN-US_TASK_0000001512836118__b45517312456">ip address 192.168.10.1 24</strong>
[*DeviceA-Vlanif10] <strong id="EN-US_TASK_0000001512836118__b5305184394512">quit</strong>
[*<span class="keyword" id="EN-US_TASK_0000001512836118__keyword428310496400">DeviceA</span>] <strong id="EN-US_TASK_0000001512836118__b11283174913404">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001512836118__step3477436164214"><span id="EN-US_TASK_0000001512836118__cmd6477183634215">Configure STelnet login.</span><p><p id="EN-US_TASK_0000001512836118__p3165184819437"># Configure DeviceA to generate a local key pair.</p>
<pre class="screen" id="EN-US_TASK_0000001512836118__screen103541745121516">[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword11458115514352"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001512836118__b7200134213711">rsa local-key-pair create</strong>
The key name will be:Host
The range of public key size is (2048, 4096).
NOTE: Key pair generation will take a short while.
Please input the modulus [default = 3072]:3072 </pre>
<p id="EN-US_TASK_0000001512836118__p13165648154318"># Set the authentication mode and protocol for accessing VTY user interfaces 0 to 4 to AAA and SSH, respectively.</p>
<pre class="screen" id="EN-US_TASK_0000001512836118__screen1116544812432">[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword384243512311">*</span>DeviceA] <strong id="EN-US_TASK_0000001512836118__b01656488433">user-interface vty 0 4</strong> 
[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword177694375317">*</span>DeviceA-ui-vty0-4] <strong id="EN-US_TASK_0000001512836118__b16165194824311">authentication-mode aaa</strong> 
[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword1028711478312">*</span>DeviceA-ui-vty0-4] <strong id="EN-US_TASK_0000001512836118__b1416544894320">protocol inbound ssh</strong>
[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword18496145014317">*</span>DeviceA-ui-vty0-4] <strong id="EN-US_TASK_0000001512836118__b216554819435">quit</strong></pre>
<p id="EN-US_TASK_0000001512836118__p41652481434"># Enable the SSH server function on DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001512836118__screen69178245378">[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword11614163913718">*</span>DeviceA] <strong id="EN-US_TASK_0000001512836118__b1261410394377">stelnet server enable</strong> 
[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword15614103963714">*</span>DeviceA] <strong id="EN-US_TASK_0000001512836118__b3614193943720">ssh server-source -i </strong><strong id="EN-US_TASK_0000001512836118__b18682175919287">vlanif 10</strong></pre>
<p id="EN-US_TASK_0000001512836118__p13165184814315"># Set the authentication mode of all SSH users to password authentication.</p>
<pre class="screen" id="EN-US_TASK_0000001512836118__screen016534814317">[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword204741758153118">*</span>DeviceA] <strong id="EN-US_TASK_0000001512836118__b1316544818435">ssh authentication-type default password</strong>
[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword3278620133310">*</span>DeviceA] <strong id="EN-US_TASK_0000001512836118__b827818207333">commit</strong></pre>
<div class="note" id="EN-US_TASK_0000001512836118__note1437971481"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001512836118__p13568138164810">If only the authentication mode and service type of a few SSH users need to be set to password authentication and STelnet, you can specify the SSH user name to set the authentication mode and service type of a single SSH user. For example, set the authentication mode and service type of an SSH user named <strong id="EN-US_TASK_0000001512836118__b109551148172614">admin</strong> to password authentication and STelnet, respectively.</p>
<p id="EN-US_TASK_0000001512836118__p155681781488">[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword2069313224815">DeviceA</span>] <strong id="EN-US_TASK_0000001512836118__b1856815854819">ssh user admin authentication-type password</strong></p>
<p id="EN-US_TASK_0000001512836118__p12568108194815">[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword13425133415489">DeviceA</span>] <strong id="EN-US_TASK_0000001512836118__b16568158164817">ssh user admin service-type stelnet</strong></p>
</div></div>
</p></li><li id="EN-US_TASK_0000001512836118__step1285142125180144"><span id="EN-US_TASK_0000001512836118__cmd2140656996180144">Configure AAA local authentication.</span><p><pre class="screen" id="EN-US_TASK_0000001512836118__screen1327691757180144">[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword18247856163320"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001512836118__b1077448753180144">aaa</strong>
[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword26256592337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-aaa] <strong id="EN-US_TASK_0000001512836118__b1264860725180144">local-user user1-huawei password irreversible-cipher </strong><strong id="EN-US_TASK_0000001512836118__b1829713231144">YsHsjx_202206</strong>
[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword86731283342">*</span>DeviceA-aaa] <strong id="EN-US_TASK_0000001512836118__b363791212180144">local-user user1-huawei service-type ssh</strong>
[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword133781139143413">*</span>DeviceA-aaa] <strong id="EN-US_TASK_0000001512836118__b25908927180144">local-user user1-huawei privilege level 3</strong>
[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword1045818419344">*</span>DeviceA-aaa] <strong id="EN-US_TASK_0000001512836118__b992359841180144">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001512836118__keyword12754155783415">*</span>DeviceA] <strong id="EN-US_TASK_0000001512836118__b107545572342">commit</strong></pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001512836118__example1722179237180144"><a name="EN-US_TASK_0000001512836118__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0000001512836118__p675791215578">The administrator can log in to DeviceA through the STelnet client after entering the correct user name and password.</p>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001512836118__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><pre class="screen" id="EN-US_TASK_0000001512836118__screen1978793865617">#
sysname DeviceA
#
aaa
 local-user user1-huawei password irreversible-cipher $1d$OwseVRh@LH}ZeTBm$1nH4$ab&gt;d(N{-%0!ab48y=Ic*xEUR4pVhR2"9-<font style="font-size:8pt" Face="Courier New" >~</font>,$
 local-user user1-huawei privilege level 3
 local-user user1-huawei service-type ssh   
# 
vlan batch 10
#
interface Vlanif10
 ip address 192.168.10.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/1</span>
 port link-type trunk
 port trunk allow-pass vlan 10
#
stelnet server enable 
ssh server-source -i Vlanif 10
#
user-interface vty 0 4           
 authentication-mode aaa           
 protocol inbound ssh
# 
return </pre>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_aaa_cfg_0056.html">Configuration Examples for AAA
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_aaa_cfg_0077.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_aaa_cfg_0058.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>