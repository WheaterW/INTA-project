
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring an Advanced ACL">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_acl_cfg_0010.html">
<meta name="DC.Relation" scheme="URI" content="vrp_acl_cfg_0011.html">
<meta name="DC.Relation" scheme="URI" content="vrp_acl_cfg_0013.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="ACL">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ACL">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="ACL">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176742481">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring an Advanced ACL</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176742481"></a><a name="EN-US_TASK_0000001176742481"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring an Advanced ACL</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176742481__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Advanced ACLs give more flexibility and functionality than basic ACLs, allowing you to filter packets more accurately. For example, with advanced ACLs, you can define packet filtering rules based on information such as source and destination IPv4 addresses, IP protocol types, TCP source and destination port numbers, UDP source and destination port numbers, fragment information, and time ranges.</p>
<p>To match multiple source and destination IPv4 addresses using an advanced ACL, configure an ACL IPv4 address pool. This helps reduce configuration workloads. After an ACL IPv4 address pool is configured, you only need to configure an ACL rule with a specified ACL IPv4 address pool name (<i><span class="varname">pool-name</span></i>) to match multiple IPv4 addresses.</p>
<p>To match multiple source and destination port numbers using an advanced ACL, configure an ACL port pool. This helps reduce configuration workloads. After an ACL port pool is configured, you only need to configure an ACL rule with a specified ACL port pool name (<i><span class="varname">pool-name</span></i>) to match multiple port numbers.</p>
<div class="p"><strong id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_b1652132913555">When ACL rules are configured:</strong><ul id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_en-us_concept_0177090555_ul1191338372183158"><li id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_en-us_concept_0177090555_li822401570183158"><p id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_en-us_concept_0177090555_p898434898183158"><a name="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_en-us_concept_0177090555_li822401570183158"></a><a name="en-us_task_0000001176742483_en-us_concept_0177090555_li822401570183158"></a>If the specified rule ID already exists and the new rule conflicts with the original, the original is replaced.</p>
</li><li id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_en-us_concept_0177090555_li504316878183158"><p id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_en-us_concept_0177090555_p2083297484183158"><a name="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_en-us_concept_0177090555_li504316878183158"></a><a name="en-us_task_0000001176742483_en-us_concept_0177090555_li504316878183158"></a>Matching stops for a packet once the packet matches a rule in an ACL.</p>
</li><li id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_li1538122512195">Many services that are not configured with ACL rules also occupy ACL resources. You can run the <a href="cmdqueryname=display+system+tcam+service+brief"><b><span class="cmdname" id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_cmdname4391122852016">display system tcam service brief</span></b></a> command to check ACL resources occupied by services.</li></ul>
</div>
<p><strong id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_b19922155455712">When ACL rules are deleted:</strong> The <a href="cmdqueryname=undo+rule"><b><span class="cmdname" id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_en-us_concept_0177090555_cmdname1539083973183158">undo rule</span></b></a> command can delete an ACL rule even if this rule is referenced. Before deleting a rule, run the <a href="cmdqueryname=display+current-configuration+%7C+include+acl"><b><span class="cmdname" id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_cmdname6906162174518">display current-configuration | include acl</span></b></a> command to check whether the rule is being referenced.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176742481__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Create an advanced ACL. You can create a numbered or named advanced ACL.</span><p><ul><li><div class="p">Create a numbered advanced ACL and enter its view.<pre class="screen"><a href="cmdqueryname=acl+number"><b><span class="cmdname">acl</span></b></a> [ <strong><span>number</span></strong> ] <i><span class="varname">advance-acl-number</span></i> </pre>
</div>
<p>The number of an advanced ACL ranges from 3000 to 3999.</p>
</li><li><p>Create a named advanced ACL and enter its view.</p>
<pre class="screen"><a href="cmdqueryname=acl+name+advance+number"><b><span class="cmdname">acl name</span></b></a> <i><span class="varname">advance-acl-name</span></i> [ <strong><span>advance</span></strong> | [ <strong><span>number</span></strong> ] <i><span class="varname">advance-acl-number</span></i> ] </pre>
</li></ul>
</p></li><li><span>(Optional) Configure an ACL step.</span><p><pre class="screen" id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_screen148201438191713"><a href="cmdqueryname=step"><b><span class="cmdname" id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_cmdname430815436176">step</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_varname776743717423">step-value</span></i></pre>
</p><p><p id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_p1373340508183306">The default ACL step is 5. Change the step value as required.</p>
</p></li><li><span>(Optional) Configure a description for the basic ACL.</span><p><pre class="screen" id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_screen1670613531740"><a href="cmdqueryname=description"><b><span class="cmdname" id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_cmdname664116591417">description</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_varname126411059742">text</span></i></pre>
<p id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_p48583136183305">The ACL description helps you understand and remember the functions or purpose of the ACL.</p>
</p></li><li><span>(Optional) Configure an ACL IPv4 address pool.</span><ol type="a"><li class="substepexpand"><span>Create an ACL IPv4 address pool and enter its view.</span><p><pre class="screen"><a href="cmdqueryname=acl+ip-pool"><b><span class="cmdname">acl ip-pool</span></b></a> <i><span class="varname">pool-name</span></i></pre>
</p></li><li class="substepexpand"><span>Add an IPv4 address to the ACL IPv4 address pool.</span><p><pre class="screen"><a href="cmdqueryname=ip+address"><b><span class="cmdname">ip address</span></b></a> <i><span class="varname">ip-address</span></i> { <i><span class="varname">mask</span></i> | <i><span class="varname">mask-length</span></i> }</pre>
</p></li></ol>
</li><li><span>(Optional) Configure an ACL port pool.</span><ol type="a"><li class="substepexpand"><span>Create an ACL port pool and enter its view.</span><p><pre class="screen"><a href="cmdqueryname=acl+port-pool"><b><span class="cmdname">acl port-pool</span></b></a> <i><span class="varname">pool-name</span></i></pre>
</p></li><li class="substepexpand"><span>Run one or more of the following commands to add a port number to the ACL port pool.</span><p><pre class="screen">{ <strong><span>eq</span></strong> | <strong><span>lt</span></strong> | <strong><span>gt</span></strong> } <i><span class="varname">begin-port-number</span></i></pre>
<pre class="screen"><a href="cmdqueryname=range"><b><span class="cmdname">range</span></b></a> <i><span class="varname">begin-port-number</span></i> <i><span class="varname">end-port-number</span></i></pre>
</p></li></ol>
</li><li><span>Return to the system view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li><span>Run either of the following commands to enter the advanced ACL view.</span><p><pre class="screen"><a href="cmdqueryname=acl+number"><b><span class="cmdname">acl</span></b></a> [ <strong><span>number</span></strong> ] <i><span class="varname">advance-acl-number</span></i></pre>
<pre class="screen"><a href="cmdqueryname=acl+name"><b><span class="cmdname">acl name</span></b></a> <i><span class="varname">advance-acl-name</span></i></pre>
</p></li><li><span>Configure a rule for the advanced ACL. Run the following commands based on the protocol type:</span><p><ul><li><p>When <i><span class="varname">protocol</span></i> is specified as UDP, run:</p>
<pre class="screen"><a href="cmdqueryname=rule+name+permit+deny+udp+dscp+af11+af12+af13+af21+af22+af23"><b><span class="cmdname">rule </span></b></a>[ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } { <strong><span>udp</span></strong> | <i><span class="varname">17</span></i> } [ [ <strong><span>dscp</span></strong> { <i><span class="varname">dscp</span></i> | <strong><span>af11</span></strong> | <strong><span>af12</span></strong> | <strong><span>af13</span></strong> | <strong><span>af21</span></strong> | <strong><span>af22</span></strong> | <strong><span>af23</span></strong> | <strong><span>af31</span></strong> | <strong><span>af32</span></strong> | <strong><span>af33</span></strong> | <strong><span>af41</span></strong> | <strong><span>af42</span></strong> | <strong><span>af43</span></strong> | <strong><span>cs1</span></strong> | <strong><span>cs2</span></strong> | <strong><span>cs3</span></strong> | <strong><span>cs4</span></strong> | <strong><span>cs5</span></strong> | <strong><span>cs6</span></strong> | <strong><span>cs7</span></strong> | <strong><span>default</span></strong> | <strong><span>ef</span></strong> } | [ <strong><span>tos</span></strong> { <i><span class="varname">tos</span></i> | <strong><span>max-reliability</span></strong> | <strong><span>max-throughput</span></strong> | <strong><span>min-delay</span></strong> | <strong><span>min-monetary-cost</span></strong> | <strong><span>normal</span></strong> } | <strong><span>precedence</span></strong> { <i><span class="varname">precedence</span></i> | <strong><span>critical</span></strong> | <strong><span>flash</span></strong> | <strong><span>flash-override</span></strong> | <strong><span>immediate</span></strong> | <strong><span>internet</span></strong> | <strong><span>network</span></strong> | <strong><span>priority</span></strong> | <strong><span>routine</span></strong> } ] <sup>*</sup> ] | { <strong><span>destination</span></strong> { <i><span class="varname">destination-ip-address</span></i> { <i><span class="varname">destination-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">des-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>destination-pool</span></strong> <i><span class="varname">destination-pool-name</span></i> } | { <strong><span>destination-port</span></strong> { <strong><span>range</span></strong> { <i><span class="varname">port-number</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } | { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } } | <strong><span>destination-port-pool</span></strong> <i><span class="varname">destination-port-pool-name</span></i> } | <strong><span>fragment-type</span></strong> <strong><span>fragment</span></strong> | { <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">src-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>source-pool</span></strong> <i><span class="varname">source-pool-name</span></i> } | { <strong><span>source-port</span></strong> { <strong><span>range</span></strong> { <i><span class="varname">port-number</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } | { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>biff</span></strong> | <strong><span>bootpc</span></strong> | <strong><span>bootps</span></strong> | <strong><span>dns</span></strong> | <strong><span>discard</span></strong> | <strong><span>dnsix</span></strong> | <strong><span>echo</span></strong> | <strong><span>mobilip-ag</span></strong> | <strong><span>mobilip-mn</span></strong> | <strong><span>nameserver</span></strong> | <strong><span>netbios-dgm</span></strong> | <strong><span>netbios-ns</span></strong> | <strong><span>netbios-ssn</span></strong> | <strong><span>ntp</span></strong> | <strong><span>rip</span></strong> | <strong><span>snmp</span></strong> | <strong><span>snmptrap</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>syslog</span></strong> | <strong><span>tacacs-ds</span></strong> | <strong><span>talk</span></strong> | <strong><span>tftp</span></strong> | <strong><span>time</span></strong> | <strong><span>who</span></strong> | <strong><span>xdmcp</span></strong> } } | <strong><span>source-port-pool</span></strong> <i><span class="varname">source-port-pool-name</span></i> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i><span> | <strong><span>ttl</span></strong> { { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } <i><span class="varname">begin-ttlvalue</span></i> | <strong><span>range</span></strong> <i><span class="varname">begin-ttlvalue</span></i> <i><span class="varname">end-ttlvalue</span></i> }</span> |<span> </span><strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> <span></span>| <strong><span>logging</span></strong> ] <sup>*</sup></pre>
</li><li><p>When <i><span class="varname">protocol</span></i> is specified as TCP, run:</p>
<pre class="screen"><a href="cmdqueryname=rule+name+permit+deny+tcp+dscp+af11+af12+af13+af21+af22+af23"><b><span class="cmdname">rule </span></b></a>[ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } { <strong><span>tcp</span></strong> | <i><span class="varname">6</span></i> } [ [ <strong><span>dscp</span></strong> { <i><span class="varname">dscp</span></i> | <strong><span>af11</span></strong> | <strong><span>af12</span></strong> | <strong><span>af13</span></strong> | <strong><span>af21</span></strong> | <strong><span>af22</span></strong> | <strong><span>af23</span></strong> | <strong><span>af31</span></strong> | <strong><span>af32</span></strong> | <strong><span>af33</span></strong> | <strong><span>af41</span></strong> | <strong><span>af42</span></strong> | <strong><span>af43</span></strong> | <strong><span>cs1</span></strong> | <strong><span>cs2</span></strong> | <strong><span>cs3</span></strong> | <strong><span>cs4</span></strong> | <strong><span>cs5</span></strong> | <strong><span>cs6</span></strong> | <strong><span>cs7</span></strong> | <strong><span>default</span></strong> | <strong><span>ef</span></strong> } | [ <strong><span>precedence</span></strong> { <i><span class="varname">precedence</span></i> | <strong><span>critical</span></strong> | <strong><span>flash</span></strong> | <strong><span>flash-override</span></strong> | <strong><span>immediate</span></strong> | <strong><span>internet</span></strong> | <strong><span>network</span></strong> | <strong><span>priority</span></strong> | <strong><span>routine</span></strong> } | <strong><span>tos</span></strong> { <i><span class="varname">tos</span></i> | <strong><span>max-reliability</span></strong> | <strong><span>max-throughput</span></strong> | <strong><span>min-delay</span></strong> | <strong><span>min-monetary-cost</span></strong> | <strong><span>normal</span></strong> } ] <sup>*</sup> ] | { <strong><span>destination</span></strong> { <i><span class="varname">destination-ip-address</span></i> { <i><span class="varname">destination-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">des-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>destination-pool</span></strong> <i><span class="varname">destination-pool-name</span></i> } | { <strong><span>destination-port</span></strong> { <strong><span>range</span></strong> { <i><span class="varname">port-number</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } | { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } } | <strong><span>destination-port-pool</span></strong> <i><span class="varname">destination-port-pool-name</span></i> } | <strong><span>fragment-type</span></strong> <strong><span>fragment</span></strong> | { <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">src-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>source-pool</span></strong> <i><span class="varname">source-pool-name</span></i> } | { <strong><span>source-port</span></strong> { <strong><span>range</span></strong> { <i><span class="varname">port-number</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } | { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> } { <i><span class="varname">port-number</span></i> | <strong><span>chargen</span></strong> | <strong><span>bgp</span></strong> | <strong><span>cmd</span></strong> | <strong><span>daytime</span></strong> | <strong><span>discard</span></strong> | <strong><span>domain</span></strong> | <strong><span>echo</span></strong> | <strong><span>exec</span></strong> | <strong><span>finger</span></strong> | <strong><span>ftp</span></strong> | <strong><span>ftp-data</span></strong> | <strong><span>gopher</span></strong> | <strong><span>hostname</span></strong> | <strong><span>irc</span></strong> | <strong><span>klogin</span></strong> | <strong><span>kshell</span></strong> | <strong><span>login</span></strong> | <strong><span>lpd</span></strong> | <strong><span>nntp</span></strong> | <strong><span>pop2</span></strong> | <strong><span>pop3</span></strong> | <strong><span>smtp</span></strong> | <strong><span>sunrpc</span></strong> | <strong><span>tacacs</span></strong> | <strong><span>talk</span></strong> | <strong><span>telnet</span></strong> | <strong><span>time</span></strong> | <strong><span>uucp</span></strong> | <strong><span>whois</span></strong> | <strong><span>www</span></strong> } } | <strong><span>source-port-pool</span></strong> <i><span class="varname">source-port-pool-name</span></i> } | <strong><span>tcp-flag</span></strong> { <i><span class="varname">tcp-flag</span></i> [ <strong><span>mask</span></strong> <i><span class="varname">mask-value</span></i> ] | <strong><span>established</span></strong> | { <strong><span>ack</span></strong> [ <strong><span>fin</span></strong> | <strong><span>psh</span></strong> | <strong><span>rst</span></strong> | <strong><span>syn</span></strong> | <strong><span>urg</span></strong> ] <sup>*</sup> } | { <strong><span>fin</span></strong> [ <strong><span>ack</span></strong> | <strong><span>psh</span></strong> | <strong><span>rst</span></strong> | <strong><span>syn</span></strong> | <strong><span>urg</span></strong> ] <sup>*</sup> } | { <strong><span>psh</span></strong> [ <strong><span>fin</span></strong> | <strong><span>ack</span></strong> | <strong><span>rst</span></strong> | <strong><span>syn</span></strong> | <strong><span>urg</span></strong> ] <sup>*</sup> } | { <strong><span>rst</span></strong> [ <strong><span>fin</span></strong> | <strong><span>psh</span></strong> | <strong><span>ack</span></strong> | <strong><span>syn</span></strong> | <strong><span>urg</span></strong> ] <sup>*</sup> } | { <strong><span>syn</span></strong> [ <strong><span>fin</span></strong> | <strong><span>psh</span></strong> | <strong><span>rst</span></strong> | <strong><span>ack</span></strong> | <strong><span>urg</span></strong> ] <sup>*</sup> } | { <strong><span>urg</span></strong> [ <strong><span>fin</span></strong> | <strong><span>psh</span></strong> | <strong><span>rst</span></strong> | <strong><span>syn</span></strong> | <strong><span>ack</span></strong> ] <sup>*</sup> } }<span> | <strong><span>ttl</span></strong> { { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } <i><span class="varname">begin-ttlvalue</span></i> | <strong><span>range</span></strong> <i><span class="varname">begin-ttlvalue</span></i> <i><span class="varname">end-ttlvalue</span></i> }</span> | <span></span><strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> <span></span>| <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | <strong><span>logging</span></strong> ] <sup>*</sup></pre>
</li><li><p>When <i><span class="varname">protocol</span></i> is specified as ICMP, run:</p>
<pre class="screen"><a href="cmdqueryname=rule+name+permit+deny+icmp+dscp+af11+af12+af13+af21+af22+af23"><b><span class="cmdname">rule </span></b></a>[ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } { <strong><span>icmp</span></strong> | <i><span class="varname">1</span></i> } [ [ <strong><span>dscp</span></strong> { <i><span class="varname">dscp</span></i> | <strong><span>af11</span></strong> | <strong><span>af12</span></strong> | <strong><span>af13</span></strong> | <strong><span>af21</span></strong> | <strong><span>af22</span></strong> | <strong><span>af23</span></strong> | <strong><span>af31</span></strong> | <strong><span>af32</span></strong> | <strong><span>af33</span></strong> | <strong><span>af41</span></strong> | <strong><span>af42</span></strong> | <strong><span>af43</span></strong> | <strong><span>cs1</span></strong> | <strong><span>cs2</span></strong> | <strong><span>cs3</span></strong> | <strong><span>cs4</span></strong> | <strong><span>cs5</span></strong> | <strong><span>cs6</span></strong> | <strong><span>cs7</span></strong> | <strong><span>default</span></strong> | <strong><span>ef</span></strong> } | [ <strong><span>tos</span></strong> { <i><span class="varname">tos</span></i> | <strong><span>max-reliability</span></strong> | <strong><span>max-throughput</span></strong> | <strong><span>min-delay</span></strong> | <strong><span>min-monetary-cost</span></strong> | <strong><span>normal</span></strong> } | <strong><span>precedence</span></strong> { <i><span class="varname">precedence</span></i> | <strong><span>critical</span></strong> | <strong><span>flash</span></strong> | <strong><span>flash-override</span></strong> | <strong><span>immediate</span></strong> | <strong><span>internet</span></strong> | <strong><span>network</span></strong> | <strong><span>priority</span></strong> | <strong><span>routine</span></strong> } ] <sup>*</sup> ] | { <strong><span>destination</span></strong> { <i><span class="varname">destination-ip-address</span></i> { <i><span class="varname">destination-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">des-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>destination-pool</span></strong> <i><span class="varname">destination-pool-name</span></i> } | [ <strong><span>fragment-type</span></strong> <strong><span>fragment</span></strong> ] | <strong><span>icmp-type</span></strong> { <i><span class="varname">icmp-name</span></i> | <i><span class="varname">icmp-type</span></i> [ <i><span class="varname">icmp-code</span></i> ] } | { <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">src-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>source-pool</span></strong> <i><span class="varname">source-pool-name</span></i> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i><span> | <strong><span>ttl</span></strong> { { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } <i><span class="varname">begin-ttlvalue</span></i> | <strong><span>range</span></strong> <i><span class="varname">begin-ttlvalue</span></i> <i><span class="varname">end-ttlvalue</span></i> }</span> | <span></span><strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>logging</span></strong> ] <sup>*</sup></pre>
</li><li><p>When <i><span class="varname">protocol</span></i> is specified as IGMP, run:</p>
<pre class="screen"><a href="cmdqueryname=rule+name+permit+deny+igmp+dscp+af11+af12+af13+af21+af22+af23"><b><span class="cmdname">rule </span></b></a>[ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } { <strong><span>igmp</span></strong> | <i><span class="varname">2</span></i> } [ [ <strong><span>dscp</span></strong> { <i><span class="varname">dscp</span></i> | <strong><span>af11</span></strong> | <strong><span>af12</span></strong> | <strong><span>af13</span></strong> | <strong><span>af21</span></strong> | <strong><span>af22</span></strong> | <strong><span>af23</span></strong> | <strong><span>af31</span></strong> | <strong><span>af32</span></strong> | <strong><span>af33</span></strong> | <strong><span>af41</span></strong> | <strong><span>af42</span></strong> | <strong><span>af43</span></strong> | <strong><span>cs1</span></strong> | <strong><span>cs2</span></strong> | <strong><span>cs3</span></strong> | <strong><span>cs4</span></strong> | <strong><span>cs5</span></strong> | <strong><span>cs6</span></strong> | <strong><span>cs7</span></strong> | <strong><span>default</span></strong> | <strong><span>ef</span></strong> } | [ <strong><span>tos</span></strong> { <i><span class="varname">value</span></i> | <strong><span>max-reliability</span></strong> | <strong><span>max-throughput</span></strong> | <strong><span>min-delay</span></strong> | <strong><span>min-monetary-cost</span></strong> | <strong><span>normal</span></strong> } | <strong><span>precedence</span></strong> { <i><span class="varname">precedence</span></i> | <strong><span>critical</span></strong> | <strong><span>flash</span></strong> | <strong><span>flash-override</span></strong> | <strong><span>immediate</span></strong> | <strong><span>internet</span></strong> | <strong><span>network</span></strong> | <strong><span>priority</span></strong> | <strong><span>routine</span></strong> } ] <sup>*</sup> ] | { <strong><span>destination</span></strong> { <i><span class="varname">destination-ip-address</span></i> { <i><span class="varname">destination-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">des-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>destination-pool</span></strong> <i><span class="varname">destination-pool-name</span></i> } | <strong><span>fragment-type</span></strong> <strong><span>fragment</span></strong> | { <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">src-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>source-pool</span></strong> <i><span class="varname">source-pool-name</span></i> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i><span> | <strong><span>ttl</span></strong> { { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } <i><span class="varname">begin-ttlvalue</span></i> | <strong><span>range</span></strong> <i><span class="varname">begin-ttlvalue</span></i> <i><span class="varname">end-ttlvalue</span></i> }</span> | <span></span><strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> <span></span>| <strong><span>logging</span></strong> ] <sup>*</sup></pre>
</li><li><p>When <i><span class="varname">protocol</span></i> is specified as a protocol other than TCP, UDP, ICMP, and IGMP, run:</p>
<pre class="screen"><a href="cmdqueryname=rule+name+permit+deny+zero+gre+ip+ipinip+ospf+dscp+af11+af12"><b><span class="cmdname">rule </span></b></a>[ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>permit</span></strong> | <strong><span>deny</span></strong> } { <strong><span>zero</span></strong> | <i><span class="varname">protocol</span></i> | <strong><span>gre</span></strong> | <strong><span>ip</span></strong> | <strong><span>ipinip</span></strong> | <strong><span>ospf</span></strong> | <i><span class="varname">7-16</span></i> | <i><span class="varname">18-255</span></i> } [ [ <strong><span>dscp</span></strong> { <i><span class="varname">dscp</span></i> | <strong><span>af11</span></strong> | <strong><span>af12</span></strong> | <strong><span>af13</span></strong> | <strong><span>af21</span></strong> | <strong><span>af22</span></strong> | <strong><span>af23</span></strong> | <strong><span>af31</span></strong> | <strong><span>af32</span></strong> | <strong><span>af33</span></strong> | <strong><span>af41</span></strong> | <strong><span>af42</span></strong> | <strong><span>af43</span></strong> | <strong><span>cs1</span></strong> | <strong><span>cs2</span></strong> | <strong><span>cs3</span></strong> | <strong><span>cs4</span></strong> | <strong><span>cs5</span></strong> | <strong><span>cs6</span></strong> | <strong><span>cs7</span></strong> | <strong><span>default</span></strong> | <strong><span>ef</span></strong> } | [ <strong><span>tos</span></strong> { <i><span class="varname">value</span></i> | <strong><span>max-reliability</span></strong> | <strong><span>max-throughput</span></strong> | <strong><span>min-delay</span></strong> | <strong><span>min-monetary-cost</span></strong> | <strong><span>normal</span></strong> } | <strong><span>precedence</span></strong> { <i><span class="varname">precedence</span></i> | <strong><span>critical</span></strong> | <strong><span>flash</span></strong> | <strong><span>flash-override</span></strong> | <strong><span>immediate</span></strong> | <strong><span>internet</span></strong> | <strong><span>network</span></strong> | <strong><span>priority</span></strong> | <strong><span>routine</span></strong> } ] <sup>*</sup> ] | { <strong><span>destination</span></strong> { <i><span class="varname">destination-ip-address</span></i> { <i><span class="varname">destination-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">des-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>destination-pool</span></strong> <i><span class="varname">destination-pool-name</span></i> } | <strong><span>fragment-type</span></strong> <strong><span>fragment</span></strong> | { <strong><span>source</span></strong> { <i><span class="varname">source-ip-address</span></i> { <i><span class="varname">source-wildcard</span></i> | <strong><span>0</span></strong> | <i><span class="varname">src-netmask</span></i> } | <strong><span>any</span></strong> } | <strong><span>source-pool</span></strong> <i><span class="varname">source-pool-name</span></i> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i><span> | <strong><span>ttl</span></strong> { { <strong><span>gt</span></strong> | <strong><span>lt</span></strong> | <strong><span>eq</span></strong> | <strong><span>neq</span></strong> } <i><span class="varname">begin-ttlvalue</span></i> | <strong><span>range</span></strong> <i><span class="varname">begin-ttlvalue</span></i> <i><span class="varname">end-ttlvalue</span></i> }</span> | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> | <strong><span>logging</span></strong> ] <sup>*</sup></pre>
</li></ul>
</p><p><p>In this example, only one permit or deny rule is configured. In actual configuration, you can configure multiple ACL rules and decide the matching order of the rules according to service requirements.</p>
</p><p><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>To configure a time-based advanced ACL, you must create a time range. For details, see <a href="vrp_acl_cfg_0009.html">Creating a Time Range in Which an ACL Takes Effect</a>.</p>
<div class="p">When a rule is configured for an advanced ACL:<ul><li><p>If a destination IPv4 address, destination port number, source IPv4 address, and source port number are specified by <strong><span>destination</span></strong>, <strong><span>destination-port</span></strong>, <strong><span>source</span></strong>, and <strong><span>source-port</span></strong> respectively, the system filters only packets with the specified destination IPv4 address, destination port number, source IPv4 address, and source port number.</p>
</li><li><p>If all destination and source IPv4 addresses are specified by <strong><span>any</span></strong>, the system does not check packets' destination or source IPv4 addresses, and considers that all packets have matched the rule and directly takes an action (<strong><span>deny</span></strong> or <strong><span>permit</span></strong>) on the packets.</p>
</li><li><p>If <strong><span>time-range</span></strong> is specified, the specified time range name must exist. Otherwise, the ACL rule configuration fails.</p>
</li></ul>
</div>
</div></div>
</p></li><li><span>(Optional) Configure a description for the ACL rule.</span><p><pre class="screen" id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_screen826615523308"><a href="cmdqueryname=rule+description"><b><span class="cmdname" id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_cmdnameab4d2703fa0c1de096e4d062b2daaf76">rule </span></b></a><i><span class="varname" id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_varname2b46a6416d48ff26018b9248bc2f24d3">rule-id</span></i> <strong><span id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_cmdpar6d720d4c65920475c7de7c975e80d31c">description</span></strong> <i><span class="varname" id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_varname7f65f9ae3bfa636bde170682d2274f6c">destext</span></i></pre>
<p id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_p2120462660183305">The ACL rule description helps you understand and remember the functions or purpose of the ACL rule.</p>
<p id="EN-US_TASK_0000001176742481__en-us_task_0000001176742483_rule_description_01">You must create a rule before you can configure a description for it.</p>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001176742481__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001176742481__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001176742481__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Example</h4><ul><li><p>Configure a filtering rule for ICMP packets based on the source IPv4 address (host address) and destination IPv4 address segment.</p>
<div class="p">To permit ICMP packets from a host and destined for a network segment, configure a rule in an ACL. For example, to permit ICMP packets from the host at 192.168.1.3 and destined for the network segment 192.168.2.0/24, configure the following rule in ACL 3001.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>acl 3001</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3001] <strong>rule permit icmp source 192.168.1.3 0 destination 192.168.2.0 0.0.0.255</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3001] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
</div>
</li><li><p>Configure a filtering rule for TCP packets based on the TCP destination port number, source IPv4 address (host address), and destination IPv4 address segment.</p>
<div class="p">To prohibit Telnet connections between a specified host and the hosts on a network segment, configure a rule in an advanced ACL. For example, to prohibit Telnet connections between the host at 192.168.1.3 and hosts on the network segment 192.168.2.0/24, configure the following rule in the advanced ACL <strong>deny-telnet</strong>.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>acl name deny-telnet</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-deny-telnet] <strong>rule deny tcp destination-port eq telnet source 192.168.1.3 0 destination 192.168.2.0 0.0.0.255</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-deny-telnet] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
</div>
<div class="p">To prohibit the specified hosts from accessing web pages (HTTP is used to access web pages, and the TCP port number is 80), configure rules in an advanced ACL. For example, to prohibit hosts 192.168.1.3 and 192.168.1.4 from accessing web pages, configure the following rules in ACL <strong>no-web</strong> and configure the description "Web access restrictions" for the ACL.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>acl name no-web</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-no-web] <strong>description Web access restrictions</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-no-web] <strong>rule deny tcp destination-port eq 80 source 192.168.1.3 0</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-no-web] <strong>rule deny tcp destination-port eq 80 source 192.168.1.4 0</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-no-web] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
</div>
</li><li><p>Configure a packet filtering rule for TCP packets based on the source IPv4 address segment and TCP flags.</p>
<p>To implement unidirectional access control on a network segment, configure rules in an ACL. For example, to implement unidirectional access control on the network segment 192.168.2.0/24, configure the following rules in ACL 3002. In the rules, the hosts on 192.168.2.0/24 can only respond to TCP handshake packets, but cannot send the packets. Set the descriptions of the ACL rules to "Allow the ACK TCP packets through," "Allow the RST TCP packets through," and "Do not Allow the other TCP packet through."</p>
<div class="p">Configure two permit rules to permit the packets with the ACK or RST field being 1 from 192.168.2.0/24, and then configure a deny rule to reject other TCP packets from this network segment.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>acl 3002</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>rule permit tcp source 192.168.2.0 0.0.0.255 tcp-flag ack</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>acl 3002</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>display this</strong>   //If you do not specify an ID for a created rule, you can perform this step to obtain the rule ID allocated by the system and configure a description for the corresponding rule.
#                                                                               
acl number 3002                                                                 
 rule <strong>5</strong> permit tcp source 192.168.2.0 0.0.0.255 tcp-flag ack           //The rule ID allocated by the system is 5.
#                                                                               
return 
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>rule 5 description Allow the ACK TCP packets through</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>rule permit tcp source 192.168.2.0 0.0.0.255 tcp-flag rst</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>acl 3002</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>display this</strong>
#                                                                               
acl number 3002                                                                 
 rule 5 permit tcp source 192.168.2.0 0.0.0.255 tcp-flag ack                 
 rule 5 description Allow the ACK TCP packets through                 
 rule <strong>10</strong> permit tcp source 192.168.2.0 0.0.0.255 tcp-flag rst       //The rule ID allocated by the system is 10.
#                                                                               
return   
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>rule 10 description Allow the RST TCP packets through</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>rule deny tcp source 192.168.2.0 0.0.0.255</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>acl 3002</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>display this</strong>
#                                                                               
acl number 3002                                                                 
 rule 5 permit tcp source 192.168.2.0 0.0.0.255 tcp-flag ack                 
 rule 5 description Allow the ACK TCP packets through                 
 rule 10 permit tcp source 192.168.2.0 0.0.0.255 tcp-flag rst                
 rule 10 description Allow the RST TCP packets through                
 rule <strong>15</strong> deny tcp source 192.168.2.0 0.0.0.255       //The rule ID allocated by the system is 15.
#                                                                               
return   
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>rule 15 description Do not Allow the other TCP packet through</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
</div>
<div class="p">You can specify the <strong>established</strong> parameter to permit the packets with the ACK or RST field being 1 from 192.168.2.0/24, and configure a deny rule to reject other TCP packets from this network segment.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>acl 3002</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>rule permit tcp source 192.168.2.0 0.0.0.255 tcp-flag established</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>rule 5 description Allow the Established TCP packets through</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>rule deny tcp source 192.168.2.0 0.0.0.255</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>rule 10 description Do not Allow the other TCP packet through</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>acl 3002</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-acl4-advance-3002] <strong>display this</strong>
#                                                                                                                                   
acl number 3002                                                                                                                     
 rule 5 permit tcp source 192.168.2.0 0.0.0.255 tcp-flag established                                                                
 rule 5 description Allow the Established TCP packets through                                                                       
 rule 10 deny tcp source 192.168.2.0 0.0.0.255                                                                                      
 rule 10 description Do not Allow the other TCP packet through                                                                      
#                                                                                                                                   
return</pre>
</div>
</li></ul>
<h4 class="sectiontitle">Verifying the Configuration</h4><p>Run the <span><a href="cmdqueryname=display+acl+name+all"><b><span class="cmdname">display acl</span></b></a> { <i><span class="varname">advance-acl-number</span></i> | <strong><span>name</span></strong> <i><span class="varname">advance-acl-name</span></i> | <strong><span>all</span></strong> }</span> command to check the configuration of the advanced ACL.</p>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001176742481__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Follow-up Procedure</h4>
<div class="p"><p>Apply the advanced ACL to a service module so that the advanced ACL rules can be delivered and take effect.</p>
</div></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_acl_cfg_0010.html">Configuring an ACL
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_acl_cfg_0011.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_acl_cfg_0013.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>