
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring Association Between VRRP and BFD to Trigger Rapid Master/Backup VRRP Switchovers">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp_cfg_0013.html">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp_cfg_0010.html">
<meta name="DC.Relation" scheme="URI" content="vrp_vrrp_cfg_0126.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="High Availability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="High Availability">
<meta name="featurename" content="VRRP">
<meta name="featuretype" content="High Availability">
<meta name="featuretype" content="High Availability">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176743709">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring Association Between VRRP and BFD to Trigger Rapid Master/Backup VRRP Switchovers</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176743709"></a><a name="EN-US_TASK_0000001176743709"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring Association Between VRRP and BFD to Trigger Rapid Master/Backup VRRP Switchovers</h1>
<div class="taskbody"><div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001176743709__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before configuring association between VRRP and BFD, you have completed the following tasks:</p>
<ul><li>Configure a VRRP group.</li><li>Ensure that VRRP devices support BFD.</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176743709__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Procedure</h4><ol><li>Enter the system view.<pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</li><li>Enter the view of the interface where a VRRP group resides.<pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i></pre>
</li><li>Switch the interface working mode to Layer 3.<pre class="screen"><a href="cmdqueryname=undo+portswitch"><b><span class="cmdname">undo portswitch</span></b></a></pre>
<p> Determine whether to perform this step based on the current interface working mode.</p>
</li><li>Perform any of the following operations as required:<ul><li>Associate the VRRP group with a common BFD session.<pre class="screen"><a href="cmdqueryname=vrrp+vrid"><b><span class="cmdname">vrrp vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>track</span></strong> <strong><span>bfd</span></strong> { <i><span class="varname">bfd-session-id</span></i> | <strong><span>session-name</span></strong> <i><span class="varname">bfd-configure-name</span></i> } [ <strong><span>increase</span></strong> <i><span class="varname">value-increased</span></i> | <strong><span>reduce</span></strong> <i><span class="varname">value-reduced</span></i> ]</pre>
<p>By default, the device that tracks a BFD session reduces its VRRP priority by 10 if the BFD session goes down.</p>
</li><li><p>Associate the VRRP group with link and peer BFD sessions.</p>
<ol type="a"><li><div class="p">Associate the VRRP group with link and peer BFD sessions.<pre class="screen"><a href="cmdqueryname=vrrp+vrid"><b><span class="cmdname">vrrp vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>track</span></strong> <strong><span>bfd</span></strong> { <i><span class="varname">bfd-session-id</span></i> | <strong><span>session-name</span></strong> <i><span class="varname">bfd-configure-name</span></i> } [ <strong><span>peer</span></strong> | <strong><span>link</span></strong> ]</pre>
</div>
</li><li><p><span>Configure a threshold for the number of VRRP-tracked link BFD sessions that go down.</span></p>
<pre class="screen"><span><a href="cmdqueryname=vrrp+vrid"><b><span class="cmdname">vrrp vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>track link-bfd</span></strong> <i><span class="varname">down-number</span></i></span></pre>
<p>If the number of VRRP-tracked link BFD sessions that go down reaches or exceeds the threshold specified by <i><span class="varname">down-number</span></i>, the VRRP group performs a master/backup VRRP switchover.</p>
</li></ol>
</li><li><div class="p">Associate the VRRP group with a VRID-based dynamic BFD session.<ol type="a"><li>Create a VRID-based dynamic BFD session for the VRRP group, and configure the peer IP address bound to the dynamic BFD session.<pre class="screen"><a href="cmdqueryname=vrrp+vrid"><b><span class="cmdname">vrrp vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>bfd</span></strong> <strong><span>peer-ip</span></strong> <i><span class="varname">peer-ip-address</span></i></pre>
</li><li><p>Configure parameters for the VRID-based dynamic BFD session.</p>
<pre class="screen"><a href="cmdqueryname=vrrp+vrid"><b><span class="cmdname">vrrp vrid</span></b></a> <i><span class="varname">virtual-router-id</span></i> <strong><span>bfd</span></strong> { <strong><span>min-rx-interval</span></strong> <em>transmit-interval</em> | <strong><span>min-tx-interval</span></strong> <em>receive-interval</em> | <strong><span>detect-multiplier</span></strong> <em>multiplier-value</em> } <sup>*</sup></pre>
<p>The default minimum intervals for sending and receiving BFD Control packets are 10 ms, and the default local detection multiplier is 3.</p>
</li></ol>
</div>
</li></ul>
</li><li>Commit the configuration.<pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</li></ol>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li>If you specify <strong><span>session-name</span></strong> <i><span class="varname">bfd-configure-name</span></i> when associating a VRRP group with a common BFD session or link and peer BFD sessions, the VRRP group can be bound to a static BFD session with either manually specified or automatically negotiated discriminators. If <i><span class="varname">bfd-session-id</span></i> is specified, the VRRP group can be associated only with a static BFD session with manually specified discriminators.</li><li>If a VRRP group is bound to an mVRRP group, the VRRP group status is consistent with the mVRRP group status. As such, the VRRP group cannot track any BFD sessions for fast master/backup VRRP switchovers.</li><li><p>After a VRRP group is associated with a link BFD session and a peer BFD session, the backup device switches to the Master state if it detects the peer BFD session down event before detecting the link BFD session down event. In addition, the backup device switches to the Initialize state after it detects the peer BFD session down event. To resolve this problem, run the <a href="cmdqueryname=min-tx-interval"><b><span class="cmdname">min-tx-interval</span></b></a> command in the BFD session view to set the interval for sending link BFD Control packets to a value less than the interval for sending peer BFD Control packets.</p>
</li></ul>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176743709__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Verifying the Configuration</h4><ul><li>Run the <a href="cmdqueryname=display+vrrp"><b><span class="cmdname">display vrrp</span></b></a> [ <strong><span>interface</span></strong> { <i><span class="varname">interface-name</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> } ] [ <i><span class="varname">virtual-router-id</span></i> ] [ <strong><span>verbose</span></strong> ] command to check the VRRP group status.</li><li>Run the <strong class="display vrrp bfd session { all | interface { interface-name | interface-type interface-number } vrid virtual-router-id }"><a href="cmdqueryname=display+vrrp+bfd+session"><b><span class="cmdname">display vrrp bfd session</span></b></a> </strong>{<strong><span> </span></strong><strong><strong><span>all</span></strong></strong> | <strong><b><span class="cmdname">interface</span></b></strong> { <em><i><span class="varname">interface-name</span></i></em> | <em><i><span class="varname">interface-type</span></i></em><em> <i><span class="varname">interface-number</span></i></em> } <strong><strong><span>vrid</span></strong></strong><em> <i><span class="varname">virtual-router-id</span></i></em> } command to check the configuration and status of the VRID-based dynamic BFD session.</li></ul>
</div></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_vrrp_cfg_0013.html">Configuring Association Between VRRP and BFD
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_vrrp_cfg_0010.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_vrrp_cfg_0126.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>