
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Routed Proxy ND">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_nd_cfg_0047.html">
<meta name="DC.Relation" scheme="URI" content="vrp_nd_cfg_0052_a.html">
<meta name="DC.Relation" scheme="URI" content="vrp_nd_cfg_0055.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="featurename" content="ND">
<meta name="featuretype" content="IP Addresses and Services">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130782302">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Routed Proxy ND</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130782302"></a><a name="EN-US_TASK_0000001130782302"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1"><span>Example for Configuring Routed Proxy ND</span></h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001130782302__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>Hosts that belong to the same network segment but different physical networks are unable to communicate with each other if the gateways connected to them have different IPv6 addresses. In this case, you can enable routed proxy ND on a device's interface connected to the hosts to allow them to communicate.</p>
<p>As shown in <a href="#EN-US_TASK_0000001130782302__fig7672135224615">Figure 1</a>, DeviceA and DeviceB are connected to different networks, and DeviceA's interface 1 and DeviceB's interface 2 have different IPv6 addresses. Take HostA and HostB as an example. When HostA needs to communicate with HostB, it sends an NS message to request HostB's MAC address because the destination IPv6 address is on the same network segment as the local IPv6 address. However, as HostA and HostB are located on different physical networks, HostB cannot receive the NS message and therefore does not respond. To address this issue, enable routed proxy ND on interface 1 and interface 2.</p>
<div class="fignone" id="EN-US_TASK_0000001130782302__fig7672135224615"><a name="EN-US_TASK_0000001130782302__fig7672135224615"></a><a name="fig7672135224615"></a><span class="figcap"><b>Figure 1 </b>Network diagram of routed proxy ND</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1 and interface 2 represent <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001130622662.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130782302__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure IPv6 addresses for interfaces.</p>
</li><li><p>Configure an IGP to implement IP interworking.</p>
</li><li><p>Enable routed proxy ND on interfaces.</p>
</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130782302__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Data Preparation</h4><p>To complete the configuration, you need the following data:</p>
<ul><li><p>Interface IPv6 addresses</p>
</li><li><p>Host IPv6 addresses</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130782302__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure IPv6 addresses for interfaces.</span><p><p># Configure DeviceA.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">Device</span>A</strong>
<span>[<span><span class="keyword">*</span></span><span class="keyword">HUAWEI</span>] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface </strong><strong><span>100ge</span> <span>1/0/1</span></strong>
<span>[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong></span>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 enable</strong>
[<span><span class="keyword">*</span></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 address 2001:db8:300:400::2 64</strong>
[<span><span class="keyword">*</span></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
<span>[</span><span><span class="keyword">*</span></span><span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>undo portswitch</strong></span>
[<span><span class="keyword">*</span></span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>ipv6 enable</strong>
[<span><span class="keyword">*</span></span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>ipv6 address 2001:db8:300:600::1 64</strong>
[<span><span class="keyword">*</span></span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceA] <strong>commit</strong></pre>
<p># Configure DeviceB.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname <span class="keyword">DeviceB</span></strong>
<span>[<span><span class="keyword">*</span></span><span class="keyword">HUAWEI</span>] <a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></span>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
<span>[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong></span>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 enable</strong>
[<span><span class="keyword">*</span></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 address 2001:db8:300:600::2 64</strong>
[<span><span class="keyword">*</span></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
<span>[</span><span><span class="keyword">*</span></span><span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>undo portswitch</strong></span>
[<span><span class="keyword">*</span></span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>ipv6 enable</strong>
[<span><span class="keyword">*</span></span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>ipv6 address 2001:db8:300:500::2 64</strong>
[<span><span class="keyword">*</span></span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceB] <strong>commit</strong></pre>
</p></li><li><span>Configure an IGP (for example, OSPFv3) to implement IP interworking.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>ospfv3 1</strong>
[<span><span class="keyword">*</span></span>DeviceA-ospfv3-1] <strong>router-id 1.1.1.1</strong>
[<span><span class="keyword">*</span></span>DeviceA-ospfv3-1] <strong>area 0</strong>
[<span><span class="keyword">*</span></span>DeviceA-ospfv3-1-area-0.0.0.0] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceA-ospfv3-1] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceA] <strong>interface </strong><strong><span>100ge</span> <span>1/0/1</span></strong>
[<span><span class="keyword">*</span></span>DeviceA-<span><span>100GE</span><span>1/0/1</span></span>] <strong>ospfv3 1 area 0</strong>
[<span><span class="keyword">*</span></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span><span class="keyword">*</span></span>DeviceA-<span><span>100GE</span><span>1/0/2</span></span>] <strong>ospfv3 1 area 0</strong>
[<span><span class="keyword">*</span></span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceA] <strong>commit</strong></pre>
<p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>ospfv3 1</strong>
[<span><span class="keyword">*</span></span>DeviceB-ospfv3-1] <strong>router-id 2.2.2.2</strong>
[<span><span class="keyword">*</span></span>DeviceB-ospfv3-1] <strong>area 0</strong>
[<span><span class="keyword">*</span></span>DeviceB-ospfv3-1-area-0.0.0.0] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceB-ospfv3-1] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceB] <strong>interface </strong><strong><span>100ge</span> <span>1/0/1</span></strong>
[<span><span class="keyword">*</span></span>DeviceB-<span><span>100GE</span><span>1/0/1</span></span>] <strong>ospfv3 1 area 0</strong>
[<span><span class="keyword">*</span></span>DeviceB-<span><span>100GE</span><span>1/0/1</span></span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span><span class="keyword">*</span></span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>ospfv3 1 area 0</strong>
[<span><span class="keyword">*</span></span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceB] <strong>commit</strong></pre>
</p></li><li><span>Enable routed proxy ND on interfaces.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface </strong><strong><span>100ge</span> <span>1/0/1</span></strong>
<strong>0</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span><span>100GE</span><span>1/0/1</span></span>] <strong>ipv6 nd proxy route enable </strong>
[<span><span class="keyword">*</span></span>DeviceA-<span><span>100GE</span><span>1/0/1</span></span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceA] <strong>commit</strong></pre>
<p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>interface <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>ipv6 nd proxy route enable </strong>
[<span><span class="keyword">*</span></span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceB] <strong>commit</strong></pre>
</p></li><li><span>Configure IPv6 addresses for hosts.</span><p><p># Set the IPv6 address of HostA to 2001:db8:300:400::1/48.</p>
<p># Set the IPv6 address of HostB to 2001:db8:300:500::1/48.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001130782302__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># After the configuration is complete, check that HostA and HostB can ping each other.</p>
<h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
ospfv3 1
 router-id 1.1.1.1
 area 0.0.0.0
#
interface <span>100ge</span> <span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8:300:400::2/64
 ospfv3 1 area 0.0.0.0
 ipv6 nd proxy route enable
#
interface <span>100ge</span> <span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8:300:600::1/64
 ospfv3 1 area 0.0.0.0
#
return</pre>
</li><li><p>DeviceB</p>
<pre class="screen">#
sysname DeviceB
#
ospfv3 1
 router-id 2.2.2.2
 area 0.0.0.0
#
interface <span>100ge</span> <span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8:300:600::2/64
 ospfv3 1 area 0.0.0.0
#
interface <span>100ge</span> <span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:DB8:300:500::2/64
 ospfv3 1 area 0.0.0.0
 ipv6 nd proxy route enable
#
return</pre>
</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_nd_cfg_0047.html">Configuring Proxy ND
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_nd_cfg_0052_a.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_nd_cfg_0055.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>