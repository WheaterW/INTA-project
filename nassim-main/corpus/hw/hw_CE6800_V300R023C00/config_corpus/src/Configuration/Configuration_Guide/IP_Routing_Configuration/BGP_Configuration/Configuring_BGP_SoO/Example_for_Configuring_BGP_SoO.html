
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring BGP SoO">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_2111.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp_cfg_2113.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001481981392">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring BGP SoO</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001481981392"></a><a name="EN-US_TASK_0000001481981392"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring BGP SoO</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001481981392__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0000001481981392__fig168879525502">Figure 1</a>, DeviceA and DeviceB reside in different ASs, are connected to Server, and establish EBGP peer relationships with Leaf and Server to transmit public network unicast routes. To reduce redundant routes, configure the SoO function on DeviceA and DeviceB. When DeviceA advertises a route to Leaf, it adds the SoO attribute to the route. After receiving the route forwarded by Leaf, DeviceB checks the SoO attribute carried in the route. If the SoO attribute is the same as that configured on DeviceB, DeviceB does not accept this route, reducing memory usage and route selection costs.</p>
<div class="fignone" id="EN-US_TASK_0000001481981392__fig168879525502"><a name="EN-US_TASK_0000001481981392__fig168879525502"></a><a name="fig168879525502"></a><span class="figcap"><b>Figure 1 </b>BGP SoO application on an IPv4 public network</span><br><span><img class="vsd" src="figure/en-us_image_0000001485105592.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001481981392__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>During the configuration, note the following:</p>
<ul><li>During the establishment of a peer relationship, if the IP address of the specified peer is a loopback interface address or a sub-interface address, the <strong>peer connect-interface</strong> command must be run on both ends to ensure correct connection.</li><li>If there is no directly connected physical link between EBGP peers, run the <strong>peer ebgp-max-hop</strong> command to allow the EBGP peers to establish a TCP connection through multiple hops.</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001481981392__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><ol><li><p>Assign IP addresses to interfaces.</p>
</li><li>Configure basic OSPF functions.</li><li>Establish EBGP connections between Server and DeviceA, between Server and DeviceB, between Leaf and DeviceA, and between Leaf and DeviceB.</li><li>Configure an IPv4 static route on Server and import it to the BGP routing table.</li><li>Configure BGP SoO on DeviceA and DeviceB.</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001481981392__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign IP addresses to interfaces. The following uses DeviceA as an example. The configurations of other devices are similar to that on DeviceA. For details, see <a href="#EN-US_TASK_0000001481981392__postreq1873214154377">Configuration Scripts</a>.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface loopback0</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-LoopBack0] <strong>ip address 10.1.3.1 24</strong>
[<span class="keyword">*</span>DeviceA-LoopBack0] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface </strong><strong>loopback1</strong>
[<span class="keyword">*</span>DeviceA-LoopBack1] <strong>ip address 10.1.1.1 24</strong>
[<span class="keyword">*</span>DeviceA-LoopBack1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface meth0/0/0</strong>
[<span class="keyword">*</span>DeviceA-MEth0/0/0] <strong>ip address 10.10.1.2 24</strong>
[<span class="keyword">*</span>DeviceA-MEth0/0/0] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
</p></li><li><span>Configure OSPF for interworking within the IGP domain.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> ospf 1</strong>
[<span class="keyword">*</span>DeviceA-ospf-1]<strong> area 0</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.0]<strong> network 10.1.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.0]<strong> network 10.1.3.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.0]<strong> network 10.10.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.0]<strong> quit</strong>
[<span class="keyword">*</span>DeviceA-ospf-1]<strong> quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure Leaf.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Leaf]<strong> ospf 1</strong>
[<span class="keyword">*</span>Leaf-ospf-1]<strong> area 0</strong>
[<span class="keyword">*</span>Leaf-ospf-1-area-0.0.0.0]<strong> network 10.1.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>Leaf-ospf-1-area-0.0.0.0]<strong> network 10.1.2.0 0.0.0.255</strong>
[<span class="keyword">*</span>Leaf-ospf-1-area-0.0.0.0]<strong> network 10.10.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>Leaf-ospf-1-area-0.0.0.0]<strong> quit</strong>
[<span class="keyword">*</span>Leaf-ospf-1]<strong> quit</strong>
[<span class="keyword">*</span>Leaf] <strong>commit</strong></pre>
<p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong> ospf 1</strong>
[<span class="keyword">*</span>DeviceB-ospf-1]<strong> area 0</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0]<strong> network 10.1.2.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0]<strong> network 10.1.4.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0]<strong> network 10.10.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.0]<strong> quit</strong>
[<span class="keyword">*</span>DeviceB-ospf-1]<strong> quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
<p># Configure Server.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Server]<strong> ospf 1</strong>
[<span class="keyword">*</span>Server-ospf-1]<strong> area 0</strong>
[<span class="keyword">*</span>Server-ospf-1-area-0.0.0.0]<strong> network 10.1.3.0 0.0.0.255</strong>
[<span class="keyword">*</span>Server-ospf-1-area-0.0.0.0]<strong> network 10.1.4.0 0.0.0.255</strong>
[<span class="keyword">*</span>Server-ospf-1-area-0.0.0.0]<strong> network 10.10.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>Server-ospf-1-area-0.0.0.0]<strong> quit</strong>
[<span class="keyword">*</span>Server-ospf-1]<strong> quit</strong>
[<span class="keyword">*</span>Server] <strong>commit</strong></pre>
</p></li><li><span>Configure EBGP.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> bgp 100</strong>
[<span class="keyword">*</span>DeviceA-bgp] <strong>router-id 11.11.11.11</strong>
[<span class="keyword">*</span>DeviceA-bgp]<strong> peer </strong><strong>10.1.1.</strong><strong>2 as-number 200</strong>  
[<span class="keyword">*</span>DeviceA-bgp] <strong>peer 10.1.1.2 ebgp-max-hop 10</strong>
[<span class="keyword">*</span>DeviceA-bgp] <strong>peer 10.1.1.2 connect-interface LoopBack1</strong>
[<span class="keyword">*</span>DeviceA-bgp]<strong> peer </strong><strong>10.1.3.</strong><strong>2 as-number 400</strong>
[<span class="keyword">*</span>DeviceA-bgp] <strong>peer 10.1.3.2 ebgp-max-hop 10</strong>
[<span class="keyword">*</span>DeviceA-bgp] <strong>peer 10.1.3.2 connect-interface LoopBack0</strong>
[<span class="keyword">*</span>DeviceA-bgp]<strong> quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure Leaf.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Leaf]<strong> bgp 200</strong>
[<span class="keyword">*</span>Leaf-bgp] <strong>router-id 22.22</strong>.<strong>22.22</strong>
[<span class="keyword">*</span>Leaf-bgp]<strong> peer </strong><strong>10.1.1.</strong><strong>1 as-number 100</strong>
[<span class="keyword">*</span>Leaf-bgp]<strong> </strong><strong>peer 10.1.1.1 ebgp-max-hop 10</strong>
[<span class="keyword">*</span>Leaf-bgp]<strong> </strong><strong>peer 10.1.1.1 connect-interface LoopBack0</strong>
[<span class="keyword">*</span>Leaf-bgp]<strong> peer </strong><strong>10.1.2.1</strong><strong> as-number 300</strong>
[<span class="keyword">*</span>Leaf-bgp]<strong> </strong><strong>peer 10.1.2.1 ebgp-max-hop 10</strong>
[<span class="keyword">*</span>Leaf-bgp]<strong> </strong><strong>peer 10.1.2.1 connect-interface LoopBack1</strong>
[<span class="keyword">*</span>Leaf-bgp]<strong> quit</strong>
[<span class="keyword">*</span>Leaf] <strong>commit</strong></pre>
<p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong> bgp 300</strong>
[<span class="keyword">*</span>DeviceB-bgp] <strong>router-id 33.33.33.33</strong>
[<span class="keyword">*</span>DeviceB-bgp]<strong> peer </strong><strong>10.1.2.2</strong><strong> as-number 200</strong>
[<span class="keyword">*</span>DeviceB-bgp] <strong>peer 10.1.2.2 ebgp-max-hop 10</strong>
[<span class="keyword">*</span>DeviceB-bgp] <strong>peer 10.1.2.2 connect-interface LoopBack0</strong>
[<span class="keyword">*</span>DeviceB-bgp]<strong> </strong><strong>peer </strong><strong>10.1.4.2</strong><strong> as-number 400</strong>
[<span class="keyword">*</span>DeviceB-bgp] <strong>peer 10.1.4.2 ebgp-max-hop 10</strong>
[<span class="keyword">*</span>DeviceB-bgp] <strong>peer 10.1.4.2 connect-interface LoopBack1</strong>
[<span class="keyword">*</span>DeviceB-bgp]<strong> quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
<p># Configure Server.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Server]<strong> bgp 400</strong>
[<span class="keyword">*</span>Server-bgp] <strong>router-id 44.44.44.44</strong>
[<span class="keyword">*</span>Server-bgp]<strong> peer </strong><strong>10.1.3.</strong><strong>1 as-number 100</strong>
[<span class="keyword">*</span>Server-bgp] <strong>peer 10.1.3.1 ebgp-max-hop 10</strong>
[<span class="keyword">*</span>Server-bgp] <strong>peer 10.1.3.1 connect-interface LoopBack0</strong>
[<span class="keyword">*</span>Server-bgp]<strong> peer </strong><strong>10.1.4.1</strong><strong> as-number 300</strong>
[<span class="keyword">*</span>Server-bgp] <strong>peer 10.1.4.1 ebgp-max-hop 10</strong>
[<span class="keyword">*</span>Server-bgp] <strong>peer 10.1.4.1 connect-interface LoopBack1</strong>
[<span class="keyword">*</span>Server-bgp]<strong> quit</strong>
[<span class="keyword">*</span>Server] <strong>commit</strong></pre>
<p># Check the connection status of BGP peers. The following uses DeviceA as an example.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display bgp peer</strong>
Status codes: * - Dynamic
 BGP local router ID        : 11.11.11.11
 Local AS number            : 100
 Total number of peers      : 2
 Peers in established state : 2
 Total number of dynamic peers : 0

  Peer                             V          AS  MsgRcvd  MsgSent  OutQ  Up/Down       State  PrefRcv
  10.1.1.2                         4         200       32       38     0 00:22:34 <strong>Established</strong>       0
  10.1.3.2                         4         400       34       35     0 00:26:22 <strong>Established</strong>       0</pre>
</p></li><li><span>Configure an IPv4 static route on Server and run the <strong>network</strong> command to import it.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Server]<strong> </strong><strong>ip route-static 1.1.1.1 255.255.255.255 NULL0</strong>
[<span class="keyword">*</span>Server] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Server] <strong>bgp 4</strong><strong>00</strong>
[<span class="keyword">*</span>Server-bgp] <strong>ipv4-family unicast</strong>
[<span class="keyword">*</span>Server-bgp-af-ipv4] <strong>network</strong> <strong>1.1.1.1</strong> <strong>32</strong>
[<span class="keyword">*</span>Server-bgp-af-ipv4] <strong>quit</strong>
[<span class="keyword">*</span>Server-bgp] <strong>quit</strong>
[<span class="keyword">*</span>Server] <strong>commit</strong></pre>
</p></li><li><span>Configure the BGP SoO function.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>bgp 1</strong><strong>00</strong>
[<span class="keyword">*</span>DeviceA-bgp] <strong>ipv4-family unicast</strong>
[<span class="keyword">*</span>DeviceA-bgp-af-ipv4] <strong>peer </strong><strong>10.1.1.2 soo-reverse 10:10</strong>
[<span class="keyword">*</span>DeviceA-bgp-af-ipv4] <strong>peer 10.1.1.2 advertise-ext-community</strong>  
[<span class="keyword">*</span>DeviceA-bgp-af-ipv4] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA-bgp] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure Leaf.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Leaf]<strong> bgp 200</strong>
[<span class="keyword">*</span>Leaf-bgp] <strong>peer 10.1.2.1 advertise-ext-community</strong> 
[<span class="keyword">*</span>Leaf-bgp]<strong> quit</strong>
[<span class="keyword">*</span>Leaf] <strong>commit</strong></pre>
<p># Check the BGP routing table of DeviceA. The command output shows that the SoO attribute 10:10 has been added to the route sent by DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display bgp routing-table peer 10.1.1.2 advertised-routes 1.1.1.1</strong>

 BGP local router ID : 11.11.11.11
 Local AS number : 100
 BGP routing table entry information of 1.1.1.1/32:
 From: 10.1.3.2 (10.1.3.2)
 Route Duration: 0d00h07m50s
 Relay IP Nexthop: 10.10.1.1
 Relay IP Out-Interface: MEth0/0/0
 Original nexthop: 10.1.3.2
 Advertised nexthop: 10.1.1.1
 Qos information : 0x0
<strong> Ext-Community: SoO &lt;10 : 10&gt;</strong>
 AS-path 100 400, origin igp, pref-val 0, valid, external, best, select, pre 255, IGP cost 1
 Advertised to such 1 peers:
    10.1.1.2</pre>
<p># Check the routing table of DeviceB. The command output shows that DeviceB receives the route 1.1.1.1/32 that carries the SoO attribute.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display bgp routing-table peer 10.1.2.2 received-routes 1.1.1.1</strong>

 BGP local router ID : 33.33.33.33
 Local AS number : 300
 BGP routing table entry information of 1.1.1.1/32:
 <strong>From: 10.1.2.2 (10.10.1.3)</strong>  
 Route Duration: 0d00h00m57s
 Relay IP Nexthop: 10.10.1.3
 Relay IP Out-Interface: MEth0/0/0
 Original nexthop: 10.1.2.2
 Qos information : 0x0
 <strong>Ext-Community: SoO &lt;10 : 10&gt;</strong>
 AS-path 200 100 400, origin igp, pref-val 0, valid, external, pre 255, IGP cost 1, not preferred for AS-Path
 Not advertised to any peer yet</pre>
</p><p><p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>bgp 3</strong><strong>00</strong>
[<span class="keyword">*</span>DeviceB-bgp] <strong>ipv4-family unicast</strong>
[<span class="keyword">*</span>DeviceB-bgp-af-ipv4] <strong>peer </strong><strong>10.1.2.2 soo-reverse 10:10</strong>
[<span class="keyword">*</span>DeviceB-bgp-af-ipv4] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB-bgp] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001481981392__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><div class="p"># Check the BGP routing table of DeviceB. The <strong>display bgp routing-table peer 10.1.2.2 received-routes 1.1.1.1</strong> command output has no route information displayed. According to the <strong>display bgp routing-table 1.1.1.1</strong> command output, DeviceB discards the route received from 10.1.2.2 and accepts the route received from 10.1.4.2 after the BGP SoO attribute is configured.<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display </strong><strong>bgp routing-table 1.1.1.1 32</strong>

 BGP local router ID : 33.33.33.33
 Local AS number : 300
 Paths:   1 available, 1 best, 1 select, 0 best-external, 0 add-path
 BGP routing table entry information of 1.1.1.1/32:
 <strong>From: 10.1.4.2 (10.1.3.2)</strong>
 Route Duration: 0d00h07m01s
 Relay IP Nexthop: 10.10.1.1
 Relay IP Out-Interface: MEth0/0/0
 Original nexthop: 10.1.4.2
 Qos information : 0x0
 AS-path 400, origin igp, MED 0, pref-val 0, valid, external, best, select, pre 255, IGP cost 1
 Advertised to such 1 peers:
    10.1.2.2</pre>
</div>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001481981392__postreq1873214154377"></a><a name="postreq1873214154377"></a><a name="EN-US_TASK_0000001481981392__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
interface MEth0/0/0
 ip address 10.10.1.2 255.255.255.0 
#
interface LoopBack0
 ip address 10.1.3.1 255.255.255.0
#
interface LoopBack1
 ip address 10.1.1.1 255.255.255.0
#
bgp 100
 private-4-byte-as enable
 peer 10.1.1.2 as-number 200
 peer 10.1.1.2 ebgp-max-hop 10                 
 peer 10.1.1.2 connect-interface LoopBack1     
 peer 10.1.3.2 as-number 400
 peer 10.1.3.2 ebgp-max-hop 10
 peer 10.1.3.2 connect-interface LoopBack0
 #
 ipv4-family unicast
  peer 10.1.1.2 enable
  peer 10.1.1.2 soo-reverse 10:10
  peer 10.1.1.2 advertise-ext-community   
  peer 10.1.3.2 enable
# 
ospf 1                             
 area 0.0.0.0
  network 10.1.1.0 0.0.0.255
  network 10.1.3.0 0.0.0.255
  network 10.10.1.0 0.0.0.255
#
return</pre>
</li><li><p>Leaf</p>
<pre class="screen">#
sysname Leaf
#
interface MEth0/0/0
 ip address 10.10.1.3 255.255.255.0
#
interface LoopBack0
 ip address 10.1.1.2 255.255.255.0
#
interface LoopBack1
 ip address 10.1.2.2 255.255.255.0
#
bgp 200
 private-4-byte-as enable
 peer 10.1.1.1 as-number 100
 peer 10.1.1.1 ebgp-max-hop 10
 peer 10.1.1.1 connect-interface LoopBack0
 peer 10.1.2.1 as-number 300
 peer 10.1.2.1 ebgp-max-hop 10
 peer 10.1.2.1 connect-interface LoopBack1
 #
 ipv4-family unicast
  peer 10.1.1.1 enable
  peer 10.1.2.1 enable
  peer 10.1.2.1 advertise-ext-community  
#
ospf 1
 area 0.0.0.0
  network 10.1.1.0 0.0.0.255
  network 10.1.2.0 0.0.0.255
  network 10.10.1.0 0.0.0.255
#
return</pre>
</li><li><div class="p">DeviceB<pre class="screen">#
sysname DeviceB
#
interface MEth0/0/0
 ip address 10.10.1.4 255.255.255.0
#
interface LoopBack0
 ip address 10.1.2.1 255.255.255.0
#
interface LoopBack1
 ip address 10.1.4.1 255.255.255.0
#
bgp 300
 private-4-byte-as enable
 peer 10.1.2.2 as-number 200
 peer 10.1.2.2 ebgp-max-hop 10
 peer 10.1.2.2 connect-interface LoopBack0
 peer 10.1.4.2 as-number 400
 peer 10.1.4.2 ebgp-max-hop 10
 peer 10.1.4.2 connect-interface LoopBack1
 #
 ipv4-family unicast
  peer 10.1.2.2 enable
  peer 10.1.2.2 soo-reverse 10:10
  peer 10.1.4.2 enable
#
ospf 1
 area 0.0.0.0
  network 10.1.2.0 0.0.0.255
  network 10.1.4.0 0.0.0.255
  network 10.10.1.0 0.0.0.255
#
return</pre>
</div>
</li><li><p>Server</p>
<pre class="screen">#
sysname Server
#
interface MEth0/0/0
 ip address 10.10.1.1 255.255.255.0
#
interface LoopBack0
 ip address 10.1.3.2 255.255.255.0
#
interface LoopBack1
 ip address 10.1.4.2 255.255.255.0
#
bgp 400
 private-4-byte-as enable
 peer 10.1.3.1 as-number 100
 peer 10.1.3.1 ebgp-max-hop 10
 peer 10.1.3.1 connect-interface LoopBack0
 peer 10.1.4.1 as-number 300
 peer 10.1.4.1 ebgp-max-hop 10
 peer 10.1.4.1 connect-interface LoopBack1
 #
 ipv4-family unicast
  network 1.1.1.1 255.255.255.255  
  peer 10.1.3.1 enable
  peer 10.1.4.1 enable
#
ospf 1
 area 0.0.0.0
  network 10.1.3.0 0.0.0.255
  network 10.1.4.0 0.0.0.255
  network 10.10.1.0 0.0.0.255
#
ip route-static 1.1.1.1 255.255.255.255 NULL0
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_bgp_cfg_2111.html">Configuring BGP SoO
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_bgp_cfg_2113.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>