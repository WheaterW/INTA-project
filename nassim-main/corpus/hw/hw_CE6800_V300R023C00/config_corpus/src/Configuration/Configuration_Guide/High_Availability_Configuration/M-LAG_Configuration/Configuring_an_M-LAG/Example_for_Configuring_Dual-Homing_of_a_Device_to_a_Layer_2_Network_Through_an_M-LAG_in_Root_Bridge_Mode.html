
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Dual-Homing of a Device to a Layer 2 Network Through an M-LAG in Root Bridge Mode">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_cfg_m-lag_0020.html">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_cfg_m-lag_0049.html">
<meta name="DC.Relation" scheme="URI" content="../dc/dc_cfg_m-lag_0081.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="M-LAG">
<meta name="featuretype" content="High Availability">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="M-LAG">
<meta name="featuretype" content="High Availability">
<meta name="featurename" content="M-LAG">
<meta name="featuretype" content="High Availability">
<meta name="featuretype" content="High Availability">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001564128877">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Dual-Homing of a Device to a Layer 2 Network Through an M-LAG in Root Bridge Mode</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001564128877"></a><a name="EN-US_TASK_0000001564128877"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Dual-Homing of a Device to a Layer 2 Network Through an M-LAG in Root Bridge Mode</h1>
<div class="taskbody" id="taskbody1587993025646"><div class="context"><a name="EN-US_TASK_0000001564128877__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_context561889775175337"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p1024284687175337">In <a href="#EN-US_TASK_0000001564128877__en-us_task_0241512096_fig_dc_cfg_eth-trunk_008701">Figure 1</a>, a server is dual-homed to a Layer 2 network through an M-LAG. As link aggregation between hosts and access devices only achieves link-level reliability, a fault on an access device may cause service interruption. As such, this cannot fulfill service reliability requirements. To address this problem, an M-LAG can be configured. When both M-LAG master and backup devices work properly, traffic is load balanced to them. In addition, services will not be affected if any of the two devices fails. As such, high service reliability is ensured. On an Ethernet network, a blocked interface cannot transmit DAD packets between M-LAG master and backup devices; therefore, a DFS group is configured and bound to the IP address of the Ethernet management interface on each of the two devices to ensure normal forwarding of DAD packets.</p>
<div class="fignone" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_fig_dc_cfg_eth-trunk_008701"><a name="EN-US_TASK_0000001564128877__en-us_task_0241512096_fig_dc_cfg_eth-trunk_008701"></a><a name="en-us_task_0241512096_fig_dc_cfg_eth-trunk_008701"></a><span class="figcap"><b>Figure 1 </b>Configuring dual-homing of a device to a Layer 2 network using an M-LAG</span><div class="note" id="EN-US_TASK_0000001564128877__note1440481974518"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001564128877__p113691482557">In this example, interface 1, interface 2, interface 3, interface 4, interface 5, interface 6, and interface 7 on DeviceA represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, <span>100GE</span> <span>1/0/3</span>, <span>100GE</span> <span>1/0/4</span>, <span>100GE</span> <span>1/0/5</span>, <span>100GE</span> <span>1/0/6</span>, and MEth0/0/0, respectively.</p>
<p id="EN-US_TASK_0000001564128877__p1412184955111">In this example, interface 1, interface 2, interface 3, interface 4, interface 5, interface 6, and interface 7 on DeviceB represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, <span>100GE</span> <span>1/0/3</span>, <span>100GE</span> <span>1/0/4</span>, <span>100GE</span> <span>1/0/5</span>, <span>100GE</span> <span>1/0/6</span>, and MEth0/0/0, respectively.</p>
<p id="EN-US_TASK_0000001564128877__p21159305216">In this example, interface 1 and interface 2 on DeviceC represent <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span>, respectively.</p>
<p id="EN-US_TASK_0000001564128877__p175273537386">In this example, interface 1 and interface 2 on DeviceD represent <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span>, respectively.</p>
</div></div>
<p id="EN-US_TASK_0000001564128877__p1185119287553"><span><img class="vsd" id="EN-US_TASK_0000001564128877__image118519282553" src="figure/en-us_image_0000001512689762.png"></span></p>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001564128877__1.3.2"></a><a name="1.3.2"></a>
<div class="p" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_context185328663175337"><h4 class="sectiontitle">Configuration Roadmap</h4><ol id="EN-US_TASK_0000001564128877__en-us_task_0241512096_ol253595771175337"><li id="EN-US_TASK_0000001564128877__en-us_task_0241512096_li1717559357175337"><p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p544930125175337"><a name="EN-US_TASK_0000001564128877__en-us_task_0241512096_li1717559357175337"></a><a name="en-us_task_0241512096_li1717559357175337"></a>Configure DeviceA and DeviceB as root bridges with the same bridge MAC address to ensure that both devices function as the root bridge on the Layer 2 network.</p>
</li><li id="EN-US_TASK_0000001564128877__en-us_task_0241512096_li1448273131175337"><p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p1546857619175337"><a name="EN-US_TASK_0000001564128877__en-us_task_0241512096_li1448273131175337"></a><a name="en-us_task_0241512096_li1448273131175337"></a>Configure IP addresses for the Ethernet management interface on DeviceA and DeviceB to ensure their Layer 3 connectivity so that DAD packets can be forwarded between them.</p>
</li><li id="EN-US_TASK_0000001564128877__en-us_task_0241512096_li1276328884175337"><p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p45403505175337"><a name="EN-US_TASK_0000001564128877__en-us_task_0241512096_li1276328884175337"></a><a name="en-us_task_0241512096_li1276328884175337"></a>Configure M-LAG on DeviceA and DeviceB so that the server can be dual-homed to the M-LAG set up by DeviceA and DeviceB.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001564128877__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001564128877__en-us_task_0241512096_steps1216880851175337"><li id="EN-US_TASK_0000001564128877__en-us_task_0241512096_step1233329594175337"><span id="EN-US_TASK_0000001564128877__en-us_task_0241512096_cmd1058325514175337">Configure DeviceA and DeviceB as root bridges with the same bridge MAC address.</span><p><div class="note" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_note1318667220175337"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p808729500175337">If the downstream device dual-homed to the M-LAG member devices is a switching device, root protection must be configured.</p>
</div></div>
<p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p1366076117175337"># Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen1858400523175337">&lt;<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword600271809175337">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1383066326175337">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1877611226175337"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1887166364175337">HUAWEI</span>] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b813340853175337">sysname DeviceA</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword612995250175337">*</span><span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1132112091175337">HUAWEI</span>] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b816634219175337">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword350006173175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1788584138175337">stp root primary</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1860613703175337">*</span>DeviceA] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b174989930175337">stp bridge-address </strong><strong id="EN-US_TASK_0000001564128877__b3413134913517">00e0-fc12-3458</strong>  <span>//Configure the bridge MAC address of the root bridge (MAC address of the M-LAG master device).</span>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword941749556175337">*</span>DeviceA] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1247792953175337">interface eth-trunk 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword610437157175337">*</span>DeviceA-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b928105302175337">trunkport <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1607667711175337">*</span>DeviceA-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1662425101175337">trunkport <span>100ge</span> <span>1/0/5</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword142197035175337">*</span>DeviceA-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b997326614175337">stp edged-port enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1084804663175337">*</span>DeviceA-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b2015226252175337">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword941347789175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b82720979175337">quit</strong></pre>
<p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p1311462473175337"># Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen1999708593175337">&lt;<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword545682142175337">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1550452856175337">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1731063925175337"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword2030421566175337">HUAWEI</span>] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1696133767175337">sysname DeviceB</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1073549444175337">*</span><span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword2135386861175337">HUAWEI</span>] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1129401981175337">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1591744504175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b741313999175337">stp root primary</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword133323386175337">*</span>DeviceB] <strong id="EN-US_TASK_0000001564128877__b29241552135115">stp bridge-address </strong><strong id="EN-US_TASK_0000001564128877__b597112446404">00e0-fc12-3458   </strong><span>//Configure the bridge MAC address of the root bridge.</span>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword89456176175337">*</span>DeviceB] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1131263875175337">interface eth-trunk 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1625595287175337">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1004883887175337">trunkport <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword440733140175337">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b852534746175337">trunkport <span>100ge</span> <span>1/0/5</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword931558681175337">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b911188873175337">stp edged-port enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword2069517562175337">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1350590924175337">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword607110022175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b973731355175337">quit</strong></pre>
</p></li><li id="EN-US_TASK_0000001564128877__en-us_task_0241512096_step920731532175337"><span id="EN-US_TASK_0000001564128877__en-us_task_0241512096_cmd2115181689175337">Configure an IP address for the Ethernet management interface on DeviceA and DeviceB, respectively.</span><p><p id="EN-US_TASK_0000001564128877__p107511940121812">Ensure that DeviceA and DeviceB can communicate at Layer 3 through their Ethernet management interfaces.</p>
</p><p><p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p1507349442175337"># Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen1201551141175337">[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword919203896175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b713868695175337"> interface meth 0/0/0</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword623678440175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-MEth0/0/0]<strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1095604106175337"> ip address 10.1.1.1 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1100223167175337">*</span>DeviceA-MEth0/0/0]<strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1827614696175337"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword471281831175337">*</span>DeviceA]<strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1378258176175337"> commit</strong></pre>
<p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p2064321767175337"># Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen530369590175337">[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1647115536175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b905563166175337"> interface meth 0/0/0</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1746729609175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-MEth0/0/0]<strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b541246638175337"> ip address 10.1.1.2 24</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword629145094175337">*</span>DeviceB-MEth0/0/0]<strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b184435368175337"> quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1421203649175337">*</span>DeviceB]<strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1053247953175337"> commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001564128877__en-us_task_0241512096_step1270350210175337"><span id="EN-US_TASK_0000001564128877__en-us_task_0241512096_cmd493560996175337">Create a DFS group on DeviceA and DeviceB and bind the IP address of the Ethernet management interface on each of the two devices to the DFS group.</span><p><p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p187779954175337"># Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen1732558673175337">[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1448862632175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b2011260673175337">dfs-group 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1804668733175337">*</span>DeviceA-dfs-group-1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1009210466175337">dual-active detection source ip 10.1.1.1</strong><strong id="EN-US_TASK_0000001564128877__b1576055016269"> peer </strong><strong id="EN-US_TASK_0000001564128877__b191102466269">10.1.1.2</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword696922065175337">*</span>DeviceA-dfs-group-1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b2014915043175337">priority 150</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword4916163804018">*</span>DeviceA-dfs-group-1] <strong id="EN-US_TASK_0000001564128877__b209301344103010">authentication-mode hmac-sha256 </strong><strong id="EN-US_TASK_0000001564128877__b172269541304">pass</strong><strong id="EN-US_TASK_0000001564128877__b3930744133011">word</strong><strong id="EN-US_TASK_0000001564128877__b8529175593012"> YsHsjx_202206</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword561855229175337">*</span>DeviceA-dfs-group-1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b170364503175337">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword386357444175337">*</span>DeviceA] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1323724415175337">commit</strong></pre>
<p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p200804484175337"># Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen1448670597175337">[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword166258531175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b918418706175337">dfs-group 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword552065424175337">*</span>DeviceB-dfs-group-1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1682079368175337">dual-active detection source ip 10.1.1.2</strong> <strong id="EN-US_TASK_0000001564128877__b983116585265">peer </strong><strong id="EN-US_TASK_0000001564128877__b1183112582262">10.1.1.1</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1750752930175337">*</span>DeviceB-dfs-group-1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b2141830521175337">priority 120</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword75872444532">*</span>DeviceB-dfs-group-1] <strong id="EN-US_TASK_0000001564128877__b64376505538">authentication-mode hmac-sha256 password</strong> <strong id="EN-US_TASK_0000001564128877__b819514613313">YsHsjx_202206</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1948542653175337">*</span>DeviceB-dfs-group-1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1456503067175337">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword469416448175337">*</span>DeviceB] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b618349905175337">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001564128877__en-us_task_0241512096_step1376380860175337"><span id="EN-US_TASK_0000001564128877__en-us_task_0241512096_cmd139268536175337">Configure a peer-link between DeviceA and DeviceB.</span><p><p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p878719484175337"># Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen695063917175337">[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword559001343175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b488078807175337">interface eth-trunk 0</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword277165101175337">*</span>DeviceA-Eth-Trunk0] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b721591601175337">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword472022143175337">*</span>DeviceA-Eth-Trunk0] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1384734651175337">trunkport <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword265175339175337">*</span>DeviceA-Eth-Trunk0] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1207260092175337">trunkport <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1501531759175337">*</span>DeviceA-Eth-Trunk0] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b870971589175337">undo stp enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword358275135175337">*</span>DeviceA-Eth-Trunk0] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1727853069175337">peer-link 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1948673859175337">*</span>DeviceA-Eth-Trunk0] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b483759788175337">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1023793434175337">*</span>DeviceA] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1769218685175337">commit</strong></pre>
<p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p1101440067175337"># Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen398231153175337">[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword75855182175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1845713484175337">interface eth-trunk 0</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1389467011175337">*</span>DeviceB-Eth-Trunk0] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b697580940175337">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1626798975175337">*</span>DeviceB-Eth-Trunk0] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1986572689175337">trunkport <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1579900585175337">*</span>DeviceB-Eth-Trunk0] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b938438349175337">trunkport <span>100ge</span> <span>1/0/4</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword2082331119175337">*</span>DeviceB-Eth-Trunk0] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1234683468175337">undo stp enable</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1988170730175337">*</span>DeviceB-Eth-Trunk0] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b590953510175337">peer-link 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword699727031175337">*</span>DeviceB-Eth-Trunk0] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b2065288104175337">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword533626691175337">*</span>DeviceB] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1349257181175337">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001564128877__en-us_task_0241512096_step1889573390175337"><span id="EN-US_TASK_0000001564128877__en-us_task_0241512096_cmd1071793894175337">Add the Eth-Trunk interfaces connecting DeviceA to the server and DeviceB to the server to VLAN 11 and bind the interfaces to the DFS group.</span><p><p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p1885162982175337">The uplink interfaces that connect the server to DeviceA and DeviceB must be added to an Eth-Trunk interface, and the working mode of the Eth-Trunk interface must be the same as that of the Eth-Trunk interfaces on both devices. In this example, the Eth-Trunk interfaces on both devices are configured to work in static LACP mode.</p>
<p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p2022189822175337"># Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen840746406175337">[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1362699560175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b55975998175337">vlan batch 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword8543840175337">*</span>DeviceA] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1752022621175337">interface eth-trunk 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword72352134175337">*</span>DeviceA-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1446970133175337">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1185529258175337">*</span>DeviceA-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b808160530175337">port link-type access</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1408660831175337">*</span>DeviceA-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b2047957456175337">port default vlan 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword821628497175337">*</span>DeviceA-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b366734588175337">dfs-group 1 m-lag 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1129152842175337">*</span>DeviceA-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b670551909175337">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword533519980175337">*</span>DeviceA] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b213430434175337">commit</strong></pre>
<p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p452681017175337"># Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen1525956860175337">[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword357107610175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b318885075175337">vlan batch 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1800798902175337">*</span>DeviceB] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b987246310175337">interface eth-trunk 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword329440428175337">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b481160917175337">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1540696338175337">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1075451326175337">port link-type access</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1475977783175337">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1984863723175337">port default vlan 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1998551755175337">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b735176176175337">dfs-group 1 m-lag 1</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword722826791175337">*</span>DeviceB-Eth-Trunk1] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b641588020175337">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1221002126175337">*</span>DeviceB] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b2087662428175337">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001564128877__en-us_task_0241512096_step890650872175337"><span id="EN-US_TASK_0000001564128877__en-us_task_0241512096_cmd1208186114175337">Configure the link between DeviceA and DeviceC and the link between DeviceB and DeviceD, and configure the interface type and allowed VLAN.</span><p><p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p1233041172175337"># Configure DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen975682152175337">[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword439900264175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong id="EN-US_TASK_0000001564128877__b610501914414">interface eth-trunk 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword833575664175337">*</span>DeviceA-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b198709083175337">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1467363979175337">*</span>DeviceA-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b426523407175337">port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword794479379175337">*</span>DeviceA-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b513283551175337">port trunk allow-pass vlan 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword487843012425">*</span>DeviceA-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b18175182114319">trunkport <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword797693184219">*</span>DeviceA-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b1873315120438">trunkport <span>100ge</span> <span>1/0/6</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1311036671175337">*</span>DeviceA-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1885318718175337">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword761748935175337">*</span>DeviceA] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b65095625175337">commit</strong></pre>
<p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p1506700425175337"># Configure DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__screen194661704420">[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword20466177184419"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong id="EN-US_TASK_0000001564128877__b446611716448">interface eth-trunk 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword74661778449">*</span>DeviceB-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b346647104413">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword0466127154419">*</span>DeviceB-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b124661713442">port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword1146620714418">*</span>DeviceB-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b20466473447">port trunk allow-pass vlan 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword124669720444">*</span>DeviceB-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b246637144414">trunkport <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword64661371448">*</span>DeviceB-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b13466207124417">trunkport <span>100ge</span> <span>1/0/6</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword24668714445">*</span>DeviceB-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b646617712448">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword84661871448">*</span>DeviceB] <strong id="EN-US_TASK_0000001564128877__b11466197174420">commit</strong></pre>
<p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p1603103068175337"># Configure DeviceC.</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen1568186675175337">&lt;<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1342362593175337">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1259123896175337">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword258869509175337"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword17968941175337">HUAWEI</span>] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1620093991175337">sysname DeviceC</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword119812969175337">*</span><span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1504392744175337">HUAWEI</span>] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b95323638175337">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword437641518175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b595578123175337">vlan batch 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword12984183451"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong id="EN-US_TASK_0000001564128877__b52981718204514">interface eth-trunk 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword9299318104510">*</span>DeviceC-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b22991418184510">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword132996188452">*</span>DeviceC-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b1729931815456">port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword1129981816457">*</span>DeviceC-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b1429917183456">port trunk allow-pass vlan 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword1529901820457">*</span>DeviceC-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b1529931816452">trunkport <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword329951817456">*</span>DeviceC-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b13299118124517">trunkport <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword23006188457">*</span>DeviceC-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b53000187457">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword17300151894511">*</span>DeviceC] <strong id="EN-US_TASK_0000001564128877__b1830081819459">commit</strong></pre>
<p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p129581264175337"># Configure DeviceD.</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen1828272432175337">&lt;<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1778991151175337">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1789858916175337">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1949556334175337"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword2035303259175337">HUAWEI</span>] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1910053155175337">sysname DeviceD</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1274348452175337">*</span><span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword1120021233175337">HUAWEI</span>] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1422067612175337">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_keyword318646844175337"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b125757809175337">vlan batch 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword95281859164614"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong id="EN-US_TASK_0000001564128877__b125291659174610">interface eth-trunk 2</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword105295595462">*</span>DeviceD-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b1529359174617">mode lacp-static</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword1352918598463">*</span>DeviceD-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b25291259134610">port link-type trunk</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword7529159204610">*</span>DeviceD-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b4529135924619">port trunk allow-pass vlan 11</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword13529155916466">*</span>DeviceD-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b11529145984619">trunkport <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword105291559114612">*</span>DeviceD-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b2052975913469">trunkport <span>100ge</span> <span>1/0/2</span></strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword052925984615">*</span>DeviceD-Eth-Trunk2] <strong id="EN-US_TASK_0000001564128877__b1552914596466">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword4529135994618">*</span>DeviceD] <strong id="EN-US_TASK_0000001564128877__b155291159114617">commit</strong></pre>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_example1338223111175337"><a name="EN-US_TASK_0000001564128877__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><div class="p" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p352928691175337"># Display information about the M-LAG with DFS group ID 1.<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen829794086175337">[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword6260833125419"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b28342539175337"> display dfs-group 1 m-lag</strong>
*                     : Local node
Heart beat state      : <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b671991216175337">OK</strong>
Node 1 *
  Dfs-Group ID        : 1
  Priority            : 150
  Dual-active Address : 10.1.1.1
  VPN-Instance        : public net
  State               : <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b1532367639175337">Master</strong>
  Causation           : -
  System ID           : 00e0-fc12-3456
  SysName             : DeviceA
  Version             : <span class="keyword" id="EN-US_TASK_0000001564128877__keyword4459185815183">V300R023C00</span>
  Device Type         : <span>CE6860-SAN</span>
Node 2
  Dfs-Group ID        : 1
  Priority            : 120
  Dual-active Address : 10.1.1.2
  VPN-Instance        : public net
  State               : <strong id="EN-US_TASK_0000001564128877__en-us_task_0241512096_b825091437175337">Backup</strong>
  Causation           : -
  System ID           : 00e0-fc12-3457
  SysName             : DeviceB
  Version             : <span class="keyword" id="EN-US_TASK_0000001564128877__keyword427545151710">V300R023C00</span>
  Device Type         : <span>CE6860-SAN</span></pre>
</div>
<p id="EN-US_TASK_0000001564128877__p1163693084817">In the preceding command output, the <span class="parmname" id="EN-US_TASK_0000001564128877__parmname18332162010402"><b>Heart beat state</b></span> field displays <span class="parmname" id="EN-US_TASK_0000001564128877__parmname17332192094020"><b>OK</b></span>, indicating that the heartbeat status is normal. DeviceA is node 1 with a priority of 150 and serves as the M-LAG master device (the <span class="parmname" id="EN-US_TASK_0000001564128877__parmname13332520124019"><b>State</b></span> field displays <span class="parmname" id="EN-US_TASK_0000001564128877__parmname1833242074015"><b>Master</b></span>), whereas DeviceB is node 2 with a priority of 120 and serves as the M-LAG backup device (the <span class="parmname" id="EN-US_TASK_0000001564128877__parmname1733262016409"><b>State</b></span> field displays <span class="parmname" id="EN-US_TASK_0000001564128877__parmname433214205401"><b>Backup</b></span>). In addition, the <span class="parmname" id="EN-US_TASK_0000001564128877__parmname10761433135019"><b>Causation</b></span> field displays <span class="parmname" id="EN-US_TASK_0000001564128877__parmname19765334509"><b>-</b></span>, indicating that the M-LAG is set up successfully.</p>
<p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p447951120175337"># Display M-LAG information on DeviceA.</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__screen20374141513399">[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword95115410559"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong id="EN-US_TASK_0000001564128877__b479311208395"> display dfs-group 1 node 1 m-lag brief</strong>
* - Local node

M-Lag ID     Interface      Port State    Status                Consistency-check
       1     Eth-Trunk 1    <strong id="EN-US_TASK_0000001564128877__b4793132053911">Up</strong>            active(*)-active      --


Failed reason:                                                                  
    1 -- Relationship between vlan and port is inconsistent                     
    2 -- STP configuration under the port is inconsistent                       
    3 -- STP port priority configuration is inconsistent                        
    4 -- LACP mode of M-LAG is inconsistent                                     
    5 -- M-LAG configuration is inconsistent                                    
    6 -- The number of M-LAG members is inconsistent
    7 -- LACP system-id of M-LAG is inconsistent
    8 -- LACP priority of M-LAG is inconsistent
    9 -- STP port edged configuration is inconsistent
    10 -- M-LAG mode configuration is inconsistent</pre>
<p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p1014088561175337"># Display M-LAG information on DeviceB.</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__screen15555135616421">[<span class="keyword" id="EN-US_TASK_0000001564128877__keyword136141229195517"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong id="EN-US_TASK_0000001564128877__b416612144315"> display dfs-group 1 node 2 m-lag brief</strong>
* - Local node

M-Lag ID     Interface      Port State    Status                Consistency-check
       1     Eth-Trunk 1    <strong id="EN-US_TASK_0000001564128877__b16166131174315">Up</strong>            active-active(*)      --


Failed reason:                                                                  
    1 -- Relationship between vlan and port is inconsistent                     
    2 -- STP configuration under the port is inconsistent                       
    3 -- STP port priority configuration is inconsistent                        
    4 -- LACP mode of M-LAG is inconsistent                                     
    5 -- M-LAG configuration is inconsistent                                    
    6 -- The number of M-LAG members is inconsistent  
    7 -- LACP system-id of M-LAG is inconsistent
    8 -- LACP priority of M-LAG is inconsistent
    9 -- STP port edged configuration is inconsistent
    10 -- M-LAG mode configuration is inconsistent</pre>
<p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p171703568175337">In the preceding command outputs, the <span class="parmname" id="EN-US_TASK_0000001564128877__parmname5845115164318"><b>Port State</b></span> fields of node 1 and node 2 display <span class="parmname" id="EN-US_TASK_0000001564128877__parmname584635116439"><b>Up</b></span>, and the M-LAG status of node 1 and node 2 is <span class="parmname" id="EN-US_TASK_0000001564128877__parmname118461051184312"><b>active</b></span>, indicating that the M-LAG configuration is correct.</p>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001564128877__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul id="EN-US_TASK_0000001564128877__en-us_task_0241512096_ul2052983015175337"><li id="EN-US_TASK_0000001564128877__en-us_task_0241512096_li1908229667175337"><p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p1095228971175337"><a name="EN-US_TASK_0000001564128877__en-us_task_0241512096_li1908229667175337"></a><a name="en-us_task_0241512096_li1908229667175337"></a>DeviceA</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen763765367175337">#
sysname DeviceA
#
dfs-group 1
 priority 150
<strong id="EN-US_TASK_0000001564128877__b114552763213"> </strong>dual-active detection source ip 10.1.1.1 peer 10.1.1.2
 authentication-mode hmac-sha256 password %+%##!!!!!!!!!"!!!!"!!!!*!!!!C+tR0CW9x*eB&amp;pWp`t),Azgw-h\o8#4LZPD!!!!!!!!!!!!!!!9!!!!&gt;fwJ)I0E{=:%,*,XRhbH&amp;t0MCy_8=7!!!!!!!!!!%+%#
#
vlan batch 11
#
stp bridge-address 00e0-fc12-3458
stp instance 0 root primary
#
interface MEth0/0/0
 ip address 10.1.1.1 255.255.255.0
#
interface Eth-Trunk0
 mode lacp-static
 stp disable
 peer-link 1
#
interface Eth-Trunk1
 port default vlan 11
 stp edged-port enable
 mode lacp-static
 dfs-group 1 m-lag 1
#
interface Eth-Trunk2
 port link-type trunk
 port trunk allow-pass vlan 11
 mode lacp-static 
#
interface <span>100GE</span><span>1/0/1</span>
 eth-trunk 2
#
interface <span>100GE</span><span>1/0/2</span>
 eth-trunk 1
#
interface <span>100GE</span><span>1/0/3</span>
 eth-trunk 0
#
interface <span>100GE</span><span>1/0/4</span>
 eth-trunk 0
#
interface <span>100GE</span><span>1/0/5</span>
 eth-trunk 1
#
interface <span>100GE</span><span>1/0/6</span>
 eth-trunk 2
#
return</pre>
</li><li id="EN-US_TASK_0000001564128877__en-us_task_0241512096_li1653772400175337"><p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p71883679175337"><a name="EN-US_TASK_0000001564128877__en-us_task_0241512096_li1653772400175337"></a><a name="en-us_task_0241512096_li1653772400175337"></a>DeviceB</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen299044331175337">#
sysname DeviceB
#
dfs-group 1
 priority 120
 dual-active detection source ip 10.1.1.2 peer 10.1.1.1
 authentication-mode hmac-sha256 password %+%##!!!!!!!!!"!!!!"!!!!*!!!!=I9f8&gt;C{!P_bhB31@7r-=jrS8c|_"(Bn<font style="font-size:8pt" Face="Courier New" >~</font>#=!!!!!!!!!!!!!!!9!!!!kx-6@.tGA(wAt/IQXl6&gt;[g{6YlOi9$!!!!!!!!!!%+%#
#
vlan batch 11
#
stp bridge-address 00e0-fc12-3458
stp root primary
#
interface MEth0/0/0
 ip address 10.1.1.2 255.255.255.0
#
interface Eth-Trunk0
 mode lacp-static
 stp disable
 peer-link 1
#
interface Eth-Trunk1
 port default vlan 11
 stp edged-port enable
 mode lacp-static
 dfs-group 1 m-lag 1
#
interface Eth-Trunk2
 port link-type trunk
 port trunk allow-pass vlan 11
 mode lacp-static
#
interface <span>100GE</span><span>1/0/1</span>
 eth-trunk 2
#
interface <span>100GE</span><span>1/0/2</span>
 eth-trunk 1
#
interface <span>100GE</span><span>1/0/3</span>
 eth-trunk 0
#
interface <span>100GE</span><span>1/0/4</span>
 eth-trunk 0
#
interface <span>100GE</span><span>1/0/5</span>
 eth-trunk 1
#
interface <span>100GE</span><span>1/0/6</span>
 eth-trunk 2
#
return</pre>
</li><li id="EN-US_TASK_0000001564128877__en-us_task_0241512096_li834020823175337"><p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p762208192175337"><a name="EN-US_TASK_0000001564128877__en-us_task_0241512096_li834020823175337"></a><a name="en-us_task_0241512096_li834020823175337"></a>DeviceC</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen1460893995175337">#
sysname DeviceC
#
vlan batch 11
#
interface Eth-Trunk2
 port link-type trunk
 port trunk allow-pass vlan 11
 mode lacp-static
#
interface <span>100GE</span><span>1/0/1</span>
 eth-trunk 2
#
interface <span>100GE</span><span>1/0/2</span>
 eth-trunk 2
#
return</pre>
</li><li id="EN-US_TASK_0000001564128877__en-us_task_0241512096_li1426025154175337"><p id="EN-US_TASK_0000001564128877__en-us_task_0241512096_p1287262758175337"><a name="EN-US_TASK_0000001564128877__en-us_task_0241512096_li1426025154175337"></a><a name="en-us_task_0241512096_li1426025154175337"></a>DeviceD</p>
<pre class="screen" id="EN-US_TASK_0000001564128877__en-us_task_0241512096_screen2032361077175337">#
sysname DeviceD
#
vlan batch 11
#
interface Eth-Trunk2
 port link-type trunk
 port trunk allow-pass vlan 11
 mode lacp-static
#
interface <span>100GE</span><span>1/0/1</span>
 eth-trunk 2
#
interface <span>100GE</span><span>1/0/2</span>
 eth-trunk 2
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../dc/dc_cfg_m-lag_0020.html">Configuring an M-LAG
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../dc/dc_cfg_m-lag_0049.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../dc/dc_cfg_m-lag_0081.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>