
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring an OSPFv3 NSSA">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospfv3_cfg_0029.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospfv3_cfg_0032.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176662845">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring an OSPFv3 NSSA</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176662845"></a><a name="EN-US_TASK_0000001176662845"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring an OSPFv3 NSSA</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176662845__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>An excessive number of entries in a routing table wastes network resources and leads to high CPU usage. To solve this problem, a non-backbone area on the border of an AS can be configured as an NSSA, which can import AS external routes and advertise them within the entire AS, without learning external routes from the other OSPFv3 areas in the AS. This reduces the consumption of bandwidth and storage resources on the device.</p>
<p>On the network shown in <a href="#EN-US_TASK_0000001176662845__fig_dc_vrp_ospfv3_cfg_209301">Figure 1</a>, OSPFv3 runs on all devices and the entire AS is divided into two areas. DeviceA and DeviceB function as ABRs to forward inter-area routes, and DeviceD functions as an ASBR and imports the external static route 2001:DB8:6::1/128. To import AS external routes, but reduce the number of LSAs advertised to area 1 without compromising route reachability, configure area 1 as an NSSA.</p>
<div class="fignone" id="EN-US_TASK_0000001176662845__fig_dc_vrp_ospfv3_cfg_209301"><a name="EN-US_TASK_0000001176662845__fig_dc_vrp_ospfv3_cfg_209301"></a><a name="fig_dc_vrp_ospfv3_cfg_209301"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring an OSPFv3 NSSA</span><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, and <span>100GE</span> <span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001130783222.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176662845__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>To improve security, you are advised to deploy OSPFv3 authentication. For details, see "Configuring OSPFv3 Authentication." OSPFv3 area authentication is used as an example. For details, see "Example for Configuring Basic OSPFv3 Functions."</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176662845__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Configure basic OSPFv3 functions on each device to ensure OSPFv3 interconnection.</li><li>Configure area 1 as an NSSA.</li><li>Configure DeviceC to import the static route 2001:DB8:7::1/128.</li><li>Configure DeviceD to import the static route 2001:DB8:6::1/128.</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176662845__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface involved.</span><p><p>Assign an IP address to each interface involved according to <a href="#EN-US_TASK_0000001176662845__fig_dc_vrp_ospfv3_cfg_209301">Figure 1</a>. For detailed configurations, see <a href="#EN-US_TASK_0000001176662845__postreq89901616133511">Configuration Scripts</a>.</p>
</p></li><li><span>Configure basic OSPFv3 functions.</span><p><p>For detailed configurations, see <a href="#EN-US_TASK_0000001176662845__postreq89901616133511">Configuration Scripts</a>.</p>
</p></li><li><span>Configure area 1 as an NSSA.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>ospfv3 1</strong>
[<span class="keyword">*</span>DeviceA-ospfv3-1] <strong>area 1</strong>
[<span class="keyword">*</span>DeviceA-ospfv3-1-area-0.0.0.1] <strong>nssa</strong>
[<span class="keyword">*</span>DeviceA-ospfv3-1-area-0.0.0.1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA-ospfv3-1] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceA] <strong>commit</strong></span></pre>
<p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>ospfv3 1</strong>
[<span class="keyword">*</span>DeviceB-ospfv3-1] <strong>area 1</strong>
[<span class="keyword">*</span>DeviceB-ospfv3-1-area-0.0.0.1] <strong>nssa</strong>
[<span class="keyword">*</span>DeviceB-ospfv3-1-area-0.0.0.1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB-ospfv3-1] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceB] <strong>commit</strong></span></pre>
<p># Configure DeviceD.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong>ospfv3 1</strong>
[<span class="keyword">*</span>DeviceD-ospfv3-1] <strong>area 1</strong>
[<span class="keyword">*</span>DeviceD-ospfv3-1-area-0.0.0.1] <strong>nssa</strong>
[<span class="keyword">*</span>DeviceD-ospfv3-1-area-0.0.0.1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceD-ospfv3-1] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceD] <strong>commit</strong></span></pre>
</p></li><li><span>Configure DeviceC to import the static route 2001:DB8:7::1/128.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>ipv6 route-static 2001:DB8:7::1 128 NULL0</strong>
[<span class="keyword">*</span>DeviceC] <strong>ospfv3 1</strong>
[<span class="keyword">*</span>DeviceC-ospfv3-1] <strong>import-route static</strong>
[<span class="keyword">*</span>DeviceC-ospfv3-1] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceC] <strong>commit</strong></span></pre>
</p></li><li><span>Configure DeviceD to import the static route 2001:DB8:6::1/128.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong>ipv6 route-static 2001:DB8:6::1 128 NULL0</strong>
[<span class="keyword">*</span>DeviceD] <strong>ospfv3 1</strong>
[<span class="keyword">*</span>DeviceD-ospfv3-1] <strong>import-route static</strong>
[<span class="keyword">*</span>DeviceD-ospfv3-1] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceD] <strong>commit</strong></span></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001176662845__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Check the OSPFv3 routing tables of DeviceC and DeviceD.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>display ospfv3 routing</strong>
Codes : E2 - Type 2 External, E1 - Type 1 External, IA - Inter-Area,
        N - NSSA
Flags : A - Added to URT6

OSPFv3 Process (1)
     Destination                                                         Metric
       Next-hop
     2001:DB8:1::/64                                                          1
       directly connected, <span>100GE</span><span>1/0/1</span>, Flags : A
IA   2001:DB8:2::/64                                                          2
       via FE80::3A6D:7CFF:FE21:1200, <span>100GE</span><span>1/0/1</span>, Flags : A
IA   2001:DB8:2::/64                                                          2
       via FE80::3A6D:7CFF:FE41:1200, <span>100GE</span><span>1/0/2</span>, Flags : A
     2001:DB8:3::/64                                                          1
       directly connected, <span>100GE</span><span>1/0/2</span>, Flags : A
IA   2001:DB8:4::/64                                                          2
       via FE80::3A6D:7CFF:FE21:1200, <span>100GE</span><span>1/0/1</span>, Flags : A
IA   2001:DB8:5::/64                                                          2
       via FE80::3A6D:7CFF:FE41:1200, <span>100GE</span><span>1/0/2</span>, Flags : A
<strong>E2   2001:DB8:6::1/128                                              1        </strong>
<strong>      via FE80::3A6D:7CFF:FE41:1200, <span>100GE</span><span>1/0/2</span>, Flags : A</strong></pre>
<pre class="screen">[DeviceD] <strong>display ospfv3 routing</strong>
Codes : E2 - Type 2 External, E1 - Type 1 External, IA - Inter-Area,
        N - NSSA
Flags : A - Added to URT6

OSPFv3 Process (1)
     Destination                                                         Metric
       Next-hop
E2   ::/0                                                                     1
N      via FE80::3A6D:7CFF:FE21:1200, <span>100GE</span><span>1/0/1</span>, Flags : A
E2   ::/0                                                                     1
N      via FE80::3A6D:7CFF:FE41:1200, <span>100GE</span><span>1/0/2</span>, Flags : A
IA   2001:DB8:1::/64                                                          2
       via FE80::3A6D:7CFF:FE21:1200, <span>100GE</span><span>1/0/1</span>, Flags : A
     2001:DB8:2::/64                                                          2
       via FE80::3A6D:7CFF:FE21:1200, <span>100GE</span><span>1/0/1</span>, Flags : A
     2001:DB8:2::/64                                                          2
       via FE80::3A6D:7CFF:FE41:1200, <span>100GE</span><span>1/0/2</span>, Flags : A
IA   2001:DB8:3::/64                                                          2
       via FE80::3A6D:7CFF:FE41:1200, <span>100GE</span><span>1/0/2</span>, Flags : A
     2001:DB8:4::/64                                                          1
       directly connected, <span>100GE</span><span>1/0/1</span>, Flags : A
     2001:DB8:5::/64                                                          1
       directly connected, <span>100GE</span><span>1/0/2</span>, Flags : A</pre>
<p>The command output shows that DeviceC has imported the AS external route (2001:DB8:6::1/128) and that the route was advertised by DeviceB. In addition, the NSSA does not learn the route 2001:DB8:7::1/128 from area 0.</p>
<p># Check routing information of the NSSA on each device involved. This example uses DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display ospfv3 routing nssa-routes</strong>
Codes : E2 - Type 2 External, E1 - Type 1 External, IA - Inter-Area,
        N - NSSA
Flags : A - Added to URT6

OSPFv3 Process (1)
     Destination                                                         Metric
       Next-hop
<strong>E2   2001:DB8:6::1/128                                          1 N</strong>
<strong>      via FE80::3A6D:7CFF:FE11:1200, <span>100GE</span><span>1/0/2</span>, Flags : A</strong></pre>
<p># Check NSSA-LSA information on each device involved. This example uses DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display ospfv3 lsdb nssa</strong>
           OSPFv3 Router with ID (1.1.1.1) (Process 1)

               NSSA-external-LSA (Area 0.0.0.1)

  LS Age: 391
  LS Type: NSSA-external-LSA
  Link State ID: 0.0.0.0
  Originating Router: 1.1.1.1
  LS Seq Number: 0x80000001
  Retransmit Count: 0
  Checksum: 0x6ebe
  Length: 32
  Flags: (E|-|T)
   Metric Type: 2 (Larger than any link state path)
      Metric: 1
   Prefix: ::/0
    Prefix Options: 0 (-|-|-|-|-)
    Tag: 0

  LS Age: 378
  LS Type: NSSA-external-LSA
  Link State ID: 0.0.0.0
  Originating Router: 2.2.2.2
  LS Seq Number: 0x80000001
  Retransmit Count: 0
  Checksum: 0x50d8
  Length: 32    
  Flags: (E|-|T)
   Metric Type: 2 (Larger than any link state path)
      Metric: 1
   Prefix: ::/0
    Prefix Options: 0 (-|-|-|-|-)
    Tag: 0      
                
  LS Age: 429   
  LS Type: NSSA-external-LSA
  Link State ID: 0.0.0.1
  Originating Router: 4.4.4.4
  LS Seq Number: 0x80000001
  Retransmit Count: 0
  Checksum: 0xb7e0
  Length: 48    
  Flags: (E|-|T)
   Metric Type: 2 (Larger than any link state path)
      Metric: 1 
   Prefix: 2001:DB8:6::1/128
    Prefix Options: 8 (-|P|-|-|-)</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001176662845__postreq89901616133511"></a><a name="postreq89901616133511"></a><a name="EN-US_TASK_0000001176662845__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable    
 ipv6 address 2001:DB8:1::2/64
 ospfv3 1 area 0.0.0.0
#               
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable    
 ipv6 address 2001:DB8:4::1/64
 ospfv3 1 area 0.0.0.1
#               
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ipv6 enable    
 ipv6 address 2001:DB8:2::1/64
 ospfv3 1 area 0.0.0.1
#               
ospfv3 1        
 router-id 1.1.1.1
 area 0.0.0.0   
 area 0.0.0.1   
  nssa            
#
return</pre>
</li><li><p>DeviceB</p>
<pre class="screen">#
sysname DeviceB
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable    
 ipv6 address 2001:DB8:2::2/64
 ospfv3 1 area 0.0.0.1
#               
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable    
 ipv6 address 2001:DB8:3::1/64
 ospfv3 1 area 0.0.0.0
#               
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ipv6 enable    
 ipv6 address 2001:DB8:5::2/64
 ospfv3 1 area 0.0.0.1
#               
ospfv3 1        
 router-id 2.2.2.2
 area 0.0.0.0   
 area 0.0.0.1   
  nssa            
#
return</pre>
</li><li><p>DeviceC</p>
<pre class="screen">#
sysname DeviceC
#   
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable    
 ipv6 address 2001:DB8:1::1/64
 ospfv3 1 area 0.0.0.0
#               
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable    
 ipv6 address 2001:DB8:3::2/64
 ospfv3 1 area 0.0.0.0
#               
ospfv3 1        
 router-id 3.3.3.3
 import-route static
 area 0.0.0.0   
#               
ipv6 route-static 2001:DB8:7::1 128 NULL0 
#
return</pre>
</li><li><p>DeviceD</p>
<pre class="screen">#
sysname DeviceD
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable    
 ipv6 address 2001:DB8:4::2/64
 ospfv3 1 area 0.0.0.1
#               
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable    
 ipv6 address 2001:DB8:5::1/64
 ospfv3 1 area 0.0.0.1
#              
ospfv3 1        
 router-id 4.4.4.4
 import-route static
 area 0.0.0.1   
  nssa          
#
ipv6 route-static 2001:DB8:6::1 128 NULL0 
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_ospfv3_cfg_0029.html">Configuring an OSPFv3 NSSA
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_ospfv3_cfg_0032.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>