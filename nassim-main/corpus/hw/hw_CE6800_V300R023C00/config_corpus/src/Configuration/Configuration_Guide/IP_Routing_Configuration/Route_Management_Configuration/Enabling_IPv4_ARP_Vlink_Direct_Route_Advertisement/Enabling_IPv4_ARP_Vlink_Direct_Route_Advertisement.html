
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Enabling IPv4 ARP Vlink Direct Route Advertisement">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_ip_routing_management_cfg_0017.html">
<meta name="DC.Relation" scheme="URI" content="vrp_ip_routing_management_cfg_0018.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Route Management">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Route Management">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="Route Management">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130622772">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Enabling IPv4 ARP Vlink Direct Route Advertisement</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130622772"></a><a name="EN-US_TASK_0000001130622772"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Enabling IPv4 ARP Vlink Direct Route Advertisement</h1>
<div class="taskbody"><p></p>
<div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001130622772__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before configuring IPv4 ARP Vlink direct route advertisement, you have completed the following task:</p>
<ul><li><p>Set data link layer protocol parameters and IPv4 addresses for interfaces to ensure that the data link layer protocol status on each interface is up.</p>
</li></ul>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130622772__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Enable IPv4 ARP Vlink direct route advertisement.</span><p><pre class="screen"><a href="cmdqueryname=arp+direct-route+enable"><b><span class="cmdname">arp direct-route enable</span></b></a></pre>
<p>After the device is enabled to advertise IPv4 ARP Vlink direct routes, IPv4 ARP Vlink direct routes can be advertised only after they are imported to the routing table of a dynamic routing protocol. Perform one of the following operations based on a routing protocol running on a device:</p>
<ul><li>Enable RIP to import and advertise IPv4 ARP Vlink direct routes.<pre class="screen"><a href="cmdqueryname=import-route"><b><span class="cmdname">import-route</span></b></a> <strong><span>direct</span></strong> [ <strong><span>cost</span></strong> <i><span class="varname">cost</span></i> | <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> ] <sup>*</sup></pre>
</li><li>Enable OSPF to import and advertise IPv4 ARP Vlink direct routes.<pre class="screen"><a href="cmdqueryname=import-route"><b><span class="cmdname">import-route</span></b></a> <strong><span>direct</span></strong> [ <strong><span>cost</span></strong> <i><span class="varname">cost</span></i> | <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> | <strong><span>tag</span></strong> <i><span class="varname">tag</span></i> | <strong><span>type</span></strong> <i><span class="varname">type</span></i> ] <sup>*</sup></pre>
</li><li>Enable IS-IS to import and advertise IPv4 ARP Vlink direct routes.<pre class="screen"><a href="cmdqueryname=import-route"><b><span class="cmdname">import-route</span></b></a> <strong><span>direct</span></strong> [ <strong><span>cost-type</span></strong> { <strong><span>external</span></strong> | <strong><span>internal</span></strong> } | <strong><span>cost</span></strong> <i><span class="varname">cost</span></i> | <strong><span>tag</span></strong> <i><span class="varname">tag</span></i> | <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> | [ <strong><span>level-1</span></strong> | <strong><span>level-2</span></strong> | <strong><span>level-1-2</span></strong> ] ] <sup>*</sup></pre>
</li><li>Enable BGP to import and advertise IPv4 ARP Vlink direct routes.<pre class="screen"><a href="cmdqueryname=import-route"><b><span class="cmdname">import-route</span></b></a> <strong><span>direct</span></strong> [ <strong><span>med</span></strong> <i><span class="varname">med</span></i> | <strong><span>route-policy</span></strong> <i><span class="varname">route-policy-name</span></i> ] <sup>*</sup></pre>
</li></ul>
</p></li><li><span>Enter the interface view.</span><p><pre class="screen"><a href="cmdqueryname=interface"><b><span class="cmdname">interface</span></b></a> <span>{ <i><span class="varname">interface-name</span></i> | <i><span class="varname">interface-type</span></i> <i><span class="varname">interface-number</span></i> }</span></pre>
</p></li><li><span>Switch the interface working mode from Layer 2 to Layer 3.</span><p><pre class="screen"><a href="cmdqueryname=undo+portswitch"><b><span class="cmdname">undo portswitch</span></b></a></pre>
<p>Determine whether to perform this step based on the current interface working mode.</p>
</p></li><li><span>Set a preference value for ARP Vlink direct routes.</span><p><pre class="screen"><a href="cmdqueryname=arp+direct-route+preference"><b><span class="cmdname">arp direct-route preference</span></b></a> <i><span class="varname">preference-value</span></i></pre>
<p>By default, the preference value of ARP Vlink direct routes on VLANIF interfaces is 255<span>, and the preference value of ARP Vlink direct routes on VBDIF interfaces is 0</span>. ARP Vlink direct routes can be advertised by different routing protocols. If there are multiple ARP Vlink direct routes advertised by different routing protocols, you can run this command to change the preference values of these routes for route selection.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The CE6885-LL in low latency mode does not support <span>VBDIF interfaces</span>.</p>
</div></div>
</p></li><li><span>Set a tag value for ARP Vlink direct routes.</span><p><pre class="screen"><a href="cmdqueryname=arp+direct-route+tag"><b><span class="cmdname">arp direct-route tag</span></b></a> <i><span class="varname">tag-value</span></i></pre>
</p><p><div class="p">By default, the tag value of ARP Vlink direct routes to be advertised is 0. To change the tag value of ARP Vlink direct routes, run the <a href="cmdqueryname=arp+direct-route+tag"><b><span class="cmdname">arp direct-route tag</span></b></a> command. As shown in <a href="#EN-US_TASK_0000001130622772__en-us_task_0172365357_en-us_cliref_0172379007_fig_arp_direct-route_tag01">Figure 1</a>, GW1 and GW2 function as gateways and have the same IP address. GW1 and GW2 learn ARP entries carrying Switch information and generate ARP Vlink direct routes. GW1 and GW2 advertise the generated ARP Vlink direct routes and direct network segment routes destined for 10.1.1.6/24. The ARP Vlink direct routes and direct network segment routes cannot be advertised separately because they have the same tag value. If the link between GW1 and Switch fails, a related ARP Vlink direct route is withdrawn, but the network segment route advertised by GW1 is not withdrawn. As a result, DeviceA cannot detect the link fault and traffic cannot be quickly switched to the link between GW2 and Switch, causing a traffic forwarding failure. To resolve this problem, run the <a href="cmdqueryname=arp+direct-route+tag"><b><span class="cmdname">arp direct-route tag</span></b></a> command to change the tag value of ARP Vlink direct routes and create a route-policy to match the tag value. In this way, GW1 advertises only the ARP Vlink direct routes but not the direct network segment routes. If the link between GW1 and Switch fails, GW1 cannot learn ARP entries. After the ARP Vlink direct routes are withdrawn, DeviceA detects the fault on the link between GW1 and Switch and rapidly switches traffic to the link between GW2 and Switch.<div class="fignone" id="EN-US_TASK_0000001130622772__en-us_task_0172365357_en-us_cliref_0172379007_fig_arp_direct-route_tag01"><a name="EN-US_TASK_0000001130622772__en-us_task_0172365357_en-us_cliref_0172379007_fig_arp_direct-route_tag01"></a><a name="en-us_task_0172365357_en-us_cliref_0172379007_fig_arp_direct-route_tag01"></a><span class="figcap"><b>Figure 1 </b>Network diagram of setting a tag value for ARP Vlink direct routes</span><br><span><img class="vsd" src="figure/en-us_image_0000001130782570.png" width="NaN" height="NaN"></span></div>
</div>
</p></li><li><span>Set a delay in advertising ARP Vlink direct routes.</span><p><pre class="screen"><a href="cmdqueryname=arp+direct-route+delay"><b><span class="cmdname">arp direct-route delay</span></b></a> <i><span class="varname">delay-time</span></i></pre>
</p><p><p>To prevent traffic loss when ARP Vlink direct route update is slower than route diversion, you can set a delay in advertising ARP Vlink direct routes.</p>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001130622772__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001130622772__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_ip_routing_management_cfg_0017.html">Enabling IPv4 ARP Vlink Direct Route Advertisement
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_ip_routing_management_cfg_0018.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>