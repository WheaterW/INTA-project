
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring EVA Based on JSON Scripts">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../toctopics/en-us_topic_0000001512671434.html">
<meta name="DC.Relation" scheme="URI" content="../toctopics/en-us_topic_0000001533947742.html">
<meta name="DC.Relation" scheme="URI" content="../toctopics/en-us_topic_0000001533788278.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="EVA">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="EVA">
<meta name="featuretype" content="System Monitoring">
<meta name="featurename" content="EVA">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001564110649">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Configuring EVA Based on JSON Scripts</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001564110649"></a><a name="EN-US_TASK_0000001564110649"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring EVA Based on JSON Scripts</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001564110649__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>EVA obtains data by loading and parsing JSON scripts. JSON scripts are classified into single-task scripts and PMI scripts. PMI scripts have the PMI function.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001564110649__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>(Optional) Configure gRPC in dial-in mode.</span><p><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the eva.kpi function is used in JSON scripts, this step is mandatory.</p>
</div></div>
</p><ol type="a"><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the gRPC view.</span><p><pre class="screen"><a href="cmdqueryname=grpc"><b><span class="cmdname">grpc</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the server view.</span><p><pre class="screen"><a href="cmdqueryname=grpc+server"><b><span class="cmdname">grpc server</span></b></a></pre>
</p></li><li class="substepexpand"><span>Configure the source IPv4 address of the gRPC server.</span><p><pre class="screen"><a href="cmdqueryname=source-ip"><b><span class="cmdname">source-ip</span></b></a> <strong>0.0.0.0</strong></pre>
</p></li><li class="substepexpand"><span>Set the port number of the gRPC server to 57400.</span><p><pre class="screen"><a href="cmdqueryname=server-port"><b><span class="cmdname">server-port</span></b></a> <strong>57400</strong></pre>
</p></li><li class="substepexpand"><span>Enable the gRPC service.</span><p><pre class="screen"><a href="cmdqueryname=server+enable"><b><span class="cmdname">server enable</span></b></a></pre>
</p></li><li class="substepexpand"><span>Exit the system view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a>
<a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li></ol>
</li><li><span>(Optional) Enable NETCONF.</span><p><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>If the eva.netconfGet function is used in JSON scripts, this step is mandatory.</p>
</div></div>
</p><ol type="a"><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enable NETCONF.</span><p><pre class="screen"><a href="cmdqueryname=snetconf+server+enable"><b><span class="cmdname">snetconf server enable</span></b></a></pre>
</p></li><li class="substepexpand"><span>Exit the system view.</span><p><pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen"><a href="cmdqueryname=commit"><b><span class="cmdname">commit</span></b></a></pre>
</p></li></ol>
</li><li><span>Install and register the script.</span><p><ul><li>Method 1: You can manually download scripts from servers (for single-task scripts and PMI scripts).<ol type="a"><li>Upload a script to the device.<p>For details on how to upload a file to the device, see "File System Management Configuration" in <span>Configuration Guide</span> &gt; Basic Configuration.</p>
</li><li>Install and register the script.<pre class="screen"><a href="cmdqueryname=install+eva+script"><b><span class="cmdname">install eva script</span></b></a> <i><span class="varname">fileName</span></i> [ <strong><span>inspection</span></strong> ]</pre>
<p>When installing the PMI script, you must specify the <strong><span>inspection</span></strong> parameter. Before the PMI script is executed, you cannot install it again.</p>
</li></ol>
</li><li>Method 2: The EVA module automatically downloads scripts from servers (only for PMI scripts).<div class="p">Download, install, and register the script.<pre class="screen"><a href="cmdqueryname=install+eva+script"><b><span class="cmdname">install eva script</span></b></a> <i><span class="varname">fileName</span></i> <strong><span>inspection</span></strong> { <a href="cmdqueryname=ftp"><b><span class="cmdname">ftp</span></b></a> | <strong><span>sftp</span></strong> } { <strong><span>ipv4</span></strong> <i><span class="varname">ipv4Address</span></i> | <strong><span>ipv6</span></strong> <i><span class="varname">ipv6Address</span></i> } <strong><span>port</span></strong> <i><span class="varname">portNum</span></i> <strong><span>username</span></strong> <i><span class="varname">userName</span></i> <strong><span>password</span></strong> <i><span class="varname">pwd</span></i> [ <strong><span>vpn-instance</span></strong> <i><span class="varname">vpnInstance</span></i> ] [ <strong><span>server-path</span></strong> <i><span class="varname">serverPath</span></i> ]</pre>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>This command can be used only after the weak security algorithm/protocol feature package (WEAKEA) is installed using the <a href="cmdqueryname=install+feature-software"><b><span class="cmdname">install feature-software</span></b></a> <strong><span>WEAKEA</span></strong> command.</p>
<p>SFTP is recommended because it is more secure than FTP.</p>
</div></div>
</div>
</li></ul>
</p></li><li><span>(Optional) Uninstall a script.</span><p><ul><li>Uninstall a single-task script.<pre class="screen"><a href="cmdqueryname=uninstall+eva+script"><b><span class="cmdname">uninstall eva script</span></b></a> <i><span class="varname">fileName</span></i></pre>
</li></ul>
<ul><li>Uninstall a PMI script.<pre class="screen"><a href="cmdqueryname=uninstall+eva+script+inspection"><b><span class="cmdname">uninstall eva script inspection</span></b></a></pre>
<p>You cannot install the PMI script again before the uninstallation is complete.</p>
</li></ul>
</p></li><li><span>(Optional) Configure the system to save the EVA script check result and collected data in the buffer to the <strong><span>flash</span>:/eva/checkresult</strong> or <strong><span>flash</span>:/eva/collection</strong> directory. (This step is performed only for single-task scripts).</span><p><pre class="screen"><a href="cmdqueryname=save+eva+check-result"><b><span class="cmdname">save eva check-result</span></b></a></pre>
<p>By default, the system saves the EVA script check result and collected data in the buffer to the <strong><span>flash</span>:/eva/checkresult</strong> or <strong><span>flash</span>:/eva/collection</strong> directory only when the size of the EVA script check result and collected data in the buffer exceeds 2 MB or the number of the result and data records exceeds 50, or the system saves the EVA script check result and collected data in the buffer to the <strong><span>flash</span>:/eva/checkresult</strong> or <strong><span>flash</span>:/eva/collection</strong> directory every 30 minutes.</p>
<p>You do not need to run this command for PMI scripts. After the PMI is complete, the system automatically saves the EVA script check result and collected data in the buffer to the <strong><span>flash</span>:/eva/checkresult</strong> or <strong><span>flash</span>:/eva/collection</strong> directory, compresses the result and data into <strong>eva_inspection_</strong><em>current time</em><strong>.zip</strong>, and saves the file to the <strong><span>flash</span>:/eva</strong> directory. If the device directly downloads the script from the FTP or SFTP server and installs and registers the script, it automatically uploads the content in the <strong><span>flash</span>:/eva</strong> directory to the server and deletes the <strong>eva_inspection_</strong><em>current time</em><strong>.zip</strong> package after the PMI.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001564110649__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ul><li>Run the <a href="cmdqueryname=display+eva+fault-event"><b><span class="cmdname">display eva fault-event</span></b></a> [ <i><span class="varname">filename</span></i> ] { <strong><span>matched</span></strong> | <strong><span>unmatched</span></strong> | <strong><span>all</span></strong> } [ <i><span class="varname">begintime</span></i> <i><span class="varname">endtime</span></i> ] command to check EVA events and matching information about related strategies.</li><li>Run the <a href="cmdqueryname=display+eva+fault"><b><span class="cmdname">display eva fault</span></b></a> [ <strong><span>unrecovered</span></strong> | <strong><span>recovered </span></strong>] [ <i><span class="varname">object</span></i> ] [ <i><span class="varname">beginTime</span></i> <i><span class="varname">endTime</span></i> ] command to check the fault data managed using EVA.</li><li>Run the <a href="cmdqueryname=display+eva+register-events"><b><span class="cmdname">display eva register-events </span></b></a>[ <i><span class="varname">filename</span></i> ] command to check registration information about the event configured in an EVA script.</li><li>Run the <a href="cmdqueryname=display+eva+register-status"><b><span class="cmdname">display eva register-status</span></b></a> [ <em>filename</em> ] command to check the registration status of an EVA script.</li><li>Run the <a href="cmdqueryname=display+eva+register-strategy"><b><span class="cmdname">display eva register-strategy</span></b></a> [ <i><span class="varname">filename</span></i> ] command to check registration information about the strategy configured in an EVA script.</li><li>Run the <a href="cmdqueryname=display+eva+script-item+status"><b><span class="cmdname">display eva script-item status</span></b></a> command to check the running status of an EVA script.</li><li>Run the <a href="cmdqueryname=display+eva+inspection+history"><b><span class="cmdname">display eva inspection history</span></b></a> command to check the execution history of the EVA PMI script.</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../toctopics/en-us_topic_0000001512671434.html">EVA Configuration
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../toctopics/en-us_topic_0000001533947742.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../toctopics/en-us_topic_0000001533788278.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>