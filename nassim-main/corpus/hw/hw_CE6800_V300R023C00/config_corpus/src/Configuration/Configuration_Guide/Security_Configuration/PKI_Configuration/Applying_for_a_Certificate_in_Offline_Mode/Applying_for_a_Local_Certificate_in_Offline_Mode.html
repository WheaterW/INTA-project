
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Applying for a Local Certificate in Offline Mode">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="security_pki_cfg_0012.html">
<meta name="DC.Relation" scheme="URI" content="security_pki_cfg_0013.html">
<meta name="DC.Relation" scheme="URI" content="security_pki_cfg_0043.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="PKI">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="Security Protection">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="PKI">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="Security Protection">
<meta name="featurename" content="PKI">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="Security Protection">
<meta name="featuretype" content="Security">
<meta name="featuretype" content="Security Protection">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001564006261">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Applying for a Local Certificate in Offline Mode</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001564006261"></a><a name="EN-US_TASK_0000001564006261"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Applying for a Local Certificate in Offline Mode</h1>
<div class="taskbody"><div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001564006261__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>You have completed the preconfiguration for a local certificate application. For details, see <a href="security_pki_cfg_0041.html">Preconfiguration for Certificate Application</a>.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001564006261__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>You can apply for a local certificate offline. To do this, you need to first generate a certificate enrollment request file on the device, and then send the file to the CA in out-of-band mode (for example, by disk or email).</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001564006261__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><span><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></span></pre>
</p></li><li><span>Create a PKI realm and enter its view, or enter the view of an existing PKI realm.</span><p><pre class="screen"><a href="cmdqueryname=pki+realm"><b><span class="cmdname">pki realm</span></b></a> <i><span class="varname">realm-name</span></i></pre>
</p><p><p><span>By default, the  system has a PKI realm named <strong>default</strong>. This realm can be modified but cannot be deleted.</span></p>
<p>A PKI realm is locally available. It is unavailable to CAs or other devices. Each PKI realm has its own parameter settings.</p>
</p></li><li><span>Specify the PKI entity that applies for a certificate.</span><p><pre class="screen"><a href="cmdqueryname=entity"><b><span class="cmdname">entity</span></b></a> <i><span class="varname">entity-name</span></i></pre>
</p><p><p>The PKI entity specified by <i><span class="varname">entity-name</span></i> must have been created using the <a href="cmdqueryname=pki+entity"><b><span class="cmdname">pki entity</span></b></a> command.</p>
</p></li><li><span>Configure the key pair used to apply for a certificate in offline mode as required.</span><ul><li>This command is added to configure the RSA key pair used in offline certificate application.<pre class="screen"><a href="cmdqueryname=rsa+local-key-pair"><b><span class="cmdname">rsa local-key-pair</span></b></a> <i><span class="varname">key-name</span></i></pre>
</li><li>This command is added to configure the SM2 key pair used in offline certificate application.<pre class="screen"><a href="cmdqueryname=sm2+local-key-pair"><b><span class="cmdname">sm2 local-key-pair</span></b></a> <i><span class="varname">key-name</span></i></pre>
</li></ul>
</li><li><span>Configure the digest algorithm used to sign certificate enrollment requests.</span><p><pre class="screen"><a href="cmdqueryname=enrollment-request+signature+message-digest-method"><b><span class="cmdname">enrollment-request signature message-digest-method</span></b></a> { <strong><span>md5</span></strong> | <span><strong>sha1</strong>| </span><strong><span>sha-256</span></strong> | <strong><span>sha-384</span></strong> | <strong><span>sha-512</span></strong> | <strong><span>sm3</span></strong> }</pre>
</p><p><p>By default, the digest algorithm used to sign certificate enrollment requests is SHA-256.</p>
<p>The digest algorithm used on a PKI entity must be the same as that used on the CA server. Note that the MD5 and SHA1 algorithms are insecure, so you are advised to use the more secure SHA2 algorithms (SHA-256, SHA-384, and SHA-512).</p>
<p>In a PKI realm, if the SM2 key pair is used to apply for a certificate in offline mode, the digest algorithm used to sign certificate enrollment requests must be configured as SM3. If the RSA key pair is used to apply for a certificate in offline mode, the digest algorithm used to sign certificate enrollment requests cannot be configured as SM3. Otherwise, offline certificate application fails.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>For security purpose,you are not advised to use the weak security algorithm or weak security protocols provided by this feature. If you need to use the weak security algorithm or protocols, run the <strong id="EN-US_TASK_0000001564006261__en-us_topic_0198441389_b7309427153513">install feature-software WEAKEA</strong> command to install the weak security algorithm or protocol feature package WEAKEA. By default, the device provides the weak security algorithm or protocol feature package WEAKEA. For details about how to install or uninstall the feature package, see "Upgrade Maintenance Configuration" in <span>Configuration Guide</span> &gt; System Management Configuration.</p>
</div></div>
</p></li><li><strong>Optional: </strong><span>Configure the certificate public key usage attribute.</span><p><pre class="screen"><a href="cmdqueryname=key-usage"><b><span class="cmdname">key-usage</span></b></a><span> { <strong><span>signature</span></strong> | <strong><span>cipher</span></strong> }</span>
<span><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></span></pre>
</p></li><li><span>Configure the file format in which the device stores the certificate and certificate enrollment request in the system view.</span><p><pre class="screen"><a href="cmdqueryname=pki+file-format"><b><span class="cmdname">pki file-format</span></b></a> { <strong><span>der</span></strong> | <strong><span>pem</span></strong> }</pre>
</p><p><p>By default, the device stores the certificate and certificate enrollment request into a PEM file.</p>
</p></li><li><span>Set parameters to save certificate enrollment information into a file in PKCS#10 format.</span><p><pre class="screen"><a href="cmdqueryname=pki+enroll-certificate"><b><span class="cmdname">pki enroll-certificate</span></b></a> <strong><span>realm</span></strong> <i><span class="varname">realm-name</span></i> <strong><span>pkcs10</span></strong> [ <strong><span>filename</span></strong> <i><span class="varname">filename</span></i> ] [ <strong><span>password</span></strong> <i><span class="varname">password</span></i> ]</pre>
</p><p><p>The challenge password used on a PKI entity must be the same as that configured on the CA server. If the CA server does not require a challenge password, this challenge password does not need to be configured.</p>
</p></li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001564006261__en-us_task_0228023023_en-us_task_0228023023_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001564006261__en-us_task_0228023023_en-us_task_0228023023_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li><li><span>Enable the device to send the certificate enrollment request file to the CA in out-of-band mode (for example, by disk or email) to apply for a local certificate.</span></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001564006261__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><ul><li>Run the <a href="cmdqueryname=display+pki+realm"><b><span class="cmdname">display pki realm</span></b></a> [ <i><span class="varname">realm-name</span></i> ] command to check the PKI realm information.</li><li>Run the <a href="cmdqueryname=display+pki+cert-req"><b><span class="cmdname">display pki cert-req</span></b></a> <strong><span>filename</span></strong> <i><span class="varname">file-name</span></i> command to check the content of the certificate enrollment request file.</li></ul>
</div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="security_pki_cfg_0012.html">Applying for a Certificate in Offline Mode
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="security_pki_cfg_0013.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="security_pki_cfg_0043.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>