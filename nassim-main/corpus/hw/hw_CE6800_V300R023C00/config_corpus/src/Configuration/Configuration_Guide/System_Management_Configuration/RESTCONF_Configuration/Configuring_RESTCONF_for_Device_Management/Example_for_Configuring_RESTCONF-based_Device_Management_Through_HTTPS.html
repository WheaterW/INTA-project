
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring RESTCONF-based Device Management Through HTTPS">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_restconf_cfg_0019.html">
<meta name="DC.Relation" scheme="URI" content="vrp_restconf_cfg_0020.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_restconf_cfg_0025.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="RESTCONF">
<meta name="featuretype" content="System Management">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="RESTCONF">
<meta name="featuretype" content="System Management">
<meta name="featurename" content="RESTCONF">
<meta name="featuretype" content="System Management">
<meta name="featuretype" content="System Management">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001512851258">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring RESTCONF-based Device Management Through HTTPS</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001512851258"></a><a name="EN-US_TASK_0000001512851258"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring RESTCONF-based Device Management Through HTTPS</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001512851258__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>RESTCONF is an HTTP-based protocol that provides RESTful APIs. External applications can use HTTP to access APIs to implement remote device management and operations. <a href="#EN-US_TASK_0000001512851258__fig104623531117">Figure 1</a> shows a network where RESTCONF is used for device management. On this network, the device functions as a RESTCONF server.</p>
<div class="fignone" id="EN-US_TASK_0000001512851258__fig104623531117"><a name="EN-US_TASK_0000001512851258__fig104623531117"></a><a name="fig104623531117"></a><span class="figcap"><b>Figure 1 </b>RESTCONF-based device management</span><br><span><img src="figure/en-us_image_0000001852290130.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001512851258__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Precautions</h4><p>If the network environment is insecure, you are advised to configure the device as an HTTPS server, which is more secure.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001512851258__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Configure an HTTP server as the RESTCONF server, including configuring IP addresses for interfaces to communicate with an HTTP client, creating an AAA user, configuring an SSL policy, and enabling the HTTP server function.</li><li><p>Configure an HTTP client. Postman is a common HTTP client. To obtain the Postman installation package, visit <a href="https://www.postman.com/downloads/" target="_blank" rel="noopener noreferrer">https://www.postman.com/downloads/</a>.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001512851258__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure IP addresses for interfaces on the device.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>ip address 10.1.1.1 24</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong></pre>
</p></li><li><span>Create an AAA user on the device.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>aaa</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-aaa] <strong>local-user huawei123 password </strong><strong>irreversible-cipher</strong> <strong>********</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-aaa] <strong>local-user huawei123 service-type http</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-aaa] <strong>local-user huawei123 privilege level 3</strong> 
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-aaa] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>ssh authentication-type default password</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong></pre>
</p></li><li><span>Configure an SSL policy on the device.</span><p><p># Upload the obtained digital certificate to the <strong>/pki/public</strong> directory of the device through SFTP. For details about how to apply for a digital certificate in PKI mode, see <em><span>Configuration Guide</span> - PKI Configuration</em>.</p>
<p># Configure a PKI domain and import the local certificate and private key file.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>pki realm domain1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-pki-realm-domain1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-pki-realm-domain1]<strong> quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>pki import-certificate local realm domain1 pem filename restconf_local.pem</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>pki import rsa-key-pair restconf-key pem restconf.pem</strong>  //Skip this step if the private key file is generated on the local device.</pre>
<p># Import the CA certificate of the HTTP client to verify the local certificate of the HTTP client.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>pki import-certificate ca realm domain1 pem filename restconf_ca.pem</strong></pre>
<p># Configure an SSL policy and bind it to the PKI domain.</p>
</p><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ssl policy policy1</strong>
[<span><span class="keyword">*</span></span><span class="keyword">HUAWEI</span>-ssl-policy-policy1]<strong> </strong><strong>pki-domain domain1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-ssl-policy-policy1] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-ssl-policy-policy1]<strong> quit</strong></pre>
</p></li><li><span>Enable the HTTP server function on the device.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>http</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-http] <strong>service restconf</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-http-service-restconf] <strong>secure-server enable</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-http-service-restconf] <strong>server-source</strong> <strong><span>100ge</span><span>1/0/1</span></strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-http-service-restconf] <strong>ssl-policy policy1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-http-service-restconf] <strong>ssl-verify peer</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-http-service-restconf] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-http-service-restconf] <strong>quit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>-http] <strong>quit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001512851258__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Check the TCP connection status of RESTCONF communication.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>display tcp status</strong>
2020-03-09 18:17:51.519
-----------------------------------------------------------------------------------
Cid        SocketID  Local-Addr:Port       Foreign-Addr:Port     State         VPNName
-----------------------------------------------------------------------------------
0x80C82724        1  0.0.0.0:23            0.0.0.0:0             LISTEN        --
0x82D804A7        2  0.0.0.0:443           0.0.0.0:0             LISTEN        --
0x80C82724        3  10.1.1.1:23           10.1.1.2:55452        ESTABLISHED   --
0x82D804A7        4  10.1.1.1:443          10.1.1.2:54152        ESTABLISHED   --
-----------------------------------------------------------------------------------</pre>
<p>The command output shows that the RESTCONF connection service with port 443 has been established on the RESTCONF server.</p>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001512851258__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li>RESTCONF server<pre class="screen">#                                                                                                                                   
pki realm domain1
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.1.1.1 24
#
ssl policy policy1
  pki-domain domain1
#
aaa
  local-user huawei123 password irreversible-cipher $1d$vi0^!e4S`K$+$7-&amp;aq_=QiN[@X,$$U"C_I023We<font style="font-size:8pt" Face="Courier New" >~</font>C+G}-<font style="font-size:8pt" Face="Courier New" >~</font>EVwzM$
  local-user huawei123 service-type http
<strong>  </strong>local-user huawei123 privilege level 3 
#
http
 service restconf
  secure-server enable
  server-source <span>100ge</span><span>1/0/1</span>
  ssl-policy policy1
  ssl-verify peer
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_restconf_cfg_0019.html">Configuring RESTCONF for Device Management
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_restconf_cfg_0020.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_restconf_cfg_0025.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>