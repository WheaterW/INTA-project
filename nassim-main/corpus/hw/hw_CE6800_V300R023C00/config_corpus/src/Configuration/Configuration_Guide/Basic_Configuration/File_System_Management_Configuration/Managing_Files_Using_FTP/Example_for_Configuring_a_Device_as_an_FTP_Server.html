
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a Device as an FTP Server">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_file_cfg_0008.html">
<meta name="DC.Relation" scheme="URI" content="vrp_file_cfg_0010.html">
<meta name="DC.Relation" scheme="URI" content="vrp_file_cfg_0012.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="FTP">
<meta name="featurename" content="File System Management">
<meta name="featuretype" content="Basic Configuration">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="FTP">
<meta name="featurename" content="File System Management">
<meta name="featuretype" content="Basic Configuration">
<meta name="featurename" content="FTP">
<meta name="featurename" content="SCP">
<meta name="featurename" content="SFTP">
<meta name="featurename" content="TFTP">
<meta name="featurename" content="File System Management">
<meta name="featuretype" content="Basic Configuration">
<meta name="featuretype" content="Basic Configuration">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001564110697">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring a Device as an FTP Server</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001564110697"></a><a name="EN-US_TASK_0000001564110697"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a Device as an FTP Server</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001564110697__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>In <a href="#EN-US_TASK_0000001564110697__fig_dc_cfg_file_002001">Figure 1</a>, PC1 connects to the device at 10.136.23.5. The device needs to be upgraded. To be specific, the device needs to function as the FTP server so that the system software can be uploaded from PC1 to the device and the configuration file of the device can be saved to PC1 for backup. In addition, an ACL policy needs to be configured so that only PC1 can access the FTP server.</p>
<div class="fignone" id="EN-US_TASK_0000001564110697__fig_dc_cfg_file_002001"><a name="EN-US_TASK_0000001564110697__fig_dc_cfg_file_002001"></a><a name="fig_dc_cfg_file_002001"></a><span class="figcap"><b>Figure 1 </b>Network diagram for configuring a device as an FTP server</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 represents <span>100GE</span><span>1/0/1</span>.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001512831086.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001564110697__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li>Configure the FTP server function for the device and configure information about an FTP user, including the source address, user name, password, user privilege level, service type, and authorized directory.</li><li>Configure access permissions on the FTP server.</li><li>Save the current configuration file on the device.</li><li>Log in to the FTP server from PC<span>1</span>.</li><li>Upload <span>the system software</span> to the device and <span>back up the configuration file of the device to PC<span>1</span></span>.</li></ol>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001564110697__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Precautions</h4><p>In insecure network environments, you are advised to use a secure password authentication mode, encryption authentication algorithm, or protocol. For details about secure configuration examples, see <a href="vrp_file_cfg_0016.html">Example for Configuring a Device as an SFTP Server (IPv4)</a>.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001564110697__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Run the <strong>install feature-software WEAKEA</strong> command in the user view to install the weak security algorithm/protocol feature package (WEAKEA).</span></li><li><span>Configure an IP address for the FTP server.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt;<strong> system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname FTP_Server</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>FTP_Server] <strong>interface <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span>SSH Server-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>FTP_Server-<span>100GE</span><span>1/0/1</span>] <strong>ip address 10.136.23.5 255.255.255.0</strong>
[<span class="keyword">*</span>FTP_Server-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>FTP_Server] <strong>commit</strong></pre>
</p></li><li><span>Configure the FTP server function for the device and configure information about an FTP user.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>FTP_Server]<strong> ftp server enable</strong>
[<span class="keyword">*</span>FTP_Server]<strong> ftp server source </strong><strong>all-interface</strong>
[<span class="keyword">*</span>FTP_Server] <strong>aaa</strong>
[<span class="keyword">*</span>FTP_Server-aaa]<strong> local-user admin1234 password</strong>
Please configure the login password (8-128)
It is recommended that the password consist of four types of characters, including lowercase letters, uppercase letters, numerals and special characters. 
Please enter password:                                      
Please confirm password:                               
Info: Add a new user.
[<span class="keyword">*</span>FTP_Server-aaa]<strong> local-user admin1234 privilege level 3</strong>
[<span class="keyword">*</span>FTP_Server-aaa]<strong> local-user admin1234 service-type ftp</strong>
<span>[<span class="keyword">*</span>FTP_Server-aaa]<strong> local-user admin1234 ftp-directory <span><strong><span>flash</span></strong></span>:/</strong></span>
[<span class="keyword">*</span>FTP_Server-aaa]<strong> quit</strong>
[<span class="keyword">*</span>FTP_Server] <strong>commit</strong></pre>
</p></li><li><span>Configure access permissions on the FTP server.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>FTP_Server] <strong>acl number 2001</strong>
[<span class="keyword">*</span>FTP_Server-acl4-basic-2001] <strong>rule permit source 10.136.23.10 0 </strong>
[<span class="keyword">*</span>FTP_Server-acl4-basic-2001] <strong>rule deny source 10.136.23.20 0</strong>
[<span class="keyword">*</span>FTP_Server-acl4-basic-2001] <strong>quit</strong>
[<span class="keyword">*</span>FTP_Server] <strong>ftp server acl 2001</strong>
[<span class="keyword">*</span>FTP_Server] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>FTP_Server]<strong> quit</strong></pre>
</p></li><li><span>Save the current configuration file on the device.</span><p><pre class="screen">&lt;FTP_Server&gt;<strong> save</strong></pre>
</p></li><li><span>Log in to the FTP server from PC<span>1</span> using the user name <strong>admin1234</strong> and password <strong>YsHsjx_202206</strong>. <span>Set the file transfer mode to binary.</span></span><p><p>Assume that PC1 runs the Windows operating system.</p>
<pre class="screen"><samp class="codeph">C:\Documents and Settings\Administrator&gt; <strong>ftp 10.136.23.5</strong></samp>
<samp class="codeph">Connected to 10.136.23.5.</samp>
<samp class="codeph">220 FTP service ready.</samp>
<samp class="codeph">User (10.136.23.5:(none)): admin1234</samp>
<samp class="codeph">331 Password required for admin1234.</samp>
<samp class="codeph">Password:</samp>
<samp class="codeph">230 User logged in.</samp>
<samp class="codeph"><span>ftp&gt; <strong>binary</strong></span></samp>
<samp class="codeph"><span>200 Type set to I.</span></samp>
<samp class="codeph">ftp&gt;</samp></pre>
</p></li><li><span>Upload the system software to the device and back up the configuration file of the device to PC1.</span><p><p># Upload the system software to the device.</p>
<pre class="screen">ftp&gt; <strong>put devicesoft.cc</strong>
200 Port command okay.
150 Opening BINARY mode data connection for <span>/</span><span>devicesoft.cc</span>
226 Transfer complete.
<samp class="codeph">ftp: <span>107973953</span> bytes sent in <span>151.05</span>Seconds 560.79Kbytes/sec.</samp></pre>
<p># Back up the configuration file.</p>
<pre class="screen">ftp&gt; <strong>get vrpcfg.zip</strong>
200 Port command okay.
150 Opening BINARY mode data connection for <span>/</span>vrpcfg.zip.
226 Transfer complete.
<samp class="codeph">ftp: 1257 bytes received in 0.03Seconds 40.55Kbytes/sec.</samp></pre>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>When uploading or downloading files, you need to specify the FTP working directory of the client. For example, the default FTP working directory of the Windows operating system is <strong>C:\Windows\System32</strong>. Save the system software to be uploaded to this directory in advance, and the backup configuration file is also saved to this directory.</p>
</div></div>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001564110697__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Run the <strong>dir</strong> command on the FTP server to check whether the <span>system software</span> is uploaded to the FTP server.</p>
<pre class="screen">&lt;FTP_Server&gt;<strong> dir</strong>
Directory of <span><span><span>flash</span></span>:</span>/

  Idx  Attr     Size(Byte)  Date        Time<span>     </span>  FileName
<samp class="codeph">    0  -rw-             14  Mar 13 2019 14:13:38   back_time_a
    1  drw-              -  Mar 11 2019 00:58:54   logfile
    2  -rw-              4  Nov 17 2019 09:33:58   snmpnotilog.txt
    3  -rw-         11,238  Mar 12 2019 21:15:56   private-data.txt
    4  -rw-          1,257  Mar 12 2019 21:15:54   vrpcfg.zip
    5  -rw-             14  Mar 13 2019 14:13:38   back_time_b
    6  -rw-    <span>107,973,953</span>  Mar 13 2019 14:24:24   <strong>devicesoft.cc</strong>
    7  drw-              -  Oct 31 2019 10:20:28   sysdrv
    8  drw-              -  Feb 21 2019 17:16:36   compatible
    9  drw-              -  Feb 09 2019 14:20:10   selftest
   10  -rw-         19,174  Feb 20 2019 18:55:32   backup.cfg
   11  -rw-         23,496  Oct 15 2019 20:59:36   <samp class="codeph">20191015</samp>.zip
   12  -rw-            588  Nov 04 2019 13:54:04   servercert.der
   13  -rw-            320  Nov 04 2019 13:54:26   serverkey.der
   14  drw-              -  Nov 04 2019 13:58:36   security
...
<span>670,092 KB total (569,904 KB free)</span></samp></pre>
<p># Access the FTP user's working directory on PC1 and check for the <strong>vrpcfg.zip</strong> file.</p>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001564110697__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><pre class="screen">#
sysname FTP_Server
# 
acl number 2001
 rule 5 permit source 10.136.23.10 0
 rule 10 deny source 10.136.23.20 0
#
ftp server enable
ftp server source all-interface
ftp server acl 2001
#
aaa
 local-user admin1234 password irreversible-cipher <span>$1d$g8wLJ`LjL!$CyE(V{3qg5DdU:PM[6=6O$UF-.fQ,Q}&gt;^)OBzgoU$</span>
 local-user admin1234 privilege level 3
 local-user admin1234 ftp-directory <span><span>flash</span></span>:
 local-user admin1234 service-type ftp
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.136.23.5 255.255.255.0
#
return</pre>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_file_cfg_0008.html">Managing Files Using FTP
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_file_cfg_0010.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_file_cfg_0012.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>