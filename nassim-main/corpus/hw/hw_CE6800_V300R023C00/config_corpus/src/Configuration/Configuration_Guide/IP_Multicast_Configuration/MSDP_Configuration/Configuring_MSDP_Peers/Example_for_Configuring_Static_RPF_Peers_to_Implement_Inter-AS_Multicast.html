
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring Static RPF Peers to Implement Inter-AS Multicast">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_msdp_cfg_0009.html">
<meta name="DC.Relation" scheme="URI" content="vrp_msdp_cfg_0014.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="MSDP">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="MSDP">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="MSDP">
<meta name="featuretype" content="IP Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130623920">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring Static RPF Peers to Implement Inter-AS Multicast</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130623920"></a><a name="EN-US_TASK_0000001130623920"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring Static RPF Peers to Implement Inter-AS Multicast</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001130623920__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>Two ASs exist on the network shown in <a href="#EN-US_TASK_0000001130623920__fig_dc_vrp_multicast_cfg_007401">Figure 1</a>. Each AS contains at least one PIM-SM domain, and each PIM-SM domain may contain one multicast source and receiver, or none at all. It is required that the receiver in domain PIM-SM2 be capable of receiving multicast data sent by both S1 in domain PIM-SM1 and S2 in domain PIM-SM3 without changing the unicast topology.</p>
<div class="fignone" id="EN-US_TASK_0000001130623920__fig_dc_vrp_multicast_cfg_007401"><a name="EN-US_TASK_0000001130623920__fig_dc_vrp_multicast_cfg_007401"></a><a name="fig_dc_vrp_multicast_cfg_007401"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring static RPF peers to implement inter-AS multicast</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1, interface2, and interface3 represent <span>100GE</span><span>1/0/1</span>, <span>100GE</span><span>1/0/2</span>, and <span>100GE</span><span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001216726426.png"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Interface IP address</caption><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="17.47799067840497%" id="mcps1.3.1.4.2.4.1.1" liSelected="liSelected"><p>Device</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="29.23355774210254%" id="mcps1.3.1.4.2.4.1.2" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="53.28845157949249%" id="mcps1.3.1.4.2.4.1.3" liSelected="liSelected"><p>IP Address</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="3" valign="top" width="17.47799067840497%" headers="mcps1.3.1.4.2.4.1.1 "><p>DeviceA</p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="29.23355774210254%" headers="mcps1.3.1.4.2.4.1.2 "><p><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" valign="top" width="53.28845157949249%" headers="mcps1.3.1.4.2.4.1.3 "><p>192.168.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.1 "><p><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.2 "><p>192.168.4.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.1 "><p>Loopback0</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.2 "><p>1.1.1.1/32</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" valign="top" width="17.47799067840497%" headers="mcps1.3.1.4.2.4.1.1 "><p>DeviceB</p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="29.23355774210254%" headers="mcps1.3.1.4.2.4.1.2 "><p><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" valign="top" width="53.28845157949249%" headers="mcps1.3.1.4.2.4.1.3 "><p>192.168.5.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.1 "><p><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.2 "><p>192.168.4.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.1 "><p><span>100GE</span><span>1/0/3</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.2 "><p>10.110.1.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" valign="top" width="17.47799067840497%" headers="mcps1.3.1.4.2.4.1.1 "><p>DeviceC</p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="29.23355774210254%" headers="mcps1.3.1.4.2.4.1.2 "><p><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" valign="top" width="53.28845157949249%" headers="mcps1.3.1.4.2.4.1.3 "><p>192.168.1.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.1 "><p><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.2 "><p>192.168.2.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" valign="top" width="17.47799067840497%" headers="mcps1.3.1.4.2.4.1.1 "><p>DeviceD</p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="29.23355774210254%" headers="mcps1.3.1.4.2.4.1.2 "><p><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" valign="top" width="53.28845157949249%" headers="mcps1.3.1.4.2.4.1.3 "><p>192.168.3.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.1 "><p><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.2 "><p>192.168.2.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.1 "><p><span>100GE</span><span>1/0/3</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.2 "><p>10.110.2.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" valign="top" width="17.47799067840497%" headers="mcps1.3.1.4.2.4.1.1 "><p>DeviceE</p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="29.23355774210254%" headers="mcps1.3.1.4.2.4.1.2 "><p><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" valign="top" width="53.28845157949249%" headers="mcps1.3.1.4.2.4.1.3 "><p>192.168.5.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.1 "><p><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.2 "><p>192.168.6.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.1 "><p>Loopback0</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.2 "><p>3.3.3.3/32</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" valign="top" width="17.47799067840497%" headers="mcps1.3.1.4.2.4.1.1 "><p>DeviceF</p>
</td>
<td class="cellrowborder" valign="top" width="29.23355774210254%" headers="mcps1.3.1.4.2.4.1.2 "><p><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" valign="top" width="53.28845157949249%" headers="mcps1.3.1.4.2.4.1.3 "><p>192.168.3.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.1 "><p>Loopback0</p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.2 "><p>2.2.2.2/32</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="3" valign="top" width="17.47799067840497%" headers="mcps1.3.1.4.2.4.1.1 "><p>DeviceG</p>
<p></p>
<p></p>
</td>
<td class="cellrowborder" valign="top" width="29.23355774210254%" headers="mcps1.3.1.4.2.4.1.2 "><p><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" valign="top" width="53.28845157949249%" headers="mcps1.3.1.4.2.4.1.3 "><p>10.110.3.1/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.1 "><p><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.2 "><p>192.168.6.2/24</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.1 "><p><span>100GE</span><span>1/0/3</span></p>
</td>
<td class="cellrowborder" valign="top" headers="mcps1.3.1.4.2.4.1.2 "><p>10.110.4.1/24</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130623920__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>Incorrect configurations of static RPF peers may lead to SA message looping. As such, exercise caution when configuring static RPF peers.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130623920__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>Set up MSDP peer relationships between RPs in PIM-SM domains. After static RPF peers are set up between MSDP peers, RPF check does not need to be performed for SA messages sent from the static RPF peers. As such, inter-AS multicast source information can be shared without changing the unicast topology.</p>
<ol><li><p>Enable the multicast function and configure interface IP addresses on devices. Configure OSPF in each AS and configure EBGP between them. Configure BGP and OSPF to import routes from each another.</p>
</li><li><p>Enable PIM-SM on each interface. Configure Loopback0 as both a C-BSR and a C-RP: Loopback0 interfaces on DeviceA, DeviceF, and DeviceE function as the C-BSRs and the C-RPs for the PIM-SM domains where they reside.</p>
</li><li><p>Set up MSDP peer relationships between RPs in PIM-SM domains. Establish an MSDP peer relationship between DeviceA and DeviceF, and between DeviceA and DeviceE.</p>
</li><li><p>Specify static RPF peers for MSDP peers. Specify DeviceE and DeviceF as static RPF peers of DeviceA, and specify DeviceA as the only static RPF peer for DeviceE and DeviceF.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001130623920__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enable the multicast function, assign an IP address to each interface, and configure OSPF as a unicast routing protocol for interworking in each AS.</span><p><p># Configure DeviceC. The configurations of other devices are similar to the configuration of DeviceC. For detailed configurations, see Configuration Scripts.</p>
<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceC</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>multicast routing-enable</strong> 
[<span class="keyword">*</span>DeviceC] <strong>interface <span>100ge</span></strong> <strong><span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>ip address 192.168.2.2 24</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC] <strong>interface <span>100ge</span></strong> <strong><span>1/0/1</span></strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong>undo portswitch</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong>ip address 192.168.1.2 24</strong>
[<span class="keyword">*</span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC] <strong>ospf 1</strong>
[<span class="keyword">*</span>DeviceC-ospf-1] <strong>area 0.0.0.0</strong>
[<span class="keyword">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong>network 192.168.1.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong>network 192.168.2.0 0.0.0.255</strong>
[<span class="keyword">*</span>DeviceC-ospf-1-area-0.0.0.0] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC-ospf-1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceC] <strong>commit</strong></pre>
</p></li><li><span>Enable PIM-SM on each interface.</span><p><p># Enable PIM-SM on each involved interface of DeviceA. The configurations of other devices are similar to the configuration of DeviceA. For detailed configurations, see Configuration Scripts.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword"></span><span class="keyword"></span>DeviceA] <strong>interface <span>100ge</span> <span></span></strong><strong><span>1/0/1</span></strong>
[<span class="keyword">*</span><span class="keyword"></span><span class="keyword"></span>DeviceA-<span>100GE</span><span>1/0/1</span><span></span>] <strong>pim sm</strong>
[<span class="keyword"></span><span class="keyword"></span><span class="keyword">*</span><span class="keyword"></span><span class="keyword"></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword"></span><span class="keyword"></span><span class="keyword">*</span><span class="keyword"></span><span class="keyword"></span>DeviceA] <strong>interface <span>100ge</span> <span>1/0/2</span><span></span></strong>
[<span class="keyword">*</span><span class="keyword"></span><span class="keyword"></span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>pim sm</strong>
[<span class="keyword">*</span><span class="keyword"></span><span class="keyword"></span>DeviceA-<span>100GE</span><span>1/0/2</span><span></span>] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword"></span><span class="keyword"></span>DeviceA] <strong>commit</strong></pre>
<p># Configure a BSR boundary on <span>100GE</span><span>1/0/1</span> of DeviceB, <span>100GE</span><span>1/0/2</span> of DeviceC, <span>100GE</span><span>1/0/2</span> of DeviceD, and <span>100GE</span><span>1/0/1</span> of DeviceE. The configurations of DeviceC, DeviceD, and DeviceE are similar to the configuration of DeviceB. For detailed configurations, see Configuration Scripts.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device<span class="keyword"></span><span class="keyword"></span>B] <strong>interface <span>100ge</span> <span></span></strong><strong><span>1/0/1</span></strong>
[<span class="keyword">*</span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>pim bsr-boundary</strong>
[<span class="keyword">*</span>Device<span class="keyword"></span><span class="keyword"></span>B-<span>100GE</span><span>1/0/1</span><span></span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB<span></span>] <strong>commit</strong></pre>
</p></li><li><span>Enable IGMP on the interface connecting to the host.</span><p><pre class="screen">[<span class="keyword"></span><span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong>interface <span>100ge</span></strong> <strong><span>1/0/3</span></strong>
[<span class="keyword"></span><span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/3</span>] <strong>igmp enable</strong>
[<span class="keyword"></span><span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword"></span><span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceG] <strong>interface <span>100ge</span> <span>1/0/3</span></strong>
[<span class="keyword"></span><span class="keyword">*</span>DeviceG-<span>100GE</span><span>1/0/3</span>] <strong>igmp enable</strong>
[<span class="keyword"></span><span class="keyword">*</span>DeviceG-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword"></span><span class="keyword">*</span>DeviceG] <strong>commit</strong></pre>
</p></li><li><span>Configure Loopback0 as both a C-BSR and a C-RP.</span><p><p># Create Loopback0 and configure it as both a C-BSR and a C-RP on DeviceA, DeviceF, and DeviceE. The configurations of DeviceF and DeviceE are similar to the configuration of DeviceA. For detailed configurations, see Configuration Scripts.</p>
<pre class="screen">[<span class="keyword"></span><span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface loopback 0</strong>
[<span class="keyword"></span><span class="keyword">*</span>DeviceA-LoopBack0] <strong>ip address 1.1.1.1 255.255.255.255</strong>
[<span class="keyword">*</span><span class="keyword"></span>DeviceA-LoopBack0] <strong>pim sm</strong>
[<span class="keyword">*</span><span class="keyword"></span>DeviceA-LoopBack0] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword"></span>DeviceA] <strong>pim</strong>
[<span class="keyword">*</span><span class="keyword"></span>DeviceA-pim] <strong>c-bsr loopback 0</strong>
[<span class="keyword">*</span><span class="keyword"></span>DeviceA-pim] <strong>c-rp loopback 0</strong>
[<span class="keyword">*</span><span class="keyword"></span>DeviceA-pim] <strong>quit</strong>
[<span class="keyword"></span><span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
</p></li><li><span>Configure static RPF peers.</span><p><p># Configure DeviceF and DeviceE as static RPF peers of DeviceA.</p>
<pre class="screen">[<span class="keyword"></span><span class="keyword"></span><span class="keyword"></span><span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>ip ip-prefix list-df permit 192.168.0.0 16 greater-equal 16 less-equal 32</strong>
[<span class="keyword">*</span>Device<span class="keyword"></span><span class="keyword"></span>A] <strong>msdp</strong>
[<span class="keyword"></span><span class="keyword"></span><span class="keyword">*</span>Device<span class="keyword"></span><span class="keyword"></span>A-msdp] <strong>peer 192.168.3.2 connect-interface <span>100ge</span> <span>1/0/1</span> <span></span></strong>
[<span class="keyword">*</span>Device<span class="keyword"></span><span class="keyword"></span>A-msdp] <strong>peer 192.168.5.1 connect-interface <span>100ge</span> <span>1/0/1</span> <span></span></strong>
[<span class="keyword">*</span>DeviceA-msdp] <strong>static-rpf-peer 192.168.3.2 rp-policy list-df</strong>
[<span class="keyword"></span><span class="keyword"></span><span class="keyword">*</span>Device<span class="keyword"></span><span class="keyword"></span>A-msdp] <strong>static-rpf-peer 192.168.5.1 rp-policy list-df </strong>
[<span class="keyword">*</span>Device<span class="keyword"></span><span class="keyword"></span>A-msdp] <strong>quit</strong>
[<span class="keyword"></span><span class="keyword"></span><span class="keyword">*</span>DeviceA<span class="keyword"></span>] <strong>commit</strong></pre>
<p># Configure DeviceA as the static RPF peer of DeviceF and DeviceE. The configuration of DeviceE is similar to that of DeviceF. For detailed configuration, see Configuration Scripts.</p>
<pre class="screen">[<span class="keyword"></span><span class="keyword"></span><span class="keyword"></span><span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceF] <strong>ip ip-prefix list-c permit 192.168.0.0 16 greater-equal 16 less-equal 32</strong>
[<span class="keyword">*</span>DeviceF] <strong>msdp</strong>
[<span class="keyword">*</span>DeviceF-msdp] <strong>peer 192.168.1.1 connect-interface <span>100ge</span> <span>1/0/1</span> <span></span></strong>
[<span class="keyword">*</span>Device<span class="keyword"></span><span class="keyword"></span>F-msdp] <strong>static-rpf-peer 192.168.1.1 rp-policy list-c</strong>
[<span class="keyword">*</span>DeviceF-msdp] <strong>quit</strong>
[<span class="keyword">*</span>Device<span class="keyword"></span><span class="keyword"></span>F] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001130623920__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Run the <strong>display bgp peer</strong> command to check BGP peer relationships established between devices. No information is displayed on DeviceA, indicating that no BGP peer relationship is established between DeviceA and DeviceE or between DeviceA and DeviceF.</p>
<p># Run the <strong>display msdp brief</strong> command to check MSDP peer relationships established between devices. When multicast source S1 in the domain PIM-SM1 sends multicast information, receivers in domains PIM-SM2 and PIM-SM3 can receive it. The MSDP peer information on DeviceA, DeviceF, and DeviceE is displayed as follows:</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device<span class="keyword"></span><span class="keyword"></span>A] <strong>display msdp brief</strong>
MSDP Peer Brief Information of VPN instance: public net
  Configured   Up           Listen       Connect      Shutdown     Down
  2            2            0            0            0            0

  Peer's Address     State     Up/Down time    AS     SA Count   Reset Count
  192.168.3.2        Up        01:07:08        ?      8          0
  192.168.5.1        Up        00:16:39        ?      13         0

[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceF] <strong>display msdp brief</strong>
MSDP Peer Brief Information of VPN instance: public net
  Configured   Up           Listen       Connect      Shutdown     Down
  1            1            0            0            0            0

  Peer's Address     State     Up/Down time    AS     SA Count   Reset Count
  192.168.1.1        Up        01:07:09        ?      8          0

[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>Device<span class="keyword"></span>E] <strong>display msdp brief</strong>
MSDP Peer Brief Information of VPN instance: public net
  Configured   Up           Listen       Connect      Shutdown     Down
  1            1            0            0            0            0

  Peer's Address     State     Up/Down time    AS     SA Count   Reset Count
  192.168.4.1        Up        00:16:40        ?      13         0</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001130623920__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
multicast routing-enable
#
ip ip-prefix list-df index 10 permit 192.168.0.0 16 greater-equal 16 less-equal 32
#
interface <span>100GE</span><span>1/0/1</span><span></span>
 undo portswitch
 ip address 192.168.1.1 255.255.255.0
 pim sm
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.4.1 255.255.255.0
 pim sm
#
interface LoopBack0
 ip address 1.1.1.1 255.255.255.255
 pim sm
#
pim
 c-bsr LoopBack0
 c-rp LoopBack0
#
ospf 1
 area 0.0.0.0
  network 192.168.1.0 0.0.0.255
  network 192.168.4.0 0.0.0.255
  network 1.1.1.1 0.0.0.0
#
msdp
 peer 192.168.3.2 connect-interface <span>100GE</span><span>1/0/1</span> <span></span>
 peer 192.168.5.1 connect-interface <span>100GE</span><span>1/0/1</span> <span></span>
 static-rpf-peer 192.168.3.2 rp-policy list-df
 static-rpf-peer 192.168.5.1 rp-policy list-df
#
return</pre>
</li><li><p><span class="keyword">DeviceB</span></p>
<pre class="screen">#
sysname <span class="keyword">DeviceB</span>
#
multicast routing-enable
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.110.1.1 255.255.255.0
 pim sm
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.4.2 255.255.255.0
 pim sm
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 192.168.5.2 255.255.255.0
 pim bsr-boundary
 pim sm
#
bgp 100
 router-id 10.1.1.3
 peer 192.168.5.1 as-number 200
 #
 ipv4-family unicast
  import-route ospf 1
  peer 192.168.5.1 enable
#
ospf 1
 import-route bgp
 area 0.0.0.0
  network 10.110.1.0 0.0.0.255
  network 192.168.4.0 0.0.0.255
  network 192.168.5.0 0.0.0.255
#
return</pre>
</li><li><p><span class="keyword">DeviceC</span></p>
<pre class="screen">#
sysname <span class="keyword">DeviceC</span>
#
multicast routing-enable
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.1.2 255.255.255.0
 pim sm
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.2.2 255.255.255.0
 pim bsr-boundary
 pim sm
#
bgp 100
 router-id 10.1.1.2
 peer 192.168.2.1 as-number 200
 #
 ipv4-family unicast
  import-route ospf 1
  peer 192.168.2.1 enable
#
ospf 1
 import-route bgp
 area 0.0.0.0
  network 192.168.1.0 0.0.0.255
  network 192.168.2.0 0.0.0.255
#
return</pre>
</li><li><p><span class="keyword">DeviceD</span></p>
<pre class="screen">#
sysname <span class="keyword">DeviceD</span>
#
multicast routing-enable
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 10.110.2.1 255.255.255.0
 pim sm
 igmp enable
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.2.1 255.255.255.0
 pim bsr-boundary
 pim sm
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.3.1 255.255.255.0
 pim sm
#
bgp 200
 router-id 10.2.2.1
 peer 192.168.2.2 as-number 100
 #
 ipv4-family unicast
  import-route ospf 1
  peer 192.168.2.2 enable
#
ospf 1
 import-route bgp
 area 0.0.0.0
  network 10.110.2.0 0.0.0.255
  network 192.168.2.0 0.0.0.255
  network 192.168.3.0 0.0.0.255
#
return</pre>
</li><li><p>DeviceE</p>
<pre class="screen">#
sysname DeviceE
#
multicast routing-enable
#
ip ip-prefix list-c index 10 permit 192.168.0.0 16 greater-equal 16 less-equal 32
#
interface <span>100GE</span><span>1/0/1</span><span></span>
 undo portswitch
 ip address 192.168.5.1 255.255.255.0
 pim sm
#
interface LoopBack0
 ip address 3.3.3.3 255.255.255.255
 pim sm
#
pim
 c-bsr LoopBack0
 c-rp LoopBack0
#
ospf 1
 area 0.0.0.0
  network 192.168.5.0 0.0.0.255
  network 3.3.3.3 0.0.0.0
#
msdp
 peer 192.168.4.1 connect-interface <span>100GE</span> <span>1/0/2</span> <span></span>
 static-rpf-peer 192.168.4.1 rp-policy list-c
#
return</pre>
</li><li><p>DeviceF</p>
<pre class="screen">#
sysname DeviceF
#
multicast routing-enable
#
ip ip-prefix list-c index 10 permit 192.168.0.0 16 greater-equal 16 less-equal 32
#
interface <span>100GE</span><span>1/0/1</span><span></span>
 undo portswitch
 ip address 192.168.3.2 255.255.255.0
 pim sm
#
interface LoopBack0
 ip address 2.2.2.2 255.255.255.255
 pim sm
#
pim
 c-bsr LoopBack0
 c-rp LoopBack0
#
ospf 1
 area 0.0.0.0
  network 192.168.3.0 0.0.0.255
  network 2.2.2.2 0.0.0.0
#
msdp
 peer 192.168.1.1 connect-interface <span>100GE</span><span>1/0/1</span> <span></span>
 static-rpf-peer 192.168.1.1 rp-policy list-c
#
return</pre>
</li><li><p><span class="keyword">Device</span>G</p>
<pre class="screen">#
sysname <span class="keyword">Device</span>G
#
multicast routing-enable
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 10.110.3.1 255.255.255.0
 pim sm
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ip address 10.110.4.1 255.255.255.0
 pim sm
 igmp enable
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 192.168.6.2 255.255.255.0
 pim sm
#
ospf 1
 area 0.0.0.0
  network 10.110.3.0 0.0.0.255
  network 10.110.4.0 0.0.0.255
  network 192.168.6.0 0.0.0.255
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_msdp_cfg_0009.html">Configuring MSDP Peers
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_msdp_cfg_0014.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>