
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring a Policy for Accepting BGP4+ Routes">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp6_cfg_0028.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp6_cfg_0030.html">
<meta name="DC.Relation" scheme="URI" content="vrp_bgp6_cfg_0078.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="BGP4+">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="BGP4+">
<meta name="featuretype" content="IP Routing">
<meta name="featurename" content="BGP4+">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001130782216">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Configuring a Policy for Accepting BGP4+ Routes</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001130782216"></a><a name="EN-US_TASK_0000001130782216"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring a Policy for Accepting BGP4+ Routes</h1>
<div class="taskbody"><div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001130782216__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p"><p>Before configuring a policy for accepting BGP4+ routes, you have completed the following task:</p>
<ul><li><a href="vrp_bgp6_cfg_0006.html">Configure basic BGP4+ functions</a>.</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001130782216__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>BGP4+ can apply a routing policy to routes received from all peers or peer groups, or only those received from a specified peer or peer group. If multiple filtering policies are configured, BGP4+ accepts only those routes that match all the configured policies.</p>
</div></div>
<div class="steps-unordered"><a name="EN-US_TASK_0000001130782216__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ul><li><span>Configure BGP4+ to filter routes received from all peers or peer groups.</span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Enter the BGP view.</span><p><pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></pre>
</p></li><li class="substepexpand"><span>Enter the IPv6 unicast address family view.</span><p><pre class="screen"><a href="cmdqueryname=ipv6-family+unicast"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>unicast</span></strong></pre>
</p></li><li class="substepexpand"><span>Configure the device to filter all received BGP4+ routes.</span><p><pre class="screen"><a href="cmdqueryname=filter-policy+acl6-name+ipv6-prefix"><b><span class="cmdname">filter-policy</span></b></a> { <i><span class="varname">acl6-number</span></i> | <strong><span>acl6-name</span></strong> <i><span class="varname">acl6-name</span></i> | <strong><span>ipv6-prefix</span></strong> <i><span class="varname">ipv6-prefix-name</span></i> } <a href="cmdqueryname=import"><b><span class="cmdname">import</span></b></a></pre>
<p>Only the matched routes are accepted by BGP4+ and added to the BGP4+ routing table.</p>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001130782216__en-us_task_0234857734_screen14848162118611"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001130782216__en-us_task_0234857734_cmdname1784862115612">commit</span></b></a></pre>
</p></li></ol>
</li><li><span>Apply a routing policy to the routes received from a specified peer or peer group.</span><ol><li class="substepexpand"><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li class="substepexpand"><span>Configure the device to filter the routes received from a specified peer or peer group based on any of the following filters:</span><p><ul><li>Based on a basic ACL<ol type="a"><li>Enter the ACL view.<pre class="screen"><span><a href="cmdqueryname=acl+ipv6+name+basic+number"><b><span class="cmdname">acl ipv6</span></b></a> { <strong><span>name</span></strong> <i><span class="varname">basic-acl6-name</span></i> <strong><span>basic</span></strong> | [ <strong><span>number</span></strong> ] <i><span class="varname">basic-acl6-number</span></i> }</span></pre>
</li><li><p>Configure an ACL rule.</p>
<pre class="screen"><span><a href="cmdqueryname=rule+name+deny+permit+fragment+source+any+time-range"><b><span class="cmdname">rule</span></b></a> [ <i><span class="varname">rule-id</span></i> ] [ <strong><span>name</span></strong> <i><span class="varname">rule-name</span></i> ] { <strong><span>deny</span></strong> | <strong><span>permit</span></strong> } [ <strong><span>fragment</span></strong> | <strong><span>source</span></strong> { <i><span class="varname">source-ipv6-address</span></i> <span>{ </span><i><span class="varname">prefix-length</span></i><span> | <i><span class="varname">source-wildcard</span></i> }</span> | <i><span class="varname">source-ipv6-address</span></i>/<i><span class="varname">prefix-length</span></i> | <strong><span>any</span></strong> } | <strong><span>time-range</span></strong> <i><span class="varname">time-name</span></i> | <strong><span>vpn-instance</span></strong> <i><span class="varname">vpn-instance-name</span></i> ] <sup>*</sup></span></pre>
<p>When the <a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> command is used to configure a filtering rule for a named ACL, only the configurations specified by <strong><span>source</span></strong> and <strong><span>time-range</span></strong> take effect.</p>
<div class="p">When a filter-policy of a routing protocol is used to filter routes:<ul><li><p>If the action specified in an ACL rule is <strong>permit</strong>, a route matching the rule will be accepted or advertised by the device.</p>
</li><li><p>If the action specified in an ACL rule is <strong>deny</strong>, a route matching the rule will not be accepted or advertised by the device.</p>
</li><li><p>If a route has not matched any ACL rules, the route will not be accepted or advertised by the device.</p>
</li><li><p>If an ACL does not contain any rules, none of the routes matched against the filter-policy that uses this ACL will be accepted or advertised by the device.</p>
</li><li><p>Routes can be filtered using a blacklist or whitelist:</p>
<p>Filtering using a blacklist: Configure a rule with a smaller ID and specify the action <strong>deny</strong> in this rule to filter out the unwanted routes. Then, configure another rule with a larger ID in the same ACL and specify the action <strong>permit</strong> in this rule to advertise or accept the other routes.</p>
<p>Filtering using a whitelist: Configure a rule with a smaller ID and specify the action <strong>permit</strong> in this rule to permit the routes to be advertised or accepted. Then, configure another rule with a larger ID in the same ACL and specify the action <strong>deny</strong> in this rule to filter out the unwanted routes.</p>
<p>If <strong>match-order</strong> is set to <strong>config</strong> for the ACL, the ACL rules are matched based on their configuration order by default. If the ACL rules are numbered with IDs, the rules are matched in ascending order of their IDs.</p>
</li></ul>
</div>
</li><li>Return to the system view.<pre class="screen"><a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</li><li>Enter the BGP view.<pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></pre>
</li><li>Enter the IPv6 unicast address family view.<pre class="screen"><a href="cmdqueryname=ipv6-family+unicast"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>unicast</span></strong></pre>
</li><li>Configure BGP4+ to filter the routes received from a specified peer or peer group.<pre class="screen"><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> | <i><span class="varname">ipv4-address</span></i> } <a href="cmdqueryname=filter-policy+import"><b><span class="cmdname">filter-policy</span></b></a> <i><span class="varname">acl-number</span></i> <strong><span>import</span></strong></pre>
<pre class="screen"><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> | <i><span class="varname">ipv4-address</span></i> } <a href="cmdqueryname=filter-policy+acl6-name+import"><b><span class="cmdname">filter-policy</span></b></a> <strong><span>acl6-name</span></strong> <i><span class="varname">acl6-name</span></i> <strong><span>import</span></strong></pre>
</li></ol>
</li><li><p>Based on an AS_Path filter:</p>
<ol type="a"><li>Enter the BGP view.<pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></pre>
</li><li>Enter the IPv6 unicast address family view.<pre class="screen"><a href="cmdqueryname=ipv6-family+unicast"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>unicast</span></strong></pre>
</li><li>Configure BGP4+ to filter the routes received from a specified peer or peer group.<pre class="screen"><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> | <i><span class="varname">ipv4-address</span></i> } <a href="cmdqueryname=as-path-filter+import"><b><span class="cmdname">as-path-filter</span></b></a> { <i><span class="varname">number</span></i> | <i><span class="varname">name</span></i> } <strong><span>import</span></strong></pre>
</li></ol>
</li><li><p>Based on a route-policy:</p>
<ol type="a"><li>Enter the BGP view.<pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></pre>
</li><li>Enter the IPv6 unicast address family view.<pre class="screen"><a href="cmdqueryname=ipv6-family+unicast"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>unicast</span></strong></pre>
</li><li>Configure BGP4+ to filter the routes received from a specified peer or peer group.<pre class="screen"><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> | <i><span class="varname">ipv4-address</span></i> } <a href="cmdqueryname=route-policy+import"><b><span class="cmdname">route-policy</span></b></a> <i><span class="varname">route-policy-name</span></i> <strong><span>import</span></strong></pre>
</li></ol>
</li><li><p>Based on a route-policy:</p>
<ol type="a"><li>Enter the BGP view.<pre class="screen"><a href="cmdqueryname=bgp"><b><span class="cmdname">bgp</span></b></a> <i><span class="varname">as-number</span></i></pre>
</li><li>Enter the IPv6 unicast address family view.<pre class="screen"><a href="cmdqueryname=ipv6-family+unicast"><b><span class="cmdname">ipv6-family</span></b></a> <strong><span>unicast</span></strong></pre>
</li><li>Configure the device to filter the routes to be received from a specified peer or peer group.<pre class="screen"><a href="cmdqueryname=peer"><b><span class="cmdname">peer</span></b></a> { <i><span class="varname">ipv6-address</span></i> | <i><span class="varname">group-name</span></i> | <i><span class="varname">ipv4-address</span></i> } <a href="cmdqueryname=route-policy+import"><b><span class="cmdname">route-policy</span></b></a> <i><span class="varname">route-policy-name</span></i> <strong><span>import</span></strong></pre>
</li></ol>
</li></ul>
<p>The import routing policy applied to a peer in a peer group can be different from that applied to the peer group. Specifically, a unique policy can be used to filter the routes to be received from each peer in the peer group.</p>
</p></li><li class="substepexpand"><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001130782216__en-us_task_0234857734_screen14848162118611_1"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001130782216__en-us_task_0234857734_cmdname1784862115612_1">commit</span></b></a></pre>
</p></li></ol>
</li></ul></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_bgp6_cfg_0028.html">Configuring BGP4+ to Accept Routes
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_bgp6_cfg_0030.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_bgp6_cfg_0078.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>