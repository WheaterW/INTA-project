
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring BFD for OSPFv3">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospfv3_cfg_0070_copy.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospfv3_cfg_0072_copy.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176742713">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring BFD for OSPFv3</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176742713"></a><a name="EN-US_TASK_0000001176742713"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring BFD for OSPFv3</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176742713__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>On the network shown in <a href="#EN-US_TASK_0000001176742713__en-us_task_0275858002_fig_dc_vrp_ospfv3_cfg_206901">Figure 1</a>:</p>
<ul><li><p>OSPFv3 runs on DeviceA, DeviceB, and DeviceC.</p>
</li><li><p>BFD is enabled in an OSPFv3 process on each of DeviceA, DeviceB, and DeviceC.</p>
</li><li><p>Service traffic is transmitted over the primary link (DeviceA -&gt; DeviceB). The link (DeviceA -&gt; DeviceC -&gt; DeviceB) functions as the backup link.</p>
</li><li><p>If the primary link fails, BFD can quickly detect the fault and notify OSPFv3 of the fault so that service traffic can be transmitted through the backup link.</p>
</li></ul>
<div class="fignone" id="EN-US_TASK_0000001176742713__en-us_task_0275858002_fig_dc_vrp_ospfv3_cfg_206901"><a name="EN-US_TASK_0000001176742713__en-us_task_0275858002_fig_dc_vrp_ospfv3_cfg_206901"></a><a name="en-us_task_0275858002_fig_dc_vrp_ospfv3_cfg_206901"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring BFD for OSPFv3</span><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1, interface 2, and interface 3 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, and <span>100GE</span> <span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001184761434.png"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176742713__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>To improve security, you are advised to deploy OSPFv3 authentication. For details, see "Configuring OSPFv3 Authentication." OSPFv3 area authentication is used as an example. For details, see "Example for Configuring Basic OSPFv3 Functions."</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176742713__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Enable basic OSPFv3 functions on each device.</p>
</li><li><p>Configure BFD for OSPFv3.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176742713__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IPv6 address to each interface involved. For detailed configurations, see <a href="#EN-US_TASK_0000001176742713__en-us_task_0275858002_postreq1488919183427">Configuration Scripts</a>.</span></li><li><span>Configure basic OSPFv3 functions.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>ospfv3</strong>
[<span><span class="keyword">*</span></span>DeviceA-ospfv3-1] <strong>router-id 1.1.1.1</strong>
[<span><span class="keyword">*</span></span>DeviceA-ospfv3-1] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceA] <strong>interface <span>100ge</span><span>1/0/1</span></strong>
[<span><span class="keyword">*</span></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ospfv3 1 area 0</strong>
[<span><span class="keyword">*</span></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceA] <strong>interface <span>100ge</span><span>1/0/2</span></strong>
[<span><span class="keyword">*</span></span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>ospfv3 1 area 0.0.0.0</strong>
[<span><span class="keyword">*</span></span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
<span>[<span><span class="keyword">*</span></span>DeviceA] <strong>commit</strong></span></pre>
<p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>ospfv3 1</strong>
[<span><span class="keyword">*</span></span>DeviceB-ospfv3-1] <strong>router-id 2.2.2.2</strong>
[<span><span class="keyword">*</span></span>DeviceB-ospfv3-1] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceB] <strong>interface <span>100ge</span><span>1/0/1</span></strong>
[<span><span class="keyword">*</span></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>ospfv3 1 area 0.0.0.0</strong>
[<span><span class="keyword">*</span></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceB] <strong>interface <span>100ge</span><span>1/0/2</span></strong>
[<span><span class="keyword">*</span></span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>ospfv3 1 area 0.0.0.0</strong>
[<span><span class="keyword">*</span></span>DeviceB-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceB] <strong>interface <span>100ge</span><span>1/0/3</span></strong>
[<span><span class="keyword">*</span></span>DeviceB-<span>100GE</span><span>1/0/3</span>] <strong>ospfv3 1 area 0.0.0.0</strong>
[<span><span class="keyword">*</span></span>DeviceB-<span>100GE</span><span>1/0/3</span>]<strong> quit</strong>
<span>[<span><span class="keyword">*</span></span>DeviceB] <strong>commit</strong></span></pre>
<p># Configure DeviceC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>ospfv3 1</strong>
[<span><span class="keyword">*</span></span>DeviceC-ospfv3-1] <strong>router-id 3.3.3.3</strong>
[<span><span class="keyword">*</span></span>DeviceC-ospfv3-1] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceC] <strong>interface <span>100ge</span><span>1/0/1</span></strong>
[<span><span class="keyword">*</span></span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong>ospfv3 1 area 0.0.0.0</strong>
[<span><span class="keyword">*</span></span>DeviceC-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceC] <strong>interface <span>100ge</span><span>1/0/2</span></strong>
[<span><span class="keyword">*</span></span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>ospfv3 1 area 0.0.0.0</strong>
[<span><span class="keyword">*</span></span>DeviceC-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
<span>[<span><span class="keyword">*</span></span>DeviceC] <strong>commit</strong></span></pre>
<p># After the preceding configurations are complete, run the <a href="cmdqueryname=display+ospfv3+peer"><b><span class="cmdname">display ospfv3 peer</span></b></a> command. This example uses DeviceA. The command output shows that neighbor relationships are set up.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display ospfv3 peer</strong>
OSPFv3 Process (1)
Total number of peer(s): 2
 Peer(s) in full state: 1
 OSPFv3 Area (0.0.0.0)
Neighbor ID      Pri State            Dead Time  Interface          Instance ID
2.2.2.2            1 Full/DR          00:00:38   <span>100GE</span><span>1/0/1</span>              0
3.3.3.3            1 Init/-           00:00:37   <span>100GE</span><span>1/0/2</span>              0</pre>
<p># Check the OSPFv3 routing table of DeviceA. The routing table should contain the routes to DeviceB and DeviceC.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display ospfv3 routing</strong>
Codes : E2 - Type 2 External, E1 - Type 1 External, IA - Inter-Area,
        N - NSSA
Flags : A - Added to URT6, LT - Locator Routing

OSPFv3 Process (1)
     Destination                                                         Metric
  Next-hop
     2001:DB8:1::/64                                                          1
       directly connected, <span>100GE</span><span>1/0/1</span>, Flags : A
     2001:DB8:2::/64                                                          2
       via FE80::3AE9:7BFF:FE31:307, <span>100GE</span><span>1/0/2</span>, Flags : A
       via FE80::3AE9:7BFF:FE21:300, <span>100GE</span><span>1/0/1</span>, Flags : A
     2001:DB8:3::/64                                                          1
       directly connected, <span>100GE</span><span>1/0/2</span>, Flags : A
     2001:DB8:4::1/64                                                         1
       via FE80::3AE9:7BFF:FE21:300, <span>100GE</span><span>1/0/1</span></pre>
<p>The command output shows that the next hop of the route to 2001:DB8:4::1/64 is <span>100GE</span> <span>1/0/1</span>. Traffic is transmitted over the primary link DeviceA -&gt; DeviceB.</p>
</p></li><li><span>Configure BFD for OSPFv3.</span><p><p># Enable BFD on DeviceA globally.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>bfd</strong>
[<span><span class="keyword">*</span></span>DeviceA-bfd] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceA] <strong>ospfv3 1</strong>
[<span><span class="keyword">*</span></span>DeviceA-ospfv3-1] <strong>bfd all-interfaces enable</strong>
[<span><span class="keyword">*</span></span>DeviceA-ospfv3-1] <strong>bfd all-interfaces min-transmit-interval 100 min-receive-interval 100 detect-multiplier 4</strong>
[<span><span class="keyword">*</span></span>DeviceA-ospfv3-1] <strong>quit</strong>
<span>[<span><span class="keyword">*</span></span>DeviceA] <strong>commit</strong></span></pre>
<p># Enable BFD on DeviceB globally.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>bfd</strong>
[<span><span class="keyword">*</span></span>DeviceB-bfd] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceB] <strong>ospfv3 1</strong>
[<span><span class="keyword">*</span></span>DeviceB-ospfv3-1] <strong>bfd all-interfaces enable</strong>
[<span><span class="keyword">*</span></span>DeviceB-ospfv3-1] <strong>bfd all-interfaces min-transmit-interval 100 min-receive-interval 100 detect-multiplier 4</strong>
[<span><span class="keyword">*</span></span>DeviceB-ospfv3-1] <strong>quit</strong>
<span>[<span><span class="keyword">*</span></span>DeviceB] <strong>commit</strong></span></pre>
<p># Enable BFD on DeviceC globally.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>bfd</strong>
[<span><span class="keyword">*</span></span>DeviceC-bfd] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceC] <strong>ospfv3 1</strong>
[<span><span class="keyword">*</span></span>DeviceC-ospfv3-1] <strong>bfd all-interfaces enable</strong>
[<span><span class="keyword">*</span></span>DeviceC-ospfv3-1] <strong>bfd all-interfaces min-transmit-interval 100 min-receive-interval 100 detect-multiplier 4</strong>
[<span><span class="keyword">*</span></span>DeviceC-ospfv3-1] <strong>quit</strong>
<span>[<span><span class="keyword">*</span></span>DeviceC] <strong>commit</strong></span></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001176742713__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># After the preceding configurations are complete, run the <a href="cmdqueryname=display+ospfv3+bfd+session"><b><span class="cmdname">display ospfv3 bfd session</span></b></a> command on DeviceA or DeviceB. You can view that the status of the BFD session is <strong>Up</strong>.</p>
<p>This example uses DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display ospfv3 bfd session </strong> - STALE
* - STALE

OSPFv3 Process (1)

 Neighbor-Id      Interface                       BFD-Status
 1.1.1.1          <span>100GE</span><span>1/0/1</span>                        Up
 3.3.3.3          <span>100GE</span><span>1/0/2</span>                        Up</pre>
<p># Run the <a href="cmdqueryname=shutdown"><b><span class="cmdname">shutdown</span></b></a> command on <span>100GE</span> <span>1/0/1</span> of DeviceB to simulate a primary link failure.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>interface <span>100ge</span><span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>shutdown</strong>
<span>[<span><span class="keyword">*</span></span>DeviceB-<span>100GE</span><span>1/0/1</span>] <strong>commit</strong></span></pre>
<p># Check the routing table on DeviceA. The command output shows that the next hop of the route to 2001:DB8:4::1/64 is changed to <span>100GE</span> <span>1/0/2</span> after the primary link fails, and traffic is switched to the backup link.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>display ospfv3 routing</strong>
Codes : E2 - Type 2 External, E1 - Type 1 External, IA - Inter-Area,
        N - NSSA
Flags : A - Added to URT6, LT - Locator Routing

OSPFv3 Process (1)
     Destination                                                         Metric
  Next-hop
     2001:DB8:2::/64                                                          2
       via FE80::3AE9:7BFF:FE31:307, <span>100GE</span><span>1/0/2</span>, Flags : A
     2001:DB8:3::/64                                                          1
       directly connected, <span>100GE</span><span>1/0/2</span>, Flags : A
     2001:DB8:4::/64                                                          3
       via FE80::3AE9:7BFF:FE31:307, <span>100GE</span><span>1/0/2</span>, Flags : A</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001176742713__en-us_task_0275858002_postreq1488919183427"></a><a name="en-us_task_0275858002_postreq1488919183427"></a><a name="EN-US_TASK_0000001176742713__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
 bfd
#
ospfv3 1
 router-id 1.1.1.1
 bfd all-interfaces enable
 bfd all-interfaces min-transmit-interval 100 min-receive-interval 100 detect-multiplier 4
 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/1</span> 
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:1::3/64
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:3::1/64
 ospfv3 1 area 0.0.0.0
#
return</pre>
</li><li><p>DeviceB</p>
<pre class="screen">#
sysname DeviceB
#
 bfd
#
ospfv3 1
 router-id 2.2.2.2
 bfd all-interfaces enable
 bfd all-interfaces min-transmit-interval 100 min-receive-interval 100 detect-multiplier 4
 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:1::2/64
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:2::1/64
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:4::1/64
 ospfv3 1 area 0.0.0.0
#
return</pre>
</li><li><p>DeviceC</p>
<pre class="screen">#
sysname DeviceC
#
ospfv3 1
 router-id 3.3.3.3
 bfd all-interfaces enable
 bfd all-interfaces min-transmit-interval 100 min-receive-interval 100 detect-multiplier 4
 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:2::2/64
 ospfv3 1 area 0.0.0.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:3::3/64
 ospfv3 1 area 0.0.0.0
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_ospfv3_cfg_0070_copy.html">Configuring BFD for OSPFv3
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_ospfv3_cfg_0072_copy.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>