
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Configuring an ICMP Test">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_nqa_cfg_0009.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_nqa_cfg_0011.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="NQA">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="NQA">
<meta name="featuretype" content="System Monitoring">
<meta name="featurename" content="NQA">
<meta name="featuretype" content="System Monitoring">
<meta name="featurename" content="NQA">
<meta name="featuretype" content="System Monitoring">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176661839">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Configuring an ICMP Test</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176661839"></a><a name="EN-US_TASK_0000001176661839"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Configuring an ICMP Test</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176661839__1.3.1"></a><a name="1.3.1"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>An ICMP test checks whether there are reachable routes between a source and a destination. The ICMP test functions similarly to the <a href="cmdqueryname=ping"><b><span class="cmdname">ping</span></b></a> command, but it provides more output information, including:</p>
<ul><li><p>Results of the last several tests. By default, the results of last five tests are saved.</p>
</li><li><p>Average delay, packet loss rate, and the time when the last ICMP Echo Reply message is received.</p>
</li></ul>
<div class="p"><a href="#EN-US_TASK_0000001176661839__fig_dc_vrp_network-monitor_feature_001701">Figure 1</a> shows a network on which an ICMP test is performed. The ICMP test process is as follows:<ol><li><p>DeviceA (source) sends an ICMP Echo Request message to DeviceB (destination) and records the timestamp t1 when the message is sent.</p>
</li><li><p>DeviceB receives the ICMP Echo Request message and responds with an ICMP Echo Reply message.</p>
</li><li>DeviceA receives the ICMP Echo Reply message within a specified period, records the timestamp t2 when the message is received, and obtains the delay in its communication with DeviceB by calculating the difference between t1 and t2.<p>If DeviceA does not receive the ICMP Echo Reply message within the specified period, DeviceA considers the sent ICMP Echo Reply message as discarded and calculates the packet loss rate (Number of discarded ICMP Echo Request messages/Number of sent ICMP Echo Request messages). You can determine the network status based on the packet loss rate. If packet loss occurs, the network status is unstable. If the packet loss rate is 100%, the destination is unreachable.</p>
</li></ol>
<div class="fignone" id="EN-US_TASK_0000001176661839__fig_dc_vrp_network-monitor_feature_001701"><a name="EN-US_TASK_0000001176661839__fig_dc_vrp_network-monitor_feature_001701"></a><a name="fig_dc_vrp_network-monitor_feature_001701"></a><span class="figcap"><b>Figure 1 </b>ICMP test networking</span><br><span><img class="vsd" src="figure/en-us_image_0000001176741763.png" width="NaN" height="NaN"></span></div>
</div>
<div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>ICMP tests are mainly used to check reachability, but cannot accurately reflect the link delay. To test the link delay, use ICMP jitter or UDP jitter tests.</p>
</div></div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176661839__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Create an NQA test instance and set the test instance type to ICMP.</span><ol type="a"><li class="substepexpand"><span>Create an NQA test instance and enter the view of the test instance.</span><p><pre class="screen"><a href="cmdqueryname=nqa"><b><span class="cmdname">nqa</span></b></a> <strong><span>test-instance</span></strong> <i><span class="varname">admin-name test-name</span></i></pre>
</p></li><li class="substepexpand"><span>Set the test instance type to ICMP.</span><p><pre class="screen"><a href="cmdqueryname=test-type"><b><span class="cmdname">test-type</span></b></a> <strong><span>icmp</span></strong></pre>
</p></li><li class="substepexpand"><span>(Optional) Configure a description for the test instance.</span><p><pre class="screen"><a href="cmdqueryname=description"><b><span class="cmdname">description</span></b></a> <i><span class="varname">description</span></i></pre>
</p></li></ol>
</li><li><span>Set the destination IP address for test packets, that is, the IP address of the NQA server. </span><p><pre class="screen"><a href="cmdqueryname=destination-address"><b><span class="cmdname">destination-address</span></b></a> { <strong><span>ipv4</span></strong> <i><span class="varname">destAddress</span></i> | <strong><span>ipv6</span></strong> <i><span class="varname">destAddress6</span></i> }</pre>
</p></li><li><span>(Optional) Set optional parameters for the test instance to simulate packet transmission.</span><ol type="a"><li class="substepexpand"><span>Configure the aging time for the NQA test instance.</span><p><pre class="screen"><a href="cmdqueryname=agetime"><b><span class="cmdname">agetime</span></b></a> <i><span class="varname">ageTimeValue</span></i></pre>
</p></li><li class="substepexpand"><span>Configure padding characters in test packets.</span><p><pre class="screen"><a href="cmdqueryname=datafill"><b><span class="cmdname">datafill</span></b></a> <i><span class="varname">fill-string</span></i></pre>
</p></li><li class="substepexpand"><span>Set the packet payload size for the NQA test instance.</span><p><pre class="screen"><a href="cmdqueryname=datasize"><b><span class="cmdname">datasize</span></b></a> <i><span class="varname">datasizeValue</span></i></pre>
</p></li><li class="substepexpand"><span>Set the number of probes in a test.</span><p><pre class="screen"><a href="cmdqueryname=probe-count"><b><span class="cmdname">probe-count</span></b></a> <i><span class="varname">number</span></i></pre>
</p></li><li class="substepexpand"><span>Set the interval at which test packets are sent.</span><p><pre class="screen"><a href="cmdqueryname=interval"><b><span class="cmdname">interval</span></b></a> <strong><span>seconds</span></strong> <i><span class="varname">interval</span></i></pre>
</p></li><li class="substepexpand"><span>Configure the NQA client to send packets without searching the routing table.</span><p><pre class="screen"><a href="cmdqueryname=sendpacket+passroute"><b><span class="cmdname">sendpacket passroute</span></b></a></pre>
</p></li><li class="substepexpand"><span>Configure the source IP address for test packets.</span><p><pre class="screen"><a href="cmdqueryname=source-address"><b><span class="cmdname">source-address</span></b></a> { <strong><span>ipv4</span></strong> <i><span class="varname">srcAddress</span></i> | <strong><span>ipv6</span></strong> <i><span class="varname">srcAddr6</span></i> }</pre>
</p></li><li class="substepexpand"><span>Set the source interface for test packets.</span><p><pre class="screen"><a href="cmdqueryname=source-interface"><b><span class="cmdname">source-interface</span></b></a> { <i><span class="varname">ifName</span></i> | <i><span class="varname">ifType</span></i> <i><span class="varname">ifNum</span></i> }</pre>
</p></li><li class="substepexpand"><span>Set the ToS value of test packets.</span><p><pre class="screen"><a href="cmdqueryname=tos"><b><span class="cmdname">tos</span></b></a> <i><span class="varname">tos-value</span></i> [ <strong><span>dscp</span></strong> ]</pre>
</p></li><li class="substepexpand"><span>Set the TTL value of test packets.</span><p><pre class="screen"><a href="cmdqueryname=ttl"><b><span class="cmdname">ttl</span></b></a> <i><span class="varname">ttlValue</span></i></pre>
</p></li><li class="substepexpand"><span>Set the next-hop IP address.</span><p><pre class="screen"><a href="cmdqueryname=nexthop"><b><span class="cmdname">nexthop</span></b></a> { <strong><span>ipv4</span></strong> <i><span class="varname">ipv4Address</span></i> | <strong><span>ipv6</span></strong> <i><span class="varname">ipv6Address</span></i> }</pre>
</p></li></ol>
</li><li><span>(Optional) Configure test failure conditions.</span><ol type="a"><li class="substepexpand"><span>Set the response timeout interval.</span><p><pre class="screen"><a href="cmdqueryname=timeout"><b><span class="cmdname">timeout</span></b></a> <i><span class="varname">time</span></i></pre>
</p></li><li class="substepexpand"><span>Set the failure percentage for the NQA test instance.</span><p><pre class="screen"><a href="cmdqueryname=fail-percent"><b><span class="cmdname">fail-percent</span></b></a> <i><span class="varname">percent</span></i></pre>
</p></li></ol>
</li><li><span>(Optional) Set the maximum number of historical test records and the maximum number of test results that can be saved for the NQA test instance.</span><p><pre class="screen"><a href="cmdqueryname=records"><b><span class="cmdname">records</span></b></a> { <strong><span>history</span></strong> <i><span class="varname">history-number</span></i> | <strong><span>result</span></strong> <i><span class="varname">result-number</span></i> }</pre>
</p></li><li><span>(Optional) Configure the device to send traps.</span><ol type="a"><li class="substepexpand"><span>Configure the NQA client to send a trap to the NMS when the number of consecutive probe failures reaches a specified value.</span><p><pre class="screen"><a href="cmdqueryname=probe-failtimes"><b><span class="cmdname">probe-failtimes</span></b></a> <i><span class="varname">failTimes</span></i></pre>
</p></li><li class="substepexpand"><span>Configure the NQA client to send a trap to the NMS when the number of consecutive test failures reaches a specified value.</span><p><pre class="screen"><a href="cmdqueryname=test-failtimes"><b><span class="cmdname">test-failtimes</span></b></a> <i><span class="varname">failTimes</span></i></pre>
</p></li><li class="substepexpand"><span>Set the RTD threshold.</span><p><pre class="screen"><a href="cmdqueryname=threshold"><b><span class="cmdname">threshold</span></b></a> <strong><span>rtd</span></strong> <i><span class="varname">thresholdRtd</span></i></pre>
</p></li><li class="substepexpand"><span>Configure the condition for sending a trap.</span><p><pre class="screen"><a href="cmdqueryname=send-trap"><b><span class="cmdname">send-trap</span></b></a> { <strong><span>all</span></strong> | { <strong><span>rtd</span></strong> | <strong><span>testfailure</span></strong> | <strong><span>probefailure</span></strong> | <strong><span>testcomplete</span></strong> | <strong><span>testresult-change</span></strong> } <sup>*</sup> }</pre>
</p></li></ol>
</li><li><span>(Optional) Configure the VPN instance name for the NQA test instance.</span><p><pre class="screen"><a href="cmdqueryname=vpn-instance"><b><span class="cmdname">vpn-instance</span></b></a> <i><span class="varname">vpn-instance-name</span></i></pre>
</p></li><li><span>Schedule the NQA test instance.</span><ol type="a"><li class="substepexpand"><span>(Optional) Set the interval for performing NQA tests.</span><p><pre class="screen"><a href="cmdqueryname=frequency"><b><span class="cmdname">frequency</span></b></a> <i><span class="varname">frequencyValue</span></i></pre>
</p></li><li class="substepexpand"><span>Start the NQA test instance.</span><p><p>You can start an NQA test instance immediately, at a specified time, after a delay, or periodically.</p>
<ul><li><div class="p">Start the test instance immediately.<pre class="screen"><a href="cmdqueryname=start"><b><span class="cmdname">start</span></b></a> <strong><span>now</span></strong> [ <strong><span>end</span></strong> { <strong><span>at</span></strong> [ <i><span class="varname">yyyy/mm/dd</span></i> ] <i><span class="varname">hh:mm:ss</span></i> | <strong><span>delay</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh:mm:ss</span></i> } | <strong><span>lifetime</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh:mm:ss</span></i> } } ]</pre>
</div>
</li><li><div class="p">Start the test instance at a specified time.<pre class="screen"><a href="cmdqueryname=start"><b><span class="cmdname">start</span></b></a> <strong><span>at</span></strong> [ <i><span class="varname">yyyy/mm/dd</span></i> ] <i><span class="varname">hh:mm:ss</span></i> [ <strong><span>end</span></strong> { <strong><span>at</span></strong> [ <i><span class="varname">yyyy/mm/dd</span></i> ] <i><span class="varname">hh:mm:ss</span></i> | <strong><span>delay</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh:mm:ss</span></i> } | <strong><span>lifetime</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh:mm:ss</span></i> } } ]</pre>
</div>
</li><li><p>Start the test instance after a specified delay.</p>
<pre class="screen"><a href="cmdqueryname=start"><b><span class="cmdname">start</span></b></a> <strong><span>delay</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh:mm:ss</span></i> } [ <strong><span>end</span></strong> { <strong><span>at</span></strong> [ <i><span class="varname">yyyy/mm/dd</span></i> ] <i><span class="varname">hh:mm:ss</span></i> | <strong><span>delay</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh:mm:ss</span></i> } | <strong><span>lifetime</span></strong> { <strong><span>seconds</span></strong> <i><span class="varname">second</span></i> | <i><span class="varname">hh:mm:ss</span></i> } } ]</pre>
</li><li><p>Start the test instance at a specified time every day.</p>
<pre class="screen"><a href="cmdqueryname=start"><b><span class="cmdname">start</span></b></a> <strong><span>daily</span></strong> <i><span class="varname">hh:mm:ss</span></i> <strong><span>to</span></strong> <i><span class="varname">hh:mm:ss</span></i> [ <strong><span>begin</span></strong> <i><span class="varname">yyyy/mm/dd</span></i> ] [ <strong><span>end</span></strong> <i><span class="varname">yyyy/mm/dd</span></i> ]</pre>
</li></ul>
</p></li></ol>
</li><li><span>Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001176661839__en-us_task_0234857734_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001176661839__en-us_task_0234857734_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_nqa_cfg_0009.html">Configuring NQA to Test an IP Network
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_nqa_cfg_0011.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>