
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring the Device to Output SSL-Encrypted Logs to Log Hosts">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_info-center_cfg_0013.html">
<meta name="DC.Relation" scheme="URI" content="vrp_info-center_cfg_0022.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Information Management">
<meta name="featuretype" content="System Management">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Information Management">
<meta name="featuretype" content="System Management">
<meta name="featurename" content="Information Management">
<meta name="featuretype" content="System Management">
<meta name="featuretype" content="System Management">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001563999625">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring the Device to Output SSL-Encrypted Logs to Log Hosts</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001563999625"></a><a name="EN-US_TASK_0000001563999625"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring the Device to Output SSL-Encrypted Logs to Log Hosts</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001563999625__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0000001563999625__fig1056353520414">Figure 1</a>, DeviceA is connected to four log hosts and has reachable routes to the log hosts. Different log hosts are expected to reliably receive logs of different types and severities so that the network administrator can monitor information generated by different modules in real time.</p>
<div class="fignone" id="EN-US_TASK_0000001563999625__fig1056353520414"><a name="EN-US_TASK_0000001563999625__fig1056353520414"></a><a name="fig1056353520414"></a><span class="figcap"><b>Figure 1 </b>Networking diagram of outputting SSL-encrypted logs to log hosts</span><br><span><img class="vsd" src="figure/en-us_image_0000001512680266.png" width="NaN" height="NaN"></span></div>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1 represents <span>100GE</span><span>1/0/1</span>.</p>
</div></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001563999625__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure a client SSL policy to authenticate log hosts and ensure log transmission security.</p>
<p>Assume that each log host has obtained a certificate from the CA, and the corresponding trusted CA files <strong>1_cacert_pem_rsa.pem</strong> and <strong>1_rootcert_pem_rsa.pem</strong> have been uploaded to the <strong>security</strong> sub-directory of DeviceA.</p>
</li><li>Enable the IM function.</li><li><p>Configure channels and rules for outputting logs to the log hosts.</p>
</li><li><p>Configure the source interface used to send logs to the log hosts.</p>
</li><li><p>Configure the log hosts.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001563999625__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure an IP address and a routing protocol to ensure that there is a reachable route between DeviceA and each log host. For details, see Configuration Scripts.</span></li><li><span>Configure a client SSL policy.</span><p><pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> </strong><strong>ssl policy syslog_client</strong>
[<span class="keyword">*</span>DeviceA-ssl-policy-syslog_client]<strong> trusted-ca load pem-ca 1_cacert_pem_rsa.pem</strong>
[<span class="keyword">*</span>DeviceA-ssl-policy-syslog_client]<strong> trusted-ca load pem-ca 1_rootcert_pem_rsa.pem</strong>
[<span class="keyword">*</span>DeviceA-ssl-policy-syslog_client] <strong>commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-ssl-policy-syslog_client]<strong> quit</strong></pre>
<p>You can run the <strong>display ssl policy</strong> command on DeviceA to display detailed information about the trusted CA file in the command output.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> </strong><strong>display ssl policy</strong>
       SSL Policy Name: syslog_client 
     Policy Applicants: 
         Key-pair Type:
 Certificate File Type:
      Certificate Type:
  Certificate Filename:
     Key-file Filename:
              CRL File:
       Trusted-CA File:
     Trusted-CA File 1: Format = PEM, Filename = 1_cacert_pem_rsa.pem
     Trusted-CA File 2: Format = PEM, Filename = 1_rootcert_pem_rsa.pem</pre>
</p></li><li><span>Enable the IM function.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> info-center enable</strong></pre>
</p></li><li><span>Configure channels and rules for outputting logs to the log hosts.</span><p><p>Configure DeviceA to send notification logs generated by the CLI module to Server1, and specify Server3 as the backup of Server1.</p>
<p>Configure DeviceA to send warning logs generated by the AAA module to Server2, and specify Server4 as the backup of Server2.</p>
<p># Configure the information channel.</p>
<pre class="screen">[<span class="keyword">*</span>DeviceA]<strong> info-center channel 6 name loghost1</strong>
[<span class="keyword">*</span>DeviceA]<strong> info-center channel 7 name loghost2</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure information channels for outputting logs to the log hosts.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> info-center loghost 10.1.1.1 channel loghost1 transport tcp ssl-policy syslog_client</strong>
[<span class="keyword">*</span>DeviceA]<strong> info-center</strong> <strong>loghost 10.1.1.2 channel loghost1 transport tcp ssl-policy syslog_client</strong>
[<span class="keyword">*</span>DeviceA]<strong> info-center</strong> <strong>loghost 10.2.1.1 channel loghost2 transport tcp ssl-policy syslog_client</strong>
[<span class="keyword">*</span>DeviceA]<strong> info-center</strong> <strong>loghost 10.2.1.2 channel loghost2 transport tcp ssl-policy syslog_client</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p># Configure rules for outputting logs to the log hosts.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> info-center source cli channel loghost1 log level notification</strong>
[<span class="keyword">*</span>DeviceA]<strong> info-center</strong> <strong>source aaa channel loghost2 log level warning</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
</p></li><li><span>Configure the source interface used to send logs to the log hosts.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>info-center loghost source <span>100ge</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
</p></li><li><span>Configure the log hosts.</span><p><p>The log hosts can run the Unix or Linux operating system or third-party log software. For details about the configuration procedure, see the relevant documentation.</p>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001563999625__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Check recorded information related to IM.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> </strong><strong>display info-center</strong>
Information Center:enabled
Log host:
        10.1.1.1, channel number 6, channel name loghost1,
language English , host facility local7, transport tcp ssl-policy syslog_client
        10.1.1.2, channel number 6, channel name loghost1,
language English , host facility local7, transport tcp ssl-policy syslog_client
        10.2.1.1, channel number 7, channel name loghost2,
language English , host facility local7, transport tcp ssl-policy syslog_client
        10.2.1.2, channel number 7, channel name loghost2,
language English , host facility local7, transport tcp ssl-policy syslog_client
Console:
        channel number : 0, channel name : console
Monitor:
        channel number : 1, channel name : monitor
SNMP Agent:
        channel number : 5, channel name : snmpagent
Log buffer:
        enabled,max buffer size 10240, current buffer size 512,
current messages 316, channel number : 4, channel name : logbuffer
dropped messages 0, overwritten messages 53
Trap buffer:
        enabled,max buffer size 1024, current buffer size 256,
current messages 256, channel number:3, channel name:trapbuffer
dropped messages 0, overwritten messages 0
logfile:
        channel number : 9, channel name : channel9, language : English
Information timestamp setting:
        log - date, trap - date, debug - date millisecond
</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001563999625__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Configuration Scripts</h4><pre class="screen">#
sysname DeviceA
#
ssl policy syslog_client
 trusted-ca load pem-ca 1_cacert_pem_rsa.pem
 trusted-ca load pem-ca 1_rootcert_pem_rsa.pem
#
info-center channel 6 name loghost1
info-center channel 7 name loghost2
info-center source cli channel 6 log level notification
info-center source aaa channel 7 log level warning
info-center loghost source <span>100GE</span><span>1/0/1</span>
info-center loghost 10.1.1.1 channel 6 transport tcp ssl-policy syslog_client
info-center loghost 10.1.1.2 channel 6 transport tcp ssl-policy syslog_client
info-center loghost 10.2.1.1 channel 7 transport tcp ssl-policy syslog_client
info-center loghost 10.2.1.2 channel 7 transport tcp ssl-policy syslog_client
#
interface <span>100GE</span><span>1/0/1</span>
<span> undo portswitch</span>
 ip address 10.3.1.1 255.255.0.0
#
ip route-static 10.1.1.0 255.255.255.0 172.16.0.2
ip route-static 10.2.1.0 255.255.255.0 172.16.0.2
#
return</pre>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_info-center_cfg_0013.html">Configuring Log Output
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_info-center_cfg_0022.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>