
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Failed to Log In to the SSH Server Using STelnet">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_login_cfg_0019.html">
<meta name="DC.Relation" scheme="URI" content="vrp_login_cfg_0020.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Stelnet">
<meta name="featurename" content="CLI-based Device Login">
<meta name="featuretype" content="Basic Configuration">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Stelnet">
<meta name="featurename" content="Telnet">
<meta name="featurename" content="CLI-based Device Login">
<meta name="featuretype" content="Basic Configuration">
<meta name="featurename" content="Console">
<meta name="featurename" content="Stelnet">
<meta name="featurename" content="Telnet">
<meta name="featurename" content="CLI-based Device Login">
<meta name="featuretype" content="Basic Configuration">
<meta name="featuretype" content="Basic Configuration">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001564013281">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Failed to Log In to the SSH Server Using STelnet</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001564013281"></a><a name="EN-US_TASK_0000001564013281"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Failed to Log In to the SSH Server Using STelnet</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001564013281__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Fault Description</h4><p>A user fails to log in to the SSH server using STelnet.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001564013281__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Log in to the SSH server through the console port or Telnet. Enter the system view.</span><p><pre class="screen"><a href="cmdqueryname=system-view"><b><span class="cmdname">system-view</span></b></a></pre>
</p></li><li><span>Check whether the SSH service is enabled on the SSH server.</span><p><ol type="a"><li>Check the configuration of the SSH server.<pre class="screen"><a href="cmdqueryname=display+ssh+server+status"><b><span class="cmdname">display ssh server status</span></b></a></pre>
<ul><li>If STelnet is not enabled, go to step b.</li><li>If STelnet is enabled, go to step 3.</li></ul>
</li><li>Enable the STelnet service on the SSH server.<pre class="screen"><a href="cmdqueryname=stelnet+server+enable"><b><span class="cmdname">stelnet server enable</span></b></a></pre>
</li></ol>
</p></li><li><span>Check the protocol configuration in the VTY user interface view of the SSH server.</span><p><ol type="a"><li>Check whether the protocol supported by the VTY user interface is SSH or all.<pre class="screen"><a href="cmdqueryname=user-interface+vty"><b><span class="cmdname">user-interface vty</span></b></a> <i><span class="varname">first-ui-number</span></i> [ <i><span class="varname">last-ui-number</span></i> ]
<a href="cmdqueryname=display+this"><b><span class="cmdname">display this</span></b></a></pre>
<ul><li>If not, go to step b.</li><li>If so, go to step 4.</li></ul>
</li><li>Set the protocol supported by the user interface to SSH.<pre class="screen"><a href="cmdqueryname=protocol+inbound"><b><span class="cmdname">protocol inbound</span></b></a> { <strong><span>ssh</span></strong> | <strong><span>all</span></strong> }
<a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
</li></ol>
</p></li><li><span>Check whether an SSH user is configured on the SSH server.</span><p><ol type="a"><li>Check the configuration of the SSH user.<pre class="screen"><a href="cmdqueryname=display+ssh+user-information"><b><span class="cmdname">display ssh user-information</span></b></a></pre>
<ul><li>If no configuration information exists, go to step b.</li><li>If configuration information exists, go to step 5.</li></ul>
</li><li>Create an SSH user, and configure the authentication mode and service type for the SSH user.<pre class="screen"><a href="cmdqueryname=ssh+user"><b><span class="cmdname">ssh user</span></b></a> <i><span class="varname">user-name</span></i>   //Create an SSH user.
<a href="cmdqueryname=ssh+user"><b><span class="cmdname">ssh user</span></b></a> <i><span class="varname">user-name</span></i> <strong><span>authentication-type</span></strong> { <strong><span>password</span></strong> | <strong><span>rsa</span></strong> | <strong><span>password-rsa</span></strong> | <strong><span>all</span></strong> | <strong><span>dsa</span></strong> | <strong><span>password-dsa</span></strong> | <strong><span>ecc</span></strong> | <strong><span>password-ecc</span></strong> | <strong>sm2</strong> | <strong>password-sm2</strong> | <strong><span>password-x509v3-rsa</span></strong> | <strong><span>x509v3-rsa</span></strong> } // Configure the authentication mode for the SSH user.
<a href="cmdqueryname=ssh+user"><b><span class="cmdname">ssh user</span></b></a> <i><span class="varname">user-name</span></i> <strong><span>service-type</span></strong> { <strong>all</strong> |  <strong><span>stelnet</span></strong> }  //Configure the service type for the SSH user.</pre>
</li></ol>
</p></li><li><span>Check whether the number of users who have logged in to the SSH server reaches the upper limit.</span><p><ol type="a"><li>Check whether all VTY channels are occupied.<pre class="screen"><a href="cmdqueryname=display+users"><b><span class="cmdname">display users</span></b></a></pre>
<ul><li>If all VTY channels are occupied, go to step b.</li><li>If not all VTY channels are occupied, go to step 6.</li></ul>
</li><li>Check the maximum number of users allowed by the current VTY channel.<pre class="screen"><a href="cmdqueryname=display+user-interface+maximum-vty"><b><span class="cmdname">display user-interface maximum-vty</span></b></a></pre>
</li><li>Set the maximum number of users allowed by the VTY channel to 21.<pre class="screen"><a href="cmdqueryname=user-interface+maximum-vty"><b><span class="cmdname">user-interface maximum-vty</span></b></a> <span><strong>21</strong></span></pre>
</li></ol>
</p></li><li><span>Check whether an ACL is bound to the VTY user interface of the SSH server.</span><p><ol type="a"><li>Check whether an ACL is configured on the VTY user interface.<pre class="screen"><a href="cmdqueryname=user-interface+vty"><b><span class="cmdname">user-interface vty</span></b></a> <i><span class="varname">first-ui-number</span></i> [ <i><span class="varname">last-ui-number</span></i> ]
<a href="cmdqueryname=display+this"><b><span class="cmdname">display this</span></b></a>
<a href="cmdqueryname=quit"><b><span class="cmdname">quit</span></b></a></pre>
<ul><li>If an ACL is configured, record the ACL number and go to step b.</li><li>If no ACL is configured, go to step 7.</li></ul>
</li><li>Check whether ACL denies the IP address of the STelnet client.<pre class="screen"><a href="cmdqueryname=display+acl"><b><span class="cmdname">display acl</span></b></a> <i><span class="varname">acl-number</span></i></pre>
<ul><li>If so, go to step c.</li><li>If not, go to step 7.</li></ul>
</li><li>Delete the <strong>deny</strong> rule.<pre class="screen"><a href="cmdqueryname=undo+rule"><b><span class="cmdname">undo rule</span></b></a> <i><span class="varname">rule-id</span></i></pre>
</li><li>Modify the ACL to allow access from the IP address of the client.<pre class="screen"><a href="cmdqueryname=rule"><b><span class="cmdname">rule</span></b></a> <strong><span>permit source </span></strong><i><span class="varname">source-ip-address source-wildcard</span></i></pre>
</li></ol>
</p></li><li><span>Check whether the SSH version on the SSH server matches that on the SSH client.</span><p><ol type="a"><li>Check the SSH version.<pre class="screen"><a href="cmdqueryname=display+ssh+server+status"><b><span class="cmdname">display ssh server status</span></b></a></pre>
<ul><li>If the SSH client and SSH server have different SSH versions and <strong>SSH version 1.x compatibility</strong> of the SSH server is <strong>Disable</strong>, go to step b.</li><li>If the SSH client and SSH server have the same SSH version, go to step 8.</li></ul>
</li><li>Enable the capability with earlier versions for the SSH server.<pre class="screen"><strong><a href="cmdqueryname=ssh+server+compatible-ssh1x+enable"><b><span class="cmdname">ssh server compatible-ssh1x enable</span></b></a></strong></pre>
</li></ol>
</p></li><li><span>Check whether the first login function is enabled for the SSH client.</span><p><p>If the first login function is not enabled on an SSH client, the first login from the STelnet client to the SSH server fails because validity check on the RSA public key of the SSH server fails.</p>
</p><p><ol type="a"><li>Check whether the first login function is enabled for the SSH client.<pre class="screen"><a href="cmdqueryname=display+this"><b><span class="cmdname">display this</span></b></a></pre>
</li><li>Enable first login for the SSH client.<pre class="screen"><a href="cmdqueryname=ssh+client+first-time+enable"><b><span class="cmdname">ssh client first-time enable</span></b></a></pre>
</li></ol>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_login_cfg_0019.html">Troubleshooting CLI-based Device Login Failure
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_login_cfg_0020.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>