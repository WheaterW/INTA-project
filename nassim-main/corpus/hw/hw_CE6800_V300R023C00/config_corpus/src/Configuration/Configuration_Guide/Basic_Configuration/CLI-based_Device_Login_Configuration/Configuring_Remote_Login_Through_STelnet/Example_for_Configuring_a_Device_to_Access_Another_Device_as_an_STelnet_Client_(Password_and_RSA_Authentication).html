
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring a Device to Access Another Device as an STelnet Client (Password and RSA Authentication)">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_login_cfg_0013.html">
<meta name="DC.Relation" scheme="URI" content="vrp_login_cfg_0031.html">
<meta name="DC.Relation" scheme="URI" content="vrp_login_cfg_0029.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="Stelnet">
<meta name="featurename" content="CLI-based Device Login">
<meta name="featuretype" content="Basic Configuration">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="Stelnet">
<meta name="featurename" content="CLI-based Device Login">
<meta name="featuretype" content="Basic Configuration">
<meta name="featurename" content="Console">
<meta name="featurename" content="Stelnet">
<meta name="featurename" content="Telnet">
<meta name="featurename" content="CLI-based Device Login">
<meta name="featuretype" content="Basic Configuration">
<meta name="featuretype" content="Basic Configuration">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001513053082">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring a Device to Access Another Device as an STelnet Client (Password and RSA Authentication)</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001513053082"></a><a name="EN-US_TASK_0000001513053082"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring a Device to Access Another Device as an STelnet Client (Password and RSA Authentication)</h1>
<div class="taskbody" id="taskbody1492563811175336"><div class="context"><a name="EN-US_TASK_0000001513053082__1.3.1"></a><a name="1.3.1"></a>
<div class="p" id="EN-US_TASK_0000001513053082__context776261265175336"><h4 class="sectiontitle">Networking Requirements</h4><p id="EN-US_TASK_0000001513053082__p532251824175336">The customer requires secure data exchange between the server and client. In <a href="#EN-US_TASK_0000001513053082__fig13411164017368">Figure 1</a>, two login users <strong id="EN-US_TASK_0000001513053082__b91571140457">client001</strong> and <strong id="EN-US_TASK_0000001513053082__b1015714011514">client002</strong> are configured and they use the password and RSA authentication modes respectively to log in to the SSH server. A new port number is configured, and the default port number is not used.</p>
<div class="fignone" id="EN-US_TASK_0000001513053082__fig13411164017368"><a name="EN-US_TASK_0000001513053082__fig13411164017368"></a><a name="fig13411164017368"></a><span class="figcap"><b>Figure 1 </b>Network diagram for login to another device using STelnet</span><div class="note" id="EN-US_TASK_0000001513053082__note989615126387"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TASK_0000001513053082__p5896131216386">In this example, interface1 represents <span>100GE</span><span>1/0/1</span>.</p>
</div></div>
<br><span><img id="EN-US_TASK_0000001513053082__image041120407362" src="figure/en-us_image_0000001987318233.png" width="NaN" height="NaN"></span></div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001513053082__1.3.2"></a><a name="1.3.2"></a>
<div class="p" id="EN-US_TASK_0000001513053082__context1906473612175336"><h4 class="sectiontitle">Configuration Roadmap</h4><p id="EN-US_TASK_0000001513053082__p1828772947175336">The configuration roadmap is as follows:</p>
<ol id="EN-US_TASK_0000001513053082__ol997376847175336"><li id="EN-US_TASK_0000001513053082__li858102535175336"><p id="EN-US_TASK_0000001513053082__p1776616140175336"><a name="EN-US_TASK_0000001513053082__li858102535175336"></a><a name="li858102535175336"></a>Configure the SSH server to generate a local key pair to implement secure data exchange between the server and client.</p>
</li><li id="EN-US_TASK_0000001513053082__li1893213550175336"><p id="EN-US_TASK_0000001513053082__p2122420898175336"><a name="EN-US_TASK_0000001513053082__li1893213550175336"></a><a name="li1893213550175336"></a>Configure different authentication modes for the SSH users <strong id="EN-US_TASK_0000001513053082__b1775458999175548">client001</strong> and <strong id="EN-US_TASK_0000001513053082__b2111977531175548">client002</strong> on the SSH server.</p>
</li><li id="EN-US_TASK_0000001513053082__li1002363232175336"><p id="EN-US_TASK_0000001513053082__p1857113156175336"><a name="EN-US_TASK_0000001513053082__li1002363232175336"></a><a name="li1002363232175336"></a>Enable the STelnet service on the SSH server.</p>
</li><li id="EN-US_TASK_0000001513053082__li1271342540175336"><p id="EN-US_TASK_0000001513053082__p2139265777175336"><a name="EN-US_TASK_0000001513053082__li1271342540175336"></a><a name="li1271342540175336"></a>Configure the STelnet service type for the SSH users <strong id="EN-US_TASK_0000001513053082__b1611480450175548">client001</strong> and <strong id="EN-US_TASK_0000001513053082__b1359887862175548">client002</strong> on the SSH server.</p>
</li><li id="EN-US_TASK_0000001513053082__li1483681639175336"><p id="EN-US_TASK_0000001513053082__p1804681356175336"><a name="EN-US_TASK_0000001513053082__li1483681639175336"></a><a name="li1483681639175336"></a>Set an SSH server listening port number on the SSH server to prevent attackers from accessing the standard SSH service port, ensuring security.</p>
</li><li id="EN-US_TASK_0000001513053082__li987304449175336"><p id="EN-US_TASK_0000001513053082__p19733974175336"><a name="EN-US_TASK_0000001513053082__li987304449175336"></a><a name="li987304449175336"></a>Log in to the SSH server as the <strong id="EN-US_TASK_0000001513053082__b494443740175548">client001</strong> and <strong id="EN-US_TASK_0000001513053082__b1009354333175548">client002</strong> users through STelnet.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001513053082__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001513053082__steps1671760009175336"><li id="EN-US_TASK_0000001513053082__step1911388630175336"><span id="EN-US_TASK_0000001513053082__cmd500828937175336">Configure the server to generate a local key pair.</span><p><pre class="screen" id="EN-US_TASK_0000001513053082__screen88764564510">&lt;<span class="keyword" id="EN-US_TASK_0000001513053082__keyword26471340123819">HUAWEI</span>&gt;<strong id="EN-US_TASK_0000001513053082__b1899144518456"> system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1216720134511"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001513053082__keyword127031328102219">HUAWEI</span>]<strong id="EN-US_TASK_0000001513053082__b16100104513452"> sysname SSH Server</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1484012304113">*</span><span class="keyword" id="EN-US_TASK_0000001513053082__keyword846333032212">HUAWEI</span>] <strong id="EN-US_TASK_0000001513053082__b2118660123175336">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword151911913816"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server]<strong id="EN-US_TASK_0000001513053082__b41001454457"> rsa local-key-pair create</strong>
The key name will be:Host
The range of public key size is (2048, 4096).
NOTE: Key pair generation will take a short while.
Please input the modulus [default = 3072]:
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1925658193820">*</span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b9586729659">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001513053082__step1721942741175336"><span id="EN-US_TASK_0000001513053082__cmd1202021015175336">Create SSH users on the server.</span><p><p id="EN-US_TASK_0000001513053082__p1015591445175336"># Configure a VTY user interface.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen857494854117">[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword55451534133811"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b195951148164115">user-interface vty 0 4</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword19106039163819"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server-ui-vty0-4] <strong id="EN-US_TASK_0000001513053082__b3595134824116">authentication-mode aaa</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword529201913398">*</span>SSH Server-ui-vty0-4] <strong id="EN-US_TASK_0000001513053082__b75951248164113">protocol inbound ssh</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword27109252396">*</span>SSH Server-ui-vty0-4] <strong id="EN-US_TASK_0000001513053082__b359511485419">quit</strong>
[*SSH Server] <strong id="EN-US_TASK_0000001513053082__b1248713471113">commit</strong></pre>
<ul id="EN-US_TASK_0000001513053082__ul1376154559175336"><li id="EN-US_TASK_0000001513053082__li1790989269175336"><p id="EN-US_TASK_0000001513053082__p2025847731175336"><a name="EN-US_TASK_0000001513053082__li1790989269175336"></a><a name="li1790989269175336"></a>Create an SSH user named <strong id="EN-US_TASK_0000001513053082__b1208599265175548">client001</strong>.</p>
<p id="EN-US_TASK_0000001513053082__p1397135756175336"># Create an SSH user named <strong id="EN-US_TASK_0000001513053082__b1186330573175548">client001</strong> and configure the password authentication mode for the user.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen194775417422">[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword129011153113911"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b954013434217">aaa</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1994019034019"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server-aaa] <strong id="EN-US_TASK_0000001513053082__b6540114164210">local-user client001 password</strong>
Please configure the login password (8-128)
It is recommended that the password consist of four types of characters, including lowercase letters, uppercase letters, numerals and special characters. 
Please enter password:                                      
Please confirm password:                               
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword725963115314">*</span>SSH Server-aaa] <strong id="EN-US_TASK_0000001513053082__b1854114414422">local-user client001 privilege level 3</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1257315231497">*</span>SSH Server-aaa] <strong id="EN-US_TASK_0000001513053082__b1554212411428">local-user client001 service-type ssh</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword380332513918">*</span>SSH Server-aaa] <strong id="EN-US_TASK_0000001513053082__b125421945424">quit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1763710318918">*</span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b15543104174219">ssh user client001</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1430183211918">*</span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b55431416423">ssh user client001 authentication-type password</strong>
[*SSH Server] <strong id="EN-US_TASK_0000001513053082__b112251257131111">commit</strong></pre>
<p id="EN-US_TASK_0000001513053082__p9461049419"># Configure the encryption algorithm, HMAC authentication algorithm, key exchange algorithm list, and public key algorithm on <strong id="EN-US_TASK_0000001513053082__b9145153304012">client001</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen79375551539">&lt;<span class="keyword" id="EN-US_TASK_0000001513053082__keyword184272037102212">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001513053082__b27011815749">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1434101610467"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001513053082__keyword45064391226">HUAWEI</span>] <strong id="EN-US_TASK_0000001513053082__b1570151516410">sysname client001</strong>
[*<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1053924115221">HUAWEI</span>] <strong id="EN-US_TASK_0000001513053082__b12701131514415">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword656718319107"><font style="font-size:8pt" Face="Courier New" >~</font></span>client001] <strong id="EN-US_TASK_0000001513053082__b177753551442">ssh client cipher aes128_ctr aes256_ctr aes192_ctr aes128_gcm aes256_gcm</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword496794820910">*</span>client001] <strong id="EN-US_TASK_0000001513053082__b19775185519412">ssh client hmac sha2_256 sha2_512</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword10632104916913">*</span>client001] <strong id="EN-US_TASK_0000001513053082__b207752551048">ssh client key-exchange dh_group_exchange_sha256 dh_group16_sha512</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword13944451896">*</span>client001] <strong id="EN-US_TASK_0000001513053082__b677555520415">ssh client publickey rsa_sha2_256 rsa_sha2_512</strong>
[*client001] <strong id="EN-US_TASK_0000001513053082__b1775165515411">commit</strong></pre>
</li><li id="EN-US_TASK_0000001513053082__li1044420948175336"><p id="EN-US_TASK_0000001513053082__p51542458175336"><a name="EN-US_TASK_0000001513053082__li1044420948175336"></a><a name="li1044420948175336"></a>Create an SSH user named <strong id="EN-US_TASK_0000001513053082__b288119525175548">client002</strong>.</p>
<p id="EN-US_TASK_0000001513053082__p1977364382175336"># Create an SSH user named <strong id="EN-US_TASK_0000001513053082__b813373229175548">client002</strong> and configure the RSA authentication mode for the user.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen1571112218425">[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword719883012464"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b37792215424">ssh user client002</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1787812011014">*</span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b57712234216">ssh user client002 authentication-type rsa</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1248112211102">*</span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b1077192254218">ssh authorization-type default root</strong>
[*SSH Server] <strong id="EN-US_TASK_0000001513053082__b15331914131215">commit</strong></pre>
<p id="EN-US_TASK_0000001513053082__p1395203594175336"># Configure <strong id="EN-US_TASK_0000001513053082__b896165010113">client002</strong> to generate a local key pair.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen14122114314213">&lt;<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1713224862215">HUAWEI</span>&gt; <strong id="EN-US_TASK_0000001513053082__b4137543114212">system-view</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword11668236114613"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword" id="EN-US_TASK_0000001513053082__keyword13730249132211">HUAWEI</span>] <strong id="EN-US_TASK_0000001513053082__b6137204364217">sysname client002</strong>
[*<span class="keyword" id="EN-US_TASK_0000001513053082__keyword11409195112227">HUAWEI</span>] <strong id="EN-US_TASK_0000001513053082__b139660429128">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword595014271478"><font style="font-size:8pt" Face="Courier New" >~</font></span>client002]<strong id="EN-US_TASK_0000001513053082__b18138343124212"> rsa local-key-pair create</strong>
The key name will be: client002_Host
The range of public key size is (2048, 4096).
NOTE: Key pair generation will take a short while.
Please input the modulus [default = 3072]:
[*client002] <strong id="EN-US_TASK_0000001513053082__b7542058111217">commit</strong></pre>
<p id="EN-US_TASK_0000001513053082__p15181465117"># Configure the encryption algorithm, HMAC authentication algorithm, key exchange algorithm list, and public key algorithm on <strong id="EN-US_TASK_0000001513053082__b05601546124018">client002</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen1371053161212">[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword82441238114712"><font style="font-size:8pt" Face="Courier New" >~</font></span>client002] <strong id="EN-US_TASK_0000001513053082__b4225183013138">ssh client cipher aes128_ctr aes256_ctr aes192_ctr aes128_gcm aes256_gcm</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword730253917108">*</span>client002] <strong id="EN-US_TASK_0000001513053082__b726032414138">ssh client hmac sha2_256 sha2_512</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword658364051014">*</span>client002] <strong id="EN-US_TASK_0000001513053082__b030114200136">ssh client key-exchange dh_group_exchange_sha256 dh_group16_sha512</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword195791841161012">*</span>client002] <strong id="EN-US_TASK_0000001513053082__b155911816121310">ssh client publickey rsa_sha2_256 rsa_sha2_512</strong>
[*client002] <strong id="EN-US_TASK_0000001513053082__b584231214">commit</strong></pre>
<div class="p" id="EN-US_TASK_0000001513053082__p1156869190175336"># Check the public key in the RSA key pair generated on the client.<pre class="screen" id="EN-US_TASK_0000001513053082__screen264208095175336">[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword103731323133215"><font style="font-size:8pt" Face="Courier New" >~</font></span>client002] <strong id="EN-US_TASK_0000001513053082__b4373102353218">display rsa local-key-pair public</strong>
======================Host key==========================
Time of Key pair created : 2023-12-27 18:00:55 
Key Name    : Host 
Key modulus : 3072 
Key Type    : RSA Encryption Key
========================================================
Key code:
<strong id="EN-US_TASK_0000001513053082__b1879224198175336">3082010A
  02820101
    00A4BAB8 B964077E F7657F7F E4BE1DE8 71EE1707
    E4EE2864 2D06FBE0 BFC1CB52 F99B7A99 0132B709
    3F841CA2 3544B8B2 6EE0A9ED 04B19FE3 FB3DA86D
    BE68FFE2 2303108D BDC24B80 A1793A08 FDA0B6C1
    13C31EA5 298EC9B1 2B0BC8BD 32CFF896 29F8CA98
    8B1724AF 5DA8A390 20906ADE 6A8AD77D 6234F0C8
    DC965BA0 1771D9C0 A89ED49B 5ECF7EE2 D5997527
    FC87FE03 E51658C1 0996DFDF DC456376 2FA4B268
    4345131D 431419D2 DD5E4003 6A7D3295 145F3175
    22E80686 E6B39A05 799D6BCF A78F69B6 BC2D0836
    F5013421 77D68B89 A9EC182A 04B87BE3 500FCE14
    9C95CF78 75704359 0C70FD60 1EFC0B99 32F02142
    4CE781E4 36A60BFC 2CBD07F6 9E700CEE 4D0203
    010001</strong>

Key fingerprint:   
  ssh-rsa 3072 47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU

Host public key for PEM format code:
---- BEGIN SSH2 PUBLIC KEY ----
AAAAB3NzaC1yc2EAAAADAQABAAABAQCkuri5ZAd+92V/f+S+Hehx7hcH5O4oZC0G
++C/wctS+Zt6mQEytwk/hByiNUS4sm7gqe0EsZ/j+z2obb5o/+IjAxCNvcJLgKF5
Ogj9oLbBE8MepSmOybErC8i9Ms/4lin4ypiLFySvXaijkCCQat5qitd9YjTwyNyW
W6AXcdnAqJ7Um17PfuLVmXUn/If+A+UWWMEJlt/f3EVjdi+ksmhDRRMdQxQZ0t1e
QANqfTKVFF8xdSLoBobms5oFeZ1rz6ePaba8LQg29QE0IXfWi4mp7BgqBLh741AP
zhSclc94dXBDWQxw/WAe/AuZMvAhQkzngeQ2pgv8LL0H9p5wDO5N
---- END SSH2 PUBLIC KEY ----

Public key code for pasting into OpenSSH authorized_keys file:
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCkuri5ZAd+92V/f+S+Hehx7hcH5O4oZC0G++C/wctS+Zt6mQEytwk/hByiNUS4sm7gqe0EsZ/j+z2obb5o/+IjAxCNvcJLgKF5Ogj9oLbBE8MepSmOybErC8i9Ms/4lin4ypiLFySvXaijkCCQat5qitd9YjTwyNyWW6AXcdnAqJ7Um17PfuLVmXUn/If+A+UWWMEJlt/f3EVjdi+ksmhDRRMdQxQZ0t1eQANqfTKVFF8xdSLoBobms5oFeZ1rz6ePaba8LQg29QE0IXfWi4mp7BgqBLh741APzhSclc94dXBDWQxw/WAe/AuZMvAhQkzngeQ2pgv8LL0H9p5wDO5N rsa-key</pre>
</div>
<div class="p" id="EN-US_TASK_0000001513053082__p167572346175336"># Copy the RSA public key (the information in bold in the <strong id="EN-US_TASK_0000001513053082__b1918234319211">display</strong> command output) generated on the client to the server.<pre class="screen" id="EN-US_TASK_0000001513053082__screen1814830195175336">[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword157392217210"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b763235434175336">rsa peer-public-key rsakey001</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword139631113111111">*</span>SSH Server-rsa-public-key] <strong id="EN-US_TASK_0000001513053082__b1432925669175336">public-key-code begin</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword132203169118">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b193519220175336">3082010A</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword156384183117">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b484381700175336">2820101</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword155131619171114">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b347914100175336">00A4BAB8 B964077E F7657F7F E4BE1DE8 71EE1707</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword15177142010117">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b1962244249175336">E4EE2864 2D06FBE0 BFC1CB52 F99B7A99 0132B709</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword290432018119">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b1433760361175336">3F841CA2 3544B8B2 6EE0A9ED 04B19FE3 FB3DA86D</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword060562119117">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b1376632468175336">BE68FFE2 2303108D BDC24B80 A1793A08 FDA0B6C1</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword11359102217113">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b1950465868175336">13C31EA5 298EC9B1 2B0BC8BD 32CFF896 29F8CA98</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1524022413117">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b345935376175336">8B1724AF 5DA8A390 20906ADE 6A8AD77D 6234F0C8</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword194142421117">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b1277022682175336">DC965BA0 1771D9C0 A89ED49B 5ECF7EE2 D5997527</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword072842581112">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b862899898175336">FC87FE03 E51658C1 0996DFDF DC456376 2FA4B268</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword528914265110">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b1762445422175336">4345131D 431419D2 DD5E4003 6A7D3295 145F3175</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1012172718118">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b1221198294175336">22E80686 E6B39A05 799D6BCF A78F69B6 BC2D0836</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword2838172711113">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b916619093175336">F5013421 77D68B89 A9EC182A 04B87BE3 500FCE14</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword12701728131113">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b2011887703175336">9C95CF78 75704359 0C70FD60 1EFC0B99 32F02142</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1722283351118">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b1096987899175336">4CE781E4 36A60BFC 2CBD07F6 9E700CEE 4D</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword11643934181118">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b912271906175336">203</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword11493535151117">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b275638379175336">10001</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword13366183614117">*</span>SSH Server-rsa-public-key-rsa-key-code] <strong id="EN-US_TASK_0000001513053082__b1513113711175336">public-key-code end</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1956737101116">*</span>SSH Server-rsa-public-key] <strong id="EN-US_TASK_0000001513053082__b1503121313175336">peer-public-key end</strong>
[*SSH Server] <strong id="EN-US_TASK_0000001513053082__b1925015107147">commit</strong></pre>
</div>
<p id="EN-US_TASK_0000001513053082__p1767103893175336"># On the server, bind the RSA public key of the STelnet client to the SSH user <strong id="EN-US_TASK_0000001513053082__b896922711412">client002</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen1083187118175336">[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword19387178923"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b1220803286175336">ssh user client002 assign rsa-key rsakey001</strong>
[*SSH Server] <strong id="EN-US_TASK_0000001513053082__b62241841238">commit</strong></pre>
</li></ul>
</p></li><li id="EN-US_TASK_0000001513053082__step227457862175336"><span id="EN-US_TASK_0000001513053082__cmd363394974175336">Enable the STelnet service on the SSH server and specify the source interface for the SSH server.</span><p><p id="EN-US_TASK_0000001513053082__p1643723548175336"># Enable the STelnet service.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen1766858379175336">[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword7994953379"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b1328007666175336">stelnet server enable</strong></pre>
<p id="EN-US_TASK_0000001513053082__p12901411013"># Specify the source interface for the SSH server.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen20290241502">[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword15536114621111">*</span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b1064192214333">ssh server-source all-interface</strong> 
[*SSH Server] <strong id="EN-US_TASK_0000001513053082__b12365149333">commit</strong></pre>
<p id="EN-US_TASK_0000001513053082__p921874817293"># Configure the public key algorithm, encryption algorithm, key exchange algorithm list, HMAC authentication algorithm, and minimum key length on the SSH server.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen921781610318">[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword6161703813"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server]<strong id="EN-US_TASK_0000001513053082__b17991111632611"> ssh server cipher aes128_ctr aes256_ctr aes192_ctr aes128_gcm aes256_gcm</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword16873348141114">*</span>SSH Server]<strong id="EN-US_TASK_0000001513053082__b73022113262"> ssh server hmac sha2_256 sha2_512</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword2400114915117">*</span>SSH Server]<strong id="EN-US_TASK_0000001513053082__b82831626152615"> ssh server key-exchange dh_group_exchange_sha256 dh_group16_sha512</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword16268205012118">*</span>SSH Server]<strong id="EN-US_TASK_0000001513053082__b774924532617"> ssh server publickey rsa_sha2_256 rsa_sha2_512</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword17279509115">*</span>SSH Server]<strong id="EN-US_TASK_0000001513053082__b1558035592618"> ssh server dh-exchange min-len 3072</strong>
[*SSH Server] <strong id="EN-US_TASK_0000001513053082__b177841833183113">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001513053082__step442922751175336"><span id="EN-US_TASK_0000001513053082__cmd1024355555175336">Set the service type to STelnet for the SSH users <strong id="EN-US_TASK_0000001513053082__b137671446515">client001</strong> and <strong id="EN-US_TASK_0000001513053082__b1176719416516">client002</strong>.</span><p><pre class="screen" id="EN-US_TASK_0000001513053082__screen1812132518431">[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword2251101311818"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b102242519432">ssh user client001 service-type stelnet</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword129021855161117">*</span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b12232514435">ssh user client002 service-type stelnet</strong></pre>
</p></li><li id="EN-US_TASK_0000001513053082__step1736913282175336"><span id="EN-US_TASK_0000001513053082__cmd1556316903175336">Configure a new listening port number on the SSH server.</span><p><pre class="screen" id="EN-US_TASK_0000001513053082__screen1880431230175336">[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword2922574112">*</span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b1530026283175336">ssh server port 1025</strong>
[*SSH Server] <strong id="EN-US_TASK_0000001513053082__b17650171820153">commit</strong></pre>
</p></li><li id="EN-US_TASK_0000001513053082__step693315688175336"><span id="EN-US_TASK_0000001513053082__cmd310499594175336">Connect the STelnet clients to the SSH server.</span><p><p id="EN-US_TASK_0000001513053082__p1611208539175336"># Enable the first login function for the SSH clients.</p>
<p id="EN-US_TASK_0000001513053082__p982350082175336">Enable first login for <strong id="EN-US_TASK_0000001513053082__b1586735101614">client001</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen1163863964319">[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword6360128686"><font style="font-size:8pt" Face="Courier New" >~</font></span>client001] <strong id="EN-US_TASK_0000001513053082__b1966713984312">ssh client first-time enable</strong>
[*client001] <strong id="EN-US_TASK_0000001513053082__b10694125812167">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword28961332582"><font style="font-size:8pt" Face="Courier New" >~</font></span>client001] <strong id="EN-US_TASK_0000001513053082__b357802115595">quit</strong></pre>
<p id="EN-US_TASK_0000001513053082__p1131205451175336">Enable first login for <strong id="EN-US_TASK_0000001513053082__b82721015121615">client002</strong>.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen422535344317">[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword166601739584"><font style="font-size:8pt" Face="Courier New" >~</font></span>client002] <strong id="EN-US_TASK_0000001513053082__b1824025313432">ssh client first-time enable</strong>
[*client002] <strong id="EN-US_TASK_0000001513053082__b1892751111189">commit</strong>
[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword1446914401282"><font style="font-size:8pt" Face="Courier New" >~</font></span>client002] <strong id="EN-US_TASK_0000001513053082__b192403537438">quit</strong></pre>
<p id="EN-US_TASK_0000001513053082__p940668971175336"># Log in to the SSH server from <strong id="EN-US_TASK_0000001513053082__b033922641610">client001</strong> in password authentication mode by entering the user name and password.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen1348159134415">&lt;client001&gt; <strong id="EN-US_TASK_0000001513053082__b1765495019175548">stelnet 10.1.1.1 1025</strong>
Trying 10.1.1.1 ...
Press CTRL+K to abort
Connected to 10.1.1.1 ...
The server's public key does not match the one cached before. 
The server is not authenticated. Continue to access it?[Y/N]:<strong id="EN-US_TASK_0000001513053082__b1774973424175548">y</strong>
The keyname:10.1.1.1 already exists. Update it? [Y/N]:<strong id="EN-US_TASK_0000001513053082__b1995315797175548">n</strong>

Please input the username: <strong id="EN-US_TASK_0000001513053082__b1445309136175548">client001</strong>    
Enter password:</pre>
<p id="EN-US_TASK_0000001513053082__p4875446175336">Enter the password. The following information indicates that the login is successful:</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen822596719175336">Warning: The initial password poses security risks.                             
The password needs to be changed. Change now? [Y/N]:<strong id="EN-US_TASK_0000001513053082__b2013888571175548">n</strong>

Info: The max number of VTY users is 21, the number of current VTY users online is 4, and total number of terminal users online is 4.                           
      The current login time is 2023-12-31 11:22:06.                            
&lt;SSH Server&gt;</pre>
<p id="EN-US_TASK_0000001513053082__p1444917510175336"># Log in to the SSH server from <strong id="EN-US_TASK_0000001513053082__b1632865215161">client002</strong> in RSA authentication mode.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen16387529184418">&lt;client002&gt; <strong id="EN-US_TASK_0000001513053082__b1724735152175548">stelnet 10.1.1.1 1025</strong>
Trying 10.1.1.1 ...
Press CTRL+K to abort
Connected to 10.1.1.1 ...
The server's public key does not match the one cached before. 
The server is not authenticated. Continue to access it?[Y/N]:<strong id="EN-US_TASK_0000001513053082__b1102464909175548">y</strong>
The keyname:10.1.1.1 already exists. Update it? [Y/N]: <strong id="EN-US_TASK_0000001513053082__b1241612916447">n</strong>

Please input the username: <strong id="EN-US_TASK_0000001513053082__b923229355175548">client002</strong>
Info: The max number of VTY users is 21, the number of current VTY users online is 4, and total number of terminal users online is 4.                           
      The current login time is 2023-12-31 11:36:06. 
&lt;SSH Server&gt;</pre>
<p id="EN-US_TASK_0000001513053082__p1351213689175336">If the user view is displayed, the login is successful. If the message <strong id="EN-US_TASK_0000001513053082__b2061215188175336">Session is disconnected</strong> is displayed, the login fails.</p>
</p></li></ol></div>
<div class="example" id="EN-US_TASK_0000001513053082__example2100419764175336"><a name="EN-US_TASK_0000001513053082__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p id="EN-US_TASK_0000001513053082__p41092175214"># Attackers fail to log in to the SSH server using the default listening port number 22.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen1210971712114">&lt;client002&gt; <strong id="EN-US_TASK_0000001513053082__b11109141792119">stelnet 10.1.1.1</strong>
Trying 10.1.1.1 ...
Press CTRL+K to abort
Error: Failed to connect to the remote host.</pre>
<p id="EN-US_TASK_0000001513053082__p51091217102119">The <strong id="EN-US_TASK_0000001513053082__b11815371476">display ssh server status</strong> command output indicates that the STelnet service has been enabled. The <strong id="EN-US_TASK_0000001513053082__b107046355117">display ssh user-information</strong> command output contains information about SSH users on the server.</p>
<p id="EN-US_TASK_0000001513053082__p210921792118"># Check the status of the SSH server.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen910918175212">[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword7109171713210"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b810991722110">display ssh server status</strong>  
SSH Version                                : 2.0
SSH authentication timeout (Seconds)       : 60
SSH authentication retries (Times)         : 3
SSH server key generating interval (Hours) : 0
SSH version 1.x compatibility              : Enable
SSH server keepalive                       : Disable
SFTP IPv4 server                           : Disable
SFTP IPv6 server                           : Disable
STELNET IPv4 server                        : Enable
STELNET IPv6 server                        : Enable
<strong id="EN-US_TASK_0000001513053082__b1502130154010">SNETCONF IPv4 server</strong>                    : Enable
SNETCONF IPv6 server                       : Enable
SNETCONF IPv4 server port(830)             : Disable
SNETCONF IPv6 server port(830)             : Disable
SCP IPv4 server                            : Enable
SCP IPv6 server                            : Enable
SSH port forwarding                        : Disable
SSH IPv4 server port                       : 1025
SSH IPv6 server port                       : 1025
ACL name                                   :
ACL number                                 :
ACL6 name                                  : 
ACL6 number                                :
SSH server ip-block                        : Enable</pre>
<p id="EN-US_TASK_0000001513053082__p19109101742115"># Check information about SSH users.</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen1910911719216">[<span class="keyword" id="EN-US_TASK_0000001513053082__keyword18109141732118"><font style="font-size:8pt" Face="Courier New" >~</font></span>SSH Server] <strong id="EN-US_TASK_0000001513053082__b510981716213">display ssh user-information</strong>
--------------------------------------------------------------------------------
User Name             : client001
Authentication type   : password
User public key name  : -
User public key type  : -
Sftp directory        : -
Service type          : stelnet

User Name             : client002
Authentication type   : rsa
User public key name  : -
User public key type  : -
Sftp directory        : -
Service type          : stelnet
--------------------------------------------------------------------------------
Total 2, 2 printed    </pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001513053082__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul id="EN-US_TASK_0000001513053082__ul09491044102013"><li id="EN-US_TASK_0000001513053082__li29492044172011"><p id="EN-US_TASK_0000001513053082__p894954419205"><a name="EN-US_TASK_0000001513053082__li29492044172011"></a><a name="li29492044172011"></a>SSH server</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen494904462019">#
sysname SSH Server
#
rsa peer-public-key rsakey001
 public-key-code begin
 3082010A
  02820101
    00A4BAB8 B964077E F7657F7F E4BE1DE8 71EE1707 E4EE2864 2D06FBE0 BFC1CB52
    F99B7A99 0132B709 3F841CA2 3544B8B2 6EE0A9ED 04B19FE3 FB3DA86D BE68FFE2
    2303108D BDC24B80 A1793A08 FDA0B6C1 13C31EA5 298EC9B1 2B0BC8BD 32CFF896
    29F8CA98 8B1724AF 5DA8A390 20906ADE 6A8AD77D 6234F0C8 DC965BA0 1771D9C0
    A89ED49B 5ECF7EE2 D5997527 FC87FE03 E51658C1 0996DFDF DC456376 2FA4B268
    4345131D 431419D2 DD5E4003 6A7D3295 145F3175 22E80686 E6B39A05 799D6BCF
    A78F69B6 BC2D0836 F5013421 77D68B89 A9EC182A 04B87BE3 500FCE14 9C95CF78
    75704359 0C70FD60 1EFC0B99 32F02142 4CE781E4 36A60BFC 2CBD07F6 9E700CEE
    4D
  0203
    010001
 public-key-code end
 peer-public-key end
#
aaa
 local-user client001 password irreversible-cipher $1d$v!=.5/:(q-$xL=\K+if"'S}&gt;k7vGP5$_ox0B@ys7.'DBHL<font style="font-size:8pt" Face="Courier New" >~</font>3*aN$
 local-user client001 service-type ssh
 local-user client001 privilege level 3
#
ssh server port 1025
stelnet server enable
ssh user client001
ssh user client001 authentication-type password
ssh user client001 service-type stelnet
ssh user client002
ssh user client002 authentication-type rsa
ssh user client002 assign rsa-key rsakey001
ssh user client002 service-type stelnet
ssh authorization-type default root 
ssh server-source all-interface
#
ssh server cipher aes128_ctr aes256_ctr aes192_ctr aes128_gcm aes256_gcm
ssh server hmac sha2_256 sha2_512
ssh server key-exchange dh_group_exchange_sha256 dh_group16_sha512
ssh server publickey rsa_sha2_256 rsa_sha2_512
ssh server dh-exchange min-len 3072
#
user-interface vty 0 4
 authentication-mode aaa
 protocol inbound ssh
#
return</pre>
</li><li id="EN-US_TASK_0000001513053082__li16950154452017"><p id="EN-US_TASK_0000001513053082__p139511544122012"><a name="EN-US_TASK_0000001513053082__li16950154452017"></a><a name="li16950154452017"></a>client001</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen17951134402012">#
sysname client001
#
ssh client first-time enable
#
ssh client cipher aes128_ctr aes256_ctr aes192_ctr aes128_gcm aes256_gcm
ssh client hmac sha2_256 sha2_512
ssh client key-exchange dh_group_exchange_sha256 dh_group16_sha512
ssh client publickey rsa_sha2_256 rsa_sha2_512
#
return</pre>
</li><li id="EN-US_TASK_0000001513053082__li895174419204"><p id="EN-US_TASK_0000001513053082__p49511644162015"><a name="EN-US_TASK_0000001513053082__li895174419204"></a><a name="li895174419204"></a>client002</p>
<pre class="screen" id="EN-US_TASK_0000001513053082__screen1195116442201">#
sysname client002
#
ssh client first-time enable
#
ssh client cipher aes128_ctr aes256_ctr aes192_ctr aes128_gcm aes256_gcm
ssh client hmac sha2_256 sha2_512
ssh client key-exchange dh_group_exchange_sha256 dh_group16_sha512
ssh client publickey rsa_sha2_256 rsa_sha2_512
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_login_cfg_0013.html">Configuring Remote Login Through STelnet
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_login_cfg_0031.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_login_cfg_0029.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>