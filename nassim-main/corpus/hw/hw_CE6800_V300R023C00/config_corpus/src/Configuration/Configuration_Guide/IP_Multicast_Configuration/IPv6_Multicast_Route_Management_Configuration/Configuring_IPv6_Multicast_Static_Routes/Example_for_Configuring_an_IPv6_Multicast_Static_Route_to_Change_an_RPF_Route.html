
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring an IPv6 Multicast Static Route to Change an RPF Route">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="vrp_mcastv6_cfg_0008.html">
<meta name="DC.Relation" scheme="URI" content="vrp_mcastv6_cfg_0011.html">
<meta name="DC.Relation" scheme="URI" content="vrp_mcastv6_cfg_0013.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="IPv6 Multicast Route Management">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="IPv6 Multicast Route Management">
<meta name="featuretype" content="IP Multicast">
<meta name="featurename" content="IPv6 Multicast Route Management">
<meta name="featuretype" content="IP Multicast">
<meta name="featuretype" content="IP Multicast">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001583800489">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring an IPv6 Multicast Static Route to Change an RPF Route</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001583800489"></a><a name="EN-US_TASK_0000001583800489"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring an IPv6 Multicast Static Route to Change an RPF Route</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001583800489__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><div class="p"><h4 class="sectiontitle">Networking Scenario</h4><p>In <a href="#EN-US_TASK_0000001583800489__fig125353144811">Figure 1</a>, IPv6 PIM-SM is running on the network, all devices support multicast, and the receiver can receive information from the multicast source. IPv6 IS-IS is running on DeviceA, DeviceB, DeviceC, and DeviceD. To change the RPF route so that the source-to-receiver multicast path is different from the unicast path, configure a multicast static route on the multicast network.</p>
<div class="fignone" id="EN-US_TASK_0000001583800489__fig125353144811"><a name="EN-US_TASK_0000001583800489__fig125353144811"></a><a name="fig125353144811"></a><span class="figcap"><b>Figure 1 </b>Network diagram of configuring an IPv6 multicast static route to change an RPF route</span><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface1, interface2, and interface3 represent <span>100GE</span> <span>1/0/1</span>, <span>100GE</span> <span>1/0/2</span>, and <span>100GE</span> <span>1/0/3</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001583680837.png"></span></div>
<h4 class="sectiontitle">Precautions</h4><p>Note the following during the configuration:</p>
<ul><li><p>When configuring a multicast static route, if the next hop is a P2P interface, you can specify the next hop through the outbound interface number. If the next hop is not a P2P interface, you must specify the next hop through the next-hop address.</p>
</li></ul>
<h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Assign an IPv6 address to each interface and configure IPv6 IS-IS as the unicast routing protocol.</p>
</li><li><p>Enable multicast routing on each device, enable IPv6 PIM-SM on each interface, and enable MLD on interfaces connected to hosts.</p>
</li><li><p>Configure a candidate-bootstrap router (C-BSR) and a candidate-rendezvous point (C-RP).</p>
</li><li><p>On DeviceB, configure a multicast static route that specifies DeviceC as the RPF neighbor to the source.</p>
</li></ol>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001583800489__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Configure interface IPv6 addresses and IS-IS on the devices.</span><p><p># Configure DeviceA.</p>
<pre class="screen">&lt;HUAWEI&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>sysname DeviceA</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>]<strong> commit</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>isis 1</strong>
[<span class="keyword">*</span>DeviceA-isis-1] <strong>network-entity 10.0000.0000.0001.00</strong>
[<span class="keyword">*</span>DeviceA-isis-1] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>DeviceA-isis-1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface </strong><strong><span>100GE</span> <span>1/0/1</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>undo </strong><strong>portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ipv6 address 2001:db8:4::1 64</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>isis ipv6 enable 1</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface </strong><strong><span>100GE</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>undo </strong><strong>portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>ipv6 address 2001:db8:5::1 64</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>isis ipv6 enable 1</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface </strong><strong><span>100GE</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>undo </strong><strong>portswitch</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>ipv6 enable</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>ipv6 address 2001:db8:3::1 64</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>isis ipv6 enable 1</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p>The configurations of DeviceB, DeviceC, and DeviceD are similar to the configuration of DeviceA. For detailed configurations, see Configuration Scripts.</p>
</p></li><li><span>Enable the multicast function on all the devices and enable IPv6 PIM-SM on all the involved interfaces.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>multicast ipv6 routing-enable</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface </strong><strong><span>100GE</span></strong> <strong><span>1/0/1</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface </strong><strong><span>100GE</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>pim ipv6 sm</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>interface </strong><strong><span>100GE</span> <span>1/0/3</span></strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>]<strong> pim ipv6 sm</strong>
[<span class="keyword">*</span>DeviceA-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceA] <strong>commit</strong></pre>
<p>The configurations of DeviceB, DeviceC, and DeviceD are similar to the configuration of DeviceA. For detailed configurations, see Configuration Scripts.</p>
</p></li><li><span>Enable MLD on the interfaces connected to user hosts.</span><p><p># Enable MLD on the interface connecting DeviceD to the host.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceD] <strong>interface </strong><strong><span>100GE</span> <span>1/0/2</span></strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/2</span>] <strong>mld enable</strong>
[<span class="keyword">*</span>DeviceD-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span class="keyword">*</span>DeviceD] <strong>commit</strong></pre>
</p></li><li><span>Configure a C-BSR and a C-RP.</span><p><p># Configure interface3 on DeviceC as the C-BSR and C-RP.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceC] <strong>pim ipv6</strong>
[<span class="keyword">*</span>DeviceC-pim6] <strong>c-bsr </strong><strong>2001:db8:3::2</strong>
[<span class="keyword">*</span>DeviceC-pim6] <strong>c-rp </strong><strong>2001:db8:3::2</strong>
[<span class="keyword">*</span>DeviceC-pim6] <strong>commit</strong></pre>
</p><p><p># Run the <a href="cmdqueryname=display+multicast+ipv6+rpf-info"><b><span class="cmdname">display multicast ipv6 rpf-info</span></b></a> command on DeviceB to check the RPF route to the source. The command output shows that the RPF route is a unicast route and the RPF neighbor is DeviceA. The displayed information is as follows:</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display multicast ipv6 rpf-info 2001:db8:5::</strong>
VPN-Instance: public net
RPF information about source 2001:db8:5::2:
     RPF interface: <strong><span>100GE</span></strong><strong><span>1/0/1</span></strong>, RPF neighbor: <strong>2001:db8:4::1</strong>
     Referenced route/mask: 2001:db8:5::/64
     Referenced route type: <strong>unicast</strong>
     Route selection rule: preference-preferred
     Load splitting rule: disable</pre>
</p></li><li><span>Configure a multicast static route.</span><p><p># Configure a multicast static route on DeviceB, and specify DeviceC as the RPF neighbor to the source.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>ipv6 rpf-route-static 2001:db8:5:: 64 2001:db8:2::2</strong>
[<span class="keyword">*</span>DeviceB] <strong>commit</strong></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001583800489__1.3.3"></a><a name="1.3.3"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Run the <a href="cmdqueryname=display+multicast+ipv6+rpf-info"><b><span class="cmdname">display multicast ipv6 rpf-info</span></b></a> command on DeviceB to check the RPF route to the source. The command output shows that the RPF route and the RPF neighbor have been updated according to the multicast static route. The displayed information is as follows:</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB] <strong>display multicast ipv6 rpf-info 2001:db8:5::</strong>
VPN-Instance: public net
RPF information about source 2001:db8:5::2:
     RPF interface: <strong><span>100GE</span></strong><strong><span>1/0/2</span></strong>, RPF neighbor: <strong>2001:db8:2::2</strong>
     Referenced route/mask: 2001:db8:5::/64
     Referenced route type:<strong>mstatic</strong>
     Route selection rule: preference-preferred
     Load splitting rule: disable</pre>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001583800489__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
multicast ipv6 routing-enable
#
isis 1
 ipv6 enable topology ipv6
 network-entity 10.0000.0000.0001.00
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:4::1/64
 pim ipv6 sm 
 isis ipv6 enable 1
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:5::1/64
 pim ipv6 sm 
 isis ipv6 enable 1
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:3::1/64
 pim ipv6 sm 
 isis ipv6 enable 1
#
return</pre>
</li><li><p>DeviceB</p>
<pre class="screen">#
sysname DeviceB
#
multicast ipv6 routing-enable
#
isis 1
 ipv6 enable topology ipv6
 network-entity 10.0000.0000.0002.00
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:4::2/64
 pim ipv6 sm 
 isis ipv6 enable 1
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:2::1/64
 pim ipv6 sm 
 isis ipv6 enable 1
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:1::2/64
 pim ipv6 sm 
 isis ipv6 enable 1
#
ipv6 rpf-route-static 2001:db8:5:: 64 2001:db8:2::2
#
return</pre>
</li><li><p>DeviceC</p>
<pre class="screen">#
sysname DeviceC
#
multicast ipv6 routing-enable
#
isis 1
 ipv6 enable topology ipv6
 network-entity 10.0000.0000.0003.00
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:2::2/64
 pim ipv6 sm 
 isis ipv6 enable 1
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:3::2/64
 pim ipv6 sm 
 isis ipv6 enable 1
#
pim ipv6
 c-bsr 2001:db8:3::2
 c-rp 2001:db8:3::2
#
return</pre>
</li><li><p>DeviceD</p>
<pre class="screen">#
sysname DeviceD
#
multicast ipv6 routing-enable
#
isis 1
 ipv6 enable topology ipv6
 network-entity 10.0000.0000.0004.00
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:6::1/64
 pim ipv6 sm 
 mld enable
 isis ipv6 enable 1
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:1::1/64
 pim ipv6 sm 
 isis ipv6 enable 1
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="vrp_mcastv6_cfg_0008.html">Configuring IPv6 Multicast Static Routes
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="vrp_mcastv6_cfg_0011.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="vrp_mcastv6_cfg_0013.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>