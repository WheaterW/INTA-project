
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="(Optional) Configuring the Device to Download a CA Certificate from the Bootstrap Server">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="galaxy_ztp_cfg_0029.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_ztp_cfg_0037.html">
<meta name="DC.Relation" scheme="URI" content="galaxy_ztp_cfg_0138.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="ZTP">
<meta name="featuretype" content="Basic Configuration">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="ZTP">
<meta name="featuretype" content="Basic Configuration">
<meta name="featurename" content="ZTP">
<meta name="featuretype" content="Basic Configuration">
<meta name="featurename" content="ZTP">
<meta name="featuretype" content="Basic Configuration">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001598162673">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="public_sys-resources/browseVersion.js"></script>
<title>(Optional) Configuring the Device to Download a CA Certificate from the Bootstrap Server</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001598162673"></a><a name="EN-US_TASK_0000001598162673"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">(Optional) Configuring the Device to Download a CA Certificate from the Bootstrap Server</h1>
<div class="taskbody"><p></p>
<div class="prereq" style="margin-left:0"><a name="EN-US_TASK_0000001598162673__1.4.1"></a><a name="1.4.1"></a><h4 class="sectiontitle">Prerequisites</h4>
<div class="p" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_prereq32308743172748"><p id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_p742372012505">The device has been deployed.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001598162673__1.4.2"></a><a name="1.4.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_context1677625172748"><p id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_p2051685191114">In the scenario where no initial certificate is available on iMaster NCE-Fabric, if the device needs to be managed by the controller, you need to import the CA certificate trusted by the controller to the device.</p>
<p id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_p77231238155813">The bootstrap server stores the CA certificate trusted by the controller. Currently, iMaster NCE-Fabric integrates the function of the bootstrap server. The device needs to download the CA certificate <strong id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_b580117103615">NCE-bootstrap.pem</strong> from the bootstrap server and import the certificate to the <strong id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_b15893407301">default</strong> domain.</p>
<p id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_p2432101713145">A maximum of 10 bootstrap servers can be configured for the device. The bootstrap servers with the same IP address and VPN instance name are considered as one bootstrap server. The interaction process between the device and bootstrap server is as follows:</p>
<ol id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_ol123495406140"><li id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_li143493409149">The device proactively establishes an HTTPS connection with a bootstrap server.</li><li id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_li166615105496">The device sends a request packet to the bootstrap server to download a CA certificate. The request packet carries the device ESN or the IP address of the bootstrap server.</li><li id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_li58631249195110">The bootstrap server searches for the CA certificate based on the ESN or IP address in the request packet and sends a response packet carrying the CA certificate to the device. The response packet also carries the device ESN or the IP address of the bootstrap server.</li><li id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_li20917169195318">After receiving the response packet from the bootstrap server, the device terminates the HTTPS connection with the bootstrap server, parses the response packet, and verifies the validity of the certificate. If the verification fails, the device cannot obtain the CA certificate. In this case, the device attempts to obtain the CA certificate from the next bootstrap server. The device will keep doing so until it successfully obtains a CA certificate.</li></ol>
<p id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_p1589954712536">After successfully obtaining the CA certificate <strong id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_b1253675316345">NCE-bootstrap.pem</strong> from the bootstrap server, the device automatically imports the certificate to the default domain.</p>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001598162673__1.4.3"></a><a name="1.4.3"></a><h4 class="sectiontitle">Procedure</h4>
<ol id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_steps10132325172748"><li id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_step5253145172748"><span id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmd7907968172748">Enter the system view.</span><p><pre class="screen" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_screen166121251194719"><a href="cmdqueryname=system-view"><b><span class="cmdname" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmdname176711445119">system-view</span></b></a></pre>
</p></li><li id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_step589014819558"><span id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmd1289098165511">Configure an SSL policy and bind it to the default domain.</span><p><pre class="screen" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_screen1352819125560"><a href="cmdqueryname=ssl+policy"><b><span class="cmdname" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmdname1152461618578">ssl policy</span></b></a> <i><span class="varname" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_varname84331224195717">policy-name</span></i>
<a href="cmdqueryname=pki-domain"><b><span class="cmdname" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmdname109512995716">pki-domain</span></b></a><strong id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_b1346111185717"> </strong><strong><span id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmdparmname10639103345713">default</span></strong>
<a href="cmdqueryname=quit"><b><span class="cmdname" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmdname10136173015475">quit</span></b></a></pre>
</p></li><li id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_step858111115479"><span id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmd458181124719">Configure the device to download a CA certificate from the bootstrap server. </span><p><pre class="screen" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_screen937917411482"><a href="cmdqueryname=ztp+certificate-remote"><b><span class="cmdname" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmdname726119374489">ztp certificate-remote</span></b></a> { <i><span class="varname" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_varname1841654919488">ipv4-addr</span></i> | <strong><span id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmdparmname569811532485">ipv6</span></strong> <i><span class="varname" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_varname34121836499">ipv6-addr</span></i> } [ <strong><span id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmdparmname16322998494">vpn-instance</span></strong> <i><span class="varname" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_varname122361921114914">vpnvalue</span></i> ] <strong><span id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmdparmname1995882684918">port</span></strong> <i><span class="varname" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_varname05902382495">portvalue</span></i> <strong><span id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmdparmname78941342174912">ssl-policy</span></strong> <i><span class="varname" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_varname1245455215490">policyname</span></i> [ <strong><span id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmdparmname1181416576498">verify-type esn</span></strong> ]</pre>
<p id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_p141787515015">By default, the device is not configured to download a CA certificate from the bootstrap server.</p>
<p id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_p1672314755313">When the <strong><span id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmdparmname1432218915412">verify-type esn</span></strong> parameter is specified, a certificate is authenticated based on the device ESN. That is, the request packet sent by the device to the bootstrap server for downloading the CA certificate carries the device ESN. When parsing the response packet from the bootstrap server, the device uses the ESN for verification.</p>
<p id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_p15243036115812">When the <strong><span id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmdparmname7411165882116">verify-type esn</span></strong> parameter is not specified, a certificate is authenticated based on the IP address of the bootstrap server. That is, the request packet sent by the device to the bootstrap server for downloading the CA certificate carries the IP address of the bootstrap server. When parsing the response packet from the bootstrap server, the device uses the IP address for verification.</p>
<p id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_p178161152105012">After <strong id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_b35181712113720">NCE-bootstrap.pem</strong> is imported to the <strong id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_b0197181413339">default</strong> domain, if another CA certificate needs to be downloaded from the bootstrap server, delete the original certificate from the <strong id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_b281424623319">default</strong> domain and run the <a href="cmdqueryname=ztp+certificate-remote"><b><span class="cmdname" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_cmdname18782161710528">ztp certificate-remote</span></b></a> command again.</p>
</p></li><li id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_step12655154411714"><span id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_en-us_task_0228023023_cmd10380203014117">Commit the configuration.</span><p><pre class="screen" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_en-us_task_0228023023_screen163801330213"><a href="cmdqueryname=commit"><b><span class="cmdname" id="EN-US_TASK_0000001598162673__en-us_task_0000001513154398_en-us_task_0000001346322101_en-us_task_0228023023_en-us_concept_0141113565_cmdname1667501373175340">commit</span></b></a></pre>
</p></li></ol></div>
</div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="galaxy_ztp_cfg_0029.html">Configuring DHCP-based ZTP (Without a Controller)
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="galaxy_ztp_cfg_0037.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="galaxy_ztp_cfg_0138.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>