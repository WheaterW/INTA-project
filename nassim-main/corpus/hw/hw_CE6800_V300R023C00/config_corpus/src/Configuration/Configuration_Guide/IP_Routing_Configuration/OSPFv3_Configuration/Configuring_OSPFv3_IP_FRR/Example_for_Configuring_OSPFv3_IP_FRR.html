
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring OSPFv3 IP FRR">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospfv3_cfg_0078_copy.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospfv3_cfg_0082_copy.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPFv3">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176662793">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring OSPFv3 IP FRR</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176662793"></a><a name="EN-US_TASK_0000001176662793"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring OSPFv3 IP FRR</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176662793__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>If a fault occurs on a network, OSPFv3 IP FRR can rapidly switch traffic to the backup link without waiting for route convergence, ensuring uninterrupted traffic transmission.</p>
<div class="p">On the network shown in <a href="#EN-US_TASK_0000001176662793__en-us_task_0275858023_fig_dc_vrp_ospfv3_cfg_206601">Figure 1</a>:<ul><li>OSPFv3 runs on all devices.</li><li>The link costs meet the OSPFv3 IP FRR inequality.</li><li><p>If the primary link (link T) fails, DeviceS immediately switches traffic to the backup link, which passes through DeviceN.</p>
</li><li>Based on the network planning, the link that passes through DeviceA does not function as an FRR backup link.</li></ul>
</div>
<div class="fignone" id="EN-US_TASK_0000001176662793__en-us_task_0275858023_fig_dc_vrp_ospfv3_cfg_206601"><a name="EN-US_TASK_0000001176662793__en-us_task_0275858023_fig_dc_vrp_ospfv3_cfg_206601"></a><a name="en-us_task_0275858023_fig_dc_vrp_ospfv3_cfg_206601"></a><span class="figcap"><b>Figure 1 </b>Network diagram of OSPFv3 IP FRR</span><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1, interface 2, interface 3, and interface 4 represent <span>100GE</span><span>1/0/1</span>, <span>100GE</span><span>1/0/2</span>, <span>100GE</span><span>1/0/3</span>, and <span>100GE</span><span>1/0/4</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001229682725.png" width="NaN" height="NaN"></span></div>

<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Device interfaces and IP addresses</caption><thead align="left"><tr><th align="left" class="cellrowborder" char="." valign="top" width="25%" id="mcps1.3.1.5.2.5.1.1" liSelected="liSelected"><p>Device</p>
</th>
<th align="left" class="cellrowborder" char="." valign="top" width="25%" id="mcps1.3.1.5.2.5.1.2" liSelected="liSelected"><p>Router ID</p>
</th>
<th align="left" class="cellrowborder" char="." valign="top" width="25%" id="mcps1.3.1.5.2.5.1.3" liSelected="liSelected"><p>Interface</p>
</th>
<th align="left" class="cellrowborder" char="." valign="top" width="25%" id="mcps1.3.1.5.2.5.1.4" liSelected="liSelected"><p>IPv6 Address</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" rowspan="3" char="." valign="top" width="25%" headers="mcps1.3.1.5.2.5.1.1 "><p>DeviceS</p>
</td>
<td class="cellrowborder" rowspan="3" char="." valign="top" width="25%" headers="mcps1.3.1.5.2.5.1.2 "><p>1.1.1.1</p>
</td>
<td class="cellrowborder" char="." valign="top" width="25%" headers="mcps1.3.1.5.2.5.1.3 "><p><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="25%" headers="mcps1.3.1.5.2.5.1.4 "><p>2001:DB8:1000::1/96</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.3.1.5.2.5.1.1 "><p><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.3.1.5.2.5.1.2 "><p>2001:DB8:1001::1/96</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.3.1.5.2.5.1.1 "><p><span>100GE</span><span>1/0/3</span></p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.3.1.5.2.5.1.2 "><p>2001:DB8:1002::1/96</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" char="." valign="top" width="25%" headers="mcps1.3.1.5.2.5.1.1 "><p>DeviceA</p>
</td>
<td class="cellrowborder" rowspan="2" char="." valign="top" width="25%" headers="mcps1.3.1.5.2.5.1.2 "><p>2.2.2.2</p>
</td>
<td class="cellrowborder" char="." valign="top" width="25%" headers="mcps1.3.1.5.2.5.1.3 "><p><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="25%" headers="mcps1.3.1.5.2.5.1.4 "><p>2001:DB8:1000::2/96</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.3.1.5.2.5.1.1 "><p><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.3.1.5.2.5.1.2 "><p>2001:DB8:2000::2/96</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="2" char="." valign="top" width="25%" headers="mcps1.3.1.5.2.5.1.1 "><p>DeviceN</p>
</td>
<td class="cellrowborder" rowspan="2" char="." valign="top" width="25%" headers="mcps1.3.1.5.2.5.1.2 "><p>3.3.3.3</p>
</td>
<td class="cellrowborder" char="." valign="top" width="25%" headers="mcps1.3.1.5.2.5.1.3 "><p><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="25%" headers="mcps1.3.1.5.2.5.1.4 "><p>2001:DB8:1002::2/96</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.3.1.5.2.5.1.1 "><p><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.3.1.5.2.5.1.2 "><p>2001:DB8:2002::2/96</p>
</td>
</tr>
<tr><td class="cellrowborder" rowspan="4" char="." valign="top" width="25%" headers="mcps1.3.1.5.2.5.1.1 "><p>DeviceE</p>
</td>
<td class="cellrowborder" rowspan="4" char="." valign="top" width="25%" headers="mcps1.3.1.5.2.5.1.2 "><p>4.4.4.4</p>
</td>
<td class="cellrowborder" char="." valign="top" width="25%" headers="mcps1.3.1.5.2.5.1.3 "><p><span>100GE</span><span>1/0/1</span></p>
</td>
<td class="cellrowborder" char="." valign="top" width="25%" headers="mcps1.3.1.5.2.5.1.4 "><p>2001:DB8:2000::1/96</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.3.1.5.2.5.1.1 "><p><span>100GE</span><span>1/0/2</span></p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.3.1.5.2.5.1.2 "><p>2001:DB8:2001::1/96</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.3.1.5.2.5.1.1 "><p><span>100GE</span><span>1/0/3</span></p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.3.1.5.2.5.1.2 "><p>2001:DB8:2002::1/96</p>
</td>
</tr>
<tr><td class="cellrowborder" char="." valign="top" headers="mcps1.3.1.5.2.5.1.1 "><p><span>100GE</span><span>1/0/4</span></p>
</td>
<td class="cellrowborder" char="." valign="top" headers="mcps1.3.1.5.2.5.1.2 "><p>2001:DB8:3000::1/96</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176662793__1.3.2"></a><a name="1.3.2"></a><h4 class="sectiontitle">Context</h4>
<div class="p"><p>Note the following during the configuration:</p>
<p>Before configuring OSPFv3 IP FRR, block FRR on certain interfaces to prevent the links connected to these interfaces from functioning as backup links. This prevents the links connected to these interfaces from being calculated as backup links during FRR calculation.</p>
<p>When OSPFv3 IP FRR is configured, the underlying layer must be able to quickly respond to link changes so that traffic can be quickly switched to the backup link. After the <a href="cmdqueryname=bfd+all-interfaces"><b><span class="cmdname">bfd all-interfaces</span></b></a> <strong><span>frr-binding</span></strong> command is run, the BFD session status is bound to the link status of the interface (when the BFD session goes down, the link status of the interface also goes down). In this manner, faults can be rapidly detected.</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176662793__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>To improve security, you are advised to deploy OSPFv3 authentication. For details, see "Configuring OSPFv3 Authentication." OSPFv3 area authentication is used as an example. For details, see "Example for Configuring Basic OSPFv3 Functions."</p>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176662793__1.3.4"></a><a name="1.3.4"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><div class="p">The configuration roadmap is as follows:<ol><li><p>Configure basic OSPFv3 functions on each device involved. (For detailed configurations, see <a href="vrp_ospfv3_cfg_0017.html">Example for Configuring Basic OSPFv3 Functions</a>.) </p>
</li><li><p>Configure BFD for OSPFv3 on all the devices in area 0.</p>
</li><li><p>Set link costs to ensure that link T is preferentially selected to transmit traffic.</p>
</li><li><p>Disable FRR on a specified interface of DeviceS.</p>
</li><li>Enable OSPFv3 IP FRR on DeviceS to protect the traffic it forwards.</li></ol>
</div>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176662793__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IPv6 address to each interface involved. For detailed configurations, see <a href="#EN-US_TASK_0000001176662793__en-us_task_0275858023_postreq117470469436">Configuration Scripts</a>.</span></li><li><span>Configure basic OSPFv3 functions. For detailed configurations, see <a href="vrp_ospfv3_cfg_0017.html">Example for Configuring Basic OSPFv3 Functions</a>.</span></li><li><span>Configure BFD for OSPFv3 on all the devices in area 0. For detailed configurations, see <a href="vrp_ospfv3_cfg_0077_copy.html">Example for Configuring BFD for OSPFv3</a>.</span></li><li><span>Set link costs to ensure that link T is preferentially selected to transmit traffic.</span><p><p># Configure DeviceS.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceS] <strong>interface <span>100ge</span><span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceS-<span>100GE</span><span>1/0/1</span>] <strong>ospfv3 cost 5</strong>
[<span><span class="keyword">*</span></span>DeviceS-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceS] <strong>interface <span>100ge</span><span>1/0/2</span></strong>
[<span><span class="keyword">*</span></span>DeviceS-<span>100GE</span><span>1/0/2</span>] <strong>ospfv3 cost 20</strong>
[<span><span class="keyword">*</span></span>DeviceS-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceS] <strong>interface <span>100ge</span><span>1/0/3</span></strong>
[<span><span class="keyword">*</span></span>DeviceS-<span>100GE</span><span>1/0/3</span>] <strong>ospfv3 cost 10</strong>
[<span><span class="keyword">*</span></span>DeviceS-<span>100GE</span><span>1/0/3</span>] <strong>quit</strong>
<span>[<span><span class="keyword">*</span></span>DeviceS] <strong>commit</strong></span></pre>
</p><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA] <strong>interface <span>100ge</span><span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>ospfv3 cost 5</strong>
[<span><span class="keyword">*</span></span>DeviceA-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceA] <strong>interface <span>100ge</span><span>1/0/2</span></strong>
[<span><span class="keyword">*</span></span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>ospfv3 cost 5</strong>
[<span><span class="keyword">*</span></span>DeviceA-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
<span>[<span><span class="keyword">*</span></span>DeviceA] <strong>commit</strong></span></pre>
</p><p><p># Configure DeviceN.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceN] <strong>interface <span>100ge</span><span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceN-<span>100GE</span><span>1/0/1</span>] <strong>ospfv3 cost 10</strong>
[<span><span class="keyword">*</span></span>DeviceN-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceN] <strong>interface <span>100ge</span><span>1/0/2</span></strong>
[<span><span class="keyword">*</span></span>DeviceN-<span>100GE</span><span>1/0/2</span>] <strong>ospfv3 cost 10</strong>
[<span><span class="keyword">*</span></span>DeviceN-<span>100GE</span><span>1/0/2</span>] <strong>quit</strong>
<span>[<span><span class="keyword">*</span></span>DeviceN] <strong>commit</strong></span></pre>
</p></li><li><span>Disable FRR on a specified interface of DeviceS.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceS] <strong>interface <span>100ge</span><span>1/0/1</span></strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceS-<span>100GE</span><span>1/0/1</span>] <strong>ospfv3 frr block</strong>
[<span><span class="keyword">*</span></span>DeviceS-<span>100GE</span><span>1/0/1</span>] <strong>quit</strong>
<span>[<span><span class="keyword">*</span></span>DeviceS] <strong>commit</strong></span></pre>
</p></li><li><span>Enable OSPFv3 IP FRR on DeviceS.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceS] <strong>ospfv3</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceS-ospfv3-1] <strong>frr</strong>
[<span><span class="keyword">*</span></span>DeviceS-ospfv3-1-frr] <strong>loop-free-alternate</strong>
[<span><span class="keyword">*</span></span>DeviceS-ospfv3-1-frr] <strong>quit</strong>
[<span><span class="keyword">*</span></span>DeviceS-ospfv3-1] <strong>quit</strong>
<span>[<span><span class="keyword">*</span></span>DeviceS] <strong>commit</strong></span></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001176662793__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Run the <strong>display ospfv3 routing</strong> command on DeviceS to check the routing information.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceS] <strong>display ospfv3 routing 2001:db8:3000::1 96</strong>
 Codes : E2 - Type 2 External, E1 - Type 1 External, IA - Inter-Area
 OSPFv3 Process (1)
   Destination                                Metric
     Nexthop
   2001:DB8:2000:1::/64                       3124
<strong>       via 2001:DB8:2001::1/96, <span>100GE</span><span>1/0/2</span>           backup via FE80::2000:10FF:4, <span>100GE</span><span>1/0/3</span>, LFA LINK-NODE</strong>
     Priority      :Low</pre>
<p>The command output shows that a backup link has been generated through FRR calculation on DeviceS.</p>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001176662793__en-us_task_0275858023_postreq117470469436"></a><a name="en-us_task_0275858023_postreq117470469436"></a><a name="EN-US_TASK_0000001176662793__1.3.7"></a><a name="1.3.7"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceS</p>
<pre class="screen">#
sysname DeviceS
#
bfd
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:1000::1/96
 ospfv3 1 area 0.0.0.1
 ospfv3 cost 5
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:1001::1/96
 ospfv3 1 area 0.0.0.1
 ospfv3 cost 15
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:1002::1/96
 ospfv3 1 area 0.0.0.1
 ospfv3 frr block
 ospfv3 cost 10
#
ospfv3 1 
 router-id 1.1.1.1
 bfd all-interfaces enable
 bfd all-interfaces frr-binding
 frr
  loop-free-alternate
 area 0.0.0.1
#
return</pre>
</li><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#  
bfd
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:1000::2/96
 ospfv3 1 area 0.0.0.1
 ospfv3 cost 5
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:2000::2/96
 ospfv3 1 area 0.0.0.1
 ospfv3 cost 5
#
ospfv3 1
 router-id 2.2.2.2
 bfd all-interfaces enable
 bfd all-interfaces frr-binding
 frr
  loop-free-alternate
 area 0.0.0.1
#
return</pre>
</li><li><p>DeviceN</p>
<pre class="screen">#
sysname DeviceN
#
bfd
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:1002::2/96
 ospfv3 1 area 0.0.0.1
 ospfv3 cost 10
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:2002::2/96
 ospfv3 1 area 0.0.0.1
 ospfv3 cost 10
#
ospfv3 1 
 router-id 3.3.3.3
 bfd all-interfaces enable
 bfd all-interfaces frr-binding
 frr
 area 0.0.0.1
#
return</pre>
</li><li><p>DeviceE</p>
<pre class="screen">#
sysname DeviceE
#
bfd
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:2000::1/96
 ospfv3 1 area 0.0.0.1
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:2001::1/96
 ospfv3 1 area 0.0.0.1
#
interface <span>100GE</span><span>1/0/3</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:2002::1/96
 ospfv3 1 area 0.0.0.1
#
interface <span>100GE</span><span>1/0/4</span>
 undo portswitch
 ipv6 enable
 ipv6 address 2001:db8:3000::1/96
 ospfv3 1 area 0.0.0.1
 ospfv3 cost 5
#
ospfv3 1
 router-id 4.4.4.4
 bfd all-interfaces enable
 bfd all-interfaces frr-binding
 area 0.0.0.1
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_ospfv3_cfg_0078_copy.html">Configuring OSPFv3 IP FRR
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_ospfv3_cfg_0082_copy.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>