
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Example for Configuring an OSPF Virtual Link">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0036.html">
<meta name="DC.Relation" scheme="URI" content="../vrp/vrp_ospf_cfg_0039.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation">
<meta name="DC.Publisher" content="20230413">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Audience.Job" content="Configuration">
<meta name="featurename" content="OSPF">
<meta name="featuretype" content="IP Routing">
<meta name="featuretype" content="IP Routing">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TASK_0000001176742887">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../public_sys-resources/browseVersion.js"></script>
<title>Example for Configuring an OSPF Virtual Link</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_TASK_0000001176742887"></a><a name="EN-US_TASK_0000001176742887"></a>

<div class="articleBoxWithoutHead">
<h1 class="topicTitle-h1">Example for Configuring an OSPF Virtual Link</h1>
<div class="taskbody"><div class="context"><a name="EN-US_TASK_0000001176742887__1.3.1"></a><a name="1.3.1"></a>
<div class="p"><h4 class="sectiontitle">Networking Requirements</h4><p>As shown in <a href="#EN-US_TASK_0000001176742887__fig_dc_vrp_ospf_cfg_205401">Figure 1</a>, area 2 is not directly connected to the backbone area (area 0). Area 1 serves as a transit area to connect area 2 and area 0, and a virtual link is configured between DeviceA and DeviceB.</p>
<div class="fignone" id="EN-US_TASK_0000001176742887__fig_dc_vrp_ospf_cfg_205401"><a name="EN-US_TASK_0000001176742887__fig_dc_vrp_ospf_cfg_205401"></a><a name="fig_dc_vrp_ospf_cfg_205401"></a><span class="figcap"><b>Figure 1 </b>Network diagram of OSPF virtual link configuration</span><div class="note"><img src="../public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>In this example, interface 1 and interface 2 represent <span>100GE</span> <span>1/0/1</span> and <span>100GE</span> <span>1/0/2</span>, respectively.</p>
</div></div>
<br><span><img class="vsd" src="figure/en-us_image_0000001130623496.png"></span><div class="tableBorder"><table cellpadding="4" cellspacing="0" summary=""><tr><td valign="top"><p>Device</p>
</td>
<td valign="top"><p>Router ID</p>
</td>
<td valign="top"><p>Process ID</p>
</td>
<td valign="top"><p>IP Address</p>
</td>
</tr>
<tr><td valign="top"><p>DeviceA</p>
</td>
<td valign="top"><p>1.1.1.1</p>
</td>
<td valign="top"><p>1</p>
</td>
<td valign="top"><p>Area 0: 10.0.0.0/8</p>
<p>Area 1: 192.168.1.0/24</p>
</td>
</tr>
<tr><td valign="top"><p>DeviceB</p>
</td>
<td valign="top"><p>2.2.2.2</p>
</td>
<td valign="top"><p>1</p>
</td>
<td valign="top"><p>Area 1: 192.168.1.0/24</p>
<p>Area 2: 172.16.0.0/16</p>
</td>
</tr>
<tr><td valign="top"><p>DeviceC</p>
</td>
<td valign="top"><p>3.3.3.3</p>
</td>
<td valign="top"><p>1</p>
</td>
<td valign="top"><p>Area 0: 10.0.0.0/8</p>
</td>
</tr>
<tr><td valign="top"><p>DeviceD</p>
</td>
<td valign="top"><p>4.4.4.4</p>
</td>
<td valign="top"><p>1</p>
</td>
<td valign="top"><p>Area 2: 172.16.0.0/16</p>
</td>
</tr>
</table></div>
</div>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176742887__1.3.2"></a><a name="1.3.2"></a>
<div class="p"><h4 class="sectiontitle">Precautions</h4><p>The default parameter values are recommended when a virtual link is configured; however, you can modify the parameter values according to the actual scenario:</p>
<ul><li>The smaller the <a href="cmdqueryname=hello"><b><span class="cmdname">hello</span></b></a> value, the faster the device detects network topology changes, but the more network resources are consumed.</li><li>If <a href="cmdqueryname=retransmit"><b><span class="cmdname">retransmit</span></b></a> is set to too small a value, unnecessary LSA retransmission may occur. Therefore, setting the parameter to a large value is recommended on a low-speed network.</li><li>The authentication modes of a virtual link and the backbone area must be the same.</li><li>To improve security, OSPF area authentication or interface authentication is recommended. For details, see "Improving OSPF Network Security." OSPF area authentication is used as an example. For details, see "Example for Configuring Basic OSPF Functions."</li></ul>
</div></div>
<div class="context"><a name="EN-US_TASK_0000001176742887__1.3.3"></a><a name="1.3.3"></a>
<div class="p"><h4 class="sectiontitle">Configuration Roadmap</h4><p>The configuration roadmap is as follows:</p>
<ol><li><p>Configure basic OSPF functions on each device.</p>
</li><li><p>Configure a virtual link between DeviceA and DeviceB to connect a non-backbone area to the backbone area.</p>
</li></ol>
</div></div>
<div class="steps"><a name="EN-US_TASK_0000001176742887__1.3.4"></a><a name="1.3.4"></a><h4 class="sectiontitle">Procedure</h4>
<ol><li><span>Assign an IP address to each interface.</span><p><p>Assign an IP address to each interface according to <a href="#EN-US_TASK_0000001176742887__fig_dc_vrp_ospf_cfg_205401">Figure 1</a>. For detailed configurations, see <a href="#EN-US_TASK_0000001176742887__postreq24192593172748">Configuration Scripts</a>.</p>
</p></li><li><span>Configure basic OSPF functions.</span><p><p>For detailed configurations, see the configuration scripts.</p>
</p></li><li><span>Check information about the OSPF routing table on DeviceA.</span><p><pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> display ospf routing</strong></pre>
<pre class="screen">          OSPF Process 1 with Router ID 1.1.1.1
                   Routing Tables

 Routing for Network
 Destination        Cost       Type       NextHop         AdvRouter       Area
 10.0.0.0/8         1          Transit    10.1.1.1        3.3.3.3         0.0.0.0
 192.168.1.0/24     1          Transit    192.168.1.1     1.1.1.1         0.0.0.1

 Total Nets: 2
 Intra Area: 2  Inter Area: 0  ASE: 0  NSSA: 0    </pre>
<p>The routing table on DeviceA contains no route in area 2, because area 2 is not directly connected to area 0.</p>
</p></li><li><span>Configure a virtual link.</span><p><p># Configure DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> router id 1.1.1.1</strong>
[<span><span class="keyword">*</span></span>DeviceA]<strong> ospf 1</strong>
[<span class="keyword">*</span>DeviceA-ospf-1]<strong> area 1</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.1]<strong> vlink-peer 2.2.2.2</strong>
[<span class="keyword">*</span>DeviceA-ospf-1-area-0.0.0.1]<strong> quit</strong>
[<span class="keyword">*</span>DeviceA-ospf-1]<strong> quit</strong>
<span>[<span class="keyword">*</span>DeviceA] <strong>commit</strong></span></pre>
<p># Configure DeviceB.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceB]<strong> router id 2.2.2.2</strong>
[<span class="keyword">*</span>DeviceB] <strong>ospf 1</strong>
[<span class="keyword">*</span>DeviceB-ospf-1]<strong> area 1</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.1]<strong> vlink-peer 1.1.1.1</strong>
[<span class="keyword">*</span>DeviceB-ospf-1-area-0.0.0.1] <strong>quit</strong>
[<span class="keyword">*</span>DeviceB-ospf-1] <strong>quit</strong>
<span>[<span class="keyword">*</span>DeviceB] <strong>commit</strong></span></pre>
</p></li></ol></div>
<div class="example"><a name="EN-US_TASK_0000001176742887__1.3.5"></a><a name="1.3.5"></a><h4 class="sectiontitle">Verifying the Configuration</h4><p># Check the OSPF virtual link information on DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> display ospf vlink</strong></pre>
<pre class="screen">          OSPF Process 1 with Router ID 1.1.1.1
                  Virtual Links
 Virtual-link Neighbor-id  -&gt; 2.2.2.2, Neighbor-State: <strong>Full</strong>
 Interface: 192.168.1.1 (<span>100GE</span><span>1/0/1</span>)
 Cost: 1  State: P-2-P  Type: Virtual
 Transit Area: 0.0.0.1
 Timers: Hello 10 , Dead 40 , Retransmit 5 , Transmit Delay 1
 GR State: Normal</pre>
<p>The preceding command output shows that the OSPF virtual link neighbor relationship is in Full state, indicating that the virtual link is configured successfully.</p>
<p># Check information about the OSPF routing table on DeviceA.</p>
<pre class="screen">[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span>DeviceA]<strong> display ospf routing</strong></pre>
<pre class="screen">          OSPF Process 1 with Router ID 1.1.1.1
                   Routing Tables

 Routing for Network
 Destination        Cost       Type       NextHop         AdvRouter       Area
<strong> 172.16.0.0/16      2          Inter-area 192.168.1.2     2.2.2.2         0.0.0.2</strong>
 10.0.0.0/8         1          Transit    10.1.1.1        1.1.1.1         0.0.0.0
 192.168.1.0/24     1          Transit    192.168.1.1     1.1.1.1         0.0.0.1

 Total Nets: 3
 Intra Area: 2  Inter Area: 1  ASE: 0  NSSA: 0    </pre>
<p>After the virtual link is configured, the routing table on DeviceA contains the route in area 2.</p>
</div>
<div class="postreq"><a name="EN-US_TASK_0000001176742887__postreq24192593172748"></a><a name="postreq24192593172748"></a><a name="EN-US_TASK_0000001176742887__1.3.6"></a><a name="1.3.6"></a><h4 class="sectiontitle">Configuration Scripts</h4><ul><li><p>DeviceA</p>
<pre class="screen">#
sysname DeviceA
#
router id 1.1.1.1
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.1.1 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.1.1.1 255.0.0.0
#
ospf 1
 area 0.0.0.0
  network 10.0.0.0 0.255.255.255
 area 0.0.0.1
  network 192.168.1.0 0.0.0.255
  vlink-peer 2.2.2.2
#
return</pre>
</li><li><p>DeviceB</p>
<pre class="screen">#
sysname DeviceB
#
router id 2.2.2.2
#
interface <span>100GE</span><span>1/0/1</span>
 undo portswitch
 ip address 192.168.1.2 255.255.255.0
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 172.16.1.1 255.255.0.0
#
ospf 1
 area 0.0.0.1
  network 192.168.1.0 0.0.0.255
  vlink-peer 1.1.1.1
 area 0.0.0.2
  network 172.16.0.0 0.0.255.255
#
return</pre>
</li><li><p>DeviceC</p>
<pre class="screen">#
sysname DeviceC
#
router id 3.3.3.3
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 10.1.1.2 255.0.0.0
#
ospf 1
 area 0.0.0.0
  network 10.0.0.0 0.255.255.255
#
return</pre>
</li><li><p>DeviceD</p>
<pre class="screen">#
sysname DeviceD
#
router id 4.4.4.4
#
interface <span>100GE</span><span>1/0/2</span>
 undo portswitch
 ip address 172.16.1.2 255.255.0.0
#
ospf 1
 area 0.0.0.2
  network 172.16.0.0 0.0.255.255
#
return</pre>
</li></ul>
</div></div>

</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../vrp/vrp_ospf_cfg_0036.html">Configuring an OSPF Virtual Link
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../vrp/vrp_ospf_cfg_0039.html"><span class="font-st">&lt; </span>Previous topic</a>
</div>
</div>
</body>
</html>