Overview of NPCC
================

Overview of NPCC

#### Definition

Network-based Proactive Congestion Control (NPCC) is a technology that accurately controls the rate at which a server sends Remote Direct Memory Access (RDMA) over Converged Ethernet version 2 (RoCEv2) packets based on the congestion status of a network device's port connected to the server.


#### Purpose

Data Center Quantized Congestion Notification (DCQCN) is the most widely used congestion control algorithm on RoCEv2 networks. It provides a congestion control mechanism that relieves congestion as follows: After a network device detects congestion, it sends an Explicit Congestion Notification (ECN)-marked packet to the server at the receive end (receiver), which then sends a Congestion Notification Packet (CNP) to the server at the transmit end (sender), notifying the sender to reduce its packet transmission rate.

There are some problems with this mechanism of DCQCN:

* Slow response: Congestion occurs on a network device but the CNP is sent by the final receiver. This means that if the network scale is large, a long congestion feedback path may cause the sender unable to reduce the packet transmission rate in a timely manner or even to increase the rate in advance, further exacerbating congestion.
* Inaccurate response: The network congestion status can be obtained only through the ECN field in a packet, and a certain number of CNPs generated by the receiver cannot accurately relieve the congestion. In addition, in a congestion relief process, the network device (known as the forwarding device) continues to perform ECN marking, which easily leads to a low throughput.

The Intelligent Quantized Congestion Notification (iQCN) function provided by the intelligent lossless network enables the forwarding device to compare the interval for receiving CNPs with the sender's NIC rate increase time and send extra CNPs for compensation accordingly. This prevents the sender from increasing the rate in advance. However, iQCN still relies on the CNPs sent by the receiver for compensation determination, which is considered passive congestion control. In a long-distance communication scenario with relative long transmission latency such as Data Center Interconnect (DCI), this cannot effectively prevent congestion from worsening.

To address the preceding issues, the intelligent lossless network provides the NPCC function, which enables network devices to intelligently identify the congestion status and proactively send CNPs to accurately control the rate at which servers send RoCEv2 packets. This ensures timely rate reduction upon congestion and prevents excessive rate reduction when congestion is relieved, thus ensuring low latency and high throughput of RoCEv2 services in long-distance communication scenarios such as DCI.