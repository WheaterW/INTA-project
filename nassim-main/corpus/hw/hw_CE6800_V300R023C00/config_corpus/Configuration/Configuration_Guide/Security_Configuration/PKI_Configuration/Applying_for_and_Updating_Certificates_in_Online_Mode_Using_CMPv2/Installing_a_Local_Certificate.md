Installing a Local Certificate
==============================

Installing a Local Certificate

#### Context

The system automatically saves the local certificate that has been obtained online using CMPv2 to **flash:/pki/public**.

After the local certificate is stored in the preceding directory, you need to manually import the certificate into the device memory. After the device restarts, the system automatically loads the certificate.

![](public_sys-resources/note_3.0-en-us.png) 

To prevent a certificate installation failure, ensure that the local certificate file size does not exceed 1 MB.

The initial local certificate that identifies a Huawei device provides certificate authentication for user login services of the device by default.



#### Procedure

1. Enter the system view.
   
   
   ```
   [system-view](cmdqueryname=system-view)
   ```
2. Import the local certificate into the device memory.
   
   
   * When applying for a local certificate from the CA based on the PKI entity information and RSA key pair created in the local PKI entity, you only need to run the following command to import the local certificate into the device memory. The RSA key pair has been imported into the device memory by default during the creation of the RSA key pair.
     ```
     [pki import-certificate](cmdqueryname=pki+import-certificate) local [ [ realm realm-name ] { der | pkcs12 | pem } ] filename file-name [ cert-name cert-name ] [ no-check-hash-alg ] [ no-check-same-name ]
     ```
   * If you need to use the key pair generated by another PKI entity and the certificate of another PKI entity, you need to import both the certificate and key pair. A key pair file can either be included in a certificate file or exist independently of the certificate file. The methods of importing a key pair file vary accordingly.Select a method of importing a key pair file accordingly.
     + If the key pair file is included in a certificate file:
       ```
       [pki import rsa-key-pair](cmdqueryname=pki+import+rsa-key-pair) keyname { [pem](cmdqueryname=pem) | [pkcs12](cmdqueryname=pkcs12) } filename [ exportable ] [ [password](cmdqueryname=password) password ]
       ```
     + If the key pair file exists independently of the certificate file:# Import the certificate file.
       ```
       [pki import-certificate](cmdqueryname=pki+import-certificate) local [ [ realm realm-name ] { der | pkcs12 | pem } ] filename file-name [ cert-name cert-name ] [ no-check-hash-alg ] [ no-check-same-name ]
       ```
       
       # Import the key pair file.
       ```
       [pki import rsa-key-pair](cmdqueryname=pki+import+rsa-key-pair) keyname exclude-cert { [pem](cmdqueryname=pem) | [pkcs12](cmdqueryname=pkcs12) } filename [ exportable ] [ [password](cmdqueryname=password) password ]
       ```
   
   ![](public_sys-resources/note_3.0-en-us.png) 
   
   If no certificate format is specified, the system automatically detects the certificate format and imports the certificate.
3. **Optional:** Set the number of days in advance you are notified that the local certificate in the memory is about to expire.
   
   
   ```
   [pki set-certificate expire-prewarning](cmdqueryname=pki+set-certificate+expire-prewarning) day
   ```
4. Commit the configuration.
   
   
   ```
   [commit](cmdqueryname=commit)
   ```

#### Verifying the Configuration

Run the [**display pki certificate**](cmdqueryname=display+pki+certificate) **local** [ **realm** *realm-name* | **filename** *filename* ] command to check the local certificate that has been loaded on the device.