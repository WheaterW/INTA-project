Digital Envelope and Digital Signature
======================================

Digital Envelope and Digital Signature

#### Digital Envelope

A digital envelope contains the data that combines the symmetric key encrypted using the receiver's public key and the data encrypted using the symmetric key. Upon receiving a digital envelope, the receiver uses its own private key to decrypt the digital envelope and obtains the symmetric key. The digital envelope has the advantages of both symmetric key cryptography and public key cryptography. It speeds up key distribution and encryption, while improving key security, extensibility, and as efficiency.

[Figure 1](#EN-US_CONCEPT_0000001564006277__fig_dc_fd_pki_000601) shows the encryption and decryption process for a digital envelope.

**Figure 1** Digital envelope encryption and decryption process  
![](figure/en-us_image_0000001564126185.png)

Assume that user A has obtained the public key of user B. The encryption and decryption process is as follows:

1. User A uses a symmetric key to encrypt clear text, generating ciphertext.
2. User A uses the public key of user B to encrypt the symmetric key, generating a digital envelope.
3. User A sends the digital envelope to user B.
4. User B uses its own private key to decrypt the digital envelope, obtaining the symmetric key.
5. User B uses the symmetric key to decrypt the ciphertext, obtaining the original clear text.

However, the following vulnerability should be noted regarding the digital envelope: An attacker may intercept information from user A, use its own symmetric key to encrypt forged information, use the public key of user B to encrypt its own symmetric key, and send the information to user B. User B then decrypts and considers this information to have been sent from user A. To address this problem, the digital signature is utilized to ensure the credentials of the sender.


#### Digital Signature

A digital envelope cannot determine if the information received actually originated from the sender. Instead, a digital signature is utilized to verify the identity of the sender as well as whether the information received has been tampered with.

A digital signature is generated by the sender by encrypting the digital fingerprint using its own private key. The receiver then uses the sender's public key to decrypt the digital signature and obtain the digital fingerprint.

A digital fingerprint, also known as the information digest, is generated by the sender using the hash algorithm on the clear text. The sender transmits both the digital fingerprint and clear text to the receiver, which also performs hash on the clear text to generate a digital fingerprint. If the two fingerprints match, the receiver determines that the information has not been tampered with.

[Figure 2](#EN-US_CONCEPT_0000001564006277__fig_dc_fd_pki_000602) shows the encryption and decryption process for a digital signature.

**Figure 2** Digital signature encryption and decryption process  
![](figure/en-us_image_0000001513046118.png)

Assume that user A has obtained the public key of user B. The encryption and decryption process is as follows:

1. User A uses the public key of user B to encrypt clear text, generating ciphertext.
2. User A performs hash on the clear text, generating a digital fingerprint.
3. User A uses its own private key to encrypt the digital fingerprint, generating a digital signature.
4. User A sends both the ciphertext and digital signature to user B.
5. User B uses the public key of user A to decrypt the digital signature, obtaining the digital fingerprint.
6. After receiving the ciphertext from user A, user B uses its own private key for decryption, obtaining the original clear text.
7. User B performs hash on the clear text, generating a digital fingerprint.
8. User B compares the generated fingerprint with that received from user A. If the two fingerprints match, user B accepts the clear text. Otherwise, user B discards it.

The digital signature proves that information has not been tampered with and verifies the sender's identity, and can be used in conjunction with the digital envelope.

Despite these advanced security features, a vulnerability still exists. If an attacker modifies user B's public key, user A will obtain the attacker's public key. The attacker can obtain information sent from user B to user A, sign forged information using its own private key, encrypts forged information using user A's public key, and sends this forged information to user A. Upon receipt, user A decrypts the information, verifies that the information has not been tampered with, and considers it to have originated from user B. However, the digital certificate can address this vulnerability.