802.1X Authentication Packet Exchange Process
=============================================

802.1X Authentication Packet Exchange Process

#### 802.1X Authentication Triggering

802.1X authentication can be triggered in the following scenarios:

* A client sends an EAPoL-Start packet.
* A client sends a DHCP, ARP, DHCPv6, ND, or any other packet.
* The access device multicasts an EAP-Request/Identity packet.


#### Authentication Processes in EAP Relay and EAP Termination Modes

In the 802.1X authentication system, the access device exchanges information with the RADIUS server in EAP relay or EAP termination mode. [Figure 1](#EN-US_CONCEPT_0000001564120289__fig_dc_fd_nac_000403) and [Figure 2](#EN-US_CONCEPT_0000001564120289__fig_dc_fd_nac_000404) respectively show the 802.1X authentication processes in EAP relay and EAP termination modes. In both processes, the client sends an EAPoL-Start packet to trigger authentication.

**Figure 1** Authentication process in EAP relay mode  
![](figure/en-us_image_0000001512840938.png)

1. The client sends an EAPoL-Start packet to trigger authentication.
2. The access device sends an EAP-Request/Identity packet to request the identity information of the client.
3. The client sends an EAP-Response/Identity packet carrying its identity information to the access device.
4. The access device encapsulates the received EAP-Response/Identity packet into a RADIUS Access-Request packet, and sends the resulting packet to the RADIUS server.
5. The RADIUS server receives the RADIUS Access-Request packet carrying the client's identity information, and starts to negotiate the EAP authentication method with the client. The RADIUS server encapsulates a RADIUS Access-Challenge packet with an EAP authentication method for negotiation with the client, and sends the resulting packet to the access device.
6. The access device forwards the EAP information in the received RADIUS Access-Challenge packet to the client.
7. The client parses the received EAP information to obtain the EAP authentication method selected by the RADIUS server. If the client supports this method, it sends an EAP-Response packet encapsulated with this method to the access device. If the client does not support this method, it encapsulates an EAP-Response packet with the EAP authentication method it supports, and sends the resulting packet to the access device.
8. The access device encapsulates a RADIUS packet with the EAP information carried in the received EAP-Response packet, and sends the RADIUS packet to the RADIUS server.
9. Upon receipt of the RADIUS packet, the RADIUS server checks whether it supports the EAP authentication method specified in the packet. If so, negotiation of the EAP authentication method succeeds, and authentication starts. The following assumes that the negotiated EAP authentication method is EAP-PEAP authentication. The server then encapsulates a RADIUS packet with its certificate and sends the packet to the access device. After receiving the RADIUS packet, the access device forwards the certificate information to the client. The client verifies the server certificate (optional), negotiates TLS parameters with the RADIUS server, and establishes a TLS tunnel with the server. This tunnel is used to transmit TLS-encrypted user information among the client, access device, and RADIUS server. If negotiation of the EAP authentication method between the client and server fails, the authentication process is terminated, and the access device is notified of the authentication failure and disconnects the client.
10. After authenticating the client, the RADIUS server sends a RADIUS Access-Accept packet to notify the access device of the authentication success.
11. The access device receives the RADIUS Access-Accept packet, sends an EAP-Success packet to the client, changes the access port state of the user to authorized, and allows the user to access the network through this port.
12. If the user wants to go offline, the client sends an EAPoL-Logoff packet to the access device.
13. The access device changes the port state from authorized to unauthorized and sends an EAP-Failure packet to the client.

**Figure 2** Authentication process in EAP termination mode  
![](figure/en-us_image_0000001563760845.png)

In EAP termination mode, the access device negotiates the EAP authentication method with the client, and sends user information to the RADIUS server for authentication. In contrast, such negotiation in EAP relay mode is performed between the client and server; the access device is only responsible for encapsulating RADIUS packets with EAP packets and transparently transmitting the RADIUS packets to the authentication server.