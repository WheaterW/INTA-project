OSPFv3 LSA Format
=================

Each device in an AS generates one or more types of LSAs, depending on the device's role, and multiple LSAs form an LSDB. OSPFv3 encapsulates routing information into LSAs for transmission. Commonly used LSAs include:

* Router-LSA (Type 1)
* Network-LSA (Type 2)
* Inter-area-prefix-LSA (Type 3)
* Inter-area-router-LSA (Type 4)
* AS-external-LSA (Type 5)
* NSSA-LSA (Type 7)
* Link-LSA (Type 8)
* Intra-area-prefix-LSA (Type 9)

#### LSA Header Format

All LSAs have the same header. [Figure 1](#EN-US_CONCEPT_0000001130623224__fig_dc_vrp_feature_new_00632201) shows an LSA header.

**Figure 1** LSA header format  
![](figure/en-us_image_0000001176662961.png)

**Table 1** LSA header fields
| Field | Length | Description |
| --- | --- | --- |
| LS age | 16 bits | Time elapsed since an LSA is generated, in seconds. The value of this field continually increases regardless of whether the LSA is transmitted over a link or saved in an LSDB. |
| LS type | 16 bits | Type of the LSA. The values are as follows:   * Type1: Router-LSA * Type2: Network-LSA * Type3: Inter-Area-Prefix-LSA * Type4: Inter-Area-Router-LSA * Type5: AS-external-LSA * Type7: NSSA-LSA * Type8: Link-LSA * Type9: Intra-Area-Prefix-LSA |
| Link State ID | 32 bits | This field, together with the LS type field, uniquely identifies each LSA in an OSPFv3 area. |
| Advertising Router | 32 bits | Router ID of the device that generates the LSA. |
| LS sequence number | 32 bits | Sequence number of the LSA. Neighbors can use this field to identify the latest LSA. |
| LS checksum | 16 bits | Checksum of all fields except the LS age field. |
| Length | 16 bits | Length of the LSA including the LSA header, in bytes. |



#### Router-LSA

A router-LSA (Type 1) describes the link status and cost of a device. Router-LSAs are generated by a device and advertised within the area to which the device belongs. [Figure 2](#EN-US_CONCEPT_0000001130623224__fig_dc_vrp_feature_new_00632202) shows the format of a router-LSA.

**Figure 2** Format of a router-LSA  
![](figure/en-us_image_0000001130783178.png)

**Table 2** Router-LSA fields
| Field | Length | Description |
| --- | --- | --- |
| Nt (NSSA translation) | 1 bit | If the device that generates the LSA is an NSSA border router, this field is set to 1. Otherwise, this field is set to 0. When this field is set to 1, the device unconditionally translates NSSA-LSAs into AS-external-LSAs. |
| x | 1 bit | This field is deprecated for OSPFv3. |
| V (Virtual Link) | 1 bit | If the device that generates the LSA is located at one end of a virtual link, this field is set to 1. Otherwise, this field is set to 0. |
| E (External) | 1 bit | If the device that generates the LSA is an ASBR, this field is set to 1. Otherwise, this field is set to 0. |
| B (Border) | 1 bit | If the device that generates the LSA is an ABR, this field is set to 1. Otherwise, this field is set to 0. |
| Options | 24 bits | Optional capabilities supported by the device. |
| Type | 8 bits | Type of the device link. The values are as follows:   * 1: The device is connected to a neighbor in P2P mode. * 2: The device is connected to a transit network. * 3: Reserved. * 4: The device is connected to a neighbor over a virtual link. |
| metric | 16 bits | Cost of the link. |
| Interface ID | 32 bits | Interface ID assigned to the interface being described. |
| Neighbor Interface ID | 32 bits | Interface ID that a neighbor has associated with the link, as advertised in the neighbor's Hello packets.   * For transit links, this field indicates the DR's interface ID. * For other link types, this field indicates the neighbor's interface ID. |
| Neighbor Router ID | 32 bits | Router ID of a neighbor.   * For transit links, this field indicates the DR's router ID. * For other link types, this field indicates the neighbor's router ID. |



#### Network-LSA

A network-LSA (Type 2) records router IDs of all devices on the local network segment and describes the link status of the local network segment. Network-LSAs are generated by the DR on a broadcast or NBMA network and advertised within the area to which the DR belongs. [Figure 3](#EN-US_CONCEPT_0000001130623224__fig_dc_vrp_feature_new_00632203) shows the format of a network-LSA.

**Figure 3** Format of a network-LSA  
![](figure/en-us_image_0000001176662949.png)

**Table 3** Network-LSA fields
| Field | Length | Description |
| --- | --- | --- |
| Options | 24 bits | Optional capabilities supported by the device |
| Attached Router | 32 bits | Router IDs of all devices on the same network, including the router ID of the DR |



#### Inter-Area-Prefix-LSA

Originated by an ABR, an inter-area-prefix-LSA (Type 3) describes routes to an IPv6 address prefix within the local area, and is advertised to other related areas.

[Figure 4](#EN-US_CONCEPT_0000001130623224__fig_dc_vrp_feature_new_00632204) shows the format of an inter-area-prefix-LSA.

**Figure 4** Format of an inter-area-prefix-LSA  
![](figure/en-us_image_0000001130783206.png)

**Table 4** Inter-area-prefix-LSA fields
| Field | Length | Description |
| --- | --- | --- |
| PrefixLength | 8 bits | Length of the IPv6 address prefix |
| PrefixOption | 8 bits | Capabilities associated with the IPv6 address prefix |
| Address Prefix | 32 bits | Encoding of the IPv6 address prefix itself |



#### Inter-Area-Router-LSA

Originated by ABRs, inter-area-router-LSAs (Type 4) describe routes to ASBRs in other areas, and are advertised to all related areas excluding those that the ASBRs belong to.

[Figure 5](#EN-US_CONCEPT_0000001130623224__fig_dc_vrp_feature_new_00632205) shows the format of an inter-area-router-LSA.

**Figure 5** Format of an inter-area-router-LSA  
![](figure/en-us_image_0000001176662941.png)

**Table 5** Inter-area-router-LSA fields
| Field | Length | Description |
| --- | --- | --- |
| Destination Router ID | 32 bits | Router ID of the device described by the LSA |



#### AS-External-LSA

AS-external-LSAs are originated by ASBRs and describe routes to destinations external to the local AS.

[Figure 6](#EN-US_CONCEPT_0000001130623224__fig_dc_vrp_feature_new_00632206) shows the format of an AS-external-LSA.

**Figure 6** Format of an AS-external-LSA  
![](figure/en-us_image_0000001176742849.png)

**Table 6** AS-external-LSA fields
| Field | Length | Description |
| --- | --- | --- |
| E | 1 bit | External metric type.  * If this field is set to 1, the specified metric is a Type 2 external metric. * If this field is set to 0, the specified metric is a Type 1 external metric. |
| F | 1 bit | Whether a forwarding address has been included in the LSA.  * If this field is set to 1, a forwarding address has been included in the LSA. * If this field is set to 0, no forwarding address has been included in the LSA. |
| T | 1 bit | Whether an external route tag has been included in the LSA.  * If this field is set to 1, an external route tag has been included in the LSA. * If this field is set to 0, no external route tag has been included in the LSA. |
| Referenced LS Type | 16 bits | Referenced link state (LS) type. If this value is not 0, an LSA with this LS type is to be associated with this LSA (see Referenced Link State ID below). |
| Forwarding Address | 128 bits | A fully qualified global IPv6 address. |
| External Route Tag | 32 bits | External route tag, which can be used to communicate additional information between ASBRs. |
| Referenced Link State ID | 32 bits | Referenced LS ID. |



#### NSSA-LSA

NSSA-LSAs are originated by ASBRs within an NSSA and describe routes to destinations external to the AS.

[Figure 7](#EN-US_CONCEPT_0000001130623224__fig_dc_vrp_feature_new_00632207) shows the format of an NSSA-LSA.

**Figure 7** Format of an NSSA-LSA  
![](figure/en-us_image_0000001176742861.png)

#### Link-LSA

A device originates a separate link-LSA for each attached link. Link LSAs have scope for link-local flooding, and offer a number of functions which include providing the device's link-local address to all other devices attached to the link, informing other devices attached to the link of a list of IPv6 address prefixes to associate with the link, and allowing the device to advertise a collection of link Options bits in network-LSAs.

[Figure 8](#EN-US_CONCEPT_0000001130623224__fig_dc_vrp_feature_new_00632208) shows the format of a link-LSA.

**Figure 8** Format of a link-LSA  
![](figure/en-us_image_0000001130783180.png)

**Table 7** Link-LSA fields
| Field | Length | Description |
| --- | --- | --- |
| Rtr Priority | 8 bits | Router priority of the interface attaching the originating device to the link. |
| Options | 24 bits | Set of Options bits that the device may set in the network-LSA to be originated by the DR on broadcast or NBMA links. |
| Link-local Interface Address | 128 bits | Originating device's link-local interface address on the link. |
| Number of prefixes | 32 bits | Number of IPv6 address prefixes contained in the LSA. |



#### Intra-Area-Prefix-LSA

Each device or DR generates one or more LSAs of this type and transmits them in the local area:

* Such LSAs generated by a device describe the IPv6 address prefixes associated with router LSAs.
* Such LSAs generated by a DR describe the IPv6 address prefixes associated with network LSAs.

[Figure 9](#EN-US_CONCEPT_0000001130623224__fig_dc_vrp_feature_new_00632209) shows the format of an intra-area-prefix-LSA.

**Figure 9** Format of an intra-area-prefix-LSA  
![](figure/en-us_image_0000001130783212.png)

**Table 8** Intra-area-prefix-LSA fields
| Field | Length | Description |
| --- | --- | --- |
| Referenced LS Type | 16 bits | Identifies the router-LSA or network-LSA with which IPv6 address prefixes should be associated.  * If Referenced LS Type is 0x2001, the IPv6 address prefixes are associated with a router-LSA. * If Referenced LS Type is 0x2002, the IPv6 address prefixes are associated with a network-LSA. |
| Referenced Link State ID | 32 bits | Referenced LS ID.  * If Referenced LS Type is 0x2001, Referenced Link State ID should be 0. * If Referenced LS Type is 0x2002, Referenced Link State ID should be the DR's interface ID. |
| Referenced Advertising Router | 32 bits | ID of the referenced advertising router.  * If Referenced LS Type is 0x2001, Referenced Advertising Router should be the originating router's router ID. * If Referenced LS Type is 0x2002, Referenced Advertising Router should be the DR's router ID. |