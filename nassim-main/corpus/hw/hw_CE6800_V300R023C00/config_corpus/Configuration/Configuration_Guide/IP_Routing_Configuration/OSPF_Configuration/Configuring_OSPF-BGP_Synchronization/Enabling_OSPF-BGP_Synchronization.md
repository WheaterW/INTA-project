Enabling OSPF-BGP Synchronization
=================================

Enabling OSPF-BGP Synchronization

#### Prerequisites

Before enabling OSPF-BGP synchronization, you have completed the following tasks:

* [Configure basic OSPF functions](vrp_ospf_cfg_0010.html).
* [Configure basic BGP functions](../vrp_bgp_cfg_0014.html).

#### Procedure

1. Enter the system view.
   
   
   ```
   [system-view](cmdqueryname=system-view)
   ```
2. Enter the OSPF view.
   
   
   ```
   [ospf](cmdqueryname=ospf) [ process-id ]
   ```
   
   The *process-id* parameter specifies the ID of a process, and the default value is 1.
3. Configure the current device as a stub router.
   
   
   ```
   [stub-router](cmdqueryname=stub-router) on-startup [ interval ]
   ```
   
   After configuration, the link metric in the LSAs advertised by the device is the maximum value (65535), which instructs other OSPF devices not to use it as a transit device for data forwarding.
4. Enable secure synchronization.
   
   
   ```
   [safe-sync enable](cmdqueryname=safe-sync+enable)
   ```
   
   If a stub router restarts, the router LSAs on the device are discarded. In this case, the neighbors use the old router LSAs before the device restart to calculate routes that pass through it due to the interval at which LSAs are retransmitted. As a result, packet loss occurs and continues for seconds after the device is restarted and before the device establishes a neighbor relationship with the peer end.
   
   To prevent this issue, configure secure synchronization on the device to be restarted. When the device synchronizes the LSDB with the peer end, it deletes or updates the LSA received from the peer end if that LSA was the one generated by the device itself. In this manner, the neighbor relationship between the local device and peer end can reach the Full state, indicating a successful establishment.
5. Commit the configuration.
   
   
   ```
   [commit](cmdqueryname=commit)
   ```