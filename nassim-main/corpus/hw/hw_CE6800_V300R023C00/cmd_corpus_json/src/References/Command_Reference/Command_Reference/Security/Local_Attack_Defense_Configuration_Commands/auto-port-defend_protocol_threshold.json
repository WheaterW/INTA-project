{
    "PageTitle": "auto-port-defend protocol threshold",
    "FuncDef": "The auto-port-defend protocol threshold command sets the protocol packet rate threshold for port attack defense.\nThe undo auto-port-defend protocol threshold command restores the default protocol packet rate threshold for port attack defense. The auto-port-defend protocol threshold command sets the protocol packet rate threshold for port attack defense. The undo auto-port-defend protocol threshold command restores the default protocol packet rate threshold for port attack defense. By default, the rate threshold for protocol packets in port attack defense is 80% of the default CAR value for the protocol.",
    "CLIs": [
        "auto-port-defend protocol { arp-request | arp-request-uc | arp-reply | dhcp-request | dhcp-reply | dhcpv6-discovery | dhcpv6-reply | dhcpv6-request | icmp | igmp | ip-fragment | isis | isis-overlay | lacp | nd | ospf | ospf-hello | ospf-overlay | ospf-hello-overlay | ospfv3 | ospfv3-overlay | pim | pim-mc | vrrp | vrrp6 } threshold <threshold-value>",
        "undo auto-port-defend protocol { arp-request | arp-request-uc | arp-reply | dhcp-request | dhcp-reply | dhcpv6-discovery | dhcpv6-reply | dhcpv6-request | icmp | igmp | ip-fragment | isis | isis-overlay | lacp | nd | ospf | ospf-hello | ospf-overlay | ospf-hello-overlay | ospfv3 | ospfv3-overlay | pim | pim-mc | vrrp | vrrp6 } threshold",
        "auto-port-defend protocol { arp-request | arp-request-uc | arp-reply | dhcp-request | dhcp-reply | icmp | igmp | ip-fragment | isis | lacp | ospf | pim | pim-mc | vrrp } threshold <threshold-value>",
        "undo auto-port-defend protocol { arp-request | arp-request-uc | arp-reply | dhcp-request | dhcp-reply | icmp | igmp | ip-fragment | isis | lacp | ospf | pim | pim-mc | vrrp } threshold",
        "auto-port-defend protocol { arp-request | arp-request-uc | arp-reply | dhcp-discovery | dhcp-request | dhcp-reply | dhcpv6-discovery | dhcpv6-reply | dhcpv6-request | icmp | igmp | ip-fragment | isis | isis-overlay | lacp | nd | ospf | ospf-hello | ospf-overlay | ospf-hello-overlay | ospfv3 | ospfv3-overlay | pim | pim-mc | vrrp | vrrp6 } threshold <threshold-value>",
        "undo auto-port-defend protocol { arp-request | arp-request-uc | arp-reply | dhcp-discovery | dhcp-request | dhcp-reply | dhcpv6-discovery | dhcpv6-reply | dhcpv6-request | icmp | igmp | ip-fragment | isis | isis-overlay | lacp | nd | ospf | ospf-hello | ospf-overlay | ospf-hello-overlay | ospfv3 | ospfv3-overlay | pim | pim-mc | vrrp | vrrp6 } threshold"
    ],
    "ParentView": [
        "Attack defense policy view"
    ],
    "ParaDef": [
        {
            "Parameters": "arp-request",
            "Info": "Specifies the rate threshold for ARP request packets.\n-"
        },
        {
            "Parameters": "arp-request-uc",
            "Info": "Specifies the rate threshold for ARP request packets.\n-"
        },
        {
            "Parameters": "arp-reply",
            "Info": "Specifies the rate threshold for ARP Reply packets.\n-"
        },
        {
            "Parameters": "dhcp-discovery",
            "Info": "Applies port attack defense to DHCP Discovery packets or cancels port attack defense for DHCP Discovery packets.\n\n NOTE: This parameter is supported only on the CE6863H, CE6863H-K, CE6881H, CE6881H-K, CE6820H, CE6820H-K and CE6820S.\n-"
        },
        {
            "Parameters": "dhcp-request",
            "Info": "Specifies the rate threshold for DHCP server packets.\n-"
        },
        {
            "Parameters": "dhcpv6-discovery",
            "Info": "Specifies the rate threshold for DHCPv6 discovery packets.\n\n NOTE: This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.\n-"
        },
        {
            "Parameters": "dhcpv6-request",
            "Info": "Specifies the rate threshold for DHCPv6 request packets.\n\n NOTE: This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.\n-"
        },
        {
            "Parameters": "igmp",
            "Info": "Specifies the rate threshold for IGMP packets.\n-"
        },
        {
            "Parameters": "isis",
            "Info": "Specifies the rate threshold for ISIS packets.\n-"
        },
        {
            "Parameters": "isis-overlay",
            "Info": "Specifies the rate threshold for Overlay ISIS packets.\n\n NOTE: This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.\n-"
        },
        {
            "Parameters": "nd",
            "Info": "Specifies the rate threshold for ND packets.\n\n NOTE: This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.\n-"
        },
        {
            "Parameters": "ospf",
            "Info": "Specifies the rate threshold for OSPF packets.\n-"
        },
        {
            "Parameters": "ospf-hello",
            "Info": "Specifies the rate threshold for OSPF Hello packets.\n\n NOTE: This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.\n-"
        },
        {
            "Parameters": "ospfv3",
            "Info": "Specifies the rate threshold for OSPFv3 packets.\n\n NOTE: This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.\n-"
        },
        {
            "Parameters": "vrrp",
            "Info": "Specifies the rate threshold for VRRP packets.\n-"
        },
        {
            "Parameters": "vrrp6",
            "Info": "Specifies the rate threshold for VRRP6 packets.\n\n NOTE: This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.\n-"
        },
        {
            "Parameters": "lacp",
            "Info": "Specifies the rate threshold for LACP packets.\n-"
        },
        {
            "Parameters": "pim",
            "Info": "Specifies the rate threshold for PIM packets.\n-"
        },
        {
            "Parameters": "pim-mc",
            "Info": "Specifies PIM multicast packets.\n-"
        },
        {
            "Parameters": "<threshold-value>",
            "Info": "Specifies the rate threshold for auto port defend.\nThe value is an integer in the range from 1 to 65535."
        },
        {
            "Parameters": "dhcp-reply",
            "Info": "Specifies the rate threshold for DHCP client packets.\n-"
        },
        {
            "Parameters": "dhcpv6-reply",
            "Info": "Specifies the rate threshold for DHCPv6 reply packets.\n\n NOTE: This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.\n-"
        },
        {
            "Parameters": "icmp",
            "Info": "Specifies the rate threshold for ICMP packets.\n-"
        },
        {
            "Parameters": "ip-fragment",
            "Info": "Specifies the rate threshold for IP fragment packets.\n-"
        },
        {
            "Parameters": "ospf-overlay",
            "Info": "Specifies the rate threshold for Overlay OSPF packets.\n\n NOTE: This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.\n-"
        },
        {
            "Parameters": "ospf-hello-overlay",
            "Info": "Specifies the rate threshold for Overlay OSPF hello packets.\n\n NOTE: This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.\n-"
        },
        {
            "Parameters": "ospfv3-overlay",
            "Info": "Specifies the rate threshold for Overlay OSPFv3 packets.\n\n NOTE: This parameter is supported only on the CE6863H, CE6863H-K, CE6860-SAN, CE6866K, CE6866, CE6860-HAM, CE6855-48XS8CQ, CE6885-SAN, CE8850-SAN, CE8855, CE8851-32CQ4BQ, CE8851K, CE8851-32CQ8DQ-P, CE8850-HAM, CE6881H, CE6881H-K, CE6820H, CE6820H-K, CE6820S, CE6885, CE6885-T, CE6885-LL (standard forwarding mode) and CE6863E-48S8CQ.\n-"
        }
    ],
    "Examples": [
        [
            "<HUAWEI> system-view",
            "[~HUAWEI] cpu-defend policy test",
            "[*HUAWEI-cpu-defend-policy-test] auto-port-defend protocol arp-request threshold 40"
        ]
    ],
    "ExtraInfo": "After port attack defense is enabled on a port, the device calculates the rate of affected protocol packets received by the port. If the packet rate exceeds the protocol rate threshold, the device considers that an attack occurs. Then the device traces the source and limits the rate of attack packets on the port, and records a log. The device moves the packets within the protocol rate limit (CPCAR in attack defense policies) to the low-priority queue, and then sends them to the CPU. The device discards the excess packets.\nYou need to set an appropriate rate threshold for port attack defense according to service requirements. If the CPU fails to process many protocol packets promptly after port attack defense is enabled, set a large packet rate threshold. If the CPU is busy processing the packets of a protocol, set a small rate threshold for this protocol to avoid impact on other services."
}