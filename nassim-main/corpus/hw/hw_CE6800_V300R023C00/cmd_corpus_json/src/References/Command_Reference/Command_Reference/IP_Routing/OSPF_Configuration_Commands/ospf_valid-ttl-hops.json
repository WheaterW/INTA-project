{
    "PageTitle": "ospf valid-ttl-hops",
    "FuncDef": "The ospf valid-ttl-hops command enables OSPF GTSM and sets the TTL value to be checked.\nThe undo ospf valid-ttl-hops command disables OSPF GTSM. The ospf valid-ttl-hops command enables OSPF GTSM and sets the TTL value to be checked. The undo ospf valid-ttl-hops command disables OSPF GTSM. By default, OSPF GTSM is disabled.",
    "CLIs": [
        "ospf valid-ttl-hops <ttl> [ nonstandard-multicast ] [ vpn-instance <vpn-instance-name> ]",
        "undo ospf valid-ttl-hops [ <ttl> ] [ nonstandard-multicast ] [ vpn-instance <vpn-instance-name> ]"
    ],
    "ParentView": [
        "System view"
    ],
    "ParaDef": [
        {
            "Parameters": "<ttl>",
            "Info": "Specifies the TTL value to be checked.\nThe value is an integer that ranges from 1 to 255. If you specify the parameter hops, the valid range of the TTL value in the packet to be checked is [ 255-hops+1, 255 ]."
        },
        {
            "Parameters": "nonstandard-multicast",
            "Info": "Specifies the GTSM configuration is also valid for multicast packets.When the.\nnonstandard-multicast parameter is configured:\n\nThe TTL values of the multicast packets which will be sent are set to 255.Received multicast packets are not checked.\n-"
        },
        {
            "Parameters": "vpn-instance <vpn-instance-name>",
            "Info": "Specifies the VPN instance name.\nThe value is a string of 1 to 31 case-sensitive characters, spaces not supported. The VPN instance name cannot be _public_. If the character string is quoted by double quotation marks, the character string can contain spaces."
        }
    ],
    "Examples": [
        [
            "<HUAWEI> system-view",
            "[~HUAWEI] ospf valid-ttl-hops 5"
        ]
    ],
    "ExtraInfo": "On a network requiring high security, you can configure GTSM to improve the security of the OSPF network. GTSM defends against attacks through TTL detection. If an attacker continuously sends simulated OSPF unicast packets to a device, the device receives these packets and finds that they are local packets. Then, the device directly sends the packets to OSPF on the control plane for processing, without checking the validity of these packets. As a result, the control plane of the device is busy processing these packets, and the CPU usage is high. GTSM protects a device by checking whether the TTL value in the IP packet header is within a pre-defined range to enhance system security.\nThis command can be used to enable OSPF GTSM and check the TTL value."
}