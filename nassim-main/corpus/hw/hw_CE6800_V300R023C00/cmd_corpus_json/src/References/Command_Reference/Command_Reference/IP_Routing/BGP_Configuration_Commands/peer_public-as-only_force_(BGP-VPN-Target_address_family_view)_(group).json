{
    "PageTitle": "peer public-as-only force (BGP-VPN-Target address family view) (group)",
    "FuncDef": "The peer public-as-only force command configures the AS-Path attribute in a BGP Update message to delete all private AS numbers from the AS_Path attribute except the private AS number of a specified peer.\nThe undo peer public-as-only force command restores the default setting. The peer public-as-only force command configures the AS-Path attribute in a BGP Update message to delete all private AS numbers from the AS_Path attribute except the private AS number of a specified peer. The undo peer public-as-only force command restores the default setting. By default, the AS-Path attribute in a BGP Update message is allowed to carry private AS numbers.",
    "CLIs": [
        "peer <group-name> public-as-onlyforce [ replace ] [ include-peer-as ]",
        "undo peer <group-name> public-as-onlyforce [ replace ] [ include-peer-as ]"
    ],
    "ParentView": [
        "BGP-VPN-target address family view"
    ],
    "ParaDef": [
        {
            "Parameters": "<group-name>",
            "Info": "Specifies the name of a peer group.\nThe name is a string of 1 to 47 case-sensitive characters, with spaces not supported. When double quotation marks are used around the string, spaces are allowed in the string."
        },
        {
            "Parameters": "force",
            "Info": "Deletes all private AS numbers from the AS_Path attribute except the private AS number of a specified peer group.\n-"
        },
        {
            "Parameters": "replace",
            "Info": "Replaces private AS numbers in an AS_Path list with a local AS number:\nIf both force and replace are specified, private AS numbers in an AS_Path list, except the AS number of a specified peer group, are replaced with the local AS number.\n-"
        },
        {
            "Parameters": "include-peer-as",
            "Info": "Deletes AS numbers:\nIf both force and include-peer-as are specified, all private AS numbers are forcibly deleted.\n-"
        }
    ],
    "Examples": [
        [
            "<HUAWEI> system-view",
            "[*HUAWEI] bgp 100",
            "[*HUAWEI-bgp] group test internal",
            "[*HUAWEI-bgp] ipv4-family vpn-target",
            "[*HUAWEI-bgp-af-vpn-target] peer test enable",
            "[*HUAWEI-bgp-af-vpn-target] peer test public-as-only force"
        ]
    ],
    "ExtraInfo": "Generally, AS numbers range from 1 to 4294967295, including the public, private, and reserved AS numbers. If the private-4-byte-as enable command is not run, private AS numbers range from 64512 to 65534, and the AS number 65535 is reserved for special use. If the private-4-byte-as enable command is run, private AS numbers range from 64512 to 65534 and from 4200000000 to 4294967294, and the AS numbers 65535 and 4294967295 are reserved for special use.\nPublic AS numbers can be used over the Internet, whereas private AS numbers cannot be advertised to the Internet. If private AS numbers are advertised to the Internet, routing loops may occur. Therefore, private AS numbers are used only within a routing domain.\nThis command enables BGP to process the private and reserved AS numbers in the AS_Path attribute of BGP routes as required. Reserved AS numbers are processed the same as private AS numbers. The following uses private AS numbers as an example to illustrate the processing modes:\nIf the peer public-as-only command is run without any optional parameter specified and the AS_Path attribute of BGP routes contains only private AS numbers, BGP deletes these private AS numbers before advertising the routes. BGP does not delete private AS numbers in either of the following scenarios if the peer public-as-only command is run, without any parameter following public-as-only specified:\n\u00e2\u0080\u00a2\tThe AS_Path attribute of a route carries the AS number of the remote peer. In this case, deleting private AS numbers may lead to a routing loop.\n\u00e2\u0080\u00a2\tThe AS_Path attribute carries both public and private AS numbers, which indicates that the route has passed through the public network. In this case, deleting private AS numbers may lead to a traffic forwarding error.\nParameters that are used to delete or replace private AS numbers are described as follows:\n\u00e2\u0080\u00a2\tforce: deletes all private AS numbers from the AS_Path attribute except the private AS number of a specified peer group.\n\u00e2\u0080\u00a2\tforce replace: replaces the private AS numbers in the AS_Path attribute with the local AS number except the private AS number of a specified peer group.\n\u00e2\u0080\u00a2\tforce include-peer-as: deletes all private AS numbers from the AS_Path attribute.\n\u00e2\u0080\u00a2\tforce replace include-peer-as: replaces the private AS numbers in the AS_Path attribute with the local AS number. This parameter ensures that the AS_Path attribute length remains unchanged. Therefore, the route selection result is not affected.\n\u00e2\u0080\u00a2\tlimited: deletes private AS numbers from the leftmost one to the local or a public AS number except the private AS number of a specified peer group.\n\u00e2\u0080\u00a2\tlimited replace: replaces private AS numbers from the leftmost one to the local or a public AS number in the AS_Path attribute with the local AS number except the private AS number of a specified peer group.\n\u00e2\u0080\u00a2\tlimited include-peer-as: deletes private AS numbers from the leftmost one to the local or a public AS number. This parameter ensures that all private AS numbers of the local network are deleted.\n\u00e2\u0080\u00a2\tlimited replace include-peer-as: replaces private AS numbers from the leftmost one to the local or a public AS number in the AS_Path attribute with the local AS number.\nSelect one of the preceding parameters based on the network topology to prevent routing loops or forwarding errors."
}